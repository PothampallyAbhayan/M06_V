cscope 15 $HOME/Desktop/PDC-M-Board/PDCcode/bacnet-stack-0.8.6               0004177001
	@demo/dcc/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"f.h
"

36 
	~"tsm.h
"

37 
	~"addss.h
"

38 
	~"cfig.h
"

39 
	~"bacdef.h
"

40 
	~"du.h
"

41 
	~"du.h
"

42 
	~"devi.h
"

43 
	~"t.h
"

44 
	~"dk.h
"

45 
	~"whois.h
"

46 
	~"dcc.h
"

48 
	~"fame.h
"

49 
	~"hdrs.h
"

50 
	~".h
"

51 
	~"txbuf.h
"

52 
	~"dnv.h
"

55 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

58 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

59 
BACNET_ADDRESS
 
	gTg_Addss
;

60 
ut16_t
 
	gCommuniti_Timeout_Mus
 = 0;

61 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
	gCommuniti_S
 =

62 
COMMUNICATION_ENABLE
;

63 *
	gCommuniti_Passwd
 = 
NULL
;

65 
bo
 
	gE_Deed
 = 
l
;

67 
	$MyEHdr
(

68 
BACNET_ADDRESS
 * 
c
,

69 
ut8_t
 
voke_id
,

70 
BACNET_ERROR_CLASS
 
r_ass
,

71 
BACNET_ERROR_CODE
 
r_code
)

74 (
c
;

75 (
voke_id
;

76 
	`tf
("BACÈE: %s: %s\r\n", 
	`baext_r_ass_me
(
r_ass
),

77 
	`baext_r_code_me
(
r_code
));

78 
E_Deed
 = 
ue
;

79 
	}
}

81 
	$MyAbtHdr
(

82 
BACNET_ADDRESS
 * 
c
,

83 
ut8_t
 
voke_id
,

84 
ut8_t
 
abt_as
,

85 
bo
 
rv
)

88 (
c
;

89 (
voke_id
;

90 (
rv
;

91 
	`tf
("BACÈAbt: %s\r\n", 
	`baext_abt_as_me
(
abt_as
));

92 
E_Deed
 = 
ue
;

93 
	}
}

95 
	$MyRejeHdr
(

96 
BACNET_ADDRESS
 * 
c
,

97 
ut8_t
 
voke_id
,

98 
ut8_t
 
je_as
)

101 (
c
;

102 (
voke_id
;

103 
	`tf
("BACÈReje: %s\r\n", 
	`baext_je_as_me
(
je_as
));

104 
E_Deed
 = 
ue
;

105 
	}
}

107 
	$MyDeviCommunitiCڌSimeAckHdr
(

108 
BACNET_ADDRESS
 * 
c
,

109 
ut8_t
 
voke_id
)

111 (
c
;

112 (
voke_id
;

113 
	`tf
("DeviceCommunicationControl Acknowledged!\r\n");

114 
	}
}

116 
	$In_Svi_Hdrs
(

119 
	`Devi_In
(
NULL
);

122 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

124 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

127 
du_t_uecognized_rvi_hdr_hdr


128 (
hdr_uecognized_rvi
);

130 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

131 
hdr_ad_ݔty
);

133 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

134 
hdr_devi_communiti_cڌ
);

136 
du_t_cfmed_sime_ack_hdr


137 (
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

138 
MyDeviCommunitiCڌSimeAckHdr
);

140 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

141 
MyEHdr
);

142 
	`du_t_abt_hdr
(
MyAbtHdr
);

143 
	`du_t_je_hdr
(
MyRejeHdr
);

144 
	}
}

146 
	$ma
(

147 
gc
,

148 *
gv
[])

150 
BACNET_ADDRESS
 
c
 = {

153 
ut16_t
 
pdu_n
 = 0;

154 
timeout
 = 100;

155 
max_du
 = 0;

156 
time_t
 
d_cds
 = 0;

157 
time_t
 
ϡ_cds
 = 0;

158 
time_t
 
cut_cds
 = 0;

159 
time_t
 
timeout_cds
 = 0;

160 
ut8_t
 
voke_id
 = 0;

161 
bo
 
found
 = 
l
;

163 i(
gc
 < 3) {

164 
	`tf
("Usage: %s device-instance stateimeout [password]\r\n"

172 
	`fame_move_th
(
gv
[0]), 
BACNET_MAX_INSTANCE
 - 1);

176 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

177 
Communiti_S
 = (
ut16_t

	`
(
gv
[2], 
NULL
, 0);

178 
Communiti_Timeout_Mus
 = (
ut16_t

	`
(
gv
[3], 
NULL
, 0);

180 i(
gc
 > 4)

181 
Communiti_Passwd
 = 
gv
[4];

183 i(
Tg_Devi_Obje_In
 >
BACNET_MAX_INSTANCE
) {

184 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

185 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

190 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

191 
	`addss_
();

192 
	`In_Svi_Hdrs
();

193 
	`dnv_
();

194 
	`ex
(
dk_nup
);

196 
ϡ_cds
 = 
	`time
(
NULL
);

197 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

199 
found
 =

200 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

201 &
Tg_Addss
);

202 i(!
found
) {

203 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

204 
Tg_Devi_Obje_In
);

209 
cut_cds
 = 
	`time
(
NULL
);

212 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

215 i(
pdu_n
) {

216 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

219 i(
cut_cds
 !
ϡ_cds
)

220 
	`tsm_tim_mlicds
((
ut16_t
((
cut_cds
 -

221 
ϡ_cds
) * 1000));

222 i(
E_Deed
)

225 i(!
found
) {

226 
found
 =

227 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

228 &
Tg_Addss
);

230 i(
found
) {

231 i(
voke_id
 == 0) {

232 
voke_id
 =

233 
Sd_Devi_Communiti_Cڌ_Reque


234 (
Tg_Devi_Obje_In
,

235 
Communiti_Timeout_Mus
, 
Communiti_S
,

236 
Communiti_Passwd
);

237 } i(
	`tsm_voke_id_
(
voke_id
))

239 i(
	`tsm_voke_id_ed
(
voke_id
)) {

240 
	`rtf
(
dr
, "\rError: TSM Timeout!\r\n");

241 
	`tsm__voke_id
(
voke_id
);

247 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

248 i(
d_cds
 > 
timeout_cds
) {

249 
	`tf
("\rError: APDU Timeout!\r\n");

254 
ϡ_cds
 = 
cut_cds
;

258 
	}
}

	@demo/epics/bacepics.h

26 #ide
BACEPICS_H_


27 
	#BACEPICS_H_


	)

90 
	mINITIAL_BINDING
,

92 
	mGET_HEADING_INFO
, 
	mGET_HEADING_RESPONSE
, 
	mPRINT_HEADING
,

94 
	mGET_ALL_REQUEST
, 
	mGET_ALL_RESPONSE
,

96 
	mGET_LIST_OF_ALL_REQUEST
, 
	mGET_LIST_OF_ALL_RESPONSE
,

98 
	mGET_PROPERTY_REQUEST
, 
	mGET_PROPERTY_RESPONSE
,

100 
	mNEXT_OBJECT


101 } 
	tEPICS_STATES
;

	@demo/epics/main.c

29 
	~<ddef.h
>

30 
	~<dt.h
>

31 
	~<dio.h
>

32 
	~<dlib.h
>

33 
	~<time.h
>

34 
	~<o.h
>

35 
	~<as.h
>

36 
	~"cfig.h
"

37 
	~"baext.h
"

38 
	~"m.h
"

39 
	~"f.h
"

40 
	~"tsm.h
"

41 
	~"addss.h
"

42 
	~"bacdef.h
"

43 
	~"du.h
"

44 
	~"du.h
"

45 
	~"devi.h
"

46 
	~"t.h
"

47 
	~"dk.h
"

48 
	~"whois.h
"

49 
	~".h
"

50 
	~"li.h
"

52 
	~"fame.h
"

53 
	~"hdrs.h
"

54 
	~".h
"

55 
	~"txbuf.h
"

56 
	~"dnv.h
"

57 
	~"keyli.h
"

58 
	~"bapics.h
"

74 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

77 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

78 
BACNET_ADDRESS
 
	gTg_Addss
;

80 
ut8_t
 
	gReque_Invoke_ID
 = 0;

83 #i
defed
(
BACDL_BIP
)

85 
ut16_t
 
	gMy_BIP_Pt
 = 0;

87 
bo
 
	gProvided_Tg_MAC
 = 
l
;

90 
bo
 
	gE_Deed
 = 
l
;

91 
ut16_t
 
	gLa_E_Css
 = 0;

92 
ut16_t
 
	gLa_E_Code
 = 0;

94 
ut16_t
 
	gE_Cou
 = 0;

96 
bo
 
	gHas_RPM
 = 
ue
;

97 
EPICS_STATES
 
	gmyS
 = 
INITIAL_BINDING
;

109 
	sBACt_RPM_Svi_Da_t
 {

110 
bo
 
	mw_da
;

111 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 
	mrvi_da
;

112 
BACNET_READ_ACCESS_DATA
 *
	mm_da
;

113 } 
	tBACNET_RPM_SERVICE_DATA
;

114 
BACNET_RPM_SERVICE_DATA
 
	gRd_Prݔty_Muɝ_Da
;

118 
ut32_t
 
	gObje_Li_Lgth
 = 0;

119 
t32_t
 
	gObje_Li_Index
 = 0;

121 
OS_Keyli
 
	gObje_Li
;

125 
	#MAX_PROPS
 128

	)

126 
ut32_t
 
	gPrݔty_Li_Lgth
 = 0;

127 
ut32_t
 
	gPrݔty_Li_Index
 = 0;

128 
t32_t
 
	gPrݔty_Li
[
MAX_PROPS
 + 2];

130 
	sݔty_vue_li_t
 {

131 
t32_t
 
	mݔty_id
;

132 
BACNET_APPLICATION_DATA_VALUE
 *
	mvue
;

134 
ݔty_vue_li_t
 
	gPrݔty_Vue_Li
[] = {

135 {
PROP_VENDOR_NAME
, 
NULL
},

136 {
PROP_MODEL_NAME
, 
NULL
},

137 {
PROP_MAX_APDU_LENGTH_ACCEPTED
, 
NULL
},

138 {
PROP_PROTOCOL_SERVICES_SUPPORTED
, 
NULL
},

139 {
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
, 
NULL
},

140 {
PROP_DESCRIPTION
, 
NULL
},

141 {-1, 
NULL
}

144 
BACNET_APPLICATION_DATA_VALUE
 *
	$obje_ݔty_vue
(

145 
t32_t
 
ݔty_id
)

147 
BACNET_APPLICATION_DATA_VALUE
 *
vue
 = 
NULL
;

148 
t32_t
 
dex
 = 0;

151 i(
Prݔty_Vue_Li
[
dex
].
ݔty_id
 ==roperty_id) {

152 
vue
 = 
Prݔty_Vue_Li
[
dex
].value;

155 
dex
++;

156 } 
Prݔty_Vue_Li
[
dex
].
ݔty_id
 != -1);

158  
vue
;

159 
	}
}

164 
ut32_t
 
	gWked_Li_Lgth
 = 0;

165 
ut32_t
 
	gWked_Li_Index
 = 0;

167 
bo
 
	gUsg_Wked_Li
 = 
l
;

170 
bo
 
	gIsLgAay
 = 
l
;

172 
bo
 
	gShowVues
 = 
l
;

174 
bo
 
	gOiڮ_Prݔts
 = 
l
;

176 #i!
defed
(
PRINT_ERRORS
)

177 
	#PRINT_ERRORS
 1

	)

180 
	$MyEHdr
(

181 
BACNET_ADDRESS
 * 
c
,

182 
ut8_t
 
voke_id
,

183 
BACNET_ERROR_CLASS
 
r_ass
,

184 
BACNET_ERROR_CODE
 
r_code
)

186 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

187 (
voke_id
 =
Reque_Invoke_ID
)) {

188 #i
PRINT_ERRORS


189 i(
ShowVues
) {

190 
	`rtf
(
dr
, "-- BACnet Error: %s: %s\n",

191 
	`baext_r_ass_me
(
r_ass
),

192 
	`baext_r_code_me
(
r_code
));

195 
E_Deed
 = 
ue
;

196 
La_E_Css
 = 
r_ass
;

197 
La_E_Code
 = 
r_code
;

199 
	}
}

201 
	$MyAbtHdr
(

202 
BACNET_ADDRESS
 * 
c
,

203 
ut8_t
 
voke_id
,

204 
ut8_t
 
abt_as
,

205 
bo
 
rv
)

207 (
rv
;

208 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

209 (
voke_id
 =
Reque_Invoke_ID
)) {

210 #i
PRINT_ERRORS


212 i((
myS
 !
GET_ALL_RESPONSE
&& !
IsLgAay
 && 
ShowVues
) {

213 
	`rtf
(
dr
, "-- BACnet Abort: %s \n",

214 
	`baext_abt_as_me
(
abt_as
));

217 
E_Deed
 = 
ue
;

218 
La_E_Css
 = 
ERROR_CLASS_SERVICES
;

219 i(
abt_as
 < 
MAX_BACNET_ABORT_REASON
)

220 
La_E_Code
 =

221 (
ERROR_CODE_ABORT_BUFFER_OVERFLOW
 - 1+ 
abt_as
;

223 
La_E_Code
 = 
ERROR_CODE_ABORT_OTHER
;

225 
	}
}

227 
	$MyRejeHdr
(

228 
BACNET_ADDRESS
 * 
c
,

229 
ut8_t
 
voke_id
,

230 
ut8_t
 
je_as
)

232 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

233 (
voke_id
 =
Reque_Invoke_ID
)) {

234 #i
PRINT_ERRORS


235 i(
ShowVues
) {

236 
	`rtf
(
dr
, "BACnet Reject: %s\n",

237 
	`baext_je_as_me
(
je_as
));

240 
E_Deed
 = 
ue
;

241 
La_E_Css
 = 
ERROR_CLASS_SERVICES
;

242 i(
je_as
 < 
MAX_BACNET_REJECT_REASON
)

243 
La_E_Code
 =

244 (
ERROR_CODE_REJECT_BUFFER_OVERFLOW
 - 1+ 
je_as
;

246 
La_E_Code
 = 
ERROR_CODE_REJECT_OTHER
;

248 
	}
}

250 
	$MyRdPrݔtyAckHdr
(

251 
ut8_t
 * 
rvi_que
,

252 
ut16_t
 
rvi_n
,

253 
BACNET_ADDRESS
 * 
c
,

254 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

256 
n
 = 0;

257 
BACNET_READ_ACCESS_DATA
 *
_da
;

259 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

260 (
rvi_da
->
voke_id
 =
Reque_Invoke_ID
)) {

261 
_da
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

262 i(
_da
) {

263 
n
 =

264 
	`_ack_fuy_decode_rvi_que
(
rvi_que
,

265 
rvi_n
, 
_da
);

267 i(
n
 > 0) {

268 
	`memmove
(&
Rd_Prݔty_Muɝ_Da
.
rvi_da
, service_data,

269 (
BACNET_CONFIRMED_SERVICE_ACK_DATA
));

270 
Rd_Prݔty_Muɝ_Da
.
m_da
 = 
_da
;

271 
Rd_Prݔty_Muɝ_Da
.
w_da
 = 
ue
;

273 i(
n
 < 0)

274 
E_Deed
 = 
ue
;

275 
	`
(
_da
);

278 
	}
}

280 
	$MyRdPrݔtyMuɝAckHdr
(

281 
ut8_t
 * 
rvi_que
,

282 
ut16_t
 
rvi_n
,

283 
BACNET_ADDRESS
 * 
c
,

284 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

286 
n
 = 0;

287 
BACNET_READ_ACCESS_DATA
 *
m_da
;

289 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

290 (
rvi_da
->
voke_id
 =
Reque_Invoke_ID
)) {

291 
m_da
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

292 i(
m_da
) {

293 
n
 =

294 
	`m_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
,

295 
m_da
);

297 i(
n
 > 0) {

298 
	`memmove
(&
Rd_Prݔty_Muɝ_Da
.
rvi_da
, service_data,

299 (
BACNET_CONFIRMED_SERVICE_ACK_DATA
));

300 
Rd_Prݔty_Muɝ_Da
.
m_da
 =pm_data;

301 
Rd_Prݔty_Muɝ_Da
.
w_da
 = 
ue
;

304 i(
n
 < 0)

305 
E_Deed
 = 
ue
;

306 
	`
(
m_da
);

309 
	}
}

311 
	$In_Svi_Hdrs
(

314 
	`Devi_In
(
NULL
);

316 #i
BAC_ROUTING


317 
ut32_t
 
Obje_In
;

318 
BACNET_CHARACTER_STRING
 
me_rg
;

320 
Obje_In
 = 
	`Devi_Obje_In_Numb
();

321 
	`Devi_Obje_Name
(
Obje_In
, &
me_rg
);

322 
	`Add_Roud_Devi
(
Obje_In
, &
me_rg
, 
	`Devi_Desti
());

327 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

329 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

332 
du_t_uecognized_rvi_hdr_hdr


333 (
hdr_uecognized_rvi
);

335 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

336 
hdr_ad_ݔty
);

338 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

339 
MyRdPrݔtyAckHdr
);

340 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

341 
MyRdPrݔtyMuɝAckHdr
);

343 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
, 
MyEHdr
);

344 
	`du_t_abt_hdr
(
MyAbtHdr
);

345 
	`du_t_je_hdr
(
MyRejeHdr
);

346 
	}
}

358 
	$CheckIsWrabPrݔty
(

359 
BACNET_OBJECT_TYPE
 
obje_ty
,

361 
BACNET_PROPERTY_REFERENCE
 * 
m_ݔty
)

363 
bo
 
bIsWrab
 = 
l
;

364 i((
obje_ty
 =
OBJECT_ANALOG_OUTPUT
) ||

365 (
obje_ty
 =
OBJECT_BINARY_OUTPUT
) ||

366 (
obje_ty
 =
OBJECT_COMMAND
) ||

367 (
obje_ty
 =
OBJECT_MULTI_STATE_OUTPUT
) ||

368 (
obje_ty
 =
OBJECT_ACCESS_DOOR
)) {

369 i(
m_ݔty
->
ݔtyIdtifr
 =
PROP_PRESENT_VALUE
) {

370 
bIsWrab
 = 
ue
;

372 } i(
obje_ty
 =
OBJECT_AVERAGING
) {

373 i((
m_ݔty
->
ݔtyIdtifr
 =
PROP_ATTEMPTED_SAMPLES
) ||

374 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_WINDOW_INTERVAL
) ||

375 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_WINDOW_SAMPLES
)) {

376 
bIsWrab
 = 
ue
;

378 } i(
obje_ty
 =
OBJECT_FILE
) {

379 i(
m_ݔty
->
ݔtyIdtifr
 =
PROP_ARCHIVE
) {

380 
bIsWrab
 = 
ue
;

382 } i((
obje_ty
 =
OBJECT_LIFE_SAFETY_POINT
) ||

383 (
obje_ty
 =
OBJECT_LIFE_SAFETY_ZONE
)) {

384 i(
m_ݔty
->
ݔtyIdtifr
 =
PROP_MODE
) {

385 
bIsWrab
 = 
ue
;

387 } i(
obje_ty
 =
OBJECT_PROGRAM
) {

388 i(
m_ݔty
->
ݔtyIdtifr
 =
PROP_PROGRAM_CHANGE
) {

389 
bIsWrab
 = 
ue
;

391 } i(
obje_ty
 =
OBJECT_PULSE_CONVERTER
) {

392 i(
m_ݔty
->
ݔtyIdtifr
 =
PROP_ADJUST_VALUE
) {

393 
bIsWrab
 = 
ue
;

395 } i((
obje_ty
 =
OBJECT_TRENDLOG
) ||

396 (
obje_ty
 =
OBJECT_EVENT_LOG
) ||

397 (
obje_ty
 =
OBJECT_TREND_LOG_MULTIPLE
)) {

398 i((
m_ݔty
->
ݔtyIdtifr
 =
PROP_ENABLE
) ||

399 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_RECORD_COUNT
)) {

400 
bIsWrab
 = 
ue
;

402 } i(
obje_ty
 =
OBJECT_LOAD_CONTROL
) {

403 i((
m_ݔty
->
ݔtyIdtifr
 =
PROP_REQUESTED_SHED_LEVEL
) ||

404 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_START_TIME
) ||

405 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_SHED_DURATION
) ||

406 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_DUTY_WINDOW
) ||

407 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_SHED_LEVELS
)) {

408 
bIsWrab
 = 
ue
;

410 } i((
obje_ty
 =
OBJECT_ACCESS_ZONE
) ||

411 (
obje_ty
 =
OBJECT_ACCESS_USER
) ||

412 (
obje_ty
 =
OBJECT_ACCESS_RIGHTS
) ||

413 (
obje_ty
 =
OBJECT_ACCESS_CREDENTIAL
)) {

414 i(
m_ݔty
->
ݔtyIdtifr
 =
PROP_GLOBAL_IDENTIFIER
) {

415 
bIsWrab
 = 
ue
;

417 } i(
obje_ty
 =
OBJECT_NETWORK_SECURITY
) {

418 i((
m_ݔty
->
ݔtyIdtifr
 ==

419 
PROP_BASE_DEVICE_SECURITY_POLICY
) ||

420 (
m_ݔty
->
ݔtyIdtifr
 ==

421 
PROP_NETWORK_ACCESS_SECURITY_POLICIES
) ||

422 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_SECURITY_TIME_WINDOW
) ||

423 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_PACKET_REORDER_TIME
) ||

424 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_LAST_KEY_SERVER
) ||

425 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_SECURITY_PDU_TIMEOUT
) ||

426 (
m_ݔty
->
ݔtyIdtifr
 =
PROP_DO_NOT_HIDE
)) {

427 
bIsWrab
 = 
ue
;

435 i(
bIsWrab
)

436 
	`rtf
(
dout
, " Writable");

437 
	}
}

440 cڡ *
	$oc_rvis_su܋d_xt
(

441 
size_t
 
b_dex
)

443 
bo
 
is_cfmed
 = 
l
;

444 
size_t
 
xt_dex
 = 0;

445 
bo
 
found
 = 
l
;

446 cڡ *
rvis_xt
 = "unknown";

448 
found
 =

449 
	`du_rvi_su܋d_to_dex
(
b_dex
, &
xt_dex
, &
is_cfmed
);

450 i(
found
) {

451 i(
is_cfmed
) {

452 
rvis_xt
 = 
	`baext_cfmed_rvi_me
(
xt_dex
);

454 
rvis_xt
 = 
	`baext_uncfmed_rvi_me
(
xt_dex
);

458  
rvis_xt
;

459 
	}
}

475 
bo
 
	$PyPrtPrݔtyVue
(

476 
FILE
 * 
am
,

477 
BACNET_OBJECT_PROPERTY_VALUE
 * 
obje_vue
)

479 
BACNET_APPLICATION_DATA_VALUE
 *
vue
 = 
NULL
;

480 
bo
 
us
 = 
ue
;

481 
size_t
 
n
 = 0, 
i
 = 0, 
j
 = 0;

482 
BACNET_PROPERTY_ID
 
ݔty
 = 
PROP_ALL
;

483 
sht_mth
[4];

485 
vue
 = 
obje_vue
->value;

486 
ݔty
 = 
obje_vue
->
obje_ݔty
;

487 i((
vue
 !
NULL
&& (vue->
g
 =
BACNET_APPLICATION_TAG_BIT_STRING
) &&

488 ((
ݔty
 =
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
) ||

489 (
ݔty
 =
PROP_PROTOCOL_SERVICES_SUPPORTED
))) {

490 
n
 = 
	`brg_bs_ud
(&
vue
->
ty
.
B_Sg
);

491 
	`rtf
(
am
, "( \n ");

492 
i
 = 0; i < 
n
; i++) {

493 
	`rtf
(
am
, "%s", 
	`brg_b
(&
vue
->
ty
.
B_Sg
,

494 (
ut8_t

i
) ? "T" : "F");

495 i(
i
 < 
n
 - 1)

496 
	`rtf
(
am
, ",");

498 
	`rtf
(
am
, " ");

500 i((
i
 =(
n
 - 1)) || ((i % 4) == 3)) {

501 
	`rtf
(
am
, " -- ");

503 
j
 = 
i
 - (i % 4); j <= i; j++) {

504 i(
	`brg_b
(&
vue
->
ty
.
B_Sg
, (
ut8_t

j
)) {

505 i(
ݔty
 =
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
) {

506 
	`rtf
(
am
, " %s,",

507 
	`baext_obje_ty_me
(
j
));

510 
	`rtf
(
am
, " %s,",

511 
	`oc_rvis_su܋d_xt
(
j
));

514 
	`rtf
(
am
, ",");

516 
	`rtf
(
am
, "\n ");

519 
	`rtf
(
am
, ") \n");

520 } i((
vue
 !
NULL
&& (vue->
g
 =
BACNET_APPLICATION_TAG_DATE
)) {

524 
	`y
(
sht_mth
, 
	`baext_mth_me
(
vue
->
ty
.
De
.
mth
), 3);

525 
sht_mth
[3] = 0;

526 
	`rtf
(
am
, "(%u-%3s-%u, %u)", (
vue
->
ty
.
De
.
day
,

527 
sht_mth
, (
vue
->
ty
.
De
.
yr
,

528 (
vue
->
ty
.
De
.
wday
);

529 } i(
vue
 !
NULL
) {

530 
	`as
(
l
);

532 
us
 = 
	`ba_t_vue
(
dout
, 
obje_vue
);

534 
	`rtf
(
am
, "? \n");

536  
us
;

537 
	}
}

550 
	$PrtRdPrݔtyDa
(

551 
BACNET_OBJECT_TYPE
 
obje_ty
,

552 
ut32_t
 
obje_
,

553 
BACNET_PROPERTY_REFERENCE
 * 
m_ݔty
)

555 
BACNET_OBJECT_PROPERTY_VALUE
 
obje_vue
;

556 
BACNET_APPLICATION_DATA_VALUE
 *
vue
, *
d_vue
;

557 
bo
 
t_b
 = 
l
;

558 
KEY
 
obje_li_emt
;

559 
bo
 
isSequ
 = 
l
;

561 i(
m_ݔty
 =
NULL
) {

562 
	`rtf
(
dout
, " -- Null Property data \n");

565 
vue
 = 
m_ݔty
->value;

566 i(
vue
 =
NULL
) {

568 
	`rtf
(
dout
, "? -- BACnet Error: %s: %s\n",

569 
	`baext_r_ass_me
((
m_ݔty
->
r
.
r_ass
),

570 
	`baext_r_code_me
((
m_ݔty
->
r
.
r_code
));

573 
obje_vue
.
obje_ty
 = object_type;

574 
obje_vue
.
obje_
 = object_instance;

575 i((
vue
 !
NULL
&& (vue->
xt
 != NULL)) {

578 
m_ݔty
->
ݔtyIdtifr
) {

580 
PROP_PRESENT_VALUE
:

581 
PROP_PRIORITY_ARRAY
:

582 i(!
ShowVues
) {

583 
	`rtf
(
dout
, "? \n");

588 
m_ݔty
->
ݔtyIdtifr
 =

589 
PROP_PROTOCOL_CONFORMANCE_CLASS
;

592 i(
obje_ty
 =
OBJECT_DATETIME_VALUE
)

597 
	`rtf
(
dout
, "{ ");

598 
t_b
 = 
ue
;

603 i(!
Usg_Wked_Li
)

604 
Wked_Li_Index
 = 
Wked_Li_Lgth
 = 0;

606 
vue
 !
NULL
) {

607 
obje_vue
.
obje_ݔty
 = 
m_ݔty
->
ݔtyIdtifr
;

608 
obje_vue
.
y_dex
 = 
m_ݔty
->
ݔtyAayIndex
;

609 
obje_vue
.
vue
 = value;

610 
m_ݔty
->
ݔtyIdtifr
) {

612 
PROP_OBJECT_LIST
:

613 
PROP_STATE_TEXT
:

614 
PROP_STRUCTURED_OBJECT_LIST
:

615 
PROP_SUBORDINATE_ANNOTATIONS
:

616 
PROP_SUBORDINATE_LIST
:

617 i(
Usg_Wked_Li
) {

618 i((
m_ݔty
->
ݔtyAayIndex
 == 0) &&

619 (
vue
->
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
)) {

621 
Wked_Li_Lgth
 = 
vue
->
ty
.
Unsigd_I
;

622 i(
m_ݔty
->
ݔtyIdtifr
 ==

623 
PROP_OBJECT_LIST
)

624 
Obje_Li_Lgth
 = 
vue
->
ty
.
Unsigd_I
;

627 
	`as
(
Wked_Li_Index
 =(
ut32_t
)

628 
m_ݔty
->
ݔtyAayIndex
);

630 
Wked_Li_Index
++;

633 i(
m_ݔty
->
ݔtyIdtifr
 =
PROP_OBJECT_LIST
)

634 
Obje_Li_Lgth
 = ++
Obje_Li_Index
;

636 i(
Wked_Li_Index
 == 1) {

639 i(
vue
->
g
 =
BACNET_APPLICATION_TAG_NULL
) {

640 
	`rtf
(
dout
, "?\n ");

647 i(
vue
->
xt
 =
NULL
)

648 
	`rtf
(
dout
, "{ \n ");

650 
	`rtf
(
dout
, "\n ");

653 i(
m_ݔty
->
ݔtyIdtifr
 =
PROP_OBJECT_LIST
) {

654 i(
vue
->
g
 !
BACNET_APPLICATION_TAG_OBJECT_ID
) {

655 
	`as
(
vue
->
g
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

660 
obje_li_emt
 =

661 
	`KEY_ENCODE
(
vue
->
ty
.
Obje_Id
.type,

662 
vue
->
ty
.
Obje_Id
.

);

665 
	`Keyli_Da_Add
(
Obje_Li
, 
obje_li_emt
, 
NULL
);

666 } i(
m_ݔty
->
ݔtyIdtifr
 =
PROP_STATE_TEXT
) {

669 i(
vue
->
ty
.
Cha_Sg
.
ngth
 > 31) {

670 
iLa15idx
 =

671 
vue
->
ty
.
Cha_Sg
.
ngth
 - 15;

672 
vue
->
ty
.
Cha_Sg
.value[15] = '-';

673 
	`memy
(&
vue
->
ty
.
Cha_Sg
.value[16],

674 &
vue
->
ty
.
Cha_Sg
.vue[
iLa15idx
],

676 
vue
->
ty
.
Cha_Sg
.value[31] = 0;

677 
vue
->
ty
.
Cha_Sg
.
ngth
 = 31;

679 } i(
m_ݔty
->
ݔtyIdtifr
 ==

680 
PROP_SUBORDINATE_LIST
) {

681 i(
vue
->
g
 !
BACNET_APPLICATION_TAG_OBJECT_ID
) {

682 
	`as
(
vue
->
g
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

686 
isSequ
 = 
ue
;

690 i(
isSequ
)

691 
	`rtf
(
dout
, "{");

692 
	`ba_t_vue
(
dout
, &
obje_vue
);

693 i(
isSequ
)

694 
	`rtf
(
dout
, "}");

696 i((
Wked_Li_Index
 < 
Wked_Li_Lgth
) ||

697 (
vue
->
xt
 !
NULL
)) {

699 
	`rtf
(
dout
, ", ");

700 i(!(
Wked_Li_Index
 % 4))

701 
	`rtf
(
dout
, "\n ");

703 
	`rtf
(
dout
, " } \n");

707 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

708 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

709 
	`PyPrtPrݔtyVue
(
dout
, &
obje_vue
);

713 
PROP_PROTOCOL_CONFORMANCE_CLASS
:

719 i(
ShowVues
 &&

720 (
obje_vue
.
vue
->
g
 =
BACNET_APPLICATION_TAG_DATE
)) {

723 
	`PyPrtPrݔtyVue
(
dout
, &
obje_vue
);

727 
m_ݔty
->
ݔtyIdtifr
) {

728 
PROP_DEVICE_ADDRESS_BINDING
:

731 i(
vue
->
g
 =
BACNET_APPLICATION_TAG_NULL
) {

732 
	`rtf
(
dout
, "?");

736 
PROP_DAYLIGHT_SAVINGS_STATUS
:

737 
PROP_LOCAL_TIME
:

738 
PROP_LOCAL_DATE
:

739 
PROP_PRESENT_VALUE
:

740 
PROP_PRIORITY_ARRAY
:

741 
PROP_RELIABILITY
:

742 
PROP_UTC_OFFSET
:

743 
PROP_DATABASE_REVISION
:

744 i(!
ShowVues
) {

745 
	`rtf
(
dout
, "?");

750 
	`ba_t_vue
(
dout
, &
obje_vue
);

754 i(
vue
->
xt
 !
NULL
) {

756 
	`rtf
(
dout
, ",");

758 i(
t_b
) {

760 
	`rtf
(
dout
, " }");

762 
	`CheckIsWrabPrݔty
(
obje_ty
,

763 
m_ݔty
);

764 
	`rtf
(
dout
, "\n");

769 
d_vue
 = 
vue
;

770 
vue
 = vue->
xt
;

771 
	`
(
d_vue
);

774 
	}
}

780 
	$Prt_Prݔty_Idtifr
(

781 
ݔtyIdtifr
)

783 i(
ݔtyIdtifr
 < 512) {

784 
	`rtf
(
dout
, "%s", 
	`baext_ݔty_me
(
ݔtyIdtifr
));

786 
	`rtf
(
dout
, "--rrry %u", 
ݔtyIdtifr
);

788 
	}
}

791 
	$BudPrReque
(

792 
BACNET_READ_ACCESS_DATA
 * 
m_obje
)

794 
i
;

798 
BACNET_PROPERTY_REFERENCE
 *
Ery
 = 
m_obje
->
liOfPrݔts
;

799 
BACNET_PROPERTY_REFERENCE
 *
dEry
 = 
m_obje
->
liOfPrݔts
;

800 
i
 = 0; 
Prݔty_Vue_Li
[i].
ݔty_id
 != -1; i++) {

801 i(
Ery
 =
NULL
) {

802 
Ery
 = 
	`oc
(1, (
BACNET_PROPERTY_REFERENCE
));

803 
	`as
(
Ery
);

804 
dEry
->
xt
 = 
Ery
;

806 
Ery
->
ݔtyIdtifr
 = 
Prݔty_Vue_Li
[
i
].
ݔty_id
;

807 
Ery
->
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

808 
Ery
->
xt
 = 
NULL
;

809 
dEry
 = 
Ery
;

810 
Ery
 = 
NULL
;

812 
	}
}

824 
ut8_t
 
	$Rd_Prݔts
(

825 
ut32_t
 
devi_
,

826 
BACNET_OBJECT_ID
 * 
pMyObje
)

828 
ut8_t
 
voke_id
 = 0;

829 
ecl_ݔty_li_t
 
PrݔtyLiSu
;

830 
i
 = 0, 
j
 = 0;

832 i((!
Has_RPM
 && (
Prݔty_Li_Index
 == 0)) ||

833 (
Prݔty_Li_Lgth
 == 0)) {

839 
	`ݔty_li_ecl
(
pMyObje
->
ty
, &
PrݔtyLiSu
);

840 i(
Oiڮ_Prݔts
) {

841 
Prݔty_Li_Lgth
 =

842 
PrݔtyLiSu
.
Requed
.
cou
 +

843 
PrݔtyLiSu
.
Oiڮ
.
cou
;

845 
Prݔty_Li_Lgth
 = 
PrݔtyLiSu
.
Requed
.
cou
;

847 i(
Prݔty_Li_Lgth
 > 
MAX_PROPS
) {

848 
Prݔty_Li_Lgth
 = 
MAX_PROPS
;

851 
i
 = 0; i < 
Prݔty_Li_Lgth
; i++) {

852 i(
i
 < 
PrݔtyLiSu
.
Requed
.
cou
) {

853 
Prݔty_Li
[
i
] = 
PrݔtyLiSu
.
Requed
.
pLi
[i];

854 } i(
Oiڮ_Prݔts
) {

855 
Prݔty_Li
[
i
] = 
PrݔtyLiSu
.
Oiڮ
.
pLi
[
j
];

856 
j
++;

860 
Prݔty_Li
[
i
] = -1;

862 i(
Prݔty_Li
[
Prݔty_Li_Index
] != -1) {

863 

 = 
Prݔty_Li
[
Prݔty_Li_Index
];

864 
ut32_t
 
y_dex
;

865 
IsLgAay
 = 
l
;

866 i(
Usg_Wked_Li
) {

867 i(
Wked_Li_Lgth
 == 0) {

868 
y_dex
 = 0;

870 
y_dex
 = 
Wked_Li_Index
;

873 
	`rtf
(
dout
, " ");

874 
	`Prt_Prݔty_Idtifr
(

);

875 
	`rtf
(
dout
, ": ");

876 
y_dex
 = 
BACNET_ARRAY_ALL
;

878 

) {

880 
PROP_OBJECT_LIST
:

881 
PROP_STATE_TEXT
:

882 
PROP_STRUCTURED_OBJECT_LIST
:

883 
PROP_SUBORDINATE_ANNOTATIONS
:

884 
PROP_SUBORDINATE_LIST
:

885 
IsLgAay
 = 
ue
;

889 
voke_id
 =

890 
	`Sd_Rd_Prݔty_Reque
(
devi_
, 
pMyObje
->
ty
,

891 
pMyObje
->

, 

, 
y_dex
);

895  
voke_id
;

896 
	}
}

909 
EPICS_STATES
 
	$ProssRPMDa
(

910 
BACNET_READ_ACCESS_DATA
 * 
m_da
,

911 
EPICS_STATES
 
myS
)

913 
BACNET_READ_ACCESS_DATA
 *
d_m_da
;

914 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

915 
BACNET_PROPERTY_REFERENCE
 *
d_m_ݔty
;

916 
BACNET_APPLICATION_DATA_VALUE
 *
vue
;

917 
BACNET_APPLICATION_DATA_VALUE
 *
d_vue
;

918 
bo
 
bSucss
 = 
ue
;

919 
EPICS_STATES
 
xtS
 = 
myS
;

922 
bo
 
bHasObjeLi
 = 
l
;

923 
bo
 
bHasSuudVwLi
 = 
l
;

924 
i
 = 0;

926 
m_da
) {

927 
m_ݔty
 = 
m_da
->
liOfPrݔts
;

928 
m_ݔty
) {

931 i(
myS
 =
GET_LIST_OF_ALL_RESPONSE
) {

932 
m_ݔty
->
ݔtyIdtifr
) {

933 
PROP_OBJECT_LIST
:

934 
bHasObjeLi
 = 
ue
;

936 
PROP_STRUCTURED_OBJECT_LIST
:

937 
bHasSuudVwLi
 = 
ue
;

940 
Prݔty_Li
[
Prݔty_Li_Index
] =

941 
m_ݔty
->
ݔtyIdtifr
;

942 
Prݔty_Li_Index
++;

943 
Prݔty_Li_Lgth
++;

947 
vue
 = 
m_ݔty
->value;

948 
vue
) {

949 
d_vue
 = 
vue
;

950 
vue
 = vue->
xt
;

951 
	`
(
d_vue
);

953 } i(
myS
 =
GET_HEADING_RESPONSE
) {

954 
Prݔty_Vue_Li
[
i
++].
vue
 = 
m_ݔty
->value;

959 
	`rtf
(
dout
, " ");

960 
	`Prt_Prݔty_Idtifr
(
m_ݔty
->
ݔtyIdtifr
);

961 
	`rtf
(
dout
, ": ");

962 
	`PrtRdPrݔtyDa
(
m_da
->
obje_ty
,

963 
m_da
->
obje_
, 
m_ݔty
);

965 
d_m_ݔty
 = 
m_ݔty
;

966 
m_ݔty
 =pm_ݔty->
xt
;

967 
	`
(
d_m_ݔty
);

969 
d_m_da
 = 
m_da
;

970 
m_da
 =pm_da->
xt
;

971 
	`
(
d_m_da
);

975 i(
myS
 =
GET_HEADING_RESPONSE
)

976 
xtS
 = 
PRINT_HEADING
;

978 i(
bSucss
 && (
myS
 =
GET_ALL_RESPONSE
))

979 
xtS
 = 
NEXT_OBJECT
;

980 i(
bSucss
) {

982 i(
bHasSuudVwLi
) {

983 
Prݔty_Li
[
Prݔty_Li_Index
] = 
PROP_STRUCTURED_OBJECT_LIST
;

984 
Prݔty_Li_Index
++;

985 
Prݔty_Li_Lgth
++;

987 i(
bHasObjeLi
) {

988 
Prݔty_Li
[
Prݔty_Li_Index
] = 
PROP_OBJECT_LIST
;

989 
Prݔty_Li_Index
++;

990 
Prݔty_Li_Lgth
++;

993 
Prݔty_Li
[
Prݔty_Li_Index
] = -1;

994 
	`as
(
Prݔty_Li_Lgth
 < 
MAX_PROPS
);

995 
Prݔty_Li_Index
 = 0;

996 
xtS
 = 
GET_PROPERTY_REQUEST
;

998  
xtS
;

999 
	}
}

1001 
	$PrtUge
(

1004 
tf


1006 
	`tf
("Usage: \n");

1007 
tf


1009 
	`tf
(" -v: show values instead of '?' \n");

1010 
tf


1012 
	`tf
(" Allows youo communicate withocalhostarget. \n");

1013 
tf


1015 
tf


1017 
	`tf
(" Use \"7F:00:00:01:BA:C0\" foroopbackesting \n");

1018 
	`tf
(" -n: specifyarget's DNET ifotocal BACnetetwork \n");

1019 
	`tf
(" or onouted Virtual Network \n");

1020 
	`tf
("\n");

1021 
tf


1023 
	`tf
("g, bacepics -v 2701876 >pics-2701876.tpi \n");

1024 
	`tf
("\n");

1025 
	`ex
(0);

1026 
	}
}

1028 
	$CheckCommdLeArgs
(

1029 
gc
,

1030 *
gv
[])

1032 
i
;

1033 
bo
 
bFoundTg
 = 
l
;

1037 i(
gc
 < 2) {

1038 
	`rtf
(
dout
, "Error: Mustrovide device-instance \n\n");

1039 
	`PrtUge
();

1041 
i
 = 1; i < 
gc
; i++) {

1042 *
Arg
 = 
gv
[
i
];

1043 i(
Arg
[0] == '-') {

1044 
Arg
[1]) {

1046 
Oiڮ_Prݔts
 = 
ue
;

1049 
ShowVues
 = 
ue
;

1052 i(++
i
 < 
gc
) {

1053 #i
	`defed
(
BACDL_BIP
)

1054 
My_BIP_Pt
 = (
ut16_t

	`
(
gv
[
i
], 
NULL
, 0);

1061 i(
Tg_Addss
.
mac_n
 == 0)

1062 
	`rtf
(
dr
,

1064 i(++
i
 < 
gc
)

1065 
Tg_Addss
.
t
 =

1066 (
ut16_t

	`
(
gv
[
i
], 
NULL
, 0);

1070 i(++
i
 < 
gc
) {

1072 
mac
[6];

1074 
cou
;

1076 
j
;

1077 
cou
 =

1078 
	`ssnf
(
gv
[
i
], "%2x:%2x:%2x:%2x:%2x:%2x", &
mac
[0],

1079 &
mac
[1], &mac[2], &mac[3], &mac[4], &mac[5]);

1080 i(
cou
 == 6) {

1081 
Tg_Addss
.
mac_n
 = 
cou
;

1082 
j
 = 0; j < 6; j++) {

1083 
Tg_Addss
.
mac
[
j
] = (
ut8_t
) mac[j];

1085 
Tg_Addss
.
t
 = 0;

1086 
Tg_Addss
.
n
 = 0;

1087 
Provided_Tg_MAC
 = 
ue
;

1090 
	`tf
("ERROR: invalid Target MAC %s \n",

1091 
gv
[
i
]);

1097 
	`PrtUge
();

1102 
Tg_Devi_Obje_In
 = 
	`
(
Arg
, 
NULL
, 0);

1103 i(
Tg_Devi_Obje_In
 > 
BACNET_MAX_INSTANCE
) {

1104 
	`rtf
(
dout
,

1106 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
 + 1);

1107 
	`PrtUge
();

1109 
bFoundTg
 = 
ue
;

1112 i(!
bFoundTg
) {

1113 
	`rtf
(
dout
, "Error: Mustrovide device-instance \n\n");

1114 
	`PrtUge
();

1118 
	}
}

1121 
	$PrtHdg
(

1124 
BACNET_APPLICATION_DATA_VALUE
 *
vue
 = 
NULL
;

1125 
BACNET_OBJECT_PROPERTY_VALUE
 
ݔty_vue
;

1127 
	`tf
("PICS 0\n");

1128 
	`tf
("BACnet Protocol Implementation Conformance Statement\n\n");

1130 
	`tf
("--\n--\n");

1131 
	`tf
("-- Generated by BACnet Protocol Stackibrary EPICSool\n");

1132 
	`tf
("-- BACnet/IP Interface for BACnet-stack Devices\n");

1133 
	`tf
("-- http://sourceforge.net/projects/bacnet/ \n");

1134 
	`tf
("-- \n--\n\n");

1135 
vue
 = 
	`obje_ݔty_vue
(
PROP_VENDOR_NAME
);

1136 i((
vue
 !
NULL
) &&

1137 (
vue
->
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
)) {

1138 
	`tf
("Vendor Name: \"%s\"\n",

1139 
	`charg_vue
(&
vue
->
ty
.
Cha_Sg
));

1141 
	`tf
("Vendor Name: \"your vendorame here\"\n");

1144 
vue
 = 
	`obje_ݔty_vue
(
PROP_MODEL_NAME
);

1146 i((
vue
 !
NULL
) &&

1147 (
vue
->
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
)) {

1148 
	`tf
("Product Name: \"%s\"\n",

1149 
	`charg_vue
(&
vue
->
ty
.
Cha_Sg
));

1150 
	`tf
("Product Model Number: \"%s\"\n",

1151 
	`charg_vue
(&
vue
->
ty
.
Cha_Sg
));

1153 
	`tf
("Product Name: \"yourroductame here\"\n");

1154 
	`tf
("Product Model Number: \"your modelumber here\"\n");

1157 
vue
 = 
	`obje_ݔty_vue
(
PROP_DESCRIPTION
);

1158 i((
vue
 !
NULL
) &&

1159 (
vue
->
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
)) {

1160 
	`tf
("Product Description: \"%s\"\n\n",

1161 
	`charg_vue
(&
vue
->
ty
.
Cha_Sg
));

1163 
	`tf
("Product Description: "

1166 
	`tf
("BIBBs Supported:\n");

1167 
	`tf
("{\n");

1168 
	`tf
(" DS-RP-B\n");

1169 
	`tf
("--ossible BIBBs inhis device\n");

1170 
	`tf
("-- DS-RPM-B\n");

1171 
	`tf
("-- DS-WP-B\n");

1172 
	`tf
("-- DM-DDB-B\n");

1173 
	`tf
("-- DM-DOB-B\n");

1174 
	`tf
("-- DM-DCC-B\n");

1175 
	`tf
("-- DM-RD-B\n");

1176 
	`tf
("-- DS-COV-A\n");

1177 
	`tf
("-- DS-COV-B\n");

1178 
	`tf
("-- AE-N-A\n");

1179 
	`tf
("-- AE-N-I-B\n");

1180 
	`tf
("-- AE-N-E-B\n");

1181 
	`tf
("-- AE-ACK-B\n");

1182 
	`tf
("-- AE-ACK-A\n");

1183 
	`tf
("-- DM-UTC-B\n");

1184 #ifde
BAC_ROUTING


1186 i(
Tg_Addss
.
t
 == 0)

1187 
	`tf
("-- NM-RC-B\n");

1189 
	`tf
("}\n\n");

1190 
	`tf
("BACnet Standard Application Services Supported:\n");

1191 
	`tf
("{\n");

1192 
vue
 = 
	`obje_ݔty_vue
(
PROP_PROTOCOL_SERVICES_SUPPORTED
);

1196 i((
vue
 !
NULL
&& (vue->
g
 =
BACNET_APPLICATION_TAG_BIT_STRING
)) {

1197 
i
, 
n
 = 
	`brg_bs_ud
(&
vue
->
ty
.
B_Sg
);

1198 
	`tf
("-- serviceseported byhis device\n");

1199 
i
 = 0; i < 
n
; i++) {

1200 i(
	`brg_b
(&
vue
->
ty
.
B_Sg
, (
ut8_t

i
))

1201 
	`tf
(" %s\n", 
	`oc_rvis_su܋d_xt
(
i
));

1204 
	`tf
("-- use \'Initiate\' or \'Execute\' or both for services.\n");

1205 
	`tf
(" ReadProperty Execute\n");

1206 
	`tf
("-- ReadPropertyMultiple Initiate Execute\n");

1207 
	`tf
("-- WriteProperty Initiate Execute\n");

1208 
	`tf
("-- DeviceCommunicationControl Initiate Execute\n");

1209 
	`tf
("-- Who-Has Initiate Execute\n");

1210 
	`tf
("-- I-Have Initiate Execute\n");

1211 
	`tf
("-- Who-Is Initiate Execute\n");

1212 
	`tf
("-- I-Am Initiate Execute\n");

1213 
	`tf
("-- ReinitializeDevice Initiate Execute\n");

1214 
	`tf
("-- AcknowledgeAlarm Initiate Execute\n");

1215 
	`tf
("-- ConfirmedCOVNotification Initiate Execute\n");

1216 
	`tf
("-- UnconfirmedCOVNotification Initiate Execute\n");

1217 
	`tf
("-- ConfirmedEventNotification Initiate Execute\n");

1218 
	`tf
("-- UnconfirmedEventNotification Initiate Execute\n");

1219 
	`tf
("-- GetAlarmSummary Initiate Execute\n");

1220 
	`tf
("-- GetEnrollmentSummary Initiate Execute\n");

1221 
	`tf
("-- WritePropertyMultiple Initiate Execute\n");

1222 
	`tf
("-- ReadRange Initiate Execute\n");

1223 
	`tf
("-- GetEventInformation Initiate Execute\n");

1224 
	`tf
("-- SubscribeCOVProperty Initiate Execute\n");

1225 #ifde
BAC_ROUTING


1226 i(
Tg_Addss
.
t
 == 0) {

1227 
tf


1229 
	`tf
("-- Who-Is-Router-To-Network Initiate Execute\n");

1230 
	`tf
("-- I-Am-Router-To-Network Initiate Execute\n");

1231 
	`tf
("-- Initialize-Routing-Table Execute\n");

1232 
	`tf
("-- Initialize-Routing-Table-Ack Initiate\n");

1236 
	`tf
("}\n\n");

1238 
	`tf
("Standard Object-Types Supported:\n");

1239 
	`tf
("{\n");

1240 
vue
 = 
	`obje_ݔty_vue
(
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
);

1244 i((
vue
 !
NULL
&& (vue->
g
 =
BACNET_APPLICATION_TAG_BIT_STRING
)) {

1245 
i
, 
n
 = 
	`brg_bs_ud
(&
vue
->
ty
.
B_Sg
);

1246 
	`tf
("-- objectseported byhis device\n");

1247 
i
 = 0; i < 
n
; i++) {

1248 i(
	`brg_b
(&
vue
->
ty
.
B_Sg
, (
ut8_t

i
))

1249 
	`tf
(" %s\n", 
	`baext_obje_ty_me
(
i
));

1252 
	`tf
("--ossible objects inhis device\n");

1253 
	`tf
("-- use \'Createable\' or \'Deleteable\' or both orone.\n");

1254 
	`tf
("-- Analog Input Createable Deleteable\n");

1255 
	`tf
("-- Analog Output Createable Deleteable\n");

1256 
	`tf
("-- Analog Value Createable Deleteable\n");

1257 
	`tf
("-- Binary Input Createable Deleteable\n");

1258 
	`tf
("-- Binary Output Createable Deleteable\n");

1259 
	`tf
("-- Binary Value Createable Deleteable\n");

1260 
	`tf
("-- Device Createable Deleteable\n");

1261 
	`tf
("-- Multi-state Input Createable Deleteable\n");

1262 
	`tf
("-- Multi-state Output Createable Deleteable\n");

1263 
	`tf
("-- Multi-state Value Createable Deleteable\n");

1264 
	`tf
("-- Structured View Createable Deleteable\n");

1265 
	`tf
("-- Characterstring Value\n");

1266 
	`tf
("-- Datetime Value\n");

1267 
	`tf
("-- Integer Value\n");

1268 
	`tf
("-- Positive Integer Value\n");

1269 
	`tf
("-- Trend Log\n");

1270 
	`tf
("-- Load Control\n");

1271 
	`tf
("-- Bitstring Value\n");

1272 
	`tf
("-- Date Pattern Value\n");

1273 
	`tf
("-- Date Value\n");

1274 
	`tf
("-- Datetime Pattern Value\n");

1275 
	`tf
("-- Large Analog Value\n");

1276 
	`tf
("-- Octetstring Value\n");

1277 
	`tf
("-- Time Pattern Value\n");

1278 
	`tf
("-- Time Value\n");

1280 
	`tf
("}\n\n");

1282 
	`tf
("Data Link Layer Option:\n");

1283 
	`tf
("{\n");

1284 
	`tf
("-- choosehe dataink options supported\n");

1285 
	`tf
("-- ISO 8802-3, 10BASE5\n");

1286 
	`tf
("-- ISO 8802-3, 10BASE2\n");

1287 
	`tf
("-- ISO 8802-3, 10BASET\n");

1288 
	`tf
("-- ISO 8802-3, fiber\n");

1289 
	`tf
("-- ARCNET, coax star\n");

1290 
	`tf
("-- ARCNET, coax bus\n");

1291 
	`tf
("-- ARCNET,wistedair star \n");

1292 
	`tf
("-- ARCNET,wistedair bus\n");

1293 
	`tf
("-- ARCNET, fiber star\n");

1294 
	`tf
("-- ARCNET,wistedair, EIA-485, Baudate(s): 156000\n");

1295 
	`tf
("-- MS/TP master. Baudate(s): 9600, 38400\n");

1296 
	`tf
("-- MS/TP slave. Baudate(s): 9600, 38400\n");

1297 
	`tf
("-- Point-To-Point. EIA 232, Baudate(s): 9600\n");

1298 
	`tf
("-- Point-To-Point. Modem, Baudate(s): 9600\n");

1299 
	`tf
("-- Point-To-Point. Modem, Baudate(s): 9600o 115200\n");

1300 
	`tf
("-- BACnet/IP, 'DIX' Ethernet\n");

1301 
	`tf
("-- BACnet/IP, Other\n");

1302 
	`tf
("-- Other\n");

1303 
	`tf
("}\n\n");

1305 
	`tf
("Character Sets Supported:\n");

1306 
	`tf
("{\n");

1307 
	`tf
("-- chooseny character sets supported\n");

1308 
	`tf
("-- ANSI X3.4\n");

1309 
	`tf
("-- IBM/Microsoft DBCS\n");

1310 
	`tf
("-- JIS C 6226\n");

1311 
	`tf
("-- ISO 8859-1\n");

1312 
	`tf
("-- ISO 10646 (UCS-4)\n");

1313 
	`tf
("-- ISO 10646 (UCS2)\n");

1314 
	`tf
("}\n\n");

1316 
	`tf
("Special Functionality:\n");

1317 
	`tf
("{\n");

1318 
vue
 = 
	`obje_ݔty_vue
(
PROP_MAX_APDU_LENGTH_ACCEPTED
);

1319 
	`tf
(" Maximum APDU size in octets: ");

1320 i(
vue
 !
NULL
) {

1321 
ݔty_vue
.
obje_ty
 = 
OBJECT_DEVICE
;

1322 
ݔty_vue
.
obje_
 = 0;

1323 
ݔty_vue
.
obje_ݔty
 = 
PROP_MAX_APDU_LENGTH_ACCEPTED
;

1324 
ݔty_vue
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1325 
ݔty_vue
.
vue
 = value;

1326 
	`ba_t_vue
(
dout
, &
ݔty_vue
);

1328 
	`tf
("?");

1330 
	`tf
("\n}\n\n");

1332 
	`tf
("List of Objects in Test Device:\n");

1334 
	`tf
("{\n");

1335 
	`tf
(" {\n");

1336 
	}
}

1340 
	$SNextObje
(

1341 
BACNET_READ_ACCESS_DATA
 * 
m_obje
,

1342 
BACNET_OBJECT_ID
 * 
pNewObje
)

1344 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

1345 
E_Deed
 = 
l
;

1346 
Prݔty_Li_Index
 = 
Prݔty_Li_Lgth
 = 0;

1347 
m_obje
->
obje_ty
 = 
pNewObje
->
ty
;

1348 
m_obje
->
obje_
 = 
pNewObje
->

;

1349 
m_ݔty
 = 
	`oc
(1, (
BACNET_PROPERTY_REFERENCE
));

1350 
m_obje
->
liOfPrݔts
 = 
m_ݔty
;

1351 
m_obje
->
xt
 = 
NULL
;

1352 
	`as
(
m_ݔty
);

1353 
m_ݔty
->
ݔtyIdtifr
 = 
PROP_ALL
;

1354 
m_ݔty
->
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

1355 
	}
}

1369 
	$ma
(

1370 
gc
,

1371 *
gv
[])

1373 
BACNET_ADDRESS
 
c
;

1374 
ut16_t
 
pdu_n
 = 0;

1375 
timeout
 = 100;

1376 
max_du
 = 0;

1377 
time_t
 
d_cds
 = 0;

1378 
time_t
 
ϡ_cds
 = 0;

1379 
time_t
 
cut_cds
 = 0;

1380 
time_t
 
timeout_cds
 = 0;

1381 
bo
 
found
 = 
l
;

1382 
BACNET_OBJECT_ID
 
myObje
;

1383 
ut8_t
 
bufr
[
MAX_PDU
] = { 0 };

1384 
BACNET_READ_ACCESS_DATA
 *
m_obje
 = 
NULL
;

1385 
KEY
 
xtKey
;

1387 
	`CheckCommdLeArgs
(
gc
, 
gv
);

1388 
	`memt
(&
c
, 0, (
BACNET_ADDRESS
));

1391 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

1392 
Obje_Li
 = 
	`Keyli_Ce
();

1393 #i
	`defed
(
BACDL_BIP
)

1398 i(
My_BIP_Pt
 > 0) {

1399 
	`b_t_pt
(
	`hts
(
My_BIP_Pt
));

1402 
	`addss_
();

1403 
	`In_Svi_Hdrs
();

1404 
	`dnv_
();

1405 
	`ex
(
dk_nup
);

1408 
cut_cds
 = 
	`time
(
NULL
);

1409 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

1411 #i
	`defed
(
BACDL_BIP
)

1412 i(
My_BIP_Pt
 > 0) {

1413 
	`b_t_pt
(
	`hts
(0xBAC0));

1417 
found
 =

1418 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

1419 &
Tg_Addss
);

1420 i(!
found
) {

1421 i(
Provided_Tg_MAC
) {

1422 i(
Tg_Addss
.
t
 > 0) {

1425 
	`Sd_WhoIs_Reme
(&
Tg_Addss
,

1426 
Tg_Devi_Obje_In
,

1427 
Tg_Devi_Obje_In
);

1431 i(
max_du
 == 0)

1432 
max_du
 = 
MAX_APDU
;

1433 
	`addss_add_bdg
(
Tg_Devi_Obje_In
, 
max_du
,

1434 &
Tg_Addss
);

1437 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

1438 
Tg_Devi_Obje_In
);

1441 
myObje
.
ty
 = 
OBJECT_DEVICE
;

1442 
myObje
.

 = 
Tg_Devi_Obje_In
;

1443 
myS
 = 
INITIAL_BINDING
;

1446 
ϡ_cds
 = 
cut_cds
;

1447 
cut_cds
 = 
	`time
(
NULL
);

1449 i(
cut_cds
 !
ϡ_cds
) {

1450 
	`tsm_tim_mlicds
((
ut16_t
((
cut_cds
 -

1451 
ϡ_cds
) * 1000));

1455 
myS
) {

1456 
INITIAL_BINDING
:

1458 
pdu_n
 =

1459 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

1462 i(
pdu_n
) {

1463 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

1466 
found
 =

1467 
	`addss_bd_que
(
Tg_Devi_Obje_In
,

1468 &
max_du
, &
Tg_Addss
);

1469 i(!
found
) {

1471 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

1472 i(
d_cds
 > 
timeout_cds
) {

1473 
	`rtf
(
dr
,

1476 
Tg_Devi_Obje_In
,

1477 (
d_cds
);

1483 
m_obje
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

1484 
	`as
(
m_obje
);

1485 
myS
 = 
GET_HEADING_INFO
;

1489 
GET_HEADING_INFO
:

1491 
ϡ_cds
 = 
cut_cds
;

1492 
	`SNextObje
(
m_obje
, &
myObje
);

1493 
	`BudPrReque
(
m_obje
);

1494 
Reque_Invoke_ID
 =

1495 
	`Sd_Rd_Prݔty_Muɝ_Reque
(
bufr
, 
MAX_PDU
,

1496 
Tg_Devi_Obje_In
, 
m_obje
);

1497 i(
Reque_Invoke_ID
 > 0) {

1498 
d_cds
 = 0;

1501 
	`rtf
(
dr
, "\r-- Failedo get Heading info \n");

1503 
myS
 = 
GET_HEADING_RESPONSE
;

1506 
PRINT_HEADING
:

1508 
	`PrtHdg
();

1509 
myS
 = 
GET_ALL_REQUEST
;

1512 
GET_ALL_REQUEST
:

1513 
GET_LIST_OF_ALL_REQUEST
:

1516 
ϡ_cds
 = 
cut_cds
;

1517 
	`SNextObje
(
m_obje
, &
myObje
);

1519 
Reque_Invoke_ID
 =

1520 
	`Sd_Rd_Prݔty_Muɝ_Reque
(
bufr
, 
MAX_PDU
,

1521 
Tg_Devi_Obje_In
, 
m_obje
);

1522 i(
Reque_Invoke_ID
 > 0) {

1523 
d_cds
 = 0;

1524 i(
myS
 =
GET_LIST_OF_ALL_REQUEST
)

1525 
myS
 = 
GET_LIST_OF_ALL_RESPONSE
;

1527 
myS
 = 
GET_ALL_RESPONSE
;

1531 
GET_HEADING_RESPONSE
:

1532 
GET_ALL_RESPONSE
:

1533 
GET_LIST_OF_ALL_RESPONSE
:

1535 
pdu_n
 =

1536 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

1539 i(
pdu_n
) {

1540 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

1543 i((
Rd_Prݔty_Muɝ_Da
.
w_da
) &&

1544 (
Reque_Invoke_ID
 ==

1545 
Rd_Prݔty_Muɝ_Da
.
rvi_da
.
voke_id
)) {

1546 
Rd_Prݔty_Muɝ_Da
.
w_da
 = 
l
;

1547 
myS
 =

1548 
	`ProssRPMDa
(
Rd_Prݔty_Muɝ_Da
.
m_da
,

1549 
myS
);

1550 i(
	`tsm_voke_id_
(
Reque_Invoke_ID
)) {

1551 
Reque_Invoke_ID
 = 0;

1553 
	`as
(
l
);

1554 
Reque_Invoke_ID
 = 0;

1556 
d_cds
 = 0;

1557 } i(
	`tsm_voke_id_
(
Reque_Invoke_ID
)) {

1558 
d_cds
 = 0;

1559 
Reque_Invoke_ID
 = 0;

1560 i(
myS
 =
GET_HEADING_RESPONSE
)

1561 
myS
 = 
PRINT_HEADING
;

1563 i(
E_Deed
) {

1564 i(
La_E_Code
 ==

1565 
ERROR_CODE_REJECT_UNRECOGNIZED_SERVICE
) {

1568 
Has_RPM
 = 
l
;

1569 
myS
 = 
GET_PROPERTY_REQUEST
;

1570 } i(
La_E_Code
 ==

1571 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
) {

1572 
myS
 = 
GET_PROPERTY_REQUEST
;

1573 
	`SNextObje
(
m_obje
, &
myObje
);

1574 } i(
myS
 =
GET_ALL_RESPONSE
)

1576 
myS
 = 
GET_LIST_OF_ALL_REQUEST
;

1579 
myS
 = 
GET_PROPERTY_REQUEST
;

1580 
	`SNextObje
(
m_obje
, &
myObje
);

1582 } i(
Has_RPM
)

1583 
myS
 = 
GET_ALL_REQUEST
;

1585 
myS
 = 
GET_PROPERTY_REQUEST
;

1586 } i(
	`tsm_voke_id_ed
(
Reque_Invoke_ID
)) {

1587 
	`rtf
(
dr
, "\rError: TSM Timeout!\n");

1588 
	`tsm__voke_id
(
Reque_Invoke_ID
);

1589 
Reque_Invoke_ID
 = 0;

1590 
d_cds
 = 0;

1591 i(
myS
 =
GET_HEADING_RESPONSE
)

1592 
myS
 = 
PRINT_HEADING
;

1595 
myS
 = 
GET_ALL_REQUEST
;

1596 } i(
E_Deed
) {

1598 
d_cds
 = 0;

1599 
Reque_Invoke_ID
 = 0;

1600 i(
myS
 =
GET_HEADING_RESPONSE
)

1601 
myS
 = 
PRINT_HEADING
;

1604 
myS
 = 
NEXT_OBJECT
;

1605 
E_Cou
++;

1611 
GET_PROPERTY_REQUEST
:

1612 
E_Deed
 = 
l
;

1614 
ϡ_cds
 = 
cut_cds
;

1615 
d_cds
 = 0;

1616 
Reque_Invoke_ID
 =

1617 
	`Rd_Prݔts
(
Tg_Devi_Obje_In
, &
myObje
);

1618 i(
Reque_Invoke_ID
 == 0) {

1620 
myS
 = 
NEXT_OBJECT
;

1622 
myS
 = 
GET_PROPERTY_RESPONSE
;

1625 
GET_PROPERTY_RESPONSE
:

1627 
pdu_n
 =

1628 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

1631 i(
pdu_n
) {

1632 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

1635 i((
Rd_Prݔty_Muɝ_Da
.
w_da
) &&

1636 (
Reque_Invoke_ID
 ==

1637 
Rd_Prݔty_Muɝ_Da
.
rvi_da
.
voke_id
)) {

1638 
Rd_Prݔty_Muɝ_Da
.
w_da
 = 
l
;

1639 
	`PrtRdPrݔtyDa
(
Rd_Prݔty_Muɝ_Da
.

1640 
m_da
->
obje_ty
,

1641 
Rd_Prݔty_Muɝ_Da
.
m_da
->
obje_
,

1642 
Rd_Prݔty_Muɝ_Da
.
m_da
->

1643 
liOfPrݔts
);

1644 i(
	`tsm_voke_id_
(
Reque_Invoke_ID
)) {

1645 
Reque_Invoke_ID
 = 0;

1647 
	`as
(
l
);

1648 
Reque_Invoke_ID
 = 0;

1650 
d_cds
 = 0;

1652 i(
Usg_Wked_Li
) {

1653 
Wked_Li_Index
++;

1654 i(
Wked_Li_Index
 > 
Wked_Li_Lgth
) {

1656 
Prݔty_Li_Index
++;

1657 
Usg_Wked_Li
 = 
l
;

1660 
Prݔty_Li_Index
++;

1662 
myS
 = 
GET_PROPERTY_REQUEST
;

1663 } i(
	`tsm_voke_id_
(
Reque_Invoke_ID
)) {

1664 
Reque_Invoke_ID
 = 0;

1665 
d_cds
 = 0;

1666 
myS
 = 
GET_PROPERTY_REQUEST
;

1667 i(
E_Deed
) {

1668 i((
La_E_Css
 !
ERROR_CLASS_PROPERTY
) &&

1669 (
La_E_Code
 !
ERROR_CODE_UNKNOWN_PROPERTY
)) {

1670 i(
IsLgAay
) {

1672 
Usg_Wked_Li
 = 
ue
;

1673 
Wked_Li_Index
 = 
Wked_Li_Lgth
 = 0;

1676 
	`rtf
(
dout
, " -- Failedo get ");

1677 
	`Prt_Prݔty_Idtifr
(
Prݔty_Li


1678 [
Prݔty_Li_Index
]);

1679 
	`rtf
(
dout
, " \n");

1680 
E_Cou
++;

1681 
Prݔty_Li_Index
++;

1682 i(
Prݔty_Li_Index
 >=

1683 
Prݔty_Li_Lgth
) {

1685 
myS
 = 
NEXT_OBJECT
;

1689 
	`rtf
(
dout
, " -- unknownroperty\n");

1690 
E_Cou
++;

1691 
Prݔty_Li_Index
++;

1692 i(
Prݔty_Li_Index
 >
Prݔty_Li_Lgth
) {

1694 
myS
 = 
NEXT_OBJECT
;

1698 } i(
	`tsm_voke_id_ed
(
Reque_Invoke_ID
)) {

1699 
	`rtf
(
dr
, "\rError: TSM Timeout!\n");

1700 
	`tsm__voke_id
(
Reque_Invoke_ID
);

1701 
d_cds
 = 0;

1702 
Reque_Invoke_ID
 = 0;

1703 
myS
 = 3;

1704 } i(
E_Deed
) {

1706 
d_cds
 = 0;

1707 
Reque_Invoke_ID
 = 0;

1708 
myS
 = 
NEXT_OBJECT
;

1709 
E_Cou
++;

1713 
NEXT_OBJECT
:

1714 i(
myObje
.
ty
 =
OBJECT_DEVICE
) {

1715 
	`tf
(" -- Found %d Objects \n",

1716 
	`Keyli_Cou
(
Obje_Li
));

1717 
Obje_Li_Index
 = -1;

1721 
Obje_Li_Index
++;

1722 i(
Obje_Li_Index
 < 
	`Keyli_Cou
(
Obje_Li
)) {

1723 
xtKey
 = 
	`Keyli_Key
(
Obje_Li
, 
Obje_Li_Index
);

1724 
myObje
.
ty
 = 
	`KEY_DECODE_TYPE
(
xtKey
);

1725 
myObje
.

 = 
	`KEY_DECODE_ID
(
xtKey
);

1727 i(
myObje
.
ty
 =
OBJECT_DEVICE
)

1730 
	`tf
(" }, \n");

1732 
	`tf
(" { \n");

1739 
	`tf
(" } \n");

1741 
myObje
.
ty
 = 
MAX_BACNET_OBJECT_TYPE
;

1743 i(
Has_RPM
)

1744 
myS
 = 
GET_ALL_REQUEST
;

1746 
myS
 = 
GET_PROPERTY_REQUEST
;

1747 
	`SNextObje
(
m_obje
, &
myObje
);

1750 } 
myObje
.
ty
 =
OBJECT_DEVICE
);

1755 
	`as
(
l
);

1760 i(!
found
 || (
Reque_Invoke_ID
 > 0)) {

1762 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

1763 i(
d_cds
 > 
timeout_cds
) {

1764 
	`rtf
(
dr
, "\rError: APDU Timeout! (%lds)\n",

1765 (
d_cds
);

1770 } 
myObje
.
ty
 < 
MAX_BACNET_OBJECT_TYPE
);

1772 i(
E_Cou
 > 0)

1773 
	`rtf
(
dout
, "\r-- Found %d Eܠ\n", 
E_Cou
);

1776 i(
myS
 !
INITIAL_BINDING
) {

1777 
	`tf
("} \n");

1778 
tf


1780 
	`tf
("\n");

1784 
	}
}

	@demo/gateway/gateway.h

26 #ide
GATEWAY_H_


27 
	#GATEWAY_H_


	)

40 
	#FIRST_DEVICE_NUMBER
 260001

	)

41 
	#VIRTUAL_DNET
 2709

	)

42 
	#DEV_NAME_BASE
 "Geway DemDevi"

	)

43 
	#DEV_DESCR_GATEWAY
 "Geway Devind Rour"

	)

44 
	#DEV_DESCR_REMOTE
 "Roud RemِDevi"

	)

	@demo/gateway/main.c

30 
	~<ddef.h
>

31 
	~<dt.h
>

32 
	~<dio.h
>

33 
	~<dlib.h
>

34 
	~<sigl.h
>

35 
	~<time.h
>

36 
	~"cfig.h
"

37 
	~"geway.h
"

38 
	~"addss.h
"

39 
	~"bacdef.h
"

40 
	~"hdrs.h
"

41 
	~".h
"

42 
	~"dnv.h
"

43 
	~"bacdcode.h
"

44 
	~"du.h
"

45 
	~"du.h
"

46 
	~"m.h
"

47 
	~"tsm.h
"

48 
	~"devi.h
"

49 
	~"bacfe.h
"

50 
	~"dk.h
"

51 
	~"dcc.h
"

52 
	~"t.h
"

53 
	~"txbuf.h
"

54 
	~"lc.h
"

55 
	~"debug.h
"

56 
	~"vsi.h
"

58 
	~"devi.h
"

59 #ifde
BACNET_TEST_VMAC


60 
	~"vmac.h
"

73 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

78 
	gDNET_li
[2] = {

79 
VIRTUAL_DNET
, -1

88 
	$Devis_In
(

89 
ut32_t
 
f_obje_
)

91 
i
;

92 
meText
[
MAX_DEV_NAME_LEN
];

93 
descText
[
MAX_DEV_DESC_LEN
];

94 
BACNET_CHARACTER_STRING
 
me_rg
;

98 
	`Roud_Devi_S_Desti
(
DEV_DESCR_GATEWAY
,

99 
	`
(
DEV_DESCR_GATEWAY
));

102 
i
 = 1; i < 
MAX_NUM_DEVICES
; i++) {

103 #ifde
_MSC_VER


104 
	`_tf
(
meText
, 
MAX_DEV_NAME_LEN
, "%%d", 
DEV_NAME_BASE
, 
i
 + 1);

105 
	`_tf
(
descText
, 
MAX_DEV_DESC_LEN
, "%%d", 
DEV_DESCR_REMOTE
, 
i
);

107 
	`tf
(
meText
, 
MAX_DEV_NAME_LEN
, "%%d", 
DEV_NAME_BASE
, 
i
 + 1);

108 
	`tf
(
descText
, 
MAX_DEV_DESC_LEN
, "%%d", 
DEV_DESCR_REMOTE
, 
i
);

110 
	`charg__si
(&
me_rg
, 
meText
);

112 
	`Add_Roud_Devi
((
f_obje_
 + 
i
), &
me_rg
, 
descText
);

115 
	}
}

121 
	$In_Svi_Hdrs
(

122 
ut32_t
 
f_obje_
)

124 
	`Devi_In
(
NULL
);

125 
	`Routg_Devi_In
(
f_obje_
);

133 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
,

134 
hdr_who_is_uni
);

135 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_HAS
, 
hdr_who_has
);

138 
du_t_uecognized_rvi_hdr_hdr


139 (
hdr_uecognized_rvi
);

142 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

143 
hdr_ad_ݔty
);

144 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

145 
hdr_ad_ݔty_muɝ
);

146 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

147 
hdr_wre_ݔty
);

148 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_RANGE
,

149 
hdr_ad_nge
);

150 #i
	`defed
(
BACFILE
)

151 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_ATOMIC_READ_FILE
,

152 
hdr_omic_ad_fe
);

153 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
,

154 
hdr_omic_wre_fe
);

156 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

157 
hdr_lize_devi
);

158 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_UTC_TIME_SYNCHRONIZATION
,

159 
hdr_timesync_utc
);

160 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_TIME_SYNCHRONIZATION
,

161 
hdr_timesync
);

162 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_SUBSCRIBE_COV
,

163 
hdr_cov_subsibe
);

164 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_COV_NOTIFICATION
,

165 
hdr_ucov_nifiti
);

167 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

168 
hdr_devi_communiti_cڌ
);

169 
	}
}

179 
	$Inlize_Devi_Addss
(

182 
i
 = 0;

183 
ut32_t
 
vtu_mac
 = 0;

184 
DEVICE_OBJECT_DATA
 *
pDev
 = 
NULL
;

186 #i
	`defed
(
BACDL_BIP
)

187 
ut16_t
 
myPt
;

188 
_addr
 *
tP
;

189 
ut8_t
 *
gewayMac
 = 
NULL
;

190 
ut32_t
 
myAddr
 = 
	`b_g_addr
();

191 
pDev
 = 
	`G_Roud_Devi_Obje
(
i
);

192 
gewayMac
 = 
pDev
->
bacDevAddr
.
mac
;

193 
	`memy
(
pDev
->
bacDevAddr
.
mac
, &
myAddr
, 4);

194 
myPt
 = 
	`b_g_pt
();

195 
	`memy
(&
pDev
->
bacDevAddr
.
mac
[4], &
myPt
, 2);

196 
pDev
->
bacDevAddr
.
mac_n
 = 6;

197 #i
	`defed
(
BACDL_MSTP
)

199 
pDev
->
bacDevAddr
.
mac_n
 = 2;

204 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

206 
i
 = 1; i < 
MAX_NUM_DEVICES
; i++) {

207 
pDev
 = 
	`G_Roud_Devi_Obje
(
i
);

208 i(
pDev
 =
NULL
)

210 #i
	`defed
(
BACDL_BIP
)

211 
vtu_mac
 = 
i
;

212 
tP
 = (
_addr
 *
pDev
->
bacDevAddr
.
mac
;

213 #i(
MAX_NUM_DEVICES
 > 0xFFFFFF)

214 
pDev
->
bacDevAddr
.
mac
[0] = ((
vtu_mac
 & 0xff000000) >> 24);

216 
pDev
->
bacDevAddr
.
mac
[0] = 
gewayMac
[3];

218 #i(
MAX_NUM_DEVICES
 > 0xFFFF)

219 
pDev
->
bacDevAddr
.
mac
[1] = ((
vtu_mac
 & 0xff0000) >> 16);

221 
pDev
->
bacDevAddr
.
mac
[1] = 
gewayMac
[2];

223 #i(
MAX_NUM_DEVICES
 > 0xFF)

224 
pDev
->
bacDevAddr
.
mac
[2] = ((
vtu_mac
 & 0xff00) >> 8);

226 
pDev
->
bacDevAddr
.
mac
[2] = 
gewayMac
[1];

228 
pDev
->
bacDevAddr
.
mac
[3] = (
vtu_mac
 & 0xff);

229 
	`memy
(&
pDev
->
bacDevAddr
.
mac
[4], &
myPt
, 2);

230 
pDev
->
bacDevAddr
.
mac_n
 = 6;

231 
pDev
->
bacDevAddr
.
t
 = 
VIRTUAL_DNET
;

232 
	`memy
(&
pDev
->
bacDevAddr
.
adr
[0], &pDev->bacDevAddr.
mac
[0], 6);

233 
pDev
->
bacDevAddr
.
n
 = 6;

234 
	`tf
(" - Roud devi [%d] ID %u%\n", 
i
,

235 
pDev
->
bacObj
.
Obje_In_Numb
, 
	`_
(*
tP
));

236 #i
	`defed
(
BACDL_MSTP
)

238 
pDev
->
bacDevAddr
.
mac_n
 = 2;

241 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

244 
	}
}

258 
	$ma
(

259 
gc
,

260 *
gv
[])

262 
BACNET_ADDRESS
 
c
 = {

265 
ut16_t
 
pdu_n
 = 0;

266 
timeout
 = 1000;

267 
time_t
 
ϡ_cds
 = 0;

268 
time_t
 
cut_cds
 = 0;

269 
ut32_t
 
d_cds
 = 0;

270 
ut32_t
 
d_mlicds
 = 0;

271 
ut32_t
 
f_obje_
 = 
FIRST_DEVICE_NUMBER
;

272 #ifde
BACNET_TEST_VMAC


274 
BACNET_DEVICE_PROFILE
 *
devi
;

275 
BACNET_VMAC_ADDRESS
 
adr
;

279 i(
gc
 > 1) {

280 
f_obje_
 = 
	`
(
gv
[1], 
NULL
, 0);

281 i((
f_obje_
 == 0) ||

282 (
f_obje_
 >
BACNET_MAX_INSTANCE
)) {

283 
	`tf
("E: Invid Obje In %\n", 
gv
[1]);

284 
	`tf
("Provideumber from 1o %ul \n",

285 
BACNET_MAX_INSTANCE
 - 1);

286 
	`ex
(1);

289 
	`tf
("BACnet Router Demo\n" "BACnet Stack Version %s\n"

290 "BACÈDevi ID: %u\n" "Max APDU: %d\n", 
BACt_Vsi
,

291 
f_obje_
, 
MAX_APDU
);

292 
	`In_Svi_Hdrs
(
f_obje_
);

293 
	`dnv_
();

294 
	`ex
(
dk_nup
);

295 
	`Devis_In
(
f_obje_
);

296 
	`Inlize_Devi_Addss
();

298 #ifde
BACNET_TEST_VMAC


300 
devi
 = 
	`vmac_lize
(99, 2001);

301 
	`debug_tf
(
devi
->
me
, "ROUTER:%u", 
	`vmac_g_subt
());

304 
ϡ_cds
 = 
	`time
(
NULL
);

307 
	`tf
("RemِNwk DNET Numb %d \n", 
DNET_li
[0]);

308 
	`Sd_I_Am_Rour_To_Nwk
(
DNET_li
);

313 
cut_cds
 = 
	`time
(
NULL
);

316 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

319 i(
pdu_n
) {

320 
	`routg_du_hdr
(&
c
, 
DNET_li
, &
Rx_Buf
[0], 
pdu_n
);

323 
d_cds
 = 
cut_cds
 - 
ϡ_cds
;

324 i(
d_cds
) {

325 
ϡ_cds
 = 
cut_cds
;

326 
	`dcc_tim_cds
(
d_cds
);

327 #i
	`defed
(
BACDL_BIP
&& 
BBMD_ENABLED


328 
	`bvlc_man_tim
(
d_cds
);

330 
	`dnv_man_tim
(
d_cds
);

331 
	`Ld_Cڌ_S_Mache_Hdr
();

332 
d_mlicds
 = 
d_cds
 * 1000;

333 
	`hdr_cov_sk
();

334 
	`tsm_tim_mlicds
(
d_mlicds
);

342 
	}
}

	@demo/handler/dlenv.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~"cfig.h
"

32 
	~"bacdef.h
"

33 
	~"du.h
"

34 
	~"dk.h
"

35 
	~"hdrs.h
"

36 
	~"dnv.h
"

37 
	~"tsm.h
"

41 #i
defed
(
BACDL_BIP
)

43 
ut16_t
 
	gBBMD_Tim_Secds
;

45 
	gbbmd_timive_cds
 = 60000;

46 
	gbbmd_pt
 = 0xBAC0;

47 
	gbbmd_addss
 = 0;

48 
	gbbmd_mask
 = 0xFFFFFFFF;

49 
	gbbmd_su
 = 0;

50 
BBMD_TABLE_ENTRY
 
	gBBMD_Tab_Ery
;

61 
	$dnv_bbmd_addss_t
(

62 
addss
)

64 
bbmd_addss
 = 
addss
;

65 
	}
}

71 
	$dnv_bbmd_pt_t
(

72 
pt
)

74 
bbmd_pt
 = 
pt
;

75 
	}
}

81 
	$dnv_bbmd_l_t
(

82 
l_cs
)

84 
bbmd_timive_cds
 = 
l_cs
;

85 
	}
}

95 
	$dnv_bbmd_su
(

98 i((
bbmd_su
 > 0) &&

99 (
	`bvlc_g_ϡ_su
(=
BVLC_RESULT_REGISTER_FOREIGN_DEVICE_NAK
))

102  
bbmd_su
;

103 
	}
}

120 
	$dnv_gi_as_feign_devi
(

123 
tv
 = 0;

124 #i
	`defed
(
BACDL_BIP
)

125 *
pEnv
 = 
NULL
;

126 
a
[4] = {0};

127 
bbmd_v
[32] = "";

128 
y_numb
 = 0;

129 
c
;

131 
pEnv
 = 
	`gv
("BACNET_BBMD_PORT");

132 i(
pEnv
) {

133 
bbmd_pt
 = 
	`
(
pEnv
, 
NULL
, 0);

134 i(
bbmd_pt
 > 0xFFFF) {

135 
bbmd_pt
 = 0xBAC0;

138 
pEnv
 = 
	`gv
("BACNET_BBMD_TIMETOLIVE");

139 i(
pEnv
) {

140 
bbmd_timive_cds
 = 
	`
(
pEnv
, 
NULL
, 0);

141 i(
bbmd_timive_cds
 > 0xFFFF) {

142 
bbmd_timive_cds
 = 0xFFFF;

145 
pEnv
 = 
	`gv
("BACNET_BBMD_ADDRESS");

146 i(
pEnv
) {

147 
bbmd_addss
 = 
	`b_gaddrbyme
(
pEnv
);

149 i(
bbmd_addss
) {

150 
_addr
 
addr
;

151 
addr
.
s_addr
 = 
bbmd_addss
;

152 
	`rtf
(
dr
, "Registering with BBMDt %s:%ld for %ld seconds\n",

153 
	`_
(
addr
), 
bbmd_pt
, 
bbmd_timive_cds
);

154 
tv
 =

155 
	`bvlc_gi_wh_bbmd
(
bbmd_addss
, 
	`hts
((
ut16_t

bbmd_pt
),

156 (
ut16_t

bbmd_timive_cds
);

157 i(
tv
 < 0)

158 
	`rtf
(
dr
, "FAILEDo Register with BBMDt %s \n",

159 
	`_
(
addr
));

160 
BBMD_Tim_Secds
 = (
ut16_t

bbmd_timive_cds
;

162 
y_numb
 = 1;ntry_number <= 128;ntry_number++) {

163 
	`rtf
(
bbmd_v
,"BACNET_BDT_ADDR_%u", 
y_numb
);

164 
pEnv
 = 
	`gv
(
bbmd_v
);

165 i(
pEnv
) {

166 
bbmd_addss
 = 
	`b_gaddrbyme
(
pEnv
);

168 i(
bbmd_addss
) {

169 
bbmd_pt
 = 0xBAC0;

170 
	`rtf
(
bbmd_v
,"BACNET_BDT_PORT_%u", 
y_numb
);

171 
pEnv
 = 
	`gv
(
bbmd_v
);

172 i(
pEnv
) {

173 
bbmd_pt
 = 
	`
(
pEnv
, 
NULL
, 0);

174 i(
bbmd_pt
 > 0xFFFF) {

175 
bbmd_pt
 = 0xBAC0;

178 
bbmd_mask
 = 0xFFFFFFFF;

179 
	`rtf
(
bbmd_v
,"BACNET_BDT_MASK_%u", 
y_numb
);

180 
pEnv
 = 
	`gv
(
bbmd_v
);

181 i(
pEnv
) {

182 
c
 = 
	`ssnf
(
pEnv
, "%3u.%3u.%3u.%3u",

183 &
a
[0],&a[1],&a[2],&a[3]);

184 i(
c
 == 4) {

185 
bbmd_mask
 =

186 ((
a
[0]&0xFF)<<24)|((a[1]&0xFF)<<16)|

187 ((
a
[2]&0xFF)<<8)|(a[3]&0xFF);

190 
BBMD_Tab_Ery
.
vid
 = 
ue
;

191 
BBMD_Tab_Ery
.
de_addss
.
s_addr
 = 
bbmd_addss
;

192 
BBMD_Tab_Ery
.
de_pt
 = 
bbmd_pt
;

193 
BBMD_Tab_Ery
.
brd_mask
.
s_addr
 = 
bbmd_mask
;

194 
	`bvlc_add_bdt_y_lol
(&
BBMD_Tab_Ery
);

198 
bbmd_su
 = 
tv
;

200  
tv
;

201 
	}
}

209 
	$dnv_man_tim
(

210 
ut16_t
 
d_cds
)

212 #i
	`defed
(
BACDL_BIP
&& 
BBMD_ENABLED


213 
	`bvlc_man_tim
(
d_cds
);

215 #i
	`defed
(
BACDL_BIP6
&& 
BBMD6_ENABLED


216 
	`bvlc6_man_tim
(
d_cds
);

218 #i
	`defed
(
BACDL_BIP
)

219 i(
BBMD_Tim_Secds
) {

220 i(
BBMD_Tim_Secds
 <
d_cds
) {

221 
BBMD_Tim_Secds
 = 0;

223 
BBMD_Tim_Secds
 -
d_cds
;

225 i(
BBMD_Tim_Secds
 == 0) {

226 (
	`dnv_gi_as_feign_devi
();

230 
BBMD_Tim_Secds
 = (
ut16_t

bbmd_timive_cds
;

234 
	}
}

286 
	$dnv_
(

289 *
pEnv
 = 
NULL
;

291 #i
	`defed
(
BACDL_ALL
)

292 
pEnv
 = 
	`gv
("BACNET_DATALINK");

293 i(
pEnv
) {

294 
	`dk_t
(
pEnv
);

296 
	`dk_t
(
NULL
);

299 #i
	`defed
(
BACDL_BIP6
)

300 
BACNET_IP6_ADDRESS
 
addr
;

301 
pEnv
 = 
	`gv
("BACNET_BIP6_BROADCAST");

302 i(
pEnv
) {

303 
	`bvlc6_addss_t
(&
addr
,

304 (
ut16_t

	`
(
pEnv
, 
NULL
, 0), 0, 0, 0, 0, 0, 0,

305 
BIP6_MULTICAST_GROUP_ID
);

306 
	`b6_t_brd_addr
(&
addr
);

308 
	`bvlc6_addss_t
(&
addr
,

309 
BIP6_MULTICAST_SITE_LOCAL
, 0, 0, 0, 0, 0, 0,

310 
BIP6_MULTICAST_GROUP_ID
);

311 
	`b6_t_brd_addr
(&
addr
);

313 
pEnv
 = 
	`gv
("BACNET_BIP6_PORT");

314 i(
pEnv
) {

315 
	`b6_t_pt
((
ut16_t

	`
(
pEnv
, 
NULL
, 0));

317 
	`b6_t_pt
(0xBAC0);

320 #i
	`defed
(
BACDL_BIP
)

321 #i
	`defed
(
BIP_DEBUG
)

322 
BIP_Debug
 = 
ue
;

324 
pEnv
 = 
	`gv
("BACNET_IP_PORT");

325 i(
pEnv
) {

326 
	`b_t_pt
(
	`hts
((
ut16_t

	`
(
pEnv
, 
NULL
, 0)));

334 i(
	`ohs
(
	`b_g_pt
()) < 1024)

335 
	`b_t_pt
(
	`hts
(0xBAC0));

337 
pEnv
 = 
	`gv
("BACNET_IP_NAT_ADDR");

338 i(
pEnv
) {

339 
_addr
 
t_addr
;

340 
t_addr
.
s_addr
 = 
	`b_gaddrbyme
(
pEnv
);

341 i(
t_addr
.
s_addr
) {

342 
	`bvlc_t_glob_addss_f_t
(&
t_addr
);

345 #i
	`defed
(
BACDL_MSTP
)

346 
pEnv
 = 
	`gv
("BACNET_MAX_INFO_FRAMES");

347 i(
pEnv
) {

348 
	`dlmp_t_max_fo_ames
(
	`
(
pEnv
, 
NULL
, 0));

350 
	`dlmp_t_max_fo_ames
(1);

352 
pEnv
 = 
	`gv
("BACNET_MAX_MASTER");

353 i(
pEnv
) {

354 
	`dlmp_t_max_ma
(
	`
(
pEnv
, 
NULL
, 0));

356 
	`dlmp_t_max_ma
(127);

358 
pEnv
 = 
	`gv
("BACNET_MSTP_BAUD");

359 i(
pEnv
) {

360 
	`dlmp_t_baud_
(
	`
(
pEnv
, 
NULL
, 0));

362 
	`dlmp_t_baud_
(38400);

364 
pEnv
 = 
	`gv
("BACNET_MSTP_MAC");

365 i(
pEnv
) {

366 
	`dlmp_t_mac_addss
(
	`
(
pEnv
, 
NULL
, 0));

368 
	`dlmp_t_mac_addss
(127);

371 
pEnv
 = 
	`gv
("BACNET_APDU_TIMEOUT");

372 i(
pEnv
) {

373 
	`du_timeout_t
((
ut16_t

	`
(
pEnv
, 
NULL
, 0));

375 #i
	`defed
(
BACDL_MSTP
)

376 
	`du_timeout_t
(60000);

379 
pEnv
 = 
	`gv
("BACNET_APDU_RETRIES");

380 i(
pEnv
) {

381 
	`du_s_t
((
ut8_t

	`
(
pEnv
, 
NULL
, 0));

384 i(!
	`dk_
(
	`gv
("BACNET_IFACE"))) {

385 
	`ex
(1);

387 #i(
MAX_TSM_TRANSACTIONS
)

388 
pEnv
 = 
	`gv
("BACNET_INVOKE_ID");

389 i(
pEnv
) {

390 
	`tsm_vokeID_t
((
ut8_t

	`
(
pEnv
, 
NULL
, 0));

393 
	`dnv_gi_as_feign_devi
();

394 
	}
}

	@demo/handler/h_alarm_ack.c

26 
	~<ddef.h
>

27 
	~<dt.h
>

28 
	~<dio.h
>

29 
	~<rg.h
>

30 
	~<o.h
>

32 
	~"cfig.h
"

33 
	~"txbuf.h
"

34 
	~"bacdef.h
"

35 
	~"bacdcode.h
"

36 
	~"ba.h
"

37 
	~"baext.h
"

38 
	~"du.h
"

39 
	~"du.h
"

40 
	~"abt.h
"

41 
	~"m_ack.h
"

42 
	~"hdrs.h
"

43 
	~"devi.h
"

48 
m_ack_funi
 
	gArm_Ack
[
MAX_BACNET_OBJECT_TYPE
];

50 
	$hdr_m_ack_t
(

51 
BACNET_OBJECT_TYPE
 
obje_ty
,

52 
m_ack_funi
 
pFuni
)

54 i(
obje_ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

55 
Arm_Ack
[
obje_ty
] = 
pFuni
;

57 
	}
}

75 
	$hdr_m_ack
(

76 
ut8_t
 * 
rvi_que
,

77 
ut16_t
 
rvi_n
,

78 
BACNET_ADDRESS
 * 
c
,

79 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

81 
n
 = 0;

82 
pdu_n
 = 0;

83 
bys_
 = 0;

84 
ack_su
 = 0;

85 
BACNET_ADDRESS
 
my_addss
;

86 
BACNET_NPDU_DATA
 
du_da
;

87 
BACNET_ALARM_ACK_DATA
 
da
;

88 
BACNET_ERROR_CODE
 
r_code
;

91 
	`dk_g_my_addss
(&
my_addss
);

92 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

93 
pdu_n
 =

94 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

95 &
du_da
);

96 i(
rvi_da
->
gmd_mesge
) {

98 
n
 =

99 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

100 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

101 
ue
);

102 #i
PRINT_ENABLED


103 
	`rtf
(
dr
, "Alarm Ack: Segmented message. Sending Abort!\n");

105 
AA_ABORT
;

108 
n
 =

109 
	`m_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

110 #i
PRINT_ENABLED


111 i(
n
 <= 0)

112 
	`rtf
(
dr
, "Alarm Ack: Unableo decode Request!\n");

114 i(
n
 < 0) {

116 
n
 =

117 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

118 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

119 #i
PRINT_ENABLED


120 
	`rtf
(
dr
, "Alarm Ack: Bad Encoding. Sending Abort!\n");

122 
AA_ABORT
;

124 #i
PRINT_ENABLED


125 
	`rtf
(
dr
,

127 
da
.
evtObjeIdtifr
.
ty
,

128 (
da
.
evtObjeIdtifr
.

,

129 
da
.
ackSour
.
vue
, (da.
ackProssIdtifr
);

132 i(!
	`Devi_Vid_Obje_Id
(
da
.
evtObjeIdtifr
.
ty
, da.evtObjeIdtifr.

))

134 
n
 =

135 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

136 
rvi_da
->
voke_id
,

137 
SERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
, 
ERROR_CLASS_OBJECT
, 
ERROR_CODE_UNKNOWN_OBJECT
);

139 i(
Arm_Ack
[
da
.
evtObjeIdtifr
.
ty
]) {

140 
ack_su
 =

141 
Arm_Ack
[
da
.
evtObjeIdtifr
.
ty
] (&da, &
r_code
);

143 
ack_su
) {

145 
n
 =

146 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

147 
rvi_da
->
voke_id
,

148 
SERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
);

149 #i
PRINT_ENABLED


150 
	`rtf
(
dr
, "Alarm Acknowledge: " "Sending Simple Ack!\n");

155 
n
 =

156 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

157 
rvi_da
->
voke_id
,

158 
SERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
, 
ERROR_CLASS_OBJECT
,

159 
r_code
);

160 #i
PRINT_ENABLED


161 
	`rtf
(
dr
, "Alarm Acknowledge:rror %s!\n",

162 
	`baext_r_code_me
(
r_code
));

167 
n
 =

168 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

169 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

170 #i
PRINT_ENABLED


171 
	`rtf
(
dr
, "Alarm Acknowledge:bort other!\n");

176 
n
 =

177 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

178 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
,

179 
ERROR_CLASS_OBJECT
, 
ERROR_CODE_NO_ALARM_CONFIGURED
);

180 #i
PRINT_ENABLED


181 
	`rtf
(
dr
, "Alarm Acknowledge:rror %s!\n",

182 
	`baext_r_code_me
(
ERROR_CODE_NO_ALARM_CONFIGURED
));

187 
AA_ABORT
:

188 
pdu_n
 +
n
;

189 
bys_
 =

190 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

191 
pdu_n
);

192 #i
PRINT_ENABLED


193 i(
bys_
 <= 0)

194 
	`rtf
(
dr
, "Alarm Acknowledge: " "Failedo send PDU (%s)!\n",

195 
	`
(
o
));

199 
	}
}

	@demo/handler/h_arf.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"ba.h
"

34 
	~"bacdcode.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~"f.h
"

40 #i
defed
(
BACFILE
)

41 
	~"bacfe.h
"

43 
	~"hdrs.h
"

98 #i
defed
(
BACFILE
)

99 
	$hdr_omic_ad_fe
(

100 
ut8_t
 * 
rvi_que
,

101 
ut16_t
 
rvi_n
,

102 
BACNET_ADDRESS
 * 
c
,

103 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

105 
BACNET_ATOMIC_READ_FILE_DATA
 
da
;

106 
n
 = 0;

107 
pdu_n
 = 0;

108 
bo
 
r
 = 
l
;

109 
bys_
 = 0;

110 
BACNET_NPDU_DATA
 
du_da
;

111 
BACNET_ADDRESS
 
my_addss
;

112 
BACNET_ERROR_CLASS
 
r_ass
 = 
ERROR_CLASS_OBJECT
;

113 
BACNET_ERROR_CODE
 
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

115 #i
PRINT_ENABLED


116 
	`rtf
(
dr
, "Received Atomic-Read-File Request!\n");

119 
	`dk_g_my_addss
(&
my_addss
);

120 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

121 
pdu_n
 =

122 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

123 &
du_da
);

124 i(
rvi_da
->
gmd_mesge
) {

125 
n
 =

126 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

127 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

128 
ue
);

129 #i
PRINT_ENABLED


130 
	`rtf
(
dr
, "ARF: Segmented Message. Sending Abort!\n");

132 
ARF_ABORT
;

134 
n
 = 
	`f_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

136 i(
n
 < 0) {

137 
n
 =

138 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

139 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

140 #i
PRINT_ENABLED


141 
	`rtf
(
dr
, "Bad Encoding. Sending Abort!\n");

143 
ARF_ABORT
;

145 i(
da
.
obje_ty
 =
OBJECT_FILE
) {

146 i(!
	`bacfe_vid_
(
da
.
obje_
)) {

147 
r
 = 
ue
;

148 } i(
da
.
acss
 =
FILE_STREAM_ACCESS
) {

149 i(
da
.
ty
.
am
.
queedOCou
 <

150 
	`org_cy
(&
da
.
feDa
)) {

151 
	`bacfe_ad_da
(&
da
);

152 #i
PRINT_ENABLED


153 
	`rtf
(
dr
, "ARF: Stream offset %d, %d octets.\n",

154 
da
.
ty
.
am
.
feSPosi
,

155 
da
.
ty
.
am
.
queedOCou
);

157 
n
 =

158 
	`f_ack_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

159 
rvi_da
->
voke_id
, &
da
);

161 
n
 =

162 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

163 
rvi_da
->
voke_id
,

164 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
, 
ue
);

165 #i
PRINT_ENABLED


166 
	`rtf
(
dr
, "Too Big To Send (%d >= %d). Sending Abort!\n",

167 
da
.
ty
.
am
.
queedOCou
,

168 ()
	`org_cy
(&
da
.
feDa
));

172 
r
 = 
ue
;

173 
r_ass
 = 
ERROR_CLASS_SERVICES
;

174 
r_code
 = 
ERROR_CODE_INVALID_FILE_ACCESS_METHOD
;

175 #i
PRINT_ENABLED


176 
	`rtf
(
dr
, "Record Access Requested. Sending Error!\n");

180 
r
 = 
ue
;

181 
r_ass
 = 
ERROR_CLASS_SERVICES
;

182 
r_code
 = 
ERROR_CODE_INCONSISTENT_OBJECT_TYPE
;

184 i(
r
) {

185 
n
 =

186 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

187 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_ATOMIC_READ_FILE
,

188 
r_ass
, 
r_code
);

190 
ARF_ABORT
:

191 
pdu_n
 +
n
;

192 
bys_
 =

193 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

194 
pdu_n
);

195 #i
PRINT_ENABLED


196 i(
bys_
 <= 0) {

197 
	`rtf
(
dr
, "Faedأnd PDU (%s)!\n", 
	`
(
o
));

202 
	}
}

	@demo/handler/h_arf_a.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~"cfig.h
"

28 
	~"txbuf.h
"

29 
	~"bacdef.h
"

30 
	~"bacdcode.h
"

31 
	~"addss.h
"

32 
	~"tsm.h
"

33 
	~"du.h
"

34 
	~"du.h
"

35 
	~"devi.h
"

36 
	~"dk.h
"

37 
	~"f.h
"

38 #i
defed
(
BACFILE
)

39 
	~"bacfe.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

52 #i
defed
(
BACFILE
)

53 
	$hdr_omic_ad_fe_ack
(

54 
ut8_t
 * 
rvi_que
,

55 
ut16_t
 
rvi_n
,

56 
BACNET_ADDRESS
 * 
c
,

57 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

59 
n
 = 0;

60 
BACNET_ATOMIC_READ_FILE_DATA
 
da
;

61 
ut32_t
 

 = 0;

63 (
c
;

65 

 = 
	`bacfe__om_tsm
(
rvi_da
->
voke_id
);

66 
n
 = 
	`f_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

67 #i
PRINT_ENABLED


68 
	`rtf
(
dr
, "Received Read-File Ack!\n");

70 i((
n
 > 0&& (

 <
BACNET_MAX_INSTANCE
)) {

72 i(
da
.
acss
 =
FILE_STREAM_ACCESS
) {

73 
	`bacfe_ad_ack_am_da
(

, &
da
);

74 } i(
da
.
acss
 =
FILE_RECORD_ACCESS
) {

78 
	}
}

	@demo/handler/h_awf.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacr.h
"

34 
	~"ba.h
"

35 
	~"bacdcode.h
"

36 
	~"du.h
"

37 
	~"du.h
"

38 
	~"abt.h
"

39 
	~"awf.h
"

41 
	~"devi.h
"

42 #i
defed
(
BACFILE
)

43 
	~"bacfe.h
"

45 
	~"hdrs.h
"

78 #i
defed
(
BACFILE
)

79 
	$hdr_omic_wre_fe
(

80 
ut8_t
 * 
rvi_que
,

81 
ut16_t
 
rvi_n
,

82 
BACNET_ADDRESS
 * 
c
,

83 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

85 
BACNET_ATOMIC_WRITE_FILE_DATA
 
da
;

86 
n
 = 0;

87 
pdu_n
 = 0;

88 
bo
 
r
 = 
l
;

89 
bys_
 = 0;

90 
BACNET_NPDU_DATA
 
du_da
;

91 
BACNET_ADDRESS
 
my_addss
;

92 
BACNET_ERROR_CLASS
 
r_ass
 = 
ERROR_CLASS_OBJECT
;

93 
BACNET_ERROR_CODE
 
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

95 #i
PRINT_ENABLED


96 
	`rtf
(
dr
, "Received AtomicWriteFile Request!\n");

99 
	`dk_g_my_addss
(&
my_addss
);

100 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

101 
pdu_n
 =

102 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

103 &
du_da
);

104 i(
rvi_da
->
gmd_mesge
) {

105 
n
 =

106 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

107 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

108 
ue
);

109 #i
PRINT_ENABLED


110 
	`rtf
(
dr
, "Segmented Message. Sending Abort!\n");

112 
AWF_ABORT
;

114 
n
 = 
	`awf_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

116 i(
n
 < 0) {

117 
n
 =

118 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

119 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

120 #i
PRINT_ENABLED


121 
	`rtf
(
dr
, "Bad Encoding. Sending Abort!\n");

123 
AWF_ABORT
;

125 i(
da
.
obje_ty
 =
OBJECT_FILE
) {

126 i(!
	`bacfe_vid_
(
da
.
obje_
)) {

127 
r
 = 
ue
;

128 } i(
da
.
acss
 =
FILE_STREAM_ACCESS
) {

129 i(
	`bacfe_wre_am_da
(&
da
)) {

130 #i
PRINT_ENABLED


131 
	`rtf
(
dr
, "AWF: Stream offset %d, %d bytes\n",

132 
da
.
ty
.
am
.
feSPosi
,

133 ()
	`org_ngth
(&
da
.
feDa
));

135 
n
 =

136 
	`awf_ack_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

137 
rvi_da
->
voke_id
, &
da
);

139 
r
 = 
ue
;

140 
r_ass
 = 
ERROR_CLASS_OBJECT
;

141 
r_code
 = 
ERROR_CODE_FILE_ACCESS_DENIED
;

144 
r
 = 
ue
;

145 
r_ass
 = 
ERROR_CLASS_SERVICES
;

146 
r_code
 = 
ERROR_CODE_INVALID_FILE_ACCESS_METHOD
;

147 #i
PRINT_ENABLED


148 
	`rtf
(
dr
, "Record Access Requested. Sending Error!\n");

152 
r
 = 
ue
;

153 
r_ass
 = 
ERROR_CLASS_SERVICES
;

154 
r_code
 = 
ERROR_CODE_INCONSISTENT_OBJECT_TYPE
;

156 i(
r
) {

157 
n
 =

158 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

159 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
,

160 
r_ass
, 
r_code
);

162 
AWF_ABORT
:

163 
pdu_n
 +
n
;

164 
bys_
 =

165 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

166 
pdu_n
);

167 #i
PRINT_ENABLED


168 i(
bys_
 <= 0) {

169 
	`rtf
(
dr
, "Faedأnd PDU (%s)!\n", 
	`
(
o
));

174 
	}
}

	@demo/handler/h_bbmd6.c

35 
	~<dio.h
>

36 
	~<dt.h
>

37 
	~<dbo.h
>

38 
	~<rg.h
>

39 
	~"bacdcode.h
"

40 
	~"b6.h
"

41 
	~"bvlc6.h
"

42 
	~"debug.h
"

43 
	~"devi.h
"

44 
	~"vmac.h
"

45 #ide
TEST


46 
	~"t.h
"

50 
ut16_t
 
	gBVLC6_Resu_Code
 = 
BVLC6_RESULT_SUCCESSFUL_COMPLETION
;

52 
ut8_t
 
	gBVLC6_Funi_Code
 = 
BVLC6_RESULT
;

55 
BACNET_IP6_ADDRESS
 
	gReme_BBMD
;

56 #i
defed
(
BACDL_BIP6
&& 
BBMD6_ENABLED


58 
ut8_t
 
	gBVLC6_Bufr
[
MAX_MPDU
];

59 
ut16_t
 
	gBVLC6_Bufr_L
;

61 #ide
MAX_BBMD6_ENTRIES


62 
	#MAX_BBMD6_ENTRIES
 128

	)

64 
BACNET_IP6_BROADCAST_DISTRIBUTION_TABLE_ENTRY
 
	gBBMD_Tab
[
MAX_BBMD6_ENTRIES
];

66 #ide
MAX_FD6_ENTRIES


67 
	#MAX_FD6_ENTRIES
 128

	)

69 
BACNET_IP6_FOREIGN_DEVICE_TABLE_ENTRY
 
	gFD_Tab
[
MAX_FD6_ENTRIES
];

72 #i
defed
(
BACDL_BIP6
&& 
BBMD6_ENABLED


77 
	$bvlc6_man_tim
(

78 
time_t
 
cds
)

80 
i
 = 0;

82 
i
 = 0; i < 
MAX_FD6_ENTRIES
; i++) {

83 i(
FD_Tab
[
i
].
vid
) {

84 i(
FD_Tab
[
i
].
l_cds_mag
) {

85 i(
FD_Tab
[
i
].
l_cds_mag
 < 
cds
) {

86 
FD_Tab
[
i
].
l_cds_mag
 = 0;

88 
FD_Tab
[
i
].
l_cds_mag
 -
cds
;

90 i(
FD_Tab
[
i
].
l_cds_mag
 == 0) {

91 
FD_Tab
[
i
].
vid
 = 
l
;

96 
	}
}

107 
bo
 
	$bbmd6_addss_om_vmac
(

108 
BACNET_IP6_ADDRESS
 *
addr
,

109 
vmac_da
 *
vmac
)

111 
bo
 
us
 = 
l
;

112 
i
 = 0;

114 i(
vmac
 && 
addr
 && (vmac->
mac_n
 == 18)) {

115 
i
 = 0; i < 
IP6_ADDRESS_MAX
; i++) {

116 
addr
->
addss
[
i
] = 
vmac
->
mac
[i];

118 
	`decode_unsigd16
(&
vmac
->
mac
[16], &
addr
->
pt
);

119 
us
 = 
ue
;

122  
us
;

123 
	}
}

133 
bo
 
	$bbmd6_addss_to_vmac
(

134 
vmac_da
 *
vmac
,

135 
BACNET_IP6_ADDRESS
 *
addr
)

137 
bo
 
us
 = 
l
;

138 
i
 = 0;

140 i(
vmac
 && 
addr
) {

141 
i
 = 0; i < 
IP6_ADDRESS_MAX
; i++) {

142 
vmac
->
mac
[
i
] = 
addr
->
addss
[i];

144 
	`code_unsigd16
(&
vmac
->
mac
[16], 
addr
->
pt
);

145 
vmac
->
mac_n
 = 18;

146 
us
 = 
ue
;

149  
us
;

150 
	}
}

160 
bo
 
	$bbmd6_add_vmac
(

161 
ut32_t
 
devi_id
,

162 
BACNET_IP6_ADDRESS
 *
addr
)

164 
bo
 
us
 = 
l
;

165 
vmac_da
 *
vmac
;

166 
vmac_da
 
w_vmac
;

168 i(
addr
) {

169 
vmac
 = 
	`VMAC_Fd_By_Key
(
devi_id
);

170 i(
vmac
) {

172 } i(
	`bbmd6_addss_to_vmac
(&
w_vmac
, 
addr
)) {

174 
us
 = 
	`VMAC_Add
(
devi_id
, &
w_vmac
);

175 
	`debug_tf
("BVLC6: Addg VMAC %lu.\n", ()
devi_id
);

179  
us
;

180 
	}
}

192 
bo
 
	$bbmd6_addss_om_ba_addss
(

193 
BACNET_IP6_ADDRESS
 * 
addr
,

194 
ut32_t
 * 
vmac_c
,

195 
BACNET_ADDRESS
 * 
baddr
)

197 
vmac_da
 *
vmac
;

198 
bo
 
us
 = 
l
;

199 
ut32_t
 
devi_id
 = 0;

201 i(
addr
 && 
baddr
) {

202 
us
 = 
	`bvlc6_vmac_addss_g
(
baddr
, &
devi_id
);

203 i(
us
) {

204 
vmac
 = 
	`VMAC_Fd_By_Key
(
devi_id
);

205 i(
vmac
) {

206 
	`debug_tf
("BVLC6: Found VMAC %lu (len=%u).\n",

207 ()
devi_id
,

208 ()
vmac
->
mac_n
);

209 
us
 = 
	`bbmd6_addss_om_vmac
(
addr
, 
vmac
);

210 i(
vmac_c
) {

211 *
vmac_c
 = 
devi_id
;

217  
us
;

218 
	}
}

234 
	$b6_nd_pdu
(

235 
BACNET_ADDRESS
 * 
de
,

236 
BACNET_NPDU_DATA
 * 
du_da
,

237 
ut8_t
 * 
pdu
,

238 
pdu_n
)

240 
BACNET_IP6_ADDRESS
 
bvlc_de
 = {{0}};

241 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

242 
ut16_t
 
mtu_n
 = 0;

243 
ut32_t
 
vmac_c
 = 0;

244 
ut32_t
 
vmac_d
 = 0;

247 (
du_da
;

249 i((
de
->
t
 =
BACNET_BROADCAST_NETWORK
|| (de->
mac_n
 == 0)) {

252 i(
Reme_BBMD
.
pt
) {

254 
	`bvlc6_addss_cy
(&
bvlc_de
, &
Reme_BBMD
);

255 
vmac_c
 = 
	`Devi_Obje_In_Numb
();

256 
mtu_n
 = 
	`bvlc6_code_diribu_brd_to_twk
(

257 
mtu
, (mtu), 
vmac_c
, 
pdu
, 
pdu_n
);

258 
	`debug_tf
("BVLC6: Sent Distribute-Broadcast-to-Network.\n");

260 
	`b6_g_brd_addr
(&
bvlc_de
);

261 
vmac_c
 = 
	`Devi_Obje_In_Numb
();

262 
mtu_n
 = 
	`bvlc6_code_ig_brd
(

263 
mtu
, (mtu), 
vmac_c
, 
pdu
, 
pdu_n
);

264 
	`debug_tf
("BVLC6: Sent Original-Broadcast-NPDU.\n");

266 } i((
de
->
t
 > 0&& (de->
n
 == 0)) {

268 i(
de
->
mac_n
 == 3) {

270 
	`bbmd6_addss_om_ba_addss
(&
bvlc_de
, &
vmac_d
, 
de
);

272 
	`b6_g_brd_addr
(&
bvlc_de
);

274 
vmac_c
 = 
	`Devi_Obje_In_Numb
();

275 
mtu_n
 = 
	`bvlc6_code_ig_brd
(

276 
mtu
, (mtu), 
vmac_c
, 
pdu
, 
pdu_n
);

277 
	`debug_tf
("BVLC6: Sent Original-Broadcast-NPDU.\n");

278 } i(
de
->
mac_n
 == 3) {

280 
	`bbmd6_addss_om_ba_addss
(&
bvlc_de
, &
vmac_d
, 
de
);

281 
	`debug_tf
("BVLC6: SdgVMAC %lu.\n", ()
vmac_d
);

282 
vmac_c
 = 
	`Devi_Obje_In_Numb
();

283 
mtu_n
 = 
	`bvlc6_code_ig_uni
(

284 
mtu
, (mtu), 
vmac_c
, 
vmac_d
, 
pdu
, 
pdu_n
);

285 
	`debug_tf
("BVLC6: Sent Original-Unicast-NPDU.\n");

287 
	`debug_tf
("BVLC6: Send failure. Invalid Address.\n");

291  
	`b6_nd_mpdu
(&
bvlc_de
, 
mtu
, 
mtu_n
);

292 
	}
}

294 #i
defed
(
BACDL_BIP6
&& 
BBMD6_ENABLED


304 
	$bbmd6_nd_pdu_bdt
(

305 
ut8_t
 * 
mtu
,

306 
mtu_n
)

308 
BACNET_IP6_ADDRESS
 
my_addr
 = {{0}};

309 
i
 = 0;

311 i(
mtu
) {

312 
	`b6_g_addr
(&
my_addr
);

313 
i
 = 0; i < 
MAX_BBMD6_ENTRIES
; i++) {

314 i(
BBMD_Tab
[
i
].
vid
) {

315 i(
	`bvlc6_addss_dif
(&
my_addr
,

316 &
BBMD_Tab
[
i
].
b6_addss
)) {

317 
	`b6_nd_mpdu
(&
BBMD_Tab
[
i
].
b6_addss
, 
mtu
, 
mtu_n
);

322 
	}
}

333 
	$bbmd6_nd_pdu_fdt
(

334 
ut8_t
 * 
mtu
,

335 
mtu_n
)

337 
BACNET_IP6_ADDRESS
 
my_addr
 = {{0}};

338 
i
 = 0;

340 i(
mtu
) {

341 
	`b6_g_addr
(&
my_addr
);

342 
i
 = 0; i < 
MAX_FD6_ENTRIES
; i++) {

343 i(
FD_Tab
[
i
].
vid
) {

344 i(
	`bvlc6_addss_dif
(&
my_addr
,

345 &
FD_Tab
[
i
].
b6_addss
)) {

346 
	`b6_nd_mpdu
(&
FD_Tab
[
i
].
b6_addss
, 
mtu
, 
mtu_n
);

351 
	}
}

365 
	$bvlc6_nd_su
(

366 
BACNET_IP6_ADDRESS
 *
de_addr
,

367 
ut32_t
 
vmac_c
,

368 
ut16_t
 
su_code
)

370 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

371 
ut16_t
 
mtu_n
 = 0;

373 
mtu_n
 = 
	`bvlc6_code_su
(&
mtu
[0], (mtu), 
vmac_c
, 
su_code
);

375  
	`b6_nd_mpdu
(
de_addr
, 
mtu
, 
mtu_n
);

376 
	}
}

389 
	$bvlc6_nd_addss_suti_ack
(

390 
BACNET_IP6_ADDRESS
 *
de_addr
,

391 
ut32_t
 
vmac_c
,

392 
ut32_t
 
vmac_d
)

394 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

395 
ut16_t
 
mtu_n
 = 0;

397 
mtu_n
 = 
	`bvlc6_code_addss_suti_ack
(

398 &
mtu
[0], (mtu),

399 
vmac_c
, 
vmac_d
);

401  
	`b6_nd_mpdu
(
de_addr
, 
mtu
, 
mtu_n
);

402 
	}
}

416 
	$bvlc6_nd_vtu_addss_suti_ack
(

417 
BACNET_IP6_ADDRESS
 *
de_addr
,

418 
ut32_t
 
vmac_c
,

419 
ut32_t
 
vmac_d
)

421 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

422 
ut16_t
 
mtu_n
 = 0;

424 
mtu_n
 = 
	`bvlc6_code_vtu_addss_suti_ack
(

425 &
mtu
[0], (mtu),

426 
vmac_c
, 
vmac_d
);

428  
	`b6_nd_mpdu
(
de_addr
, 
mtu
, 
mtu_n
);

429 
	}
}

438 
	$bbmd6_vtu_addss_suti_hdr
(

439 
BACNET_IP6_ADDRESS
 *
addr
,

440 
ut8_t
 * 
pdu
,

441 
ut16_t
 
pdu_n
)

443 
funi_n
 = 0;

444 
ut32_t
 
vmac_c
 = 0;

445 
ut32_t
 
vmac_me
 = 0;

447 i(
addr
 && 
pdu
) {

448 
	`debug_tf
("BIP6: Received Virtual-Address-Resolution.\n");

449 i(
	`b6_addss_mch_lf
(
addr
)) {

452 
funi_n
 = 
	`bvlc6_decode_vtu_addss_suti
(

453 
pdu
, 
pdu_n
,

454 &
vmac_c
);

455 i(
funi_n
) {

456 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

460 
vmac_me
 = 
	`Devi_Obje_In_Numb
();

461 
	`bvlc6_nd_vtu_addss_suti_ack
(

462 
addr
, 
vmac_me
, 
vmac_c
);

466 
	}
}

475 
	$bbmd6_vtu_addss_suti_ack_hdr
(

476 
BACNET_IP6_ADDRESS
 *
addr
,

477 
ut8_t
 * 
pdu
,

478 
ut16_t
 
pdu_n
)

480 
funi_n
 = 0;

481 
ut32_t
 
vmac_c
 = 0;

482 
ut32_t
 
vmac_d
 = 0;

484 i(
addr
 && 
pdu
) {

485 
	`debug_tf
("BIP6: Received Virtual-Address-Resolution-ACK.\n");

486 i(
	`b6_addss_mch_lf
(
addr
)) {

489 
funi_n
 = 
	`bvlc6_decode_vtu_addss_suti_ack
(

490 
pdu
, 
pdu_n
,

491 &
vmac_c
, &
vmac_d
);

492 i(
funi_n
) {

493 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

497 
	}
}

506 
	$bbmd6_addss_suti_hdr
(

507 
BACNET_IP6_ADDRESS
 *
addr
,

508 
ut8_t
 * 
pdu
,

509 
ut16_t
 
pdu_n
)

511 
funi_n
 = 0;

512 
ut32_t
 
vmac_c
 = 0;

513 
ut32_t
 
vmac_rg
 = 0;

514 
ut32_t
 
vmac_me
 = 0;

516 i(
addr
 && 
pdu
) {

517 
	`debug_tf
("BIP6: Received Address-Resolution.\n");

518 i(
	`b6_addss_mch_lf
(
addr
)) {

521 
funi_n
 = 
	`bvlc6_decode_addss_suti
(

522 
pdu
, 
pdu_n
,

523 &
vmac_c
, &
vmac_rg
);

524 i(
funi_n
) {

525 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

526 
vmac_me
 = 
	`Devi_Obje_In_Numb
();

527 i(
vmac_rg
 =
vmac_me
) {

531 
	`bvlc6_nd_addss_suti_ack
(

532 
addr
, 
vmac_me
, 
vmac_c
);

537 
	}
}

546 
	$bbmd6_addss_suti_ack_hdr
(

547 
BACNET_IP6_ADDRESS
 *
addr
,

548 
ut8_t
 * 
pdu
,

549 
ut16_t
 
pdu_n
)

551 
funi_n
 = 0;

552 
ut32_t
 
vmac_c
 = 0;

553 
ut32_t
 
vmac_d
 = 0;

555 i(
addr
 && 
pdu
) {

556 
	`debug_tf
("BIP6: Received Address-Resolution-ACK.\n");

557 i(
	`b6_addss_mch_lf
(
addr
)) {

560 
funi_n
 = 
	`bvlc6_decode_addss_suti_ack
(

561 
pdu
, 
pdu_n
,

562 &
vmac_c
, &
vmac_d
);

563 i(
funi_n
) {

564 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

568 
	}
}

570 #i
defed
(
BACDL_BIP6
&& 
BBMD6_ENABLED


582 
	$hdr_bbmd6_f_bbmd
(

583 
BACNET_IP6_ADDRESS
 *
addr
,

584 
BACNET_ADDRESS
 * 
c
,

585 
ut8_t
 * 
mtu
,

586 
ut16_t
 
mtu_n
)

588 
ut16_t
 
su_code
 = 
BVLC6_RESULT_SUCCESSFUL_COMPLETION
;

589 
ut32_t
 
vmac_c
 = 0;

590 
ut32_t
 
vmac_d
 = 0;

591 
ut8_t
 
mesge_ty
 = 0;

592 
ut16_t
 
mesge_ngth
 = 0;

593 
hd_n
 = 0;

594 
funi_n
 = 0;

595 
ut8_t
 * 
pdu
 = 
NULL
;

596 
ut16_t
 
pdu_n
 = 0;

597 
ut8_t
 * 
du
 = 
NULL
;

598 
ut16_t
 
du_n
 = 0;

599 
bo
 
nd_su
 = 
l
;

600 
ut16_t
 
offt
 = 0;

601 
BACNET_IP6_ADDRESS
 
fwd_addss
 = {{0}};

602 
BACNET_IP6_ADDRESS
 
bvlc_de
 = {{0}};

604 
hd_n
 = 
	`bvlc6_decode_hd
(
mtu
, 
mtu_n
, &
mesge_ty
,

605 &
mesge_ngth
);

606 i(
hd_n
 == 4) {

607 
BVLC6_Funi_Code
 = 
mesge_ty
;

608 
pdu
 = &
mtu
[
hd_n
];

609 
pdu_n
 = 
mtu_n
 - 
hd_n
;

610 
BVLC6_Funi_Code
) {

611 
BVLC6_RESULT
:

612 
funi_n
 = 
	`bvlc6_decode_su
(
pdu
, 
pdu_n
, &
vmac_c
,

613 &
su_code
);

614 i(
funi_n
) {

615 
BVLC6_Resu_Code
 = 
su_code
;

619 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

620 
	`bvlc6_vmac_addss_t
(
c
, 
vmac_c
);

621 
	`debug_tf
("BIP6: Received Result Code=%d\n",

622 
BVLC6_Resu_Code
);

625 
BVLC6_REGISTER_FOREIGN_DEVICE
:

626 
su_code
 = 
BVLC6_RESULT_REGISTER_FOREIGN_DEVICE_NAK
;

627 
nd_su
 = 
ue
;

629 
BVLC6_DELETE_FOREIGN_DEVICE
:

630 
su_code
 = 
BVLC6_RESULT_DELETE_FOREIGN_DEVICE_NAK
;

631 
nd_su
 = 
ue
;

633 
BVLC6_DISTRIBUTE_BROADCAST_TO_NETWORK
:

634 
su_code
 = 
BVLC6_RESULT_DISTRIBUTE_BROADCAST_TO_NETWORK_NAK
;

635 
nd_su
 = 
ue
;

637 
BVLC6_ORIGINAL_UNICAST_NPDU
:

640 
	`debug_tf
("BIP6: Received Original-Unicast-NPDU.\n");

641 i(
	`b6_addss_mch_lf
(
addr
)) {

643 
offt
 = 0;

645 
funi_n
 = 
	`bvlc6_decode_ig_uni
(

646 
pdu
, 
pdu_n
,

647 &
vmac_c
, &
vmac_d
,

648 
NULL
, 0, &
du_n
);

649 i(
funi_n
) {

650 i(
vmac_d
 =
	`Devi_Obje_In_Numb
()) {

654 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

655 
	`bvlc6_vmac_addss_t
(
c
, 
vmac_c
);

656 
offt
 = 
hd_n
 + (
funi_n
 - 
du_n
);

661 
BVLC6_ORIGINAL_BROADCAST_NPDU
:

662 
	`debug_tf
("BIP6: Received Original-Broadcast-NPDU.\n");

663 
funi_n
 = 
	`bvlc6_decode_ig_brd
(

664 
pdu
, 
pdu_n
,

665 &
vmac_c
,

666 
NULL
, 0, &
du_n
);

667 i(
funi_n
) {

668 
offt
 = 
hd_n
 + (
funi_n
 - 
du_n
);

669 
du
 = &
mtu
[
offt
];

677 
BVLC6_Bufr_L
 = 
	`bvlc6_code_fwded_du
(

678 &
BVLC6_Bufr
[0], (BVLC6_Buffer),

679 
vmac_c
, 
addr
,

680 
du
, 
du_n
);

681 
	`bbmd6_nd_pdu_bdt
(&
BVLC6_Bufr
[0], 
BVLC6_Bufr_L
);

682 
	`bbmd6_nd_pdu_fdt
(&
BVLC6_Bufr
[0], 
BVLC6_Bufr_L
);

683 i(!
	`b6_addss_mch_lf
(
addr
)) {

687 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

688 
	`bvlc6_vmac_addss_t
(
c
, 
vmac_c
);

692 
BVLC6_FORWARDED_NPDU
:

693 
	`debug_tf
("BIP6: Received Forwarded-NPDU.\n");

694 
funi_n
 = 
	`bvlc6_decode_fwded_du
(

695 
pdu
, 
pdu_n
,

696 &
vmac_c
, &
fwd_addss
,

697 
NULL
, 0, &
du_n
);

698 i(
funi_n
) {

699 
offt
 = 
hd_n
 + (
funi_n
 - 
du_n
);

700 
du
 = &
mtu
[
offt
];

706 
BVLC6_Bufr_L
 = 
	`bvlc6_code_fwded_du
(

707 &
BVLC6_Bufr
[0], (BVLC6_Buffer),

708 
vmac_c
, 
addr
,

709 
du
, 
du_n
);

710 
	`b6_g_brd_addr
(&
bvlc_de
);

711 
	`b6_nd_mpdu
(&
bvlc_de
, &
BVLC6_Bufr
[0], 
BVLC6_Bufr_L
);

719 
	`bbmd6_nd_pdu_fdt
(&
BVLC6_Bufr
[0], 
BVLC6_Bufr_L
);

720 i(!
	`b6_addss_mch_lf
(
addr
)) {

724 
	`bbmd6_add_vmac
(
vmac_c
, &
fwd_addss
);

725 
	`bvlc6_vmac_addss_t
(
c
, 
vmac_c
);

729 
BVLC6_FORWARDED_ADDRESS_RESOLUTION
:

730 
su_code
 = 
BVLC6_RESULT_ADDRESS_RESOLUTION_NAK
;

731 
nd_su
 = 
ue
;

733 
BVLC6_ADDRESS_RESOLUTION
:

734 
	`bbmd6_addss_suti_hdr
(
addr
, 
pdu
, 
pdu_n
);

736 
BVLC6_ADDRESS_RESOLUTION_ACK
:

737 
	`bbmd6_addss_suti_ack_hdr
(
addr
, 
pdu
, 
pdu_n
);

739 
BVLC6_VIRTUAL_ADDRESS_RESOLUTION
:

740 
	`bbmd6_vtu_addss_suti_hdr
(
addr
, 
pdu
, 
pdu_n
);

742 
BVLC6_VIRTUAL_ADDRESS_RESOLUTION_ACK
:

743 
	`bbmd6_vtu_addss_suti_ack_hdr
(
addr
, 
pdu
, 
pdu_n
);

745 
BVLC6_SECURE_BVLL
:

750 i(
nd_su
) {

751 
vmac_c
 = 
	`Devi_Obje_In_Numb
();

752 
	`bvlc6_nd_su
(
addr
, 
vmac_c
, 
su_code
);

753 
	`debug_tf
("BIP6: ssu code=%d\n", 
su_code
);

757  
offt
;

758 
	}
}

771 
	$hdr_bbmd6_f_n_bbmd
(

772 
BACNET_IP6_ADDRESS
 *
addr
,

773 
BACNET_ADDRESS
 * 
c
,

774 
ut8_t
 * 
mtu
,

775 
ut16_t
 
mtu_n
)

777 
ut16_t
 
su_code
 = 
BVLC6_RESULT_SUCCESSFUL_COMPLETION
;

778 
ut32_t
 
vmac_c
 = 0;

779 
ut32_t
 
vmac_d
 = 0;

780 
ut8_t
 
mesge_ty
 = 0;

781 
ut16_t
 
mesge_ngth
 = 0;

782 
hd_n
 = 0;

783 
funi_n
 = 0;

784 
ut8_t
 * 
pdu
 = 
NULL
;

785 
ut16_t
 
pdu_n
 = 0;

786 
ut16_t
 
du_n
 = 0;

787 
bo
 
nd_su
 = 
l
;

788 
ut16_t
 
offt
 = 0;

789 
BACNET_IP6_ADDRESS
 
fwd_addss
 = {{0}};

791 
hd_n
 = 
	`bvlc6_decode_hd
(
mtu
, 
mtu_n
, &
mesge_ty
,

792 &
mesge_ngth
);

793 i(
hd_n
 == 4) {

794 
BVLC6_Funi_Code
 = 
mesge_ty
;

795 
pdu
 = &
mtu
[
hd_n
];

796 
pdu_n
 = 
mtu_n
 - 
hd_n
;

797 
BVLC6_Funi_Code
) {

798 
BVLC6_RESULT
:

799 
funi_n
 = 
	`bvlc6_decode_su
(
pdu
, 
pdu_n
, &
vmac_c
,

800 &
su_code
);

801 i(
funi_n
) {

802 
BVLC6_Resu_Code
 = 
su_code
;

806 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

807 
	`bvlc6_vmac_addss_t
(
c
, 
vmac_c
);

808 
	`debug_tf
("BIP6: Received Result Code=%d\n",

809 
BVLC6_Resu_Code
);

812 
BVLC6_REGISTER_FOREIGN_DEVICE
:

813 
su_code
 = 
BVLC6_RESULT_REGISTER_FOREIGN_DEVICE_NAK
;

814 
nd_su
 = 
ue
;

816 
BVLC6_DELETE_FOREIGN_DEVICE
:

817 
su_code
 = 
BVLC6_RESULT_DELETE_FOREIGN_DEVICE_NAK
;

818 
nd_su
 = 
ue
;

820 
BVLC6_DISTRIBUTE_BROADCAST_TO_NETWORK
:

821 
su_code
 = 
BVLC6_RESULT_DISTRIBUTE_BROADCAST_TO_NETWORK_NAK
;

822 
nd_su
 = 
ue
;

824 
BVLC6_ORIGINAL_UNICAST_NPDU
:

827 
	`debug_tf
("BIP6: Received Original-Unicast-NPDU.\n");

828 i(
	`b6_addss_mch_lf
(
addr
)) {

830 
offt
 = 0;

832 
funi_n
 = 
	`bvlc6_decode_ig_uni
(

833 
pdu
, 
pdu_n
,

834 &
vmac_c
, &
vmac_d
,

835 
NULL
, 0, &
du_n
);

836 i(
funi_n
) {

837 i(
vmac_d
 =
	`Devi_Obje_In_Numb
()) {

841 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

842 
	`bvlc6_vmac_addss_t
(
c
, 
vmac_c
);

843 
offt
 = 
hd_n
 + (
funi_n
 - 
du_n
);

848 
BVLC6_ORIGINAL_BROADCAST_NPDU
:

849 
	`debug_tf
("BIP6: Received Original-Broadcast-NPDU.\n");

850 i(
	`b6_addss_mch_lf
(
addr
)) {

852 
offt
 = 0;

854 
funi_n
 = 
	`bvlc6_decode_ig_brd
(

855 
pdu
, 
pdu_n
,

856 &
vmac_c
,

857 
NULL
, 0, &
du_n
);

858 i(
funi_n
) {

862 
	`bbmd6_add_vmac
(
vmac_c
, 
addr
);

863 
	`bvlc6_vmac_addss_t
(
c
, 
vmac_c
);

864 
offt
 = 
hd_n
 + (
funi_n
 - 
du_n
);

868 
BVLC6_FORWARDED_NPDU
:

869 
	`debug_tf
("BIP6: Received Forwarded-NPDU.\n");

870 i(
	`b6_addss_mch_lf
(
addr
)) {

872 
offt
 = 0;

874 
funi_n
 = 
	`bvlc6_decode_fwded_du
(

875 
pdu
, 
pdu_n
,

876 &
vmac_c
, &
fwd_addss
,

877 
NULL
, 0, &
du_n
);

878 i(
funi_n
) {

882 
	`bbmd6_add_vmac
(
vmac_c
, &
fwd_addss
);

883 
	`bvlc6_vmac_addss_t
(
c
, 
vmac_c
);

884 
offt
 = 
hd_n
 + (
funi_n
 - 
du_n
);

888 
BVLC6_FORWARDED_ADDRESS_RESOLUTION
:

889 
su_code
 = 
BVLC6_RESULT_ADDRESS_RESOLUTION_NAK
;

890 
nd_su
 = 
ue
;

892 
BVLC6_ADDRESS_RESOLUTION
:

893 
	`bbmd6_addss_suti_hdr
(
addr
, 
pdu
, 
pdu_n
);

895 
BVLC6_ADDRESS_RESOLUTION_ACK
:

896 
	`bbmd6_addss_suti_ack_hdr
(
addr
, 
pdu
, 
pdu_n
);

898 
BVLC6_VIRTUAL_ADDRESS_RESOLUTION
:

899 
	`bbmd6_vtu_addss_suti_hdr
(
addr
, 
pdu
, 
pdu_n
);

901 
BVLC6_VIRTUAL_ADDRESS_RESOLUTION_ACK
:

902 
	`bbmd6_vtu_addss_suti_ack_hdr
(
addr
, 
pdu
, 
pdu_n
);

904 
BVLC6_SECURE_BVLL
:

909 i(
nd_su
) {

910 
vmac_c
 = 
	`Devi_Obje_In_Numb
();

911 
	`bvlc6_nd_su
(
addr
, 
vmac_c
, 
su_code
);

912 
	`debug_tf
("BIP6: ssu code=%d\n", 
su_code
);

916  
offt
;

917 
	}
}

930 
	$bvlc6_hdr
(

931 
BACNET_IP6_ADDRESS
 *
addr
,

932 
BACNET_ADDRESS
 * 
c
,

933 
ut8_t
 * 
du
,

934 
ut16_t
 
du_n
)

936 #i
	`defed
(
BACDL_BIP6
&& 
BBMD6_ENABLED


937  
	`hdr_bbmd6_f_bbmd
(
addr
, 
c
, 
du
, 
du_n
);

939  
	`hdr_bbmd6_f_n_bbmd
(
addr
, 
c
, 
du
, 
du_n
);

941 
	}
}

952 
	$bvlc6_gi_wh_bbmd
(

953 
BACNET_IP6_ADDRESS
 *
bbmd_addr
,

954 
ut32_t
 
vmac_c
,

955 
ut16_t
 
time_to_live_cds
)

957 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

958 
ut16_t
 
mtu_n
 = 0;

960 
mtu_n
 = 
	`bvlc6_code_gi_feign_devi
(

961 &
mtu
[0], (mtu), 
vmac_c
, 
time_to_live_cds
);

963  
	`b6_nd_mpdu
(
bbmd_addr
, &
mtu
[0], 
mtu_n
);

964 
	}
}

974 
ut16_t
 
	$bvlc6_g_ϡ_su
(

977  
BVLC6_Resu_Code
;

978 
	}
}

987 
ut8_t
 
	$bvlc6_g_funi_code
(

990  
BVLC6_Funi_Code
;

991 
	}
}

993 
	$bvlc6_
()

995 
	`VMAC_In
();

996 
	}
}

998 #ifde
TEST


999 
	~<as.h
>

1000 
	~<rg.h
>

1001 
	~"e.h
"

1002 
ut32_t
 
	gDevi_ID
 = 0;

1003 
ut32_t
 
	gTe_Devi_ID
 = 12345;

1004 
BACNET_IP6_ADDRESS
 
	gBIP6_Addr
;

1005 
BACNET_IP6_ADDRESS
 
	gTe_BIP6_Addr
;

1006 
BACNET_IP6_ADDRESS
 
	gBIP6_Brd_Addr
;

1007 
ut8_t
 
	gBIP6_MTU_Bufr
[
MAX_MPDU
];

1020 
ut16_t
 
	$b6_ive
(

1021 
BACNET_ADDRESS
 * 
c
,

1022 
ut8_t
 * 
du
,

1023 
ut16_t
 
max_du
,

1024 
timeout
)

1027 
	}
}

1040 
	$b6_nd_mpdu
(

1041 
BACNET_IP6_ADDRESS
 *
de
,

1042 
ut8_t
 * 
mtu
,

1043 
ut16_t
 
mtu_n
)

1046 
	}
}

1054 
ut32_t
 
	$Devi_Obje_In_Numb
(

1057  
Devi_ID
;

1058 
	}
}

1065 
bo
 
	$b6_g_addr
(

1066 
BACNET_IP6_ADDRESS
 *
addr
)

1068  
	`bvlc6_addss_cy
(
addr
, &
BIP6_Addr
);

1069 
	}
}

1076 
bo
 
	$b6_g_brd_addr
(

1077 
BACNET_IP6_ADDRESS
 *
addr
)

1079  
	`bvlc6_addss_cy
(
addr
, &
BIP6_Brd_Addr
);

1080 
	}
}

1082 
	$_BBMD_Resu
(

1083 
Te
 * 
pTe
)

1085 
su
 = 0;

1086 
ut32_t
 
vmac_c
 = 0x1234;

1087 
ut16_t
 
su_code
[6] = {

1088 
BVLC6_RESULT_SUCCESSFUL_COMPLETION
,

1089 
BVLC6_RESULT_ADDRESS_RESOLUTION_NAK
,

1090 
BVLC6_RESULT_VIRTUAL_ADDRESS_RESOLUTION_NAK
,

1091 
BVLC6_RESULT_REGISTER_FOREIGN_DEVICE_NAK
,

1092 
BVLC6_RESULT_DELETE_FOREIGN_DEVICE_NAK
,

1093 
BVLC6_RESULT_DISTRIBUTE_BROADCAST_TO_NETWORK_NAK


1095 
ut16_t
 
_su_code
 = 0;

1096 
ut8_t
 
_funi_code
 = 0;

1097 
BACNET_IP6_ADDRESS
 
addr
;

1098 
BACNET_ADDRESS
 
c
;

1099 
i
 = 0;

1100 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

1101 
ut16_t
 
mtu_n
 = 0;

1103 
	`bvlc6_addss_t
(&
addr
,

1104 
BIP6_MULTICAST_LINK_LOCAL
, 0, 0, 0, 0, 0, 0,

1105 
BIP6_MULTICAST_GROUP_ID
);

1106 
addr
.
pt
 = 0xBAC0;

1107 
	`bvlc6_vmac_addss_t
(&
c
, 
vmac_c
);

1108 
i
 = 0; i < 6; i++) {

1109 
mtu_n
 = 
	`bvlc6_code_su
(&
mtu
[0], (mtu),

1110 
vmac_c
, 
su_code
[
i
]);

1111 
su
 = 
	`hdr_bbmd6_f_n_bbmd
(&
addr
, &
c
, &
mtu
[0], 
mtu_n
);

1113 
	`_
(
pTe
, 
su
 == 0);

1114 
_su_code
 = 
	`bvlc6_g_ϡ_su
();

1115 
	`_
(
pTe
, 
_su_code
 =
su_code
[
i
]);

1116 
_funi_code
 = 
	`bvlc6_g_funi_code
();

1117 
	`_
(
pTe
, 
_funi_code
 =
BVLC6_RESULT
);

1119 
	}
}

1121 
	$_BBMD6
(

1122 
Te
 * 
pTe
)

1124 
bo
 
rc
;

1127 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BBMD_Resu
);

1128 
	`as
(
rc
);

1129 
	}
}

1131 #ifde
TEST_BBMD6


1132 
	$ma
(

1135 
Te
 *
pTe
;

1137 
pTe
 = 
	`_
("BACÈBrd MagemDevi IP/v6", 
NULL
);

1138 
	`_BBMD6
(
pTe
);

1140 
	`_tSm
(
pTe
, 
dout
);

1141 
	`_run
(
pTe
);

1142 (
	`_pt
(
pTe
);

1143 
	`_deroy
(
pTe
);

1146 
	}
}

	@demo/handler/h_ccov.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"du.h
"

35 
	~"du.h
"

36 
	~"abt.h
"

38 
	~"cov.h
"

39 
	~"baext.h
"

40 
	~"hdrs.h
"

42 #ide
MAX_COV_PROPERTIES


43 
	#MAX_COV_PROPERTIES
 2

	)

62 
	$hdr_ccov_nifiti
(

63 
ut8_t
 * 
rvi_que
,

64 
ut16_t
 
rvi_n
,

65 
BACNET_ADDRESS
 * 
c
,

66 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

68 
BACNET_NPDU_DATA
 
du_da
;

69 
BACNET_COV_DATA
 
cov_da
;

70 
BACNET_PROPERTY_VALUE
 
ݔty_vue
[
MAX_COV_PROPERTIES
];

71 
BACNET_PROPERTY_VALUE
 *
pPrݔty_vue
 = 
NULL
;

72 
dex
 = 0;

73 
n
 = 0;

74 
pdu_n
 = 0;

75 
bys_
 = 0;

76 
BACNET_ADDRESS
 
my_addss
;

80 
pPrݔty_vue
 = &
ݔty_vue
[0];

81 
pPrݔty_vue
) {

82 
dex
++;

83 i(
dex
 < 
MAX_COV_PROPERTIES
) {

84 
pPrݔty_vue
->
xt
 = &
ݔty_vue
[
dex
];

86 
pPrݔty_vue
->
xt
 = 
NULL
;

88 
pPrݔty_vue
 =Prݔty_vue->
xt
;

90 
cov_da
.
liOfVues
 = &
ݔty_vue
[0];

92 
	`dk_g_my_addss
(&
my_addss
);

93 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

94 
pdu_n
 =

95 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

96 &
du_da
);

97 #i
PRINT_ENABLED


98 
	`rtf
(
dr
, "CCOV: Received Notification!\n");

100 i(
rvi_da
->
gmd_mesge
) {

101 
n
 =

102 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

103 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

104 
ue
);

105 #i
PRINT_ENABLED


106 
	`rtf
(
dr
, "CCOV: Segmented message. Sending Abort!\n");

108 
CCOV_ABORT
;

111 
n
 =

112 
	`cov_nify_decode_rvi_que
(
rvi_que
, 
rvi_n
,

113 &
cov_da
);

114 #i
PRINT_ENABLED


115 i(
n
 > 0) {

116 
	`rtf
(
dr
, "CCOV: PID=%u ", 
cov_da
.
subsibProssIdtifr
);

117 
	`rtf
(
dr
, "=%u ", 
cov_da
.
tgDeviIdtifr
);

118 
	`rtf
(
dr
, "%s %u ",

119 
	`baext_obje_ty_me
(
cov_da
.
mڙedObjeIdtifr
.
ty
),

120 
cov_da
.
mڙedObjeIdtifr
.

);

121 
	`rtf
(
dr
, "timmag=%u secd", 
cov_da
.
timeRemag
);

122 
	`rtf
(
dr
, "\n");

123 
pPrݔty_vue
 = &
ݔty_vue
[0];

124 
pPrݔty_vue
) {

125 
	`rtf
(
dr
, "CCOV: ");

126 i(
pPrݔty_vue
->
ݔtyIdtifr
 < 512) {

127 
	`rtf
(
dr
, "%s ",

128 
baext_ݔty_me


129 (
pPrݔty_vue
->
ݔtyIdtifr
));

131 
	`rtf
(
dr
, "proprietary %u ",

132 
pPrݔty_vue
->
ݔtyIdtifr
);

134 i(
pPrݔty_vue
->
ݔtyAayIndex
 !
BACNET_ARRAY_ALL
) {

135 
	`rtf
(
dr
, "%u ", 
pPrݔty_vue
->
ݔtyAayIndex
);

137 
	`rtf
(
dr
, "\n");

138 
pPrݔty_vue
 =Prݔty_vue->
xt
;

143 i(
n
 <= 0) {

144 
n
 =

145 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

146 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

147 #i
PRINT_ENABLED


148 
	`rtf
(
dr
, "CCOV: Bad Encoding. Sending Abort!\n");

150 
CCOV_ABORT
;

152 
n
 =

153 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

154 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_COV_NOTIFICATION
);

155 #i
PRINT_ENABLED


156 
	`rtf
(
dr
, "CCOV: Sending Simple Ack!\n");

159 
CCOV_ABORT
:

160 
pdu_n
 +
n
;

161 
bys_
 =

162 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

163 
pdu_n
);

164 #i
PRINT_ENABLED


165 i(
bys_
 <= 0) {

166 
	`rtf
(
dr
, "CCOV: Faedأnd PDU (%s)!\n", 
	`
(
o
));

169 
bys_
 = bytes_sent;

173 
	}
}

	@demo/handler/h_cov.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"ba.h
"

34 
	~"bacdcode.h
"

35 
	~"baddr.h
"

36 
	~"du.h
"

37 
	~"du.h
"

38 
	~"abt.h
"

39 
	~"je.h
"

40 
	~"cov.h
"

41 
	~"tsm.h
"

42 
	~"dcc.h
"

43 #i
PRINT_ENABLED


44 
	~"baext.h
"

47 
	~"devi.h
"

48 
	~"hdrs.h
"

52 
	sBACt_COV_Addss
{

53 
bo
 
	mvid
:1;

54 
BACNET_ADDRESS
 
	mde
;

55 } 
	tBACNET_COV_ADDRESS
;

59 
	sBACt_COV_Substi_Fgs
 {

60 
bo
 
	mvid
:1;

61 
bo
 
	missueCfmedNifitis
:1;

62 
bo
 
	mnd_queed
:1;

63 } 
	tBACNET_COV_SUBSCRIPTION_FLAGS
;

65 
	sBACt_COV_Substi
 {

66 
BACNET_COV_SUBSCRIPTION_FLAGS
 
	mag
;

67 
ut8_t
 
	mde_dex
;

68 
ut8_t
 
	mvokeID
;

69 
ut32_t
 
	msubsibProssIdtifr
;

70 
ut32_t
 
	mlitime
;

71 
BACNET_OBJECT_ID
 
	mmڙedObjeIdtifr
;

72 } 
	tBACNET_COV_SUBSCRIPTION
;

74 #ide
MAX_COV_SUBCRIPTIONS


75 
	#MAX_COV_SUBCRIPTIONS
 128

	)

77 
BACNET_COV_SUBSCRIPTION
 
	gCOV_Substis
[
MAX_COV_SUBCRIPTIONS
];

78 #ide
MAX_COV_ADDRESSES


79 
	#MAX_COV_ADDRESSES
 16

	)

81 
BACNET_COV_ADDRESS
 
	gCOV_Addss
[
MAX_COV_ADDRESSES
];

91 
BACNET_ADDRESS
 *
	$cov_addss_g
(

92 
dex
)

94 
BACNET_ADDRESS
 *
cov_de
 = 
NULL
;

96 i(
dex
 < 
MAX_COV_ADDRESSES
) {

97 i(
COV_Addss
[
dex
].
vid
) {

98 
cov_de
 = &
COV_Addss
[
dex
].
de
;

102  
cov_de
;

103 
	}
}

109 
	$cov_addss_move_unud
()

111 
dex
 = 0;

112 
cov_dex
 = 0;

113 
bo
 
found
 = 
l
;

115 
cov_dex
 = 0; cov_dex < 
MAX_COV_ADDRESSES
; cov_index++) {

116 i(
COV_Addss
[
cov_dex
].
vid
) {

117 
found
 = 
l
;

118 
dex
 = 0; index < 
MAX_COV_SUBCRIPTIONS
; index++) {

119 i((
COV_Substis
[
dex
].
ag
.
vid
) &&

120 (
COV_Substis
[
dex
].
de_dex
 =
cov_dex
)) {

121 
found
 = 
ue
;

125 i(!
found
) {

126 
COV_Addss
[
cov_dex
].
vid
 = 
l
;

130 
	}
}

139 
	$cov_addss_add
(

140 
BACNET_ADDRESS
 *
de
)

142 
dex
 = -1;

143 
i
 = 0;

144 
bo
 
found
 = 
l
;

145 
bo
 
vid
 = 
l
;

146 
BACNET_ADDRESS
 *
cov_de
 = 
NULL
;

148 i(
de
) {

149 
i
 = 0; i < 
MAX_COV_ADDRESSES
; i++) {

150 
vid
 = 
COV_Addss
[
i
].valid;

151 i(
vid
) {

152 
cov_de
 = &
COV_Addss
[
i
].
de
;

153 
found
 = 
	`ba_addss_me
(
de
, 
cov_de
);

154 i(
found
) {

155 
dex
 = 
i
;

160 i(!
found
) {

162 
i
 = 0; i < 
MAX_COV_ADDRESSES
; i++) {

163 
vid
 = 
COV_Addss
[
i
].valid;

164 i(!
vid
) {

165 
dex
 = 
i
;

166 
cov_de
 = &
COV_Addss
[
i
].
de
;

167 
	`ba_addss_cy
(
cov_de
, 
de
);

168 
COV_Addss
[
i
].
vid
 = 
ue
;

175  
dex
;

176 
	}
}

205 
	$cov_code_substi
(

206 
ut8_t
 * 
du
,

207 
max_du
,

208 
BACNET_COV_SUBSCRIPTION
 * 
cov_substi
)

210 
n
 = 0;

211 
du_n
 = 0;

212 
BACNET_OCTET_STRING
 
o_rg
;

213 
BACNET_ADDRESS
 *
de
 = 
NULL
;

217 
max_du
 = max_apdu;

218 i(!
cov_substi
) {

221 
de
 = 
	`cov_addss_g
(
cov_substi
->
de_dex
);

222 i(!
de
) {

226 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 0);

227 
du_n
 +
n
;

229 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 0);

230 
du_n
 +
n
;

232 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 1);

233 
du_n
 +
n
;

236 
n
 = 
	`code_iti_unsigd
(&
du
[
du_n
], 
de
->
t
);

237 
du_n
 +
n
;

240 i(
de
->
t
) {

241 
	`org_
(&
o_rg
, &
de
->
adr
[0], de->
n
);

243 
	`org_
(&
o_rg
, &
de
->
mac
[0], de->
mac_n
);

245 
n
 = 
	`code_iti_o_rg
(&
du
[
du_n
], &
o_rg
);

246 
du_n
 +
n
;

248 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 1);

249 
du_n
 +
n
;

251 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 0);

252 
du_n
 +
n
;

254 
n
 =

255 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1,

256 
cov_substi
->
subsibProssIdtifr
);

257 
du_n
 +
n
;

259 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 0);

260 
du_n
 +
n
;

262 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 1);

263 
du_n
 +
n
;

265 
n
 =

266 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0,

267 
cov_substi
->
mڙedObjeIdtifr
.
ty
,

268 
cov_substi
->
mڙedObjeIdtifr
.

);

269 
du_n
 +
n
;

272 
n
 = 
	`code_cڋxt_umed
(&
du
[
du_n
], 1, 
PROP_PRESENT_VALUE
);

273 
du_n
 +
n
;

275 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 1);

276 
du_n
 +
n
;

278 
n
 =

279 
	`code_cڋxt_boޗn
(&
du
[
du_n
], 2,

280 
cov_substi
->
ag
.
issueCfmedNifitis
);

281 
du_n
 +
n
;

283 
n
 =

284 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 3,

285 
cov_substi
->
litime
);

286 
du_n
 +
n
;

288  
du_n
;

289 
	}
}

302 
	$hdr_cov_code_substis
(

303 
ut8_t
 * 
du
,

304 
max_du
)

306 
n
 = 0;

307 
du_n
 = 0;

308 
dex
 = 0;

310 i(
du
) {

311 
dex
 = 0; index < 
MAX_COV_SUBCRIPTIONS
; index++) {

312 i(
COV_Substis
[
dex
].
ag
.
vid
) {

313 
n
 =

314 
	`cov_code_substi
(&
du
[
du_n
],

315 
max_du
 - 
du_n
, &
COV_Substis
[
dex
]);

316 
du_n
 +
n
;

318 i(
du_n
 > 
max_du
) {

325  
du_n
;

326 
	}
}

331 
	$hdr_cov_
(

334 
dex
 = 0;

336 
dex
 = 0; index < 
MAX_COV_SUBCRIPTIONS
; index++) {

337 
COV_Substis
[
dex
].
ag
.
vid
 = 
l
;

338 
COV_Substis
[
dex
].
de_dex
 = -1;

339 
COV_Substis
[
dex
].
subsibProssIdtifr
 = 0;

340 
COV_Substis
[
dex
].
mڙedObjeIdtifr
.
ty
 =

341 
OBJECT_ANALOG_INPUT
;

342 
COV_Substis
[
dex
].
mڙedObjeIdtifr
.

 = 0;

343 
COV_Substis
[
dex
].
ag
.
issueCfmedNifitis
 = 
l
;

344 
COV_Substis
[
dex
].
vokeID
 = 0;

345 
COV_Substis
[
dex
].
litime
 = 0;

346 
COV_Substis
[
dex
].
ag
.
nd_queed
 = 
l
;

348 
dex
 = 0; index < 
MAX_COV_ADDRESSES
; index++) {

349 
COV_Addss
[
dex
].
vid
 = 
l
;

351 
	}
}

353 
bo
 
	$cov_li_subsibe
(

354 
BACNET_ADDRESS
 * 
c
,

355 
BACNET_SUBSCRIBE_COV_DATA
 * 
cov_da
,

356 
BACNET_ERROR_CLASS
 * 
r_ass
,

357 
BACNET_ERROR_CODE
 * 
r_code
)

359 
bo
 
exig_y
 = 
l
;

360 
dex
;

361 
f_vid_dex
 = -1;

362 
bo
 
found
 = 
ue
;

363 
bo
 
addss_mch
 = 
l
;

364 
BACNET_ADDRESS
 *
de
 = 
NULL
;

370 
dex
 = 0; index < 
MAX_COV_SUBCRIPTIONS
; index++) {

371 i(
COV_Substis
[
dex
].
ag
.
vid
) {

372 
de
 = 
	`cov_addss_g
(
COV_Substis
[
dex
].
de_dex
);

373 i(
de
) {

374 
addss_mch
 = 
	`ba_addss_me
(
c
, 
de
);

377 
addss_mch
 = 
ue
;

379 i((
COV_Substis
[
dex
].
mڙedObjeIdtifr
.
ty
 ==

380 
cov_da
->
mڙedObjeIdtifr
.
ty
) &&

381 (
COV_Substis
[
dex
].
mڙedObjeIdtifr
.

 ==

382 
cov_da
->
mڙedObjeIdtifr
.

) &&

383 (
COV_Substis
[
dex
].
subsibProssIdtifr
 ==

384 
cov_da
->
subsibProssIdtifr
&& 
addss_mch
) {

385 
exig_y
 = 
ue
;

386 i(
cov_da
->
nΩiReque
) {

387 
COV_Substis
[
dex
].
ag
.
vid
 = 
l
;

388 
COV_Substis
[
dex
].
de_dex
 = -1;

389 
	`cov_addss_move_unud
();

391 
COV_Substis
[
dex
].
de_dex
 = 
	`cov_addss_add
(
c
);

392 
COV_Substis
[
dex
].
ag
.
issueCfmedNifitis
 =

393 
cov_da
->
issueCfmedNifitis
;

394 
COV_Substis
[
dex
].
litime
 = 
cov_da
->lifetime;

395 
COV_Substis
[
dex
].
ag
.
nd_queed
 = 
ue
;

397 i(
COV_Substis
[
dex
].
vokeID
) {

398 
	`tsm__voke_id
(
COV_Substis
[
dex
].
vokeID
);

399 
COV_Substis
[
dex
].
vokeID
 = 0;

404 i(
f_vid_dex
 < 0) {

405 
f_vid_dex
 = 
dex
;

409 i(!
exig_y
 && (
f_vid_dex
 >= 0) &&

410 (!
cov_da
->
nΩiReque
)) {

411 
dex
 = 
f_vid_dex
;

412 
found
 = 
ue
;

413 
COV_Substis
[
dex
].
ag
.
vid
 = 
ue
;

414 
COV_Substis
[
dex
].
de_dex
 = 
	`cov_addss_add
(
c
);

415 
COV_Substis
[
dex
].
mڙedObjeIdtifr
.
ty
 =

416 
cov_da
->
mڙedObjeIdtifr
.
ty
;

417 
COV_Substis
[
dex
].
mڙedObjeIdtifr
.

 =

418 
cov_da
->
mڙedObjeIdtifr
.

;

419 
COV_Substis
[
dex
].
subsibProssIdtifr
 =

420 
cov_da
->
subsibProssIdtifr
;

421 
COV_Substis
[
dex
].
ag
.
issueCfmedNifitis
 =

422 
cov_da
->
issueCfmedNifitis
;

423 
COV_Substis
[
dex
].
vokeID
 = 0;

424 
COV_Substis
[
dex
].
litime
 = 
cov_da
->lifetime;

425 
COV_Substis
[
dex
].
ag
.
nd_queed
 = 
ue
;

426 } i(!
exig_y
) {

427 i(
f_vid_dex
 < 0) {

429 *
r_ass
 = 
ERROR_CLASS_RESOURCES
;

430 *
r_code
 = 
ERROR_CODE_NO_SPACE_TO_ADD_LIST_ELEMENT
;

431 
found
 = 
l
;

438 
found
 = 
ue
;

442  
found
;

443 
	}
}

445 
bo
 
	$cov_nd_que
(

446 
BACNET_COV_SUBSCRIPTION
 * 
cov_substi
,

447 
BACNET_PROPERTY_VALUE
 * 
vue_li
)

449 
n
 = 0;

450 
pdu_n
 = 0;

451 
BACNET_NPDU_DATA
 
du_da
;

452 
BACNET_ADDRESS
 
my_addss
;

453 
bys_
 = 0;

454 
ut8_t
 
voke_id
 = 0;

455 
bo
 
us
 = 
l
;

456 
BACNET_COV_DATA
 
cov_da
;

457 
BACNET_ADDRESS
 *
de
 = 
NULL
;

459 i(!
	`dcc_communiti_abd
()) {

460  
us
;

462 #i
PRINT_ENABLED


463 
	`rtf
(
dr
, "COVnotification:equested\n");

465 i(!
cov_substi
) {

466  
us
;

468 
de
 = 
	`cov_addss_g
(
cov_substi
->
de_dex
);

469 i(!
de
) {

470 #i
PRINT_ENABLED


471 
	`rtf
(
dr
, "COVnotification: destot found!\n");

473  
us
;

475 
	`dk_g_my_addss
(&
my_addss
);

476 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

477 
pdu_n
 =

478 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
de
,

479 &
my_addss
, &
du_da
);

481 
cov_da
.
subsibProssIdtifr
 =

482 
cov_substi
->
subsibProssIdtifr
;

483 
cov_da
.
tgDeviIdtifr
 = 
	`Devi_Obje_In_Numb
();

484 
cov_da
.
mڙedObjeIdtifr
.
ty
 =

485 
cov_substi
->
mڙedObjeIdtifr
.
ty
;

486 
cov_da
.
mڙedObjeIdtifr
.

 =

487 
cov_substi
->
mڙedObjeIdtifr
.

;

488 
cov_da
.
timeRemag
 = 
cov_substi
->
litime
;

489 
cov_da
.
liOfVues
 = 
vue_li
;

490 i(
cov_substi
->
ag
.
issueCfmedNifitis
) {

491 
du_da
.
da_exg_y
 = 
ue
;

492 
voke_id
 = 
	`tsm_xt__vokeID
();

493 i(
voke_id
) {

494 
cov_substi
->
vokeID
 = 
voke_id
;

495 
n
 =

496 
	`ccov_nify_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

497 
voke_id
, &
cov_da
);

499 
COV_FAILED
;

502 
n
 =

503 
	`ucov_nify_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

504 &
cov_da
);

506 
pdu_n
 +
n
;

507 i(
cov_substi
->
ag
.
issueCfmedNifitis
) {

508 
	`tsm_t_cfmed_ungmd_i
(
voke_id
,

509 
de
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

510 (
ut16_t

pdu_n
);

512 
bys_
 =

513 
	`dk_nd_pdu
(
de
, &
du_da
,

514 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

515 i(
bys_
 > 0) {

516 
us
 = 
ue
;

517 #i
PRINT_ENABLED


518 
	`rtf
(
dr
, "COVnotification: Sent!\n");

522 
COV_FAILED
:

524  
us
;

525 
	}
}

527 
	$cov_litime_expi_hdr
(

528 
dex
,

529 
ut32_t
 
d_cds
,

530 
ut32_t
 
litime_cds
)

532 i(
dex
 < 
MAX_COV_SUBCRIPTIONS
) {

534 i(
litime_cds
 >
d_cds
) {

535 
COV_Substis
[
dex
].
litime
 -
d_cds
;

537 
	`rtf
(
dr
, "COVtim: substi[%d].litime=%lu\n", 
dex
,

538 (
COV_Substis
[
dex
].
litime
);

541 
COV_Substis
[
dex
].
litime
 = 0;

543 i(
COV_Substis
[
dex
].
litime
 == 0) {

545 #i
PRINT_ENABLED


546 
	`rtf
(
dr
, "COVtimer: PID=%u ",

547 
COV_Substis
[
dex
].
subsibProssIdtifr
);

548 
	`rtf
(
dr
, "%s %u ",

549 
	`baext_obje_ty_me
(
COV_Substis
[
dex
].

550 
mڙedObjeIdtifr
.
ty
),

551 
COV_Substis
[
dex
].
mڙedObjeIdtifr
.

);

552 
	`rtf
(
dr
, "timeemaining=%u seconds ",

553 
COV_Substis
[
dex
].
litime
);

554 
	`rtf
(
dr
, "\n");

556 
COV_Substis
[
dex
].
ag
.
vid
 = 
l
;

557 
COV_Substis
[
dex
].
de_dex
 = -1;

558 
	`cov_addss_move_unud
();

559 i(
COV_Substis
[
dex
].
ag
.
issueCfmedNifitis
) {

560 i(
COV_Substis
[
dex
].
vokeID
) {

561 
	`tsm__voke_id
(
COV_Substis
[
dex
].
vokeID
);

562 
COV_Substis
[
dex
].
vokeID
 = 0;

567 
	}
}

590 
	$hdr_cov_tim_cds
(

591 
ut32_t
 
d_cds
)

593 
dex
 = 0;

594 
ut32_t
 
litime_cds
 = 0;

596 i(
d_cds
) {

598 
dex
 = 0; index < 
MAX_COV_SUBCRIPTIONS
; index++) {

599 i(
COV_Substis
[
dex
].
ag
.
vid
) {

600 
litime_cds
 = 
COV_Substis
[
dex
].
litime
;

601 i(
litime_cds
) {

603 
	`cov_litime_expi_hdr
(
dex
, 
d_cds
,

604 
litime_cds
);

609 
	}
}

611 
bo
 
	$hdr_cov_fsm
(

614 
dex
 = 0;

615 
BACNET_OBJECT_TYPE
 
obje_ty
 = 
MAX_BACNET_OBJECT_TYPE
;

616 
ut32_t
 
obje_
 = 0;

617 
bo
 
us
 = 
l
;

618 
bo
 
nd
 = 
l
;

619 
BACNET_PROPERTY_VALUE
 
vue_li
[2];

622 
COV_STATE_IDLE
 = 0,

623 
COV_STATE_MARK
,

624 
COV_STATE_CLEAR
,

625 
COV_STATE_FREE
,

626 
COV_STATE_SEND


627 } 
cov_sk_e
 = 
COV_STATE_IDLE
;

629 
cov_sk_e
) {

630 
COV_STATE_IDLE
:

631 
dex
 = 0;

632 
cov_sk_e
 = 
COV_STATE_MARK
;

634 
COV_STATE_MARK
:

636 i(
COV_Substis
[
dex
].
ag
.
vid
) {

637 
obje_ty
 = (
BACNET_OBJECT_TYPE
)

638 
COV_Substis
[
dex
].
mڙedObjeIdtifr
.
ty
;

639 
obje_
 =

640 
COV_Substis
[
dex
].

641 
mڙedObjeIdtifr
.

;

642 
us
 = 
	`Devi_COV
(
obje_ty
, 
obje_
);

643 i(
us
) {

644 
COV_Substis
[
dex
].
ag
.
nd_queed
 = 
ue
;

645 #i
PRINT_ENABLED


646 
	`rtf
(
dr
, "COVtask: Marking...\n");

650 
dex
++;

651 i(
dex
 >
MAX_COV_SUBCRIPTIONS
) {

652 
dex
 = 0;

653 
cov_sk_e
 = 
COV_STATE_CLEAR
;

656 
COV_STATE_CLEAR
:

658 i((
COV_Substis
[
dex
].
ag
.
vid
) &&

659 (
COV_Substis
[
dex
].
ag
.
nd_queed
)) {

660 
obje_ty
 = (
BACNET_OBJECT_TYPE
)

661 
COV_Substis
[
dex
].
mڙedObjeIdtifr
.
ty
;

662 
obje_
 =

663 
COV_Substis
[
dex
].

664 
mڙedObjeIdtifr
.

;

665 
	`Devi_COV_Cˬ
(
obje_ty
, 
obje_
);

667 
dex
++;

668 i(
dex
 >
MAX_COV_SUBCRIPTIONS
) {

669 
dex
 = 0;

670 
cov_sk_e
 = 
COV_STATE_FREE
;

673 
COV_STATE_FREE
:

675 i((
COV_Substis
[
dex
].
ag
.
vid
) &&

676 (
COV_Substis
[
dex
].
ag
.
issueCfmedNifitis
) &&

677 (
COV_Substis
[
dex
].
vokeID
)) {

678 i(
	`tsm_voke_id_
(
COV_Substis
[
dex
].
vokeID
)) {

679 
COV_Substis
[
dex
].
vokeID
 = 0;

681 i(
	`tsm_voke_id_ed
(
COV_Substis


682 [
dex
].
vokeID
)) {

683 
	`tsm__voke_id
(
COV_Substis
[
dex
].
vokeID
);

684 
COV_Substis
[
dex
].
vokeID
 = 0;

687 
dex
++;

688 i(
dex
 >
MAX_COV_SUBCRIPTIONS
) {

689 
dex
 = 0;

690 
cov_sk_e
 = 
COV_STATE_SEND
;

693 
COV_STATE_SEND
:

695 i((
COV_Substis
[
dex
].
ag
.
vid
) &&

696 (
COV_Substis
[
dex
].
ag
.
nd_queed
)) {

697 
nd
 = 
ue
;

698 i(
COV_Substis
[
dex
].
ag
.
issueCfmedNifitis
) {

699 i(
COV_Substis
[
dex
].
vokeID
 != 0) {

701 
nd
 = 
l
;

703 i(!
	`tsm_i_avaab
()) {

705 
nd
 = 
l
;

708 i(
nd
) {

709 
obje_ty
 = (
BACNET_OBJECT_TYPE
)

710 
COV_Substis
[
dex
].

711 
mڙedObjeIdtifr
.
ty
;

712 
obje_
 =

713 
COV_Substis
[
dex
].

714 
mڙedObjeIdtifr
.

;

715 #i
PRINT_ENABLED


716 
	`rtf
(
dr
, "COVtask: Sending...\n");

719 
vue_li
[0].
xt
 = &value_list[1];

720 
vue_li
[1].
xt
 = 
NULL
;

721 
us
 =

722 
	`Devi_Encode_Vue_Li
(
obje_ty
,

723 
obje_
, &
vue_li
[0]);

724 i(
us
) {

725 
us
 =

726 
	`cov_nd_que
(&
COV_Substis
[
dex
],

727 &
vue_li
[0]);

729 i(
us
) {

730 
COV_Substis
[
dex
].
ag
.
nd_queed
 = 
l
;

734 
dex
++;

735 i(
dex
 >
MAX_COV_SUBCRIPTIONS
) {

736 
dex
 = 0;

737 
cov_sk_e
 = 
COV_STATE_IDLE
;

741 
dex
 = 0;

742 
cov_sk_e
 = 
COV_STATE_IDLE
;

746  (
cov_sk_e
 =
COV_STATE_IDLE
);

747 
	}
}

749 
	$hdr_cov_sk
(

752 
	`hdr_cov_fsm
();

753 
	}
}

755 
bo
 
	$cov_subsibe
(

756 
BACNET_ADDRESS
 * 
c
,

757 
BACNET_SUBSCRIBE_COV_DATA
 * 
cov_da
,

758 
BACNET_ERROR_CLASS
 * 
r_ass
,

759 
BACNET_ERROR_CODE
 * 
r_code
)

761 
bo
 
us
 = 
l
;

762 
BACNET_OBJECT_TYPE
 
obje_ty
 = 
MAX_BACNET_OBJECT_TYPE
;

763 
ut32_t
 
obje_
 = 0;

765 
obje_ty
 =

766 (
BACNET_OBJECT_TYPE

cov_da
->
mڙedObjeIdtifr
.
ty
;

767 
obje_
 = 
cov_da
->
mڙedObjeIdtifr
.

;

768 
us
 = 
	`Devi_Vid_Obje_Id
(
obje_ty
, 
obje_
);

769 i(
us
) {

770 
us
 = 
	`Devi_Vue_Li_Su܋d
(
obje_ty
);

771 i(
us
) {

772 
us
 =

773 
	`cov_li_subsibe
(
c
, 
cov_da
, 
r_ass
, 
r_code
);

775 *
r_ass
 = 
ERROR_CLASS_OBJECT
;

776 *
r_code
 = 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

779 *
r_ass
 = 
ERROR_CLASS_OBJECT
;

780 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

783  
us
;

784 
	}
}

803 
	$hdr_cov_subsibe
(

804 
ut8_t
 * 
rvi_que
,

805 
ut16_t
 
rvi_n
,

806 
BACNET_ADDRESS
 * 
c
,

807 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

809 
BACNET_SUBSCRIBE_COV_DATA
 
cov_da
;

810 
n
 = 0;

811 
pdu_n
 = 0;

812 
du_n
 = 0;

813 
du_n
 = 0;

814 
BACNET_NPDU_DATA
 
du_da
;

815 
bo
 
sucss
 = 
l
;

816 
bys_
 = 0;

817 
BACNET_ADDRESS
 
my_addss
;

818 
bo
 
r
 = 
l
;

821 
cov_da
.
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

823 
	`dk_g_my_addss
(&
my_addss
);

824 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

825 
du_n
 =

826 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

827 &
du_da
);

828 i(
rvi_da
->
gmd_mesge
) {

830 
n
 = 
BACNET_STATUS_ABORT
;

831 #i
PRINT_ENABLED


832 
	`rtf
(
dr
, "SubscribeCOV: Segmented message. Sending Abort!\n");

834 
r
 = 
ue
;

835 
COV_ABORT
;

837 
n
 =

838 
	`cov_subsibe_decode_rvi_que
(
rvi_que
, 
rvi_n
,

839 &
cov_da
);

840 #i
PRINT_ENABLED


841 i(
n
 <= 0)

842 
	`rtf
(
dr
, "SubscribeCOV: Unableo decode Request!\n");

844 i(
n
 < 0) {

845 
r
 = 
ue
;

846 
COV_ABORT
;

848 
cov_da
.
r_ass
 = 
ERROR_CLASS_OBJECT
;

849 
cov_da
.
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

850 
sucss
 =

851 
	`cov_subsibe
(
c
, &
cov_da
, &cov_da.
r_ass
,

852 &
cov_da
.
r_code
);

853 i(
sucss
) {

854 
du_n
 =

855 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
du_n
],

856 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_SUBSCRIBE_COV
);

857 #i
PRINT_ENABLED


858 
	`rtf
(
dr
, "SubscribeCOV: Sending Simple Ack!\n");

861 
n
 = 
BACNET_STATUS_ERROR
;

862 
r
 = 
ue
;

863 #i
PRINT_ENABLED


864 
	`rtf
(
dr
, "SubscribeCOV: Sending Error!\n");

867 
COV_ABORT
:

868 i(
r
) {

869 i(
n
 =
BACNET_STATUS_ABORT
) {

870 
du_n
 =

871 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

872 
rvi_da
->
voke_id
,

873 
	`abt_cvt_r_code
(
cov_da
.
r_code
), 
ue
);

874 #i
PRINT_ENABLED


875 
	`rtf
(
dr
, "SubscribeCOV: Sending Abort!\n");

877 } i(
n
 =
BACNET_STATUS_ERROR
) {

878 
du_n
 =

879 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

880 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_SUBSCRIBE_COV
,

881 
cov_da
.
r_ass
, cov_da.
r_code
);

882 #i
PRINT_ENABLED


883 
	`rtf
(
dr
, "SubscribeCOV: Sending Error!\n");

885 } i(
n
 =
BACNET_STATUS_REJECT
) {

886 
du_n
 =

887 
	`je_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

888 
rvi_da
->
voke_id
,

889 
	`je_cvt_r_code
(
cov_da
.
r_code
));

890 #i
PRINT_ENABLED


891 
	`rtf
(
dr
, "SubscribeCOV: Sending Reject!\n");

895 
pdu_n
 = 
du_n
 + 
du_n
;

896 
bys_
 =

897 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

898 
pdu_n
);

899 i(
bys_
 <= 0) {

900 #i
PRINT_ENABLED


901 
	`rtf
(
dr
, "SubscribeCOV: Failedo send PDU (%s)!\n",

902 
	`
(
o
));

907 
	}
}

	@demo/handler/h_dcc.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~"je.h
"

39 
	~"dcc.h
"

40 
	~"hdrs.h
"

41 
	~"devi.h
"

45 
	gMy_Passwd
[32] = "filister";

50 
	$hdr_dcc_sswd_t
(

51 *
w_sswd
)

53 
size_t
 
i
 = 0;

55 i(
w_sswd
) {

56 
i
 = 0; i < ((
My_Passwd
) - 1); i++) {

57 
My_Passwd
[
i
] = 
w_sswd
[i];

58 
My_Passwd
[
i
 + 1] = 0;

59 i(
w_sswd
[
i
] == 0) {

64 
i
 = 0; i < (
My_Passwd
); i++) {

65 
My_Passwd
[
i
] = 0;

68 
	}
}

90 
	$hdr_devi_communiti_cڌ
(

91 
ut8_t
 * 
rvi_que
,

92 
ut16_t
 
rvi_n
,

93 
BACNET_ADDRESS
 * 
c
,

94 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

96 
ut16_t
 
timeDuti
 = 0;

97 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
e
 = 
COMMUNICATION_ENABLE
;

98 
BACNET_CHARACTER_STRING
 
sswd
;

99 
n
 = 0;

100 
pdu_n
 = 0;

101 
BACNET_NPDU_DATA
 
du_da
;

102 
BACNET_ADDRESS
 
my_addss
;

105 
	`dk_g_my_addss
(&
my_addss
);

106 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

107 
pdu_n
 =

108 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

109 &
du_da
);

110 #i
PRINT_ENABLED


111 
	`rtf
(
dr
, "DeviceCommunicationControl!\n");

113 i(
rvi_da
->
gmd_mesge
) {

114 
n
 =

115 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

116 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

117 
ue
);

118 #i
PRINT_ENABLED


119 
	`rtf
(
dr
,

123 
DCC_ABORT
;

126 
n
 =

127 
	`dcc_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
timeDuti
,

128 &
e
, &
sswd
);

129 #i
PRINT_ENABLED


130 i(
n
 > 0)

131 
	`rtf
(
dr
,

133 (
timeDuti
, (
e
,

134 
	`charg_vue
(&
sswd
));

137 i(
n
 < 0) {

138 
n
 =

139 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

140 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

141 #i
PRINT_ENABLED


142 
	`rtf
(
dr
,

146 
DCC_ABORT
;

148 i(
e
 >
MAX_BACNET_COMMUNICATION_ENABLE_DISABLE
) {

149 
n
 =

150 
	`je_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

151 
rvi_da
->
voke_id
, 
REJECT_REASON_UNDEFINED_ENUMERATION
);

152 #i
PRINT_ENABLED


153 
	`rtf
(
dr
,

158 #i
BAC_ROUTING


160 
n
 =

161 
Roud_Devi_Svi_Arov


162 (
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
, (
e
,

163 &
Hdr_Tnsm_Bufr
[
pdu_n
], 
rvi_da
->
voke_id
);

164 i(
n
 > 0)

165 
DCC_ABORT
;

168 i(
	`charg_si_me
(&
sswd
, 
My_Passwd
)) {

169 
n
 =

170 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

171 
rvi_da
->
voke_id
,

172 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
);

173 #i
PRINT_ENABLED


174 
	`rtf
(
dr
,

177 
	`dcc_t_us_duti
(
e
, 
timeDuti
);

179 
n
 =

180 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

181 
rvi_da
->
voke_id
,

182 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

183 
ERROR_CLASS_SECURITY
, 
ERROR_CODE_PASSWORD_FAILURE
);

184 #i
PRINT_ENABLED


185 
	`rtf
(
dr
,

191 
DCC_ABORT
:

192 
pdu_n
 +
n
;

193 
n
 =

194 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

195 
pdu_n
);

196 i(
n
 <= 0) {

197 #i
PRINT_ENABLED


198 
	`rtf
(
dr
,

200 
	`
(
o
));

205 
	}
}

	@demo/handler/h_gas_a.c

37 
	~<as.h
>

38 
	~"cfig.h
"

39 
	~"txbuf.h
"

40 
	~"bacdef.h
"

41 
	~"bacdcode.h
"

42 
	~"ba.h
"

43 
	~"du.h
"

44 
	~"du.h
"

45 
	~"abt.h
"

46 
	~"hdrs.h
"

47 
	~"g_m_sum.h
"

58 
	$g_m_summy_ack_hdr
(

59 
ut8_t
 * 
rvi_que
,

60 
ut16_t
 
rvi_n
,

61 
BACNET_ADDRESS
 * 
c
,

62 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

64 
ut16_t
 
du_n
 = 0;

65 
ut16_t
 
n
 = 0;

66 
BACNET_GET_ALARM_SUMMARY_DATA
 
da
;

68 
rvi_n
 - 
n
) {

69 
du_n
 =

70 
	`g_m_summy_ack_decode_du_da
(&
rvi_que
[
n
],

71 
rvi_n
 - 
n
, &
da
);

73 
n
 +
du_n
;

75 i(
du_n
 > 0) {

81 
	}
}

	@demo/handler/h_get_alarm_sum.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~"hdrs.h
"

42 
g_m_summy_funi
 
	gG_Arm_Summy
[
MAX_BACNET_OBJECT_TYPE
];

44 
	$hdr_g_m_summy_t
(

45 
BACNET_OBJECT_TYPE
 
obje_ty
,

46 
g_m_summy_funi
 
pFuni
)

48 i(
obje_ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

49 
G_Arm_Summy
[
obje_ty
] = 
pFuni
;

51 
	}
}

53 
	$hdr_g_m_summy
(

54 
ut8_t
 * 
rvi_que
,

55 
ut16_t
 
rvi_n
,

56 
BACNET_ADDRESS
 * 
c
,

57 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

59 
n
 = 0;

60 
pdu_n
 = 0;

61 
du_n
 = 0;

62 
bys_
 = 0;

63 
m_vue
 = 0;

64 
i
 = 0;

65 
j
 = 0;

66 
bo
 
r
 = 
l
;

67 
BACNET_ADDRESS
 
my_addss
;

68 
BACNET_NPDU_DATA
 
du_da
;

69 
BACNET_GET_ALARM_SUMMARY_DATA
 
gm_da
;

74 
	`dk_g_my_addss
(&
my_addss
);

75 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

76 
pdu_n
 =

77 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

78 &
du_da
);

79 i(
rvi_da
->
gmd_mesge
) {

81 
du_n
 =

82 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

83 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

84 
ue
);

85 #i
PRINT_ENABLED


86 
	`rtf
(
dr
,

89 
GET_ALARM_SUMMARY_ABORT
;

93 
du_n
 =

94 
	`g_m_summy_ack_code_du_
(&
Hdr_Tnsm_Bufr


95 [
pdu_n
], 
rvi_da
->
voke_id
);

98 
i
 = 0; i < 
MAX_BACNET_OBJECT_TYPE
; i++) {

99 i(
G_Arm_Summy
[
i
]) {

100 
j
 = 0; j < 0xffff; j++) {

101 
m_vue
 = 
G_Arm_Summy
[
i
] (
j
, &
gm_da
);

102 i(
m_vue
 > 0) {

103 
n
 =

104 
g_m_summy_ack_code_du_da


105 (&
Hdr_Tnsm_Bufr
[
pdu_n
 + 
du_n
],

106 
rvi_da
->
max_
 - 
du_n
, &
gm_da
);

107 i(
n
 <= 0) {

108 
r
 = 
ue
;

109 
GET_ALARM_SUMMARY_ERROR
;

111 
du_n
 +
n
;

112 } i(
m_vue
 < 0) {

120 #i
PRINT_ENABLED


121 
	`rtf
(
dr
, "GetAlarmSummary: Sendingesponse!\n");

124 
GET_ALARM_SUMMARY_ERROR
:

125 i(
r
) {

126 i(
n
 =
BACNET_STATUS_ABORT
) {

128 
du_n
 =

129 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

130 
rvi_da
->
voke_id
,

131 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
, 
ue
);

132 #i
PRINT_ENABLED


133 
	`rtf
(
dr
,

137 
du_n
 =

138 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

139 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_GET_ALARM_SUMMARY
,

140 
ERROR_CLASS_PROPERTY
, 
ERROR_CODE_OTHER
);

141 #i
PRINT_ENABLED


142 
	`rtf
(
dr
, "GetAlarmSummary: Sending Error!\n");

148 
GET_ALARM_SUMMARY_ABORT
:

149 
pdu_n
 +
du_n
;

150 
bys_
 =

151 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

152 
pdu_n
);

153 #i
PRINT_ENABLED


154 i(
bys_
 <= 0) {

158 
bys_
 = bytes_sent;

162 
	}
}

	@demo/handler/h_getevent.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~"evt.h
"

39 
	~"gevt.h
"

40 
	~"hdrs.h
"

44 
g_evt_fo_funi
 
	gG_Evt_Info
[
MAX_BACNET_OBJECT_TYPE
];

46 
	$hdr_g_evt_fmi_t
(

47 
BACNET_OBJECT_TYPE
 
obje_ty
,

48 
g_evt_fo_funi
 
pFuni
)

50 i(
obje_ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

51 
G_Evt_Info
[
obje_ty
] = 
pFuni
;

53 
	}
}

55 
	$hdr_g_evt_fmi
(

56 
ut8_t
 * 
rvi_que
,

57 
ut16_t
 
rvi_n
,

58 
BACNET_ADDRESS
 * 
c
,

59 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

61 
n
 = 0;

62 
pdu_n
 = 0;

63 
du_n
 = 0;

64 
BACNET_NPDU_DATA
 
du_da
;

65 
bo
 
r
 = 
l
;

66 
bo
 
me_evts
 = 
l
;

67 
bys_
 = 0;

68 
BACNET_ERROR_CLASS
 
r_ass
 = 
ERROR_CLASS_OBJECT
;

69 
BACNET_ERROR_CODE
 
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

70 
BACNET_ADDRESS
 
my_addss
;

71 
BACNET_OBJECT_ID
 
obje_id
;

72 
i
 = 0, 
j
 = 0;

73 
BACNET_GET_EVENT_INFORMATION_DATA
 
gevt_da
;

74 
vid_evt
 = 0;

77 
obje_id
.
ty
 = 
MAX_BACNET_OBJECT_TYPE
;

80 
	`dk_g_my_addss
(&
my_addss
);

81 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

82 
pdu_n
 =

83 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

84 &
du_da
);

85 i(
rvi_da
->
gmd_mesge
) {

87 
n
 =

88 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

89 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

90 
ue
);

91 #i
PRINT_ENABLED


92 
	`rtf
(
dr
,

95 
GET_EVENT_ABORT
;

98 
n
 =

99 
	`gevt_decode_rvi_que
(
rvi_que
, 
rvi_n
,

100 &
obje_id
);

101 i(
n
 < 0) {

103 
n
 =

104 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

105 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

106 #i
PRINT_ENABLED


107 
	`rtf
(
dr
,

110 
GET_EVENT_ABORT
;

112 
n
 =

113 
	`gevt_ack_code_du_
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

114 (
Hdr_Tnsm_Bufr
- 
pdu_n
, 
rvi_da
->
voke_id
);

115 i(
n
 <= 0) {

116 
r
 = 
ue
;

117 
GET_EVENT_ERROR
;

119 
pdu_n
 +
n
;

120 
du_n
 = 
n
;

121 
i
 = 0; i < 
MAX_BACNET_OBJECT_TYPE
; i++) {

122 i(
G_Evt_Info
[
i
]) {

123 
j
 = 0; j < 0xffff; j++) {

124 
vid_evt
 = 
G_Evt_Info
[
i
] (
j
, &
gevt_da
);

125 i(
vid_evt
 > 0) {

127 i(
obje_id
.
ty
 !
MAX_BACNET_OBJECT_TYPE
) {

128 i((
obje_id
.
ty
 ==

129 
gevt_da
.
objeIdtifr
.
ty
) &&

130 (
obje_id
.

 ==

131 
gevt_da
.
objeIdtifr
.

)) {

134 
obje_id
.
ty
 = 
MAX_BACNET_OBJECT_TYPE
;

139 
gevt_da
.
xt
 = 
NULL
;

140 
n
 =

141 
	`gevt_ack_code_du_da
(&
Hdr_Tnsm_Bufr


142 [
pdu_n
], (
Hdr_Tnsm_Bufr
) -du_len,

143 &
gevt_da
);

144 i(
n
 <= 0) {

145 
r
 = 
ue
;

146 
GET_EVENT_ERROR
;

148 
du_n
 +
n
;

149 i((
du_n
 >
rvi_da
->
max_
 - 2) ||

150 (
du_n
 >
MAX_APDU
 - 2)) {

155 i((
rvi_da
->
max_
 < 128) ||

156 (
MAX_APDU
 < 128)) {

157 
n
 = 
BACNET_STATUS_ABORT
;

158 
r
 = 
ue
;

159 
GET_EVENT_ERROR
;

161 
me_evts
 = 
ue
;

165 
pdu_n
 +
n
;

167 } i(
vid_evt
 < 0) {

173 
n
 =

174 
	`gevt_ack_code_du_d
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

175 (
Hdr_Tnsm_Bufr
- 
pdu_n
, 
me_evts
);

176 i(
n
 <= 0) {

177 
r
 = 
ue
;

178 
GET_EVENT_ERROR
;

180 #i
PRINT_ENABLED


181 
	`rtf
(
dr
, "GetEventInformation: Sending Ack!\n");

183 
GET_EVENT_ERROR
:

184 i(
r
) {

185 
pdu_n
 =

186 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

187 &
du_da
);

189 i(
n
 == -2) {

191 
n
 =

192 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

193 
rvi_da
->
voke_id
,

194 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
, 
ue
);

195 #i
PRINT_ENABLED


196 
	`rtf
(
dr
,

200 
n
 =

201 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

202 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_READ_PROPERTY
,

203 
r_ass
, 
r_code
);

204 #i
PRINT_ENABLED


205 
	`rtf
(
dr
, "GetEventInformation: Sending Error!\n");

209 
GET_EVENT_ABORT
:

210 
pdu_n
 +
n
;

211 
bys_
 =

212 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

213 
pdu_n
);

214 #i
PRINT_ENABLED


215 i(
bys_
 <= 0)

216 
	`rtf
(
dr
, "Faedأnd PDU (%s)!\n", 
	`
(
o
));

220 
	}
}

	@demo/handler/h_getevent_a.c

39 
	~<as.h
>

40 
	~"cfig.h
"

41 
	~"txbuf.h
"

42 
	~"bacdef.h
"

43 
	~"bacdcode.h
"

44 
	~"ba.h
"

45 
	~"du.h
"

46 
	~"du.h
"

47 
	~"abt.h
"

48 
	~"hdrs.h
"

49 
	~"gevt.h
"

52 
	#MAX_NUMBER_OF_EVENTS
 ((
MAX_APDU
 / 40+ 1)

	)

62 
	$g_evt_ack_hdr
(

63 
ut8_t
 *
rvi_que
,

64 
ut16_t
 
rvi_n
,

65 
BACNET_ADDRESS
 *
c
,

66 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 *
rvi_da
)

68 
ut8_t
 
i
 = 0;

69 
ut16_t
 
du_n
 = 0;

70 
bo
 
me_evts
 = 
l
;

73 
BACNET_GET_EVENT_INFORMATION_DATA
 
g_evt_da
[
MAX_NUMBER_OF_EVENTS
];

75 
i
 = 1; i < 
MAX_NUMBER_OF_EVENTS
; i++) {

77 
g_evt_da
[
i
 - 1].
xt
 = &get_event_data[i];

80 
du_n
 =

81 
	`gevt_ack_decode_rvi_que
(&
rvi_que
[0],

82 
rvi_n
, &
g_evt_da
[0], &
me_evts
);

84 i(
du_n
 > 0) {

87 
	}
}

	@demo/handler/h_iam.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~"cfig.h
"

29 
	~"txbuf.h
"

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"m.h
"

33 
	~"addss.h
"

34 
	~"hdrs.h
"

45 
	$hdr_i_am_add
(

46 
ut8_t
 * 
rvi_que
,

47 
ut16_t
 
rvi_n
,

48 
BACNET_ADDRESS
 * 
c
)

50 
n
 = 0;

51 
ut32_t
 
devi_id
 = 0;

52 
max_du
 = 0;

53 
gmti
 = 0;

54 
ut16_t
 
vd_id
 = 0;

56 (
rvi_n
;

57 
n
 =

58 
	`m_decode_rvi_que
(
rvi_que
, &
devi_id
, &
max_du
,

59 &
gmti
, &
vd_id
);

60 #i
PRINT_ENABLED


61 
	`rtf
(
dr
, "Received I-Am Request");

63 i(
n
 != -1) {

64 #i
PRINT_ENABLED


65 
	`rtf
(
dr
, " from %lu, MAC = %d.%d.%d.%d.%d.%d\n",

66 (
devi_id
, 
c
->
mac
[0], src->mac[1], src->mac[2],

67 
c
->
mac
[3], src->mac[4], src->mac[5]);

69 
	`addss_add
(
devi_id
, 
max_du
, 
c
);

71 #i
PRINT_ENABLED


72 
	`rtf
(
dr
, ", but unableo decode it.\n");

77 
	}
}

87 
	$hdr_i_am_bd
(

88 
ut8_t
 * 
rvi_que
,

89 
ut16_t
 
rvi_n
,

90 
BACNET_ADDRESS
 * 
c
)

92 
n
 = 0;

93 
ut32_t
 
devi_id
 = 0;

94 
max_du
 = 0;

95 
gmti
 = 0;

96 
ut16_t
 
vd_id
 = 0;

98 (
rvi_n
;

99 
n
 =

100 
	`m_decode_rvi_que
(
rvi_que
, &
devi_id
, &
max_du
,

101 &
gmti
, &
vd_id
);

102 i(
n
 > 0) {

104 
	`addss_add_bdg
(
devi_id
, 
max_du
, 
c
);

108 
	}
}

	@demo/handler/h_ihave.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~"cfig.h
"

29 
	~"txbuf.h
"

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"baext.h
"

33 
	~"ihave.h
"

34 
	~"hdrs.h
"

44 
	$hdr_i_have
(

45 
ut8_t
 * 
rvi_que
,

46 
ut16_t
 
rvi_n
,

47 
BACNET_ADDRESS
 * 
c
)

49 
n
 = 0;

50 
BACNET_I_HAVE_DATA
 
da
;

52 (
rvi_n
;

53 (
c
;

54 
n
 = 
	`ihave_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

55 i(
n
 != -1) {

56 #i
PRINT_ENABLED


57 
	`rtf
(
dr
, "I-Have: %s %lu from %s %lu!\r\n",

58 
	`baext_obje_ty_me
(
da
.
obje_id
.
ty
),

59 (
da
.
obje_id
.

,

60 
	`baext_obje_ty_me
(
da
.
devi_id
.
ty
),

61 (
da
.
devi_id
.

);

64 #i
PRINT_ENABLED


65 
	`rtf
(
dr
, "I-Have:eceived, but unableo decode!\n");

70 
	}
}

	@demo/handler/h_lso.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"du.h
"

35 
	~"du.h
"

36 
	~"abt.h
"

37 
	~"lso.h
"

38 
	~"hdrs.h
"

39 
	~"devi.h
"

43 
	$hdr_lso
(

44 
ut8_t
 * 
rvi_que
,

45 
ut16_t
 
rvi_n
,

46 
BACNET_ADDRESS
 * 
c
,

47 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

49 
BACNET_LSO_DATA
 
da
;

50 
n
 = 0;

51 
pdu_n
 = 0;

52 
BACNET_NPDU_DATA
 
du_da
;

53 
bys_
 = 0;

54 
BACNET_ADDRESS
 
my_addss
;

57 
	`dk_g_my_addss
(&
my_addss
);

58 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

59 
pdu_n
 =

60 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

61 &
du_da
);

62 i(
rvi_da
->
gmd_mesge
) {

64 
n
 =

65 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

66 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

67 
ue
);

68 #i
PRINT_ENABLED


69 
	`rtf
(
dr
, "LSO: Segmented message. Sending Abort!\n");

71 
LSO_ABORT
;

74 
n
 = 
	`lso_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

75 #i
PRINT_ENABLED


76 i(
n
 <= 0)

77 
	`rtf
(
dr
, "LSO: Unableo decode Request!\n");

79 i(
n
 < 0) {

81 
n
 =

82 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

83 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

84 #i
PRINT_ENABLED


85 
	`rtf
(
dr
, "LSO: Bad Encoding. Sending Abort!\n");

87 
LSO_ABORT
;

93 #i
PRINT_ENABLED


94 
	`rtf
(
dr
,

96 
da
.
ݔi
, (da.
ossId
,

97 (
da
.
rgObje
.

);

100 
n
 =

101 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

102 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_LIFE_SAFETY_OPERATION
);

103 #i
PRINT_ENABLED


104 
	`rtf
(
dr
, "Life Safety Operation: " "Sending Simple Ack!\n");

107 
LSO_ABORT
:

108 
pdu_n
 +
n
;

109 
bys_
 =

110 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

111 
pdu_n
);

112 #i
PRINT_ENABLED


113 i(
bys_
 <= 0)

114 
	`rtf
(
dr
, "Life Safety Operation: " "Failedo send PDU (%s)!\n",

115 
	`
(
o
));

119 
	}
}

	@demo/handler/h_npdu.c

25 
	~<dbo.h
>

26 
	~<dt.h
>

27 
	~"bacdef.h
"

28 
	~"bacdcode.h
"

29 
	~"bact.h
"

30 
	~"banum.h
"

31 
	~"bs.h
"

32 
	~"du.h
"

33 
	~"du.h
"

34 
	~"hdrs.h
"

35 
	~".h
"

37 #i
PRINT_ENABLED


38 
	~<dio.h
>

66 
	$du_hdr
(

67 
BACNET_ADDRESS
 * 
c
,

68 
ut8_t
 * 
pdu
,

69 
ut16_t
 
pdu_n
)

71 
du_offt
 = 0;

72 
BACNET_ADDRESS
 
de
 = { 0 };

73 
BACNET_NPDU_DATA
 
du_da
 = { 0 };

76 i(
pdu
[0] =
BACNET_PROTOCOL_VERSION
) {

77 
du_offt
 = 
	`du_decode
(&
pdu
[0], &
de
, 
c
, &
du_da
);

78 i(
du_da
.
twk_y_mesge
) {

80 #i
PRINT_ENABLED


81 
	`rtf
(
dr
, "NPDU: Network Layer Message discarded!\n");

83 } i((
du_offt
 > 0&& (du_off<
pdu_n
)) {

84 i((
de
.
t
 =0|| (de.È=
BACNET_BROADCAST_NETWORK
)) {

88 i((
de
.
t
 =
BACNET_BROADCAST_NETWORK
) &&

89 ((
pdu
[
du_offt
] & 0xF0) ==

90 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)) {

95 
	`du_hdr
(
c
, &
pdu
[
du_offt
],

96 (
ut16_t
(
pdu_n
 - 
du_offt
));

99 #i
PRINT_ENABLED


100 
	`tf
("NPDU: DNET=%u. Disrded!\n", (
de
.
t
);

105 #i
PRINT_ENABLED


106 
	`tf
("NPDU: BACnet Protocol Version=%u. Discarded!\n",

107 (
pdu
[0]);

112 
	}
}

	@demo/handler/h_pt.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"du.h
"

35 
	~"du.h
"

36 
	~"abt.h
"

39 #i
defed
(
BACFILE
)

40 
	~"bacfe.h
"

42 
	~"myda.h
"

43 
	~"nsr.h
"

44 
	~"hdrs.h
"

48 
	#MYMAXSTR
 32

	)

49 
	#MYMAXBLOCK
 8

	)

51 
DATABLOCK
 
	gMyDa
[
MYMAXBLOCK
];

53 
ut8_t
 
	gIOBufrPT
[
MAX_APDU
];

55 
	$ProssPT
(

56 
BACNET_PRIVATE_TRANSFER_DATA
 * 
da
)

58 
iL
;

59 
cBlockNumb
;

60 
ut32_t
 
ulTemp
;

61 
g_n
;

62 
ut8_t
 
g_numb
;

63 
ut32_t
 
n_vue_ty
;

64 
BACNET_CHARACTER_STRING
 
bsTemp
;

66 
iL
 = 0;

69 
g_n
 =

70 
	`decode_g_numb_d_vue
(&
da
->
rviPams
[
iL
],

71 &
g_numb
, &
n_vue_ty
);

72 
iL
 +
g_n
;

73 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

76 
da
->
rviPamsL
 = 0;

80 
iL
 +=

81 
	`decode_unsigd
(&
da
->
rviPams
[
iL
], 
n_vue_ty
,

82 &
ulTemp
);

83 
cBlockNumb
 = (
ulTemp
;

84 i(
cBlockNumb
 < 
MY_MAX_BLOCK
) {

85 i(
da
->
rviNumb
 =
MY_SVC_READ
) {

96 
iL
 = 0;

99 
iL
 +
	`code_iti_unsigd
(&
IOBufrPT
[iL], 
MY_ERR_OK
);

101 
iL
 +=

102 
	`code_iti_unsigd
(&
IOBufrPT
[
iL
], 
cBlockNumb
);

104 
iL
 +=

105 
	`code_iti_unsigd
(&
IOBufrPT
[
iL
],

106 
MyDa
[(
t8_t

cBlockNumb
].
cMyBy1
);

107 
iL
 +=

108 
	`code_iti_unsigd
(&
IOBufrPT
[
iL
],

109 
MyDa
[(
t8_t

cBlockNumb
].
cMyBy2
);

110 
iL
 +=

111 
	`code_iti_
(&
IOBufrPT
[
iL
],

112 
MyDa
[(
t8_t

cBlockNumb
].
fMyRl
);

113 
	`charg__si
(&
bsTemp
,

114 (*
MyDa
[(
t8_t

cBlockNumb
].
sMySg
);

115 
iL
 +=

116 
	`code_iti_cha_rg
(&
IOBufrPT
[
iL
],

117 &
bsTemp
);

127 
g_n
 =

128 
	`decode_g_numb_d_vue
(&
da
->
rviPams
[
iL
],

129 &
g_numb
, &
n_vue_ty
);

130 
iL
 +
g_n
;

131 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

132 
da
->
rviPamsL
 = 0;

135 
iL
 +=

136 
	`decode_unsigd
(&
da
->
rviPams
[
iL
], 
n_vue_ty
,

137 &
ulTemp
);

138 
MyDa
[(
t8_t

cBlockNumb
].
cMyBy1
 = (
ulTemp
;

140 
g_n
 =

141 
	`decode_g_numb_d_vue
(&
da
->
rviPams
[
iL
],

142 &
g_numb
, &
n_vue_ty
);

143 
iL
 +
g_n
;

144 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

145 
da
->
rviPamsL
 = 0;

148 
iL
 +=

149 
	`decode_unsigd
(&
da
->
rviPams
[
iL
], 
n_vue_ty
,

150 &
ulTemp
);

151 
MyDa
[(
t8_t

cBlockNumb
].
cMyBy2
 = (
ulTemp
;

153 
g_n
 =

154 
	`decode_g_numb_d_vue
(&
da
->
rviPams
[
iL
],

155 &
g_numb
, &
n_vue_ty
);

156 
iL
 +
g_n
;

157 i(
g_numb
 !
BACNET_APPLICATION_TAG_REAL
) {

158 
da
->
rviPamsL
 = 0;

161 
iL
 +=

162 
	`decode_
(&
da
->
rviPams
[
iL
],

163 &
MyDa
[(
t8_t

cBlockNumb
].
fMyRl
);

165 
g_n
 =

166 
	`decode_g_numb_d_vue
(&
da
->
rviPams
[
iL
],

167 &
g_numb
, &
n_vue_ty
);

168 
iL
 +
g_n
;

169 i(
g_numb
 !
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

170 
da
->
rviPamsL
 = 0;

173 
	`decode_cha_rg
(&
da
->
rviPams
[
iL
],

174 
n_vue_ty
, &
bsTemp
);

176 
	`y
((*
MyDa
[(
t8_t

cBlockNumb
].
sMySg
,

177 
	`charg_vue
(&
bsTemp
), 
MY_MAX_STR
);

179 
MyDa
[(
t8_t

cBlockNumb
].
sMySg
[
MY_MAX_STR
] = '\0';

181 
iL
 = 
	`code_iti_unsigd
(&
IOBufrPT
[0], 
MY_ERR_OK
);

185 
iL
 = 
	`code_iti_unsigd
(&
IOBufrPT
[0], 
MY_ERR_BAD_INDEX
);

187 
da
->
rviPamsL
 = 
iL
;

188 
da
->
rviPams
 = 
IOBufrPT
;

189 
	}
}

202 
	$hdr_cf_ive_s
(

203 
ut8_t
 * 
rvi_que
,

204 
ut16_t
 
rvi_n
,

205 
BACNET_ADDRESS
 * 
c
,

206 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

208 
BACNET_PRIVATE_TRANSFER_DATA
 
da
;

209 
n
;

210 
pdu_n
;

211 
bo
 
r
;

212 
bys_
;

213 
BACNET_NPDU_DATA
 
du_da
;

214 
BACNET_ADDRESS
 
my_addss
;

215 
BACNET_ERROR_CLASS
 
r_ass
;

216 
BACNET_ERROR_CODE
 
r_code
;

218 
n
 = 0;

219 
pdu_n
 = 0;

220 
r
 = 
l
;

221 
bys_
 = 0;

222 
r_ass
 = 
ERROR_CLASS_OBJECT
;

223 
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

225 #i
PRINT_ENABLED


226 
	`rtf
(
dr
, "Received Confirmed Private Transfer Request!\n");

231 
	`dk_g_my_addss
(&
my_addss
);

232 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

233 
pdu_n
 =

234 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

235 &
du_da
);

237 i(
rvi_da
->
gmd_mesge
) {

238 
n
 =

239 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

240 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

241 
ue
);

242 #i
PRINT_ENABLED


243 
	`rtf
(
dr
, "CPT: Segmented Message. Sending Abort!\n");

245 
CPT_ABORT
;

248 
n
 =

249 
	`nsr_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

251 i(
n
 < 0) {

252 
n
 =

253 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

254 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

255 #i
PRINT_ENABLED


256 
	`rtf
(
dr
, "CPT: Bad Encoding. Sending Abort!\n");

258 
CPT_ABORT
;

267 i((
da
.
vdID
 =
BACNET_VENDOR_ID
) &&

268 (
da
.
rviNumb
 <
MY_SVC_WRITE
)) {

271 
	`ProssPT
(&
da
);

272 i(
da
.
rviPamsL
 == 0) {

274 
r
 = 
ue
;

275 
r_ass
 = 
ERROR_CLASS_SERVICES
;

276 
r_code
 = 
ERROR_CODE_OTHER
;

277 #i
PRINT_ENABLED


278 
	`rtf
(
dr
, "CPT: Error servicingequest!\n");

281 
n
 =

282 
	`nsr_ack_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

283 
rvi_da
->
voke_id
, &
da
);

286 
r
 = 
ue
;

287 
r_ass
 = 
ERROR_CLASS_SERVICES
;

288 
r_code
 = 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

289 #i
PRINT_ENABLED


290 
	`rtf
(
dr
, "CPT: Not our Vendor ID or invalid service code!\n");

294 i(
r
) {

295 
n
 =

296 
	`nsr_r_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

297 
rvi_da
->
voke_id
, 
r_ass
, 
r_code
, &
da
);

299 
CPT_ABORT
:

300 
pdu_n
 +
n
;

301 
bys_
 =

302 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

303 
pdu_n
);

305 #i
PRINT_ENABLED


306 i(
bys_
 <= 0) {

307 
	`rtf
(
dr
, "Faedأnd PDU (%s)!\n", 
	`
(
o
));

312 
	}
}

	@demo/handler/h_pt_a.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"du.h
"

35 
	~"du.h
"

36 
	~"abt.h
"

39 
	~"nsr.h
"

40 
	~"myda.h
"

41 #i
defed
(
BACFILE
)

42 
	~"bacfe.h
"

44 
	~"hdrs.h
"

48 
ut8_t
 
IOBufrPT
[300];

50 
	$DecodeBlock
(

51 
cBlockNum
,

52 
ut8_t
 * 
pDa
)

54 
iL
;

55 
ut32_t
 
ulTemp
;

56 
g_n
;

57 
ut8_t
 
g_numb
;

58 
ut32_t
 
n_vue_ty
;

59 
BACNET_CHARACTER_STRING
 
bsName
;

60 
DATABLOCK
 
Reڣ
;

62 
iL
 = 0;

64 i(
cBlockNum
 >
MY_MAX_BLOCK
)

67 
g_n
 =

68 
	`decode_g_numb_d_vue
(&
pDa
[
iL
], &
g_numb
,

69 &
n_vue_ty
);

70 
iL
 +
g_n
;

71 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
)

74 
iL
 +
	`decode_unsigd
(&
pDa
[iL], 
n_vue_ty
, &
ulTemp
);

75 
Reڣ
.
cMyBy1
 = (
ulTemp
;

77 
g_n
 =

78 
	`decode_g_numb_d_vue
(&
pDa
[
iL
], &
g_numb
,

79 &
n_vue_ty
);

80 
iL
 +
g_n
;

81 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
)

84 
iL
 +
	`decode_unsigd
(&
pDa
[iL], 
n_vue_ty
, &
ulTemp
);

85 
Reڣ
.
cMyBy2
 = (
ulTemp
;

87 
g_n
 =

88 
	`decode_g_numb_d_vue
(&
pDa
[
iL
], &
g_numb
,

89 &
n_vue_ty
);

90 
iL
 +
g_n
;

91 i(
g_numb
 !
BACNET_APPLICATION_TAG_REAL
)

94 
iL
 +
	`decode_
(&
pDa
[iL], &
Reڣ
.
fMyRl
);

96 
g_n
 =

97 
	`decode_g_numb_d_vue
(&
pDa
[
iL
], &
g_numb
,

98 &
n_vue_ty
);

99 
iL
 +
g_n
;

100 i(
g_numb
 !
BACNET_APPLICATION_TAG_CHARACTER_STRING
)

103 
iL
 +
	`decode_cha_rg
(&
pDa
[iL], 
n_vue_ty
, &
bsName
);

104 
	`y
((*
Reڣ
.
sMySg
, 
	`charg_vue
(&
bsName
),

105 
MY_MAX_STR
);

106 
Reڣ
.
sMySg
[
MY_MAX_STR
] = '\0';

108 
	`tf
("Private Transfer Read Block Response\n");

109 
	`tf
("DBlock: %d\n", (
cBlockNum
);

110 
	`tf
(" F By : %d\n", (
Reڣ
.
cMyBy1
);

111 
	`tf
(" Secd By : %d\n", (
Reڣ
.
cMyBy2
);

112 
	`tf
(" R : %f\n", 
Reڣ
.
fMyRl
);

113 
	`tf
(" Sg : %s\n\n", 
Reڣ
.
sMySg
);

114 
	}
}

116 
	$ProssPTA
(

117 
BACNET_PRIVATE_TRANSFER_DATA
 * 
da
)

119 
iL
;

120 
ut32_t
 
uiECode
;

121 
cBlockNumb
;

122 
ut32_t
 
ulTemp
;

123 
g_n
;

124 
ut8_t
 
g_numb
;

125 
ut32_t
 
n_vue_ty
;

127 
iL
 = 0;

131 
g_n
 =

132 
	`decode_g_numb_d_vue
(&
da
->
rviPams
[
iL
],

133 &
g_numb
, &
n_vue_ty
);

134 
iL
 +
g_n
;

135 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

136 #i
PRINT_ENABLED


137 
	`tf
("CPTA: Bad Encoding!\n");

141 
iL
 +=

142 
	`decode_unsigd
(&
da
->
rviPams
[
iL
], 
n_vue_ty
,

143 &
uiECode
);

145 i(
da
->
rviNumb
 =
MY_SVC_READ
) {

148 i(
uiECode
 =
MY_ERR_OK
) {

150 
g_n
 =

151 
	`decode_g_numb_d_vue
(&
da
->
rviPams
[
iL
],

152 &
g_numb
, &
n_vue_ty
);

153 
iL
 +
g_n
;

154 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

155 #i
PRINT_ENABLED


156 
	`tf
("CPTA: Bad Encoding!\n");

161 
iL
 +=

162 
	`decode_unsigd
(&
da
->
rviPams
[
iL
], 
n_vue_ty
,

163 &
ulTemp
);

164 
cBlockNumb
 = (
ulTemp
;

165 
	`DecodeBlock
(
cBlockNumb
, &
da
->
rviPams
[
iL
]);

167 
tf


169 (
uiECode
);

173 
	`tf
("Private Transfer write operationeturnedrror code: %lu\n",

174 (
uiECode
);

176 
	}
}

186 
	$hdr_cf_ive_s_ack
(

187 
ut8_t
 * 
rvi_que
,

188 
ut16_t
 
rvi_n
,

189 
BACNET_ADDRESS
 * 
c
,

190 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

192 
BACNET_PRIVATE_TRANSFER_DATA
 
da
;

193 
n
;

202 
c
 = src;

203 
rvi_da
 = service_data;

205 
n
 = 0;

209 #i
PRINT_ENABLED


210 
	`tf
("Received Confirmed Private Transfer Ack!\n");

213 
n
 = 
	`nsr_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

214 i(
n
 < 0) {

215 #i
PRINT_ENABLED


216 
	`tf
("cpta: Bad Encoding!\n");

220 
	`ProssPTA
(&
da
);

223 
	}
}

226 
	$PTEHdr
(

227 
BACNET_ADDRESS
 * 
c
,

228 
ut8_t
 
voke_id
,

229 
BACNET_ERROR_CLASS
 
r_ass
,

230 
BACNET_ERROR_CODE
 
r_code
)

233 (
c
;

234 (
voke_id
;

235 
	`tf
("BACnet Error: %s: %s\r\n",

236 
	`baext_r_ass_me
((
r_ass
),

237 
	`baext_r_code_me
((
r_code
));

238 
E_Deed
 = 
ue
;

239 
	}
}

	@demo/handler/h_rd.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~"je.h
"

39 
	~"rd.h
"

41 
	~"devi.h
"

42 
	~"hdrs.h
"

66 
	$hdr_lize_devi
(

67 
ut8_t
 * 
rvi_que
,

68 
ut16_t
 
rvi_n
,

69 
BACNET_ADDRESS
 * 
c
,

70 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

72 
BACNET_REINITIALIZE_DEVICE_DATA
 
rd_da
;

73 
n
 = 0;

74 
pdu_n
 = 0;

75 
BACNET_NPDU_DATA
 
du_da
;

76 
BACNET_ADDRESS
 
my_addss
;

79 
	`dk_g_my_addss
(&
my_addss
);

80 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

81 
pdu_n
 =

82 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

83 &
du_da
);

84 #i
PRINT_ENABLED


85 
	`rtf
(
dr
, "ReinitializeDevice!\n");

87 i(
rvi_da
->
gmd_mesge
) {

88 
n
 =

89 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

90 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

91 
ue
);

92 #i
PRINT_ENABLED


93 
	`rtf
(
dr
,

96 
RD_ABORT
;

99 
n
 =

100 
	`rd_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
rd_da
.
e
,

101 &
rd_da
.
sswd
);

102 #i
PRINT_ENABLED


103 i(
n
 > 0) {

104 
	`rtf
(
dr
, "ReinitializeDevice: state=%uassword=%s\n",

105 (
rd_da
.
e
,

106 
	`charg_vue
(&
rd_da
.
sswd
));

108 
	`rtf
(
dr
, "ReinitializeDevice: Unableo decodeequest!\n");

112 i(
n
 < 0) {

113 
n
 =

114 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

115 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

116 #i
PRINT_ENABLED


117 
	`rtf
(
dr
,

120 
RD_ABORT
;

123 i(
rd_da
.
e
 >
MAX_BACNET_REINITIALIZED_STATE
) {

124 
n
 =

125 
	`je_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

126 
rvi_da
->
voke_id
, 
REJECT_REASON_UNDEFINED_ENUMERATION
);

127 #i
PRINT_ENABLED


128 
	`rtf
(
dr
,

132 #i
BAC_ROUTING


134 
n
 =

135 
Roud_Devi_Svi_Arov


136 (
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
, (
rd_da
.
e
,

137 &
Hdr_Tnsm_Bufr
[
pdu_n
], 
rvi_da
->
voke_id
);

138 i(
n
 > 0)

139 
RD_ABORT
;

142 i(
	`Devi_Relize
(&
rd_da
)) {

143 
n
 =

144 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

145 
rvi_da
->
voke_id
,

146 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
);

147 #i
PRINT_ENABLED


148 
	`rtf
(
dr
, "ReinitializeDevice: Sending Simple Ack!\n");

151 
n
 =

152 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

153 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

154 
rd_da
.
r_ass
,d_da.
r_code
);

155 #i
PRINT_ENABLED


156 
	`rtf
(
dr
, "ReinitializeDevice: Sending Error.\n");

160 
RD_ABORT
:

161 
pdu_n
 +
n
;

162 
n
 =

163 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

164 
pdu_n
);

165 i(
n
 <= 0) {

166 #i
PRINT_ENABLED


167 
	`rtf
(
dr
, "ReinitializeDevice: Failedo send PDU (%s)!\n",

168 
	`
(
o
));

173 
	}
}

	@demo/handler/h_routed_npdu.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"bact.h
"

33 
	~"banum.h
"

34 
	~"bs.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"hdrs.h
"

38 
	~"devi.h
"

39 
	~".h
"

40 
	~"baext.h
"

41 
	~"debug.h
"

43 #i
PRINT_ENABLED


44 
	~<dio.h
>

46 #i
defed
(
BACDL_BIP
)

47 
	~"bvlc.h
"

72 
	$twk_cڌ_hdr
(

73 
BACNET_ADDRESS
 * 
c
,

74 *
DNET_li
,

75 
BACNET_NPDU_DATA
 * 
du_da
,

76 
ut8_t
 * 
du
,

77 
ut16_t
 
du_n
)

79 
ut16_t
 
du_offt
 = 0;

80 
ut16_t
 
dt
 = 0;

81 
ut16_t
 
n
 = 0;

83 
du_da
->
twk_mesge_ty
) {

84 
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
:

89 i(
du_n
 >= 2) {

90 
ut16_t
 
twk
;

91 
n
 +
	`decode_unsigd16
(&
du
[n], &
twk
);

92 i(
twk
 =
DNET_li
[0]) {

93 
	`Sd_I_Am_Rour_To_Nwk
(
DNET_li
);

96 
	`Sd_I_Am_Rour_To_Nwk
(
DNET_li
);

99 
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
:

111 
	`debug_tf
("%s for Networks: ",

112 
baext_twk_y_msg_me


113 (
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
));

114 
du_n
 >= 2) {

115 
n
 = 
	`decode_unsigd16
(&
du
[
du_offt
], &
dt
);

116 
	`debug_tf
("%hu", 
dt
);

117 
du_n
 -
n
;

118 
du_offt
 +
n
;

119 i(
du_n
 >= 2) {

120 
	`debug_tf
(", ");

123 
	`debug_tf
("\n");

125 
NETWORK_MESSAGE_I_COULD_BE_ROUTER_TO_NETWORK
:

128 
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
:

129 i(
du_n
 >= 3) {

130 
	`decode_unsigd16
(&
du
[1], &
dt
);

131 
	`debug_tf
("Received %s for Network: ",

132 
baext_twk_y_msg_me


133 (
NETWORK_MESSAGE_I_COULD_BE_ROUTER_TO_NETWORK
));

134 
	`debug_tf
("%hu, Rs code: %d \n", 
dt
, 
du
[0]);

137 
NETWORK_MESSAGE_ROUTER_BUSY_TO_NETWORK
:

138 
NETWORK_MESSAGE_ROUTER_AVAILABLE_TO_NETWORK
:

141 
NETWORK_MESSAGE_INIT_RT_TABLE
:

146 i(
du_n
 > 0) {

148 i(
du
[0] == 0)

149 
	`Sd_Inlize_Routg_Tab_Ack
(
NULL
, 
DNET_li
);

155 
liTm
 = -1;

156 
	`Sd_Inlize_Routg_Tab_Ack
(
c
, &
liTm
);

161 
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
:

165 
NETWORK_MESSAGE_ESTABLISH_CONNECTION_TO_NETWORK
:

166 
NETWORK_MESSAGE_DISCONNECT_CONNECTION_TO_NETWORK
:

171 
	`Sd_Reje_Mesge_To_Nwk
(
c
,

172 
NETWORK_REJECT_UNKNOWN_MESSAGE_TYPE
, 
DNET_li
[0]);

176 
	}
}

194 
	$roud_du_hdr
(

195 
BACNET_ADDRESS
 * 
c
,

196 
BACNET_ADDRESS
 * 
de
,

197 *
DNET_li
,

198 
ut8_t
 * 
du
,

199 
ut16_t
 
du_n
)

201 
curs
 = 0;

202 
bo
 
bGO
 = 
l
;

204 i(!
	`Roud_Devi_Is_Vid_Nwk
(
de
->
t
, 
DNET_li
)) {

211 #i
	`defed
(
BACDL_BIP
)

214 i(
	`bvlc_g_funi_code
(!
BVLC_ORIGINAL_UNICAST_NPDU
)

221 i(
de
->
n
 > 0) {

222 
	`Sd_Reje_Mesge_To_Nwk
(
c
, 
NETWORK_REJECT_NO_ROUTE
,

223 
de
->
t
);

228 
	`Roud_Devi_GNext
(
de
, 
DNET_li
, &
curs
)) {

229 
	`du_hdr
(
c
, 
du
, 
du_n
);

230 
bGO
 = 
ue
;

231 i(
curs
 < 0)

234 i(!
bGO
) {

237 
	}
}

268 
	$routg_du_hdr
(

269 
BACNET_ADDRESS
 * 
c
,

270 *
DNET_li
,

271 
ut8_t
 * 
pdu
,

272 
ut16_t
 
pdu_n
)

274 
du_offt
 = 0;

275 
BACNET_ADDRESS
 
de
 = { 0 };

276 
BACNET_NPDU_DATA
 
du_da
 = { 0 };

279 i(
pdu
[0] =
BACNET_PROTOCOL_VERSION
) {

280 
du_offt
 = 
	`du_decode
(&
pdu
[0], &
de
, 
c
, &
du_da
);

281 i(
du_offt
 <= 0) {

282 
	`debug_tf
("NPDU: Decoding failed; Discarded!\n");

283 } i(
du_da
.
twk_y_mesge
) {

284 i((
de
.
t
 =0|| (de.È=
BACNET_BROADCAST_NETWORK
)) {

285 
	`twk_cڌ_hdr
(
c
, 
DNET_li
, &
du_da
,

286 &
pdu
[
du_offt
], (
ut16_t
(
pdu_n
 -pdu_offset));

292 } i(
du_offt
 <
pdu_n
) {

293 i((
de
.
t
 =0|| (
du_da
.
h_cou
 > 1))

294 
	`roud_du_hdr
(
c
, &
de
, 
DNET_li
, &
pdu
[
du_offt
],

295 (
ut16_t
(
pdu_n
 - 
du_offt
));

300 
debug_tf


302 (
pdu
[0]);

306 
	}
}

	@demo/handler/h_rp.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"bacdevobjݻf.h
"

36 
	~"du.h
"

37 
	~"du.h
"

38 
	~"abt.h
"

39 
	~"je.h
"

40 
	~".h
"

42 
	~"devi.h
"

43 
	~"hdrs.h
"

67 
	$hdr_ad_ݔty
(

68 
ut8_t
 * 
rvi_que
,

69 
ut16_t
 
rvi_n
,

70 
BACNET_ADDRESS
 * 
c
,

71 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

73 
BACNET_READ_PROPERTY_DATA
 
da
;

74 
n
 = 0;

75 
pdu_n
 = 0;

76 
du_n
 = -1;

77 
du_n
 = -1;

78 
BACNET_NPDU_DATA
 
du_da
;

79 
bo
 
r
 = 
ue
;

80 
bys_
 = 0;

81 
BACNET_ADDRESS
 
my_addss
;

84 
da
.
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

86 
	`dk_g_my_addss
(&
my_addss
);

87 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

88 
du_n
 =

89 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

90 &
du_da
);

91 i(
rvi_da
->
gmd_mesge
) {

93 
n
 = 
BACNET_STATUS_ABORT
;

94 #i
PRINT_ENABLED


95 
	`rtf
(
dr
, "RP: Segmented message. Sending Abort!\n");

97 
RP_FAILURE
;

99 
n
 = 
	`_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

100 #i
PRINT_ENABLED


101 i(
n
 <= 0) {

102 
	`rtf
(
dr
, "RP: Unableo decode Request!\n");

105 i(
n
 < 0) {

107 
r
 = 
ue
;

108 #i
PRINT_ENABLED


109 
	`rtf
(
dr
, "RP: Bad Encoding.\n");

111 
RP_FAILURE
;

114 i((
da
.
obje_ty
 =
OBJECT_DEVICE
) &&

115 (
da
.
obje_
 =
BACNET_MAX_INSTANCE
)) {

116 
da
.
obje_
 = 
	`Devi_Obje_In_Numb
();

119 
du_n
 =

120 
	`_ack_code_du_
(&
Hdr_Tnsm_Bufr
[
du_n
],

121 
rvi_da
->
voke_id
, &
da
);

123 
da
.
iti_da
 = &
Hdr_Tnsm_Bufr
[
du_n
 + 
du_n
];

124 
da
.
iti_da_n
 =

125 (
Hdr_Tnsm_Bufr
- (
du_n
 + 
du_n
);

126 
n
 = 
	`Devi_Rd_Prݔty
(&
da
);

127 i(
n
 >= 0) {

128 
du_n
 +
n
;

129 
n
 =

130 
	`_ack_code_du_obje_ݔty_d
(&
Hdr_Tnsm_Bufr


131 [
du_n
 + 
du_n
]);

132 
du_n
 +
n
;

133 i(
du_n
 > 
rvi_da
->
max_
) {

137 
da
.
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

138 
n
 = 
BACNET_STATUS_ABORT
;

139 #i
PRINT_ENABLED


140 
	`rtf
(
dr
, "RP: Messageooarge.\n");

143 #i
PRINT_ENABLED


146 
r
 = 
l
;

149 #i
PRINT_ENABLED


150 
	`rtf
(
dr
, "RP: Device_Read_Property: ");

151 i(
n
 =
BACNET_STATUS_ABORT
) {

152 
	`rtf
(
dr
, "Abort!\n");

153 } i(
n
 =
BACNET_STATUS_ERROR
) {

154 
	`rtf
(
dr
, "Error!\n");

155 } i(
n
 =
BACNET_STATUS_REJECT
) {

156 
	`rtf
(
dr
, "Reject!\n");

158 
	`rtf
(
dr
, "UnknowL=%d\n", 
n
);

163 
RP_FAILURE
:

164 i(
r
) {

165 i(
n
 =
BACNET_STATUS_ABORT
) {

166 
du_n
 =

167 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

168 
rvi_da
->
voke_id
,

169 
	`abt_cvt_r_code
(
da
.
r_code
), 
ue
);

170 #i
PRINT_ENABLED


171 
	`rtf
(
dr
, "RP: Sending Abort!\n");

173 } i(
n
 =
BACNET_STATUS_ERROR
) {

174 
du_n
 =

175 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

176 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_READ_PROPERTY
,

177 
da
.
r_ass
,pda.
r_code
);

178 #i
PRINT_ENABLED


179 
	`rtf
(
dr
, "RP: Sending Error!\n");

181 } i(
n
 =
BACNET_STATUS_REJECT
) {

182 
du_n
 =

183 
	`je_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

184 
rvi_da
->
voke_id
,

185 
	`je_cvt_r_code
(
da
.
r_code
));

186 #i
PRINT_ENABLED


187 
	`rtf
(
dr
, "RP: Sending Reject!\n");

192 
pdu_n
 = 
du_n
 + 
du_n
;

193 
bys_
 =

194 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

195 
pdu_n
);

196 i(
bys_
 <= 0) {

197 #i
PRINT_ENABLED


198 
	`rtf
(
dr
, "Faedأnd PDU (%s)!\n", 
	`
(
o
));

203 
	}
}

	@demo/handler/h_rp_a.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dlib.h
>

28 
	~"cfig.h
"

29 
	~"txbuf.h
"

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"addss.h
"

33 
	~"tsm.h
"

34 
	~"du.h
"

35 
	~"du.h
"

36 
	~"devi.h
"

37 
	~"dk.h
"

38 
	~"baext.h
"

39 
	~".h
"

41 
	~"hdrs.h
"

42 
	~"txbuf.h
"

49 
	$_ack_t_da
(

50 
BACNET_READ_PROPERTY_DATA
 * 
da
)

52 
BACNET_OBJECT_PROPERTY_VALUE
 
obje_vue
;

53 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

54 
n
 = 0;

55 
ut8_t
 *
iti_da
;

56 
iti_da_n
;

57 
bo
 
f_vue
 = 
ue
;

58 
bo
 
t_b
 = 
l
;

60 i(
da
) {

61 
iti_da
 = 
da
->application_data;

62 
iti_da_n
 = 
da
->application_data_len;

66 
n
 =

67 
	`ba_decode_iti_da
(
iti_da
,

68 (
ut8_t

iti_da_n
, &
vue
);

69 i(
f_vue
 && (
n
 < 
iti_da_n
)) {

70 
f_vue
 = 
l
;

71 #i
PRINT_ENABLED


72 
	`rtf
(
dout
, "{");

74 
t_b
 = 
ue
;

76 
obje_vue
.
obje_ty
 = 
da
->object_type;

77 
obje_vue
.
obje_
 = 
da
->object_instance;

78 
obje_vue
.
obje_ݔty
 = 
da
->object_property;

79 
obje_vue
.
y_dex
 = 
da
->array_index;

80 
obje_vue
.
vue
 = &value;

81 
	`ba_t_vue
(
dout
, &
obje_vue
);

82 i(
n
 > 0) {

83 i(
n
 < 
iti_da_n
) {

84 
iti_da
 +
n
;

85 
iti_da_n
 -
n
;

87 #i
PRINT_ENABLED


88 
	`rtf
(
dout
, ",");

97 #i
PRINT_ENABLED


98 i(
t_b
)

99 
	`rtf
(
dout
, "}");

100 
	`rtf
(
dout
, "\r\n");

103 
	}
}

117 
	$hdr_ad_ݔty_ack
(

118 
ut8_t
 * 
rvi_que
,

119 
ut16_t
 
rvi_n
,

120 
BACNET_ADDRESS
 * 
c
,

121 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

123 
n
 = 0;

124 
BACNET_READ_PROPERTY_DATA
 
da
;

126 (
c
;

127 (
rvi_da
;

128 
n
 = 
	`_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

130 
	`rtf
(
dr
, "Received Read-Property Ack!\n");

132 i(
n
 > 0)

133 
	`_ack_t_da
(&
da
);

134 
	}
}

150 
	$_ack_fuy_decode_rvi_que
(

151 
ut8_t
 * 
du
,

152 
du_n
,

153 
BACNET_READ_ACCESS_DATA
 * 
ad_acss_da
)

155 
decoded_n
 = 0;

156 
BACNET_READ_PROPERTY_DATA
 
1da
;

157 
BACNET_PROPERTY_REFERENCE
 *
1_ݔty
;

158 
BACNET_APPLICATION_DATA_VALUE
 *
vue
, *
d_vue
;

159 
ut8_t
 *
vda
;

160 
vn
, 
n
;

162 
decoded_n
 = 
	`_ack_decode_rvi_que
(
du
, 
du_n
, &
1da
);

163 i(
decoded_n
 > 0) {

167 
ad_acss_da
->
obje_ty
 = 
1da
.object_type;

168 
ad_acss_da
->
obje_
 = 
1da
.object_instance;

169 
1_ݔty
 = 
	`oc
(1, (
BACNET_PROPERTY_REFERENCE
));

170 
ad_acss_da
->
liOfPrݔts
 = 
1_ݔty
;

171 i(
1_ݔty
 =
NULL
) {

173  
BACNET_STATUS_ERROR
;

175 
1_ݔty
->
ݔtyIdtifr
 = 
1da
.
obje_ݔty
;

176 
1_ݔty
->
ݔtyAayIndex
 = 
1da
.
y_dex
;

183 
vda
 = 
1da
.
iti_da
;

184 
vn
 = 
1da
.
iti_da_n
;

185 
vue
 = 
	`oc
(1, (
BACNET_APPLICATION_DATA_VALUE
));

186 
1_ݔty
->
vue
 = value;

187 
d_vue
 = 
vue
;

188 
vue
 && 
vda
 && (
vn
 > 0)) {

189 i(
	`IS_CONTEXT_SPECIFIC
(*
vda
)) {

190 
n
 =

191 
	`ba_decode_cڋxt_da
(
vda
, 
vn
, 
vue
,

192 
1_ݔty
->
ݔtyIdtifr
);

194 
n
 = 
	`ba_decode_iti_da
(
vda
, 
vn
, 
vue
);

196 i(
n
 < 0) {

198 
vue
) {

200 
d_vue
 = 
vue
;

201 
vue
 = vue->
xt
;

202 
	`
(
d_vue
);

204 
	`
(
1_ݔty
);

205 
ad_acss_da
->
liOfPrݔts
 = 
NULL
;

206  
n
;

208 
decoded_n
 +
n
;

209 
vn
 -
n
;

210 
vda
 +
n
;

212 i(
vn
 && 
	`decode_is_osg_g_numb
(
vda
, 3)) {

213 
decoded_n
++;

214 
vn
--;

215 
vda
++;

218 i(
n
 == 0) {

220 
vue
) {

222 
d_vue
 = 
vue
;

223 
vue
 = vue->
xt
;

224 
	`
(
d_vue
);

226 
	`
(
1_ݔty
);

227 
ad_acss_da
->
liOfPrݔts
 = 
NULL
;

228  
BACNET_STATUS_ERROR
;

230 i(
vn
 > 0) {

232 
d_vue
 = 
vue
;

233 
vue
 = 
	`oc
(1, (
BACNET_APPLICATION_DATA_VALUE
));

234 
d_vue
->
xt
 = 
vue
;

240  
decoded_n
;

241 
	}
}

	@demo/handler/h_rpm.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<rg.h
>

31 
	~<o.h
>

32 
	~"cfig.h
"

33 
	~"txbuf.h
"

34 
	~"memcy.h
"

35 
	~"bacdef.h
"

36 
	~"bacdcode.h
"

37 
	~"du.h
"

38 
	~"du.h
"

39 
	~"abt.h
"

40 
	~"je.h
"

41 
	~"ba.h
"

42 
	~"m.h
"

43 
	~"hdrs.h
"

45 
	~"devi.h
"

49 
ut8_t
 
	gTemp_Buf
[
MAX_APDU
] = { 0 };

51 
BACNET_PROPERTY_ID
 
	$RPM_Obje_Prݔty
(

52 
ecl_ݔty_li_t
 *
pPrݔtyLi
,

53 
BACNET_PROPERTY_ID
 
ecl_ݔty
,

54 
dex
)

56 
ݔty
 = -1;

57 
qued
, 
tiڮ
, 
rry
;

59 
qued
 = 
pPrݔtyLi
->
Requed
.
cou
;

60 
tiڮ
 = 
pPrݔtyLi
->
Oiڮ
.
cou
;

61 
rry
 = 
pPrݔtyLi
->
Prrry
.
cou
;

62 i(
ecl_ݔty
 =
PROP_ALL
) {

63 i(
dex
 < 
qued
) {

64 
ݔty
 = 
pPrݔtyLi
->
Requed
.
pLi
[
dex
];

65 } i(
dex
 < (
qued
 + 
tiڮ
)) {

66 
dex
 -
qued
;

67 
ݔty
 = 
pPrݔtyLi
->
Oiڮ
.
pLi
[
dex
];

68 } i(
dex
 < (
qued
 + 
tiڮ
 + 
rry
)) {

69 
dex
 -(
qued
 + 
tiڮ
);

70 
ݔty
 = 
pPrݔtyLi
->
Prrry
.
pLi
[
dex
];

72 } i(
ecl_ݔty
 =
PROP_REQUIRED
) {

73 i(
dex
 < 
qued
) {

74 
ݔty
 = 
pPrݔtyLi
->
Requed
.
pLi
[
dex
];

76 } i(
ecl_ݔty
 =
PROP_OPTIONAL
) {

77 i(
dex
 < 
tiڮ
) {

78 
ݔty
 = 
pPrݔtyLi
->
Oiڮ
.
pLi
[
dex
];

82  (
BACNET_PROPERTY_ID

ݔty
;

83 
	}
}

85 
	$RPM_Obje_Prݔty_Cou
(

86 
ecl_ݔty_li_t
 *
pPrݔtyLi
,

87 
BACNET_PROPERTY_ID
 
ecl_ݔty
)

89 
cou
 = 0;

91 i(
ecl_ݔty
 =
PROP_ALL
) {

92 
cou
 =

93 
pPrݔtyLi
->
Requed
.
cou
 +PrݔtyLi->
Oiڮ
.count +

94 
pPrݔtyLi
->
Prrry
.
cou
;

95 } i(
ecl_ݔty
 =
PROP_REQUIRED
) {

96 
cou
 = 
pPrݔtyLi
->
Requed
.count;

97 } i(
ecl_ݔty
 =
PROP_OPTIONAL
) {

98 
cou
 = 
pPrݔtyLi
->
Oiڮ
.count;

101  
cou
;

102 
	}
}

106 
	$RPM_Encode_Prݔty
(

107 
ut8_t
 * 
du
,

108 
ut16_t
 
offt
,

109 
ut16_t
 
max_du
,

110 
BACNET_RPM_DATA
 * 
mda
)

112 
n
 = 0;

113 
size_t
 
cy_n
 = 0;

114 
du_n
 = 0;

115 
BACNET_READ_PROPERTY_DATA
 
da
;

117 
n
 =

118 
	`m_ack_code_du_obje_ݔty
(&
Temp_Buf
[0],

119 
mda
->
obje_ݔty
,pmda->
y_dex
);

120 
cy_n
 = 
	`memcy
(&
du
[0], &
Temp_Buf
[0], 
offt
, 
n
, 
max_du
);

121 i(
cy_n
 == 0) {

122 
mda
->
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

123  
BACNET_STATUS_ABORT
;

125 
du_n
 +
n
;

126 
n
 = 0;

127 
da
.
r_ass
 = 
ERROR_CLASS_OBJECT
;

128 
da
.
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

129 
da
.
obje_ty
 = 
mda
->object_type;

130 
da
.
obje_
 = 
mda
->object_instance;

131 
da
.
obje_ݔty
 = 
mda
->object_property;

132 
da
.
y_dex
 = 
mda
->array_index;

133 
da
.
iti_da
 = &
Temp_Buf
[0];

134 
da
.
iti_da_n
 = (
Temp_Buf
);

135 
n
 = 
	`Devi_Rd_Prݔty
(&
da
);

136 i(
n
 < 0) {

137 i((
n
 =
BACNET_STATUS_ABORT
|| (=
BACNET_STATUS_REJECT
)) {

138 
mda
->
r_code
 = 
da
.error_code;

140  
n
;

143 
n
 =

144 
	`m_ack_code_du_obje_ݔty_r
(&
Temp_Buf
[0],

145 
da
.
r_ass
,pda.
r_code
);

146 
cy_n
 =

147 
	`memcy
(&
du
[0], &
Temp_Buf
[0], 
offt
 + 
du_n
, 
n
, 
max_du
);

149 i(
cy_n
 == 0) {

150 
mda
->
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

151  
BACNET_STATUS_ABORT
;

153 } i((
offt
 + 
du_n
 + 1 + 
n
 + 1< 
max_du
) {

155 
n
 =

156 
	`m_ack_code_du_obje_ݔty_vue
(&
du
[
offt
 + 
du_n
],

157 &
Temp_Buf
[0], 
n
);

160 
mda
->
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

161  
BACNET_STATUS_ABORT
;

163 
du_n
 +
n
;

165  
du_n
;

166 
	}
}

187 
	$hdr_ad_ݔty_muɝ
(

188 
ut8_t
 * 
rvi_que
,

189 
ut16_t
 
rvi_n
,

190 
BACNET_ADDRESS
 * 
c
,

191 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

193 
n
 = 0;

194 
ut16_t
 
cy_n
 = 0;

195 
ut16_t
 
decode_n
 = 0;

196 
pdu_n
 = 0;

197 
BACNET_NPDU_DATA
 
du_da
;

198 
bys_
;

199 
BACNET_ADDRESS
 
my_addss
;

200 
BACNET_RPM_DATA
 
mda
;

201 
du_n
 = 0;

202 
du_n
 = 0;

203 
r
 = 0;

208 
	`dk_g_my_addss
(&
my_addss
);

209 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

210 
du_n
 =

211 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

212 &
du_da
);

213 i(
rvi_da
->
gmd_mesge
) {

214 
mda
.
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

215 
r
 = 
BACNET_STATUS_ABORT
;

216 #i
PRINT_ENABLED


217 
	`rtf
(
dr
, "RPM: Segmented message. Sending Abort!\r\n");

219 
RPM_FAILURE
;

223 
du_n
 =

224 
	`m_ack_code_du_
(&
Hdr_Tnsm_Bufr
[
du_n
],

225 
rvi_da
->
voke_id
);

228 
n
 =

229 
	`m_decode_obje_id
(&
rvi_que
[
decode_n
],

230 
rvi_n
 - 
decode_n
, &
mda
);

231 i(
n
 >= 0) {

233 
decode_n
 +
n
;

236 #i
PRINT_ENABLED


237 
	`rtf
(
dr
, "RPM: Bad Encoding.\n");

239 
r
 = 
n
;

240 
RPM_FAILURE
;

244 i((
mda
.
obje_ty
 =
OBJECT_DEVICE
) &&

245 (
mda
.
obje_
 =
BACNET_MAX_INSTANCE
)) {

246 
mda
.
obje_
 = 
	`Devi_Obje_In_Numb
();

250 
n
 = 
	`m_ack_code_du_obje_beg
(&
Temp_Buf
[0], &
mda
);

251 
cy_n
 =

252 
	`memcy
(&
Hdr_Tnsm_Bufr
[
du_n
], &
Temp_Buf
[0], 
du_n
,

253 
n
, 
MAX_APDU
);

254 i(
cy_n
 == 0) {

255 #i
PRINT_ENABLED


256 
	`rtf
(
dr
, "RPM: Responseoo big!\r\n");

258 
mda
.
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

259 
r
 = 
BACNET_STATUS_ABORT
;

260 
RPM_FAILURE
;

263 
du_n
 +
cy_n
;

267 
n
 =

268 
	`m_decode_obje_ݔty
(&
rvi_que
[
decode_n
],

269 
rvi_n
 - 
decode_n
, &
mda
);

270 i(
n
 < 0) {

272 #i
PRINT_ENABLED


273 
	`rtf
(
dr
, "RPM: Bad Encoding.\n");

275 
r
 = 
n
;

276 
RPM_FAILURE
;

278 
decode_n
 +
n
;

280 i((
mda
.
obje_ݔty
 =
PROP_ALL
) ||

281 (
mda
.
obje_ݔty
 =
PROP_REQUIRED
) ||

282 (
mda
.
obje_ݔty
 =
PROP_OPTIONAL
)) {

283 
ecl_ݔty_li_t
 
ݔty_li
;

284 
ݔty_cou
 = 0;

285 
dex
 = 0;

286 
BACNET_PROPERTY_ID
 
ecl_obje_ݔty
;

288 i(
mda
.
y_dex
 !
BACNET_ARRAY_ALL
) {

291 
n
 =

292 
	`m_ack_code_du_obje_ݔty
(&
Temp_Buf
[0],

293 
mda
.
obje_ݔty
,pmda.
y_dex
);

294 
cy_n
 =

295 
	`memcy
(&
Hdr_Tnsm_Bufr
[
du_n
],

296 &
Temp_Buf
[0], 
du_n
, 
n
, 
MAX_APDU
);

297 i(
cy_n
 == 0) {

298 #i
PRINT_ENABLED


299 
	`rtf
(
dr
,

302 
mda
.
r_code
 =

303 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

304 
r
 = 
BACNET_STATUS_ABORT
;

305 
RPM_FAILURE
;

307 
du_n
 +
n
;

308 
n
 =

309 
	`m_ack_code_du_obje_ݔty_r
(&
Temp_Buf
[0],

310 
ERROR_CLASS_PROPERTY
,

311 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
);

312 
cy_n
 =

313 
	`memcy
(&
Hdr_Tnsm_Bufr
[
du_n
],

314 &
Temp_Buf
[0], 
du_n
, 
n
, 
MAX_APDU
);

315 i(
cy_n
 == 0) {

316 #i
PRINT_ENABLED


317 
	`rtf
(
dr
, "RPM: Too fulloncoderror!\r\n");

319 
mda
.
r_code
 =

320 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

321 
r
 = 
BACNET_STATUS_ABORT
;

322 
RPM_FAILURE
;

324 
du_n
 +
n
;

326 
ecl_obje_ݔty
 = 
mda
.
obje_ݔty
;

327 
	`Devi_Objes_Prݔty_Li
(
mda
.
obje_ty
,

328 &
ݔty_li
);

329 
ݔty_cou
 =

330 
	`RPM_Obje_Prݔty_Cou
(&
ݔty_li
,

331 
ecl_obje_ݔty
);

332 i(
ݔty_cou
 == 0) {

340 
dex
 = 0; index < 
ݔty_cou
; index++) {

341 
mda
.
obje_ݔty
 =

342 
	`RPM_Obje_Prݔty
(&
ݔty_li
,

343 
ecl_obje_ݔty
, 
dex
);

344 
n
 =

345 
	`RPM_Encode_Prݔty
(&
Hdr_Tnsm_Bufr


346 [
du_n
], (
ut16_t

du_n
, 
MAX_APDU
,

347 &
mda
);

348 i(
n
 > 0) {

349 
du_n
 +
n
;

351 #i
PRINT_ENABLED


352 
	`rtf
(
dr
,

355 
r
 = 
n
;

356 
RPM_FAILURE
;

363 
n
 =

364 
	`RPM_Encode_Prݔty
(&
Hdr_Tnsm_Bufr
[
du_n
],

365 (
ut16_t

du_n
, 
MAX_APDU
, &
mda
);

366 i(
n
 > 0) {

367 
du_n
 +
n
;

369 #i
PRINT_ENABLED


370 
	`rtf
(
dr
,

373 
r
 = 
n
;

374 
RPM_FAILURE
;

377 i(
	`decode_is_osg_g_numb
(&
rvi_que
[
decode_n
], 1)) {

379 
decode_n
++;

380 
n
 = 
	`m_ack_code_du_obje_d
(&
Temp_Buf
[0]);

381 
cy_n
 =

382 
	`memcy
(&
Hdr_Tnsm_Bufr
[
du_n
], &
Temp_Buf
[0],

383 
du_n
, 
n
, 
MAX_APDU
);

384 i(
cy_n
 == 0) {

385 #i
PRINT_ENABLED


386 
	`rtf
(
dr
, "RPM: Too fulloncode objectnd!\r\n");

388 
mda
.
r_code
 =

389 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

390 
r
 = 
BACNET_STATUS_ABORT
;

391 
RPM_FAILURE
;

393 
du_n
 +
cy_n
;

398 i(
decode_n
 >
rvi_n
) {

404 i(
du_n
 > 
rvi_da
->
max_
) {

406 
mda
.
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

407 
r
 = 
BACNET_STATUS_ABORT
;

408 #i
PRINT_ENABLED


409 
	`rtf
(
dr
, "RPM: Messageooarge. Sending Abort!\n");

411 
RPM_FAILURE
;

414 
RPM_FAILURE
:

415 i(
r
) {

416 i(
r
 =
BACNET_STATUS_ABORT
) {

417 
du_n
 =

418 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

419 
rvi_da
->
voke_id
,

420 
	`abt_cvt_r_code
(
mda
.
r_code
), 
ue
);

421 #i
PRINT_ENABLED


422 
	`rtf
(
dr
, "RPM: Sending Abort!\n");

424 } i(
r
 =
BACNET_STATUS_ERROR
) {

425 
du_n
 =

426 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

427 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

428 
mda
.
r_ass
,pmda.
r_code
);

429 #i
PRINT_ENABLED


430 
	`rtf
(
dr
, "RPM: Sending Error!\n");

432 } i(
r
 =
BACNET_STATUS_REJECT
) {

433 
du_n
 =

434 
	`je_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

435 
rvi_da
->
voke_id
,

436 
	`je_cvt_r_code
(
mda
.
r_code
));

437 #i
PRINT_ENABLED


438 
	`rtf
(
dr
, "RPM: Sending Reject!\n");

443 
pdu_n
 = 
du_n
 + 
du_n
;

444 
bys_
 =

445 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

446 
pdu_n
);

447 i(
bys_
 <= 0) {

448 #i
PRINT_ENABLED


449 
	`rtf
(
dr
, "RPM: Faedأnd PDU (%s)!\n", 
	`
(
o
));

452 
	}
}

	@demo/handler/h_rpm_a.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dlib.h
>

28 
	~<as.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"baext.h
"

40 
	~"m.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

56 
	$m_ack_decode_rvi_que
(

57 
ut8_t
 * 
du
,

58 
du_n
,

59 
BACNET_READ_ACCESS_DATA
 * 
ad_acss_da
)

61 
decoded_n
 = 0;

62 
ut32_t
 
r_vue
 = 0;

63 
n
 = 0;

64 
ut8_t
 
g_numb
 = 0;

65 
ut32_t
 
n_vue
 = 0;

66 
BACNET_READ_ACCESS_DATA
 *
m_obje
;

67 
BACNET_READ_ACCESS_DATA
 *
d_m_obje
;

68 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

69 
BACNET_PROPERTY_REFERENCE
 *
d_m_ݔty
;

70 
BACNET_APPLICATION_DATA_VALUE
 *
vue
;

71 
BACNET_APPLICATION_DATA_VALUE
 *
d_vue
;

73 
	`as
(
ad_acss_da
 !
NULL
);

74 
m_obje
 = 
ad_acss_da
;

75 
d_m_obje
 = 
m_obje
;

76 
m_obje
 && 
du_n
) {

77 
n
 =

78 
	`m_ack_decode_obje_id
(
du
, 
du_n
, &
m_obje
->
obje_ty
,

79 &
m_obje
->
obje_
);

80 i(
n
 <= 0) {

81 
d_m_obje
->
xt
 = 
NULL
;

82 
	`
(
m_obje
);

85 
decoded_n
 +
n
;

86 
du_n
 -
n
;

87 
du
 +
n
;

88 
m_ݔty
 = 
	`oc
(1, (
BACNET_PROPERTY_REFERENCE
));

89 
m_obje
->
liOfPrݔts
 = 
m_ݔty
;

90 
d_m_ݔty
 = 
m_ݔty
;

91 
m_ݔty
 && 
du_n
) {

92 
n
 =

93 
	`m_ack_decode_obje_ݔty
(
du
, 
du_n
,

94 &
m_ݔty
->
ݔtyIdtifr
,

95 &
m_ݔty
->
ݔtyAayIndex
);

96 i(
n
 <= 0) {

97 
d_m_ݔty
->
xt
 = 
NULL
;

98 i(
m_obje
->
liOfPrݔts
 =
m_ݔty
) {

100 
m_obje
->
liOfPrݔts
 = 
NULL
;

102 
	`
(
m_ݔty
);

105 
decoded_n
 +
n
;

106 
du_n
 -
n
;

107 
du
 +
n
;

108 i(
du_n
 && 
	`decode_is_ݒg_g_numb
(
du
, 4)) {

110 
decoded_n
++;

111 
du_n
--;

112 
du
++;

115 
vue
 = 
	`oc
(1, (
BACNET_APPLICATION_DATA_VALUE
));

116 
m_ݔty
->
vue
 = value;

117 
d_vue
 = 
vue
;

118 
vue
 && (
du_n
 > 0)) {

119 i(
	`IS_CONTEXT_SPECIFIC
(*
du
)) {

120 
n
 =

121 
	`ba_decode_cڋxt_da
(
du
, 
du_n
, 
vue
,

122 
m_ݔty
->
ݔtyIdtifr
);

124 
n
 =

125 
	`ba_decode_iti_da
(
du
, 
du_n
,

126 
vue
);

129 i(
n
 < 0) {

132  
BACNET_STATUS_ERROR
;

134 
decoded_n
 +
n
;

135 
du_n
 -
n
;

136 
du
 +
n
;

137 i(
du_n
 && 
	`decode_is_osg_g_numb
(
du
, 4)) {

138 
decoded_n
++;

139 
du_n
--;

140 
du
++;

143 
d_vue
 = 
vue
;

144 
vue
 =

145 
	`oc
(1, (
BACNET_APPLICATION_DATA_VALUE
));

146 
d_vue
->
xt
 = 
vue
;

149 } i(
du_n
 && 
	`decode_is_ݒg_g_numb
(
du
, 5)) {

151 
decoded_n
++;

152 
du_n
--;

153 
du
++;

155 
n
 =

156 
	`decode_g_numb_d_vue
(
du
, &
g_numb
, &
n_vue
);

157 
decoded_n
 +
n
;

158 
du_n
 -
n
;

159 
du
 +
n
;

161 
n
 = 
	`decode_umed
(
du
, 
n_vue
, &
r_vue
);

162 
m_ݔty
->
r
.
r_ass
 = 
r_vue
;

163 
decoded_n
 +
n
;

164 
du_n
 -
n
;

165 
du
 +
n
;

166 
n
 =

167 
	`decode_g_numb_d_vue
(
du
, &
g_numb
, &
n_vue
);

168 
decoded_n
 +
n
;

169 
du_n
 -
n
;

170 
du
 +
n
;

172 
n
 = 
	`decode_umed
(
du
, 
n_vue
, &
r_vue
);

173 
m_ݔty
->
r
.
r_code
 = 
r_vue
;

174 
decoded_n
 +
n
;

175 
du_n
 -
n
;

176 
du
 +
n
;

177 i(
du_n
 && 
	`decode_is_osg_g_numb
(
du
, 5)) {

178 
decoded_n
++;

179 
du_n
--;

180 
du
++;

183 
d_m_ݔty
 = 
m_ݔty
;

184 
m_ݔty
 = 
	`oc
(1, (
BACNET_PROPERTY_REFERENCE
));

185 
d_m_ݔty
->
xt
 = 
m_ݔty
;

187 
n
 = 
	`m_decode_obje_d
(
du
, 
du_n
);

188 i(
n
) {

189 
decoded_n
 +
n
;

190 
du_n
 -
n
;

191 
du
 +
n
;

193 i(
du_n
) {

194 
d_m_obje
 = 
m_obje
;

195 
m_obje
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

196 
d_m_obje
->
xt
 = 
m_obje
;

200  
decoded_n
;

201 
	}
}

204 
	$m_ack_t_da
(

205 
BACNET_READ_ACCESS_DATA
 * 
m_da
)

207 
BACNET_OBJECT_PROPERTY_VALUE
 
obje_vue
;

208 
BACNET_PROPERTY_REFERENCE
 *
liOfPrݔts
;

209 
BACNET_APPLICATION_DATA_VALUE
 *
vue
;

210 
bo
 
y_vue
 = 
l
;

212 i(
m_da
) {

213 #i
PRINT_ENABLED


214 
	`rtf
(
dout
, "%s #%lu\r\n",

215 
	`baext_obje_ty_me
(
m_da
->
obje_ty
),

216 (
m_da
->
obje_
);

217 
	`rtf
(
dout
, "{\r\n");

219 
liOfPrݔts
 = 
m_da
->listOfProperties;

220 
liOfPrݔts
) {

221 #i
PRINT_ENABLED


222 i(
liOfPrݔts
->
ݔtyIdtifr
 < 512) {

223 
	`rtf
(
dout
, " %s: ",

224 
	`baext_ݔty_me
(
liOfPrݔts
->

225 
ݔtyIdtifr
));

227 
	`rtf
(
dout
, "roprietary %u: ",

228 (
liOfPrݔts
->
ݔtyIdtifr
);

231 i(
liOfPrݔts
->
ݔtyAayIndex
 !
BACNET_ARRAY_ALL
) {

232 #i
PRINT_ENABLED


233 
	`rtf
(
dout
, "[%d]", 
liOfPrݔts
->
ݔtyAayIndex
);

236 
vue
 = 
liOfPrݔts
->value;

237 i(
vue
) {

238 #i
PRINT_ENABLED


239 i(
vue
->
xt
) {

240 
	`rtf
(
dout
, "{");

241 
y_vue
 = 
ue
;

243 
y_vue
 = 
l
;

246 
obje_vue
.
obje_ty
 = 
m_da
->object_type;

247 
obje_vue
.
obje_
 = 
m_da
->object_instance;

248 
vue
) {

249 
obje_vue
.
obje_ݔty
 =

250 
liOfPrݔts
->
ݔtyIdtifr
;

251 
obje_vue
.
y_dex
 =

252 
liOfPrݔts
->
ݔtyAayIndex
;

253 
obje_vue
.
vue
 = value;

254 
	`ba_t_vue
(
dout
, &
obje_vue
);

255 #i
PRINT_ENABLED


256 i(
vue
->
xt
) {

257 
	`rtf
(
dout
, ",\r\n ");

259 i(
y_vue
) {

260 
	`rtf
(
dout
, "}\r\n");

262 
	`rtf
(
dout
, "\r\n");

266 
vue
 = vue->
xt
;

269 #i
PRINT_ENABLED


271 
	`rtf
(
dout
, "BACnet Error: %s: %s\r\n",

272 
	`baext_r_ass_me
((
liOfPrݔts
->

273 
r
.
r_ass
),

274 
	`baext_r_code_me
((
liOfPrݔts
->

275 
r
.
r_code
));

278 
liOfPrݔts
 =iOfPrݔts->
xt
;

280 #i
PRINT_ENABLED


281 
	`rtf
(
dout
, "}\r\n");

284 
	}
}

297 
	$hdr_ad_ݔty_muɝ_ack
(

298 
ut8_t
 * 
rvi_que
,

299 
ut16_t
 
rvi_n
,

300 
BACNET_ADDRESS
 * 
c
,

301 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

303 
n
 = 0;

304 
BACNET_READ_ACCESS_DATA
 *
m_da
;

305 
BACNET_READ_ACCESS_DATA
 *
d_m_da
;

306 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

307 
BACNET_PROPERTY_REFERENCE
 *
d_m_ݔty
;

308 
BACNET_APPLICATION_DATA_VALUE
 *
vue
;

309 
BACNET_APPLICATION_DATA_VALUE
 *
d_vue
;

311 (
c
;

312 (
rvi_da
;

314 
m_da
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

315 i(
m_da
) {

316 
n
 =

317 
	`m_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
,

318 
m_da
);

321 
	`rtf
(
dr
, "Received Read-Property-Multiple Ack!\n");

323 i(
n
 > 0) {

324 
m_da
) {

325 
	`m_ack_t_da
(
m_da
);

326 
m_ݔty
 = 
m_da
->
liOfPrݔts
;

327 
m_ݔty
) {

328 
vue
 = 
m_ݔty
->value;

329 
vue
) {

330 
d_vue
 = 
vue
;

331 
vue
 = vue->
xt
;

332 
	`
(
d_vue
);

334 
d_m_ݔty
 = 
m_ݔty
;

335 
m_ݔty
 =pm_ݔty->
xt
;

336 
	`
(
d_m_ݔty
);

338 
d_m_da
 = 
m_da
;

339 
m_da
 =pm_da->
xt
;

340 
	`
(
d_m_da
);

344 
	`rtf
(
dr
, "RPM Ack Malformed! Freeing memory...\n");

346 
m_da
) {

347 
m_ݔty
 = 
m_da
->
liOfPrݔts
;

348 
m_ݔty
) {

349 
vue
 = 
m_ݔty
->value;

350 
vue
) {

351 
d_vue
 = 
vue
;

352 
vue
 = vue->
xt
;

353 
	`
(
d_vue
);

355 
d_m_ݔty
 = 
m_ݔty
;

356 
m_ݔty
 =pm_ݔty->
xt
;

357 
	`
(
d_m_ݔty
);

359 
d_m_da
 = 
m_da
;

360 
m_da
 =pm_da->
xt
;

361 
	`
(
d_m_da
);

364 
	}
}

	@demo/handler/h_rr.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~"adnge.h
"

39 
	~"devi.h
"

40 
	~"hdrs.h
"

44 
ut8_t
 
	gTemp_Buf
[
MAX_APDU
] = { 0 };

48 
	$Encode_RR_yld
(

49 
ut8_t
 * 
du
,

50 
BACNET_READ_RANGE_DATA
 * 
pReque
)

52 
du_n
 = -1;

53 
_fo_funi
 
fo__r
 = 
NULL
;

54 
RR_PROP_INFO
 
PrInfo
;

57 
pReque
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

58 
pReque
->
r_code
 = 
ERROR_CODE_OTHER
;

61 
fo__r
 = 
	`Devi_Objes_RR_Info
(
pReque
->
obje_ty
);

63 i((
fo__r
 !
NULL
&& (
	`fo__r
(
pReque
, &
PrInfo
!
l
)) {

66 i((
pReque
->
RequeTy
 =
RR_BY_POSITION
&& (pReque->
Rge
.
RefIndex
 == 0)) {

67 
pReque
->
r_code
 = 
ERROR_CODE_OTHER
;

68 } i(((
PrInfo
.
RequeTys
 & 
RR_ARRAY_OF_LISTS
) == 0) &&

69 (
pReque
->
y_dex
 != 0) &&

70 (
pReque
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

72 
pReque
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

73 } i((
pReque
->
RequeTy
 !
RR_READ_ALL
) &&

74 ((
PrInfo
.
RequeTys
 & 
pReque
->
RequeTy
) == 0)) {

76 
pReque
->
r_code
 = 
ERROR_CODE_OTHER
;

77 } i((
pReque
->
Cou
 =0&& (pReque->
RequeTy
 !
RR_READ_ALL
)) {

78 
pReque
->
r_code
 = 
ERROR_CODE_OTHER
;

79 } i(
PrInfo
.
Hdr
 !
NULL
) {

80 
du_n
 = 
PrInfo
.
	`Hdr
(
du
, 
pReque
);

84 
pReque
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_A_LIST
;

87  
du_n
;

88 
	}
}

90 
	$hdr_ad_nge
(

91 
ut8_t
 * 
rvi_que
,

92 
ut16_t
 
rvi_n
,

93 
BACNET_ADDRESS
 * 
c
,

94 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

96 
BACNET_READ_RANGE_DATA
 
da
;

97 
n
 = 0;

98 
pdu_n
 = 0;

99 
BACNET_NPDU_DATA
 
du_da
;

100 
bo
 
r
 = 
l
;

101 
bys_
 = 0;

102 
BACNET_ADDRESS
 
my_addss
;

104 
da
.
r_ass
 = 
ERROR_CLASS_OBJECT
;

105 
da
.
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

107 
	`dk_g_my_addss
(&
my_addss
);

108 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

109 
pdu_n
 =

110 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

111 &
du_da
);

112 i(
rvi_da
->
gmd_mesge
) {

114 
n
 =

115 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

116 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

117 
ue
);

118 #i
PRINT_ENABLED


119 
	`rtf
(
dr
, "RR: Segmented message. Sending Abort!\n");

121 
RR_ABORT
;

123 
	`memt
(&
da
, 0, (data));

124 
n
 = 
	`_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

125 #i
PRINT_ENABLED


126 i(
n
 <= 0)

127 
	`rtf
(
dr
, "RR: Unableo decode Request!\n");

129 i(
n
 < 0) {

131 
n
 =

132 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

133 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

134 #i
PRINT_ENABLED


135 
	`rtf
(
dr
, "RR: Bad Encoding. Sending Abort!\n");

137 
RR_ABORT
;

141 
r
 = 
ue
;

142 
n
 = 
	`Encode_RR_yld
(&
Temp_Buf
[0], &
da
);

143 i(
n
 >= 0) {

145 
da
.
iti_da
 = &
Temp_Buf
[0];

146 
da
.
iti_da_n
 = 
n
;

148 
n
 =

149 
	`_ack_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

150 
rvi_da
->
voke_id
, &
da
);

151 #i
PRINT_ENABLED


152 
	`rtf
(
dr
, "RR: Sending Ack!\n");

154 
r
 = 
l
;

156 i(
r
) {

157 i(
n
 == -2) {

159 
n
 =

160 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

161 
rvi_da
->
voke_id
,

162 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
, 
ue
);

163 #i
PRINT_ENABLED


164 
	`rtf
(
dr
, "RR: Replyoo bigo fit into APDU!\n");

167 
n
 =

168 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

169 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_READ_RANGE
,

170 
da
.
r_ass
, da.
r_code
);

171 #i
PRINT_ENABLED


172 
	`rtf
(
dr
, "RR: Sending Error!\n");

176 
RR_ABORT
:

177 
pdu_n
 +
n
;

178 
bys_
 =

179 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

180 
pdu_n
);

181 #i
PRINT_ENABLED


182 i(
bys_
 <= 0)

183 
	`rtf
(
dr
, "Faedأnd PDU (%s)!\n", 
	`
(
o
));

187 
	}
}

	@demo/handler/h_rr_a.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~"cfig.h
"

28 
	~"txbuf.h
"

29 
	~"bacdef.h
"

30 
	~"bacdcode.h
"

31 
	~"addss.h
"

32 
	~"tsm.h
"

33 
	~"du.h
"

34 
	~"du.h
"

35 
	~"devi.h
"

36 
	~"dk.h
"

37 
	~"baext.h
"

38 
	~"adnge.h
"

40 
	~"hdrs.h
"

41 
	~"txbuf.h
"

46 
	$PrtRdRgeDa
(

47 
BACNET_READ_RANGE_DATA
 * 
da
)

49 
BACNET_OBJECT_PROPERTY_VALUE
 
obje_vue
;

50 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

51 
n
 = 0;

52 
ut8_t
 *
iti_da
;

53 
iti_da_n
;

54 
bo
 
f_vue
 = 
ue
;

55 
bo
 
t_b
 = 
l
;

57 i(
da
) {

58 
iti_da
 = 
da
->application_data;

59 
iti_da_n
 = 
da
->application_data_len;

63 
n
 =

64 
	`ba_decode_iti_da
(
iti_da
,

65 (
ut8_t

iti_da_n
, &
vue
);

66 i(
f_vue
 && (
n
 < 
iti_da_n
)) {

67 
f_vue
 = 
l
;

68 #i
PRINT_ENABLED


69 
	`rtf
(
dout
, "{");

71 
t_b
 = 
ue
;

73 
obje_vue
.
obje_ty
 = 
da
->object_type;

74 
obje_vue
.
obje_
 = 
da
->object_instance;

75 
obje_vue
.
obje_ݔty
 = 
da
->object_property;

76 
obje_vue
.
y_dex
 = 
da
->array_index;

77 
obje_vue
.
vue
 = &value;

78 
	`ba_t_vue
(
dout
, &
obje_vue
);

79 i(
n
 > 0) {

80 i(
n
 < 
iti_da_n
) {

81 
iti_da
 +
n
;

82 
iti_da_n
 -
n
;

84 #i
PRINT_ENABLED


85 
	`rtf
(
dout
, ",");

94 #i
PRINT_ENABLED


95 i(
t_b
)

96 
	`rtf
(
dout
, "}");

97 
	`rtf
(
dout
, "\r\n");

100 
	}
}

102 
	$hdr_ad_nge_ack
(

103 
ut8_t
 * 
rvi_que
,

104 
ut16_t
 
rvi_n
,

105 
BACNET_ADDRESS
 * 
c
,

106 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

108 
n
 = 0;

109 
BACNET_READ_RANGE_DATA
 
da
;

111 (
c
;

112 (
rvi_da
;

113 
n
 = 
	`_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

115 #i
PRINT_ENABLED


116 
	`rtf
(
dr
, "Received ReadRange Ack!\n");

119 i(
n
 > 0)

120 
	`PrtRdRgeDa
(&
da
);

121 
	}
}

	@demo/handler/h_ts.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~"cfig.h
"

29 
	~"txbuf.h
"

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"timesync.h
"

33 
	~"hdrs.h
"

37 #i
PRINT_ENABLED


38 
	$show_ba_de_time
(

39 
BACNET_DATE
 * 
bde
,

40 
BACNET_TIME
 * 
btime
)

43 
	`rtf
(
dr
, "%u", (
bde
->
yr
);

44 
	`rtf
(
dr
, "/%u", (
bde
->
mth
);

45 
	`rtf
(
dr
, "/%u", (
bde
->
day
);

47 
	`rtf
(
dr
, " %02u", (
btime
->
hour
);

48 
	`rtf
(
dr
, ":%02u", (
btime
->
m
);

49 
	`rtf
(
dr
, ":%02u", (
btime
->
c
);

50 
	`rtf
(
dr
, ".%02u", (
btime
->
hunddths
);

51 
	`rtf
(
dr
, "\r\n");

52 
	}
}

55 
	$hdr_timesync
(

56 
ut8_t
 * 
rvi_que
,

57 
ut16_t
 
rvi_n
,

58 
BACNET_ADDRESS
 * 
c
)

60 
n
 = 0;

61 
BACNET_DATE
 
bde
;

62 
BACNET_TIME
 
btime
;

64 (
c
;

65 (
rvi_n
;

66 
n
 =

67 
	`timesync_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
bde
,

68 &
btime
);

69 i(
n
 > 0) {

70 #i
PRINT_ENABLED


71 
	`rtf
(
dr
, "Received TimeSyncronization Request\r\n");

72 
	`show_ba_de_time
(&
bde
, &
btime
);

79 
	}
}

81 
	$hdr_timesync_utc
(

82 
ut8_t
 * 
rvi_que
,

83 
ut16_t
 
rvi_n
,

84 
BACNET_ADDRESS
 * 
c
)

86 
n
 = 0;

87 
BACNET_DATE
 
bde
;

88 
BACNET_TIME
 
btime
;

90 (
c
;

91 (
rvi_n
;

92 
n
 =

93 
	`timesync_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
bde
,

94 &
btime
);

95 i(
n
 > 0) {

96 #i
PRINT_ENABLED


97 
	`rtf
(
dr
, "Received TimeSyncronization Request\r\n");

98 
	`show_ba_de_time
(&
bde
, &
btime
);

104 
	}
}

	@demo/handler/h_ucov.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"du.h
"

35 
	~"du.h
"

36 
	~"abt.h
"

38 
	~"cov.h
"

39 
	~"baext.h
"

40 
	~"hdrs.h
"

42 #ide
MAX_COV_PROPERTIES


43 
	#MAX_COV_PROPERTIES
 2

	)

60 
	$hdr_ucov_nifiti
(

61 
ut8_t
 * 
rvi_que
,

62 
ut16_t
 
rvi_n
,

63 
BACNET_ADDRESS
 * 
c
)

65 
BACNET_COV_DATA
 
cov_da
;

66 
BACNET_PROPERTY_VALUE
 
ݔty_vue
[
MAX_COV_PROPERTIES
];

67 
BACNET_PROPERTY_VALUE
 *
pPrݔty_vue
 = 
NULL
;

68 
n
 = 0;

69 
dex
 = 0;

72 
c
 = src;

75 
pPrݔty_vue
 = &
ݔty_vue
[0];

76 
pPrݔty_vue
) {

77 
dex
++;

78 i(
dex
 < 
MAX_COV_PROPERTIES
) {

79 
pPrݔty_vue
->
xt
 = &
ݔty_vue
[
dex
];

81 
pPrݔty_vue
->
xt
 = 
NULL
;

83 
pPrݔty_vue
 =Prݔty_vue->
xt
;

85 
cov_da
.
liOfVues
 = &
ݔty_vue
[0];

86 #i
PRINT_ENABLED


87 
	`rtf
(
dr
, "UCOV: Received Notification!\n");

90 
n
 =

91 
	`cov_nify_decode_rvi_que
(
rvi_que
, 
rvi_n
,

92 &
cov_da
);

93 #i
PRINT_ENABLED


94 i(
n
 > 0) {

95 
	`rtf
(
dr
, "UCOV: PID=%u ", 
cov_da
.
subsibProssIdtifr
);

96 
	`rtf
(
dr
, "=%u ", 
cov_da
.
tgDeviIdtifr
);

97 
	`rtf
(
dr
, "%s %u ",

98 
	`baext_obje_ty_me
(
cov_da
.
mڙedObjeIdtifr
.
ty
),

99 
cov_da
.
mڙedObjeIdtifr
.

);

100 
	`rtf
(
dr
, "timmag=%u secd", 
cov_da
.
timeRemag
);

101 
	`rtf
(
dr
, "\n");

102 
pPrݔty_vue
 = &
ݔty_vue
[0];

103 
pPrݔty_vue
) {

104 
	`rtf
(
dr
, "UCOV: ");

105 i(
pPrݔty_vue
->
ݔtyIdtifr
 < 512) {

106 
	`rtf
(
dr
, "%s ",

107 
baext_ݔty_me


108 (
pPrݔty_vue
->
ݔtyIdtifr
));

110 
	`rtf
(
dr
, "proprietary %u ",

111 
pPrݔty_vue
->
ݔtyIdtifr
);

113 i(
pPrݔty_vue
->
ݔtyAayIndex
 !
BACNET_ARRAY_ALL
) {

114 
	`rtf
(
dr
, "%u ", 
pPrݔty_vue
->
ݔtyAayIndex
);

116 
	`rtf
(
dr
, "\n");

117 
pPrݔty_vue
 =Prݔty_vue->
xt
;

120 
	`rtf
(
dr
, "UCOV: Unableo decode serviceequest!\n");

123 
	}
}

	@demo/handler/h_upt.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"du.h
"

35 
	~"du.h
"

36 
	~"abt.h
"

37 
	~"nsr.h
"

38 
	~"hdrs.h
"

42 
	$hdr_uncfmed_ive_sr
(

43 
ut8_t
 * 
rvi_que
,

44 
ut16_t
 
rvi_n
,

45 
BACNET_ADDRESS
 * 
c
)

47 
BACNET_PRIVATE_TRANSFER_DATA
 
ive_da
;

48 
BACNET_OBJECT_PROPERTY_VALUE
 
obje_vue
;

49 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

50 
n
 = 0;

51 
ut8_t
 *
iti_da
;

52 
iti_da_n
;

53 
bo
 
f_vue
 = 
ue
;

54 
bo
 
t_b
 = 
l
;

56 #i
PRINT_ENABLED


57 
	`rtf
(
dr
, "Received Unconfirmed Private Transfer Request!\n");

59 
n
 =

60 
	`nsr_decode_rvi_que
(
rvi_que
, 
rvi_n
,

61 &
ive_da
);

62 i(
n
 >= 0) {

63 #i
PRINT_ENABLED


64 
	`tf
("PrivateTransfer:vendorID=%u\r\n",

65 (
ive_da
.
vdID
);

66 
	`tf
("PrivateTransfer:serviceNumber=%lu\r\n",

67 (
ive_da
.
rviNumb
);

69 
iti_da
 = 
ive_da
.
rviPams
;

70 
iti_da_n
 = 
ive_da
.
rviPamsL
;

72 
n
 =

73 
	`ba_decode_iti_da
(
iti_da
,

74 (
ut8_t

iti_da_n
, &
vue
);

75 i(
f_vue
 && (
n
 < 
iti_da_n
)) {

76 
f_vue
 = 
l
;

77 #i
PRINT_ENABLED


78 
	`rtf
(
dout
, "{");

80 
t_b
 = 
ue
;

83 
obje_vue
.
obje_ty
 = 
MAX_BACNET_OBJECT_TYPE
;

84 
obje_vue
.
obje_
 = 
BACNET_MAX_INSTANCE
;

85 
obje_vue
.
obje_ݔty
 = 
MAX_BACNET_PROPERTY_ID
;

86 
obje_vue
.
y_dex
 = 
BACNET_ARRAY_ALL
;

87 
obje_vue
.
vue
 = &value;

88 
	`ba_t_vue
(
dout
, &
obje_vue
);

89 i(
n
 > 0) {

90 i(
n
 < 
iti_da_n
) {

91 
iti_da
 +
n
;

92 
iti_da_n
 -
n
;

94 #i
PRINT_ENABLED


95 
	`rtf
(
dout
, ",");

104 #i
PRINT_ENABLED


105 i(
t_b
)

106 
	`rtf
(
dout
, "}");

107 
	`rtf
(
dout
, "\r\n");

110 
	}
}

	@demo/handler/h_whohas.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"whohas.h
"

35 
	~"devi.h
"

36 
	~".h
"

37 
	~"hdrs.h
"

45 
	$mch_me__obje
(

46 
BACNET_WHO_HAS_DATA
 * 
da
)

48 
obje_ty
 = 0;

49 
ut32_t
 
obje_
 = 0;

50 
bo
 
found
 = 
l
;

51 
BACNET_CHARACTER_STRING
 
obje_me
;

55 i(
da
->
is_obje_me
) {

57 
found
 =

58 
	`Devi_Vid_Obje_Name
(&
da
->
obje
.
me
, &
obje_ty
,

59 &
obje_
);

60 i(
found
) {

61 
	`Sd_I_Have
(
	`Devi_Obje_In_Numb
(),

62 (
BACNET_OBJECT_TYPE

obje_ty
, 
obje_
,

63 &
da
->
obje
.
me
);

67 
found
 =

68 
	`Devi_Obje_Name_Cy
((
BACNET_OBJECT_TYPE

da
->

69 
obje
.
idtifr
.
ty
, 
da
->obje.idtifr.

,

70 &
obje_me
);

71 i(
found
) {

72 
	`Sd_I_Have
(
	`Devi_Obje_In_Numb
(),

73 (
BACNET_OBJECT_TYPE

da
->
obje
.
idtifr
.
ty
,

74 
da
->
obje
.
idtifr
.

, &
obje_me
);

77 
	}
}

89 
	$hdr_who_has
(

90 
ut8_t
 * 
rvi_que
,

91 
ut16_t
 
rvi_n
,

92 
BACNET_ADDRESS
 * 
c
)

94 
n
 = 0;

95 
BACNET_WHO_HAS_DATA
 
da
;

96 
bo
 
deed_to_me
 = 
l
;

98 (
c
;

99 
n
 = 
	`whohas_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

100 i(
n
 > 0) {

101 i((
da
.
low_lim
 =-1|| (da.
high_lim
 == -1))

102 
deed_to_me
 = 
ue
;

103 i((
	`Devi_Obje_In_Numb
(>(
ut32_t

da
.
low_lim
)

104 && (
	`Devi_Obje_In_Numb
(<(
ut32_t

da
.
high_lim
))

105 
deed_to_me
 = 
ue
;

106 i(
deed_to_me
) {

107 
	`mch_me__obje
(&
da
);

110 
	}
}

113 #ifde
DEPRECATED


124 
	$hdr_who_has_f_routg
(

125 
ut8_t
 * 
rvi_que
,

126 
ut16_t
 
rvi_n
,

127 
BACNET_ADDRESS
 * 
c
)

129 
n
 = 0;

130 
BACNET_WHO_HAS_DATA
 
da
;

131 
t32_t
 
dev_
;

132 
curs
 = 0;

133 
my_li
[2] = { 0, -1 };

134 
BACNET_ADDRESS
 
b_t
;

136 (
c
;

137 
n
 = 
	`whohas_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

138 i(
n
 > 0) {

140 
	`memt
(&
b_t
, 0, (
BACNET_ADDRESS
));

141 
b_t
.
t
 = 
BACNET_BROADCAST_NETWORK
;

142 
	`Roud_Devi_GNext
(&
b_t
, 
my_li
, &
curs
)) {

143 
dev_
 = 
	`Devi_Obje_In_Numb
();

144 i((
da
.
low_lim
 =-1|| (da.
high_lim
 == -1) ||

145 ((
dev_
 >
da
.
low_lim
) &&

146 (
dev_
 <
da
.
high_lim
)))

147 
	`mch_me__obje
(&
da
);

150 
	}
}

	@demo/handler/h_whois.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"whois.h
"

35 
	~"m.h
"

36 
	~"devi.h
"

38 
	~".h
"

39 
	~"txbuf.h
"

40 
	~"hdrs.h
"

50 
	$hdr_who_is
(

51 
ut8_t
 * 
rvi_que
,

52 
ut16_t
 
rvi_n
,

53 
BACNET_ADDRESS
 * 
c
)

55 
n
 = 0;

56 
t32_t
 
low_lim
 = 0;

57 
t32_t
 
high_lim
 = 0;

59 (
c
;

60 
n
 =

61 
	`whois_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
low_lim
,

62 &
high_lim
);

63 i(
n
 == 0) {

64 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

65 } i(
n
 !
BACNET_STATUS_ERROR
) {

67 i((
	`Devi_Obje_In_Numb
(>(
ut32_t

low_lim
) &&

68 (
	`Devi_Obje_In_Numb
(<(
ut32_t

high_lim
)) {

69 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

74 
	}
}

83 
	$hdr_who_is_uni
(

84 
ut8_t
 * 
rvi_que
,

85 
ut16_t
 
rvi_n
,

86 
BACNET_ADDRESS
 * 
c
)

88 
n
 = 0;

89 
t32_t
 
low_lim
 = 0;

90 
t32_t
 
high_lim
 = 0;

92 
n
 =

93 
	`whois_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
low_lim
,

94 &
high_lim
);

96 i(
n
 == 0) {

97 
	`Sd_I_Am_Uni
(&
Hdr_Tnsm_Bufr
[0], 
c
);

98 } i(
n
 !
BACNET_STATUS_ERROR
) {

100 i((
	`Devi_Obje_In_Numb
(>(
ut32_t

low_lim
) &&

101 (
	`Devi_Obje_In_Numb
(<(
ut32_t

high_lim
)) {

102 
	`Sd_I_Am_Uni
(&
Hdr_Tnsm_Bufr
[0], 
c
);

107 
	}
}

110 #ifde
DEPRECATED


121 
	$check_who_is_f_routg
(

122 
ut8_t
 * 
rvi_que
,

123 
ut16_t
 
rvi_n
,

124 
BACNET_ADDRESS
 * 
c
,

125 
bo
 
is_uni
)

127 
n
 = 0;

128 
t32_t
 
low_lim
 = 0;

129 
t32_t
 
high_lim
 = 0;

130 
t32_t
 
dev_
;

131 
curs
 = 0;

132 
my_li
[2] = { 0, -1 };

133 
BACNET_ADDRESS
 
b_t
;

135 
n
 =

136 
	`whois_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
low_lim
,

137 &
high_lim
);

138 i(
n
 =
BACNET_STATUS_ERROR
) {

143 
	`memt
(&
b_t
, 0, (
BACNET_ADDRESS
));

144 
b_t
.
t
 = 
BACNET_BROADCAST_NETWORK
;

146 
	`Roud_Devi_GNext
(&
b_t
, 
my_li
, &
curs
)) {

147 
dev_
 = 
	`Devi_Obje_In_Numb
();

149 i((
n
 =0|| ((
dev_
 >
low_lim
) &&

150 (
dev_
 <
high_lim
))) {

151 i(
is_uni
)

152 
	`Sd_I_Am_Uni
(&
Hdr_Tnsm_Bufr
[0], 
c
);

154 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

158 
	}
}

172 
	$hdr_who_is_b_f_routg
(

173 
ut8_t
 * 
rvi_que
,

174 
ut16_t
 
rvi_n
,

175 
BACNET_ADDRESS
 * 
c
)

177 
	`check_who_is_f_routg
(
rvi_que
, 
rvi_n
, 
c
, 
l
);

178 
	}
}

192 
	$hdr_who_is_uni_f_routg
(

193 
ut8_t
 * 
rvi_que
,

194 
ut16_t
 
rvi_n
,

195 
BACNET_ADDRESS
 * 
c
)

197 
	`check_who_is_f_routg
(
rvi_que
, 
rvi_n
, 
c
, 
ue
);

198 
	}
}

	@demo/handler/h_wp.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~"wp.h
"

40 
	~"devi.h
"

41 
	~"hdrs.h
"

64 
	$hdr_wre_ݔty
(

65 
ut8_t
 * 
rvi_que
,

66 
ut16_t
 
rvi_n
,

67 
BACNET_ADDRESS
 * 
c
,

68 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

70 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

71 
n
 = 0;

72 
pdu_n
 = 0;

73 
BACNET_NPDU_DATA
 
du_da
;

74 
bys_
 = 0;

75 
BACNET_ADDRESS
 
my_addss
;

78 
	`dk_g_my_addss
(&
my_addss
);

79 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

80 
pdu_n
 =

81 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

82 &
du_da
);

83 #i
PRINT_ENABLED


84 
	`rtf
(
dr
, "WP: Received Request!\n");

86 i(
rvi_da
->
gmd_mesge
) {

87 
n
 =

88 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

89 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

90 
ue
);

91 #i
PRINT_ENABLED


92 
	`rtf
(
dr
, "WP: Segmented message. Sending Abort!\n");

94 
WP_ABORT
;

96 
n
 = 
	`wp_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
wp_da
);

97 #i
PRINT_ENABLED


98 i(
n
 > 0)

99 
	`rtf
(
dr
,

101 (
wp_da
.
obje_ty
,

102 (
wp_da
.
obje_
,

103 (
wp_da
.
obje_ݔty
,

104 (
wp_da
.
iܙy
, (wp_da.
y_dex
);

106 
	`rtf
(
dr
, "WP: Unableo decode Request!\n");

109 i(
n
 <= 0) {

110 
n
 =

111 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

112 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

113 #i
PRINT_ENABLED


114 
	`rtf
(
dr
, "WP: Bad Encoding. Sending Abort!\n");

116 
WP_ABORT
;

118 i(
	`Devi_Wre_Prݔty
(&
wp_da
)) {

119 
n
 =

120 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

121 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_WRITE_PROPERTY
);

122 #i
PRINT_ENABLED


123 
	`rtf
(
dr
, "WP: Sending Simple Ack!\n");

126 
n
 =

127 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

128 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_WRITE_PROPERTY
,

129 
wp_da
.
r_ass
, wp_da.
r_code
);

130 #i
PRINT_ENABLED


131 
	`rtf
(
dr
, "WP: Sending Error!\n");

134 
WP_ABORT
:

135 
pdu_n
 +
n
;

136 
bys_
 =

137 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

138 
pdu_n
);

139 i(
bys_
 <= 0) {

140 #i
PRINT_ENABLED


141 
	`rtf
(
dr
, "WP: Faedأnd PDU (%s)!\n", 
	`
(
o
));

146 
	}
}

155 
bo
 
	$WPVideSg
(

156 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

157 
iMaxL
,

158 
bo
 
bEmyAowed
,

159 
BACNET_ERROR_CLASS
 * 
pECss
,

160 
BACNET_ERROR_CODE
 * 
pECode
)

162 
bo
 
bResu
;

168 
bResu
 = 
l
;

169 *
pECss
 = 
ERROR_CLASS_PROPERTY
;

171 i(
pVue
->
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

172 i(
	`charg_codg
(&
pVue
->
ty
.
Cha_Sg
) ==

173 
CHARACTER_ANSI_X34
) {

174 i((
bEmyAowed
 =
l
) &&

175 (
	`charg_ngth
(&
pVue
->
ty
.
Cha_Sg
) ==

177 *
pECode
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

178 } i((
bEmyAowed
 =
l
) &&

179 (!
	`charg_b
(&
pVue
->
ty
.
Cha_Sg
))) {

181 *
pECode
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

182 } i(
	`charg_ngth
(&
pVue
->
ty
.
Cha_Sg
) >

183 (
ut16_t

iMaxL
) {

184 *
pECss
 = 
ERROR_CLASS_RESOURCES
;

185 *
pECode
 = 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

187 
bResu
 = 
ue
;

189 *
pECode
 = 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

191 *
pECode
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

193  (
bResu
);

194 
	}
}

201 
bo
 
	$WPVideArgTy
(

202 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

203 
ut8_t
 
ucExedTag
,

204 
BACNET_ERROR_CLASS
 * 
pECss
,

205 
BACNET_ERROR_CODE
 * 
pECode
)

207 
bo
 
bResu
;

213 
bResu
 = 
ue
;

214 i(
pVue
->
g
 !
ucExedTag
) {

215 
bResu
 = 
l
;

216 *
pECss
 = 
ERROR_CLASS_PROPERTY
;

217 *
pECode
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

220  (
bResu
);

221 
	}
}

	@demo/handler/h_wpm.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~"wp.h
"

39 
	~"je.h
"

40 
	~"wpm.h
"

42 
	~"devi.h
"

43 
	~"hdrs.h
"

65 
	$hdr_wre_ݔty_muɝ
(

66 
ut8_t
 * 
rvi_que
,

67 
ut16_t
 
rvi_n
,

68 
BACNET_ADDRESS
 * 
c
,

69 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

71 
n
 = 0;

72 
du_n
 = 0;

73 
du_n
 = 0;

74 
pdu_n
 = 0;

75 
decode_n
 = 0;

76 
bo
 
r
 = 
l
;

77 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

78 
BACNET_NPDU_DATA
 
du_da
;

79 
BACNET_ADDRESS
 
my_addss
;

80 
bys_
 = 0;

82 i(
rvi_da
->
gmd_mesge
) {

83 
wp_da
.
r_code
 = 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

84 
n
 = 
BACNET_STATUS_ABORT
;

85 #i
PRINT_ENABLED


86 
	`rtf
(
dr
, "WPM: Segmented message. Sending Abort!\n");

88 
WPM_ABORT
;

92 
decode_n
 = 0;

95 
n
 =

96 
	`wpm_decode_obje_id
(&
rvi_que
[
decode_n
],

97 
rvi_n
 - 
decode_n
, &
wp_da
);

98 i(
n
 > 0) {

99 
ut8_t
 
g_numb
 = 0;

101 
decode_n
 +
n
;

103 i(
	`decode_is_ݒg_g_numb
(&
rvi_que
[
decode_n
++],

108 
n
 =

109 
	`wpm_decode_obje_ݔty
(&
rvi_que


110 [
decode_n
], 
rvi_n
 - decode_n, &
wp_da
);

111 i(
n
 > 0) {

112 
decode_n
 +
n
;

113 #i
PRINT_ENABLED


114 
	`rtf
(
dr
,

116 (
wp_da
.
obje_ty
,

117 (
wp_da
.
obje_
,

118 (
wp_da
.
obje_ݔty
,

119 (
wp_da
.
iܙy
,

120 (
wp_da
.
y_dex
);

122 i(
	`Devi_Wre_Prݔty
(&
wp_da
=
l
) {

123 
r
 = 
ue
;

124 
n
 = 
BACNET_STATUS_ERROR
;

125 
WPM_ABORT
;

128 #i
PRINT_ENABLED


129 
	`rtf
(
dr
, "WPM: Bad Encoding!\n");

131 
r
 = 
ue
;

132 
WPM_ABORT
;

136 i(
	`decode_is_osg_g_numb
(&
rvi_que


137 [
decode_n
], 1)) {

138 
g_numb
 = 1;

139 
decode_n
++;

141 
g_numb
 = 0;

144 
g_numb
 != 1);

146 i(
r
) {

147 
WPM_ABORT
;

151 #i
PRINT_ENABLED


152 
	`rtf
(
dr
, "WPM: Bad Encoding!\n");

154 
r
 = 
ue
;

155 
WPM_ABORT
;

157 } 
decode_n
 < 
rvi_n
);

159 
WPM_ABORT
:

161 
	`dk_g_my_addss
(&
my_addss
);

162 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

163 
du_n
 =

164 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

165 &
du_da
);

166 
du_n
 = 0;

168 i(
r
) {

169 i(
n
 =
BACNET_STATUS_ABORT
) {

170 
du_n
 =

171 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

172 
rvi_da
->
voke_id
,

173 
	`abt_cvt_r_code
(
wp_da
.
r_code
), 
ue
);

174 #i
PRINT_ENABLED


175 
	`rtf
(
dr
, "WPM: Sending Abort!\n");

177 } i(
n
 =
BACNET_STATUS_ERROR
) {

178 
du_n
 =

179 
	`wpm_r_ack_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

180 
rvi_da
->
voke_id
, &
wp_da
);

181 #i
PRINT_ENABLED


182 
	`rtf
(
dr
, "WPM: Sending Error!\n");

184 } i(
n
 =
BACNET_STATUS_REJECT
) {

185 
du_n
 =

186 
	`je_code_du
(&
Hdr_Tnsm_Bufr
[
du_n
],

187 
rvi_da
->
voke_id
,

188 
	`je_cvt_r_code
(
wp_da
.
r_code
));

189 #i
PRINT_ENABLED


190 
	`rtf
(
dr
, "WPM: Sending Reject!\n");

194 
du_n
 =

195 
	`wpm_ack_code_du_
(&
Hdr_Tnsm_Bufr
[
du_n
],

196 
rvi_da
->
voke_id
);

197 #i
PRINT_ENABLED


198 
	`rtf
(
dr
, "WPM: Sending Ack!\n");

202 
pdu_n
 = 
du_n
 + 
du_n
;

203 
bys_
 =

204 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

205 
pdu_n
);

206 #i
PRINT_ENABLED


207 i(
bys_
 <= 0) {

208 
	`rtf
(
dr
, "Faedأnd PDU (%s)!\n", 
	`
(
o
));

211 
bys_
 = bytes_sent;

213 
	}
}

	@demo/handler/noserv.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"du.h
"

34 
	~"du.h
"

35 
	~"je.h
"

36 
	~"hdrs.h
"

37 
	~"devi.h
"

52 
	$hdr_uecognized_rvi
(

53 
ut8_t
 * 
rvi_que
,

54 
ut16_t
 
rvi_n
,

55 
BACNET_ADDRESS
 * 
c
,

56 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

58 
n
 = 0;

59 
pdu_n
 = 0;

60 
bys_
 = 0;

61 
BACNET_NPDU_DATA
 
du_da
;

62 
BACNET_ADDRESS
 
my_addss
;

64 (
rvi_que
;

65 (
rvi_n
;

68 
	`dk_g_my_addss
(&
my_addss
);

69 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

70 
pdu_n
 =

71 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

72 &
du_da
);

74 
n
 =

75 
	`je_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

76 
rvi_da
->
voke_id
, 
REJECT_REASON_UNRECOGNIZED_SERVICE
);

77 
pdu_n
 +
n
;

79 
bys_
 =

80 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

81 
pdu_n
);

82 i(
bys_
 > 0) {

83 #i
PRINT_ENABLED


84 
	`rtf
(
dr
, "Sent Reject!\n");

87 #i
PRINT_ENABLED


88 
	`rtf
(
dr
, "FaedSd Reje (%s)!\n", 
	`
(
o
));

91 
	}
}

	@demo/handler/objects.c

35 
	~<ddef.h
>

36 
	~<dlib.h
>

37 
	~<dio.h
>

38 
	~<memy.h
>

39 
	~"keyli.h
"

40 
	~"objes.h
"

45 
OS_Keyli
 
	gDevi_Li
 = 
NULL
;

47 
	$objes_
(

50 i(!
Devi_Li
)

51 
Devi_Li
 = 
	`Keyli_Ce
();

52 
	}
}

54 
	$objes_devi_cou
(

57 
	`objes_
();

58  
	`Keyli_Cou
(
Devi_Li
);

59 
	}
}

61 
OBJECT_DEVICE_T
 *
	$objes_devi_da
(

62 
dex
)

64 
	`objes_
();

65  
	`Keyli_Da_Index
(
Devi_Li
, 
dex
);

66 
	}
}

68 
OBJECT_DEVICE_T
 *
	$objes_devi_by_
(

69 
ut32_t
 
devi_
)

71 
	`objes_
();

72  
	`Keyli_Da
(
Devi_Li
, 
devi_
);

73 
	}
}

75 
OBJECT_DEVICE_T
 *
	$objes_devi_w
(

76 
ut32_t
 
devi_
)

78 
OBJECT_DEVICE_T
 *
pDevi
 = 
NULL
;

79 
KEY
 
key
 = 
devi_
;

81 i(
Devi_Li
) {

83 
pDevi
 = 
	`Keyli_Da
(
Devi_Li
, 
key
);

84 i(
pDevi
) {

85 
	`memt
(
pDevi
, 0, (
OBJECT_DEVICE_T
));

87 
pDevi
 = 
	`oc
(1, (
OBJECT_DEVICE_T
));

88 i(
pDevi
) {

89 
pDevi
->
Obje_Idtifr
.
ty
 = 
OBJECT_DEVICE
;

90 
pDevi
->
Obje_Idtifr
.

 = 
devi_
;

91 
pDevi
->
Obje_Ty
 = 
OBJECT_DEVICE
;

92 
pDevi
->
Obje_Li
 = 
	`Keyli_Ce
();

93 
	`Keyli_Da_Add
(
Devi_Li
, 
key
, 
pDevi
);

95 
	`rtf
(
dr
,

97 (
devi_
);

102  
pDevi
;

103 
	}
}

105 
OBJECT_DEVICE_T
 *
	$objes_devi_de
(

106 
dex
)

108 
OBJECT_DEVICE_T
 *
pDevi
 = 
NULL
;

109 
BACNET_OBJECT_ID
 *
pObje
;

111 i(
Devi_Li
) {

112 
pDevi
 = 
	`Keyli_Da_De_By_Index
(
Devi_Li
, 
dex
);

113 i(
pDevi
) {

114 
	`rtf
(
dr
, "Objects:emoving device %lu",

115 (
pDevi
->
Obje_Idtifr
.

);

116 i(
pDevi
->
Obje_Li
) {

118 
pObje
 =

119 
	`Keyli_Da_De_By_Index
(
pDevi
->
Obje_Li
, 0);

121 i(
pObje
) {

122 
	`
(
pObje
);

124 } 
pObje
);

125 
	`Keyli_De
(
pDevi
->
Obje_Li
);

127 
	`
(
pDevi
);

130  
pDevi
;

131 
	}
}

133 #ifde
TEST


134 
	~<as.h
>

135 
	~<rg.h
>

137 
	~"e.h
"

140 
	$BACtObjesCom
(

141 
Te
 * 
pTe
,

142 
OBJECT_DEVICE_T
 * 
pDevi
,

143 
ut32_t
 
devi_id
)

145 
	`_
(
pTe
, 
pDevi
 !
NULL
);

146 i(
pDevi
) {

147 
	`_
(
pTe
, 
pDevi
->
Obje_Li
 !
NULL
);

148 
	`_
(
pTe
, 
pDevi
->
Obje_Idtifr
.

 =
devi_id
);

149 
	`_
(
pTe
, 
pDevi
->
Obje_Idtifr
.
ty
 =
OBJECT_DEVICE
);

150 
	`_
(
pTe
, 
pDevi
->
Obje_Ty
 =
OBJECT_DEVICE
);

152 
	}
}

154 
	$BACtObjes
(

155 
Te
 * 
pTe
)

157 
ut32_t
 
devi_id
 = 0;

158 
_pot
 = 0;

159 cڡ 
max__pots
 = 20;

160 
OBJECT_DEVICE_T
 *
pDevi
;

162 
_pot
 = 0;e_po< 
max__pots
;est_point++) {

163 
devi_id
 = 
_pot
 * (
BACNET_MAX_INSTANCE
 / 
max__pots
);

164 
pDevi
 = 
	`objes_devi_w
(
devi_id
);

165 
	`BACtObjesCom
(
pTe
, 
pDevi
, 
devi_id
);

166 
pDevi
 = 
	`objes_devi_by_
(
devi_id
);

167 
	`BACtObjesCom
(
pTe
, 
pDevi
, 
devi_id
);

169 
	`_
(
pTe
, 
max__pots
 =
	`objes_devi_cou
());

170 
_pot
 = 0;e_po< 
max__pots
;est_point++) {

171 
devi_id
 = 
_pot
 * (
BACNET_MAX_INSTANCE
 / 
max__pots
);

172 
pDevi
 = 
	`objes_devi_by_
(
devi_id
);

173 
	`BACtObjesCom
(
pTe
, 
pDevi
, 
devi_id
);

175 
_pot
 = 0;e_po< 
max__pots
;est_point++) {

176 
devi_id
 = 
_pot
 * (
BACNET_MAX_INSTANCE
 / 
max__pots
);

177 
pDevi
 = 
	`objes_devi_da
(
_pot
);

178 
	`BACtObjesCom
(
pTe
, 
pDevi
, 
	`Keyli_Key
(
Devi_Li
,

179 
_pot
));

181 
_pot
 = 0;e_po< 
max__pots
;est_point++) {

182 
pDevi
 = 
	`objes_devi_de
(0);

184 
	}
}

186 #ifde
TEST_OBJECT_LIST


187 
	$ma
(

190 
Te
 *
pTe
;

191 
bo
 
rc
;

193 
pTe
 = 
	`_
("BACÈObjes", 
NULL
);

196 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtObjes
);

197 
	`as
(
rc
);

199 
	`_tSm
(
pTe
, 
dout
);

200 
	`_run
(
pTe
);

201 (
	`_pt
(
pTe
);

203 
	`_deroy
(
pTe
);

206 
	}
}

	@demo/handler/s_ack_alarm.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"whois.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~"m_ack.h
"

45 
	~".h
"

52 
ut8_t
 
	$Sd_Arm_Acknowdgemt
(

53 
ut32_t
 
devi_id
,

54 
BACNET_ALARM_ACK_DATA
 * 
da
)

56 
BACNET_ADDRESS
 
de
;

57 
BACNET_ADDRESS
 
my_addss
;

58 
max_du
 = 0;

59 
ut8_t
 
voke_id
 = 0;

60 
bo
 
us
 = 
l
;

61 
n
 = 0;

62 
pdu_n
 = 0;

63 
bys_
 = 0;

64 
BACNET_NPDU_DATA
 
du_da
;

66 i(!
	`dcc_communiti_abd
())

70 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

72 i(
us
)

73 
voke_id
 = 
	`tsm_xt__vokeID
();

74 i(
voke_id
) {

76 
	`dk_g_my_addss
(&
my_addss
);

77 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

78 
pdu_n
 =

79 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

80 &
du_da
);

81 
n
 =

82 
	`m_ack_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
,

83 
da
);

84 
pdu_n
 +
n
;

90 i((
pdu_n
 < 
max_du
) {

91 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

92 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

93 
bys_
 =

94 
	`dk_nd_pdu
(&
de
, &
du_da
,

95 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

96 #i
PRINT_ENABLED


97 i(
bys_
 <= 0)

98 
	`rtf
(
dr
, "Failedo Send Alarm Ack Request (%s)!\n",

99 
	`
(
o
));

102 
	`tsm__voke_id
(
voke_id
);

103 
voke_id
 = 0;

104 #i
PRINT_ENABLED


105 
	`rtf
(
dr
,

112  
voke_id
;

113 
	}
}

	@demo/handler/s_arfs.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"dcc.h
"

35 
	~"tsm.h
"

36 
	~"du.h
"

37 
	~"du.h
"

38 
	~"devi.h
"

39 
	~"dk.h
"

40 
	~"f.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~".h
"

48 
ut8_t
 
	$Sd_Atomic_Rd_Fe_Sm
(

49 
ut32_t
 
devi_id
,

50 
ut32_t
 
fe_
,

51 
feSPosi
,

52 
queedOCou
)

54 
BACNET_ADDRESS
 
de
;

55 
BACNET_ADDRESS
 
my_addss
;

56 
BACNET_NPDU_DATA
 
du_da
;

57 
max_du
 = 0;

58 
ut8_t
 
voke_id
 = 0;

59 
bo
 
us
 = 
l
;

60 
n
 = 0;

61 
pdu_n
 = 0;

62 
bys_
 = 0;

63 
BACNET_ATOMIC_READ_FILE_DATA
 
da
;

66 i(!
	`dcc_communiti_abd
())

70 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

72 i(
us
)

73 
voke_id
 = 
	`tsm_xt__vokeID
();

74 i(
voke_id
) {

76 
da
.
obje_ty
 = 
OBJECT_FILE
;

77 
da
.
obje_
 = 
fe_
;

78 
da
.
acss
 = 
FILE_STREAM_ACCESS
;

79 
da
.
ty
.
am
.
feSPosi
 = fileStartPosition;

80 
da
.
ty
.
am
.
queedOCou
 =equestedOctetCount;

82 
	`dk_g_my_addss
(&
my_addss
);

83 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

84 
pdu_n
 =

85 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

86 &
du_da
);

87 
n
 =

88 
	`f_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
,

89 &
da
);

90 
pdu_n
 +
n
;

96 i((
pdu_n
 < 
max_du
) {

97 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

98 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

99 
bys_
 =

100 
	`dk_nd_pdu
(&
de
, &
du_da
,

101 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

102 #i
PRINT_ENABLED


103 i(
bys_
 <= 0)

104 
	`rtf
(
dr
,

106 
	`
(
o
));

109 
	`tsm__voke_id
(
voke_id
);

110 
voke_id
 = 0;

111 #i
PRINT_ENABLED


112 
	`rtf
(
dr
,

119  
voke_id
;

120 
	}
}

	@demo/handler/s_awfs.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"dcc.h
"

36 
	~"du.h
"

37 
	~"du.h
"

38 
	~"devi.h
"

39 
	~"dk.h
"

40 
	~"awf.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~".h
"

48 
ut8_t
 
	$Sd_Atomic_Wre_Fe_Sm
(

49 
ut32_t
 
devi_id
,

50 
ut32_t
 
fe_
,

51 
feSPosi
,

52 
BACNET_OCTET_STRING
 * 
feDa
)

54 
BACNET_ADDRESS
 
de
;

55 
BACNET_ADDRESS
 
my_addss
;

56 
BACNET_NPDU_DATA
 
du_da
;

57 
max_du
 = 0;

58 
ut8_t
 
voke_id
 = 0;

59 
bo
 
us
 = 
l
;

60 
n
 = 0;

61 
pdu_n
 = 0;

62 
bys_
 = 0;

63 
BACNET_ATOMIC_WRITE_FILE_DATA
 
da
;

66 i(!
	`dcc_communiti_abd
())

70 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

72 i(
us
)

73 
voke_id
 = 
	`tsm_xt__vokeID
();

74 i(
voke_id
) {

76 
da
.
obje_ty
 = 
OBJECT_FILE
;

77 
da
.
obje_
 = 
fe_
;

78 
da
.
acss
 = 
FILE_STREAM_ACCESS
;

79 
da
.
ty
.
am
.
feSPosi
 = fileStartPosition;

80 
us
 = 
	`org_cy
(&
da
.
feDa
, fileData);

81 i(
us
) {

83 
	`dk_g_my_addss
(&
my_addss
);

84 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

85 
pdu_n
 =

86 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
,

87 &
my_addss
, &
du_da
);

89 
n
 =

90 
	`awf_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
,

91 &
da
);

92 
pdu_n
 +
n
;

98 i((
pdu_n
 <
max_du
) {

99 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

100 &
du_da
, &
Hdr_Tnsm_Bufr
[0],

101 (
ut16_t

pdu_n
);

102 
bys_
 =

103 
	`dk_nd_pdu
(&
de
, &
du_da
,

104 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

105 #i
PRINT_ENABLED


106 i(
bys_
 <= 0)

107 
	`rtf
(
dr
,

109 
	`
(
o
));

112 
	`tsm__voke_id
(
voke_id
);

113 
voke_id
 = 0;

114 #i
PRINT_ENABLED


115 
	`rtf
(
dr
,

118 
pdu_n
, 
max_du
);

122 
	`tsm__voke_id
(
voke_id
);

123 
voke_id
 = 0;

124 #i
PRINT_ENABLED


125 
	`rtf
(
dr
,

127 "ayld [%d]xedo sg cacy)!\n", 
pdu_n
);

132  
voke_id
;

133 
	}
}

	@demo/handler/s_cevent.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"evt.h
"

30 
	~"devi.h
"

31 
	~"dk.h
"

32 
	~"tsm.h
"

33 
	~"dcc.h
"

34 
	~"addss.h
"

36 
	~"hdrs.h
"

37 
	~"txbuf.h
"

38 
	~".h
"

50 
ut8_t
 
	$Sd_CEvt_Nify
(

51 
ut32_t
 
devi_id
,

52 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
)

54 
n
 = 0;

55 
pdu_n
 = 0;

56 
bys_
 = 0;

57 
BACNET_NPDU_DATA
 
du_da
;

58 
BACNET_ADDRESS
 
de
;

59 
BACNET_ADDRESS
 
my_addss
;

60 
max_du
 = 0;

61 
bo
 
us
 = 
l
;

62 
ut8_t
 
voke_id
 = 0;

64 i(!
	`dcc_communiti_abd
())

68 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

70 i(
us
)

71 
voke_id
 = 
	`tsm_xt__vokeID
();

72 i(
voke_id
) {

74 
	`dk_g_my_addss
(&
my_addss
);

75 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

76 
pdu_n
 =

77 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

78 &
du_da
);

80 
n
 =

81 
	`vt_nify_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

82 
voke_id
, 
da
);

83 
pdu_n
 +
n
;

89 i((
pdu_n
 < 
max_du
) {

90 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

91 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

92 
bys_
 =

93 
	`dk_nd_pdu
(&
de
, &
du_da
,

94 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

95 #i
PRINT_ENABLED


96 i(
bys_
 <= 0) {

97 
	`rtf
(
dr
,

99 
	`
(
o
));

103 
	`tsm__voke_id
(
voke_id
);

104 
voke_id
 = 0;

105 #i
PRINT_ENABLED


106 
	`rtf
(
dr
,

113  
voke_id
;

114 
	}
}

	@demo/handler/s_cov.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"addss.h
"

33 
	~"tsm.h
"

34 
	~"dcc.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"cov.h
"

41 
	~"hdrs.h
"

42 
	~"txbuf.h
"

43 
	~".h
"

47 
	$ucov_nify_code_pdu
(

48 
ut8_t
 * 
bufr
,

49 
BACNET_ADDRESS
 * 
de
,

50 
BACNET_NPDU_DATA
 * 
du_da
,

51 
BACNET_COV_DATA
 * 
cov_da
)

53 
n
 = 0;

54 
pdu_n
 = 0;

55 
BACNET_ADDRESS
 
my_addss
;

56 
	`dk_g_my_addss
(&
my_addss
);

59 
	`dk_g_brd_addss
(
de
);

61 
	`du_code_du_da
(
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

62 
pdu_n
 = 
	`du_code_pdu
(&
bufr
[0], 
de
, &
my_addss
, 
du_da
);

65 
n
 = 
	`ucov_nify_code_du
(&
bufr
[
pdu_n
], 
cov_da
);

66 
pdu_n
 +
n
;

68  
pdu_n
;

69 
	}
}

78 
	$Sd_UCOV_Nify
(

79 
ut8_t
 * 
bufr
,

80 
BACNET_COV_DATA
 * 
cov_da
)

82 
pdu_n
 = 0;

83 
BACNET_ADDRESS
 
de
;

84 
bys_
 = 0;

85 
BACNET_NPDU_DATA
 
du_da
;

87 
pdu_n
 = 
	`ucov_nify_code_pdu
(
bufr
, &
de
, &
du_da
, 
cov_da
);

88 
bys_
 = 
	`dk_nd_pdu
(&
de
, &
du_da
, &
bufr
[0], 
pdu_n
);

90  
bys_
;

91 
	}
}

101 
ut8_t
 
	$Sd_COV_Subsibe
(

102 
ut32_t
 
devi_id
,

103 
BACNET_SUBSCRIBE_COV_DATA
 * 
cov_da
)

105 
BACNET_ADDRESS
 
de
;

106 
BACNET_ADDRESS
 
my_addss
;

107 
max_du
 = 0;

108 
ut8_t
 
voke_id
 = 0;

109 
bo
 
us
 = 
l
;

110 
n
 = 0;

111 
pdu_n
 = 0;

112 
bys_
 = 0;

113 
BACNET_NPDU_DATA
 
du_da
;

115 i(!
	`dcc_communiti_abd
())

118 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

120 i(
us
) {

121 
voke_id
 = 
	`tsm_xt__vokeID
();

123 i(
voke_id
) {

125 
	`dk_g_my_addss
(&
my_addss
);

126 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

127 
pdu_n
 =

128 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

129 &
du_da
);

131 
n
 =

132 
	`cov_subsibe_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

133 
voke_id
, 
cov_da
);

134 
pdu_n
 +
n
;

140 i((
pdu_n
 < 
max_du
) {

141 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

142 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

143 
bys_
 =

144 
	`dk_nd_pdu
(&
de
, &
du_da
,

145 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

146 i(
bys_
 <= 0) {

147 #i
PRINT_ENABLED


148 
	`rtf
(
dr
, "Failedo Send SubscribeCOV Request (%s)!\n",

149 
	`
(
o
));

153 
	`tsm__voke_id
(
voke_id
);

154 
voke_id
 = 0;

155 #i
PRINT_ENABLED


156 
	`rtf
(
dr
,

163  
voke_id
;

164 
	}
}

	@demo/handler/s_dcc.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

41 
	~"hdrs.h
"

42 
	~"txbuf.h
"

43 
	~".h
"

58 
ut8_t
 
	$Sd_Devi_Communiti_Cڌ_Reque
(

59 
ut32_t
 
devi_id
,

60 
ut16_t
 
timeDuti
,

61 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
e
,

62 *
sswd
)

64 
BACNET_ADDRESS
 
de
;

65 
BACNET_ADDRESS
 
my_addss
;

66 
max_du
 = 0;

67 
ut8_t
 
voke_id
 = 0;

68 
bo
 
us
 = 
l
;

69 
n
 = 0;

70 
pdu_n
 = 0;

71 
bys_
 = 0;

72 
BACNET_CHARACTER_STRING
 
sswd_rg
;

73 
BACNET_NPDU_DATA
 
du_da
;

76 i(!
	`dcc_communiti_abd
())

80 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

82 i(
us
)

83 
voke_id
 = 
	`tsm_xt__vokeID
();

84 i(
voke_id
) {

86 
	`dk_g_my_addss
(&
my_addss
);

87 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

88 
pdu_n
 =

89 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

90 &
du_da
);

92 
	`charg__si
(&
sswd_rg
, 
sswd
);

93 
n
 =

94 
	`dcc_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
,

95 
timeDuti
, 
e
, 
sswd
 ? &
sswd_rg
 : 
NULL
);

96 
pdu_n
 +
n
;

102 i((
pdu_n
 < 
max_du
) {

103 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

104 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

105 
bys_
 =

106 
	`dk_nd_pdu
(&
de
, &
du_da
,

107 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

108 #i
PRINT_ENABLED


109 i(
bys_
 <= 0)

110 
	`rtf
(
dr
,

112 
	`
(
o
));

115 
	`tsm__voke_id
(
voke_id
);

116 
voke_id
 = 0;

117 #i
PRINT_ENABLED


118 
	`rtf
(
dr
,

125  
voke_id
;

126 
	}
}

	@demo/handler/s_iam.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"addss.h
"

33 
	~"tsm.h
"

34 
	~"dcc.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"m.h
"

40 
	~"txbuf.h
"

42 
	~"hdrs.h
"

43 
	~".h
"

54 
	$Sd_I_Am_To_Nwk
(

55 
BACNET_ADDRESS
 * 
rg_addss
,

56 
ut32_t
 
devi_id
,

57 
max_du
,

58 
gmti
,

59 
ut16_t
 
vd_id
)

61 
n
 = 0;

62 
pdu_n
 = 0;

63 
bys_
 = 0;

64 
BACNET_NPDU_DATA
 
du_da
;

65 
BACNET_ADDRESS
 
my_addss
;

67 
	`dk_g_my_addss
(&
my_addss
);

69 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

71 
pdu_n
 =

72 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
rg_addss
,

73 &
my_addss
, &
du_da
);

76 
n
 =

77 
	`m_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

78 
devi_id
, 
max_du
, 
gmti
, 
vd_id
);

79 
pdu_n
 +
n
;

80 
bys_
 =

81 
	`dk_nd_pdu
(
rg_addss
, &
du_da
,

82 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

83 i(
bys_
 <= 0) {

84 #i
PRINT_ENABLED


85 
	`rtf
(
dr
, "Failedo Send I-Am Request (%s)!\n",

86 
	`
(
o
));

90 
	}
}

98 
	$m_code_pdu
(

99 
ut8_t
 * 
bufr
,

100 
BACNET_ADDRESS
 * 
de
,

101 
BACNET_NPDU_DATA
 * 
du_da
)

103 
n
 = 0;

104 
pdu_n
 = 0;

105 
BACNET_ADDRESS
 
my_addss
;

106 
	`dk_g_my_addss
(&
my_addss
);

108 
	`dk_g_brd_addss
(
de
);

110 
	`du_code_du_da
(
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

111 
pdu_n
 = 
	`du_code_pdu
(&
bufr
[0], 
de
, &
my_addss
, 
du_da
);

114 
n
 =

115 
	`m_code_du
(&
bufr
[
pdu_n
], 
	`Devi_Obje_In_Numb
(),

116 
MAX_APDU
, 
SEGMENTATION_NONE
, 
	`Devi_Vd_Idtifr
());

117 
pdu_n
 +
n
;

119  
pdu_n
;

120 
	}
}

127 
	$Sd_I_Am
(

128 
ut8_t
 * 
bufr
)

130 
pdu_n
 = 0;

131 
BACNET_ADDRESS
 
de
;

132 
bys_
 = 0;

133 
BACNET_NPDU_DATA
 
du_da
;

143 i(!
	`dcc_communiti_abd
())

148 
pdu_n
 = 
	`m_code_pdu
(
bufr
, &
de
, &
du_da
);

150 
bys_
 = 
	`dk_nd_pdu
(&
de
, &
du_da
, &
bufr
[0], 
pdu_n
);

152 i(
bys_
 <= 0) {

153 #i
PRINT_ENABLED


154 
	`rtf
(
dr
, "FaedSd I-Am Rly (%s)!\n", 
	`
(
o
));

157 
	}
}

168 
	$m_uni_code_pdu
(

169 
ut8_t
 * 
bufr
,

170 
BACNET_ADDRESS
 * 
c
,

171 
BACNET_ADDRESS
 * 
de
,

172 
BACNET_NPDU_DATA
 * 
du_da
)

174 
du_n
 = 0;

175 
du_n
 = 0;

176 
pdu_n
 = 0;

177 
BACNET_ADDRESS
 
my_addss
;

179 
	`ba_addss_cy
(
de
, 
c
);

182 
	`dk_g_my_addss
(&
my_addss
);

184 
	`du_code_du_da
(
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

185 
du_n
 = 
	`du_code_pdu
(&
bufr
[0], 
de
, &
my_addss
, 
du_da
);

187 
du_n
 =

188 
	`m_code_du
(&
bufr
[
du_n
], 
	`Devi_Obje_In_Numb
(),

189 
MAX_APDU
, 
SEGMENTATION_NONE
, 
	`Devi_Vd_Idtifr
());

190 
pdu_n
 = 
du_n
 + 
du_n
;

192  
pdu_n
;

193 
	}
}

206 
	$Sd_I_Am_Uni
(

207 
ut8_t
 * 
bufr
,

208 
BACNET_ADDRESS
 * 
c
)

210 
pdu_n
 = 0;

211 
BACNET_ADDRESS
 
de
;

212 
bys_
 = 0;

213 
BACNET_NPDU_DATA
 
du_da
;

223 i(!
	`dcc_communiti_abd
())

228 
pdu_n
 = 
	`m_uni_code_pdu
(
bufr
, 
c
, &
de
, &
du_da
);

230 
bys_
 = 
	`dk_nd_pdu
(&
de
, &
du_da
, &
bufr
[0], 
pdu_n
);

232 i(
bys_
 <= 0) {

233 #i
PRINT_ENABLED


234 
	`rtf
(
dr
, "FaedSd I-Am Rly (%s)!\n", 
	`
(
o
));

237 
	}
}

	@demo/handler/s_ihave.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"ihave.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~".h
"

56 
	$Sd_I_Have
(

57 
ut32_t
 
devi_id
,

58 
BACNET_OBJECT_TYPE
 
obje_ty
,

59 
ut32_t
 
obje_
,

60 
BACNET_CHARACTER_STRING
 * 
obje_me
)

62 
n
 = 0;

63 
pdu_n
 = 0;

64 
BACNET_ADDRESS
 
de
;

65 
bys_
 = 0;

66 
BACNET_I_HAVE_DATA
 
da
;

67 
BACNET_NPDU_DATA
 
du_da
;

68 
BACNET_ADDRESS
 
my_addss
;

70 
	`dk_g_my_addss
(&
my_addss
);

72 i(!
	`dcc_communiti_abd
())

75 
	`dk_g_brd_addss
(&
de
);

77 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

78 
pdu_n
 =

79 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

80 &
du_da
);

83 
da
.
devi_id
.
ty
 = 
OBJECT_DEVICE
;

84 
da
.
devi_id
.

 = device_id;

85 
da
.
obje_id
.
ty
 = 
obje_ty
;

86 
da
.
obje_id
.

 = 
obje_
;

87 
	`charg_cy
(&
da
.
obje_me
, object_name);

88 
n
 = 
	`ihave_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], &
da
);

89 
pdu_n
 +
n
;

91 
bys_
 =

92 
	`dk_nd_pdu
(&
de
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

93 
pdu_n
);

94 i(
bys_
 <= 0) {

95 #i
PRINT_ENABLED


96 
	`rtf
(
dr
, "Failedo Send I-Have Reply (%s)!\n",

97 
	`
(
o
));

100 
	}
}

	@demo/handler/s_lso.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"whois.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~"lso.h
"

45 
	~".h
"

52 
ut8_t
 
	$Sd_Li_Saty_Oti_Da
(

53 
ut32_t
 
devi_id
,

54 
BACNET_LSO_DATA
 * 
da
)

56 
BACNET_ADDRESS
 
de
;

57 
BACNET_ADDRESS
 
my_addss
;

58 
max_du
 = 0;

59 
ut8_t
 
voke_id
 = 0;

60 
bo
 
us
 = 
l
;

61 
n
 = 0;

62 
pdu_n
 = 0;

63 
bys_
 = 0;

64 
BACNET_NPDU_DATA
 
du_da
;

66 i(!
	`dcc_communiti_abd
())

70 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

72 i(
us
)

73 
voke_id
 = 
	`tsm_xt__vokeID
();

74 i(
voke_id
) {

76 
	`dk_g_my_addss
(&
my_addss
);

77 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

78 
pdu_n
 =

79 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

80 &
du_da
);

81 
n
 =

82 
	`lso_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
,

83 
da
);

84 
pdu_n
 +
n
;

90 i((
pdu_n
 < 
max_du
) {

91 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

92 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

93 
bys_
 =

94 
	`dk_nd_pdu
(&
de
, &
du_da
,

95 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

96 #i
PRINT_ENABLED


97 i(
bys_
 <= 0)

98 
	`rtf
(
dr
, "Failedo Send Life Safe Op Request (%s)!\n",

99 
	`
(
o
));

102 
	`tsm__voke_id
(
voke_id
);

103 
voke_id
 = 0;

104 #i
PRINT_ENABLED


105 
	`rtf
(
dr
,

112  
voke_id
;

113 
	}
}

	@demo/handler/s_ptransfer.c

25 
	~<dlib.h
>

26 
	~<ddef.h
>

27 
	~<dt.h
>

28 
	~<o.h
>

29 
	~<rg.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"addss.h
"

35 
	~"tsm.h
"

36 
	~"du.h
"

37 
	~"du.h
"

38 
	~"devi.h
"

39 
	~"dk.h
"

40 
	~"dcc.h
"

41 
	~"nsr.h
"

43 
	~"hdrs.h
"

44 
	~"txbuf.h
"

45 
	~"myda.h
"

46 
	~".h
"

51 
ut8_t
 
Sd_Prive_Tnsr_Reque
(

52 
ut32_t
 
devi_id
,

53 
ut16_t
 
vd_id
,

54 
ut32_t
 
rvi_numb
,

55 
block_numb
,

56 
DATABLOCK
 * 
block
);

58 
ut8_t
 
	$Sd_Prive_Tnsr_Reque
(

59 
ut32_t
 
devi_id
,

60 
ut16_t
 
vd_id
,

61 
ut32_t
 
rvi_numb
,

62 
block_numb
,

63 
DATABLOCK
 * 
block
)

65 
BACNET_ADDRESS
 
de
;

66 
BACNET_ADDRESS
 
my_addss
;

67 
max_du
 = 0;

68 
ut8_t
 
voke_id
 = 0;

69 
bo
 
us
 = 
l
;

70 
n
 = 0;

71 
pdu_n
 = 0;

72 
bys_
 = 0;

73 
BACNET_NPDU_DATA
 
du_da
;

74 
ut8_t
 
_q_bufr
[300];

75 
BACNET_PRIVATE_TRANSFER_DATA
 
_block
;

76 
BACNET_CHARACTER_STRING
 
bsTemp
;

79 i(!
	`dcc_communiti_abd
())

83 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

85 i(
us
)

86 
voke_id
 = 
	`tsm_xt__vokeID
();

87 i(
voke_id
) {

89 
	`dk_g_my_addss
(&
my_addss
);

90 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

91 
pdu_n
 =

92 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

93 &
du_da
);

96 
_block
.
vdID
 = 
vd_id
;

97 
_block
.
rviNumb
 = 
rvi_numb
;

98 i(
rvi_numb
 =
MY_SVC_READ
) {

99 
n
 +
	`code_iti_unsigd
(&
_q_bufr
[n], 
block_numb
);

101 
n
 +
	`code_iti_unsigd
(&
_q_bufr
[n], 
block_numb
);

102 
n
 +
	`code_iti_unsigd
(&
_q_bufr
[n], 
block
->
cMyBy1
);

103 
n
 +=

104 
	`code_iti_unsigd
(&
_q_bufr
[
n
],

105 
block
->
cMyBy2
);

106 
n
 +=

107 
	`code_iti_
(&
_q_bufr
[
n
], 
block
->
fMyRl
);

108 
	`charg__si
(&
bsTemp
, (*
block
->
sMySg
);

109 
n
 +=

110 
	`code_iti_cha_rg
(&
_q_bufr
[
n
],

111 &
bsTemp
);

114 
_block
.
rviPams
 = &
_q_bufr
[0];

115 
_block
.
rviPamsL
 = 
n
;

116 
n
 =

117 
	`nsr_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
,

118 &
_block
);

119 
pdu_n
 +
n
;

127 i((
pdu_n
 < 
max_du
) {

128 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

129 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

130 
bys_
 =

131 
	`dk_nd_pdu
(&
de
, &
du_da
,

132 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

133 #i
PRINT_ENABLED


134 i(
bys_
 <= 0)

135 
	`rtf
(
dr
,

137 
	`
(
o
));

140 
	`tsm__voke_id
(
voke_id
);

141 
voke_id
 = 0;

142 #i
PRINT_ENABLED


143 
	`rtf
(
dr
,

150  
voke_id
;

151 
	}
}

	@demo/handler/s_rd.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"rd.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~".h
"

56 
ut8_t
 
	$Sd_Relize_Devi_Reque
(

57 
ut32_t
 
devi_id
,

58 
BACNET_REINITIALIZED_STATE
 
e
,

59 *
sswd
)

61 
BACNET_ADDRESS
 
de
;

62 
BACNET_ADDRESS
 
my_addss
;

63 
max_du
 = 0;

64 
ut8_t
 
voke_id
 = 0;

65 
bo
 
us
 = 
l
;

66 
n
 = 0;

67 
pdu_n
 = 0;

68 
bys_
 = 0;

69 
BACNET_CHARACTER_STRING
 
sswd_rg
;

70 
BACNET_NPDU_DATA
 
du_da
;

73 i(!
	`dcc_communiti_abd
())

77 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

79 i(
us
)

80 
voke_id
 = 
	`tsm_xt__vokeID
();

81 i(
voke_id
) {

83 
	`dk_g_my_addss
(&
my_addss
);

84 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

85 
pdu_n
 =

86 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

87 &
du_da
);

89 
	`charg__si
(&
sswd_rg
, 
sswd
);

90 
n
 =

91 
	`rd_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
, 
e
,

92 
sswd
 ? &
sswd_rg
 : 
NULL
);

93 
pdu_n
 +
n
;

99 i((
pdu_n
 < 
max_du
) {

100 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

101 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

102 
bys_
 =

103 
	`dk_nd_pdu
(&
de
, &
du_da
,

104 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

105 #i
PRINT_ENABLED


106 i(
bys_
 <= 0)

107 
	`rtf
(
dr
,

109 
	`
(
o
));

112 
	`tsm__voke_id
(
voke_id
);

113 
voke_id
 = 0;

114 #i
PRINT_ENABLED


115 
	`rtf
(
dr
,

122  
voke_id
;

123 
	}
}

	@demo/handler/s_readrange.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"m.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~"adnge.h
"

45 
	~".h
"

50 
ut8_t
 
	$Sd_RdRge_Reque
(

51 
ut32_t
 
devi_id
,

52 
BACNET_READ_RANGE_DATA
 * 
ad_acss_da
)

54 
BACNET_ADDRESS
 
de
;

55 
BACNET_ADDRESS
 
my_addss
;

56 
max_du
 = 0;

57 
ut8_t
 
voke_id
 = 0;

58 
bo
 
us
 = 
l
;

59 
n
 = 0;

60 
pdu_n
 = 0;

61 
bys_
 = 0;

62 
BACNET_NPDU_DATA
 
du_da
;

64 i(!
	`dcc_communiti_abd
())

68 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

70 i(
us
)

71 
voke_id
 = 
	`tsm_xt__vokeID
();

73 i(
voke_id
) {

75 
	`dk_g_my_addss
(&
my_addss
);

76 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

77 
pdu_n
 =

78 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

79 &
du_da
);

82 
n
 =

83 
	`_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
,

84 
ad_acss_da
);

85 i(
n
 <= 0) {

89 
pdu_n
 +
n
;

95 i((
pdu_n
 < 
max_du
) {

96 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

97 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

98 
bys_
 =

99 
	`dk_nd_pdu
(&
de
, &
du_da
,

100 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

101 #i
PRINT_ENABLED


102 i(
bys_
 <= 0)

103 
	`rtf
(
dr
, "Failedo Send ReadRange Request (%s)!\n",

104 
	`
(
o
));

107 
	`tsm__voke_id
(
voke_id
);

108 
voke_id
 = 0;

109 #i
PRINT_ENABLED


110 
	`rtf
(
dr
,

116  
voke_id
;

117 
	}
}

	@demo/handler/s_router.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"baext.h
"

41 
	~"hdrs.h
"

42 
	~"txbuf.h
"

43 
	~".h
"

44 
	~"debug.h
"

61 
	$du_code_du_twk
(

62 
BACNET_NPDU_DATA
 * 
du_da
,

63 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

64 
bo
 
da_exg_y
,

65 
BACNET_MESSAGE_PRIORITY
 
iܙy
)

67 i(
du_da
) {

68 
du_da
->
da_exg_y
 = data_expecting_reply;

69 
du_da
->
oc_vsi
 = 
BACNET_PROTOCOL_VERSION
;

70 
du_da
->
twk_y_mesge
 = 
ue
;

71 
du_da
->
twk_mesge_ty
 =etwork_message_type;

72 
du_da
->
vd_id
 = 0;

73 
du_da
->
iܙy
 =riority;

74 
du_da
->
h_cou
 = 
HOP_COUNT_DEFAULT
;

76 
	}
}

100 
	$Sd_Nwk_Lay_Mesge
(

101 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

102 
BACNET_ADDRESS
 * 
d
,

103 *
iArgs
)

105 
n
 = 0;

106 
pdu_n
 = 0;

107 
bys_
 = 0;

108 *
pV
 = 
iArgs
;

109 
bo
 
da_exg_y
 = 
l
;

110 
BACNET_NPDU_DATA
 
du_da
;

111 
BACNET_ADDRESS
 
bDe
;

113 i(
iArgs
 =
NULL
)

117 i(
d
 =
NULL
) {

118 
	`dk_g_brd_addss
(&
bDe
);

119 
d
 = &
bDe
;

122 i(
twk_mesge_ty
 =
NETWORK_MESSAGE_INIT_RT_TABLE
)

123 
da_exg_y
 = 
ue
;

124 
	`du_code_du_twk
(&
du_da
, 
twk_mesge_ty
,

125 
da_exg_y
, 
MESSAGE_PRIORITY_NORMAL
);

130 
pdu_n
 =

131 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
d
, 
NULL
, &
du_da
);

134 
twk_mesge_ty
) {

135 
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
:

136 i(*
pV
 >= 0) {

137 
n
 =

138 
	`code_unsigd16
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

139 (
ut16_t
* 
pV
);

140 
pdu_n
 +
n
;

145 
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
:

146 
NETWORK_MESSAGE_ROUTER_BUSY_TO_NETWORK
:

147 
NETWORK_MESSAGE_ROUTER_AVAILABLE_TO_NETWORK
:

148 *
pV
 >= 0) {

149 
n
 =

150 
	`code_unsigd16
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

151 (
ut16_t
* 
pV
);

152 
pdu_n
 +
n
;

153 
pV
++;

157 
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
:

159 
Hdr_Tnsm_Bufr
[
pdu_n
++] = (
ut8_t
* 
pV
;

160 
pV
++;

161 
n
 =

162 
	`code_unsigd16
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

163 (
ut16_t
* 
pV
);

164 
pdu_n
 +
n
;

167 
NETWORK_MESSAGE_INIT_RT_TABLE
:

168 
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
:

170 
n
 = 0;

171 *
pV
 >= 0) {

172 
n
++;

173 
pV
++;

175 
Hdr_Tnsm_Bufr
[
pdu_n
++] = (
ut8_t

n
;

177 i(
n
 > 0) {

178 
ut8_t
 
ptID
 = 1;

179 
pV
 = 
iArgs
;

184 *
pV
 >= 0) {

185 
n
 =

186 
	`code_unsigd16
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

187 (
ut16_t
* 
pV
);

188 
pdu_n
 +
n
;

189 
Hdr_Tnsm_Bufr
[
pdu_n
++] = 
ptID
++;

190 
Hdr_Tnsm_Bufr
[
pdu_n
++] = 0;

191 
	`debug_tf
(" Sending Routing Tablentry for %u \n",

192 *
pV
);

193 
pV
++;

199 
	`debug_tf
("Not sent: %s message unsupported \n",

200 
	`baext_twk_y_msg_me
(
twk_mesge_ty
));

205 i(
d
 !
NULL
)

206 
	`debug_tf
("Sending %s messageo BACnetetwork %u \n",

207 
	`baext_twk_y_msg_me
(
twk_mesge_ty
), 
d
->
t
);

209 
	`debug_tf
("Sending %s messageoocal BACnetetwork \n",

210 
	`baext_twk_y_msg_me
(
twk_mesge_ty
));

213 
bys_
 =

214 
	`dk_nd_pdu
(
d
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

215 
pdu_n
);

216 #i
PRINT_ENABLED


217 i(
bys_
 <= 0) {

218 
wasEno
 = 
o
;

219 
	`debug_tf
("Failedo send %s message (%s)!\n",

220 
	`baext_twk_y_msg_me
(
twk_mesge_ty
),

221 
	`
(
wasEno
));

224  
bys_
;

225 
	}
}

239 
	$Sd_Who_Is_Rour_To_Nwk
(

240 
BACNET_ADDRESS
 * 
d
,

241 
dt
)

243 
	`Sd_Nwk_Lay_Mesge
(
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
, 
d
,

244 &
dt
);

245 
	}
}

256 
	$Sd_I_Am_Rour_To_Nwk
(

257 cڡ 
DNET_li
[])

260 
	`Sd_Nwk_Lay_Mesge
(
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
, 
NULL
,

261 (*
DNET_li
);

262 
	}
}

274 
	$Sd_Reje_Mesge_To_Nwk
(

275 
BACNET_ADDRESS
 * 
d
,

276 
ut8_t
 
je_as
,

277 
dt
)

279 
iArgs
[2];

280 
iArgs
[0] = 
je_as
;

281 
iArgs
[1] = 
dt
;

282 
	`Sd_Nwk_Lay_Mesge
(
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
, 
d
,

283 
iArgs
);

284 
	`debug_tf
(" Reje Rs=%d, DNET=%u\n", 
je_as
, 
dt
);

285 
	}
}

304 
	$Sd_Inlize_Routg_Tab
(

305 
BACNET_ADDRESS
 * 
d
,

306 cڡ 
DNET_li
[])

309 
	`Sd_Nwk_Lay_Mesge
(
NETWORK_MESSAGE_INIT_RT_TABLE
, 
d
,

310 (*
DNET_li
);

311 
	}
}

331 
	$Sd_Inlize_Routg_Tab_Ack
(

332 
BACNET_ADDRESS
 * 
d
,

333 cڡ 
DNET_li
[])

335 
	`Sd_Nwk_Lay_Mesge
(
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
, 
d
,

336 (*
DNET_li
);

337 
	}
}

	@demo/handler/s_rp.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~".h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~".h
"

62 
ut8_t
 
	$Sd_Rd_Prݔty_Reque_Addss
(

63 
BACNET_ADDRESS
 * 
de
,

64 
ut16_t
 
max_du
,

65 
BACNET_OBJECT_TYPE
 
obje_ty
,

66 
ut32_t
 
obje_
,

67 
BACNET_PROPERTY_ID
 
obje_ݔty
,

68 
ut32_t
 
y_dex
)

70 
BACNET_ADDRESS
 
my_addss
;

71 
ut8_t
 
voke_id
 = 0;

72 
n
 = 0;

73 
pdu_n
 = 0;

74 
bys_
 = 0;

75 
BACNET_READ_PROPERTY_DATA
 
da
;

76 
BACNET_NPDU_DATA
 
du_da
;

78 i(!
	`dcc_communiti_abd
()) {

81 i(!
de
) {

85 
voke_id
 = 
	`tsm_xt__vokeID
();

86 i(
voke_id
) {

88 
	`dk_g_my_addss
(&
my_addss
);

89 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

90 
pdu_n
 =

91 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
de
, &
my_addss
,

92 &
du_da
);

94 
da
.
obje_ty
 = object_type;

95 
da
.
obje_
 = object_instance;

96 
da
.
obje_ݔty
 = object_property;

97 
da
.
y_dex
 =rray_index;

98 
n
 =

99 
	`_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
,

100 &
da
);

101 
pdu_n
 +
n
;

107 i((
ut16_t

pdu_n
 < 
max_du
) {

108 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, 
de
,

109 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

110 
bys_
 =

111 
	`dk_nd_pdu
(
de
, &
du_da
,

112 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

113 i(
bys_
 <= 0) {

114 #i
PRINT_ENABLED


115 
	`rtf
(
dr
, "Failedo Send ReadProperty Request (%s)!\n",

116 
	`
(
o
));

120 
	`tsm__voke_id
(
voke_id
);

121 
voke_id
 = 0;

122 #i
PRINT_ENABLED


123 
	`rtf
(
dr
,

130  
voke_id
;

131 
	}
}

146 
ut8_t
 
	$Sd_Rd_Prݔty_Reque
(

147 
ut32_t
 
devi_id
,

148 
BACNET_OBJECT_TYPE
 
obje_ty
,

149 
ut32_t
 
obje_
,

150 
BACNET_PROPERTY_ID
 
obje_ݔty
,

151 
ut32_t
 
y_dex
)

153 
BACNET_ADDRESS
 
de
 = { 0 };

154 
max_du
 = 0;

155 
ut8_t
 
voke_id
 = 0;

156 
bo
 
us
 = 
l
;

159 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

160 i(
us
) {

161 
voke_id
 =

162 
	`Sd_Rd_Prݔty_Reque_Addss
(&
de
, 
max_du
, 
obje_ty
,

163 
obje_
, 
obje_ݔty
, 
y_dex
);

166  
voke_id
;

167 
	}
}

	@demo/handler/s_rpm.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"m.h
"

42 
	~"hdrs.h
"

43 
	~"sbuf.h
"

44 
	~".h
"

58 
ut8_t
 
	$Sd_Rd_Prݔty_Muɝ_Reque
(

59 
ut8_t
 * 
pdu
,

60 
size_t
 
max_pdu
,

61 
ut32_t
 
devi_id
,

62 
BACNET_READ_ACCESS_DATA
 * 
ad_acss_da
)

64 
BACNET_ADDRESS
 
de
;

65 
BACNET_ADDRESS
 
my_addss
;

66 
max_du
 = 0;

67 
ut8_t
 
voke_id
 = 0;

68 
bo
 
us
 = 
l
;

69 
n
 = 0;

70 
pdu_n
 = 0;

71 
bys_
 = 0;

72 
BACNET_NPDU_DATA
 
du_da
;

74 i(!
	`dcc_communiti_abd
())

78 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

80 i(
us
)

81 
voke_id
 = 
	`tsm_xt__vokeID
();

82 i(
voke_id
) {

84 
	`dk_g_my_addss
(&
my_addss
);

85 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

86 
pdu_n
 = 
	`du_code_pdu
(&
pdu
[0], &
de
, &
my_addss
, &
du_da
);

88 
n
 =

89 
	`m_code_du
(&
pdu
[
pdu_n
], 
max_pdu
 -du_n, 
voke_id
,

90 
ad_acss_da
);

91 i(
n
 <= 0) {

94 
pdu_n
 +
n
;

100 i((
pdu_n
 < 
max_du
) {

101 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

102 &
du_da
, &
pdu
[0], (
ut16_t

pdu_n
);

103 
bys_
 =

104 
	`dk_nd_pdu
(&
de
, &
du_da
, &
pdu
[0], 
pdu_n
);

105 #i
PRINT_ENABLED


106 i(
bys_
 <= 0)

107 
	`rtf
(
dr
,

109 
	`
(
o
));

112 
	`tsm__voke_id
(
voke_id
);

113 
voke_id
 = 0;

114 #i
PRINT_ENABLED


115 
	`rtf
(
dr
,

122  
voke_id
;

123 
	}
}

	@demo/handler/s_ts.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"timesync.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~".h
"

55 
	$Sd_TimeSync_Reme
(

56 
BACNET_ADDRESS
 * 
de
,

57 
BACNET_DATE
 * 
bde
,

58 
BACNET_TIME
 * 
btime
)

60 
n
 = 0;

61 
pdu_n
 = 0;

62 
bys_
 = 0;

63 
BACNET_NPDU_DATA
 
du_da
;

64 
BACNET_ADDRESS
 
my_addss
;

66 i(!
	`dcc_communiti_abd
())

69 
	`dk_g_my_addss
(&
my_addss
);

71 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

72 
pdu_n
 =

73 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
de
, &
my_addss
,

74 &
du_da
);

76 
n
 =

77 
	`timesync_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
bde
, 
btime
);

78 
pdu_n
 +
n
;

80 
bys_
 =

81 
	`dk_nd_pdu
(
de
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

82 
pdu_n
);

83 #i
PRINT_ENABLED


84 i(
bys_
 <= 0)

85 
	`rtf
(
dr
, "Failedo Send Time-Synchronization Request (%s)!\n",

86 
	`
(
o
));

88 
	}
}

96 
	$Sd_TimeSync
(

97 
BACNET_DATE
 * 
bde
,

98 
BACNET_TIME
 * 
btime
)

100 
BACNET_ADDRESS
 
de
;

102 
	`dk_g_brd_addss
(&
de
);

103 
	`Sd_TimeSync_Reme
(&
de
, 
bde
, 
btime
);

104 
	}
}

113 
	$Sd_TimeSyncUTC_Reme
(

114 
BACNET_ADDRESS
 * 
de
,

115 
BACNET_DATE
 * 
bde
,

116 
BACNET_TIME
 * 
btime
)

118 
n
 = 0;

119 
pdu_n
 = 0;

120 
bys_
 = 0;

121 
BACNET_NPDU_DATA
 
du_da
;

122 
BACNET_ADDRESS
 
my_addss
;

124 i(!
	`dcc_communiti_abd
())

127 
	`dk_g_my_addss
(&
my_addss
);

129 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

130 
pdu_n
 =

131 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
de
, &
my_addss
,

132 &
du_da
);

134 
n
 =

135 
	`timesync_utc_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

136 
bde
, 
btime
);

137 
pdu_n
 +
n
;

138 
bys_
 =

139 
	`dk_nd_pdu
(
de
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

140 
pdu_n
);

141 #i
PRINT_ENABLED


142 i(
bys_
 <= 0)

143 
	`rtf
(
dr
,

145 
	`
(
o
));

147 
	}
}

155 
	$Sd_TimeSyncUTC
(

156 
BACNET_DATE
 * 
bde
,

157 
BACNET_TIME
 * 
btime
)

159 
BACNET_ADDRESS
 
de
;

161 
	`dk_g_brd_addss
(&
de
);

162 
	`Sd_TimeSyncUTC_Reme
(&
de
, 
bde
, 
btime
);

163 
	}
}

168 
	$Sd_TimeSyncUTC_Devi
()

170 
t32_t
 
utc_offt_mus
 = 0;

171 
bo
 
d
 = 
l
;

172 
BACNET_DATE_TIME
 
lol_time
;

173 
BACNET_DATE_TIME
 
utc_time
;

175 
	`Devi_gCutDeTime
(&
lol_time
);

176 
d
 = 
	`Devi_Daylight_Savgs_Stus
();

177 
utc_offt_mus
 = 
	`Devi_UTC_Offt
();

178 
	`dime_cy
(&
utc_time
, &
lol_time
);

179 
	`dime_add_mus
(&
utc_time
, 
utc_offt_mus
);

180 i(
d
) {

181 
	`dime_add_mus
(&
utc_time
, -60);

183 
	`Sd_TimeSyncUTC
(&
utc_time
.
de
, &utc_time.
time
);

184 
	}
}

189 
	$Sd_TimeSync_Devi
()

191 
BACNET_DATE_TIME
 
lol_time
;

193 
	`Devi_gCutDeTime
(&
lol_time
);

194 
	`Sd_TimeSync
(&
lol_time
.
de
, &lol_time.
time
);

195 
	}
}

	@demo/handler/s_uevent.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~"evt.h
"

29 
	~"dk.h
"

30 
	~".h
"

31 
	~"devi.h
"

43 
	$Sd_UEvt_Nify
(

44 
ut8_t
 * 
bufr
,

45 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
,

46 
BACNET_ADDRESS
 * 
de
)

48 
n
 = 0;

49 
pdu_n
 = 0;

50 
bys_
 = 0;

51 
BACNET_NPDU_DATA
 
du_da
;

52 
BACNET_ADDRESS
 
my_addss
;

54 
	`dk_g_my_addss
(&
my_addss
);

56 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

57 
pdu_n
 = 
	`du_code_pdu
(
bufr
, 
de
, &
my_addss
, &
du_da
);

59 
n
 = 
	`uevt_nify_code_du
(&
bufr
[
pdu_n
], 
da
);

60 
pdu_n
 +
n
;

62 
bys_
 = 
	`dk_nd_pdu
(
de
, &
du_da
, &
bufr
[0], 
pdu_n
);

64  
bys_
;

65 
	}
}

	@demo/handler/s_upt.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"nsr.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~".h
"

48 
	$Sd_UncfmedPriveTnsr
(

49 
BACNET_ADDRESS
 * 
de
,

50 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

52 
n
 = 0;

53 
pdu_n
 = 0;

54 
bys_
 = 0;

55 
BACNET_NPDU_DATA
 
du_da
;

56 
BACNET_ADDRESS
 
my_addss
;

58 i(!
	`dcc_communiti_abd
())

59  
bys_
;

61 
	`dk_g_my_addss
(&
my_addss
);

63 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

64 
pdu_n
 =

65 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
de
, &
my_addss
,

66 &
du_da
);

69 
n
 =

70 
	`unsr_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

71 
ive_da
);

72 
pdu_n
 +
n
;

73 
bys_
 =

74 
	`dk_nd_pdu
(
de
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

75 
pdu_n
);

76 i(
bys_
 <= 0) {

77 #i
PRINT_ENABLED


78 
	`rtf
(
dr
,

80 
	`
(
o
));

84  
bys_
;

85 
	}
}

	@demo/handler/s_whohas.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"whohas.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~".h
"

58 
	$Sd_WhoHas_Name
(

59 
t32_t
 
low_lim
,

60 
t32_t
 
high_lim
,

61 cڡ *
obje_me
)

63 
n
 = 0;

64 
pdu_n
 = 0;

65 
BACNET_ADDRESS
 
de
;

66 
bys_
 = 0;

67 
BACNET_WHO_HAS_DATA
 
da
;

68 
BACNET_NPDU_DATA
 
du_da
;

69 
BACNET_ADDRESS
 
my_addss
;

72 i(!
	`dcc_communiti_abd
())

75 
	`dk_g_brd_addss
(&
de
);

76 
	`dk_g_my_addss
(&
my_addss
);

78 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

79 
pdu_n
 =

80 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

81 &
du_da
);

84 
da
.
low_lim
 =ow_limit;

85 
da
.
high_lim
 = high_limit;

86 
da
.
is_obje_me
 = 
ue
;

87 
	`charg__si
(&
da
.
obje
.
me
, 
obje_me
);

88 
n
 = 
	`whohas_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], &
da
);

89 
pdu_n
 +
n
;

91 
bys_
 =

92 
	`dk_nd_pdu
(&
de
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

93 
pdu_n
);

94 #i
PRINT_ENABLED


95 i(
bys_
 <= 0)

96 
	`rtf
(
dr
, "Failedo Send Who-Has Request (%s)!\n",

97 
	`
(
o
));

99 
	}
}

112 
	$Sd_WhoHas_Obje
(

113 
t32_t
 
low_lim
,

114 
t32_t
 
high_lim
,

115 
BACNET_OBJECT_TYPE
 
obje_ty
,

116 
ut32_t
 
obje_
)

118 
n
 = 0;

119 
pdu_n
 = 0;

120 
BACNET_ADDRESS
 
de
;

121 
bys_
 = 0;

122 
BACNET_WHO_HAS_DATA
 
da
;

123 
BACNET_NPDU_DATA
 
du_da
;

124 
BACNET_ADDRESS
 
my_addss
;

127 i(!
	`dcc_communiti_abd
())

130 
	`dk_g_brd_addss
(&
de
);

131 
	`dk_g_my_addss
(&
my_addss
);

133 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

134 
pdu_n
 =

135 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

136 &
du_da
);

139 
da
.
low_lim
 =ow_limit;

140 
da
.
high_lim
 = high_limit;

141 
da
.
is_obje_me
 = 
l
;

142 
da
.
obje
.
idtifr
.
ty
 = 
obje_ty
;

143 
da
.
obje
.
idtifr
.

 = 
obje_
;

144 
n
 = 
	`whohas_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], &
da
);

145 
pdu_n
 +
n
;

146 
bys_
 =

147 
	`dk_nd_pdu
(&
de
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

148 
pdu_n
);

149 #i
PRINT_ENABLED


150 i(
bys_
 <= 0)

151 
	`rtf
(
dr
, "Failedo Send Who-Has Request (%s)!\n",

152 
	`
(
o
));

154 
	}
}

	@demo/handler/s_whois.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"whois.h
"

41 
	~"banum.h
"

43 
	~"hdrs.h
"

44 
	~"txbuf.h
"

45 
	~".h
"

59 
	$Sd_WhoIs_To_Nwk
(

60 
BACNET_ADDRESS
 * 
rg_addss
,

61 
t32_t
 
low_lim
,

62 
t32_t
 
high_lim
)

64 
n
 = 0;

65 
pdu_n
 = 0;

66 
bys_
 = 0;

67 
BACNET_NPDU_DATA
 
du_da
;

68 
BACNET_ADDRESS
 
my_addss
;

70 
	`dk_g_my_addss
(&
my_addss
);

72 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

74 
pdu_n
 =

75 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
rg_addss
,

76 &
my_addss
, &
du_da
);

78 
n
 =

79 
	`whois_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
low_lim
,

80 
high_lim
);

81 
pdu_n
 +
n
;

82 
bys_
 =

83 
	`dk_nd_pdu
(
rg_addss
, &
du_da
,

84 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

85 i(
bys_
 <= 0) {

86 #i
PRINT_ENABLED


87 
	`rtf
(
dr
, "Failedo Send Who-Is Request (%s)!\n",

88 
	`
(
o
));

91 
	}
}

101 
	$Sd_WhoIs_Glob
(

102 
t32_t
 
low_lim
,

103 
t32_t
 
high_lim
)

105 
BACNET_ADDRESS
 
de
;

107 i(!
	`dcc_communiti_abd
())

111 
	`dk_g_brd_addss
(&
de
);

113 
	`Sd_WhoIs_To_Nwk
(&
de
, 
low_lim
, 
high_lim
);

114 
	}
}

124 
	$Sd_WhoIs_Lol
(

125 
t32_t
 
low_lim
,

126 
t32_t
 
high_lim
)

128 
BACNET_ADDRESS
 
de
;

129 
mp
[6];

130 
lo
;

132 i(!
	`dcc_communiti_abd
())

136 
	`dk_g_brd_addss
(&
de
);

140 
de
.
t
 = 0;

144 
mp
[0] = 
de
.
mac
[3];

145 
mp
[1] = 
de
.
mac
[2];

146 
mp
[2] = 
de
.
mac
[1];

147 
mp
[3] = 
de
.
mac
[0];

148 
mp
[4] = 
de
.
mac
[5];

149 
mp
[5] = 
de
.
mac
[4];

152 
lo
 = 0;oop < 6;oop++) {

153 
de
.
mac
[
lo
] = 
mp
[loop];

156 
	`Sd_WhoIs_To_Nwk
(&
de
, 
low_lim
, 
high_lim
);

157 
	}
}

170 
	$Sd_WhoIs_Reme
(

171 
BACNET_ADDRESS
 * 
rg_addss
,

172 
t32_t
 
low_lim
,

173 
t32_t
 
high_lim
)

175 i(!
	`dcc_communiti_abd
())

178 
	`Sd_WhoIs_To_Nwk
(
rg_addss
, 
low_lim
, 
high_lim
);

179 
	}
}

193 
	$Sd_WhoIs
(

194 
t32_t
 
low_lim
,

195 
t32_t
 
high_lim
)

197 
	`Sd_WhoIs_Glob
(
low_lim
, 
high_lim
);

198 
	}
}

	@demo/handler/s_wp.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<o.h
>

28 
	~<rg.h
>

29 
	~"cfig.h
"

30 
	~"txbuf.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"addss.h
"

34 
	~"tsm.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"devi.h
"

38 
	~"dk.h
"

39 
	~"dcc.h
"

40 
	~"whois.h
"

42 
	~"hdrs.h
"

43 
	~"txbuf.h
"

44 
	~".h
"

49 
ut8_t
 
	$Sd_Wre_Prݔty_Reque_Da
(

50 
ut32_t
 
devi_id
,

51 
BACNET_OBJECT_TYPE
 
obje_ty
,

52 
ut32_t
 
obje_
,

53 
BACNET_PROPERTY_ID
 
obje_ݔty
,

54 
ut8_t
 * 
iti_da
,

55 
iti_da_n
,

56 
ut8_t
 
iܙy
,

57 
ut32_t
 
y_dex
)

59 
BACNET_ADDRESS
 
de
;

60 
BACNET_ADDRESS
 
my_addss
;

61 
max_du
 = 0;

62 
ut8_t
 
voke_id
 = 0;

63 
bo
 
us
 = 
l
;

64 
n
 = 0;

65 
pdu_n
 = 0;

66 
bys_
 = 0;

67 
BACNET_WRITE_PROPERTY_DATA
 
da
;

68 
BACNET_NPDU_DATA
 
du_da
;

70 i(!
	`dcc_communiti_abd
())

74 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

76 i(
us
)

77 
voke_id
 = 
	`tsm_xt__vokeID
();

78 i(
voke_id
) {

80 
	`dk_g_my_addss
(&
my_addss
);

81 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

82 
pdu_n
 =

83 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

84 &
du_da
);

86 
da
.
obje_ty
 = object_type;

87 
da
.
obje_
 = object_instance;

88 
da
.
obje_ݔty
 = object_property;

89 
da
.
y_dex
 =rray_index;

90 
da
.
iti_da_n
 =pplication_data_len;

91 
	`memy
(&
da
.
iti_da
[0], &application_data[0],

92 
iti_da_n
);

93 
da
.
iܙy
 =riority;

94 
n
 =

95 
	`wp_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
voke_id
,

96 &
da
);

97 
pdu_n
 +
n
;

103 i((
pdu_n
 < 
max_du
) {

104 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

105 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

106 
bys_
 =

107 
	`dk_nd_pdu
(&
de
, &
du_da
,

108 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

109 i(
bys_
 <= 0) {

110 #i
PRINT_ENABLED


111 
	`rtf
(
dr
, "Failedo Send WriteProperty Request (%s)!\n",

112 
	`
(
o
));

116 
	`tsm__voke_id
(
voke_id
);

117 
voke_id
 = 0;

118 #i
PRINT_ENABLED


119 
	`rtf
(
dr
,

126  
voke_id
;

127 
	}
}

145 
ut8_t
 
	$Sd_Wre_Prݔty_Reque
(

146 
ut32_t
 
devi_id
,

147 
BACNET_OBJECT_TYPE
 
obje_ty
,

148 
ut32_t
 
obje_
,

149 
BACNET_PROPERTY_ID
 
obje_ݔty
,

150 
BACNET_APPLICATION_DATA_VALUE
 * 
obje_vue
,

151 
ut8_t
 
iܙy
,

152 
ut32_t
 
y_dex
)

154 
ut8_t
 
iti_da
[
MAX_APDU
] = { 0 };

155 
du_n
 = 0, 
n
 = 0;

157 
obje_vue
) {

158 #i
PRINT_ENABLED_DEBUG


159 
	`rtf
(
dr
, "WriteProperty service: " "%sag=%d\n",

160 (
obje_vue
->
cڋxt_ecific
 ? "context" : "application"),

161 ((
obje_vue
->

162 
cڋxt_ecific
 ? 
obje_vue
->
cڋxt_g
 : object_value->

163 
g
));

165 
n
 = 
	`ba_code_da
(&
iti_da
[
du_n
], 
obje_vue
);

166 i((
n
 + 
du_n
< 
MAX_APDU
) {

167 
du_n
 +
n
;

171 
obje_vue
 = obje_vue->
xt
;

174  
	`Sd_Wre_Prݔty_Reque_Da
(
devi_id
, 
obje_ty
,

175 
obje_
, 
obje_ݔty
, &
iti_da
[0], 
du_n
,

176 
iܙy
, 
y_dex
);

177 
	}
}

	@demo/handler/s_wpm.c

30 
	~<ddef.h
>

31 
	~<dt.h
>

32 
	~<o.h
>

33 
	~<rg.h
>

34 
	~"cfig.h
"

35 
	~"txbuf.h
"

36 
	~"bacdef.h
"

37 
	~"bacdcode.h
"

38 
	~"addss.h
"

39 
	~"tsm.h
"

40 
	~"du.h
"

41 
	~"du.h
"

42 
	~"devi.h
"

43 
	~"dk.h
"

44 
	~"dcc.h
"

45 
	~"wpm.h
"

47 
	~"hdrs.h
"

48 
	~"sbuf.h
"

49 
	~".h
"

59 
ut8_t
 
	$Sd_Wre_Prݔty_Muɝ_Reque_Da
(

60 
ut32_t
 
devi_id
,

61 
BACNET_WRITE_ACCESS_DATA
 * 
wre_acss_da
)

63 
BACNET_ADDRESS
 
de
;

64 
BACNET_ADDRESS
 
my_addss
;

65 
max_du
 = 0;

66 
ut8_t
 
voke_id
 = 0;

67 
bo
 
us
 = 
l
;

68 
n
 = 0;

69 
pdu_n
 = 0;

70 
bys_
 = 0;

71 
BACNET_NPDU_DATA
 
du_da
;

74 i(!
	`dcc_communiti_abd
()) {

79 
us
 = 
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
);

81 i(
us
)

82 
voke_id
 = 
	`tsm_xt__vokeID
();

83 i(
voke_id
) {

85 
	`dk_g_my_addss
(&
my_addss
);

86 
	`du_code_du_da
(&
du_da
, 
ue
, 
MESSAGE_PRIORITY_NORMAL
);

87 
pdu_n
 =

88 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
de
, &
my_addss
,

89 &
du_da
);

91 
n
 = 
	`wpm_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], 
max_du
,

92 
voke_id
, 
wre_acss_da
);

94 
pdu_n
 +
n
;

101 i((
pdu_n
 < 
max_du
) {

102 
	`tsm_t_cfmed_ungmd_i
(
voke_id
, &
de
,

103 &
du_da
, &
Hdr_Tnsm_Bufr
[0], (
ut16_t

pdu_n
);

104 
bys_
 =

105 
	`dk_nd_pdu
(&
de
, &
du_da
,

106 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

107 #i
PRINT_ENABLED


108 i(
bys_
 <= 0)

109 
	`rtf
(
dr
, "Failedo Send WritePropertyMultiple Request (%s)!\n",

110 
	`
(
o
));

113 
	`tsm__voke_id
(
voke_id
);

114 
voke_id
 = 0;

115 #i
PRINT_ENABLED


116 
	`rtf
(
dr
,

123  
voke_id
;

124 
	}
}

	@demo/handler/txbuf.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~"cfig.h
"

28 
	~"dk.h
"

32 
ut8_t
 
	gHdr_Tnsm_Bufr
[
MAX_PDU
] = { 0 };

	@demo/iamrouter/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"addss.h
"

36 
	~"cfig.h
"

37 
	~"bacdef.h
"

38 
	~"du.h
"

39 
	~"du.h
"

40 
	~"devi.h
"

41 
	~"dk.h
"

43 
	~"fame.h
"

44 
	~"hdrs.h
"

45 
	~".h
"

46 
	~"txbuf.h
"

47 
	~"dnv.h
"

50 
	#MAX_ROUTER_DNETS
 64

	)

51 
	gTg_Rour_Nwks
[
MAX_ROUTER_DNETS
] = { -1 };

53 
bo
 
	gE_Deed
 = 
l
;

55 
	$MyAbtHdr
(

56 
BACNET_ADDRESS
 * 
c
,

57 
ut8_t
 
voke_id
,

58 
ut8_t
 
abt_as
,

59 
bo
 
rv
)

62 (
c
;

63 (
voke_id
;

64 (
rv
;

65 
	`tf
("BACÈAbt: %s\r\n", 
	`baext_abt_as_me
(
abt_as
));

66 
E_Deed
 = 
ue
;

67 
	}
}

69 
	$MyRejeHdr
(

70 
BACNET_ADDRESS
 * 
c
,

71 
ut8_t
 
voke_id
,

72 
ut8_t
 
je_as
)

75 (
c
;

76 (
voke_id
;

77 
	`tf
("BACÈReje: %s\r\n", 
	`baext_je_as_me
(
je_as
));

78 
E_Deed
 = 
ue
;

79 
	}
}

81 
	$In_Svi_Hdrs
(

84 
	`Devi_In
(
NULL
);

87 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

90 
du_t_uecognized_rvi_hdr_hdr


91 (
hdr_uecognized_rvi
);

93 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

94 
hdr_ad_ݔty
);

96 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_add
);

98 
	`du_t_abt_hdr
(
MyAbtHdr
);

99 
	`du_t_je_hdr
(
MyRejeHdr
);

100 
	}
}

102 
	$ma
(

103 
gc
,

104 *
gv
[])

106 
g_cou
 = 0;

108 i(
gc
 < 2) {

109 
	`tf
("Usage: %s DNET [DNET] [DNET] [...]\r\n",

110 
	`fame_move_th
(
gv
[0]));

113 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

114 
	`tf
("Send BACnet I-Am-Router-To-Network message for \r\n"

121 
	`fame_move_th
(
gv
[0]), filename_remove_path(argv[0]));

125 i(
gc
 > 1) {

126 
g_cou
 = 1;rg_cou < 
gc
;rg_count++) {

127 i(
g_cou
 > 
MAX_ROUTER_DNETS
) {

128 
	`rtf
(
dr
, "Limitedo %u DNETS. Sorry!\r\n",

129 
MAX_ROUTER_DNETS
);

132 
Tg_Rour_Nwks
[
g_cou
 - 1] =

133 
	`
(
gv
[
g_cou
], 
NULL
, 0);

135 
Tg_Rour_Nwks
[
g_cou
] = -1;

137 i(
Tg_Rour_Nwks
[
g_cou
 - 1] >= 65535) {

138 
	`rtf
(
dr
, "DNET=%u - it must beesshan %u\r\n",

139 
Tg_Rour_Nwks
[
g_cou
 - 1], 65535);

145 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

146 
	`In_Svi_Hdrs
();

147 
	`addss_
();

148 
	`dnv_
();

149 
	`ex
(
dk_nup
);

151 
	`Sd_I_Am_Rour_To_Nwk
(
Tg_Rour_Nwks
);

154 
	}
}

	@demo/initrouter/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"addss.h
"

36 
	~"cfig.h
"

37 
	~"bacdef.h
"

38 
	~"du.h
"

39 
	~"du.h
"

40 
	~"devi.h
"

41 
	~"dk.h
"

43 #ide
DEBUG_ENABLED


44 
	#DEBUG_ENABLED
 0

	)

46 
	~"debug.h
"

47 
	~"fame.h
"

48 
	~"hdrs.h
"

49 
	~".h
"

50 
	~"txbuf.h
"

51 
	~"dnv.h
"

54 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

57 
BACNET_ADDRESS
 
	gTg_Rour_Addss
;

60 
	#VIRTUAL_DNET
 2709

	)

64 
	gDNET_li
[2] = {

65 
VIRTUAL_DNET
, -1

68 
bo
 
	gE_Deed
 = 
l
;

70 
	$MyAbtHdr
(

71 
BACNET_ADDRESS
 * 
c
,

72 
ut8_t
 
voke_id
,

73 
ut8_t
 
abt_as
,

74 
bo
 
rv
)

77 (
c
;

78 (
voke_id
;

79 (
rv
;

80 
	`tf
("BACÈAbt: %s\r\n", 
	`baext_abt_as_me
(
abt_as
));

81 
E_Deed
 = 
ue
;

82 
	}
}

84 
	$MyRejeHdr
(

85 
BACNET_ADDRESS
 * 
c
,

86 
ut8_t
 
voke_id
,

87 
ut8_t
 
je_as
)

90 (
c
;

91 (
voke_id
;

92 
	`tf
("BACÈReje: %s\r\n", 
	`baext_je_as_me
(
je_as
));

93 
E_Deed
 = 
ue
;

94 
	}
}

96 
	$My_Rour_Hdr
(

97 
BACNET_ADDRESS
 * 
c
,

98 
BACNET_NPDU_DATA
 * 
du_da
,

99 
ut8_t
 * 
du
,

100 
ut16_t
 
du_n
)

102 
ut16_t
 
du_offt
 = 0;

103 
ut16_t
 
dt
 = 0;

104 
ut16_t
 
n
 = 0;

105 
ut16_t
 
j
 = 0;

106 
pt_mpgs
 = 0;

107 
pt_id
 = 0;

108 
pt_fo_n
 = 0;

110 
du_da
->
twk_mesge_ty
) {

111 
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
:

113 
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
:

115 
NETWORK_MESSAGE_I_COULD_BE_ROUTER_TO_NETWORK
:

117 
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
:

119 
NETWORK_MESSAGE_ROUTER_BUSY_TO_NETWORK
:

121 
NETWORK_MESSAGE_ROUTER_AVAILABLE_TO_NETWORK
:

123 
NETWORK_MESSAGE_INIT_RT_TABLE
:

125 
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
:

126 
	`tf
("Initialize-Routing-Table-Ack from ");

127 
j
 = 0; j < 
MAX_MAC_LEN
; j++) {

128 i(
j
 < 
c
->
mac_n
) {

129 
	`tf
("%02X", 
c
->
mac
[
j
]);

132 
pt_mpgs
 = 
du
[0];

133 
	`tf
("\nP܈Mpgs: %u\n", 
pt_mpgs
);

134 
du_offt
 = 1;

135 
du_n
--;

136 
du_n
) {

137 
n
 = 
	`decode_unsigd16
(&
du
[
du_offt
], &
dt
);

138 
	`tf
("DNET=%hu, ", 
dt
);

139 
du_offt
 +
n
;

140 
du_n
 -
n
;

141 i(!
du_n
) {

144 
pt_id
 = 
du
[
du_offt
];

145 
	`tf
("P܈ID=%u, ", 
pt_id
);

146 
du_offt
++;

147 
du_n
--;

148 i(!
du_n
) {

151 
pt_fo_n
 = 
du
[
du_offt
];

152 
	`tf
("P܈InfLgth=%u, ", 
pt_fo_n
);

153 
du_offt
++;

154 
du_n
--;

155 
	`tf
("Port Info=\"");

156 
j
 = 0; j < 255; j++) {

157 i(!
du_n
) {

160 i(
j
 < 
pt_fo_n
) {

161 
	`tf
("%02X", 
du
[
du_offt
]);

162 
du_offt
++;

163 
du_n
--;

166 
	`tf
("\"");

167 i(
du_n
) {

168 
	`tf
("\n");

171 
	`tf
("\n");

173 
NETWORK_MESSAGE_ESTABLISH_CONNECTION_TO_NETWORK
:

175 
NETWORK_MESSAGE_DISCONNECT_CONNECTION_TO_NETWORK
:

180 
	}
}

182 
	$My_NPDU_Hdr
(

183 
BACNET_ADDRESS
 * 
c
,

184 
ut8_t
 * 
pdu
,

185 
ut16_t
 
pdu_n
)

187 
du_offt
 = 0;

188 
BACNET_ADDRESS
 
de
 = { 0 };

189 
BACNET_NPDU_DATA
 
du_da
 = { 0 };

191 
du_offt
 = 
	`du_decode
(&
pdu
[0], &
de
, 
c
, &
du_da
);

192 i(
du_da
.
twk_y_mesge
) {

193 
	`My_Rour_Hdr
(
c
, &
du_da
, &
pdu
[
du_offt
],

194 (
ut16_t
(
pdu_n
 - 
du_offt
));

195 } i((
du_offt
 > 0&& (du_off<
pdu_n
)) {

196 i((
du_da
.
oc_vsi
 =
BACNET_PROTOCOL_VERSION
) &&

197 ((
de
.
t
 =0|| (de.È=
BACNET_BROADCAST_NETWORK
))) {

201 
	`du_hdr
(
c
, &
pdu
[
du_offt
],

202 (
ut16_t
(
pdu_n
 - 
du_offt
));

204 i(
de
.
t
) {

205 
	`debug_tf
("NPDU: DNET=%d. Disrded!\n", 
de
.
t
);

207 
	`debug_tf
("NPDU: BACnet Protocol Version=%d. Discarded!\n",

208 
du_da
.
oc_vsi
);

214 
	}
}

216 
	$In_Svi_Hdrs
(

219 
	`Devi_In
(
NULL
);

222 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

225 
du_t_uecognized_rvi_hdr_hdr


226 (
hdr_uecognized_rvi
);

228 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

229 
hdr_ad_ݔty
);

231 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_add
);

233 
	`du_t_abt_hdr
(
MyAbtHdr
);

234 
	`du_t_je_hdr
(
MyRejeHdr
);

235 
	}
}

237 
	$addss_r
(

238 
BACNET_ADDRESS
 * 
d
,

239 
gc
,

240 *
gv
[])

242 
mac
[6];

243 
pt
;

244 
cou
 = 0;

245 
dex
 = 0;

247 i(
gc
 > 0) {

248 
cou
 =

249 
	`ssnf
(
gv
[0], "%u.%u.%u.%u:%u", &
mac
[0], &mac[1], &mac[2],

250 &
mac
[3], &
pt
);

251 i(
cou
 == 5) {

252 
d
->
mac_n
 = 6;

253 
dex
 = 0; index < 4; index++) {

254 
d
->
mac
[
dex
] = mac[index];

256 
	`code_unsigd16
(&
d
->
mac
[4], 
pt
);

258 
cou
 =

259 
	`ssnf
(
gv
[0], "%x:%x:%x:%x:%x:%x", &
mac
[0], &mac[1], &mac[2],

260 &
mac
[3], &mac[4], &mac[5]);

261 
d
->
mac_n
 = 
cou
;

262 
dex
 = 0; index < 
MAX_MAC_LEN
; index++) {

263 i(
dex
 < 
cou
) {

264 
d
->
mac
[
dex
] = mac[index];

266 
d
->
mac
[
dex
] = 0;

271 
d
->
t
 = 0;

272 
d
->
n
 = 0;

273 
dex
 = 0; index < 
MAX_MAC_LEN
; index++) {

274 
d
->
adr
[
dex
] = 0;

276 
	}
}

278 
	$ma
(

279 
gc
,

280 *
gv
[])

282 
BACNET_ADDRESS
 
c
 = {

285 
ut16_t
 
pdu_n
 = 0;

286 
timeout
 = 100;

287 
time_t
 
tٮ_cds
 = 0;

288 
time_t
 
d_cds
 = 0;

289 
time_t
 
ϡ_cds
 = 0;

290 
time_t
 
cut_cds
 = 0;

291 
time_t
 
timeout_cds
 = 0;

293 i(
gc
 < 2) {

294 
	`tf
("Usage: %sddress [DNET ID Len Info]\r\n",

295 
	`fame_move_th
(
gv
[0]));

298 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

299 
	`tf
("Send BACnet Initialize-Routing-Table messageoetwork\r\n"

309 "%192.168.0.18:47808\r\n", 
	`fame_move_th
(
gv
[0]));

313 
	`addss_r
(&
Tg_Rour_Addss
, 
gc
 - 1, &
gv
[1]);

314 i(
gc
 > 2) {

323 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

324 
	`In_Svi_Hdrs
();

325 
	`addss_
();

326 
	`dnv_
();

327 
	`ex
(
dk_nup
);

329 
ϡ_cds
 = 
	`time
(
NULL
);

330 
timeout_cds
 = 
	`du_timeout
() / 1000;

332 
	`Sd_Inlize_Routg_Tab
(&
Tg_Rour_Addss
, 
DNET_li
);

336 
cut_cds
 = 
	`time
(
NULL
);

338 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

340 i(
pdu_n
) {

341 
	`My_NPDU_Hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

343 i(
E_Deed
)

346 
d_cds
 = 
cut_cds
 - 
ϡ_cds
;

347 i(
d_cds
) {

348 #i
	`defed
(
BACDL_BIP
&& 
BBMD_ENABLED


349 
	`bvlc_man_tim
(
d_cds
);

352 
tٮ_cds
 +
d_cds
;

353 i(
tٮ_cds
 > 
timeout_cds
)

356 
ϡ_cds
 = 
cut_cds
;

360 
	}
}

	@demo/mstpcap/main.c

35 
	~<ddef.h
>

36 
	~<dt.h
>

37 
	~<dio.h
>

38 
	~<dlib.h
>

39 
	~<rg.h
>

40 
	~<o.h
>

41 
	~<time.h
>

43 
	~"t.h
"

44 
	~"tim.h
"

46 
	~"bys.h
"

47 
	~"rs485.h
"

48 
	~"c.h
"

49 
	~"mext.h
"

50 
	~"fame.h
"

51 
	~"vsi.h
"

52 
	~"dlmp.h
"

54 
	~"m.h
"

56 #ifde
_WIN32


57 
	#cmp
(
x
,
y
,
z

	`_icmp
(x,y,z)

	)

61 
	#DLT_BACNET_MS_TP
 165

	)

63 #ide
max


64 
	#max
(
a
,
b
(((b)? (a: (b))

	)

65 
	#m
(
a
,
b
((< (b)? (a: (b))

	)

68 
	#MSTP_HEADER_MAX
 (2+1+1+1+2+1)

	)

71 vީ
mp_pt_ru_t
 
	gMSTP_Pt
;

73 
MSTP_RECEIVE_STATE
 
	gMSTP_Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

75 
ut8_t
 
	gRxBufr
[
MAX_MPDU
];

76 
ut8_t
 
	gTxBufr
[
MAX_MPDU
];

78 vީ
bo
 
	gEx_Requeed
;

80 
bo
 
	gWeshk_Ctu
;

83 
	smp_iics
 {

85 
ut32_t
 
	mtok_cou
;

87 
ut32_t
 
	mtok_ived_cou
;

89 
ut32_t
 
	mpfm_cou
;

91 
ut32_t
 
	mfm_cou
;

93 
ut32_t
 
	my_poped_cou
;

95 
ut32_t
 
	m_que_cou
;

97 
ut32_t
 
	m_ڣ_cou
;

99 
ut32_t
 
	md_cou
;

101 
ut32_t
 
	mdr_cou
;

104 
ut32_t
 
	mtok_s
;

106 
ut32_t
 
	mtuge_timeout
;

108 
ut8_t
 
	mmax_ma
;

110 
ut8_t
 
	mmax_fo_ames
;

112 
ut32_t
 
	mtok_y
;

114 
ut32_t
 
	mpfm_y
;

116 
ut32_t
 
	md_y
;

118 
ut32_t
 
	my_poped
;

120 
ut32_t
 
	ml
;

122 
ut32_t
 
	mϡ_pfm_toks
;

125 
ut32_t
 
	mlf_tok_cou
;

127 
ut32_t
 
	mooo_tok_cou
;

129 
ut32_t
 
	mdevi_id
;

132 
	#MAX_MSTP_DEVICES
 256

	)

133 
mp_iics
 
	gMSTP_Stiics
[
MAX_MSTP_DEVICES
];

134 
ut32_t
 
	gInvid_Fme_Cou
;

136 
ut32_t
 
	$timev_diff_ms
(

137 
timev
 *
d
,

138 
timev
 *
now
)

140 
ut32_t
 
ms
 = 0;

143 
ms
 = (
now
->
tv_c
 - 
d
->tv_c* 1000 + (now->
tv_uc
 -

144 
d
->
tv_uc
) / 1000;

146  
ms
;

147 
	}
}

149 
	$mp_mڙ_i_am
(

150 
ut8_t
 
mac
,

151 
ut8_t
 * 
pdu
,

152 
ut16_t
 
pdu_n
)

154 
BACNET_ADDRESS
 
c
 = { 0 };

155 
BACNET_ADDRESS
 
de
 = { 0 };

156 
BACNET_NPDU_DATA
 
du_da
 = { 0 };

157 
du_offt
 = 0;

158 
ut16_t
 
du_n
 = 0;

159 
ut8_t
 *
du
 = 
NULL
;

160 
ut8_t
 
pdu_ty
 = 0;

161 
ut8_t
 
rvi_choi
 = 0;

162 
ut8_t
 *
rvi_que
 = 
NULL
;

163 
ut32_t
 
devi_id
 = 0;

164 
n
 = 0;

166 i(
pdu
[0] =
BACNET_PROTOCOL_VERSION
) {

167 
	`MSTP_Fl_BACt_Addss
(&
c
, 
mac
);

168 
du_offt
 = 
	`du_decode
(&
pdu
[0], &
de
, &
c
, &
du_da
);

169 i((!
du_da
.
twk_y_mesge
&& (
du_offt
 > 0) &&

170 (
du_offt
 < 
pdu_n
&& (
c
.
t
 == 0)) {

171 
du_n
 = 
pdu_n
 - 
du_offt
;

172 
du
 = &
pdu
[
du_offt
];

173 
pdu_ty
 = 
du
[0] & 0xF0;

174 i((
pdu_ty
 =
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
) &&

175 (
du_n
 >= 2)) {

176 
rvi_choi
 = 
du
[1];

177 
rvi_que
 = &
du
[2];

178 i(
rvi_choi
 =
SERVICE_UNCONFIRMED_I_AM
) {

179 
n
 =

180 
	`m_decode_rvi_que
(
rvi_que
, &
devi_id
,

181 
NULL
, NULL, NULL);

182 i(
n
 != -1) {

183 
MSTP_Stiics
[
mac
].
devi_id
 = device_id;

189 
	}
}

191 
	$ck_iics
(

192 
timev
 *
tv
,

193 vީ
mp_pt_ru_t
 *
mp_pt
)

195 
timev
 
d_tv
 = { 0 };

196 
ut8_t
 
d_ame
 = 255;

197 
ut8_t
 
d_c
 = 255;

198 
ut8_t
 
d_d
 = 255;

199 
ut8_t
 
d_tok_d
 = 255;

200 
ut8_t
 
ame
, 
c
, 
d
;

201 
ut32_t
 
d
;

202 
ut32_t
 
l
;

204 
d
 = 
mp_pt
->
DeiAddss
;

205 
c
 = 
mp_pt
->
SourAddss
;

206 
ame
 = 
mp_pt
->
FmeTy
;

207 
ame
) {

208 
FRAME_TYPE_TOKEN
:

209 
MSTP_Stiics
[
c
].
tok_cou
++;

210 
MSTP_Stiics
[
d
].
tok_ived_cou
++;

211 i(
c
 =
d
) {

212 
MSTP_Stiics
[
c
].
lf_tok_cou
++;

214 i(
d_ame
 =
FRAME_TYPE_TOKEN
) {

215 i((
d_d
 =
d
&& (
d_c
 =
c
)) {

217 
MSTP_Stiics
[
d
].
tok_s
++;

219 
d
 = 
	`timev_diff_ms
(&
d_tv
, 
tv
);

220 i(
d
 > 
MSTP_Stiics
[
c
].
tuge_timeout
) {

221 
MSTP_Stiics
[
c
].
tuge_timeout
 = 
d
;

223 } i(
d_d
 =
c
) {

225 
d
 = 
	`timev_diff_ms
(&
d_tv
, 
tv
);

226 i(
d
 > 
MSTP_Stiics
[
c
].
tok_y
) {

227 
MSTP_Stiics
[
c
].
tok_y
 = 
d
;

230 } i((
d_ame
 =
FRAME_TYPE_POLL_FOR_MASTER
) &&

231 (
d_c
 =
c
)) {

233 
d
 = 
	`timev_diff_ms
(&
d_tv
, 
tv
);

234 i(
d
 > 
MSTP_Stiics
[
c
].
tuge_timeout
) {

235 
MSTP_Stiics
[
c
].
tuge_timeout
 = 
d
;

238 i(
d_tok_d
 !
c
) {

240 
MSTP_Stiics
[
c
].
ooo_tok_cou
++;

242 
d_tok_d
 = 
d
;

244 
FRAME_TYPE_POLL_FOR_MASTER
:

245 i(
MSTP_Stiics
[
c
].
ϡ_pfm_toks
) {

246 
l
 =

247 
MSTP_Stiics
[
c
].
tok_ived_cou
 -

248 
MSTP_Stiics
[
c
].
ϡ_pfm_toks
;

249 i(
l
 > 
MSTP_Stiics
[
c
].npoll) {

250 
MSTP_Stiics
[
c
].
l
 =poll;

253 
MSTP_Stiics
[
c
].
ϡ_pfm_toks
 =

254 
MSTP_Stiics
[
c
].
tok_ived_cou
;

255 
MSTP_Stiics
[
c
].
pfm_cou
++;

256 i(
d
 > 
MSTP_Stiics
[
c
].
max_ma
) {

257 
MSTP_Stiics
[
c
].
max_ma
 = 
d
;

259 i((
d_ame
 =
FRAME_TYPE_POLL_FOR_MASTER
&& (
d_c
 =
c
)) {

261 
d
 = 
	`timev_diff_ms
(&
d_tv
, 
tv
);

262 i(
d
 > 
MSTP_Stiics
[
c
].
tuge_timeout
) {

263 
MSTP_Stiics
[
c
].
tuge_timeout
 = 
d
;

267 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
:

268 
MSTP_Stiics
[
c
].
fm_cou
++;

269 i(
d_ame
 =
FRAME_TYPE_POLL_FOR_MASTER
) {

270 
d
 = 
	`timev_diff_ms
(&
d_tv
, 
tv
);

271 i(
d
 > 
MSTP_Stiics
[
c
].
pfm_y
) {

272 
MSTP_Stiics
[
c
].
pfm_y
 = 
d
;

276 
FRAME_TYPE_TEST_REQUEST
:

277 
MSTP_Stiics
[
c
].
_que_cou
++;

279 
FRAME_TYPE_TEST_RESPONSE
:

280 
MSTP_Stiics
[
c
].
_ڣ_cou
++;

282 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

283 
MSTP_Stiics
[
c
].
d_cou
++;

285 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

286 
MSTP_Stiics
[
c
].
dr_cou
++;

287 i((
d_ame
 =
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
) &&

288 (
d_d
 =
c
)) {

290 
d
 = 
	`timev_diff_ms
(&
d_tv
, 
tv
);

291 i(
d
 > 
MSTP_Stiics
[
c
].
d_y
) {

292 
MSTP_Stiics
[
c
].
d_y
 = 
d
;

295 i((
mp_pt
->
ReivedVidFme
) ||

296 (
mp_pt
->
ReivedVidFmeNFUs
)) {

297 i((
mp_pt
->
DaLgth
 <mp_pt->
IutBufrSize
) &&

298 (
mp_pt
->
DaLgth
 > 0)) {

299 
	`mp_mڙ_i_am
(
c
, &
mp_pt
->
IutBufr
[0],

300 
mp_pt
->
DaLgth
);

304 
FRAME_TYPE_REPLY_POSTPONED
:

305 
MSTP_Stiics
[
c
].
y_poped_cou
++;

306 i((
d_ame
 =
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
) &&

307 (
d_d
 =
c
)) {

309 
d
 = 
	`timev_diff_ms
(&
d_tv
, 
tv
);

310 i(
d
 > 
MSTP_Stiics
[
c
].
y_poped
) {

311 
MSTP_Stiics
[
c
].
y_poped
 = 
d
;

320 
d_d
 = 
d
;

321 
d_c
 = 
c
;

322 
d_ame
 = 
ame
;

323 
d_tv
.
tv_c
 = 
tv
->tv_sec;

324 
d_tv
.
tv_uc
 = 
tv
->tv_usec;

325 
	}
}

327 
	$ck_iics_t
(

330 
i
;

331 
node_cou
 = 0;

332 
lf__ooo_cou
;

334 
	`rtf
(
dout
, "\n");

335 
	`rtf
(
dout
, "==== MS/TP Frame Counts ====\n");

336 
	`rtf
(
dout
, "%-8s%-8s%-8s%-8s%-8s%-8s%-8s%-8s%-8s%-7s", "MAC",

339 
	`rtf
(
dout
, "\n");

340 
i
 = 0; i < 
MAX_MSTP_DEVICES
; i++) {

342 i((
MSTP_Stiics
[
i
].
tok_cou
|| (MSTP_Stiics[i].
d_y
)

343 || (
MSTP_Stiics
[
i
].
pfm_cou
)) {

344 
node_cou
++;

345 
	`rtf
(
dout
, "%-8u", 
i
);

346 i(
MSTP_Stiics
[
i
].
devi_id
 <= 4194303) {

347 
	`rtf
(
dout
, "%-8lu",

348 (
MSTP_Stiics
[
i
].
devi_id
);

350 
	`rtf
(
dout
, "%-8s", "-");

352 
	`rtf
(
dout
, "%-8lu%-8lu%-8lu%-8lu",

353 (
MSTP_Stiics
[
i
].
tok_cou
,

354 (
MSTP_Stiics
[
i
].
pfm_cou
,

355 (
MSTP_Stiics
[
i
].
fm_cou
,

356 (
MSTP_Stiics
[
i
].
d_cou
);

357 
	`rtf
(
dout
, "%-8lu%-8lu%-8lu%-7lu",

358 (
MSTP_Stiics
[
i
].
y_poped_cou
,

359 (
MSTP_Stiics
[
i
].
dr_cou
,

360 (
MSTP_Stiics
[
i
].
_que_cou
,

361 (
MSTP_Stiics
[
i
].
_ڣ_cou
);

362 
	`rtf
(
dout
, "\n");

365 
	`rtf
(
dout
, "NodCou: %u\n", 
node_cou
);

366 
node_cou
 = 0;

367 
	`rtf
(
dout
, "\n");

368 
	`rtf
(
dout
, "==== MS/TP Usagend Timing Maximums ====\n");

369 
	`rtf
(
dout
, "%-8s%-8s%-8s%-8s%-8s%-8s%-8s%-8s%-8s%-7s", "MAC",

372 
	`rtf
(
dout
, "\n");

373 
i
 = 0; i < 
MAX_MSTP_DEVICES
; i++) {

375 i((
MSTP_Stiics
[
i
].
tok_cou
|| (MSTP_Stiics[i].
d_y
)

376 || (
MSTP_Stiics
[
i
].
pfm_cou
)) {

377 
node_cou
++;

378 
lf__ooo_cou
 = 
MSTP_Stiics
[
i
].
lf_tok_cou
 +

379 
MSTP_Stiics
[
i
].
ooo_tok_cou
;

380 
	`rtf
(
dout
, "%-8u", 
i
);

381 
	`rtf
(
dout
, "%-8lu%-8lu%-8lu%-8lu%-8lu",

382 (
MSTP_Stiics
[
i
].
max_ma
,

383 (
MSTP_Stiics
[
i
].
tok_s
,

384 (
MSTP_Stiics
[
i
].
l
,

385 
lf__ooo_cou
,

386 (
MSTP_Stiics
[
i
].
tok_y
);

387 
	`rtf
(
dout
, "%-8lu%-8lu%-8lu%-7lu",

388 (
MSTP_Stiics
[
i
].
tuge_timeout
,

389 (
MSTP_Stiics
[
i
].
pfm_y
,

390 (
MSTP_Stiics
[
i
].
d_y
,

391 (
MSTP_Stiics
[
i
].
y_poped
);

392 
	`rtf
(
dout
, "\n");

395 
	`rtf
(
dout
, "NodCou: %u\n", 
node_cou
);

396 
	`rtf
(
dout
, "Invalid Frame Count: %lu\n",

397 (
Invid_Fme_Cou
);

398 
	}
}

400 
	$ck_iics_r
(

403 
i
 = 0;

405 
	`memt
(&
MSTP_Stiics
[0], 0, (MSTP_Statistics));

406 
i
 = 0; i < 
MAX_MSTP_DEVICES
; i++) {

407 
MSTP_Stiics
[
i
].
devi_id
 = 0xFFFFFFFF;

409 
Invid_Fme_Cou
 = 0;

410 
	}
}

412 
ut32_t
 
	$Tim_S
(

413 *
pArg
)

415  
	`tim_mlicds
(
TIMER_SILENCE
);

416 
	}
}

418 
	$Tim_S_Ret
(

419 *
pArg
)

421 
	`tim_t
(
TIMER_SILENCE
);

422 
	}
}

425 
ut16_t
 
	$MSTP_Put_Reive
(

426 vީ
mp_pt_ru_t
 *
mp_pt
)

428 (
mp_pt
;

431 
	}
}

435 
ut16_t
 
	$MSTP_G_Sd
(

436 vީ
mp_pt_ru_t
 * 
mp_pt
,

437 
timeout
)

439 (
mp_pt
;

440 (
timeout
;

442 
	}
}

444 
ut16_t
 
	$MSTP_G_Rly
(

445 vީ
mp_pt_ru_t
 * 
mp_pt
,

446 
timeout
)

448 (
mp_pt
;

449 (
timeout
;

451 
	}
}

453 
	gCtu_Fame
[64] = "mstp_20090123091200.cap";

454 
FILE
 *
	gpFe
 = 
NULL
;

455 #i
defed
(
_WIN32
)

456 
HANDLE
 
	ghPe
 = 
INVALID_HANDLE_VALUE
;

457 
	$med_pe_
(

458 *
pe_me
)

460 i(!
Weshk_Ctu
) {

461 
	`rtf
(
dout
, "mpp: Cg Named P\"%s\"\n", 
pe_me
);

464 
hPe
 =
INVALID_HANDLE_VALUE
)

467 
hPe
 = 
	`CeFe
(

468 
pe_me
,

469 
GENERIC_READ
 |

470 
GENERIC_WRITE
,

472 
NULL
,

473 
OPEN_EXISTING
,

475 
NULL
);

476 i(
hPe
 !
INVALID_HANDLE_VALUE
) {

480 i(!
	`WaNamedPe
(
pe_me
, 20000)) {

481 
	`tf
("Couldot openipe: waited for 20sec!\n"

484 
Ex_Requeed
 = 
ue
;

488 
	`CNamedPe
(
hPe
, 
NULL
);

489 
	}
}

491 
size_t
 
	$da_wre
(

492 cڡ *
r
,

493 
size_t
 
size
,

494 
size_t
 
nems
)

496 
DWORD
 
cbWrn
 = 0;

497 i(
hPe
 !
INVALID_HANDLE_VALUE
) {

498 (
	`WreFe
(
hPe
,

499 
r
,

500 
size
 * 
nems
,

501 &
cbWrn
,

502 
NULL
);

505  
	`fwre
(
r
, 
size
, 
nems
, 
pFe
);

506 
	}
}

508 
size_t
 
	$da_wre_hd
(

509 cڡ *
r
,

510 
size_t
 
size
,

511 
size_t
 
nems
,

512 
bo
 
pe_ab
)

514 
DWORD
 
cbWrn
 = 0;

515 i(
pe_ab
 && (
hPe
 !
INVALID_HANDLE_VALUE
)) {

516 (
	`WreFe
(
hPe
,

517 
r
,

518 
size
 * 
nems
,

519 &
cbWrn
,

520 
NULL
);

523  
	`fwre
(
r
, 
size
, 
nems
, 
pFe
);

524 
	}
}

526 
	gFD_Pe
 = -1;

527 
	$med_pe_
(

528 *
me
)

530 
rv
 = 0;

531 
rv
 = 
	`mkfifo
(
me
, 0666);

532 i((
rv
 =-1&& (
o
 !
EEXIST
)) {

533 
	`
("Error creatingamedipe");

534 
	`ex
(1);

536 
FD_Pe
 = 
	`ݒ
(
me
, 
O_WRONLY
);

537 i(
FD_Pe
 == -1) {

538 
	`
("Error connectingoamedipe");

539 
	`ex
(1);

541 
	}
}

543 
size_t
 
	$da_wre
(

544 cڡ *
r
,

545 
size_t
 
size
,

546 
size_t
 
nems
)

548 
ssize_t
 
bys
 = 0;

549 i(
FD_Pe
 != -1) {

550 
bys
 = 
	`wre
(
FD_Pe
, 
r
, 
size
 * 
nems
);

551 
bys
 = bytes;

553  
	`fwre
(
r
, 
size
, 
nems
, 
pFe
);

554 
	}
}

556 
size_t
 
	$da_wre_hd
(

557 cڡ *
r
,

558 
size_t
 
size
,

559 
size_t
 
nems
,

560 
bo
 
pe_ab
)

562 
ssize_t
 
bys
 = 0;

563 i(
pe_ab
 && (
FD_Pe
 != -1)) {

564 
bys
 = 
	`wre
(
FD_Pe
, 
r
, 
size
 * 
nems
);

565 
bys
 = bytes;

567  
	`fwre
(
r
, 
size
, 
nems
, 
pFe
);

568 
	}
}

571 
	$fame_
(

572 *
fame
)

574 
time_t
 
my_time
;

575 
tm
 *
today
;

577 i(
fame
) {

578 
my_time
 = 
	`time
(
NULL
);

579 
today
 = 
	`loime
(&
my_time
);

580 
	`rtf
(
fame
, "mstp_%04d%02d%02d%02d%02d%02d.cap",

581 1900 + 
today
->
tm_yr
, 1 +oday->
tm_m
,oday->
tm_mday
,

582 
today
->
tm_hour
,oday->
tm_m
,oday->
tm_c
);

584 
	}
}

587 
	$wre_glob_hd
(

588 cڡ *
fame
)

590 
bo
 
pe_ab
 = 
ue
;

591 
ut32_t
 
magic_numb
 = 0xa1b2c3d4;

592 
ut16_t
 
vsi_maj
 = 2;

593 
ut16_t
 
vsi_m
 = 4;

594 
t32_t
 
thisze
 = 0;

595 
ut32_t
 
sigfigs
 = 0;

596 
ut32_t
 
n
 = 65535;

597 
ut32_t
 
twk
 = 
DLT_BACNET_MS_TP
;

600 
pFe
 = 
	`fݒ
(
fame
, "wb");

601 i(
pFe
) {

602 (
	`da_wre_hd
(&
magic_numb
, (magic_number), 1,

603 
pe_ab
);

604 (
	`da_wre_hd
(&
vsi_maj
, (version_major), 1,

605 
pe_ab
);

606 (
	`da_wre_hd
(&
vsi_m
, (version_minor), 1,

607 
pe_ab
);

608 (
	`da_wre_hd
(&
thisze
, hisze), 1, 
pe_ab
);

609 (
	`da_wre_hd
(&
sigfigs
, (sigfigs), 1, 
pe_ab
);

610 (
	`da_wre_hd
(&
n
, (n), 1, 
pe_ab
);

611 (
	`da_wre_hd
(&
twk
, ґwk), 1, 
pe_ab
);

612 
	`fush
(
pFe
);

613 i(!
Weshk_Ctu
) {

614 
	`rtf
(
dout
, "mpp: savg ctu%s\n", 
fame
);

617 
	`rtf
(
dr
, "mpp[hd]: faedݒ %s: %s\n", 
fame
,

618 
	`
(
o
));

620 i(
pe_ab
) {

621 
pe_ab
 = 
l
;

623 
	}
}

626 
	$wre_ived_ck
(

627 vީ
mp_pt_ru_t
 *
mp_pt
,

628 
size_t
 
hd_n
)

630 
ut32_t
 
ts_c
 = 0;

631 
ut32_t
 
ts_uc
 = 0;

632 
ut32_t
 
_n
 = 0;

633 
ut32_t
 
ig_n
 = 0;

634 
ut8_t
 
hd
[
MSTP_HEADER_MAX
] = {0};

635 
timev
 
tv
;

636 
size_t
 
max_da
 = 0;

638 i(
pFe
) {

639 
	`gtimeofday
(&
tv
, 
NULL
);

640 
ts_c
 = 
tv
.
tv_c
;

641 
ts_uc
 = 
tv
.
tv_uc
;

642 i((
mp_pt
->
ReivedVidFme
) ||

643 (
mp_pt
->
ReivedVidFmeNFUs
)) {

644 
	`ck_iics
(&
tv
, 
mp_pt
);

646 (
	`da_wre
(&
ts_c
, (ts_sec), 1);

647 (
	`da_wre
(&
ts_uc
, (ts_usec), 1);

648 i(
mp_pt
->
ReivedInvidFme
) {

649 i(
mp_pt
->
Index
) {

650 
max_da
 = 
	`m
(
mp_pt
->
IutBufrSize
, mp_pt->
Index
);

651 
_n
 = 
ig_n
 = 
hd_n
 + 
max_da
 + 2 ;

654 
_n
 = 
ig_n
 = 
hd_n
;

657 i(
mp_pt
->
DaLgth
) {

658 
max_da
 = 
	`m
(
mp_pt
->
IutBufrSize
, mp_pt->
DaLgth
);

659 
_n
 = 
ig_n
 = 
hd_n
 + 
max_da
 + 2 ;

662 
_n
 = 
ig_n
 = 
hd_n
;

665 (
	`da_wre
(&
_n
, (incl_len), 1);

666 (
	`da_wre
(&
ig_n
, (orig_len), 1);

667 i(
hd_n
 == 1) {

668 
hd
[0] = 
mp_pt
->
DaRegi
;

669 } i(
hd_n
 == 2) {

670 
hd
[0] = 0x55;

671 
hd
[1] = 
mp_pt
->
DaRegi
;

673 
hd
[0] = 0x55;

674 
hd
[1] = 0xFF;

675 
hd
[2] = 
mp_pt
->
FmeTy
;

676 
hd
[3] = 
mp_pt
->
DeiAddss
;

677 
hd
[4] = 
mp_pt
->
SourAddss
;

678 
hd
[5] = 
	`HI_BYTE
(
mp_pt
->
DaLgth
);

679 
hd
[6] = 
	`LO_BYTE
(
mp_pt
->
DaLgth
);

680 
hd
[7] = 
mp_pt
->
HdCRCAu
;

682 (
	`da_wre
(
hd
, 
hd_n
, 1);

683 i(
max_da
) {

684 (
	`da_wre
(
mp_pt
->
IutBufr
, 
max_da
, 1);

685 (
	`da_wre
((*&
mp_pt
->
DaCRCAuMSB
, 1, 1);

686 (
	`da_wre
((*&
mp_pt
->
DaCRCAuLSB
, 1, 1);

689 
	`rtf
(
dr
, "mstpcap[packet]: failedo open %s: %s\n",

690 
Ctu_Fame
, 
	`
(
o
));

692 
	}
}

695 
bo
 
	$_glob_hd
(

696 cڡ *
fame
)

698 
ut32_t
 
magic_numb
 = 0;

699 
ut16_t
 
vsi_maj
 = 0;

700 
ut16_t
 
vsi_m
 = 0;

701 
t32_t
 
thisze
 = 0;

702 
ut32_t
 
sigfigs
 = 0;

703 
ut32_t
 
n
 = 0;

704 
ut32_t
 
twk
 = 0;

705 
size_t
 
cou
 = 0;

708 
pFe
 = 
	`fݒ
(
fame
, "rb");

709 i(
pFe
) {

710 
cou
 = 
	`d
(&
magic_numb
, (magic_numb), 1, 
pFe
);

711 i((
cou
 !1|| (
magic_numb
 != 0xa1b2c3d4)) {

712 
	`rtf
(
dr
, "mstpcap: invalid magicumber\n");

713 
	`fo
(
pFe
);

714 
pFe
 = 
NULL
;

715  
l
;

717 
cou
 = 
	`d
(&
vsi_maj
, (vsi_maj), 1, 
pFe
);

718 i((
cou
 !1|| (
vsi_maj
 != 2)) {

719 
	`rtf
(
dr
, "mstpcap: invalid major version\n");

720 
	`fo
(
pFe
);

721 
pFe
 = 
NULL
;

722  
l
;

724 
cou
 = 
	`d
(&
vsi_m
, (vsi_m), 1, 
pFe
);

725 i((
cou
 !1|| (
vsi_m
 != 4)) {

726 
	`rtf
(
dr
, "mstpcap: invalid minor version\n");

727 
	`fo
(
pFe
);

728 
pFe
 = 
NULL
;

729  
l
;

731 
cou
 = 
	`d
(&
thisze
, hisze), 1, 
pFe
);

732 i((
cou
 !1|| (
thisze
 != 0)) {

733 
	`rtf
(
dr
, "mstpcap: invalidime zone\n");

734 
	`fo
(
pFe
);

735 
pFe
 = 
NULL
;

736  
l
;

738 
cou
 = 
	`d
(&
sigfigs
, (sigfigs), 1, 
pFe
);

739 i((
cou
 !1|| (
sigfigs
 != 0)) {

740 
	`rtf
(
dr
, "mstpcap: invalidime stampccuracy\n");

741 
	`fo
(
pFe
);

742 
pFe
 = 
NULL
;

743  
l
;

745 
cou
 = 
	`d
(&
n
, (n), 1, 
pFe
);

746 i(
cou
 != 1) {

747 
	`rtf
(
dr
, "mstpcap: unableoead SNAPength\n");

748 
	`fo
(
pFe
);

749 
pFe
 = 
NULL
;

750  
l
;

752 
cou
 = 
	`d
(&
twk
, ґwk), 1, 
pFe
);

753 i((
cou
 !1|| (
twk
 !
DLT_BACNET_MS_TP
)) {

754 
	`rtf
(
dr
, "mstpcap: invalid datainkype (DLT)\n");

755 
	`fo
(
pFe
);

756 
pFe
 = 
NULL
;

757  
l
;

760 
	`rtf
(
dr
, "mpp[sn]: faedݒ %s: %s\n", 
fame
,

761 
	`
(
o
));

762  
l
;

765  
ue
;

766 
	}
}

768 
bo
 
	$ad_ived_ck
(

769 vީ
mp_pt_ru_t
 *
mp_pt
)

771 
ut32_t
 
ts_c
 = 0;

772 
ut32_t
 
ts_uc
 = 0;

773 
ut32_t
 
_n
 = 0;

774 
ut32_t
 
ig_n
 = 0;

775 
ut8_t
 
hd
[8] = { 0 };

776 
timev
 
tv
;

777 
size_t
 
cou
 = 0;

778 
i
 = 0;

780 i(
pFe
) {

781 
cou
 = 
	`d
(&
ts_c
, s_c), 1, 
pFe
);

782 i(
cou
 != 1) {

783 
	`fo
(
pFe
);

784 
pFe
 = 
NULL
;

785  
l
;

787 
cou
 = 
	`d
(&
ts_uc
, s_uc), 1, 
pFe
);

788 i(
cou
 != 1) {

789 
	`fo
(
pFe
);

790 
pFe
 = 
NULL
;

791  
l
;

793 
tv
.
tv_c
 = 
ts_c
;

794 
tv
.
tv_uc
 = 
ts_uc
;

795 
cou
 = 
	`d
(&
_n
, (_n), 1, 
pFe
);

796 i(
cou
 != 1) {

797 
	`fo
(
pFe
);

798 
pFe
 = 
NULL
;

799  
l
;

801 
cou
 = 
	`d
(&
ig_n
, (ig_n), 1, 
pFe
);

802 i(
cou
 != 1) {

803 
	`fo
(
pFe
);

804 
pFe
 = 
NULL
;

805  
l
;

807 
cou
 = 
	`d
(&
hd
, (hd), 1, 
pFe
);

808 i(
cou
 != 1) {

809 
	`fo
(
pFe
);

810 
pFe
 = 
NULL
;

811  
l
;

813 
mp_pt
->
FmeTy
 = 
hd
[2];

814 
mp_pt
->
DeiAddss
 = 
hd
[3];

815 
mp_pt
->
SourAddss
 = 
hd
[4];

816 
mp_pt
->
DaLgth
 = 
	`MAKE_WORD
(
hd
[6], header[5]);

817 
mp_pt
->
HdCRCAu
 = 
hd
[7];

818 
mp_pt
->
HdCRC
 = 0xFF;

819 
i
 = 2; i < 8; i++) {

820 
mp_pt
->
HdCRC
 =

821 
	`CRC_Cc_Hd
(
hd
[
i
], 
mp_pt
->
HdCRC
);

823 i(
mp_pt
->
HdCRC
 == 0x55) {

824 
mp_pt
->
ReivedVidFme
 = 
ue
;

825 
mp_pt
->
ReivedInvidFme
 = 
l
;

826 i(
mp_pt
->
DaLgth
 == 0) {

827 
mp_pt
->
ReivedVidFme
 = 
ue
;

828 
mp_pt
->
ReivedVidFmeNFUs
 = 
ue
;

831 
mp_pt
->
ReivedVidFme
 = 
l
;

832 
mp_pt
->
ReivedInvidFme
 = 
ue
;

834 i(
ig_n
 > 8) {

836 
mp_pt
->
DaLgth
 = 
ig_n
 - 8 - 2;

837 
cou
 =

838 
	`d
(
mp_pt
->
IutBufr
, mp_pt->
DaLgth
, 1, 
pFe
);

839 i(
cou
 != 1) {

840 
	`fo
(
pFe
);

841 
pFe
 = 
NULL
;

842  
l
;

844 
cou
 = 
	`d
((*&
mp_pt
->
DaCRCAuMSB
, 1, 1, 
pFe
);

845 i(
cou
 != 1) {

846 
	`fo
(
pFe
);

847 
pFe
 = 
NULL
;

848  
l
;

850 
cou
 = 
	`d
((*&
mp_pt
->
DaCRCAuLSB
, 1, 1, 
pFe
);

851 i(
cou
 != 1) {

852 
	`fo
(
pFe
);

853 
pFe
 = 
NULL
;

854  
l
;

856 
mp_pt
->
DaCRC
 = 0xFFFF;

857 
i
 = 0; i < 
mp_pt
->
DaLgth
; i++) {

858 
mp_pt
->
DaCRC
 =

859 
	`CRC_Cc_Da
(
mp_pt
->
IutBufr
[
i
],

860 
mp_pt
->
DaCRC
);

862 
mp_pt
->
DaCRC
 =

863 
	`CRC_Cc_Da
(
mp_pt
->
DaCRCAuMSB
, mp_pt->
DaCRC
);

864 
mp_pt
->
DaCRC
 =

865 
	`CRC_Cc_Da
(
mp_pt
->
DaCRCAuLSB
, mp_pt->
DaCRC
);

866 i(
mp_pt
->
DaCRC
 == 0xF0B8) {

867 
mp_pt
->
ReivedInvidFme
 = 
l
;

868 
mp_pt
->
ReivedVidFme
 = 
ue
;

869 
mp_pt
->
ReivedVidFmeNFUs
 = 
ue
;

871 
mp_pt
->
ReivedInvidFme
 = 
ue
;

872 
mp_pt
->
ReivedVidFme
 = 
l
;

873 
mp_pt
->
ReivedVidFmeNFUs
 = 
l
;

876 
mp_pt
->
DaLgth
 = 0;

878 i(
mp_pt
->
ReivedInvidFme
) {

879 
Invid_Fme_Cou
++;

880 } i((
mp_pt
->
ReivedVidFme
) ||

881 (
mp_pt
->
ReivedVidFmeNFUs
)) {

882 
	`ck_iics
(&
tv
, 
mp_pt
);

885  
l
;

888  
ue
;

889 
	}
}

891 
	$nup
(

894 i(!
Weshk_Ctu
) {

895 
	`ck_iics_t
();

897 i(
pFe
) {

898 
	`fush
(
pFe
);

899 
	`fo
(
pFe
);

901 
pFe
 = 
NULL
;

902 
	}
}

904 #i
defed
(
_WIN32
)

905 
BOOL
 
WINAPI
 
	$ClCHdr
(

906 
DWORD
 
dwClTy
)

908 
dwClTy
 = dwCtrlType;

910 i(
hPe
 !
INVALID_HANDLE_VALUE
) {

911 
	`FlushFeBufrs
(
hPe
);

912 
	`DiscNamedPe
(
hPe
);

913 
	`CloHd
(
hPe
);

914 
hPe
 = 
INVALID_HANDLE_VALUE
;

917 
Ex_Requeed
 = 
ue
;

918 
Ex_Requeed
) {

919 
	`S˕
(100);

921 
	`ex
(0);

923  
TRUE
;

924 
	}
}

926 
	$sig_t
(

927 
signo
)

929 (
signo
;

930 i(
FD_Pe
 != -1) {

931 
	`o
(
FD_Pe
);

933 
Ex_Requeed
 = 
ue
;

934 
	`ex
(0);

935 
	}
}

937 
	$sigl_
(

940 
	`sigl
(
SIGINT
, 
sig_t
);

941 
	`sigl
(
SIGHUP
, 
sig_t
);

942 
	`sigl
(
SIGTERM
, 
sig_t
);

943 
	}
}

946 
	$fame__w
(

949 i(
pFe
) {

950 
	`fo
(
pFe
);

952 
pFe
 = 
NULL
;

953 
	`fame_
(&
Ctu_Fame
[0]);

954 
	`wre_glob_hd
(&
Ctu_Fame
[0]);

955 
	}
}

957 
	$t_uge
(

958 *
fame
)

960 
	`tf
("Uge: %s", 
fame
);

961 
	`tf
(" [--scan <filename>]\n");

962 
	`tf
(" [--extcap-interfaceort]\n");

963 
	`tf
(" [--extcap-interfaces][--extcap-dlts][--extcap-config]\n");

964 
	`tf
(" [--capture][--baud baud][--fifoipe]\n");

965 
	`tf
(" [--version][--help]\n");

966 
	}
}

968 
	$t_hp
(*
fame
) {

969 
	`tf
("%s --scan <filename>\n"

971 
fame
);

972 
	`tf
("\n");

973 
	`tf
("Captures MS/TPackets from serial interface\n"

979 #i
	`defed
(
_WIN32
)

988 #i
	`defed
(
_WIN32
)

994 
	`tf
("\n");

995 
	`tf
("%s [--extcap-interfaces][--extcap-dlts][--extcap-config]\n"

999 
fame
);

1000 
	}
}

1003 
	$mp_ruu_
(

1004 vީ
mp_pt_ru_t
 *
mp_pt
)

1006 i(
mp_pt
) {

1007 
mp_pt
->
FmeTy
 = 
FRAME_TYPE_PROPRIETARY_MAX
;

1008 
mp_pt
->
DeiAddss
 = 
MSTP_BROADCAST_ADDRESS
;

1009 
mp_pt
->
SourAddss
 = 
MSTP_BROADCAST_ADDRESS
;

1010 
mp_pt
->
DaLgth
 = 0;

1011 
mp_pt
->
HdCRCAu
 = 0;

1012 
mp_pt
->
Index
 = 0;

1013 
mp_pt
->
EvtCou
 = 0;

1014 
mp_pt
->
ReivedInvidFme
 = 
l
;

1015 
mp_pt
->
ReivedVidFme
 = 
l
;

1016 
mp_pt
->
ReivedVidFmeNFUs
 = 
l
;

1017 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

1019 
	}
}

1022 
	$ma
(

1023 
gc
,

1024 *
gv
[])

1026 vީ
mp_pt_ru_t
 *
mp_pt
;

1027 
my_baud
 = 38400;

1028 
ut32_t
 
ck_cou
 = 0;

1029 
ut32_t
 
hd_n
 = 0;

1030 
gi
 = 0;

1031 *
fame
 = 
NULL
;

1033 
MSTP_Pt
.
IutBufr
 = &
RxBufr
[0];

1034 
MSTP_Pt
.
IutBufrSize
 = (
RxBufr
);

1035 
MSTP_Pt
.
OuutBufr
 = &
TxBufr
[0];

1036 
MSTP_Pt
.
OuutBufrSize
 = (
TxBufr
);

1037 
MSTP_Pt
.
This_Sti
 = 127;

1038 
MSTP_Pt
.
Nmax_fo_ames
 = 1;

1039 
MSTP_Pt
.
Nmax_ma
 = 127;

1040 
MSTP_Pt
.
STim
 = 
Tim_S
;

1041 
MSTP_Pt
.
STimRet
 = 
Tim_S_Ret
;

1043 
mp_pt
 = &
MSTP_Pt
;

1044 
	`MSTP_In
(
mp_pt
);

1045 
	`ck_iics_r
();

1047 
fame
 = 
	`fame_move_th
(
gv
[0]);

1048 
gi
 = 1;rg< 
gc
;rgi++) {

1049 i(
	`rcmp
(
gv
[
gi
], "--help") == 0) {

1050 
	`t_uge
(
fame
);

1051 
	`t_hp
(
fame
);

1054 i(
	`rcmp
(
gv
[
gi
], "--version") == 0) {

1055 
	`tf
("mp%s\n", 
BACNET_VERSION_TEXT
);

1056 
	`tf
("Copyright (C) 2011-2016 by Steve Karg\n"

1062 i(
	`rcmp
(
gv
[
gi
], "--scan") == 0) {

1063 
gi
++;

1064 i(
gi
 >
gc
) {

1065 
	`tf
("An fileame must berovided.\n");

1068 
	`tf
("Sg %s\n", 
gv
[
gi
]);

1070 i(
	`_glob_hd
(
gv
[
gi
])) {

1071 
	`ad_ived_ck
(
mp_pt
)) {

1072 
ck_cou
++;

1073 
	`rtf
(
dr
, "\r%uackets",

1074 (
ck_cou
);

1076 i(
ck_cou
) {

1077 
	`ck_iics_t
();

1079 
Ex_Requeed
 = 
ue
;

1081 
	`rtf
(
dr
, "File header doesot match.\n");

1085 i(
	`rcmp
(
gv
[
gi
], "--extcap-interfaces") == 0) {

1086 
	`RS485_Prt_Pts
();

1089 i(
	`rcmp
(
gv
[
gi
], "--extcap-dlts") == 0) {

1090 
gi
++;

1091 i(
gi
 >
gc
) {

1092 
	`tf
("An interface must berovided.\n");

1095 
	`tf
("dlt {number=%u}{name=BACnet MS/TP}"

1097 
DLT_BACNET_MS_TP
);

1098 
Ex_Requeed
 = 
ue
;

1100 i(
	`rcmp
(
gv
[
gi
], "--extcap-config") == 0) {

1101 
	`tf
("arg {number=0}{call=--baud}{display=Baud Rate}"

1104 
	`tf
("value {arg=0}{value=9600}{display=9600}{default=false}\n");

1105 
	`tf
("value {arg=0}{value=19200}{display=19200}{default=false}\n");

1106 
	`tf
("value {arg=0}{value=38400}{display=38400}{default=true}\n");

1107 
	`tf
("value {arg=0}{value=57600}{display=57600}{default=false}\n");

1108 
	`tf
("value {arg=0}{value=76800}{display=76800}{default=false}\n");

1109 
	`tf
("value {arg=0}{value=115200}{display=115200}{default=false}\n");

1112 i(
	`rcmp
(
gv
[
gi
], "--capture") == 0) {

1114 
Weshk_Ctu
 = 
ue
;

1116 i(
	`rcmp
(
gv
[
gi
], "--extcap-interface") == 0) {

1117 
gi
++;

1118 i(
gi
 >
gc
) {

1119 
	`tf
("An interface must berovided or "

1123 
	`RS485_S_I
(
gv
[
gi
]);

1125 #i
	`defed
(
_WIN32
)

1126 i(
	`cmp
(
gv
[
gi
], "com", 3) == 0) {

1128 
	`RS485_S_I
(
gv
[
gi
]);

1129 i((
gi
+1< 
gc
) {

1130 
gi
++;

1131 
my_baud
 = 
	`
(
gv
[
gi
], 
NULL
, 0);

1132 
	`RS485_S_Baud_Re
(
my_baud
);

1136 i(
	`cmp
(
gv
[
gi
], "/dev/", 5) == 0) {

1138 
	`RS485_S_I
(
gv
[
gi
]);

1139 i((
gi
+1< 
gc
) {

1140 
gi
++;

1141 
my_baud
 = 
	`
(
gv
[
gi
], 
NULL
, 0);

1142 
	`RS485_S_Baud_Re
(
my_baud
);

1146 i(
	`rcmp
(
gv
[
gi
], "--baud") == 0) {

1147 
gi
++;

1148 i(
gi
 >
gc
) {

1149 
	`tf
("A baudate must berovided.\n");

1152 
my_baud
 = 
	`
(
gv
[
gi
], 
NULL
, 0);

1153 
	`RS485_S_Baud_Re
(
my_baud
);

1155 i(
	`rcmp
(
gv
[
gi
], "--fifo") == 0) {

1156 
gi
++;

1157 i(
gi
 >
gc
) {

1158 
	`tf
("Aamedipe must berovided.\n");

1161 
	`med_pe_
(
gv
[
gi
]);

1164 i(
Ex_Requeed
) {

1167 i(
gc
 <= 1) {

1168 
	`RS485_Prt_Pts
();

1171 
	`ex
(
nup
);

1172 
	`RS485_Inlize
();

1173 
	`tim_
();

1174 i(!
Weshk_Ctu
) {

1175 
	`rtf
(
dout
, "mstpcap: Using %s for capturet %ld bps.\n",

1176 
	`RS485_I
(), (
	`RS485_G_Baud_Re
());

1178 #i
	`defed
(
_WIN32
)

1179 
	`SCseMode
(
	`GStdHd
(
STD_INPUT_HANDLE
), 
ENABLE_PROCESSED_INPUT
);

1180 
	`SCseClHdr
((
PHANDLER_ROUTINE

ClCHdr
, 
TRUE
);

1182 
	`sigl_
();

1184 
	`fame__w
();

1187 
	`RS485_Check_UART_Da
(
mp_pt
);

1188 
	`MSTP_Reive_Fme_FSM
(
mp_pt
);

1190 i(
mp_pt
->
ReivedVidFme
) {

1191 
	`wre_ived_ck
(
mp_pt
, 
MSTP_HEADER_MAX
);

1192 
	`mp_ruu_
(
mp_pt
);

1193 
ck_cou
++;

1194 } i(
mp_pt
->
ReivedVidFmeNFUs
) {

1195 
	`wre_ived_ck
(
mp_pt
, 
MSTP_HEADER_MAX
);

1196 
	`mp_ruu_
(
mp_pt
);

1197 
ck_cou
++;

1198 } i(
mp_pt
->
ReivedInvidFme
) {

1199 i(
MSTP_Reive_S
 =
MSTP_RECEIVE_STATE_HEADER
) {

1200 
mp_pt
->
Index
 = 0;

1202 
	`wre_ived_ck
(
mp_pt
, 
MSTP_HEADER_MAX
);

1203 
	`mp_ruu_
(
mp_pt
);

1204 
Invid_Fme_Cou
++;

1205 
ck_cou
++;

1206 } i(
mp_pt
->
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
) {

1207 i(
MSTP_Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
) {

1208 i((
mp_pt
->
EvtCou
 == 1) &&

1209 (
mp_pt
->
DaRegi
 == 0xFF)) {

1211 
	`mp_ruu_
(
mp_pt
);

1212 } i(
mp_pt
->
EvtCou
 > 1) {

1213 
	`wre_ived_ck
(
mp_pt
, 1);

1214 
	`mp_ruu_
(
mp_pt
);

1215 
Invid_Fme_Cou
++;

1219 i(
MSTP_Reive_S
 =
MSTP_RECEIVE_STATE_PREAMBLE
) {

1220 i(
mp_pt
->
EvtCou
) {

1221 
hd_n
 = 1;

1223 
hd_n
 = 2;

1226 
hd_n
 = 3 + 
mp_pt
->
Index
;

1228 
	`wre_ived_ck
(
mp_pt
, 
hd_n
);

1229 
	`mp_ruu_
(
mp_pt
);

1230 
Invid_Fme_Cou
++;

1233 i(!
Weshk_Ctu
) {

1234 i(!(
ck_cou
 % 100)) {

1235 
	`rtf
(
dout
, "\r%huacks, %hu invid fmes", 
ck_cou
,

1236 
Invid_Fme_Cou
);

1238 i(
ck_cou
 >= 65535) {

1239 
	`ck_iics_t
();

1240 
	`ck_iics_r
();

1241 
	`fame__w
();

1242 
ck_cou
 = 0;

1245 i(
Ex_Requeed
) {

1249 
MSTP_Reive_S
 = 
mp_pt
->
ive_e
;

1252 
Ex_Requeed
 = 
l
;

1255 
	}
}

	@demo/mstpcrc/main.c

35 
	~<ddef.h
>

36 
	~<dt.h
>

37 
	~<dbo.h
>

38 
	~<dio.h
>

39 
	~<dlib.h
>

40 
	~<rg.h
>

41 
	~<o.h
>

42 
	~<time.h
>

43 
	~<y.h
>

45 
	~"t.h
"

46 
	~"tim.h
"

48 
	~"bys.h
"

49 
	~"c.h
"

50 
	~"vsi.h
"

52 #ide
max


53 
	#max
(
a
,
b
(((b)? (a: (b))

	)

54 
	#m
(
a
,
b
((< (b)? (a: (b))

	)

58 
ut8_t
 
	gCRC_Bufr
[1512];

59 
	gCRC_Bufr_L
 = 0;

61 
bo
 
	gASCII_Decim
 = 
l
;

62 
	gCRC_Size
 = 8;

64 
bo
 
	gMSTP_C
 = 
l
;

65 
bo
 
	gMSTP_Text_Fe
 = 
l
;

66 
	gCtu_Fame
[64] = "mstp_20090123091200.cap";

67 
FILE
 *
	gpFe
 = 
NULL
;

68 
FILE
 *
	gpText_Fe
 = 
NULL
;

77 
	$P_Numb
(

78 *
gi
)

80 
lg_vue
 = 0;

82 i(
ASCII_Decim
) {

83 
lg_vue
 = 
	`
(
gi
, 
NULL
, 10);

85 
lg_vue
 = 
	`
(
gi
, 
NULL
, 16);

87 
CRC_Bufr
[
CRC_Bufr_L
] = (
ut8_t

lg_vue
;

88 
CRC_Bufr_L
++;

89 
	}
}

99 
	$P_Argumts
(

100 
gc
,

101 *
gv
[])

103 
i
 = 0;

104 
lg_vue
 = 0;

106 
i
 = 1; i < 
gc
; i++) {

107 i(
gv
[
i
][0] == '-') {

109 i(
	`isdig
(
gv
[
i
][1])) {

110 
lg_vue
 = 
	`
(&
gv
[
i
][1], 
NULL
, 10);

112 
lg_vue
) {

114 
CRC_Size
 = 8;

117 
CRC_Size
 = 16;

120 
CRC_Size
 = 32;

127 
gv
[
i
][1]) {

130 
ASCII_Decim
 = 
l
;

134 
ASCII_Decim
 = 
ue
;

138 
MSTP_C
 = 
ue
;

142 
MSTP_Text_Fe
 = 
ue
;

148 i(
MSTP_Text_Fe
) {

150 
pText_Fe
 = 
	`fݒ
(
gv
[
i
], "r");

153 
	`P_Numb
(
gv
[
i
]);

157 
	}
}

159 
	$fame_
(

160 *
fame
)

162 
time_t
 
my_time
;

163 
tm
 *
today
;

165 i(
fame
) {

166 
my_time
 = 
	`time
(
NULL
);

167 
today
 = 
	`loime
(&
my_time
);

168 
	`rtf
(
fame
, "mstp_%04d%02d%02d%02d%02d%02d.cap",

169 1900 + 
today
->
tm_yr
, 1 +oday->
tm_m
,oday->
tm_mday
,

170 
today
->
tm_hour
,oday->
tm_m
,oday->
tm_c
);

172 
	}
}

175 
	$wre_glob_hd
(

176 cڡ *
fame
)

178 
ut32_t
 
magic_numb
 = 0xa1b2c3d4;

179 
ut16_t
 
vsi_maj
 = 2;

180 
ut16_t
 
vsi_m
 = 4;

181 
t32_t
 
thisze
 = 0;

182 
ut32_t
 
sigfigs
 = 0;

183 
ut32_t
 
n
 = 65535;

184 
ut32_t
 
twk
 = 165;

187 
pFe
 = 
	`fݒ
(
fame
, "wb");

188 i(
pFe
) {

189 (
	`fwre
(&
magic_numb
, (magic_numb), 1, 
pFe
);

190 (
	`fwre
(&
vsi_maj
, (vsi_maj), 1, 
pFe
);

191 (
	`fwre
(&
vsi_m
, (vsi_m), 1, 
pFe
);

192 (
	`fwre
(&
thisze
, hisze), 1, 
pFe
);

193 (
	`fwre
(&
sigfigs
, (sigfigs), 1, 
pFe
);

194 (
	`fwre
(&
n
, (n), 1, 
pFe
);

195 (
	`fwre
(&
twk
, ґwk), 1, 
pFe
);

196 
	`fush
(
pFe
);

197 
	`rtf
(
dout
, "mpp: savg ctu%s\n", 
fame
);

199 
	`rtf
(
dr
, "mpp[hd]: faedݒ %s: %s\n", 
fame
,

200 
	`
(
o
));

202 
	}
}

204 
	$wre_ived_ck
(

205 
ut8_t
 * 
bufr
,

206 
ngth
)

208 
ut32_t
 
ts_c
;

209 
ut32_t
 
ts_uc
;

210 
ut32_t
 
_n
;

211 
ut32_t
 
ig_n
;

212 
timev
 
tv
;

214 i(
pFe
) {

215 
	`gtimeofday
(&
tv
, 
NULL
);

216 
ts_c
 = 
tv
.
tv_c
;

217 
ts_uc
 = 
tv
.
tv_uc
;

218 (
	`fwre
(&
ts_c
, s_c), 1, 
pFe
);

219 (
	`fwre
(&
ts_uc
, s_uc), 1, 
pFe
);

220 
ig_n
 = 
_n
 = 
ngth
;

221 (
	`fwre
(&
_n
, (_n), 1, 
pFe
);

222 (
	`fwre
(&
ig_n
, (ig_n), 1, 
pFe
);

223 (
	`fwre
(
bufr
, 
ngth
, 1, 
pFe
);

225 
	`rtf
(
dr
, "mstpcrc[packet]: failedo open %s: %s\n",

226 
Ctu_Fame
, 
	`
(
o
));

228 
	}
}

230 
	$Wre_Pp
(

231 
ut8_t
 * 
bufr
,

232 
ngth
)

234 
	`fame_
(&
Ctu_Fame
[0]);

235 
	`wre_glob_hd
(&
Ctu_Fame
[0]);

236 
	`wre_ived_ck
(
bufr
, 
ngth
);

237 i(
pFe
) {

238 
	`fo
(
pFe
);

240 
	}
}

242 
	gText_Bufr
[1024*3];

243 
	$Pross_Text_Fe
()

245 *
gi
 = 
NULL
;

247 
	`fame_
(&
Ctu_Fame
[0]);

248 
	`wre_glob_hd
(&
Ctu_Fame
[0]);

249 
	`fgs
(
Text_Bufr
, (Text_Bufr), 
pText_Fe
)) {

250 
CRC_Bufr_L
 = 0;

252 i(!
gi
) {

253 
gi
 = 
	`ok
(
Text_Bufr
, " ");

255 
gi
 = 
	`ok
(
NULL
, " ");

257 i(
gi
) {

258 
	`P_Numb
(
gi
);

260 } 
gi
);

261 
	`wre_ived_ck
(
CRC_Bufr
, 
CRC_Bufr_L
);

263 i(
pFe
) {

264 
	`fo
(
pFe
);

266 i(
pText_Fe
) {

267 
	`fo
(
pText_Fe
);

269 
	}
}

272 
	$ma
(

273 
gc
,

274 *
gv
[])

277 
ut8_t
 
c8
 = 0xff;

278 
ut16_t
 
c16
 = 0xffff;

279 
i
 = 0;

282 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

283 
	`tf
("mstpcrc [options] <05 03 01 0D...>\r\n"

295 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--version") == 0)) {

296 
	`tf
("mp%s\r\n", 
BACNET_VERSION_TEXT
);

297 
	`tf
("Copyright (C) 2012 by Steve Karg\r\n"

303 
	`P_Argumts
(
gc
, 
gv
);

304 i(
MSTP_Text_Fe
) {

305 
	`Pross_Text_Fe
();

306 } i(
CRC_Bufr_L
) {

307 i(
MSTP_C
) {

308 
	`Wre_Pp
(
CRC_Bufr
, 
CRC_Bufr_L
);

310 
i
 = 0; i < 
CRC_Bufr_L
; i++) {

311 i(
CRC_Size
 == 8) {

312 
c8
 = 
	`CRC_Cc_Hd
(
CRC_Bufr
[
i
], crc8);

313 } i(
CRC_Size
 == 16) {

314 
c16
 = 
	`CRC_Cc_Da
(
CRC_Bufr
[
i
], crc16);

316 i(
ASCII_Decim
) {

317 
	`tf
("%u\r\n", (
CRC_Bufr
[
i
]);

319 
	`tf
("0x%02X\r\n", 
CRC_Bufr
[
i
]);

322 i(
CRC_Size
 == 8) {

323 
c8
 = ~crc8;

324 i(
ASCII_Decim
) {

325 
	`tf
("%u Hd CRC\r\n", (
c8
);

327 
	`tf
("0x%02X Hd CRC\r\n", 
c8
);

329 } i(
CRC_Size
 == 16) {

330 
c16
 = ~crc16;

331 i(
ASCII_Decim
) {

332 
	`tf
("%u DCRC\r\n", ((
c16
 & 0xFF));

333 
	`tf
("%u DCRC\r\n", ((
c16
 >> 8));

335 
	`tf
("0x%02X DCRC\r\n", (
c16
 & 0xFF));

336 
	`tf
("0x%02X DCRC\r\n", (
c16
 >> 8));

343 
	}
}

	@demo/object/ai.c

29 
	~<dbo.h
>

30 
	~<dt.h
>

31 
	~<dio.h
>

33 
	~"bacdef.h
"

34 
	~"bacdcode.h
"

35 
	~"banum.h
"

36 
	~"baext.h
"

37 
	~"cfig.h
"

38 
	~"devi.h
"

39 
	~"hdrs.h
"

40 
	~"timeamp.h
"

41 
	~"ai.h
"

44 #ide
MAX_ANALOG_INPUTS


45 
	#MAX_ANALOG_INPUTS
 4

	)

49 
ANALOG_INPUT_DESCR
 
	gAI_Des
[
MAX_ANALOG_INPUTS
];

52 cڡ 
	gPrݔts_Requed
[] = {

53 
PROP_OBJECT_IDENTIFIER
,

54 
PROP_OBJECT_NAME
,

55 
PROP_OBJECT_TYPE
,

56 
PROP_PRESENT_VALUE
,

57 
PROP_STATUS_FLAGS
,

58 
PROP_EVENT_STATE
,

59 
PROP_OUT_OF_SERVICE
,

60 
PROP_UNITS
,

64 cڡ 
	gPrݔts_Oiڮ
[] = {

65 
PROP_DESCRIPTION
,

66 
PROP_RELIABILITY
,

67 
PROP_COV_INCREMENT
,

68 #i
defed
(
INTRINSIC_REPORTING
)

69 
PROP_TIME_DELAY
,

70 
PROP_NOTIFICATION_CLASS
,

71 
PROP_HIGH_LIMIT
,

72 
PROP_LOW_LIMIT
,

73 
PROP_DEADBAND
,

74 
PROP_LIMIT_ENABLE
,

75 
PROP_EVENT_ENABLE
,

76 
PROP_ACKED_TRANSITIONS
,

77 
PROP_NOTIFY_TYPE
,

78 
PROP_EVENT_TIME_STAMPS
,

83 cڡ 
	gPrݔts_Prrry
[] = {

90 
	$Alog_Iut_Prݔty_Lis
(

91 cڡ **
pRequed
,

92 cڡ **
pOiڮ
,

93 cڡ **
pPrrry
)

95 i(
pRequed
)

96 *
pRequed
 = 
Prݔts_Requed
;

97 i(
pOiڮ
)

98 *
pOiڮ
 = 
Prݔts_Oiڮ
;

99 i(
pPrrry
)

100 *
pPrrry
 = 
Prݔts_Prrry
;

103 
	}
}

106 
	$Alog_Iut_In
(

109 
i
;

110 #i
	`defed
(
INTRINSIC_REPORTING
)

111 
j
;

114 
i
 = 0; i < 
MAX_ANALOG_INPUTS
; i++) {

115 
AI_Des
[
i
].
P_Vue
 = 0.0f;

116 
AI_Des
[
i
].
Out_Of_Svi
 = 
l
;

117 
AI_Des
[
i
].
Uns
 = 
UNITS_PERCENT
;

118 
AI_Des
[
i
].
Rby
 = 
RELIABILITY_NO_FAULT_DETECTED
;

119 
AI_Des
[
i
].
Pri_Vue
 = 0.0f;

120 
AI_Des
[
i
].
COV_Inemt
 = 1.0f;

121 
AI_Des
[
i
].
Chged
 = 
l
;

122 #i
	`defed
(
INTRINSIC_REPORTING
)

123 
AI_Des
[
i
].
Evt_S
 = 
EVENT_STATE_NORMAL
;

125 
AI_Des
[
i
].
Nifiti_Css
 = 
BACNET_MAX_INSTANCE
;

128 
j
 = 0; j < 
MAX_BACNET_EVENT_TRANSITION
; j++) {

129 
	`dime_wdrd_t
(&
AI_Des
[
i
].
Evt_Time_Smps
[
j
]);

130 
AI_Des
[
i
].
Acked_Tnsis
[
j
].
bIsAcked
 = 
ue
;

134 
	`hdr_g_evt_fmi_t
(
OBJECT_ANALOG_INPUT
,

135 
Alog_Iut_Evt_Infmi
);

137 
	`hdr_m_ack_t
(
OBJECT_ANALOG_INPUT
, 
Alog_Iut_Arm_Ack
);

139 
	`hdr_g_m_summy_t
(
OBJECT_ANALOG_INPUT
,

140 
Alog_Iut_Arm_Summy
);

143 
	}
}

148 
bo
 
	$Alog_Iut_Vid_In
(

149 
ut32_t
 
obje_
)

151 
dex
;

153 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

154 i(
dex
 < 
MAX_ANALOG_INPUTS
)

155  
ue
;

157  
l
;

158 
	}
}

162 
	$Alog_Iut_Cou
(

165  
MAX_ANALOG_INPUTS
;

166 
	}
}

171 
ut32_t
 
	$Alog_Iut_Index_To_In
(

172 
dex
)

174  
dex
;

175 
	}
}

180 
	$Alog_Iut_In_To_Index
(

181 
ut32_t
 
obje_
)

183 
dex
 = 
MAX_ANALOG_INPUTS
;

185 i(
obje_
 < 
MAX_ANALOG_INPUTS
)

186 
dex
 = 
obje_
;

188  
dex
;

189 
	}
}

191 
	$Alog_Iut_P_Vue
(

192 
ut32_t
 
obje_
)

194 
vue
 = 0.0;

195 
dex
;

197 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

198 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

199 
vue
 = 
AI_Des
[
dex
].
P_Vue
;

202  
vue
;

203 
	}
}

205 
	$Alog_Iut_COV_De
(
dex
,

206 
vue
)

208 
i_vue
 = 0.0;

209 
cov_emt
 = 0.0;

210 
cov_d
 = 0.0;

212 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

213 
i_vue
 = 
AI_Des
[
dex
].
Pri_Vue
;

214 
cov_emt
 = 
AI_Des
[
dex
].
COV_Inemt
;

215 i(
i_vue
 > 
vue
) {

216 
cov_d
 = 
i_vue
 - 
vue
;

218 
cov_d
 = 
vue
 - 
i_vue
;

220 i(
cov_d
 >
cov_emt
) {

221 
AI_Des
[
dex
].
Chged
 = 
ue
;

222 
AI_Des
[
dex
].
Pri_Vue
 = 
vue
;

225 
	}
}

227 
	$Alog_Iut_P_Vue_S
(

228 
ut32_t
 
obje_
,

229 
vue
)

231 
dex
 = 0;

233 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

234 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

235 
	`Alog_Iut_COV_De
(
dex
, 
vue
);

236 
AI_Des
[
dex
].
P_Vue
 = 
vue
;

238 
	}
}

240 
bo
 
	$Alog_Iut_Obje_Name
(

241 
ut32_t
 
obje_
,

242 
BACNET_CHARACTER_STRING
 * 
obje_me
)

244 
xt_rg
[32] = "";

245 
dex
;

246 
bo
 
us
 = 
l
;

248 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

249 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

250 
	`rtf
(
xt_rg
, "ANALOG INPUT %lu", (
dex
);

251 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

254  
us
;

255 
	}
}

257 
bo
 
	$Alog_Iut_Chge_Of_Vue
(

258 
ut32_t
 
obje_
)

260 
dex
 = 0;

261 
bo
 
chged
 = 
l
;

263 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

264 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

265 
chged
 = 
AI_Des
[
dex
].
Chged
;

268  
chged
;

269 
	}
}

271 
	$Alog_Iut_Chge_Of_Vue_Cˬ
(

272 
ut32_t
 
obje_
)

274 
dex
 = 0;

276 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

277 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

278 
AI_Des
[
dex
].
Chged
 = 
l
;

280 
	}
}

290 
bo
 
	$Alog_Iut_Encode_Vue_Li
(

291 
ut32_t
 
obje_
,

292 
BACNET_PROPERTY_VALUE
 * 
vue_li
)

294 
bo
 
us
 = 
l
;

296 i(
vue_li
) {

297 
vue_li
->
ݔtyIdtifr
 = 
PROP_PRESENT_VALUE
;

298 
vue_li
->
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

299 
vue_li
->
vue
.
cڋxt_ecific
 = 
l
;

300 
vue_li
->
vue
.
g
 = 
BACNET_APPLICATION_TAG_REAL
;

301 
vue_li
->
vue
.
ty
.
Rl
 =

302 
	`Alog_Iut_P_Vue
(
obje_
);

303 
vue_li
->
vue
.
xt
 = 
NULL
;

304 
vue_li
->
iܙy
 = 
BACNET_NO_PRIORITY
;

305 
vue_li
 = vue_li->
xt
;

307 i(
vue_li
) {

308 
vue_li
->
ݔtyIdtifr
 = 
PROP_STATUS_FLAGS
;

309 
vue_li
->
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

310 
vue_li
->
vue
.
cڋxt_ecific
 = 
l
;

311 
vue_li
->
vue
.
g
 = 
BACNET_APPLICATION_TAG_BIT_STRING
;

312 
	`brg_
(&
vue_li
->
vue
.
ty
.
B_Sg
);

313 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

314 
STATUS_FLAG_IN_ALARM
, 
l
);

315 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

316 
STATUS_FLAG_FAULT
, 
l
);

317 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

318 
STATUS_FLAG_OVERRIDDEN
, 
l
);

319 i(
	`Alog_Iut_Out_Of_Svi
(
obje_
)) {

320 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

321 
STATUS_FLAG_OUT_OF_SERVICE
, 
ue
);

323 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

324 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

326 
vue_li
->
vue
.
xt
 = 
NULL
;

327 
vue_li
->
iܙy
 = 
BACNET_NO_PRIORITY
;

328 
vue_li
->
xt
 = 
NULL
;

329 
us
 = 
ue
;

332  
us
;

333 
	}
}

335 
	$Alog_Iut_COV_Inemt
(

336 
ut32_t
 
obje_
)

338 
dex
 = 0;

339 
vue
 = 0;

341 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

342 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

343 
vue
 = 
AI_Des
[
dex
].
COV_Inemt
;

346  
vue
;

347 
	}
}

349 
	$Alog_Iut_COV_Inemt_S
(

350 
ut32_t
 
obje_
,

351 
vue
)

353 
dex
 = 0;

355 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

356 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

357 
AI_Des
[
dex
].
COV_Inemt
 = 
vue
;

358 
	`Alog_Iut_COV_De
(
dex
, 
AI_Des
[dex].
P_Vue
);

360 
	}
}

362 
bo
 
	$Alog_Iut_Out_Of_Svi
(

363 
ut32_t
 
obje_
)

365 
dex
 = 0;

366 
bo
 
vue
 = 
l
;

368 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

369 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

370 
vue
 = 
AI_Des
[
dex
].
Out_Of_Svi
;

373  
vue
;

374 
	}
}

376 
	$Alog_Iut_Out_Of_Svi_S
(

377 
ut32_t
 
obje_
,

378 
bo
 
vue
)

380 
dex
 = 0;

382 
dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

383 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

384 i(
AI_Des
[
dex
].
Out_Of_Svi
 !
vue
) {

385 
AI_Des
[
dex
].
Chged
 = 
ue
;

387 
AI_Des
[
dex
].
Out_Of_Svi
 = 
vue
;

389 
	}
}

393 
	$Alog_Iut_Rd_Prݔty
(

394 
BACNET_READ_PROPERTY_DATA
 * 
da
)

396 
du_n
 = 0;

397 
BACNET_BIT_STRING
 
b_rg
;

398 
BACNET_CHARACTER_STRING
 
ch_rg
;

399 
ANALOG_INPUT_DESCR
 *
CutAI
;

400 
obje_dex
 = 0;

401 #i
	`defed
(
INTRINSIC_REPORTING
)

402 
i
 = 0;

403 
n
 = 0;

405 
ut8_t
 *
du
 = 
NULL
;

407 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

408 (
da
->
iti_da_n
 == 0)) {

412 
obje_dex
 = 
	`Alog_Iut_In_To_Index
(
da
->
obje_
);

413 i(
obje_dex
 < 
MAX_ANALOG_INPUTS
)

414 
CutAI
 = &
AI_Des
[
obje_dex
];

416  
BACNET_STATUS_ERROR
;

418 
du
 = 
da
->
iti_da
;

419 (
da
->
obje_ݔty
) {

420 
PROP_OBJECT_IDENTIFIER
:

421 
du_n
 =

422 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_INPUT
,

423 
da
->
obje_
);

426 
PROP_OBJECT_NAME
:

427 
PROP_DESCRIPTION
:

428 
	`Alog_Iut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

429 
du_n
 =

430 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

433 
PROP_OBJECT_TYPE
:

434 
du_n
 =

435 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_INPUT
);

438 
PROP_PRESENT_VALUE
:

439 
du_n
 =

440 
	`code_iti_
(&
du
[0],

441 
	`Alog_Iut_P_Vue
(
da
->
obje_
));

444 
PROP_STATUS_FLAGS
:

445 
	`brg_
(&
b_rg
);

446 #i
	`defed
(
INTRINSIC_REPORTING
)

447 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
,

448 
CutAI
->
Evt_S
 ? 
ue
 : 
l
);

450 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

452 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

453 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

454 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
,

455 
CutAI
->
Out_Of_Svi
);

457 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

460 
PROP_EVENT_STATE
:

461 #i
	`defed
(
INTRINSIC_REPORTING
)

462 
du_n
 =

463 
	`code_iti_umed
(&
du
[0],

464 
CutAI
->
Evt_S
);

466 
du_n
 =

467 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

471 
PROP_RELIABILITY
:

472 
du_n
 =

473 
	`code_iti_umed
(&
du
[0],

474 
CutAI
->
Rby
);

477 
PROP_OUT_OF_SERVICE
:

478 
du_n
 =

479 
	`code_iti_boޗn
(&
du
[0],

480 
CutAI
->
Out_Of_Svi
);

483 
PROP_UNITS
:

484 
du_n
 =

485 
	`code_iti_umed
(&
du
[0], 
CutAI
->
Uns
);

488 
PROP_COV_INCREMENT
:

489 
du_n
 = 
	`code_iti_
(&
du
[0],

490 
CutAI
->
COV_Inemt
);

493 #i
	`defed
(
INTRINSIC_REPORTING
)

494 
PROP_TIME_DELAY
:

495 
du_n
 =

496 
	`code_iti_unsigd
(&
du
[0], 
CutAI
->
Time_Day
);

499 
PROP_NOTIFICATION_CLASS
:

500 
du_n
 =

501 
	`code_iti_unsigd
(&
du
[0],

502 
CutAI
->
Nifiti_Css
);

505 
PROP_HIGH_LIMIT
:

506 
du_n
 =

507 
	`code_iti_
(&
du
[0], 
CutAI
->
High_Lim
);

510 
PROP_LOW_LIMIT
:

511 
du_n
 = 
	`code_iti_
(&
du
[0], 
CutAI
->
Low_Lim
);

514 
PROP_DEADBAND
:

515 
du_n
 = 
	`code_iti_
(&
du
[0], 
CutAI
->
Ddbd
);

518 
PROP_LIMIT_ENABLE
:

519 
	`brg_
(&
b_rg
);

520 
	`brg_t_b
(&
b_rg
, 0,

521 (
CutAI
->

522 
Lim_Eb
 & 
EVENT_LOW_LIMIT_ENABLE
? 
ue
 : 
l
);

523 
	`brg_t_b
(&
b_rg
, 1,

524 (
CutAI
->

525 
Lim_Eb
 & 
EVENT_HIGH_LIMIT_ENABLE
? 
ue
 : 
l
);

527 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

530 
PROP_EVENT_ENABLE
:

531 
	`brg_
(&
b_rg
);

532 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_OFFNORMAL
,

533 (
CutAI
->

534 
Evt_Eb
 & 
EVENT_ENABLE_TO_OFFNORMAL
? 
ue
 : 
l
);

535 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_FAULT
,

536 (
CutAI
->

537 
Evt_Eb
 & 
EVENT_ENABLE_TO_FAULT
? 
ue
 : 
l
);

538 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_NORMAL
,

539 (
CutAI
->

540 
Evt_Eb
 & 
EVENT_ENABLE_TO_NORMAL
? 
ue
 : 
l
);

542 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

545 
PROP_ACKED_TRANSITIONS
:

546 
	`brg_
(&
b_rg
);

547 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_OFFNORMAL
,

548 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

549 
bIsAcked
);

550 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_FAULT
,

551 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
);

552 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_NORMAL
,

553 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
);

555 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

558 
PROP_NOTIFY_TYPE
:

559 
du_n
 =

560 
	`code_iti_umed
(&
du
[0],

561 
CutAI
->
Nify_Ty
 ? 
NOTIFY_EVENT
 : 
NOTIFY_ALARM
);

564 
PROP_EVENT_TIME_STAMPS
:

566 i(
da
->
y_dex
 == 0)

567 
du_n
 =

568 
	`code_iti_unsigd
(&
du
[0],

569 
MAX_BACNET_EVENT_TRANSITION
);

572 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

573 
i
 = 0; i < 
MAX_BACNET_EVENT_TRANSITION
; i++) {;

574 
n
 =

575 
	`code_ݒg_g
(&
du
[
du_n
],

576 
TIME_STAMP_DATETIME
);

577 
n
 +=

578 
	`code_iti_de
(&
du
[
du_n
 + 
n
],

579 &
CutAI
->
Evt_Time_Smps
[
i
].
de
);

580 
n
 +=

581 
	`code_iti_time
(&
du
[
du_n
 + 
n
],

582 &
CutAI
->
Evt_Time_Smps
[
i
].
time
);

583 
n
 +=

584 
	`code_osg_g
(&
du
[
du_n
 + 
n
],

585 
TIME_STAMP_DATETIME
);

588 i((
du_n
 + 
n
< 
MAX_APDU
)

589 
du_n
 +
n
;

591 
da
->
r_code
 =

592 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

593 
du_n
 = 
BACNET_STATUS_ABORT
;

597 } i(
da
->
y_dex
 <
MAX_BACNET_EVENT_TRANSITION
) {

598 
du_n
 =

599 
	`code_ݒg_g
(&
du
[
du_n
], 
TIME_STAMP_DATETIME
);

600 
du_n
 +=

601 
	`code_iti_de
(&
du
[
du_n
],

602 &
CutAI
->
Evt_Time_Smps
[
da
->
y_dex
].
de
);

603 
du_n
 +=

604 
	`code_iti_time
(&
du
[
du_n
],

605 &
CutAI
->
Evt_Time_Smps
[
da
->
y_dex
].
time
);

606 
du_n
 +=

607 
	`code_osg_g
(&
du
[
du_n
], 
TIME_STAMP_DATETIME
);

609 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

610 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

611 
du_n
 = 
BACNET_STATUS_ERROR
;

618 
du_n
 = 
	`code_iti_
(&
du
[0], 90.510F);

622 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 90);

626 
du_n
 = 
	`code_iti_sigd
(&
du
[0], -200);

629 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

630 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

631 
du_n
 = 
BACNET_STATUS_ERROR
;

635 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
)

636 && (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

637 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

638 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

639 
du_n
 = 
BACNET_STATUS_ERROR
;

642  
du_n
;

643 
	}
}

646 
bo
 
	$Alog_Iut_Wre_Prݔty
(

647 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

649 
bo
 
us
 = 
l
;

650 
obje_dex
 = 0;

651 
n
 = 0;

652 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

653 
ANALOG_INPUT_DESCR
 *
CutAI
;

656 
n
 =

657 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

658 
wp_da
->
iti_da_n
, &
vue
);

660 i(
n
 < 0) {

662 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

663 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

664  
l
;

667 i((
wp_da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
) &&

668 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

669 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

670 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

671  
l
;

673 
obje_dex
 = 
	`Alog_Iut_In_To_Index
(
wp_da
->
obje_
);

674 i(
obje_dex
 < 
MAX_ANALOG_INPUTS
) {

675 
CutAI
 = &
AI_Des
[
obje_dex
];

677  
l
;

680 (
wp_da
->
obje_ݔty
) {

681 
PROP_PRESENT_VALUE
:

682 
us
 =

683 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_REAL
,

684 &
wp_da
->
r_ass
, &wp_da->
r_code
);

686 i(
us
) {

687 i(
CutAI
->
Out_Of_Svi
 =
ue
) {

688 
	`Alog_Iut_P_Vue_S
(
wp_da
->
obje_
,

689 
vue
.
ty
.
Rl
);

691 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

692 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

693 
us
 = 
l
;

698 
PROP_OUT_OF_SERVICE
:

699 
us
 =

700 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

701 &
wp_da
->
r_ass
, &wp_da->
r_code
);

702 i(
us
) {

703 
	`Alog_Iut_Out_Of_Svi_S
(

704 
wp_da
->
obje_
,

705 
vue
.
ty
.
Boޗn
);

709 
PROP_UNITS
:

710 
us
 =

711 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

712 &
wp_da
->
r_ass
, &wp_da->
r_code
);

713 i(
us
) {

714 
CutAI
->
Uns
 = 
vue
.
ty
.
Enumed
;

718 
PROP_COV_INCREMENT
:

719 
us
 =

720 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_REAL
,

721 &
wp_da
->
r_ass
, &wp_da->
r_code
);

722 i(
us
) {

723 i(
vue
.
ty
.
Rl
 >= 0.0) {

724 
	`Alog_Iut_COV_Inemt_S
(

725 
wp_da
->
obje_
,

726 
vue
.
ty
.
Rl
);

728 
us
 = 
l
;

729 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

730 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

735 #i
	`defed
(
INTRINSIC_REPORTING
)

736 
PROP_TIME_DELAY
:

737 
us
 =

738 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

739 &
wp_da
->
r_ass
, &wp_da->
r_code
);

741 i(
us
) {

742 
CutAI
->
Time_Day
 = 
vue
.
ty
.
Unsigd_I
;

743 
CutAI
->
Remag_Time_Day
 = CutAI->
Time_Day
;

747 
PROP_NOTIFICATION_CLASS
:

748 
us
 =

749 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

750 &
wp_da
->
r_ass
, &wp_da->
r_code
);

752 i(
us
) {

753 
CutAI
->
Nifiti_Css
 = 
vue
.
ty
.
Unsigd_I
;

757 
PROP_HIGH_LIMIT
:

758 
us
 =

759 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_REAL
,

760 &
wp_da
->
r_ass
, &wp_da->
r_code
);

762 i(
us
) {

763 
CutAI
->
High_Lim
 = 
vue
.
ty
.
Rl
;

767 
PROP_LOW_LIMIT
:

768 
us
 =

769 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_REAL
,

770 &
wp_da
->
r_ass
, &wp_da->
r_code
);

772 i(
us
) {

773 
CutAI
->
Low_Lim
 = 
vue
.
ty
.
Rl
;

777 
PROP_DEADBAND
:

778 
us
 =

779 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_REAL
,

780 &
wp_da
->
r_ass
, &wp_da->
r_code
);

782 i(
us
) {

783 
CutAI
->
Ddbd
 = 
vue
.
ty
.
Rl
;

787 
PROP_LIMIT_ENABLE
:

788 
us
 =

789 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BIT_STRING
,

790 &
wp_da
->
r_ass
, &wp_da->
r_code
);

792 i(
us
) {

793 i(
vue
.
ty
.
B_Sg
.
bs_ud
 == 2) {

794 
CutAI
->
Lim_Eb
 = 
vue
.
ty
.
B_Sg
.value[0];

796 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

797 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

798 
us
 = 
l
;

803 
PROP_EVENT_ENABLE
:

804 
us
 =

805 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BIT_STRING
,

806 &
wp_da
->
r_ass
, &wp_da->
r_code
);

808 i(
us
) {

809 i(
vue
.
ty
.
B_Sg
.
bs_ud
 == 3) {

810 
CutAI
->
Evt_Eb
 = 
vue
.
ty
.
B_Sg
.value[0];

812 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

813 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

814 
us
 = 
l
;

819 
PROP_NOTIFY_TYPE
:

820 
us
 =

821 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

822 &
wp_da
->
r_ass
, &wp_da->
r_code
);

824 i(
us
) {

825 (
BACNET_NOTIFY_TYPE

vue
.
ty
.
Enumed
) {

826 
NOTIFY_EVENT
:

827 
CutAI
->
Nify_Ty
 = 1;

829 
NOTIFY_ALARM
:

830 
CutAI
->
Nify_Ty
 = 0;

833 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

834 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

835 
us
 = 
l
;

841 
PROP_OBJECT_IDENTIFIER
:

842 
PROP_OBJECT_NAME
:

843 
PROP_OBJECT_TYPE
:

844 
PROP_STATUS_FLAGS
:

845 
PROP_EVENT_STATE
:

846 
PROP_DESCRIPTION
:

847 
PROP_RELIABILITY
:

848 #i
	`defed
(
INTRINSIC_REPORTING
)

849 
PROP_ACKED_TRANSITIONS
:

850 
PROP_EVENT_TIME_STAMPS
:

855 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

856 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

859 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

860 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

864  
us
;

865 
	}
}

868 
	$Alog_Iut_Irsic_Rtg
(

869 
ut32_t
 
obje_
)

871 #i
	`defed
(
INTRINSIC_REPORTING
)

872 
BACNET_EVENT_NOTIFICATION_DATA
 
evt_da
;

873 
BACNET_CHARACTER_STRING
 
msgText
;

874 
ANALOG_INPUT_DESCR
 *
CutAI
;

875 
obje_dex
;

876 
ut8_t
 
FromS
 = 0;

877 
ut8_t
 
ToS
;

878 
ExededLim
 = 0.0f;

879 
PV
 = 0.0f;

880 
bo
 
SdNify
 = 
l
;

883 
obje_dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

884 i(
obje_dex
 < 
MAX_ANALOG_INPUTS
)

885 
CutAI
 = &
AI_Des
[
obje_dex
];

890 i(!
CutAI
->
Lim_Eb
)

894 i(
CutAI
->
Ack_nify_da
.
bSdAckNify
) {

896 
CutAI
->
Ack_nify_da
.
bSdAckNify
 = 
l
;

898 
ToS
 = 
CutAI
->
Ack_nify_da
.
EvtS
;

900 #i
PRINT_ENABLED


901 
	`rtf
(
dr
, "Send Acknotification for (%s,%d).\n",

902 
	`baext_obje_ty_me
(
OBJECT_ANALOG_INPUT
), 
obje_
);

905 
	`charg__si
(&
msgText
, "AckNotification");

908 
evt_da
.
nifyTy
 = 
NOTIFY_ACK_NOTIFICATION
;

911 
SdNify
 = 
ue
;

914 
PV
 = 
	`Alog_Iut_P_Vue
(
obje_
);

915 
FromS
 = 
CutAI
->
Evt_S
;

916 
CutAI
->
Evt_S
) {

917 
EVENT_STATE_NORMAL
:

923 i((
PV
 > 
CutAI
->
High_Lim
) &&

924 ((
CutAI
->
Lim_Eb
 & 
EVENT_HIGH_LIMIT_ENABLE
) ==

925 
EVENT_HIGH_LIMIT_ENABLE
) &&

926 ((
CutAI
->
Evt_Eb
 & 
EVENT_ENABLE_TO_OFFNORMAL
) ==

927 
EVENT_ENABLE_TO_OFFNORMAL
)) {

928 i(!
CutAI
->
Remag_Time_Day
)

929 
CutAI
->
Evt_S
 = 
EVENT_STATE_HIGH_LIMIT
;

931 
CutAI
->
Remag_Time_Day
--;

940 i((
PV
 < 
CutAI
->
Low_Lim
) &&

941 ((
CutAI
->
Lim_Eb
 & 
EVENT_LOW_LIMIT_ENABLE
) ==

942 
EVENT_LOW_LIMIT_ENABLE
) &&

943 ((
CutAI
->
Evt_Eb
 & 
EVENT_ENABLE_TO_OFFNORMAL
) ==

944 
EVENT_ENABLE_TO_OFFNORMAL
)) {

945 i(!
CutAI
->
Remag_Time_Day
)

946 
CutAI
->
Evt_S
 = 
EVENT_STATE_LOW_LIMIT
;

948 
CutAI
->
Remag_Time_Day
--;

952 
CutAI
->
Remag_Time_Day
 = CutAI->
Time_Day
;

955 
EVENT_STATE_HIGH_LIMIT
:

962 i((
PV
 < 
CutAI
->
High_Lim
 - CutAI->
Ddbd
)

963 && ((
CutAI
->
Lim_Eb
 & 
EVENT_HIGH_LIMIT_ENABLE
) ==

964 
EVENT_HIGH_LIMIT_ENABLE
) &&

965 ((
CutAI
->
Evt_Eb
 & 
EVENT_ENABLE_TO_NORMAL
) ==

966 
EVENT_ENABLE_TO_NORMAL
)) {

967 i(!
CutAI
->
Remag_Time_Day
)

968 
CutAI
->
Evt_S
 = 
EVENT_STATE_NORMAL
;

970 
CutAI
->
Remag_Time_Day
--;

974 
CutAI
->
Remag_Time_Day
 = CutAI->
Time_Day
;

977 
EVENT_STATE_LOW_LIMIT
:

985 i((
PV
 > 
CutAI
->
Low_Lim
 + CutAI->
Ddbd
)

986 && ((
CutAI
->
Lim_Eb
 & 
EVENT_LOW_LIMIT_ENABLE
) ==

987 
EVENT_LOW_LIMIT_ENABLE
) &&

988 ((
CutAI
->
Evt_Eb
 & 
EVENT_ENABLE_TO_NORMAL
) ==

989 
EVENT_ENABLE_TO_NORMAL
)) {

990 i(!
CutAI
->
Remag_Time_Day
)

991 
CutAI
->
Evt_S
 = 
EVENT_STATE_NORMAL
;

993 
CutAI
->
Remag_Time_Day
--;

997 
CutAI
->
Remag_Time_Day
 = CutAI->
Time_Day
;

1004 
ToS
 = 
CutAI
->
Evt_S
;

1006 i(
FromS
 !
ToS
) {

1011 
ToS
) {

1012 
EVENT_STATE_HIGH_LIMIT
:

1013 
ExededLim
 = 
CutAI
->
High_Lim
;

1014 
	`charg__si
(&
msgText
, "Goeso highimit");

1017 
EVENT_STATE_LOW_LIMIT
:

1018 
ExededLim
 = 
CutAI
->
Low_Lim
;

1019 
	`charg__si
(&
msgText
, "Goesoowimit");

1022 
EVENT_STATE_NORMAL
:

1023 i(
FromS
 =
EVENT_STATE_HIGH_LIMIT
) {

1024 
ExededLim
 = 
CutAI
->
High_Lim
;

1025 
	`charg__si
(&
msgText
,

1028 
ExededLim
 = 
CutAI
->
Low_Lim
;

1029 
	`charg__si
(&
msgText
,

1035 
ExededLim
 = 0;

1039 #i
PRINT_ENABLED


1040 
	`rtf
(
dr
, "Event_State for (%s,%d) goes from %so %s.\n",

1041 
	`baext_obje_ty_me
(
OBJECT_ANALOG_INPUT
), 
obje_
,

1042 
	`baext_evt_e_me
(
FromS
),

1043 
	`baext_evt_e_me
(
ToS
));

1047 
evt_da
.
nifyTy
 = 
CutAI
->
Nify_Ty
;

1050 
SdNify
 = 
ue
;

1055 i(
SdNify
) {

1057 
evt_da
.
evtObjeIdtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

1058 
evt_da
.
evtObjeIdtifr
.

 = 
obje_
;

1061 
evt_da
.
timeSmp
.
g
 = 
TIME_STAMP_DATETIME
;

1062 
	`Devi_gCutDeTime
(&
evt_da
.
timeSmp
.
vue
.
deTime
);

1064 i(
evt_da
.
nifyTy
 !
NOTIFY_ACK_NOTIFICATION
) {

1066 
ToS
) {

1067 
EVENT_STATE_HIGH_LIMIT
:

1068 
EVENT_STATE_LOW_LIMIT
:

1069 
CutAI
->
Evt_Time_Smps
[
TRANSITION_TO_OFFNORMAL
] =

1070 
evt_da
.
timeSmp
.
vue
.
deTime
;

1073 
EVENT_STATE_FAULT
:

1074 
CutAI
->
Evt_Time_Smps
[
TRANSITION_TO_FAULT
] =

1075 
evt_da
.
timeSmp
.
vue
.
deTime
;

1078 
EVENT_STATE_NORMAL
:

1079 
CutAI
->
Evt_Time_Smps
[
TRANSITION_TO_NORMAL
] =

1080 
evt_da
.
timeSmp
.
vue
.
deTime
;

1086 
evt_da
.
nifitiCss
 = 
CutAI
->
Nifiti_Css
;

1089 
evt_da
.
evtTy
 = 
EVENT_OUT_OF_RANGE
;

1092 
evt_da
.
mesgeText
 = &
msgText
;

1098 i(
evt_da
.
nifyTy
 !
NOTIFY_ACK_NOTIFICATION
)

1099 
evt_da
.
omS
 = 
FromS
;

1102 
evt_da
.
toS
 = 
CutAI
->
Evt_S
;

1105 i(
evt_da
.
nifyTy
 !
NOTIFY_ACK_NOTIFICATION
) {

1107 
evt_da
.
nifitiPams
.
outOfRge
.
exedgVue
 =

1108 
PV
;

1110 
	`brg_
(&
evt_da
.
nifitiPams
.
outOfRge
.

1111 
usFgs
);

1112 
	`brg_t_b
(&
evt_da
.
nifitiPams
.
outOfRge
.

1113 
usFgs
, 
STATUS_FLAG_IN_ALARM
,

1114 
CutAI
->
Evt_S
 ? 
ue
 : 
l
);

1115 
	`brg_t_b
(&
evt_da
.
nifitiPams
.
outOfRge
.

1116 
usFgs
, 
STATUS_FLAG_FAULT
, 
l
);

1117 
	`brg_t_b
(&
evt_da
.
nifitiPams
.
outOfRge
.

1118 
usFgs
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

1119 
	`brg_t_b
(&
evt_da
.
nifitiPams
.
outOfRge
.

1120 
usFgs
, 
STATUS_FLAG_OUT_OF_SERVICE
,

1121 
CutAI
->
Out_Of_Svi
);

1123 
evt_da
.
nifitiPams
.
outOfRge
.
ddbd
 =

1124 
CutAI
->
Ddbd
;

1126 
evt_da
.
nifitiPams
.
outOfRge
.
exededLim
 =

1127 
ExededLim
;

1131 
	`Nifiti_Css_comm_ptg_funi
(&
evt_da
);

1134 i((
evt_da
.
nifyTy
 !
NOTIFY_ACK_NOTIFICATION
) &&

1135 (
evt_da
.
ackRequed
 =
ue
)) {

1136 
evt_da
.
toS
) {

1137 
EVENT_STATE_OFFNORMAL
:

1138 
EVENT_STATE_HIGH_LIMIT
:

1139 
EVENT_STATE_LOW_LIMIT
:

1140 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1141 
bIsAcked
 = 
l
;

1142 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1143 
Time_Smp
 = 
evt_da
.
timeSmp
.
vue
.
deTime
;

1146 
EVENT_STATE_FAULT
:

1147 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].

1148 
bIsAcked
 = 
l
;

1149 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].

1150 
Time_Smp
 = 
evt_da
.
timeSmp
.
vue
.
deTime
;

1153 
EVENT_STATE_NORMAL
:

1154 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].

1155 
bIsAcked
 = 
l
;

1156 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].

1157 
Time_Smp
 = 
evt_da
.
timeSmp
.
vue
.
deTime
;

1163 
	}
}

1166 #i
defed
(
INTRINSIC_REPORTING
)

1167 
	$Alog_Iut_Evt_Infmi
(

1168 
dex
,

1169 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
gevt_da
)

1171 
bo
 
IsNAckedTnsis
;

1172 
bo
 
IsAiveEvt
;

1173 
i
;

1177 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

1179 
IsAiveEvt
 = (
AI_Des
[
dex
].
Evt_S
 !
EVENT_STATE_NORMAL
);

1183 
IsNAckedTnsis
 =

1184 (
AI_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1185 
bIsAcked
 ==

1186 
l
| (
AI_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_FAULT
].

1187 
bIsAcked
 ==

1188 
l
| (
AI_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].

1189 
bIsAcked
 =
l
);

1193 i((
IsAiveEvt
|| (
IsNAckedTnsis
)) {

1195 
gevt_da
->
objeIdtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

1196 
gevt_da
->
objeIdtifr
.

 =

1197 
	`Alog_Iut_Index_To_In
(
dex
);

1199 
gevt_da
->
evtS
 = 
AI_Des
[
dex
].
Evt_S
;

1201 
	`brg_
(&
gevt_da
->
acknowdgedTnsis
);

1202 
	`brg_t_b
(&
gevt_da
->
acknowdgedTnsis
,

1203 
TRANSITION_TO_OFFNORMAL
,

1204 
AI_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1205 
bIsAcked
);

1206 
	`brg_t_b
(&
gevt_da
->
acknowdgedTnsis
,

1207 
TRANSITION_TO_FAULT
,

1208 
AI_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
);

1209 
	`brg_t_b
(&
gevt_da
->
acknowdgedTnsis
,

1210 
TRANSITION_TO_NORMAL
,

1211 
AI_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
);

1213 
i
 = 0; i < 3; i++) {

1214 
gevt_da
->
evtTimeSmps
[
i
].
g
 = 
TIME_STAMP_DATETIME
;

1215 
gevt_da
->
evtTimeSmps
[
i
].
vue
.
deTime
 =

1216 
AI_Des
[
dex
].
Evt_Time_Smps
[
i
];

1219 
gevt_da
->
nifyTy
 = 
AI_Des
[
dex
].
Nify_Ty
;

1221 
	`brg_
(&
gevt_da
->
evtEb
);

1222 
	`brg_t_b
(&
gevt_da
->
evtEb
, 
TRANSITION_TO_OFFNORMAL
,

1223 (
AI_Des
[
dex
].

1224 
Evt_Eb
 & 
EVENT_ENABLE_TO_OFFNORMAL
? 
ue
 : 
l
);

1225 
	`brg_t_b
(&
gevt_da
->
evtEb
, 
TRANSITION_TO_FAULT
,

1226 (
AI_Des
[
dex
].

1227 
Evt_Eb
 & 
EVENT_ENABLE_TO_FAULT
? 
ue
 : 
l
);

1228 
	`brg_t_b
(&
gevt_da
->
evtEb
, 
TRANSITION_TO_NORMAL
,

1229 (
AI_Des
[
dex
].

1230 
Evt_Eb
 & 
EVENT_ENABLE_TO_NORMAL
? 
ue
 : 
l
);

1232 
	`Nifiti_Css_G_Priܙs
(
AI_Des
[
dex
].
Nifiti_Css
,

1233 
gevt_da
->
evtPriܙs
);

1238 
	}
}

1241 
	$Alog_Iut_Arm_Ack
(

1242 
BACNET_ALARM_ACK_DATA
 * 
mack_da
,

1243 
BACNET_ERROR_CODE
 * 
r_code
)

1245 
ANALOG_INPUT_DESCR
 *
CutAI
;

1246 
obje_dex
;

1249 
obje_dex
 =

1250 
	`Alog_Iut_In_To_Index
(
mack_da
->
evtObjeIdtifr
.

1251 

);

1253 i(
obje_dex
 < 
MAX_ANALOG_INPUTS
)

1254 
CutAI
 = &
AI_Des
[
obje_dex
];

1256 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1260 
mack_da
->
evtSAcked
) {

1261 
EVENT_STATE_OFFNORMAL
:

1262 
EVENT_STATE_HIGH_LIMIT
:

1263 
EVENT_STATE_LOW_LIMIT
:

1264 i(
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1265 
bIsAcked
 =
l
) {

1266 i(
mack_da
->
evtTimeSmp
.
g
 !
TIME_STAMP_DATETIME
) {

1267 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1270 i(
	`dime_com
(&
CutAI
->

1271 
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].
Time_Smp
,

1272 &
mack_da
->
evtTimeSmp
.
vue
.
deTime
) > 0) {

1273 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1278 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1279 
bIsAcked
 = 
ue
;

1281 *
r_code
 = 
ERROR_CODE_INVALID_EVENT_STATE
;

1286 
EVENT_STATE_FAULT
:

1287 i(
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
 ==

1288 
l
) {

1289 i(
mack_da
->
evtTimeSmp
.
g
 !
TIME_STAMP_DATETIME
) {

1290 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1293 i(
	`dime_com
(&
CutAI
->

1294 
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
Time_Smp
,

1295 &
mack_da
->
evtTimeSmp
.
vue
.
deTime
) > 0) {

1296 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1301 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
 =

1302 
ue
;

1304 *
r_code
 = 
ERROR_CODE_INVALID_EVENT_STATE
;

1309 
EVENT_STATE_NORMAL
:

1310 i(
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
 ==

1311 
l
) {

1312 i(
mack_da
->
evtTimeSmp
.
g
 !
TIME_STAMP_DATETIME
) {

1313 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1316 i(
	`dime_com
(&
CutAI
->

1317 
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
Time_Smp
,

1318 &
mack_da
->
evtTimeSmp
.
vue
.
deTime
) > 0) {

1319 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1324 
CutAI
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
 =

1325 
ue
;

1327 *
r_code
 = 
ERROR_CODE_INVALID_EVENT_STATE
;

1335 
CutAI
->
Ack_nify_da
.
bSdAckNify
 = 
ue
;

1336 
CutAI
->
Ack_nify_da
.
EvtS
 = 
mack_da
->
evtSAcked
;

1339 
	}
}

1341 
	$Alog_Iut_Arm_Summy
(

1342 
dex
,

1343 
BACNET_GET_ALARM_SUMMARY_DATA
 * 
gm_da
)

1347 i(
dex
 < 
MAX_ANALOG_INPUTS
) {

1350 i((
AI_Des
[
dex
].
Evt_S
 !
EVENT_STATE_NORMAL
) &&

1351 (
AI_Des
[
dex
].
Nify_Ty
 =
NOTIFY_ALARM
)) {

1353 
gm_da
->
objeIdtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

1354 
gm_da
->
objeIdtifr
.

 =

1355 
	`Alog_Iut_Index_To_In
(
dex
);

1357 
gm_da
->
mS
 = 
AI_Des
[
dex
].
Evt_S
;

1359 
	`brg_
(&
gm_da
->
acknowdgedTnsis
);

1360 
	`brg_t_b
(&
gm_da
->
acknowdgedTnsis
,

1361 
TRANSITION_TO_OFFNORMAL
,

1362 
AI_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1363 
bIsAcked
);

1364 
	`brg_t_b
(&
gm_da
->
acknowdgedTnsis
,

1365 
TRANSITION_TO_FAULT
,

1366 
AI_Des
[
dex
].

1367 
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
);

1368 
	`brg_t_b
(&
gm_da
->
acknowdgedTnsis
,

1369 
TRANSITION_TO_NORMAL
,

1370 
AI_Des
[
dex
].

1371 
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
);

1378 
	}
}

1382 #ifde
TEST


1383 
	~<as.h
>

1384 
	~<rg.h
>

1385 
	~"e.h
"

1387 
bo
 
	$WPVideArgTy
(

1388 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

1389 
ut8_t
 
ucExedTag
,

1390 
BACNET_ERROR_CLASS
 * 
pECss
,

1391 
BACNET_ERROR_CODE
 * 
pECode
)

1393 
bo
 
bResu
;

1399 
bResu
 = 
ue
;

1400 i(
pVue
->
g
 !
ucExedTag
) {

1401 
bResu
 = 
l
;

1402 *
pECss
 = 
ERROR_CLASS_PROPERTY
;

1403 *
pECode
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

1406  (
bResu
);

1407 
	}
}

1409 
	$AlogIut
(

1410 
Te
 * 
pTe
)

1412 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

1413 
n
 = 0;

1414 
ut32_t
 
n_vue
 = 0;

1415 
ut8_t
 
g_numb
 = 0;

1416 
ut32_t
 
decoded_
 = 0;

1417 
ut16_t
 
decoded_ty
 = 0;

1418 
BACNET_READ_PROPERTY_DATA
 
da
;

1420 
	`Alog_Iut_In
();

1421 
da
.
iti_da
 = &
du
[0];

1422 
da
.
iti_da_n
 = (
du
);

1423 
da
.
obje_ty
 = 
OBJECT_ANALOG_INPUT
;

1424 
da
.
obje_
 = 1;

1425 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

1426 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1427 
n
 = 
	`Alog_Iut_Rd_Prݔty
(&
da
);

1428 
	`_
(
pTe
, 
n
 != 0);

1429 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

1430 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

1431 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

1432 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

1433 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

1436 
	}
}

1438 #ifde
TEST_ANALOG_INPUT


1439 
	$ma
(

1442 
Te
 *
pTe
;

1443 
bo
 
rc
;

1445 
pTe
 = 
	`_
("BACÈAlog Iut", 
NULL
);

1447 
rc
 = 
	`_addTeFuni
(
pTe
, 
AlogIut
);

1448 
	`as
(
rc
);

1450 
	`_tSm
(
pTe
, 
dout
);

1451 
	`_run
(
pTe
);

1452 (
	`_pt
(
pTe
);

1453 
	`_deroy
(
pTe
);

1456 
	}
}

	@demo/object/ai.h

26 #ide
AI_H


27 
	#AI_H


	)

29 
	~<dbo.h
>

30 
	~<dt.h
>

31 
	~"bacdef.h
"

32 
	~".h
"

33 
	~"wp.h
"

34 #i
defed
(
INTRINSIC_REPORTING
)

35 
	~"nc.h
"

36 
	~"gevt.h
"

37 
	~"m_ack.h
"

38 
	~"g_m_sum.h
"

41 #ifde
__lulus


45 
	sog_put_des
 {

46 
Evt_S
:3;

47 
P_Vue
;

48 
BACNET_RELIABILITY
 
Rby
;

49 
bo
 
Out_Of_Svi
;

50 
ut8_t
 
Uns
;

51 
Pri_Vue
;

52 
COV_Inemt
;

53 
bo
 
Chged
;

54 #i
defed
(
INTRINSIC_REPORTING
)

55 
ut32_t
 
Time_Day
;

56 
ut32_t
 
Nifiti_Css
;

57 
High_Lim
;

58 
Low_Lim
;

59 
Ddbd
;

60 
Lim_Eb
:2;

61 
Evt_Eb
:3;

62 
Nify_Ty
:1;

63 
ACKED_INFO
 
Acked_Tnsis
[
MAX_BACNET_EVENT_TRANSITION
];

64 
BACNET_DATE_TIME
 
Evt_Time_Smps
[
MAX_BACNET_EVENT_TRANSITION
];

66 
ut32_t
 
Remag_Time_Day
;

68 
ACK_NOTIFICATION
 
Ack_nify_da
;

70 } 
	tANALOG_INPUT_DESCR
;

72 
Alog_Iut_Prݔty_Lis
(

73 cڡ **
pRequed
,

74 cڡ **
pOiڮ
,

75 cڡ **
pPrrry
);

77 
bo
 
Alog_Iut_Vid_In
(

78 
ut32_t
 
obje_
);

79 
Alog_Iut_Cou
(

81 
ut32_t
 
Alog_Iut_Index_To_In
(

82 
dex
);

83 
Alog_Iut_In_To_Index
(

84 
ut32_t
 

);

85 
bo
 
Alog_Iut_Obje_In_Add
(

86 
ut32_t
 

);

88 
bo
 
Alog_Iut_Obje_Name
(

89 
ut32_t
 
obje_
,

90 
BACNET_CHARACTER_STRING
 * 
obje_me
);

91 
bo
 
Alog_Iut_Name_S
(

92 
ut32_t
 
obje_
,

93 *
w_me
);

95 *
Alog_Iut_Desti
(

96 
ut32_t
 

);

97 
bo
 
Alog_Iut_Desti_S
(

98 
ut32_t
 

,

99 *
w_me
);

101 
bo
 
Alog_Iut_Uns_S
(

102 
ut32_t
 

,

103 
ut16_t
 
uns
);

104 
ut16_t
 
Alog_Iut_Uns
(

105 
ut32_t
 

);

107 
Alog_Iut_Rd_Prݔty
(

108 
BACNET_READ_PROPERTY_DATA
 * 
da
);

109 
bo
 
Alog_Iut_Wre_Prݔty
(

110 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

112 
Alog_Iut_P_Vue
(

113 
ut32_t
 
obje_
);

114 
Alog_Iut_P_Vue_S
(

115 
ut32_t
 
obje_
,

116 
vue
);

118 
bo
 
Alog_Iut_Out_Of_Svi
(

119 
ut32_t
 
obje_
);

120 
Alog_Iut_Out_Of_Svi_S
(

121 
ut32_t
 
obje_
,

122 
bo
 
oos_ag
);

124 
bo
 
Alog_Iut_Chge_Of_Vue
(

125 
ut32_t
 

);

126 
Alog_Iut_Chge_Of_Vue_Cˬ
(

127 
ut32_t
 

);

128 
bo
 
Alog_Iut_Encode_Vue_Li
(

129 
ut32_t
 
obje_
,

130 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

131 
Alog_Iut_COV_Inemt
(

132 
ut32_t
 

);

133 
Alog_Iut_COV_Inemt_S
(

134 
ut32_t
 

,

135 
vue
);

139 
Alog_Iut_Irsic_Rtg
(

140 
ut32_t
 
obje_
);

142 #i
defed
(
INTRINSIC_REPORTING
)

143 
Alog_Iut_Evt_Infmi
(

144 
dex
,

145 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
gevt_da
);

147 
Alog_Iut_Arm_Ack
(

148 
BACNET_ALARM_ACK_DATA
 * 
mack_da
,

149 
BACNET_ERROR_CODE
 * 
r_code
);

151 
Alog_Iut_Arm_Summy
(

152 
dex
,

153 
BACNET_GET_ALARM_SUMMARY_DATA
 * 
gm_da
);

156 
bo
 
Alog_Iut_Ce
(

157 
ut32_t
 
obje_
);

158 
bo
 
Alog_Iut_De
(

159 
ut32_t
 
obje_
);

160 
Alog_Iut_C˪up
(

162 
Alog_Iut_In
(

165 #ifde
TEST


166 
	~"e.h
"

167 
AlogIut
(

168 
Te
 * 
pTe
);

171 #ifde
__lulus


	@demo/object/ao.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~"wp.h
"

37 
	~"ao.h
"

38 
	~"hdrs.h
"

40 #ide
MAX_ANALOG_OUTPUTS


41 
	#MAX_ANALOG_OUTPUTS
 4

	)

47 
	#AO_LEVEL_NULL
 255

	)

50 
	#AO_RELINQUISH_DEFAULT
 0

	)

54 
ut8_t
 
	gAlog_Ouut_Lev
[
MAX_ANALOG_OUTPUTS
][
BACNET_MAX_PRIORITY
];

57 
bo
 
	gOut_Of_Svi
[
MAX_ANALOG_OUTPUTS
];

60 
bo
 
	gAlog_Ouut_Inlized
 = 
l
;

63 cڡ 
	gPrݔts_Requed
[] = {

64 
PROP_OBJECT_IDENTIFIER
,

65 
PROP_OBJECT_NAME
,

66 
PROP_OBJECT_TYPE
,

67 
PROP_PRESENT_VALUE
,

68 
PROP_STATUS_FLAGS
,

69 
PROP_EVENT_STATE
,

70 
PROP_OUT_OF_SERVICE
,

71 
PROP_UNITS
,

72 
PROP_PRIORITY_ARRAY
,

73 
PROP_RELINQUISH_DEFAULT
,

77 cڡ 
	gPrݔts_Oiڮ
[] = {

81 cڡ 
	gPrݔts_Prrry
[] = {

85 
	$Alog_Ouut_Prݔty_Lis
(

86 cڡ **
pRequed
,

87 cڡ **
pOiڮ
,

88 cڡ **
pPrrry
)

90 i(
pRequed
)

91 *
pRequed
 = 
Prݔts_Requed
;

92 i(
pOiڮ
)

93 *
pOiڮ
 = 
Prݔts_Oiڮ
;

94 i(
pPrrry
)

95 *
pPrrry
 = 
Prݔts_Prrry
;

98 
	}
}

100 
	$Alog_Ouut_In
(

103 
i
, 
j
;

105 i(!
Alog_Ouut_Inlized
) {

106 
Alog_Ouut_Inlized
 = 
ue
;

109 
i
 = 0; i < 
MAX_ANALOG_OUTPUTS
; i++) {

110 
j
 = 0; j < 
BACNET_MAX_PRIORITY
; j++) {

111 
Alog_Ouut_Lev
[
i
][
j
] = 
AO_LEVEL_NULL
;

117 
	}
}

122 
bo
 
	$Alog_Ouut_Vid_In
(

123 
ut32_t
 
obje_
)

125 i(
obje_
 < 
MAX_ANALOG_OUTPUTS
)

126  
ue
;

128  
l
;

129 
	}
}

133 
	$Alog_Ouut_Cou
(

136  
MAX_ANALOG_OUTPUTS
;

137 
	}
}

142 
ut32_t
 
	$Alog_Ouut_Index_To_In
(

143 
dex
)

145  
dex
;

146 
	}
}

151 
	$Alog_Ouut_In_To_Index
(

152 
ut32_t
 
obje_
)

154 
dex
 = 
MAX_ANALOG_OUTPUTS
;

156 i(
obje_
 < 
MAX_ANALOG_OUTPUTS
)

157 
dex
 = 
obje_
;

159  
dex
;

160 
	}
}

162 
	$Alog_Ouut_P_Vue
(

163 
ut32_t
 
obje_
)

165 
vue
 = 
AO_RELINQUISH_DEFAULT
;

166 
dex
 = 0;

167 
i
 = 0;

169 
dex
 = 
	`Alog_Ouut_In_To_Index
(
obje_
);

170 i(
dex
 < 
MAX_ANALOG_OUTPUTS
) {

171 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

172 i(
Alog_Ouut_Lev
[
dex
][
i
] !
AO_LEVEL_NULL
) {

173 
vue
 = 
Alog_Ouut_Lev
[
dex
][
i
];

179  
vue
;

180 
	}
}

182 
	$Alog_Ouut_P_Vue_Priܙy
(

183 
ut32_t
 
obje_
)

185 
dex
 = 0;

186 
i
 = 0;

187 
iܙy
 = 0;

189 
dex
 = 
	`Alog_Ouut_In_To_Index
(
obje_
);

190 i(
dex
 < 
MAX_ANALOG_OUTPUTS
) {

191 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

192 i(
Alog_Ouut_Lev
[
dex
][
i
] !
AO_LEVEL_NULL
) {

193 
iܙy
 = 
i
 + 1;

199  
iܙy
;

200 
	}
}

202 
bo
 
	$Alog_Ouut_P_Vue_S
(

203 
ut32_t
 
obje_
,

204 
vue
,

205 
iܙy
)

207 
dex
 = 0;

208 
bo
 
us
 = 
l
;

210 
dex
 = 
	`Alog_Ouut_In_To_Index
(
obje_
);

211 i(
dex
 < 
MAX_ANALOG_OUTPUTS
) {

212 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

213 (
iܙy
 != 6 ) &&

214 (
vue
 >= 0.0) && (value <= 100.0)) {

215 
Alog_Ouut_Lev
[
dex
][
iܙy
 - 1] = (
ut8_t

vue
;

222 
us
 = 
ue
;

226  
us
;

227 
	}
}

229 
bo
 
	$Alog_Ouut_P_Vue_Rquish
(

230 
ut32_t
 
obje_
,

231 
iܙy
)

233 
dex
 = 0;

234 
bo
 
us
 = 
l
;

236 
dex
 = 
	`Alog_Ouut_In_To_Index
(
obje_
);

237 i(
dex
 < 
MAX_ANALOG_OUTPUTS
) {

238 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

239 (
iܙy
 != 6 )) {

240 
Alog_Ouut_Lev
[
dex
][
iܙy
 - 1] = 
AO_LEVEL_NULL
;

247 
us
 = 
ue
;

251  
us
;

252 
	}
}

255 
bo
 
	$Alog_Ouut_Obje_Name
(

256 
ut32_t
 
obje_
,

257 
BACNET_CHARACTER_STRING
 * 
obje_me
)

259 
xt_rg
[32] = "";

260 
bo
 
us
 = 
l
;

262 i(
obje_
 < 
MAX_ANALOG_OUTPUTS
) {

263 
	`rtf
(
xt_rg
, "ANALOG OUTPUT %lu",

264 (
obje_
);

265 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

268  
us
;

269 
	}
}

271 
bo
 
	$Alog_Ouut_Out_Of_Svi
(

272 
ut32_t
 

)

274 
dex
 = 0;

275 
bo
 
oos_ag
 = 
l
;

277 
dex
 = 
	`Alog_Ouut_In_To_Index
(

);

278 i(
dex
 < 
MAX_ANALOG_OUTPUTS
) {

279 
oos_ag
 = 
Out_Of_Svi
[
dex
];

282  
oos_ag
;

283 
	}
}

285 
	$Alog_Ouut_Out_Of_Svi_S
(

286 
ut32_t
 

,

287 
bo
 
oos_ag
)

289 
dex
 = 0;

291 
dex
 = 
	`Alog_Ouut_In_To_Index
(

);

292 i(
dex
 < 
MAX_ANALOG_OUTPUTS
) {

293 
Out_Of_Svi
[
dex
] = 
oos_ag
;

295 
	}
}

298 
	$Alog_Ouut_Rd_Prݔty
(

299 
BACNET_READ_PROPERTY_DATA
 * 
da
)

301 
n
 = 0;

302 
du_n
 = 0;

303 
BACNET_BIT_STRING
 
b_rg
;

304 
BACNET_CHARACTER_STRING
 
ch_rg
;

305 
_vue
 = () 1.414;

306 
obje_dex
 = 0;

307 
i
 = 0;

308 
bo
 
e
 = 
l
;

309 
ut8_t
 *
du
 = 
NULL
;

311 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

312 (
da
->
iti_da_n
 == 0)) {

315 
du
 = 
da
->
iti_da
;

316 
da
->
obje_ݔty
) {

317 
PROP_OBJECT_IDENTIFIER
:

318 
du_n
 =

319 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_OUTPUT
,

320 
da
->
obje_
);

322 
PROP_OBJECT_NAME
:

323 
	`Alog_Ouut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

324 
du_n
 =

325 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

327 
PROP_OBJECT_TYPE
:

328 
du_n
 =

329 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_OUTPUT
);

331 
PROP_PRESENT_VALUE
:

332 
_vue
 = 
	`Alog_Ouut_P_Vue
(
da
->
obje_
);

333 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

335 
PROP_STATUS_FLAGS
:

336 
	`brg_
(&
b_rg
);

337 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

338 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

339 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

340 
e
 = 
	`Alog_Ouut_Out_Of_Svi
(
da
->
obje_
);

341 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
e
);

342 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

344 
PROP_EVENT_STATE
:

345 
du_n
 =

346 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

348 
PROP_OUT_OF_SERVICE
:

349 
e
 = 
	`Alog_Ouut_Out_Of_Svi
(
da
->
obje_
);

350 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

352 
PROP_UNITS
:

353 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

355 
PROP_PRIORITY_ARRAY
:

357 i(
da
->
y_dex
 == 0)

358 
du_n
 =

359 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

362 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

363 
obje_dex
 =

364 
	`Alog_Ouut_In_To_Index
(
da
->
obje_
);

365 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

367 i(
Alog_Ouut_Lev
[
obje_dex
][
i
] =
AO_LEVEL_NULL
)

368 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

370 
_vue
 = 
Alog_Ouut_Lev
[
obje_dex
][
i
];

371 
n
 =

372 
	`code_iti_
(&
du
[
du_n
],

373 
_vue
);

376 i((
du_n
 + 
n
< 
MAX_APDU
)

377 
du_n
 +
n
;

379 
da
->
r_code
 =

380 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

381 
du_n
 = 
BACNET_STATUS_ABORT
;

386 
obje_dex
 =

387 
	`Alog_Ouut_In_To_Index
(
da
->
obje_
);

388 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

389 i(
Alog_Ouut_Lev
[
obje_dex
][
da
->
y_dex
 -

390 1] =
AO_LEVEL_NULL
)

391 
du_n
 = 
	`code_iti_nu
(&
du
[0]);

393 
_vue
 = 
Alog_Ouut_Lev
[
obje_dex
]

394 [
da
->
y_dex
 - 1];

395 
du_n
 =

396 
	`code_iti_
(&
du
[0], 
_vue
);

399 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

400 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

401 
du_n
 = 
BACNET_STATUS_ERROR
;

405 
PROP_RELINQUISH_DEFAULT
:

406 
_vue
 = 
AO_RELINQUISH_DEFAULT
;

407 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

410 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

411 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

412 
du_n
 = 
BACNET_STATUS_ERROR
;

416 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

417 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

418 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

419 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

420 
du_n
 = 
BACNET_STATUS_ERROR
;

423  
du_n
;

424 
	}
}

427 
bo
 
	$Alog_Ouut_Wre_Prݔty
(

428 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

430 
bo
 
us
 = 
l
;

431 
n
 = 0;

432 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

435 
n
 =

436 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

437 
wp_da
->
iti_da_n
, &
vue
);

439 i(
n
 < 0) {

441 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

442 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

443  
l
;

446 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

447 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

448 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

449 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

450  
l
;

452 
wp_da
->
obje_ݔty
) {

453 
PROP_PRESENT_VALUE
:

454 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_REAL
) {

458 
us
 =

459 
	`Alog_Ouut_P_Vue_S
(
wp_da
->
obje_
,

460 
vue
.
ty
.
Rl
, 
wp_da
->
iܙy
);

461 i(
wp_da
->
iܙy
 == 6) {

465 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

466 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

467 } i(!
us
) {

468 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

469 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

472 
us
 =

473 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_NULL
,

474 &
wp_da
->
r_ass
, &wp_da->
r_code
);

475 i(
us
) {

476 
us
 =

477 
Alog_Ouut_P_Vue_Rquish


478 (
wp_da
->
obje_
, wp_da->
iܙy
);

479 i(!
us
) {

480 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

481 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

486 
PROP_OUT_OF_SERVICE
:

487 
us
 =

488 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

489 &
wp_da
->
r_ass
, &wp_da->
r_code
);

490 i(
us
) {

491 
	`Alog_Ouut_Out_Of_Svi_S
(
wp_da
->
obje_
,

492 
vue
.
ty
.
Boޗn
);

495 
PROP_OBJECT_IDENTIFIER
:

496 
PROP_OBJECT_NAME
:

497 
PROP_OBJECT_TYPE
:

498 
PROP_STATUS_FLAGS
:

499 
PROP_EVENT_STATE
:

500 
PROP_UNITS
:

501 
PROP_PRIORITY_ARRAY
:

502 
PROP_RELINQUISH_DEFAULT
:

503 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

504 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

507 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

508 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

512  
us
;

513 
	}
}

516 #ifde
TEST


517 
	~<as.h
>

518 
	~<rg.h
>

519 
	~"e.h
"

521 
bo
 
	$WPVideArgTy
(

522 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

523 
ut8_t
 
ucExedTag
,

524 
BACNET_ERROR_CLASS
 * 
pECss
,

525 
BACNET_ERROR_CODE
 * 
pECode
)

527 
bo
 
bResu
;

533 
bResu
 = 
ue
;

534 i(
pVue
->
g
 !
ucExedTag
) {

535 
bResu
 = 
l
;

536 *
pECss
 = 
ERROR_CLASS_PROPERTY
;

537 *
pECode
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

540  (
bResu
);

541 
	}
}

543 
	$AlogOuut
(

544 
Te
 * 
pTe
)

546 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

547 
n
 = 0;

548 
ut32_t
 
n_vue
 = 0;

549 
ut8_t
 
g_numb
 = 0;

550 
ut32_t
 
decoded_
 = 0;

551 
ut16_t
 
decoded_ty
 = 0;

552 
BACNET_READ_PROPERTY_DATA
 
da
;

554 
	`Alog_Ouut_In
();

555 
da
.
iti_da
 = &
du
[0];

556 
da
.
iti_da_n
 = (
du
);

557 
da
.
obje_ty
 = 
OBJECT_ANALOG_OUTPUT
;

558 
da
.
obje_
 = 1;

559 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

560 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

561 
n
 = 
	`Alog_Ouut_Rd_Prݔty
(&
da
);

562 
	`_
(
pTe
, 
n
 != 0);

563 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

564 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

565 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

566 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

567 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

570 
	}
}

572 #ifde
TEST_ANALOG_OUTPUT


573 
	$ma
(

576 
Te
 *
pTe
;

577 
bo
 
rc
;

579 
pTe
 = 
	`_
("BACÈAlog Ouut", 
NULL
);

581 
rc
 = 
	`_addTeFuni
(
pTe
, 
AlogOuut
);

582 
	`as
(
rc
);

584 
	`_tSm
(
pTe
, 
dout
);

585 
	`_run
(
pTe
);

586 (
	`_pt
(
pTe
);

587 
	`_deroy
(
pTe
);

590 
	}
}

	@demo/object/ao.h

25 #ide
AO_H


26 
	#AO_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
Alog_Ouut_Prݔty_Lis
(

40 cڡ **
pRequed
,

41 cڡ **
pOiڮ
,

42 cڡ **
pPrrry
);

43 
bo
 
Alog_Ouut_Vid_In
(

44 
ut32_t
 
obje_
);

45 
Alog_Ouut_Cou
(

47 
ut32_t
 
Alog_Ouut_Index_To_In
(

48 
dex
);

49 
Alog_Ouut_In_To_Index
(

50 
ut32_t
 

);

51 
bo
 
Alog_Ouut_Obje_In_Add
(

52 
ut32_t
 

);

54 
Alog_Ouut_P_Vue
(

55 
ut32_t
 
obje_
);

56 
Alog_Ouut_P_Vue_Priܙy
(

57 
ut32_t
 
obje_
);

58 
bo
 
Alog_Ouut_P_Vue_S
(

59 
ut32_t
 
obje_
,

60 
vue
,

61 
iܙy
);

62 
bo
 
Alog_Ouut_P_Vue_Rquish
(

63 
ut32_t
 
obje_
,

64 
iܙy
);

66 
Alog_Ouut_Rquish_Deu
(

67 
ut32_t
 
obje_
);

68 
bo
 
Alog_Ouut_Rquish_Deu_S
(

69 
ut32_t
 
obje_
,

70 
vue
);

72 
bo
 
Alog_Ouut_Chge_Of_Vue
(

73 
ut32_t
 

);

74 
Alog_Ouut_Chge_Of_Vue_Cˬ
(

75 
ut32_t
 

);

76 
bo
 
Alog_Ouut_Encode_Vue_Li
(

77 
ut32_t
 
obje_
,

78 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

79 
Alog_Ouut_COV_Inemt
(

80 
ut32_t
 

);

81 
Alog_Ouut_COV_Inemt_S
(

82 
ut32_t
 

,

83 
vue
);

85 
bo
 
Alog_Ouut_Obje_Name
(

86 
ut32_t
 
obje_
,

87 
BACNET_CHARACTER_STRING
 * 
obje_me
);

88 
bo
 
Alog_Ouut_Name_S
(

89 
ut32_t
 
obje_
,

90 *
w_me
);

92 *
Alog_Ouut_Desti
(

93 
ut32_t
 

);

94 
bo
 
Alog_Ouut_Desti_S
(

95 
ut32_t
 

,

96 *
w_me
);

98 
bo
 
Alog_Ouut_Uns_S
(

99 
ut32_t
 

,

100 
ut16_t
 
uns
);

101 
ut16_t
 
Alog_Ouut_Uns
(

102 
ut32_t
 

);

104 
bo
 
Alog_Ouut_Out_Of_Svi
(

105 
ut32_t
 

);

106 
Alog_Ouut_Out_Of_Svi_S
(

107 
ut32_t
 

,

108 
bo
 
oos_ag
);

110 
Alog_Ouut_Rd_Prݔty
(

111 
BACNET_READ_PROPERTY_DATA
 * 
da
);

112 
bo
 
Alog_Ouut_Wre_Prݔty
(

113 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

115 
bo
 
Alog_Ouut_Ce
(

116 
ut32_t
 
obje_
);

117 
bo
 
Alog_Ouut_De
(

118 
ut32_t
 
obje_
);

119 
Alog_Ouut_C˪up
(

121 
Alog_Ouut_In
(

124 #ifde
TEST


125 
	~"e.h
"

126 
AlogOuut
(

127 
Te
 * 
pTe
);

130 #ifde
__lulus


	@demo/object/av.c

29 
	~<dbo.h
>

30 
	~<dt.h
>

31 
	~<dio.h
>

32 
	~<rg.h
>

34 
	~"bacdef.h
"

35 
	~"bacdcode.h
"

36 
	~"banum.h
"

37 
	~"ba.h
"

38 
	~"baext.h
"

39 
	~"cfig.h
"

40 
	~"devi.h
"

41 
	~"hdrs.h
"

42 
	~"av.h
"

45 #ide
MAX_ANALOG_VALUES


46 
	#MAX_ANALOG_VALUES
 4

	)

49 
ANALOG_VALUE_DESCR
 
	gAV_Des
[
MAX_ANALOG_VALUES
];

52 cڡ 
	gAlog_Vue_Prݔts_Requed
[] = {

53 
PROP_OBJECT_IDENTIFIER
,

54 
PROP_OBJECT_NAME
,

55 
PROP_OBJECT_TYPE
,

56 
PROP_PRESENT_VALUE
,

57 
PROP_STATUS_FLAGS
,

58 
PROP_EVENT_STATE
,

59 
PROP_OUT_OF_SERVICE
,

60 
PROP_UNITS
,

64 cڡ 
	gAlog_Vue_Prݔts_Oiڮ
[] = {

65 
PROP_DESCRIPTION
,

66 #i
defed
(
INTRINSIC_REPORTING
)

67 
PROP_TIME_DELAY
,

68 
PROP_NOTIFICATION_CLASS
,

69 
PROP_HIGH_LIMIT
,

70 
PROP_LOW_LIMIT
,

71 
PROP_DEADBAND
,

72 
PROP_LIMIT_ENABLE
,

73 
PROP_EVENT_ENABLE
,

74 
PROP_ACKED_TRANSITIONS
,

75 
PROP_NOTIFY_TYPE
,

76 
PROP_EVENT_TIME_STAMPS
,

81 cڡ 
	gAlog_Vue_Prݔts_Prrry
[] = {

85 
	$Alog_Vue_Prݔty_Lis
(

86 cڡ **
pRequed
,

87 cڡ **
pOiڮ
,

88 cڡ **
pPrrry
)

90 i(
pRequed
)

91 *
pRequed
 = 
Alog_Vue_Prݔts_Requed
;

92 i(
pOiڮ
)

93 *
pOiڮ
 = 
Alog_Vue_Prݔts_Oiڮ
;

94 i(
pPrrry
)

95 *
pPrrry
 = 
Alog_Vue_Prݔts_Prrry
;

98 
	}
}

100 
	$Alog_Vue_In
(

103 
i
;

104 #i
	`defed
(
INTRINSIC_REPORTING
)

105 
j
;

108 
i
 = 0; i < 
MAX_ANALOG_VALUES
; i++) {

109 
	`memt
(&
AV_Des
[
i
], 0x00, (
ANALOG_VALUE_DESCR
));

110 
AV_Des
[
i
].
P_Vue
 = 0.0;

111 
AV_Des
[
i
].
Uns
 = 
UNITS_NO_UNITS
;

112 #i
	`defed
(
INTRINSIC_REPORTING
)

113 
AV_Des
[
i
].
Evt_S
 = 
EVENT_STATE_NORMAL
;

115 
AV_Des
[
i
].
Nifiti_Css
 = 
BACNET_MAX_INSTANCE
;

118 
j
 = 0; j < 
MAX_BACNET_EVENT_TRANSITION
; j++) {

119 
	`dime_wdrd_t
(&
AV_Des
[
i
].
Evt_Time_Smps
[
j
]);

120 
AV_Des
[
i
].
Acked_Tnsis
[
j
].
bIsAcked
 = 
ue
;

124 
	`hdr_g_evt_fmi_t
(
OBJECT_ANALOG_VALUE
,

125 
Alog_Vue_Evt_Infmi
);

127 
	`hdr_m_ack_t
(
OBJECT_ANALOG_VALUE
, 
Alog_Vue_Arm_Ack
);

129 
	`hdr_g_m_summy_t
(
OBJECT_ANALOG_VALUE
,

130 
Alog_Vue_Arm_Summy
);

133 
	}
}

138 
bo
 
	$Alog_Vue_Vid_In
(

139 
ut32_t
 
obje_
)

141 i(
obje_
 < 
MAX_ANALOG_VALUES
)

142  
ue
;

144  
l
;

145 
	}
}

149 
	$Alog_Vue_Cou
(

152  
MAX_ANALOG_VALUES
;

153 
	}
}

158 
ut32_t
 
	$Alog_Vue_Index_To_In
(

159 
dex
)

161  
dex
;

162 
	}
}

167 
	$Alog_Vue_In_To_Index
(

168 
ut32_t
 
obje_
)

170 
dex
 = 
MAX_ANALOG_VALUES
;

172 i(
obje_
 < 
MAX_ANALOG_VALUES
)

173 
dex
 = 
obje_
;

175  
dex
;

176 
	}
}

188 
bo
 
	$Alog_Vue_P_Vue_S
(

189 
ut32_t
 
obje_
,

190 
vue
,

191 
ut8_t
 
iܙy
)

193 
dex
 = 0;

194 
bo
 
us
 = 
l
;

196 
dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

197 i(
dex
 < 
MAX_ANALOG_VALUES
) {

198 
AV_Des
[
dex
].
P_Vue
 = 
vue
;

199 
us
 = 
ue
;

201  
us
;

202 
	}
}

204 
	$Alog_Vue_P_Vue
(

205 
ut32_t
 
obje_
)

207 
vue
 = 0;

208 
dex
 = 0;

210 
dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

211 i(
dex
 < 
MAX_ANALOG_VALUES
) {

212 
vue
 = 
AV_Des
[
dex
].
P_Vue
;

215  
vue
;

216 
	}
}

219 
bo
 
	$Alog_Vue_Obje_Name
(

220 
ut32_t
 
obje_
,

221 
BACNET_CHARACTER_STRING
 * 
obje_me
)

223 
xt_rg
[32] = "";

224 
bo
 
us
 = 
l
;

226 i(
obje_
 < 
MAX_ANALOG_VALUES
) {

227 
	`rtf
(
xt_rg
, "ANALOG VALUE %lu",

228 (
obje_
);

229 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

232  
us
;

233 
	}
}

236 
	$Alog_Vue_Rd_Prݔty
(

237 
BACNET_READ_PROPERTY_DATA
 * 
da
)

239 
du_n
 = 0;

240 
BACNET_BIT_STRING
 
b_rg
;

241 
BACNET_CHARACTER_STRING
 
ch_rg
;

242 
_vue
 = () 1.414;

243 
obje_dex
 = 0;

244 
bo
 
e
 = 
l
;

245 
ut8_t
 *
du
 = 
NULL
;

246 
ANALOG_VALUE_DESCR
 *
CutAV
;

247 #i
	`defed
(
INTRINSIC_REPORTING
)

248 
n
 = 0;

249 
i
 = 0;

252 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

253 (
da
->
iti_da_n
 == 0)) {

257 
du
 = 
da
->
iti_da
;

259 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
da
->
obje_
);

260 i(
obje_dex
 < 
MAX_ANALOG_VALUES
)

261 
CutAV
 = &
AV_Des
[
obje_dex
];

263  
BACNET_STATUS_ERROR
;

265 
da
->
obje_ݔty
) {

266 
PROP_OBJECT_IDENTIFIER
:

267 
du_n
 =

268 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_VALUE
,

269 
da
->
obje_
);

272 
PROP_OBJECT_NAME
:

273 
PROP_DESCRIPTION
:

274 
	`Alog_Vue_Obje_Name
(
da
->
obje_
, &
ch_rg
);

275 
du_n
 =

276 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

279 
PROP_OBJECT_TYPE
:

280 
du_n
 =

281 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_VALUE
);

284 
PROP_PRESENT_VALUE
:

285 
_vue
 = 
	`Alog_Vue_P_Vue
(
da
->
obje_
);

286 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

289 
PROP_STATUS_FLAGS
:

290 
	`brg_
(&
b_rg
);

291 #i
	`defed
(
INTRINSIC_REPORTING
)

292 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
,

293 
CutAV
->
Evt_S
 ? 
ue
 : 
l
);

295 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

297 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

298 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

299 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
,

300 
CutAV
->
Out_Of_Svi
);

302 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

305 
PROP_EVENT_STATE
:

306 #i
	`defed
(
INTRINSIC_REPORTING
)

307 
du_n
 =

308 
	`code_iti_umed
(&
du
[0],

309 
CutAV
->
Evt_S
);

311 
du_n
 =

312 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

316 
PROP_OUT_OF_SERVICE
:

317 
e
 = 
CutAV
->
Out_Of_Svi
;

318 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

321 
PROP_UNITS
:

322 
du_n
 =

323 
	`code_iti_umed
(&
du
[0], 
CutAV
->
Uns
);

326 #i
	`defed
(
INTRINSIC_REPORTING
)

327 
PROP_TIME_DELAY
:

328 
du_n
 =

329 
	`code_iti_unsigd
(&
du
[0], 
CutAV
->
Time_Day
);

332 
PROP_NOTIFICATION_CLASS
:

333 
du_n
 =

334 
	`code_iti_unsigd
(&
du
[0],

335 
CutAV
->
Nifiti_Css
);

338 
PROP_HIGH_LIMIT
:

339 
du_n
 =

340 
	`code_iti_
(&
du
[0], 
CutAV
->
High_Lim
);

343 
PROP_LOW_LIMIT
:

344 
du_n
 = 
	`code_iti_
(&
du
[0], 
CutAV
->
Low_Lim
);

347 
PROP_DEADBAND
:

348 
du_n
 = 
	`code_iti_
(&
du
[0], 
CutAV
->
Ddbd
);

351 
PROP_LIMIT_ENABLE
:

352 
	`brg_
(&
b_rg
);

353 
	`brg_t_b
(&
b_rg
, 0,

354 (
CutAV
->

355 
Lim_Eb
 & 
EVENT_LOW_LIMIT_ENABLE
? 
ue
 : 
l
);

356 
	`brg_t_b
(&
b_rg
, 1,

357 (
CutAV
->

358 
Lim_Eb
 & 
EVENT_HIGH_LIMIT_ENABLE
? 
ue
 : 
l
);

360 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

363 
PROP_EVENT_ENABLE
:

364 
	`brg_
(&
b_rg
);

365 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_OFFNORMAL
,

366 (
CutAV
->

367 
Evt_Eb
 & 
EVENT_ENABLE_TO_OFFNORMAL
? 
ue
 : 
l
);

368 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_FAULT
,

369 (
CutAV
->

370 
Evt_Eb
 & 
EVENT_ENABLE_TO_FAULT
? 
ue
 : 
l
);

371 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_NORMAL
,

372 (
CutAV
->

373 
Evt_Eb
 & 
EVENT_ENABLE_TO_NORMAL
? 
ue
 : 
l
);

375 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

378 
PROP_ACKED_TRANSITIONS
:

379 
	`brg_
(&
b_rg
);

380 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_OFFNORMAL
,

381 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

382 
bIsAcked
);

383 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_FAULT
,

384 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
);

385 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_NORMAL
,

386 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
);

388 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

391 
PROP_NOTIFY_TYPE
:

392 
du_n
 =

393 
	`code_iti_umed
(&
du
[0],

394 
CutAV
->
Nify_Ty
 ? 
NOTIFY_EVENT
 : 
NOTIFY_ALARM
);

397 
PROP_EVENT_TIME_STAMPS
:

399 i(
da
->
y_dex
 == 0)

400 
du_n
 =

401 
	`code_iti_unsigd
(&
du
[0],

402 
MAX_BACNET_EVENT_TRANSITION
);

405 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

406 
i
 = 0; i < 
MAX_BACNET_EVENT_TRANSITION
; i++) {;

407 
n
 =

408 
	`code_ݒg_g
(&
du
[
du_n
],

409 
TIME_STAMP_DATETIME
);

410 
n
 +=

411 
	`code_iti_de
(&
du
[
du_n
 + 
n
],

412 &
CutAV
->
Evt_Time_Smps
[
i
].
de
);

413 
n
 +=

414 
	`code_iti_time
(&
du
[
du_n
 + 
n
],

415 &
CutAV
->
Evt_Time_Smps
[
i
].
time
);

416 
n
 +=

417 
	`code_osg_g
(&
du
[
du_n
 + 
n
],

418 
TIME_STAMP_DATETIME
);

421 i((
du_n
 + 
n
< 
MAX_APDU
)

422 
du_n
 +
n
;

424 
da
->
r_code
 =

425 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

426 
du_n
 = 
BACNET_STATUS_ABORT
;

430 } i(
da
->
y_dex
 <
MAX_BACNET_EVENT_TRANSITION
) {

431 
du_n
 =

432 
	`code_ݒg_g
(&
du
[
du_n
], 
TIME_STAMP_DATETIME
);

433 
du_n
 +=

434 
	`code_iti_de
(&
du
[
du_n
],

435 &
CutAV
->
Evt_Time_Smps
[
da
->
y_dex
].
de
);

436 
du_n
 +=

437 
	`code_iti_time
(&
du
[
du_n
],

438 &
CutAV
->
Evt_Time_Smps
[
da
->
y_dex
].
time
);

439 
du_n
 +=

440 
	`code_osg_g
(&
du
[
du_n
], 
TIME_STAMP_DATETIME
);

442 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

443 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

444 
du_n
 = 
BACNET_STATUS_ERROR
;

450 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

451 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

452 
du_n
 = 
BACNET_STATUS_ERROR
;

456 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

457 (
da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
) &&

458 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

459 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

460 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

461 
du_n
 = 
BACNET_STATUS_ERROR
;

464  
du_n
;

465 
	}
}

468 
bo
 
	$Alog_Vue_Wre_Prݔty
(

469 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

471 
bo
 
us
 = 
l
;

472 
obje_dex
 = 0;

473 
n
 = 0;

474 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

475 
ANALOG_VALUE_DESCR
 *
CutAV
;

478 
n
 =

479 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

480 
wp_da
->
iti_da_n
, &
vue
);

482 i(
n
 < 0) {

484 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

485 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

486  
l
;

488 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

489 (
wp_da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
) &&

490 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

492 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

493 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

494  
l
;

496 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
wp_da
->
obje_
);

497 i(
obje_dex
 < 
MAX_ANALOG_VALUES
)

498 
CutAV
 = &
AV_Des
[
obje_dex
];

500  
l
;

502 
wp_da
->
obje_ݔty
) {

503 
PROP_PRESENT_VALUE
:

504 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_REAL
) {

508 i(
	`Alog_Vue_P_Vue_S
(
wp_da
->
obje_
,

509 
vue
.
ty
.
Rl
, 
wp_da
->
iܙy
)) {

510 
us
 = 
ue
;

511 } i(
wp_da
->
iܙy
 == 6) {

515 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

516 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

518 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

519 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

522 
us
 = 
l
;

523 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

524 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

528 
PROP_OUT_OF_SERVICE
:

529 
us
 =

530 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

531 &
wp_da
->
r_ass
, &wp_da->
r_code
);

532 i(
us
) {

533 
CutAV
->
Out_Of_Svi
 = 
vue
.
ty
.
Boޗn
;

537 
PROP_UNITS
:

538 
us
 =

539 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

540 &
wp_da
->
r_ass
, &wp_da->
r_code
);

541 i(
us
) {

542 
CutAV
->
Uns
 = 
vue
.
ty
.
Enumed
;

546 #i
	`defed
(
INTRINSIC_REPORTING
)

547 
PROP_TIME_DELAY
:

548 
us
 =

549 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

550 &
wp_da
->
r_ass
, &wp_da->
r_code
);

552 i(
us
) {

553 
CutAV
->
Time_Day
 = 
vue
.
ty
.
Unsigd_I
;

554 
CutAV
->
Remag_Time_Day
 = CutAV->
Time_Day
;

558 
PROP_NOTIFICATION_CLASS
:

559 
us
 =

560 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

561 &
wp_da
->
r_ass
, &wp_da->
r_code
);

563 i(
us
) {

564 
CutAV
->
Nifiti_Css
 = 
vue
.
ty
.
Unsigd_I
;

568 
PROP_HIGH_LIMIT
:

569 
us
 =

570 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_REAL
,

571 &
wp_da
->
r_ass
, &wp_da->
r_code
);

573 i(
us
) {

574 
CutAV
->
High_Lim
 = 
vue
.
ty
.
Rl
;

578 
PROP_LOW_LIMIT
:

579 
us
 =

580 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_REAL
,

581 &
wp_da
->
r_ass
, &wp_da->
r_code
);

583 i(
us
) {

584 
CutAV
->
Low_Lim
 = 
vue
.
ty
.
Rl
;

588 
PROP_DEADBAND
:

589 
us
 =

590 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_REAL
,

591 &
wp_da
->
r_ass
, &wp_da->
r_code
);

593 i(
us
) {

594 
CutAV
->
Ddbd
 = 
vue
.
ty
.
Rl
;

598 
PROP_LIMIT_ENABLE
:

599 
us
 =

600 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BIT_STRING
,

601 &
wp_da
->
r_ass
, &wp_da->
r_code
);

603 i(
us
) {

604 i(
vue
.
ty
.
B_Sg
.
bs_ud
 == 2) {

605 
CutAV
->
Lim_Eb
 = 
vue
.
ty
.
B_Sg
.value[0];

607 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

608 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

609 
us
 = 
l
;

614 
PROP_EVENT_ENABLE
:

615 
us
 =

616 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BIT_STRING
,

617 &
wp_da
->
r_ass
, &wp_da->
r_code
);

619 i(
us
) {

620 i(
vue
.
ty
.
B_Sg
.
bs_ud
 == 3) {

621 
CutAV
->
Evt_Eb
 = 
vue
.
ty
.
B_Sg
.value[0];

623 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

624 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

625 
us
 = 
l
;

630 
PROP_NOTIFY_TYPE
:

631 
us
 =

632 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

633 &
wp_da
->
r_ass
, &wp_da->
r_code
);

635 i(
us
) {

636 (
BACNET_NOTIFY_TYPE

vue
.
ty
.
Enumed
) {

637 
NOTIFY_EVENT
:

638 
CutAV
->
Nify_Ty
 = 1;

640 
NOTIFY_ALARM
:

641 
CutAV
->
Nify_Ty
 = 0;

644 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

645 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

646 
us
 = 
l
;

652 
PROP_OBJECT_IDENTIFIER
:

653 
PROP_OBJECT_NAME
:

654 
PROP_OBJECT_TYPE
:

655 
PROP_STATUS_FLAGS
:

656 
PROP_EVENT_STATE
:

657 
PROP_DESCRIPTION
:

658 #i
	`defed
(
INTRINSIC_REPORTING
)

659 
PROP_ACKED_TRANSITIONS
:

660 
PROP_EVENT_TIME_STAMPS
:

662 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

663 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

665 
PROP_RELINQUISH_DEFAULT
:

666 
PROP_PRIORITY_ARRAY
:

668 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

669 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

673  
us
;

674 
	}
}

677 
	$Alog_Vue_Irsic_Rtg
(

678 
ut32_t
 
obje_
)

680 #i
	`defed
(
INTRINSIC_REPORTING
)

681 
BACNET_EVENT_NOTIFICATION_DATA
 
evt_da
;

682 
BACNET_CHARACTER_STRING
 
msgText
;

683 
ANALOG_VALUE_DESCR
 *
CutAV
;

684 
obje_dex
;

685 
ut8_t
 
FromS
 = 0;

686 
ut8_t
 
ToS
;

687 
ExededLim
 = 0.0f;

688 
PV
 = 0.0f;

689 
bo
 
SdNify
 = 
l
;

692 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

693 i(
obje_dex
 < 
MAX_ANALOG_VALUES
)

694 
CutAV
 = &
AV_Des
[
obje_dex
];

699 i(!
CutAV
->
Lim_Eb
)

703 i(
CutAV
->
Ack_nify_da
.
bSdAckNify
) {

705 
CutAV
->
Ack_nify_da
.
bSdAckNify
 = 
l
;

707 
ToS
 = 
CutAV
->
Ack_nify_da
.
EvtS
;

709 #i
PRINT_ENABLED


710 
	`rtf
(
dr
, "Send Acknotification for (%s,%d).\n",

711 
	`baext_obje_ty_me
(
OBJECT_ANALOG_VALUE
), 
obje_
);

714 
	`charg__si
(&
msgText
, "AckNotification");

717 
evt_da
.
nifyTy
 = 
NOTIFY_ACK_NOTIFICATION
;

720 
SdNify
 = 
ue
;

723 
PV
 = 
	`Alog_Vue_P_Vue
(
obje_
);

724 
FromS
 = 
CutAV
->
Evt_S
;

725 
CutAV
->
Evt_S
) {

726 
EVENT_STATE_NORMAL
:

732 i((
PV
 > 
CutAV
->
High_Lim
) &&

733 ((
CutAV
->
Lim_Eb
 & 
EVENT_HIGH_LIMIT_ENABLE
) ==

734 
EVENT_HIGH_LIMIT_ENABLE
) &&

735 ((
CutAV
->
Evt_Eb
 & 
EVENT_ENABLE_TO_OFFNORMAL
) ==

736 
EVENT_ENABLE_TO_OFFNORMAL
)) {

737 i(!
CutAV
->
Remag_Time_Day
)

738 
CutAV
->
Evt_S
 = 
EVENT_STATE_HIGH_LIMIT
;

740 
CutAV
->
Remag_Time_Day
--;

749 i((
PV
 < 
CutAV
->
Low_Lim
) &&

750 ((
CutAV
->
Lim_Eb
 & 
EVENT_LOW_LIMIT_ENABLE
) ==

751 
EVENT_LOW_LIMIT_ENABLE
) &&

752 ((
CutAV
->
Evt_Eb
 & 
EVENT_ENABLE_TO_OFFNORMAL
) ==

753 
EVENT_ENABLE_TO_OFFNORMAL
)) {

754 i(!
CutAV
->
Remag_Time_Day
)

755 
CutAV
->
Evt_S
 = 
EVENT_STATE_LOW_LIMIT
;

757 
CutAV
->
Remag_Time_Day
--;

761 
CutAV
->
Remag_Time_Day
 = CutAV->
Time_Day
;

764 
EVENT_STATE_HIGH_LIMIT
:

771 i((
PV
 < 
CutAV
->
High_Lim
 - CutAV->
Ddbd
)

772 && ((
CutAV
->
Lim_Eb
 & 
EVENT_HIGH_LIMIT_ENABLE
) ==

773 
EVENT_HIGH_LIMIT_ENABLE
) &&

774 ((
CutAV
->
Evt_Eb
 & 
EVENT_ENABLE_TO_NORMAL
) ==

775 
EVENT_ENABLE_TO_NORMAL
)) {

776 i(!
CutAV
->
Remag_Time_Day
)

777 
CutAV
->
Evt_S
 = 
EVENT_STATE_NORMAL
;

779 
CutAV
->
Remag_Time_Day
--;

783 
CutAV
->
Remag_Time_Day
 = CutAV->
Time_Day
;

786 
EVENT_STATE_LOW_LIMIT
:

794 i((
PV
 > 
CutAV
->
Low_Lim
 + CutAV->
Ddbd
)

795 && ((
CutAV
->
Lim_Eb
 & 
EVENT_LOW_LIMIT_ENABLE
) ==

796 
EVENT_LOW_LIMIT_ENABLE
) &&

797 ((
CutAV
->
Evt_Eb
 & 
EVENT_ENABLE_TO_NORMAL
) ==

798 
EVENT_ENABLE_TO_NORMAL
)) {

799 i(!
CutAV
->
Remag_Time_Day
)

800 
CutAV
->
Evt_S
 = 
EVENT_STATE_NORMAL
;

802 
CutAV
->
Remag_Time_Day
--;

806 
CutAV
->
Remag_Time_Day
 = CutAV->
Time_Day
;

813 
ToS
 = 
CutAV
->
Evt_S
;

815 i(
FromS
 !
ToS
) {

820 
ToS
) {

821 
EVENT_STATE_HIGH_LIMIT
:

822 
ExededLim
 = 
CutAV
->
High_Lim
;

823 
	`charg__si
(&
msgText
, "Goeso highimit");

826 
EVENT_STATE_LOW_LIMIT
:

827 
ExededLim
 = 
CutAV
->
Low_Lim
;

828 
	`charg__si
(&
msgText
, "Goesoowimit");

831 
EVENT_STATE_NORMAL
:

832 i(
FromS
 =
EVENT_STATE_HIGH_LIMIT
) {

833 
ExededLim
 = 
CutAV
->
High_Lim
;

834 
	`charg__si
(&
msgText
,

837 
ExededLim
 = 
CutAV
->
Low_Lim
;

838 
	`charg__si
(&
msgText
,

844 
ExededLim
 = 0;

848 #i
PRINT_ENABLED


849 
	`rtf
(
dr
, "Event_State for (%s,%d) goes from %so %s.\n",

850 
	`baext_obje_ty_me
(
OBJECT_ANALOG_VALUE
), 
obje_
,

851 
	`baext_evt_e_me
(
FromS
),

852 
	`baext_evt_e_me
(
ToS
));

856 
evt_da
.
nifyTy
 = 
CutAV
->
Nify_Ty
;

859 
SdNify
 = 
ue
;

864 i(
SdNify
) {

866 
evt_da
.
evtObjeIdtifr
.
ty
 = 
OBJECT_ANALOG_VALUE
;

867 
evt_da
.
evtObjeIdtifr
.

 = 
obje_
;

870 
evt_da
.
timeSmp
.
g
 = 
TIME_STAMP_DATETIME
;

871 
	`Devi_gCutDeTime
(&
evt_da
.
timeSmp
.
vue
.
deTime
);

873 i(
evt_da
.
nifyTy
 !
NOTIFY_ACK_NOTIFICATION
) {

875 
ToS
) {

876 
EVENT_STATE_HIGH_LIMIT
:

877 
EVENT_STATE_LOW_LIMIT
:

878 
CutAV
->
Evt_Time_Smps
[
TRANSITION_TO_OFFNORMAL
] =

879 
evt_da
.
timeSmp
.
vue
.
deTime
;

882 
EVENT_STATE_FAULT
:

883 
CutAV
->
Evt_Time_Smps
[
TRANSITION_TO_FAULT
] =

884 
evt_da
.
timeSmp
.
vue
.
deTime
;

887 
EVENT_STATE_NORMAL
:

888 
CutAV
->
Evt_Time_Smps
[
TRANSITION_TO_NORMAL
] =

889 
evt_da
.
timeSmp
.
vue
.
deTime
;

895 
evt_da
.
nifitiCss
 = 
CutAV
->
Nifiti_Css
;

898 
evt_da
.
evtTy
 = 
EVENT_OUT_OF_RANGE
;

901 
evt_da
.
mesgeText
 = &
msgText
;

907 i(
evt_da
.
nifyTy
 !
NOTIFY_ACK_NOTIFICATION
)

908 
evt_da
.
omS
 = 
FromS
;

911 
evt_da
.
toS
 = 
CutAV
->
Evt_S
;

914 i(
evt_da
.
nifyTy
 !
NOTIFY_ACK_NOTIFICATION
) {

916 
evt_da
.
nifitiPams
.
outOfRge
.
exedgVue
 =

917 
PV
;

919 
	`brg_
(&
evt_da
.
nifitiPams
.
outOfRge
.

920 
usFgs
);

921 
	`brg_t_b
(&
evt_da
.
nifitiPams
.
outOfRge
.

922 
usFgs
, 
STATUS_FLAG_IN_ALARM
,

923 
CutAV
->
Evt_S
 ? 
ue
 : 
l
);

924 
	`brg_t_b
(&
evt_da
.
nifitiPams
.
outOfRge
.

925 
usFgs
, 
STATUS_FLAG_FAULT
, 
l
);

926 
	`brg_t_b
(&
evt_da
.
nifitiPams
.
outOfRge
.

927 
usFgs
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

928 
	`brg_t_b
(&
evt_da
.
nifitiPams
.
outOfRge
.

929 
usFgs
, 
STATUS_FLAG_OUT_OF_SERVICE
,

930 
CutAV
->
Out_Of_Svi
);

932 
evt_da
.
nifitiPams
.
outOfRge
.
ddbd
 =

933 
CutAV
->
Ddbd
;

935 
evt_da
.
nifitiPams
.
outOfRge
.
exededLim
 =

936 
ExededLim
;

940 
	`Nifiti_Css_comm_ptg_funi
(&
evt_da
);

943 i((
evt_da
.
nifyTy
 !
NOTIFY_ACK_NOTIFICATION
) &&

944 (
evt_da
.
ackRequed
 =
ue
)) {

945 
evt_da
.
toS
) {

946 
EVENT_STATE_OFFNORMAL
:

947 
EVENT_STATE_HIGH_LIMIT
:

948 
EVENT_STATE_LOW_LIMIT
:

949 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

950 
bIsAcked
 = 
l
;

951 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

952 
Time_Smp
 = 
evt_da
.
timeSmp
.
vue
.
deTime
;

955 
EVENT_STATE_FAULT
:

956 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].

957 
bIsAcked
 = 
l
;

958 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].

959 
Time_Smp
 = 
evt_da
.
timeSmp
.
vue
.
deTime
;

962 
EVENT_STATE_NORMAL
:

963 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].

964 
bIsAcked
 = 
l
;

965 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].

966 
Time_Smp
 = 
evt_da
.
timeSmp
.
vue
.
deTime
;

972 
	}
}

975 #i
defed
(
INTRINSIC_REPORTING
)

976 
	$Alog_Vue_Evt_Infmi
(

977 
dex
,

978 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
gevt_da
)

980 
bo
 
IsNAckedTnsis
;

981 
bo
 
IsAiveEvt
;

982 
i
;

986 i(
dex
 < 
MAX_ANALOG_VALUES
) {

988 
IsAiveEvt
 = (
AV_Des
[
dex
].
Evt_S
 !
EVENT_STATE_NORMAL
);

992 
IsNAckedTnsis
 =

993 (
AV_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

994 
bIsAcked
 ==

995 
l
| (
AV_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_FAULT
].

996 
bIsAcked
 ==

997 
l
| (
AV_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].

998 
bIsAcked
 =
l
);

1002 i((
IsAiveEvt
|| (
IsNAckedTnsis
)) {

1004 
gevt_da
->
objeIdtifr
.
ty
 = 
OBJECT_ANALOG_VALUE
;

1005 
gevt_da
->
objeIdtifr
.

 =

1006 
	`Alog_Vue_Index_To_In
(
dex
);

1008 
gevt_da
->
evtS
 = 
AV_Des
[
dex
].
Evt_S
;

1010 
	`brg_
(&
gevt_da
->
acknowdgedTnsis
);

1011 
	`brg_t_b
(&
gevt_da
->
acknowdgedTnsis
,

1012 
TRANSITION_TO_OFFNORMAL
,

1013 
AV_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1014 
bIsAcked
);

1015 
	`brg_t_b
(&
gevt_da
->
acknowdgedTnsis
,

1016 
TRANSITION_TO_FAULT
,

1017 
AV_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
);

1018 
	`brg_t_b
(&
gevt_da
->
acknowdgedTnsis
,

1019 
TRANSITION_TO_NORMAL
,

1020 
AV_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
);

1022 
i
 = 0; i < 3; i++) {

1023 
gevt_da
->
evtTimeSmps
[
i
].
g
 = 
TIME_STAMP_DATETIME
;

1024 
gevt_da
->
evtTimeSmps
[
i
].
vue
.
deTime
 =

1025 
AV_Des
[
dex
].
Evt_Time_Smps
[
i
];

1028 
gevt_da
->
nifyTy
 = 
AV_Des
[
dex
].
Nify_Ty
;

1030 
	`brg_
(&
gevt_da
->
evtEb
);

1031 
	`brg_t_b
(&
gevt_da
->
evtEb
, 
TRANSITION_TO_OFFNORMAL
,

1032 (
AV_Des
[
dex
].

1033 
Evt_Eb
 & 
EVENT_ENABLE_TO_OFFNORMAL
? 
ue
 : 
l
);

1034 
	`brg_t_b
(&
gevt_da
->
evtEb
, 
TRANSITION_TO_FAULT
,

1035 (
AV_Des
[
dex
].

1036 
Evt_Eb
 & 
EVENT_ENABLE_TO_FAULT
? 
ue
 : 
l
);

1037 
	`brg_t_b
(&
gevt_da
->
evtEb
, 
TRANSITION_TO_NORMAL
,

1038 (
AV_Des
[
dex
].

1039 
Evt_Eb
 & 
EVENT_ENABLE_TO_NORMAL
? 
ue
 : 
l
);

1041 
	`Nifiti_Css_G_Priܙs
(
AV_Des
[
dex
].
Nifiti_Css
,

1042 
gevt_da
->
evtPriܙs
);

1047 
	}
}

1049 
	$Alog_Vue_Arm_Ack
(

1050 
BACNET_ALARM_ACK_DATA
 * 
mack_da
,

1051 
BACNET_ERROR_CODE
 * 
r_code
)

1053 
ANALOG_VALUE_DESCR
 *
CutAV
;

1054 
obje_dex
;

1057 
obje_dex
 =

1058 
	`Alog_Vue_In_To_Index
(
mack_da
->
evtObjeIdtifr
.

1059 

);

1061 i(
obje_dex
 < 
MAX_ANALOG_VALUES
)

1062 
CutAV
 = &
AV_Des
[
obje_dex
];

1064 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1068 
mack_da
->
evtSAcked
) {

1069 
EVENT_STATE_OFFNORMAL
:

1070 
EVENT_STATE_HIGH_LIMIT
:

1071 
EVENT_STATE_LOW_LIMIT
:

1072 i(
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1073 
bIsAcked
 =
l
) {

1074 i(
mack_da
->
evtTimeSmp
.
g
 !
TIME_STAMP_DATETIME
) {

1075 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1078 i(
	`dime_com
(&
CutAV
->

1079 
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].
Time_Smp
,

1080 &
mack_da
->
evtTimeSmp
.
vue
.
deTime
) > 0) {

1081 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1086 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1087 
bIsAcked
 = 
ue
;

1089 *
r_code
 = 
ERROR_CODE_INVALID_EVENT_STATE
;

1094 
EVENT_STATE_FAULT
:

1095 i(
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
 ==

1096 
l
) {

1097 i(
mack_da
->
evtTimeSmp
.
g
 !
TIME_STAMP_DATETIME
) {

1098 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1101 i(
	`dime_com
(&
CutAV
->

1102 
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
Time_Smp
,

1103 &
mack_da
->
evtTimeSmp
.
vue
.
deTime
) > 0) {

1104 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1109 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
 =

1110 
ue
;

1112 *
r_code
 = 
ERROR_CODE_INVALID_EVENT_STATE
;

1117 
EVENT_STATE_NORMAL
:

1118 i(
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
 ==

1119 
l
) {

1120 i(
mack_da
->
evtTimeSmp
.
g
 !
TIME_STAMP_DATETIME
) {

1121 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1124 i(
	`dime_com
(&
CutAV
->

1125 
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
Time_Smp
,

1126 &
mack_da
->
evtTimeSmp
.
vue
.
deTime
) > 0) {

1127 *
r_code
 = 
ERROR_CODE_INVALID_TIME_STAMP
;

1132 
CutAV
->
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
 =

1133 
ue
;

1135 *
r_code
 = 
ERROR_CODE_INVALID_EVENT_STATE
;

1145 
CutAV
->
Ack_nify_da
.
bSdAckNify
 = 
ue
;

1146 
CutAV
->
Ack_nify_da
.
EvtS
 = 
mack_da
->
evtSAcked
;

1150 
	}
}

1152 
	$Alog_Vue_Arm_Summy
(

1153 
dex
,

1154 
BACNET_GET_ALARM_SUMMARY_DATA
 * 
gm_da
)

1158 i(
dex
 < 
MAX_ANALOG_VALUES
) {

1161 i((
AV_Des
[
dex
].
Evt_S
 !
EVENT_STATE_NORMAL
) &&

1162 (
AV_Des
[
dex
].
Nify_Ty
 =
NOTIFY_ALARM
)) {

1164 
gm_da
->
objeIdtifr
.
ty
 = 
OBJECT_ANALOG_VALUE
;

1165 
gm_da
->
objeIdtifr
.

 =

1166 
	`Alog_Vue_Index_To_In
(
dex
);

1168 
gm_da
->
mS
 = 
AV_Des
[
dex
].
Evt_S
;

1170 
	`brg_
(&
gm_da
->
acknowdgedTnsis
);

1171 
	`brg_t_b
(&
gm_da
->
acknowdgedTnsis
,

1172 
TRANSITION_TO_OFFNORMAL
,

1173 
AV_Des
[
dex
].
Acked_Tnsis
[
TRANSITION_TO_OFFNORMAL
].

1174 
bIsAcked
);

1175 
	`brg_t_b
(&
gm_da
->
acknowdgedTnsis
,

1176 
TRANSITION_TO_FAULT
,

1177 
AV_Des
[
dex
].

1178 
Acked_Tnsis
[
TRANSITION_TO_FAULT
].
bIsAcked
);

1179 
	`brg_t_b
(&
gm_da
->
acknowdgedTnsis
,

1180 
TRANSITION_TO_NORMAL
,

1181 
AV_Des
[
dex
].

1182 
Acked_Tnsis
[
TRANSITION_TO_NORMAL
].
bIsAcked
);

1189 
	}
}

1193 #ifde
TEST


1194 
	~<as.h
>

1195 
	~<rg.h
>

1196 
	~"e.h
"

1198 
bo
 
	$WPVideArgTy
(

1199 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

1200 
ut8_t
 
ucExedTag
,

1201 
BACNET_ERROR_CLASS
 * 
pECss
,

1202 
BACNET_ERROR_CODE
 * 
pECode
)

1204 
pVue
 =Value;

1205 
ucExedTag
 = ucExpectedTag;

1206 
pECss
 =ErrorClass;

1207 
pECode
 =ErrorCode;

1209  
l
;

1210 
	}
}

1212 
	$Alog_Vue
(

1213 
Te
 * 
pTe
)

1215 
BACNET_READ_PROPERTY_DATA
 
da
;

1216 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

1217 
n
 = 0;

1218 
ut32_t
 
n_vue
 = 0;

1219 
ut8_t
 
g_numb
 = 0;

1220 
ut16_t
 
decoded_ty
 = 0;

1221 
ut32_t
 
decoded_
 = 0;

1223 
	`Alog_Vue_In
();

1224 
da
.
iti_da
 = &
du
[0];

1225 
da
.
iti_da_n
 = (
du
);

1226 
da
.
obje_ty
 = 
OBJECT_ANALOG_VALUE
;

1227 
da
.
obje_
 = 1;

1228 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

1229 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1230 
n
 = 
	`Alog_Vue_Rd_Prݔty
(&
da
);

1231 
	`_
(
pTe
, 
n
 != 0);

1232 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

1233 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

1234 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

1235 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

1236 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

1239 
	}
}

1241 #ifde
TEST_ANALOG_VALUE


1242 
	$ma
(

1245 
Te
 *
pTe
;

1246 
bo
 
rc
;

1248 
pTe
 = 
	`_
("BACÈAlog Vue", 
NULL
);

1250 
rc
 = 
	`_addTeFuni
(
pTe
, 
Alog_Vue
);

1251 
	`as
(
rc
);

1253 
	`_tSm
(
pTe
, 
dout
);

1254 
	`_run
(
pTe
);

1255 (
	`_pt
(
pTe
);

1256 
	`_deroy
(
pTe
);

1259 
	}
}

	@demo/object/av.h

26 #ide
AV_H


27 
	#AV_H


	)

29 
	~<dbo.h
>

30 
	~<dt.h
>

31 
	~"bacdef.h
"

32 
	~"ba.h
"

33 
	~"wp.h
"

34 
	~".h
"

35 #i
defed
(
INTRINSIC_REPORTING
)

36 
	~"nc.h
"

37 
	~"m_ack.h
"

38 
	~"gevt.h
"

39 
	~"g_m_sum.h
"

42 #ifde
__lulus


46 
	sog_vue_des
 {

47 
Evt_S
:3;

48 
bo
 
Out_Of_Svi
;

49 
ut16_t
 
Uns
;

50 
P_Vue
;

51 #i
defed
(
INTRINSIC_REPORTING
)

52 
ut32_t
 
Time_Day
;

53 
ut32_t
 
Nifiti_Css
;

54 
High_Lim
;

55 
Low_Lim
;

56 
Ddbd
;

57 
Lim_Eb
:2;

58 
Evt_Eb
:3;

59 
Nify_Ty
:1;

60 
ACKED_INFO
 
Acked_Tnsis
[
MAX_BACNET_EVENT_TRANSITION
];

61 
BACNET_DATE_TIME
 
Evt_Time_Smps
[
MAX_BACNET_EVENT_TRANSITION
];

63 
ut32_t
 
Remag_Time_Day
;

65 
ACK_NOTIFICATION
 
Ack_nify_da
;

67 } 
	tANALOG_VALUE_DESCR
;

70 
Alog_Vue_Prݔty_Lis
(

71 cڡ **
pRequed
,

72 cڡ **
pOiڮ
,

73 cڡ **
pPrrry
);

74 
bo
 
Alog_Vue_Vid_In
(

75 
ut32_t
 
obje_
);

76 
Alog_Vue_Cou
(

78 
ut32_t
 
Alog_Vue_Index_To_In
(

79 
dex
);

80 
Alog_Vue_In_To_Index
(

81 
ut32_t
 
obje_
);

83 
bo
 
Alog_Vue_Obje_Name
(

84 
ut32_t
 
obje_
,

85 
BACNET_CHARACTER_STRING
 * 
obje_me
);

87 
Alog_Vue_Rd_Prݔty
(

88 
BACNET_READ_PROPERTY_DATA
 * 
da
);

90 
bo
 
Alog_Vue_Wre_Prݔty
(

91 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

93 
bo
 
Alog_Vue_P_Vue_S
(

94 
ut32_t
 
obje_
,

95 
vue
,

96 
ut8_t
 
iܙy
);

97 
Alog_Vue_P_Vue
(

98 
ut32_t
 
obje_
);

99 
bo
 
Alog_Vue_Chge_Of_Vue
(

100 
ut32_t
 

);

101 
Alog_Vue_Chge_Of_Vue_Cˬ
(

102 
ut32_t
 

);

103 
bo
 
Alog_Vue_Encode_Vue_Li
(

104 
ut32_t
 
obje_
,

105 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

106 
Alog_Vue_COV_Inemt
(

107 
ut32_t
 

);

108 
Alog_Vue_COV_Inemt_S
(

109 
ut32_t
 

,

110 
vue
);

112 *
Alog_Vue_Desti
(

113 
ut32_t
 

);

114 
bo
 
Alog_Vue_Desti_S
(

115 
ut32_t
 

,

116 *
w_me
);

118 
ut16_t
 
Alog_Vue_Uns
(

119 
ut32_t
 

);

120 
bo
 
Alog_Vue_Uns_S
(

121 
ut32_t
 

, 
ut16_t
 
un
);

123 
bo
 
Alog_Vue_Out_Of_Svi
(

124 
ut32_t
 

);

125 
Alog_Vue_Out_Of_Svi_S
(

126 
ut32_t
 

,

127 
bo
 
oos_ag
);

131 
Alog_Vue_Irsic_Rtg
(

132 
ut32_t
 
obje_
);

134 #i
defed
(
INTRINSIC_REPORTING
)

135 
Alog_Vue_Evt_Infmi
(

136 
dex
,

137 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
gevt_da
);

139 
Alog_Vue_Arm_Ack
(

140 
BACNET_ALARM_ACK_DATA
 * 
mack_da
,

141 
BACNET_ERROR_CODE
 * 
r_code
);

143 
Alog_Vue_Arm_Summy
(

144 
dex
,

145 
BACNET_GET_ALARM_SUMMARY_DATA
 * 
gm_da
);

148 
bo
 
Alog_Vue_Ce
(

149 
ut32_t
 
obje_
);

150 
bo
 
Alog_Vue_De
(

151 
ut32_t
 
obje_
);

152 
Alog_Vue_C˪up
(

154 
Alog_Vue_In
(

157 #ifde
TEST


158 
	~"e.h
"

159 
Alog_Vue
(

160 
Te
 * 
pTe
);

163 #ifde
__lulus


	@demo/object/bacfile.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<dlib.h
>

29 
	~<rg.h
>

30 
	~"cfig.h
"

31 
	~"addss.h
"

32 
	~"bacdef.h
"

33 
	~"ba.h
"

34 
	~"dk.h
"

35 
	~"bacdcode.h
"

36 
	~"du.h
"

37 
	~"du.h
"

38 
	~"tsm.h
"

39 
	~"devi.h
"

40 
	~"f.h
"

41 
	~"awf.h
"

42 
	~".h
"

43 
	~"wp.h
"

44 
	~"hdrs.h
"

45 
	~"bacfe.h
"

48 
ut32_t
 
	m
;

49 *
	mfame
;

50 } 
	tBACNET_FILE_LISTING
;

52 
BACNET_FILE_LISTING
 
	gBACt_Fe_Lig
[] = {

56 {0, 
NULL
}

60 cڡ 
	gbacfe_Prݔts_Requed
[] = {

61 
PROP_OBJECT_IDENTIFIER
,

62 
PROP_OBJECT_NAME
,

63 
PROP_OBJECT_TYPE
,

64 
PROP_FILE_TYPE
,

65 
PROP_FILE_SIZE
,

66 
PROP_MODIFICATION_DATE
,

67 
PROP_ARCHIVE
,

68 
PROP_READ_ONLY
,

69 
PROP_FILE_ACCESS_METHOD
,

73 cڡ 
	gbacfe_Prݔts_Oiڮ
[] = {

74 
PROP_DESCRIPTION
,

78 cڡ 
	gbacfe_Prݔts_Prrry
[] = {

82 
	$BACfe_Prݔty_Lis
(

83 cڡ **
pRequed
,

84 cڡ **
pOiڮ
,

85 cڡ **
pPrrry
)

87 i(
pRequed
)

88 *
pRequed
 = 
bacfe_Prݔts_Requed
;

89 i(
pOiڮ
)

90 *
pOiڮ
 = 
bacfe_Prݔts_Oiڮ
;

91 i(
pPrrry
)

92 *
pPrrry
 = 
bacfe_Prݔts_Prrry
;

95 
	}
}

97 *
	$bacfe_me
(

98 
ut32_t
 

)

100 
ut32_t
 
dex
 = 0;

101 *
fame
 = 
NULL
;

104 
BACt_Fe_Lig
[
dex
].
fame
) {

105 i(
BACt_Fe_Lig
[
dex
].

 == instance) {

106 
fame
 = 
BACt_Fe_Lig
[
dex
].filename;

109 
dex
++;

112  
fame
;

113 
	}
}

115 
bo
 
	$bacfe_obje_me
(

116 
ut32_t
 

,

117 
BACNET_CHARACTER_STRING
 * 
obje_me
)

119 
bo
 
us
 = 
l
;

120 *
fame
 = 
NULL
;

122 
fame
 = 
	`bacfe_me
(

);

123 i(
fame
) {

124 
us
 = 
	`charg__si
(
obje_me
, 
fame
);

127  
us
;

128 
	}
}

130 
bo
 
	$bacfe_vid_
(

131 
ut32_t
 
obje_
)

133  
	`bacfe_me
(
obje_
? 
ue
 : 
l
;

134 
	}
}

136 
ut32_t
 
	$bacfe_cou
(

139 
ut32_t
 
dex
 = 0;

142 
BACt_Fe_Lig
[
dex
].
fame
) {

143 
dex
++;

146  
dex
;

147 
	}
}

149 
ut32_t
 
	$bacfe_dex_to_
(

150 
fd_dex
)

152 
ut32_t
 

 = 
BACNET_MAX_INSTANCE
 + 1;

153 
ut32_t
 
dex
 = 0;

156 
BACt_Fe_Lig
[
dex
].
fame
) {

157 i(
dex
 =
fd_dex
) {

158 

 = 
BACt_Fe_Lig
[
dex
].instance;

161 
dex
++;

164  

;

165 
	}
}

167 
	$fsize
(

168 
FILE
 * 
pFe
)

170 
size
 = 0;

171 
ig
 = 0;

173 i(
pFe
) {

174 
ig
 = 
	`l
(
pFe
);

175 
	`fek
(
pFe
, 0L, 
SEEK_END
);

176 
size
 = 
	`l
(
pFe
);

177 
	`fek
(
pFe
, 
ig
, 
SEEK_SET
);

179  (
size
);

180 
	}
}

182 
	$bacfe_fe_size
(

183 
ut32_t
 
obje_
)

185 *
pFame
 = 
NULL
;

186 
FILE
 *
pFe
 = 
NULL
;

187 
fe_size
 = 0;

189 
pFame
 = 
	`bacfe_me
(
obje_
);

190 i(
pFame
) {

191 
pFe
 = 
	`fݒ
(
pFame
, "rb");

192 i(
pFe
) {

193 
fe_size
 = 
	`fsize
(
pFe
);

194 
	`fo
(
pFe
);

198  
fe_size
;

199 
	}
}

202 
	$bacfe_ad_ݔty
(

203 
BACNET_READ_PROPERTY_DATA
 * 
da
)

205 
du_n
 = 0;

206 
xt_rg
[32] = { "" };

207 
BACNET_CHARACTER_STRING
 
ch_rg
;

208 
BACNET_DATE
 
bde
;

209 
BACNET_TIME
 
btime
;

210 
ut8_t
 *
du
 = 
NULL
;

212 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

213 (
da
->
iti_da_n
 == 0)) {

216 
du
 = 
da
->
iti_da
;

217 
da
->
obje_ݔty
) {

218 
PROP_OBJECT_IDENTIFIER
:

219 
du_n
 =

220 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_FILE
,

221 
da
->
obje_
);

223 
PROP_OBJECT_NAME
:

224 
	`rtf
(
xt_rg
, "FILE %lu",

225 (
da
->
obje_
);

226 
	`charg__si
(&
ch_rg
, 
xt_rg
);

227 
du_n
 =

228 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

230 
PROP_OBJECT_TYPE
:

231 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
OBJECT_FILE
);

233 
PROP_DESCRIPTION
:

234 
	`charg__si
(&
ch_rg
,

235 
	`bacfe_me
(
da
->
obje_
));

236 
du_n
 =

237 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

239 
PROP_FILE_TYPE
:

240 
	`charg__si
(&
ch_rg
, "TEXT");

241 
du_n
 =

242 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

244 
PROP_FILE_SIZE
:

245 
du_n
 =

246 
	`code_iti_unsigd
(&
du
[0],

247 
	`bacfe_fe_size
(
da
->
obje_
));

249 
PROP_MODIFICATION_DATE
:

251 
bde
.
yr
 = 2006;

252 
bde
.
mth
 = 4;

253 
bde
.
day
 = 1;

254 
bde
.
wday
 = 6;

255 
du_n
 = 
	`code_iti_de
(&
du
[0], &
bde
);

257 
btime
.
hour
 = 7;

258 
btime
.
m
 = 0;

259 
btime
.
c
 = 3;

260 
btime
.
hunddths
 = 1;

261 
du_n
 +
	`code_iti_time
(&
du
[du_n], &
btime
);

263 
PROP_ARCHIVE
:

272 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
ue
);

274 
PROP_READ_ONLY
:

276 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
ue
);

278 
PROP_FILE_ACCESS_METHOD
:

279 
du_n
 =

280 
	`code_iti_umed
(&
du
[0], 
FILE_STREAM_ACCESS
);

283 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

284 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

285 
du_n
 = -1;

289  
du_n
;

290 
	}
}

293 
bo
 
	$bacfe_wre_ݔty
(

294 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

296 
bo
 
us
 = 
l
;

297 
n
 = 0;

298 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

300 i(!
	`bacfe_vid_
(
wp_da
->
obje_
)) {

301 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

302 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

303  
l
;

306 i(
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

307 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

308 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

309  
l
;

312 
n
 =

313 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

314 
wp_da
->
iti_da_n
, &
vue
);

315 i(
n
 < 0) {

317 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

318 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

319  
l
;

322 
wp_da
->
obje_ݔty
) {

323 
PROP_ARCHIVE
:

330 
us
 =

331 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

332 &
wp_da
->
r_ass
, &wp_da->
r_code
);

333 i(
us
) {

334 i(
vue
.
ty
.
Boޗn
) {

341 
PROP_FILE_SIZE
:

345 
us
 =

346 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

347 &
wp_da
->
r_ass
, &wp_da->
r_code
);

348 i(
us
) {

353 
PROP_OBJECT_IDENTIFIER
:

354 
PROP_OBJECT_NAME
:

355 
PROP_OBJECT_TYPE
:

356 
PROP_DESCRIPTION
:

357 
PROP_FILE_TYPE
:

358 
PROP_MODIFICATION_DATE
:

359 
PROP_READ_ONLY
:

360 
PROP_FILE_ACCESS_METHOD
:

361 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

362 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

365 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

366 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

370  
us
;

371 
	}
}

373 
ut32_t
 
	$bacfe_
(

374 *
fame
)

376 
ut32_t
 
dex
 = 0;

377 
ut32_t
 

 = 
BACNET_MAX_INSTANCE
 + 1;

380 
BACt_Fe_Lig
[
dex
].
fame
) {

381 i(
	`rcmp
(
BACt_Fe_Lig
[
dex
].
fame
, filename) == 0) {

382 

 = 
BACt_Fe_Lig
[
dex
].instance;

385 
dex
++;

388  

;

389 
	}
}

391 #i
MAX_TSM_TRANSACTIONS


397 
ut32_t
 
	$bacfe__om_tsm
(

398 
ut8_t
 
vokeID
)

400 
BACNET_NPDU_DATA
 
du_da
 = { 0 };

401 
BACNET_CONFIRMED_SERVICE_DATA
 
rvi_da
 = { 0 };

402 
ut8_t
 
rvi_choi
 = 0;

403 
ut8_t
 *
rvi_que
 = 
NULL
;

404 
ut16_t
 
rvi_que_n
 = 0;

405 
BACNET_ADDRESS
 
de
;

406 
ut8_t
 
du
[
MAX_PDU
] = { 0 };

407 
ut16_t
 
du_n
 = 0;

408 
n
 = 0;

409 
BACNET_ATOMIC_READ_FILE_DATA
 
da
 = { 0 };

410 
ut32_t
 
obje_
 = 
BACNET_MAX_INSTANCE
 + 1;

411 
bo
 
found
 = 
l
;

413 
found
 =

414 
	`tsm_g_i_pdu
(
vokeID
, &
de
, &
du_da
, &
du
[0],

415 &
du_n
);

416 i(
found
) {

417 i(!
du_da
.
twk_y_mesge
 &&pdu_da.
da_exg_y


418 && (
du
[0] =
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)) {

419 
n
 =

420 
	`du_decode_cfmed_rvi_que
(&
du
[0], 
du_n
,

421 &
rvi_da
, &
rvi_choi
, &
rvi_que
,

422 &
rvi_que_n
);

423 i(
rvi_choi
 =
SERVICE_CONFIRMED_ATOMIC_READ_FILE
) {

424 
n
 =

425 
	`f_decode_rvi_que
(
rvi_que
,

426 
rvi_que_n
, &
da
);

427 i(
n
 > 0) {

428 i(
da
.
obje_ty
 =
OBJECT_FILE
)

429 
obje_
 = 
da
.object_instance;

435  
obje_
;

436 
	}
}

439 
bo
 
	$bacfe_ad_da
(

440 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

442 *
pFame
 = 
NULL
;

443 
bo
 
found
 = 
l
;

444 
FILE
 *
pFe
 = 
NULL
;

445 
size_t
 
n
 = 0;

447 
pFame
 = 
	`bacfe_me
(
da
->
obje_
);

448 i(
pFame
) {

449 
found
 = 
ue
;

450 
pFe
 = 
	`fݒ
(
pFame
, "rb");

451 i(
pFe
) {

452 (
	`fek
(
pFe
, 
da
->
ty
.
am
.
feSPosi
, 
SEEK_SET
);

453 
n
 =

454 
	`d
(
	`org_vue
(&
da
->
feDa
), 1,

455 
da
->
ty
.
am
.
queedOCou
, 
pFe
);

456 i(
n
 < 
da
->
ty
.
am
.
queedOCou
)

457 
da
->
dOfFe
 = 
ue
;

459 
da
->
dOfFe
 = 
l
;

460 
	`org_un
(&
da
->
feDa
, 
n
);

461 
	`fo
(
pFe
);

463 
	`org_un
(&
da
->
feDa
, 0);

464 
da
->
dOfFe
 = 
ue
;

467 
	`org_un
(&
da
->
feDa
, 0);

468 
da
->
dOfFe
 = 
ue
;

471  
found
;

472 
	}
}

474 
bo
 
	$bacfe_wre_am_da
(

475 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
)

477 *
pFame
 = 
NULL
;

478 
bo
 
found
 = 
l
;

479 
FILE
 *
pFe
 = 
NULL
;

481 
pFame
 = 
	`bacfe_me
(
da
->
obje_
);

482 i(
pFame
) {

483 
found
 = 
ue
;

484 i(
da
->
ty
.
am
.
feSPosi
 == 0) {

486 
pFe
 = 
	`fݒ
(
pFame
, "wb");

487 } i(
da
->
ty
.
am
.
feSPosi
 == -1) {

491 
pFe
 = 
	`fݒ
(
pFame
, "ab+");

494 
pFe
 = 
	`fݒ
(
pFame
, "rb+");

496 i(
pFe
) {

497 i(
da
->
ty
.
am
.
feSPosi
 != -1) {

498 (
	`fek
(
pFe
, 
da
->
ty
.
am
.
feSPosi
,

499 
SEEK_SET
);

501 i(
	`fwre
(
	`org_vue
(&
da
->
feDa
),

502 
	`org_ngth
(&
da
->
feDa
), 1, 
pFe
) != 1) {

505 
	`fo
(
pFe
);

509  
found
;

510 
	}
}

512 
bo
 
	$bacfe_ad_ack_am_da
(

513 
ut32_t
 

,

514 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

516 
bo
 
found
 = 
l
;

517 
FILE
 *
pFe
 = 
NULL
;

518 *
pFame
 = 
NULL
;

520 
pFame
 = 
	`bacfe_me
(

);

521 i(
pFame
) {

522 
found
 = 
ue
;

523 
pFe
 = 
	`fݒ
(
pFame
, "rb");

524 i(
pFe
) {

525 (
	`fek
(
pFe
, 
da
->
ty
.
am
.
feSPosi
, 
SEEK_SET
);

526 i(
	`fwre
(
	`org_vue
(&
da
->
feDa
),

527 
	`org_ngth
(&
da
->
feDa
), 1, 
pFe
) != 1) {

528 #i
PRINT_ENABLED


529 
	`rtf
(
dr
, "Faedwrt%(%lu)!\n", 
pFame
,

530 (

);

533 
	`fo
(
pFe
);

537  
found
;

538 
	}
}

540 
	$bacfe_
(

543 
	}
}

	@demo/object/bacfile.h

34 #ide
BACFILE_H


35 
	#BACFILE_H


	)

37 
	~<dbo.h
>

38 
	~<dt.h
>

39 
	~"bacdef.h
"

40 
	~"banum.h
"

41 
	~"du.h
"

42 
	~"f.h
"

43 
	~"awf.h
"

44 
	~".h
"

45 
	~"wp.h
"

47 #ifde
__lulus


51 
BACfe_Prݔty_Lis
(

52 cڡ **
pRequed
,

53 cڡ **
pOiڮ
,

54 cڡ **
pPrrry
);

55 
bo
 
bacfe_obje_me
(

56 
ut32_t
 
obje_
,

57 
BACNET_CHARACTER_STRING
 * 
obje_me
);

58 
bo
 
bacfe_vid_
(

59 
ut32_t
 
obje_
);

60 
ut32_t
 
bacfe_cou
(

62 
ut32_t
 
bacfe_dex_to_
(

63 
fd_dex
);

64 
bacfe__to_dex
(

65 
ut32_t
 

);

66 
ut32_t
 
bacfe_
(

67 *
fame
);

73 
ut32_t
 
bacfe__om_tsm
(

74 
ut8_t
 
vokeID
);

77 
bo
 
bacfe_ad_da
(

78 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
);

79 
bo
 
bacfe_ad_ack_am_da
(

80 
ut32_t
 

,

81 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
);

82 
bo
 
bacfe_wre_am_da
(

83 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
);

85 
bacfe_
(

87 
ut32_t
 
bacfe_fe_size
(

88 
ut32_t
 

);

91 
bacfe_ad_ݔty
(

92 
BACNET_READ_PROPERTY_DATA
 * 
da
);

95 
bo
 
bacfe_wre_ݔty
(

96 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

98 #ifde
__lulus


	@demo/object/bi.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~".h
"

36 
	~"wp.h
"

37 
	~"cov.h
"

38 
	~"cfig.h
"

39 
	~"bi.h
"

40 
	~"hdrs.h
"

42 #ide
MAX_BINARY_INPUTS


43 
	#MAX_BINARY_INPUTS
 5

	)

47 
BACNET_BINARY_PV
 
	gP_Vue
[
MAX_BINARY_INPUTS
];

49 
bo
 
	gOut_Of_Svi
[
MAX_BINARY_INPUTS
];

51 
bo
 
	gChge_Of_Vue
[
MAX_BINARY_INPUTS
];

53 
BACNET_POLARITY
 
	gPެy
[
MAX_BINARY_INPUTS
];

56 cڡ 
	gBy_Iut_Prݔts_Requed
[] = {

57 
PROP_OBJECT_IDENTIFIER
,

58 
PROP_OBJECT_NAME
,

59 
PROP_OBJECT_TYPE
,

60 
PROP_PRESENT_VALUE
,

61 
PROP_STATUS_FLAGS
,

62 
PROP_EVENT_STATE
,

63 
PROP_OUT_OF_SERVICE
,

64 
PROP_POLARITY
,

68 cڡ 
	gBy_Iut_Prݔts_Oiڮ
[] = {

69 
PROP_DESCRIPTION
,

73 cڡ 
	gBy_Iut_Prݔts_Prrry
[] = {

77 
	$By_Iut_Prݔty_Lis
(

78 cڡ **
pRequed
,

79 cڡ **
pOiڮ
,

80 cڡ **
pPrrry
)

82 i(
pRequed
) {

83 *
pRequed
 = 
By_Iut_Prݔts_Requed
;

85 i(
pOiڮ
) {

86 *
pOiڮ
 = 
By_Iut_Prݔts_Oiڮ
;

88 i(
pPrrry
) {

89 *
pPrrry
 = 
By_Iut_Prݔts_Prrry
;

93 
	}
}

98 
bo
 
	$By_Iut_Vid_In
(

99 
ut32_t
 
obje_
)

101 i(
obje_
 < 
MAX_BINARY_INPUTS
) {

102  
ue
;

105  
l
;

106 
	}
}

110 
	$By_Iut_Cou
(

113  
MAX_BINARY_INPUTS
;

114 
	}
}

119 
ut32_t
 
	$By_Iut_Index_To_In
(

120 
dex
)

122  
dex
;

123 
	}
}

125 
	$By_Iut_In
(

128 
bo
 
lized
 = 
l
;

129 
i
;

131 i(!
lized
) {

132 
lized
 = 
ue
;

135 
i
 = 0; i < 
MAX_BINARY_INPUTS
; i++) {

136 
P_Vue
[
i
] = 
BINARY_INACTIVE
;

141 
	}
}

146 
	$By_Iut_In_To_Index
(

147 
ut32_t
 
obje_
)

149 
dex
 = 
MAX_BINARY_INPUTS
;

151 i(
obje_
 < 
MAX_BINARY_INPUTS
) {

152 
dex
 = 
obje_
;

155  
dex
;

156 
	}
}

158 
BACNET_BINARY_PV
 
	$By_Iut_P_Vue
(

159 
ut32_t
 
obje_
)

161 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

162 
dex
 = 0;

164 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

165 i(
dex
 < 
MAX_BINARY_INPUTS
) {

166 
vue
 = 
P_Vue
[
dex
];

167 i(
Pެy
[
dex
] !
POLARITY_NORMAL
) {

168 i(
vue
 =
BINARY_INACTIVE
) {

169 
vue
 = 
BINARY_ACTIVE
;

171 
vue
 = 
BINARY_INACTIVE
;

176  
vue
;

177 
	}
}

179 
bo
 
	$By_Iut_Out_Of_Svi
(

180 
ut32_t
 
obje_
)

182 
bo
 
vue
 = 
l
;

183 
dex
 = 0;

185 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

186 i(
dex
 < 
MAX_BINARY_INPUTS
) {

187 
vue
 = 
Out_Of_Svi
[
dex
];

190  
vue
;

191 
	}
}

193 
bo
 
	$By_Iut_Chge_Of_Vue
(

194 
ut32_t
 
obje_
)

196 
bo
 
us
 = 
l
;

197 
dex
;

199 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

200 i(
dex
 < 
MAX_BINARY_INPUTS
) {

201 
us
 = 
Chge_Of_Vue
[
dex
];

204  
us
;

205 
	}
}

207 
	$By_Iut_Chge_Of_Vue_Cˬ
(

208 
ut32_t
 
obje_
)

210 
dex
;

212 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

213 i(
dex
 < 
MAX_BINARY_INPUTS
) {

214 
Chge_Of_Vue
[
dex
] = 
l
;

218 
	}
}

228 
bo
 
	$By_Iut_Encode_Vue_Li
(

229 
ut32_t
 
obje_
,

230 
BACNET_PROPERTY_VALUE
 * 
vue_li
)

232 
bo
 
us
 = 
l
;

234 i(
vue_li
) {

235 
vue_li
->
ݔtyIdtifr
 = 
PROP_PRESENT_VALUE
;

236 
vue_li
->
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

237 
vue_li
->
vue
.
cڋxt_ecific
 = 
l
;

238 
vue_li
->
vue
.
g
 = 
BACNET_APPLICATION_TAG_ENUMERATED
;

239 
vue_li
->
vue
.
xt
 = 
NULL
;

240 
vue_li
->
vue
.
ty
.
Enumed
 =

241 
	`By_Iut_P_Vue
(
obje_
);

242 
vue_li
->
iܙy
 = 
BACNET_NO_PRIORITY
;

243 
vue_li
 = vue_li->
xt
;

245 i(
vue_li
) {

246 
vue_li
->
ݔtyIdtifr
 = 
PROP_STATUS_FLAGS
;

247 
vue_li
->
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

248 
vue_li
->
vue
.
cڋxt_ecific
 = 
l
;

249 
vue_li
->
vue
.
g
 = 
BACNET_APPLICATION_TAG_BIT_STRING
;

250 
vue_li
->
vue
.
xt
 = 
NULL
;

251 
	`brg_
(&
vue_li
->
vue
.
ty
.
B_Sg
);

252 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

253 
STATUS_FLAG_IN_ALARM
, 
l
);

254 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

255 
STATUS_FLAG_FAULT
, 
l
);

256 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

257 
STATUS_FLAG_OVERRIDDEN
, 
l
);

258 i(
	`By_Iut_Out_Of_Svi
(
obje_
)) {

259 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

260 
STATUS_FLAG_OUT_OF_SERVICE
, 
ue
);

262 
	`brg_t_b
(&
vue_li
->
vue
.
ty
.
B_Sg
,

263 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

265 
vue_li
->
iܙy
 = 
BACNET_NO_PRIORITY
;

266 
vue_li
->
xt
 = 
NULL
;

267 
us
 = 
ue
;

270  
us
;

271 
	}
}

273 
bo
 
	$By_Iut_P_Vue_S
(

274 
ut32_t
 
obje_
,

275 
BACNET_BINARY_PV
 
vue
)

277 
dex
 = 0;

278 
bo
 
us
 = 
l
;

280 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

281 i(
dex
 < 
MAX_BINARY_INPUTS
) {

282 i(
Pެy
[
dex
] !
POLARITY_NORMAL
) {

283 i(
vue
 =
BINARY_INACTIVE
) {

284 
vue
 = 
BINARY_ACTIVE
;

286 
vue
 = 
BINARY_INACTIVE
;

289 i(
P_Vue
[
dex
] !
vue
) {

290 
Chge_Of_Vue
[
dex
] = 
ue
;

292 
P_Vue
[
dex
] = 
vue
;

293 
us
 = 
ue
;

296  
us
;

297 
	}
}

299 
	$By_Iut_Out_Of_Svi_S
(

300 
ut32_t
 
obje_
,

301 
bo
 
vue
)

303 
dex
 = 0;

305 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

306 i(
dex
 < 
MAX_BINARY_INPUTS
) {

307 i(
Out_Of_Svi
[
dex
] !
vue
) {

308 
Chge_Of_Vue
[
dex
] = 
ue
;

310 
Out_Of_Svi
[
dex
] = 
vue
;

314 
	}
}

316 
bo
 
	$By_Iut_Obje_Name
(

317 
ut32_t
 
obje_
,

318 
BACNET_CHARACTER_STRING
 * 
obje_me
)

320 
xt_rg
[32] = "";

321 
bo
 
us
 = 
l
;

322 
dex
 = 0;

324 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

325 i(
dex
 < 
MAX_BINARY_INPUTS
) {

326 
	`rtf
(
xt_rg
, "BINARY INPUT %lu",

327 (
obje_
);

328 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

331  
us
;

332 
	}
}

334 
BACNET_POLARITY
 
	$By_Iut_Pެy
(

335 
ut32_t
 
obje_
)

337 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

338 
dex
 = 0;

340 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

341 i(
dex
 < 
MAX_BINARY_INPUTS
) {

342 
pެy
 = 
Pެy
[
dex
];

345  
pެy
;

346 
	}
}

348 
bo
 
	$By_Iut_Pެy_S
(

349 
ut32_t
 
obje_
,

350 
BACNET_POLARITY
 
pެy
)

352 
bo
 
us
 = 
l
;

353 
dex
 = 0;

355 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

356 i(
dex
 < 
MAX_BINARY_INPUTS
) {

357 
Pެy
[
dex
] = 
pެy
;

360  
us
;

361 
	}
}

365 
	$By_Iut_Rd_Prݔty
(

366 
BACNET_READ_PROPERTY_DATA
 * 
da
)

368 
du_n
 = 0;

369 
BACNET_BIT_STRING
 
b_rg
;

370 
BACNET_CHARACTER_STRING
 
ch_rg
;

371 
ut8_t
 *
du
 = 
NULL
;

372 
bo
 
e
 = 
l
;

374 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

375 (
da
->
iti_da_n
 == 0)) {

378 
du
 = 
da
->
iti_da
;

379 
da
->
obje_ݔty
) {

380 
PROP_OBJECT_IDENTIFIER
:

381 
du_n
 =

382 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_BINARY_INPUT
,

383 
da
->
obje_
);

385 
PROP_OBJECT_NAME
:

386 
PROP_DESCRIPTION
:

388 
	`By_Iut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

389 
du_n
 =

390 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

392 
PROP_OBJECT_TYPE
:

393 
du_n
 =

394 
	`code_iti_umed
(&
du
[0], 
OBJECT_BINARY_INPUT
);

396 
PROP_PRESENT_VALUE
:

398 
du_n
 =

399 
	`code_iti_umed
(&
du
[0],

400 
	`By_Iut_P_Vue
(
da
->
obje_
));

402 
PROP_STATUS_FLAGS
:

404 
	`brg_
(&
b_rg
);

405 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

406 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

407 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

408 
e
 = 
	`By_Iut_Out_Of_Svi
(
da
->
obje_
);

409 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
e
);

410 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

412 
PROP_EVENT_STATE
:

414 
du_n
 =

415 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

417 
PROP_OUT_OF_SERVICE
:

418 
e
 = 
	`By_Iut_Out_Of_Svi
(
da
->
obje_
);

419 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

421 
PROP_POLARITY
:

422 
du_n
 =

423 
	`code_iti_umed
(&
du
[0],

424 
	`By_Iut_Pެy
(
da
->
obje_
));

427 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

428 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

429 
du_n
 = 
BACNET_STATUS_ERROR
;

433 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

434 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

435 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

436 
du_n
 = 
BACNET_STATUS_ERROR
;

439  
du_n
;

440 
	}
}

443 
bo
 
	$By_Iut_Wre_Prݔty
(

444 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

446 
bo
 
us
 = 
l
;

447 
n
 = 0;

448 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

451 
n
 =

452 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

453 
wp_da
->
iti_da_n
, &
vue
);

455 i(
n
 < 0) {

457 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

458 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

459  
l
;

462 i(
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

463 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

464 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

465  
l
;

467 
wp_da
->
obje_ݔty
) {

468 
PROP_PRESENT_VALUE
:

469 
us
 =

470 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

471 &
wp_da
->
r_ass
, &wp_da->
r_code
);

472 i(
us
) {

473 i(
vue
.
ty
.
Enumed
 <
MAX_BINARY_PV
) {

474 
	`By_Iut_P_Vue_S
(
wp_da
->
obje_
,

475 (
BACNET_BINARY_PV

vue
.
ty
.
Enumed
);

477 
us
 = 
l
;

478 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

479 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

483 
PROP_OUT_OF_SERVICE
:

484 
us
 =

485 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

486 &
wp_da
->
r_ass
, &wp_da->
r_code
);

487 i(
us
) {

488 
	`By_Iut_Out_Of_Svi_S
(
wp_da
->
obje_
,

489 
vue
.
ty
.
Boޗn
);

492 
PROP_POLARITY
:

493 
us
 =

494 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

495 &
wp_da
->
r_ass
, &wp_da->
r_code
);

496 i(
us
) {

497 i(
vue
.
ty
.
Enumed
 < 
MAX_POLARITY
) {

498 
	`By_Iut_Pެy_S
(
wp_da
->
obje_
,

499 (
BACNET_POLARITY

vue
.
ty
.
Enumed
);

501 
us
 = 
l
;

502 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

503 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

507 
PROP_OBJECT_IDENTIFIER
:

508 
PROP_OBJECT_NAME
:

509 
PROP_DESCRIPTION
:

510 
PROP_OBJECT_TYPE
:

511 
PROP_STATUS_FLAGS
:

512 
PROP_EVENT_STATE
:

513 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

514 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

517 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

518 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

522  
us
;

523 
	}
}

525 #ifde
TEST


526 
	~<as.h
>

527 
	~<rg.h
>

528 
	~"e.h
"

530 
bo
 
	$WPVideArgTy
(

531 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

532 
ut8_t
 
ucExedTag
,

533 
BACNET_ERROR_CLASS
 * 
pECss
,

534 
BACNET_ERROR_CODE
 * 
pECode
)

536 
pVue
 =Value;

537 
ucExedTag
 = ucExpectedTag;

538 
pECss
 =ErrorClass;

539 
pECode
 =ErrorCode;

541  
l
;

542 
	}
}

544 
	$ByIut
(

545 
Te
 * 
pTe
)

547 
BACNET_READ_PROPERTY_DATA
 
da
;

548 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

549 
n
 = 0;

550 
ut32_t
 
n_vue
 = 0;

551 
ut8_t
 
g_numb
 = 0;

552 
ut16_t
 
decoded_ty
 = 0;

553 
ut32_t
 
decoded_
 = 0;

555 
	`By_Iut_In
();

556 
da
.
iti_da
 = &
du
[0];

557 
da
.
iti_da_n
 = (
du
);

558 
da
.
obje_ty
 = 
OBJECT_BINARY_INPUT
;

559 
da
.
obje_
 = 1;

560 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

561 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

562 
n
 = 
	`By_Iut_Rd_Prݔty
(&
da
);

563 
	`_
(
pTe
, 
n
 != 0);

564 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

565 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

566 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

567 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

568 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

571 
	}
}

573 #ifde
TEST_BINARY_INPUT


574 
	$ma
(

577 
Te
 *
pTe
;

578 
bo
 
rc
;

580 
pTe
 = 
	`_
("BACÈBy Iut", 
NULL
);

582 
rc
 = 
	`_addTeFuni
(
pTe
, 
ByIut
);

583 
	`as
(
rc
);

585 
	`_tSm
(
pTe
, 
dout
);

586 
	`_run
(
pTe
);

587 (
	`_pt
(
pTe
);

588 
	`_deroy
(
pTe
);

591 
	}
}

	@demo/object/bi.h

25 #ide
BI_H


26 
	#BI_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"cov.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
By_Iut_Prݔty_Lis
(

40 cڡ **
pRequed
,

41 cڡ **
pOiڮ
,

42 cڡ **
pPrrry
);

44 
bo
 
By_Iut_Vid_In
(

45 
ut32_t
 
obje_
);

46 
By_Iut_Cou
(

48 
ut32_t
 
By_Iut_Index_To_In
(

49 
dex
);

50 
By_Iut_In_To_Index
(

51 
ut32_t
 

);

52 
bo
 
By_Iut_Obje_In_Add
(

53 
ut32_t
 

);

55 
bo
 
By_Iut_Obje_Name
(

56 
ut32_t
 
obje_
,

57 
BACNET_CHARACTER_STRING
 * 
obje_me
);

58 
bo
 
By_Iut_Name_S
(

59 
ut32_t
 
obje_
,

60 *
w_me
);

62 
BACNET_BINARY_PV
 
By_Iut_P_Vue
(

63 
ut32_t
 
obje_
);

64 
bo
 
By_Iut_P_Vue_S
(

65 
ut32_t
 
obje_
,

66 
BACNET_BINARY_PV
 
vue
);

68 *
By_Iut_Desti
(

69 
ut32_t
 

);

70 
bo
 
By_Iut_Desti_S
(

71 
ut32_t
 

,

72 *
w_me
);

74 *
By_Iut_Iive_Text
(

75 
ut32_t
 

);

76 
bo
 
By_Iut_Iive_Text_S
(

77 
ut32_t
 

,

78 *
w_me
);

79 *
By_Iut_Aive_Text
(

80 
ut32_t
 

);

81 
bo
 
By_Iut_Aive_Text_S
(

82 
ut32_t
 

,

83 *
w_me
);

85 
BACNET_POLARITY
 
By_Iut_Pެy
(

86 
ut32_t
 
obje_
);

87 
bo
 
By_Iut_Pެy_S
(

88 
ut32_t
 
obje_
,

89 
BACNET_POLARITY
 
pެy
);

91 
bo
 
By_Iut_Out_Of_Svi
(

92 
ut32_t
 
obje_
);

93 
By_Iut_Out_Of_Svi_S
(

94 
ut32_t
 
obje_
,

95 
bo
 
vue
);

97 
bo
 
By_Iut_Encode_Vue_Li
(

98 
ut32_t
 
obje_
,

99 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

100 
bo
 
By_Iut_Chge_Of_Vue
(

101 
ut32_t
 

);

102 
By_Iut_Chge_Of_Vue_Cˬ
(

103 
ut32_t
 

);

105 
By_Iut_Rd_Prݔty
(

106 
BACNET_READ_PROPERTY_DATA
 * 
da
);

108 
bo
 
By_Iut_Wre_Prݔty
(

109 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

111 
bo
 
By_Iut_Ce
(

112 
ut32_t
 
obje_
);

113 
bo
 
By_Iut_De
(

114 
ut32_t
 
obje_
);

115 
By_Iut_C˪up
(

117 
By_Iut_In
(

120 #ifde
TEST


121 
	~"e.h
"

122 
ByIut
(

123 
Te
 * 
pTe
);

126 #ifde
__lulus


	@demo/object/bo.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~".h
"

37 
	~"wp.h
"

38 
	~"bo.h
"

39 
	~"hdrs.h
"

41 #ide
MAX_BINARY_OUTPUTS


42 
	#MAX_BINARY_OUTPUTS
 4

	)

47 
	#RELINQUISH_DEFAULT
 
BINARY_INACTIVE


	)

49 
BACNET_BINARY_PV


50 
	gBy_Ouut_Lev
[
MAX_BINARY_OUTPUTS
][
BACNET_MAX_PRIORITY
];

53 
bo
 
	gOut_Of_Svi
[
MAX_BINARY_OUTPUTS
];

56 cڡ 
	gBy_Ouut_Prݔts_Requed
[] = {

57 
PROP_OBJECT_IDENTIFIER
,

58 
PROP_OBJECT_NAME
,

59 
PROP_OBJECT_TYPE
,

60 
PROP_PRESENT_VALUE
,

61 
PROP_STATUS_FLAGS
,

62 
PROP_EVENT_STATE
,

63 
PROP_OUT_OF_SERVICE
,

64 
PROP_POLARITY
,

65 
PROP_PRIORITY_ARRAY
,

66 
PROP_RELINQUISH_DEFAULT
,

70 cڡ 
	gBy_Ouut_Prݔts_Oiڮ
[] = {

71 
PROP_DESCRIPTION
,

72 
PROP_ACTIVE_TEXT
,

73 
PROP_INACTIVE_TEXT
,

77 cڡ 
	gBy_Ouut_Prݔts_Prrry
[] = {

81 
	$By_Ouut_Prݔty_Lis
(

82 cڡ **
pRequed
,

83 cڡ **
pOiڮ
,

84 cڡ **
pPrrry
)

86 i(
pRequed
)

87 *
pRequed
 = 
By_Ouut_Prݔts_Requed
;

88 i(
pOiڮ
)

89 *
pOiڮ
 = 
By_Ouut_Prݔts_Oiڮ
;

90 i(
pPrrry
)

91 *
pPrrry
 = 
By_Ouut_Prݔts_Prrry
;

94 
	}
}

96 
	$By_Ouut_In
(

99 
i
, 
j
;

100 
bo
 
lized
 = 
l
;

102 i(!
lized
) {

103 
lized
 = 
ue
;

106 
i
 = 0; i < 
MAX_BINARY_OUTPUTS
; i++) {

107 
j
 = 0; j < 
BACNET_MAX_PRIORITY
; j++) {

108 
By_Ouut_Lev
[
i
][
j
] = 
BINARY_NULL
;

114 
	}
}

119 
bo
 
	$By_Ouut_Vid_In
(

120 
ut32_t
 
obje_
)

122 i(
obje_
 < 
MAX_BINARY_OUTPUTS
)

123  
ue
;

125  
l
;

126 
	}
}

130 
	$By_Ouut_Cou
(

133  
MAX_BINARY_OUTPUTS
;

134 
	}
}

139 
ut32_t
 
	$By_Ouut_Index_To_In
(

140 
dex
)

142  
dex
;

143 
	}
}

148 
	$By_Ouut_In_To_Index
(

149 
ut32_t
 
obje_
)

151 
dex
 = 
MAX_BINARY_OUTPUTS
;

153 i(
obje_
 < 
MAX_BINARY_OUTPUTS
)

154 
dex
 = 
obje_
;

156  
dex
;

157 
	}
}

159 
BACNET_BINARY_PV
 
	$By_Ouut_P_Vue
(

160 
ut32_t
 
obje_
)

162 
BACNET_BINARY_PV
 
vue
 = 
RELINQUISH_DEFAULT
;

163 
dex
 = 0;

164 
i
 = 0;

166 
dex
 = 
	`By_Ouut_In_To_Index
(
obje_
);

167 i(
dex
 < 
MAX_BINARY_OUTPUTS
) {

168 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

169 i(
By_Ouut_Lev
[
dex
][
i
] !
BINARY_NULL
) {

170 
vue
 = 
By_Ouut_Lev
[
dex
][
i
];

176  
vue
;

177 
	}
}

179 
bo
 
	$By_Ouut_Out_Of_Svi
(

180 
ut32_t
 
obje_
)

182 
bo
 
vue
 = 
l
;

183 
dex
 = 0;

185 
dex
 = 
	`By_Ouut_In_To_Index
(
obje_
);

186 i(
dex
 < 
MAX_BINARY_OUTPUTS
) {

187 
vue
 = 
Out_Of_Svi
[
dex
];

190  
vue
;

191 
	}
}

194 
bo
 
	$By_Ouut_Obje_Name
(

195 
ut32_t
 
obje_
,

196 
BACNET_CHARACTER_STRING
 * 
obje_me
)

198 
xt_rg
[32] = "";

199 
bo
 
us
 = 
l
;

201 i(
obje_
 < 
MAX_BINARY_OUTPUTS
) {

202 
	`rtf
(
xt_rg
, "BINARY OUTPUT %lu",

203 (
obje_
);

204 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

207  
us
;

208 
	}
}

211 
	$By_Ouut_Rd_Prݔty
(

212 
BACNET_READ_PROPERTY_DATA
 * 
da
)

214 
n
 = 0;

215 
du_n
 = 0;

216 
BACNET_BIT_STRING
 
b_rg
;

217 
BACNET_CHARACTER_STRING
 
ch_rg
;

218 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

219 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

220 
obje_dex
 = 0;

221 
i
 = 0;

222 
bo
 
e
 = 
l
;

223 
ut8_t
 *
du
 = 
NULL
;

225 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

226 (
da
->
iti_da_n
 == 0)) {

229 
du
 = 
da
->
iti_da
;

230 
da
->
obje_ݔty
) {

231 
PROP_OBJECT_IDENTIFIER
:

232 
du_n
 =

233 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_BINARY_OUTPUT
,

234 
da
->
obje_
);

238 
PROP_OBJECT_NAME
:

239 
PROP_DESCRIPTION
:

240 
	`By_Ouut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

241 
du_n
 =

242 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

244 
PROP_OBJECT_TYPE
:

245 
du_n
 =

246 
	`code_iti_umed
(&
du
[0], 
OBJECT_BINARY_OUTPUT
);

248 
PROP_PRESENT_VALUE
:

249 
e_vue
 =

250 
	`By_Ouut_P_Vue
(
da
->
obje_
);

251 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

253 
PROP_STATUS_FLAGS
:

255 
	`brg_
(&
b_rg
);

256 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

257 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

258 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

259 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

260 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

262 
PROP_EVENT_STATE
:

264 
du_n
 =

265 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

267 
PROP_OUT_OF_SERVICE
:

268 
obje_dex
 =

269 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

270 
e
 = 
Out_Of_Svi
[
obje_dex
];

271 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

273 
PROP_POLARITY
:

274 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
pެy
);

276 
PROP_PRIORITY_ARRAY
:

278 i(
da
->
y_dex
 == 0)

279 
du_n
 =

280 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

283 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

284 
obje_dex
 =

285 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

286 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

288 i(
By_Ouut_Lev
[
obje_dex
][
i
] =
BINARY_NULL
)

289 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

291 
e_vue
 = 
By_Ouut_Lev
[
obje_dex
][
i
];

292 
n
 =

293 
	`code_iti_umed
(&
du
[
du_n
],

294 
e_vue
);

297 i((
du_n
 + 
n
< 
MAX_APDU
)

298 
du_n
 +
n
;

300 
da
->
r_code
 =

301 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

302 
du_n
 = 
BACNET_STATUS_ABORT
;

307 
obje_dex
 =

308 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

309 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

310 i(
By_Ouut_Lev
[
obje_dex
][
da
->
y_dex
 -

311 1] =
BINARY_NULL
)

312 
du_n
 = 
	`code_iti_nu
(&
du
[apdu_len]);

314 
e_vue
 = 
By_Ouut_Lev
[
obje_dex
]

315 [
da
->
y_dex
 - 1];

316 
du_n
 =

317 
	`code_iti_umed
(&
du
[
du_n
],

318 
e_vue
);

321 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

322 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

323 
du_n
 = 
BACNET_STATUS_ERROR
;

328 
PROP_RELINQUISH_DEFAULT
:

329 
e_vue
 = 
RELINQUISH_DEFAULT
;

330 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

332 
PROP_ACTIVE_TEXT
:

333 
	`charg__si
(&
ch_rg
, "on");

334 
du_n
 =

335 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

337 
PROP_INACTIVE_TEXT
:

338 
	`charg__si
(&
ch_rg
, "off");

339 
du_n
 =

340 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

343 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

344 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

345 
du_n
 = 
BACNET_STATUS_ERROR
;

349 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

350 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

351 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

352 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

353 
du_n
 = 
BACNET_STATUS_ERROR
;

356  
du_n
;

357 
	}
}

360 
bo
 
	$By_Ouut_Wre_Prݔty
(

361 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

363 
bo
 
us
 = 
l
;

364 
obje_dex
 = 0;

365 
iܙy
 = 0;

366 
BACNET_BINARY_PV
 
v
 = 
BINARY_NULL
;

367 
n
 = 0;

368 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

371 
n
 =

372 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

373 
wp_da
->
iti_da_n
, &
vue
);

375 i(
n
 < 0) {

377 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

378 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

379  
l
;

381 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

382 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

384 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

385 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

386  
l
;

388 
wp_da
->
obje_ݔty
) {

389 
PROP_PRESENT_VALUE
:

390 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_ENUMERATED
) {

391 
iܙy
 = 
wp_da
->priority;

395 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

396 (
iܙy
 != 6 ) &&

397 (
vue
.
ty
.
Enumed
 <
MAX_BINARY_PV
)) {

398 
v
 = (
BACNET_BINARY_PV

vue
.
ty
.
Enumed
;

399 
obje_dex
 =

400 
By_Ouut_In_To_Index


401 (
wp_da
->
obje_
);

402 
iܙy
--;

403 
By_Ouut_Lev
[
obje_dex
][
iܙy
] = 
v
;

409 
us
 = 
ue
;

410 } i(
iܙy
 == 6) {

414 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

415 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

417 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

418 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

421 
us
 =

422 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_NULL
,

423 &
wp_da
->
r_ass
, &wp_da->
r_code
);

424 i(
us
) {

425 
v
 = 
BINARY_NULL
;

426 
obje_dex
 =

427 
By_Ouut_In_To_Index


428 (
wp_da
->
obje_
);

429 
iܙy
 = 
wp_da
->priority;

430 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

431 
iܙy
--;

432 
By_Ouut_Lev
[
obje_dex
][
iܙy
] = 
v
;

440 
us
 = 
l
;

441 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

442 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

447 
PROP_OUT_OF_SERVICE
:

448 
us
 =

449 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

450 &
wp_da
->
r_ass
, &wp_da->
r_code
);

451 i(
us
) {

452 
obje_dex
 =

453 
	`By_Ouut_In_To_Index
(
wp_da
->
obje_
);

454 
Out_Of_Svi
[
obje_dex
] =

455 
vue
.
ty
.
Boޗn
;

458 
PROP_OBJECT_IDENTIFIER
:

459 
PROP_OBJECT_NAME
:

460 
PROP_OBJECT_TYPE
:

461 
PROP_STATUS_FLAGS
:

462 
PROP_RELIABILITY
:

463 
PROP_EVENT_STATE
:

464 
PROP_POLARITY
:

465 
PROP_PRIORITY_ARRAY
:

466 
PROP_RELINQUISH_DEFAULT
:

467 
PROP_ACTIVE_TEXT
:

468 
PROP_INACTIVE_TEXT
:

469 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

470 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

473 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

474 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

478  
us
;

479 
	}
}

482 #ifde
TEST


483 
	~<as.h
>

484 
	~<rg.h
>

485 
	~"e.h
"

487 
bo
 
	$WPVideArgTy
(

488 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

489 
ut8_t
 
ucExedTag
,

490 
BACNET_ERROR_CLASS
 * 
pECss
,

491 
BACNET_ERROR_CODE
 * 
pECode
)

493 
pVue
 =Value;

494 
ucExedTag
 = ucExpectedTag;

495 
pECss
 =ErrorClass;

496 
pECode
 =ErrorCode;

498  
l
;

499 
	}
}

501 
	$ByOuut
(

502 
Te
 * 
pTe
)

504 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

505 
n
 = 0;

506 
ut32_t
 
n_vue
 = 0;

507 
ut8_t
 
g_numb
 = 0;

508 
ut16_t
 
decoded_ty
 = 0;

509 
ut32_t
 
decoded_
 = 0;

510 
BACNET_READ_PROPERTY_DATA
 
da
;

512 
	`By_Ouut_In
();

513 
da
.
iti_da
 = &
du
[0];

514 
da
.
iti_da_n
 = (
du
);

515 
da
.
obje_ty
 = 
OBJECT_BINARY_OUTPUT
;

516 
da
.
obje_
 = 1;

517 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

518 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

519 
n
 = 
	`By_Ouut_Rd_Prݔty
(&
da
);

520 
	`_
(
pTe
, 
n
 != 0);

521 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

522 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

523 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

524 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

525 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

528 
	}
}

530 #ifde
TEST_BINARY_OUTPUT


531 
	$ma
(

534 
Te
 *
pTe
;

535 
bo
 
rc
;

537 
pTe
 = 
	`_
("BACÈBy Ouut", 
NULL
);

539 
rc
 = 
	`_addTeFuni
(
pTe
, 
ByOuut
);

540 
	`as
(
rc
);

542 
	`_tSm
(
pTe
, 
dout
);

543 
	`_run
(
pTe
);

544 (
	`_pt
(
pTe
);

545 
	`_deroy
(
pTe
);

548 
	}
}

	@demo/object/bo.h

25 #ide
BO_H


26 
	#BO_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
By_Ouut_In
(

42 
By_Ouut_Prݔty_Lis
(

43 cڡ **
pRequed
,

44 cڡ **
pOiڮ
,

45 cڡ **
pPrrry
);

47 
bo
 
By_Ouut_Vid_In
(

48 
ut32_t
 
obje_
);

49 
By_Ouut_Cou
(

51 
ut32_t
 
By_Ouut_Index_To_In
(

52 
dex
);

53 
By_Ouut_In_To_Index
(

54 
ut32_t
 

);

55 
bo
 
By_Ouut_Obje_In_Add
(

56 
ut32_t
 

);

58 
bo
 
By_Ouut_Obje_Name
(

59 
ut32_t
 
obje_
,

60 
BACNET_CHARACTER_STRING
 * 
obje_me
);

61 
bo
 
By_Ouut_Name_S
(

62 
ut32_t
 
obje_
,

63 *
w_me
);

65 *
By_Ouut_Desti
(

66 
ut32_t
 

);

67 
bo
 
By_Ouut_Desti_S
(

68 
ut32_t
 

,

69 *
w_me
);

71 *
By_Ouut_Iive_Text
(

72 
ut32_t
 

);

73 
bo
 
By_Ouut_Iive_Text_S
(

74 
ut32_t
 

,

75 *
w_me
);

76 *
By_Ouut_Aive_Text
(

77 
ut32_t
 

);

78 
bo
 
By_Ouut_Aive_Text_S
(

79 
ut32_t
 

,

80 *
w_me
);

82 
BACNET_BINARY_PV
 
By_Ouut_P_Vue
(

83 
ut32_t
 

);

84 
bo
 
By_Ouut_P_Vue_S
(

85 
ut32_t
 

,

86 
BACNET_BINARY_PV
 
by_vue
,

87 
iܙy
);

88 
bo
 
By_Ouut_P_Vue_Rquish
(

89 
ut32_t
 

,

90 
iܙy
);

91 
By_Ouut_P_Vue_Priܙy
(

92 
ut32_t
 
obje_
);

94 
BACNET_POLARITY
 
By_Ouut_Pެy
(

95 
ut32_t
 

);

96 
bo
 
By_Ouut_Pެy_S
(

97 
ut32_t
 
obje_
,

98 
BACNET_POLARITY
 
pެy
);

100 
bo
 
By_Ouut_Out_Of_Svi
(

101 
ut32_t
 

);

102 
By_Ouut_Out_Of_Svi_S
(

103 
ut32_t
 
obje_
,

104 
bo
 
vue
);

106 
BACNET_BINARY_PV
 
By_Ouut_Rquish_Deu
(

107 
ut32_t
 
obje_
);

108 
bo
 
By_Ouut_Rquish_Deu_S
(

109 
ut32_t
 
obje_
,

110 
BACNET_BINARY_PV
 
vue
);

112 
bo
 
By_Ouut_Encode_Vue_Li
(

113 
ut32_t
 
obje_
,

114 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

115 
bo
 
By_Ouut_Chge_Of_Vue
(

116 
ut32_t
 

);

117 
By_Ouut_Chge_Of_Vue_Cˬ
(

118 
ut32_t
 

);

120 
By_Ouut_Rd_Prݔty
(

121 
BACNET_READ_PROPERTY_DATA
 * 
da
);

122 
bo
 
By_Ouut_Wre_Prݔty
(

123 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

125 
bo
 
By_Ouut_Ce
(

126 
ut32_t
 
obje_
);

127 
bo
 
By_Ouut_De
(

128 
ut32_t
 
obje_
);

129 
By_Ouut_C˪up
(

132 #ifde
TEST


133 
	~"e.h
"

134 
ByOuut
(

135 
Te
 * 
pTe
);

138 #ifde
__lulus


	@demo/object/bv.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~"wp.h
"

37 
	~".h
"

38 
	~"bv.h
"

39 
	~"hdrs.h
"

41 #ide
MAX_BINARY_VALUES


42 
	#MAX_BINARY_VALUES
 10

	)

47 
	#RELINQUISH_DEFAULT
 
BINARY_INACTIVE


	)

49 
BACNET_BINARY_PV


50 
	gBy_Vue_Lev
[
MAX_BINARY_VALUES
][
BACNET_MAX_PRIORITY
];

53 
bo
 
	gOut_Of_Svi
[
MAX_BINARY_VALUES
];

56 cڡ 
	gBy_Vue_Prݔts_Requed
[] = {

57 
PROP_OBJECT_IDENTIFIER
,

58 
PROP_OBJECT_NAME
,

59 
PROP_OBJECT_TYPE
,

60 
PROP_PRESENT_VALUE
,

61 
PROP_STATUS_FLAGS
,

62 
PROP_EVENT_STATE
,

63 
PROP_OUT_OF_SERVICE
,

67 cڡ 
	gBy_Vue_Prݔts_Oiڮ
[] = {

68 
PROP_DESCRIPTION
,

69 
PROP_PRIORITY_ARRAY
,

70 
PROP_RELINQUISH_DEFAULT
,

74 cڡ 
	gBy_Vue_Prݔts_Prrry
[] = {

78 
	$By_Vue_Prݔty_Lis
(

79 cڡ **
pRequed
,

80 cڡ **
pOiڮ
,

81 cڡ **
pPrrry
)

83 i(
pRequed
)

84 *
pRequed
 = 
By_Vue_Prݔts_Requed
;

85 i(
pOiڮ
)

86 *
pOiڮ
 = 
By_Vue_Prݔts_Oiڮ
;

87 i(
pPrrry
)

88 *
pPrrry
 = 
By_Vue_Prݔts_Prrry
;

91 
	}
}

93 
	$By_Vue_In
(

96 
i
, 
j
;

97 
bo
 
lized
 = 
l
;

99 i(!
lized
) {

100 
lized
 = 
ue
;

103 
i
 = 0; i < 
MAX_BINARY_VALUES
; i++) {

104 
j
 = 0; j < 
BACNET_MAX_PRIORITY
; j++) {

105 
By_Vue_Lev
[
i
][
j
] = 
BINARY_NULL
;

111 
	}
}

116 
bo
 
	$By_Vue_Vid_In
(

117 
ut32_t
 
obje_
)

119 i(
obje_
 < 
MAX_BINARY_VALUES
)

120  
ue
;

122  
l
;

123 
	}
}

127 
	$By_Vue_Cou
(

130  
MAX_BINARY_VALUES
;

131 
	}
}

136 
ut32_t
 
	$By_Vue_Index_To_In
(

137 
dex
)

139  
dex
;

140 
	}
}

145 
	$By_Vue_In_To_Index
(

146 
ut32_t
 
obje_
)

148 
dex
 = 
MAX_BINARY_VALUES
;

150 i(
obje_
 < 
MAX_BINARY_VALUES
)

151 
dex
 = 
obje_
;

153  
dex
;

154 
	}
}

156 
BACNET_BINARY_PV
 
	$By_Vue_P_Vue
(

157 
ut32_t
 
obje_
)

159 
BACNET_BINARY_PV
 
vue
 = 
RELINQUISH_DEFAULT
;

160 
dex
 = 0;

161 
i
 = 0;

163 
dex
 = 
	`By_Vue_In_To_Index
(
obje_
);

164 i(
dex
 < 
MAX_BINARY_VALUES
) {

165 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

166 i(
By_Vue_Lev
[
dex
][
i
] !
BINARY_NULL
) {

167 
vue
 = 
By_Vue_Lev
[
dex
][
i
];

173  
vue
;

174 
	}
}

177 
bo
 
	$By_Vue_Obje_Name
(

178 
ut32_t
 
obje_
,

179 
BACNET_CHARACTER_STRING
 * 
obje_me
)

181 
xt_rg
[32] = "";

182 
bo
 
us
 = 
l
;

184 i(
obje_
 < 
MAX_BINARY_VALUES
) {

185 
	`rtf
(
xt_rg
, "BINARY VALUE %lu",

186 (
obje_
);

187 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

190  
us
;

191 
	}
}

193 
bo
 
	$By_Vue_Out_Of_Svi
(

194 
ut32_t
 

)

196 
dex
 = 0;

197 
bo
 
oos_ag
 = 
l
;

199 
dex
 = 
	`By_Vue_In_To_Index
(

);

200 i(
dex
 < 
MAX_BINARY_VALUES
) {

201 
oos_ag
 = 
Out_Of_Svi
[
dex
];

204  
oos_ag
;

205 
	}
}

207 
	$By_Vue_Out_Of_Svi_S
(

208 
ut32_t
 

,

209 
bo
 
oos_ag
)

211 
dex
 = 0;

213 
dex
 = 
	`By_Vue_In_To_Index
(

);

214 i(
dex
 < 
MAX_BINARY_VALUES
) {

215 
Out_Of_Svi
[
dex
] = 
oos_ag
;

217 
	}
}

220 
	$By_Vue_Rd_Prݔty
(

221 
BACNET_READ_PROPERTY_DATA
 * 
da
)

223 
n
 = 0;

224 
du_n
 = 0;

225 
BACNET_BIT_STRING
 
b_rg
;

226 
BACNET_CHARACTER_STRING
 
ch_rg
;

227 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

228 
obje_dex
 = 0;

229 
i
 = 0;

230 
bo
 
e
 = 
l
;

231 
ut8_t
 *
du
 = 
NULL
;

233 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

234 (
da
->
iti_da_n
 == 0)) {

237 
du
 = 
da
->
iti_da
;

238 
da
->
obje_ݔty
) {

239 
PROP_OBJECT_IDENTIFIER
:

240 
du_n
 =

241 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_BINARY_VALUE
,

242 
da
->
obje_
);

246 
PROP_OBJECT_NAME
:

247 
PROP_DESCRIPTION
:

248 
	`By_Vue_Obje_Name
(
da
->
obje_
, &
ch_rg
);

249 
du_n
 =

250 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

252 
PROP_OBJECT_TYPE
:

253 
du_n
 =

254 
	`code_iti_umed
(&
du
[0], 
OBJECT_BINARY_VALUE
);

256 
PROP_PRESENT_VALUE
:

257 
e_vue
 =

258 
	`By_Vue_P_Vue
(
da
->
obje_
);

259 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

261 
PROP_STATUS_FLAGS
:

263 
	`brg_
(&
b_rg
);

264 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

265 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

266 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

267 
e
 = 
	`By_Vue_Out_Of_Svi
(
da
->
obje_
);

268 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
e
);

269 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

271 
PROP_EVENT_STATE
:

273 
du_n
 =

274 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

276 
PROP_OUT_OF_SERVICE
:

277 
e
 = 
	`By_Vue_Out_Of_Svi
(
da
->
obje_
);

278 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

280 
PROP_PRIORITY_ARRAY
:

282 i(
da
->
y_dex
 == 0)

283 
du_n
 =

284 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

287 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

288 
obje_dex
 =

289 
	`By_Vue_In_To_Index
(
da
->
obje_
);

290 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

292 i(
By_Vue_Lev
[
obje_dex
][
i
] =
BINARY_NULL
)

293 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

295 
e_vue
 = 
By_Vue_Lev
[
obje_dex
][
i
];

296 
n
 =

297 
	`code_iti_umed
(&
du
[
du_n
],

298 
e_vue
);

301 i((
du_n
 + 
n
< 
MAX_APDU
)

302 
du_n
 +
n
;

304 
da
->
r_code
 =

305 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

306 
du_n
 = 
BACNET_STATUS_ABORT
;

311 
obje_dex
 =

312 
	`By_Vue_In_To_Index
(
da
->
obje_
);

313 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

314 i(
By_Vue_Lev
[
obje_dex
][
da
->
y_dex
]

315 =
BINARY_NULL
)

316 
du_n
 = 
	`code_iti_nu
(&
du
[apdu_len]);

318 
e_vue
 = 
By_Vue_Lev
[
obje_dex
]

319 [
da
->
y_dex
];

320 
du_n
 =

321 
	`code_iti_umed
(&
du
[
du_n
],

322 
e_vue
);

325 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

326 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

327 
du_n
 = 
BACNET_STATUS_ERROR
;

331 
PROP_RELINQUISH_DEFAULT
:

332 
e_vue
 = 
RELINQUISH_DEFAULT
;

333 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

336 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

337 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

338 
du_n
 = 
BACNET_STATUS_ERROR
;

342 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

343 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

344 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

345 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

346 
du_n
 = 
BACNET_STATUS_ERROR
;

349  
du_n
;

350 
	}
}

353 
bo
 
	$By_Vue_Wre_Prݔty
(

354 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

356 
bo
 
us
 = 
l
;

357 
obje_dex
 = 0;

358 
iܙy
 = 0;

359 
BACNET_BINARY_PV
 
v
 = 
BINARY_NULL
;

360 
n
 = 0;

361 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

364 
n
 =

365 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

366 
wp_da
->
iti_da_n
, &
vue
);

368 i(
n
 < 0) {

370 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

371 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

372  
l
;

375 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

376 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

377 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

378 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

379  
l
;

381 
wp_da
->
obje_ݔty
) {

382 
PROP_PRESENT_VALUE
:

383 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_ENUMERATED
) {

384 
iܙy
 = 
wp_da
->priority;

388 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

389 (
iܙy
 != 6 ) &&

390 (
vue
.
ty
.
Enumed
 <
MAX_BINARY_PV
)) {

391 
v
 = (
BACNET_BINARY_PV

vue
.
ty
.
Enumed
;

392 
obje_dex
 =

393 
By_Vue_In_To_Index


394 (
wp_da
->
obje_
);

395 
iܙy
--;

396 
By_Vue_Lev
[
obje_dex
][
iܙy
] = 
v
;

402 
us
 = 
ue
;

403 } i(
iܙy
 == 6) {

407 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

408 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

410 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

411 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

414 
us
 =

415 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_NULL
,

416 &
wp_da
->
r_ass
, &wp_da->
r_code
);

417 i(
us
) {

418 
v
 = 
BINARY_NULL
;

419 
obje_dex
 =

420 
By_Vue_In_To_Index


421 (
wp_da
->
obje_
);

422 
iܙy
 = 
wp_da
->priority;

423 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

424 
iܙy
--;

425 
By_Vue_Lev
[
obje_dex
][
iܙy
] = 
v
;

433 
us
 = 
l
;

434 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

435 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

440 
PROP_OUT_OF_SERVICE
:

441 
us
 =

442 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

443 &
wp_da
->
r_ass
, &wp_da->
r_code
);

444 i(
us
) {

445 
	`By_Vue_Out_Of_Svi_S
(
wp_da
->
obje_
,

446 
vue
.
ty
.
Boޗn
);

449 
PROP_OBJECT_IDENTIFIER
:

450 
PROP_OBJECT_NAME
:

451 
PROP_DESCRIPTION
:

452 
PROP_OBJECT_TYPE
:

453 
PROP_STATUS_FLAGS
:

454 
PROP_EVENT_STATE
:

455 
PROP_PRIORITY_ARRAY
:

456 
PROP_RELINQUISH_DEFAULT
:

457 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

458 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

461 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

462 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

466  
us
;

467 
	}
}

470 #ifde
TEST


471 
	~<as.h
>

472 
	~<rg.h
>

473 
	~"e.h
"

475 
bo
 
	$WPVideArgTy
(

476 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

477 
ut8_t
 
ucExedTag
,

478 
BACNET_ERROR_CLASS
 * 
pECss
,

479 
BACNET_ERROR_CODE
 * 
pECode
)

481 
pVue
 =Value;

482 
ucExedTag
 = ucExpectedTag;

483 
pECss
 =ErrorClass;

484 
pECode
 =ErrorCode;

486  
l
;

487 
	}
}

489 
	$By_Vue
(

490 
Te
 * 
pTe
)

492 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

493 
n
 = 0;

494 
ut32_t
 
n_vue
 = 0;

495 
ut8_t
 
g_numb
 = 0;

496 
ut16_t
 
decoded_ty
 = 0;

497 
ut32_t
 
decoded_
 = 0;

498 
BACNET_READ_PROPERTY_DATA
 
da
;

500 
	`By_Vue_In
();

501 
da
.
iti_da
 = &
du
[0];

502 
da
.
iti_da_n
 = (
du
);

503 
da
.
obje_ty
 = 
OBJECT_BINARY_VALUE
;

504 
da
.
obje_
 = 1;

505 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

506 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

507 
n
 = 
	`By_Vue_Rd_Prݔty
(&
da
);

508 
	`_
(
pTe
, 
n
 != 0);

509 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

510 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

511 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

512 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

513 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

516 
	}
}

518 #ifde
TEST_BINARY_VALUE


519 
	$ma
(

522 
Te
 *
pTe
;

523 
bo
 
rc
;

525 
pTe
 = 
	`_
("BACÈBy_Vue", 
NULL
);

527 
rc
 = 
	`_addTeFuni
(
pTe
, 
By_Vue
);

528 
	`as
(
rc
);

530 
	`_tSm
(
pTe
, 
dout
);

531 
	`_run
(
pTe
);

532 (
	`_pt
(
pTe
);

533 
	`_deroy
(
pTe
);

536 
	}
}

	@demo/object/bv.h

25 #ide
BV_H


26 
	#BV_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
By_Vue_In
(

42 
By_Vue_Prݔty_Lis
(

43 cڡ **
pRequed
,

44 cڡ **
pOiڮ
,

45 cڡ **
pPrrry
);

47 
bo
 
By_Vue_Vid_In
(

48 
ut32_t
 
obje_
);

49 
By_Vue_Cou
(

51 
ut32_t
 
By_Vue_Index_To_In
(

52 
dex
);

53 
By_Vue_In_To_Index
(

54 
ut32_t
 
obje_
);

55 
bo
 
By_Vue_Obje_In_Add
(

56 
ut32_t
 

);

58 
bo
 
By_Vue_Obje_Name
(

59 
ut32_t
 
obje_
,

60 
BACNET_CHARACTER_STRING
 * 
obje_me
);

61 
bo
 
By_Vue_Name_S
(

62 
ut32_t
 
obje_
,

63 *
w_me
);

65 *
By_Vue_Desti
(

66 
ut32_t
 

);

67 
bo
 
By_Vue_Desti_S
(

68 
ut32_t
 

,

69 *
w_me
);

71 *
By_Vue_Iive_Text
(

72 
ut32_t
 

);

73 
bo
 
By_Vue_Iive_Text_S
(

74 
ut32_t
 

,

75 *
w_me
);

76 *
By_Vue_Aive_Text
(

77 
ut32_t
 

);

78 
bo
 
By_Vue_Aive_Text_S
(

79 
ut32_t
 

,

80 *
w_me
);

82 
By_Vue_Rd_Prݔty
(

83 
BACNET_READ_PROPERTY_DATA
 * 
da
);

85 
bo
 
By_Vue_Wre_Prݔty
(

86 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

88 
bo
 
By_Vue_Encode_Vue_Li
(

89 
ut32_t
 
obje_
,

90 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

91 
bo
 
By_Vue_Chge_Of_Vue
(

92 
ut32_t
 

);

93 
By_Vue_Chge_Of_Vue_Cˬ
(

94 
ut32_t
 

);

96 
BACNET_BINARY_PV
 
By_Vue_P_Vue
(

97 
ut32_t
 

);

98 
bo
 
By_Vue_P_Vue_S
(

99 
ut32_t
 

,

100 
BACNET_BINARY_PV
 
vue
);

102 
bo
 
By_Vue_Out_Of_Svi
(

103 
ut32_t
 

);

104 
By_Vue_Out_Of_Svi_S
(

105 
ut32_t
 

,

106 
bo
 
vue
);

108 *
By_Vue_Desti
(

109 
ut32_t
 

);

110 
bo
 
By_Vue_Desti_S
(

111 
ut32_t
 
obje_
,

112 *
xt_rg
);

114 *
By_Vue_Iive_Text
(

115 
ut32_t
 

);

116 
bo
 
By_Vue_Iive_Text_S
(

117 
ut32_t
 

,

118 *
w_me
);

119 *
By_Vue_Aive_Text
(

120 
ut32_t
 

);

121 
bo
 
By_Vue_Aive_Text_S
(

122 
ut32_t
 

,

123 *
w_me
);

125 
BACNET_POLARITY
 
By_Vue_Pެy
(

126 
ut32_t
 

);

127 
bo
 
By_Vue_Pެy_S
(

128 
ut32_t
 
obje_
,

129 
BACNET_POLARITY
 
pެy
);

130 
bo
 
By_Vue_Ce
(

131 
ut32_t
 
obje_
);

132 
bo
 
By_Vue_De
(

133 
ut32_t
 
obje_
);

134 
By_Vue_C˪up
(

137 #ifde
TEST


138 
	~"e.h
"

139 
By_Vue
(

140 
Te
 * 
pTe
);

143 #ifde
__lulus


	@demo/object/csv.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~".h
"

37 
	~"wp.h
"

38 
	~"csv.h
"

39 
	~"hdrs.h
"

42 #ide
MAX_CHARACTERSTRING_VALUES


43 
	#MAX_CHARACTERSTRING_VALUES
 1

	)

47 
BACNET_CHARACTER_STRING
 
	gP_Vue
[
MAX_CHARACTERSTRING_VALUES
];

49 
bo
 
	gOut_Of_Svi
[
MAX_CHARACTERSTRING_VALUES
];

50 
	gObje_Name
[
MAX_CHARACTERSTRING_VALUES
][64];

51 
	gObje_Desti
[
MAX_CHARACTERSTRING_VALUES
][64];

54 cڡ 
	gPrݔts_Requed
[] = {

55 
PROP_OBJECT_IDENTIFIER
,

56 
PROP_OBJECT_NAME
,

57 
PROP_OBJECT_TYPE
,

58 
PROP_PRESENT_VALUE
,

59 
PROP_STATUS_FLAGS
,

63 cڡ 
	gPrݔts_Oiڮ
[] = {

64 
PROP_EVENT_STATE
,

65 
PROP_OUT_OF_SERVICE
,

66 
PROP_DESCRIPTION
,

70 cڡ 
	gPrݔts_Prrry
[] = {

74 
	$ChaSg_Vue_Prݔty_Lis
(

75 cڡ **
pRequed
,

76 cڡ **
pOiڮ
,

77 cڡ **
pPrrry
)

79 i(
pRequed
)

80 *
pRequed
 = 
Prݔts_Requed
;

81 i(
pOiڮ
)

82 *
pOiڮ
 = 
Prݔts_Oiڮ
;

83 i(
pPrrry
)

84 *
pPrrry
 = 
Prݔts_Prrry
;

87 
	}
}

89 
	$ChaSg_Vue_In
(

92 
i
;

95 
i
 = 0; i < 
MAX_CHARACTERSTRING_VALUES
; i++) {

96 
	`charg__si
(&
P_Vue
[
i
], "");

100 
	}
}

105 
	$ChaSg_Vue_In_To_Index
(

106 
ut32_t
 
obje_
)

108 
dex
 = 
MAX_CHARACTERSTRING_VALUES
;

110 i(
obje_
 < 
MAX_CHARACTERSTRING_VALUES
) {

111 
dex
 = 
obje_
;

114  
dex
;

115 
	}
}

120 
ut32_t
 
	$ChaSg_Vue_Index_To_In
(

121 
dex
)

123  
dex
;

124 
	}
}

128 
	$ChaSg_Vue_Cou
(

131  
MAX_CHARACTERSTRING_VALUES
;

132 
	}
}

134 
bo
 
	$ChaSg_Vue_Vid_In
(

135 
ut32_t
 
obje_
)

137 
dex
 = 0;

139 
dex
 = 
	`ChaSg_Vue_In_To_Index
(
obje_
);

140 i(
dex
 < 
MAX_CHARACTERSTRING_VALUES
) {

141  
ue
;

144  
l
;

145 
	}
}

147 
bo
 
	$ChaSg_Vue_P_Vue
(

148 
ut32_t
 
obje_
,

149 
BACNET_CHARACTER_STRING
 * 
obje_me
)

151 
bo
 
us
 = 
l
;

152 
dex
 = 0;

154 
dex
 = 
	`ChaSg_Vue_In_To_Index
(
obje_
);

155 i(
obje_me
 && (
dex
 < 
MAX_CHARACTERSTRING_VALUES
)) {

156 
us
 = 
	`charg_cy
(
obje_me
, &
P_Vue
[
dex
]);

159  
us
;

160 
	}
}

162 
bo
 
	$ChaSg_Vue_P_Vue_S
(

163 
ut32_t
 
obje_
,

164 
BACNET_CHARACTER_STRING
 * 
obje_me
)

166 
bo
 
us
 = 
l
;

167 
dex
 = 0;

169 
dex
 = 
	`ChaSg_Vue_In_To_Index
(
obje_
);

170 i(
dex
 < 
MAX_CHARACTERSTRING_VALUES
) {

171 
us
 = 
	`charg_cy
(&
P_Vue
[
dex
], 
obje_me
);

174  
us
;

175 
	}
}

177 
bo
 
	$ChaSg_Vue_Out_Of_Svi
(

178 
ut32_t
 
obje_
)

180 
bo
 
vue
 = 
l
;

181 
dex
 = 0;

183 
dex
 = 
	`ChaSg_Vue_In_To_Index
(
obje_
);

184 i(
dex
 < 
MAX_CHARACTERSTRING_VALUES
) {

185 
vue
 = 
Out_Of_Svi
[
dex
];

188  
vue
;

189 
	}
}

191 
	$ChaSg_Vue_Out_Of_Svi_S
(

192 
ut32_t
 
obje_
,

193 
bo
 
vue
)

195 
dex
 = 0;

197 
dex
 = 
	`ChaSg_Vue_In_To_Index
(
obje_
);

198 i(
dex
 < 
MAX_CHARACTERSTRING_VALUES
) {

199 
Out_Of_Svi
[
dex
] = 
vue
;

203 
	}
}

205 *
	$ChaSg_Vue_Desti
(

206 
ut32_t
 
obje_
)

208 
dex
 = 0;

209 *
pName
 = 
NULL
;

211 
dex
 = 
	`ChaSg_Vue_In_To_Index
(
obje_
);

212 i(
dex
 < 
MAX_CHARACTERSTRING_VALUES
) {

213 
pName
 = 
Obje_Desti
[
dex
];

216  
pName
;

217 
	}
}

219 
bo
 
	$ChaSg_Vue_Desti_S
(

220 
ut32_t
 
obje_
,

221 *
w_me
)

223 
dex
 = 0;

224 
size_t
 
i
 = 0;

225 
bo
 
us
 = 
l
;

227 
dex
 = 
	`ChaSg_Vue_In_To_Index
(
obje_
);

228 i(
dex
 < 
MAX_CHARACTERSTRING_VALUES
) {

229 
us
 = 
ue
;

230 i(
w_me
) {

231 
i
 = 0; i < (
Obje_Desti
[
dex
]); i++) {

232 
Obje_Desti
[
dex
][
i
] = 
w_me
[i];

233 i(
w_me
[
i
] == 0) {

238 
i
 = 0; i < (
Obje_Desti
[
dex
]); i++) {

239 
Obje_Desti
[
dex
][
i
] = 0;

244  
us
;

245 
	}
}

247 
bo
 
	$ChaSg_Vue_Obje_Name
(

248 
ut32_t
 
obje_
,

249 
BACNET_CHARACTER_STRING
 * 
obje_me
)

251 
dex
 = 0;

252 
bo
 
us
 = 
l
;

254 
dex
 = 
	`ChaSg_Vue_In_To_Index
(
obje_
);

255 i(
dex
 < 
MAX_CHARACTERSTRING_VALUES
) {

256 
us
 = 
	`charg__si
(
obje_me
, 
Obje_Name
[
dex
]);

259  
us
;

260 
	}
}

263 
bo
 
	$ChaSg_Vue_Name_S
(

264 
ut32_t
 
obje_
,

265 *
w_me
)

267 
dex
 = 0;

268 
size_t
 
i
 = 0;

269 
bo
 
us
 = 
l
;

271 
dex
 = 
	`ChaSg_Vue_In_To_Index
(
obje_
);

272 i(
dex
 < 
MAX_CHARACTERSTRING_VALUES
) {

273 
us
 = 
ue
;

275 i(
w_me
) {

276 
i
 = 0; i < (
Obje_Name
[
dex
]); i++) {

277 
Obje_Name
[
dex
][
i
] = 
w_me
[i];

278 i(
w_me
[
i
] == 0) {

283 
i
 = 0; i < (
Obje_Name
[
dex
]); i++) {

284 
Obje_Name
[
dex
][
i
] = 0;

289  
us
;

290 
	}
}

293 
	$ChaSg_Vue_Rd_Prݔty
(

294 
BACNET_READ_PROPERTY_DATA
 * 
da
)

296 
du_n
 = 0;

297 
BACNET_BIT_STRING
 
b_rg
;

298 
BACNET_CHARACTER_STRING
 
ch_rg
;

299 
obje_dex
 = 0;

300 
bo
 
e
 = 
l
;

301 
ut8_t
 *
du
 = 
NULL
;

303 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

304 (
da
->
iti_da_n
 == 0)) {

307 
du
 = 
da
->
iti_da
;

308 
da
->
obje_ݔty
) {

309 
PROP_OBJECT_IDENTIFIER
:

310 
du_n
 =

311 
	`code_iti_obje_id
(&
du
[0],

312 
OBJECT_CHARACTERSTRING_VALUE
, 
da
->
obje_
);

316 
PROP_OBJECT_NAME
:

317 
	`ChaSg_Vue_Obje_Name
(
da
->
obje_
,

318 &
ch_rg
);

319 
du_n
 =

320 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

322 
PROP_DESCRIPTION
:

323 
	`charg__si
(&
ch_rg
,

324 
	`ChaSg_Vue_Desti
(
da
->
obje_
));

325 
du_n
 =

326 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

328 
PROP_OBJECT_TYPE
:

329 
du_n
 =

330 
	`code_iti_umed
(&
du
[0],

331 
OBJECT_CHARACTERSTRING_VALUE
);

333 
PROP_PRESENT_VALUE
:

334 
	`ChaSg_Vue_P_Vue
(
da
->
obje_
,

335 &
ch_rg
);

336 
du_n
 =

337 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

339 
PROP_STATUS_FLAGS
:

341 
	`brg_
(&
b_rg
);

342 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

343 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

344 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

345 i(
	`ChaSg_Vue_Out_Of_Svi
(
da
->
obje_
)) {

346 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
,

347 
ue
);

349 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
,

350 
l
);

352 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

354 
PROP_EVENT_STATE
:

356 
du_n
 =

357 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

359 
PROP_OUT_OF_SERVICE
:

360 
obje_dex
 =

361 
ChaSg_Vue_In_To_Index


362 (
da
->
obje_
);

363 
e
 = 
Out_Of_Svi
[
obje_dex
];

364 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

367 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

368 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

369 
du_n
 = 
BACNET_STATUS_ERROR
;

373 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_STATE_TEXT
) &&

374 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

375 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

376 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

377 
du_n
 = 
BACNET_STATUS_ERROR
;

380  
du_n
;

381 
	}
}

384 
bo
 
	$ChaSg_Vue_Wre_Prݔty
(

385 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

387 
bo
 
us
 = 
l
;

388 
n
 = 0;

389 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

392 
n
 =

393 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

394 
wp_da
->
iti_da_n
, &
vue
);

396 i(
n
 < 0) {

398 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

399 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

400  
l
;

402 
wp_da
->
obje_ݔty
) {

403 
PROP_PRESENT_VALUE
:

404 
us
 =

405 
	`WPVideArgTy
(&
vue
,

406 
BACNET_APPLICATION_TAG_CHARACTER_STRING
, &
wp_da
->
r_ass
,

407 &
wp_da
->
r_code
);

408 i(
us
) {

409 
us
 =

410 
ChaSg_Vue_P_Vue_S


411 (
wp_da
->
obje_
, &
vue
.
ty
.
Cha_Sg
);

412 i(!
us
) {

413 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

414 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

418 
PROP_OUT_OF_SERVICE
:

419 
us
 =

420 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

421 &
wp_da
->
r_ass
, &wp_da->
r_code
);

422 i(
us
) {

423 
ChaSg_Vue_Out_Of_Svi_S


424 (
wp_da
->
obje_
, 
vue
.
ty
.
Boޗn
);

427 
PROP_OBJECT_IDENTIFIER
:

428 
PROP_OBJECT_NAME
:

429 
PROP_DESCRIPTION
:

430 
PROP_OBJECT_TYPE
:

431 
PROP_STATUS_FLAGS
:

432 
PROP_EVENT_STATE
:

433 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

434 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

437 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

438 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

442  
us
;

443 
	}
}

446 #ifde
TEST


447 
	~<as.h
>

448 
	~<rg.h
>

449 
	~"e.h
"

451 
bo
 
	$WPVideArgTy
(

452 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

453 
ut8_t
 
ucExedTag
,

454 
BACNET_ERROR_CLASS
 * 
pECss
,

455 
BACNET_ERROR_CODE
 * 
pECode
)

457 
pVue
 =Value;

458 
ucExedTag
 = ucExpectedTag;

459 
pECss
 =ErrorClass;

460 
pECode
 =ErrorCode;

462  
l
;

463 
	}
}

465 
	$ChaSgVue
(

466 
Te
 * 
pTe
)

468 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

469 
n
 = 0;

470 
ut32_t
 
n_vue
 = 0;

471 
ut8_t
 
g_numb
 = 0;

472 
ut16_t
 
decoded_ty
 = 0;

473 
ut32_t
 
decoded_
 = 0;

474 
BACNET_READ_PROPERTY_DATA
 
da
;

476 
	`ChaSg_Vue_In
();

477 
da
.
iti_da
 = &
du
[0];

478 
da
.
iti_da_n
 = (
du
);

479 
da
.
obje_ty
 = 
OBJECT_CHARACTERSTRING_VALUE
;

480 
da
.
obje_
 = 1;

481 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

482 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

483 
n
 = 
	`ChaSg_Vue_Rd_Prݔty
(&
da
);

484 
	`_
(
pTe
, 
n
 != 0);

485 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

486 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

487 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

488 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

489 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

492 
	}
}

494 #ifde
TEST_CHARACTERSTRING_VALUE


495 
	$ma
(

498 
Te
 *
pTe
;

499 
bo
 
rc
;

501 
pTe
 = 
	`_
("BACÈChaSg Vue", 
NULL
);

503 
rc
 = 
	`_addTeFuni
(
pTe
, 
ChaSgVue
);

504 
	`as
(
rc
);

506 
	`_tSm
(
pTe
, 
dout
);

507 
	`_run
(
pTe
);

508 (
	`_pt
(
pTe
);

509 
	`_deroy
(
pTe
);

512 
	}
}

	@demo/object/csv.h

25 #ide
CSV_H


26 
	#CSV_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
ChaSg_Vue_Prݔty_Lis
(

40 cڡ **
pRequed
,

41 cڡ **
pOiڮ
,

42 cڡ **
pPrrry
);

44 
bo
 
ChaSg_Vue_Vid_In
(

45 
ut32_t
 
obje_
);

46 
ChaSg_Vue_Cou
(

48 
ut32_t
 
ChaSg_Vue_Index_To_In
(

49 
dex
);

50 
ChaSg_Vue_In_To_Index
(

51 
ut32_t
 

);

53 
ChaSg_Vue_Rd_Prݔty
(

54 
BACNET_READ_PROPERTY_DATA
 * 
da
);

56 
bo
 
ChaSg_Vue_Wre_Prݔty
(

57 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

60 
bo
 
ChaSg_Vue_Obje_In_Add
(

61 
ut32_t
 

);

63 
bo
 
ChaSg_Vue_Obje_Name
(

64 
ut32_t
 
obje_
,

65 
BACNET_CHARACTER_STRING
 * 
obje_me
);

66 
bo
 
ChaSg_Vue_Name_S
(

67 
ut32_t
 
obje_
,

68 *
w_me
);

70 
bo
 
ChaSg_Vue_P_Vue
(

71 
ut32_t
 
obje_
,

72 
BACNET_CHARACTER_STRING
 * 
vue
);

73 
bo
 
ChaSg_Vue_P_Vue_S
(

74 
ut32_t
 
obje_
,

75 
BACNET_CHARACTER_STRING
 * 
vue
);

76 
bo
 
ChaSg_Vue_Desti_S
(

77 
ut32_t
 
obje_
,

78 *
xt_rg
);

79 
bo
 
ChaSg_Vue_Out_Of_Svi
(

80 
ut32_t
 
obje_
);

82 
ChaSg_Vue_In
(

86 #ifde
TEST


87 
	~"e.h
"

88 
ChaSgVue
(

89 
Te
 * 
pTe
);

92 #ifde
__lulus


	@demo/object/device-client.c

31 
	~<dbo.h
>

32 
	~<dt.h
>

33 
	~<rg.h
>

34 
	~<time.h
>

36 
	~"t.h
"

37 
	~"tim.h
"

39 
	~"bacdef.h
"

40 
	~"bacdcode.h
"

41 
	~"banum.h
"

42 
	~"ba.h
"

43 
	~"cfig.h
"

44 
	~"du.h
"

45 
	~".h
"

46 
	~"vsi.h
"

47 
	~"hdrs.h
"

48 
	~"dk.h
"

49 
	~"addss.h
"

51 
	~"devi.h
"

53 #i
defed
(
__BORLANDC__
|| defed(
_WIN32
)

56 
	gtimeze
;

64 
ut32_t
 
	gObje_In_Numb
 = 260001;

65 
BACNET_CHARACTER_STRING
 
	gMy_Obje_Name
;

66 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

67 *
	gVd_Name
 = 
BACNET_VENDOR_NAME
;

68 
ut16_t
 
	gVd_Idtifr
 = 
BACNET_VENDOR_ID
;

69 *
	gMod_Name
 = "GNU";

70 *
	gAliti_Sowe_Vsi
 = "1.0";

71 *
	gLoti
 = "USA";

72 *
	gDesti
 = "commandine client";

82 
BACNET_TIME
 
	gLol_Time
;

83 
BACNET_DATE
 
	gLol_De
;

88 
t32_t
 
	gUTC_Offt
 = 5 * 60;

89 
bo
 
	gDaylight_Savgs_Stus
 = 
l
;

95 
ut32_t
 
	gDaba_Revisi
 = 0;

107 
Devi_Rd_Prݔty_Lol
(

108 
BACNET_READ_PROPERTY_DATA
 * 
da
);

109 
Roud_Devi_Rd_Prݔty_Lol
(

110 
BACNET_READ_PROPERTY_DATA
 * 
da
);

111 
bo
 
Roud_Devi_Wre_Prݔty_Lol
(

112 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

115 
obje_funis_t
 
	gObje_Tab
[] = {

116 {
OBJECT_DEVICE
,

117 
NULL
 ,

118 
Devi_Cou
,

119 
Devi_Index_To_In
,

120 
Devi_Vid_Obje_In_Numb
,

121 
Devi_Obje_Name
,

122 
Devi_Rd_Prݔty_Lol
,

123 
NULL
 ,

124 
NULL
 ,

125 
NULL
 ,

126 
NULL
 ,

127 
NULL
 ,

128 
NULL
 ,

129 
NULL
 ,

130 
NULL
 },

131 {
MAX_BACNET_OBJECT_TYPE
,

132 
NULL
 ,

133 
NULL
 ,

134 
NULL
 ,

135 
NULL
 ,

136 
NULL
 ,

137 
NULL
 ,

138 
NULL
 ,

139 
NULL
 ,

140 
NULL
 ,

141 
NULL
 ,

142 
NULL
 ,

143 
NULL
 ,

144 
NULL
 ,

145 
NULL
 }

155 
obje_funis
 *
	$Devi_Objes_Fd_Funis
(

156 
BACNET_OBJECT_TYPE
 
Obje_Ty
)

158 
obje_funis
 *
pObje
 = 
NULL
;

160 
pObje
 = &
Obje_Tab
[0];

161 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

163 i(
pObje
->
Obje_Ty
 == Object_Type) {

164  (
pObje
);

167 
pObje
++;

170  (
NULL
);

171 
	}
}

173 
	$Devi_Cou
(

177 
	}
}

179 
ut32_t
 
	$Devi_Index_To_In
(

180 
dex
)

182 
dex
 = index;

183  
Obje_In_Numb
;

184 
	}
}

194 
ut32_t
 
	$Devi_Obje_In_Numb
(

197 #ifde
BAC_ROUTING


198  
	`Roud_Devi_Obje_In_Numb
();

200  
Obje_In_Numb
;

202 
	}
}

204 
bo
 
	$Devi_S_Obje_In_Numb
(

205 
ut32_t
 
obje_id
)

207 
bo
 
us
 = 
ue
;

209 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

211 
Obje_In_Numb
 = 
obje_id
;

212 
	`Devi_Inc_Daba_Revisi
();

214 
us
 = 
l
;

216  
us
;

217 
	}
}

219 
bo
 
	$Devi_Vid_Obje_In_Numb
(

220 
ut32_t
 
obje_id
)

222  (
Obje_In_Numb
 =
obje_id
);

223 
	}
}

225 
bo
 
	$Devi_Obje_Name
(

226 
ut32_t
 
obje_
,

227 
BACNET_CHARACTER_STRING
 * 
obje_me
)

229 
bo
 
us
 = 
l
;

231 i(
obje_
 =
Obje_In_Numb
) {

232 
us
 = 
	`charg_cy
(
obje_me
, &
My_Obje_Name
);

235  
us
;

236 
	}
}

238 
bo
 
	$Devi_S_Obje_Name
(

239 
BACNET_CHARACTER_STRING
 * 
obje_me
)

241 
bo
 
us
 = 
l
;

243 i(!
	`charg_me
(&
My_Obje_Name
, 
obje_me
)) {

245 
us
 = 
	`charg_cy
(&
My_Obje_Name
, 
obje_me
);

246 
	`Devi_Inc_Daba_Revisi
();

249  
us
;

250 
	}
}

252 
BACNET_DEVICE_STATUS
 
	$Devi_Syem_Stus
(

255  
Syem_Stus
;

256 
	}
}

258 
	$Devi_S_Syem_Stus
(

259 
BACNET_DEVICE_STATUS
 
us
,

260 
bo
 
lol
)

262 
su
 = 0;

266 i(
lol
) {

267 
us
) {

268 
STATUS_OPERATIONAL
:

269 
STATUS_OPERATIONAL_READ_ONLY
:

270 
STATUS_DOWNLOAD_REQUIRED
:

271 
STATUS_DOWNLOAD_IN_PROGRESS
:

272 
STATUS_NON_OPERATIONAL
:

273 
Syem_Stus
 = 
us
;

277 
STATUS_BACKUP_IN_PROGRESS
:

278 
su
 = -2;

282 
su
 = -1;

286 
us
) {

292 
STATUS_OPERATIONAL
:

293 
STATUS_OPERATIONAL_READ_ONLY
:

294 
STATUS_NON_OPERATIONAL
:

295 
Syem_Stus
 = 
us
;

303 
STATUS_DOWNLOAD_REQUIRED
:

308 
STATUS_DOWNLOAD_IN_PROGRESS
:

310 
STATUS_BACKUP_IN_PROGRESS
:

311 
su
 = -2;

315 
su
 = -1;

320  (
su
);

321 
	}
}

323 cڡ *
	$Devi_Vd_Name
(

326  
Vd_Name
;

327 
	}
}

333 
ut16_t
 
	$Devi_Vd_Idtifr
(

336  
Vd_Idtifr
;

337 
	}
}

339 
	$Devi_S_Vd_Idtifr
(

340 
ut16_t
 
vd_id
)

342 
Vd_Idtifr
 = 
vd_id
;

343 
	}
}

345 cڡ *
	$Devi_Mod_Name
(

348  
Mod_Name
;

349 
	}
}

351 
bo
 
	$Devi_S_Mod_Name
(

352 cڡ *
me
,

353 
size_t
 
ngth
)

355 
bo
 
us
 = 
l
;

357 i(
ngth
 < (
Mod_Name
)) {

358 
	`memmove
(
Mod_Name
, 
me
, 
ngth
);

359 
Mod_Name
[
ngth
] = 0;

360 
us
 = 
ue
;

363  
us
;

364 
	}
}

366 cڡ *
	$Devi_Fmwe_Revisi
(

369  
BACt_Vsi
;

370 
	}
}

372 cڡ *
	$Devi_Aliti_Sowe_Vsi
(

375  
Aliti_Sowe_Vsi
;

376 
	}
}

378 
bo
 
	$Devi_S_Aliti_Sowe_Vsi
(

379 cڡ *
me
,

380 
size_t
 
ngth
)

382 
bo
 
us
 = 
l
;

384 i(
ngth
 < (
Aliti_Sowe_Vsi
)) {

385 
	`memmove
(
Aliti_Sowe_Vsi
, 
me
, 
ngth
);

386 
Aliti_Sowe_Vsi
[
ngth
] = 0;

387 
us
 = 
ue
;

390  
us
;

391 
	}
}

393 cڡ *
	$Devi_Desti
(

396  
Desti
;

397 
	}
}

399 
bo
 
	$Devi_S_Desti
(

400 cڡ *
me
,

401 
size_t
 
ngth
)

403 
bo
 
us
 = 
l
;

405 i(
ngth
 < (
Desti
)) {

406 
	`memmove
(
Desti
, 
me
, 
ngth
);

407 
Desti
[
ngth
] = 0;

408 
us
 = 
ue
;

411  
us
;

412 
	}
}

414 cڡ *
	$Devi_Loti
(

417  
Loti
;

418 
	}
}

420 
bo
 
	$Devi_S_Loti
(

421 cڡ *
me
,

422 
size_t
 
ngth
)

424 
bo
 
us
 = 
l
;

426 i(
ngth
 < (
Loti
)) {

427 
	`memmove
(
Loti
, 
me
, 
ngth
);

428 
Loti
[
ngth
] = 0;

429 
us
 = 
ue
;

432  
us
;

433 
	}
}

435 
ut8_t
 
	$Devi_Proc_Vsi
(

438  
BACNET_PROTOCOL_VERSION
;

439 
	}
}

441 
ut8_t
 
	$Devi_Proc_Revisi
(

444  
BACNET_PROTOCOL_REVISION
;

445 
	}
}

447 
BACNET_SEGMENTATION
 
	$Devi_Segmti_Su܋d
(

450  
SEGMENTATION_NONE
;

451 
	}
}

453 
ut32_t
 
	$Devi_Daba_Revisi
(

456  
Daba_Revisi
;

457 
	}
}

459 
	$Devi_S_Daba_Revisi
(

460 
ut32_t
 
visi
)

462 
Daba_Revisi
 = 
visi
;

463 
	}
}

470 
	$Devi_Inc_Daba_Revisi
(

473 
Daba_Revisi
++;

474 
	}
}

481 
	$Devi_Obje_Li_Cou
(

484 
cou
 = 0;

485 
obje_funis
 *
pObje
 = 
NULL
;

488 
pObje
 = &
Obje_Tab
[0];

489 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

490 i(
pObje
->
Obje_Cou
) {

491 
cou
 +
pObje
->
	`Obje_Cou
();

493 
pObje
++;

496  
cou
;

497 
	}
}

509 
bo
 
	$Devi_Obje_Li_Idtifr
(

510 
ut32_t
 
y_dex
,

511 *
obje_ty
,

512 
ut32_t
 * 

)

514 
bo
 
us
 = 
l
;

515 
cou
 = 0;

516 
obje_dex
 = 0;

517 
mp_dex
 = 0;

518 
obje_funis
 *
pObje
 = 
NULL
;

521 i(
y_dex
 == 0) {

522  
us
;

524 
obje_dex
 = 
y_dex
 - 1;

526 
pObje
 = &
Obje_Tab
[0];

527 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

528 i(
pObje
->
Obje_Cou
) {

529 
obje_dex
 -
cou
;

530 
cou
 = 
pObje
->
	`Obje_Cou
();

531 i(
obje_dex
 < 
cou
) {

534 i(
pObje
->
Obje_It
) {

536 
mp_dex
 = 
pObje
->
	`Obje_It
(~() 0);

538 
obje_dex
 != 0) {

539 
mp_dex
 = 
pObje
->
	`Obje_It
(temp_index);

540 
obje_dex
--;

543 
obje_dex
 = 
mp_dex
;

545 i(
pObje
->
Obje_Index_To_In
) {

546 *
obje_ty
 = 
pObje
->
Obje_Ty
;

547 *

 =

548 
pObje
->
	`Obje_Index_To_In
(
obje_dex
);

549 
us
 = 
ue
;

554 
pObje
++;

557  
us
;

558 
	}
}

568 
bo
 
	$Devi_Vid_Obje_Name
(

569 
BACNET_CHARACTER_STRING
 * 
obje_me1
,

570 *
obje_ty
,

571 
ut32_t
 * 
obje_
)

573 
bo
 
found
 = 
l
;

574 
ty
 = 0;

575 
ut32_t
 

;

576 
ut32_t
 
max_objes
 = 0, 
i
 = 0;

577 
bo
 
check_id
 = 
l
;

578 
BACNET_CHARACTER_STRING
 
obje_me2
;

579 
obje_funis
 *
pObje
 = 
NULL
;

581 
max_objes
 = 
	`Devi_Obje_Li_Cou
();

582 
i
 = 1; i <
max_objes
; i++) {

583 
check_id
 = 
	`Devi_Obje_Li_Idtifr
(
i
, &
ty
, &

);

584 i(
check_id
) {

585 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
ty
);

586 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL) &&

587 (
pObje
->
	`Obje_Name
(

, &
obje_me2
) &&

588 
	`charg_me
(
obje_me1
, &
obje_me2
))) {

589 
found
 = 
ue
;

590 i(
obje_ty
) {

591 *
obje_ty
 = 
ty
;

593 i(
obje_
) {

594 *
obje_
 = 

;

601  
found
;

602 
	}
}

609 
bo
 
	$Devi_Vid_Obje_Id
(

610 
obje_ty
,

611 
ut32_t
 
obje_
)

613 
bo
 
us
 = 
l
;

614 
obje_funis
 *
pObje
 = 
NULL
;

616 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

617 i((
pObje
 !
NULL
&& (pObje->
Obje_Vid_In
 != NULL)) {

618 
us
 = 
pObje
->
	`Obje_Vid_In
(
obje_
);

621  
us
;

622 
	}
}

630 
bo
 
	$Devi_Obje_Name_Cy
(

631 
BACNET_OBJECT_TYPE
 
obje_ty
,

632 
ut32_t
 
obje_
,

633 
BACNET_CHARACTER_STRING
 * 
obje_me
)

635 
obje_funis
 *
pObje
 = 
NULL
;

636 
bo
 
found
 = 
l
;

638 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

639 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL)) {

640 
found
 = 
pObje
->
	`Obje_Name
(
obje_
, 
obje_me
);

643  
found
;

644 
	}
}

646 
	$Upde_Cut_Time
(

649 
tm
 *
tblock
 = 
NULL
;

650 #i
	`defed
(
_MSC_VER
)

651 
time_t
 
tTemp
;

653 
timev
 
tv
;

668 #i
	`defed
(
_MSC_VER
)

669 
	`time
(&
tTemp
);

670 
tblock
 = (
tm
 *)
	`loime
(&
tTemp
);

672 i(
	`gtimeofday
(&
tv
, 
NULL
) == 0) {

673 
tblock
 = (
tm
 *)
	`loime
((cڡ 
time_t
 *)&
tv
.
tv_c
);

677 i(
tblock
) {

678 
	`dime_t_de
(&
Lol_De
, (
ut16_t

tblock
->
tm_yr
 + 1900,

679 (
ut8_t

tblock
->
tm_m
 + 1, (ut8_ttblock->
tm_mday
);

680 #i!
	`defed
(
_MSC_VER
)

681 
	`dime_t_time
(&
Lol_Time
, (
ut8_t

tblock
->
tm_hour
,

682 (
ut8_t

tblock
->
tm_m
, (ut8_ttblock->
tm_c
,

683 (
ut8_t
(
tv
.
tv_uc
 / 10000));

685 
	`dime_t_time
(&
Lol_Time
, (
ut8_t

tblock
->
tm_hour
,

686 (
ut8_t

tblock
->
tm_m
, (ut8_ttblock->
tm_c
, 0);

688 i(
tblock
->
tm_isd
) {

689 
Daylight_Savgs_Stus
 = 
ue
;

691 
Daylight_Savgs_Stus
 = 
l
;

694 
UTC_Offt
 = 
timeze
 / 60;

696 
	`dime_de_wdrd_t
(&
Lol_De
);

697 
	`dime_time_wdrd_t
(&
Lol_Time
);

698 
Daylight_Savgs_Stus
 = 
l
;

700 
	}
}

702 
	$Devi_gCutDeTime
(

703 
BACNET_DATE_TIME
 * 
DeTime
)

705 
	`Upde_Cut_Time
();

707 
DeTime
->
de
 = 
Lol_De
;

708 
DeTime
->
time
 = 
Lol_Time
;

709 
	}
}

711 
t32_t
 
	$Devi_UTC_Offt
()

713 
	`Upde_Cut_Time
();

715  
UTC_Offt
;

716 
	}
}

718 
bo
 
	$Devi_Daylight_Savgs_Stus
()

720  
Daylight_Savgs_Stus
;

721 
	}
}

725 
	$Devi_Rd_Prݔty_Lol
(

726 
BACNET_READ_PROPERTY_DATA
 * 
da
)

728 
du_n
 = 0;

729 
n
 = 0;

730 
BACNET_BIT_STRING
 
b_rg
;

731 
BACNET_CHARACTER_STRING
 
ch_rg
;

732 
ut32_t
 
i
 = 0;

733 
obje_ty
 = 0;

734 
ut32_t
 

 = 0;

735 
ut32_t
 
cou
 = 0;

736 
ut8_t
 *
du
 = 
NULL
;

737 
obje_funis
 *
pObje
 = 
NULL
;

738 
bo
 
found
 = 
l
;

740 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

741 (
da
->
iti_da_n
 == 0)) {

744 
du
 = 
da
->
iti_da
;

745 
da
->
obje_ݔty
) {

746 
PROP_OBJECT_IDENTIFIER
:

747 
du_n
 =

748 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_DEVICE
,

749 
Obje_In_Numb
);

751 
PROP_OBJECT_NAME
:

752 
du_n
 =

753 
	`code_iti_cha_rg
(&
du
[0], &
My_Obje_Name
);

755 
PROP_OBJECT_TYPE
:

756 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
OBJECT_DEVICE
);

758 
PROP_DESCRIPTION
:

759 
	`charg__si
(&
ch_rg
, 
Desti
);

760 
du_n
 =

761 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

763 
PROP_SYSTEM_STATUS
:

764 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
Syem_Stus
);

766 
PROP_VENDOR_NAME
:

767 
	`charg__si
(&
ch_rg
, 
Vd_Name
);

768 
du_n
 =

769 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

771 
PROP_VENDOR_IDENTIFIER
:

772 
du_n
 =

773 
	`code_iti_unsigd
(&
du
[0], 
Vd_Idtifr
);

775 
PROP_MODEL_NAME
:

776 
	`charg__si
(&
ch_rg
, 
Mod_Name
);

777 
du_n
 =

778 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

780 
PROP_FIRMWARE_REVISION
:

781 
	`charg__si
(&
ch_rg
, 
BACt_Vsi
);

782 
du_n
 =

783 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

785 
PROP_APPLICATION_SOFTWARE_VERSION
:

786 
	`charg__si
(&
ch_rg
,

787 
Aliti_Sowe_Vsi
);

788 
du_n
 =

789 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

791 
PROP_LOCATION
:

792 
	`charg__si
(&
ch_rg
, 
Loti
);

793 
du_n
 =

794 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

796 
PROP_PROTOCOL_VERSION
:

797 
du_n
 =

798 
	`code_iti_unsigd
(&
du
[0],

799 
	`Devi_Proc_Vsi
());

801 
PROP_PROTOCOL_REVISION
:

802 
du_n
 =

803 
	`code_iti_unsigd
(&
du
[0],

804 
	`Devi_Proc_Revisi
());

806 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

808 
	`brg_
(&
b_rg
);

809 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

811 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

812 
	`du_rvi_su܋d
((
BACNET_SERVICES_SUPPORTED

i
));

814 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

816 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

819 
	`brg_
(&
b_rg
);

820 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

822 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

826 
pObje
 = &
Obje_Tab
[0];

827 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

828 i((
pObje
->
Obje_Cou
&& (pObje->
	`Obje_Cou
() > 0)) {

829 
	`brg_t_b
(&
b_rg
, 
pObje
->
Obje_Ty
, 
ue
);

831 
pObje
++;

833 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

835 
PROP_OBJECT_LIST
:

836 
cou
 = 
	`Devi_Obje_Li_Cou
();

838 i(
da
->
y_dex
 == 0)

839 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

844 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

845 
i
 = 1; i <
cou
; i++) {

846 
found
 =

847 
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
,

848 &

);

849 i(
found
) {

850 
n
 =

851 
	`code_iti_obje_id
(&
du
[
du_n
],

852 
obje_ty
, 

);

853 
du_n
 +
n
;

856 i((
i
 !
cou
&& (
du_n
 + 
n
>
MAX_APDU
) {

858 
da
->
r_code
 =

859 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

860 
du_n
 = 
BACNET_STATUS_ABORT
;

865 
da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

866 
da
->
r_code
 = 
ERROR_CODE_OTHER
;

867 
du_n
 = 
BACNET_STATUS_ERROR
;

872 
found
 =

873 
	`Devi_Obje_Li_Idtifr
(
da
->
y_dex
,

874 &
obje_ty
, &

);

875 i(
found
) {

876 
du_n
 =

877 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

878 

);

880 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

881 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

882 
du_n
 = 
BACNET_STATUS_ERROR
;

886 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

887 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

889 
PROP_SEGMENTATION_SUPPORTED
:

890 
du_n
 =

891 
	`code_iti_umed
(&
du
[0],

892 
	`Devi_Segmti_Su܋d
());

894 
PROP_APDU_TIMEOUT
:

895 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_timeout
());

897 
PROP_NUMBER_OF_APDU_RETRIES
:

898 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_s
());

900 
PROP_DEVICE_ADDRESS_BINDING
:

902 
du_n
 = 
	`addss_li_code
(&
du
[0], 
MAX_APDU
);

904 
PROP_DATABASE_REVISION
:

905 
du_n
 =

906 
	`code_iti_unsigd
(&
du
[0], 
Daba_Revisi
);

908 #i
	`defed
(
BACDL_MSTP
)

909 
PROP_MAX_INFO_FRAMES
:

910 
du_n
 =

911 
	`code_iti_unsigd
(&
du
[0],

912 
	`dlmp_max_fo_ames
());

914 
PROP_MAX_MASTER
:

915 
du_n
 =

916 
	`code_iti_unsigd
(&
du
[0], 
	`dlmp_max_ma
());

919 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

922 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

923 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

924 
du_n
 = 
BACNET_STATUS_ERROR
;

928 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

929 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

930 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

931 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

932 
du_n
 = 
BACNET_STATUS_ERROR
;

935  
du_n
;

936 
	}
}

946 
	$Devi_Rd_Prݔty
(

947 
BACNET_READ_PROPERTY_DATA
 * 
da
)

949 
du_n
 = 
BACNET_STATUS_ERROR
;

950 
obje_funis
 *
pObje
 = 
NULL
;

953 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

954 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

955 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
da
->
obje_ty
);

956 i(
pObje
 !
NULL
) {

957 i(
pObje
->
Obje_Vid_In
 &&

958 
pObje
->
	`Obje_Vid_In
(
da
->
obje_
)) {

959 i(
pObje
->
Obje_Rd_Prݔty
) {

960 
du_n
 = 
pObje
->
	`Obje_Rd_Prݔty
(
da
);

963 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

964 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

967 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

968 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

971  
du_n
;

972 
	}
}

982 
	$Devi_In
(

983 
obje_funis_t
 * 
obje_b
)

985 
obje_funis
 *
pObje
 = 
NULL
;

987 
	`charg__si
(&
My_Obje_Name
, "SimpleClient");

989 (
obje_b
;

990 
pObje
 = &
Obje_Tab
[0];

991 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

992 i(
pObje
->
Obje_In
) {

993 
pObje
->
	`Obje_In
();

995 
pObje
++;

997 
	}
}

	@demo/object/device.c

29 
	~<dbo.h
>

30 
	~<dt.h
>

31 
	~<rg.h
>

32 
	~<time.h
>

33 
	~"bacdef.h
"

34 
	~"bacdcode.h
"

35 
	~"banum.h
"

36 
	~"ba.h
"

37 
	~"cfig.h
"

38 
	~"du.h
"

39 
	~"wp.h
"

40 
	~".h
"

41 
	~"dcc.h
"

42 
	~"vsi.h
"

43 
	~"devi.h
"

44 
	~"hdrs.h
"

45 
	~"dk.h
"

46 
	~"addss.h
"

48 
	~"tim.h
"

50 
	~"devi.h
"

51 
	~"ai.h
"

52 
	~"ao.h
"

53 
	~"av.h
"

54 
	~"bi.h
"

55 
	~"bo.h
"

56 
	~"bv.h
"

57 
	~"csv.h
"

58 
	~"lc.h
"

59 
	~"l.h
"

60 
	~"ms-put.h
"

61 
	~"mso.h
"

62 
	~"msv.h
"

63 
	~"osv.h
"

64 
	~"piv.h
"

65 
	~"schedu.h
"

66 
	~"dlog.h
"

67 #i
defed
(
INTRINSIC_REPORTING
)

68 
	~"nc.h
"

70 #i
defed
(
BACFILE
)

71 
	~"bacfe.h
"

75 #i
defed
(
__BORLANDC__
|| defed(
_WIN32
)

78 
	gtimeze
;

82 
Devi_Rd_Prݔty_Lol
(

83 
BACNET_READ_PROPERTY_DATA
 * 
da
);

84 
bo
 
Devi_Wre_Prݔty_Lol
(

85 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

86 
Roud_Devi_Rd_Prݔty_Lol
(

87 
BACNET_READ_PROPERTY_DATA
 * 
da
);

88 
bo
 
Roud_Devi_Wre_Prݔty_Lol
(

89 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

92 
obje_funis_t
 *
	gObje_Tab
;

94 
obje_funis_t
 
	gMy_Obje_Tab
[] = {

95 {
OBJECT_DEVICE
,

96 
NULL
 ,

97 
Devi_Cou
,

98 
Devi_Index_To_In
,

99 
Devi_Vid_Obje_In_Numb
,

100 
Devi_Obje_Name
,

101 
Devi_Rd_Prݔty_Lol
,

102 
Devi_Wre_Prݔty_Lol
,

103 
Devi_Prݔty_Lis
,

104 
DeviGRRInfo
,

105 
NULL
 ,

106 
NULL
 ,

107 
NULL
 ,

108 
NULL
 ,

109 
NULL
 },

110 {
OBJECT_ANALOG_INPUT
,

111 
Alog_Iut_In
,

112 
Alog_Iut_Cou
,

113 
Alog_Iut_Index_To_In
,

114 
Alog_Iut_Vid_In
,

115 
Alog_Iut_Obje_Name
,

116 
Alog_Iut_Rd_Prݔty
,

117 
Alog_Iut_Wre_Prݔty
,

118 
Alog_Iut_Prݔty_Lis
,

119 
NULL
 ,

120 
NULL
 ,

121 
NULL
 ,

122 
NULL
 ,

123 
NULL
 ,

124 
Alog_Iut_Irsic_Rtg
},

125 {
OBJECT_ANALOG_OUTPUT
,

126 
Alog_Ouut_In
,

127 
Alog_Ouut_Cou
,

128 
Alog_Ouut_Index_To_In
,

129 
Alog_Ouut_Vid_In
,

130 
Alog_Ouut_Obje_Name
,

131 
Alog_Ouut_Rd_Prݔty
,

132 
Alog_Ouut_Wre_Prݔty
,

133 
Alog_Ouut_Prݔty_Lis
,

134 
NULL
 ,

135 
NULL
 ,

136 
NULL
 ,

137 
NULL
 ,

138 
NULL
 ,

139 
NULL
 },

140 {
OBJECT_ANALOG_VALUE
,

141 
Alog_Vue_In
,

142 
Alog_Vue_Cou
,

143 
Alog_Vue_Index_To_In
,

144 
Alog_Vue_Vid_In
,

145 
Alog_Vue_Obje_Name
,

146 
Alog_Vue_Rd_Prݔty
,

147 
Alog_Vue_Wre_Prݔty
,

148 
Alog_Vue_Prݔty_Lis
,

149 
NULL
 ,

150 
NULL
 ,

151 
NULL
 ,

152 
NULL
 ,

153 
NULL
 ,

154 
Alog_Vue_Irsic_Rtg
},

155 {
OBJECT_BINARY_INPUT
,

156 
By_Iut_In
,

157 
By_Iut_Cou
,

158 
By_Iut_Index_To_In
,

159 
By_Iut_Vid_In
,

160 
By_Iut_Obje_Name
,

161 
By_Iut_Rd_Prݔty
,

162 
By_Iut_Wre_Prݔty
,

163 
By_Iut_Prݔty_Lis
,

164 
NULL
 ,

165 
NULL
 ,

166 
By_Iut_Encode_Vue_Li
,

167 
By_Iut_Chge_Of_Vue
,

168 
By_Iut_Chge_Of_Vue_Cˬ
,

169 
NULL
 },

170 {
OBJECT_BINARY_OUTPUT
,

171 
By_Ouut_In
,

172 
By_Ouut_Cou
,

173 
By_Ouut_Index_To_In
,

174 
By_Ouut_Vid_In
,

175 
By_Ouut_Obje_Name
,

176 
By_Ouut_Rd_Prݔty
,

177 
By_Ouut_Wre_Prݔty
,

178 
By_Ouut_Prݔty_Lis
,

179 
NULL
 ,

180 
NULL
 ,

181 
NULL
 ,

182 
NULL
 ,

183 
NULL
 ,

184 
NULL
 },

185 {
OBJECT_BINARY_VALUE
,

186 
By_Vue_In
,

187 
By_Vue_Cou
,

188 
By_Vue_Index_To_In
,

189 
By_Vue_Vid_In
,

190 
By_Vue_Obje_Name
,

191 
By_Vue_Rd_Prݔty
,

192 
By_Vue_Wre_Prݔty
,

193 
By_Vue_Prݔty_Lis
,

194 
NULL
 ,

195 
NULL
 ,

196 
NULL
 ,

197 
NULL
 ,

198 
NULL
 ,

199 
NULL
 },

201 {
OBJECT_CHARACTERSTRING_VALUE
,

202 
ChaSg_Vue_In
,

203 
ChaSg_Vue_Cou
,

204 
ChaSg_Vue_Index_To_In
,

205 
ChaSg_Vue_Vid_In
,

206 
ChaSg_Vue_Obje_Name
,

207 
ChaSg_Vue_Rd_Prݔty
,

208 
ChaSg_Vue_Wre_Prݔty
,

209 
ChaSg_Vue_Prݔty_Lis
,

210 
NULL
 ,

211 
NULL
 ,

212 
NULL
 ,

213 
NULL
 ,

214 
NULL
 ,

215 
NULL
 },

217 #i
defed
(
INTRINSIC_REPORTING
)

218 {
OBJECT_NOTIFICATION_CLASS
,

219 
Nifiti_Css_In
,

220 
Nifiti_Css_Cou
,

221 
Nifiti_Css_Index_To_In
,

222 
Nifiti_Css_Vid_In
,

223 
Nifiti_Css_Obje_Name
,

224 
Nifiti_Css_Rd_Prݔty
,

225 
Nifiti_Css_Wre_Prݔty
,

226 
Nifiti_Css_Prݔty_Lis
,

227 
NULL
 ,

228 
NULL
 ,

229 
NULL
 ,

230 
NULL
 ,

231 
NULL
 ,

232 
NULL
 },

234 {
OBJECT_LIFE_SAFETY_POINT
,

235 
Li_Saty_Pot_In
,

236 
Li_Saty_Pot_Cou
,

237 
Li_Saty_Pot_Index_To_In
,

238 
Li_Saty_Pot_Vid_In
,

239 
Li_Saty_Pot_Obje_Name
,

240 
Li_Saty_Pot_Rd_Prݔty
,

241 
Li_Saty_Pot_Wre_Prݔty
,

242 
Li_Saty_Pot_Prݔty_Lis
,

243 
NULL
 ,

244 
NULL
 ,

245 
NULL
 ,

246 
NULL
 ,

247 
NULL
 ,

248 
NULL
 },

249 {
OBJECT_LOAD_CONTROL
,

250 
Ld_Cڌ_In
,

251 
Ld_Cڌ_Cou
,

252 
Ld_Cڌ_Index_To_In
,

253 
Ld_Cڌ_Vid_In
,

254 
Ld_Cڌ_Obje_Name
,

255 
Ld_Cڌ_Rd_Prݔty
,

256 
Ld_Cڌ_Wre_Prݔty
,

257 
Ld_Cڌ_Prݔty_Lis
,

258 
NULL
 ,

259 
NULL
 ,

260 
NULL
 ,

261 
NULL
 ,

262 
NULL
 ,

263 
NULL
 },

264 {
OBJECT_MULTI_STATE_INPUT
,

265 
Muie_Iut_In
,

266 
Muie_Iut_Cou
,

267 
Muie_Iut_Index_To_In
,

268 
Muie_Iut_Vid_In
,

269 
Muie_Iut_Obje_Name
,

270 
Muie_Iut_Rd_Prݔty
,

271 
Muie_Iut_Wre_Prݔty
,

272 
Muie_Iut_Prݔty_Lis
,

273 
NULL
 ,

274 
NULL
 ,

275 
NULL
 ,

276 
NULL
 ,

277 
NULL
 ,

278 
NULL
 },

279 {
OBJECT_MULTI_STATE_OUTPUT
,

280 
Muie_Ouut_In
,

281 
Muie_Ouut_Cou
,

282 
Muie_Ouut_Index_To_In
,

283 
Muie_Ouut_Vid_In
,

284 
Muie_Ouut_Obje_Name
,

285 
Muie_Ouut_Rd_Prݔty
,

286 
Muie_Ouut_Wre_Prݔty
,

287 
Muie_Ouut_Prݔty_Lis
,

288 
NULL
 ,

289 
NULL
 ,

290 
NULL
 ,

291 
NULL
 ,

292 
NULL
 ,

293 
NULL
 },

294 {
OBJECT_MULTI_STATE_VALUE
,

295 
Muie_Vue_In
,

296 
Muie_Vue_Cou
,

297 
Muie_Vue_Index_To_In
,

298 
Muie_Vue_Vid_In
,

299 
Muie_Vue_Obje_Name
,

300 
Muie_Vue_Rd_Prݔty
,

301 
Muie_Vue_Wre_Prݔty
,

302 
Muie_Vue_Prݔty_Lis
,

303 
NULL
 ,

304 
NULL
 ,

305 
NULL
 ,

306 
NULL
 ,

307 
NULL
 ,

308 
NULL
 },

309 {
OBJECT_TRENDLOG
,

310 
Tnd_Log_In
,

311 
Tnd_Log_Cou
,

312 
Tnd_Log_Index_To_In
,

313 
Tnd_Log_Vid_In
,

314 
Tnd_Log_Obje_Name
,

315 
Tnd_Log_Rd_Prݔty
,

316 
Tnd_Log_Wre_Prݔty
,

317 
Tnd_Log_Prݔty_Lis
,

318 
TndLogGRRInfo
,

319 
NULL
 ,

320 
NULL
 ,

321 
NULL
 ,

322 
NULL
 ,

323 
NULL
 },

324 #i
defed
(
BACFILE
)

325 {
OBJECT_FILE
,

326 
bacfe_
,

327 
bacfe_cou
,

328 
bacfe_dex_to_
,

329 
bacfe_vid_
,

330 
bacfe_obje_me
,

331 
bacfe_ad_ݔty
,

332 
bacfe_wre_ݔty
,

333 
BACfe_Prݔty_Lis
,

334 
NULL
 ,

335 
NULL
 ,

336 
NULL
 ,

337 
NULL
 ,

338 
NULL
 ,

339 
NULL
 },

341 {
OBJECT_OCTETSTRING_VALUE
,

342 
OSg_Vue_In
,

343 
OSg_Vue_Cou
,

344 
OSg_Vue_Index_To_In
,

345 
OSg_Vue_Vid_In
,

346 
OSg_Vue_Obje_Name
,

347 
OSg_Vue_Rd_Prݔty
,

348 
OSg_Vue_Wre_Prݔty
,

349 
OSg_Vue_Prݔty_Lis
,

350 
NULL
 ,

351 
NULL
 ,

352 
NULL
 ,

353 
NULL
 ,

354 
NULL
 ,

355 
NULL
 },

356 {
OBJECT_POSITIVE_INTEGER_VALUE
,

357 
PosiveIeg_Vue_In
,

358 
PosiveIeg_Vue_Cou
,

359 
PosiveIeg_Vue_Index_To_In
,

360 
PosiveIeg_Vue_Vid_In
,

361 
PosiveIeg_Vue_Obje_Name
,

362 
PosiveIeg_Vue_Rd_Prݔty
,

363 
PosiveIeg_Vue_Wre_Prݔty
,

364 
PosiveIeg_Vue_Prݔty_Lis
,

365 
NULL
 ,

366 
NULL
 ,

367 
NULL
 ,

368 
NULL
 ,

369 
NULL
 ,

370 
NULL
 },

371 {
OBJECT_SCHEDULE
,

372 
Schedu_In
,

373 
Schedu_Cou
,

374 
Schedu_Index_To_In
,

375 
Schedu_Vid_In
,

376 
Schedu_Obje_Name
,

377 
Schedu_Rd_Prݔty
,

378 
Schedu_Wre_Prݔty
,

379 
Schedu_Prݔty_Lis
,

380 
NULL
 ,

381 
NULL
 ,

382 
NULL
 ,

383 
NULL
 ,

384 
NULL
 ,

385 
NULL
 },

386 {
MAX_BACNET_OBJECT_TYPE
,

387 
NULL
 ,

388 
NULL
 ,

389 
NULL
 ,

390 
NULL
 ,

391 
NULL
 ,

392 
NULL
 ,

393 
NULL
 ,

394 
NULL
 ,

395 
NULL
 ,

396 
NULL
 ,

397 
NULL
 ,

398 
NULL
 ,

399 
NULL
 ,

400 
NULL
 }

410 
obje_funis
 *
	$Devi_Objes_Fd_Funis
(

411 
BACNET_OBJECT_TYPE
 
Obje_Ty
)

413 
obje_funis
 *
pObje
 = 
NULL
;

415 
pObje
 = 
Obje_Tab
;

416 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

418 i(
pObje
->
Obje_Ty
 == Object_Type) {

419  (
pObje
);

421 
pObje
++;

424  (
NULL
);

425 
	}
}

436 
_fo_funi
 
	$Devi_Objes_RR_Info
(

437 
BACNET_OBJECT_TYPE
 
obje_ty
)

439 
obje_funis
 *
pObje
 = 
NULL
;

441 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

442  (
pObje
 !
NULL
 ?Obje->
Obje_RR_Info
 : NULL);

443 
	}
}

456 
	$Devi_Objes_Prݔty_Li
(

457 
BACNET_OBJECT_TYPE
 
obje_ty
,

458 
ecl_ݔty_li_t
 *
pPrݔtyLi
)

460 
obje_funis
 *
pObje
 = 
NULL
;

462 
pPrݔtyLi
->
Requed
.
pLi
 = 
NULL
;

463 
pPrݔtyLi
->
Oiڮ
.
pLi
 = 
NULL
;

464 
pPrݔtyLi
->
Prrry
.
pLi
 = 
NULL
;

471 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

472 i((
pObje
 !
NULL
&& (pObje->
Obje_RPM_Li
 != NULL)) {

473 
pObje
->
	`Obje_RPM_Li
(&
pPrݔtyLi
->
Requed
.
pLi
,

474 &
pPrݔtyLi
->
Oiڮ
.
pLi
, &pPrݔtyLi->
Prrry
.pList);

478 
pPrݔtyLi
->
Requed
.
cou
 =

479 
pPrݔtyLi
->
Requed
.
pLi
 ==

480 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Requed
.
pLi
);

482 
pPrݔtyLi
->
Oiڮ
.
cou
 =

483 
pPrݔtyLi
->
Oiڮ
.
pLi
 ==

484 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Oiڮ
.
pLi
);

486 
pPrݔtyLi
->
Prrry
.
cou
 =

487 
pPrݔtyLi
->
Prrry
.
pLi
 ==

488 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Prrry
.
pLi
);

491 
	}
}

494 cڡ 
	gDevi_Prݔts_Requed
[] = {

495 
PROP_OBJECT_IDENTIFIER
,

496 
PROP_OBJECT_NAME
,

497 
PROP_OBJECT_TYPE
,

498 
PROP_SYSTEM_STATUS
,

499 
PROP_VENDOR_NAME
,

500 
PROP_VENDOR_IDENTIFIER
,

501 
PROP_MODEL_NAME
,

502 
PROP_FIRMWARE_REVISION
,

503 
PROP_APPLICATION_SOFTWARE_VERSION
,

504 
PROP_PROTOCOL_VERSION
,

505 
PROP_PROTOCOL_REVISION
,

506 
PROP_PROTOCOL_SERVICES_SUPPORTED
,

507 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

508 
PROP_OBJECT_LIST
,

509 
PROP_MAX_APDU_LENGTH_ACCEPTED
,

510 
PROP_SEGMENTATION_SUPPORTED
,

511 
PROP_APDU_TIMEOUT
,

512 
PROP_NUMBER_OF_APDU_RETRIES
,

513 
PROP_DEVICE_ADDRESS_BINDING
,

514 
PROP_DATABASE_REVISION
,

518 cڡ 
	gDevi_Prݔts_Oiڮ
[] = {

519 #i
defed
(
BACDL_MSTP
)

520 
PROP_MAX_MASTER
,

521 
PROP_MAX_INFO_FRAMES
,

523 
PROP_DESCRIPTION
,

524 
PROP_LOCAL_TIME
,

525 
PROP_UTC_OFFSET
,

526 
PROP_LOCAL_DATE
,

527 
PROP_DAYLIGHT_SAVINGS_STATUS
,

528 
PROP_LOCATION
,

529 
PROP_ACTIVE_COV_SUBSCRIPTIONS
,

533 cڡ 
	gDevi_Prݔts_Prrry
[] = {

537 
	$Devi_Prݔty_Lis
(

538 cڡ **
pRequed
,

539 cڡ **
pOiڮ
,

540 cڡ **
pPrrry
)

542 i(
pRequed
)

543 *
pRequed
 = 
Devi_Prݔts_Requed
;

544 i(
pOiڮ
)

545 *
pOiڮ
 = 
Devi_Prݔts_Oiڮ
;

546 i(
pPrrry
)

547 *
pPrrry
 = 
Devi_Prݔts_Prrry
;

550 
	}
}

557 
ut32_t
 
	gObje_In_Numb
 = 260001;

558 
BACNET_CHARACTER_STRING
 
	gMy_Obje_Name
;

559 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

560 *
	gVd_Name
 = 
BACNET_VENDOR_NAME
;

561 
ut16_t
 
	gVd_Idtifr
 = 
BACNET_VENDOR_ID
;

562 
	gMod_Name
[
MAX_DEV_MOD_LEN
 + 1] = "GNU";

563 
	gAliti_Sowe_Vsi
[
MAX_DEV_VER_LEN
 + 1] = "1.0";

564 
	gLoti
[
MAX_DEV_LOC_LEN
 + 1] = "USA";

565 
	gDesti
[
MAX_DEV_DESC_LEN
 + 1] = "server";

575 
BACNET_TIME
 
	gLol_Time
;

576 
BACNET_DATE
 
	gLol_De
;

581 
t32_t
 
	gUTC_Offt
 = 5 * 60;

582 
bo
 
	gDaylight_Savgs_Stus
 = 
l
;

588 
ut32_t
 
	gDaba_Revisi
 = 0;

598 
BACNET_REINITIALIZED_STATE
 
	gRelize_S
 = 
BACNET_REINIT_IDLE
;

599 cڡ *
	gRe_Passwd
 = "filister";

614 
bo
 
	$Devi_Relize
(

615 
BACNET_REINITIALIZE_DEVICE_DATA
 * 
rd_da
)

617 
bo
 
us
 = 
l
;

620 i(
	`charg_si_me
(&
rd_da
->
sswd
, 
Re_Passwd
)) {

621 
rd_da
->
e
) {

622 
BACNET_REINIT_COLDSTART
:

623 
BACNET_REINIT_WARMSTART
:

624 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

628 
Relize_S
 = 
rd_da
->
e
;

629 
us
 = 
ue
;

631 
BACNET_REINIT_STARTBACKUP
:

632 
BACNET_REINIT_ENDBACKUP
:

633 
BACNET_REINIT_STARTRESTORE
:

634 
BACNET_REINIT_ENDRESTORE
:

635 
BACNET_REINIT_ABORTRESTORE
:

636 i(
	`dcc_communiti_dibd
()) {

637 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

638 
rd_da
->
r_code
 = 
ERROR_CODE_COMMUNICATION_DISABLED
;

640 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

641 
rd_da
->
r_code
 =

642 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

646 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

647 
rd_da
->
r_code
 = 
ERROR_CODE_PARAMETER_OUT_OF_RANGE
;

651 
rd_da
->
r_ass
 = 
ERROR_CLASS_SECURITY
;

652 
rd_da
->
r_code
 = 
ERROR_CODE_PASSWORD_FAILURE
;

655  
us
;

656 
	}
}

658 
BACNET_REINITIALIZED_STATE
 
	$Devi_Relized_S
(

661  
Relize_S
;

662 
	}
}

664 
	$Devi_Cou
(

668 
	}
}

670 
ut32_t
 
	$Devi_Index_To_In
(

671 
dex
)

673 
dex
 = index;

674  
Obje_In_Numb
;

675 
	}
}

685 
ut32_t
 
	$Devi_Obje_In_Numb
(

688 #ifde
BAC_ROUTING


689  
	`Roud_Devi_Obje_In_Numb
();

691  
Obje_In_Numb
;

693 
	}
}

695 
bo
 
	$Devi_S_Obje_In_Numb
(

696 
ut32_t
 
obje_id
)

698 
bo
 
us
 = 
ue
;

700 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

702 
Obje_In_Numb
 = 
obje_id
;

703 
	`Devi_Inc_Daba_Revisi
();

705 
us
 = 
l
;

707  
us
;

708 
	}
}

710 
bo
 
	$Devi_Vid_Obje_In_Numb
(

711 
ut32_t
 
obje_id
)

713  (
Obje_In_Numb
 =
obje_id
);

714 
	}
}

716 
bo
 
	$Devi_Obje_Name
(

717 
ut32_t
 
obje_
,

718 
BACNET_CHARACTER_STRING
 * 
obje_me
)

720 
bo
 
us
 = 
l
;

722 i(
obje_
 =
Obje_In_Numb
) {

723 
us
 = 
	`charg_cy
(
obje_me
, &
My_Obje_Name
);

726  
us
;

727 
	}
}

729 
bo
 
	$Devi_S_Obje_Name
(

730 
BACNET_CHARACTER_STRING
 * 
obje_me
)

732 
bo
 
us
 = 
l
;

734 i(!
	`charg_me
(&
My_Obje_Name
, 
obje_me
)) {

736 
us
 = 
	`charg_cy
(&
My_Obje_Name
, 
obje_me
);

737 
	`Devi_Inc_Daba_Revisi
();

740  
us
;

741 
	}
}

743 
BACNET_DEVICE_STATUS
 
	$Devi_Syem_Stus
(

746  
Syem_Stus
;

747 
	}
}

749 
	$Devi_S_Syem_Stus
(

750 
BACNET_DEVICE_STATUS
 
us
,

751 
bo
 
lol
)

753 
su
 = 0;

757 i(
lol
) {

758 
us
) {

759 
STATUS_OPERATIONAL
:

760 
STATUS_OPERATIONAL_READ_ONLY
:

761 
STATUS_DOWNLOAD_REQUIRED
:

762 
STATUS_DOWNLOAD_IN_PROGRESS
:

763 
STATUS_NON_OPERATIONAL
:

764 
Syem_Stus
 = 
us
;

768 
STATUS_BACKUP_IN_PROGRESS
:

769 
su
 = -2;

773 
su
 = -1;

777 
us
) {

783 
STATUS_OPERATIONAL
:

784 
STATUS_OPERATIONAL_READ_ONLY
:

785 
STATUS_NON_OPERATIONAL
:

786 
Syem_Stus
 = 
us
;

794 
STATUS_DOWNLOAD_REQUIRED
:

799 
STATUS_DOWNLOAD_IN_PROGRESS
:

801 
STATUS_BACKUP_IN_PROGRESS
:

802 
su
 = -2;

806 
su
 = -1;

811  (
su
);

812 
	}
}

814 cڡ *
	$Devi_Vd_Name
(

817  
Vd_Name
;

818 
	}
}

824 
ut16_t
 
	$Devi_Vd_Idtifr
(

827  
Vd_Idtifr
;

828 
	}
}

830 
	$Devi_S_Vd_Idtifr
(

831 
ut16_t
 
vd_id
)

833 
Vd_Idtifr
 = 
vd_id
;

834 
	}
}

836 cڡ *
	$Devi_Mod_Name
(

839  
Mod_Name
;

840 
	}
}

842 
bo
 
	$Devi_S_Mod_Name
(

843 cڡ *
me
,

844 
size_t
 
ngth
)

846 
bo
 
us
 = 
l
;

848 i(
ngth
 < (
Mod_Name
)) {

849 
	`memmove
(
Mod_Name
, 
me
, 
ngth
);

850 
Mod_Name
[
ngth
] = 0;

851 
us
 = 
ue
;

854  
us
;

855 
	}
}

857 cڡ *
	$Devi_Fmwe_Revisi
(

860  
BACt_Vsi
;

861 
	}
}

863 cڡ *
	$Devi_Aliti_Sowe_Vsi
(

866  
Aliti_Sowe_Vsi
;

867 
	}
}

869 
bo
 
	$Devi_S_Aliti_Sowe_Vsi
(

870 cڡ *
me
,

871 
size_t
 
ngth
)

873 
bo
 
us
 = 
l
;

875 i(
ngth
 < (
Aliti_Sowe_Vsi
)) {

876 
	`memmove
(
Aliti_Sowe_Vsi
, 
me
, 
ngth
);

877 
Aliti_Sowe_Vsi
[
ngth
] = 0;

878 
us
 = 
ue
;

881  
us
;

882 
	}
}

884 cڡ *
	$Devi_Desti
(

887  
Desti
;

888 
	}
}

890 
bo
 
	$Devi_S_Desti
(

891 cڡ *
me
,

892 
size_t
 
ngth
)

894 
bo
 
us
 = 
l
;

896 i(
ngth
 < (
Desti
)) {

897 
	`memmove
(
Desti
, 
me
, 
ngth
);

898 
Desti
[
ngth
] = 0;

899 
us
 = 
ue
;

902  
us
;

903 
	}
}

905 cڡ *
	$Devi_Loti
(

908  
Loti
;

909 
	}
}

911 
bo
 
	$Devi_S_Loti
(

912 cڡ *
me
,

913 
size_t
 
ngth
)

915 
bo
 
us
 = 
l
;

917 i(
ngth
 < (
Loti
)) {

918 
	`memmove
(
Loti
, 
me
, 
ngth
);

919 
Loti
[
ngth
] = 0;

920 
us
 = 
ue
;

923  
us
;

924 
	}
}

926 
ut8_t
 
	$Devi_Proc_Vsi
(

929  
BACNET_PROTOCOL_VERSION
;

930 
	}
}

932 
ut8_t
 
	$Devi_Proc_Revisi
(

935  
BACNET_PROTOCOL_REVISION
;

936 
	}
}

938 
BACNET_SEGMENTATION
 
	$Devi_Segmti_Su܋d
(

941  
SEGMENTATION_NONE
;

942 
	}
}

944 
ut32_t
 
	$Devi_Daba_Revisi
(

947  
Daba_Revisi
;

948 
	}
}

950 
	$Devi_S_Daba_Revisi
(

951 
ut32_t
 
visi
)

953 
Daba_Revisi
 = 
visi
;

954 
	}
}

961 
	$Devi_Inc_Daba_Revisi
(

964 
Daba_Revisi
++;

965 
	}
}

972 
	$Devi_Obje_Li_Cou
(

975 
cou
 = 0;

976 
obje_funis
 *
pObje
 = 
NULL
;

979 
pObje
 = 
Obje_Tab
;

980 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

981 i(
pObje
->
Obje_Cou
) {

982 
cou
 +
pObje
->
	`Obje_Cou
();

984 
pObje
++;

987  
cou
;

988 
	}
}

1000 
bo
 
	$Devi_Obje_Li_Idtifr
(

1001 
ut32_t
 
y_dex
,

1002 *
obje_ty
,

1003 
ut32_t
 * 

)

1005 
bo
 
us
 = 
l
;

1006 
ut32_t
 
cou
 = 0;

1007 
ut32_t
 
obje_dex
 = 0;

1008 
ut32_t
 
mp_dex
 = 0;

1009 
obje_funis
 *
pObje
 = 
NULL
;

1012 i(
y_dex
 == 0) {

1013  
us
;

1015 
obje_dex
 = 
y_dex
 - 1;

1017 
pObje
 = 
Obje_Tab
;

1018 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

1019 i(
pObje
->
Obje_Cou
) {

1020 
obje_dex
 -
cou
;

1021 
cou
 = 
pObje
->
	`Obje_Cou
();

1022 i(
obje_dex
 < 
cou
) {

1025 i(
pObje
->
Obje_It
) {

1027 
mp_dex
 = 
pObje
->
	`Obje_It
(~() 0);

1029 
obje_dex
 != 0) {

1030 
mp_dex
 = 
pObje
->
	`Obje_It
(temp_index);

1031 
obje_dex
--;

1034 
obje_dex
 = 
mp_dex
;

1036 i(
pObje
->
Obje_Index_To_In
) {

1037 *
obje_ty
 = 
pObje
->
Obje_Ty
;

1038 *

 =

1039 
pObje
->
	`Obje_Index_To_In
(
obje_dex
);

1040 
us
 = 
ue
;

1045 
pObje
++;

1048  
us
;

1049 
	}
}

1059 
bo
 
	$Devi_Vid_Obje_Name
(

1060 
BACNET_CHARACTER_STRING
 * 
obje_me1
,

1061 *
obje_ty
,

1062 
ut32_t
 * 
obje_
)

1064 
bo
 
found
 = 
l
;

1065 
ty
 = 0;

1066 
ut32_t
 

;

1067 
ut32_t
 
max_objes
 = 0, 
i
 = 0;

1068 
bo
 
check_id
 = 
l
;

1069 
BACNET_CHARACTER_STRING
 
obje_me2
;

1070 
obje_funis
 *
pObje
 = 
NULL
;

1072 
max_objes
 = 
	`Devi_Obje_Li_Cou
();

1073 
i
 = 1; i <
max_objes
; i++) {

1074 
check_id
 = 
	`Devi_Obje_Li_Idtifr
(
i
, &
ty
, &

);

1075 i(
check_id
) {

1076 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
ty
);

1077 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL) &&

1078 (
pObje
->
	`Obje_Name
(

, &
obje_me2
) &&

1079 
	`charg_me
(
obje_me1
, &
obje_me2
))) {

1080 
found
 = 
ue
;

1081 i(
obje_ty
) {

1082 *
obje_ty
 = 
ty
;

1084 i(
obje_
) {

1085 *
obje_
 = 

;

1092  
found
;

1093 
	}
}

1100 
bo
 
	$Devi_Vid_Obje_Id
(

1101 
obje_ty
,

1102 
ut32_t
 
obje_
)

1104 
bo
 
us
 = 
l
;

1105 
obje_funis
 *
pObje
 = 
NULL
;

1107 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1108 i((
pObje
 !
NULL
&& (pObje->
Obje_Vid_In
 != NULL)) {

1109 
us
 = 
pObje
->
	`Obje_Vid_In
(
obje_
);

1112  
us
;

1113 
	}
}

1121 
bo
 
	$Devi_Obje_Name_Cy
(

1122 
BACNET_OBJECT_TYPE
 
obje_ty
,

1123 
ut32_t
 
obje_
,

1124 
BACNET_CHARACTER_STRING
 * 
obje_me
)

1126 
obje_funis
 *
pObje
 = 
NULL
;

1127 
bo
 
found
 = 
l
;

1129 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1130 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL)) {

1131 
found
 = 
pObje
->
	`Obje_Name
(
obje_
, 
obje_me
);

1134  
found
;

1135 
	}
}

1137 
	$Upde_Cut_Time
(

1140 
tm
 *
tblock
 = 
NULL
;

1141 #i
	`defed
(
_MSC_VER
)

1142 
time_t
 
tTemp
;

1144 
timev
 
tv
;

1159 #i
	`defed
(
_MSC_VER
)

1160 
	`time
(&
tTemp
);

1161 
tblock
 = 
	`loime
(&
tTemp
);

1163 i(
	`gtimeofday
(&
tv
, 
NULL
) == 0) {

1164 
tblock
 = 
	`loime
(&
tv
.
tv_c
);

1168 i(
tblock
) {

1169 
	`dime_t_de
(&
Lol_De
, (
ut16_t

tblock
->
tm_yr
 + 1900,

1170 (
ut8_t

tblock
->
tm_m
 + 1, (ut8_ttblock->
tm_mday
);

1171 #i!
	`defed
(
_MSC_VER
)

1172 
	`dime_t_time
(&
Lol_Time
, (
ut8_t

tblock
->
tm_hour
,

1173 (
ut8_t

tblock
->
tm_m
, (ut8_ttblock->
tm_c
,

1174 (
ut8_t
(
tv
.
tv_uc
 / 10000));

1176 
	`dime_t_time
(&
Lol_Time
, (
ut8_t

tblock
->
tm_hour
,

1177 (
ut8_t

tblock
->
tm_m
, (ut8_ttblock->
tm_c
, 0);

1179 i(
tblock
->
tm_isd
) {

1180 
Daylight_Savgs_Stus
 = 
ue
;

1182 
Daylight_Savgs_Stus
 = 
l
;

1185 
UTC_Offt
 = 
timeze
 / 60;

1187 
	`dime_de_wdrd_t
(&
Lol_De
);

1188 
	`dime_time_wdrd_t
(&
Lol_Time
);

1189 
Daylight_Savgs_Stus
 = 
l
;

1191 
	}
}

1193 
	$Devi_gCutDeTime
(

1194 
BACNET_DATE_TIME
 * 
DeTime
)

1196 
	`Upde_Cut_Time
();

1198 
DeTime
->
de
 = 
Lol_De
;

1199 
DeTime
->
time
 = 
Lol_Time
;

1200 
	}
}

1202 
t32_t
 
	$Devi_UTC_Offt
()

1204 
	`Upde_Cut_Time
();

1206  
UTC_Offt
;

1207 
	}
}

1209 
bo
 
	$Devi_Daylight_Savgs_Stus
()

1211  
Daylight_Savgs_Stus
;

1212 
	}
}

1216 
	$Devi_Rd_Prݔty_Lol
(

1217 
BACNET_READ_PROPERTY_DATA
 * 
da
)

1219 
du_n
 = 0;

1220 
n
 = 0;

1221 
BACNET_BIT_STRING
 
b_rg
 = { 0 };

1222 
BACNET_CHARACTER_STRING
 
ch_rg
 = { 0 };

1223 
ut32_t
 
i
 = 0;

1224 
obje_ty
 = 0;

1225 
ut32_t
 

 = 0;

1226 
ut32_t
 
cou
 = 0;

1227 
ut8_t
 *
du
 = 
NULL
;

1228 
obje_funis
 *
pObje
 = 
NULL
;

1229 
bo
 
found
 = 
l
;

1231 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

1232 (
da
->
iti_da_n
 == 0)) {

1235 
du
 = 
da
->
iti_da
;

1236 
da
->
obje_ݔty
) {

1237 
PROP_OBJECT_IDENTIFIER
:

1238 
du_n
 =

1239 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_DEVICE
,

1240 
Obje_In_Numb
);

1242 
PROP_OBJECT_NAME
:

1243 
du_n
 =

1244 
	`code_iti_cha_rg
(&
du
[0], &
My_Obje_Name
);

1246 
PROP_OBJECT_TYPE
:

1247 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
OBJECT_DEVICE
);

1249 
PROP_DESCRIPTION
:

1250 
	`charg__si
(&
ch_rg
, 
Desti
);

1251 
du_n
 =

1252 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

1254 
PROP_SYSTEM_STATUS
:

1255 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
Syem_Stus
);

1257 
PROP_VENDOR_NAME
:

1258 
	`charg__si
(&
ch_rg
, 
Vd_Name
);

1259 
du_n
 =

1260 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

1262 
PROP_VENDOR_IDENTIFIER
:

1263 
du_n
 =

1264 
	`code_iti_unsigd
(&
du
[0], 
Vd_Idtifr
);

1266 
PROP_MODEL_NAME
:

1267 
	`charg__si
(&
ch_rg
, 
Mod_Name
);

1268 
du_n
 =

1269 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

1271 
PROP_FIRMWARE_REVISION
:

1272 
	`charg__si
(&
ch_rg
, 
BACt_Vsi
);

1273 
du_n
 =

1274 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

1276 
PROP_APPLICATION_SOFTWARE_VERSION
:

1277 
	`charg__si
(&
ch_rg
,

1278 
Aliti_Sowe_Vsi
);

1279 
du_n
 =

1280 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

1282 
PROP_LOCATION
:

1283 
	`charg__si
(&
ch_rg
, 
Loti
);

1284 
du_n
 =

1285 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

1287 
PROP_LOCAL_TIME
:

1288 
	`Upde_Cut_Time
();

1289 
du_n
 = 
	`code_iti_time
(&
du
[0], &
Lol_Time
);

1291 
PROP_UTC_OFFSET
:

1292 
	`Upde_Cut_Time
();

1293 
du_n
 = 
	`code_iti_sigd
(&
du
[0], 
UTC_Offt
);

1295 
PROP_LOCAL_DATE
:

1296 
	`Upde_Cut_Time
();

1297 
du_n
 = 
	`code_iti_de
(&
du
[0], &
Lol_De
);

1299 
PROP_DAYLIGHT_SAVINGS_STATUS
:

1300 
	`Upde_Cut_Time
();

1301 
du_n
 =

1302 
	`code_iti_boޗn
(&
du
[0], 
Daylight_Savgs_Stus
);

1304 
PROP_PROTOCOL_VERSION
:

1305 
du_n
 =

1306 
	`code_iti_unsigd
(&
du
[0],

1307 
	`Devi_Proc_Vsi
());

1309 
PROP_PROTOCOL_REVISION
:

1310 
du_n
 =

1311 
	`code_iti_unsigd
(&
du
[0],

1312 
	`Devi_Proc_Revisi
());

1314 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

1316 
	`brg_
(&
b_rg
);

1317 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

1319 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

1320 
	`du_rvi_su܋d
((
BACNET_SERVICES_SUPPORTED

i
));

1322 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

1324 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

1327 
	`brg_
(&
b_rg
);

1328 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

1330 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

1334 
pObje
 = 
Obje_Tab
;

1335 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

1336 i((
pObje
->
Obje_Cou
&& (pObje->
	`Obje_Cou
() > 0)) {

1337 
	`brg_t_b
(&
b_rg
, 
pObje
->
Obje_Ty
, 
ue
);

1339 
pObje
++;

1341 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

1343 
PROP_OBJECT_LIST
:

1344 
cou
 = 
	`Devi_Obje_Li_Cou
();

1346 i(
da
->
y_dex
 == 0)

1347 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

1352 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

1353 
i
 = 1; i <
cou
; i++) {

1354 
found
 =

1355 
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
,

1356 &

);

1357 i(
found
) {

1358 
n
 =

1359 
	`code_iti_obje_id
(&
du
[
du_n
],

1360 
obje_ty
, 

);

1361 
du_n
 +
n
;

1364 i((
i
 !
cou
&& (
du_n
 + 
n
>
MAX_APDU
) {

1366 
da
->
r_code
 =

1367 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

1368 
du_n
 = 
BACNET_STATUS_ABORT
;

1373 
da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

1374 
da
->
r_code
 = 
ERROR_CODE_OTHER
;

1375 
du_n
 = 
BACNET_STATUS_ERROR
;

1380 
found
 =

1381 
	`Devi_Obje_Li_Idtifr
(
da
->
y_dex
,

1382 &
obje_ty
, &

);

1383 i(
found
) {

1384 
du_n
 =

1385 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

1386 

);

1388 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1389 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

1390 
du_n
 = 
BACNET_STATUS_ERROR
;

1394 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

1395 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

1397 
PROP_SEGMENTATION_SUPPORTED
:

1398 
du_n
 =

1399 
	`code_iti_umed
(&
du
[0],

1400 
	`Devi_Segmti_Su܋d
());

1402 
PROP_APDU_TIMEOUT
:

1403 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_timeout
());

1405 
PROP_NUMBER_OF_APDU_RETRIES
:

1406 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_s
());

1408 
PROP_DEVICE_ADDRESS_BINDING
:

1410 
du_n
 = 
	`addss_li_code
(&
du
[0], 
MAX_APDU
);

1412 
PROP_DATABASE_REVISION
:

1413 
du_n
 =

1414 
	`code_iti_unsigd
(&
du
[0], 
Daba_Revisi
);

1416 #i
	`defed
(
BACDL_MSTP
)

1417 
PROP_MAX_INFO_FRAMES
:

1418 
du_n
 =

1419 
	`code_iti_unsigd
(&
du
[0],

1420 
	`dlmp_max_fo_ames
());

1422 
PROP_MAX_MASTER
:

1423 
du_n
 =

1424 
	`code_iti_unsigd
(&
du
[0], 
	`dlmp_max_ma
());

1427 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

1429 
du_n
 = 
	`hdr_cov_code_substis
(&
du
[0], 
MAX_APDU
);

1432 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1433 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1434 
du_n
 = 
BACNET_STATUS_ERROR
;

1438 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

1439 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

1440 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1441 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

1442 
du_n
 = 
BACNET_STATUS_ERROR
;

1445  
du_n
;

1446 
	}
}

1456 
	$Devi_Rd_Prݔty
(

1457 
BACNET_READ_PROPERTY_DATA
 * 
da
)

1459 
du_n
 = 
BACNET_STATUS_ERROR
;

1460 
obje_funis
 *
pObje
 = 
NULL
;

1463 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

1464 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1465 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
da
->
obje_ty
);

1466 i(
pObje
 !
NULL
) {

1467 i(
pObje
->
Obje_Vid_In
 &&

1468 
pObje
->
	`Obje_Vid_In
(
da
->
obje_
)) {

1469 i(
pObje
->
Obje_Rd_Prݔty
) {

1470 
du_n
 = 
pObje
->
	`Obje_Rd_Prݔty
(
da
);

1475  
du_n
;

1476 
	}
}

1479 
bo
 
	$Devi_Wre_Prݔty_Lol
(

1480 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

1482 
bo
 
us
 = 
l
;

1483 
n
 = 0;

1484 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1485 
obje_ty
 = 0;

1486 
ut32_t
 
obje_
 = 0;

1487 
mp
;

1490 
n
 =

1491 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

1492 
wp_da
->
iti_da_n
, &
vue
);

1493 i(
n
 < 0) {

1495 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1496 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1497  
l
;

1499 i((
wp_da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

1500 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

1502 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1503 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

1504  
l
;

1507 
wp_da
->
obje_ݔty
) {

1508 
PROP_OBJECT_IDENTIFIER
:

1509 
us
 =

1510 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_OBJECT_ID
,

1511 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1512 i(
us
) {

1513 i((
vue
.
ty
.
Obje_Id
.ty =
OBJECT_DEVICE
) &&

1514 (
	`Devi_S_Obje_In_Numb
(
vue
.
ty
.

1515 
Obje_Id
.

))) {

1518 
us
 = 
l
;

1519 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1520 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1524 
PROP_NUMBER_OF_APDU_RETRIES
:

1525 
us
 =

1526 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1527 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1528 i(
us
) {

1530 
	`du_s_t
((
ut8_t

vue
.
ty
.
Unsigd_I
);

1533 
PROP_APDU_TIMEOUT
:

1534 
us
 =

1535 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1536 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1537 i(
us
) {

1539 
	`du_timeout_t
((
ut16_t

vue
.
ty
.
Unsigd_I
);

1542 
PROP_VENDOR_IDENTIFIER
:

1543 
us
 =

1544 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1545 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1546 i(
us
) {

1548 
	`Devi_S_Vd_Idtifr
((
ut16_t

vue
.

1549 
ty
.
Unsigd_I
);

1552 
PROP_SYSTEM_STATUS
:

1553 
us
 =

1554 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

1555 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1556 i(
us
) {

1557 
mp
 = 
	`Devi_S_Syem_Stus
((
BACNET_DEVICE_STATUS
)

1558 
vue
.
ty
.
Enumed
, 
l
);

1559 i(
mp
 != 0) {

1560 
us
 = 
l
;

1561 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1562 i(
mp
 == -1) {

1563 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1565 
wp_da
->
r_code
 =

1566 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

1571 
PROP_OBJECT_NAME
:

1572 
us
 =

1573 
	`WPVideSg
(&
vue
,

1574 
	`charg_cy
(&
My_Obje_Name
), 
l
,

1575 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1576 i(
us
) {

1578 i(
	`Devi_Vid_Obje_Name
(&
vue
.
ty
.
Cha_Sg
,

1579 &
obje_ty
, &
obje_
)) {

1580 i((
obje_ty
 =
wp_da
->object_type) &&

1581 (
obje_
 =
wp_da
->object_instance)) {

1583 
us
 = 
ue
;

1585 
us
 = 
l
;

1586 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1587 
wp_da
->
r_code
 = 
ERROR_CODE_DUPLICATE_NAME
;

1590 
	`Devi_S_Obje_Name
(&
vue
.
ty
.
Cha_Sg
);

1594 
PROP_LOCATION
:

1595 
us
 =

1596 
	`WPVideSg
(&
vue
, 
MAX_DEV_LOC_LEN
, 
ue
,

1597 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1598 i(
us
) {

1599 
	`Devi_S_Loti
(
	`charg_vue
(&
vue
.

1600 
ty
.
Cha_Sg
),

1601 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

1605 
PROP_DESCRIPTION
:

1606 
us
 =

1607 
	`WPVideSg
(&
vue
, 
MAX_DEV_DESC_LEN
, 
ue
,

1608 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1609 i(
us
) {

1610 
	`Devi_S_Desti
(
	`charg_vue
(&
vue
.

1611 
ty
.
Cha_Sg
),

1612 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

1615 
PROP_MODEL_NAME
:

1616 
us
 =

1617 
	`WPVideSg
(&
vue
, 
MAX_DEV_MOD_LEN
, 
ue
,

1618 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1619 i(
us
) {

1620 
	`Devi_S_Mod_Name
(
	`charg_vue
(&
vue
.

1621 
ty
.
Cha_Sg
),

1622 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

1626 
PROP_MAX_INFO_FRAMES
:

1627 #i
	`defed
(
BACDL_MSTP
)

1628 
us
 =

1629 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1630 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1631 i(
us
) {

1632 i(
vue
.
ty
.
Unsigd_I
 <= 255) {

1633 
	`dlmp_t_max_fo_ames
((
ut8_t

vue
.

1634 
ty
.
Unsigd_I
);

1636 
us
 = 
l
;

1637 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1638 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1643 
PROP_MAX_MASTER
:

1644 #i
	`defed
(
BACDL_MSTP
)

1645 
us
 =

1646 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1647 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1648 i(
us
) {

1649 i((
vue
.
ty
.
Unsigd_I
 > 0) &&

1650 (
vue
.
ty
.
Unsigd_I
 <= 127)) {

1651 
	`dlmp_t_max_ma
((
ut8_t

vue
.
ty
.
Unsigd_I
);

1653 
us
 = 
l
;

1654 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1655 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1660 
PROP_OBJECT_TYPE
:

1661 
PROP_VENDOR_NAME
:

1662 
PROP_FIRMWARE_REVISION
:

1663 
PROP_APPLICATION_SOFTWARE_VERSION
:

1664 
PROP_LOCAL_TIME
:

1665 
PROP_UTC_OFFSET
:

1666 
PROP_LOCAL_DATE
:

1667 
PROP_DAYLIGHT_SAVINGS_STATUS
:

1668 
PROP_PROTOCOL_VERSION
:

1669 
PROP_PROTOCOL_REVISION
:

1670 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

1671 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

1672 
PROP_OBJECT_LIST
:

1673 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

1674 
PROP_SEGMENTATION_SUPPORTED
:

1675 
PROP_DEVICE_ADDRESS_BINDING
:

1676 
PROP_DATABASE_REVISION
:

1677 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

1678 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1679 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

1682 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1683 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1687  
us
;

1688 
	}
}

1699 
bo
 
	$Devi_Wre_Prݔty
(

1700 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

1702 
bo
 
us
 = 
l
;

1703 
obje_funis
 *
pObje
 = 
NULL
;

1706 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

1707 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1708 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
wp_da
->
obje_ty
);

1709 i(
pObje
 !
NULL
) {

1710 i(
pObje
->
Obje_Vid_In
 &&

1711 
pObje
->
	`Obje_Vid_In
(
wp_da
->
obje_
)) {

1712 i(
pObje
->
Obje_Wre_Prݔty
) {

1713 
us
 = 
pObje
->
	`Obje_Wre_Prݔty
(
wp_da
);

1715 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1716 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

1719 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

1720 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1723 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

1724 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1727  (
us
);

1728 
	}
}

1739 
bo
 
	$Devi_Encode_Vue_Li
(

1740 
BACNET_OBJECT_TYPE
 
obje_ty
,

1741 
ut32_t
 
obje_
,

1742 
BACNET_PROPERTY_VALUE
 * 
vue_li
)

1744 
bo
 
us
 = 
l
;

1745 
obje_funis
 *
pObje
 = 
NULL
;

1747 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1748 i(
pObje
 !
NULL
) {

1749 i(
pObje
->
Obje_Vid_In
 &&

1750 
pObje
->
	`Obje_Vid_In
(
obje_
)) {

1751 i(
pObje
->
Obje_Vue_Li
) {

1752 
us
 =

1753 
pObje
->
	`Obje_Vue_Li
(
obje_
, 
vue_li
);

1758  (
us
);

1759 
	}
}

1767 
bo
 
	$Devi_COV
(

1768 
BACNET_OBJECT_TYPE
 
obje_ty
,

1769 
ut32_t
 
obje_
)

1771 
bo
 
us
 = 
l
;

1772 
obje_funis
 *
pObje
 = 
NULL
;

1774 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1775 i(
pObje
 !
NULL
) {

1776 i(
pObje
->
Obje_Vid_In
 &&

1777 
pObje
->
	`Obje_Vid_In
(
obje_
)) {

1778 i(
pObje
->
Obje_COV
) {

1779 
us
 = 
pObje
->
	`Obje_COV
(
obje_
);

1784  (
us
);

1785 
	}
}

1792 
	$Devi_COV_Cˬ
(

1793 
BACNET_OBJECT_TYPE
 
obje_ty
,

1794 
ut32_t
 
obje_
)

1796 
obje_funis
 *
pObje
 = 
NULL
;

1798 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1799 i(
pObje
 !
NULL
) {

1800 i(
pObje
->
Obje_Vid_In
 &&

1801 
pObje
->
	`Obje_Vid_In
(
obje_
)) {

1802 i(
pObje
->
Obje_COV_Cˬ
) {

1803 
pObje
->
	`Obje_COV_Cˬ
(
obje_
);

1807 
	}
}

1809 #i
defed
(
INTRINSIC_REPORTING
)

1810 
	$Devi_lol_ptg
(

1813 
obje_funis
 *
pObje
;

1814 
ut32_t
 
objes_cou
;

1815 
ut32_t
 
obje_
;

1816 
obje_ty
;

1817 
ut32_t
 
idx
;

1819 
objes_cou
 = 
	`Devi_Obje_Li_Cou
();

1822 
idx
 = 1; idx < 
objes_cou
; idx++) {

1823 
	`Devi_Obje_Li_Idtifr
(
idx
, &
obje_ty
, &
obje_
);

1825 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1826 i(
pObje
 !
NULL
) {

1827 i(
pObje
->
Obje_Vid_In
 &&

1828 
pObje
->
	`Obje_Vid_In
(
obje_
)) {

1829 i(
pObje
->
Obje_Irsic_Rtg
) {

1830 
pObje
->
	`Obje_Irsic_Rtg
(
obje_
);

1835 
	}
}

1843 
bo
 
	$Devi_Vue_Li_Su܋d
(

1844 
BACNET_OBJECT_TYPE
 
obje_ty
)

1846 
bo
 
us
 = 
l
;

1847 
obje_funis
 *
pObje
 = 
NULL
;

1849 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1850 i(
pObje
 !
NULL
) {

1851 i(
pObje
->
Obje_Vue_Li
) {

1852 
us
 = 
ue
;

1856  (
us
);

1857 
	}
}

1867 
	$Devi_In
(

1868 
obje_funis_t
 * 
obje_b
)

1870 
obje_funis
 *
pObje
 = 
NULL
;

1872 
	`charg__si
(&
My_Obje_Name
, "SimpleServer");

1873 i(
obje_b
) {

1874 
Obje_Tab
 = 
obje_b
;

1876 
Obje_Tab
 = &
My_Obje_Tab
[0];

1878 
pObje
 = 
Obje_Tab
;

1879 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

1880 i(
pObje
->
Obje_In
) {

1881 
pObje
->
	`Obje_In
();

1883 
pObje
++;

1885 
	}
}

1887 
bo
 
	$DeviGRRInfo
(

1888 
BACNET_READ_RANGE_DATA
 * 
pReque
,

1889 
RR_PROP_INFO
 * 
pInfo
)

1891 
bo
 
us
 = 
l
;

1893 
pReque
->
obje_ݔty
) {

1894 
PROP_VT_CLASSES_SUPPORTED
:

1895 
PROP_ACTIVE_VT_SESSIONS
:

1896 
PROP_LIST_OF_SESSION_KEYS
:

1897 
PROP_TIME_SYNCHRONIZATION_RECIPIENTS
:

1898 
PROP_MANUAL_SLAVE_ADDRESS_BINDING
:

1899 
PROP_SLAVE_ADDRESS_BINDING
:

1900 
PROP_RESTART_NOTIFICATION_RECIPIENTS
:

1901 
PROP_UTC_TIME_SYNCHRONIZATION_RECIPIENTS
:

1902 
pInfo
->
RequeTys
 = 
RR_BY_POSITION
;

1903 
pReque
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1904 
pReque
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1907 
PROP_DEVICE_ADDRESS_BINDING
:

1908 
pInfo
->
RequeTys
 = 
RR_BY_POSITION
;

1909 
pInfo
->
Hdr
 = 
_addss_li_code
;

1910 
us
 = 
ue
;

1913 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

1914 
pInfo
->
RequeTys
 = 
RR_BY_POSITION
;

1915 
pReque
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1916 
pReque
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1919 
pReque
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

1920 
pReque
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_A_LIST
;

1924  
us
;

1925 
	}
}

1928 #ifde
BAC_ROUTING


1943 
	$Routg_Devi_In
(

1944 
ut32_t
 
f_obje_
)

1946 
obje_funis
 *
pDevObje
 = 
NULL
;

1949 
	`Add_Roud_Devi
(
f_obje_
, &
My_Obje_Name
, 
Desti
);

1952 
pDevObje
 = 
Obje_Tab
;

1953 
pDevObje
->
Obje_Index_To_In
 = 
Roud_Devi_Index_To_In
;

1954 
pDevObje
->
Obje_Vid_In
 =

1955 
Roud_Devi_Vid_Obje_In_Numb
;

1956 
pDevObje
->
Obje_Name
 = 
Roud_Devi_Name
;

1957 
pDevObje
->
Obje_Rd_Prݔty
 = 
Roud_Devi_Rd_Prݔty_Lol
;

1958 
pDevObje
->
Obje_Wre_Prݔty
 = 
Roud_Devi_Wre_Prݔty_Lol
;

1959 
	}
}

1964 #ifde
TEST


1965 
	~<as.h
>

1966 
	~<rg.h
>

1967 
	~"e.h
"

1969 
bo
 
	$WPVideArgTy
(

1970 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

1971 
ut8_t
 
ucExedTag
,

1972 
BACNET_ERROR_CLASS
 * 
pECss
,

1973 
BACNET_ERROR_CODE
 * 
pECode
)

1975 
pVue
 =Value;

1976 
ucExedTag
 = ucExpectedTag;

1977 
pECss
 =ErrorClass;

1978 
pECode
 =ErrorCode;

1980  
l
;

1981 
	}
}

1983 
bo
 
	$WPVideSg
(

1984 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

1985 
iMaxL
,

1986 
bo
 
bEmyAowed
,

1987 
BACNET_ERROR_CLASS
 * 
pECss
,

1988 
BACNET_ERROR_CODE
 * 
pECode
)

1990 
pVue
 =Value;

1991 
iMaxL
 = iMaxLen;

1992 
bEmyAowed
 = bEmptyAllowed;

1993 
pECss
 =ErrorClass;

1994 
pECode
 =ErrorCode;

1996  
l
;

1997 
	}
}

1999 
	$hdr_cov_code_substis
(

2000 
ut8_t
 * 
du
,

2001 
max_du
)

2003 
du
 =pdu;

2004 
max_du
 = max_apdu;

2007 
	}
}

2009 
	$Devi
(

2010 
Te
 * 
pTe
)

2012 
bo
 
us
 = 
l
;

2013 cڡ *
me
 = "Patricia";

2015 
us
 = 
	`Devi_S_Obje_In_Numb
(0);

2016 
	`_
(
pTe
, 
	`Devi_Obje_In_Numb
() == 0);

2017 
	`_
(
pTe
, 
us
 =
ue
);

2018 
us
 = 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

2019 
	`_
(
pTe
, 
	`Devi_Obje_In_Numb
(=
BACNET_MAX_INSTANCE
);

2020 
	`_
(
pTe
, 
us
 =
ue
);

2021 
us
 = 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
 / 2);

2022 
	`_
(
pTe
,

2023 
	`Devi_Obje_In_Numb
(=(
BACNET_MAX_INSTANCE
 / 2));

2024 
	`_
(
pTe
, 
us
 =
ue
);

2025 
us
 = 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
 + 1);

2026 
	`_
(
pTe
,

2027 
	`Devi_Obje_In_Numb
(!(
BACNET_MAX_INSTANCE
 + 1));

2028 
	`_
(
pTe
, 
us
 =
l
);

2031 
	`Devi_S_Syem_Stus
(
STATUS_NON_OPERATIONAL
, 
ue
);

2032 
	`_
(
pTe
, 
	`Devi_Syem_Stus
(=
STATUS_NON_OPERATIONAL
);

2034 
	`_
(
pTe
, 
	`Devi_Vd_Idtifr
(=
BACNET_VENDOR_ID
);

2036 
	`Devi_S_Mod_Name
(
me
, 
	`
(name));

2037 
	`_
(
pTe
, 
	`rcmp
(
	`Devi_Mod_Name
(), 
me
) == 0);

2040 
	}
}

2042 #ifde
TEST_DEVICE


2043 
	$ma
(

2046 
Te
 *
pTe
;

2047 
bo
 
rc
;

2049 
pTe
 = 
	`_
("BACÈDevi", 
NULL
);

2051 
rc
 = 
	`_addTeFuni
(
pTe
, 
Devi
);

2052 
	`as
(
rc
);

2054 
	`_tSm
(
pTe
, 
dout
);

2055 
	`_run
(
pTe
);

2056 (
	`_pt
(
pTe
);

2057 
	`_deroy
(
pTe
);

2060 
	}
}

	@demo/object/device.h

29 #ide
DEVICE_H


30 
	#DEVICE_H


	)

32 
	~<dbo.h
>

33 
	~<dt.h
>

34 
	~"bacdef.h
"

35 
	~"banum.h
"

36 
	~"wp.h
"

37 
	~"rd.h
"

38 
	~".h
"

39 
	~"m.h
"

40 
	~"adnge.h
"

46 *
	tobje__funi
) (

54 *
	tobje_cou_funi
) (

62 
	$ut32_t
(

63 *
	tobje_dex_to__funi
)

65 
	tdex
);

75 
	$bo
(

76 *
	tobje_me_funi
)

78 
	tut32_t
 
	tobje_
,

79 
	tBACNET_CHARACTER_STRING
 * 
	tobje_me
);

87 
	$bo
(

88 *
	tobje_vid__funi
) (

89 
	tut32_t
 
	tobje_
);

102 *
	tobje_e_funi
) (

103 
	tcut_dex
);

111 
	$bo
(

112 *
	tobje_vue_li_funi
) (

113 
	tut32_t
 
	tobje_
,

114 
	tBACNET_PROPERTY_VALUE
 * 
	tvue_li
);

121 
	$bo
(

122 *
	tobje_cov_funi
) (

123 
	tut32_t
 
	tobje_
);

130 *
	tobje_cov_r_funi
) (

131 
	tut32_t
 
	tobje_
);

138 *
	tobje_sic_ptg_funi
) (

139 
	tut32_t
 
	tobje_
);

151 
	sobje_funis
 {

152 
BACNET_OBJECT_TYPE
 
Obje_Ty
;

153 
obje__funi
 
Obje_In
;

154 
obje_cou_funi
 
Obje_Cou
;

155 
obje_dex_to__funi
 
Obje_Index_To_In
;

156 
obje_vid__funi
 
Obje_Vid_In
;

157 
obje_me_funi
 
Obje_Name
;

158 
ad_ݔty_funi
 
Obje_Rd_Prݔty
;

159 
wre_ݔty_funi
 
Obje_Wre_Prݔty
;

160 
m_ݔty_lis_funi
 
Obje_RPM_Li
;

161 
_fo_funi
 
Obje_RR_Info
;

162 
obje_e_funi
 
Obje_It
;

163 
obje_vue_li_funi
 
Obje_Vue_Li
;

164 
obje_cov_funi
 
Obje_COV
;

165 
obje_cov_r_funi
 
Obje_COV_Cˬ
;

166 
obje_sic_ptg_funi
 
Obje_Irsic_Rtg
;

167 } 
	tobje_funis_t
;

170 
	#MAX_DEV_NAME_LEN
 32

	)

171 
	#MAX_DEV_LOC_LEN
 64

	)

172 
	#MAX_DEV_MOD_LEN
 32

	)

173 
	#MAX_DEV_VER_LEN
 16

	)

174 
	#MAX_DEV_DESC_LEN
 64

	)

177 
	scommBacObj_s
 {

183 
BACNET_OBJECT_TYPE
 
mObje_Ty
;

186 
ut32_t
 
Obje_In_Numb
;

192 
Obje_Name
[
MAX_DEV_NAME_LEN
];

194 } 
	tCOMMON_BAC_OBJECT
;

205 
	sdevObj_s
 {

207 
BACNET_ADDRESS
 
bacDevAddr
;

210 
COMMON_BAC_OBJECT
 
bacObj
;

213 
Desti
[
MAX_DEV_DESC_LEN
];

216 
ut32_t
 
Daba_Revisi
;

217 } 
	tDEVICE_OBJECT_DATA
;

220 #ifde
__lulus


224 
	`Devi_In
(

225 
obje_funis_t
 * 
obje_b
);

227 
bo
 
	`Devi_Relize
(

228 
BACNET_REINITIALIZE_DEVICE_DATA
 * 
rd_da
);

230 
BACNET_REINITIALIZED_STATE
 
	`Devi_Relized_S
(

233 
_fo_funi
 
	`Devi_Objes_RR_Info
(

234 
BACNET_OBJECT_TYPE
 
obje_ty
);

236 
	`Devi_gCutDeTime
(

237 
BACNET_DATE_TIME
 * 
DeTime
);

238 
t32_t
 
	`Devi_UTC_Offt
();

239 
bo
 
	`Devi_Daylight_Savgs_Stus
();

240 
bo
 
	`Devi_Align_Ivs
();

241 
bo
 
	`Devi_Align_Ivs_S
(bo 
ag
);

242 
ut32_t
 
	`Devi_Time_Sync_Iv
();

243 
bo
 
	`Devi_Time_Sync_Iv_S
(
ut32_t
 
vue
);

244 
ut32_t
 
	`Devi_Iv_Offt
();

245 
bo
 
	`Devi_Iv_Offt_S
(
ut32_t
 
vue
);

247 
	`Devi_Prݔty_Lis
(

248 cڡ **
pRequed
,

249 cڡ **
pOiڮ
,

250 cڡ **
pPrrry
);

251 
	`Devi_Objes_Prݔty_Li
(

252 
BACNET_OBJECT_TYPE
 
obje_ty
,

253 
ecl_ݔty_li_t
 *
pPrݔtyLi
);

255 
bo
 
	`Devi_Encode_Vue_Li
(

256 
BACNET_OBJECT_TYPE
 
obje_ty
,

257 
ut32_t
 
obje_
,

258 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

259 
bo
 
	`Devi_Vue_Li_Su܋d
(

260 
BACNET_OBJECT_TYPE
 
obje_ty
);

261 
bo
 
	`Devi_COV
(

262 
BACNET_OBJECT_TYPE
 
obje_ty
,

263 
ut32_t
 
obje_
);

264 
	`Devi_COV_Cˬ
(

265 
BACNET_OBJECT_TYPE
 
obje_ty
,

266 
ut32_t
 
obje_
);

268 
ut32_t
 
	`Devi_Obje_In_Numb
(

270 
bo
 
	`Devi_S_Obje_In_Numb
(

271 
ut32_t
 
obje_id
);

272 
bo
 
	`Devi_Vid_Obje_In_Numb
(

273 
ut32_t
 
obje_id
);

274 
	`Devi_Obje_Li_Cou
(

276 
bo
 
	`Devi_Obje_Li_Idtifr
(

277 
ut32_t
 
y_dex
,

278 *
obje_ty
,

279 
ut32_t
 * 

);

281 
	`Devi_Cou
(

283 
ut32_t
 
	`Devi_Index_To_In
(

284 
dex
);

286 
bo
 
	`Devi_Obje_Name
(

287 
ut32_t
 
obje_
,

288 
BACNET_CHARACTER_STRING
 * 
obje_me
);

289 
bo
 
	`Devi_S_Obje_Name
(

290 
BACNET_CHARACTER_STRING
 * 
obje_me
);

292 
bo
 
	`Devi_Obje_Name_Cy
(

293 
BACNET_OBJECT_TYPE
 
obje_ty
,

294 
ut32_t
 
obje_
,

295 
BACNET_CHARACTER_STRING
 * 
obje_me
);

296 
bo
 
	`Devi_Obje_Name_ANSI_In
(cڡ * 
vue
);

298 
BACNET_DEVICE_STATUS
 
	`Devi_Syem_Stus
(

300 
	`Devi_S_Syem_Stus
(

301 
BACNET_DEVICE_STATUS
 
us
,

302 
bo
 
lol
);

304 cڡ *
	`Devi_Vd_Name
(

307 
ut16_t
 
	`Devi_Vd_Idtifr
(

309 
	`Devi_S_Vd_Idtifr
(

310 
ut16_t
 
vd_id
);

312 cڡ *
	`Devi_Mod_Name
(

314 
bo
 
	`Devi_S_Mod_Name
(

315 cڡ *
me
,

316 
size_t
 
ngth
);

318 cڡ *
	`Devi_Fmwe_Revisi
(

321 cڡ *
	`Devi_Aliti_Sowe_Vsi
(

323 
bo
 
	`Devi_S_Aliti_Sowe_Vsi
(

324 cڡ *
me
,

325 
size_t
 
ngth
);

327 cڡ *
	`Devi_Desti
(

329 
bo
 
	`Devi_S_Desti
(

330 cڡ *
me
,

331 
size_t
 
ngth
);

333 cڡ *
	`Devi_Loti
(

335 
bo
 
	`Devi_S_Loti
(

336 cڡ *
me
,

337 
size_t
 
ngth
);

340 
ut8_t
 
	`Devi_Proc_Vsi
(

342 
ut8_t
 
	`Devi_Proc_Revisi
(

344 
BACNET_SEGMENTATION
 
	`Devi_Segmti_Su܋d
(

347 
ut32_t
 
	`Devi_Daba_Revisi
(

349 
	`Devi_S_Daba_Revisi
(

350 
ut32_t
 
visi
);

351 
	`Devi_Inc_Daba_Revisi
(

354 
bo
 
	`Devi_Vid_Obje_Name
(

355 
BACNET_CHARACTER_STRING
 * 
obje_me
,

356 *
obje_ty
,

357 
ut32_t
 * 
obje_
);

358 
bo
 
	`Devi_Vid_Obje_Id
(

359 
obje_ty
,

360 
ut32_t
 
obje_
);

362 
	`Devi_Rd_Prݔty
(

363 
BACNET_READ_PROPERTY_DATA
 * 
da
);

364 
bo
 
	`Devi_Wre_Prݔty
(

365 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

367 
bo
 
	`DeviGRRInfo
(

368 
BACNET_READ_RANGE_DATA
 * 
pReque
,

369 
RR_PROP_INFO
 * 
pInfo
);

371 
	`Devi_Rd_Prݔty_Lol
(

372 
BACNET_READ_PROPERTY_DATA
 * 
da
);

373 
bo
 
	`Devi_Wre_Prݔty_Lol
(

374 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

376 #i
	`defed
(
INTRINSIC_REPORTING
)

377 
	`Devi_lol_ptg
(

385 
	`Routg_Devi_In
(

386 
ut32_t
 
f_obje_
);

388 
ut16_t
 
	`Add_Roud_Devi
(

389 
ut32_t
 
Obje_In
,

390 
BACNET_CHARACTER_STRING
 * 
Obje_Name
,

391 cڡ *
Desti
);

392 
DEVICE_OBJECT_DATA
 *
	`G_Roud_Devi_Obje
(

393 
idx
);

394 
BACNET_ADDRESS
 *
	`G_Roud_Devi_Addss
(

395 
idx
);

397 
	`roud_g_my_addss
(

398 
BACNET_ADDRESS
 * 
my_addss
);

400 
bo
 
	`Roud_Devi_Addss_Lookup
(

401 
idx
,

402 
ut8_t
 
addss_n
,

403 
ut8_t
 * 
mac_adss
);

404 
bo
 
	`Roud_Devi_GNext
(

405 
BACNET_ADDRESS
 * 
de
,

406 *
DNET_li
,

407 *
curs
);

408 
bo
 
	`Roud_Devi_Is_Vid_Nwk
(

409 
ut16_t
 
de_t
,

410 *
DNET_li
);

412 
ut32_t
 
	`Roud_Devi_Index_To_In
(

413 
dex
);

414 
bo
 
	`Roud_Devi_Vid_Obje_In_Numb
(

415 
ut32_t
 
obje_id
);

416 
bo
 
	`Roud_Devi_Name
(

417 
ut32_t
 
obje_
,

418 
BACNET_CHARACTER_STRING
 * 
obje_me
);

419 
ut32_t
 
	`Roud_Devi_Obje_In_Numb
(

421 
bo
 
	`Roud_Devi_S_Obje_In_Numb
(

422 
ut32_t
 
obje_id
);

423 
bo
 
	`Roud_Devi_S_Obje_Name
(

424 
ut8_t
 
codg
,

425 cڡ *
vue
,

426 
size_t
 
ngth
);

427 
bo
 
	`Roud_Devi_S_Desti
(

428 cڡ *
me
,

429 
size_t
 
ngth
);

430 
	`Roud_Devi_Inc_Daba_Revisi
(

432 
	`Roud_Devi_Svi_Arov
(

433 
BACNET_CONFIRMED_SERVICE
 
rvi
,

434 
rvi_gumt
,

435 
ut8_t
 * 
du_buff
,

436 
ut8_t
 
voke_id
);

440 #ifde
__lulus


441 
	}
}

	@demo/object/gw_device.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<rg.h
>

31 
	~<time.h
>

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"banum.h
"

35 
	~"ba.h
"

36 
	~"cfig.h
"

37 
	~"du.h
"

38 
	~"wp.h
"

39 
	~".h
"

40 
	~"vsi.h
"

41 
	~"devi.h
"

42 
	~"hdrs.h
"

43 
	~"dk.h
"

44 
	~"addss.h
"

45 
	~"je.h
"

47 
	~"ai.h
"

48 
	~"ao.h
"

49 
	~"av.h
"

50 
	~"bi.h
"

51 
	~"bo.h
"

52 
	~"bv.h
"

53 
	~"lc.h
"

54 
	~"l.h
"

55 
	~"mso.h
"

56 
	~"ms-put.h
"

57 
	~"dlog.h
"

58 #i
defed
(
BACFILE
)

59 
	~"bacfe.h
"

62 
	~"tim.h
"

64 #i
defed
(
__BORLANDC__
|| defed(
_WIN32
)

67 
	gtimeze
;

71 
Devi_Rd_Prݔty_Lol
(

72 
BACNET_READ_PROPERTY_DATA
 * 
da
);

73 
bo
 
Devi_Wre_Prݔty_Lol
(

74 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

75 
Roud_Devi_Rd_Prݔty_Lol
(

76 
BACNET_READ_PROPERTY_DATA
 * 
da
);

77 
bo
 
Roud_Devi_Wre_Prݔty_Lol
(

78 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

81 #i!
defed
(
BAC_ROUTING
)

82 #ifde
_MSC_VER


83 #agm
mesge
 
This
 
fe
 
should
 
n
 
be
 
uded
 

 
the
 
bud
 
uess
 
BAC_ROUTING
 
is
 
abd
.

85 #wng 
This
 
fe
 
should
 
n
 
be
 
uded
 

 
the
 
bud
 
uess
 
BAC_ROUTING
 
is
 
abd
.

99 
DEVICE_OBJECT_DATA
 
	gDevis
[
MAX_NUM_DEVICES
];

101 
ut16_t
 
	gNum_Maged_Devis
 = 0;

107 
ut16_t
 
	giCut_Devi_Idx
 = 0;

121 
ut16_t
 
	$Add_Roud_Devi
(

122 
ut32_t
 
Obje_In
,

123 
BACNET_CHARACTER_STRING
 * 
sObje_Name
,

124 cڡ *
sDesti
)

126 
i
 = 
Num_Maged_Devis
;

127 i(
i
 < 
MAX_NUM_DEVICES
) {

128 
DEVICE_OBJECT_DATA
 *
pDev
 = &
Devis
[
i
];

129 
Num_Maged_Devis
++;

130 
iCut_Devi_Idx
 = 
i
;

131 
pDev
->
bacObj
.
mObje_Ty
 = 
OBJECT_DEVICE
;

132 
pDev
->
bacObj
.
Obje_In_Numb
 = 
Obje_In
;

133 i(
sObje_Name
 !
NULL
)

134 
	`Roud_Devi_S_Obje_Name
(
sObje_Name
->
codg
,

135 
sObje_Name
->
vue
, sObje_Name->
ngth
);

137 
	`Roud_Devi_S_Obje_Name
(
CHARACTER_UTF8
, "No Name",

138 
	`
("No Name"));

139 i(
sDesti
 !
NULL
)

140 
	`Roud_Devi_S_Desti
(
sDesti
, 
	`
(sDescription));

142 
	`Roud_Devi_S_Desti
("NDes", 
	`
("No Descr"));

143 
pDev
->
Daba_Revisi
 = 0;

144  
i
;

147 
	}
}

159 
DEVICE_OBJECT_DATA
 *
	$G_Roud_Devi_Obje
(

160 
idx
)

162 i(
idx
 == -1)

163  &
Devis
[
iCut_Devi_Idx
];

164 i((
idx
 >0&& (idx < 
MAX_NUM_DEVICES
)) {

165 
iCut_Devi_Idx
 = 
idx
;

166  &
Devis
[
idx
];

168  
NULL
;

169 
	}
}

180 
BACNET_ADDRESS
 *
	$G_Roud_Devi_Addss
(

181 
idx
)

183 i(
idx
 == -1)

184  &
Devis
[
iCut_Devi_Idx
].
bacDevAddr
;

185 i((
idx
 >0&& (idx < 
MAX_NUM_DEVICES
)) {

186 
iCut_Devi_Idx
 = 
idx
;

187  &
Devis
[
idx
].
bacDevAddr
;

189  
NULL
;

190 
	}
}

201 
	$roud_g_my_addss
(

202 
BACNET_ADDRESS
 * 
my_addss
)

204 i(
my_addss
) {

205 
	`memy
(
my_addss
, &
Devis
[
iCut_Devi_Idx
].
bacDevAddr
,

206 (
BACNET_ADDRESS
));

208 
	}
}

228 
bo
 
	$Roud_Devi_Addss_Lookup
(

229 
idx
,

230 
ut8_t
 
addss_n
,

231 
ut8_t
 * 
mac_adss
)

233 
bo
 
su
 = 
l
;

234 
DEVICE_OBJECT_DATA
 *
pDev
 = &
Devis
[
idx
];

235 
i
;

237 i((
idx
 >0&& (idx < 
MAX_NUM_DEVICES
)) {

238 i(
addss_n
 == 0) {

240 
iCut_Devi_Idx
 = 
idx
;

241 
su
 = 
ue
;

242 } i(
mac_adss
 !
NULL
) {

243 
i
 = 0; i < 
addss_n
; i++) {

244 i(
pDev
->
bacDevAddr
.
mac
[
i
] !
mac_adss
[i])

247 i(
i
 =
addss_n
) {

248 
iCut_Devi_Idx
 = 
idx
;

249 
su
 = 
ue
;

253  
su
;

254 
	}
}

283 
bo
 
	$Roud_Devi_GNext
(

284 
BACNET_ADDRESS
 * 
de
,

285 *
DNET_li
,

286 *
curs
)

288 
dt
 = 
DNET_li
[0];

289 
idx
 = *
curs
;

290 
bo
 
bSucss
 = 
l
;

295 i((
idx
 < 0|| (idx >
MAX_NUM_DEVICES
))

296 
idx
 = -1;

301 i(
de
->
t
 =
BACNET_BROADCAST_NETWORK
) {

303 
bSucss
 = 
	`Roud_Devi_Addss_Lookup
(
idx
++, 
de
->
n
, de->
adr
);

308 i(
de
->
t
 == 0) {

312 
bSucss
 = 
	`Roud_Devi_Addss_Lookup
(0, 
de
->
n
, de->
adr
);

314 
idx
 = -1;

321 i(
de
->
t
 =
dt
) {

322 i(
idx
 == 0)

323 
idx
 = 1;

324 
idx
 < 
MAX_NUM_DEVICES
) {

325 
bSucss
 =

326 
	`Roud_Devi_Addss_Lookup
(
idx
++, 
de
->
n
, de->
adr
);

327 i(
bSucss
)

332 i(!
bSucss
)

333 *
curs
 = -1;

334 i(
idx
 =
MAX_NUM_DEVICES
)

335 *
curs
 = -1;

337 *
curs
 = 
idx
;

338  
bSucss
;

339 
	}
}

355 
bo
 
	$Roud_Devi_Is_Vid_Nwk
(

356 
ut16_t
 
de_t
,

357 *
DNET_li
)

359 
dt
 = 
DNET_li
[0];

360 
bo
 
bSucss
 = 
l
;

363 i(
de_t
 =
BACNET_BROADCAST_NETWORK
)

364 
bSucss
 = 
ue
;

368 i(
de_t
 == 0)

369 
bSucss
 = 
ue
;

371 i(
de_t
 =
dt
)

372 
bSucss
 = 
ue
;

374  
bSucss
;

375 
	}
}

380 
ut32_t
 
	$Roud_Devi_Index_To_In
(

381 
dex
)

383 
dex
 = index;

384  
Devis
[
iCut_Devi_Idx
].
bacObj
.
Obje_In_Numb
;

385 
	}
}

395 
bo
 
	$Roud_Devi_Vid_Obje_In_Numb
(

396 
ut32_t
 
obje_id
)

398 
bo
 
bResu
 = 
l
;

399 
DEVICE_OBJECT_DATA
 *
pDev
 = &
Devis
[
iCut_Devi_Idx
];

401 i(
pDev
->
bacObj
.
Obje_In_Numb
 =
obje_id
)

402 
bResu
 = 
ue
;

404  
bResu
;

405 
	}
}

407 
bo
 
	$Roud_Devi_Name
(

408 
ut32_t
 
obje_
,

409 
BACNET_CHARACTER_STRING
 * 
obje_me
)

411 
DEVICE_OBJECT_DATA
 *
pDev
 = &
Devis
[
iCut_Devi_Idx
];

412 i(
obje_
 =
pDev
->
bacObj
.
Obje_In_Numb
) {

413  
	`charg__si
(
obje_me
,

414 
pDev
->
bacObj
.
Obje_Name
);

417  
l
;

418 
	}
}

426 
	$Roud_Devi_Rd_Prݔty_Lol
(

427 
BACNET_READ_PROPERTY_DATA
 * 
da
)

429 
du_n
 = 0;

430 
BACNET_CHARACTER_STRING
 
ch_rg
;

431 
ut8_t
 *
du
 = 
NULL
;

432 
DEVICE_OBJECT_DATA
 *
pDev
 = &
Devis
[
iCut_Devi_Idx
];

434 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

435 (
da
->
iti_da_n
 == 0)) {

438 
du
 = 
da
->
iti_da
;

439 
da
->
obje_ݔty
) {

440 
PROP_OBJECT_IDENTIFIER
:

441 
du_n
 =

442 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_DEVICE
,

443 
pDev
->
bacObj
.
Obje_In_Numb
);

445 
PROP_OBJECT_NAME
:

446 
	`charg__si
(&
ch_rg
, 
pDev
->
bacObj
.
Obje_Name
);

447 
du_n
 =

448 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

450 
PROP_DESCRIPTION
:

451 
	`charg__si
(&
ch_rg
, 
pDev
->
Desti
);

452 
du_n
 =

453 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

455 
PROP_DATABASE_REVISION
:

456 
du_n
 =

457 
	`code_iti_unsigd
(&
du
[0], 
pDev
->
Daba_Revisi
);

460 
du_n
 = 
	`Devi_Rd_Prݔty_Lol
(
da
);

464  (
du_n
);

465 
	}
}

467 
bo
 
	$Roud_Devi_Wre_Prݔty_Lol
(

468 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

470 
bo
 
us
 = 
l
;

471 
n
 = 0;

472 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

475 
n
 =

476 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

477 
wp_da
->
iti_da_n
, &
vue
);

478 i(
n
 < 0) {

480 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

481 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

482  
l
;

485 i((
wp_da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

486 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

487 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

488 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

489  
l
;

492 
wp_da
->
obje_ݔty
) {

493 
PROP_OBJECT_IDENTIFIER
:

494 
us
 =

495 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_OBJECT_ID
,

496 &
wp_da
->
r_ass
, &wp_da->
r_code
);

497 i(
us
) {

498 i((
vue
.
ty
.
Obje_Id
.ty =
OBJECT_DEVICE
) &&

499 (
	`Roud_Devi_S_Obje_In_Numb
(
vue
.
ty
.

500 
Obje_Id
.

))) {

503 
us
 = 
l
;

504 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

505 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

509 
PROP_OBJECT_NAME
:

510 
us
 =

511 
	`WPVideSg
(&
vue
, 
MAX_DEV_NAME_LEN
, 
l
,

512 &
wp_da
->
r_ass
, &wp_da->
r_code
);

513 i(
us
) {

514 
	`Roud_Devi_S_Obje_Name
(
	`charg_codg
(&
vue
.

515 
ty
.
Cha_Sg
),

516 
	`charg_vue
(&
vue
.
ty
.
Cha_Sg
),

517 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

521 
us
 = 
	`Devi_Wre_Prݔty_Lol
(
wp_da
);

524  
us
;

525 
	}
}

535 
ut32_t
 
	$Roud_Devi_Obje_In_Numb
(

538  
Devis
[
iCut_Devi_Idx
].
bacObj
.
Obje_In_Numb
;

539 
	}
}

541 
bo
 
	$Roud_Devi_S_Obje_In_Numb
(

542 
ut32_t
 
obje_id
)

544 
bo
 
us
 = 
ue
;

546 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

548 
Devis
[
iCut_Devi_Idx
].
bacObj
.
Obje_In_Numb
 = 
obje_id
;

549 
	`Roud_Devi_Inc_Daba_Revisi
();

551 
us
 = 
l
;

553  
us
;

554 
	}
}

562 
bo
 
	$Roud_Devi_S_Obje_Name
(

563 
ut8_t
 
codg
,

564 cڡ *
vue
,

565 
size_t
 
ngth
)

567 
bo
 
us
 = 
l
;

568 
DEVICE_OBJECT_DATA
 *
pDev
 = &
Devis
[
iCut_Devi_Idx
];

570 i((
codg
 =
CHARACTER_UTF8
&& (
ngth
 < 
MAX_DEV_NAME_LEN
)) {

572 
	`memmove
(
pDev
->
bacObj
.
Obje_Name
, 
vue
, 
ngth
);

573 
pDev
->
bacObj
.
Obje_Name
[
ngth
] = 0;

574 
	`Roud_Devi_Inc_Daba_Revisi
();

575 
us
 = 
ue
;

578  
us
;

579 
	}
}

581 
bo
 
	$Roud_Devi_S_Desti
(

582 cڡ *
me
,

583 
size_t
 
ngth
)

585 
bo
 
us
 = 
l
;

586 
DEVICE_OBJECT_DATA
 *
pDev
 = &
Devis
[
iCut_Devi_Idx
];

588 i(
ngth
 < 
MAX_DEV_DESC_LEN
) {

589 
	`memmove
(
pDev
->
Desti
, 
me
, 
ngth
);

590 
pDev
->
Desti
[
ngth
] = 0;

591 
us
 = 
ue
;

594  
us
;

595 
	}
}

603 
	$Roud_Devi_Inc_Daba_Revisi
(

606 
DEVICE_OBJECT_DATA
 *
pDev
 = &
Devis
[
iCut_Devi_Idx
];

607 
pDev
->
Daba_Revisi
++;

608 
	}
}

624 
	$Roud_Devi_Svi_Arov
(

625 
BACNET_CONFIRMED_SERVICE
 
rvi
,

626 
rvi_gumt
,

627 
ut8_t
 * 
du_buff
,

628 
ut8_t
 
voke_id
)

630 
n
 = 0;

631 
rvi
) {

632 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
:

634 i(
iCut_Devi_Idx
 > 0) {

635 i(
du_buff
 !
NULL
)

636 
n
 =

637 
	`je_code_du
(
du_buff
, 
voke_id
,

638 
REJECT_REASON_UNRECOGNIZED_SERVICE
);

640 
n
 = 1;

643 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
:

645 i(
iCut_Devi_Idx
 > 0) {

646 i(
du_buff
 !
NULL
)

647 
n
 =

648 
	`je_code_du
(
du_buff
, 
voke_id
,

649 
REJECT_REASON_UNRECOGNIZED_SERVICE
);

651 
n
 = 1;

658  
n
;

659 
	}
}

	@demo/object/lc.c

29 
	~<dbo.h
>

30 
	~<dt.h
>

31 
	~<dio.h
>

32 
	~<rg.h
>

33 
	~<time.h
>

34 
	~"bacdef.h
"

35 
	~"bacdcode.h
"

36 
	~"dime.h
"

37 
	~"banum.h
"

38 
	~"cfig.h
"

39 
	~"lc.h
"

40 
	~"ao.h
"

41 
	~"wp.h
"

42 
	~"hdrs.h
"

45 #ide
MAX_LOAD_CONTROLS


46 
	#MAX_LOAD_CONTROLS
 4

	)

50 
BACNET_SHED_STATE
 
	gP_Vue
[
MAX_LOAD_CONTROLS
];

53 
	eBACtShedLevTy
 {

54 
	mBACNET_SHED_TYPE_PERCENT
,

55 
	mBACNET_SHED_TYPE_LEVEL
,

56 
	mBACNET_SHED_TYPE_AMOUNT


57 } 
	tBACNET_SHED_LEVEL_TYPE
;

59 
	#DEFAULT_VALUE_PERCENT
 100

	)

60 
	#DEFAULT_VALUE_LEVEL
 0

	)

61 
	#DEFAULT_VALUE_AMOUNT
 0

	)

66 
BACNET_SHED_LEVEL_TYPE
 
	mty
;

68 
	mv
;

69 
	mr
;

70 
	mamou
;

71 } 
	mvue
;

72 } 
	tBACNET_SHED_LEVEL
;

74 
BACNET_SHED_LEVEL
 
	gRequeed_Shed_Lev
[
MAX_LOAD_CONTROLS
];

77 
BACNET_SHED_LEVEL
 
	gExed_Shed_Lev
[
MAX_LOAD_CONTROLS
];

80 
BACNET_SHED_LEVEL
 
	gAu_Shed_Lev
[
MAX_LOAD_CONTROLS
];

84 
BACNET_DATE_TIME
 
	gS_Time
[
MAX_LOAD_CONTROLS
];

85 
BACNET_DATE_TIME
 
	gEnd_Time
[
MAX_LOAD_CONTROLS
];

86 
BACNET_DATE_TIME
 
	gCut_Time
;

90 
ut32_t
 
	gShed_Duti
[
MAX_LOAD_CONTROLS
];

93 
ut32_t
 
	gDuty_Wdow
[
MAX_LOAD_CONTROLS
];

97 
bo
 
	gLd_Cڌ_Eb
[
MAX_LOAD_CONTROLS
];

101 
bo
 
	gLd_Cڌ_Reque_Wrn
[
MAX_LOAD_CONTROLS
];

103 
bo
 
	gS_Time_Prݔty_Wrn
[
MAX_LOAD_CONTROLS
];

109 
	gFu_Duty_Bale
[
MAX_LOAD_CONTROLS
];

111 
	#MAX_SHED_LEVELS
 3

	)

123 
	gShed_Levs
[
MAX_LOAD_CONTROLS
][
MAX_SHED_LEVELS
];

128 *
	gShed_Lev_Destis
[
MAX_SHED_LEVELS
] = {

134 
	gShed_Lev_Vues
[
MAX_SHED_LEVELS
] = {

142 cڡ 
	gLd_Cڌ_Prݔts_Requed
[] = {

143 
PROP_OBJECT_IDENTIFIER
,

144 
PROP_OBJECT_NAME
,

145 
PROP_OBJECT_TYPE
,

146 
PROP_PRESENT_VALUE
,

147 
PROP_STATUS_FLAGS
,

148 
PROP_EVENT_STATE
,

149 
PROP_REQUESTED_SHED_LEVEL
,

150 
PROP_START_TIME
,

151 
PROP_SHED_DURATION
,

152 
PROP_DUTY_WINDOW
,

153 
PROP_ENABLE
,

154 
PROP_EXPECTED_SHED_LEVEL
,

155 
PROP_ACTUAL_SHED_LEVEL
,

156 
PROP_SHED_LEVELS
,

157 
PROP_SHED_LEVEL_DESCRIPTIONS
,

161 cڡ 
	gLd_Cڌ_Prݔts_Oiڮ
[] = {

162 
PROP_DESCRIPTION
,

163 
PROP_FULL_DUTY_BASELINE
,

167 cڡ 
	gLd_Cڌ_Prݔts_Prrry
[] = {

171 
	$Ld_Cڌ_Prݔty_Lis
(

172 cڡ **
pRequed
,

173 cڡ **
pOiڮ
,

174 cڡ **
pPrrry
)

176 i(
pRequed
)

177 *
pRequed
 = 
Ld_Cڌ_Prݔts_Requed
;

178 i(
pOiڮ
)

179 *
pOiڮ
 = 
Ld_Cڌ_Prݔts_Oiڮ
;

180 i(
pPrrry
)

181 *
pPrrry
 = 
Ld_Cڌ_Prݔts_Prrry
;

184 
	}
}

186 
	$Ld_Cڌ_In
(

189 
i
, 
j
;

191 
i
 = 0; i < 
MAX_LOAD_CONTROLS
; i++) {

193 
P_Vue
[
i
] = 
BACNET_SHED_INACTIVE
;

194 
Requeed_Shed_Lev
[
i
].
ty
 = 
BACNET_SHED_TYPE_LEVEL
;

195 
Requeed_Shed_Lev
[
i
].
vue
.
v
 = 0;

196 
	`dime_wdrd_t
(&
S_Time
[
i
]);

197 
	`dime_wdrd_t
(&
End_Time
[
i
]);

198 
	`dime_wdrd_t
(&
Cut_Time
);

199 
Shed_Duti
[
i
] = 0;

200 
Duty_Wdow
[
i
] = 0;

201 
Ld_Cڌ_Eb
[
i
] = 
ue
;

202 
Fu_Duty_Bale
[
i
] = 1.500;

203 
Exed_Shed_Lev
[
i
].
ty
 = 
BACNET_SHED_TYPE_LEVEL
;

204 
Exed_Shed_Lev
[
i
].
vue
.
v
 = 0;

205 
Au_Shed_Lev
[
i
].
ty
 = 
BACNET_SHED_TYPE_LEVEL
;

206 
Au_Shed_Lev
[
i
].
vue
.
v
 = 0;

207 
Ld_Cڌ_Reque_Wrn
[
i
] = 
l
;

208 
S_Time_Prݔty_Wrn
[
i
] = 
l
;

209 
j
 = 0; j < 
MAX_SHED_LEVELS
; j++) {

210 
Shed_Levs
[
i
][
j
] = j + 1;

215 
	}
}

220 
bo
 
	$Ld_Cڌ_Vid_In
(

221 
ut32_t
 
obje_
)

223 i(
obje_
 < 
MAX_LOAD_CONTROLS
)

224  
ue
;

226  
l
;

227 
	}
}

231 
	$Ld_Cڌ_Cou
(

234  
MAX_LOAD_CONTROLS
;

235 
	}
}

240 
ut32_t
 
	$Ld_Cڌ_Index_To_In
(

241 
dex
)

243  
dex
;

244 
	}
}

249 
	$Ld_Cڌ_In_To_Index
(

250 
ut32_t
 
obje_
)

252 
dex
 = 
MAX_LOAD_CONTROLS
;

254 i(
obje_
 < 
MAX_LOAD_CONTROLS
)

255 
dex
 = 
obje_
;

257  
dex
;

258 
	}
}

260 
BACNET_SHED_STATE
 
	$Ld_Cڌ_P_Vue
(

261 
ut32_t
 
obje_
)

263 
BACNET_SHED_STATE
 
vue
 = 
BACNET_SHED_INACTIVE
;

264 
dex
 = 0;

266 
dex
 = 
	`Ld_Cڌ_In_To_Index
(
obje_
);

267 i(
dex
 < 
MAX_LOAD_CONTROLS
) {

268 
vue
 = 
P_Vue
[
dex
];

271  
vue
;

272 
	}
}

275 
bo
 
	$Ld_Cڌ_Obje_Name
(

276 
ut32_t
 
obje_
,

277 
BACNET_CHARACTER_STRING
 * 
obje_me
)

279 
xt_rg
[32] = "";

280 
bo
 
us
 = 
l
;

282 i(
obje_
 < 
MAX_LOAD_CONTROLS
) {

283 
	`rtf
(
xt_rg
, "LOAD CONTROL %u", 
obje_
);

284 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

287  
us
;

288 
	}
}

290 
	$Upde_Cut_Time
(

291 
BACNET_DATE_TIME
 * 
bdime
)

293 
time_t
 
tim
;

294 
tm
 *
tblock
;

310 
tim
 = 
	`time
(
NULL
);

311 
tblock
 = 
	`loime
(&
tim
);

312 
	`dime_t_vues
(
bdime
, (
ut16_t

tblock
->
tm_yr
,

313 (
ut8_t

tblock
->
tm_m
, (ut8_ttblock->
tm_mday
,

314 (
ut8_t

tblock
->
tm_hour
, (ut8_ttblock->
tm_m
,

315 (
ut8_t

tblock
->
tm_c
, 0);

316 
	}
}

319 
	$Requeed_Shed_Lev_Vue
(

320 
obje_dex
)

322 
shed_v_dex
 = 0;

323 
i
 = 0;

324 
queed_v
 = 0.0;

326 
Requeed_Shed_Lev
[
obje_dex
].
ty
) {

327 
BACNET_SHED_TYPE_PERCENT
:

328 
queed_v
 =

329 (
Requeed_Shed_Lev
[
obje_dex
].
vue
.
r
;

331 
BACNET_SHED_TYPE_AMOUNT
:

333 
queed_v
 =

334 
Fu_Duty_Bale
[
obje_dex
] -

335 
Requeed_Shed_Lev
[
obje_dex
].
vue
.
amou
;

336 
queed_v
 /
Fu_Duty_Bale
[
obje_dex
];

337 
queed_v
 *= 100.0;

339 
BACNET_SHED_TYPE_LEVEL
:

341 
i
 = 0; i < 
MAX_SHED_LEVELS
; i++) {

342 i(
Shed_Levs
[
obje_dex
][
i
] <=

343 
Requeed_Shed_Lev
[
obje_dex
].
vue
.
v
)

344 
shed_v_dex
 = 
i
;

346 
queed_v
 = 
Shed_Lev_Vues
[
shed_v_dex
];

350  
queed_v
;

351 
	}
}

353 
	$Shed_Lev_Cy
(

354 
BACNET_SHED_LEVEL
 * 
de
,

355 
BACNET_SHED_LEVEL
 * 
c
)

357 i(
de
 && 
c
) {

358 
de
->
ty
 = 
c
->type;

359 
c
->
ty
) {

360 
BACNET_SHED_TYPE_PERCENT
:

361 
de
->
vue
.
r
 = 
c
->value.percent;

363 
BACNET_SHED_TYPE_AMOUNT
:

364 
de
->
vue
.
amou
 = 
c
->value.amount;

366 
BACNET_SHED_TYPE_LEVEL
:

368 
de
->
vue
.
v
 = 
c
->value.level;

372 
	}
}

374 
	$Shed_Lev_Deu_S
(

375 
BACNET_SHED_LEVEL
 * 
de
,

376 
BACNET_SHED_LEVEL_TYPE
 
ty
)

378 i(
de
) {

379 
de
->
ty
 =ype;

380 
ty
) {

381 
BACNET_SHED_TYPE_PERCENT
:

382 
de
->
vue
.
r
 = 100;

384 
BACNET_SHED_TYPE_AMOUNT
:

385 
de
->
vue
.
amou
 = 0.0;

387 
BACNET_SHED_TYPE_LEVEL
:

389 
de
->
vue
.
v
 = 0;

393 
	}
}

395 
bo
 
	$Ab_To_Mt_Shed_Reque
(

396 
obje_dex
)

398 
v
 = 0.0;

399 
queed_v
 = 0.0;

400 
iܙy
 = 0;

401 
bo
 
us
 = 
l
;

402 
obje_
 = 0;

405 
obje_
 = 
obje_dex
;

406 
iܙy
 = 
	`Alog_Ouut_P_Vue_Priܙy
(
obje_
);

408 i(
iܙy
 >= 4) {

410 
queed_v
 = 
	`Requeed_Shed_Lev_Vue
(
obje_dex
);

411 
v
 = 
	`Alog_Ouut_P_Vue
(
obje_
);

412 i(
v
 >
queed_v
) {

413 
us
 = 
ue
;

417  
us
;

418 
	}
}

420 
	eld_cڌ_e
 {

421 
	mSHED_INACTIVE
,

422 
	mSHED_REQUEST_PENDING
,

423 
	mSHED_NON_COMPLIANT
,

424 
	mSHED_COMPLIANT
,

425 
	mMAX_LOAD_CONTROL_STATE


426 } 
	tLOAD_CONTROL_STATE
;

427 
LOAD_CONTROL_STATE
 
	gLd_Cڌ_S
[
MAX_LOAD_CONTROLS
];

428 
LOAD_CONTROL_STATE
 
	gLd_Cڌ_S_Pviouy
[
MAX_LOAD_CONTROLS
];

430 #i
PRINT_ENABLED_DEBUG


431 
	$Prt_Ld_Cڌ_S
(

432 
obje_dex
)

434 *
Ld_Cڌ_S_Text
[
MAX_LOAD_CONTROLS
] = {

441 i(
obje_dex
 < 
MAX_LOAD_CONTROLS
) {

442 i(
Ld_Cڌ_S
[
obje_dex
] < 
MAX_LOAD_CONTROL_STATE
) {

443 
	`tf
("Ld Cڌ[%d]=%s\n", 
obje_dex
,

444 
Ld_Cڌ_S_Text
[
Ld_Cڌ_S
[
obje_dex
]]);

447 
	}
}

450 
	$Ld_Cڌ_S_Mache
(

451 
obje_dex
)

453 
i
 = 0;

454 
diff
 = 0;

457 i(!
Ld_Cڌ_Eb
[
obje_dex
]) {

458 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_INACTIVE
;

462 
Ld_Cڌ_S
[
obje_dex
]) {

463 
SHED_REQUEST_PENDING
:

464 i(
Ld_Cڌ_Reque_Wrn
[
obje_dex
]) {

465 
Ld_Cڌ_Reque_Wrn
[
obje_dex
] = 
l
;

467 
Requeed_Shed_Lev
[
obje_dex
].
ty
) {

468 
BACNET_SHED_TYPE_PERCENT
:

469 i(
Requeed_Shed_Lev
[
obje_dex
].
vue
.
r
 ==

470 
DEFAULT_VALUE_PERCENT
)

471 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_INACTIVE
;

473 
BACNET_SHED_TYPE_AMOUNT
:

474 i(
Requeed_Shed_Lev
[
obje_dex
].
vue
.
amou
 ==

475 
DEFAULT_VALUE_AMOUNT
)

476 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_INACTIVE
;

478 
BACNET_SHED_TYPE_LEVEL
:

480 i(
Requeed_Shed_Lev
[
obje_dex
].
vue
.
v
 ==

481 
DEFAULT_VALUE_LEVEL
)

482 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_INACTIVE
;

485 i(
Ld_Cڌ_S
[
obje_dex
] =
SHED_INACTIVE
) {

486 #i
PRINT_ENABLED_DEBUG


487 
	`tf
("Load Control[%d]:Requested Shed Level=Default\n",

488 
obje_dex
);

494 i(
S_Time_Prݔty_Wrn
[
obje_dex
]) {

495 
S_Time_Prݔty_Wrn
[
obje_dex
] = 
l
;

497 i(
	`dime_wdrd
(&
S_Time
[
obje_dex
])) {

498 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_INACTIVE
;

499 #i
PRINT_ENABLED_DEBUG


500 
	`tf
("Load Control[%d]:Start Time=Wildcard\n",

501 
obje_dex
);

507 
	`dime_cy
(&
End_Time
[
obje_dex
], &
S_Time
[object_index]);

508 
	`dime_add_mus
(&
End_Time
[
obje_dex
],

509 
Shed_Duti
[
obje_dex
]);

510 
diff
 = 
	`dime_com
(&
End_Time
[
obje_dex
], &
Cut_Time
);

511 i(
diff
 < 0) {

514 #i
PRINT_ENABLED_DEBUG


515 
	`tf
("Load Control[%d]:Current Time"

516 " ia S Tim+ Duti\n", 
obje_dex
);

518 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_INACTIVE
;

521 
diff
 = 
	`dime_com
(&
Cut_Time
, &
S_Time
[
obje_dex
]);

522 i(
diff
 < 0) {

525 
	`Shed_Lev_Cy
(&
Exed_Shed_Lev
[
obje_dex
],

526 &
Requeed_Shed_Lev
[
obje_dex
]);

527 
	`Shed_Lev_Deu_S
(&
Au_Shed_Lev
[
obje_dex
],

528 
Requeed_Shed_Lev
[
obje_dex
].
ty
);

529 } i(
diff
 > 0) {

531 #i
PRINT_ENABLED_DEBUG


532 
	`tf
("Load Control[%d]:Current Time"

533 " ia S Time\n", 
obje_dex
);

536 i(
	`Ab_To_Mt_Shed_Reque
(
obje_dex
)) {

537 
	`Shed_Lev_Cy
(&
Exed_Shed_Lev
[
obje_dex
],

538 &
Requeed_Shed_Lev
[
obje_dex
]);

539 
	`Alog_Ouut_P_Vue_S
(
obje_dex
,

540 
	`Requeed_Shed_Lev_Vue
(
obje_dex
), 4);

541 
	`Shed_Lev_Cy
(&
Au_Shed_Lev
[
obje_dex
],

542 &
Requeed_Shed_Lev
[
obje_dex
]);

543 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_COMPLIANT
;

546 
	`Shed_Lev_Deu_S
(&
Exed_Shed_Lev
[
obje_dex
],

547 
Requeed_Shed_Lev
[
obje_dex
].
ty
);

548 
	`Shed_Lev_Deu_S
(&
Au_Shed_Lev
[
obje_dex
],

549 
Requeed_Shed_Lev
[
obje_dex
].
ty
);

550 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_NON_COMPLIANT
;

554 
SHED_NON_COMPLIANT
:

555 
	`dime_cy
(&
End_Time
[
obje_dex
], &
S_Time
[object_index]);

556 
	`dime_add_mus
(&
End_Time
[
obje_dex
],

557 
Shed_Duti
[
obje_dex
]);

558 
diff
 = 
	`dime_com
(&
End_Time
[
obje_dex
], &
Cut_Time
);

559 i(
diff
 < 0) {

561 #i
PRINT_ENABLED_DEBUG


562 
tf


564 
obje_dex
);

566 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_INACTIVE
;

569 i(
Ld_Cڌ_Reque_Wrn
[
obje_dex
] ||

570 
S_Time_Prݔty_Wrn
[
obje_dex
]) {

572 #i
PRINT_ENABLED_DEBUG


573 
	`tf
("Load Control[%d]:Control Property written\n",

574 
obje_dex
);

577 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_REQUEST_PENDING
;

580 i(
	`Ab_To_Mt_Shed_Reque
(
obje_dex
)) {

582 #i
PRINT_ENABLED_DEBUG


583 
	`tf
("Load Control[%d]:Ableo meet Shed Request\n",

584 
obje_dex
);

586 
	`Shed_Lev_Cy
(&
Exed_Shed_Lev
[
obje_dex
],

587 &
Requeed_Shed_Lev
[
obje_dex
]);

588 
	`Alog_Ouut_P_Vue_S
(
obje_dex
,

589 
	`Requeed_Shed_Lev_Vue
(
obje_dex
), 4);

590 
	`Shed_Lev_Cy
(&
Au_Shed_Lev
[
obje_dex
],

591 &
Requeed_Shed_Lev
[
obje_dex
]);

592 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_COMPLIANT
;

595 
SHED_COMPLIANT
:

596 
	`dime_cy
(&
End_Time
[
obje_dex
], &
S_Time
[object_index]);

597 
	`dime_add_mus
(&
End_Time
[
obje_dex
],

598 
Shed_Duti
[
obje_dex
]);

599 
diff
 = 
	`dime_com
(&
End_Time
[
obje_dex
], &
Cut_Time
);

600 i(
diff
 < 0) {

602 #i
PRINT_ENABLED_DEBUG


603 
tf


605 
obje_dex
);

607 
	`dime_wdrd_t
(&
S_Time
[
i
]);

608 
	`Alog_Ouut_P_Vue_Rquish
(
obje_dex
, 4);

609 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_INACTIVE
;

612 i(
Ld_Cڌ_Reque_Wrn
[
obje_dex
] ||

613 
S_Time_Prݔty_Wrn
[
obje_dex
]) {

615 #i
PRINT_ENABLED_DEBUG


616 
	`tf
("Load Control[%d]:Control Property written\n",

617 
obje_dex
);

620 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_REQUEST_PENDING
;

623 i(!
	`Ab_To_Mt_Shed_Reque
(
obje_dex
)) {

625 #i
PRINT_ENABLED_DEBUG


626 
	`tf
("Load Control[%d]:Notbleo meet Shed Request\n",

627 
obje_dex
);

629 
	`Shed_Lev_Deu_S
(&
Exed_Shed_Lev
[
obje_dex
],

630 
Requeed_Shed_Lev
[
obje_dex
].
ty
);

631 
	`Shed_Lev_Deu_S
(&
Au_Shed_Lev
[
obje_dex
],

632 
Requeed_Shed_Lev
[
obje_dex
].
ty
);

633 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_NON_COMPLIANT
;

636 
SHED_INACTIVE
:

638 i(
S_Time_Prݔty_Wrn
[
obje_dex
]) {

639 #i
PRINT_ENABLED_DEBUG


640 
	`tf
("Ld Cڌ[%d]:S Timwrn\n", 
obje_dex
);

643 
	`Shed_Lev_Cy
(&
Exed_Shed_Lev
[
obje_dex
],

644 &
Requeed_Shed_Lev
[
obje_dex
]);

645 
	`Shed_Lev_Deu_S
(&
Au_Shed_Lev
[
obje_dex
],

646 
Requeed_Shed_Lev
[
obje_dex
].
ty
);

647 
Ld_Cڌ_S
[
obje_dex
] = 
SHED_REQUEST_PENDING
;

653 
	}
}

656 
	$Ld_Cڌ_S_Mache_Hdr
(

659 
i
 = 0;

660 
bo
 
lized
 = 
l
;

662 i(!
lized
) {

663 
lized
 = 
ue
;

664 
i
 = 0; i < 
MAX_LOAD_CONTROLS
; i++) {

665 
Ld_Cڌ_S
[
i
] = 
SHED_INACTIVE
;

666 
Ld_Cڌ_S_Pviouy
[
i
] = 
SHED_INACTIVE
;

669 
	`Upde_Cut_Time
(&
Cut_Time
);

670 
i
 = 0; i < 
MAX_LOAD_CONTROLS
; i++) {

671 
	`Ld_Cڌ_S_Mache
(
i
);

672 i(
Ld_Cڌ_S
[
i
] !
Ld_Cڌ_S_Pviouy
[i]) {

673 #i
PRINT_ENABLED_DEBUG


674 
	`Prt_Ld_Cڌ_S
(
i
);

676 
Ld_Cڌ_S_Pviouy
[
i
] = 
Ld_Cڌ_S
[i];

681 
	}
}

684 
	$Ld_Cڌ_Rd_Prݔty
(

685 
BACNET_READ_PROPERTY_DATA
 * 
da
)

687 
n
 = 0;

688 
du_n
 = 0;

689 
BACNET_BIT_STRING
 
b_rg
;

690 
BACNET_CHARACTER_STRING
 
ch_rg
;

691 
umi
 = 0;

692 
obje_dex
 = 0;

693 
i
 = 0;

694 
bo
 
e
 = 
l
;

695 
ut8_t
 *
du
 = 
NULL
;

697 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

698 (
da
->
iti_da_n
 == 0)) {

701 
du
 = 
da
->
iti_da
;

702 
obje_dex
 = 
	`Ld_Cڌ_In_To_Index
(
da
->
obje_
);

703 
da
->
obje_ݔty
) {

704 
PROP_OBJECT_IDENTIFIER
:

705 
du_n
 =

706 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_LOAD_CONTROL
,

707 
da
->
obje_
);

709 
PROP_OBJECT_NAME
:

710 
PROP_DESCRIPTION
:

711 
	`Ld_Cڌ_Obje_Name
(
da
->
obje_
, &
ch_rg
);

712 
du_n
 =

713 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

715 
PROP_OBJECT_TYPE
:

716 
du_n
 =

717 
	`code_iti_umed
(&
du
[0], 
OBJECT_LOAD_CONTROL
);

719 
PROP_PRESENT_VALUE
:

720 
umi
 = 
	`Ld_Cڌ_P_Vue
(
da
->
obje_
);

721 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
umi
);

723 
PROP_STATUS_FLAGS
:

724 
	`brg_
(&
b_rg
);

727 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

731 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

735 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

737 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

738 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

740 
PROP_EVENT_STATE
:

741 
du_n
 =

742 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

744 
PROP_REQUESTED_SHED_LEVEL
:

745 
Requeed_Shed_Lev
[
obje_dex
].
ty
) {

746 
BACNET_SHED_TYPE_PERCENT
:

747 
du_n
 =

748 
	`code_cڋxt_unsigd
(&
du
[0], 0,

749 
Requeed_Shed_Lev
[
obje_dex
].
vue
.
r
);

751 
BACNET_SHED_TYPE_AMOUNT
:

752 
du_n
 =

753 
	`code_cڋxt_
(&
du
[0], 2,

754 
Requeed_Shed_Lev
[
obje_dex
].
vue
.
amou
);

756 
BACNET_SHED_TYPE_LEVEL
:

758 
du_n
 =

759 
	`code_cڋxt_unsigd
(&
du
[0], 1,

760 
Requeed_Shed_Lev
[
obje_dex
].
vue
.
v
);

764 
PROP_START_TIME
:

765 
n
 =

766 
	`code_iti_de
(&
du
[0],

767 &
S_Time
[
obje_dex
].
de
);

768 
du_n
 = 
n
;

769 
n
 =

770 
	`code_iti_time
(&
du
[
du_n
],

771 &
S_Time
[
obje_dex
].
time
);

772 
du_n
 +
n
;

774 
PROP_SHED_DURATION
:

775 
du_n
 =

776 
	`code_iti_unsigd
(&
du
[0],

777 
Shed_Duti
[
obje_dex
]);

779 
PROP_DUTY_WINDOW
:

780 
du_n
 =

781 
	`code_iti_unsigd
(&
du
[0],

782 
Duty_Wdow
[
obje_dex
]);

784 
PROP_ENABLE
:

785 
e
 = 
Ld_Cڌ_Eb
[
obje_dex
];

786 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

788 
PROP_FULL_DUTY_BASELINE
:

789 
du_n
 =

790 
	`code_iti_
(&
du
[0],

791 
Fu_Duty_Bale
[
obje_dex
]);

793 
PROP_EXPECTED_SHED_LEVEL
:

794 
Exed_Shed_Lev
[
obje_dex
].
ty
) {

795 
BACNET_SHED_TYPE_PERCENT
:

796 
du_n
 =

797 
	`code_cڋxt_unsigd
(&
du
[0], 0,

798 
Exed_Shed_Lev
[
obje_dex
].
vue
.
r
);

800 
BACNET_SHED_TYPE_AMOUNT
:

801 
du_n
 =

802 
	`code_cڋxt_
(&
du
[0], 2,

803 
Exed_Shed_Lev
[
obje_dex
].
vue
.
amou
);

805 
BACNET_SHED_TYPE_LEVEL
:

807 
du_n
 =

808 
	`code_cڋxt_unsigd
(&
du
[0], 1,

809 
Exed_Shed_Lev
[
obje_dex
].
vue
.
v
);

813 
PROP_ACTUAL_SHED_LEVEL
:

814 
Au_Shed_Lev
[
obje_dex
].
ty
) {

815 
BACNET_SHED_TYPE_PERCENT
:

816 
du_n
 =

817 
	`code_cڋxt_unsigd
(&
du
[0], 0,

818 
Au_Shed_Lev
[
obje_dex
].
vue
.
r
);

820 
BACNET_SHED_TYPE_AMOUNT
:

821 
du_n
 =

822 
	`code_cڋxt_
(&
du
[0], 2,

823 
Au_Shed_Lev
[
obje_dex
].
vue
.
amou
);

825 
BACNET_SHED_TYPE_LEVEL
:

827 
du_n
 =

828 
	`code_cڋxt_unsigd
(&
du
[0], 1,

829 
Au_Shed_Lev
[
obje_dex
].
vue
.
v
);

833 
PROP_SHED_LEVELS
:

835 i(
da
->
y_dex
 == 0)

836 
du_n
 =

837 
	`code_iti_unsigd
(&
du
[0], 
MAX_SHED_LEVELS
);

840 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

841 
du_n
 = 0;

842 
i
 = 0; i < 
MAX_SHED_LEVELS
; i++) {

844 
n
 =

845 
	`code_iti_unsigd
(&
du
[
du_n
],

846 
Shed_Levs
[
obje_dex
][
i
]);

848 i((
du_n
 + 
n
< 
MAX_APDU
)

849 
du_n
 +
n
;

851 
da
->
r_code
 =

852 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

853 
du_n
 = 
BACNET_STATUS_ABORT
;

858 i(
da
->
y_dex
 <
MAX_SHED_LEVELS
) {

859 
du_n
 =

860 
	`code_iti_unsigd
(&
du
[0],

861 
Shed_Levs
[
obje_dex
][
da
->
y_dex
 - 1]);

863 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

864 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

865 
du_n
 = 
BACNET_STATUS_ERROR
;

869 
PROP_SHED_LEVEL_DESCRIPTIONS
:

871 i(
da
->
y_dex
 == 0)

872 
du_n
 =

873 
	`code_iti_unsigd
(&
du
[0], 
MAX_SHED_LEVELS
);

876 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

877 
du_n
 = 0;

878 
i
 = 0; i < 
MAX_SHED_LEVELS
; i++) {

880 
	`charg__si
(&
ch_rg
,

881 
Shed_Lev_Destis
[
i
]);

882 
n
 =

883 
	`code_iti_cha_rg
(&
du
[
du_n
],

884 &
ch_rg
);

886 i((
du_n
 + 
n
< 
MAX_APDU
)

887 
du_n
 +
n
;

889 
da
->
r_code
 =

890 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

891 
du_n
 = 
BACNET_STATUS_ABORT
;

896 i(
da
->
y_dex
 <
MAX_SHED_LEVELS
) {

897 
	`charg__si
(&
ch_rg
,

898 
Shed_Lev_Destis
[
da
->
y_dex
 - 1]);

899 
du_n
 =

900 
	`code_iti_cha_rg
(&
du
[0],

901 &
ch_rg
);

903 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

904 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

905 
du_n
 = 
BACNET_STATUS_ERROR
;

910 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

911 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

912 
du_n
 = 
BACNET_STATUS_ERROR
;

916 i((
du_n
 >= 0) &&

917 (
da
->
obje_ݔty
 !
PROP_SHED_LEVEL_DESCRIPTIONS
) &&

918 (
da
->
obje_ݔty
 !
PROP_SHED_LEVELS
) &&

919 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

920 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

921 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

922 
du_n
 = 
BACNET_STATUS_ERROR
;

925  
du_n
;

926 
	}
}

929 
bo
 
	$Ld_Cڌ_Wre_Prݔty
(

930 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

932 
bo
 
us
 = 
l
;

933 
obje_dex
 = 0;

934 
n
 = 0;

935 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

936 
BACNET_DATE
 
TempDe
;

939 
n
 =

940 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

941 
wp_da
->
iti_da_n
, &
vue
);

943 i(
n
 < 0) {

945 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

946 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

947  
l
;

950 i((
wp_da
->
obje_ݔty
 !
PROP_SHED_LEVELS
) &&

951 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

952 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

953 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

954  
l
;

956 
obje_dex
 = 
	`Ld_Cڌ_In_To_Index
(
wp_da
->
obje_
);

957 
wp_da
->
obje_ݔty
) {

958 
PROP_REQUESTED_SHED_LEVEL
:

959 
n
 =

960 
	`ba_decode_cڋxt_da
(
wp_da
->
iti_da
,

961 
wp_da
->
iti_da_n
, &
vue
,

962 
PROP_REQUESTED_SHED_LEVEL
);

963 i(
vue
.
cڋxt_g
 == 0) {

965 
Requeed_Shed_Lev
[
obje_dex
].
ty
 =

966 
BACNET_SHED_TYPE_PERCENT
;

967 
Requeed_Shed_Lev
[
obje_dex
].
vue
.
r
 =

968 
vue
.
ty
.
Unsigd_I
;

969 
us
 = 
ue
;

970 } i(
vue
.
cڋxt_g
 == 1) {

972 
Requeed_Shed_Lev
[
obje_dex
].
ty
 =

973 
BACNET_SHED_TYPE_LEVEL
;

974 
Requeed_Shed_Lev
[
obje_dex
].
vue
.
v
 =

975 
vue
.
ty
.
Unsigd_I
;

976 
us
 = 
ue
;

977 } i(
vue
.
cڋxt_g
 == 2) {

979 
Requeed_Shed_Lev
[
obje_dex
].
ty
 =

980 
BACNET_SHED_TYPE_AMOUNT
;

981 
Requeed_Shed_Lev
[
obje_dex
].
vue
.
amou
 =

982 
vue
.
ty
.
Rl
;

983 
us
 = 
ue
;

986 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

987 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

989 i(
us
) {

990 
Ld_Cڌ_Reque_Wrn
[
obje_dex
] = 
ue
;

994 
PROP_START_TIME
:

995 
us
 =

996 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_DATE
,

997 &
wp_da
->
r_ass
, &wp_da->
r_code
);

998 i(!
us
) {

1003 
TempDe
 = 
vue
.
ty
.
De
;

1004 
n
 =

1005 
	`ba_decode_iti_da
(
wp_da
->
iti_da
 + 
n
,

1006 
wp_da
->
iti_da_n
 - 
n
, &
vue
);

1007 i(
n
) {

1008 
us
 =

1009 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_TIME
,

1010 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1011 i(
us
) {

1013 
S_Time
[
obje_dex
].
de
 = 
TempDe
;

1014 
S_Time
[
obje_dex
].
time
 = 
vue
.
ty
.
Time
;

1015 
S_Time_Prݔty_Wrn
[
obje_dex
] = 
ue
;

1018 
us
 = 
l
;

1019 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1020 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1024 
PROP_SHED_DURATION
:

1025 
us
 =

1026 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1027 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1028 i(
us
) {

1029 
Shed_Duti
[
obje_dex
] = 
vue
.
ty
.
Unsigd_I
;

1030 
Ld_Cڌ_Reque_Wrn
[
obje_dex
] = 
ue
;

1034 
PROP_DUTY_WINDOW
:

1035 
us
 =

1036 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1037 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1038 i(
us
) {

1039 
Duty_Wdow
[
obje_dex
] = 
vue
.
ty
.
Unsigd_I
;

1040 
Ld_Cڌ_Reque_Wrn
[
obje_dex
] = 
ue
;

1044 
PROP_SHED_LEVELS
:

1045 
us
 =

1046 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1047 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1048 i(
us
) {

1050 i(
wp_da
->
y_dex
 == 0) {

1051 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1052 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

1053 
us
 = 
l
;

1054 } i(
wp_da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

1056 } i(
wp_da
->
y_dex
 <
MAX_SHED_LEVELS
) {

1057 
Shed_Levs
[
obje_dex
][
wp_da
->
y_dex
 - 1] =

1058 
vue
.
ty
.
Unsigd_I
;

1062 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1063 
wp_da
->
r_code
 = 
ERROR_CODE_OTHER
;

1064 
us
 = 
l
;

1069 
PROP_ENABLE
:

1070 
us
 =

1071 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

1072 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1073 i(
us
) {

1074 
Ld_Cڌ_Eb
[
obje_dex
] = 
vue
.
ty
.
Boޗn
;

1078 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1079 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

1083  
us
;

1084 
	}
}

1086 #ifde
TEST


1087 
	~<as.h
>

1088 
	~<rg.h
>

1089 
	~"e.h
"

1092 
	$Ld_Cڌ_WrePrݔty_Reque_Shed_P
(

1093 
Te
 * 
pTe
,

1094 

,

1095 
r
)

1097 
bo
 
us
 = 
l
;

1098 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1099 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

1101 
wp_da
.
obje_ty
 = 
OBJECT_LOAD_CONTROL
;

1102 
wp_da
.
obje_
 = 

;

1103 
wp_da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1104 
wp_da
.
iܙy
 = 
BACNET_NO_PRIORITY
;

1105 
wp_da
.
obje_ݔty
 = 
PROP_REQUESTED_SHED_LEVEL
;

1106 
wp_da
.
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1107 
wp_da
.
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1108 
vue
.
cڋxt_ecific
 = 
ue
;

1109 
vue
.
cڋxt_g
 = 0;

1110 
vue
.
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

1111 
vue
.
ty
.
Unsigd_I
 = 
r
;

1112 
wp_da
.
iti_da_n
 =

1113 
	`ba_code_da
(&
wp_da
.
iti_da
[0], &
vue
);

1114 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1115 
us
 = 
	`Ld_Cڌ_Wre_Prݔty
(&
wp_da
);

1116 
	`_
(
pTe
, 
us
 =
ue
);

1117 
	}
}

1120 
	$Ld_Cڌ_WrePrݔty_Reque_Shed_Lev
(

1121 
Te
 * 
pTe
,

1122 

,

1123 
v
)

1125 
bo
 
us
 = 
l
;

1126 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1127 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

1129 
wp_da
.
obje_ty
 = 
OBJECT_LOAD_CONTROL
;

1130 
wp_da
.
obje_
 = 

;

1131 
wp_da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1132 
wp_da
.
iܙy
 = 
BACNET_NO_PRIORITY
;

1133 
wp_da
.
obje_ݔty
 = 
PROP_REQUESTED_SHED_LEVEL
;

1134 
vue
.
cڋxt_ecific
 = 
ue
;

1135 
vue
.
cڋxt_g
 = 1;

1136 
vue
.
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

1137 
vue
.
ty
.
Unsigd_I
 = 
v
;

1138 
wp_da
.
iti_da_n
 =

1139 
	`ba_code_da
(&
wp_da
.
iti_da
[0], &
vue
);

1140 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1141 
us
 = 
	`Ld_Cڌ_Wre_Prݔty
(&
wp_da
);

1142 
	`_
(
pTe
, 
us
 =
ue
);

1143 
	}
}

1146 
	$Ld_Cڌ_WrePrݔty_Reque_Shed_Amou
(

1147 
Te
 * 
pTe
,

1148 

,

1149 
amou
)

1151 
bo
 
us
 = 
l
;

1152 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1153 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

1155 
wp_da
.
obje_ty
 = 
OBJECT_LOAD_CONTROL
;

1156 
wp_da
.
obje_
 = 

;

1157 
wp_da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1158 
wp_da
.
iܙy
 = 
BACNET_NO_PRIORITY
;

1159 
wp_da
.
obje_ݔty
 = 
PROP_REQUESTED_SHED_LEVEL
;

1160 
vue
.
cڋxt_ecific
 = 
ue
;

1161 
vue
.
cڋxt_g
 = 2;

1162 
vue
.
g
 = 
BACNET_APPLICATION_TAG_REAL
;

1163 
vue
.
ty
.
Rl
 = 
amou
;

1164 
wp_da
.
iti_da_n
 =

1165 
	`ba_code_da
(&
wp_da
.
iti_da
[0], &
vue
);

1166 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1167 
us
 = 
	`Ld_Cڌ_Wre_Prݔty
(&
wp_da
);

1168 
	`_
(
pTe
, 
us
 =
ue
);

1169 
	}
}

1172 
	$Ld_Cڌ_WrePrݔty_Eb
(

1173 
Te
 * 
pTe
,

1174 

,

1175 
bo
 
ab
)

1177 
bo
 
us
 = 
l
;

1178 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1179 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

1181 
wp_da
.
obje_ty
 = 
OBJECT_LOAD_CONTROL
;

1182 
wp_da
.
obje_
 = 

;

1183 
wp_da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1184 
wp_da
.
iܙy
 = 
BACNET_NO_PRIORITY
;

1186 
wp_da
.
obje_ݔty
 = 
PROP_ENABLE
;

1187 
vue
.
cڋxt_ecific
 = 
l
;

1188 
vue
.
cڋxt_g
 = 0;

1189 
vue
.
g
 = 
BACNET_APPLICATION_TAG_BOOLEAN
;

1190 
vue
.
ty
.
Boޗn
 = 
ab
;

1191 
wp_da
.
iti_da_n
 =

1192 
	`ba_code_da
(&
wp_da
.
iti_da
[0], &
vue
);

1193 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1194 
us
 = 
	`Ld_Cڌ_Wre_Prݔty
(&
wp_da
);

1195 
	`_
(
pTe
, 
us
 =
ue
);

1196 
	}
}

1198 
	$Ld_Cڌ_WrePrݔty_Shed_Duti
(

1199 
Te
 * 
pTe
,

1200 

,

1201 
duti
)

1203 
bo
 
us
 = 
l
;

1204 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1205 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

1207 
wp_da
.
obje_ty
 = 
OBJECT_LOAD_CONTROL
;

1208 
wp_da
.
obje_
 = 

;

1209 
wp_da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1210 
wp_da
.
iܙy
 = 
BACNET_NO_PRIORITY
;

1211 
wp_da
.
obje_ݔty
 = 
PROP_SHED_DURATION
;

1212 
vue
.
cڋxt_ecific
 = 
l
;

1213 
vue
.
cڋxt_g
 = 0;

1214 
vue
.
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

1215 
vue
.
ty
.
Unsigd_I
 = 
duti
;

1216 
wp_da
.
iti_da_n
 =

1217 
	`ba_code_da
(&
wp_da
.
iti_da
[0], &
vue
);

1218 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1219 
us
 = 
	`Ld_Cڌ_Wre_Prݔty
(&
wp_da
);

1220 
	`_
(
pTe
, 
us
 =
ue
);

1221 
	}
}

1223 
	$Ld_Cڌ_WrePrݔty_Duty_Wdow
(

1224 
Te
 * 
pTe
,

1225 

,

1226 
duti
)

1228 
bo
 
us
 = 
l
;

1229 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1230 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

1232 
wp_da
.
obje_ty
 = 
OBJECT_LOAD_CONTROL
;

1233 
wp_da
.
obje_
 = 

;

1234 
wp_da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1235 
wp_da
.
iܙy
 = 
BACNET_NO_PRIORITY
;

1236 
wp_da
.
obje_ݔty
 = 
PROP_DUTY_WINDOW
;

1237 
vue
.
cڋxt_ecific
 = 
l
;

1238 
vue
.
cڋxt_g
 = 0;

1239 
vue
.
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

1240 
vue
.
ty
.
Unsigd_I
 = 
duti
;

1241 
wp_da
.
iti_da_n
 =

1242 
	`ba_code_da
(&
wp_da
.
iti_da
[0], &
vue
);

1243 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1244 
us
 = 
	`Ld_Cڌ_Wre_Prݔty
(&
wp_da
);

1245 
	`_
(
pTe
, 
us
 =
ue
);

1246 
	}
}

1248 
	$Ld_Cڌ_WrePrݔty_S_Time_Wdrds
(

1249 
Te
 * 
pTe
,

1250 

)

1252 
n
 = 0;

1253 
bo
 
us
 = 
l
;

1254 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1255 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

1257 
wp_da
.
obje_ty
 = 
OBJECT_LOAD_CONTROL
;

1258 
wp_da
.
obje_
 = 

;

1259 
wp_da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1260 
wp_da
.
iܙy
 = 
BACNET_NO_PRIORITY
;

1261 
wp_da
.
obje_ݔty
 = 
PROP_START_TIME
;

1262 
vue
.
cڋxt_ecific
 = 
l
;

1263 
vue
.
cڋxt_g
 = 0;

1264 
vue
.
g
 = 
BACNET_APPLICATION_TAG_DATE
;

1265 
	`dime_de_wdrd_t
(&
vue
.
ty
.
De
);

1266 
wp_da
.
iti_da_n
 =

1267 
	`ba_code_da
(&
wp_da
.
iti_da
[0], &
vue
);

1268 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1269 
n
 = 
wp_da
.
iti_da_n
;

1270 
vue
.
g
 = 
BACNET_APPLICATION_TAG_TIME
;

1271 
	`dime_time_wdrd_t
(&
vue
.
ty
.
Time
);

1272 
wp_da
.
iti_da_n
 =

1273 
	`ba_code_da
(&
wp_da
.
iti_da
[
n
], &
vue
);

1274 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1275 
wp_da
.
iti_da_n
 +
n
;

1276 
us
 = 
	`Ld_Cڌ_Wre_Prݔty
(&
wp_da
);

1277 
	`_
(
pTe
, 
us
 =
ue
);

1278 
	}
}

1280 
	$Ld_Cڌ_WrePrݔty_S_Time
(

1281 
Te
 * 
pTe
,

1282 

,

1283 
ut16_t
 
yr
,

1284 
ut8_t
 
mth
,

1285 
ut8_t
 
day
,

1286 
ut8_t
 
hour
,

1287 
ut8_t
 
mu
,

1288 
ut8_t
 
cds
,

1289 
ut8_t
 
hunddths
)

1291 
n
 = 0;

1292 
bo
 
us
 = 
l
;

1293 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1294 
BACNET_WRITE_PROPERTY_DATA
 
wp_da
;

1296 
wp_da
.
obje_ty
 = 
OBJECT_LOAD_CONTROL
;

1297 
wp_da
.
obje_
 = 

;

1298 
wp_da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1299 
wp_da
.
iܙy
 = 
BACNET_NO_PRIORITY
;

1300 
wp_da
.
obje_ݔty
 = 
PROP_START_TIME
;

1301 
vue
.
cڋxt_ecific
 = 
l
;

1302 
vue
.
cڋxt_g
 = 0;

1303 
vue
.
g
 = 
BACNET_APPLICATION_TAG_DATE
;

1304 
	`dime_t_de
(&
vue
.
ty
.
De
, 
yr
, 
mth
, 
day
);

1305 
wp_da
.
iti_da_n
 =

1306 
	`ba_code_da
(&
wp_da
.
iti_da
[0], &
vue
);

1307 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1308 
n
 = 
wp_da
.
iti_da_n
;

1309 
vue
.
g
 = 
BACNET_APPLICATION_TAG_TIME
;

1310 
	`dime_t_time
(&
vue
.
ty
.
Time
, 
hour
, 
mu
, 
cds
, 
hunddths
);

1311 
wp_da
.
iti_da_n
 =

1312 
	`ba_code_da
(&
wp_da
.
iti_da
[
n
], &
vue
);

1313 
	`_
(
pTe
, 
wp_da
.
iti_da_n
 > 0);

1314 
wp_da
.
iti_da_n
 +
n
;

1315 
us
 = 
	`Ld_Cڌ_Wre_Prݔty
(&
wp_da
);

1316 
	`_
(
pTe
, 
us
 =
ue
);

1317 
	}
}

1319 
	$LdCڌSMache
(

1320 
Te
 * 
pTe
)

1322 
i
 = 0, 
j
 = 0;

1323 
ut8_t
 
v
 = 0;

1325 
	`Ld_Cڌ_In
();

1327 
j
 = 0; j < 20; j++) {

1328 
	`Ld_Cڌ_S_Mache
(0);

1329 
i
 = 0; i < 
MAX_LOAD_CONTROLS
; i++) {

1330 
	`_
(
pTe
, 
Ld_Cڌ_S
[
i
] =
SHED_INACTIVE
);

1335 
	`Ld_Cڌ_WrePrݔty_Eb
(
pTe
, 0, 
ue
);

1336 
	`Ld_Cڌ_WrePrݔty_Shed_Duti
(
pTe
, 0, 60);

1337 
	`Ld_Cڌ_WrePrݔty_S_Time_Wdrds
(
pTe
, 0);

1338 
	`Ld_Cڌ_S_Mache
(0);

1339 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1340 
	`Ld_Cڌ_S_Mache
(0);

1341 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_INACTIVE
);

1344 
	`Ld_Cڌ_In
();

1345 
	`Ld_Cڌ_WrePrݔty_Reque_Shed_Lev
(
pTe
, 0, 0);

1346 
	`Ld_Cڌ_WrePrݔty_S_Time
(
pTe
, 0, 2007, 2, 27, 15, 0, 0, 0);

1347 
	`Ld_Cڌ_WrePrݔty_Shed_Duti
(
pTe
, 0, 5);

1348 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 15, 0, 0, 0);

1349 
	`Ld_Cڌ_S_Mache
(0);

1350 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1351 
	`Ld_Cڌ_S_Mache
(0);

1352 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_INACTIVE
);

1355 
	`Ld_Cڌ_In
();

1356 
	`Ld_Cڌ_WrePrݔty_Eb
(
pTe
, 0, 
ue
);

1357 
	`Ld_Cڌ_WrePrݔty_Reque_Shed_Lev
(
pTe
, 0, 1);

1358 
	`Ld_Cڌ_WrePrݔty_Shed_Duti
(
pTe
, 0, 5);

1359 
	`Ld_Cڌ_WrePrݔty_S_Time
(
pTe
, 0, 2007, 2, 27, 15, 0, 0, 0);

1360 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 28, 15, 0, 0, 0);

1361 
	`Ld_Cڌ_S_Mache
(0);

1362 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1363 
	`Ld_Cڌ_S_Mache
(0);

1364 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_INACTIVE
);

1367 
	`Ld_Cڌ_In
();

1368 
	`Ld_Cڌ_WrePrݔty_Eb
(
pTe
, 0, 
ue
);

1369 
	`Ld_Cڌ_WrePrݔty_Reque_Shed_Lev
(
pTe
, 0, 1);

1370 
	`Ld_Cڌ_WrePrݔty_Shed_Duti
(
pTe
, 0, 5);

1371 
	`Ld_Cڌ_WrePrݔty_S_Time
(
pTe
, 0, 2007, 2, 27, 15, 0, 0, 0);

1372 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 5, 0, 0, 0);

1373 
	`Ld_Cڌ_S_Mache
(0);

1374 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1375 
	`Ld_Cڌ_S_Mache
(0);

1376 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1377 
	`Ld_Cڌ_WrePrݔty_Reque_Shed_Lev
(
pTe
, 0, 2);

1378 
	`Ld_Cڌ_S_Mache
(0);

1379 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1380 
	`Ld_Cڌ_WrePrݔty_Shed_Duti
(
pTe
, 0, 6);

1381 
	`Ld_Cڌ_S_Mache
(0);

1382 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1383 
	`Ld_Cڌ_WrePrݔty_Duty_Wdow
(
pTe
, 0, 60);

1384 
	`Ld_Cڌ_S_Mache
(0);

1385 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1386 
	`Ld_Cڌ_WrePrݔty_S_Time
(
pTe
, 0, 2007, 2, 27, 15, 0, 0, 1);

1387 
	`Ld_Cڌ_S_Mache
(0);

1388 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1389 
	`Ld_Cڌ_S_Mache
(0);

1390 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1391 
	`Ld_Cڌ_S_Mache
(0);

1392 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1395 
	`Ld_Cڌ_In
();

1396 
	`Ld_Cڌ_WrePrݔty_Eb
(
pTe
, 0, 
ue
);

1397 
	`Ld_Cڌ_WrePrݔty_Reque_Shed_Lev
(
pTe
, 0, 1);

1398 
	`Ld_Cڌ_WrePrݔty_Shed_Duti
(
pTe
, 0, 120);

1399 
	`Ld_Cڌ_WrePrݔty_S_Time
(
pTe
, 0, 2007, 2, 27, 15, 0, 0, 0);

1400 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 5, 0, 0, 0);

1401 
	`Ld_Cڌ_S_Mache
(0);

1402 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1403 
	`Ld_Cڌ_S_Mache
(0);

1404 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1406 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 16, 0, 0, 0);

1407 
	`Alog_Ouut_P_Vue_S
(0, 0, 16);

1408 
	`Ld_Cڌ_S_Mache
(0);

1409 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_NON_COMPLIANT
);

1410 
	`Ld_Cڌ_S_Mache
(0);

1411 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_NON_COMPLIANT
);

1413 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 23, 0, 0, 0);

1414 
	`Ld_Cڌ_S_Mache
(0);

1415 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_INACTIVE
);

1418 
	`Ld_Cڌ_In
();

1419 
	`Ld_Cڌ_WrePrݔty_Eb
(
pTe
, 0, 
ue
);

1420 
	`Ld_Cڌ_WrePrݔty_Reque_Shed_Lev
(
pTe
, 0, 1);

1421 
	`Ld_Cڌ_WrePrݔty_Shed_Duti
(
pTe
, 0, 120);

1422 
	`Ld_Cڌ_WrePrݔty_S_Time
(
pTe
, 0, 2007, 2, 27, 15, 0, 0, 0);

1423 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 5, 0, 0, 0);

1424 
	`Ld_Cڌ_S_Mache
(0);

1425 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1426 
	`Ld_Cڌ_S_Mache
(0);

1427 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1429 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 16, 0, 0, 0);

1430 
	`Alog_Ouut_P_Vue_S
(0, 0, 16);

1431 
	`Ld_Cڌ_S_Mache
(0);

1432 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_NON_COMPLIANT
);

1433 
	`Ld_Cڌ_S_Mache
(0);

1434 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_NON_COMPLIANT
);

1436 
	`Ld_Cڌ_WrePrݔty_S_Time
(
pTe
, 0, 2007, 2, 27, 16, 0, 0, 0);

1437 
	`Ld_Cڌ_S_Mache
(0);

1438 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1439 
	`Ld_Cڌ_S_Mache
(0);

1440 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_REQUEST_PENDING
);

1441 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 16, 0, 1, 0);

1442 
	`Ld_Cڌ_S_Mache
(0);

1443 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_NON_COMPLIANT
);

1445 
	`Alog_Ouut_P_Vue_S
(0, 100, 16);

1446 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 16, 0, 2, 0);

1447 
	`Ld_Cڌ_S_Mache
(0);

1448 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_COMPLIANT
);

1449 
v
 = 
	`Alog_Ouut_P_Vue
(0);

1450 
	`_
(
pTe
, 
v
 == 90);

1452 
	`dime_t_vues
(&
Cut_Time
, 2007, 2, 27, 23, 0, 0, 0);

1453 
	`Ld_Cڌ_S_Mache
(0);

1454 
	`_
(
pTe
, 
Ld_Cڌ_S
[0] =
SHED_INACTIVE
);

1455 
v
 = 
	`Alog_Ouut_P_Vue
(0);

1456 
	`_
(
pTe
, 
v
 == 100);

1457 
	}
}

1459 
	$LdCڌ
(

1460 
Te
 * 
pTe
)

1462 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

1463 
n
 = 0;

1464 
ut32_t
 
n_vue
 = 0;

1465 
ut8_t
 
g_numb
 = 0;

1466 
ut16_t
 
decoded_ty
 = 0;

1467 
ut32_t
 
decoded_
 = 0;

1468 
BACNET_READ_PROPERTY_DATA
 
da
;

1470 
	`Alog_Ouut_In
();

1471 
	`Ld_Cڌ_In
();

1472 
da
.
iti_da
 = &
du
[0];

1473 
da
.
iti_da_n
 = (
du
);

1474 
da
.
obje_ty
 = 
OBJECT_LOAD_CONTROL
;

1475 
da
.
obje_
 = 1;

1476 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

1477 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1478 
n
 = 
	`Ld_Cڌ_Rd_Prݔty
(&
da
);

1479 
	`_
(
pTe
, 
n
 != 0);

1480 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

1481 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

1482 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

1483 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

1484 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

1487 
	}
}

1489 #ifde
TEST_LOAD_CONTROL


1490 
	$ma
(

1493 
Te
 *
pTe
;

1494 
bo
 
rc
;

1496 
pTe
 = 
	`_
("BACÈLd Cڌ", 
NULL
);

1498 
rc
 = 
	`_addTeFuni
(
pTe
, 
LdCڌ
);

1499 
	`as
(
rc
);

1500 
rc
 = 
	`_addTeFuni
(
pTe
, 
LdCڌSMache
);

1501 
	`as
(
rc
);

1503 
	`_tSm
(
pTe
, 
dout
);

1504 
	`_run
(
pTe
);

1505 (
	`_pt
(
pTe
);

1506 
	`_deroy
(
pTe
);

1509 
	}
}

	@demo/object/lc.h

25 #ide
LOADCONTROL_H


26 
	#LOADCONTROL_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
Ld_Cڌ_Prݔty_Lis
(

40 cڡ **
pRequed
,

41 cڡ **
pOiڮ
,

42 cڡ **
pPrrry
);

43 
Ld_Cڌ_S_Mache_Hdr
(

46 
bo
 
Ld_Cڌ_Vid_In
(

47 
ut32_t
 
obje_
);

48 
Ld_Cڌ_Cou
(

50 
ut32_t
 
Ld_Cڌ_Index_To_In
(

51 
dex
);

52 
Ld_Cڌ_In_To_Index
(

53 
ut32_t
 
obje_
);

55 
bo
 
Ld_Cڌ_Obje_Name
(

56 
ut32_t
 
obje_
,

57 
BACNET_CHARACTER_STRING
 * 
obje_me
);

59 
Ld_Cڌ_In
(

61 
Ld_Cڌ_S_Mache
(

62 
obje_dex
);

64 
Ld_Cڌ_Rd_Prݔty
(

65 
BACNET_READ_PROPERTY_DATA
 * 
da
);

67 
bo
 
Ld_Cڌ_Wre_Prݔty
(

68 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

70 #ifde
TEST


71 
	~"e.h
"

72 
LdCڌ
(

73 
Te
 * 
pTe
);

76 #ifde
__lulus


	@demo/object/lo.c

30 
	~<dbo.h
>

31 
	~<dt.h
>

32 
	~<dio.h
>

33 
	~"bacdef.h
"

34 
	~"bacdcode.h
"

35 
	~"banum.h
"

36 
	~"ba.h
"

37 
	~"cfig.h
"

38 
	~".h
"

39 
	~"wp.h
"

40 
	~"lightg.h
"

41 
	~"hdrs.h
"

42 
	~"li.h
"

44 
	~"lo.h
"

46 #ide
MAX_LIGHTING_OUTPUTS


47 
	#MAX_LIGHTING_OUTPUTS
 8

	)

50 
	slightg_ouut_obje
 {

51 
	mP_Vue
;

52 
	mTckg_Vue
;

53 
	mPhysil_Vue
;

54 
BACNET_LIGHTING_COMMAND
 
	mLightg_Commd
;

55 
BACNET_LIGHTING_IN_PROGRESS
 
	mIn_Progss
;

56 
bo
 
	mOut_Of_Svi
:1;

57 
bo
 
	mBlk_Wn_Eb
:1;

58 
bo
 
	mEgss_Aive
:1;

59 
ut32_t
 
	mEgss_Time
;

60 
ut32_t
 
	mDeu_Fade_Time
;

61 
	mDeu_Ramp_Re
;

62 
	mDeu_Sp_Inemt
;

63 
BACNET_LIGHTING_TRANSITION
 
	mTnsi
;

64 
	mFdback_Vue
;

65 
	mPriܙy_Aay
[
BACNET_MAX_PRIORITY
];

66 
ut16_t
 
	mPriܙy_Aive_Bs
;

67 
	mRquish_Deu
;

68 
	mPow
;

69 
	mInous_Pow
;

70 
	mM_Au_Vue
;

71 
	mMax_Au_Vue
;

72 
ut8_t
 
	mLightg_Commd_Deu_Priܙy
;

74 
lightg_ouut_obje
 
	gLightg_Ouut
[
MAX_LIGHTING_OUTPUTS
];

78 cڡ 
	gLightg_Ouut_Prݔts_Requed
[] = {

79 
PROP_OBJECT_IDENTIFIER
,

80 
PROP_OBJECT_NAME
,

81 
PROP_OBJECT_TYPE
,

82 
PROP_PRESENT_VALUE
,

83 
PROP_TRACKING_VALUE
,

84 
PROP_LIGHTING_COMMAND
,

85 
PROP_IN_PROGRESS
,

86 
PROP_STATUS_FLAGS
,

87 
PROP_OUT_OF_SERVICE
,

88 
PROP_BLINK_WARN_ENABLE
,

89 
PROP_EGRESS_TIME
,

90 
PROP_EGRESS_ACTIVE
,

91 
PROP_DEFAULT_FADE_TIME
,

92 
PROP_DEFAULT_RAMP_RATE
,

93 
PROP_DEFAULT_STEP_INCREMENT
,

94 
PROP_PRIORITY_ARRAY
,

95 
PROP_RELINQUISH_DEFAULT
,

96 
PROP_LIGHTING_COMMAND_DEFAULT_PRIORITY
,

99 cڡ 
	gLightg_Ouut_Prݔts_Oiڮ
[] = {

103 cڡ 
	gLightg_Ouut_Prݔts_Prrry
[] = {

118 
	$Lightg_Ouut_Prݔty_Lis
(

119 cڡ **
pRequed
,

120 cڡ **
pOiڮ
,

121 cڡ **
pPrrry
)

123 i(
pRequed
)

124 *
pRequed
 = 
Lightg_Ouut_Prݔts_Requed
;

125 i(
pOiڮ
)

126 *
pOiڮ
 = 
Lightg_Ouut_Prݔts_Oiڮ
;

127 i(
pPrrry
)

128 *
pPrrry
 = 
Lightg_Ouut_Prݔts_Prrry
;

131 
	}
}

140 
bo
 
	$Lightg_Ouut_Vid_In
(

141 
ut32_t
 
obje_
)

143 
dex
;

145 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

146 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

147  
ue
;

150  
l
;

151 
	}
}

158 
	$Lightg_Ouut_Cou
(

161  
MAX_LIGHTING_OUTPUTS
;

162 
	}
}

172 
ut32_t
 
	$Lightg_Ouut_Index_To_In
(

173 
dex
)

175 
ut32_t
 

 = 1;

177 

 +
dex
;

179  

;

180 
	}
}

191 
	$Lightg_Ouut_In_To_Index
(

192 
ut32_t
 
obje_
)

194 
dex
 = 
MAX_LIGHTING_OUTPUTS
;

196 i(
obje_
) {

197 
dex
 = 
obje_
 - 1;

198 i(
dex
 > 
MAX_LIGHTING_OUTPUTS
) {

199 
dex
 = 
MAX_LIGHTING_OUTPUTS
;

203  
dex
;

204 
	}
}

213 
	$Lightg_Ouut_P_Vue
(

214 
ut32_t
 
obje_
)

216 
vue
 = 0.0;

217 
dex
 = 0;

218 
p
 = 0;

220 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

221 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

222 
vue
 = 
Lightg_Ouut
[
dex
].
Rquish_Deu
;

223 
p
 = 0; < 
BACNET_MAX_PRIORITY
;++) {

224 i(
	`BIT_CHECK
(
Lightg_Ouut
[
dex
].
Priܙy_Aive_Bs
, 
p
)) {

225 
vue
 = 
Lightg_Ouut
[
dex
].
Priܙy_Aay
[
p
];

231  
vue
;

232 
	}
}

243 
	$Lightg_Ouut_Priܙy_Vue
(

244 
ut32_t
 
obje_
,

245 
iܙy
)

247 
vue
 = 0.0;

248 
dex
 = 0;

250 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

251 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

252 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

253 
iܙy
--;

254 
vue
 = 
Lightg_Ouut
[
dex
].
Priܙy_Aay
[
iܙy
];

258  
vue
;

259 
	}
}

270 
bo
 
	$Lightg_Ouut_Priܙy_Aive
(

271 
ut32_t
 
obje_
,

272 
iܙy
)

274 
bo
 
us
 = 
l
;

275 
dex
 = 0;

277 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

278 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

279 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

280 
iܙy
--;

281 i(
	`BIT_CHECK
(
Lightg_Ouut
[
dex
].
Priܙy_Aive_Bs
, 
iܙy
)) {

282 
us
 = 
ue
;

287  
us
;

288 
	}
}

297 
	$Lightg_Ouut_P_Vue_Priܙy
(

298 
ut32_t
 
obje_
)

300 
dex
 = 0;

301 
p
 = 0;

302 
iܙy
 = 0;

304 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

305 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

306 
p
 = 0; < 
BACNET_MAX_PRIORITY
;++) {

307 i(
	`BIT_CHECK
(
Lightg_Ouut
[
dex
].
Priܙy_Aive_Bs
, 
p
)) {

308 
iܙy
 = 
p
 + 1;

314  
iܙy
;

315 
	}
}

327 
bo
 
	$Lightg_Ouut_P_Vue_S
(

328 
ut32_t
 
obje_
,

329 
vue
,

330 
iܙy
)

332 
dex
 = 0;

333 
bo
 
us
 = 
l
;

335 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

336 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

337 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

338 (
iܙy
 != 6 )) {

339 
iܙy
--;

340 
	`BIT_SET
(
Lightg_Ouut
[
dex
].
Priܙy_Aive_Bs
, 
iܙy
);

341 
Lightg_Ouut
[
dex
].
Priܙy_Aay
[
iܙy
] = 
vue
;

342 
us
 = 
ue
;

346  
us
;

347 
	}
}

358 
bo
 
	$Lightg_Ouut_P_Vue_Rquish
(

359 
ut32_t
 
obje_
,

360 
iܙy
)

362 
dex
 = 0;

363 
bo
 
us
 = 
l
;

365 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

366 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

367 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

368 (
iܙy
 != 6 )) {

369 
iܙy
--;

370 
	`BIT_CLEAR
(
Lightg_Ouut
[
dex
].
Priܙy_Aive_Bs
, 
iܙy
);

371 
Lightg_Ouut
[
dex
].
Priܙy_Aay
[
iܙy
] = 0.0;

372 
us
 = 
ue
;

376  
us
;

377 
	}
}

389 
bo
 
	$Lightg_Ouut_Obje_Name
(

390 
ut32_t
 
obje_
,

391 
BACNET_CHARACTER_STRING
 * 
obje_me
)

393 
xt_rg
[32] = "";

394 
bo
 
us
 = 
l
;

395 
dex
 = 0;

397 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

398 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

399 
	`rtf
(
xt_rg
, "LIGHTING OUTPUT %lu",

400 (
obje_
);

401 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

404  
us
;

405 
	}
}

415 
bo
 
	$Lightg_Ouut_Lightg_Commd_S
(

416 
ut32_t
 
obje_
,

417 
BACNET_LIGHTING_COMMAND
 *
vue
)

419 
bo
 
us
 = 
l
;

420 
dex
 = 0;

422 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

423 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

425 
us
 = 
	`lightg_commd_cy
(

426 &
Lightg_Ouut
[
dex
].
Lightg_Commd
,

427 
vue
);

431  
us
;

432 
	}
}

442 
bo
 
	$Lightg_Ouut_Lightg_Commd
(

443 
ut32_t
 
obje_
,

444 
BACNET_LIGHTING_COMMAND
 *
vue
)

446 
bo
 
us
 = 
l
;

447 
dex
 = 0;

449 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

450 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

451 
us
 = 
	`lightg_commd_cy
(
vue
,

452 &
Lightg_Ouut
[
dex
].
Lightg_Commd
);

455  
us
;

456 
	}
}

465 
BACNET_LIGHTING_IN_PROGRESS
 
	$Lightg_Ouut_In_Progss
(

466 
ut32_t
 
obje_
)

468 
BACNET_LIGHTING_IN_PROGRESS
 
vue
 = 
BACNET_LIGHTING_IDLE
;

469 
dex
 = 0;

471 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

472 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

473 
vue
 = 
Lightg_Ouut
[
dex
].
In_Progss
;

476  
vue
;

477 
	}
}

488 
bo
 
	$Lightg_Ouut_In_Progss_S
(

489 
ut32_t
 
obje_
,

490 
BACNET_LIGHTING_IN_PROGRESS
 
_ogss
)

492 
bo
 
us
 = 
l
;

493 
dex
 = 0;

495 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

496 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

497 
Lightg_Ouut
[
dex
].
In_Progss
 = 
_ogss
;

501  
us
;

502 
	}
}

511 
	$Lightg_Ouut_Tckg_Vue
(

512 
ut32_t
 
obje_
)

514 
vue
 = 0.0;

515 
dex
 = 0;

517 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

518 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

519 
vue
 = 
Lightg_Ouut
[
dex
].
Tckg_Vue
;

522  
vue
;

523 
	}
}

534 
bo
 
	$Lightg_Ouut_Tckg_Vue_S
(

535 
ut32_t
 
obje_
,

536 
vue
)

538 
bo
 
us
 = 
l
;

539 
dex
 = 0;

541 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

542 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

543 
Lightg_Ouut
[
dex
].
Tckg_Vue
 = 
vue
;

544 
us
 = 
ue
;

547  
us
;

548 
	}
}

558 
bo
 
	$Lightg_Ouut_Blk_Wn_Eb
(

559 
ut32_t
 
obje_
)

561 
bo
 
vue
 = 
l
;

562 
dex
 = 0;

564 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

565 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

566 
vue
 = 
Lightg_Ouut
[
dex
].
Blk_Wn_Eb
;

569  
vue
;

570 
	}
}

581 
bo
 
	$Lightg_Ouut_Blk_Wn_Eb_S
(

582 
ut32_t
 
obje_
,

583 
bo
 
ab
)

585 
bo
 
us
 = 
l
;

586 
dex
 = 0;

588 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

589 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

590 
Lightg_Ouut
[
dex
].
Blk_Wn_Eb
 = 
ab
;

591 
us
 = 
ue
;

594  
us
;

595 
	}
}

605 
ut32_t
 
	$Lightg_Ouut_Egss_Time
(

606 
ut32_t
 
obje_
)

608 
ut32_t
 
vue
 = 0;

609 
dex
 = 0;

611 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

612 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

613 
vue
 = 
Lightg_Ouut
[
dex
].
Egss_Time
;

616  
vue
;

617 
	}
}

628 
bo
 
	$Lightg_Ouut_Egss_Time_S
(

629 
ut32_t
 
obje_
,

630 
ut32_t
 
cds
)

632 
bo
 
us
 = 
l
;

633 
dex
 = 0;

635 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

636 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

637 
Lightg_Ouut
[
dex
].
Egss_Time
 = 
cds
;

638 
us
 = 
ue
;

641  
us
;

642 
	}
}

652 
bo
 
	$Lightg_Ouut_Egss_Aive
(

653 
ut32_t
 
obje_
)

655 
bo
 
vue
 = 
l
;

656 
dex
 = 0;

658 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

659 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

660 
vue
 = 
Lightg_Ouut
[
dex
].
Egss_Aive
;

663  
vue
;

664 
	}
}

674 
ut32_t
 
	$Lightg_Ouut_Deu_Fade_Time
(

675 
ut32_t
 
obje_
)

677 
ut32_t
 
vue
 = 0;

678 
dex
 = 0;

680 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

681 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

682 
vue
 = 
Lightg_Ouut
[
dex
].
Deu_Fade_Time
;

685  
vue
;

686 
	}
}

697 
bo
 
	$Lightg_Ouut_Deu_Fade_Time_S
(

698 
ut32_t
 
obje_
,

699 
ut32_t
 
mlicds
)

701 
bo
 
us
 = 
l
;

702 
dex
 = 0;

704 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

705 i((
dex
 < 
MAX_LIGHTING_OUTPUTS
) &&

706 (
mlicds
 >= 100) &&

707 (
mlicds
 <= 86400000)) {

708 
Lightg_Ouut
[
dex
].
Deu_Fade_Time
 = 
mlicds
;

709 
us
 = 
ue
;

712  
us
;

713 
	}
}

723 
	$Lightg_Ouut_Deu_Ramp_Re
(

724 
ut32_t
 
obje_
)

726 
vue
 = 0.0;

727 
dex
 = 0;

729 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

730 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

731 
vue
 = 
Lightg_Ouut
[
dex
].
Deu_Ramp_Re
;

734  
vue
;

735 
	}
}

746 
bo
 
	$Lightg_Ouut_Deu_Ramp_Re_S
(

747 
ut32_t
 
obje_
,

748 
r_r_cd
)

750 
bo
 
us
 = 
l
;

751 
dex
 = 0;

753 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

754 i((
dex
 < 
MAX_LIGHTING_OUTPUTS
) &&

755 (
r_r_cd
 >= 0.1) &&

756 (
r_r_cd
 <= 100.0)) {

757 
Lightg_Ouut
[
dex
].
Deu_Ramp_Re
 = 
r_r_cd
;

758 
us
 = 
ue
;

761  
us
;

762 
	}
}

772 
	$Lightg_Ouut_Deu_Sp_Inemt
(

773 
ut32_t
 
obje_
)

775 
vue
 = 0.0;

776 
dex
 = 0;

778 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

779 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

780 
vue
 = 
Lightg_Ouut
[
dex
].
Deu_Sp_Inemt
;

783  
vue
;

784 
	}
}

795 
bo
 
	$Lightg_Ouut_Deu_Sp_Inemt_S
(

796 
ut32_t
 
obje_
,

797 
_emt
)

799 
bo
 
us
 = 
l
;

800 
dex
 = 0;

802 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

803 i((
dex
 < 
MAX_LIGHTING_OUTPUTS
) &&

804 (
_emt
 >= 0.1) &&

805 (
_emt
 <= 100.0)) {

806 
Lightg_Ouut
[
dex
].
Deu_Sp_Inemt
 = 
_emt
;

807 
us
 = 
ue
;

810  
us
;

811 
	}
}

823 
	$Lightg_Ouut_Deu_Priܙy
(

824 
ut32_t
 
obje_
)

826 
vue
 = 0;

827 
dex
 = 0;

829 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

830 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

831 
vue
 = 
Lightg_Ouut
[
dex
].
Lightg_Commd_Deu_Priܙy
;

834  
vue
;

835 
	}
}

846 
bo
 
	$Lightg_Ouut_Deu_Priܙy_S
(

847 
ut32_t
 
obje_
,

848 
iܙy
)

850 
bo
 
us
 = 
l
;

851 
dex
 = 0;

853 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

854 i((
dex
 < 
MAX_LIGHTING_OUTPUTS
) &&

855 (
iܙy
 >
BACNET_MIN_PRIORITY
) &&

856 (
iܙy
 <
BACNET_MAX_PRIORITY
)) {

857 
Lightg_Ouut
[
dex
].
Lightg_Commd_Deu_Priܙy
 = 
iܙy
;

858 
us
 = 
ue
;

861  
us
;

862 
	}
}

872 
bo
 
	$Lightg_Ouut_Out_Of_Svi
(

873 
ut32_t
 
obje_
)

875 
bo
 
vue
 = 
l
;

876 
dex
 = 0;

878 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

879 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

880 
vue
 = 
Lightg_Ouut
[
dex
].
Out_Of_Svi
;

883  
vue
;

884 
	}
}

894 
	$Lightg_Ouut_Out_Of_Svi_S
(

895 
ut32_t
 
obje_
,

896 
bo
 
vue
)

898 
dex
 = 0;

900 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

901 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

902 
Lightg_Ouut
[
dex
].
Out_Of_Svi
 = 
vue
;

904 
	}
}

914 
	$Lightg_Ouut_Rquish_Deu
(

915 
ut32_t
 
obje_
)

917 
vue
 = 0.0;

918 
dex
 = 0;

920 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

921 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

922 
vue
 = 
Lightg_Ouut
[
dex
].
Rquish_Deu
;

925  
vue
;

926 
	}
}

937 
bo
 
	$Lightg_Ouut_Rquish_Deu_S
(

938 
ut32_t
 
obje_
,

939 
vue
)

941 
bo
 
us
 = 
l
;

942 
dex
 = 0;

944 
dex
 = 
	`Lightg_Ouut_In_To_Index
(
obje_
);

945 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

946 
Lightg_Ouut
[
dex
].
Rquish_Deu
 = 
vue
;

949  
us
;

950 
	}
}

962 
	$Lightg_Ouut_Rd_Prݔty
(

963 
BACNET_READ_PROPERTY_DATA
 * 
da
)

965 
n
 = 0;

966 
du_n
 = 0;

967 
BACNET_BIT_STRING
 
b_rg
;

968 
BACNET_CHARACTER_STRING
 
ch_rg
;

969 
BACNET_LIGHTING_COMMAND
 
lightg_commd
;

970 
_vue
 = () 1.414;

971 
ut32_t
 
unsigd_vue
 = 0;

972 
i
 = 0;

973 
bo
 
e
 = 
l
;

974 
ut8_t
 *
du
 = 
NULL
;

976 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

977 (
da
->
iti_da_n
 == 0)) {

980 
du
 = 
da
->
iti_da
;

981 
da
->
obje_ݔty
) {

982 
PROP_OBJECT_IDENTIFIER
:

983 
du_n
 =

984 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_LIGHTING_OUTPUT
,

985 
da
->
obje_
);

987 
PROP_OBJECT_NAME
:

988 
	`Lightg_Ouut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

989 
du_n
 =

990 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

992 
PROP_OBJECT_TYPE
:

993 
du_n
 =

994 
	`code_iti_umed
(&
du
[0], 
OBJECT_LIGHTING_OUTPUT
);

996 
PROP_PRESENT_VALUE
:

997 
_vue
 = 
	`Lightg_Ouut_P_Vue
(
da
->
obje_
);

998 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

1000 
PROP_TRACKING_VALUE
:

1001 
_vue
 =

1002 
	`Lightg_Ouut_Tckg_Vue
(
da
->
obje_
);

1003 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

1005 
PROP_LIGHTING_COMMAND
:

1006 
	`Lightg_Ouut_Lightg_Commd
(

1007 
da
->
obje_
,

1008 &
lightg_commd
);

1009 
du_n
 = 
	`lightg_commd_code
(&
du
[0],

1010 &
lightg_commd
);

1012 
PROP_IN_PROGRESS
:

1013 
unsigd_vue
 = 
	`Lightg_Ouut_In_Progss
(

1014 
da
->
obje_
);

1015 
du_n
 = 
	`code_iti_umed
(&
du
[0],

1016 
unsigd_vue
);

1018 
PROP_STATUS_FLAGS
:

1019 
	`brg_
(&
b_rg
);

1020 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

1021 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

1022 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

1023 
e
 = 
	`Lightg_Ouut_Out_Of_Svi
(
da
->
obje_
);

1024 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
e
);

1025 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

1027 
PROP_OUT_OF_SERVICE
:

1028 
e
 = 
	`Lightg_Ouut_Out_Of_Svi
(
da
->
obje_
);

1029 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

1031 
PROP_BLINK_WARN_ENABLE
:

1032 
e
 = 
	`Lightg_Ouut_Blk_Wn_Eb
(
da
->
obje_
);

1033 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

1035 
PROP_EGRESS_TIME
:

1036 
unsigd_vue
 = 
	`Lightg_Ouut_Egss_Time
(

1037 
da
->
obje_
);

1038 
du_n
 = 
	`code_iti_unsigd
(&
du
[0],

1039 
unsigd_vue
);

1041 
PROP_EGRESS_ACTIVE
:

1042 
e
 = 
	`Lightg_Ouut_Egss_Aive
(
da
->
obje_
);

1043 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

1045 
PROP_DEFAULT_FADE_TIME
:

1046 
unsigd_vue
 = 
	`Lightg_Ouut_Deu_Fade_Time
(

1047 
da
->
obje_
);

1048 
du_n
 = 
	`code_iti_unsigd
(&
du
[0],

1049 
unsigd_vue
);

1051 
PROP_DEFAULT_RAMP_RATE
:

1052 
_vue
 =

1053 
	`Lightg_Ouut_Deu_Ramp_Re
(
da
->
obje_
);

1054 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

1056 
PROP_DEFAULT_STEP_INCREMENT
:

1057 
_vue
 =

1058 
	`Lightg_Ouut_Deu_Sp_Inemt
(
da
->
obje_
);

1059 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

1061 
PROP_PRIORITY_ARRAY
:

1063 i(
da
->
y_dex
 == 0) {

1064 
du_n
 =

1065 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

1068 } i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

1069 
i
 = 1; i <
BACNET_MAX_PRIORITY
; i++) {

1070 i(
	`Lightg_Ouut_Priܙy_Aive
(

1071 
da
->
obje_
, 
i
)) {

1072 
_vue
 = 
	`Lightg_Ouut_Priܙy_Vue
(

1073 
da
->
obje_
, 
i
);

1074 
n
 =

1075 
	`code_iti_
(&
du
[
du_n
],

1076 
_vue
);

1078 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1081 i((
du_n
 + 
n
< 
MAX_APDU
)

1082 
du_n
 +
n
;

1084 
da
->
r_code
 =

1085 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

1086 
du_n
 = 
BACNET_STATUS_ABORT
;

1091 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

1092 i(
	`Lightg_Ouut_Priܙy_Aive
(

1093 
da
->
obje_
,

1094 
da
->
y_dex
)) {

1095 
_vue
 = 
	`Lightg_Ouut_Priܙy_Vue
(

1096 
da
->
obje_
,

1097 
da
->
y_dex
);

1098 
n
 =

1099 
	`code_iti_
(&
du
[
du_n
],

1100 
_vue
);

1102 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1105 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1106 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

1107 
du_n
 = 
BACNET_STATUS_ERROR
;

1111 
PROP_RELINQUISH_DEFAULT
:

1112 
_vue
 = 
	`Lightg_Ouut_Rquish_Deu
(

1113 
da
->
obje_
);

1114 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

1116 
PROP_LIGHTING_COMMAND_DEFAULT_PRIORITY
:

1117 
unsigd_vue
 = 
	`Lightg_Ouut_Deu_Priܙy
(

1118 
da
->
obje_
);

1119 
du_n
 = 
	`code_iti_unsigd
(&
du
[0],

1120 
unsigd_vue
);

1123 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1124 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1125 
du_n
 = 
BACNET_STATUS_ERROR
;

1129 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

1130 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

1131 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1132 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

1133 
du_n
 = 
BACNET_STATUS_ERROR
;

1136  
du_n
;

1137 
	}
}

1148 
bo
 
	$Lightg_Ouut_Wre_Prݔty
(

1149 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

1151 
bo
 
us
 = 
l
;

1152 
n
 = 0;

1153 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1156 
n
 =

1157 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

1158 
wp_da
->
iti_da_n
, &
vue
);

1160 i(
n
 < 0) {

1162 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1163 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1164  
l
;

1166 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

1167 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

1169 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1170 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

1171  
l
;

1173 
wp_da
->
obje_ݔty
) {

1174 
PROP_PRESENT_VALUE
:

1175 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_REAL
) {

1179 
us
 =

1180 
	`Lightg_Ouut_P_Vue_S
(
wp_da
->
obje_
,

1181 
vue
.
ty
.
Rl
, 
wp_da
->
iܙy
);

1182 i(
wp_da
->
iܙy
 == 6) {

1186 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1187 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

1188 } i(!
us
) {

1189 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1190 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1193 
us
 =

1194 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_NULL
,

1195 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1196 i(
us
) {

1197 i(
wp_da
->
iܙy
 == 6) {

1202 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1203 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

1205 
us
 = 
	`Lightg_Ouut_P_Vue_Rquish
(

1206 
wp_da
->
obje_
, wp_da->
iܙy
);

1207 i(!
us
) {

1208 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1209 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1215 
PROP_LIGHTING_COMMAND
:

1216 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_LIGHTING_COMMAND
) {

1217 
us
 = 
	`Lightg_Ouut_Lightg_Commd_S
(

1218 
wp_da
->
obje_
,

1219 &
vue
.
ty
.
Lightg_Commd
);

1220 i(!
us
) {

1221 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1222 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1225 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1226 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

1229 
PROP_OUT_OF_SERVICE
:

1230 
us
 =

1231 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

1232 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1233 i(
us
) {

1234 
	`Lightg_Ouut_Out_Of_Svi_S
(

1235 
wp_da
->
obje_
,

1236 
vue
.
ty
.
Boޗn
);

1239 
PROP_OBJECT_IDENTIFIER
:

1240 
PROP_OBJECT_NAME
:

1241 
PROP_OBJECT_TYPE
:

1242 
PROP_TRACKING_VALUE
:

1243 
PROP_IN_PROGRESS
:

1244 
PROP_STATUS_FLAGS
:

1245 
PROP_BLINK_WARN_ENABLE
:

1246 
PROP_EGRESS_TIME
:

1247 
PROP_EGRESS_ACTIVE
:

1248 
PROP_DEFAULT_FADE_TIME
:

1249 
PROP_DEFAULT_RAMP_RATE
:

1250 
PROP_DEFAULT_STEP_INCREMENT
:

1251 
PROP_PRIORITY_ARRAY
:

1252 
PROP_RELINQUISH_DEFAULT
:

1253 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1254 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

1257 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1258 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1262  
us
;

1263 
	}
}

1273 
	$Lightg_Ouut_Ramp_Hdr
(

1274 
lightg_ouut_obje
 *
pLight
,

1275 
BACNET_LIGHTING_COMMAND
 *
pCommd
,

1276 
ut16_t
 
mlicds
)

1278 i(
pLight
 && 
pCommd
) {

1281 
	}
}

1291 
	$Lightg_Ouut_Fade_Hdr
(

1292 
lightg_ouut_obje
 *
pLight
,

1293 
BACNET_LIGHTING_COMMAND
 *
pCommd
,

1294 
ut16_t
 
mlicds
)

1296 i(
pLight
 && 
pCommd
) {

1299 
	}
}

1308 
	$Lightg_Ouut_Tim_Hdr
(

1309 
dex
,

1310 
ut16_t
 
mlicds
)

1312 
lightg_ouut_obje
 *
pLight
 = 
NULL
;

1313 
BACNET_LIGHTING_COMMAND
 *
pCommd
 = 
NULL
;

1315 i(
dex
 < 
MAX_LIGHTING_OUTPUTS
) {

1316 
pLight
 = &
Lightg_Ouut
[
dex
];

1317 
pCommd
 = &
pLight
->
Lightg_Commd
;

1318 
pCommd
->
ݔi
) {

1319 
BACNET_LIGHTS_NONE
:

1321 
BACNET_LIGHTS_FADE_TO
:

1322 
	`Lightg_Ouut_Fade_Hdr
(
pLight
, 
pCommd
, 
mlicds
);

1324 
BACNET_LIGHTS_RAMP_TO
:

1325 
	`Lightg_Ouut_Ramp_Hdr
(
pLight
, 
pCommd
, 
mlicds
);

1327 
BACNET_LIGHTS_STEP_UP
:

1329 
BACNET_LIGHTS_STEP_DOWN
:

1331 
BACNET_LIGHTS_STEP_ON
:

1333 
BACNET_LIGHTS_STEP_OFF
:

1335 
BACNET_LIGHTS_WARN
:

1337 
BACNET_LIGHTS_WARN_OFF
:

1339 
BACNET_LIGHTS_WARN_RELINQUISH
:

1341 
BACNET_LIGHTS_STOP
:

1347 
	}
}

1355 
	$Lightg_Ouut_Tim
(

1356 
ut16_t
 
mlicds
)

1358 
i
 = 0;

1360 
i
 = 0; i < 
MAX_LIGHTING_OUTPUTS
; i++) {

1361 
	`Lightg_Ouut_Tim_Hdr
(
i
, 
mlicds
);

1363 
	}
}

1368 
	$Lightg_Ouut_In
(

1371 
i
, 
p
;

1373 
i
 = 0; i < 
MAX_LIGHTING_OUTPUTS
; i++) {

1374 
Lightg_Ouut
[
i
].
P_Vue
 = 0.0;

1375 
Lightg_Ouut
[
i
].
Tckg_Vue
 = 0.0;

1376 
Lightg_Ouut
[
i
].
Physil_Vue
 = 0.0;

1377 
Lightg_Ouut
[
i
].
Lightg_Commd
.
ݔi
 = 
BACNET_LIGHTS_NONE
;

1378 
Lightg_Ouut
[
i
].
Lightg_Commd
.
u_rg_v
 = 
l
;

1379 
Lightg_Ouut
[
i
].
Lightg_Commd
.
u_mp_
 = 
l
;

1380 
Lightg_Ouut
[
i
].
Lightg_Commd
.
u__emt
 = 
l
;

1381 
Lightg_Ouut
[
i
].
Lightg_Commd
.
u_de_time
 = 
l
;

1382 
Lightg_Ouut
[
i
].
Lightg_Commd
.
u_iܙy
 = 
l
;

1383 
Lightg_Ouut
[
i
].
In_Progss
 = 
BACNET_LIGHTING_IDLE
;

1384 
Lightg_Ouut
[
i
].
Out_Of_Svi
 = 
l
;

1385 
Lightg_Ouut
[
i
].
Blk_Wn_Eb
 = 
l
;

1386 
Lightg_Ouut
[
i
].
Egss_Aive
 = 
l
;

1387 
Lightg_Ouut
[
i
].
Egss_Time
 = 0;

1388 
Lightg_Ouut
[
i
].
Deu_Fade_Time
 = 100;

1389 
Lightg_Ouut
[
i
].
Deu_Ramp_Re
 = 100.0;

1390 
Lightg_Ouut
[
i
].
Deu_Sp_Inemt
 = 1.0;

1391 
Lightg_Ouut
[
i
].
Tnsi
 = 
BACNET_LIGHTING_TRANSITION_IDLE
;

1392 
Lightg_Ouut
[
i
].
Fdback_Vue
 = 0.0;

1393 
p
 = 0; < 
BACNET_MAX_PRIORITY
;++) {

1394 
Lightg_Ouut
[
i
].
Priܙy_Aay
[
p
] = 0.0;

1395 
	`BIT_CLEAR
(
Lightg_Ouut
[
i
].
Priܙy_Aive_Bs
, 
p
);

1397 
Lightg_Ouut
[
i
].
Rquish_Deu
 = 0.0;

1398 
Lightg_Ouut
[
i
].
Pow
 = 0.0;

1399 
Lightg_Ouut
[
i
].
Inous_Pow
 = 0.0;

1400 
Lightg_Ouut
[
i
].
M_Au_Vue
 = 0.0;

1401 
Lightg_Ouut
[
i
].
Max_Au_Vue
 = 100.0;

1402 
Lightg_Ouut
[
i
].
Lightg_Commd_Deu_Priܙy
 = 16;

1406 
	}
}

1408 #ifde
TEST


1409 
	~<as.h
>

1410 
	~<rg.h
>

1411 
	~"e.h
"

1413 
bo
 
	$WPVideArgTy
(

1414 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

1415 
ut8_t
 
ucExedTag
,

1416 
BACNET_ERROR_CLASS
 * 
pECss
,

1417 
BACNET_ERROR_CODE
 * 
pECode
)

1419 
pVue
 =Value;

1420 
ucExedTag
 = ucExpectedTag;

1421 
pECss
 =ErrorClass;

1422 
pECode
 =ErrorCode;

1424  
l
;

1425 
	}
}

1427 
	$LightgOuut
(

1428 
Te
 * 
pTe
)

1430 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

1431 
n
 = 0;

1432 
ut32_t
 
n_vue
 = 0;

1433 
ut8_t
 
g_numb
 = 0;

1434 
ut16_t
 
decoded_ty
 = 0;

1435 
ut32_t
 
decoded_
 = 0;

1436 
BACNET_READ_PROPERTY_DATA
 
da
;

1438 
	`Lightg_Ouut_In
();

1439 
da
.
iti_da
 = &
du
[0];

1440 
da
.
iti_da_n
 = (
du
);

1441 
da
.
obje_ty
 = 
OBJECT_LIGHTING_OUTPUT
;

1442 
da
.
obje_
 = 1;

1443 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

1444 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1445 
n
 = 
	`Lightg_Ouut_Rd_Prݔty
(&
da
);

1446 
	`_
(
pTe
, 
n
 != 0);

1447 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

1448 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

1449 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

1450 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

1451 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

1454 
	}
}

1456 #ifde
TEST_LIGHTING_OUTPUT


1457 
	$ma
(

1460 
Te
 *
pTe
;

1461 
bo
 
rc
;

1463 
pTe
 = 
	`_
("BACÈLightg Ouut", 
NULL
);

1465 
rc
 = 
	`_addTeFuni
(
pTe
, 
LightgOuut
);

1466 
	`as
(
rc
);

1468 
	`_tSm
(
pTe
, 
dout
);

1469 
	`_run
(
pTe
);

1470 (
	`_pt
(
pTe
);

1471 
	`_deroy
(
pTe
);

1474 
	}
}

	@demo/object/lo.h

25 #ide
LIGHTING_OUTPUT_H


26 
	#LIGHTING_OUTPUT_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
Lightg_Ouut_Prݔty_Lis
(

40 cڡ **
pRequed
,

41 cڡ **
pOiڮ
,

42 cڡ **
pPrrry
);

43 
bo
 
Lightg_Ouut_Vid_In
(

44 
ut32_t
 
obje_
);

45 
Lightg_Ouut_Cou
(

47 
ut32_t
 
Lightg_Ouut_Index_To_In
(

48 
dex
);

49 
Lightg_Ouut_In_To_Index
(

50 
ut32_t
 

);

51 
bo
 
Lightg_Ouut_Obje_In_Add
(

52 
ut32_t
 

);

54 
Lightg_Ouut_P_Vue
(

55 
ut32_t
 
obje_
);

56 
Lightg_Ouut_P_Vue_Priܙy
(

57 
ut32_t
 
obje_
);

58 
bo
 
Lightg_Ouut_P_Vue_S
(

59 
ut32_t
 
obje_
,

60 
vue
,

61 
iܙy
);

62 
bo
 
Lightg_Ouut_P_Vue_Rquish
(

63 
ut32_t
 
obje_
,

64 
iܙy
);

66 
Lightg_Ouut_Rquish_Deu
(

67 
ut32_t
 
obje_
);

68 
bo
 
Lightg_Ouut_Rquish_Deu_S
(

69 
ut32_t
 
obje_
,

70 
vue
);

72 
bo
 
Lightg_Ouut_Chge_Of_Vue
(

73 
ut32_t
 

);

74 
Lightg_Ouut_Chge_Of_Vue_Cˬ
(

75 
ut32_t
 

);

76 
bo
 
Lightg_Ouut_Encode_Vue_Li
(

77 
ut32_t
 
obje_
,

78 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

79 
Lightg_Ouut_COV_Inemt
(

80 
ut32_t
 

);

81 
Lightg_Ouut_COV_Inemt_S
(

82 
ut32_t
 

,

83 
vue
);

85 
bo
 
Lightg_Ouut_Obje_Name
(

86 
ut32_t
 
obje_
,

87 
BACNET_CHARACTER_STRING
 * 
obje_me
);

88 
bo
 
Lightg_Ouut_Name_S
(

89 
ut32_t
 
obje_
,

90 *
w_me
);

92 *
Lightg_Ouut_Desti
(

93 
ut32_t
 

);

94 
bo
 
Lightg_Ouut_Desti_S
(

95 
ut32_t
 

,

96 *
w_me
);

98 
bo
 
Lightg_Ouut_Out_Of_Svi
(

99 
ut32_t
 

);

100 
Lightg_Ouut_Out_Of_Svi_S
(

101 
ut32_t
 

,

102 
bo
 
oos_ag
);

104 
bo
 
Lightg_Ouut_Lightg_Commd_S
(

105 
ut32_t
 
obje_
,

106 
BACNET_LIGHTING_COMMAND
 *
vue
);

107 
bo
 
Lightg_Ouut_Lightg_Commd
(

108 
ut32_t
 
obje_
,

109 
BACNET_LIGHTING_COMMAND
 *
vue
);

111 
BACNET_LIGHTING_IN_PROGRESS
 
Lightg_Ouut_In_Progss
(

112 
ut32_t
 
obje_
);

113 
bo
 
Lightg_Ouut_In_Progss_S
(

114 
ut32_t
 
obje_
,

115 
BACNET_LIGHTING_IN_PROGRESS
 
_ogss
);

117 
Lightg_Ouut_Tckg_Vue
(

118 
ut32_t
 
obje_
);

119 
bo
 
Lightg_Ouut_Tckg_Vue_S
(

120 
ut32_t
 
obje_
,

121 
vue
);

123 
bo
 
Lightg_Ouut_Blk_Wn_Eb
(

124 
ut32_t
 
obje_
);

125 
bo
 
Lightg_Ouut_Blk_Wn_Eb_S
(

126 
ut32_t
 
obje_
,

127 
bo
 
ab
);

129 
ut32_t
 
Lightg_Ouut_Egss_Time
(

130 
ut32_t
 
obje_
);

131 
bo
 
Lightg_Ouut_Egss_Time_S
(

132 
ut32_t
 
obje_
,

133 
ut32_t
 
cds
);

134 
bo
 
Lightg_Ouut_Egss_Aive
(

135 
ut32_t
 
obje_
);

137 
ut32_t
 
Lightg_Ouut_Deu_Fade_Time
(

138 
ut32_t
 
obje_
);

139 
bo
 
Lightg_Ouut_Deu_Fade_Time_S
(

140 
ut32_t
 
obje_
,

141 
ut32_t
 
mlicds
);

143 
Lightg_Ouut_Deu_Ramp_Re
(

144 
ut32_t
 
obje_
);

145 
bo
 
Lightg_Ouut_Deu_Ramp_Re_S
(

146 
ut32_t
 
obje_
,

147 
r_r_cd
);

149 
Lightg_Ouut_Deu_Sp_Inemt
(

150 
ut32_t
 
obje_
);

151 
bo
 
Lightg_Ouut_Deu_Sp_Inemt_S
(

152 
ut32_t
 
obje_
,

153 
_emt
);

155 
Lightg_Ouut_Deu_Priܙy
(

156 
ut32_t
 
obje_
);

157 
bo
 
Lightg_Ouut_Deu_Priܙy_S
(

158 
ut32_t
 
obje_
,

159 
iܙy
);

161 
Lightg_Ouut_Tim
(

162 
ut16_t
 
mlicds
);

164 
Lightg_Ouut_In
(

167 
Lightg_Ouut_Rd_Prݔty
(

168 
BACNET_READ_PROPERTY_DATA
 * 
da
);

169 
bo
 
Lightg_Ouut_Wre_Prݔty
(

170 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

172 #ifde
TEST


173 
	~"e.h
"

174 
LightgOuut
(

175 
Te
 * 
pTe
);

178 #ifde
__lulus


	@demo/object/lsp.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~".h
"

37 
	~"wp.h
"

38 
	~"l.h
"

39 
	~"hdrs.h
"

41 #ide
MAX_LIFE_SAFETY_POINTS


42 
	#MAX_LIFE_SAFETY_POINTS
 7

	)

46 
BACNET_LIFE_SAFETY_MODE
 
	gLi_Saty_Pot_Mode
[
MAX_LIFE_SAFETY_POINTS
];

47 
BACNET_LIFE_SAFETY_STATE


48 
	gLi_Saty_Pot_S
[
MAX_LIFE_SAFETY_POINTS
];

49 
BACNET_SILENCED_STATE


50 
	gLi_Saty_Pot_Sd_S
[
MAX_LIFE_SAFETY_POINTS
];

51 
BACNET_LIFE_SAFETY_OPERATION


52 
	gLi_Saty_Pot_Oti
[
MAX_LIFE_SAFETY_POINTS
];

55 
bo
 
	gLi_Saty_Pot_Out_Of_Svi
[
MAX_LIFE_SAFETY_POINTS
];

58 cڡ 
	gLi_Saty_Pot_Prݔts_Requed
[] = {

59 
PROP_OBJECT_IDENTIFIER
,

60 
PROP_OBJECT_NAME
,

61 
PROP_OBJECT_TYPE
,

62 
PROP_PRESENT_VALUE
,

63 
PROP_TRACKING_VALUE
,

64 
PROP_STATUS_FLAGS
,

65 
PROP_EVENT_STATE
,

66 
PROP_OUT_OF_SERVICE
,

67 
PROP_RELIABILITY
,

68 
PROP_MODE
,

69 
PROP_ACCEPTED_MODES
,

70 
PROP_SILENCED
,

71 
PROP_OPERATION_EXPECTED
,

75 cڡ 
	gLi_Saty_Pot_Prݔts_Oiڮ
[] = {

76 
PROP_DESCRIPTION
,

80 cڡ 
	gLi_Saty_Pot_Prݔts_Prrry
[] = {

95 
	$Li_Saty_Pot_Prݔty_Lis
(

96 cڡ **
pRequed
,

97 cڡ **
pOiڮ
,

98 cڡ **
pPrrry
)

100 i(
pRequed
) {

101 *
pRequed
 = 
Li_Saty_Pot_Prݔts_Requed
;

103 i(
pOiڮ
) {

104 *
pOiڮ
 = 
Li_Saty_Pot_Prݔts_Oiڮ
;

106 i(
pPrrry
) {

107 *
pPrrry
 = 
Li_Saty_Pot_Prݔts_Prrry
;

111 
	}
}

113 
	$Li_Saty_Pot_In
(

116 
bo
 
lized
 = 
l
;

117 
i
;

119 i(!
lized
) {

120 
lized
 = 
ue
;

123 
i
 = 0; i < 
MAX_LIFE_SAFETY_POINTS
; i++) {

124 
Li_Saty_Pot_Mode
[
i
] = 
LIFE_SAFETY_MODE_DEFAULT
;

125 
Li_Saty_Pot_S
[
i
] = 
LIFE_SAFETY_STATE_QUIET
;

126 
Li_Saty_Pot_Sd_S
[
i
] = 
SILENCED_STATE_UNSILENCED
;

127 
Li_Saty_Pot_Oti
[
i
] = 
LIFE_SAFETY_OP_NONE
;

132 
	}
}

137 
bo
 
	$Li_Saty_Pot_Vid_In
(

138 
ut32_t
 
obje_
)

140 i(
obje_
 < 
MAX_LIFE_SAFETY_POINTS
)

141  
ue
;

143  
l
;

144 
	}
}

148 
	$Li_Saty_Pot_Cou
(

151  
MAX_LIFE_SAFETY_POINTS
;

152 
	}
}

157 
ut32_t
 
	$Li_Saty_Pot_Index_To_In
(

158 
dex
)

160  
dex
;

161 
	}
}

166 
	$Li_Saty_Pot_In_To_Index
(

167 
ut32_t
 
obje_
)

169 
dex
 = 
MAX_LIFE_SAFETY_POINTS
;

171 i(
obje_
 < 
MAX_LIFE_SAFETY_POINTS
)

172 
dex
 = 
obje_
;

174  
dex
;

175 
	}
}

177 
BACNET_LIFE_SAFETY_STATE
 
	$Li_Saty_Pot_P_Vue
(

178 
ut32_t
 
obje_
)

180 
BACNET_LIFE_SAFETY_STATE
 
e_vue
 = 
LIFE_SAFETY_STATE_QUIET
;

181 
dex
 = 0;

183 
dex
 = 
	`Li_Saty_Pot_In_To_Index
(
obje_
);

184 i(
dex
 < 
MAX_LIFE_SAFETY_POINTS
)

185 
e_vue
 = 
Li_Saty_Pot_S
[
dex
];

187  
e_vue
;

188 
	}
}

191 
bo
 
	$Li_Saty_Pot_Obje_Name
(

192 
ut32_t
 
obje_
,

193 
BACNET_CHARACTER_STRING
 * 
obje_me
)

195 
xt_rg
[32] = "";

196 
bo
 
us
 = 
l
;

198 i(
obje_
 < 
MAX_LIFE_SAFETY_POINTS
) {

199 
	`rtf
(
xt_rg
, "LS POINT %u", 
obje_
);

200 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

203  
us
;

204 
	}
}

207 
	$Li_Saty_Pot_Rd_Prݔty
(

208 
BACNET_READ_PROPERTY_DATA
 * 
da
)

210 
n
 = 0;

211 
du_n
 = 0;

212 
BACNET_BIT_STRING
 
b_rg
;

213 
BACNET_CHARACTER_STRING
 
ch_rg
;

214 
BACNET_LIFE_SAFETY_STATE
 
e_vue
 = 
LIFE_SAFETY_STATE_QUIET
;

215 
BACNET_LIFE_SAFETY_MODE
 
mode
 = 
LIFE_SAFETY_MODE_DEFAULT
;

216 
BACNET_SILENCED_STATE
 
sd_e
 = 
SILENCED_STATE_UNSILENCED
;

217 
BACNET_LIFE_SAFETY_OPERATION
 
ݔi
 = 
LIFE_SAFETY_OP_NONE
;

218 
obje_dex
 = 0;

219 
bo
 
e
 = 
l
;

220 
BACNET_RELIABILITY
 
lby
 = 
RELIABILITY_NO_FAULT_DETECTED
;

221 
ut8_t
 *
du
 = 
NULL
;

223 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

224 (
da
->
iti_da_n
 == 0)) {

227 
du
 = 
da
->
iti_da
;

228 
da
->
obje_ݔty
) {

229 
PROP_OBJECT_IDENTIFIER
:

230 
du_n
 =

231 
	`code_iti_obje_id
(&
du
[0],

232 
OBJECT_LIFE_SAFETY_POINT
, 
da
->
obje_
);

234 
PROP_OBJECT_NAME
:

235 
PROP_DESCRIPTION
:

236 
	`Li_Saty_Pot_Obje_Name
(
da
->
obje_
,

237 &
ch_rg
);

238 
du_n
 =

239 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

241 
PROP_OBJECT_TYPE
:

242 
du_n
 =

243 
	`code_iti_umed
(&
du
[0],

244 
OBJECT_LIFE_SAFETY_POINT
);

246 
PROP_PRESENT_VALUE
:

247 
e_vue
 =

248 
	`Li_Saty_Pot_P_Vue
(
da
->
obje_
);

249 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

251 
PROP_TRACKING_VALUE
:

253 
e_vue
 =

254 
	`Li_Saty_Pot_P_Vue
(
da
->
obje_
);

255 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

257 
PROP_STATUS_FLAGS
:

258 
	`brg_
(&
b_rg
);

259 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

260 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

261 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

262 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

263 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

265 
PROP_EVENT_STATE
:

266 
du_n
 =

267 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

269 
PROP_OUT_OF_SERVICE
:

270 
obje_dex
 =

271 
	`Li_Saty_Pot_In_To_Index
(
da
->
obje_
);

272 
e
 = 
Li_Saty_Pot_Out_Of_Svi
[
obje_dex
];

273 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

275 
PROP_RELIABILITY
:

277 
lby
 = 
RELIABILITY_NO_FAULT_DETECTED
;

278 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
lby
);

280 
PROP_MODE
:

281 
obje_dex
 =

282 
	`Li_Saty_Pot_In_To_Index
(
da
->
obje_
);

283 
mode
 = 
Li_Saty_Pot_Mode
[
obje_dex
];

284 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
mode
);

286 
PROP_ACCEPTED_MODES
:

287 
mode
 = 
MIN_LIFE_SAFETY_MODE
; mod< 
MAX_LIFE_SAFETY_MODE
;

288 
mode
++) {

289 
n
 = 
	`code_iti_umed
(&
du
[
du_n
], 
mode
);

290 
du_n
 +
n
;

293 
PROP_SILENCED
:

294 
obje_dex
 =

295 
	`Li_Saty_Pot_In_To_Index
(
da
->
obje_
);

296 
sd_e
 = 
Li_Saty_Pot_Sd_S
[
obje_dex
];

297 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
sd_e
);

299 
PROP_OPERATION_EXPECTED
:

300 
obje_dex
 =

301 
	`Li_Saty_Pot_In_To_Index
(
da
->
obje_
);

302 
ݔi
 = 
Li_Saty_Pot_Oti
[
obje_dex
];

303 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
ݔi
);

306 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

307 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

308 
du_n
 = 
BACNET_STATUS_ERROR
;

312 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

313 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

314 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

315 
du_n
 = 
BACNET_STATUS_ERROR
;

318  
du_n
;

319 
	}
}

322 
bo
 
	$Li_Saty_Pot_Wre_Prݔty
(

323 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

325 
bo
 
us
 = 
l
;

326 
obje_dex
 = 0;

327 
n
 = 0;

328 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

331 
n
 =

332 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

333 
wp_da
->
iti_da_n
, &
vue
);

335 i(
n
 < 0) {

337 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

338 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

339  
l
;

342 i(
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

343 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

344 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

345  
l
;

347 
wp_da
->
obje_ݔty
) {

348 
PROP_MODE
:

349 
us
 =

350 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

351 &
wp_da
->
r_ass
, &wp_da->
r_code
);

352 i(
us
) {

353 i(
vue
.
ty
.
Enumed
 <
MAX_LIFE_SAFETY_MODE
) {

354 
obje_dex
 =

355 
Li_Saty_Pot_In_To_Index


356 (
wp_da
->
obje_
);

357 
Li_Saty_Pot_Mode
[
obje_dex
] =

358 
vue
.
ty
.
Enumed
;

360 
us
 = 
l
;

361 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

362 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

366 
PROP_OUT_OF_SERVICE
:

367 
us
 =

368 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

369 &
wp_da
->
r_ass
, &wp_da->
r_code
);

370 i(
us
) {

371 
obje_dex
 =

372 
Li_Saty_Pot_In_To_Index


373 (
wp_da
->
obje_
);

374 
Li_Saty_Pot_Out_Of_Svi
[
obje_dex
] =

375 
vue
.
ty
.
Boޗn
;

381 
PROP_OBJECT_IDENTIFIER
:

382 
PROP_OBJECT_NAME
:

383 
PROP_DESCRIPTION
:

384 
PROP_OBJECT_TYPE
:

385 
PROP_PRESENT_VALUE
:

386 
PROP_TRACKING_VALUE
:

387 
PROP_STATUS_FLAGS
:

388 
PROP_EVENT_STATE
:

389 
PROP_RELIABILITY
:

390 
PROP_ACCEPTED_MODES
:

391 
PROP_SILENCED
:

392 
PROP_OPERATION_EXPECTED
:

393 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

394 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

397 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

398 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

402  
us
;

403 
	}
}

406 #ifde
TEST


407 
	~<as.h
>

408 
	~<rg.h
>

409 
	~"e.h
"

411 
bo
 
	$WPVideArgTy
(

412 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

413 
ut8_t
 
ucExedTag
,

414 
BACNET_ERROR_CLASS
 * 
pECss
,

415 
BACNET_ERROR_CODE
 * 
pECode
)

417 
pVue
 =Value;

418 
ucExedTag
 = ucExpectedTag;

419 
pECss
 =ErrorClass;

420 
pECode
 =ErrorCode;

422  
l
;

423 
	}
}

425 
	$LiSatyPot
(

426 
Te
 * 
pTe
)

428 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

429 
n
 = 0;

430 
ut32_t
 
n_vue
 = 0;

431 
ut8_t
 
g_numb
 = 0;

432 
ut16_t
 
decoded_ty
 = 0;

433 
ut32_t
 
decoded_
 = 0;

434 
BACNET_READ_PROPERTY_DATA
 
da
;

436 
	`Li_Saty_Pot_In
();

437 
da
.
iti_da
 = &
du
[0];

438 
da
.
iti_da_n
 = (
du
);

439 
da
.
obje_ty
 = 
OBJECT_LIFE_SAFETY_POINT
;

440 
da
.
obje_
 = 1;

441 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

442 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

443 
n
 = 
	`Li_Saty_Pot_Rd_Prݔty
(&
da
);

444 
	`_
(
pTe
, 
n
 != 0);

445 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

446 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

447 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

448 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

449 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

452 
	}
}

454 #ifde
TEST_LIFE_SAFETY_POINT


455 
	$ma
(

458 
Te
 *
pTe
;

459 
bo
 
rc
;

461 
pTe
 = 
	`_
("BACÈLi Saty Pot", 
NULL
);

463 
rc
 = 
	`_addTeFuni
(
pTe
, 
LiSatyPot
);

464 
	`as
(
rc
);

466 
	`_tSm
(
pTe
, 
dout
);

467 
	`_run
(
pTe
);

468 (
	`_pt
(
pTe
);

469 
	`_deroy
(
pTe
);

472 
	}
}

	@demo/object/lsp.h

25 #ide
LSP_H


26 
	#LSP_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
Li_Saty_Pot_Prݔty_Lis
(

40 cڡ **
pRequed
,

41 cڡ **
pOiڮ
,

42 cڡ **
pPrrry
);

43 
bo
 
Li_Saty_Pot_Vid_In
(

44 
ut32_t
 
obje_
);

45 
Li_Saty_Pot_Cou
(

47 
ut32_t
 
Li_Saty_Pot_Index_To_In
(

48 
dex
);

49 
Li_Saty_Pot_In_To_Index
(

50 
ut32_t
 
obje_
);

51 
bo
 
Li_Saty_Pot_Obje_Name
(

52 
ut32_t
 
obje_
,

53 
BACNET_CHARACTER_STRING
 * 
obje_me
);

54 
Li_Saty_Pot_In
(

57 
Li_Saty_Pot_Rd_Prݔty
(

58 
BACNET_READ_PROPERTY_DATA
 * 
da
);

60 
bo
 
Li_Saty_Pot_Wre_Prݔty
(

61 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

63 #ifde
TEST


64 
	~"e.h
"

65 
LiSatyPot
(

66 
Te
 * 
pTe
);

69 #ifde
__lulus


	@demo/object/ms-input.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~".h
"

37 
	~"wp.h
"

38 
	~"devi.h
"

39 
	~"ms-put.h
"

40 
	~"hdrs.h
"

43 #ide
MAX_MULTISTATE_INPUTS


44 
	#MAX_MULTISTATE_INPUTS
 4

	)

48 #ide
MULTISTATE_NUMBER_OF_STATES


49 
	#MULTISTATE_NUMBER_OF_STATES
 (254)

	)

53 
ut8_t
 
	gP_Vue
[
MAX_MULTISTATE_INPUTS
];

55 
bo
 
	gOut_Of_Svi
[
MAX_MULTISTATE_INPUTS
];

56 
	gObje_Name
[
MAX_MULTISTATE_INPUTS
][64];

57 
	gObje_Desti
[
MAX_MULTISTATE_INPUTS
][64];

58 
	gS_Text
[
MAX_MULTISTATE_INPUTS
][
MULTISTATE_NUMBER_OF_STATES
][64];

61 cڡ 
	gPrݔts_Requed
[] = {

62 
PROP_OBJECT_IDENTIFIER
,

63 
PROP_OBJECT_NAME
,

64 
PROP_OBJECT_TYPE
,

65 
PROP_PRESENT_VALUE
,

66 
PROP_STATUS_FLAGS
,

67 
PROP_EVENT_STATE
,

68 
PROP_OUT_OF_SERVICE
,

69 
PROP_NUMBER_OF_STATES
,

73 cڡ 
	gPrݔts_Oiڮ
[] = {

74 
PROP_DESCRIPTION
,

75 
PROP_STATE_TEXT
,

79 cڡ 
	gPrݔts_Prrry
[] = {

83 
	$Muie_Iut_Prݔty_Lis
(

84 cڡ **
pRequed
,

85 cڡ **
pOiڮ
,

86 cڡ **
pPrrry
)

88 i(
pRequed
)

89 *
pRequed
 = 
Prݔts_Requed
;

90 i(
pOiڮ
)

91 *
pOiڮ
 = 
Prݔts_Oiڮ
;

92 i(
pPrrry
)

93 *
pPrrry
 = 
Prݔts_Prrry
;

96 
	}
}

98 
	$Muie_Iut_In
(

101 
i
;

104 
i
 = 0; i < 
MAX_MULTISTATE_INPUTS
; i++) {

105 
P_Vue
[
i
] = 1;

106 
	`rtf
(&
Obje_Name
[
i
][0], "MULTISTATE INPUT %u", i);

107 
	`rtf
(&
Obje_Desti
[
i
][0], "MULTISTATE INPUT %u", i);

111 
	}
}

116 
	$Muie_Iut_In_To_Index
(

117 
ut32_t
 
obje_
)

119 
dex
 = 
MAX_MULTISTATE_INPUTS
;

121 i(
obje_
 < 
MAX_MULTISTATE_INPUTS
)

122 
dex
 = 
obje_
;

124  
dex
;

125 
	}
}

130 
ut32_t
 
	$Muie_Iut_Index_To_In
(

131 
dex
)

133  
dex
;

134 
	}
}

138 
	$Muie_Iut_Cou
(

141  
MAX_MULTISTATE_INPUTS
;

142 
	}
}

144 
bo
 
	$Muie_Iut_Vid_In
(

145 
ut32_t
 
obje_
)

147 
dex
 = 0;

149 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

150 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

151  
ue
;

154  
l
;

155 
	}
}

157 
ut32_t
 
	$Muie_Iut_Max_Ss
(

158 
ut32_t
 

)

160  
MULTISTATE_NUMBER_OF_STATES
;

161 
	}
}

163 
ut32_t
 
	$Muie_Iut_P_Vue
(

164 
ut32_t
 
obje_
)

166 
ut32_t
 
vue
 = 1;

167 
dex
 = 0;

169 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

170 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

171 
vue
 = 
P_Vue
[
dex
];

174  
vue
;

175 
	}
}

177 
bo
 
	$Muie_Iut_P_Vue_S
(

178 
ut32_t
 
obje_
,

179 
ut32_t
 
vue
)

181 
bo
 
us
 = 
l
;

182 
dex
 = 0;

184 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

185 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

186 i((
vue
 > 0&& (vu<
MULTISTATE_NUMBER_OF_STATES
)) {

187 
P_Vue
[
dex
] = (
ut8_t

vue
;

188 
us
 = 
ue
;

192  
us
;

193 
	}
}

195 
bo
 
	$Muie_Iut_Out_Of_Svi
(

196 
ut32_t
 
obje_
)

198 
bo
 
vue
 = 
l
;

199 
dex
 = 0;

201 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

202 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

203 
vue
 = 
Out_Of_Svi
[
dex
];

206  
vue
;

207 
	}
}

209 
	$Muie_Iut_Out_Of_Svi_S
(

210 
ut32_t
 
obje_
,

211 
bo
 
vue
)

213 
dex
 = 0;

215 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

216 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

217 
Out_Of_Svi
[
dex
] = 
vue
;

221 
	}
}

223 *
	$Muie_Iut_Desti
(

224 
ut32_t
 
obje_
)

226 
dex
 = 0;

227 *
pName
 = 
NULL
;

229 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

230 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

231 
pName
 = 
Obje_Desti
[
dex
];

234  
pName
;

235 
	}
}

237 
bo
 
	$Muie_Iut_Desti_S
(

238 
ut32_t
 
obje_
,

239 *
w_me
)

241 
dex
 = 0;

242 
size_t
 
i
 = 0;

243 
bo
 
us
 = 
l
;

245 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

246 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

247 
us
 = 
ue
;

248 i(
w_me
) {

249 
i
 = 0; i < (
Obje_Desti
[
dex
]); i++) {

250 
Obje_Desti
[
dex
][
i
] = 
w_me
[i];

251 i(
w_me
[
i
] == 0) {

256 
i
 = 0; i < (
Obje_Desti
[
dex
]); i++) {

257 
Obje_Desti
[
dex
][
i
] = 0;

262  
us
;

263 
	}
}

265 
bo
 
	$Muie_Iut_Desti_Wre
(

266 
ut32_t
 
obje_
,

267 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

268 
BACNET_ERROR_CLASS
 * 
r_ass
,

269 
BACNET_ERROR_CODE
 * 
r_code
)

271 
dex
 = 0;

272 
size_t
 
ngth
 = 0;

273 
ut8_t
 
codg
 = 0;

274 
bo
 
us
 = 
l
;

276 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

277 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

278 
ngth
 = 
	`charg_ngth
(
ch_rg
);

279 i(
ngth
 <(
Obje_Desti
[
dex
])) {

280 
codg
 = 
	`charg_codg
(
ch_rg
);

281 i(
codg
 =
CHARACTER_UTF8
) {

282 
us
 =

283 
	`charg_si_cy
(
Obje_Desti
[
dex
],

284 (
Obje_Desti
[
dex
]), 
ch_rg
);

285 i(!
us
) {

286 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

287 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

290 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

291 *
r_code
 = 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

294 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

295 *
r_code
 = 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

299  
us
;

300 
	}
}

303 
bo
 
	$Muie_Iut_Obje_Name
(

304 
ut32_t
 
obje_
,

305 
BACNET_CHARACTER_STRING
 * 
obje_me
)

307 
dex
 = 0;

308 
bo
 
us
 = 
l
;

310 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

311 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

312 
us
 = 
	`charg__si
(
obje_me
, 
Obje_Name
[
dex
]);

315  
us
;

316 
	}
}

319 
bo
 
	$Muie_Iut_Name_S
(

320 
ut32_t
 
obje_
,

321 *
w_me
)

323 
dex
 = 0;

324 
size_t
 
i
 = 0;

325 
bo
 
us
 = 
l
;

327 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

328 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

329 
us
 = 
ue
;

331 i(
w_me
) {

332 
i
 = 0; i < (
Obje_Name
[
dex
]); i++) {

333 
Obje_Name
[
dex
][
i
] = 
w_me
[i];

334 i(
w_me
[
i
] == 0) {

339 
i
 = 0; i < (
Obje_Name
[
dex
]); i++) {

340 
Obje_Name
[
dex
][
i
] = 0;

345  
us
;

346 
	}
}

348 
bo
 
	$Muie_Iut_Obje_Name_Wre
(

349 
ut32_t
 
obje_
,

350 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

351 
BACNET_ERROR_CLASS
 * 
r_ass
,

352 
BACNET_ERROR_CODE
 * 
r_code
)

354 
dex
 = 0;

355 
size_t
 
ngth
 = 0;

356 
ut8_t
 
codg
 = 0;

357 
bo
 
us
 = 
l
;

359 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

360 i(
dex
 < 
MAX_MULTISTATE_INPUTS
) {

361 
ngth
 = 
	`charg_ngth
(
ch_rg
);

362 i(
ngth
 <(
Obje_Name
[
dex
])) {

363 
codg
 = 
	`charg_codg
(
ch_rg
);

364 i(
codg
 =
CHARACTER_UTF8
) {

365 
us
 =

366 
	`charg_si_cy
(
Obje_Name
[
dex
],

367 (
Obje_Name
[
dex
]), 
ch_rg
);

368 i(!
us
) {

369 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

370 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

373 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

374 *
r_code
 = 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

377 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

378 *
r_code
 = 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

382  
us
;

383 
	}
}

385 *
	$Muie_Iut_S_Text
(

386 
ut32_t
 
obje_
,

387 
ut32_t
 
e_dex
)

389 
dex
 = 0;

390 *
pName
 = 
NULL
;

392 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

393 i((
dex
 < 
MAX_MULTISTATE_INPUTS
&& (
e_dex
 > 0) &&

394 (
e_dex
 <
MULTISTATE_NUMBER_OF_STATES
)) {

395 
e_dex
--;

396 
pName
 = 
S_Text
[
dex
][
e_dex
];

399  
pName
;

400 
	}
}

403 
bo
 
	$Muie_Iut_S_Text_S
(

404 
ut32_t
 
obje_
,

405 
ut32_t
 
e_dex
,

406 *
w_me
)

408 
dex
 = 0;

409 
size_t
 
i
 = 0;

410 
bo
 
us
 = 
l
;

412 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

413 i((
dex
 < 
MAX_MULTISTATE_INPUTS
&& (
e_dex
 > 0) &&

414 (
e_dex
 <
MULTISTATE_NUMBER_OF_STATES
)) {

415 
e_dex
--;

416 
us
 = 
ue
;

417 i(
w_me
) {

418 
i
 = 0; i < (
S_Text
[
dex
][
e_dex
]); i++) {

419 
S_Text
[
dex
][
e_dex
][
i
] = 
w_me
[i];

420 i(
w_me
[
i
] == 0) {

425 
i
 = 0; i < (
S_Text
[
dex
][
e_dex
]); i++) {

426 
S_Text
[
dex
][
e_dex
][
i
] = 0;

431  
us
;;

432 
	}
}

434 
bo
 
	$Muie_Iut_S_Text_Wre
(

435 
ut32_t
 
obje_
,

436 
ut32_t
 
e_dex
,

437 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

438 
BACNET_ERROR_CLASS
 * 
r_ass
,

439 
BACNET_ERROR_CODE
 * 
r_code
)

441 
dex
 = 0;

442 
size_t
 
ngth
 = 0;

443 
ut8_t
 
codg
 = 0;

444 
bo
 
us
 = 
l
;

446 
dex
 = 
	`Muie_Iut_In_To_Index
(
obje_
);

447 i((
dex
 < 
MAX_MULTISTATE_INPUTS
&& (
e_dex
 > 0) &&

448 (
e_dex
 <
	`Muie_Iut_Max_Ss
(
obje_
))) {

449 
e_dex
--;

450 
ngth
 = 
	`charg_ngth
(
ch_rg
);

451 i(
ngth
 <(
S_Text
[
dex
][
e_dex
])) {

452 
codg
 = 
	`charg_codg
(
ch_rg
);

453 i(
codg
 =
CHARACTER_UTF8
) {

454 
us
 =

455 
	`charg_si_cy
(
S_Text
[
dex
][
e_dex
],

456 (
S_Text
[
dex
][
e_dex
]), 
ch_rg
);

457 i(!
us
) {

458 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

459 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

462 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

463 *
r_code
 = 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

466 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

467 *
r_code
 = 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

470 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

471 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

474  
us
;

475 
	}
}

478 
	$Muie_Iut_Rd_Prݔty
(

479 
BACNET_READ_PROPERTY_DATA
 * 
da
)

481 
n
 = 0;

482 
du_n
 = 0;

483 
BACNET_BIT_STRING
 
b_rg
;

484 
BACNET_CHARACTER_STRING
 
ch_rg
;

485 
ut32_t
 
e_vue
 = 0;

486 
i
 = 0;

487 
ut32_t
 
max_es
 = 0;

488 
bo
 
e
 = 
l
;

489 
ut8_t
 *
du
 = 
NULL
;

491 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

492 (
da
->
iti_da_n
 == 0)) {

495 
du
 = 
da
->
iti_da
;

496 
da
->
obje_ݔty
) {

497 
PROP_OBJECT_IDENTIFIER
:

498 
du_n
 =

499 
	`code_iti_obje_id
(&
du
[0],

500 
OBJECT_MULTI_STATE_INPUT
, 
da
->
obje_
);

504 
PROP_OBJECT_NAME
:

505 
	`Muie_Iut_Obje_Name
(
da
->
obje_
,

506 &
ch_rg
);

507 
du_n
 =

508 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

510 
PROP_DESCRIPTION
:

511 
	`charg__si
(&
ch_rg
,

512 
	`Muie_Iut_Desti
(
da
->
obje_
));

513 
du_n
 =

514 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

516 
PROP_OBJECT_TYPE
:

517 
du_n
 =

518 
	`code_iti_umed
(&
du
[0],

519 
OBJECT_MULTI_STATE_INPUT
);

521 
PROP_PRESENT_VALUE
:

522 
e_vue
 =

523 
	`Muie_Iut_P_Vue
(
da
->
obje_
);

524 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
e_vue
);

526 
PROP_STATUS_FLAGS
:

528 
	`brg_
(&
b_rg
);

529 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

530 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

531 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

532 i(
	`Muie_Iut_Out_Of_Svi
(
da
->
obje_
)) {

533 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
,

534 
ue
);

536 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
,

537 
l
);

539 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

541 
PROP_EVENT_STATE
:

543 
du_n
 =

544 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

546 
PROP_OUT_OF_SERVICE
:

547 
e
 = 
	`Muie_Iut_Out_Of_Svi
(
da
->
obje_
);

548 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

550 
PROP_NUMBER_OF_STATES
:

551 
du_n
 =

552 
	`code_iti_unsigd
(&
du
[
du_n
],

553 
	`Muie_Iut_Max_Ss
(
da
->
obje_
));

555 
PROP_STATE_TEXT
:

556 i(
da
->
y_dex
 == 0) {

558 
du_n
 =

559 
	`code_iti_unsigd
(&
du
[0],

560 
	`Muie_Iut_Max_Ss
(
da
->
obje_
));

561 } i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

564 
max_es
 =

565 
	`Muie_Iut_Max_Ss
(
da
->
obje_
);

566 
i
 = 1; i <
max_es
; i++) {

567 
	`charg__si
(&
ch_rg
,

568 
	`Muie_Iut_S_Text
(
da
->
obje_
,

569 
i
));

571 
n
 =

572 
	`code_iti_cha_rg
(&
du
[
du_n
],

573 &
ch_rg
);

575 i((
du_n
 + 
n
< 
MAX_APDU
) {

576 
du_n
 +
n
;

578 
da
->
r_code
 =

579 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

580 
du_n
 = 
BACNET_STATUS_ABORT
;

585 
max_es
 =

586 
	`Muie_Iut_Max_Ss
(
da
->
obje_
);

587 i(
da
->
y_dex
 <
max_es
) {

588 
	`charg__si
(&
ch_rg
,

589 
	`Muie_Iut_S_Text
(
da
->
obje_
,

590 
da
->
y_dex
));

591 
du_n
 =

592 
	`code_iti_cha_rg
(&
du
[0],

593 &
ch_rg
);

595 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

596 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

597 
du_n
 = 
BACNET_STATUS_ERROR
;

602 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

603 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

604 
du_n
 = 
BACNET_STATUS_ERROR
;

608 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_STATE_TEXT
) &&

609 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

610 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

611 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

612 
du_n
 = 
BACNET_STATUS_ERROR
;

615  
du_n
;

616 
	}
}

619 
bo
 
	$Muie_Iut_Wre_Prݔty
(

620 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

622 
bo
 
us
 = 
l
;

623 
n
 = 0;

624 
emt_n
 = 0;

625 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

626 
ut32_t
 
max_es
 = 0;

627 
ut32_t
 
y_dex
 = 0;

628 
obje_ty
 = 0;

629 
ut32_t
 
obje_
 = 0;

632 
n
 =

633 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

634 
wp_da
->
iti_da_n
, &
vue
);

636 i(
n
 < 0) {

638 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

639 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

640  
l
;

642 i((
wp_da
->
obje_ݔty
 !
PROP_STATE_TEXT
) &&

643 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

645 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

646 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

647  
l
;

649 
wp_da
->
obje_ݔty
) {

650 
PROP_OBJECT_NAME
:

651 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

653 i(
	`Devi_Vid_Obje_Name
(&
vue
.
ty
.
Cha_Sg
,

654 &
obje_ty
, &
obje_
)) {

655 i((
obje_ty
 =
wp_da
->object_type) &&

656 (
obje_
 =
wp_da
->object_instance)) {

658 
us
 = 
ue
;

660 
us
 = 
l
;

661 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

662 
wp_da
->
r_code
 = 
ERROR_CODE_DUPLICATE_NAME
;

665 
us
 =

666 
	`Muie_Iut_Obje_Name_Wre
(
wp_da
->

667 
obje_
, &
vue
.
ty
.
Cha_Sg
,

668 &
wp_da
->
r_ass
, &wp_da->
r_code
);

671 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

672 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

675 
PROP_DESCRIPTION
:

676 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

677 
us
 =

678 
	`Muie_Iut_Desti_Wre
(
wp_da
->

679 
obje_
, &
vue
.
ty
.
Cha_Sg
,

680 &
wp_da
->
r_ass
, &wp_da->
r_code
);

682 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

683 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

686 
PROP_PRESENT_VALUE
:

687 
us
 =

688 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

689 &
wp_da
->
r_ass
, &wp_da->
r_code
);

690 i(
us
) {

691 
us
 =

692 
Muie_Iut_P_Vue_S


693 (
wp_da
->
obje_
, 
vue
.
ty
.
Unsigd_I
);

694 i(!
us
) {

695 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

696 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

700 
PROP_OUT_OF_SERVICE
:

701 
us
 =

702 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

703 &
wp_da
->
r_ass
, &wp_da->
r_code
);

704 i(
us
) {

705 
	`Muie_Iut_Out_Of_Svi_S
(
wp_da
->
obje_
,

706 
vue
.
ty
.
Boޗn
);

709 
PROP_STATE_TEXT
:

710 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

711 i(
wp_da
->
y_dex
 == 0) {

715 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

716 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

717 } i(
wp_da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

718 
max_es
 =

719 
	`Muie_Iut_Max_Ss
(
wp_da
->
obje_
);

720 
y_dex
 = 1;

721 
emt_n
 = 
n
;

723 i(
emt_n
) {

724 
us
 =

725 
	`Muie_Iut_S_Text_Wre
(
wp_da
->

726 
obje_
, 
y_dex
,

727 &
vue
.
ty
.
Cha_Sg
,

728 &
wp_da
->
r_ass
, &wp_da->
r_code
);

730 
max_es
--;

731 
y_dex
++;

732 i(
max_es
) {

733 
emt_n
 =

734 
	`ba_decode_iti_da
(&
wp_da
->

735 
iti_da
[
n
],

736 
wp_da
->
iti_da_n
 - 
n
, &
vue
);

737 i(
emt_n
 < 0) {

738 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

739 
wp_da
->
r_code
 =

740 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

743 
n
 +
emt_n
;

745 } 
max_es
);

747 
max_es
 =

748 
	`Muie_Iut_Max_Ss
(
wp_da
->
obje_
);

749 i(
wp_da
->
y_dex
 <
max_es
) {

750 
us
 =

751 
	`Muie_Iut_S_Text_Wre
(
wp_da
->

752 
obje_
, 
wp_da
->
y_dex
,

753 &
vue
.
ty
.
Cha_Sg
,

754 &
wp_da
->
r_ass
, &wp_da->
r_code
);

756 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

757 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

761 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

762 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

765 
PROP_OBJECT_IDENTIFIER
:

766 
PROP_OBJECT_TYPE
:

767 
PROP_STATUS_FLAGS
:

768 
PROP_EVENT_STATE
:

769 
PROP_NUMBER_OF_STATES
:

770 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

771 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

774 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

775 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

779  
us
;

780 
	}
}

783 #ifde
TEST


784 
	~<as.h
>

785 
	~<rg.h
>

786 
	~"e.h
"

789 
bo
 
	$Devi_Vid_Obje_Name
(

790 
BACNET_CHARACTER_STRING
 * 
obje_me
,

791 *
obje_ty
,

792 
ut32_t
 * 
obje_
)

794  
ue
;

795 
	}
}

797 
bo
 
	$WPVideArgTy
(

798 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

799 
ut8_t
 
ucExedTag
,

800 
BACNET_ERROR_CLASS
 * 
pECss
,

801 
BACNET_ERROR_CODE
 * 
pECode
)

803 
pVue
 =Value;

804 
ucExedTag
 = ucExpectedTag;

805 
pECss
 =ErrorClass;

806 
pECode
 =ErrorCode;

808  
l
;

809 
	}
}

811 
	$MuieIut
(

812 
Te
 * 
pTe
)

814 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

815 
n
 = 0;

816 
ut32_t
 
n_vue
 = 0;

817 
ut8_t
 
g_numb
 = 0;

818 
ut16_t
 
decoded_ty
 = 0;

819 
ut32_t
 
decoded_
 = 0;

820 
BACNET_READ_PROPERTY_DATA
 
da
;

822 
	`Muie_Iut_In
();

823 
da
.
iti_da
 = &
du
[0];

824 
da
.
iti_da_n
 = (
du
);

825 
da
.
obje_ty
 = 
OBJECT_MULTI_STATE_INPUT
;

826 
da
.
obje_
 = 1;

827 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

828 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

829 
n
 = 
	`Muie_Iut_Rd_Prݔty
(&
da
);

830 
	`_
(
pTe
, 
n
 != 0);

831 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

832 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

833 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

834 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

835 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

838 
	}
}

840 #ifde
TEST_MULTISTATE_INPUT


841 
	$ma
(

844 
Te
 *
pTe
;

845 
bo
 
rc
;

847 
pTe
 = 
	`_
("BACÈMui-Iut", 
NULL
);

849 
rc
 = 
	`_addTeFuni
(
pTe
, 
MuieIut
);

850 
	`as
(
rc
);

852 
	`_tSm
(
pTe
, 
dout
);

853 
	`_run
(
pTe
);

854 (
	`_pt
(
pTe
);

855 
	`_deroy
(
pTe
);

858 
	}
}

	@demo/object/ms-input.h

25 #ide
MS_INPUT_H


26 
	#MS_INPUT_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
Muie_Iut_Prݔty_Lis
(

40 cڡ **
pRequed
,

41 cڡ **
pOiڮ
,

42 cڡ **
pPrrry
);

44 
bo
 
Muie_Iut_Vid_In
(

45 
ut32_t
 
obje_
);

46 
Muie_Iut_Cou
(

48 
ut32_t
 
Muie_Iut_Index_To_In
(

49 
dex
);

50 
Muie_Iut_In_To_Index
(

51 
ut32_t
 

);

53 
Muie_Iut_Rd_Prݔty
(

54 
BACNET_READ_PROPERTY_DATA
 * 
da
);

56 
bo
 
Muie_Iut_Wre_Prݔty
(

57 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

60 
bo
 
Muie_Iut_Obje_In_Add
(

61 
ut32_t
 

);

63 
bo
 
Muie_Iut_Obje_Name
(

64 
ut32_t
 
obje_
,

65 
BACNET_CHARACTER_STRING
 * 
obje_me
);

66 
bo
 
Muie_Iut_Name_S
(

67 
ut32_t
 
obje_
,

68 *
w_me
);

70 
ut32_t
 
Muie_Iut_P_Vue
(

71 
ut32_t
 
obje_
);

72 
bo
 
Muie_Iut_P_Vue_S
(

73 
ut32_t
 
obje_
,

74 
ut32_t
 
vue
);

76 
bo
 
Muie_Iut_Chge_Of_Vue
(

77 
ut32_t
 

);

78 
Muie_Iut_Chge_Of_Vue_Cˬ
(

79 
ut32_t
 

);

80 
bo
 
Muie_Iut_Encode_Vue_Li
(

81 
ut32_t
 
obje_
,

82 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

84 
bo
 
Muie_Iut_Out_Of_Svi
(

85 
ut32_t
 
obje_
);

86 
Muie_Iut_Out_Of_Svi_S
(

87 
ut32_t
 
obje_
,

88 
bo
 
vue
);

90 *
Muie_Iut_Desti
(

91 
ut32_t
 

);

92 
bo
 
Muie_Iut_Desti_S
(

93 
ut32_t
 
obje_
,

94 *
xt_rg
);

96 
bo
 
Muie_Iut_S_Text_S
(

97 
ut32_t
 
obje_
,

98 
ut32_t
 
e_dex
,

99 *
w_me
);

100 
bo
 
Muie_Iut_Max_Ss_S
(

101 
ut32_t
 

,

102 
ut32_t
 
max_es_queed
);

103 *
Muie_Iut_S_Text
(

104 
ut32_t
 
obje_
,

105 
ut32_t
 
e_dex
);

107 
Muie_Iut_In
(

111 #ifde
TEST


112 
	~"e.h
"

113 
MuieIut
(

114 
Te
 * 
pTe
);

117 #ifde
__lulus


	@demo/object/mso.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~".h
"

37 
	~"wp.h
"

38 
	~"mso.h
"

39 
	~"hdrs.h
"

41 #ide
MAX_MULTISTATE_OUTPUTS


42 
	#MAX_MULTISTATE_OUTPUTS
 4

	)

47 
	#MULTISTATE_RELINQUISH_DEFAULT
 1

	)

50 
	#MULTISTATE_NULL
 (255)

	)

52 
	#MULTISTATE_NUMBER_OF_STATES
 (254)

	)

54 
ut8_t


55 
	gMuie_Ouut_Lev
[
MAX_MULTISTATE_OUTPUTS
][
BACNET_MAX_PRIORITY
];

58 
bo
 
	gOut_Of_Svi
[
MAX_MULTISTATE_OUTPUTS
];

61 cڡ 
	gMuie_Ouut_Prݔts_Requed
[] = {

62 
PROP_OBJECT_IDENTIFIER
,

63 
PROP_OBJECT_NAME
,

64 
PROP_OBJECT_TYPE
,

65 
PROP_PRESENT_VALUE
,

66 
PROP_STATUS_FLAGS
,

67 
PROP_EVENT_STATE
,

68 
PROP_OUT_OF_SERVICE
,

69 
PROP_NUMBER_OF_STATES
,

70 
PROP_PRIORITY_ARRAY
,

71 
PROP_RELINQUISH_DEFAULT
,

75 cڡ 
	gMuie_Ouut_Prݔts_Oiڮ
[] = {

76 
PROP_DESCRIPTION
,

80 cڡ 
	gMuie_Ouut_Prݔts_Prrry
[] = {

84 
	$Muie_Ouut_Prݔty_Lis
(

85 cڡ **
pRequed
,

86 cڡ **
pOiڮ
,

87 cڡ **
pPrrry
)

89 i(
pRequed
)

90 *
pRequed
 = 
Muie_Ouut_Prݔts_Requed
;

91 i(
pOiڮ
)

92 *
pOiڮ
 = 
Muie_Ouut_Prݔts_Oiڮ
;

93 i(
pPrrry
)

94 *
pPrrry
 = 
Muie_Ouut_Prݔts_Prrry
;

97 
	}
}

99 
	$Muie_Ouut_In
(

102 
i
, 
j
;

103 
bo
 
lized
 = 
l
;

105 i(!
lized
) {

106 
lized
 = 
ue
;

109 
i
 = 0; i < 
MAX_MULTISTATE_OUTPUTS
; i++) {

110 
j
 = 0; j < 
BACNET_MAX_PRIORITY
; j++) {

111 
Muie_Ouut_Lev
[
i
][
j
] = 
MULTISTATE_NULL
;

117 
	}
}

122 
bo
 
	$Muie_Ouut_Vid_In
(

123 
ut32_t
 
obje_
)

125 i(
obje_
 < 
MAX_MULTISTATE_OUTPUTS
)

126  
ue
;

128  
l
;

129 
	}
}

133 
	$Muie_Ouut_Cou
(

136  
MAX_MULTISTATE_OUTPUTS
;

137 
	}
}

142 
ut32_t
 
	$Muie_Ouut_Index_To_In
(

143 
dex
)

145  
dex
;

146 
	}
}

151 
	$Muie_Ouut_In_To_Index
(

152 
ut32_t
 
obje_
)

154 
dex
 = 
MAX_MULTISTATE_OUTPUTS
;

156 i(
obje_
 < 
MAX_MULTISTATE_OUTPUTS
)

157 
dex
 = 
obje_
;

159  
dex
;

160 
	}
}

162 
ut32_t
 
	$Muie_Ouut_P_Vue
(

163 
ut32_t
 
obje_
)

165 
ut32_t
 
vue
 = 
MULTISTATE_RELINQUISH_DEFAULT
;

166 
dex
 = 0;

167 
i
 = 0;

169 
dex
 = 
	`Muie_Ouut_In_To_Index
(
obje_
);

170 i(
dex
 < 
MAX_MULTISTATE_OUTPUTS
) {

171 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

172 i(
Muie_Ouut_Lev
[
dex
][
i
] !
MULTISTATE_NULL
) {

173 
vue
 = 
Muie_Ouut_Lev
[
dex
][
i
];

179  
vue
;

180 
	}
}

183 
bo
 
	$Muie_Ouut_Obje_Name
(

184 
ut32_t
 
obje_
,

185 
BACNET_CHARACTER_STRING
 * 
obje_me
)

187 
xt_rg
[32] = "";

188 
bo
 
us
 = 
l
;

190 i(
obje_
 < 
MAX_MULTISTATE_OUTPUTS
) {

191 
	`rtf
(
xt_rg
, "MULTISTATE OUTPUT %u", 
obje_
);

192 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

195  
us
;

196 
	}
}

198 
bo
 
	$Muie_Ouut_Out_Of_Svi
(

199 
ut32_t
 

)

201 
dex
 = 0;

202 
bo
 
oos_ag
 = 
l
;

204 
dex
 = 
	`Muie_Ouut_In_To_Index
(

);

205 i(
dex
 < 
MAX_MULTISTATE_OUTPUTS
) {

206 
oos_ag
 = 
Out_Of_Svi
[
dex
];

209  
oos_ag
;

210 
	}
}

212 
	$Muie_Ouut_Out_Of_Svi_S
(

213 
ut32_t
 

,

214 
bo
 
oos_ag
)

216 
dex
 = 0;

218 
dex
 = 
	`Muie_Ouut_In_To_Index
(

);

219 i(
dex
 < 
MAX_MULTISTATE_OUTPUTS
) {

220 
Out_Of_Svi
[
dex
] = 
oos_ag
;

222 
	}
}

225 
	$Muie_Ouut_Rd_Prݔty
(

226 
BACNET_READ_PROPERTY_DATA
 * 
da
)

228 
n
 = 0;

229 
du_n
 = 0;

230 
BACNET_BIT_STRING
 
b_rg
;

231 
BACNET_CHARACTER_STRING
 
ch_rg
;

232 
ut32_t
 
e_vue
 = 0;

233 
obje_dex
 = 0;

234 
i
 = 0;

235 
bo
 
e
 = 
l
;

236 
ut8_t
 *
du
 = 
NULL
;

238 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

239 (
da
->
iti_da_n
 == 0)) {

242 
du
 = 
da
->
iti_da
;

243 
da
->
obje_ݔty
) {

244 
PROP_OBJECT_IDENTIFIER
:

245 
du_n
 =

246 
	`code_iti_obje_id
(&
du
[0],

247 
OBJECT_MULTI_STATE_OUTPUT
, 
da
->
obje_
);

251 
PROP_OBJECT_NAME
:

252 
PROP_DESCRIPTION
:

253 
	`Muie_Ouut_Obje_Name
(
da
->
obje_
,

254 &
ch_rg
);

255 
du_n
 =

256 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

258 
PROP_OBJECT_TYPE
:

259 
du_n
 =

260 
	`code_iti_umed
(&
du
[0],

261 
OBJECT_MULTI_STATE_OUTPUT
);

263 
PROP_PRESENT_VALUE
:

264 
e_vue
 =

265 
	`Muie_Ouut_P_Vue
(
da
->
obje_
);

266 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
e_vue
);

268 
PROP_STATUS_FLAGS
:

270 
	`brg_
(&
b_rg
);

271 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

272 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

273 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

274 
e
 = 
	`Muie_Ouut_Out_Of_Svi
(
da
->
obje_
);

275 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
e
);

276 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

278 
PROP_EVENT_STATE
:

280 
du_n
 =

281 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

283 
PROP_OUT_OF_SERVICE
:

284 
e
 = 
	`Muie_Ouut_Out_Of_Svi
(
da
->
obje_
);

285 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

287 
PROP_PRIORITY_ARRAY
:

289 i(
da
->
y_dex
 == 0)

290 
du_n
 =

291 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

294 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

295 
obje_dex
 =

296 
Muie_Ouut_In_To_Index


297 (
da
->
obje_
);

298 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

300 i(
Muie_Ouut_Lev
[
obje_dex
][
i
] ==

301 
MULTISTATE_NULL
)

302 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

304 
e_vue
 =

305 
Muie_Ouut_Lev
[
obje_dex
][
i
];

306 
n
 =

307 
	`code_iti_unsigd
(&
du
[
du_n
],

308 
e_vue
);

311 i((
du_n
 + 
n
< 
MAX_APDU
)

312 
du_n
 +
n
;

314 
da
->
r_code
 =

315 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

316 
du_n
 = 
BACNET_STATUS_ABORT
;

321 
obje_dex
 =

322 
Muie_Ouut_In_To_Index


323 (
da
->
obje_
);

324 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

325 i(
Muie_Ouut_Lev
[
obje_dex
]

326 [
da
->
y_dex
 - 1] =
MULTISTATE_NULL
)

327 
du_n
 = 
	`code_iti_nu
(&
du
[0]);

329 
e_vue
 = 
Muie_Ouut_Lev
[
obje_dex
]

330 [
da
->
y_dex
 - 1];

331 
du_n
 =

332 
	`code_iti_unsigd
(&
du
[0],

333 
e_vue
);

336 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

337 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

338 
du_n
 = 
BACNET_STATUS_ERROR
;

343 
PROP_RELINQUISH_DEFAULT
:

344 
e_vue
 = 
MULTISTATE_RELINQUISH_DEFAULT
;

345 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
e_vue
);

347 
PROP_NUMBER_OF_STATES
:

348 
du_n
 =

349 
	`code_iti_unsigd
(&
du
[
du_n
],

350 
MULTISTATE_NUMBER_OF_STATES
);

354 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

355 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

356 
du_n
 = 
BACNET_STATUS_ERROR
;

360 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_STATE_TEXT
) &&

361 (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

362 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

363 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

364 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

365 
du_n
 = 
BACNET_STATUS_ERROR
;

368  
du_n
;

369 
	}
}

372 
bo
 
	$Muie_Ouut_Wre_Prݔty
(

373 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

375 
bo
 
us
 = 
l
;

376 
obje_dex
 = 0;

377 
iܙy
 = 0;

378 
ut32_t
 
v
 = 0;

379 
n
 = 0;

380 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

383 
n
 =

384 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

385 
wp_da
->
iti_da_n
, &
vue
);

387 i(
n
 < 0) {

389 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

390 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

391  
l
;

393 i((
wp_da
->
obje_ݔty
 !
PROP_STATE_TEXT
) &&

394 (
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

395 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

397 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

398 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

399  
l
;

401 
wp_da
->
obje_ݔty
) {

402 
PROP_PRESENT_VALUE
:

403 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

404 
iܙy
 = 
wp_da
->priority;

408 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

409 (
iܙy
 != 6 ) &&

410 (
vue
.
ty
.
Unsigd_I
 > 0) &&

411 (
vue
.
ty
.
Unsigd_I
 <
MULTISTATE_NUMBER_OF_STATES
)) {

412 
v
 = 
vue
.
ty
.
Unsigd_I
;

413 
obje_dex
 =

414 
Muie_Ouut_In_To_Index


415 (
wp_da
->
obje_
);

416 
iܙy
--;

417 
Muie_Ouut_Lev
[
obje_dex
][
iܙy
] =

418 (
ut8_t

v
;

424 
us
 = 
ue
;

425 } i(
iܙy
 == 6) {

429 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

430 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

432 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

433 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

436 
us
 =

437 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_NULL
,

438 &
wp_da
->
r_ass
, &wp_da->
r_code
);

439 i(
us
) {

440 
v
 = 
MULTISTATE_NULL
;

441 
obje_dex
 =

442 
Muie_Ouut_In_To_Index


443 (
wp_da
->
obje_
);

444 
iܙy
 = 
wp_da
->priority;

445 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

446 
iܙy
--;

447 
Muie_Ouut_Lev
[
obje_dex
][
iܙy
] =

448 (
ut8_t

v
;

456 
us
 = 
l
;

457 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

458 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

463 
PROP_OUT_OF_SERVICE
:

464 
us
 =

465 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

466 &
wp_da
->
r_ass
, &wp_da->
r_code
);

467 i(
us
) {

468 
	`Muie_Ouut_Out_Of_Svi_S
(
wp_da
->
obje_
,

469 
vue
.
ty
.
Boޗn
);

472 
PROP_OBJECT_IDENTIFIER
:

473 
PROP_OBJECT_NAME
:

474 
PROP_OBJECT_TYPE
:

475 
PROP_STATUS_FLAGS
:

476 
PROP_EVENT_STATE
:

477 
PROP_NUMBER_OF_STATES
:

478 
PROP_DESCRIPTION
:

479 
PROP_PRIORITY_ARRAY
:

480 
PROP_RELINQUISH_DEFAULT
:

481 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

482 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

485 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

486 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

490  
us
;

491 
	}
}

494 #ifde
TEST


495 
	~<as.h
>

496 
	~<rg.h
>

497 
	~"e.h
"

499 
bo
 
	$WPVideArgTy
(

500 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

501 
ut8_t
 
ucExedTag
,

502 
BACNET_ERROR_CLASS
 * 
pECss
,

503 
BACNET_ERROR_CODE
 * 
pECode
)

505 
pVue
 =Value;

506 
ucExedTag
 = ucExpectedTag;

507 
pECss
 =ErrorClass;

508 
pECode
 =ErrorCode;

510  
l
;

511 
	}
}

513 
	$MuieOuut
(

514 
Te
 * 
pTe
)

516 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

517 
n
 = 0;

518 
ut32_t
 
n_vue
 = 0;

519 
ut8_t
 
g_numb
 = 0;

520 
ut16_t
 
decoded_ty
 = 0;

521 
ut32_t
 
decoded_
 = 0;

522 
BACNET_READ_PROPERTY_DATA
 
da
;

524 
	`Muie_Ouut_In
();

525 
da
.
iti_da
 = &
du
[0];

526 
da
.
iti_da_n
 = (
du
);

527 
da
.
obje_ty
 = 
OBJECT_MULTI_STATE_OUTPUT
;

528 
da
.
obje_
 = 1;

529 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

530 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

531 
n
 = 
	`Muie_Ouut_Rd_Prݔty
(&
da
);

532 
	`_
(
pTe
, 
n
 != 0);

533 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

534 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

535 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

536 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

537 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

540 
	}
}

542 #ifde
TEST_MULTISTATE_OUTPUT


543 
	$ma
(

546 
Te
 *
pTe
;

547 
bo
 
rc
;

549 
pTe
 = 
	`_
("BACÈMui-Ouut", 
NULL
);

551 
rc
 = 
	`_addTeFuni
(
pTe
, 
MuieOuut
);

552 
	`as
(
rc
);

554 
	`_tSm
(
pTe
, 
dout
);

555 
	`_run
(
pTe
);

556 (
	`_pt
(
pTe
);

557 
	`_deroy
(
pTe
);

560 
	}
}

	@demo/object/mso.h

25 #ide
MSO_H


26 
	#MSO_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
Muie_Ouut_Prݔty_Lis
(

40 cڡ **
pRequed
,

41 cڡ **
pOiڮ
,

42 cڡ **
pPrrry
);

43 
bo
 
Muie_Ouut_Vid_In
(

44 
ut32_t
 
obje_
);

45 
Muie_Ouut_Cou
(

47 
ut32_t
 
Muie_Ouut_Index_To_In
(

48 
dex
);

49 
Muie_Ouut_In_To_Index
(

50 
ut32_t
 
obje_
);

52 
bo
 
Muie_Ouut_Obje_Name
(

53 
ut32_t
 
obje_
,

54 
BACNET_CHARACTER_STRING
 * 
obje_me
);

56 
Muie_Ouut_In
(

59 
Muie_Ouut_Rd_Prݔty
(

60 
BACNET_READ_PROPERTY_DATA
 * 
da
);

62 
bo
 
Muie_Ouut_Wre_Prݔty
(

63 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

65 
bo
 
Muie_Ouut_Chge_Of_Vue
(

66 
ut32_t
 

);

67 
Muie_Ouut_Chge_Of_Vue_Cˬ
(

68 
ut32_t
 

);

69 
bo
 
Muie_Ouut_Encode_Vue_Li
(

70 
ut32_t
 
obje_
,

71 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

73 
ut32_t
 
Muie_Ouut_P_Vue
(

74 
ut32_t
 

);

75 
bo
 
Muie_Ouut_P_Vue_S
(

76 
ut32_t
 

,

77 
vue
,

78 
iܙy
);

79 
bo
 
Muie_Ouut_P_Vue_Rquish
(

80 
ut32_t
 

,

81 
iܙy
);

83 
bo
 
Muie_Ouut_Out_Of_Svi
(

84 
ut32_t
 

);

85 
Muie_Ouut_Out_Of_Svi_S
(

86 
ut32_t
 

,

87 
bo
 
vue
);

89 *
Muie_Ouut_Desti
(

90 
ut32_t
 

);

91 
bo
 
Muie_Ouut_Desti_S
(

92 
ut32_t
 
obje_
,

93 *
xt_rg
);

95 
bo
 
Muie_Ouut_S_Text_S
(

96 
ut32_t
 
obje_
,

97 
ut32_t
 
e_dex
,

98 *
w_me
);

99 
bo
 
Muie_Ouut_Max_Ss_S
(

100 
ut32_t
 

,

101 
ut32_t
 
max_es_queed
);

102 *
Muie_Ouut_S_Text
(

103 
ut32_t
 
obje_
,

104 
ut32_t
 
e_dex
);

107 #ifde
TEST


108 
	~"e.h
"

109 
MuieOuut
(

110 
Te
 * 
pTe
);

113 #ifde
__lulus


	@demo/object/msv.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~".h
"

37 
	~"wp.h
"

38 
	~"msv.h
"

39 
	~"hdrs.h
"

42 #ide
MAX_MULTISTATE_VALUES


43 
	#MAX_MULTISTATE_VALUES
 4

	)

47 #ide
MULTISTATE_NUMBER_OF_STATES


48 
	#MULTISTATE_NUMBER_OF_STATES
 (254)

	)

52 
ut8_t
 
	gP_Vue
[
MAX_MULTISTATE_VALUES
];

54 
bo
 
	gOut_Of_Svi
[
MAX_MULTISTATE_VALUES
];

55 
	gObje_Name
[
MAX_MULTISTATE_VALUES
][64];

56 
	gObje_Desti
[
MAX_MULTISTATE_VALUES
][64];

57 
	gS_Text
[
MAX_MULTISTATE_VALUES
][
MULTISTATE_NUMBER_OF_STATES
][64];

60 cڡ 
	gPrݔts_Requed
[] = {

61 
PROP_OBJECT_IDENTIFIER
,

62 
PROP_OBJECT_NAME
,

63 
PROP_OBJECT_TYPE
,

64 
PROP_PRESENT_VALUE
,

65 
PROP_STATUS_FLAGS
,

66 
PROP_EVENT_STATE
,

67 
PROP_OUT_OF_SERVICE
,

68 
PROP_NUMBER_OF_STATES
,

72 cڡ 
	gPrݔts_Oiڮ
[] = {

73 
PROP_DESCRIPTION
,

74 
PROP_STATE_TEXT
,

78 cڡ 
	gPrݔts_Prrry
[] = {

82 
	$Muie_Vue_Prݔty_Lis
(

83 cڡ **
pRequed
,

84 cڡ **
pOiڮ
,

85 cڡ **
pPrrry
)

87 i(
pRequed
)

88 *
pRequed
 = 
Prݔts_Requed
;

89 i(
pOiڮ
)

90 *
pOiڮ
 = 
Prݔts_Oiڮ
;

91 i(
pPrrry
)

92 *
pPrrry
 = 
Prݔts_Prrry
;

95 
	}
}

97 
	$Muie_Vue_In
(

100 
i
;

103 
i
 = 0; i < 
MAX_MULTISTATE_VALUES
; i++) {

104 
P_Vue
[
i
] = 1;

105 
	`rtf
(&
Obje_Name
[
i
][0], "MULTISTATE VALUE %u", i);

106 
	`rtf
(&
Obje_Desti
[
i
][0], "MULTISTATE VALUE %u", i);

110 
	}
}

115 
	$Muie_Vue_In_To_Index
(

116 
ut32_t
 
obje_
)

118 
dex
 = 
MAX_MULTISTATE_VALUES
;

120 i(
obje_
 < 
MAX_MULTISTATE_VALUES
)

121 
dex
 = 
obje_
;

123  
dex
;

124 
	}
}

129 
ut32_t
 
	$Muie_Vue_Index_To_In
(

130 
dex
)

132  
dex
;

133 
	}
}

137 
	$Muie_Vue_Cou
(

140  
MAX_MULTISTATE_VALUES
;

141 
	}
}

143 
bo
 
	$Muie_Vue_Vid_In
(

144 
ut32_t
 
obje_
)

146 
dex
 = 0;

148 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

149 i(
dex
 < 
MAX_MULTISTATE_VALUES
) {

150  
ue
;

153  
l
;

154 
	}
}

156 
ut32_t
 
	$Muie_Vue_P_Vue
(

157 
ut32_t
 
obje_
)

159 
ut32_t
 
vue
 = 1;

160 
dex
 = 0;

162 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

163 i(
dex
 < 
MAX_MULTISTATE_VALUES
) {

164 
vue
 = 
P_Vue
[
dex
];

167  
vue
;

168 
	}
}

170 
bo
 
	$Muie_Vue_P_Vue_S
(

171 
ut32_t
 
obje_
,

172 
ut32_t
 
vue
)

174 
bo
 
us
 = 
l
;

175 
dex
 = 0;

177 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

178 i(
dex
 < 
MAX_MULTISTATE_VALUES
) {

179 i((
vue
 > 0&& (vu<
MULTISTATE_NUMBER_OF_STATES
)) {

180 
P_Vue
[
dex
] = (
ut8_t

vue
;

181 
us
 = 
ue
;

185  
us
;

186 
	}
}

188 
bo
 
	$Muie_Vue_Out_Of_Svi
(

189 
ut32_t
 
obje_
)

191 
bo
 
vue
 = 
l
;

192 
dex
 = 0;

194 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

195 i(
dex
 < 
MAX_MULTISTATE_VALUES
) {

196 
vue
 = 
Out_Of_Svi
[
dex
];

199  
vue
;

200 
	}
}

202 
	$Muie_Vue_Out_Of_Svi_S
(

203 
ut32_t
 
obje_
,

204 
bo
 
vue
)

206 
dex
 = 0;

208 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

209 i(
dex
 < 
MAX_MULTISTATE_VALUES
) {

210 
Out_Of_Svi
[
dex
] = 
vue
;

214 
	}
}

216 *
	$Muie_Vue_Desti
(

217 
ut32_t
 
obje_
)

219 
dex
 = 0;

220 *
pName
 = 
NULL
;

222 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

223 i(
dex
 < 
MAX_MULTISTATE_VALUES
) {

224 
pName
 = 
Obje_Desti
[
dex
];

227  
pName
;

228 
	}
}

230 
bo
 
	$Muie_Vue_Desti_S
(

231 
ut32_t
 
obje_
,

232 *
w_me
)

234 
dex
 = 0;

235 
size_t
 
i
 = 0;

236 
bo
 
us
 = 
l
;

238 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

239 i(
dex
 < 
MAX_MULTISTATE_VALUES
) {

240 
us
 = 
ue
;

241 i(
w_me
) {

242 
i
 = 0; i < (
Obje_Desti
[
dex
]); i++) {

243 
Obje_Desti
[
dex
][
i
] = 
w_me
[i];

244 i(
w_me
[
i
] == 0) {

249 
i
 = 0; i < (
Obje_Desti
[
dex
]); i++) {

250 
Obje_Desti
[
dex
][
i
] = 0;

255  
us
;

256 
	}
}

258 
bo
 
	$Muie_Vue_Obje_Name
(

259 
ut32_t
 
obje_
,

260 
BACNET_CHARACTER_STRING
 * 
obje_me
)

262 
dex
 = 0;

263 
bo
 
us
 = 
l
;

265 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

266 i(
dex
 < 
MAX_MULTISTATE_VALUES
) {

267 
us
 = 
	`charg__si
(
obje_me
, 
Obje_Name
[
dex
]);

270  
us
;

271 
	}
}

274 
bo
 
	$Muie_Vue_Name_S
(

275 
ut32_t
 
obje_
,

276 *
w_me
)

278 
dex
 = 0;

279 
size_t
 
i
 = 0;

280 
bo
 
us
 = 
l
;

282 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

283 i(
dex
 < 
MAX_MULTISTATE_VALUES
) {

284 
us
 = 
ue
;

286 i(
w_me
) {

287 
i
 = 0; i < (
Obje_Name
[
dex
]); i++) {

288 
Obje_Name
[
dex
][
i
] = 
w_me
[i];

289 i(
w_me
[
i
] == 0) {

294 
i
 = 0; i < (
Obje_Name
[
dex
]); i++) {

295 
Obje_Name
[
dex
][
i
] = 0;

300  
us
;

301 
	}
}

303 *
	$Muie_Vue_S_Text
(

304 
ut32_t
 
obje_
,

305 
ut32_t
 
e_dex
)

307 
dex
 = 0;

308 *
pName
 = 
NULL
;

310 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

311 i((
dex
 < 
MAX_MULTISTATE_VALUES
&& (
e_dex
 > 0) &&

312 (
e_dex
 <
MULTISTATE_NUMBER_OF_STATES
)) {

313 
e_dex
--;

314 
pName
 = 
S_Text
[
dex
][
e_dex
];

317  
pName
;

318 
	}
}

321 
bo
 
	$Muie_Vue_S_Text_S
(

322 
ut32_t
 
obje_
,

323 
ut32_t
 
e_dex
,

324 *
w_me
)

326 
dex
 = 0;

327 
size_t
 
i
 = 0;

328 
bo
 
us
 = 
l
;

330 
dex
 = 
	`Muie_Vue_In_To_Index
(
obje_
);

331 i((
dex
 < 
MAX_MULTISTATE_VALUES
&& (
e_dex
 > 0) &&

332 (
e_dex
 <
MULTISTATE_NUMBER_OF_STATES
)) {

333 
e_dex
--;

334 
us
 = 
ue
;

335 i(
w_me
) {

336 
i
 = 0; i < (
S_Text
[
dex
][
e_dex
]); i++) {

337 
S_Text
[
dex
][
e_dex
][
i
] = 
w_me
[i];

338 i(
w_me
[
i
] == 0) {

343 
i
 = 0; i < (
S_Text
[
dex
][
e_dex
]); i++) {

344 
S_Text
[
dex
][
e_dex
][
i
] = 0;

349  
us
;;

350 
	}
}

354 
	$Muie_Vue_Rd_Prݔty
(

355 
BACNET_READ_PROPERTY_DATA
 * 
da
)

357 
n
 = 0;

358 
du_n
 = 0;

359 
BACNET_BIT_STRING
 
b_rg
;

360 
BACNET_CHARACTER_STRING
 
ch_rg
;

361 
ut32_t
 
e_vue
 = 0;

362 
i
 = 0;

363 
bo
 
e
 = 
l
;

364 
ut8_t
 *
du
 = 
NULL
;

366 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

367 (
da
->
iti_da_n
 == 0)) {

370 
du
 = 
da
->
iti_da
;

371 
da
->
obje_ݔty
) {

372 
PROP_OBJECT_IDENTIFIER
:

373 
du_n
 =

374 
	`code_iti_obje_id
(&
du
[0],

375 
OBJECT_MULTI_STATE_VALUE
, 
da
->
obje_
);

379 
PROP_OBJECT_NAME
:

380 
	`Muie_Vue_Obje_Name
(
da
->
obje_
,

381 &
ch_rg
);

382 
du_n
 =

383 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

385 
PROP_DESCRIPTION
:

386 
	`charg__si
(&
ch_rg
,

387 
	`Muie_Vue_Desti
(
da
->
obje_
));

388 
du_n
 =

389 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

391 
PROP_OBJECT_TYPE
:

392 
du_n
 =

393 
	`code_iti_umed
(&
du
[0],

394 
OBJECT_MULTI_STATE_VALUE
);

396 
PROP_PRESENT_VALUE
:

397 
e_vue
 =

398 
	`Muie_Vue_P_Vue
(
da
->
obje_
);

399 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
e_vue
);

401 
PROP_STATUS_FLAGS
:

403 
	`brg_
(&
b_rg
);

404 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

405 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

406 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

407 
e
 = 
	`Muie_Vue_Out_Of_Svi
(
da
->
obje_
);

408 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
e
);

409 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

411 
PROP_EVENT_STATE
:

413 
du_n
 =

414 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

416 
PROP_OUT_OF_SERVICE
:

417 
e
 = 
	`Muie_Vue_Out_Of_Svi
(
da
->
obje_
);

418 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

420 
PROP_NUMBER_OF_STATES
:

421 
du_n
 =

422 
	`code_iti_unsigd
(&
du
[
du_n
],

423 
MULTISTATE_NUMBER_OF_STATES
);

425 
PROP_STATE_TEXT
:

426 i(
da
->
y_dex
 == 0) {

428 
du_n
 =

429 
	`code_iti_unsigd
(&
du
[0],

430 
MULTISTATE_NUMBER_OF_STATES
);

431 } i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

434 
i
 = 1; i <
MULTISTATE_NUMBER_OF_STATES
; i++) {

435 
	`charg__si
(&
ch_rg
,

436 
	`Muie_Vue_S_Text
(
da
->
obje_
,

437 
i
));

439 
n
 =

440 
	`code_iti_cha_rg
(&
du
[
du_n
],

441 &
ch_rg
);

443 i((
du_n
 + 
n
< 
MAX_APDU
) {

444 
du_n
 +
n
;

446 
da
->
r_code
 =

447 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

448 
du_n
 = 
BACNET_STATUS_ABORT
;

453 i(
da
->
y_dex
 <
MULTISTATE_NUMBER_OF_STATES
) {

454 
	`charg__si
(&
ch_rg
,

455 
	`Muie_Vue_S_Text
(
da
->
obje_
,

456 
da
->
y_dex
));

457 
du_n
 =

458 
	`code_iti_cha_rg
(&
du
[0],

459 &
ch_rg
);

461 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

462 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

463 
du_n
 = 
BACNET_STATUS_ERROR
;

468 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

469 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

470 
du_n
 = 
BACNET_STATUS_ERROR
;

474 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_STATE_TEXT
) &&

475 (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

476 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

477 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

478 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

479 
du_n
 = 
BACNET_STATUS_ERROR
;

482  
du_n
;

483 
	}
}

486 
bo
 
	$Muie_Vue_Wre_Prݔty
(

487 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

489 
bo
 
us
 = 
l
;

490 
n
 = 0;

491 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

494 
n
 =

495 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

496 
wp_da
->
iti_da_n
, &
vue
);

498 i(
n
 < 0) {

500 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

501 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

502  
l
;

504 i((
wp_da
->
obje_ݔty
 !
PROP_STATE_TEXT
) &&

505 (
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

506 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

508 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

509 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

510  
l
;

512 
wp_da
->
obje_ݔty
) {

513 
PROP_PRESENT_VALUE
:

514 
us
 =

515 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

516 &
wp_da
->
r_ass
, &wp_da->
r_code
);

517 i(
us
) {

518 
us
 =

519 
Muie_Vue_P_Vue_S


520 (
wp_da
->
obje_
, 
vue
.
ty
.
Unsigd_I
);

521 i(!
us
) {

522 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

523 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

527 
PROP_OUT_OF_SERVICE
:

528 
us
 =

529 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

530 &
wp_da
->
r_ass
, &wp_da->
r_code
);

531 i(
us
) {

532 
	`Muie_Vue_Out_Of_Svi_S
(
wp_da
->
obje_
,

533 
vue
.
ty
.
Boޗn
);

536 
PROP_OBJECT_IDENTIFIER
:

537 
PROP_OBJECT_NAME
:

538 
PROP_OBJECT_TYPE
:

539 
PROP_STATUS_FLAGS
:

540 
PROP_EVENT_STATE
:

541 
PROP_NUMBER_OF_STATES
:

542 
PROP_DESCRIPTION
:

543 
PROP_STATE_TEXT
:

544 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

545 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

548 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

549 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

553  
us
;

554 
	}
}

557 #ifde
TEST


558 
	~<as.h
>

559 
	~<rg.h
>

560 
	~"e.h
"

562 
bo
 
	$WPVideArgTy
(

563 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

564 
ut8_t
 
ucExedTag
,

565 
BACNET_ERROR_CLASS
 * 
pECss
,

566 
BACNET_ERROR_CODE
 * 
pECode
)

568 
pVue
 =Value;

569 
ucExedTag
 = ucExpectedTag;

570 
pECss
 =ErrorClass;

571 
pECode
 =ErrorCode;

573  
l
;

574 
	}
}

576 
	$MuieIut
(

577 
Te
 * 
pTe
)

579 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

580 
n
 = 0;

581 
ut32_t
 
n_vue
 = 0;

582 
ut8_t
 
g_numb
 = 0;

583 
ut16_t
 
decoded_ty
 = 0;

584 
ut32_t
 
decoded_
 = 0;

585 
BACNET_READ_PROPERTY_DATA
 
da
;

587 
	`Muie_Vue_In
();

588 
da
.
iti_da
 = &
du
[0];

589 
da
.
iti_da_n
 = (
du
);

590 
da
.
obje_ty
 = 
OBJECT_MULTI_STATE_VALUE
;

591 
da
.
obje_
 = 1;

592 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

593 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

594 
n
 = 
	`Muie_Vue_Rd_Prݔty
(&
da
);

595 
	`_
(
pTe
, 
n
 != 0);

596 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

597 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

598 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

599 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

600 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

603 
	}
}

605 #ifde
TEST_MULTISTATE_VALUE


606 
	$ma
(

609 
Te
 *
pTe
;

610 
bo
 
rc
;

612 
pTe
 = 
	`_
("BACÈMui-Iut", 
NULL
);

614 
rc
 = 
	`_addTeFuni
(
pTe
, 
MuieIut
);

615 
	`as
(
rc
);

617 
	`_tSm
(
pTe
, 
dout
);

618 
	`_run
(
pTe
);

619 (
	`_pt
(
pTe
);

620 
	`_deroy
(
pTe
);

623 
	}
}

	@demo/object/msv.h

25 #ide
MULTISTATE_VALUE_H


26 
	#MULTISTATE_VALUE_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~".h
"

33 
	~"wp.h
"

35 #ifde
__lulus


39 
Muie_Vue_Prݔty_Lis
(

40 cڡ **
pRequed
,

41 cڡ **
pOiڮ
,

42 cڡ **
pPrrry
);

44 
bo
 
Muie_Vue_Vid_In
(

45 
ut32_t
 
obje_
);

46 
Muie_Vue_Cou
(

48 
ut32_t
 
Muie_Vue_Index_To_In
(

49 
dex
);

50 
Muie_Vue_In_To_Index
(

51 
ut32_t
 

);

53 
Muie_Vue_Rd_Prݔty
(

54 
BACNET_READ_PROPERTY_DATA
 * 
da
);

56 
bo
 
Muie_Vue_Wre_Prݔty
(

57 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

60 
bo
 
Muie_Vue_Obje_In_Add
(

61 
ut32_t
 

);

63 
bo
 
Muie_Vue_Obje_Name
(

64 
ut32_t
 
obje_
,

65 
BACNET_CHARACTER_STRING
 * 
obje_me
);

66 
bo
 
Muie_Vue_Name_S
(

67 
ut32_t
 
obje_
,

68 *
w_me
);

70 
ut32_t
 
Muie_Vue_P_Vue
(

71 
ut32_t
 
obje_
);

72 
bo
 
Muie_Vue_P_Vue_S
(

73 
ut32_t
 
obje_
,

74 
ut32_t
 
vue
);

76 
bo
 
Muie_Vue_Chge_Of_Vue
(

77 
ut32_t
 

);

78 
Muie_Vue_Chge_Of_Vue_Cˬ
(

79 
ut32_t
 

);

80 
bo
 
Muie_Vue_Encode_Vue_Li
(

81 
ut32_t
 
obje_
,

82 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

84 
bo
 
Muie_Vue_Out_Of_Svi
(

85 
ut32_t
 
obje_
);

86 
Muie_Vue_Out_Of_Svi_S
(

87 
ut32_t
 
obje_
,

88 
bo
 
vue
);

90 *
Muie_Vue_Desti
(

91 
ut32_t
 

);

92 
bo
 
Muie_Vue_Desti_S
(

93 
ut32_t
 
obje_
,

94 *
xt_rg
);

96 
bo
 
Muie_Vue_S_Text_S
(

97 
ut32_t
 
obje_
,

98 
ut32_t
 
e_dex
,

99 *
w_me
);

100 
bo
 
Muie_Vue_Max_Ss_S
(

101 
ut32_t
 

,

102 
ut32_t
 
max_es_queed
);

103 *
Muie_Vue_S_Text
(

104 
ut32_t
 
obje_
,

105 
ut32_t
 
e_dex
);

107 
Muie_Vue_In
(

111 #ifde
TEST


112 
	~"e.h
"

113 
MuieVue
(

114 
Te
 * 
pTe
);

117 #ifde
__lulus


	@demo/object/nc.c

31 
	~<dbo.h
>

32 
	~<dt.h
>

33 
	~<dio.h
>

34 
	~<rg.h
>

36 
	~"addss.h
"

37 
	~"bacdef.h
"

38 
	~"bacdcode.h
"

39 
	~"banum.h
"

40 
	~"ba.h
"

41 
	~".h
"

42 
	~"cfig.h
"

43 
	~"devi.h
"

44 
	~"evt.h
"

45 
	~"hdrs.h
"

46 
	~"txbuf.h
"

47 
	~"wp.h
"

48 
	~"nc.h
"

51 #ide
MAX_NOTIFICATION_CLASSES


52 
	#MAX_NOTIFICATION_CLASSES
 2

	)

56 #i
defed
(
INTRINSIC_REPORTING
)

57 
NOTIFICATION_CLASS_INFO
 
	gNC_Info
[
MAX_NOTIFICATION_CLASSES
];

60 cڡ 
	gNifiti_Prݔts_Requed
[] = {

61 
PROP_OBJECT_IDENTIFIER
,

62 
PROP_OBJECT_NAME
,

63 
PROP_OBJECT_TYPE
,

64 
PROP_NOTIFICATION_CLASS
,

65 
PROP_PRIORITY
,

66 
PROP_ACK_REQUIRED
,

67 
PROP_RECIPIENT_LIST
,

71 cڡ 
	gNifiti_Prݔts_Oiڮ
[] = {

72 
PROP_DESCRIPTION
,

76 cڡ 
	gNifiti_Prݔts_Prrry
[] = {

80 
	$Nifiti_Css_Prݔty_Lis
(

81 cڡ **
pRequed
,

82 cڡ **
pOiڮ
,

83 cڡ **
pPrrry
)

85 i(
pRequed
)

86 *
pRequed
 = 
Nifiti_Prݔts_Requed
;

87 i(
pOiڮ
)

88 *
pOiڮ
 = 
Nifiti_Prݔts_Oiڮ
;

89 i(
pPrrry
)

90 *
pPrrry
 = 
Nifiti_Prݔts_Prrry
;

92 
	}
}

94 
	$Nifiti_Css_In
(

97 
ut8_t
 
NifyIdx
 = 0;

99 
NifyIdx
 = 0; NifyIdx < 
MAX_NOTIFICATION_CLASSES
; NotifyIdx++) {

101 
	`memt
(&
NC_Info
[
NifyIdx
], 0x00, (
NOTIFICATION_CLASS_INFO
));

103 
NC_Info
[
NifyIdx
].
Ack_Requed
 = 0;

104 
NC_Info
[
NifyIdx
].
Priܙy
[
TRANSITION_TO_OFFNORMAL
] = 255;

105 
NC_Info
[
NifyIdx
].
Priܙy
[
TRANSITION_TO_FAULT
] = 255;

106 
NC_Info
[
NifyIdx
].
Priܙy
[
TRANSITION_TO_NORMAL
] = 255;

110 
	}
}

116 
bo
 
	$Nifiti_Css_Vid_In
(

117 
ut32_t
 
obje_
)

119 
dex
;

121 
dex
 = 
	`Nifiti_Css_In_To_Index
(
obje_
);

122 i(
dex
 < 
MAX_NOTIFICATION_CLASSES
)

123  
ue
;

125  
l
;

126 
	}
}

130 
	$Nifiti_Css_Cou
(

133  
MAX_NOTIFICATION_CLASSES
;

134 
	}
}

139 
ut32_t
 
	$Nifiti_Css_Index_To_In
(

140 
dex
)

142  
dex
;

143 
	}
}

148 
	$Nifiti_Css_In_To_Index
(

149 
ut32_t
 
obje_
)

151 
dex
 = 
MAX_NOTIFICATION_CLASSES
;

153 i(
obje_
 < 
MAX_NOTIFICATION_CLASSES
)

154 
dex
 = 
obje_
;

156  
dex
;

157 
	}
}

159 
bo
 
	$Nifiti_Css_Obje_Name
(

160 
ut32_t
 
obje_
,

161 
BACNET_CHARACTER_STRING
 * 
obje_me
)

163 
xt_rg
[32] = "";

164 
dex
;

165 
bo
 
us
 = 
l
;

167 
dex
 = 
	`Nifiti_Css_In_To_Index
(
obje_
);

168 i(
dex
 < 
MAX_NOTIFICATION_CLASSES
) {

169 
	`rtf
(
xt_rg
, "NOTIFICATION CLASS %lu", (
dex
);

170 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

173  
us
;

174 
	}
}

178 
	$Nifiti_Css_Rd_Prݔty
(

179 
BACNET_READ_PROPERTY_DATA
 * 
da
)

181 
NOTIFICATION_CLASS_INFO
 *
CutNify
;

182 
BACNET_CHARACTER_STRING
 
ch_rg
;

183 
BACNET_OCTET_STRING
 
o_rg
;

184 
BACNET_BIT_STRING
 
b_rg
;

185 
ut8_t
 *
du
 = 
NULL
;

186 
ut8_t
 
u8V
;

187 
idx
;

188 
du_n
 = 0;

191 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

192 (
da
->
iti_da_n
 == 0)) {

196 
du
 = 
da
->
iti_da
;

197 
CutNify
 =

198 &
NC_Info
[
	`Nifiti_Css_In_To_Index
(
da
->

199 
obje_
)];

201 
da
->
obje_ݔty
) {

202 
PROP_OBJECT_IDENTIFIER
:

203 
du_n
 =

204 
	`code_iti_obje_id
(&
du
[0],

205 
OBJECT_NOTIFICATION_CLASS
, 
da
->
obje_
);

208 
PROP_OBJECT_NAME
:

209 
PROP_DESCRIPTION
:

210 
	`Nifiti_Css_Obje_Name
(
da
->
obje_
,

211 &
ch_rg
);

212 
du_n
 =

213 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

216 
PROP_OBJECT_TYPE
:

217 
du_n
 =

218 
	`code_iti_umed
(&
du
[0],

219 
OBJECT_NOTIFICATION_CLASS
);

222 
PROP_NOTIFICATION_CLASS
:

223 
du_n
 +=

224 
	`code_iti_unsigd
(&
du
[0], 
da
->
obje_
);

227 
PROP_PRIORITY
:

228 i(
da
->
y_dex
 == 0)

229 
du_n
 +
	`code_iti_unsigd
(&
du
[0], 3);

231 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

232 
du_n
 +=

233 
	`code_iti_unsigd
(&
du
[
du_n
],

234 
CutNify
->
Priܙy
[
TRANSITION_TO_OFFNORMAL
]);

235 
du_n
 +=

236 
	`code_iti_unsigd
(&
du
[
du_n
],

237 
CutNify
->
Priܙy
[
TRANSITION_TO_FAULT
]);

238 
du_n
 +=

239 
	`code_iti_unsigd
(&
du
[
du_n
],

240 
CutNify
->
Priܙy
[
TRANSITION_TO_NORMAL
]);

241 } i(
da
->
y_dex
 <
MAX_BACNET_EVENT_TRANSITION
) {

242 
du_n
 +=

243 
	`code_iti_unsigd
(&
du
[
du_n
],

244 
CutNify
->
Priܙy
[
da
->
y_dex
 - 1]);

246 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

247 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

248 
du_n
 = -1;

253 
PROP_ACK_REQUIRED
:

254 
u8V
 = 
CutNify
->
Ack_Requed
;

256 
	`brg_
(&
b_rg
);

257 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_OFFNORMAL
,

258 (
u8V
 & 
TRANSITION_TO_OFFNORMAL_MASKED
? 
ue
 : 
l
);

259 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_FAULT
,

260 (
u8V
 & 
TRANSITION_TO_FAULT_MASKED
? 
ue
 : 
l
);

261 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_NORMAL
,

262 (
u8V
 & 
TRANSITION_TO_NORMAL_MASKED
? 
ue
 : 
l
);

264 
du_n
 +=

265 
	`code_iti_brg
(&
du
[
du_n
], &
b_rg
);

268 
PROP_RECIPIENT_LIST
:

270 
idx
 = 0; idx < 
NC_MAX_RECIPIENTS
; idx++) {

271 
BACNET_DESTINATION
 *
RecEry
;

272 
i
 = 0;

275 
RecEry
 = &
CutNify
->
Rec_Li
[
idx
];

276 i(
RecEry
->
Rec
.
RecTy
 !=

277 
RECIPIENT_TYPE_NOTINITIALIZED
) {

279 
u8V
 = 0x01;

280 
	`brg_
(&
b_rg
);

282 
i
 = 0; i < 
MAX_BACNET_DAYS_OF_WEEK
; i++) {

283 i(
RecEry
->
VidDays
 & 
u8V
)

284 
	`brg_t_b
(&
b_rg
, 
i
, 
ue
);

286 
	`brg_t_b
(&
b_rg
, 
i
, 
l
);

287 
u8V
 <<= 1;

289 
du_n
 +=

290 
	`code_iti_brg
(&
du
[
du_n
],

291 &
b_rg
);

294 
du_n
 +=

295 
	`code_iti_time
(&
du
[
du_n
],

296 &
RecEry
->
FromTime
);

299 
du_n
 +=

300 
	`code_iti_time
(&
du
[
du_n
],

301 &
RecEry
->
ToTime
);

310 i(
RecEry
->
Rec
.
RecTy
 ==

311 
RECIPIENT_TYPE_DEVICE
) {

312 
du_n
 +=

313 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0,

314 
OBJECT_DEVICE
,

315 
RecEry
->
Rec
.
_
.
DeviIdtifr
);

318 i(
RecEry
->
Rec
.
RecTy
 ==

319 
RECIPIENT_TYPE_ADDRESS
) {

321 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 1);

323 
du_n
 +=

324 
	`code_iti_unsigd
(&
du
[
du_n
],

325 
RecEry
->
Rec
.
_
.
Addss
.
t
);

328 i(
RecEry
->
Rec
.
_
.
Addss
.
t
) {

329 
	`org_
(&
o_rg
,

330 
RecEry
->
Rec
.
_
.
Addss
.
adr
,

331 
RecEry
->
Rec
.
_
.
Addss
.
n
);

333 
	`org_
(&
o_rg
,

334 
RecEry
->
Rec
.
_
.
Addss
.
mac
,

335 
RecEry
->
Rec
.
_
.
Addss
.
mac_n
);

337 
du_n
 +=

338 
	`code_iti_o_rg
(&
du
[
du_n
],

339 &
o_rg
);

342 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 1);

348 
du_n
 +=

349 
	`code_iti_unsigd
(&
du
[
du_n
],

350 
RecEry
->
ProssIdtifr
);

353 
du_n
 +=

354 
	`code_iti_boޗn
(&
du
[
du_n
],

355 
RecEry
->
CfmedNify
);

358 
u8V
 = 
RecEry
->
Tnsis
;

360 
	`brg_
(&
b_rg
);

361 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_OFFNORMAL
,

362 (
u8V
 & 
TRANSITION_TO_OFFNORMAL_MASKED
? 
ue
 :

363 
l
);

364 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_FAULT
,

365 (
u8V
 & 
TRANSITION_TO_FAULT_MASKED
? 
ue
 : 
l
);

366 
	`brg_t_b
(&
b_rg
, 
TRANSITION_TO_NORMAL
,

367 (
u8V
 & 
TRANSITION_TO_NORMAL_MASKED
? 
ue
 : 
l
);

369 
du_n
 +=

370 
	`code_iti_brg
(&
du
[
du_n
],

371 &
b_rg
);

377 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

378 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

379 
du_n
 = -1;

384 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY
) &&

385 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

386 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

387 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

388 
du_n
 = 
BACNET_STATUS_ERROR
;

391  
du_n
;

392 
	}
}

395 
bo
 
	$Nifiti_Css_Wre_Prݔty
(

396 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

398 
NOTIFICATION_CLASS_INFO
 *
CutNify
;

399 
NOTIFICATION_CLASS_INFO
 
TmpNify
;

400 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

401 
bo
 
us
 = 
l
;

402 
iOfft
 = 0;

403 
ut8_t
 
idx
 = 0;

404 
n
 = 0;

408 
CutNify
 =

409 &
NC_Info
[
	`Nifiti_Css_In_To_Index
(
wp_da
->

410 
obje_
)];

413 
n
 =

414 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

415 
wp_da
->
iti_da_n
, &
vue
);

416 i(
n
 < 0) {

418 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

419 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

420  
l
;

422 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY
) &&

423 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

425 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

426 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

427  
l
;

429 
wp_da
->
obje_ݔty
) {

430 
PROP_PRIORITY
:

431 
us
 =

432 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

433 &
wp_da
->
r_ass
, &wp_da->
r_code
);

435 i(
us
) {

436 i(
wp_da
->
y_dex
 == 0) {

437 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

438 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

439 } i(
wp_da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

441 } i(
wp_da
->
y_dex
 <= 3) {

442 
CutNify
->
Priܙy
[
wp_da
->
y_dex
 - 1] =

443 
vue
.
ty
.
Unsigd_I
;

445 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

446 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

451 
PROP_ACK_REQUIRED
:

452 
us
 =

453 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BIT_STRING
,

454 &
wp_da
->
r_ass
, &wp_da->
r_code
);

456 i(
us
) {

457 i(
vue
.
ty
.
B_Sg
.
bs_ud
 == 3) {

458 
CutNify
->
Ack_Requed
 =

459 
vue
.
ty
.
B_Sg
.value[0];

461 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

462 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

467 
PROP_RECIPIENT_LIST
:

469 
	`memt
(&
TmpNify
, 0x00, (
NOTIFICATION_CLASS_INFO
));

472 
iOfft
 < 
wp_da
->
iti_da_n
) {

474 
n
 =

475 
	`ba_decode_iti_da
(&
wp_da
->

476 
iti_da
[
iOfft
], 
wp_da
->
iti_da_n
,

477 &
vue
);

479 i((
n
 == 0) ||

480 (
vue
.
g
 !
BACNET_APPLICATION_TAG_BIT_STRING
)) {

482 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

483 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

484  
l
;

487 i(
vue
.
ty
.
B_Sg
.
bs_ud
 =
MAX_BACNET_DAYS_OF_WEEK
)

489 
TmpNify
.
Rec_Li
[
idx
].
VidDays
 =

490 
vue
.
ty
.
B_Sg
.value[0];

492 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

493 
wp_da
->
r_code
 = 
ERROR_CODE_OTHER
;

494  
l
;

497 
iOfft
 +
n
;

499 
n
 =

500 
	`ba_decode_iti_da
(&
wp_da
->

501 
iti_da
[
iOfft
], 
wp_da
->
iti_da_n
,

502 &
vue
);

504 i((
n
 =0|| (
vue
.
g
 !
BACNET_APPLICATION_TAG_TIME
)) {

506 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

507 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

508  
l
;

511 
TmpNify
.
Rec_Li
[
idx
].
FromTime
 = 
vue
.
ty
.
Time
;

513 
iOfft
 +
n
;

515 
n
 =

516 
	`ba_decode_iti_da
(&
wp_da
->

517 
iti_da
[
iOfft
], 
wp_da
->
iti_da_n
,

518 &
vue
);

520 i((
n
 =0|| (
vue
.
g
 !
BACNET_APPLICATION_TAG_TIME
)) {

522 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

523 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

524  
l
;

527 
TmpNify
.
Rec_Li
[
idx
].
ToTime
 = 
vue
.
ty
.
Time
;

529 
iOfft
 +
n
;

531 i(
	`decode_is_cڋxt_g
(&
wp_da
->
iti_da
[
iOfft
],

533 
TmpNify
.
Rec_Li
[
idx
].
Rec
.
RecTy
 =

534 
RECIPIENT_TYPE_DEVICE
;

536 
n
 =

537 
	`ba_decode_cڋxt_da
(&
wp_da
->

538 
iti_da
[
iOfft
],

539 
wp_da
->
iti_da_n
, &
vue
,

540 
PROP_RECIPIENT_LIST
);

542 i((
n
 == 0) ||

543 (
vue
.
g
 !
BACNET_APPLICATION_TAG_OBJECT_ID
)) {

545 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

546 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

547  
l
;

550 
TmpNify
.
Rec_Li
[
idx
].
Rec
.
_
.

551 
DeviIdtifr
 = 
vue
.
ty
.
Obje_Id
.

;

553 
iOfft
 +
n
;

556 i(
	`decode_is_ݒg_g_numb
(&
wp_da
->

557 
iti_da
[
iOfft
], 1)) {

558 
iOfft
++;

559 
TmpNify
.
Rec_Li
[
idx
].
Rec
.
RecTy
 =

560 
RECIPIENT_TYPE_ADDRESS
;

562 
n
 =

563 
	`ba_decode_iti_da
(&
wp_da
->

564 
iti_da
[
iOfft
],

565 
wp_da
->
iti_da_n
, &
vue
);

567 i((
n
 == 0) ||

568 (
vue
.
g
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
)) {

570 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

571 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

572  
l
;

575 
TmpNify
.
Rec_Li
[
idx
].
Rec
.
_
.
Addss
.
t
 =

576 
vue
.
ty
.
Unsigd_I
;

578 
iOfft
 +
n
;

580 
n
 =

581 
	`ba_decode_iti_da
(&
wp_da
->

582 
iti_da
[
iOfft
],

583 
wp_da
->
iti_da_n
, &
vue
);

585 i((
n
 == 0) ||

586 (
vue
.
g
 !
BACNET_APPLICATION_TAG_OCTET_STRING
)) {

588 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

589 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

590  
l
;

593 i(
TmpNify
.
Rec_Li
[
idx
].
Rec
.
_
.
Addss
.

594 
t
 == 0) {

595 
	`memy
(
TmpNify
.
Rec_Li
[
idx
].
Rec
.
_
.

596 
Addss
.
mac
, 
vue
.
ty
.
O_Sg
.value,

597 
vue
.
ty
.
O_Sg
.
ngth
);

598 
TmpNify
.
Rec_Li
[
idx
].
Rec
.
_
.
Addss
.

599 
mac_n
 = 
vue
.
ty
.
O_Sg
.
ngth
;

601 
	`memy
(
TmpNify
.
Rec_Li
[
idx
].
Rec
.
_
.

602 
Addss
.
adr
, 
vue
.
ty
.
O_Sg
.value,

603 
vue
.
ty
.
O_Sg
.
ngth
);

604 
TmpNify
.
Rec_Li
[
idx
].
Rec
.
_
.
Addss
.
n
 =

605 
vue
.
ty
.
O_Sg
.
ngth
;

608 
iOfft
 +
n
;

610 i(
	`decode_is_osg_g_numb
(&
wp_da
->

611 
iti_da
[
iOfft
], 1))

612 
iOfft
++;

615 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

616 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

617  
l
;

621 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

622 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

623  
l
;

627 
n
 =

628 
	`ba_decode_iti_da
(&
wp_da
->

629 
iti_da
[
iOfft
], 
wp_da
->
iti_da_n
,

630 &
vue
);

632 i((
n
 == 0) ||

633 (
vue
.
g
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
)) {

635 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

636 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

637  
l
;

640 
TmpNify
.
Rec_Li
[
idx
].
ProssIdtifr
 =

641 
vue
.
ty
.
Unsigd_I
;

643 
iOfft
 +
n
;

645 
n
 =

646 
	`ba_decode_iti_da
(&
wp_da
->

647 
iti_da
[
iOfft
], 
wp_da
->
iti_da_n
,

648 &
vue
);

650 i((
n
 == 0) ||

651 (
vue
.
g
 !
BACNET_APPLICATION_TAG_BOOLEAN
)) {

653 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

654 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

655  
l
;

658 
TmpNify
.
Rec_Li
[
idx
].
CfmedNify
 =

659 
vue
.
ty
.
Boޗn
;

661 
iOfft
 +
n
;

663 
n
 =

664 
	`ba_decode_iti_da
(&
wp_da
->

665 
iti_da
[
iOfft
], 
wp_da
->
iti_da_n
,

666 &
vue
);

668 i((
n
 == 0) ||

669 (
vue
.
g
 !
BACNET_APPLICATION_TAG_BIT_STRING
)) {

671 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

672 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

673  
l
;

676 i(
vue
.
ty
.
B_Sg
.
bs_ud
 ==

677 
MAX_BACNET_EVENT_TRANSITION
)

679 
TmpNify
.
Rec_Li
[
idx
].
Tnsis
 =

680 
vue
.
ty
.
B_Sg
.value[0];

682 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

683 
wp_da
->
r_code
 = 
ERROR_CODE_OTHER
;

684  
l
;

686 
iOfft
 +
n
;

689 i(++
idx
 >
NC_MAX_RECIPIENTS
) {

690 
wp_da
->
r_ass
 = 
ERROR_CLASS_RESOURCES
;

691 
wp_da
->
r_code
 =

692 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

693  
l
;

699 
idx
 = 0; idx < 
NC_MAX_RECIPIENTS
; idx++) {

700 
BACNET_ADDRESS
 
c
 = { 0 };

701 
max_du
 = 0;

702 
t32_t
 
DeviID
;

704 
CutNify
->
Rec_Li
[
idx
] =

705 
TmpNify
.
Rec_Li
[
idx
];

707 i(
CutNify
->
Rec_Li
[
idx
].
Rec
.

708 
RecTy
 =
RECIPIENT_TYPE_DEVICE
) {

710 
DeviID
 =

711 
CutNify
->
Rec_Li
[
idx
].
Rec
.
_
.

712 
DeviIdtifr
;

713 
	`addss_bd_que
(
DeviID
, &
max_du
, &
c
);

715 } i(
CutNify
->
Rec_Li
[
idx
].
Rec
.

716 
RecTy
 =
RECIPIENT_TYPE_ADDRESS
) {

723 
us
 = 
ue
;

725 
PROP_OBJECT_NAME
:

726 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

727 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

731 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

732 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

736  
us
;

737 
	}
}

740 
	$Nifiti_Css_G_Priܙs
(

741 
ut32_t
 
Obje_In
,

742 
ut32_t
 * 
pPriܙyAay
)

744 
NOTIFICATION_CLASS_INFO
 *
CutNify
;

745 
ut32_t
 
obje_dex
;

746 
i
;

748 
obje_dex
 = 
	`Nifiti_Css_In_To_Index
(
Obje_In
);

750 i(
obje_dex
 < 
MAX_NOTIFICATION_CLASSES
)

751 
CutNify
 = &
NC_Info
[
obje_dex
];

753 
i
 = 0; i < 3; i++)

754 
pPriܙyAay
[
i
] = 255;

758 
i
 = 0; i < 3; i++)

759 
pPriܙyAay
[
i
] = 
CutNify
->
Priܙy
[i];

760 
	}
}

763 
bo
 
	$IsRecAive
(

764 
BACNET_DESTINATION
 * 
pBacDe
,

765 
ut8_t
 
EvtToS
)

767 
BACNET_DATE_TIME
 
DeTime
;

770 
EvtToS
) {

771 
EVENT_STATE_OFFNORMAL
:

772 
EVENT_STATE_HIGH_LIMIT
:

773 
EVENT_STATE_LOW_LIMIT
:

774 i(!(
pBacDe
->
Tnsis
 & 
TRANSITION_TO_OFFNORMAL_MASKED
))

775  
l
;

778 
EVENT_STATE_FAULT
:

779 i(!(
pBacDe
->
Tnsis
 & 
TRANSITION_TO_FAULT_MASKED
))

780  
l
;

783 
EVENT_STATE_NORMAL
:

784 i(!(
pBacDe
->
Tnsis
 & 
TRANSITION_TO_NORMAL_MASKED
))

785  
l
;

789  
l
;

793 
	`Devi_gCutDeTime
(&
DeTime
);

796 i(!((0x01 << (
DeTime
.
de
.
wday
 - 1)& 
pBacDe
->
VidDays
))

797  
l
;

800 i(
	`dime_com_time
(&
DeTime
.
time
, &
pBacDe
->
FromTime
) < 0)

801  
l
;

804 i(
	`dime_com_time
(&
pBacDe
->
ToTime
, &
DeTime
.
time
) < 0)

805  
l
;

807  
ue
;

808 
	}
}

811 
	$Nifiti_Css_comm_ptg_funi
(

812 
BACNET_EVENT_NOTIFICATION_DATA
 * 
evt_da
)

816 
NOTIFICATION_CLASS_INFO
 *
CutNify
;

817 
BACNET_DESTINATION
 *
pBacDe
;

818 
ut32_t
 
nify_dex
;

819 
ut8_t
 
dex
;

822 
nify_dex
 =

823 
	`Nifiti_Css_In_To_Index
(
evt_da
->
nifitiCss
);

825 i(
nify_dex
 < 
MAX_NOTIFICATION_CLASSES
)

826 
CutNify
 = &
NC_Info
[
nify_dex
];

832 
evt_da
->
tgObjeIdtifr
.
ty
 = 
OBJECT_DEVICE
;

833 
evt_da
->
tgObjeIdtifr
.

 =

834 
	`Devi_Obje_In_Numb
();

837 
evt_da
->
toS
) {

838 
EVENT_STATE_NORMAL
:

839 
evt_da
->
iܙy
 =

840 
CutNify
->
Priܙy
[
TRANSITION_TO_NORMAL
];

841 
evt_da
->
ackRequed
 =

842 (
CutNify
->

843 
Ack_Requed
 & 
TRANSITION_TO_NORMAL_MASKED
? 
ue
 : 
l
;

846 
EVENT_STATE_FAULT
:

847 
evt_da
->
iܙy
 =

848 
CutNify
->
Priܙy
[
TRANSITION_TO_FAULT
];

849 
evt_da
->
ackRequed
 =

850 (
CutNify
->

851 
Ack_Requed
 & 
TRANSITION_TO_FAULT_MASKED
? 
ue
 : 
l
;

854 
EVENT_STATE_OFFNORMAL
:

855 
EVENT_STATE_HIGH_LIMIT
:

856 
EVENT_STATE_LOW_LIMIT
:

857 
evt_da
->
iܙy
 =

858 
CutNify
->
Priܙy
[
TRANSITION_TO_OFFNORMAL
];

859 
evt_da
->
ackRequed
 =

860 (
CutNify
->
Ack_Requed
 & 
TRANSITION_TO_OFFNORMAL_MASKED
)

861 ? 
ue
 : 
l
;

870 
pBacDe
 = &
CutNify
->
Rec_Li
[0];

871 
dex
 = 0; index < 
NC_MAX_RECIPIENTS
; index++, 
pBacDe
++) {

873 i(
pBacDe
->
Rec
.
RecTy
 =
RECIPIENT_TYPE_NOTINITIALIZED
)

876 i(
	`IsRecAive
(
pBacDe
, 
evt_da
->
toS
=
ue
) {

877 
BACNET_ADDRESS
 
de
;

878 
ut32_t
 
devi_id
;

879 
max_du
;

882 
evt_da
->
ossIdtifr
 = 
pBacDe
->
ProssIdtifr
;

885 i(
pBacDe
->
Rec
.
RecTy
 =
RECIPIENT_TYPE_DEVICE
) {

887 
devi_id
 = 
pBacDe
->
Rec
.
_
.
DeviIdtifr
;

889 i(
pBacDe
->
CfmedNify
 =
ue
)

890 
	`Sd_CEvt_Nify
(
devi_id
, 
evt_da
);

891 i(
	`addss_g_by_devi
(
devi_id
, &
max_du
, &
de
))

892 
	`Sd_UEvt_Nify
(
Hdr_Tnsm_Bufr
, 
evt_da
,

893 &
de
);

894 } i(
pBacDe
->
Rec
.
RecTy
 ==

895 
RECIPIENT_TYPE_ADDRESS
) {

897 i(
pBacDe
->
CfmedNify
 =
ue
) {

898 i(
	`addss_g_devi_id
(&
de
, &
devi_id
))

899 
	`Sd_CEvt_Nify
(
devi_id
, 
evt_da
);

901 
de
 = 
pBacDe
->
Rec
.
_
.
Addss
;

902 
	`Sd_UEvt_Nify
(
Hdr_Tnsm_Bufr
, 
evt_da
,

903 &
de
);

908 
	}
}

912 
	$Nifiti_Css_fd_c
(

915 
NOTIFICATION_CLASS_INFO
 *
CutNify
;

916 
BACNET_DESTINATION
 *
pBacDe
;

917 
BACNET_ADDRESS
 
c
 = { 0 };

918 
max_du
 = 0;

919 
ut32_t
 
nify_dex
;

920 
ut32_t
 
DeviID
;

921 
ut8_t
 
idx
;

924 
nify_dex
 = 0;ify_dex < 
MAX_NOTIFICATION_CLASSES
;

925 
nify_dex
++) {

927 
CutNify
 =

928 &
NC_Info
[
	`Nifiti_Css_In_To_Index
(
nify_dex
)];

930 
pBacDe
 = &
CutNify
->
Rec_Li
[0];

931 
idx
 = 0; idx < 
NC_MAX_RECIPIENTS
; idx++, 
pBacDe
++) {

932 i(
CutNify
->
Rec_Li
[
idx
].
Rec
.
RecTy
 ==

933 
RECIPIENT_TYPE_DEVICE
) {

935 
DeviID
 =

936 
CutNify
->
Rec_Li
[
idx
].
Rec
.
_
.

937 
DeviIdtifr
;

939 i(!
	`addss_bd_que
(
DeviID
, &
max_du
, &
c
))

940 
	`Sd_WhoIs
(
DeviID
, DeviceID);

941 } i(
CutNify
->
Rec_Li
[
idx
].
Rec
.

942 
RecTy
 =
RECIPIENT_TYPE_ADDRESS
) {

947 
	}
}

	@demo/object/nc.h

25 #ide
NC_H


26 
	#NC_H


	)

28 
	~"evt.h
"

31 #ifde
__lulus


36 
	#NC_RESCAN_RECIPIENTS_SECS
 60

	)

39 
	#NC_MAX_RECIPIENTS
 10

	)

42 
RECIPIENT_TYPE_NOTINITIALIZED
 = 0,

43 
RECIPIENT_TYPE_DEVICE
 = 1,

44 
RECIPIENT_TYPE_ADDRESS
 = 2

45 } 
	tNC_RECIPIENT_TYPE
;

48 #i
defed
(
INTRINSIC_REPORTING
)

56 
	sBACt_Rec
 {

57 
ut8_t
 
RecTy
;

59 
ut32_t
 
DeviIdtifr
;

60 
BACNET_ADDRESS
 
Addss
;

61 } 
_
;

62 } 
	tBACNET_RECIPIENT
;

66 
	sBACt_Dei
 {

67 
ut8_t
 
VidDays
;

68 
BACNET_TIME
 
FromTime
;

69 
BACNET_TIME
 
ToTime
;

70 
BACNET_RECIPIENT
 
Rec
;

71 
ut32_t
 
ProssIdtifr
;

72 
ut8_t
 
Tnsis
;

73 
bo
 
CfmedNify
;

74 } 
	tBACNET_DESTINATION
;

78 
	sNifiti_Css_fo
 {

79 
ut8_t
 
Priܙy
[
MAX_BACNET_EVENT_TRANSITION
];

80 
ut8_t
 
Ack_Requed
;

81 
BACNET_DESTINATION
 
Rec_Li
[
NC_MAX_RECIPIENTS
];

82 } 
	tNOTIFICATION_CLASS_INFO
;

86 
	sAcked_fo
 {

87 
bo
 
bIsAcked
;

88 
BACNET_DATE_TIME
 
Time_Smp
;

89 } 
	tACKED_INFO
;

93 
	sAck_Nifiti
 {

94 
bo
 
bSdAckNify
;

95 
ut8_t
 
EvtS
;

96 } 
	tACK_NOTIFICATION
;

100 
Nifiti_Css_Prݔty_Lis
(

101 cڡ **
pRequed
,

102 cڡ **
pOiڮ
,

103 cڡ **
pPrrry
);

105 
Nifiti_Css_In
(

108 
bo
 
Nifiti_Css_Vid_In
(

109 
ut32_t
 
obje_
);

110 
Nifiti_Css_Cou
(

112 
ut32_t
 
Nifiti_Css_Index_To_In
(

113 
dex
);

114 
Nifiti_Css_In_To_Index
(

115 
ut32_t
 
obje_
);

116 
bo
 
Nifiti_Css_Obje_Name
(

117 
ut32_t
 
obje_
,

118 
BACNET_CHARACTER_STRING
 * 
obje_me
);

120 
Nifiti_Css_Rd_Prݔty
(

121 
BACNET_READ_PROPERTY_DATA
 * 
da
);

123 
bo
 
Nifiti_Css_Wre_Prݔty
(

124 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

126 
Nifiti_Css_G_Priܙs
(

127 
ut32_t
 
Obje_In
,

128 
ut32_t
 * 
pPriܙyAay
);

130 
Nifiti_Css_comm_ptg_funi
(

131 
BACNET_EVENT_NOTIFICATION_DATA
 * 
evt_da
);

133 
Nifiti_Css_fd_c
(

138 #ifde
__lulus


	@demo/object/osv.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~<rg.h
>

33 
	~"bacdef.h
"

34 
	~"bacdcode.h
"

35 
	~"banum.h
"

36 
	~"ba.h
"

37 
	~"baext.h
"

38 
	~"cfig.h
"

39 
	~"devi.h
"

40 
	~"hdrs.h
"

41 
	~"osv.h
"

44 #ide
MAX_OCTETSTRING_VALUES


45 
	#MAX_OCTETSTRING_VALUES
 4

	)

48 
OCTETSTRING_VALUE_DESCR
 
	gAV_Des
[
MAX_OCTETSTRING_VALUES
];

51 cڡ 
	gOSg_Vue_Prݔts_Requed
[] = {

52 
PROP_OBJECT_IDENTIFIER
,

53 
PROP_OBJECT_NAME
,

54 
PROP_OBJECT_TYPE
,

55 
PROP_PRESENT_VALUE
,

56 
PROP_STATUS_FLAGS
,

60 cڡ 
	gOSg_Vue_Prݔts_Oiڮ
[] = {

61 
PROP_EVENT_STATE
,

62 
PROP_OUT_OF_SERVICE
,

63 
PROP_DESCRIPTION
,

67 cڡ 
	gOSg_Vue_Prݔts_Prrry
[] = {

71 
	$OSg_Vue_Prݔty_Lis
(cڡ **
pRequed
,

72 cڡ **
pOiڮ
,

73 cڡ **
pPrrry
)

75 i(
pRequed
)

76 *
pRequed
 = 
OSg_Vue_Prݔts_Requed
;

77 i(
pOiڮ
)

78 *
pOiڮ
 = 
OSg_Vue_Prݔts_Oiڮ
;

79 i(
pPrrry
)

80 *
pPrrry
 = 
OSg_Vue_Prݔts_Prrry
;

83 
	}
}

85 
	$OSg_Vue_In
()

87 
i
;

89 
i
 = 0; i < 
MAX_OCTETSTRING_VALUES
; i++) {

90 
	`memt
(&
AV_Des
[
i
], 0x00, (
OCTETSTRING_VALUE_DESCR
));

91 
	`org_
(&
AV_Des
[
i
].
P_Vue
, 
NULL
, 0);

93 
	}
}

98 
bo
 
	$OSg_Vue_Vid_In
(
ut32_t
 
obje_
)

100 i(
obje_
 < 
MAX_OCTETSTRING_VALUES
)

101  
ue
;

103  
l
;

104 
	}
}

108 
	$OSg_Vue_Cou
()

110  
MAX_OCTETSTRING_VALUES
;

111 
	}
}

116 
ut32_t
 
	$OSg_Vue_Index_To_In
(
dex
)

118  
dex
;

119 
	}
}

124 
	$OSg_Vue_In_To_Index
(
ut32_t
 
obje_
)

126 
dex
 = 
MAX_OCTETSTRING_VALUES
;

128 i(
obje_
 < 
MAX_OCTETSTRING_VALUES
)

129 
dex
 = 
obje_
;

131  
dex
;

132 
	}
}

144 
bo
 
	$OSg_Vue_P_Vue_S
(
ut32_t
 
obje_
,

145 
BACNET_OCTET_STRING
 * 
vue
,

146 
ut8_t
 
iܙy
)

148 
dex
 = 0;

149 
bo
 
us
 = 
l
;

151 
dex
 = 
	`OSg_Vue_In_To_Index
(
obje_
);

152 i(
dex
 < 
MAX_OCTETSTRING_VALUES
) {

153 
	`org_cy
(&
AV_Des
[
dex
].
P_Vue
, 
vue
);

154 
us
 = 
ue
;

156  
us
;

157 
	}
}

159 
BACNET_OCTET_STRING
 *
	$OSg_Vue_P_Vue
(
ut32_t
 
obje_
)

161 
BACNET_OCTET_STRING
 *
vue
 = 
NULL
;

162 
dex
 = 0;

164 
dex
 = 
	`OSg_Vue_In_To_Index
(
obje_
);

165 i(
dex
 < 
MAX_OCTETSTRING_VALUES
) {

166 
vue
 = &
AV_Des
[
dex
].
P_Vue
;

169  
vue
;

170 
	}
}

173 
bo
 
	$OSg_Vue_Obje_Name
(
ut32_t
 
obje_
,

174 
BACNET_CHARACTER_STRING
 * 
obje_me
)

176 
xt_rg
[32] = "";

177 
bo
 
us
 = 
l
;

179 i(
obje_
 < 
MAX_OCTETSTRING_VALUES
) {

180 
	`rtf
(
xt_rg
, "OCTETSTRING VALUE %lu",

181 (
obje_
);

182 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

185  
us
;

186 
	}
}

189 
	$OSg_Vue_Rd_Prݔty
(
BACNET_READ_PROPERTY_DATA
 * 
da
)

191 
du_n
 = 0;

192 
BACNET_BIT_STRING
 
b_rg
;

193 
BACNET_CHARACTER_STRING
 
ch_rg
;

194 
BACNET_OCTET_STRING
 *
_vue
 = 
NULL
;

195 
obje_dex
 = 0;

196 
bo
 
e
 = 
l
;

197 
ut8_t
 *
du
 = 
NULL
;

198 
OCTETSTRING_VALUE_DESCR
 *
CutAV
;

200 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

201 (
da
->
iti_da_n
 == 0)) {

205 
du
 = 
da
->
iti_da
;

207 
obje_dex
 =

208 
	`OSg_Vue_In_To_Index
(
da
->
obje_
);

209 i(
obje_dex
 < 
MAX_OCTETSTRING_VALUES
)

210 
CutAV
 = &
AV_Des
[
obje_dex
];

212  
BACNET_STATUS_ERROR
;

214 
da
->
obje_ݔty
) {

215 
PROP_OBJECT_IDENTIFIER
:

216 
du_n
 =

217 
	`code_iti_obje_id
(&
du
[0],

218 
OBJECT_OCTETSTRING_VALUE
, 
da
->
obje_
);

221 
PROP_OBJECT_NAME
:

222 
PROP_DESCRIPTION
:

223 
	`OSg_Vue_Obje_Name
(
da
->
obje_
,

224 &
ch_rg
);

225 
du_n
 =

226 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

229 
PROP_OBJECT_TYPE
:

230 
du_n
 =

231 
	`code_iti_umed
(&
du
[0],

232 
OBJECT_OCTETSTRING_VALUE
);

235 
PROP_PRESENT_VALUE
:

236 
_vue
 =

237 
	`OSg_Vue_P_Vue
(
da
->
obje_
);

238 
du_n
 = 
	`code_iti_o_rg
(&
du
[0], 
_vue
);

241 
PROP_STATUS_FLAGS
:

242 
	`brg_
(&
b_rg
);

243 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

244 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

245 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

246 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
,

247 
CutAV
->
Out_Of_Svi
);

249 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

252 
PROP_EVENT_STATE
:

253 
du_n
 =

254 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

257 
PROP_OUT_OF_SERVICE
:

258 
e
 = 
CutAV
->
Out_Of_Svi
;

259 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

262 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

263 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

264 
du_n
 = 
BACNET_STATUS_ERROR
;

268 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

269 (
da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
) &&

270 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

271 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

272 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

273 
du_n
 = 
BACNET_STATUS_ERROR
;

276  
du_n
;

277 
	}
}

280 
bo
 
	$OSg_Vue_Wre_Prݔty
(
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

282 
bo
 
us
 = 
l
;

283 
obje_dex
 = 0;

284 
n
 = 0;

285 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

286 
OCTETSTRING_VALUE_DESCR
 *
CutAV
;

289 
n
 =

290 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

291 
wp_da
->
iti_da_n
, &
vue
);

293 i(
n
 < 0) {

295 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

296 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

297  
l
;

299 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

300 (
wp_da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
) &&

301 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

303 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

304 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

305  
l
;

307 
obje_dex
 =

308 
	`OSg_Vue_In_To_Index
(
wp_da
->
obje_
);

309 i(
obje_dex
 < 
MAX_OCTETSTRING_VALUES
)

310 
CutAV
 = &
AV_Des
[
obje_dex
];

312  
l
;

314 
wp_da
->
obje_ݔty
) {

315 
PROP_PRESENT_VALUE
:

316 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_OCTET_STRING
) {

320 i(
	`OSg_Vue_P_Vue_S
(
wp_da
->

321 
obje_
, &
vue
.
ty
.
O_Sg
,

322 
wp_da
->
iܙy
)) {

323 
us
 = 
ue
;

324 } i(
wp_da
->
iܙy
 == 6) {

328 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

329 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

331 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

332 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

335 
us
 = 
l
;

336 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

337 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

341 
PROP_OUT_OF_SERVICE
:

342 
us
 =

343 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

344 &
wp_da
->
r_ass
, &wp_da->
r_code
);

345 i(
us
) {

346 
CutAV
->
Out_Of_Svi
 = 
vue
.
ty
.
Boޗn
;

350 
PROP_OBJECT_IDENTIFIER
:

351 
PROP_OBJECT_NAME
:

352 
PROP_OBJECT_TYPE
:

353 
PROP_STATUS_FLAGS
:

354 
PROP_EVENT_STATE
:

355 
PROP_DESCRIPTION
:

356 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

357 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

360 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

361 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

365  
us
;

366 
	}
}

369 
	$OSg_Vue_Irsic_Rtg
(
ut32_t
 
obje_
)

371 
	}
}

373 #ifde
TEST


374 
	~<as.h
>

375 
	~<rg.h
>

376 
	~"e.h
"

378 
bo
 
	$WPVideArgTy
(
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

379 
ut8_t
 
ucExedTag
,

380 
BACNET_ERROR_CLASS
 * 
pECss
,

381 
BACNET_ERROR_CODE
 * 
pECode
)

383 
pVue
 =Value;

384 
ucExedTag
 = ucExpectedTag;

385 
pECss
 =ErrorClass;

386 
pECode
 =ErrorCode;

388  
l
;

389 
	}
}

391 
	$OSg_Vue
(
Te
 * 
pTe
)

393 
BACNET_READ_PROPERTY_DATA
 
da
;

394 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

395 
n
 = 0;

396 
ut32_t
 
n_vue
 = 0;

397 
ut8_t
 
g_numb
 = 0;

398 
ut16_t
 
decoded_ty
 = 0;

399 
ut32_t
 
decoded_
 = 0;

401 
	`OSg_Vue_In
();

402 
da
.
iti_da
 = &
du
[0];

403 
da
.
iti_da_n
 = (
du
);

404 
da
.
obje_ty
 = 
OBJECT_OCTETSTRING_VALUE
;

405 
da
.
obje_
 = 1;

406 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

407 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

408 
n
 = 
	`OSg_Vue_Rd_Prݔty
(&
da
);

409 
	`_
(
pTe
, 
n
 != 0);

410 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

411 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

412 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

413 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

414 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

417 
	}
}

419 #ifde
TEST_OCTETSTRING_VALUE


420 
	$ma
()

422 
Te
 *
pTe
;

423 
bo
 
rc
;

425 
pTe
 = 
	`_
("BACÈOSg Vue", 
NULL
);

427 
rc
 = 
	`_addTeFuni
(
pTe
, 
OSg_Vue
);

428 
	`as
(
rc
);

430 
	`_tSm
(
pTe
, 
dout
);

431 
	`_run
(
pTe
);

432 (
	`_pt
(
pTe
);

433 
	`_deroy
(
pTe
);

436 
	}
}

	@demo/object/osv.h

25 #ide
OSV_H


26 
	#OSV_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~"wp.h
"

33 
	~".h
"

35 #ifde
__lulus


39 
	sorg_vue_des
 {

40 
Evt_S
:3;

41 
bo
 
Out_Of_Svi
;

42 
BACNET_OCTET_STRING
 
P_Vue
;

43 } 
	tOCTETSTRING_VALUE_DESCR
;

46 
OSg_Vue_Prݔty_Lis
(cڡ **
pRequed
,

47 cڡ **
pOiڮ
,

48 cڡ **
pPrrry
);

49 
bo
 
OSg_Vue_Vid_In
(
ut32_t
 
obje_
);

50 
OSg_Vue_Cou
();

51 
ut32_t
 
OSg_Vue_Index_To_In
(
dex
);

52 
OSg_Vue_In_To_Index
(
ut32_t
 
obje_
);

54 
bo
 
OSg_Vue_Obje_Name
(
ut32_t
 
obje_
,

55 
BACNET_CHARACTER_STRING
 * 
obje_me
);

57 
OSg_Vue_Rd_Prݔty
(
BACNET_READ_PROPERTY_DATA
 * 
da
);

59 
bo
 
OSg_Vue_Wre_Prݔty
(
BACNET_WRITE_PROPERTY_DATA
 *

60 
wp_da
);

62 
bo
 
OSg_Vue_P_Vue_S
(
ut32_t
 
obje_
,

63 
BACNET_OCTET_STRING
 * 
vue
,

64 
ut8_t
 
iܙy
);

65 
BACNET_OCTET_STRING
 *
OSg_Vue_P_Vue
(
ut32_t


66 
obje_
);

68 
bo
 
OSg_Vue_Chge_Of_Vue
(
ut32_t
 

);

69 
OSg_Vue_Chge_Of_Vue_Cˬ
(
ut32_t
 

);

70 
bo
 
OSg_Vue_Encode_Vue_Li
(
ut32_t
 
obje_
,

71 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

73 *
OSg_Vue_Desti
(
ut32_t
 

);

74 
bo
 
OSg_Vue_Desti_S
(
ut32_t
 

,

75 *
w_me
);

77 
bo
 
OSg_Vue_Out_Of_Svi
(
ut32_t
 

);

78 
OSg_Vue_Out_Of_Svi_S
(
ut32_t
 

,

79 
bo
 
oos_ag
);

83 
OSg_Vue_Irsic_Rtg
(
ut32_t
 
obje_
);

85 
OSg_Vue_In
();

87 #ifde
TEST


88 
	~"e.h
"

89 
OSg_Vue
(
Te
 * 
pTe
);

92 #ifde
__lulus


	@demo/object/piv.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~<rg.h
>

33 
	~"bacdef.h
"

34 
	~"bacdcode.h
"

35 
	~"banum.h
"

36 
	~"ba.h
"

37 
	~"baext.h
"

38 
	~"cfig.h
"

39 
	~"devi.h
"

40 
	~"hdrs.h
"

41 
	~"piv.h
"

44 #ide
MAX_POSITIVEINTEGER_VALUES


45 
	#MAX_POSITIVEINTEGER_VALUES
 4

	)

48 
POSITIVEINTEGER_VALUE_DESCR
 
	gPIV_Des
[
MAX_POSITIVEINTEGER_VALUES
];

51 cڡ 
	gPosiveIeg_Vue_Prݔts_Requed
[] = {

52 
PROP_OBJECT_IDENTIFIER
,

53 
PROP_OBJECT_NAME
,

54 
PROP_OBJECT_TYPE
,

55 
PROP_PRESENT_VALUE
,

56 
PROP_STATUS_FLAGS
,

57 
PROP_UNITS
,

61 cڡ 
	gPosiveIeg_Vue_Prݔts_Oiڮ
[] = {

62 
PROP_OUT_OF_SERVICE
,

66 cڡ 
	gPosiveIeg_Vue_Prݔts_Prrry
[] = {

70 
	$PosiveIeg_Vue_Prݔty_Lis
(cڡ **
pRequed
,

71 cڡ **
pOiڮ
,

72 cڡ **
pPrrry
)

74 i(
pRequed
)

75 *
pRequed
 = 
PosiveIeg_Vue_Prݔts_Requed
;

76 i(
pOiڮ
)

77 *
pOiڮ
 = 
PosiveIeg_Vue_Prݔts_Oiڮ
;

78 i(
pPrrry
)

79 *
pPrrry
 = 
PosiveIeg_Vue_Prݔts_Prrry
;

82 
	}
}

84 
	$PosiveIeg_Vue_In
()

86 
i
;

88 
i
 = 0; i < 
MAX_POSITIVEINTEGER_VALUES
; i++) {

89 
	`memt
(&
PIV_Des
[
i
], 0x00, (
POSITIVEINTEGER_VALUE_DESCR
));

91 
	}
}

96 
bo
 
	$PosiveIeg_Vue_Vid_In
(
ut32_t
 
obje_
)

98 i(
obje_
 < 
MAX_POSITIVEINTEGER_VALUES
)

99  
ue
;

101  
l
;

102 
	}
}

106 
	$PosiveIeg_Vue_Cou
()

108  
MAX_POSITIVEINTEGER_VALUES
;

109 
	}
}

114 
ut32_t
 
	$PosiveIeg_Vue_Index_To_In
(
dex
)

116  
dex
;

117 
	}
}

122 
	$PosiveIeg_Vue_In_To_Index
(
ut32_t
 
obje_
)

124 
dex
 = 
MAX_POSITIVEINTEGER_VALUES
;

126 i(
obje_
 < 
MAX_POSITIVEINTEGER_VALUES
)

127 
dex
 = 
obje_
;

129  
dex
;

130 
	}
}

142 
bo
 
	$PosiveIeg_Vue_P_Vue_S
(
ut32_t
 
obje_
,

143 
ut32_t
 
vue
,

144 
ut8_t
 
iܙy
)

146 
dex
 = 0;

147 
bo
 
us
 = 
l
;

149 
dex
 = 
	`PosiveIeg_Vue_In_To_Index
(
obje_
);

150 i(
dex
 < 
MAX_POSITIVEINTEGER_VALUES
) {

151 
PIV_Des
[
dex
].
P_Vue
 = 
vue
;

152 
us
 = 
ue
;

154  
us
;

155 
	}
}

157 
ut32_t
 
	$PosiveIeg_Vue_P_Vue
(
ut32_t
 
obje_
)

159 
ut32_t
 
vue
 = 0;

160 
dex
 = 0;

162 
dex
 = 
	`PosiveIeg_Vue_In_To_Index
(
obje_
);

163 i(
dex
 < 
MAX_POSITIVEINTEGER_VALUES
) {

164 
vue
 = 
PIV_Des
[
dex
].
P_Vue
;

167  
vue
;

168 
	}
}

171 
bo
 
	$PosiveIeg_Vue_Obje_Name
(
ut32_t
 
obje_
,

172 
BACNET_CHARACTER_STRING
 * 
obje_me
)

174 
xt_rg
[32] = "";

175 
bo
 
us
 = 
l
;

177 i(
obje_
 < 
MAX_POSITIVEINTEGER_VALUES
) {

178 
	`rtf
(
xt_rg
, "POSITIVEINTEGER VALUE %lu",

179 (
obje_
);

180 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

183  
us
;

184 
	}
}

187 
	$PosiveIeg_Vue_Rd_Prݔty
(
BACNET_READ_PROPERTY_DATA
 * 
da
)

189 
du_n
 = 0;

190 
BACNET_BIT_STRING
 
b_rg
;

191 
BACNET_CHARACTER_STRING
 
ch_rg
;

192 
obje_dex
 = 0;

193 
bo
 
e
 = 
l
;

194 
ut8_t
 *
du
 = 
NULL
;

195 
POSITIVEINTEGER_VALUE_DESCR
 *
CutAV
;

197 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

198 (
da
->
iti_da_n
 == 0)) {

202 
du
 = 
da
->
iti_da
;

204 
obje_dex
 =

205 
	`PosiveIeg_Vue_In_To_Index
(
da
->
obje_
);

206 i(
obje_dex
 < 
MAX_POSITIVEINTEGER_VALUES
)

207 
CutAV
 = &
PIV_Des
[
obje_dex
];

209  
BACNET_STATUS_ERROR
;

211 
da
->
obje_ݔty
) {

212 
PROP_OBJECT_IDENTIFIER
:

213 
du_n
 =

214 
	`code_iti_obje_id
(&
du
[0],

215 
OBJECT_POSITIVE_INTEGER_VALUE
, 
da
->
obje_
);

218 
PROP_OBJECT_NAME
:

219 
	`PosiveIeg_Vue_Obje_Name
(
da
->
obje_
,

220 &
ch_rg
);

221 
du_n
 =

222 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

225 
PROP_OBJECT_TYPE
:

226 
du_n
 =

227 
	`code_iti_umed
(&
du
[0],

228 
OBJECT_POSITIVE_INTEGER_VALUE
);

231 
PROP_PRESENT_VALUE
:

232 
du_n
 =

233 
	`code_iti_unsigd
(&
du
[0],

234 
	`PosiveIeg_Vue_P_Vue
(
da
->
obje_
));

237 
PROP_STATUS_FLAGS
:

238 
	`brg_
(&
b_rg
);

239 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

240 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

241 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

242 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
,

243 
CutAV
->
Out_Of_Svi
);

245 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

248 
PROP_UNITS
:

249 
du_n
 =

250 
	`code_iti_umed
(&
du
[0], 
CutAV
->
Uns
);

253 
PROP_OUT_OF_SERVICE
:

254 
e
 = 
CutAV
->
Out_Of_Svi
;

255 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

258 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

259 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

260 
du_n
 = 
BACNET_STATUS_ERROR
;

264 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

265 (
da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
) &&

266 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

267 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

268 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

269 
du_n
 = 
BACNET_STATUS_ERROR
;

272  
du_n
;

273 
	}
}

276 
bo
 
	$PosiveIeg_Vue_Wre_Prݔty
(
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

278 
bo
 
us
 = 
l
;

279 
obje_dex
 = 0;

280 
n
 = 0;

281 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

282 
POSITIVEINTEGER_VALUE_DESCR
 *
CutAV
;

285 
n
 =

286 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

287 
wp_da
->
iti_da_n
, &
vue
);

289 i(
n
 < 0) {

291 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

292 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

293  
l
;

295 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

296 (
wp_da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
) &&

297 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

299 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

300 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

301  
l
;

303 
obje_dex
 =

304 
	`PosiveIeg_Vue_In_To_Index
(
wp_da
->
obje_
);

305 i(
obje_dex
 < 
MAX_POSITIVEINTEGER_VALUES
)

306 
CutAV
 = &
PIV_Des
[
obje_dex
];

308  
l
;

310 
wp_da
->
obje_ݔty
) {

311 
PROP_PRESENT_VALUE
:

312 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

316 i(
	`PosiveIeg_Vue_P_Vue_S
(
wp_da
->

317 
obje_
, 
vue
.
ty
.
Unsigd_I
,

318 
wp_da
->
iܙy
)) {

319 
us
 = 
ue
;

320 } i(
wp_da
->
iܙy
 == 6) {

324 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

325 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

327 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

328 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

331 
us
 = 
l
;

332 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

333 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

337 
PROP_OUT_OF_SERVICE
:

338 
us
 =

339 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

340 &
wp_da
->
r_ass
, &wp_da->
r_code
);

341 i(
us
) {

342 
CutAV
->
Out_Of_Svi
 = 
vue
.
ty
.
Boޗn
;

346 
PROP_OBJECT_IDENTIFIER
:

347 
PROP_OBJECT_NAME
:

348 
PROP_OBJECT_TYPE
:

349 
PROP_STATUS_FLAGS
:

350 
PROP_UNITS
:

351 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

352 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

355 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

356 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

360  
us
;

361 
	}
}

364 
	$PosiveIeg_Vue_Irsic_Rtg
(
ut32_t
 
obje_
)

366 
	}
}

368 #ifde
TEST


369 
	~<as.h
>

370 
	~<rg.h
>

371 
	~"e.h
"

373 
bo
 
	$WPVideArgTy
(
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

374 
ut8_t
 
ucExedTag
,

375 
BACNET_ERROR_CLASS
 * 
pECss
,

376 
BACNET_ERROR_CODE
 * 
pECode
)

378 
pVue
 =Value;

379 
ucExedTag
 = ucExpectedTag;

380 
pECss
 =ErrorClass;

381 
pECode
 =ErrorCode;

383  
l
;

384 
	}
}

386 
	$PosiveIeg_Vue
(
Te
 * 
pTe
)

388 
BACNET_READ_PROPERTY_DATA
 
da
;

389 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

390 
n
 = 0;

391 
ut32_t
 
n_vue
 = 0;

392 
ut8_t
 
g_numb
 = 0;

393 
ut16_t
 
decoded_ty
 = 0;

394 
ut32_t
 
decoded_
 = 0;

396 
	`PosiveIeg_Vue_In
();

397 
da
.
iti_da
 = &
du
[0];

398 
da
.
iti_da_n
 = (
du
);

399 
da
.
obje_ty
 = 
OBJECT_POSITIVE_INTEGER_VALUE
;

400 
da
.
obje_
 = 1;

401 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

402 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

403 
n
 = 
	`PosiveIeg_Vue_Rd_Prݔty
(&
da
);

404 
	`_
(
pTe
, 
n
 != 0);

405 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

406 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

407 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

408 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

409 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

412 
	}
}

414 #ifde
TEST_POSITIVEINTEGER_VALUE


415 
	$ma
()

417 
Te
 *
pTe
;

418 
bo
 
rc
;

420 
pTe
 = 
	`_
("BACÈPosiveIeg Vue", 
NULL
);

422 
rc
 = 
	`_addTeFuni
(
pTe
, 
PosiveIeg_Vue
);

423 
	`as
(
rc
);

425 
	`_tSm
(
pTe
, 
dout
);

426 
	`_run
(
pTe
);

427 (
	`_pt
(
pTe
);

428 
	`_deroy
(
pTe
);

431 
	}
}

	@demo/object/piv.h

25 #ide
PIV_H


26 
	#PIV_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~"wp.h
"

33 
	~".h
"

35 #ifde
__lulus


39 
	sposiveg_vue_des
 {

40 
bo
 
Out_Of_Svi
:1;

41 
ut32_t
 
P_Vue
;

42 
ut16_t
 
Uns
;

43 } 
	tPOSITIVEINTEGER_VALUE_DESCR
;

46 
PosiveIeg_Vue_Prݔty_Lis
(cڡ **
pRequed
,

47 cڡ **
pOiڮ
,

48 cڡ **
pPrrry
);

49 
bo
 
PosiveIeg_Vue_Vid_In
(
ut32_t
 
obje_
);

50 
PosiveIeg_Vue_Cou
();

51 
ut32_t
 
PosiveIeg_Vue_Index_To_In
(
dex
);

52 
PosiveIeg_Vue_In_To_Index
(
ut32_t
 
obje_
);

54 
bo
 
PosiveIeg_Vue_Obje_Name
(
ut32_t
 
obje_
,

55 
BACNET_CHARACTER_STRING
 * 
obje_me
);

57 
PosiveIeg_Vue_Rd_Prݔty
(
BACNET_READ_PROPERTY_DATA
 *

58 
da
);

60 
bo
 
PosiveIeg_Vue_Wre_Prݔty
(
BACNET_WRITE_PROPERTY_DATA
 *

61 
wp_da
);

63 
bo
 
PosiveIeg_Vue_P_Vue_S
(
ut32_t
 
obje_
,

64 
ut32_t
 
vue
,

65 
ut8_t
 
iܙy
);

66 
ut32_t
 
PosiveIeg_Vue_P_Vue
(ut32_
obje_
);

68 
bo
 
PosiveIeg_Vue_Chge_Of_Vue
(
ut32_t
 

);

69 
PosiveIeg_Vue_Chge_Of_Vue_Cˬ
(
ut32_t
 

);

70 
bo
 
PosiveIeg_Vue_Encode_Vue_Li
(
ut32_t
 
obje_
,

71 
BACNET_PROPERTY_VALUE
 * 
vue_li
);

73 *
PosiveIeg_Vue_Desti
(
ut32_t
 

);

74 
bo
 
PosiveIeg_Vue_Desti_S
(
ut32_t
 

,

75 *
w_me
);

77 
bo
 
PosiveIeg_Vue_Out_Of_Svi
(
ut32_t
 

);

78 
PosiveIeg_Vue_Out_Of_Svi_S
(
ut32_t
 

,

79 
bo
 
oos_ag
);

83 
PosiveIeg_Vue_Irsic_Rtg
(
ut32_t
 
obje_
);

85 
PosiveIeg_Vue_In
();

87 #ifde
TEST


88 
	~"e.h
"

89 
PosiveIeg_Vue
(
Te
 * 
pTe
);

92 #ifde
__lulus


	@demo/object/schedule.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

29 
	~"bacdef.h
"

30 
	~"bacdcode.h
"

31 
	~"banum.h
"

32 
	~"baext.h
"

33 
	~"cfig.h
"

34 
	~"devi.h
"

35 
	~"hdrs.h
"

36 
	~"li.h
"

37 
	~"timeamp.h
"

38 
	~"schedu.h
"

40 #ide
MAX_SCHEDULES


41 
	#MAX_SCHEDULES
 4

	)

44 
SCHEDULE_DESCR
 
	gSchedu_Des
[
MAX_SCHEDULES
];

46 cڡ 
	gSchedu_Prݔts_Requed
[] = {

47 
PROP_OBJECT_IDENTIFIER
,

48 
PROP_OBJECT_NAME
,

49 
PROP_OBJECT_TYPE
,

50 
PROP_PRESENT_VALUE
,

51 
PROP_EFFECTIVE_PERIOD
,

52 
PROP_SCHEDULE_DEFAULT
,

53 
PROP_LIST_OF_OBJECT_PROPERTY_REFERENCES
,

54 
PROP_PRIORITY_FOR_WRITING
,

55 
PROP_STATUS_FLAGS
,

56 
PROP_RELIABILITY
,

57 
PROP_OUT_OF_SERVICE
,

61 cڡ 
	gSchedu_Prݔts_Oiڮ
[] = {

62 
PROP_WEEKLY_SCHEDULE
,

66 cڡ 
	gSchedu_Prݔts_Prrry
[] = {

70 
	$Schedu_Prݔty_Lis
(cڡ **
pRequed
,

71 cڡ **
pOiڮ
,

72 cڡ **
pPrrry
)

74 i(
pRequed
)

75 *
pRequed
 = 
Schedu_Prݔts_Requed
;

76 i(
pOiڮ
)

77 *
pOiڮ
 = 
Schedu_Prݔts_Oiڮ
;

78 i(
pPrrry
)

79 *
pPrrry
 = 
Schedu_Prݔts_Prrry
;

80 
	}
}

82 
	$Schedu_In
()

84 
i
, 
j
;

85 
i
 = 0; i < 
MAX_SCHEDULES
; i++) {

87 
Schedu_Des
[
i
].
S_De
.
yr
 = 0xFF;

88 
Schedu_Des
[
i
].
S_De
.
mth
 = 1;

89 
Schedu_Des
[
i
].
S_De
.
day
 = 1;

90 
Schedu_Des
[
i
].
S_De
.
wday
 = 0xFF;

91 
Schedu_Des
[
i
].
End_De
.
yr
 = 0xFF;

92 
Schedu_Des
[
i
].
End_De
.
mth
 = 12;

93 
Schedu_Des
[
i
].
End_De
.
day
 = 31;

94 
Schedu_Des
[
i
].
End_De
.
wday
 = 0xFF;

95 
j
 = 0; j < 7; j++) {

96 
Schedu_Des
[
i
].
Wkly_Schedu
[
j
].
TV_Cou
 = 0;

98 
Schedu_Des
[
i
].
P_Vue
 = &Schedu_Des[i].
Schedu_Deu
;

99 
Schedu_Des
[
i
].
Schedu_Deu
.
cڋxt_ecific
 = 
l
;

100 
Schedu_Des
[
i
].
Schedu_Deu
.
g
 = 
BACNET_APPLICATION_TAG_REAL
;

101 
Schedu_Des
[
i
].
Schedu_Deu
.
ty
.
Rl
 = 21.0;

102 
Schedu_Des
[
i
].
obj__f_t
 = 0;

103 
Schedu_Des
[
i
].
Priܙy_F_Wrg
 = 16;

104 
Schedu_Des
[
i
].
Out_Of_Svi
 = 
l
;

106 
	}
}

108 
bo
 
	$Schedu_Vid_In
(
ut32_t
 
obje_
)

110 
dex
 = 
	`Schedu_In_To_Index
(
obje_
);

111 i(
dex
 < 
MAX_SCHEDULES
)

112  
ue
;

114  
l
;

115 
	}
}

117 
	$Schedu_Cou
()

119  
MAX_SCHEDULES
;

120 
	}
}

122 
ut32_t
 
	$Schedu_Index_To_In
(
dex
)

124  
dex
;

125 
	}
}

127 
	$Schedu_In_To_Index
(
ut32_t
 

)

129 
dex
 = 
MAX_SCHEDULES
;

131 i(

 < 
MAX_SCHEDULES
)

132 
dex
 = 

;

134  
dex
;

135 
	}
}

137 
bo
 
	$Schedu_Obje_Name
(
ut32_t
 
obje_
,

138 
BACNET_CHARACTER_STRING
 * 
obje_me
)

140 
xt_rg
[32] = "";

141 
dex
;

142 
bo
 
us
 = 
l
;

144 
dex
 = 
	`Schedu_In_To_Index
(
obje_
);

145 i(
dex
 < 
MAX_SCHEDULES
) {

146 
	`rtf
(
xt_rg
, "SCHEDULE %lu", (
dex
);

147 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

150  
us
;

151 
	}
}

153 
	$Schedu_Out_Of_Svi_S
(

154 
ut32_t
 
obje_
,

155 
bo
 
vue
)

157 
dex
 = 0;

159 
dex
 = 
	`Schedu_In_To_Index
(
obje_
);

160 i(
dex
 < 
MAX_SCHEDULES
) {

161 
Schedu_Des
[
dex
].
Out_Of_Svi
 = 
vue
;

163 
	}
}

165 
	$Schedu_Rd_Prݔty
(
BACNET_READ_PROPERTY_DATA
 * 
da
)

167 
du_n
 = 0;

168 
obje_dex
 = 0;

169 
SCHEDULE_DESCR
 *
CutSC
;

170 
ut8_t
 *
du
 = 
NULL
;

171 
BACNET_BIT_STRING
 
b_rg
;

172 
BACNET_CHARACTER_STRING
 
ch_rg
;

173 
i
;

175 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

176 (
da
->
iti_da_n
 == 0)) {

180 
obje_dex
 = 
	`Schedu_In_To_Index
(
da
->
obje_
);

181 i(
obje_dex
 < 
MAX_SCHEDULES
)

182 
CutSC
 = &
Schedu_Des
[
obje_dex
];

184  
BACNET_STATUS_ERROR
;

186 
du
 = 
da
->
iti_da
;

187 (
da
->
obje_ݔty
) {

188 
PROP_OBJECT_IDENTIFIER
:

189 
du_n
 =

190 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_SCHEDULE
,

191 
da
->
obje_
);

193 
PROP_OBJECT_NAME
:

194 
	`Schedu_Obje_Name
(
da
->
obje_
, &
ch_rg
);

195 
du_n
 =

196 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

198 
PROP_OBJECT_TYPE
:

199 
du_n
 =

200 
	`code_iti_umed
(&
du
[0], 
OBJECT_SCHEDULE
);

202 
PROP_PRESENT_VALUE
:

203 
du_n
 = 
	`ba_code_da
(&
du
[0], 
CutSC
->
P_Vue
);

205 
PROP_EFFECTIVE_PERIOD
:

206 
du_n
 = 
	`code_iti_de
(&
du
[0], &
CutSC
->
S_De
);

207 
du_n
 +=

208 
	`code_iti_de
(&
du
[
du_n
], &
CutSC
->
End_De
);

210 
PROP_WEEKLY_SCHEDULE
:

211 i(
da
->
y_dex
 == 0)

212 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 7);

213 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

214 
day
;

215 
day
 = 0; day < 7; day++) {

216 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 0);

217 
i
 = 0; i < 
CutSC
->
Wkly_Schedu
[
day
].
TV_Cou
;

218 
i
++) {

219 
du_n
 +=

220 
	`ba_code_time_vue
(&
du
[
du_n
],

221 &
CutSC
->
Wkly_Schedu
[
day
].
Time_Vues
[
i
]);

223 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 0);

225 } i(
da
->
y_dex
 <= 7) {

226 
day
 = 
da
->
y_dex
 - 1;

227 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 0);

228 
i
 = 0; i < 
CutSC
->
Wkly_Schedu
[
day
].
TV_Cou
; i++) {

229 
du_n
 +=

230 
	`ba_code_time_vue
(&
du
[
du_n
],

231 &
CutSC
->
Wkly_Schedu
[
day
].
Time_Vues
[
i
]);

233 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 0);

235 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

236 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

237 
du_n
 = 
BACNET_STATUS_ERROR
;

240 
PROP_SCHEDULE_DEFAULT
:

241 
du_n
 =

242 
	`ba_code_da
(&
du
[0], &
CutSC
->
Schedu_Deu
);

244 
PROP_LIST_OF_OBJECT_PROPERTY_REFERENCES
:

245 
i
 = 0; i < 
CutSC
->
obj__f_t
; i++) {

246 
du_n
 +=

247 
	`ba_code_devi_obj_ݔty_f
(&
du
[
du_n
],

248 &
CutSC
->
Obje_Prݔty_Rens
[
i
]);

251 
PROP_PRIORITY_FOR_WRITING
:

252 
du_n
 =

253 
	`code_iti_unsigd
(&
du
[0],

254 
CutSC
->
Priܙy_F_Wrg
);

256 
PROP_STATUS_FLAGS
:

257 
	`brg_
(&
b_rg
);

258 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

259 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

260 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

261 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

262 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

264 
PROP_RELIABILITY
:

265 
du_n
 =

266 
	`code_iti_umed
(&
du
[0],

267 
RELIABILITY_NO_FAULT_DETECTED
);

269 
PROP_OUT_OF_SERVICE
:

270 
du_n
 = 
	`code_iti_boޗn
(&
du
[0],

271 
CutSC
->
Out_Of_Svi
);

274 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

275 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

276 
du_n
 = 
BACNET_STATUS_ERROR
;

280 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_WEEKLY_SCHEDULE
)

281 && (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

282 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

283 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

284 
du_n
 = 
BACNET_STATUS_ERROR
;

287  
du_n
;

288 
	}
}

290 
bo
 
	$Schedu_Wre_Prݔty
(
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

292 
obje_dex
 = 0;

293 
bo
 
us
 = 
l
;

294 
n
 ;

295 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

298 
n
 =

299 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

300 
wp_da
->
iti_da_n
, &
vue
);

302 i(
n
 < 0) {

304 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

305 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

306  
l
;

309 
obje_dex
 = 
	`Schedu_In_To_Index
(
wp_da
->
obje_
);

310 i(
obje_dex
 >
MAX_SCHEDULES
) {

311  
l
;

314 (
wp_da
->
obje_ݔty
) {

315 
PROP_OUT_OF_SERVICE
:

316 
us
 =

317 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

318 &
wp_da
->
r_ass
, &wp_da->
r_code
);

319 i(
us
) {

320 
	`Schedu_Out_Of_Svi_S
(

321 
wp_da
->
obje_
,

322 
vue
.
ty
.
Boޗn
);

325 
PROP_OBJECT_IDENTIFIER
:

326 
PROP_OBJECT_NAME
:

327 
PROP_OBJECT_TYPE
:

328 
PROP_PRESENT_VALUE
:

329 
PROP_EFFECTIVE_PERIOD
:

330 
PROP_WEEKLY_SCHEDULE
:

331 
PROP_SCHEDULE_DEFAULT
:

332 
PROP_LIST_OF_OBJECT_PROPERTY_REFERENCES
:

333 
PROP_PRIORITY_FOR_WRITING
:

334 
PROP_STATUS_FLAGS
:

335 
PROP_RELIABILITY
:

336 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

337 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

340 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

341 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

345  
us
;

346 
	}
}

348 
bo
 
	$Schedu_In_Efive_Piod
(
SCHEDULE_DESCR
 * 
desc
,

349 
BACNET_DATE
 * 
de
)

351 
bo
 
s
 = 
l
;

353 i(
desc
 && 
de
) {

354 i(
	`dime_wdrd_com_de
(&
desc
->
S_De
, 
de
) <= 0 &&

355 
	`dime_wdrd_com_de
(&
desc
->
End_De
, 
de
) >= 0)

356 
s
 = 
ue
;

359  
s
;

360 
	}
}

362 
	$Schedu_Relcuϋ_PV
(
SCHEDULE_DESCR
 * 
desc
,

363 
BACNET_WEEKDAY
 
wday
,

364 
BACNET_TIME
 * 
time
)

366 
i
;

367 
desc
->
P_Vue
 = 
NULL
;

371 
i
 = 0;

372 
i
 < 
desc
->
Wkly_Schedu
[
wday
 - 1].
TV_Cou
 &&

373 
desc
->
P_Vue
 =
NULL
; 
i
++) {

374 
diff
 = 
	`dime_wdrd_com_time
(
time
,

375 &
desc
->
Wkly_Schedu
[
wday
 - 1].
Time_Vues
[
i
].
Time
);

376 i(
diff
 >= 0 &&

377 
desc
->
Wkly_Schedu
[
wday
 - 1].
Time_Vues
[
i
].
Vue
.
g
 !=

378 
BACNET_APPLICATION_TAG_NULL
) {

379 
desc
->
P_Vue
 =

380 &
desc
->
Wkly_Schedu
[
wday
 - 1].
Time_Vues
[
i
].
Vue
;

384 i(
desc
->
P_Vue
 =
NULL
)

385 
desc
->
P_Vue
 = &desc->
Schedu_Deu
;

386 
	}
}

388 #ifde
TEST


389 
	~<as.h
>

390 
	~<rg.h
>

391 
	~"e.h
"

393 
bo
 
	$WPVideArgTy
(

394 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

395 
ut8_t
 
ucExedTag
,

396 
BACNET_ERROR_CLASS
 * 
pECss
,

397 
BACNET_ERROR_CODE
 * 
pECode
)

399 
bo
 
bResu
;

405 
bResu
 = 
ue
;

406 i(
pVue
->
g
 !
ucExedTag
) {

407 
bResu
 = 
l
;

408 *
pECss
 = 
ERROR_CLASS_PROPERTY
;

409 *
pECode
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

412  (
bResu
);

413 
	}
}

415 
	$Schedu
(
Te
 * 
pTe
)

417 
BACNET_READ_PROPERTY_DATA
 
da
;

418 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

419 
n
 = 0;

420 
ut32_t
 
n_vue
 = 0;

421 
ut8_t
 
g_numb
 = 0;

422 
ut16_t
 
decoded_ty
 = 0;

423 
ut32_t
 
decoded_
 = 0;

425 
	`Schedu_In
();

426 
da
.
iti_da
 = &
du
[0];

427 
da
.
iti_da_n
 = (
du
);

428 
da
.
obje_ty
 = 
OBJECT_SCHEDULE
;

429 
da
.
obje_
 = 1;

430 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

431 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

432 
n
 = 
	`Schedu_Rd_Prݔty
(&
da
);

433 
	`_
(
pTe
, 
n
 != 0);

434 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

435 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

436 
n
 = 
	`decode_obje_id
(&
du
[n], &
decoded_ty
, &
decoded_
);

437 
	`_
(
pTe
, 
decoded_ty
 =
da
.
obje_ty
);

438 
	`_
(
pTe
, 
decoded_
 =
da
.
obje_
);

441 
	}
}

444 #ifde
TEST_SCHEDULE


446 
	$ma
()

448 
Te
 *
pTe
;

449 
bo
 
rc
;

451 
pTe
 = 
	`_
("BACÈSchedu", 
NULL
);

453 
rc
 = 
	`_addTeFuni
(
pTe
, 
Schedu
);

454 
	`as
(
rc
);

456 
	`_tSm
(
pTe
, 
dout
);

457 
	`_run
(
pTe
);

458 (
	`_pt
(
pTe
);

459 
	`_deroy
(
pTe
);

462 
	}
}

	@demo/object/schedule.h

26 #ide
SCHEDULE_H


27 
	#SCHEDULE_H


	)

29 
	~<dbo.h
>

30 
	~<dt.h
>

31 
	~"bacdef.h
"

32 
	~"ba.h
"

33 
	~"dime.h
"

34 
	~"ba.h
"

35 
	~"wp.h
"

36 
	~".h
"

37 
	~"bacdevobjݻf.h
"

38 
	~"baimevue.h
"

40 #ide
BACNET_WEEKLY_SCHEDULE_SIZE


41 
	#BACNET_WEEKLY_SCHEDULE_SIZE
 8

	)

44 #ide
BACNET_SCHEDULE_OBJ_PROP_REF_SIZE


45 
	#BACNET_SCHEDULE_OBJ_PROP_REF_SIZE
 4

	)

49 #ifde
__lulus


53 
	sba_day_schedu
 {

54 
BACNET_TIME_VALUE
 
Time_Vues
[
BACNET_WEEKLY_SCHEDULE_SIZE
];

55 
ut16_t
 
TV_Cou
;

56 } 
	tBACNET_DAILY_SCHEDULE
;

58 
	sschedu
 {

60 
BACNET_DATE
 
S_De
;

61 
BACNET_DATE
 
End_De
;

63 
BACNET_DAILY_SCHEDULE
 
Wkly_Schedu
[7];

64 
BACNET_APPLICATION_DATA_VALUE
 
Schedu_Deu
;

65 
BACNET_APPLICATION_DATA_VALUE
 *
P_Vue
;

67 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE


68 
Obje_Prݔty_Rens
[
BACNET_SCHEDULE_OBJ_PROP_REF_SIZE
];

69 
ut8_t
 
obj__f_t
;

70 
ut8_t
 
Priܙy_F_Wrg
;

71 
bo
 
Out_Of_Svi
;

72 } 
	tSCHEDULE_DESCR
;

74 
Schedu_Prݔty_Lis
(cڡ **
pRequed
,

75 cڡ **
pOiڮ
,

76 cڡ **
pPrrry
);

78 
bo
 
Schedu_Vid_In
(
ut32_t
 
obje_
);

79 
Schedu_Cou
();

80 
ut32_t
 
Schedu_Index_To_In
(
dex
);

81 
Schedu_In_To_Index
(
ut32_t
 

);

82 
Schedu_In
();

84 
Schedu_Out_Of_Svi_S
(

85 
ut32_t
 
obje_
,

86 
bo
 
vue
);

87 
bo
 
Schedu_Out_Of_Svi
(

88 
ut32_t
 
obje_
);

90 
bo
 
Schedu_Obje_Name
(
ut32_t
 
obje_
,

91 
BACNET_CHARACTER_STRING
 * 
obje_me
);

93 
Schedu_Rd_Prݔty
(
BACNET_READ_PROPERTY_DATA
 * 
da
);

94 
bo
 
Schedu_Wre_Prݔty
(
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

98 
bo
 
Schedu_In_Efive_Piod
(
SCHEDULE_DESCR
 * 
desc
,

99 
BACNET_DATE
 * 
de
);

100 
Schedu_Relcuϋ_PV
(
SCHEDULE_DESCR
 * 
desc
,

101 
BACNET_WEEKDAY
 
wday
,

102 
BACNET_TIME
 * 
time
);

104 #ifde
__lulus


	@demo/object/trendlog.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<rg.h
>

29 
	~"bacdef.h
"

30 
	~"bacdcode.h
"

31 
	~"banum.h
"

32 
	~"ba.h
"

33 
	~"cfig.h
"

34 
	~"du.h
"

35 
	~"wp.h
"

36 
	~"vsi.h
"

37 
	~"devi.h
"

38 
	~"hdrs.h
"

39 
	~"dk.h
"

40 
	~"addss.h
"

41 
	~"bacdevobjݻf.h
"

42 
	~"dlog.h
"

43 #i
defed
(
BACFILE
)

44 
	~"bacfe.h
"

48 #ide
MAX_TREND_LOGS


49 
	#MAX_TREND_LOGS
 8

	)

52 
TL_DATA_REC
 
	gLogs
[
MAX_TREND_LOGS
][
TL_MAX_ENTRIES
];

53 
TL_LOG_INFO
 
	gLogInfo
[
MAX_TREND_LOGS
];

56 cڡ 
	gTnd_Log_Prݔts_Requed
[] = {

57 
PROP_OBJECT_IDENTIFIER
,

58 
PROP_OBJECT_NAME
,

59 
PROP_OBJECT_TYPE
,

60 
PROP_ENABLE
,

61 
PROP_STOP_WHEN_FULL
,

62 
PROP_BUFFER_SIZE
,

63 
PROP_LOG_BUFFER
,

64 
PROP_RECORD_COUNT
,

65 
PROP_TOTAL_RECORD_COUNT
,

66 
PROP_EVENT_STATE
,

67 
PROP_LOGGING_TYPE
,

68 
PROP_STATUS_FLAGS
,

72 cڡ 
	gTnd_Log_Prݔts_Oiڮ
[] = {

73 
PROP_DESCRIPTION
,

74 
PROP_START_TIME
,

75 
PROP_STOP_TIME
,

76 
PROP_LOG_DEVICE_OBJECT_PROPERTY
,

77 
PROP_LOG_INTERVAL
,

93 
PROP_ALIGN_INTERVALS
,

94 
PROP_INTERVAL_OFFSET
,

95 
PROP_TRIGGER
,

99 cڡ 
	gTnd_Log_Prݔts_Prrry
[] = {

103 
	$Tnd_Log_Prݔty_Lis
(

104 cڡ **
pRequed
,

105 cڡ **
pOiڮ
,

106 cڡ **
pPrrry
)

108 i(
pRequed
)

109 *
pRequed
 = 
Tnd_Log_Prݔts_Requed
;

110 i(
pOiڮ
)

111 *
pOiڮ
 = 
Tnd_Log_Prݔts_Oiڮ
;

112 i(
pPrrry
)

113 *
pPrrry
 = 
Tnd_Log_Prݔts_Prrry
;

116 
	}
}

121 
bo
 
	$Tnd_Log_Vid_In
(

122 
ut32_t
 
obje_
)

124 i(
obje_
 < 
MAX_TREND_LOGS
) {

125  
ue
;

128  
l
;

129 
	}
}

133 
	$Tnd_Log_Cou
(

136  
MAX_TREND_LOGS
;

137 
	}
}

142 
ut32_t
 
	$Tnd_Log_Index_To_In
(

143 
dex
)

145  
dex
;

146 
	}
}

151 
	$Tnd_Log_In_To_Index
(

152 
ut32_t
 
obje_
)

154 
dex
 = 
MAX_TREND_LOGS
;

156 i(
obje_
 < 
MAX_TREND_LOGS
) {

157 
dex
 = 
obje_
;

160  
dex
;

161 
	}
}

167 
	$Tnd_Log_In
(

170 
bo
 
lized
 = 
l
;

171 
iLog
;

172 
iEry
;

173 
tm
 
TempTime
;

174 
time_t
 
tClock
;

176 i(!
lized
) {

177 
lized
 = 
ue
;

181 
iLog
 = 0; iLog < 
MAX_TREND_LOGS
; iLog++) {

197 
TempTime
.
tm_yr
 = 109;

198 
TempTime
.
tm_m
 = 
iLog
 + 1;

199 
TempTime
.
tm_mday
 = 1;

200 
TempTime
.
tm_hour
 = 0;

201 
TempTime
.
tm_m
 = 0;

202 
TempTime
.
tm_c
 = 0;

203 
tClock
 = 
	`mktime
(&
TempTime
);

205 
iEry
 = 0; iEry < 
TL_MAX_ENTRIES
; iEntry++) {

206 
Logs
[
iLog
][
iEry
].
tTimeSmp
 = 
tClock
;

207 
Logs
[
iLog
][
iEry
].
ucRecTy
 = 
TL_TYPE_REAL
;

208 
Logs
[
iLog
][
iEry
].
Dum
.
fRl
 =

209 ((
iEry
 + (
iLog
 * 
TL_MAX_ENTRIES
));

211 i((
iLog
 & 1) == 0)

212 
Logs
[
iLog
][
iEry
].
ucStus
 = 128;

214 
Logs
[
iLog
][
iEry
].
ucStus
 = 0;

215 
tClock
 += 900;

218 
LogInfo
[
iLog
].
tLaDaTime
 = 
tClock
 - 900;

219 
LogInfo
[
iLog
].
bAlignIvs
 = 
ue
;

220 
LogInfo
[
iLog
].
bEb
 = 
ue
;

221 
LogInfo
[
iLog
].
bStWhFu
 = 
l
;

222 
LogInfo
[
iLog
].
bTrigg
 = 
l
;

223 
LogInfo
[
iLog
].
LogggTy
 = 
LOGGING_TYPE_POLLED
;

224 
LogInfo
[
iLog
].
Sour
.
yIndex
 = 0;

225 
LogInfo
[
iLog
].
ucTimeFgs
 = 0;

226 
LogInfo
[
iLog
].
ulIvOfft
 = 0;

227 
LogInfo
[
iLog
].
iIndex
 = 0;

228 
LogInfo
[
iLog
].
ulLogIv
 = 900;

229 
LogInfo
[
iLog
].
ulRecdCou
 = 
TL_MAX_ENTRIES
;

230 
LogInfo
[
iLog
].
ulTٮRecdCou
 = 10000;

232 
LogInfo
[
iLog
].
Sour
.
deviIndtifr
.

 =

233 
	`Devi_Obje_In_Numb
();

234 
LogInfo
[
iLog
].
Sour
.
deviIndtifr
.
ty
 = 
OBJECT_DEVICE
;

235 
LogInfo
[
iLog
].
Sour
.
objeIdtifr
.

 = iLog;

236 
LogInfo
[
iLog
].
Sour
.
objeIdtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

237 
LogInfo
[
iLog
].
Sour
.
yIndex
 = 
BACNET_ARRAY_ALL
;

238 
LogInfo
[
iLog
].
Sour
.
ݔtyIdtifr
 = 
PROP_PRESENT_VALUE
;

240 
	`dime_t_vues
(&
LogInfo
[
iLog
].
STime
, 2009, 1, 1, 0, 0, 0,

242 
LogInfo
[
iLog
].
tSTime
 =

243 
	`TL_BAC_Time_To_Lol
(&
LogInfo
[
iLog
].
STime
);

244 
	`dime_t_vues
(&
LogInfo
[
iLog
].
StTime
, 2020, 12, 22, 23, 59,

246 
LogInfo
[
iLog
].
tStTime
 =

247 
	`TL_BAC_Time_To_Lol
(&
LogInfo
[
iLog
].
StTime
);

252 
	}
}

260 
bo
 
	$Tnd_Log_Obje_Name
(

261 
ut32_t
 
obje_
,

262 
BACNET_CHARACTER_STRING
 * 
obje_me
)

264 
xt_rg
[32] = "";

265 
bo
 
us
 = 
l
;

267 i(
obje_
 < 
MAX_TREND_LOGS
) {

268 
	`rtf
(
xt_rg
, "Tnd Log %u", 
obje_
);

269 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

272  
us
;

273 
	}
}

278 
	$Tnd_Log_Rd_Prݔty
(

279 
BACNET_READ_PROPERTY_DATA
 * 
da
)

281 
du_n
 = 0;

282 
n
 = 0;

283 
BACNET_BIT_STRING
 
b_rg
;

284 
BACNET_CHARACTER_STRING
 
ch_rg
;

285 
TL_LOG_INFO
 *
CutLog
;

286 
ut8_t
 *
du
 = 
NULL
;

288 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

289 (
da
->
iti_da_n
 == 0)) {

292 
du
 = 
da
->
iti_da
;

293 
CutLog
 = &
LogInfo
[
	`Tnd_Log_In_To_Index
(
da
->
obje_
)];

294 
da
->
obje_ݔty
) {

295 
PROP_OBJECT_IDENTIFIER
:

296 
du_n
 =

297 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_TRENDLOG
,

298 
da
->
obje_
);

301 
PROP_DESCRIPTION
:

302 
PROP_OBJECT_NAME
:

303 
	`Tnd_Log_Obje_Name
(
da
->
obje_
, &
ch_rg
);

304 
du_n
 =

305 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

308 
PROP_OBJECT_TYPE
:

309 
du_n
 =

310 
	`code_iti_umed
(&
du
[0], 
OBJECT_TRENDLOG
);

313 
PROP_ENABLE
:

314 
du_n
 =

315 
	`code_iti_boޗn
(&
du
[0], 
CutLog
->
bEb
);

318 
PROP_STOP_WHEN_FULL
:

319 
du_n
 =

320 
	`code_iti_boޗn
(&
du
[0],

321 
CutLog
->
bStWhFu
);

324 
PROP_BUFFER_SIZE
:

325 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
TL_MAX_ENTRIES
);

328 
PROP_LOG_BUFFER
:

330 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

331 
da
->
r_code
 = 
ERROR_CODE_READ_ACCESS_DENIED
;

332 
du_n
 = 
BACNET_STATUS_ERROR
;

335 
PROP_RECORD_COUNT
:

336 
du_n
 +=

337 
	`code_iti_unsigd
(&
du
[0],

338 
CutLog
->
ulRecdCou
);

341 
PROP_TOTAL_RECORD_COUNT
:

342 
du_n
 +=

343 
	`code_iti_unsigd
(&
du
[0],

344 
CutLog
->
ulTٮRecdCou
);

347 
PROP_EVENT_STATE
:

349 
du_n
 =

350 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

353 
PROP_LOGGING_TYPE
:

354 
du_n
 =

355 
	`code_iti_umed
(&
du
[0],

356 
CutLog
->
LogggTy
);

359 
PROP_STATUS_FLAGS
:

361 
	`brg_
(&
b_rg
);

362 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

363 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

364 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

365 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

366 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

369 
PROP_START_TIME
:

370 
n
 =

371 
	`code_iti_de
(&
du
[0], &
CutLog
->
STime
.
de
);

372 
du_n
 = 
n
;

373 
n
 =

374 
	`code_iti_time
(&
du
[
du_n
],

375 &
CutLog
->
STime
.
time
);

376 
du_n
 +
n
;

379 
PROP_STOP_TIME
:

380 
n
 =

381 
	`code_iti_de
(&
du
[0], &
CutLog
->
StTime
.
de
);

382 
du_n
 = 
n
;

383 
n
 =

384 
	`code_iti_time
(&
du
[
du_n
],

385 &
CutLog
->
StTime
.
time
);

386 
du_n
 +
n
;

389 
PROP_LOG_DEVICE_OBJECT_PROPERTY
:

400 
du_n
 +=

401 
	`ba_code_devi_obj_ݔty_f
(&
du
[0],

402 &
CutLog
->
Sour
);

405 
PROP_LOG_INTERVAL
:

407 
du_n
 +=

408 
	`code_iti_unsigd
(&
du
[0],

409 
CutLog
->
ulLogIv
 * 100);

412 
PROP_ALIGN_INTERVALS
:

413 
du_n
 =

414 
	`code_iti_boޗn
(&
du
[0],

415 
CutLog
->
bAlignIvs
);

418 
PROP_INTERVAL_OFFSET
:

420 
du_n
 +=

421 
	`code_iti_unsigd
(&
du
[0],

422 
CutLog
->
ulIvOfft
 * 100);

425 
PROP_TRIGGER
:

426 
du_n
 =

427 
	`code_iti_boޗn
(&
du
[0], 
CutLog
->
bTrigg
);

431 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

432 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

433 
du_n
 = 
BACNET_STATUS_ERROR
;

437 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
)

438 && (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

439 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

440 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

441 
du_n
 = 
BACNET_STATUS_ERROR
;

444  
du_n
;

445 
	}
}

448 
bo
 
	$Tnd_Log_Wre_Prݔty
(

449 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

451 
bo
 
us
 = 
l
;

452 
n
 = 0;

453 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

454 
TL_LOG_INFO
 *
CutLog
;

455 
BACNET_DATE
 
TempDe
;

456 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 
TempSour
;

457 
bo
 
bEfiveEb
;

458 
log_dex
;

461 
log_dex
 = 
	`Tnd_Log_In_To_Index
(
wp_da
->
obje_
);

462 
CutLog
 = &
LogInfo
[
log_dex
];

465 
n
 =

466 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

467 
wp_da
->
iti_da_n
, &
vue
);

469 i(
n
 < 0) {

471 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

472 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

473  
l
;

475 i((
wp_da
->
obje_ݔty
 !
PROP_EVENT_TIME_STAMPS
) &&

476 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

478 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

479 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

480  
l
;

482 
wp_da
->
obje_ݔty
) {

483 
PROP_ENABLE
:

484 
us
 =

485 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

486 &
wp_da
->
r_ass
, &wp_da->
r_code
);

487 i(
us
) {

489 i((
CutLog
->
bEb
 =
l
) &&

490 (
CutLog
->
bStWhFu
 =
ue
) &&

491 (
CutLog
->
ulRecdCou
 =
TL_MAX_ENTRIES
) &&

492 (
vue
.
ty
.
Boޗn
 =
ue
)) {

493 
us
 = 
l
;

494 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

495 
wp_da
->
r_code
 = 
ERROR_CODE_LOG_BUFFER_FULL
;

500 i(
CutLog
->
bEb
 !
vue
.
ty
.
Boޗn
) {

501 
bEfiveEb
 = 
	`TL_Is_Ebd
(
log_dex
);

502 
CutLog
->
bEb
 = 
vue
.
ty
.
Boޗn
;

504 i(
vue
.
ty
.
Boޗn
 =
l
) {

505 i(
bEfiveEb
 =
ue
) {

508 
	`TL_In_Stus_Rec
(
log_dex
,

509 
LOG_STATUS_LOG_DISABLED
, 
ue
);

512 i(
	`TL_Is_Ebd
(
log_dex
)) {

516 
	`TL_In_Stus_Rec
(
log_dex
,

517 
LOG_STATUS_LOG_DISABLED
, 
l
);

524 
PROP_STOP_WHEN_FULL
:

525 
us
 =

526 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

527 &
wp_da
->
r_ass
, &wp_da->
r_code
);

528 i(
us
) {

530 i(
CutLog
->
bStWhFu
 !
vue
.
ty
.
Boޗn
) {

531 
CutLog
->
bStWhFu
 = 
vue
.
ty
.
Boޗn
;

533 i((
vue
.
ty
.
Boޗn
 =
ue
) &&

534 (
CutLog
->
ulRecdCou
 =
TL_MAX_ENTRIES
) &&

535 (
CutLog
->
bEb
 =
ue
)) {

540 
CutLog
->
bEb
 = 
l
;

541 
	`TL_In_Stus_Rec
(
log_dex
,

542 
LOG_STATUS_LOG_DISABLED
, 
ue
);

548 
PROP_BUFFER_SIZE
:

553 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

554 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

557 
PROP_RECORD_COUNT
:

558 
us
 =

559 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

560 &
wp_da
->
r_ass
, &wp_da->
r_code
);

561 i(
us
) {

562 i(
vue
.
ty
.
Unsigd_I
 == 0) {

564 
CutLog
->
ulRecdCou
 = 0;

565 
CutLog
->
iIndex
 = 0;

566 
	`TL_In_Stus_Rec
(
log_dex
, 
LOG_STATUS_BUFFER_PURGED
,

567 
ue
);

572 
PROP_LOGGING_TYPE
:

576 
us
 =

577 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

578 &
wp_da
->
r_ass
, &wp_da->
r_code
);

579 i(
us
) {

580 i(
vue
.
ty
.
Enumed
 !
LOGGING_TYPE_COV
) {

581 
CutLog
->
LogggTy
 = 
vue
.
ty
.
Enumed
;

582 i(
vue
.
ty
.
Enumed
 =
LOGGING_TYPE_POLLED
) {

584 i(
CutLog
->
ulLogIv
 == 0) {

585 
CutLog
->
ulLogIv
 = 900;

588 i(
vue
.
ty
.
Enumed
 =
LOGGING_TYPE_TRIGGERED
) {

590 
CutLog
->
ulLogIv
 = 0;

594 
us
 = 
l
;

595 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

596 
wp_da
->
r_code
 =

597 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

602 
PROP_START_TIME
:

604 
us
 =

605 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_DATE
,

606 &
wp_da
->
r_ass
, &wp_da->
r_code
);

607 i(!
us
) {

610 
TempDe
 = 
vue
.
ty
.
De
;

612 
n
 =

613 
	`ba_decode_iti_da
(
wp_da
->
iti_da
 + 
n
,

614 
wp_da
->
iti_da_n
 - 
n
, &
vue
);

616 i(
n
) {

617 
us
 =

618 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_TIME
,

619 &
wp_da
->
r_ass
, &wp_da->
r_code
);

620 i(!
us
) {

624 
bEfiveEb
 = 
	`TL_Is_Ebd
(
log_dex
);

625 
CutLog
->
STime
.
de
 = 
TempDe
;

626 
CutLog
->
STime
.
time
 = 
vue
.
ty
.
Time
;

628 i(
	`dime_wdrd_e
(&
CutLog
->
STime
)) {

630 
CutLog
->
ucTimeFgs
 |
TL_T_START_WILD
;

631 
CutLog
->
tSTime
 = 0;

634 
CutLog
->
ucTimeFgs
 &~
TL_T_START_WILD
;

635 
CutLog
->
tSTime
 =

636 
	`TL_BAC_Time_To_Lol
(&
CutLog
->
STime
);

639 i(
bEfiveEb
 !
	`TL_Is_Ebd
(
log_dex
)) {

641 i(
bEfiveEb
 =
ue
) {

643 
	`TL_In_Stus_Rec
(
log_dex
,

644 
LOG_STATUS_LOG_DISABLED
, 
ue
);

647 
	`TL_In_Stus_Rec
(
log_dex
,

648 
LOG_STATUS_LOG_DISABLED
, 
l
);

654 
PROP_STOP_TIME
:

656 
us
 =

657 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_DATE
,

658 &
wp_da
->
r_ass
, &wp_da->
r_code
);

659 i(!
us
) {

662 
TempDe
 = 
vue
.
ty
.
De
;

664 
n
 =

665 
	`ba_decode_iti_da
(
wp_da
->
iti_da
 + 
n
,

666 
wp_da
->
iti_da_n
 - 
n
, &
vue
);

668 i(
n
) {

669 
us
 =

670 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_TIME
,

671 &
wp_da
->
r_ass
, &wp_da->
r_code
);

672 i(!
us
) {

676 
bEfiveEb
 = 
	`TL_Is_Ebd
(
log_dex
);

677 
CutLog
->
StTime
.
de
 = 
TempDe
;

678 
CutLog
->
StTime
.
time
 = 
vue
.
ty
.
Time
;

680 i(
	`dime_wdrd_e
(&
CutLog
->
StTime
)) {

682 
CutLog
->
ucTimeFgs
 |
TL_T_STOP_WILD
;

683 
CutLog
->
tStTime
 = 0xFFFFFFFF;

686 
CutLog
->
ucTimeFgs
 &~
TL_T_STOP_WILD
;

687 
CutLog
->
tStTime
 =

688 
	`TL_BAC_Time_To_Lol
(&
CutLog
->
StTime
);

691 i(
bEfiveEb
 !
	`TL_Is_Ebd
(
log_dex
)) {

693 i(
bEfiveEb
 =
ue
) {

695 
	`TL_In_Stus_Rec
(
log_dex
,

696 
LOG_STATUS_LOG_DISABLED
, 
ue
);

699 
	`TL_In_Stus_Rec
(
log_dex
,

700 
LOG_STATUS_LOG_DISABLED
, 
l
);

706 
PROP_LOG_DEVICE_OBJECT_PROPERTY
:

707 
n
 = 
	`ba_decode_devi_obj_ݔty_f
(
wp_da
->
iti_da
, &
TempSour
);

708 if((
n
 < 0|| (> 
wp_da
->
iti_da_n
))

710 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

711 
wp_da
->
r_code
 = 
ERROR_CODE_OTHER
;

716 if((
TempSour
.
deviIndtifr
.
ty
 =
OBJECT_DEVICE
&& (TempSour.deviIndtifr.

 !
	`Devi_Obje_In_Numb
()))

718 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

719 
wp_da
->
r_code
 = 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

724 i(
	`memcmp
(&
TempSour
, &
CutLog
->
Sour
,

725 (
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
)) != 0) {

727 
CutLog
->
ulRecdCou
 = 0;

728 
CutLog
->
iIndex
 = 0;

729 
	`TL_In_Stus_Rec
(
log_dex
, 
LOG_STATUS_BUFFER_PURGED
,

730 
ue
);

732 
CutLog
->
Sour
 = 
TempSour
;

733 
us
 = 
ue
;

736 
PROP_LOG_INTERVAL
:

737 i(
CutLog
->
LogggTy
 =
LOGGING_TYPE_TRIGGERED
) {

739 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

740 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

743 
us
 =

744 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

745 &
wp_da
->
r_ass
, &wp_da->
r_code
);

746 i(
us
) {

747 i((
CutLog
->
LogggTy
 =
LOGGING_TYPE_POLLED
) &&

748 (
vue
.
ty
.
Unsigd_I
 == 0)) {

751 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

752 
wp_da
->
r_code
 =

753 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

754 
us
 = 
l
;

757 
CutLog
->
ulLogIv
 = 
vue
.
ty
.
Unsigd_I
 / 100;

758 if(0 =
CutLog
->
ulLogIv
)

759 
CutLog
->
ulLogIv
 = 1;

764 
PROP_ALIGN_INTERVALS
:

765 
us
 =

766 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

767 &
wp_da
->
r_ass
, &wp_da->
r_code
);

768 i(
us
) {

769 
CutLog
->
bAlignIvs
 = 
vue
.
ty
.
Boޗn
;

773 
PROP_INTERVAL_OFFSET
:

775 
us
 =

776 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

777 &
wp_da
->
r_ass
, &wp_da->
r_code
);

778 i(
us
) {

779 
CutLog
->
ulIvOfft
 = 
vue
.
ty
.
Unsigd_I
 / 100;

783 
PROP_TRIGGER
:

784 
us
 =

785 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

786 &
wp_da
->
r_ass
, &wp_da->
r_code
);

787 i(
us
) {

792 i((
CutLog
->
LogggTy
 =
LOGGING_TYPE_POLLED
) &&

793 (
CutLog
->
bAlignIvs
 =
ue
)) {

794 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

795 
wp_da
->
r_code
 =

796 
ERROR_CODE_NOT_CONFIGURED_FOR_TRIGGERED_LOGGING
;

797 
us
 = 
l
;

799 
CutLog
->
bTrigg
 = 
vue
.
ty
.
Boޗn
;

805 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

806 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

810  
us
;

811 
	}
}

813 
bo
 
	$TndLogGRRInfo
(

814 
BACNET_READ_RANGE_DATA
 * 
pReque
,

815 
RR_PROP_INFO
 * 
pInfo
)

817 
log_dex
;

819 
log_dex
 = 
	`Tnd_Log_In_To_Index
(
pReque
->
obje_
);

820 i(
log_dex
 >
MAX_TREND_LOGS
) {

821 
pReque
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

822 
pReque
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

823 } i(
pReque
->
obje_ݔty
 =
PROP_LOG_BUFFER
) {

824 
pInfo
->
RequeTys
 = 
RR_BY_POSITION
 | 
RR_BY_TIME
 | 
RR_BY_SEQUENCE
;

825 
pInfo
->
Hdr
 = 
_d_log_code
;

826  (
ue
);

828 
pReque
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

829 
pReque
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_A_LIST
;

832  (
l
);

833 
	}
}

842 
	$TL_In_Stus_Rec
(

843 
iLog
,

844 
BACNET_LOG_STATUS
 
eStus
,

845 
bo
 
bS
)

847 
TL_LOG_INFO
 *
CutLog
;

848 
TL_DATA_REC
 
TempRec
;

850 
CutLog
 = &
LogInfo
[
iLog
];

852 
TempRec
.
tTimeSmp
 = 
	`time
(
NULL
);

853 
TempRec
.
ucRecTy
 = 
TL_TYPE_STATUS
;

854 
TempRec
.
ucStus
 = 0;

855 
TempRec
.
Dum
.
ucLogStus
 = 0;

858 
eStus
) {

859 
LOG_STATUS_LOG_DISABLED
:

860 i(
bS
)

861 
TempRec
.
Dum
.
ucLogStus
 = 1 << 
LOG_STATUS_LOG_DISABLED
;

863 
LOG_STATUS_BUFFER_PURGED
:

864 i(
bS
)

865 
TempRec
.
Dum
.
ucLogStus
 = 1 << 
LOG_STATUS_BUFFER_PURGED
;

867 
LOG_STATUS_LOG_INTERRUPTED
:

868 
TempRec
.
Dum
.
ucLogStus
 = 1 << 
LOG_STATUS_LOG_INTERRUPTED
;

874 
Logs
[
iLog
][
CutLog
->
iIndex
++] = 
TempRec
;

875 i(
CutLog
->
iIndex
 >
TL_MAX_ENTRIES
)

876 
CutLog
->
iIndex
 = 0;

878 
CutLog
->
ulTٮRecdCou
++;

880 i(
CutLog
->
ulRecdCou
 < 
TL_MAX_ENTRIES
)

881 
CutLog
->
ulRecdCou
++;

882 
	}
}

889 
bo
 
	$TL_Is_Ebd
(

890 
iLog
)

892 
TL_LOG_INFO
 *
CutLog
;

893 
time_t
 
tNow
;

894 
bo
 
bStus
;

896 
bStus
 = 
ue
;

897 
CutLog
 = &
LogInfo
[
iLog
];

899 
	`tf
("\nFlags - %u, Start - %u, Stop - %u\n",

900 (
CutLog
->
ucTimeFgs
,

901 (
CutLog
->
tSTime
,

902 (
CutLog
->
tStTime
);

904 i(
CutLog
->
bEb
 =
l
) {

906 
bStus
 = 
l
;

907 } i((
CutLog
->
ucTimeFgs
 == 0) &&

908 (
CutLog
->
tStTime
 < CutLog->
tSTime
)) {

910 
bStus
 = 
l
;

911 } i(
CutLog
->
ucTimeFgs
 !(
TL_T_START_WILD
 | 
TL_T_STOP_WILD
)) {

913 
tNow
 = 
	`time
(
NULL
);

915 
	`tf
("\nFlags - %u, Current - %u, Start - %u, Stop - %u\n",

916 (
CutLog
->
ucTimeFgs
, (
Now
,

917 (
CutLog
->
tSTime
,

918 (
CutLog
->
tStTime
);

920 i((
CutLog
->
ucTimeFgs
 & 
TL_T_START_WILD
) != 0) {

922 i(
tNow
 > 
CutLog
->
tStTime
)

923 
bStus
 = 
l
;

924 } i((
CutLog
->
ucTimeFgs
 & 
TL_T_STOP_WILD
) != 0) {

926 i(
tNow
 < 
CutLog
->
tSTime
)

927 
bStus
 = 
l
;

930 
	`tf
("\nCurrent - %u, Start - %u, Stop - %u\n",

931 (
Now
, (
CutLog
->
tSTime
,

932 (
CutLog
->
tStTime
);

935 i((
tNow
 < 
CutLog
->
tSTime
) ||

936 (
tNow
 > 
CutLog
->
tStTime
))

937 
bStus
 = 
l
;

941  (
bStus
);

942 
	}
}

948 
time_t
 
	$TL_BAC_Time_To_Lol
(

949 
BACNET_DATE_TIME
 * 
SourTime
)

951 
tm
 
LolTime
;

952 
iTemp
;

954 
LolTime
.
tm_yr
 = 
SourTime
->
de
.
yr
 - 1900;

959 
iTemp
 =

960 
SourTime
->
de
.
yr
 + SourTime->de.
mth
 + SourTime->de.
day
;

961 i(
iTemp
 == 1900) {

962 
LolTime
.
tm_m
 = 0;

963 
LolTime
.
tm_mday
 = 1;

965 
LolTime
.
tm_m
 = 
SourTime
->
de
.
mth
 - 1;

966 
LolTime
.
tm_mday
 = 
SourTime
->
de
.
day
;

969 
LolTime
.
tm_hour
 = 
SourTime
->
time
.
hour
;

970 
LolTime
.
tm_m
 = 
SourTime
->
time
.
m
;

971 
LolTime
.
tm_c
 = 
SourTime
->
time
.
c
;

973  (
	`mktime
(&
LolTime
));

974 
	}
}

980 
	$TL_Lol_Time_To_BAC
(

981 
BACNET_DATE_TIME
 * 
DeTime
,

982 
time_t
 
SourTime
)

984 
tm
 *
TempTime
;

986 
TempTime
 = 
	`loime
(&
SourTime
);

988 
DeTime
->
de
.
yr
 = (
ut16_t
(
TempTime
->
tm_yr
 + 1900);

989 
DeTime
->
de
.
mth
 = (
ut8_t
(
TempTime
->
tm_m
 + 1);

990 
DeTime
->
de
.
day
 = (
ut8_t

TempTime
->
tm_mday
;

994 i(
TempTime
->
tm_wday
 == 0)

995 
DeTime
->
de
.
wday
 = 7;

997 
DeTime
->
de
.
wday
 = (
ut8_t

TempTime
->
tm_wday
;

998 
DeTime
->
time
.
hour
 = (
ut8_t

TempTime
->
tm_hour
;

999 
DeTime
->
time
.
m
 = (
ut8_t

TempTime
->
tm_m
;

1000 
DeTime
->
time
.
c
 = (
ut8_t

TempTime
->
tm_c
;

1001 
DeTime
->
time
.
hunddths
 = 0;

1002 
	}
}

1023 
	#TL_MAX_ENC
 23

	)

1025 
	$_d_log_code
(

1026 
ut8_t
 * 
du
,

1027 
BACNET_READ_RANGE_DATA
 * 
pReque
)

1030 
	`brg_
(&
pReque
->
ResuFgs
);

1031 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_FIRST_ITEM
, 
l
);

1032 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_LAST_ITEM
, 
l
);

1033 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_MORE_ITEMS
, 
l
);

1034 
pReque
->
ImCou
 = 0;

1037 i(
LogInfo
[
	`Tnd_Log_In_To_Index
(
pReque
->

1038 
obje_
)].
ulRecdCou
 == 0)

1041 i((
pReque
->
RequeTy
 =
RR_BY_POSITION
) ||

1042 (
pReque
->
RequeTy
 =
RR_READ_ALL
))

1043  (
	`TL_code_by_posi
(
du
, 
pReque
));

1044 i(
pReque
->
RequeTy
 =
RR_BY_SEQUENCE
)

1045  (
	`TL_code_by_qu
(
du
, 
pReque
));

1047  (
	`TL_code_by_time
(
du
, 
pReque
));

1048 
	}
}

1056 
	$TL_code_by_posi
(

1057 
ut8_t
 * 
du
,

1058 
BACNET_READ_RANGE_DATA
 * 
pReque
)

1060 
log_dex
 = 0;

1061 
iL
 = 0;

1062 
t32_t
 
iTemp
 = 0;

1063 
TL_LOG_INFO
 *
CutLog
 = 
NULL
;

1065 
ut32_t
 
uiIndex
 = 0;

1066 
ut32_t
 
uiF
 = 0;

1067 
ut32_t
 
uiLa
 = 0;

1068 
ut32_t
 
uiTg
 = 0;

1069 
ut32_t
 
uiRemag
 = 0;

1072 
uiRemag
 = 
MAX_APDU
 - 
pReque
->
Ovhd
;

1073 
log_dex
 = 
	`Tnd_Log_In_To_Index
(
pReque
->
obje_
);

1074 
CutLog
 = &
LogInfo
[
log_dex
];

1075 i(
pReque
->
RequeTy
 =
RR_READ_ALL
) {

1081 
pReque
->
Cou
 = 
CutLog
->
ulRecdCou
;

1082 
pReque
->
Rge
.
RefIndex
 = 1;

1085 i(
pReque
->
Cou
 < 0) {

1099 
iTemp
 = 
pReque
->
Rge
.
RefIndex
;

1100 
iTemp
 +
pReque
->
Cou
 + 1;

1101 i(
iTemp
 < 1) {

1102 
pReque
->
Cou
 =Reque->
Rge
.
RefIndex
;

1103 
pReque
->
Rge
.
RefIndex
 = 1;

1105 
pReque
->
Rge
.
RefIndex
 = 
iTemp
;

1106 
pReque
->
Cou
 = -pRequest->Count;

1112 i(
pReque
->
Rge
.
RefIndex
 > 
CutLog
->
ulRecdCou
)

1115 
uiTg
 = 
pReque
->
Rge
.
RefIndex
 +Reque->
Cou
 - 1;

1116 i(
uiTg
 > 
CutLog
->
ulRecdCou
)

1117 
uiTg
 = 
CutLog
->
ulRecdCou
;

1119 
uiIndex
 = 
pReque
->
Rge
.
RefIndex
;

1120 
uiF
 = 
uiIndex
;

1121 
uiIndex
 <
uiTg
) {

1122 i(
uiRemag
 < 
TL_MAX_ENC
) {

1127 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_MORE_ITEMS
,

1128 
ue
);

1132 
iTemp
 = 
	`TL_code_y
(&
du
[
iL
], 
log_dex
, 
uiIndex
);

1134 
uiRemag
 -
iTemp
;

1135 
iL
 +
iTemp
;

1136 
uiLa
 = 
uiIndex
;

1137 
uiIndex
++;

1138 
pReque
->
ImCou
++;

1142 i(
uiF
 == 1)

1143 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_FIRST_ITEM
,

1144 
ue
);

1146 i(
uiLa
 =
CutLog
->
ulRecdCou
)

1147 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_LAST_ITEM
, 
ue
);

1149  (
iL
);

1150 
	}
}

1160 
	$TL_code_by_qu
(

1161 
ut8_t
 * 
du
,

1162 
BACNET_READ_RANGE_DATA
 * 
pReque
)

1164 
log_dex
 = 0;

1165 
iL
 = 0;

1166 
t32_t
 
iTemp
 = 0;

1167 
TL_LOG_INFO
 *
CutLog
 = 
NULL
;

1169 
ut32_t
 
uiIndex
 = 0;

1170 
ut32_t
 
uiF
 = 0;

1171 
ut32_t
 
uiLa
 = 0;

1172 
ut32_t
 
uiSequ
 = 0;

1173 
ut32_t
 
uiRemag
 = 0;

1174 
ut32_t
 
uiFSeq
 = 0;

1176 
ut32_t
 
uiBeg
 = 0;

1177 
ut32_t
 
uiEnd
 = 0;

1178 
bo
 
bWpReq
 = 
l
;

1179 
bo
 
bWpLog
 = 
l
;

1182 
uiRemag
 = 
MAX_APDU
 - 
pReque
->
Ovhd
;

1183 
log_dex
 = 
	`Tnd_Log_In_To_Index
(
pReque
->
obje_
);

1184 
CutLog
 = &
LogInfo
[
log_dex
];

1186 
uiFSeq
 =

1187 
CutLog
->
ulTٮRecdCou
 - (CutLog->
ulRecdCou
 - 1);

1190 i(
pReque
->
Cou
 < 0) {

1191 
uiBeg
 = 
pReque
->
Rge
.
RefSeqNum
 +Reque->
Cou
 + 1;

1192 
uiEnd
 = 
pReque
->
Rge
.
RefSeqNum
;

1194 
uiBeg
 = 
pReque
->
Rge
.
RefSeqNum
;

1195 
uiEnd
 = 
pReque
->
Rge
.
RefSeqNum
 +Reque->
Cou
 - 1;

1198 i(
uiBeg
 > 
uiEnd
)

1199 
bWpReq
 = 
ue
;

1200 i(
uiFSeq
 > 
CutLog
->
ulTٮRecdCou
)

1201 
bWpLog
 = 
ue
;

1203 i((
bWpReq
 =
l
&& (
bWpLog
 == false)) {

1205 i((
uiEnd
 < 
uiFSeq
|| (
uiBeg
 > 
CutLog
->
ulTٮRecdCou
))

1212 i(
uiBeg
 < 
uiFSeq
)

1213 
uiBeg
 = 
uiFSeq
;

1215 i(
uiEnd
 > 
CutLog
->
ulTٮRecdCou
)

1216 
uiEnd
 = 
CutLog
->
ulTٮRecdCou
;

1219 i((
uiBeg
 > 
CutLog
->
ulTٮRecdCou
&& (
uiEnd
 < 
uiFSeq
))

1222 i(
bWpLog
 =
l
) {

1223 i(
uiEnd
 < 
uiFSeq
) {

1224 
uiEnd
 = 
CutLog
->
ulTٮRecdCou
;

1225 i(
uiBeg
 < 
uiFSeq
)

1226 
uiBeg
 = 
uiFSeq
;

1228 
uiBeg
 = 
uiFSeq
;

1229 i(
uiEnd
 > 
CutLog
->
ulTٮRecdCou
)

1230 
uiEnd
 = 
CutLog
->
ulTٮRecdCou
;

1232 } i(
bWpReq
 =
l
) {

1233 i(
uiBeg
 > 
CutLog
->
ulTٮRecdCou
) {

1234 i(
uiBeg
 > 
uiFSeq
)

1235 
uiBeg
 = 
uiFSeq
;

1237 i(
uiEnd
 > 
CutLog
->
ulTٮRecdCou
)

1238 
uiEnd
 = 
CutLog
->
ulTٮRecdCou
;

1241 i(
uiBeg
 < 
uiFSeq
)

1242 
uiBeg
 = 
uiFSeq
;

1244 i(
uiEnd
 > 
CutLog
->
ulTٮRecdCou
)

1245 
uiEnd
 = 
CutLog
->
ulTٮRecdCou
;

1252 
uiIndex
 = 
uiBeg
 - 
uiFSeq
 + 1;

1253 
uiSequ
 = 
uiBeg
;

1254 
uiF
 = 
uiIndex
;

1255 
uiSequ
 !
uiEnd
 + 1) {

1256 i(
uiRemag
 < 
TL_MAX_ENC
) {

1261 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_MORE_ITEMS
,

1262 
ue
);

1266 
iTemp
 = 
	`TL_code_y
(&
du
[
iL
], 
log_dex
, 
uiIndex
);

1268 
uiRemag
 -
iTemp
;

1269 
iL
 +
iTemp
;

1270 
uiLa
 = 
uiIndex
;

1271 
uiIndex
++;

1272 
uiSequ
++;

1273 
pReque
->
ImCou
++;

1277 i(
uiF
 == 1)

1278 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_FIRST_ITEM
,

1279 
ue
);

1281 i(
uiLa
 =
CutLog
->
ulRecdCou
)

1282 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_LAST_ITEM
, 
ue
);

1284 
pReque
->
FSequ
 = 
uiBeg
;

1286  (
iL
);

1287 
	}
}

1296 
	$TL_code_by_time
(

1297 
ut8_t
 * 
du
,

1298 
BACNET_READ_RANGE_DATA
 * 
pReque
)

1300 
log_dex
 = 0;

1301 
iL
 = 0;

1302 
t32_t
 
iTemp
 = 0;

1303 
iCou
 = 0;

1304 
TL_LOG_INFO
 *
CutLog
 = 
NULL
;

1306 
ut32_t
 
uiIndex
 = 0;

1307 
ut32_t
 
uiF
 = 0;

1308 
ut32_t
 
uiLa
 = 0;

1309 
ut32_t
 
uiRemag
 = 0;

1310 
ut32_t
 
uiFSeq
 = 0;

1311 
time_t
 
tRefTime
 = 0;

1314 
uiRemag
 = 
MAX_APDU
 - 
pReque
->
Ovhd
;

1315 
log_dex
 = 
	`Tnd_Log_In_To_Index
(
pReque
->
obje_
);

1316 
CutLog
 = &
LogInfo
[
log_dex
];

1318 
tRefTime
 = 
	`TL_BAC_Time_To_Lol
(&
pReque
->
Rge
.
RefTime
);

1320 i(
CutLog
->
ulRecdCou
 < 
TL_MAX_ENTRIES
)

1321 
uiIndex
 = 0;

1323 
uiIndex
 = 
CutLog
->
iIndex
;

1325 i(
pReque
->
Cou
 < 0) {

1329 
iCou
 = 
CutLog
->
ulRecdCou
 - 1;

1331 
uiFSeq
 = 
CutLog
->
ulTٮRecdCou
;

1333 i(
Logs
[
pReque
->
obje_
][(
uiIndex
 +

1334 
iCou
% 
TL_MAX_ENTRIES
].
tTimeSmp
 < 
tRefTime
)

1337 
uiFSeq
--;

1338 
iCou
--;

1339 i(
iCou
 < 0)

1347 
pReque
->
Cou
 = -pRequest->Count;

1353 
iTemp
 = 
pReque
->
Cou
 - 1;

1354 i(
iTemp
 > 
iCou
) {

1355 
uiFSeq
 -
iCou
;

1356 
pReque
->
Cou
 = 
iCou
 + 1;

1357 
iCou
 = 0;

1359 
uiFSeq
 -
iTemp
;

1360 
iCou
 -
iTemp
;

1366 
iCou
 = 0;

1368 
uiFSeq
 =

1369 
CutLog
->
ulTٮRecdCou
 - (CutLog->
ulRecdCou
 - 1);

1371 i(
Logs
[
pReque
->
obje_
][(
uiIndex
 +

1372 
iCou
% 
TL_MAX_ENTRIES
].
tTimeSmp
 > 
tRefTime
)

1375 
uiFSeq
++;

1376 
iCou
++;

1377 i((
ut32_t

iCou
 =
CutLog
->
ulRecdCou
)

1384 
uiIndex
 = 
iCou
 + 1;

1385 
uiF
 = 
uiIndex
;

1386 
iCou
 = 
pReque
->
Cou
;

1387 
iCou
 != 0) {

1388 i(
uiRemag
 < 
TL_MAX_ENC
) {

1393 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_MORE_ITEMS
,

1394 
ue
);

1398 
iTemp
 = 
	`TL_code_y
(&
du
[
iL
], 
log_dex
, 
uiIndex
);

1400 
uiRemag
 -
iTemp
;

1401 
iL
 +
iTemp
;

1402 
uiLa
 = 
uiIndex
;

1403 
uiIndex
++;

1404 
pReque
->
ImCou
++;

1405 
iCou
--;

1407 i(
uiIndex
 > 
CutLog
->
ulRecdCou
)

1412 i(
uiF
 == 1)

1413 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_FIRST_ITEM
,

1414 
ue
);

1416 i(
uiLa
 =
CutLog
->
ulRecdCou
)

1417 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_LAST_ITEM
, 
ue
);

1419 
pReque
->
FSequ
 = 
uiFSeq
;

1421  (
iL
);

1422 
	}
}

1425 
	$TL_code_y
(

1426 
ut8_t
 * 
du
,

1427 
iLog
,

1428 
iEry
)

1430 
iL
 = 0;

1431 
TL_DATA_REC
 *
pSour
 = 
NULL
;

1432 
BACNET_BIT_STRING
 
TempBs
;

1433 
ut8_t
 
ucCou
 = 0;

1434 
BACNET_DATE_TIME
 
TempTime
;

1439 i(
LogInfo
[
iLog
].
ulRecdCou
 < 
TL_MAX_ENTRIES
)

1440 
pSour
 = &
Logs
[
iLog
][(
iEry
 - 1% 
TL_MAX_ENTRIES
];

1442 
pSour
 =

1443 &
Logs
[
iLog
][(
LogInfo
[iLog].
iIndex
 + 
iEry
 - 1% 
TL_MAX_ENTRIES
];

1445 
iL
 = 0;

1447 
	`TL_Lol_Time_To_BAC
(&
TempTime
, 
pSour
->
tTimeSmp
);

1448 
iL
 +
	`ba_code_cڋxt_dime
(
du
, 0, &
TempTime
);

1451 
iL
 +
	`code_ݒg_g
(&
du
[iLen], 1);

1453 
pSour
->
ucRecTy
) {

1454 
TL_TYPE_STATUS
:

1456 
	`brg_
(&
TempBs
);

1457 
	`brg_t_bs_ud
(&
TempBs
, 1, 5);

1458 
	`brg_t_o
(&
TempBs
, 0, 
pSour
->
Dum
.
ucLogStus
);

1459 
iL
 +=

1460 
	`code_cڋxt_brg
(&
du
[
iL
], 
pSour
->
ucRecTy
,

1461 &
TempBs
);

1464 
TL_TYPE_BOOL
:

1465 
iL
 +=

1466 
	`code_cڋxt_boޗn
(&
du
[
iL
], 
pSour
->
ucRecTy
,

1467 
pSour
->
Dum
.
ucBoޗn
);

1470 
TL_TYPE_REAL
:

1471 
iL
 +=

1472 
	`code_cڋxt_
(&
du
[
iL
], 
pSour
->
ucRecTy
,

1473 
pSour
->
Dum
.
fRl
);

1476 
TL_TYPE_ENUM
:

1477 
iL
 +=

1478 
	`code_cڋxt_umed
(&
du
[
iL
], 
pSour
->
ucRecTy
,

1479 
pSour
->
Dum
.
ulEnum
);

1482 
TL_TYPE_UNSIGN
:

1483 
iL
 +=

1484 
	`code_cڋxt_unsigd
(&
du
[
iL
], 
pSour
->
ucRecTy
,

1485 
pSour
->
Dum
.
ulUVue
);

1488 
TL_TYPE_SIGN
:

1489 
iL
 +=

1490 
	`code_cڋxt_sigd
(&
du
[
iL
], 
pSour
->
ucRecTy
,

1491 
pSour
->
Dum
.
lSVue
);

1494 
TL_TYPE_BITS
:

1498 
	`brg_
(&
TempBs
);

1499 
	`brg_t_bs_ud
(&
TempBs
,

1500 (
pSour
->
Dum
.
Bs
.
ucL
 >> 4) & 0x0F,

1501 
pSour
->
Dum
.
Bs
.
ucL
 & 0x0F);

1502 
ucCou
 = 
pSour
->
Dum
.
Bs
.
ucL
 >> 4; ucCount > 0;

1503 
ucCou
--)

1504 
	`brg_t_o
(&
TempBs
, 
ucCou
 - 1,

1505 
pSour
->
Dum
.
Bs
.
ucSte
[
ucCou
 - 1]);

1507 
iL
 +=

1508 
	`code_cڋxt_brg
(&
du
[
iL
], 
pSour
->
ucRecTy
,

1509 &
TempBs
);

1512 
TL_TYPE_NULL
:

1513 
iL
 +
	`code_cڋxt_nu
(&
du
[iL], 
pSour
->
ucRecTy
);

1516 
TL_TYPE_ERROR
:

1517 
iL
 +
	`code_ݒg_g
(&
du
[iL], 
TL_TYPE_ERROR
);

1518 
iL
 +=

1519 
	`code_iti_umed
(&
du
[
iL
],

1520 
pSour
->
Dum
.
E
.
usCss
);

1521 
iL
 +=

1522 
	`code_iti_umed
(&
du
[
iL
],

1523 
pSour
->
Dum
.
E
.
usCode
);

1524 
iL
 +
	`code_osg_g
(&
du
[iL], 
TL_TYPE_ERROR
);

1527 
TL_TYPE_DELTA
:

1528 
iL
 +=

1529 
	`code_cڋxt_
(&
du
[
iL
], 
pSour
->
ucRecTy
,

1530 
pSour
->
Dum
.
fTime
);

1533 
TL_TYPE_ANY
:

1538 
iL
 +
	`code_osg_g
(&
du
[iLen], 1);

1540 i((
pSour
->
ucStus
 & 128) == 128) {

1541 
	`brg_
(&
TempBs
);

1542 
	`brg_t_bs_ud
(&
TempBs
, 1, 4);

1544 
	`brg_t_o
(&
TempBs
, 0, (
pSour
->
ucStus
 & 0x0F));

1545 
iL
 +
	`code_cڋxt_brg
(&
du
[iL], 2, &
TempBs
);

1548  (
iL
);

1549 
	}
}

1551 
	$lol_ad_ݔty
(

1552 
ut8_t
 * 
vue
,

1553 
ut8_t
 * 
us
,

1554 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 * 
Sour
,

1555 
BACNET_ERROR_CLASS
 * 
r_ass
,

1556 
BACNET_ERROR_CODE
 * 
r_code
)

1558 
n
 = 0;

1559 
BACNET_READ_PROPERTY_DATA
 
da
;

1561 i(
vue
 !
NULL
) {

1563 
da
.
iti_da
 = 
vue
;

1564 
da
.
iti_da_n
 = 
MAX_APDU
;

1565 
da
.
obje_ty
 = 
Sour
->
objeIdtifr
.
ty
;

1566 
da
.
obje_
 = 
Sour
->
objeIdtifr
.

;

1567 
da
.
obje_ݔty
 = 
Sour
->
ݔtyIdtifr
;

1568 
da
.
y_dex
 = 
Sour
->
yIndex
;

1570 
n
 = 
	`Devi_Rd_Prݔty
(&
da
);

1571 i(
n
 < 0) {

1572 *
r_ass
 = 
da
.error_class;

1573 *
r_code
 = 
da
.error_code;

1577 i((
n
 >0&& (
us
 !
NULL
)) {

1579 
da
.
iti_da
 = 
us
;

1580 
da
.
iti_da_n
 = 
MAX_APDU
;

1581 
da
.
obje_ݔty
 = 
PROP_STATUS_FLAGS
;

1582 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

1583 
n
 = 
	`Devi_Rd_Prݔty
(&
da
);

1584 i(
n
 < 0) {

1585 *
r_ass
 = 
da
.error_class;

1586 *
r_code
 = 
da
.error_code;

1590  (
n
);

1591 
	}
}

1597 
	$TL_tch_ݔty
(

1598 
iLog
)

1600 
ut8_t
 
VueBuf
[
MAX_APDU
];

1601 
ut8_t
 
StusBuf
[3];

1602 
BACNET_ERROR_CLASS
 
r_ass
 = 
ERROR_CLASS_SERVICES
;

1603 
BACNET_ERROR_CODE
 
r_code
 = 
ERROR_CODE_OTHER
;

1604 
iL
;

1605 
ut8_t
 
ucCou
;

1606 
TL_LOG_INFO
 *
CutLog
;

1607 
TL_DATA_REC
 
TempRec
;

1608 
ut8_t
 
g_numb
 = 0;

1609 
ut32_t
 
n_vue_ty
 = 0;

1610 
BACNET_BIT_STRING
 
TempBs
;

1612 
CutLog
 = &
LogInfo
[
iLog
];

1616 
TempRec
.
tTimeSmp
 = 
	`time
(
NULL
);

1617 
CutLog
->
tLaDaTime
 = 
TempRec
.
tTimeSmp
;

1618 
TempRec
.
ucStus
 = 0;

1620 
iL
 =

1621 
	`lol_ad_ݔty
(
VueBuf
, 
StusBuf
, &
LogInfo
[
iLog
].
Sour
,

1622 &
r_ass
, &
r_code
);

1623 i(
iL
 < 0) {

1625 
TempRec
.
Dum
.
E
.
usCss
 = 
r_ass
;

1626 
TempRec
.
Dum
.
E
.
usCode
 = 
r_code
;

1627 
TempRec
.
ucRecTy
 = 
TL_TYPE_ERROR
;

1630 
iL
 =

1631 
	`decode_g_numb_d_vue
(
VueBuf
, &
g_numb
,

1632 &
n_vue_ty
);

1633 
g_numb
) {

1634 
BACNET_APPLICATION_TAG_NULL
:

1635 
TempRec
.
ucRecTy
 = 
TL_TYPE_NULL
;

1638 
BACNET_APPLICATION_TAG_BOOLEAN
:

1639 
TempRec
.
ucRecTy
 = 
TL_TYPE_BOOL
;

1640 
TempRec
.
Dum
.
ucBoޗn
 = 
	`decode_boޗn
(
n_vue_ty
);

1643 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

1644 
TempRec
.
ucRecTy
 = 
TL_TYPE_UNSIGN
;

1645 
	`decode_unsigd
(&
VueBuf
[
iL
], 
n_vue_ty
,

1646 &
TempRec
.
Dum
.
ulUVue
);

1649 
BACNET_APPLICATION_TAG_SIGNED_INT
:

1650 
TempRec
.
ucRecTy
 = 
TL_TYPE_SIGN
;

1651 
	`decode_sigd
(&
VueBuf
[
iL
], 
n_vue_ty
,

1652 &
TempRec
.
Dum
.
lSVue
);

1655 
BACNET_APPLICATION_TAG_REAL
:

1656 
TempRec
.
ucRecTy
 = 
TL_TYPE_REAL
;

1657 
	`decode__
(&
VueBuf
[
iL
], 
n_vue_ty
,

1658 &
TempRec
.
Dum
.
fRl
);

1661 
BACNET_APPLICATION_TAG_BIT_STRING
:

1662 
TempRec
.
ucRecTy
 = 
TL_TYPE_BITS
;

1663 
	`decode_brg
(&
VueBuf
[
iL
], 
n_vue_ty
, &
TempBs
);

1665 i(
	`brg_bs_ud
(&
TempBs
) < 32) {

1667 
TempRec
.
Dum
.
Bs
.
ucL
 =

1668 
	`brg_bys_ud
(&
TempBs
) << 4;

1669 
TempRec
.
Dum
.
Bs
.
ucL
 |=

1670 (8 - (
	`brg_bs_ud
(&
TempBs
) % 8)) & 7;

1672 
ucCou
 = 0;

1673 
ucCou
 < 
	`brg_bys_ud
(&
TempBs
); ucCount++)

1674 
TempRec
.
Dum
.
Bs
.
ucSte
[
ucCou
] =

1675 
	`brg_o
(&
TempBs
, 
ucCou
);

1678 
TempRec
.
Dum
.
Bs
.
ucL
 = 4 << 4;

1679 
ucCou
 = 0; ucCount < 4; ucCount++)

1680 
TempRec
.
Dum
.
Bs
.
ucSte
[
ucCou
] =

1681 
	`brg_o
(&
TempBs
, 
ucCou
);

1685 
BACNET_APPLICATION_TAG_ENUMERATED
:

1686 
TempRec
.
ucRecTy
 = 
TL_TYPE_ENUM
;

1687 
	`decode_umed
(&
VueBuf
[
iL
], 
n_vue_ty
,

1688 &
TempRec
.
Dum
.
ulEnum
);

1693 
TempRec
.
Dum
.
E
.
usCss
 = 
ERROR_CLASS_PROPERTY
;

1694 
TempRec
.
Dum
.
E
.
usCode
 = 
ERROR_CODE_DATATYPE_NOT_SUPPORTED
;

1695 
TempRec
.
ucRecTy
 = 
TL_TYPE_ERROR
;

1699 
iL
 =

1700 
	`decode_g_numb_d_vue
(
StusBuf
, &
g_numb
,

1701 &
n_vue_ty
);

1702 
	`decode_brg
(&
StusBuf
[
iL
], 
n_vue_ty
, &
TempBs
);

1703 
TempRec
.
ucStus
 = 128 | 
	`brg_o
(&
TempBs
, 0);

1706 
Logs
[
iLog
][
CutLog
->
iIndex
++] = 
TempRec
;

1707 i(
CutLog
->
iIndex
 >
TL_MAX_ENTRIES
)

1708 
CutLog
->
iIndex
 = 0;

1710 
CutLog
->
ulTٮRecdCou
++;

1712 i(
CutLog
->
ulRecdCou
 < 
TL_MAX_ENTRIES
)

1713 
CutLog
->
ulRecdCou
++;

1714 
	}
}

1720 
	$d_log_tim
(

1721 
ut16_t
 
uSecds
)

1723 
TL_LOG_INFO
 *
CutLog
 = 
NULL
;

1724 
iCou
 = 0;

1725 
time_t
 
tNow
 = 0;

1728 
uSecds
 = uSeconds;

1730 
tNow
 = 
	`time
(
NULL
);

1731 
iCou
 = 0; iCou < 
MAX_TREND_LOGS
; iCount++) {

1732 
CutLog
 = &
LogInfo
[
iCou
];

1733 i(
	`TL_Is_Ebd
(
iCou
)) {

1734 i(
CutLog
->
LogggTy
 =
LOGGING_TYPE_POLLED
) {

1738 i(
CutLog
->
bAlignIvs
 =
ue
) {

1747 i((
tNow
 % 
CutLog
->
ulLogIv
) ==

1748 (
CutLog
->
ulIvOfft
 %

1749 
CutLog
->
ulLogIv
)) {

1753 
	`TL_tch_ݔty
(
iCou
);

1754 } i((
tNow
 - 
CutLog
->
tLaDaTime
) >

1755 
CutLog
->
ulLogIv
) {

1761 
	`TL_tch_ݔty
(
iCou
);

1763 } i(((
tNow
 - 
CutLog
->
tLaDaTime
) >=

1764 
CutLog
->
ulLogIv
) ||

1765 (
CutLog
->
bTrigg
 =
ue
)) {

1769 
	`TL_tch_ݔty
(
iCou
);

1772 
CutLog
->
bTrigg
 = 
l
;

1773 } i(
CutLog
->
LogggTy
 =
LOGGING_TYPE_TRIGGERED
) {

1777 i(
CutLog
->
bTrigg
 =
ue
) {

1778 
	`TL_tch_ݔty
(
iCou
);

1779 
CutLog
->
bTrigg
 = 
l
;

1784 
	}
}

	@demo/object/trendlog.h

25 #ide
TRENDLOG_H


26 
	#TRENDLOG_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<time.h
>

31 
	~"bacdef.h
"

32 
	~"cov.h
"

33 
	~".h
"

34 
	~"wp.h
"

36 #ifde
__lulus


41 
	s_r
 {

42 
ut16_t
 
usCss
;

43 
ut16_t
 
usCode
;

44 } 
	tTL_ERROR
;

48 
	s_bs
 {

49 
ut8_t
 
ucL
;

50 
ut8_t
 
ucSte
[4];

51 } 
	tTL_BITS
;

63 
	s_da_cd
 {

64 
time_t
 
tTimeSmp
;

65 
ut8_t
 
ucRecTy
;

66 
ut8_t
 
ucStus
;

68 
ut8_t
 
ucLogStus
;

69 
ut8_t
 
ucBoޗn
;

70 
fRl
;

71 
ut32_t
 
ulEnum
;

72 
ut32_t
 
ulUVue
;

73 
t32_t
 
lSVue
;

74 
TL_BITS
 
Bs
;

75 
TL_ERROR
 
E
;

76 
fTime
;

77 } 
Dum
;

78 } 
	tTL_DATA_REC
;

80 
	#TL_T_START_WILD
 1

	)

81 
	#TL_T_STOP_WILD
 2

	)

83 
	#TL_MAX_ENTRIES
 1000

	)

87 
	s_log_fo
 {

88 
bo
 
bEb
;

89 
BACNET_DATE_TIME
 
STime
;

90 
time_t
 
tSTime
;

91 
BACNET_DATE_TIME
 
StTime
;

92 
time_t
 
tStTime
;

93 
ut8_t
 
ucTimeFgs
;

94 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 
Sour
;

95 
ut32_t
 
ulLogIv
;

96 
bo
 
bStWhFu
;

97 
ut32_t
 
ulRecdCou
;

98 
ut32_t
 
ulTٮRecdCou
;

99 
BACNET_LOGGING_TYPE
 
LogggTy
;

100 
bo
 
bAlignIvs
;

101 
ut32_t
 
ulIvOfft
;

102 
bo
 
bTrigg
;

103 
iIndex
;

104 
time_t
 
tLaDaTime
;

105 } 
	tTL_LOG_INFO
;

113 
	#TL_TYPE_STATUS
 0

	)

114 
	#TL_TYPE_BOOL
 1

	)

115 
	#TL_TYPE_REAL
 2

	)

116 
	#TL_TYPE_ENUM
 3

	)

117 
	#TL_TYPE_UNSIGN
 4

	)

118 
	#TL_TYPE_SIGN
 5

	)

119 
	#TL_TYPE_BITS
 6

	)

120 
	#TL_TYPE_NULL
 7

	)

121 
	#TL_TYPE_ERROR
 8

	)

122 
	#TL_TYPE_DELTA
 9

	)

123 
	#TL_TYPE_ANY
 10

	)

126 
Tnd_Log_Prݔty_Lis
(

127 cڡ **
pRequed
,

128 cڡ **
pOiڮ
,

129 cڡ **
pPrrry
);

131 
bo
 
Tnd_Log_Vid_In
(

132 
ut32_t
 
obje_
);

133 
Tnd_Log_Cou
(

135 
ut32_t
 
Tnd_Log_Index_To_In
(

136 
dex
);

137 
Tnd_Log_In_To_Index
(

138 
ut32_t
 

);

139 
bo
 
Tnd_Log_Obje_In_Add
(

140 
ut32_t
 

);

142 
bo
 
Tnd_Log_Obje_Name
(

143 
ut32_t
 
obje_
,

144 
BACNET_CHARACTER_STRING
 * 
obje_me
);

146 
Tnd_Log_Rd_Prݔty
(

147 
BACNET_READ_PROPERTY_DATA
 * 
da
);

149 
bo
 
Tnd_Log_Wre_Prݔty
(

150 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

151 
Tnd_Log_In
(

154 
TL_In_Stus_Rec
(

155 
iLog
,

156 
BACNET_LOG_STATUS
 
eStus
,

157 
bo
 
bS
);

159 
bo
 
TL_Is_Ebd
(

160 
iLog
);

162 
time_t
 
TL_BAC_Time_To_Lol
(

163 
BACNET_DATE_TIME
 * 
SourTime
);

165 
TL_Lol_Time_To_BAC
(

166 
BACNET_DATE_TIME
 * 
DeTime
,

167 
time_t
 
SourTime
);

169 
TL_code_y
(

170 
ut8_t
 * 
du
,

171 
iLog
,

172 
iEry
);

174 
TL_code_by_posi
(

175 
ut8_t
 * 
du
,

176 
BACNET_READ_RANGE_DATA
 * 
pReque
);

178 
TL_code_by_qu
(

179 
ut8_t
 * 
du
,

180 
BACNET_READ_RANGE_DATA
 * 
pReque
);

182 
TL_code_by_time
(

183 
ut8_t
 * 
du
,

184 
BACNET_READ_RANGE_DATA
 * 
pReque
);

186 
bo
 
TndLogGRRInfo
(

187 
BACNET_READ_RANGE_DATA
 * 
pReque
,

188 
RR_PROP_INFO
 * 
pInfo
);

190 
_d_log_code
(

191 
ut8_t
 * 
du
,

192 
BACNET_READ_RANGE_DATA
 * 
pReque
);

194 
d_log_tim
(

195 
ut16_t
 
uSecds
);

197 #ifde
__lulus


	@demo/perl/perl_bindings.c

1 
	~"bacdef.h
"

2 
	~"hdrs.h
"

3 
	~"banum.h
"

4 
	~"dk.h
"

5 
	~"devi.h
"

6 
	~<time.h
>

7 
	~"f.h
"

10 #unde



13 
ut32_t
 
	gTg_Devi_Obje_In
 = 4194303;

14 
	gTg_Max_APDU
 = 0;

15 
bo
 
	gE_Deed
 = 
l
;

16 
BACNET_ADDRESS
 
	gTg_Addss
;

17 
ut8_t
 
	gReque_Invoke_ID
 = 0;

18 
bo
 
	gisRdPrݔtyHdrRegied
 = 
l
;

19 
bo
 
	gisRdPrݔtyMuɝHdrRegied
 = 
l
;

20 
bo
 
	gisWrePrݔtyHdrRegied
 = 
l
;

21 
bo
 
	gisAtomicWreFeHdrRegied
 = 
l
;

22 
bo
 
	gisAtomicRdFeHdrRegied
 = 
l
;

27 
	#MAX_ERROR_STRING
 128

	)

28 
	#NO_ERROR
 "NE"

	)

29 
	gLa_E
[
MAX_ERROR_STRING
] = 
NO_ERROR
;

30 
	$LogE
(

31 cڡ *
msg
)

33 
	`ry
(
La_E
, 
msg
);

34 
E_Deed
 = 
ue
;

35 
	}
}

37 
	$BaGE
(

38 
SV
 * 
rMsg
)

40 
	`sv_v
(
rMsg
, 
La_E
);

41 
	`ry
(
La_E
, 
NO_ERROR
);

42 
E_Deed
 = 
l
;

43 
	}
}

45 
	$__LogAnsw
(

46 cڡ *
msg
,

47 
nd
)

49 
dSP
;

50 
ENTER
;

51 
SAVETMPS
;

52 
	`PUSHMARK
(
SP
);

53 
	`XPUSHs
(
	`sv_2m܏l
(
	`wSVpv
(
msg
, 0)));

54 
	`XPUSHs
(
	`sv_2m܏l
(
	`wSViv
(
nd
)));

55 
PUTBACK
;

56 
	`_pv
("LogAnsw", 
G_DISCARD
);

57 
FREETMPS
;

58 
LEAVE
;

59 
	}
}

64 
	$MyAbtHdr
(

65 
BACNET_ADDRESS
 * 
c
,

66 
ut8_t
 
voke_id
,

67 
ut8_t
 
abt_as
,

68 
bo
 
rv
)

70 (
rv
;

71 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

72 (
voke_id
 =
Reque_Invoke_ID
)) {

73 
msg
[
MAX_ERROR_STRING
];

74 
	`rtf
(
msg
, "BACnet Abort: %s",

75 
	`baext_abt_as_me
((
abt_as
));

76 
	`LogE
(
msg
);

78 
	}
}

80 
	$MyRejeHdr
(

81 
BACNET_ADDRESS
 * 
c
,

82 
ut8_t
 
voke_id
,

83 
ut8_t
 
je_as
)

85 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

86 (
voke_id
 =
Reque_Invoke_ID
)) {

87 
msg
[
MAX_ERROR_STRING
];

88 
	`rtf
(
msg
, "BACnet Reject: %s",

89 
	`baext_je_as_me
((
je_as
));

90 
	`LogE
(
msg
);

92 
	}
}

94 
	$My_E_Hdr
(

95 
BACNET_ADDRESS
 * 
c
,

96 
ut8_t
 
voke_id
,

97 
BACNET_ERROR_CLASS
 
r_ass
,

98 
BACNET_ERROR_CODE
 
r_code
)

100 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

101 (
voke_id
 =
Reque_Invoke_ID
)) {

102 
msg
[
MAX_ERROR_STRING
];

103 
	`rtf
(
msg
, "BACnet Error: %s: %s",

104 
	`baext_r_ass_me
((
r_ass
),

105 
	`baext_r_code_me
((
r_code
));

106 
	`LogE
(
msg
);

108 
	}
}

117 
	#MAX_ACK_STRING
 512

	)

118 
	$_ack_exa_da
(

119 
BACNET_READ_PROPERTY_DATA
 * 
da
)

121 
ackSg
[
MAX_ACK_STRING
] = "";

122 *
pAckSg
 = &
ackSg
[0];

123 
BACNET_OBJECT_PROPERTY_VALUE
 
obje_vue
;

124 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

125 
n
 = 0;

126 
ut8_t
 *
iti_da
;

127 
iti_da_n
;

128 
bo
 
f_vue
 = 
ue
;

129 
bo
 
t_b
 = 
l
;

131 i(
da
) {

132 
iti_da
 = 
da
->application_data;

133 
iti_da_n
 = 
da
->application_data_len;

137 
n
 =

138 
	`ba_decode_iti_da
(
iti_da
,

139 (
ut8_t

iti_da_n
, &
vue
);

140 i(
f_vue
 && (
n
 < 
iti_da_n
)) {

141 
f_vue
 = 
l
;

142 
	`t
(
pAckSg
, "{", 1);

143 
pAckSg
 += 1;

144 
t_b
 = 
ue
;

146 
obje_vue
.
obje_ty
 = 
da
->object_type;

147 
obje_vue
.
obje_
 = 
da
->object_instance;

148 
obje_vue
.
obje_ݔty
 = 
da
->object_property;

149 
obje_vue
.
y_dex
 = 
da
->array_index;

150 
obje_vue
.
vue
 = &value;

151 
	`ba_tf_vue
(
pAckSg
,

152 
MAX_ACK_STRING
 - (
pAckSg
 - 
ackSg
), &
obje_vue
);

153 i(
n
 > 0) {

154 i(
n
 < 
iti_da_n
) {

155 
iti_da
 +
n
;

156 
iti_da_n
 -
n
;

158 
	`t
(
pAckSg
, ",", 1);

159 
pAckSg
 += 1;

167 i(
t_b
) {

168 
	`t
(
pAckSg
, "}", 1);

169 
pAckSg
 += 1;

172 
	`__LogAnsw
(
ackSg
, 0);

174 
	}
}

179 
	$m_ack_exa_da
(

180 
BACNET_READ_ACCESS_DATA
 * 
m_da
)

182 
BACNET_OBJECT_PROPERTY_VALUE
 
obje_vue
;

183 
BACNET_PROPERTY_REFERENCE
 *
liOfPrݔts
;

184 
BACNET_APPLICATION_DATA_VALUE
 *
vue
;

185 
bo
 
y_vue
 = 
l
;

186 
ackSg
[
MAX_ACK_STRING
] = "";

187 *
pAckSg
 = &
ackSg
[0];

189 i(
m_da
) {

190 
liOfPrݔts
 = 
m_da
->listOfProperties;

191 
liOfPrݔts
) {

192 
vue
 = 
liOfPrݔts
->value;

193 i(
vue
) {

194 i(
vue
->
xt
) {

195 
	`t
(
pAckSg
, "{", 1);

196 
pAckSg
++;

197 
y_vue
 = 
ue
;

199 
y_vue
 = 
l
;

201 
obje_vue
.
obje_ty
 = 
m_da
->object_type;

202 
obje_vue
.
obje_
 = 
m_da
->object_instance;

203 
vue
) {

204 
obje_vue
.
obje_ݔty
 =

205 
liOfPrݔts
->
ݔtyIdtifr
;

206 
obje_vue
.
y_dex
 =

207 
liOfPrݔts
->
ݔtyAayIndex
;

208 
obje_vue
.
vue
 = value;

209 
	`ba_tf_vue
(
pAckSg
,

210 
MAX_ACK_STRING
 - (
pAckSg
 - 
ackSg
),

211 &
obje_vue
);

212 i(
vue
->
xt
) {

213 
	`t
(
pAckSg
, ",", 1);

214 
pAckSg
++;

216 i(
y_vue
) {

217 
	`t
(
pAckSg
, "}", 1);

218 
pAckSg
++;

221 
vue
 = vue->
xt
;

225 
	`rtf
(
ackSg
, "BACnet Error: %s: %s",

226 
	`baext_r_ass_me
((
liOfPrݔts
->

227 
r
.
r_ass
),

228 
	`baext_r_code_me
((
liOfPrݔts
->

229 
r
.
r_code
));

230 
	`LogE
(
ackSg
);

232 
liOfPrݔts
 =iOfPrݔts->
xt
;

236 
	`t
(
pAckSg
, "QQQ", 3);

237 
pAckSg
 += 3;

241 
	`__LogAnsw
(
ackSg
, 1);

243 
	}
}

245 
	$AtomicRdFeAckHdr
(

246 
ut8_t
 * 
rvi_que
,

247 
ut16_t
 
rvi_n
,

248 
BACNET_ADDRESS
 * 
c
,

249 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

251 
n
 = 0;

252 
BACNET_ATOMIC_READ_FILE_DATA
 
da
;

254 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

255 (
rvi_da
->
voke_id
 =
Reque_Invoke_ID
)) {

256 
n
 =

257 
	`f_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
,

258 &
da
);

259 i(
n
 > 0) {

261 i((
da
.
acss
 =
FILE_STREAM_ACCESS
) &&

262 (
rvi_da
->
voke_id
 =
Reque_Invoke_ID
)) {

263 
msg
[32];

264 
ut8_t
 *
pFeDa
;

265 
i
;

267 
	`rtf
(
msg
, "EOF=%d,t=%d,", 
da
.
dOfFe
,

268 
da
.
ty
.
am
.
feSPosi
);

269 
	`__LogAnsw
(
msg
, 0);

271 
pFeDa
 = 
	`org_vue
(&
da
.
feDa
);

272 
i
 = 0; i < 
	`org_ngth
(&
da
.
feDa
); i++) {

273 
	`rtf
(
msg
, "%02x ", *
pFeDa
);

274 
	`__LogAnsw
(
msg
, 1);

275 
pFeDa
++;

278 
	`LogE
("Bad streamccesseported");

282 
	}
}

296 
	$My_Rd_Prݔty_Ack_Hdr
(

297 
ut8_t
 * 
rvi_que
,

298 
ut16_t
 
rvi_n
,

299 
BACNET_ADDRESS
 * 
c
,

300 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

302 
n
 = 0;

303 
BACNET_READ_PROPERTY_DATA
 
da
;

305 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

306 (
rvi_da
->
voke_id
 =
Reque_Invoke_ID
)) {

307 
n
 =

308 
	`_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

309 i(
n
 > 0) {

310 
	`_ack_exa_da
(&
da
);

313 
	}
}

326 
	$My_Rd_Prݔty_Muɝ_Ack_Hdr
(

327 
ut8_t
 * 
rvi_que
,

328 
ut16_t
 
rvi_n
,

329 
BACNET_ADDRESS
 * 
c
,

330 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

332 
n
 = 0;

333 
BACNET_READ_ACCESS_DATA
 *
m_da
;

334 
BACNET_READ_ACCESS_DATA
 *
d_m_da
;

335 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

336 
BACNET_PROPERTY_REFERENCE
 *
d_m_ݔty
;

337 
BACNET_APPLICATION_DATA_VALUE
 *
vue
;

338 
BACNET_APPLICATION_DATA_VALUE
 *
d_vue
;

340 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

341 (
rvi_da
->
voke_id
 =
Reque_Invoke_ID
)) {

342 
m_da
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

343 i(
m_da
) {

344 
n
 =

345 
	`m_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
,

346 
m_da
);

348 i(
n
 > 0) {

349 
m_da
) {

350 
	`m_ack_exa_da
(
m_da
);

351 
m_ݔty
 = 
m_da
->
liOfPrݔts
;

352 
m_ݔty
) {

353 
vue
 = 
m_ݔty
->value;

354 
vue
) {

355 
d_vue
 = 
vue
;

356 
vue
 = vue->
xt
;

357 
	`
(
d_vue
);

359 
d_m_ݔty
 = 
m_ݔty
;

360 
m_ݔty
 =pm_ݔty->
xt
;

361 
	`
(
d_m_ݔty
);

363 
d_m_da
 = 
m_da
;

364 
m_da
 =pm_da->
xt
;

365 
	`
(
d_m_da
);

368 
	`LogE
("RPM Ack Malformed! Freeing memory...");

369 
m_da
) {

370 
m_ݔty
 = 
m_da
->
liOfPrݔts
;

371 
m_ݔty
) {

372 
vue
 = 
m_ݔty
->value;

373 
vue
) {

374 
d_vue
 = 
vue
;

375 
vue
 = vue->
xt
;

376 
	`
(
d_vue
);

378 
d_m_ݔty
 = 
m_ݔty
;

379 
m_ݔty
 =pm_ݔty->
xt
;

380 
	`
(
d_m_ݔty
);

382 
d_m_da
 = 
m_da
;

383 
m_da
 =pm_da->
xt
;

384 
	`
(
d_m_da
);

388 
	}
}

390 
	$My_Wre_Prݔty_SimeAck_Hdr
(

391 
BACNET_ADDRESS
 * 
c
,

392 
ut8_t
 
voke_id
)

394 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

395 (
voke_id
 =
Reque_Invoke_ID
)) {

396 
	`__LogAnsw
("WriteProperty Acknowledged!", 0);

398 
	}
}

401 
	$In_Svi_Hdrs
(

404 
	`Devi_In
(
NULL
);

407 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

410 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

414 
du_t_uecognized_rvi_hdr_hdr


415 (
hdr_uecognized_rvi
);

418 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

419 
hdr_ad_ݔty
);

422 
	`du_t_abt_hdr
(
MyAbtHdr
);

423 
	`du_t_je_hdr
(
MyRejeHdr
);

424 
	}
}

427 
	mwaAnsw
,

428 
	mwaBd
,

429 } 
	twaAi
;

431 
	$Wa_F_Answ_Or_Timeout
(

432 
timeout_ms
,

433 
waAi
 
ai
)

436 
time_t
 
ϡ_cds
 = 
	`time
(
NULL
);

437 
time_t
 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

438 
time_t
 
d_cds
 = 0;

439 
ut16_t
 
pdu_n
 = 0;

440 
BACNET_ADDRESS
 
c
 = { 0 };

441 
ut8_t
 
Rx_Buf
[
MAX_MPDU
] = { 0 };

443 
ue
) {

444 
time_t
 
cut_cds
 = 
	`time
(
NULL
);

447 i(
E_Deed
) {

448 
	`LogE
("Some otherrror occurred");

452 i(
d_cds
 > 
timeout_cds
) {

453 
	`LogE
("APDU Timeout");

458 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout_ms
);

459 i(
pdu_n
) {

460 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

464 i(
cut_cds
 !
ϡ_cds
) {

465 
	`tsm_tim_mlicds
(((
cut_cds
 - 
ϡ_cds
) * 1000));

468 i(
ai
 =
waAnsw
) {

470 i(
	`tsm_voke_id_
(
Reque_Invoke_ID
)) {

472 } i(
	`tsm_voke_id_ed
(
Reque_Invoke_ID
)) {

473 
	`LogE
("TSM Timeout!");

474 
	`tsm__voke_id
(
Reque_Invoke_ID
);

477 } i(
ai
 =
waBd
) {

478 i(
	`addss_bd_que
(
Tg_Devi_Obje_In
,

479 &
Tg_Max_APDU
, &
Tg_Addss
)) {

483 
	`LogE
("Invalid waitActionequested");

488 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

489 
ϡ_cds
 = 
cut_cds
;

491 
	}
}

500 
	$BaPComm
(

504 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

505 
	`addss_
();

506 
	`In_Svi_Hdrs
();

507 
	`dnv_
();

508 
	}
}

514 
	$BaBdToDevi
(

515 
deviInNumb
)

517 
isFau
 = 0;

521 
Tg_Devi_Obje_In
 = 
deviInNumb
;

524 i(!
	`addss_bd_que
(
deviInNumb
, &
Tg_Max_APDU
,

525 &
Tg_Addss
)) {

526 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

527 
Tg_Devi_Obje_In
);

530 
	`Wa_F_Answ_Or_Timeout
(100, 
waBd
);

533 
isFau
 = 
E_Deed
;

534 
E_Deed
 = 
l
;

535  
isFau
;

536 
	}
}

541 
	$BaRdPrݔty
(

542 
deviInNumb
,

543 
objeTy
,

544 
objeInNumb
,

545 
objePrݔty
,

546 
objeIndex
)

548 i(!
isRdPrݔtyHdrRegied
) {

550 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

551 
My_Rd_Prݔty_Ack_Hdr
);

554 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

555 
My_E_Hdr
);

558 
isRdPrݔtyHdrRegied
 = 
ue
;

561 
Reque_Invoke_ID
 =

562 
	`Sd_Rd_Prݔty_Reque
(
deviInNumb
, 
objeTy
,

563 
objeInNumb
, 
objePrݔty
, 
objeIndex
);

564 
	`Wa_F_Answ_Or_Timeout
(100, 
waAnsw
);

566 
isFau
 = 
E_Deed
;

567 
E_Deed
 = 0;

568  
isFau
;

569 
	}
}

574 
	$BaRdPrݔtyMuɝ
(

575 
deviInNumb
,

579 
Iƚe_Sck_Vs
;

580 
mIndex
 = 1;

581 
BACNET_READ_ACCESS_DATA
 *
m_obje
 =

582 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

583 
BACNET_READ_ACCESS_DATA
 *
Rd_Acss_Da
 = 
m_obje
;

584 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

585 
ut8_t
 
bufr
[
MAX_PDU
] = { 0 };

587 
mIndex
 < 
Iƚe_Sck_Ims
) {

588 
SV
 *
pSV
 = 
	`Iƚe_Sck_Im
(
mIndex
++);

591 i(
	`SvTYPE
(
	`SvRV
(
pSV
)!
SVt_PVAV
) {

592 
	`LogE
("Argument isotn Arrayeference");

596 i(
m_obje
) {

597 
m_obje
->
liOfPrݔts
 = 
NULL
;

599 
	`LogE
("Memory Allocation Issue");

603 
AV
 *
pAV
 = (AV *
	`SvRV
(
pSV
);

604 
SV
 **
SV
;

607 
SV
 = 
	`av_tch
(
pAV
, 0, 0);

608 i(
SV
) {

609 
m_obje
->
obje_ty
 = 
	`SvIV
(*
SV
);

611 
	`LogE
("Problemarsinghe Array ofrguments");

616 
SV
 = 
	`av_tch
(
pAV
, 1, 0);

617 i(
SV
) {

618 
m_obje
->
obje_
 = 
	`SvIV
(*
SV
);

620 
	`LogE
("Problemarsinghe Array ofrguments");

625 
SV
 = 
	`av_tch
(
pAV
, 2, 0);

626 i(
SV
) {

627 
m_ݔty
 = 
	`oc
(1, (
BACNET_PROPERTY_REFERENCE
));

628 
m_obje
->
liOfPrݔts
 = 
m_ݔty
;

629 i(
m_ݔty
) {

630 
m_ݔty
->
ݔtyIdtifr
 = 
	`SvIV
(*
SV
);

632 
	`LogE
("Memoryllocationrror");

636 
	`LogE
("Problemarsinghe Array ofrguments");

641 
SV
 = 
	`av_tch
(
pAV
, 3, 0);

642 i(
SV
) {

643 
m_ݔty
->
ݔtyAayIndex
 = 
	`SvIV
(*
SV
);

645 
	`LogE
("Problemarsinghe Array ofrguments");

650 i(
mIndex
 < 
Iƚe_Sck_Ims
) {

651 
m_obje
->
xt
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

652 
m_obje
 =pm_obje->
xt
;

654 
m_obje
->
xt
 = 
NULL
;

658 i(!
isRdPrݔtyMuɝHdrRegied
) {

660 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

661 
My_Rd_Prݔty_Muɝ_Ack_Hdr
);

664 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

665 
My_E_Hdr
);

668 
isRdPrݔtyMuɝHdrRegied
 = 
ue
;

671 i(!
E_Deed
) {

672 
Reque_Invoke_ID
 =

673 
	`Sd_Rd_Prݔty_Muɝ_Reque
(&
bufr
[0], (buffer),

674 
deviInNumb
, 
Rd_Acss_Da
);

675 
	`Wa_F_Answ_Or_Timeout
(100, 
waAnsw
);

678 
BACNET_READ_ACCESS_DATA
 *
d_m_obje
;

679 
BACNET_PROPERTY_REFERENCE
 *
d_m_ݔty
;

681 
m_obje
 = 
Rd_Acss_Da
;

682 
d_m_obje
 = 
m_obje
;

683 
m_obje
) {

684 
m_ݔty
 = 
m_obje
->
liOfPrݔts
;

685 
m_ݔty
) {

686 
d_m_ݔty
 = 
m_ݔty
;

687 
m_ݔty
 =pm_ݔty->
xt
;

688 
	`
(
d_m_ݔty
);

690 
d_m_obje
 = 
m_obje
;

691 
m_obje
 =pm_obje->
xt
;

692 
	`
(
d_m_obje
);

696 
isFau
 = 
E_Deed
;

697 
E_Deed
 = 0;

698  
isFau
;

699 
	}
}

704 
	$BaWrePrݔty
(

705 
deviInNumb
,

706 
objeTy
,

707 
objeInNumb
,

708 
objePrݔty
,

709 
objePriܙy
,

710 
objeIndex
,

711 cڡ *
g
,

712 cڡ *
vue
)

714 
msg
[
MAX_ERROR_STRING
];

715 
isFau
 = 1;

717 i(!
isWrePrݔtyHdrRegied
) {

719 
	`du_t_cfmed_sime_ack_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

720 
My_Wre_Prݔty_SimeAck_Hdr
);

723 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

724 
My_E_Hdr
);

727 
isWrePrݔtyHdrRegied
 = 
ue
;

730 i(
objeIndex
 == -1) {

731 
objeIndex
 = 
BACNET_ARRAY_ALL
;

736 
ut8_t
 
cڋxt_g
 = 0;

737 
BACNET_APPLICATION_TAG
 
ݔty_g
;

738 
BACNET_APPLICATION_DATA_VALUE
 
ݔtyVue
;

740 i(
	`tou
(
g
[0]) == 'C') {

741 
cڋxt_g
 = 
	`
(&
g
[1], 
NULL
, 0);

742 
ݔtyVue
.
cڋxt_g
 = context_tag;

743 
ݔtyVue
.
cڋxt_ecific
 = 
ue
;

745 
ݔtyVue
.
cڋxt_ecific
 = 
l
;

747 
ݔty_g
 = 
	`
(
g
, 
NULL
, 0);

749 i(
ݔty_g
 >
MAX_BACNET_APPLICATION_TAG
) {

750 
	`rtf
(
msg
, "Error:ag=%u - it must beesshan %u",

751 
ݔty_g
, 
MAX_BACNET_APPLICATION_TAG
);

752 
	`LogE
(
msg
);

755 i(!
	`ba_r_iti_da
(
ݔty_g
, 
vue
,

756 &
ݔtyVue
)) {

757 
	`rtf
(
msg
, "Error: unableoarseheag value");

758 
	`LogE
(
msg
);

761 
ݔtyVue
.
xt
 = 
NULL
;

764 
Reque_Invoke_ID
 =

765 
	`Sd_Wre_Prݔty_Reque
(
deviInNumb
, 
objeTy
,

766 
objeInNumb
, 
objePrݔty
, &
ݔtyVue
,

767 
objePriܙy
, 
objeIndex
);

768 
	`Wa_F_Answ_Or_Timeout
(100, 
waAnsw
);

772 
isFau
 = 
E_Deed
;

773 } 
l
);

776 
E_Deed
 = 
l
;

777  
isFau
;

778 
	}
}

781 
	$BaAtomicWreFe
(

782 
deviInNumb
,

783 
feInNumb
,

784 
blockSAddr
,

785 
blockNumBys
,

786 *
nibbBufr
)

788 
BACNET_OCTET_STRING
 
feDa
;

789 
i
, 
nibb
;

790 
ut8_t
 
byVue
;

791 
nibbVue
;

793 i(!
isAtomicWreFeHdrRegied
) {

795 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
,

796 
My_E_Hdr
);

799 
isAtomicWreFeHdrRegied
 = 
ue
;

802 
i
 = 0; i < 
blockNumBys
; i++) {

803 
byVue
 = 0;

804 
nibb
 = 0;ibble < 2;ibble++) {

805 
nibbVue
 = 
	`tou
(
nibbBufr
[
i
 * 2 + 
nibb
]);

806 i((
nibbVue
 >= '0') && (nibbleValue <= '9')) {

807 
byVue
 +(
nibbVue
 - '0'<< (4 * (1 - 
nibb
));

808 } i((
nibbVue
 >= 'A') && (nibbleValue <= 'F')) {

809 
byVue
 +(
nibbVue
 - 'A' + 10<< (4 * (1 - 
nibb
));

811 
	`LogE
("Bad data in buffer.");

814 
feDa
.
vue
[
i
] = 
byVue
;

816 
	`org_un
(&
feDa
, 
blockNumBys
);

819 i(!
E_Deed
) {

820 
Reque_Invoke_ID
 =

821 
	`Sd_Atomic_Wre_Fe_Sm
(
deviInNumb
,

822 
feInNumb
, 
blockSAddr
, &
feDa
);

823 
	`Wa_F_Answ_Or_Timeout
(100, 
waAnsw
);

826 
isFau
 = 
E_Deed
;

827 
E_Deed
 = 0;

828  
isFau
;

829 
	}
}

831 
	$BaGMaxApdu
(

834 
queedOCou
 = 0;

835 
ut16_t
 
my_max_du
 = 0;

841 i(
Tg_Max_APDU
 < 
MAX_APDU
) {

842 
my_max_du
 = 
Tg_Max_APDU
;

844 
my_max_du
 = 
MAX_APDU
;

847 i(
my_max_du
 <= 50) {

848 
queedOCou
 = 
my_max_du
 - 19;

849 } i(
my_max_du
 <= 480) {

850 
queedOCou
 = 
my_max_du
 - 32;

851 } i(
my_max_du
 <= 1476) {

852 
queedOCou
 = 
my_max_du
 - 64;

854 
queedOCou
 = 
my_max_du
 / 2;

857  
queedOCou
;

858 
	}
}

860 
	$BaTimeSync
(

861 
deviInNumb
,

862 
yr
,

863 
mth
,

864 
day
,

865 
hour
,

866 
mu
,

867 
cd
,

868 
isUTC
,

869 
UTCOfft
)

871 
BACNET_DATE
 
bde
;

872 
BACNET_TIME
 
btime
;

873 
tm
 
my_time
;

874 
time_t
 
aTime
;

875 
tm
 *
wTime
;

877 
my_time
.
tm_c
 = 
cd
;

878 
my_time
.
tm_m
 = 
mu
;

879 
my_time
.
tm_hour
 = 
hour
;

880 
my_time
.
tm_mday
 = 
day
;

881 
my_time
.
tm_m
 = 
mth
 - 1;

882 
my_time
.
tm_yr
 = 
yr
 - 1900;

883 
my_time
.
tm_wday
 = 0;

884 
my_time
.
tm_yday
 = 0;

885 
my_time
.
tm_isd
 = 0;

887 
aTime
 = 
	`mktime
(&
my_time
);

888 
wTime
 = 
	`loime
(&
aTime
);

890 
bde
.
yr
 = 
wTime
->
tm_yr
;

891 
bde
.
mth
 = 
wTime
->
tm_m
 + 1;

892 
bde
.
day
 = 
wTime
->
tm_mday
;

893 
bde
.
wday
 = 
wTime
->
tm_wday
 ?ewTime->tm_wday : 7;

894 
btime
.
hour
 = 
wTime
->
tm_hour
;

895 
btime
.
m
 = 
wTime
->
tm_m
;

896 
btime
.
c
 = 
wTime
->
tm_c
;

897 
btime
.
hunddths
 = 0;

899 
n
 = 0;

900 
pdu_n
 = 0;

901 
bys_
 = 0;

902 
BACNET_NPDU_DATA
 
du_da
;

903 
BACNET_ADDRESS
 
my_addss
;

904 
ut8_t
 
Hdr_Tnsm_Bufr
[
MAX_PDU
] = { 0 };

908 i(!
	`dcc_communiti_abd
()) {

909 
	`LogE
("DCC communicaiton isotnabled");

914 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

915 
	`dk_g_my_addss
(&
my_addss
);

916 
pdu_n
 =

917 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], &
Tg_Addss
,

918 &
my_addss
, &
du_da
);

921 
n
 =

922 
	`timesync_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
], &
bde
,

923 &
btime
);

924 
pdu_n
 +
n
;

927 
bys_
 =

928 
	`dk_nd_pdu
(&
Tg_Addss
, &
du_da
,

929 &
Hdr_Tnsm_Bufr
[0], 
pdu_n
);

930 i(
bys_
 <= 0) {

931 
rMsg
[64];

932 
	`rtf
(
rMsg
,

934 
	`
(
o
));

935 
	`LogE
(
rMsg
);

939 
	`Wa_F_Answ_Or_Timeout
(100, 
waAnsw
);

940 } 
l
);

942 
isFau
 = 
E_Deed
;

943 
E_Deed
 = 0;

944  
isFau
;

945 
	}
}

950 
	$BaAtomicRdFe
(

951 
deviInNumb
,

952 
feInNumb
,

953 
tOfft
,

954 
numBys
)

956 i(!
isAtomicRdFeHdrRegied
) {

958 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_ATOMIC_READ_FILE
,

959 
AtomicRdFeAckHdr
);

962 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_ATOMIC_READ_FILE
,

963 
My_E_Hdr
);

966 
isAtomicRdFeHdrRegied
 = 
ue
;

969 
Reque_Invoke_ID
 =

970 
	`Sd_Atomic_Rd_Fe_Sm
(
deviInNumb
, 
feInNumb
,

971 
tOfft
, 
numBys
);

972 
	`Wa_F_Answ_Or_Timeout
(100, 
waAnsw
);

974 
isFau
 = 
E_Deed
;

975 
E_Deed
 = 0;

976  
isFau
;

977 
	}
}

	@demo/piface/device.c

25 
	~<dbo.h
>

26 
	~<dt.h
>

27 
	~<rg.h
>

28 
	~<time.h
>

29 
	~"bacdef.h
"

30 
	~"bacdcode.h
"

31 
	~"banum.h
"

32 
	~"ba.h
"

33 
	~"cfig.h
"

34 
	~"du.h
"

35 
	~"wp.h
"

36 
	~".h
"

37 
	~"dcc.h
"

38 
	~"vsi.h
"

39 
	~"devi.h
"

40 
	~"hdrs.h
"

41 
	~"dk.h
"

42 
	~"addss.h
"

44 
	~"tim.h
"

46 
	~"devi.h
"

47 
	~"bi.h
"

48 
	~"bo.h
"

51 
Devi_Rd_Prݔty_Lol
(

52 
BACNET_READ_PROPERTY_DATA
 * 
da
);

53 
bo
 
Devi_Wre_Prݔty_Lol
(

54 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

55 
Roud_Devi_Rd_Prݔty_Lol
(

56 
BACNET_READ_PROPERTY_DATA
 * 
da
);

57 
bo
 
Roud_Devi_Wre_Prݔty_Lol
(

58 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

61 
obje_funis_t
 *
	gObje_Tab
;

63 
obje_funis_t
 
	gMy_Obje_Tab
[] = {

64 {
OBJECT_DEVICE
,

65 
NULL
 ,

66 
Devi_Cou
,

67 
Devi_Index_To_In
,

68 
Devi_Vid_Obje_In_Numb
,

69 
Devi_Obje_Name
,

70 
Devi_Rd_Prݔty_Lol
,

71 
Devi_Wre_Prݔty_Lol
,

72 
Devi_Prݔty_Lis
,

73 
DeviGRRInfo
,

74 
NULL
 ,

75 
NULL
 ,

76 
NULL
 ,

77 
NULL
 ,

78 
NULL
 },

79 {
OBJECT_BINARY_INPUT
,

80 
By_Iut_In
,

81 
By_Iut_Cou
,

82 
By_Iut_Index_To_In
,

83 
By_Iut_Vid_In
,

84 
By_Iut_Obje_Name
,

85 
By_Iut_Rd_Prݔty
,

86 
By_Iut_Wre_Prݔty
,

87 
By_Iut_Prݔty_Lis
,

88 
NULL
 ,

89 
NULL
 ,

90 
By_Iut_Encode_Vue_Li
,

91 
By_Iut_Chge_Of_Vue
,

92 
By_Iut_Chge_Of_Vue_Cˬ
,

93 
NULL
 },

94 {
OBJECT_BINARY_OUTPUT
,

95 
By_Ouut_In
,

96 
By_Ouut_Cou
,

97 
By_Ouut_Index_To_In
,

98 
By_Ouut_Vid_In
,

99 
By_Ouut_Obje_Name
,

100 
By_Ouut_Rd_Prݔty
,

101 
By_Ouut_Wre_Prݔty
,

102 
By_Ouut_Prݔty_Lis
,

103 
NULL
 ,

104 
NULL
 ,

105 
NULL
 ,

106 
NULL
 ,

107 
NULL
 ,

108 
NULL
 },

109 {
MAX_BACNET_OBJECT_TYPE
,

110 
NULL
 ,

111 
NULL
 ,

112 
NULL
 ,

113 
NULL
 ,

114 
NULL
 ,

115 
NULL
 ,

116 
NULL
 ,

117 
NULL
 ,

118 
NULL
 ,

119 
NULL
 ,

120 
NULL
 ,

121 
NULL
 ,

122 
NULL
 ,

123 
NULL
 }

133 
obje_funis
 *
	$Devi_Objes_Fd_Funis
(

134 
BACNET_OBJECT_TYPE
 
Obje_Ty
)

136 
obje_funis
 *
pObje
 = 
NULL
;

138 
pObje
 = 
Obje_Tab
;

139 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

141 i(
pObje
->
Obje_Ty
 == Object_Type) {

142  (
pObje
);

144 
pObje
++;

147  (
NULL
);

148 
	}
}

159 
_fo_funi
 
	$Devi_Objes_RR_Info
(

160 
BACNET_OBJECT_TYPE
 
obje_ty
)

162 
obje_funis
 *
pObje
 = 
NULL
;

164 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

165  (
pObje
 !
NULL
 ?Obje->
Obje_RR_Info
 : NULL);

166 
	}
}

179 
	$Devi_Objes_Prݔty_Li
(

180 
BACNET_OBJECT_TYPE
 
obje_ty
,

181 
ecl_ݔty_li_t
 *
pPrݔtyLi
)

183 
obje_funis
 *
pObje
 = 
NULL
;

185 
pPrݔtyLi
->
Requed
.
pLi
 = 
NULL
;

186 
pPrݔtyLi
->
Oiڮ
.
pLi
 = 
NULL
;

187 
pPrݔtyLi
->
Prrry
.
pLi
 = 
NULL
;

194 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

195 i((
pObje
 !
NULL
&& (pObje->
Obje_RPM_Li
 != NULL)) {

196 
pObje
->
	`Obje_RPM_Li
(&
pPrݔtyLi
->
Requed
.
pLi
,

197 &
pPrݔtyLi
->
Oiڮ
.
pLi
, &pPrݔtyLi->
Prrry
.pList);

201 
pPrݔtyLi
->
Requed
.
cou
 =

202 
pPrݔtyLi
->
Requed
.
pLi
 ==

203 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Requed
.
pLi
);

205 
pPrݔtyLi
->
Oiڮ
.
cou
 =

206 
pPrݔtyLi
->
Oiڮ
.
pLi
 ==

207 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Oiڮ
.
pLi
);

209 
pPrݔtyLi
->
Prrry
.
cou
 =

210 
pPrݔtyLi
->
Prrry
.
pLi
 ==

211 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Prrry
.
pLi
);

214 
	}
}

217 cڡ 
	gDevi_Prݔts_Requed
[] = {

218 
PROP_OBJECT_IDENTIFIER
,

219 
PROP_OBJECT_NAME
,

220 
PROP_OBJECT_TYPE
,

221 
PROP_SYSTEM_STATUS
,

222 
PROP_VENDOR_NAME
,

223 
PROP_VENDOR_IDENTIFIER
,

224 
PROP_MODEL_NAME
,

225 
PROP_FIRMWARE_REVISION
,

226 
PROP_APPLICATION_SOFTWARE_VERSION
,

227 
PROP_PROTOCOL_VERSION
,

228 
PROP_PROTOCOL_REVISION
,

229 
PROP_PROTOCOL_SERVICES_SUPPORTED
,

230 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

231 
PROP_OBJECT_LIST
,

232 
PROP_MAX_APDU_LENGTH_ACCEPTED
,

233 
PROP_SEGMENTATION_SUPPORTED
,

234 
PROP_APDU_TIMEOUT
,

235 
PROP_NUMBER_OF_APDU_RETRIES
,

236 
PROP_DEVICE_ADDRESS_BINDING
,

237 
PROP_DATABASE_REVISION
,

241 cڡ 
	gDevi_Prݔts_Oiڮ
[] = {

242 #i
defed
(
BACDL_MSTP
)

243 
PROP_MAX_MASTER
,

244 
PROP_MAX_INFO_FRAMES
,

246 
PROP_DESCRIPTION
,

247 
PROP_LOCAL_TIME
,

248 
PROP_UTC_OFFSET
,

249 
PROP_LOCAL_DATE
,

250 
PROP_DAYLIGHT_SAVINGS_STATUS
,

251 
PROP_LOCATION
,

252 
PROP_ACTIVE_COV_SUBSCRIPTIONS
,

256 cڡ 
	gDevi_Prݔts_Prrry
[] = {

260 
	$Devi_Prݔty_Lis
(

261 cڡ **
pRequed
,

262 cڡ **
pOiڮ
,

263 cڡ **
pPrrry
)

265 i(
pRequed
)

266 *
pRequed
 = 
Devi_Prݔts_Requed
;

267 i(
pOiڮ
)

268 *
pOiڮ
 = 
Devi_Prݔts_Oiڮ
;

269 i(
pPrrry
)

270 *
pPrrry
 = 
Devi_Prݔts_Prrry
;

273 
	}
}

280 
ut32_t
 
	gObje_In_Numb
 = 260001;

281 
BACNET_CHARACTER_STRING
 
	gMy_Obje_Name
;

282 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

283 *
	gVd_Name
 = 
BACNET_VENDOR_NAME
;

284 
ut16_t
 
	gVd_Idtifr
 = 
BACNET_VENDOR_ID
;

285 
	gMod_Name
[
MAX_DEV_MOD_LEN
 + 1] = "PiFace Digital";

286 
	gAliti_Sowe_Vsi
[
MAX_DEV_VER_LEN
 + 1] = "1.0";

287 
	gLoti
[
MAX_DEV_LOC_LEN
 + 1] = "USA";

288 
	gDesti
[
MAX_DEV_DESC_LEN
 + 1] = "Raspberry PiFace Digital Demo";

298 
BACNET_TIME
 
	gLol_Time
;

299 
BACNET_DATE
 
	gLol_De
;

304 
t32_t
 
	gUTC_Offt
 = 5 * 60;

305 
bo
 
	gDaylight_Savgs_Stus
 = 
l
;

311 
ut32_t
 
	gDaba_Revisi
 = 0;

321 
BACNET_REINITIALIZED_STATE
 
	gRelize_S
 = 
BACNET_REINIT_IDLE
;

322 cڡ *
	gRe_Passwd
 = "raspberry";

337 
bo
 
	$Devi_Relize
(

338 
BACNET_REINITIALIZE_DEVICE_DATA
 * 
rd_da
)

340 
bo
 
us
 = 
l
;

343 i(
	`charg_si_me
(&
rd_da
->
sswd
, 
Re_Passwd
)) {

344 
rd_da
->
e
) {

345 
BACNET_REINIT_COLDSTART
:

346 
BACNET_REINIT_WARMSTART
:

347 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

351 
Relize_S
 = 
rd_da
->
e
;

352 
us
 = 
ue
;

354 
BACNET_REINIT_STARTBACKUP
:

355 
BACNET_REINIT_ENDBACKUP
:

356 
BACNET_REINIT_STARTRESTORE
:

357 
BACNET_REINIT_ENDRESTORE
:

358 
BACNET_REINIT_ABORTRESTORE
:

359 i(
	`dcc_communiti_dibd
()) {

360 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

361 
rd_da
->
r_code
 = 
ERROR_CODE_COMMUNICATION_DISABLED
;

363 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

364 
rd_da
->
r_code
 =

365 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

369 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

370 
rd_da
->
r_code
 = 
ERROR_CODE_PARAMETER_OUT_OF_RANGE
;

374 
rd_da
->
r_ass
 = 
ERROR_CLASS_SECURITY
;

375 
rd_da
->
r_code
 = 
ERROR_CODE_PASSWORD_FAILURE
;

378  
us
;

379 
	}
}

381 
BACNET_REINITIALIZED_STATE
 
	$Devi_Relized_S
(

384  
Relize_S
;

385 
	}
}

387 
	$Devi_Cou
(

391 
	}
}

393 
ut32_t
 
	$Devi_Index_To_In
(

394 
dex
)

396 
dex
 = index;

397  
Obje_In_Numb
;

398 
	}
}

408 
ut32_t
 
	$Devi_Obje_In_Numb
(

411 #ifde
BAC_ROUTING


412  
	`Roud_Devi_Obje_In_Numb
();

414  
Obje_In_Numb
;

416 
	}
}

418 
bo
 
	$Devi_S_Obje_In_Numb
(

419 
ut32_t
 
obje_id
)

421 
bo
 
us
 = 
ue
;

423 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

425 
Obje_In_Numb
 = 
obje_id
;

426 
	`Devi_Inc_Daba_Revisi
();

428 
us
 = 
l
;

430  
us
;

431 
	}
}

433 
bo
 
	$Devi_Vid_Obje_In_Numb
(

434 
ut32_t
 
obje_id
)

436  (
Obje_In_Numb
 =
obje_id
);

437 
	}
}

439 
bo
 
	$Devi_Obje_Name
(

440 
ut32_t
 
obje_
,

441 
BACNET_CHARACTER_STRING
 * 
obje_me
)

443 
bo
 
us
 = 
l
;

445 i(
obje_
 =
Obje_In_Numb
) {

446 
us
 = 
	`charg_cy
(
obje_me
, &
My_Obje_Name
);

449  
us
;

450 
	}
}

452 
bo
 
	$Devi_S_Obje_Name
(

453 
BACNET_CHARACTER_STRING
 * 
obje_me
)

455 
bo
 
us
 = 
l
;

457 i(!
	`charg_me
(&
My_Obje_Name
, 
obje_me
)) {

459 
us
 = 
	`charg_cy
(&
My_Obje_Name
, 
obje_me
);

460 
	`Devi_Inc_Daba_Revisi
();

463  
us
;

464 
	}
}

466 
BACNET_DEVICE_STATUS
 
	$Devi_Syem_Stus
(

469  
Syem_Stus
;

470 
	}
}

472 
	$Devi_S_Syem_Stus
(

473 
BACNET_DEVICE_STATUS
 
us
,

474 
bo
 
lol
)

476 
su
 = 0;

480 i(
lol
) {

481 
us
) {

482 
STATUS_OPERATIONAL
:

483 
STATUS_OPERATIONAL_READ_ONLY
:

484 
STATUS_DOWNLOAD_REQUIRED
:

485 
STATUS_DOWNLOAD_IN_PROGRESS
:

486 
STATUS_NON_OPERATIONAL
:

487 
Syem_Stus
 = 
us
;

491 
STATUS_BACKUP_IN_PROGRESS
:

492 
su
 = -2;

496 
su
 = -1;

500 
us
) {

506 
STATUS_OPERATIONAL
:

507 
STATUS_OPERATIONAL_READ_ONLY
:

508 
STATUS_NON_OPERATIONAL
:

509 
Syem_Stus
 = 
us
;

517 
STATUS_DOWNLOAD_REQUIRED
:

522 
STATUS_DOWNLOAD_IN_PROGRESS
:

524 
STATUS_BACKUP_IN_PROGRESS
:

525 
su
 = -2;

529 
su
 = -1;

534  (
su
);

535 
	}
}

537 cڡ *
	$Devi_Vd_Name
(

540  
Vd_Name
;

541 
	}
}

547 
ut16_t
 
	$Devi_Vd_Idtifr
(

550  
Vd_Idtifr
;

551 
	}
}

553 
	$Devi_S_Vd_Idtifr
(

554 
ut16_t
 
vd_id
)

556 
Vd_Idtifr
 = 
vd_id
;

557 
	}
}

559 cڡ *
	$Devi_Mod_Name
(

562  
Mod_Name
;

563 
	}
}

565 
bo
 
	$Devi_S_Mod_Name
(

566 cڡ *
me
,

567 
size_t
 
ngth
)

569 
bo
 
us
 = 
l
;

571 i(
ngth
 < (
Mod_Name
)) {

572 
	`memmove
(
Mod_Name
, 
me
, 
ngth
);

573 
Mod_Name
[
ngth
] = 0;

574 
us
 = 
ue
;

577  
us
;

578 
	}
}

580 cڡ *
	$Devi_Fmwe_Revisi
(

583  
BACt_Vsi
;

584 
	}
}

586 cڡ *
	$Devi_Aliti_Sowe_Vsi
(

589  
Aliti_Sowe_Vsi
;

590 
	}
}

592 
bo
 
	$Devi_S_Aliti_Sowe_Vsi
(

593 cڡ *
me
,

594 
size_t
 
ngth
)

596 
bo
 
us
 = 
l
;

598 i(
ngth
 < (
Aliti_Sowe_Vsi
)) {

599 
	`memmove
(
Aliti_Sowe_Vsi
, 
me
, 
ngth
);

600 
Aliti_Sowe_Vsi
[
ngth
] = 0;

601 
us
 = 
ue
;

604  
us
;

605 
	}
}

607 cڡ *
	$Devi_Desti
(

610  
Desti
;

611 
	}
}

613 
bo
 
	$Devi_S_Desti
(

614 cڡ *
me
,

615 
size_t
 
ngth
)

617 
bo
 
us
 = 
l
;

619 i(
ngth
 < (
Desti
)) {

620 
	`memmove
(
Desti
, 
me
, 
ngth
);

621 
Desti
[
ngth
] = 0;

622 
us
 = 
ue
;

625  
us
;

626 
	}
}

628 cڡ *
	$Devi_Loti
(

631  
Loti
;

632 
	}
}

634 
bo
 
	$Devi_S_Loti
(

635 cڡ *
me
,

636 
size_t
 
ngth
)

638 
bo
 
us
 = 
l
;

640 i(
ngth
 < (
Loti
)) {

641 
	`memmove
(
Loti
, 
me
, 
ngth
);

642 
Loti
[
ngth
] = 0;

643 
us
 = 
ue
;

646  
us
;

647 
	}
}

649 
ut8_t
 
	$Devi_Proc_Vsi
(

652  
BACNET_PROTOCOL_VERSION
;

653 
	}
}

655 
ut8_t
 
	$Devi_Proc_Revisi
(

658  
BACNET_PROTOCOL_REVISION
;

659 
	}
}

661 
BACNET_SEGMENTATION
 
	$Devi_Segmti_Su܋d
(

664  
SEGMENTATION_NONE
;

665 
	}
}

667 
ut32_t
 
	$Devi_Daba_Revisi
(

670  
Daba_Revisi
;

671 
	}
}

673 
	$Devi_S_Daba_Revisi
(

674 
ut32_t
 
visi
)

676 
Daba_Revisi
 = 
visi
;

677 
	}
}

684 
	$Devi_Inc_Daba_Revisi
(

687 
Daba_Revisi
++;

688 
	}
}

695 
	$Devi_Obje_Li_Cou
(

698 
cou
 = 0;

699 
obje_funis
 *
pObje
 = 
NULL
;

702 
pObje
 = 
Obje_Tab
;

703 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

704 i(
pObje
->
Obje_Cou
) {

705 
cou
 +
pObje
->
	`Obje_Cou
();

707 
pObje
++;

710  
cou
;

711 
	}
}

723 
bo
 
	$Devi_Obje_Li_Idtifr
(

724 
ut32_t
 
y_dex
,

725 *
obje_ty
,

726 
ut32_t
 * 

)

728 
bo
 
us
 = 
l
;

729 
ut32_t
 
cou
 = 0;

730 
ut32_t
 
obje_dex
 = 0;

731 
ut32_t
 
mp_dex
 = 0;

732 
obje_funis
 *
pObje
 = 
NULL
;

735 i(
y_dex
 == 0) {

736  
us
;

738 
obje_dex
 = 
y_dex
 - 1;

740 
pObje
 = 
Obje_Tab
;

741 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

742 i(
pObje
->
Obje_Cou
) {

743 
obje_dex
 -
cou
;

744 
cou
 = 
pObje
->
	`Obje_Cou
();

745 i(
obje_dex
 < 
cou
) {

748 i(
pObje
->
Obje_It
) {

750 
mp_dex
 = 
pObje
->
	`Obje_It
(~() 0);

752 
obje_dex
 != 0) {

753 
mp_dex
 = 
pObje
->
	`Obje_It
(temp_index);

754 
obje_dex
--;

757 
obje_dex
 = 
mp_dex
;

759 i(
pObje
->
Obje_Index_To_In
) {

760 *
obje_ty
 = 
pObje
->
Obje_Ty
;

761 *

 =

762 
pObje
->
	`Obje_Index_To_In
(
obje_dex
);

763 
us
 = 
ue
;

768 
pObje
++;

771  
us
;

772 
	}
}

782 
bo
 
	$Devi_Vid_Obje_Name
(

783 
BACNET_CHARACTER_STRING
 * 
obje_me1
,

784 *
obje_ty
,

785 
ut32_t
 * 
obje_
)

787 
bo
 
found
 = 
l
;

788 
ty
 = 0;

789 
ut32_t
 

;

790 
ut32_t
 
max_objes
 = 0, 
i
 = 0;

791 
bo
 
check_id
 = 
l
;

792 
BACNET_CHARACTER_STRING
 
obje_me2
;

793 
obje_funis
 *
pObje
 = 
NULL
;

795 
max_objes
 = 
	`Devi_Obje_Li_Cou
();

796 
i
 = 1; i <
max_objes
; i++) {

797 
check_id
 = 
	`Devi_Obje_Li_Idtifr
(
i
, &
ty
, &

);

798 i(
check_id
) {

799 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
ty
);

800 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL) &&

801 (
pObje
->
	`Obje_Name
(

, &
obje_me2
) &&

802 
	`charg_me
(
obje_me1
, &
obje_me2
))) {

803 
found
 = 
ue
;

804 i(
obje_ty
) {

805 *
obje_ty
 = 
ty
;

807 i(
obje_
) {

808 *
obje_
 = 

;

815  
found
;

816 
	}
}

823 
bo
 
	$Devi_Vid_Obje_Id
(

824 
obje_ty
,

825 
ut32_t
 
obje_
)

827 
bo
 
us
 = 
l
;

828 
obje_funis
 *
pObje
 = 
NULL
;

830 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

831 i((
pObje
 !
NULL
&& (pObje->
Obje_Vid_In
 != NULL)) {

832 
us
 = 
pObje
->
	`Obje_Vid_In
(
obje_
);

835  
us
;

836 
	}
}

844 
bo
 
	$Devi_Obje_Name_Cy
(

845 
BACNET_OBJECT_TYPE
 
obje_ty
,

846 
ut32_t
 
obje_
,

847 
BACNET_CHARACTER_STRING
 * 
obje_me
)

849 
obje_funis
 *
pObje
 = 
NULL
;

850 
bo
 
found
 = 
l
;

852 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

853 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL)) {

854 
found
 = 
pObje
->
	`Obje_Name
(
obje_
, 
obje_me
);

857  
found
;

858 
	}
}

860 
	$Upde_Cut_Time
(

863 
tm
 *
tblock
 = 
NULL
;

864 #i
	`defed
(
_MSC_VER
)

865 
time_t
 
tTemp
;

867 
timev
 
tv
;

882 #i
	`defed
(
_MSC_VER
)

883 
	`time
(&
tTemp
);

884 
tblock
 = (
tm
 *)
	`loime
(&
tTemp
);

886 i(
	`gtimeofday
(&
tv
, 
NULL
) == 0) {

887 
tblock
 = (
tm
 *)
	`loime
((cڡ 
time_t
 *)&
tv
.
tv_c
);

891 i(
tblock
) {

892 
	`dime_t_de
(&
Lol_De
, (
ut16_t

tblock
->
tm_yr
 + 1900,

893 (
ut8_t

tblock
->
tm_m
 + 1, (ut8_ttblock->
tm_mday
);

894 #i!
	`defed
(
_MSC_VER
)

895 
	`dime_t_time
(&
Lol_Time
, (
ut8_t

tblock
->
tm_hour
,

896 (
ut8_t

tblock
->
tm_m
, (ut8_ttblock->
tm_c
,

897 (
ut8_t
(
tv
.
tv_uc
 / 10000));

899 
	`dime_t_time
(&
Lol_Time
, (
ut8_t

tblock
->
tm_hour
,

900 (
ut8_t

tblock
->
tm_m
, (ut8_ttblock->
tm_c
, 0);

902 i(
tblock
->
tm_isd
) {

903 
Daylight_Savgs_Stus
 = 
ue
;

905 
Daylight_Savgs_Stus
 = 
l
;

908 
UTC_Offt
 = 
timeze
 / 60;

910 
	`dime_de_wdrd_t
(&
Lol_De
);

911 
	`dime_time_wdrd_t
(&
Lol_Time
);

912 
Daylight_Savgs_Stus
 = 
l
;

914 
	}
}

916 
	$Devi_gCutDeTime
(

917 
BACNET_DATE_TIME
 * 
DeTime
)

919 
	`Upde_Cut_Time
();

921 
DeTime
->
de
 = 
Lol_De
;

922 
DeTime
->
time
 = 
Lol_Time
;

923 
	}
}

925 
t32_t
 
	$Devi_UTC_Offt
()

927 
	`Upde_Cut_Time
();

929  
UTC_Offt
;

930 
	}
}

932 
bo
 
	$Devi_Daylight_Savgs_Stus
()

934  
Daylight_Savgs_Stus
;

935 
	}
}

939 
	$Devi_Rd_Prݔty_Lol
(

940 
BACNET_READ_PROPERTY_DATA
 * 
da
)

942 
du_n
 = 0;

943 
n
 = 0;

944 
BACNET_BIT_STRING
 
b_rg
 = { 0 };

945 
BACNET_CHARACTER_STRING
 
ch_rg
 = { 0 };

946 
ut32_t
 
i
 = 0;

947 
obje_ty
 = 0;

948 
ut32_t
 

 = 0;

949 
ut32_t
 
cou
 = 0;

950 
ut8_t
 *
du
 = 
NULL
;

951 
obje_funis
 *
pObje
 = 
NULL
;

952 
bo
 
found
 = 
l
;

953 
ut16_t
 
du_max
 = 0;

955 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

956 (
da
->
iti_da_n
 == 0)) {

959 
du
 = 
da
->
iti_da
;

960 
du_max
 = 
da
->
iti_da_n
;

961 
da
->
obje_ݔty
) {

962 
PROP_OBJECT_IDENTIFIER
:

963 
du_n
 =

964 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_DEVICE
,

965 
Obje_In_Numb
);

967 
PROP_OBJECT_NAME
:

968 
du_n
 =

969 
	`code_iti_cha_rg
(&
du
[0], &
My_Obje_Name
);

971 
PROP_OBJECT_TYPE
:

972 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
OBJECT_DEVICE
);

974 
PROP_DESCRIPTION
:

975 
	`charg__si
(&
ch_rg
, 
Desti
);

976 
du_n
 =

977 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

979 
PROP_SYSTEM_STATUS
:

980 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
Syem_Stus
);

982 
PROP_VENDOR_NAME
:

983 
	`charg__si
(&
ch_rg
, 
Vd_Name
);

984 
du_n
 =

985 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

987 
PROP_VENDOR_IDENTIFIER
:

988 
du_n
 =

989 
	`code_iti_unsigd
(&
du
[0], 
Vd_Idtifr
);

991 
PROP_MODEL_NAME
:

992 
	`charg__si
(&
ch_rg
, 
Mod_Name
);

993 
du_n
 =

994 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

996 
PROP_FIRMWARE_REVISION
:

997 
	`charg__si
(&
ch_rg
, 
BACt_Vsi
);

998 
du_n
 =

999 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

1001 
PROP_APPLICATION_SOFTWARE_VERSION
:

1002 
	`charg__si
(&
ch_rg
,

1003 
Aliti_Sowe_Vsi
);

1004 
du_n
 =

1005 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

1007 
PROP_LOCATION
:

1008 
	`charg__si
(&
ch_rg
, 
Loti
);

1009 
du_n
 =

1010 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

1012 
PROP_LOCAL_TIME
:

1013 
	`Upde_Cut_Time
();

1014 
du_n
 = 
	`code_iti_time
(&
du
[0], &
Lol_Time
);

1016 
PROP_UTC_OFFSET
:

1017 
	`Upde_Cut_Time
();

1018 
du_n
 = 
	`code_iti_sigd
(&
du
[0], 
UTC_Offt
);

1020 
PROP_LOCAL_DATE
:

1021 
	`Upde_Cut_Time
();

1022 
du_n
 = 
	`code_iti_de
(&
du
[0], &
Lol_De
);

1024 
PROP_DAYLIGHT_SAVINGS_STATUS
:

1025 
	`Upde_Cut_Time
();

1026 
du_n
 =

1027 
	`code_iti_boޗn
(&
du
[0], 
Daylight_Savgs_Stus
);

1029 
PROP_PROTOCOL_VERSION
:

1030 
du_n
 =

1031 
	`code_iti_unsigd
(&
du
[0],

1032 
	`Devi_Proc_Vsi
());

1034 
PROP_PROTOCOL_REVISION
:

1035 
du_n
 =

1036 
	`code_iti_unsigd
(&
du
[0],

1037 
	`Devi_Proc_Revisi
());

1039 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

1041 
	`brg_
(&
b_rg
);

1042 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

1044 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

1045 
	`du_rvi_su܋d
((
BACNET_SERVICES_SUPPORTED

i
));

1047 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

1049 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

1052 
	`brg_
(&
b_rg
);

1053 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

1055 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

1059 
pObje
 = 
Obje_Tab
;

1060 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

1061 i((
pObje
->
Obje_Cou
&& (pObje->
	`Obje_Cou
() > 0)) {

1062 
	`brg_t_b
(&
b_rg
, 
pObje
->
Obje_Ty
, 
ue
);

1064 
pObje
++;

1066 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

1068 
PROP_OBJECT_LIST
:

1069 
cou
 = 
	`Devi_Obje_Li_Cou
();

1071 i(
da
->
y_dex
 == 0)

1072 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

1077 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

1078 
i
 = 1; i <
cou
; i++) {

1079 
found
 =

1080 
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
,

1081 &

);

1082 i(
found
) {

1083 
n
 =

1084 
	`code_iti_obje_id
(&
du
[
du_n
],

1085 
obje_ty
, 

);

1086 
du_n
 +
n
;

1089 i((
i
 !
cou
&& (
du_n
 + 
n
>
du_max
) {

1091 
da
->
r_code
 =

1092 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

1093 
du_n
 = 
BACNET_STATUS_ABORT
;

1098 
da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

1099 
da
->
r_code
 = 
ERROR_CODE_OTHER
;

1100 
du_n
 = 
BACNET_STATUS_ERROR
;

1105 
found
 =

1106 
	`Devi_Obje_Li_Idtifr
(
da
->
y_dex
,

1107 &
obje_ty
, &

);

1108 i(
found
) {

1109 
du_n
 =

1110 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

1111 

);

1113 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1114 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

1115 
du_n
 = 
BACNET_STATUS_ERROR
;

1119 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

1120 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

1122 
PROP_SEGMENTATION_SUPPORTED
:

1123 
du_n
 =

1124 
	`code_iti_umed
(&
du
[0],

1125 
	`Devi_Segmti_Su܋d
());

1127 
PROP_APDU_TIMEOUT
:

1128 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_timeout
());

1130 
PROP_NUMBER_OF_APDU_RETRIES
:

1131 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_s
());

1133 
PROP_DEVICE_ADDRESS_BINDING
:

1134 
du_n
 = 
	`addss_li_code
(&
du
[0], 
du_max
);

1136 
PROP_DATABASE_REVISION
:

1137 
du_n
 =

1138 
	`code_iti_unsigd
(&
du
[0], 
Daba_Revisi
);

1140 #i
	`defed
(
BACDL_MSTP
)

1141 
PROP_MAX_INFO_FRAMES
:

1142 
du_n
 =

1143 
	`code_iti_unsigd
(&
du
[0],

1144 
	`dlmp_max_fo_ames
());

1146 
PROP_MAX_MASTER
:

1147 
du_n
 =

1148 
	`code_iti_unsigd
(&
du
[0], 
	`dlmp_max_ma
());

1151 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

1152 
du_n
 = 
	`hdr_cov_code_substis
(&
du
[0], 
du_max
);

1155 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1156 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1157 
du_n
 = 
BACNET_STATUS_ERROR
;

1161 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

1162 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

1163 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1164 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

1165 
du_n
 = 
BACNET_STATUS_ERROR
;

1168  
du_n
;

1169 
	}
}

1179 
	$Devi_Rd_Prݔty
(

1180 
BACNET_READ_PROPERTY_DATA
 * 
da
)

1182 
du_n
 = 
BACNET_STATUS_ERROR
;

1183 
obje_funis
 *
pObje
 = 
NULL
;

1186 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

1187 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1188 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
da
->
obje_ty
);

1189 i(
pObje
 !
NULL
) {

1190 i(
pObje
->
Obje_Vid_In
 &&

1191 
pObje
->
	`Obje_Vid_In
(
da
->
obje_
)) {

1192 i(
pObje
->
Obje_Rd_Prݔty
) {

1193 
du_n
 = 
pObje
->
	`Obje_Rd_Prݔty
(
da
);

1198  
du_n
;

1199 
	}
}

1202 
bo
 
	$Devi_Wre_Prݔty_Lol
(

1203 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

1205 
bo
 
us
 = 
l
;

1206 
n
 = 0;

1207 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1208 
obje_ty
 = 0;

1209 
ut32_t
 
obje_
 = 0;

1210 
mp
;

1213 
n
 =

1214 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

1215 
wp_da
->
iti_da_n
, &
vue
);

1216 i(
n
 < 0) {

1218 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1219 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1220  
l
;

1222 i((
wp_da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

1223 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

1225 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1226 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

1227  
l
;

1230 
wp_da
->
obje_ݔty
) {

1231 
PROP_OBJECT_IDENTIFIER
:

1232 
us
 =

1233 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_OBJECT_ID
,

1234 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1235 i(
us
) {

1236 i((
vue
.
ty
.
Obje_Id
.ty =
OBJECT_DEVICE
) &&

1237 (
	`Devi_S_Obje_In_Numb
(
vue
.
ty
.

1238 
Obje_Id
.

))) {

1241 
us
 = 
l
;

1242 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1243 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1247 
PROP_NUMBER_OF_APDU_RETRIES
:

1248 
us
 =

1249 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1250 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1251 i(
us
) {

1253 
	`du_s_t
((
ut8_t

vue
.
ty
.
Unsigd_I
);

1256 
PROP_APDU_TIMEOUT
:

1257 
us
 =

1258 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1259 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1260 i(
us
) {

1262 
	`du_timeout_t
((
ut16_t

vue
.
ty
.
Unsigd_I
);

1265 
PROP_VENDOR_IDENTIFIER
:

1266 
us
 =

1267 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1268 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1269 i(
us
) {

1271 
	`Devi_S_Vd_Idtifr
((
ut16_t

vue
.

1272 
ty
.
Unsigd_I
);

1275 
PROP_SYSTEM_STATUS
:

1276 
us
 =

1277 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

1278 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1279 i(
us
) {

1280 
mp
 = 
	`Devi_S_Syem_Stus
((
BACNET_DEVICE_STATUS
)

1281 
vue
.
ty
.
Enumed
, 
l
);

1282 i(
mp
 != 0) {

1283 
us
 = 
l
;

1284 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1285 i(
mp
 == -1) {

1286 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1288 
wp_da
->
r_code
 =

1289 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

1294 
PROP_OBJECT_NAME
:

1295 
us
 =

1296 
	`WPVideSg
(&
vue
,

1297 
	`charg_cy
(&
My_Obje_Name
), 
l
,

1298 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1299 i(
us
) {

1301 i(
	`Devi_Vid_Obje_Name
(&
vue
.
ty
.
Cha_Sg
,

1302 &
obje_ty
, &
obje_
)) {

1303 i((
obje_ty
 =
wp_da
->object_type) &&

1304 (
obje_
 =
wp_da
->object_instance)) {

1306 
us
 = 
ue
;

1308 
us
 = 
l
;

1309 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1310 
wp_da
->
r_code
 = 
ERROR_CODE_DUPLICATE_NAME
;

1313 
	`Devi_S_Obje_Name
(&
vue
.
ty
.
Cha_Sg
);

1317 
PROP_LOCATION
:

1318 
us
 =

1319 
	`WPVideSg
(&
vue
, 
MAX_DEV_LOC_LEN
, 
ue
,

1320 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1321 i(
us
) {

1322 
	`Devi_S_Loti
(
	`charg_vue
(&
vue
.

1323 
ty
.
Cha_Sg
),

1324 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

1328 
PROP_DESCRIPTION
:

1329 
us
 =

1330 
	`WPVideSg
(&
vue
, 
MAX_DEV_DESC_LEN
, 
ue
,

1331 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1332 i(
us
) {

1333 
	`Devi_S_Desti
(
	`charg_vue
(&
vue
.

1334 
ty
.
Cha_Sg
),

1335 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

1338 
PROP_MODEL_NAME
:

1339 
us
 =

1340 
	`WPVideSg
(&
vue
, 
MAX_DEV_MOD_LEN
, 
ue
,

1341 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1342 i(
us
) {

1343 
	`Devi_S_Mod_Name
(
	`charg_vue
(&
vue
.

1344 
ty
.
Cha_Sg
),

1345 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

1349 
PROP_MAX_INFO_FRAMES
:

1350 #i
	`defed
(
BACDL_MSTP
)

1351 
us
 =

1352 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1353 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1354 i(
us
) {

1355 i(
vue
.
ty
.
Unsigd_I
 <= 255) {

1356 
	`dlmp_t_max_fo_ames
((
ut8_t

vue
.

1357 
ty
.
Unsigd_I
);

1359 
us
 = 
l
;

1360 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1361 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1366 
PROP_MAX_MASTER
:

1367 #i
	`defed
(
BACDL_MSTP
)

1368 
us
 =

1369 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1370 &
wp_da
->
r_ass
, &wp_da->
r_code
);

1371 i(
us
) {

1372 i((
vue
.
ty
.
Unsigd_I
 > 0) &&

1373 (
vue
.
ty
.
Unsigd_I
 <= 127)) {

1374 
	`dlmp_t_max_ma
((
ut8_t

vue
.
ty
.
Unsigd_I
);

1376 
us
 = 
l
;

1377 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1378 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

1383 
PROP_OBJECT_TYPE
:

1384 
PROP_VENDOR_NAME
:

1385 
PROP_FIRMWARE_REVISION
:

1386 
PROP_APPLICATION_SOFTWARE_VERSION
:

1387 
PROP_LOCAL_TIME
:

1388 
PROP_UTC_OFFSET
:

1389 
PROP_LOCAL_DATE
:

1390 
PROP_DAYLIGHT_SAVINGS_STATUS
:

1391 
PROP_PROTOCOL_VERSION
:

1392 
PROP_PROTOCOL_REVISION
:

1393 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

1394 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

1395 
PROP_OBJECT_LIST
:

1396 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

1397 
PROP_SEGMENTATION_SUPPORTED
:

1398 
PROP_DEVICE_ADDRESS_BINDING
:

1399 
PROP_DATABASE_REVISION
:

1400 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

1401 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1402 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

1405 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1406 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1410  
us
;

1411 
	}
}

1422 
bo
 
	$Devi_Wre_Prݔty
(

1423 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

1425 
bo
 
us
 = 
l
;

1426 
obje_funis
 *
pObje
 = 
NULL
;

1429 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

1430 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1431 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
wp_da
->
obje_ty
);

1432 i(
pObje
 !
NULL
) {

1433 i(
pObje
->
Obje_Vid_In
 &&

1434 
pObje
->
	`Obje_Vid_In
(
wp_da
->
obje_
)) {

1435 i(
pObje
->
Obje_Wre_Prݔty
) {

1436 
us
 = 
pObje
->
	`Obje_Wre_Prݔty
(
wp_da
);

1438 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1439 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

1442 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

1443 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1446 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

1447 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

1450  (
us
);

1451 
	}
}

1461 
bo
 
	$Devi_Encode_Vue_Li
(

1462 
BACNET_OBJECT_TYPE
 
obje_ty
,

1463 
ut32_t
 
obje_
,

1464 
BACNET_PROPERTY_VALUE
 * 
vue_li
)

1466 
bo
 
us
 = 
l
;

1467 
obje_funis
 *
pObje
 = 
NULL
;

1469 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1470 i(
pObje
 !
NULL
) {

1471 i(
pObje
->
Obje_Vid_In
 &&

1472 
pObje
->
	`Obje_Vid_In
(
obje_
)) {

1473 i(
pObje
->
Obje_Vue_Li
) {

1474 
us
 =

1475 
pObje
->
	`Obje_Vue_Li
(
obje_
, 
vue_li
);

1480  (
us
);

1481 
	}
}

1489 
bo
 
	$Devi_COV
(

1490 
BACNET_OBJECT_TYPE
 
obje_ty
,

1491 
ut32_t
 
obje_
)

1493 
bo
 
us
 = 
l
;

1494 
obje_funis
 *
pObje
 = 
NULL
;

1496 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1497 i(
pObje
 !
NULL
) {

1498 i(
pObje
->
Obje_Vid_In
 &&

1499 
pObje
->
	`Obje_Vid_In
(
obje_
)) {

1500 i(
pObje
->
Obje_COV
) {

1501 
us
 = 
pObje
->
	`Obje_COV
(
obje_
);

1506  (
us
);

1507 
	}
}

1514 
	$Devi_COV_Cˬ
(

1515 
BACNET_OBJECT_TYPE
 
obje_ty
,

1516 
ut32_t
 
obje_
)

1518 
obje_funis
 *
pObje
 = 
NULL
;

1520 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1521 i(
pObje
 !
NULL
) {

1522 i(
pObje
->
Obje_Vid_In
 &&

1523 
pObje
->
	`Obje_Vid_In
(
obje_
)) {

1524 i(
pObje
->
Obje_COV_Cˬ
) {

1525 
pObje
->
	`Obje_COV_Cˬ
(
obje_
);

1529 
	}
}

1531 #i
defed
(
INTRINSIC_REPORTING
)

1532 
	$Devi_lol_ptg
(

1535 
obje_funis
 *
pObje
;

1536 
ut32_t
 
objes_cou
;

1537 
ut32_t
 
obje_
;

1538 
obje_ty
;

1539 
ut32_t
 
idx
;

1541 
objes_cou
 = 
	`Devi_Obje_Li_Cou
();

1544 
idx
 = 1; idx < 
objes_cou
; idx++) {

1545 
	`Devi_Obje_Li_Idtifr
(
idx
, &
obje_ty
, &
obje_
);

1547 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1548 i(
pObje
 !
NULL
) {

1549 i(
pObje
->
Obje_Vid_In
 &&

1550 
pObje
->
	`Obje_Vid_In
(
obje_
)) {

1551 i(
pObje
->
Obje_Irsic_Rtg
) {

1552 
pObje
->
	`Obje_Irsic_Rtg
(
obje_
);

1557 
	}
}

1565 
bo
 
	$Devi_Vue_Li_Su܋d
(

1566 
BACNET_OBJECT_TYPE
 
obje_ty
)

1568 
bo
 
us
 = 
l
;

1569 
obje_funis
 *
pObje
 = 
NULL
;

1571 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

1572 i(
pObje
 !
NULL
) {

1573 i(
pObje
->
Obje_Vue_Li
) {

1574 
us
 = 
ue
;

1578  (
us
);

1579 
	}
}

1589 
	$Devi_In
(

1590 
obje_funis_t
 * 
obje_b
)

1592 
obje_funis
 *
pObje
 = 
NULL
;

1593 #i
	`defed
(
BAC_UCI
)

1594 cڡ *
ucame
;

1595 
uci_cڋxt
 *
x
;

1596 
	`rtf
(
dr
, "Device_Init\n");

1597 
x
 = 
	`ucix_
("bacnet_dev");

1598 i(!
x
)

1599 
	`rtf
(
dr
, "Failedooad config file bacnet_dev\n");

1600 
ucame
 = 
	`ucix_g_ti
(
x
, "bacnet_dev", "0", "Name");

1601 i(
ucame
 != 0) {

1602 
	`charg__si
(&
My_Obje_Name
, 
ucame
);

1605 
	`charg__si
(&
My_Obje_Name
, "PiFace Digital Demo");

1606 #i
	`defed
(
BAC_UCI
)

1608 
	`ucix_nup
(
x
);

1611 i(
obje_b
) {

1612 
Obje_Tab
 = 
obje_b
;

1614 
Obje_Tab
 = &
My_Obje_Tab
[0];

1616 
pObje
 = 
Obje_Tab
;

1617 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

1618 i(
pObje
->
Obje_In
) {

1619 
pObje
->
	`Obje_In
();

1621 
pObje
++;

1623 
	}
}

1625 
bo
 
	$DeviGRRInfo
(

1626 
BACNET_READ_RANGE_DATA
 * 
pReque
,

1627 
RR_PROP_INFO
 * 
pInfo
)

1629 
bo
 
us
 = 
l
;

1631 
pReque
->
obje_ݔty
) {

1632 
PROP_VT_CLASSES_SUPPORTED
:

1633 
PROP_ACTIVE_VT_SESSIONS
:

1634 
PROP_LIST_OF_SESSION_KEYS
:

1635 
PROP_TIME_SYNCHRONIZATION_RECIPIENTS
:

1636 
PROP_MANUAL_SLAVE_ADDRESS_BINDING
:

1637 
PROP_SLAVE_ADDRESS_BINDING
:

1638 
PROP_RESTART_NOTIFICATION_RECIPIENTS
:

1639 
PROP_UTC_TIME_SYNCHRONIZATION_RECIPIENTS
:

1640 
pInfo
->
RequeTys
 = 
RR_BY_POSITION
;

1641 
pReque
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1642 
pReque
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1645 
PROP_DEVICE_ADDRESS_BINDING
:

1646 
pInfo
->
RequeTys
 = 
RR_BY_POSITION
;

1647 
pInfo
->
Hdr
 = 
_addss_li_code
;

1648 
us
 = 
ue
;

1651 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

1652 
pInfo
->
RequeTys
 = 
RR_BY_POSITION
;

1653 
pReque
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1654 
pReque
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1657 
pReque
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

1658 
pReque
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_A_LIST
;

1662  
us
;

1663 
	}
}

1666 #ifde
BAC_ROUTING


1681 
	$Routg_Devi_In
(

1682 
ut32_t
 
f_obje_
)

1684 
obje_funis
 *
pDevObje
 = 
NULL
;

1687 
	`Add_Roud_Devi
(
f_obje_
, &
My_Obje_Name
, 
Desti
);

1690 
pDevObje
 = 
Obje_Tab
;

1691 
pDevObje
->
Obje_Index_To_In
 = 
Roud_Devi_Index_To_In
;

1692 
pDevObje
->
Obje_Vid_In
 =

1693 
Roud_Devi_Vid_Obje_In_Numb
;

1694 
pDevObje
->
Obje_Name
 = 
Roud_Devi_Name
;

1695 
pDevObje
->
Obje_Rd_Prݔty
 = 
Roud_Devi_Rd_Prݔty_Lol
;

1696 
pDevObje
->
Obje_Wre_Prݔty
 = 
Roud_Devi_Wre_Prݔty_Lol
;

1697 
	}
}

1702 #ifde
TEST


1703 
	~<as.h
>

1704 
	~<rg.h
>

1705 
	~"e.h
"

1707 
bo
 
	$WPVideArgTy
(

1708 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

1709 
ut8_t
 
ucExedTag
,

1710 
BACNET_ERROR_CLASS
 * 
pECss
,

1711 
BACNET_ERROR_CODE
 * 
pECode
)

1713 
pVue
 =Value;

1714 
ucExedTag
 = ucExpectedTag;

1715 
pECss
 =ErrorClass;

1716 
pECode
 =ErrorCode;

1718  
l
;

1719 
	}
}

1721 
bo
 
	$WPVideSg
(

1722 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

1723 
iMaxL
,

1724 
bo
 
bEmyAowed
,

1725 
BACNET_ERROR_CLASS
 * 
pECss
,

1726 
BACNET_ERROR_CODE
 * 
pECode
)

1728 
pVue
 =Value;

1729 
iMaxL
 = iMaxLen;

1730 
bEmyAowed
 = bEmptyAllowed;

1731 
pECss
 =ErrorClass;

1732 
pECode
 =ErrorCode;

1734  
l
;

1735 
	}
}

1737 
	$hdr_cov_code_substis
(

1738 
ut8_t
 * 
du
,

1739 
max_du
)

1741 
du
 =pdu;

1742 
max_du
 = max_apdu;

1745 
	}
}

1747 
	$Devi
(

1748 
Te
 * 
pTe
)

1750 
bo
 
us
 = 
l
;

1751 cڡ *
me
 = "Patricia";

1753 
us
 = 
	`Devi_S_Obje_In_Numb
(0);

1754 
	`_
(
pTe
, 
	`Devi_Obje_In_Numb
() == 0);

1755 
	`_
(
pTe
, 
us
 =
ue
);

1756 
us
 = 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

1757 
	`_
(
pTe
, 
	`Devi_Obje_In_Numb
(=
BACNET_MAX_INSTANCE
);

1758 
	`_
(
pTe
, 
us
 =
ue
);

1759 
us
 = 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
 / 2);

1760 
	`_
(
pTe
,

1761 
	`Devi_Obje_In_Numb
(=(
BACNET_MAX_INSTANCE
 / 2));

1762 
	`_
(
pTe
, 
us
 =
ue
);

1763 
us
 = 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
 + 1);

1764 
	`_
(
pTe
,

1765 
	`Devi_Obje_In_Numb
(!(
BACNET_MAX_INSTANCE
 + 1));

1766 
	`_
(
pTe
, 
us
 =
l
);

1769 
	`Devi_S_Syem_Stus
(
STATUS_NON_OPERATIONAL
, 
ue
);

1770 
	`_
(
pTe
, 
	`Devi_Syem_Stus
(=
STATUS_NON_OPERATIONAL
);

1772 
	`_
(
pTe
, 
	`Devi_Vd_Idtifr
(=
BACNET_VENDOR_ID
);

1774 
	`Devi_S_Mod_Name
(
me
, 
	`
(name));

1775 
	`_
(
pTe
, 
	`rcmp
(
	`Devi_Mod_Name
(), 
me
) == 0);

1778 
	}
}

1780 #ifde
TEST_DEVICE


1781 
	$ma
(

1784 
Te
 *
pTe
;

1785 
bo
 
rc
;

1787 
pTe
 = 
	`_
("BACÈDevi", 
NULL
);

1789 
rc
 = 
	`_addTeFuni
(
pTe
, 
Devi
);

1790 
	`as
(
rc
);

1792 
	`_tSm
(
pTe
, 
dout
);

1793 
	`_run
(
pTe
);

1794 (
	`_pt
(
pTe
);

1795 
	`_deroy
(
pTe
);

1798 
	}
}

	@demo/piface/main.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<dlib.h
>

29 
	~<sigl.h
>

30 
	~<time.h
>

32 
	~"cfig.h
"

33 
	~"addss.h
"

34 
	~"bacdef.h
"

35 
	~"hdrs.h
"

36 
	~".h
"

37 
	~"dnv.h
"

38 
	~"bacdcode.h
"

39 
	~"du.h
"

40 
	~"du.h
"

41 
	~"m.h
"

42 
	~"tsm.h
"

43 
	~"devi.h
"

44 
	~"bacfe.h
"

45 
	~"dk.h
"

46 
	~"dcc.h
"

47 
	~"gevt.h
"

48 
	~"t.h
"

49 
	~"txbuf.h
"

50 
	~"tsm.h
"

51 
	~"vsi.h
"

53 
	~"devi.h
"

54 
	~"bi.h
"

55 
	~"bo.h
"

56 
	~"pidig.h
"

66 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

71 
	$In_Svi_Hdrs
(

74 
	`Devi_In
(
NULL
);

76 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

77 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_HAS
, 
hdr_who_has
);

79 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

82 
du_t_uecognized_rvi_hdr_hdr


83 (
hdr_uecognized_rvi
);

86 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

87 
hdr_ad_ݔty
);

88 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

89 
hdr_ad_ݔty_muɝ
);

90 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

91 
hdr_wre_ݔty
);

92 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROP_MULTIPLE
,

93 
hdr_wre_ݔty_muɝ
);

94 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_RANGE
,

95 
hdr_ad_nge
);

96 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

97 
hdr_lize_devi
);

98 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_UTC_TIME_SYNCHRONIZATION
,

99 
hdr_timesync_utc
);

100 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_TIME_SYNCHRONIZATION
,

101 
hdr_timesync
);

102 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_SUBSCRIBE_COV
,

103 
hdr_cov_subsibe
);

104 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_COV_NOTIFICATION
,

105 
hdr_ucov_nifiti
);

107 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

108 
hdr_devi_communiti_cڌ
);

110 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_PRIVATE_TRANSFER
,

111 
hdr_uncfmed_ive_sr
);

112 
	}
}

114 
	$pi_
()

116 
hw_addr
 = 0;

117 #ifde
PIFACE_INTERRUPT_ENABLE


118 
b
 = 1;

124 
	`tf
("Ongi dig ciڇloti %d\n", 
hw_addr
);

125 
	`pidig_ݒ
(
hw_addr
);

127 #ifde
PIFACE_INTERRUPT_ENABLE


132 
b
 = 
	`pidig_ab_us
();

133 i
b
 == 0) {

134 
	`tf
("Interruptsnabled.\n");

136 
	`tf
("Couldotnable interrupts. "

140 
	}
}

143 
bo
 
	gPiFa_P_Stus
[
MAX_BINARY_INPUTS
];

148 
	$pi_nup
()

150 
	`pidig_o
(0);

151 
	}
}

156 
	$pi_sk
()

158 
i
 = 0;

159 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

160 
bo
 
p_us
 = 
l
;

162 
i
 = 0; i < 
MAX_BINARY_INPUTS
; i++) {

163 i(!
	`By_Iut_Out_Of_Svi
(
i
)) {

164 
e_vue
 = 
	`By_Iut_P_Vue
(
i
);

165 
p_us
 = 
l
;

166 i(
	`pidig_dig_ad
(
i
)) {

167 
p_us
 = 
ue
;

169 i(
p_us
 !
PiFa_P_Stus
[
i
]) {

170 
PiFa_P_Stus
[
i
] = 
p_us
;

171 i(
p_us
) {

173 i(
e_vue
 =
BINARY_INACTIVE
) {

174 
e_vue
 = 
BINARY_ACTIVE
;

176 
e_vue
 = 
BINARY_INACTIVE
;

178 
	`By_Iut_P_Vue_S
(
i
, 
e_vue
);

183 
i
 = 0; i < 
MAX_BINARY_OUTPUTS
; i++) {

184 i(!
	`By_Ouut_Out_Of_Svi
(
i
)) {

185 
e_vue
 = 
	`By_Ouut_P_Vue
(
i
);

186 i(
e_vue
 =
BINARY_INACTIVE
) {

187 
	`pidig_dig_wre
(
i
, 0);

189 
	`pidig_dig_wre
(
i
, 1);

193 
	}
}

207 
	$ma
(

208 
gc
,

209 *
gv
[])

211 
BACNET_ADDRESS
 
c
 = {

214 
ut16_t
 
pdu_n
 = 0;

215 
timeout
 = 1;

216 
time_t
 
ϡ_cds
 = 0;

217 
time_t
 
cut_cds
 = 0;

218 
ut32_t
 
d_cds
 = 0;

219 
ut32_t
 
d_mlicds
 = 0;

220 
ut32_t
 
addss_bdg_tmr
 = 0;

223 i(
gc
 > 1) {

224 
	`Devi_S_Obje_In_Numb
(
	`
(
gv
[1], 
NULL
, 0));

226 
	`tf
("BACnet Raspberry Pi PiFace Digital Demo\n"

229 "Max APDU: %d\n", 
BACt_Vsi
,

230 
	`Devi_Obje_In_Numb
(), 
MAX_APDU
);

233 
	`addss_
();

234 
	`In_Svi_Hdrs
();

235 
	`dnv_
();

236 
	`ex
(
dk_nup
);

237 
	`pi_
();

238 
	`ex
(
pi_nup
);

240 
ϡ_cds
 = 
	`time
(
NULL
);

242 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

246 
cut_cds
 = 
	`time
(
NULL
);

249 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

252 i(
pdu_n
) {

253 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

256 
d_cds
 = (
ut32_t
(
cut_cds
 - 
ϡ_cds
);

257 i(
d_cds
) {

258 
ϡ_cds
 = 
cut_cds
;

259 
	`dcc_tim_cds
(
d_cds
);

260 #i
	`defed
(
BACDL_BIP
&& 
BBMD_ENABLED


261 
	`bvlc_man_tim
(
d_cds
);

263 
	`dnv_man_tim
(
d_cds
);

264 
d_mlicds
 = 
d_cds
 * 1000;

265 
	`hdr_cov_tim_cds
(
d_cds
);

266 
	`tsm_tim_mlicds
(
d_mlicds
);

268 
	`hdr_cov_sk
();

270 
addss_bdg_tmr
 +
d_cds
;

271 i(
addss_bdg_tmr
 >= 60) {

272 
	`addss_che_tim
(
addss_bdg_tmr
);

273 
addss_bdg_tmr
 = 0;

276 
	`pi_sk
();

280 
	}
}

	@demo/ptransfer/main.c

26 
	~<ddef.h
>

27 
	~<dt.h
>

28 
	~<dio.h
>

29 
	~<dlib.h
>

30 
	~<o.h
>

31 
	~<time.h
>

32 
	~<y.h
>

33 #i
defed
(
WIN32
|| defed(
__BORLANDC__
)

34 
	~<cio.h
>

36 
	#PRINT_ENABLED
 1

	)

38 
	~"bacdef.h
"

39 
	~"cfig.h
"

40 
	~"baext.h
"

41 
	~"ba.h
"

42 
	~"m.h
"

43 
	~"f.h
"

44 
	~"tsm.h
"

45 
	~"addss.h
"

46 
	~"du.h
"

47 
	~"du.h
"

48 
	~"devi.h
"

49 
	~"t.h
"

50 
	~"dk.h
"

51 
	~"whois.h
"

53 
	~"fame.h
"

54 
	~"hdrs.h
"

55 
	~".h
"

56 
	~"txbuf.h
"

57 
	~"dnv.h
"

58 
	~"myda.h
"

60 #i
defed
(
__BORLANDC__
)

61 
	#_kbh
 
kbh


	)

62 
	#_ricmp
 
ricmp


	)

65 
ut8_t
 
Sd_Prive_Tnsr_Reque
(

66 
ut32_t
 
devi_id
,

67 
ut16_t
 
vd_id
,

68 
ut32_t
 
rvi_numb
,

69 
block_numb
,

70 
DATABLOCK
 * 
block
);

73 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

76 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

78 
	gTg_Mode
 = 0;

80 
BACNET_ADDRESS
 
	gTg_Addss
;

81 
bo
 
	gE_Deed
 = 
l
;

83 
	$MyEHdr
(

84 
BACNET_ADDRESS
 * 
c
,

85 
ut8_t
 
voke_id
,

86 
BACNET_ERROR_CLASS
 
r_ass
,

87 
BACNET_ERROR_CODE
 
r_code
)

90 (
c
;

91 (
voke_id
;

92 
	`tf
("BACnet Error: %s: %s\r\n",

93 
	`baext_r_ass_me
((
r_ass
),

94 
	`baext_r_code_me
((
r_code
));

96 
	}
}

98 
	$MyAbtHdr
(

99 
BACNET_ADDRESS
 * 
c
,

100 
ut8_t
 
voke_id
,

101 
ut8_t
 
abt_as
,

102 
bo
 
rv
)

105 (
c
;

106 (
voke_id
;

107 (
rv
;

108 
	`tf
("BACnet Abort: %s\r\n",

109 
	`baext_abt_as_me
((
abt_as
));

110 
E_Deed
 = 
ue
;

111 
	}
}

113 
	$MyRejeHdr
(

114 
BACNET_ADDRESS
 * 
c
,

115 
ut8_t
 
voke_id
,

116 
ut8_t
 
je_as
)

119 (
c
;

120 (
voke_id
;

121 
	`tf
("BACnet Reject: %s\r\n",

122 
	`baext_je_as_me
((
je_as
));

123 
E_Deed
 = 
ue
;

124 
	}
}

126 
	$In_Svi_Hdrs
(

129 
	`Devi_In
(
NULL
);

132 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

134 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

137 
du_t_uecognized_rvi_hdr_hdr


138 (
hdr_uecognized_rvi
);

140 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

141 
hdr_ad_ݔty
);

143 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_PRIVATE_TRANSFER
,

144 
hdr_cf_ive_s
);

146 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

147 
hdr_ad_ݔty_ack
);

149 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_PRIVATE_TRANSFER
,

150 
hdr_cf_ive_s_ack
);

153 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
, 
MyEHdr
);

154 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_PRIVATE_TRANSFER
, 
MyEHdr
);

155 
	`du_t_abt_hdr
(
MyAbtHdr
);

156 
	`du_t_je_hdr
(
MyRejeHdr
);

157 
	}
}

159 
	$ma
(

160 
gc
,

161 *
gv
[])

163 
BACNET_ADDRESS
 
c
 = {

166 
ut16_t
 
pdu_n
 = 0;

167 
timeout
 = 100;

168 
max_du
 = 0;

169 
time_t
 
d_cds
 = 0;

170 
time_t
 
ϡ_cds
 = 0;

171 
time_t
 
cut_cds
 = 0;

172 
time_t
 
timeout_cds
 = 0;

173 
ut8_t
 
voke_id
 = 0;

174 
bo
 
found
 = 
l
;

175 
DATABLOCK
 
NewDa
;

176 
iCou
 = 0;

177 
iTy
 = 0;

178 
iKey
;

180 i(((
gc
 != 2) && (argc != 3)) || ((argc >= 2) &&

181 (
	`rcmp
(
gv
[1], "--help") == 0))) {

182 
	`tf
("%s\n", 
gv
[0]);

183 
	`tf
("Usage: %s serverocal-device-instance\r\n or\r\n"

185 
	`fame_move_th
(
gv
[0]), filename_remove_path(argv[0]));

186 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

187 
	`tf
("\r\nServer mode:\r\n\r\n"

203 i(
	`_ricmp
(
gv
[1], "server") == 0)

204 
Tg_Mode
 = 1;

206 
Tg_Mode
 = 0;

208 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1 + 
Tg_Mode
], 
NULL
, 0);

210 i(
Tg_Devi_Obje_In
 > 
BACNET_MAX_INSTANCE
) {

211 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

212 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

217 i(
Tg_Mode
)

218 
	`Devi_S_Obje_In_Numb
(
Tg_Devi_Obje_In
);

220 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

222 
	`addss_
();

223 
	`In_Svi_Hdrs
();

224 
	`dnv_
();

225 
	`ex
(
dk_nup
);

227 
ϡ_cds
 = 
	`time
(
NULL
);

228 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

230 i(
Tg_Mode
) {

231 
	`tf
("Entering server mode.ress qo quitrogram\r\n\r\n");

235 
cut_cds
 = 
	`time
(
NULL
);

236 i(
cut_cds
 !
ϡ_cds
) {

240 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

243 i(
pdu_n
) {

244 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

247 i(
cut_cds
 !
ϡ_cds
) {

248 
	`putch
('.');

249 
ϡ_cds
 = 
cut_cds
;

250 
	`tsm_tim_mlicds
(((
cut_cds
 -

251 
ϡ_cds
) * 1000));

254 i(
	`_kbh
()) {

255 
iKey
 = 
	`tou
(
	`_gch
());

256 i(
iKey
 == 'Q') {

257 
	`tf
("\r\nExitingrogramow\r\n");

258 
	`ex
(0);

265 
found
 =

266 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

267 &
Tg_Addss
);

268 i(!
found
) {

269 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

270 
Tg_Devi_Obje_In
);

275 
cut_cds
 = 
	`time
(
NULL
);

278 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

281 i(
pdu_n
) {

282 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

285 i(
cut_cds
 !
ϡ_cds
)

286 
	`tsm_tim_mlicds
(((
cut_cds
 -

287 
ϡ_cds
) * 1000));

288 i(
E_Deed
)

291 i(!
found
)

292 
found
 =

293 
	`addss_bd_que
(
Tg_Devi_Obje_In
,

294 &
max_du
, &
Tg_Addss
);

295 i(
found
) {

296 i(
voke_id
 == 0) {

297 
iTy
) {

299 
NewDa
.
cMyBy1
 = 
iCou
;

300 
NewDa
.
cMyBy2
 = 255 - 
iCou
;

301 
NewDa
.
fMyRl
 = (
iCou
;

302 
	`ry
((*)
NewDa
.
sMySg
, "Test Data - [x]");

303 
NewDa
.
sMySg
[13] = 'a' + 
iCou
;

304 
	`tf
("Sdg block %d\n", 
iCou
);

305 
voke_id
 =

306 
Sd_Prive_Tnsr_Reque


307 (
Tg_Devi_Obje_In
,

308 
BACNET_VENDOR_ID
, 1, 
iCou
, &
NewDa
);

312 
	`tf
("Requeg block %d\n", 
iCou
);

313 
voke_id
 =

314 
Sd_Prive_Tnsr_Reque


315 (
Tg_Devi_Obje_In
,

316 
BACNET_VENDOR_ID
, 0, 
iCou
, &
NewDa
);

320 
iCou
) {

326 
tf


328 
iCou
);

329 
voke_id
 =

330 
Sd_Prive_Tnsr_Reque


331 (
Tg_Devi_Obje_In
,

332 
BACNET_VENDOR_ID
, 2, 
iCou
, &
NewDa
);

339 
tf


341 
iCou
);

342 
voke_id
 =

343 
Sd_Prive_Tnsr_Reque


344 (
Tg_Devi_Obje_In
,

345 
BACNET_VENDOR_ID
 + 1, 0, 
iCou
,

346 &
NewDa
);

352 } i(
	`tsm_voke_id_
(
voke_id
)) {

353 i(
iCou
 !
MY_MAX_BLOCK
) {

354 
iCou
++;

355 
voke_id
 = 0;

357 
iTy
++;

358 
iCou
 = 0;

359 
voke_id
 = 0;

361 i(
iTy
 > 2)

364 } i(
	`tsm_voke_id_ed
(
voke_id
)) {

365 
	`rtf
(
dr
, "\rError: TSM Timeout!\r\n");

366 
	`tsm__voke_id
(
voke_id
);

367 
E_Deed
 = 
ue
;

373 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

374 i(
d_cds
 > 
timeout_cds
) {

375 
	`tf
("\rError: APDU Timeout!\r\n");

376 
E_Deed
 = 
ue
;

381 
ϡ_cds
 = 
cut_cds
;

384 i(
E_Deed
)

387 
	}
}

	@demo/readbdt/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"addss.h
"

36 
	~"cfig.h
"

37 
	~"bacdef.h
"

38 
	~"du.h
"

39 
	~"du.h
"

40 
	~"devi.h
"

41 
	~"dk.h
"

42 
	~"bvlc.h
"

44 #ide
DEBUG_ENABLED


45 
	#DEBUG_ENABLED
 0

	)

47 
	~"debug.h
"

48 
	~"fame.h
"

49 
	~"hdrs.h
"

50 
	~".h
"

51 
	~"txbuf.h
"

52 
	~"dnv.h
"

55 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

58 
ut32_t
 
	gTg_BBMD_Addss
;

59 
ut16_t
 
	gTg_BBMD_Pt
;

61 
bo
 
	gE_Deed
 = 
l
;

63 
	$MyAbtHdr
(

64 
BACNET_ADDRESS
 * 
c
,

65 
ut8_t
 
voke_id
,

66 
ut8_t
 
abt_as
,

67 
bo
 
rv
)

70 (
c
;

71 (
voke_id
;

72 (
rv
;

73 
	`tf
("BACÈAbt: %s\r\n", 
	`baext_abt_as_me
(
abt_as
));

74 
E_Deed
 = 
ue
;

75 
	}
}

77 
	$MyRejeHdr
(

78 
BACNET_ADDRESS
 * 
c
,

79 
ut8_t
 
voke_id
,

80 
ut8_t
 
je_as
)

83 (
c
;

84 (
voke_id
;

85 
	`tf
("BACÈReje: %s\r\n", 
	`baext_je_as_me
(
je_as
));

86 
E_Deed
 = 
ue
;

87 
	}
}

89 
	$In_Svi_Hdrs
(

92 
	`Devi_In
(
NULL
);

95 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

98 
du_t_uecognized_rvi_hdr_hdr


99 (
hdr_uecognized_rvi
);

101 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

102 
hdr_ad_ݔty
);

104 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_add
);

106 
	`du_t_abt_hdr
(
MyAbtHdr
);

107 
	`du_t_je_hdr
(
MyRejeHdr
);

108 
	}
}

110 
	$ma
(

111 
gc
,

112 *
gv
[])

114 
BACNET_ADDRESS
 
c
 = {

117 
ut16_t
 
pdu_n
 = 0;

118 
timeout
 = 100;

119 
time_t
 
tٮ_cds
 = 0;

120 
time_t
 
d_cds
 = 0;

121 
time_t
 
ϡ_cds
 = 0;

122 
time_t
 
cut_cds
 = 0;

123 
time_t
 
timeout_cds
 = 0;

124 
pt
 = 0;

126 i(
gc
 < 2) {

127 
	`tf
("Uge: %IP [pt]\r\n", 
	`fame_move_th
(
gv
[0]));

130 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

131 
tf


139 
	`fame_move_th
(
gv
[0]));

143 i(
gc
 > 1) {

144 
Tg_BBMD_Addss
 = 
	`_addr
(
gv
[1]);

145 i(
Tg_BBMD_Addss
 == (-1)) {

146 
	`rtf
(
dr
, "IP=%- faedcvaddss.\r\n", 
gv
[1]);

150 i(
gc
 > 2) {

151 
pt
 = 
	`
(
gv
[2], 
NULL
, 0);

152 i((
pt
 > 0) && (port <= 65535)) {

153 
Tg_BBMD_Pt
 = 
	`hts
(
pt
);

155 
	`rtf
(
dr
, "port=%ld -ort must be between 0-65535.\r\n",

156 
pt
);

160 
Tg_BBMD_Pt
 = 
	`hts
(47808);

163 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

164 
	`In_Svi_Hdrs
();

165 
	`addss_
();

166 
	`dnv_
();

167 
	`ex
(
dk_nup
);

169 
ϡ_cds
 = 
	`time
(
NULL
);

170 
timeout_cds
 = 
	`du_timeout
() / 1000;

172 
	`bvlc_bbmd_ad_bdt
(
Tg_BBMD_Addss
, 
Tg_BBMD_Pt
);

176 
cut_cds
 = 
	`time
(
NULL
);

178 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

180 i(
pdu_n
) {

181 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

183 i(
E_Deed
)

186 
d_cds
 = 
cut_cds
 - 
ϡ_cds
;

187 i(
d_cds
) {

188 #i
	`defed
(
BACDL_BIP
&& 
BBMD_ENABLED


189 
	`bvlc_man_tim
(
d_cds
);

192 
tٮ_cds
 +
d_cds
;

193 i(
tٮ_cds
 > 
timeout_cds
)

196 
ϡ_cds
 = 
cut_cds
;

200 
	}
}

	@demo/readfile/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"f.h
"

36 
	~"tsm.h
"

37 
	~"addss.h
"

38 
	~"cfig.h
"

39 
	~"bacdef.h
"

40 
	~"du.h
"

41 
	~"du.h
"

42 
	~"devi.h
"

43 
	~"t.h
"

44 
	~"dk.h
"

45 
	~"whois.h
"

47 
	~"fame.h
"

48 
	~"hdrs.h
"

49 
	~".h
"

50 
	~"txbuf.h
"

51 
	~"dnv.h
"

54 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

57 
ut32_t
 
	gTg_Fe_Obje_In
 = 
BACNET_MAX_INSTANCE
;

58 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

59 
BACNET_ADDRESS
 
	gTg_Addss
;

60 *
	gLol_Fe_Name
 = 
NULL
;

61 
	gTg_Fe_S_Posi
;

62 
	gTg_Fe_Requeed_O_Cou
;

63 
bo
 
	gEnd_Of_Fe_Deed
 = 
l
;

64 
bo
 
	gE_Deed
 = 
l
;

65 
ut8_t
 
	gReque_Invoke_ID
 = 0;

67 
	$Atomic_Rd_Fe_E_Hdr
(

68 
BACNET_ADDRESS
 * 
c
,

69 
ut8_t
 
voke_id
,

70 
BACNET_ERROR_CLASS
 
r_ass
,

71 
BACNET_ERROR_CODE
 
r_code
)

73 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

74 (
voke_id
 =
Reque_Invoke_ID
)) {

75 
	`tf
("BACnet Error: %s: %s\n",

76 
	`baext_r_ass_me
((
r_ass
),

77 
	`baext_r_code_me
((
r_code
));

78 
E_Deed
 = 
ue
;

80 
	}
}

82 
	$MyAbtHdr
(

83 
BACNET_ADDRESS
 * 
c
,

84 
ut8_t
 
voke_id
,

85 
ut8_t
 
abt_as
,

86 
bo
 
rv
)

88 (
rv
;

89 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

90 (
voke_id
 =
Reque_Invoke_ID
)) {

91 
	`tf
("BACnet Abort: %s\n",

92 
	`baext_abt_as_me
((
abt_as
));

93 
E_Deed
 = 
ue
;

95 
	}
}

97 
	$MyRejeHdr
(

98 
BACNET_ADDRESS
 * 
c
,

99 
ut8_t
 
voke_id
,

100 
ut8_t
 
je_as
)

102 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

103 (
voke_id
 =
Reque_Invoke_ID
)) {

104 
	`tf
("BACnet Reject: %s\n",

105 
	`baext_je_as_me
((
je_as
));

106 
E_Deed
 = 
ue
;

108 
	}
}

110 
	$AtomicRdFeAckHdr
(

111 
ut8_t
 * 
rvi_que
,

112 
ut16_t
 
rvi_n
,

113 
BACNET_ADDRESS
 * 
c
,

114 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

116 
n
 = 0;

117 
su
 = 0;

118 
BACNET_ATOMIC_READ_FILE_DATA
 
da
;

119 
FILE
 *
pFe
 = 
NULL
;

120 
size_t
 
os_wrn
 = 0;

122 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

123 (
rvi_da
->
voke_id
 =
Reque_Invoke_ID
)) {

124 
n
 = 
	`f_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

125 i((
n
 > 0&& (
da
.
acss
 =
FILE_STREAM_ACCESS
)) {

126 i(
da
.
ty
.
am
.
feSPosi
 == 0) {

127 
pFe
 = 
	`fݒ
(
Lol_Fe_Name
, "wb");

129 
pFe
 = 
	`fݒ
(
Lol_Fe_Name
, "rb+");

131 i(
pFe
) {

132 
su
 = 
	`fek
(
pFe
, 
da
.
ty
.
am
.
feSPosi
,

133 
SEEK_SET
);

134 i(
su
 == 0) {

137 
os_wrn
 = 
	`fwre
(

138 
	`org_vue
(&
da
.
feDa
), 1,

139 
	`org_ngth
(&
da
.
feDa
), 
pFe
);

140 i(
os_wrn
 !=

141 
	`org_ngth
(&
da
.
feDa
)) {

142 
	`rtf
(
dr
,

144 
Lol_Fe_Name
);

145 } i(
os_wrn
 == 0) {

146 
	`rtf
(
dr
, "Received 0 byte octet string!.\n");

148 
Tg_Fe_S_Posi
 =

149 
da
.
ty
.
am
.
feSPosi
 +

150 
os_wrn
;

151 
	`tf
("\r%d bys", ()
Tg_Fe_S_Posi
);

153 
	`fush
(
pFe
);

155 
	`rtf
(
dr
, "Unableo seeko %d!\n",

156 
da
.
ty
.
am
.
feSPosi
);

158 
	`fo
(
pFe
);

160 i(
da
.
dOfFe
) {

161 
End_Of_Fe_Deed
 = 
ue
;

162 
	`tf
("\n");

165 
	`rtf
(
dr
, "Decodr! %d bydecoded.\n", 
n
);

168 
	`rtf
(
dr
, "Address & Invoke ID mismatch! Invoke ID=%d\n",

169 
Reque_Invoke_ID
);

171 
	}
}

173 
	$LolIAmHdr
(

174 
ut8_t
 * 
rvi_que
,

175 
ut16_t
 
rvi_n
,

176 
BACNET_ADDRESS
 * 
c
)

178 
n
 = 0;

179 
ut32_t
 
devi_id
 = 0;

180 
max_du
 = 0;

181 
gmti
 = 0;

182 
ut16_t
 
vd_id
 = 0;

184 (
c
;

185 (
rvi_n
;

186 
n
 =

187 
	`m_decode_rvi_que
(
rvi_que
, &
devi_id
, &
max_du
,

188 &
gmti
, &
vd_id
);

189 i(
n
 != -1) {

190 
	`addss_add
(
devi_id
, 
max_du
, 
c
);

192 
	`rtf
(
dr
, "!\n");

195 
	}
}

197 
	$In_Svi_Hdrs
(

200 
	`Devi_In
(
NULL
);

203 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

205 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
LolIAmHdr
);

208 
du_t_uecognized_rvi_hdr_hdr


209 (
hdr_uecognized_rvi
);

211 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

212 
hdr_ad_ݔty
);

214 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_ATOMIC_READ_FILE
,

215 
AtomicRdFeAckHdr
);

217 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_ATOMIC_READ_FILE
,

218 
Atomic_Rd_Fe_E_Hdr
);

219 
	`du_t_abt_hdr
(
MyAbtHdr
);

220 
	`du_t_je_hdr
(
MyRejeHdr
);

221 
	}
}

223 
	$ma
(

224 
gc
,

225 *
gv
[])

227 
BACNET_ADDRESS
 
c
 = {

230 
ut16_t
 
pdu_n
 = 0;

231 
timeout
 = 100;

232 
max_du
 = 0;

233 
time_t
 
d_cds
 = 0;

234 
time_t
 
ϡ_cds
 = 0;

235 
time_t
 
cut_cds
 = 0;

236 
time_t
 
timeout_cds
 = 0;

237 
ut8_t
 
voke_id
 = 0;

238 
bo
 
found
 = 
l
;

239 
ut16_t
 
my_max_du
 = 0;

241 i(
gc
 < 4) {

243 
	`tf
("%s device-instance file-instanceocal-name\r\n",

244 
	`fame_move_th
(
gv
[0]));

248 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

249 
Tg_Fe_Obje_In
 = 
	`
(
gv
[2], 
NULL
, 0);

250 
Lol_Fe_Name
 = 
gv
[3];

251 i(
Tg_Devi_Obje_In
 >
BACNET_MAX_INSTANCE
) {

252 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

253 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

256 i(
Tg_Fe_Obje_In
 >
BACNET_MAX_INSTANCE
) {

257 
	`rtf
(
dr
, "file-instance=%u - it must beesshan %u\r\n",

258 
Tg_Fe_Obje_In
, 
BACNET_MAX_INSTANCE
 + 1);

262 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

263 
	`addss_
();

264 
	`In_Svi_Hdrs
();

265 
	`dnv_
();

266 
	`ex
(
dk_nup
);

268 
ϡ_cds
 = 
	`time
(
NULL
);

269 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

271 
found
 =

272 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

273 &
Tg_Addss
);

274 i(!
found
) {

275 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

276 
Tg_Devi_Obje_In
);

281 
cut_cds
 = 
	`time
(
NULL
);

284 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

287 i(
pdu_n
) {

288 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

291 i(
cut_cds
 !
ϡ_cds
) {

292 
	`tsm_tim_mlicds
(((
cut_cds
 - 
ϡ_cds
) * 1000));

295 i(!
found
) {

296 
found
 =

297 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

298 &
Tg_Addss
);

300 i(
found
) {

305 i(
max_du
 < 
MAX_APDU
) {

306 
my_max_du
 = 
max_du
;

308 
my_max_du
 = 
MAX_APDU
;

311 i(
my_max_du
 <= 50) {

312 
Tg_Fe_Requeed_O_Cou
 = 
my_max_du
 - 20;

313 } i(
my_max_du
 <= 480) {

314 
Tg_Fe_Requeed_O_Cou
 = 
my_max_du
 - 32;

315 } i(
my_max_du
 <= 1476) {

316 
Tg_Fe_Requeed_O_Cou
 = 
my_max_du
 - 64;

318 
Tg_Fe_Requeed_O_Cou
 = 
my_max_du
 / 2;

322 i((
voke_id
 =0|| 
	`tsm_voke_id_
(invoke_id)) {

323 i(
End_Of_Fe_Deed
 || 
E_Deed
) {

329 
voke_id
 =

330 
	`Sd_Atomic_Rd_Fe_Sm
(
Tg_Devi_Obje_In
,

331 
Tg_Fe_Obje_In
, 
Tg_Fe_S_Posi
,

332 
Tg_Fe_Requeed_O_Cou
);

333 
Reque_Invoke_ID
 = 
voke_id
;

334 } i(
	`tsm_voke_id_ed
(
voke_id
)) {

335 
	`rtf
(
dr
, "\rError: TSM Timeout!\r\n");

336 
	`tsm__voke_id
(
voke_id
);

338 
E_Deed
 = 
ue
;

343 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

344 i(
d_cds
 > 
timeout_cds
) {

345 
	`rtf
(
dr
, "\rError: APDU Timeout!\r\n");

346 
E_Deed
 = 
ue
;

351 
ϡ_cds
 = 
cut_cds
;

354 i(
E_Deed
) {

359 
	}
}

	@demo/readprop/main.c

26 
	~<ddef.h
>

27 
	~<dt.h
>

28 
	~<dio.h
>

29 
	~<dlib.h
>

30 
	~<o.h
>

31 
	~<time.h
>

33 
	#PRINT_ENABLED
 1

	)

35 
	~"bacdef.h
"

36 
	~"cfig.h
"

37 
	~"baext.h
"

38 
	~"ba.h
"

39 
	~"m.h
"

40 
	~"f.h
"

41 
	~"tsm.h
"

42 
	~"addss.h
"

43 
	~"du.h
"

44 
	~"du.h
"

45 
	~"devi.h
"

46 
	~"t.h
"

47 
	~"dk.h
"

48 
	~"whois.h
"

50 
	~"fame.h
"

51 
	~"hdrs.h
"

52 
	~".h
"

53 
	~"txbuf.h
"

54 
	~"dnv.h
"

57 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

60 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

61 
ut32_t
 
	gTg_Obje_In
 = 
BACNET_MAX_INSTANCE
;

62 
BACNET_OBJECT_TYPE
 
	gTg_Obje_Ty
 = 
OBJECT_ANALOG_INPUT
;

63 
BACNET_PROPERTY_ID
 
	gTg_Obje_Prݔty
 = 
PROP_ACKED_TRANSITIONS
;

64 
t32_t
 
	gTg_Obje_Index
 = 
BACNET_ARRAY_ALL
;

66 
ut8_t
 
	gReque_Invoke_ID
 = 0;

67 
BACNET_ADDRESS
 
	gTg_Addss
;

68 
bo
 
	gE_Deed
 = 
l
;

70 
	$MyEHdr
(

71 
BACNET_ADDRESS
 * 
c
,

72 
ut8_t
 
voke_id
,

73 
BACNET_ERROR_CLASS
 
r_ass
,

74 
BACNET_ERROR_CODE
 
r_code
)

76 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

77 (
voke_id
 =
Reque_Invoke_ID
)) {

78 
	`tf
("BACnet Error: %s: %s\r\n",

79 
	`baext_r_ass_me
((
r_ass
),

80 
	`baext_r_code_me
((
r_code
));

81 
E_Deed
 = 
ue
;

83 
	}
}

85 
	$MyAbtHdr
(

86 
BACNET_ADDRESS
 * 
c
,

87 
ut8_t
 
voke_id
,

88 
ut8_t
 
abt_as
,

89 
bo
 
rv
)

91 (
rv
;

92 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

93 (
voke_id
 =
Reque_Invoke_ID
)) {

94 
	`tf
("BACnet Abort: %s\r\n",

95 
	`baext_abt_as_me
((
abt_as
));

96 
E_Deed
 = 
ue
;

98 
	}
}

100 
	$MyRejeHdr
(

101 
BACNET_ADDRESS
 * 
c
,

102 
ut8_t
 
voke_id
,

103 
ut8_t
 
je_as
)

105 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

106 (
voke_id
 =
Reque_Invoke_ID
)) {

107 
	`tf
("BACnet Reject: %s\r\n",

108 
	`baext_je_as_me
((
je_as
));

109 
E_Deed
 = 
ue
;

111 
	}
}

124 
	$My_Rd_Prݔty_Ack_Hdr
(

125 
ut8_t
 * 
rvi_que
,

126 
ut16_t
 
rvi_n
,

127 
BACNET_ADDRESS
 * 
c
,

128 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

130 
n
 = 0;

131 
BACNET_READ_PROPERTY_DATA
 
da
;

133 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

134 (
rvi_da
->
voke_id
 =
Reque_Invoke_ID
)) {

135 
n
 =

136 
	`_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

137 i(
n
 > 0) {

138 
	`_ack_t_da
(&
da
);

141 
	}
}

143 
	$In_Svi_Hdrs
(

146 
	`Devi_In
(
NULL
);

149 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

151 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

154 
du_t_uecognized_rvi_hdr_hdr


155 (
hdr_uecognized_rvi
);

157 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

158 
hdr_ad_ݔty
);

160 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

161 
My_Rd_Prݔty_Ack_Hdr
);

163 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
, 
MyEHdr
);

164 
	`du_t_abt_hdr
(
MyAbtHdr
);

165 
	`du_t_je_hdr
(
MyRejeHdr
);

166 
	}
}

168 
	$ma
(

169 
gc
,

170 *
gv
[])

172 
BACNET_ADDRESS
 
c
 = {

175 
ut16_t
 
pdu_n
 = 0;

176 
timeout
 = 100;

177 
max_du
 = 0;

178 
time_t
 
d_cds
 = 0;

179 
time_t
 
ϡ_cds
 = 0;

180 
time_t
 
cut_cds
 = 0;

181 
time_t
 
timeout_cds
 = 0;

182 
bo
 
found
 = 
l
;

184 i(
gc
 < 5) {

185 
	`tf
("Usage: %s device-instance object-type object-instance "

186 "ݔty [dex]\r\n", 
	`fame_move_th
(
gv
[0]));

187 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

188 
	`tf
("device-instance:\r\n"

219 "%123 1 101 87\r\n", 
	`fame_move_th
(
gv
[0]),

220 
	`fame_move_th
(
gv
[0]));

225 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

226 
Tg_Obje_Ty
 = 
	`
(
gv
[2], 
NULL
, 0);

227 
Tg_Obje_In
 = 
	`
(
gv
[3], 
NULL
, 0);

228 
Tg_Obje_Prݔty
 = 
	`
(
gv
[4], 
NULL
, 0);

229 i(
gc
 > 5)

230 
Tg_Obje_Index
 = 
	`
(
gv
[5], 
NULL
, 0);

231 i(
Tg_Devi_Obje_In
 > 
BACNET_MAX_INSTANCE
) {

232 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

233 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

238 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

239 
	`addss_
();

240 
	`In_Svi_Hdrs
();

241 
	`dnv_
();

242 
	`ex
(
dk_nup
);

244 
ϡ_cds
 = 
	`time
(
NULL
);

245 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

247 
found
 =

248 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

249 &
Tg_Addss
);

250 i(!
found
) {

251 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

252 
Tg_Devi_Obje_In
);

257 
cut_cds
 = 
	`time
(
NULL
);

260 i(
cut_cds
 !
ϡ_cds
)

261 
	`tsm_tim_mlicds
((
ut16_t
((
cut_cds
 -

262 
ϡ_cds
) * 1000));

263 i(
E_Deed
)

266 i(!
found
) {

267 
found
 =

268 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

269 &
Tg_Addss
);

271 i(
found
) {

272 i(
Reque_Invoke_ID
 == 0) {

273 
Reque_Invoke_ID
 =

274 
	`Sd_Rd_Prݔty_Reque
(
Tg_Devi_Obje_In
,

275 
Tg_Obje_Ty
, 
Tg_Obje_In
,

276 
Tg_Obje_Prݔty
, 
Tg_Obje_Index
);

277 } i(
	`tsm_voke_id_
(
Reque_Invoke_ID
))

279 i(
	`tsm_voke_id_ed
(
Reque_Invoke_ID
)) {

280 
	`rtf
(
dr
, "\rError: TSM Timeout!\r\n");

281 
	`tsm__voke_id
(
Reque_Invoke_ID
);

282 
E_Deed
 = 
ue
;

288 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

289 i(
d_cds
 > 
timeout_cds
) {

290 
	`tf
("\rError: APDU Timeout!\r\n");

291 
E_Deed
 = 
ue
;

297 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

300 i(
pdu_n
) {

301 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

305 
ϡ_cds
 = 
cut_cds
;

308 i(
E_Deed
)

311 
	}
}

	@demo/readpropm/main.c

26 
	~<ddef.h
>

27 
	~<dt.h
>

28 
	~<dio.h
>

29 
	~<dlib.h
>

30 
	~<o.h
>

31 
	~<time.h
>

33 
	#PRINT_ENABLED
 1

	)

35 
	~"bacdef.h
"

36 
	~"cfig.h
"

37 
	~"baext.h
"

38 
	~"ba.h
"

39 
	~"m.h
"

40 
	~"f.h
"

41 
	~"tsm.h
"

42 
	~"addss.h
"

43 
	~"du.h
"

44 
	~"du.h
"

45 
	~"devi.h
"

46 
	~"t.h
"

47 
	~"dk.h
"

48 
	~"whois.h
"

50 
	~"m.h
"

51 
	~"fame.h
"

52 
	~"hdrs.h
"

53 
	~".h
"

54 
	~"txbuf.h
"

55 
	~"dnv.h
"

58 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

61 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

62 
BACNET_READ_ACCESS_DATA
 *
	gRd_Acss_Da
;

64 
ut8_t
 
	gReque_Invoke_ID
 = 0;

65 
BACNET_ADDRESS
 
	gTg_Addss
;

67 
bo
 
	gE_Deed
 = 
l
;

69 
	$MyEHdr
(

70 
BACNET_ADDRESS
 * 
c
,

71 
ut8_t
 
voke_id
,

72 
BACNET_ERROR_CLASS
 
r_ass
,

73 
BACNET_ERROR_CODE
 
r_code
)

75 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

76 (
voke_id
 =
Reque_Invoke_ID
)) {

77 
	`tf
("BACnet Error: %s: %s\r\n",

78 
	`baext_r_ass_me
((
r_ass
),

79 
	`baext_r_code_me
((
r_code
));

80 
E_Deed
 = 
ue
;

82 
	}
}

84 
	$MyAbtHdr
(

85 
BACNET_ADDRESS
 * 
c
,

86 
ut8_t
 
voke_id
,

87 
ut8_t
 
abt_as
,

88 
bo
 
rv
)

90 (
rv
;

91 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

92 (
voke_id
 =
Reque_Invoke_ID
)) {

93 
	`tf
("BACnet Abort: %s\r\n",

94 
	`baext_abt_as_me
((
abt_as
));

95 
E_Deed
 = 
ue
;

97 
	}
}

99 
	$MyRejeHdr
(

100 
BACNET_ADDRESS
 * 
c
,

101 
ut8_t
 
voke_id
,

102 
ut8_t
 
je_as
)

105 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

106 (
voke_id
 =
Reque_Invoke_ID
)) {

107 
	`tf
("BACnet Reject: %s\r\n",

108 
	`baext_je_as_me
((
je_as
));

109 
E_Deed
 = 
ue
;

111 
	}
}

124 
	$My_Rd_Prݔty_Muɝ_Ack_Hdr
(

125 
ut8_t
 * 
rvi_que
,

126 
ut16_t
 
rvi_n
,

127 
BACNET_ADDRESS
 * 
c
,

128 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
)

130 
n
 = 0;

131 
BACNET_READ_ACCESS_DATA
 *
m_da
;

132 
BACNET_READ_ACCESS_DATA
 *
d_m_da
;

133 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

134 
BACNET_PROPERTY_REFERENCE
 *
d_m_ݔty
;

135 
BACNET_APPLICATION_DATA_VALUE
 *
vue
;

136 
BACNET_APPLICATION_DATA_VALUE
 *
d_vue
;

138 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

139 (
rvi_da
->
voke_id
 =
Reque_Invoke_ID
)) {

140 
m_da
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

141 i(
m_da
) {

142 
n
 =

143 
	`m_ack_decode_rvi_que
(
rvi_que
, 
rvi_n
,

144 
m_da
);

146 i(
n
 > 0) {

147 
m_da
) {

148 
	`m_ack_t_da
(
m_da
);

149 
m_ݔty
 = 
m_da
->
liOfPrݔts
;

150 
m_ݔty
) {

151 
vue
 = 
m_ݔty
->value;

152 
vue
) {

153 
d_vue
 = 
vue
;

154 
vue
 = vue->
xt
;

155 
	`
(
d_vue
);

157 
d_m_ݔty
 = 
m_ݔty
;

158 
m_ݔty
 =pm_ݔty->
xt
;

159 
	`
(
d_m_ݔty
);

161 
d_m_da
 = 
m_da
;

162 
m_da
 =pm_da->
xt
;

163 
	`
(
d_m_da
);

166 
	`rtf
(
dr
, "RPM Ack Malformed! Freeing memory...\n");

167 
m_da
) {

168 
m_ݔty
 = 
m_da
->
liOfPrݔts
;

169 
m_ݔty
) {

170 
vue
 = 
m_ݔty
->value;

171 
vue
) {

172 
d_vue
 = 
vue
;

173 
vue
 = vue->
xt
;

174 
	`
(
d_vue
);

176 
d_m_ݔty
 = 
m_ݔty
;

177 
m_ݔty
 =pm_ݔty->
xt
;

178 
	`
(
d_m_ݔty
);

180 
d_m_da
 = 
m_da
;

181 
m_da
 =pm_da->
xt
;

182 
	`
(
d_m_da
);

186 
	}
}

188 
	$In_Svi_Hdrs
(

191 
	`Devi_In
(
NULL
);

194 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

196 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

199 
du_t_uecognized_rvi_hdr_hdr


200 (
hdr_uecognized_rvi
);

202 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

203 
hdr_ad_ݔty
);

205 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

206 
My_Rd_Prݔty_Muɝ_Ack_Hdr
);

208 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
, 
MyEHdr
);

209 
	`du_t_abt_hdr
(
MyAbtHdr
);

210 
	`du_t_je_hdr
(
MyRejeHdr
);

211 
	}
}

213 
	$nup
(

216 
BACNET_READ_ACCESS_DATA
 *
m_obje
;

217 
BACNET_READ_ACCESS_DATA
 *
d_m_obje
;

218 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

219 
BACNET_PROPERTY_REFERENCE
 *
d_m_ݔty
;

221 
m_obje
 = 
Rd_Acss_Da
;

222 
d_m_obje
 = 
m_obje
;

223 
m_obje
) {

224 
m_ݔty
 = 
m_obje
->
liOfPrݔts
;

225 
m_ݔty
) {

226 
d_m_ݔty
 = 
m_ݔty
;

227 
m_ݔty
 =pm_ݔty->
xt
;

228 
	`
(
d_m_ݔty
);

230 
d_m_obje
 = 
m_obje
;

231 
m_obje
 =pm_obje->
xt
;

232 
	`
(
d_m_obje
);

234 
	}
}

236 
	$ma
(

237 
gc
,

238 *
gv
[])

240 
BACNET_ADDRESS
 
c
 = {

243 
ut16_t
 
pdu_n
 = 0;

244 
timeout
 = 100;

245 
max_du
 = 0;

246 
gs_mag
 = 0, 
g_vue_g
 = 0, 
g_ts
 = 0;

247 
time_t
 
d_cds
 = 0;

248 
time_t
 
ϡ_cds
 = 0;

249 
time_t
 
cut_cds
 = 0;

250 
time_t
 
timeout_cds
 = 0;

251 
bo
 
found
 = 
l
;

252 
ut8_t
 
bufr
[
MAX_PDU
] = {

255 
BACNET_READ_ACCESS_DATA
 *
m_obje
;

256 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

257 *
ݔty_tok
 = 
NULL
;

258 
ݔty_id
 = 0;

259 
ݔty_y_dex
 = 0;

260 
sn_cou
 = 0;

261 *
fame
 = 
NULL
;

263 i(
gc
 < 5) {

264 
fame
 = 
	`fame_move_th
(
gv
[0]);

265 
	`tf
("Usage: %s device-instance object-type object-instance "

267 
fame
);

268 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

269 
	`tf
("device-instance:\r\n"

310 "%123 8 123 105\r\n", 
fame
, filename, filename, filename,

311 
fame
);

316 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

317 i(
Tg_Devi_Obje_In
 >
BACNET_MAX_INSTANCE
) {

318 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

319 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

322 
	`ex
(
nup
);

323 
Rd_Acss_Da
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

324 
m_obje
 = 
Rd_Acss_Da
;

325 
gs_mag
 = (
gc
 - 2);

326 
g_ts
 = 0;

327 
m_obje
) {

328 
g_vue_g
 = 2 + (
g_ts
 * 3);

329 
m_obje
->
obje_ty
 = 
	`
(
gv
[
g_vue_g
], 
NULL
, 0);

330 
g_vue_g
++;

331 
gs_mag
--;

332 i(
gs_mag
 <= 0) {

333 
	`rtf
(
dr
, "Error:otnough objectropertyriples.\r\n");

336 i(
m_obje
->
obje_ty
 >
MAX_BACNET_OBJECT_TYPE
) {

337 
	`rtf
(
dr
, "object-type=%u - it must beesshan %u\r\n",

338 
m_obje
->
obje_ty
, 
MAX_BACNET_OBJECT_TYPE
);

341 
m_obje
->
obje_
 = 
	`
(
gv
[
g_vue_g
], 
NULL
, 0);

342 
g_vue_g
++;

343 
gs_mag
--;

344 i(
gs_mag
 <= 0) {

345 
	`rtf
(
dr
, "Error:otnough objectropertyriples.\r\n");

348 i(
m_obje
->
obje_
 > 
BACNET_MAX_INSTANCE
) {

349 
	`rtf
(
dr
, "object-instance=%u - it must beesshan %u\r\n",

350 
m_obje
->
obje_
, 
BACNET_MAX_INSTANCE
 + 1);

353 
m_ݔty
 = 
	`oc
(1, (
BACNET_PROPERTY_REFERENCE
));

354 
m_obje
->
liOfPrݔts
 = 
m_ݔty
;

355 
ݔty_tok
 = 
	`ok
(
gv
[
g_vue_g
], ",");

357 
m_ݔty
) {

358 
sn_cou
 =

359 
	`ssnf
(
ݔty_tok
, "%u[%u]", &
ݔty_id
,

360 &
ݔty_y_dex
);

361 i(
sn_cou
 > 0) {

362 
m_ݔty
->
ݔtyIdtifr
 = 
ݔty_id
;

363 i(
m_ݔty
->
ݔtyIdtifr
 > 
MAX_BACNET_PROPERTY_ID
) {

364 
	`rtf
(
dr
,

366 
m_ݔty
->
ݔtyIdtifr
,

367 
MAX_BACNET_PROPERTY_ID
 + 1);

371 i(
sn_cou
 > 1) {

372 
m_ݔty
->
ݔtyAayIndex
 = 
ݔty_y_dex
;

374 
m_ݔty
->
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

377 
ݔty_tok
 = 
	`ok
(
NULL
, ",");

378 i(
ݔty_tok
) {

379 
m_ݔty
->
xt
 =

380 
	`oc
(1, (
BACNET_PROPERTY_REFERENCE
));

381 
m_ݔty
 =pm_ݔty->
xt
;

383 
m_ݔty
->
xt
 = 
NULL
;

388 
g_vue_g
++;

389 
gs_mag
--;

390 i(
gs_mag
) {

391 
g_ts
++;

392 
m_obje
->
xt
 = 
	`oc
(1, (
BACNET_READ_ACCESS_DATA
));

393 
m_obje
 =pm_obje->
xt
;

399 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

400 
	`addss_
();

401 
	`In_Svi_Hdrs
();

402 
	`dnv_
();

403 
	`ex
(
dk_nup
);

405 
ϡ_cds
 = 
	`time
(
NULL
);

406 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

408 
found
 =

409 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

410 &
Tg_Addss
);

411 i(!
found
) {

412 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

413 
Tg_Devi_Obje_In
);

418 
cut_cds
 = 
	`time
(
NULL
);

421 i(
cut_cds
 !
ϡ_cds
)

422 
	`tsm_tim_mlicds
(((
cut_cds
 - 
ϡ_cds
) * 1000));

423 i(
E_Deed
)

426 i(!
found
) {

427 
found
 =

428 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

429 &
Tg_Addss
);

431 i(
found
) {

432 i(
Reque_Invoke_ID
 == 0) {

433 
Reque_Invoke_ID
 =

434 
	`Sd_Rd_Prݔty_Muɝ_Reque
(&
bufr
[0],

435 (
bufr
), 
Tg_Devi_Obje_In
,

436 
Rd_Acss_Da
);

437 } i(
	`tsm_voke_id_
(
Reque_Invoke_ID
))

439 i(
	`tsm_voke_id_ed
(
Reque_Invoke_ID
)) {

440 
	`rtf
(
dr
, "\rError: TSM Timeout!\r\n");

441 
	`tsm__voke_id
(
Reque_Invoke_ID
);

442 
E_Deed
 = 
ue
;

448 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

449 i(
d_cds
 > 
timeout_cds
) {

450 
	`tf
("\rError: APDU Timeout!\r\n");

451 
E_Deed
 = 
ue
;

457 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

460 i(
pdu_n
) {

461 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

465 
ϡ_cds
 = 
cut_cds
;

468 i(
E_Deed
)

471 
	}
}

	@demo/readrange/main.c

25 
	#PRINT_ENABLED
 1

	)

28 
	~<ddef.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~<dlib.h
>

32 
	~<o.h
>

33 
	~<time.h
>

34 
	~"bacdef.h
"

35 
	~"cfig.h
"

36 
	~"baext.h
"

37 
	~"ba.h
"

38 
	~"m.h
"

39 
	~"tsm.h
"

40 
	~"addss.h
"

41 
	~"du.h
"

42 
	~"du.h
"

43 
	~"devi.h
"

44 
	~"t.h
"

45 
	~"dk.h
"

46 
	~"whois.h
"

47 
	~"vsi.h
"

49 
	~"fame.h
"

50 
	~"hdrs.h
"

51 
	~".h
"

52 
	~"txbuf.h
"

53 
	~"dnv.h
"

54 
	~"adnge.h
"

57 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

60 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

61 
ut32_t
 
	gTg_Obje_In
 = 
BACNET_MAX_INSTANCE
;

62 
BACNET_OBJECT_TYPE
 
	gTg_Obje_Ty
 = 
OBJECT_ANALOG_INPUT
;

63 
BACNET_PROPERTY_ID
 
	gTg_Obje_Prݔty
 = 
PROP_ACKED_TRANSITIONS
;

64 
	gTg_Obje_Rge_Ty
 = 0;

65 
	gTg_Obje_Index
 = 0;

66 
	gTg_Obje_Cou
 = 0;

68 
ut8_t
 
	gReque_Invoke_ID
 = 0;

69 
BACNET_ADDRESS
 
	gTg_Addss
;

70 
bo
 
	gE_Deed
 = 
l
;

72 
BACNET_READ_RANGE_DATA
 
	gRR_Reque
;

74 
	$MyEHdr
(

75 
BACNET_ADDRESS
 * 
c
,

76 
ut8_t
 
voke_id
,

77 
BACNET_ERROR_CLASS
 
r_ass
,

78 
BACNET_ERROR_CODE
 
r_code
)

80 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

81 (
voke_id
 =
Reque_Invoke_ID
)) {

82 
	`tf
("BACnet Error: %s: %s\r\n",

83 
	`baext_r_ass_me
((
r_ass
),

84 
	`baext_r_code_me
((
r_code
));

85 
E_Deed
 = 
ue
;

87 
	}
}

89 
	$MyAbtHdr
(

90 
BACNET_ADDRESS
 * 
c
,

91 
ut8_t
 
voke_id
,

92 
ut8_t
 
abt_as
,

93 
bo
 
rv
)

95 (
rv
;

96 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

97 (
voke_id
 =
Reque_Invoke_ID
)) {

98 
	`tf
("BACnet Abort: %s\n",

99 
	`baext_abt_as_me
((
abt_as
));

100 
E_Deed
 = 
ue
;

102 
	}
}

104 
	$MyRejeHdr
(

105 
BACNET_ADDRESS
 * 
c
,

106 
ut8_t
 
voke_id
,

107 
ut8_t
 
je_as
)

109 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

110 (
voke_id
 =
Reque_Invoke_ID
)) {

111 
	`tf
("BACnet Reject: %s\n",

112 
	`baext_je_as_me
((
je_as
));

113 
E_Deed
 = 
ue
;

115 
	}
}

117 
	$In_Svi_Hdrs
(

120 
	`Devi_In
(
NULL
);

123 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

125 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

128 
du_t_uecognized_rvi_hdr_hdr


129 (
hdr_uecognized_rvi
);

131 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

132 
hdr_ad_ݔty
);

134 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_RANGE
,

135 
hdr_ad_nge_ack
);

138 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
, 
MyEHdr
);

139 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_PRIVATE_TRANSFER
, 
MyEHdr
);

140 
	`du_t_abt_hdr
(
MyAbtHdr
);

141 
	`du_t_je_hdr
(
MyRejeHdr
);

142 
	}
}

144 
	$t_uge
(*
fame
)

146 
	`tf
("Usage: %s device-instance object-type object-instanceroperty\n",

147 
fame
);

148 
	`tf
("ange-type <index|<dateime>> count\n");

149 
	`tf
(" [--version][--help]\n");

150 
	}
}

152 
	$t_hp
(*
fame
)

154 
	`tf
("Readange ofroperties fromnrray oristroperty\n"

189 "%123 20 2 131 1 1 10\n", 
fame
);

190 
	`tf
("%123 20 2 131 2 1 10\n", 
fame
);

191 
	`tf
("%123 20 2 131 3 1/1/2014 00:00:01 10\n", 
fame
);

192 
	}
}

194 
	$ma
(

195 
gc
,

196 *
gv
[])

198 
BACNET_ADDRESS
 
c
 = {

201 
ut16_t
 
pdu_n
 = 0;

202 
timeout
 = 100;

203 
max_du
 = 0;

204 
time_t
 
d_cds
 = 0;

205 
time_t
 
ϡ_cds
 = 0;

206 
time_t
 
cut_cds
 = 0;

207 
time_t
 
timeout_cds
 = 0;

208 
bo
 
found
 = 
l
;

209 
gi
 = 0;

210 
cou
 = 0;

211 
hour
, 
m
, 
c
, 
hunddths
;

212 
yr
, 
mth
, 
day
, 
wday
;

213 *
fame
 = 
NULL
;

215 
fame
 = 
	`fame_move_th
(
gv
[0]);

216 
gi
 = 1;rg< 
gc
;rgi++) {

217 i(
	`rcmp
(
gv
[
gi
], "--help") == 0) {

218 
	`t_uge
(
fame
);

219 
	`t_hp
(
fame
);

222 i(
	`rcmp
(
gv
[
gi
], "--version") == 0) {

223 
	`tf
("%%s\n", 
fame
, 
BACNET_VERSION_TEXT
);

224 
	`tf
("Copyright (C) 2014 by Steve Kargnd others.\n"

231 i(
gc
 < 5) {

232 
	`t_uge
(
fame
);

236 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

237 
Tg_Obje_Ty
 = 
	`
(
gv
[2], 
NULL
, 0);

238 
Tg_Obje_In
 = 
	`
(
gv
[3], 
NULL
, 0);

239 
Tg_Obje_Prݔty
 = 
	`
(
gv
[4], 
NULL
, 0);

240 
Tg_Obje_Rge_Ty
 = 
	`
(
gv
[5], 
NULL
, 0);

242 i(
Tg_Devi_Obje_In
 > 
BACNET_MAX_INSTANCE
) {

243 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

244 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

247 i(
Tg_Obje_Rge_Ty
 == 1) {

248 i(
gc
 < 7) {

249 
	`t_uge
(
fame
);

252 
RR_Reque
.
RequeTy
 = 
RR_BY_POSITION
;

253 
Tg_Obje_Index
 = 
	`
(
gv
[6], 
NULL
, 0);

254 
Tg_Obje_Cou
 = 
	`
(
gv
[7], 
NULL
, 0);

255 
RR_Reque
.
Rge
.
RefIndex
 = 
Tg_Obje_Index
;

256 
RR_Reque
.
Cou
 = 
Tg_Obje_Cou
;

257 } i(
Tg_Obje_Rge_Ty
 == 2) {

258 i(
gc
 < 7) {

259 
	`t_uge
(
fame
);

262 
RR_Reque
.
RequeTy
 = 
RR_BY_SEQUENCE
;

263 
Tg_Obje_Index
 = 
	`
(
gv
[6], 
NULL
, 0);

264 
Tg_Obje_Cou
 = 
	`
(
gv
[7], 
NULL
, 0);

265 
RR_Reque
.
Rge
.
RefSeqNum
 = 
Tg_Obje_Index
;

266 
RR_Reque
.
Cou
 = 
Tg_Obje_Cou
;

267 } i(
Tg_Obje_Rge_Ty
 == 3) {

268 i(
gc
 < 8) {

269 
	`t_uge
(
fame
);

272 
RR_Reque
.
RequeTy
 = 
RR_BY_TIME
;

273 
cou
 =

274 
	`ssnf
(
gv
[6], "%4d/%3d/%3d:%3d", &
yr
, &
mth
, &
day
,

275 &
wday
);

276 i(
cou
 == 3) {

277 
	`dime_t_de
(&
RR_Reque
.
Rge
.
RefTime
.
de
,

278 (
ut16_t

yr
,

279 (
ut8_t

mth
,

280 (
ut8_t

day
);

281 } i(
cou
 == 4) {

282 
RR_Reque
.
Rge
.
RefTime
.
de
.
yr
 = (
ut16_t
) year;

283 
RR_Reque
.
Rge
.
RefTime
.
de
.
mth
 = (
ut8_t
) month;

284 
RR_Reque
.
Rge
.
RefTime
.
de
.
day
 = (
ut8_t
) day;

285 
RR_Reque
.
Rge
.
RefTime
.
de
.
wday
 = (
ut8_t
) wday;

287 
	`rtf
(
dr
, "Invalid date format!\r\n");

290 
cou
 =

291 
	`ssnf
(
gv
[7], "%3d:%3d:%3d.%3d", &
hour
, &
m
, &
c
,

292 &
hunddths
);

293 i(
cou
 == 4) {

294 
RR_Reque
.
Rge
.
RefTime
.
time
.
hour
 = (
ut8_t
) hour;

295 
RR_Reque
.
Rge
.
RefTime
.
time
.
m
 = (
ut8_t
) min;

296 
RR_Reque
.
Rge
.
RefTime
.
time
.
c
 = (
ut8_t
) sec;

297 
RR_Reque
.
Rge
.
RefTime
.
time
.
hunddths
 = (
ut8_t
) hundredths;

298 } i(
cou
 == 3) {

299 
RR_Reque
.
Rge
.
RefTime
.
time
.
hour
 = (
ut8_t
) hour;

300 
RR_Reque
.
Rge
.
RefTime
.
time
.
m
 = (
ut8_t
) min;

301 
RR_Reque
.
Rge
.
RefTime
.
time
.
c
 = (
ut8_t
) sec;

302 
RR_Reque
.
Rge
.
RefTime
.
time
.
hunddths
 = 0;

303 } i(
cou
 == 2) {

304 
RR_Reque
.
Rge
.
RefTime
.
time
.
hour
 = (
ut8_t
) hour;

305 
RR_Reque
.
Rge
.
RefTime
.
time
.
m
 = (
ut8_t
) min;

306 
RR_Reque
.
Rge
.
RefTime
.
time
.
c
 = 0;

307 
RR_Reque
.
Rge
.
RefTime
.
time
.
hunddths
 = 0;

309 
	`rtf
(
dr
, "Invalidime format!\r\n");

312 
Tg_Obje_Cou
 = 
	`
(
gv
[8], 
NULL
, 0);

313 
RR_Reque
.
Cou
 = 
Tg_Obje_Cou
;

314 } i(
Tg_Obje_Rge_Ty
 == 4) {

315 
RR_Reque
.
RequeTy
 = 
RR_READ_ALL
;

316 
RR_Reque
.
Cou
 = 
Tg_Obje_Cou
;

318 
	`rtf
(
dr
, "Invalid Range Type. Use 1, 2, 3, or 4.\r\n");

321 
RR_Reque
.
obje_ty
 = 
Tg_Obje_Ty
;

322 
RR_Reque
.
obje_
 = 
Tg_Obje_In
;

323 
RR_Reque
.
obje_ݔty
 = 
Tg_Obje_Prݔty
;

324 
RR_Reque
.
y_dex
 = 
BACNET_ARRAY_ALL
;

326 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

327 
	`addss_
();

328 
	`In_Svi_Hdrs
();

329 
	`dnv_
();

330 
	`ex
(
dk_nup
);

332 
ϡ_cds
 = 
	`time
(
NULL
);

333 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

335 
found
 =

336 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

337 &
Tg_Addss
);

338 i(!
found
) {

339 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

340 
Tg_Devi_Obje_In
);

345 
cut_cds
 = 
	`time
(
NULL
);

348 i(
cut_cds
 !
ϡ_cds
)

349 
	`tsm_tim_mlicds
((
ut16_t
((
cut_cds
 -

350 
ϡ_cds
) * 1000));

351 i(
E_Deed
)

354 i(!
found
) {

355 
found
 =

356 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

357 &
Tg_Addss
);

359 i(
found
) {

360 i(
Reque_Invoke_ID
 == 0) {

361 
Reque_Invoke_ID
 = 
	`Sd_RdRge_Reque
(

362 
Tg_Devi_Obje_In
,

363 &
RR_Reque
);

364 } i(
	`tsm_voke_id_
(
Reque_Invoke_ID
))

366 i(
	`tsm_voke_id_ed
(
Reque_Invoke_ID
)) {

367 
	`rtf
(
dr
, "\rError: TSM Timeout!\n");

368 
	`tsm__voke_id
(
Reque_Invoke_ID
);

369 
E_Deed
 = 
ue
;

375 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

376 i(
d_cds
 > 
timeout_cds
) {

377 
	`tf
("\rError: APDU Timeout!\n");

378 
E_Deed
 = 
ue
;

384 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

387 i(
pdu_n
) {

388 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

392 
ϡ_cds
 = 
cut_cds
;

395 i(
E_Deed
)

398 
	}
}

	@demo/reinit/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"f.h
"

36 
	~"tsm.h
"

37 
	~"addss.h
"

38 
	~"cfig.h
"

39 
	~"bacdef.h
"

40 
	~"du.h
"

41 
	~"du.h
"

42 
	~"devi.h
"

43 
	~"t.h
"

44 
	~"dk.h
"

45 
	~"whois.h
"

46 
	~"rd.h
"

48 
	~"fame.h
"

49 
	~"hdrs.h
"

50 
	~".h
"

51 
	~"txbuf.h
"

52 
	~"dnv.h
"

55 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

58 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

59 
BACNET_ADDRESS
 
	gTg_Addss
;

60 
BACNET_REINITIALIZED_STATE
 
	gRelize_S
 = 
BACNET_REINIT_COLDSTART
;

61 *
	gRelize_Passwd
 = 
NULL
;

63 
bo
 
	gE_Deed
 = 
l
;

65 
	$MyEHdr
(

66 
BACNET_ADDRESS
 * 
c
,

67 
ut8_t
 
voke_id
,

68 
BACNET_ERROR_CLASS
 
r_ass
,

69 
BACNET_ERROR_CODE
 
r_code
)

72 (
c
;

73 (
voke_id
;

74 
	`tf
("BACÈE: %s: %s\r\n", 
	`baext_r_ass_me
(
r_ass
),

75 
	`baext_r_code_me
(
r_code
));

76 
E_Deed
 = 
ue
;

77 
	}
}

79 
	$MyAbtHdr
(

80 
BACNET_ADDRESS
 * 
c
,

81 
ut8_t
 
voke_id
,

82 
ut8_t
 
abt_as
,

83 
bo
 
rv
)

86 (
c
;

87 (
voke_id
;

88 (
rv
;

89 
	`tf
("BACÈAbt: %s\r\n", 
	`baext_abt_as_me
(
abt_as
));

90 
E_Deed
 = 
ue
;

91 
	}
}

93 
	$MyRejeHdr
(

94 
BACNET_ADDRESS
 * 
c
,

95 
ut8_t
 
voke_id
,

96 
ut8_t
 
je_as
)

99 (
c
;

100 (
voke_id
;

101 
	`tf
("BACÈReje: %s\r\n", 
	`baext_je_as_me
(
je_as
));

102 
E_Deed
 = 
ue
;

103 
	}
}

105 
	$MyRelizeDeviSimeAckHdr
(

106 
BACNET_ADDRESS
 * 
c
,

107 
ut8_t
 
voke_id
)

109 (
c
;

110 (
voke_id
;

111 
	`tf
("ReinitializeDevice Acknowledged!\r\n");

112 
	}
}

114 
	$In_Svi_Hdrs
(

117 
	`Devi_In
(
NULL
);

120 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

122 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

125 
du_t_uecognized_rvi_hdr_hdr


126 (
hdr_uecognized_rvi
);

128 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

129 
hdr_ad_ݔty
);

131 
du_t_cfmed_sime_ack_hdr


132 (
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

133 
MyRelizeDeviSimeAckHdr
);

135 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

136 
MyEHdr
);

137 
	`du_t_abt_hdr
(
MyAbtHdr
);

138 
	`du_t_je_hdr
(
MyRejeHdr
);

139 
	}
}

141 
	$ma
(

142 
gc
,

143 *
gv
[])

145 
BACNET_ADDRESS
 
c
 = {

148 
ut16_t
 
pdu_n
 = 0;

149 
timeout
 = 100;

150 
max_du
 = 0;

151 
time_t
 
d_cds
 = 0;

152 
time_t
 
ϡ_cds
 = 0;

153 
time_t
 
cut_cds
 = 0;

154 
time_t
 
timeout_cds
 = 0;

155 
ut8_t
 
voke_id
 = 0;

156 
bo
 
found
 = 
l
;

158 i(
gc
 < 3) {

160 
	`tf
("Usage: %s device-instance state [password]\r\n"

167 
	`fame_move_th
(
gv
[0]), 
BACNET_MAX_INSTANCE
 - 1);

171 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

172 
Relize_S
 = 
	`
(
gv
[2], 
NULL
, 0);

174 i(
gc
 > 3)

175 
Relize_Passwd
 = 
gv
[3];

177 i(
Tg_Devi_Obje_In
 >
BACNET_MAX_INSTANCE
) {

178 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

179 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

184 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

185 
	`addss_
();

186 
	`In_Svi_Hdrs
();

187 
	`dnv_
();

188 
	`ex
(
dk_nup
);

190 
ϡ_cds
 = 
	`time
(
NULL
);

191 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

193 
found
 =

194 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

195 &
Tg_Addss
);

196 i(!
found
) {

197 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

198 
Tg_Devi_Obje_In
);

203 
cut_cds
 = 
	`time
(
NULL
);

206 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

209 i(
pdu_n
) {

210 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

213 i(
cut_cds
 !
ϡ_cds
)

214 
	`tsm_tim_mlicds
(((
cut_cds
 - 
ϡ_cds
) * 1000));

215 i(
E_Deed
)

218 i(!
found
) {

219 
found
 =

220 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

221 &
Tg_Addss
);

223 i(
found
) {

224 i(
voke_id
 == 0) {

225 
voke_id
 =

226 
Sd_Relize_Devi_Reque


227 (
Tg_Devi_Obje_In
, 
Relize_S
,

228 
Relize_Passwd
);

229 } i(
	`tsm_voke_id_
(
voke_id
))

231 i(
	`tsm_voke_id_ed
(
voke_id
)) {

232 
	`rtf
(
dr
, "\rError: TSM Timeout!\r\n");

233 
	`tsm__voke_id
(
voke_id
);

235 
E_Deed
 = 
ue
;

240 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

241 i(
d_cds
 > 
timeout_cds
) {

242 
	`rtf
(
dr
, "\rError: APDU Timeout!\r\n");

243 
E_Deed
 = 
ue
;

248 
ϡ_cds
 = 
cut_cds
;

251 i(
E_Deed
)

254 
	}
}

	@demo/router-ipv6/main.c

31 
	~<ddef.h
>

32 
	~<dt.h
>

33 
	~<dio.h
>

34 
	~<dlib.h
>

35 
	~<sigl.h
>

36 
	~<time.h
>

37 
	~<as.h
>

39 
	~"bacdef.h
"

40 
	~"cfig.h
"

41 
	~"debug.h
"

42 
	~"baext.h
"

43 
	~"ba.h
"

44 
	~"m.h
"

45 
	~"f.h
"

46 
	~"tsm.h
"

47 
	~"addss.h
"

48 
	~"du.h
"

49 
	~"du.h
"

50 
	~".h
"

51 
	~"t.h
"

52 
	~"vsi.h
"

55 
	~"bvlc6.h
"

56 
	~"b6.h
"

57 #unde
MAX_HEADER


58 #unde
MAX_MPDU


59 
	~"b.h
"

60 
	~"bvlc.h
"

62 
	~"devi.h
"

63 
	~"hdrs.h
"

85 
	s_dt
 {

86 
ut8_t
 
	mmac
[
MAX_MAC_LEN
];

87 
ut8_t
 
	mmac_n
;

88 
ut16_t
 
	mt
;

89 
bo
 
	mabd
;

90 
_dt
 *
	mdts
;

91 
_dt
 *
	mxt
;

92 } 
	tDNET
;

94 
DNET
 *
	gRour_Tab_Hd
;

96 
ut16_t
 
	gBIP_N
;

97 
ut16_t
 
	gBIP6_N
;

99 
ut8_t
 
	gBIP_Rx_Bufr
[
MAX_MPDU
];

100 
ut8_t
 
	gBIP6_Rx_Bufr
[
MAX_MPDU
];

102 
ut8_t
 
	gTx_Bufr
[
MAX_MPDU
];

104 
bo
 
	gEx_Requeed
;

117 
DNET
 *
	$dt_fd
(

118 
ut16_t
 
t
,

119 
BACNET_ADDRESS
 * 
addr
)

122 
DNET
 *
pt
 = 
Rour_Tab_Hd
;

123 
DNET
 *
dt
 = 
NULL
;

124 
i
 = 0;

126 
pt
 !
NULL
) {

127 i(
t
 =
pt
->net) {

129  
pt
;

130 } i(
pt
->
dts
) {

132 
dt
 = 
pt
->
dts
;

133 
dt
 !
NULL
) {

134 i(
t
 =
dt
->net) {

135 i(
addr
) {

136 
addr
->
mac_n
 = 
dt
->mac_len;

137 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

138 
addr
->
mac
[
i
] = 
dt
->mac[i];

141  
pt
;

143 
dt
 = dt->
xt
;

146 
pt
 =t->
xt
;

149  
NULL
;

150 
	}
}

152 
bo
 
	$pt_fd
(

153 
ut16_t
 

,

154 
BACNET_ADDRESS
 *
addr
)

156 
DNET
 *
pt
 = 
NULL
;

157 
bo
 
found
 = 
l
;

158 
i
 = 0;

160 
pt
 = 
Rour_Tab_Hd
;

161 
pt
) {

162 i(
pt
->
t
 =

) {

163 i(
addr
) {

164 
addr
->
mac_n
 = 
pt
->mac_len;

165 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

166 
addr
->
mac
[
i
] = 
pt
->mac[i];

169 
found
 = 
ue
;

172 
pt
 =t->
xt
;

175  
found
;

176 
	}
}

184 
	$pt_add
(

185 
ut16_t
 

,

186 
BACNET_ADDRESS
 *
addr
)

188 
DNET
 *
pt
 = 
NULL
;

189 
DNET
 *
dt
 = 
NULL
;

190 
i
 = 0;

192 
pt
 = 
	`dt_fd
(

, 
NULL
);

193 i(!
pt
) {

194 
pt
 = 
Rour_Tab_Hd
;

195 i(!
pt
) {

197 
pt
 = (
DNET
 *
	`oc
(1, (DNET));

198 
	`as
(
pt
);

199 
Rour_Tab_Hd
 = 
pt
;

201 
pt
) {

202 i(
pt
->
xt
) {

203 
pt
 =t->
xt
;

206 
dt
 = (
DNET
 *
	`oc
(1, (DNET));

207 
	`as
(
dt
);

208 
pt
->
xt
 = 
dt
;

209 
pt
 =t->
xt
;

214 
pt
->
t
 = 

;

215 i(
addr
) {

216 
pt
->
mac_n
 = 
addr
->mac_len;

217 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

218 
pt
->
mac
[
i
] = 
addr
->mac[i];

221 
pt
->
mac_n
 = 0;

223 
pt
->
abd
 = 
ue
;

225 
	}
}

234 
	$dt_add
(

235 
ut16_t
 

,

236 
ut16_t
 
t
,

237 
BACNET_ADDRESS
 *
addr
)

240 
DNET
 *
dt
 = 
NULL
;

241 
DNET
 *
pt
 = 
NULL
;

242 
DNET
 *
i_dt
 = 
NULL
;

243 
i
 = 0;

246 
dt
 = 
	`dt_fd
(
t
, 
NULL
);

247 i(
dt
) {

251 
pt
 = 
	`dt_fd
(

, 
NULL
);

252 i(!
pt
) {

255 
dt
 = 
pt
->
dts
;

256 i(
dt
 =
NULL
) {

258 
dt
 = (
DNET
 *
	`oc
(1, (DNET));

259 
	`as
(
dt
);

260 
pt
->
dts
 = 
dt
;

261 i(
addr
) {

262 
dt
->
mac_n
 = 
addr
->mac_len;

263 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

264 
dt
->
mac
[
i
] = 
addr
->mac[i];

267 
dt
->
t
 =et;

268 
dt
->
abd
 = 
ue
;

269 
dt
->
xt
 = 
NULL
;

271 
dt
 !
NULL
) {

272 i(
dt
->
t
 ==et) {

276 
i_dt
 = 
dt
;

277 
dt
 = dt->
xt
;

280 
dt
 = (
DNET
 *
	`oc
(1, (DNET));

281 i(
addr
) {

282 
dt
->
mac_n
 = 
addr
->mac_len;

283 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

284 
dt
->
mac
[
i
] = 
addr
->mac[i];

287 
dt
->
t
 =et;

288 
dt
->
abd
 = 
ue
;

289 
dt
->
xt
 = 
NULL
;

290 
i_dt
->
xt
 = 
dt
;

292 
	}
}

299 
	$dt_nup
(

300 
DNET
 * 
dts
)

302 
DNET
 *
dt
 = 
dts
;

303 
dt
 !
NULL
) {

304 
	`debug_tf
("DNET %uemoved\n", ()
dt
->
t
);

305 
dt
 = dt->
xt
;

306 
	`
(
dts
);

307 
dts
 = 
dt
;

309 
	}
}

316 
	$dk_g_brd_addss
(

317 
BACNET_ADDRESS
 * 
de
)

319 i(
de
) {

320 
de
->
mac_n
 = 0;

321 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

322 
de
->
n
 = 0;

326 
	}
}

339 
	$dk_nd_pdu
(

340 
ut16_t
 

,

341 
BACNET_ADDRESS
 * 
de
,

342 
BACNET_NPDU_DATA
 * 
du_da
,

343 
ut8_t
 * 
pdu
,

344 
pdu_n
)

346 
bys_
 = 0;

348 i(

 == 0) {

349 
	`debug_tf
("BVLC/BVLC6 SdDNET %u\n", ()
de
->
t
);

350 
bys_
 = 
	`bvlc_nd_pdu
(
de
, 
du_da
, 
pdu
, 
pdu_n
);

351 
bys_
 = 
	`b6_nd_pdu
(
de
, 
du_da
, 
pdu
, 
pdu_n
);

352 } i(

 =
BIP_N
) {

353 
	`debug_tf
("BVLC SdDNET %u\n", ()
de
->
t
);

354 
bys_
 = 
	`bvlc_nd_pdu
(
de
, 
du_da
, 
pdu
, 
pdu_n
);

355 } i(

 =
BIP6_N
) {

356 
	`debug_tf
("BVLC6 SdDNET %u\n",()
de
->
t
);

357 
bys_
 = 
	`b6_nd_pdu
(
de
, 
du_da
, 
pdu
, 
pdu_n
);

360  
bys_
;

361 
	}
}

376 
	$du_code_du_twk
(

377 
BACNET_NPDU_DATA
 * 
du_da
,

378 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

379 
bo
 
da_exg_y
,

380 
BACNET_MESSAGE_PRIORITY
 
iܙy
)

382 i(
du_da
) {

383 
du_da
->
da_exg_y
 = data_expecting_reply;

384 
du_da
->
oc_vsi
 = 
BACNET_PROTOCOL_VERSION
;

385 
du_da
->
twk_y_mesge
 = 
ue
;

386 
du_da
->
twk_mesge_ty
 =etwork_message_type;

387 
du_da
->
vd_id
 = 0;

388 
du_da
->
iܙy
 =riority;

389 
du_da
->
h_cou
 = 
HOP_COUNT_DEFAULT
;

391 
	}
}

403 
	$nd_i_am_rour_to_twk
(
ut16_t
 

, ut16_
t
)

405 
BACNET_ADDRESS
 
de
;

406 
bo
 
da_exg_y
 = 
l
;

407 
BACNET_NPDU_DATA
 
du_da
;

408 
pdu_n
 = 0;

409 
n
 = 0;

410 
DNET
 *
pt
 = 
NULL
;

411 
DNET
 *
dt
 = 
NULL
;

413 
	`dk_g_brd_addss
(&
de
);

414 
	`du_code_du_twk
(&
du_da
,

415 
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
,

416 
da_exg_y
, 
MESSAGE_PRIORITY_NORMAL
);

419 
pdu_n
 =

420 
	`du_code_pdu
(&
Tx_Bufr
[0], &
de
, 
NULL
, &
du_da
);

421 i(
t
) {

422 
n
 = 
	`code_unsigd16
(&
Tx_Bufr
[
pdu_n
], 
t
);

423 
pdu_n
 +
n
;

425 
	`debug_tf
("I-Am-Router-To-Network ");

433 
pt
 = 
Rour_Tab_Hd
;

434 
pt
 !
NULL
) {

435 i(
pt
->
t
 !

) {

436 
	`debug_tf
("%u,", 
pt
->
t
);

437 
n
 = 
	`code_unsigd16
(&
Tx_Bufr
[
pdu_n
],

438 
pt
->
t
);

439 
pdu_n
 +
n
;

440 
dt
 = 
pt
->
dts
;

441 
dt
 !
NULL
) {

442 
	`debug_tf
("%u,", 
dt
->
t
);

443 
n
 = 
	`code_unsigd16
(&
Tx_Bufr
[
pdu_n
],

444 
dt
->
t
);

445 
pdu_n
 +
n
;

446 
dt
 = dt->
xt
;

449 
pt
 =t->
xt
;

451 
	`debug_tf
("om %u\n", 

);

453 
	`dk_nd_pdu
(

, &
de
, &
du_da
, &
Tx_Bufr
[0], 
pdu_n
);

454 
	}
}

469 
	$nd_lize_routg_b_ack
(

470 
ut8_t
 

,

471 
BACNET_ADDRESS
 * 
d
)

473 
BACNET_ADDRESS
 
de
;

474 
bo
 
da_exg_y
 = 
l
;

475 
BACNET_NPDU_DATA
 
du_da
;

476 
pdu_n
 = 0;

477 
n
 = 0;

478 
ut8_t
 
cou
 = 0;

479 
ut8_t
 
pt_id
 = 1;

480 
DNET
 *
pt
 = 
NULL
;

482 i(
d
) {

483 
	`ba_addss_cy
(&
de
, 
d
);

485 
	`dk_g_brd_addss
(&
de
);

487 
	`du_code_du_twk
(&
du_da
,

488 
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
,

489 
da_exg_y
, 
MESSAGE_PRIORITY_NORMAL
);

492 
pdu_n
 =

493 
	`du_code_pdu
(&
Tx_Bufr
[0], &
de
, 
NULL
, &
du_da
);

495 
pt
 = 
Rour_Tab_Hd
;

496 
pt
 !
NULL
) {

497 
cou
++;

498 
pt
 =t->
xt
;

500 
Tx_Bufr
[
pdu_n
] = 
cou
;

501 
pdu_n
++;

502 i(
cou
 > 0) {

507 
pt
 = 
Rour_Tab_Hd
;

508 
pt
 !
NULL
) {

509 
n
 = 
	`code_unsigd16
(&
Tx_Bufr
[
pdu_n
], 
pt
->
t
);

510 
pdu_n
 +
n
;

511 
Tx_Bufr
[
pdu_n
] = 
pt_id
;

512 
pdu_n
++;

513 
pt_id
++;

514 
Tx_Bufr
[
pdu_n
] = 0;

515 
pdu_n
++;

516 
pt
 =t->
xt
;

520 
	`dk_nd_pdu
(

, &
de
, &
du_da
, &
Tx_Bufr
[0], 
pdu_n
);

521 
	}
}

532 
	$nd_je_mesge_to_twk
(

533 
ut16_t
 

,

534 
BACNET_ADDRESS
 * 
d
,

535 
ut8_t
 
je_as
,

536 
ut16_t
 
dt
)

538 
BACNET_ADDRESS
 
de
;

539 
bo
 
da_exg_y
 = 
l
;

540 
BACNET_NPDU_DATA
 
du_da
;

541 
pdu_n
 = 0;

542 
n
 = 0;

544 i(
d
) {

545 
	`ba_addss_cy
(&
de
, 
d
);

547 
	`dk_g_brd_addss
(&
de
);

549 
	`du_code_du_twk
(&
du_da
,

550 
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
,

551 
da_exg_y
, 
MESSAGE_PRIORITY_NORMAL
);

554 
pdu_n
 =

555 
	`du_code_pdu
(&
Tx_Bufr
[0], &
de
, 
NULL
, &
du_da
);

557 
Tx_Bufr
[
pdu_n
] = 
je_as
;

558 
pdu_n
++;

559 i(
dt
) {

560 
n
 = 
	`code_unsigd16
(&
Tx_Bufr
[
pdu_n
], 
dt
);

561 
pdu_n
 +
n
;

564 
	`dk_nd_pdu
(

, &
de
, &
du_da
, &
Tx_Bufr
[0], 
pdu_n
);

565 
	}
}

572 
	$nd_who_is_rour_to_twk
(

573 
ut16_t
 

,

574 
ut16_t
 
dt
)

576 
BACNET_ADDRESS
 
de
;

577 
bo
 
da_exg_y
 = 
l
;

578 
BACNET_NPDU_DATA
 
du_da
;

579 
pdu_n
 = 0;

580 
n
 = 0;

582 
	`dk_g_brd_addss
(&
de
);

583 
	`du_code_du_twk
(&
du_da
,

584 
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
,

585 
da_exg_y
, 
MESSAGE_PRIORITY_NORMAL
);

586 
pdu_n
 =

587 
	`du_code_pdu
(&
Tx_Bufr
[0], &
de
, 
NULL
, &
du_da
);

588 i(
dt
) {

589 
n
 = 
	`code_unsigd16
(&
Tx_Bufr
[
pdu_n
], 
dt
);

590 
pdu_n
 +
n
;

593 
	`dk_nd_pdu
(

, &
de
, &
du_da
, &
Tx_Bufr
[0], 
pdu_n
);

594 
	}
}

652 
	$who_is_rour_to_twk_hdr
(

653 
ut16_t
 

,

654 
BACNET_ADDRESS
 * 
c
,

655 
BACNET_NPDU_DATA
 * 
du_da
,

656 
ut8_t
 * 
du
,

657 
ut16_t
 
du_n
)

659 
DNET
 *
pt
 = 
NULL
;

660 
ut16_t
 
twk
 = 0;

661 
ut16_t
 
n
 = 0;

663 i(
du
) {

664 i(
du_n
 >= 2) {

665 
n
 +
	`decode_unsigd16
(&
du
[n], &
twk
);

666 
pt
 = 
	`dt_fd
(
twk
, 
NULL
);

667 i(
pt
) {

669 i(
pt
->
t
 !

) {

671 
	`nd_i_am_rour_to_twk
(

, 
twk
);

675 
pt
 = 
Rour_Tab_Hd
;

676 
pt
) {

677 i(
pt
->
t
 !

) {

678 
	`nd_who_is_rour_to_twk
(
pt
->
t
, 
twk
);

680 
pt
 =t->
xt
;

684 
	`nd_i_am_rour_to_twk
(

, 0);

687 
	}
}

704 
	$twk_cڌ_hdr
(

705 
ut16_t
 

,

706 
BACNET_ADDRESS
 * 
c
,

707 
BACNET_NPDU_DATA
 * 
du_da
,

708 
ut8_t
 * 
du
,

709 
ut16_t
 
du_n
)

711 
ut16_t
 
du_offt
 = 0;

712 
ut16_t
 
dt
 = 0;

713 
ut16_t
 
n
 = 0;

714 cڡ *
msg_me
 = 
NULL
;

716 
msg_me
 = 
	`baext_twk_y_msg_me
(
du_da
->
twk_mesge_ty
);

717 
	`rtf
(
dr
, "Reived %s\n", 
msg_me
);

718 
du_da
->
twk_mesge_ty
) {

719 
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
:

720 
	`who_is_rour_to_twk_hdr
(

721 

, 
c
, 
du_da
, 
du
, 
du_n
);

723 
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
:

725 
	`rtf
(
dr
, "for Networks: ");

726 
du_n
) {

727 
n
 = 
	`decode_unsigd16
(&
du
[
du_offt
], &
dt
);

728 
	`rtf
(
dr
, "%hu", 
dt
);

729 
	`dt_add
(

, 
dt
, 
c
);

730 
du_n
 -
n
;

731 
du_offt
 +
n
;

732 i(
du_n
) {

733 
	`rtf
(
dr
, ", ");

736 
	`rtf
(
dr
, ".\n");

738 
NETWORK_MESSAGE_I_COULD_BE_ROUTER_TO_NETWORK
:

741 
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
:

742 i(
du_n
 >= 3) {

743 
	`decode_unsigd16
(&
du
[1], &
dt
);

744 
	`rtf
(
dr
, "f Nwk:%hu\n", 
dt
);

745 
du
[0]) {

747 
	`rtf
(
dr
, "Reason: Other Error.\n");

750 
	`rtf
(
dr
, "Reason: Network unreachable.\n");

753 
	`rtf
(
dr
, "Reason: Network is busy.\n");

756 
	`rtf
(
dr
, "Reason: Unknownetwork messageype.\n");

759 
	`rtf
(
dr
, "Reason: Messageooong.\n");

762 
	`rtf
(
dr
, "Reason: Security Error.\n");

765 
	`rtf
(
dr
, "Reason: Invalidddressength.\n");

768 
	`rtf
(
dr
, "Rs: %u\n", ()
du
[0]);

773 
NETWORK_MESSAGE_ROUTER_BUSY_TO_NETWORK
:

774 
NETWORK_MESSAGE_ROUTER_AVAILABLE_TO_NETWORK
:

777 
NETWORK_MESSAGE_INIT_RT_TABLE
:

782 i(
du_n
 > 0) {

784 i(
du
[0] == 0) {

785 
	`nd_lize_routg_b_ack
(

, 
NULL
);

788 
t_cou
 = 
du
[0];

789 
t_cou
--) {

790 
i
 = 1;

792 
	`decode_unsigd16
(&
du
[
i
], &
dt
);

794 
	`dt_add
(

, 
dt
, 
c
);

795 i(
du
[
i
 + 3] > 0) {

797 
i
 = 
du
[i + 3] + 4;

799 
i
 += 4;

802 
	`nd_lize_routg_b_ack
(

, 
NULL
);

807 
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
:

811 
NETWORK_MESSAGE_ESTABLISH_CONNECTION_TO_NETWORK
:

812 
NETWORK_MESSAGE_DISCONNECT_CONNECTION_TO_NETWORK
:

817 
	`nd_je_mesge_to_twk
(

, 
c
,

818 
NETWORK_REJECT_UNKNOWN_MESSAGE_TYPE
, 0);

821 
	}
}

831 
	$roud_c_addss
(

832 
BACNET_ADDRESS
 * 
rour_c
,

833 
ut16_t
 

,

834 
BACNET_ADDRESS
 * 
c
)

836 
i
 = 0;

838 i(
rour_c
 && 
c
) {

840 i(
	`pt_fd
(

, 
rour_c
)) {

841 i(
c
->
t
) {

843 
	`dt_add
(

, 
c
->
t
, src);

845 
rour_c
->
t
 = 
c
->net;

846 
rour_c
->
n
 = 
c
->len;

847 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

848 
rour_c
->
adr
[
i
] = 
c
->adr[i];

852 
rour_c
->
t
 = 

;

853 
rour_c
->
n
 = 
c
->
mac_n
;

854 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

855 
rour_c
->
adr
[
i
] = 
c
->
mac
[i];

860 
	}
}

881 
	$roud_du_hdr
(

882 
ut16_t
 

,

883 
BACNET_NPDU_DATA
 * 
du
,

884 
BACNET_ADDRESS
 * 
c
,

885 
BACNET_ADDRESS
 * 
de
,

886 
ut8_t
 * 
du
,

887 
ut16_t
 
du_n
)

889 
DNET
 *
pt
 = 
NULL
;

890 
BACNET_ADDRESS
 
lol_de
;

891 
BACNET_ADDRESS
 
me_de
;

892 
BACNET_ADDRESS
 
rour_c
;

893 
du_n
 = 0;

896 i(
de
->
t
 =
BACNET_BROADCAST_NETWORK
) {

909 
	`dk_g_brd_addss
(&
lol_de
);

910 
du
->
h_cou
--;

911 
	`roud_c_addss
(&
rour_c
, 

, 
c
);

913 
du_n
 =

914 
	`du_code_pdu
(&
Tx_Bufr
[0], &
lol_de
, &
rour_c
, 
du
);

915 
	`memmove
(&
Tx_Bufr
[
du_n
], 
du
, 
du_n
);

917 
	`debug_tf
("Routg BROADCAST from %u\n", ()

);

918 
pt
 = 
Rour_Tab_Hd
;

919 
pt
 !
NULL
) {

920 i(
pt
->
t
 !

) {

921 
	`dk_nd_pdu
(
pt
->
t
, &
lol_de
, 
du
,

922 &
Tx_Bufr
[0], 
du_n
+
du_n
);

924 
pt
 =t->
xt
;

928 
pt
 = 
	`dt_fd
(
de
->
t
, &
me_de
);

929 i(
pt
) {

930 i(
pt
->
t
 =
de
->net) {

931 
	`debug_tf
("RoutgP܈%u\n", ()
de
->
t
);

939 
	`memmove
(&
lol_de
.
mac
, 
de
->
adr
, 
MAX_MAC_LEN
);

940 
lol_de
.
mac_n
 = 
de
->
n
;

941 
lol_de
.
t
 = 0;

942 
du
->
h_cou
--;

943 
	`roud_c_addss
(&
rour_c
, 

, 
c
);

944 
du_n
 =

945 
	`du_code_pdu
(&
Tx_Bufr
[0], &
lol_de
, &
rour_c
, 
du
);

946 
	`memmove
(&
Tx_Bufr
[
du_n
], 
du
, 
du_n
);

947 
	`dk_nd_pdu
(
pt
->
t
, &
lol_de
, 
du
,

948 &
Tx_Bufr
[0], 
du_n
+
du_n
);

950 
	`debug_tf
("Routingonother Router %u\n",

951 ()
me_de
.
t
);

959 
du
->
h_cou
--;

960 
	`roud_c_addss
(&
rour_c
, 

, 
c
);

961 
du_n
 =

962 
	`du_code_pdu
(&
Tx_Bufr
[0], &
me_de
, &
rour_c
, 
du
);

963 
	`memmove
(&
Tx_Bufr
[
du_n
], 
du
, 
du_n
);

964 
	`dk_nd_pdu
(
pt
->
t
, &
me_de
, 
du
,

965 &
Tx_Bufr
[0], 
du_n
+
du_n
);

967 } i(
de
->
t
) {

968 
	`debug_tf
("Routingo Unknown Route %u\n",

969 ()
de
->
t
);

971 
de
->
mac_n
 = 0;

972 
du
->
h_cou
--;

974 
	`roud_c_addss
(&
rour_c
, 

, 
c
);

975 
du_n
 =

976 
	`du_code_pdu
(&
Tx_Bufr
[0], 
de
, &
rour_c
, 
du
);

977 
	`memmove
(&
Tx_Bufr
[
du_n
], 
du
, 
du_n
);

978 
	`dk_nd_pdu
(
pt
->
t
, 
de
, 
du
,

979 &
Tx_Bufr
[0], 
du_n
+
du_n
);

982 
	`nd_who_is_rour_to_twk
(0, 
de
->
t
);

984 
	}
}

1001 
	$my_routg_du_hdr
(

1002 
ut16_t
 

,

1003 
BACNET_ADDRESS
 * 
c
,

1004 
ut8_t
 * 
pdu
,

1005 
ut16_t
 
pdu_n
)

1007 
du_offt
 = 0;

1008 
BACNET_ADDRESS
 
de
 = { 0 };

1009 
BACNET_NPDU_DATA
 
du_da
 = { 0 };

1011 i(!
pdu
) {

1013 } i(
pdu
[0] =
BACNET_PROTOCOL_VERSION
) {

1014 
du_offt
 = 
	`du_decode
(&
pdu
[0], &
de
, 
c
, &
du_da
);

1015 i(
du_offt
 <= 0) {

1016 
	`rtf
(
dr
, "NPDU: Decoding failed; Discarded!\n");

1017 } i(
du_da
.
twk_y_mesge
) {

1018 i((
de
.
t
 =0|| (de.È=
BACNET_BROADCAST_NETWORK
)) {

1019 
	`twk_cڌ_hdr
(

, 
c
, &
du_da
,

1020 &
pdu
[
du_offt
], (
ut16_t
(
pdu_n
 -pdu_offset));

1026 } i((
du_offt
 > 0&& (du_off<
pdu_n
)) {

1027 i((
de
.
t
 == 0) ||

1028 (
de
.
t
 =
BACNET_BROADCAST_NETWORK
) ||

1029 (
du_da
.
h_cou
 > 1)) {

1033 i((
de
.
t
 =
BACNET_BROADCAST_NETWORK
) &&

1034 ((
pdu
[
du_offt
] & 0xF0) ==

1035 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)) {

1040 
	`roud_du_hdr
(

, &
du_da
, 
c
, &
de
,

1041 &
pdu
[
du_offt
],

1042 (
ut16_t
(
pdu_n
 - 
du_offt
));

1043 i((
de
.
t
 == 0) ||

1044 (
de
.
t
 =
BACNET_BROADCAST_NETWORK
)) {

1045 
	`du_hdr
(
c
, &
pdu
[
du_offt
],

1046 (
ut16_t
(
pdu_n
 - 
du_offt
));

1050 
	`rtf
(
dr
, "NPDU: DNET=%u. Discarded!\n",

1051 (
de
.
t
);

1059 
	}
}

1064 
	$dk_
()

1066 *
pEnv
 = 
NULL
;

1067 
BACNET_ADDRESS
 
my_addss
 = {0};

1068 
bo
 
BIP_Debug
;

1071 
BIP_Debug
 = 
ue
;

1072 
pEnv
 = 
	`gv
("BACNET_IP_PORT");

1073 i(
pEnv
) {

1074 
	`b_t_pt
(
	`hts
((
ut16_t

	`
(
pEnv
, 
NULL
, 0)));

1082 i(
	`ohs
(
	`b_g_pt
()) < 1024) {

1083 
	`b_t_pt
(
	`hts
(0xBAC0));

1086 i(!
	`b_
(
	`gv
("BACNET_IFACE"))) {

1087 
	`ex
(1);

1089 
	`ex
(
b_nup
);

1091 
pEnv
 = 
	`gv
("BACNET_BIP6_PORT");

1092 i(
pEnv
) {

1093 
	`b6_t_pt
((
ut16_t

	`
(
pEnv
, 
NULL
, 0));

1095 
pEnv
 = 
	`gv
("BACNET_BIP6_BROADCAST");

1096 i(
pEnv
) {

1097 
BACNET_IP6_ADDRESS
 
addr
;

1098 
	`bvlc6_addss_t
(&
addr
,

1099 (
ut16_t

	`
(
pEnv
, 
NULL
, 0), 0, 0, 0, 0, 0, 0,

1100 
BIP6_MULTICAST_GROUP_ID
);

1101 
	`b6_t_brd_addr
(&
addr
);

1103 i(!
	`b6_
(
	`gv
("BACNET_BIP6_IFACE"))) {

1104 
	`ex
(1);

1106 
	`ex
(
b6_nup
);

1108 
pEnv
 = 
	`gv
("BACNET_IP_NET");

1109 i(
pEnv
) {

1110 
BIP_N
 = 
	`
(
pEnv
, 
NULL
, 0);

1112 
BIP_N
 = 1;

1115 
	`b_g_my_addss
(&
my_addss
);

1116 
	`pt_add
(
BIP_N
, &
my_addss
);

1118 
pEnv
 = 
	`gv
("BACNET_IP6_NET");

1119 i(
pEnv
) {

1120 
BIP6_N
 = 
	`
(
pEnv
, 
NULL
, 0);

1122 
BIP6_N
 = 2;

1125 
	`b6_g_my_addss
(&
my_addss
);

1126 
	`pt_add
(
BIP6_N
, &
my_addss
);

1127 
	}
}

1132 
	$In_Svi_Hdrs
(

1135 
	`Devi_In
(
NULL
);

1137 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

1138 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_HAS
, 
hdr_who_has
);

1141 
du_t_uecognized_rvi_hdr_hdr


1142 (
hdr_uecognized_rvi
);

1145 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

1146 
hdr_ad_ݔty
);

1147 
	}
}

1153 
	$nup
()

1155 
DNET
 *
pt
 = 
NULL
;

1157 
	`rtf
(
dr
, "Cleaning up...\n");

1159 
pt
 = 
Rour_Tab_Hd
;

1160 
pt
 !
NULL
) {

1161 
	`dt_nup
(
pt
->
dts
);

1162 
pt
 =t->
xt
;

1165 
	`dt_nup
(
Rour_Tab_Hd
);

1166 
	}
}

1168 #i
defed
(
_WIN32
)

1169 
BOOL
 
WINAPI
 
	$ClCHdr
(

1170 
DWORD
 
dwClTy
)

1172 
dwClTy
 = dwCtrlType;

1175 
Ex_Requeed
 = 
ue
;

1176 
Ex_Requeed
) {

1177 
	`S˕
(100);

1179 
	`ex
(0);

1181  
TRUE
;

1182 
	}
}

1184 
	$cڌ_c_hooks
()

1186 
	`SCseMode
(
	`GStdHd
(
STD_INPUT_HANDLE
), 
ENABLE_PROCESSED_INPUT
);

1187 
	`SCseClHdr
((
PHANDLER_ROUTINE

ClCHdr
, 
TRUE
);

1188 
	}
}

1190 
	$sig_t
(

1191 
signo
)

1193 (
signo
;

1194 
Ex_Requeed
 = 
ue
;

1195 
	`ex
(0);

1196 
	}
}

1198 
	$sigl_
(

1201 
	`sigl
(
SIGINT
, 
sig_t
);

1202 
	`sigl
(
SIGHUP
, 
sig_t
);

1203 
	`sigl
(
SIGTERM
, 
sig_t
);

1204 
	}
}

1206 
	$cڌ_c_hooks
()

1208 
	`sigl_
();

1209 
	}
}

1219 
	$ma
(

1220 
gc
,

1221 *
gv
[])

1223 
BACNET_ADDRESS
 
c
 = {

1226 
ut16_t
 
pdu_n
 = 0;

1227 
time_t
 
ϡ_cds
 = 0;

1228 
time_t
 
cut_cds
 = 0;

1229 
ut32_t
 
d_cds
 = 0;

1231 i(
gc
 > 1) {

1232 
	`Devi_S_Obje_In_Numb
(
	`
(
gv
[1], 
NULL
, 0));

1234 
	`tf
("BACnet Simple IP Router Demo\n");

1235 
	`tf
("BACÈSck Vsi %s\n", 
BACt_Vsi
);

1236 
	`tf
("BACnet Device ID: %u\n" "Max APDU: %d\n",

1237 
	`Devi_Obje_In_Numb
(), 
MAX_APDU
);

1238 
	`dk_
();

1239 
	`In_Svi_Hdrs
();

1240 
	`ex
(
nup
);

1241 
	`cڌ_c_hooks
();

1243 
ϡ_cds
 = 
	`time
(
NULL
);

1245 
	`tf
("BACt/IP Nwk: %u\n", ()
BIP_N
);

1246 
	`nd_i_am_rour_to_twk
(
BIP_N
, 0);

1247 
	`tf
("BACt/IPv6 Nwk: %u\n", ()
BIP6_N
);

1248 
	`nd_i_am_rour_to_twk
(
BIP6_N
, 0);

1252 
cut_cds
 = 
	`time
(
NULL
);

1254 
pdu_n
 = 
	`bvlc_ive
(&
c
, &
BIP_Rx_Bufr
[0], 
MAX_MPDU
, 5);

1256 i(
pdu_n
) {

1257 
	`debug_tf
("BACnet/IP Receivedacket\n");

1258 
	`my_routg_du_hdr
(
BIP_N
, &
c
, &
BIP_Rx_Bufr
[0], 
pdu_n
);

1261 
pdu_n
 = 
	`b6_ive
(&
c
, &
BIP6_Rx_Bufr
[0], 
MAX_MPDU
, 5);

1263 i(
pdu_n
) {

1264 
	`debug_tf
("BACnet/IPv6 Receivedacket\n");

1265 
	`my_routg_du_hdr
(
BIP6_N
, &
c
, &
BIP6_Rx_Bufr
[0], 
pdu_n
);

1268 
d_cds
 = (
ut32_t
(
cut_cds
 - 
ϡ_cds
);

1269 i(
d_cds
) {

1270 
ϡ_cds
 = 
cut_cds
;

1271 
	`bvlc_man_tim
(
d_cds
);

1273 i(
Ex_Requeed
) {

1278 
Ex_Requeed
 = 
l
;

1281 
	}
}

	@demo/router/ipmodule.c

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<rg.h
>

32 
	~"modu.h
"

33 
	~"bact.h
"

35 #ifde
TEST_PACKET


36 
ut8_t
 
	g_ck
[] = { 0x81, 0x0a, 0x00, 0x16,

42 
g_lol_addss_iol
(

43 *
iame
,

44 
_addr
 *
addr
,

45 
que
);

47 *
	$dl__thad
(

48 *
pArgs
)

50 
MSGBOX_ID
 
msgboxid
;

51 
BACMSG
 
msg_age
, *
bacmsg
 = 
NULL
;

52 
MSG_DATA
 *
msg_da
;

53 
ROUTER_PORT
 *
pt
 = (ROUTER_PORT *
pArgs
;

54 
IP_DATA
 
_da
;

55 
BACNET_ADDRESS
 
addss
 = { 0 };

56 
us
;

57 
ut8_t
 
shutdown
 = 0;

60 i(!
	`dl__
(
pt
, &
_da
)) {

61 
pt
->
e
 = 
INIT_FAILED
;

62  
NULL
;

66 
_da
.
max_buff
 = 
MAX_BIP_MPDU
;

67 
_da
.
buff
 = (
ut8_t
 *
	`mloc
(_da.
max_buff
);

69 i(
_da
.
buff
 =
NULL
) {

70 
pt
->
e
 = 
INIT_FAILED
;

71  
NULL
;

74 
msgboxid
 = 
	`_msgbox
();

75 i(
msgboxid
 =
INVALID_MSGBOX_ID
) {

76 
	`PRINT
(
ERROR
, "Error: Failedo create message box");

77 
pt
->
e
 = 
INIT_FAILED
;

78  
NULL
;

81 
pt
->
pt_id
 = 
msgboxid
;

82 
pt
->
e
 = 
RUNNING
;

84 !
shutdown
) {

87 
bacmsg
 = 
	`cv_om_msgbox
(
pt
->
pt_id
, &
msg_age
);

89 i(
bacmsg
) {

90 
bacmsg
->
ty
) {

91 
DATA
:{

92 
msg_da
 = (
MSG_DATA
 *
bacmsg
->
da
;

93 
	`memmove
(&
addss
.
t
, &
msg_da
->
de
.net, 2);

94 
	`memmove
(&
addss
.
mac_n
, &
msg_da
->
de
.
n
, 1);

95 
	`memmove
(&
addss
.
mac
[0], &
msg_da
->
de
.
adr
[0],

96 
MAX_MAC_LEN
);

98 
	`dl__nd
(&
_da
, &
addss
, 
msg_da
->
pdu
,

99 
msg_da
->
pdu_n
);

101 
	`check_da
(
msg_da
);

106 
SERVICE
:{

107 
bacmsg
->
subty
) {

108 
SHUTDOWN
:

109 
	`d_msgbox
(
pt
->
pt_id
);

110 
shutdown
 = 1;

122 
us
 = 
	`dl__cv
(&
_da
, &
msg_da
, &
addss
, 1000);

123 i(
us
 > 0) {

124 
	`memmove
(&
msg_da
->
c
.
n
, &
addss
.
mac_n
, 1);

125 
	`memmove
(&
msg_da
->
c
.
adr
[0], &
addss
.
mac
[0], 
MAX_MAC_LEN
);

126 
msg_age
.
ig
 = 
pt
->
pt_id
;

127 
msg_age
.
ty
 = 
DATA
;

128 
msg_age
.
da
 = 
msg_da
;

130 i(!
	`nd_to_msgbox
(
pt
->
ma_id
, &
msg_age
)) {

131 
	`_da
(
msg_da
);

138 
	`dl__nup
(&
_da
);

139 
pt
->
e
 = 
FINISHED
;

140  
NULL
;

141 
	}
}

143 
bo
 
	$dl__
(

144 
ROUTER_PORT
 * 
pt
,

145 
IP_DATA
 * 
_da
)

147 
sockaddr_
 
s
;

148 
sock_t
 = 0;

149 
us
 = 0;

152 
_da
->
pt
 = 
	`hts
t->
ms
.
b_ms
.port);

155 
us
 =

156 
	`g_lol_addss_iol
(
pt
->
i
, &
_da
->
lol_addr
,

157 
SIOCGIFADDR
);

158 i(
us
 < 0) {

159  
l
;

162 
us
 =

163 
	`g_lol_addss_iol
(
pt
->
i
, &
_da
->
brd_addr
,

164 
SIOCGIFBRDADDR
);

165 i(
us
 < 0) {

166  
l
;

169 
_da
->
sock
 = 
	`sock
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_UDP
);

170 i(
_da
->
sock
 < 0)

171  
l
;

175 
sock_t
 = 1;

176 
us
 =

177 
	`tsockt
(
_da
->
sock
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
sock_t
,

178 (
sock_t
));

179 i(
us
 < 0) {

180 
	`o
(
_da
->
sock
);

181  
l
;

184 
us
 =

185 
	`tsockt
(
_da
->
sock
, 
SOL_SOCKET
, 
SO_BROADCAST
, &
sock_t
,

186 (
sock_t
));

187 i(
us
 < 0) {

188 
	`o
(
_da
->
sock
);

189  
l
;

193 
s
.
s_my
 = 
AF_INET
;

194 
s
.
s_addr
.
s_addr
 = 
	`htl
(
INADDR_ANY
);

195 
s
.
s_pt
 = 
_da
->
pt
;

197 
	`memt
(&
s
.
s_zo
, '\0', (sin.sin_zero));

199 
us
 =

200 
	`bd
(
_da
->
sock
, (cڡ 
sockaddr
 *&
s
,

201 (
sockaddr
));

202 i(
us
 < 0) {

203 
	`o
(
_da
->
sock
);

204  
l
;

208 
	`memy
(&
pt
->
rou_fo
.
mac
[0], &
_da
->
lol_addr
.
s_addr
, 4);

209 
	`memy
(&
pt
->
rou_fo
.
mac
[4], &pt->
ms
.
b_ms
.port, 2);

210 
pt
->
rou_fo
.
mac_n
 = 6;

212 
	`PRINT
(
INFO
, "I: %s\n", 
pt
->
i
);

213 
	`PRINT
(
INFO
, "IP Addss: %s\n", 
	`_
(
_da
->
lol_addr
));

214 
	`PRINT
(
INFO
, "IP Broadcast Address: %s\n",

215 
	`_
(
_da
->
brd_addr
));

216 
	`PRINT
(
INFO
, "UDP Pt: 0x%04X [%hu]\n", (
pt
->
ms
.
b_ms
.port),

217 (
pt
->
ms
.
b_ms
.port));

219  
ue
;

220 
	}
}

222 
	$dl__nd
(

223 
IP_DATA
 * 
da
,

224 
BACNET_ADDRESS
 * 
de
,

225 
ut8_t
 * 
pdu
,

226 
pdu_n
)

228 
sockaddr_
 
b_de
 = { 0 };

229 
buff_n
 = 0;

230 
bys_
 = 0;

232 i(
da
->
sock
 < 0)

235 
da
->
buff
[0] = 
BVLL_TYPE_BACNET_IP
;

236 
b_de
.
s_my
 = 
AF_INET
;

237 i(
de
->
t
 =
BACNET_BROADCAST_NETWORK
) {

239 
b_de
.
s_addr
.
s_addr
 = 
da
->
brd_addr
.s_addr;

240 
b_de
.
s_pt
 = 
da
->
pt
;

241 
da
->
buff
[1] = 
BVLC_ORIGINAL_BROADCAST_NPDU
;

242 } i(
de
->
mac_n
 == 6) {

243 
	`memy
(&
b_de
.
s_addr
.
s_addr
, &
de
->
mac
[0], 4);

244 
	`memy
(&
b_de
.
s_pt
, &
de
->
mac
[4], 2);

245 
da
->
buff
[1] = 
BVLC_ORIGINAL_UNICAST_NPDU
;

251 
buff_n
 = 2;

252 
buff_n
 +=

253 
	`code_unsigd16
(&
da
->
buff
[
buff_n
],

254 (
ut16_t
(
pdu_n
 + 4 ));

255 
	`memy
(&
da
->
buff
[
buff_n
], 
pdu
, 
pdu_n
);

256 
buff_n
 +
pdu_n
;

259 
bys_
 =

260 
	`ndto
(
da
->
sock
, (*da->
buff
, 
buff_n
, 0,

261 (
sockaddr
 *&
b_de
, (sockaddr));

263 
	`PRINT
(
DEBUG
, "nd%s\n", 
	`_
(
b_de
.
s_addr
));

265  
bys_
;

266 
	}
}

268 
	$dl__cv
(

269 
IP_DATA
 * 
da
,

270 
MSG_DATA
 ** 
msg_da
,

271 
BACNET_ADDRESS
 * 
c
,

272 
timeout
)

274 
ived_bys
 = 0;

275 
ut16_t
 
buff_n
 = 0;

276 
fd_t
 
ad_fds
;

277 
timev
 
_timeout
;

278 
sockaddr_
 
s
 = { 0 };

279 
sockn_t
 
s_n
 = (
s
);

282 i(
da
->
sock
 < 0)

285 i(
timeout
 >= 1000) {

286 
_timeout
.
tv_c
 = 
timeout
 / 1000;

287 
_timeout
.
tv_uc
 =

288 1000 * (
timeout
 - 
_timeout
.
tv_c
 * 1000);

290 
_timeout
.
tv_c
 = 0;

291 
_timeout
.
tv_uc
 = 1000 * 
timeout
;

294 
	`FD_ZERO
(&
ad_fds
);

295 
	`FD_SET
(
da
->
sock
, &
ad_fds
);

297 #ifde
TEST_PACKET


298 
ived_bys
 = (
_ck
);

299 
	`memmove
(
da
->
buff
, &
_ck
, 
ived_bys
);

300 
s
.
s_addr
.
s_addr
 = 0x7E1D40A;

301 
s
.
s_pt
 = 0xC0BA;

303 
t
 = 
	`
(
da
->
sock
 + 1, &
ad_fds
, 
NULL
, NULL, &
_timeout
);

305 i(
t
 > 0)

306 
ived_bys
 =

307 
	`cvom
(
da
->
sock
, (*&da->
buff
[0], da->
max_buff
, 0,

308 (
sockaddr
 *&
s
, &
s_n
);

312 
	`PRINT
(
DEBUG
, "ived from %s\n", 
	`_
(
s
.
s_addr
));

315 i(
ived_bys
 <= 0) {

320 i(
da
->
buff
[0] !
BVLL_TYPE_BACNET_IP
)

323 
da
->
buff
[1]) {

324 
BVLC_ORIGINAL_UNICAST_NPDU
:

325 
BVLC_ORIGINAL_BROADCAST_NPDU
:{

326 i((
s
.
s_addr
.
s_addr
 =
da
->
lol_addr
.s_addr) &&

327 (
s
.
s_pt
 =
da
->
pt
)) {

328 
buff_n
 = 0;

330 
	`PRINT
(
DEBUG
, "BIP: src is me. Discarded!\n");

333 
c
->
mac_n
 = 6;

334 
	`memy
(&
c
->
mac
[0], &
s
.
s_addr
.
s_addr
, 4);

335 
	`memy
(&
c
->
mac
[4], &
s
.
s_pt
, 2);

337 (
	`decode_unsigd16
(&
da
->
buff
[2], &
buff_n
);

339 
buff_n
 -= 4;

340 i(
buff_n
 < 
da
->
max_buff
) {

342 (*
msg_da
(
MSG_DATA
 *
	`mloc
((MSG_DATA));

343 (*
msg_da
)->
pdu_n
 = 
buff_n
;

344 (*
msg_da
)->
pdu
 =

345 (
ut8_t
 *
	`mloc
((*
msg_da
)->
pdu_n
);

347 
	`memmove
(&(*
msg_da
)->
pdu
[0], &
da
->
buff
[4],

348 (*
msg_da
)->
pdu_n
);

349 
	`memmove
(&(*
msg_da
)->
c
, src,

350 (
BACNET_ADDRESS
));

354 
buff_n
 = 0;

356 
	`PRINT
(
ERROR
, "BIP: PDUooarge. Discarded!.\n");

363 
BVLC_FORWARDED_NPDU
:{

364 
	`memy
(&
s
.
s_addr
.
s_addr
, &
da
->
buff
[4], 4);

365 
	`memy
(&
s
.
s_pt
, &
da
->
buff
[8], 2);

366 i((
s
.
s_addr
.
s_addr
 =
da
->
lol_addr
.s_addr) &&

367 (
s
.
s_pt
 =
da
->
pt
)) {

368 
buff_n
 = 0;

370 
c
->
mac_n
 = 6;

371 
	`memy
(&
c
->
mac
[0], &
s
.
s_addr
.
s_addr
, 4);

372 
	`memy
(&
c
->
mac
[4], &
s
.
s_pt
, 2);

374 (
	`decode_unsigd16
(&
da
->
buff
[2], &
buff_n
);

376 
buff_n
 -= 10;

377 i(
buff_n
 < 
da
->
max_buff
) {

379 (*
msg_da
(
MSG_DATA
 *
	`mloc
((MSG_DATA));

380 (*
msg_da
)->
pdu_n
 = 
buff_n
;

381 (*
msg_da
)->
pdu
 =

382 (
ut8_t
 *
	`mloc
((*
msg_da
)->
pdu_n
);

384 
	`memmove
(&(*
msg_da
)->
pdu
[0], &
da
->
buff
[4 + 6],

385 (*
msg_da
)->
pdu_n
);

386 
	`memmove
(&(*
msg_da
)->
c
, src,

387 (
BACNET_ADDRESS
));

390 
buff_n
 = 0;

397 
	`PRINT
(
ERROR
, "BIP: BVLC discarded!\n");

401  
buff_n
;

402 
	}
}

404 
	$dl__nup
(

405 
IP_DATA
 * 
_da
)

408 i(
_da
->
buff
)

409 
	`
(
_da
->
buff
);

411 i(
_da
->
sock
 > 0)

412 
	`o
(
_da
->
sock
);

414 
	}
}

	@demo/router/ipmodule.h

29 #ide
UDPMODULE_H


30 
	#UDPMODULE_H


	)

32 
	~<dt.h
>

33 
	~<dbo.h
>

34 
	~"p܉had.h
"

35 
	~"b.h
"

37 
	#MAX_BIP_APDU
 1476

	)

38 
	#MAX_BIP_PDU
 (
MAX_NPDU
 + 
MAX_BIP_APDU
)

	)

39 
	#MAX_BIP_MPDU
 (
MAX_HEADER
 + 
MAX_BIP_PDU
)

	)

41 
	s_da
 {

42 
	msock
;

43 
ut16_t
 
	mpt
;

44 
_addr
 
	mlol_addr
;

45 
_addr
 
	mbrd_addr
;

46 
ut8_t
 *
	mbuff
;

47 
ut16_t
 
	mmax_buff
;

48 } 
	tIP_DATA
;

51 *
dl__thad
(

52 *
pArgs
);

54 
bo
 
dl__
(

55 
ROUTER_PORT
 * 
pt
,

56 
IP_DATA
 * 
da
);

58 
dl__nd
(

59 
IP_DATA
 * 
da
,

60 
BACNET_ADDRESS
 * 
de
,

61 
ut8_t
 * 
pdu
,

62 
pdu_n
);

64 
dl__cv
(

65 
IP_DATA
 * 
da
,

66 
MSG_DATA
 ** 
msg
,

67 
BACNET_ADDRESS
 * 
c
,

68 
timeout
);

70 
dl__nup
(

71 
IP_DATA
 * 
da
);

	@demo/router/main.c

32 
	~<ddef.h
>

33 
	~<dt.h
>

34 
	~<dbo.h
>

35 
	~<dio.h
>

36 
	~<dlib.h
>

37 
	~<rg.h
>

38 
	~<time.h
>

39 
	~<o.h
>

40 
	~<as.h
>

41 
	~<f.h
>

42 
	~<libcfig.h
>

43 
	~<unid.h
>

44 
	~<rmios.h
>

45 
	~<gt.h
>

46 
	~<sys/iol.h
>

47 
	~<t/if.h
>

48 
	~<had.h
>

49 
	~<rmios.h
>

50 
	~"msgqueue.h
"

51 
	~"p܉had.h
"

52 
	~"twk_y.h
"

53 
	~"modu.h
"

54 
	~"mpmodu.h
"

56 
	#KEY_ESC
 27

	)

58 
ROUTER_PORT
 *
	ghd
 = 
NULL
;

60 
	gpt_cou
;

62 
t_hp
(

65 
bo
 
ad_cfig
(

66 *
fh
);

68 
bo
 
r_cmd
(

69 
gc
,

70 *
gv
[]);

72 
_pt_thads
(

73 
ROUTER_PORT
 * 
pt_li
);

75 
bo
 
_rour
(

78 
nup
(

81 
t_msg
(

82 
BACMSG
 * 
msg
);

84 
ut16_t
 
oss_msg
(

85 
BACMSG
 * 
msg
,

86 
MSG_DATA
 * 
da
,

87 
ut8_t
 ** 
buff
);

89 
ut16_t
 
g_xt__dt
(

92 
kbh
(

95 
le
 
bo
 
is_twk_msg
(

96 
BACMSG
 * 
msg
);

98 
	$ma
(

99 
gc
,

100 *
gv
[])

102 
	`tf
("Imouter\n");

104 
ROUTER_PORT
 *
pt
;

105 
BACMSG
 
msg_age
, *
bacmsg
 = 
NULL
;

106 
MSG_DATA
 *
msg_da
 = 
NULL
;

107 
ut8_t
 *
buff
 = 
NULL
;

108 
t16_t
 
buff_n
 = 0;

110 
	`ex
(
nup
);

112 i(!
	`r_cmd
(
gc
, 
gv
)) {

113 
	`tf
("parse cmd failed\r\n");

117 i(!
	`_rour
()) {

118 
	`tf
("init_router failed\r\n");

123 
	`nd_twk_mesge
(
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
, 
msg_da
,

124 &
buff
, 
NULL
);

126 
ue
) {

127 i(
	`kbh
()) {

128 
ch
 = 
	`gch
();

129 i(
ch
 =
KEY_ESC
) {

130 
	`PRINT
(
INFO
, "Received shutdown. Exiting...\n");

135 
bacmsg
 = 
	`cv_om_msgbox
(
hd
->
ma_id
, &
msg_age
);

136 i(
bacmsg
) {

137 
bacmsg
->
ty
) {

138 
DATA
:

140 
MSGBOX_ID
 
msg_c
 = 
bacmsg
->
ig
;

143 
msg_da
 = 
	`mloc
((
MSG_DATA
));

144 i(!
msg_da
) {

145 
	`PRINT
(
ERROR
, "Error: Couldotllocate memory\n");

149 
	`t_msg
(
bacmsg
);

151 i(
	`is_twk_msg
(
bacmsg
)) {

152 
buff_n
 =

153 
	`oss_twk_mesge
(
bacmsg
, 
msg_da
,

154 &
buff
);

155 i(
buff_n
 == 0) {

156 
	`_da
(
bacmsg
->
da
);

160 
buff_n
 = 
	`oss_msg
(
bacmsg
, 
msg_da
, &
buff
);

168 i(
buff_n
 > 0) {

170 
msg_da
->
pdu
 = 
buff
;

171 
msg_da
->
pdu_n
 = 
buff_n
;

172 
msg_age
.
ig
 = 
hd
->
ma_id
;

173 
msg_age
.
ty
 = 
DATA
;

174 
msg_age
.
da
 = 
msg_da
;

176 
	`t_msg
(
bacmsg
);

178 i(
	`is_twk_msg
(
bacmsg
)) {

179 
msg_da
->
f_cou
 = 1;

180 
	`nd_to_msgbox
(
msg_c
, &
msg_age
);

181 } i(
msg_da
->
de
.
t
 !=

182 
BACNET_BROADCAST_NETWORK
) {

183 
msg_da
->
f_cou
 = 1;

184 
pt
 =

185 
	`fd_dt
(
msg_da
->
de
.
t
,

186 &
msg_da
->
de
);

187 
	`nd_to_msgbox
(
pt
->
pt_id
, &
msg_age
);

189 
pt
 = 
hd
;

190 
msg_da
->
f_cou
 = 
pt_cou
 - 1;

191 
pt
 !
NULL
) {

192 i(
pt
->
pt_id
 =
msg_c
 ||

193 
pt
->
e
 =
FINISHED
) {

194 
pt
 =t->
xt
;

197 
	`nd_to_msgbox
(
pt
->
pt_id
,

198 &
msg_age
);

199 
pt
 =t->
xt
;

202 } i(
buff_n
 == -1) {

203 
ut16_t
 
t
 = 
msg_da
->
de
.net;

204 
	`PRINT
(
INFO
, "Searching NET...\n");

205 
nd_twk_mesge


206 (
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
,

207 
msg_da
, &
buff
, &
t
);

210 
	`PRINT
(
ERROR
, "Error: Invalid message\n");

211 
	`_da
(
msg_da
);

215 
SERVICE
:

224 
	}
}

226 
	$t_hp
(

229 
	`tf
("Usage:outer <init_method> [init_parameters]\n" "\ninit_method:\n"

240 
	}
}

242 
bo
 
	$ad_cfig
(

243 *
fh
)

245 
cfig_t
 
cfg
;

246 
cfig_g_t
 *
g
;

247 
ROUTER_PORT
 *
cut
 = 
hd
;

248 
su
, 
fd
;

250 
	`cfig_
(&
cfg
);

253 i(!
	`cfig_ad_fe
(&
cfg
, 
fh
)) {

254 
	`PRINT
(
ERROR
, "Cfig fr: %d - %s\n", 
	`cfig_r_le
(&
cfg
),

255 
	`cfig_r_xt
(&
cfg
));

256 
	`cfig_deroy
(&
cfg
);

257  
l
;

261 
g
 = 
	`cfig_lookup
(&
cfg
, "ports");

262 i(
g
 !
NULL
) {

263 
cou
 = 
	`cfig_g_ngth
(
g
);

264 
i
;

267 
i
 = 0; i < 
cou
; i++) {

268 cڡ *
dev_ty
;

269 cڡ *
i
;

270 
m
;

271 cڡ *
r_m
;

272 
cfig_g_t
 *
pt
 = 
	`cfig_g_g_em
(
g
, 
i
);

275 i(
hd
 =
NULL
) {

276 
hd
 = (
ROUTER_PORT
 *
	`mloc
((ROUTER_PORT));

277 
hd
->
xt
 = 
NULL
;

278 
cut
 = 
hd
;

280 
ROUTER_PORT
 *
tmp
 = 
cut
;

281 
cut
 = cut->
xt
;

282 
cut
 = (
ROUTER_PORT
 *
	`mloc
((ROUTER_PORT));

283 
cut
->
xt
 = 
NULL
;

284 
tmp
->
xt
 = 
cut
;

287 
pt_cou
++;

288 
	`cfig_g_lookup_rg
(
pt
, "devi_ty", &
dev_ty
);

289 
	`tf
("dev_ty = %s\r\n", 
dev_ty
);

290 i(
	`rcmp
(
dev_ty
, "bip") == 0) {

291 
cut
->
ty
 = 
BIP
;

293 
su
 = 
	`cfig_g_lookup_rg
(
pt
, "devi", &
i
);

294 i(
su
) {

295 
cut
->
i
 =

296 (*
	`mloc
((
	`
(
i
) + 1) * ());

297 
	`ry
(
cut
->
i
, iface);

300 
fd
 = 
	`sock
(
AF_INET
, 
SOCK_DGRAM
, 0);

301 i(
fd
) {

302 
ieq
 
i
;

303 
	`y
(
i
.
i_me
, 
cut
->
i
,

304 (
i
.
i_me
) - 1);

305 
su
 = 
	`iol
(
fd
, 
SIOCGIFADDR
, &
i
);

306 i(
su
 != -1) {

307 
	`o
(
fd
);

309 
	`PRINT
(
ERROR
,

311  
l
;

315 
cut
->
i
 = "eth0";

318 
su
 =

319 
	`cfig_g_lookup_t
(
pt
, "pt", (*&
m
);

320 i(
su
) {

321 
cut
->
ms
.
b_ms
.
pt
 = 
m
;

323 
cut
->
ms
.
b_ms
.
pt
 = 0xBAC0;

325 
su
 =

326 
	`cfig_g_lookup_t
(
pt
, "twk", (*&
m
);

327 i(
su
) {

328 
cut
->
rou_fo
.
t
 = 
m
;

330 
cut
->
rou_fo
.
t
 = 
	`g_xt__dt
();

333 } i(
	`rcmp
(
dev_ty
, "mstp") == 0) {

334 
cut
->
ty
 = 
MSTP
;

336 
su
 = 
	`cfig_g_lookup_rg
(
pt
, "devi", &
i
);

337 i(
su
) {

338 
cut
->
i
 =

339 (*
	`mloc
((
	`
(
i
) + 1) * ());

340 
	`ry
(
cut
->
i
, iface);

343 
fd
 = 
	`ݒ
(
cut
->
i
, 
O_NOCTTY
 | 
O_NONBLOCK
);

344 i(
fd
 != -1) {

345 
	`o
(
fd
);

347 
	`PRINT
(
ERROR
,

349  
l
;

352 
cut
->
i
 = "/dev/ttyS0";

354 
su
 =

355 
	`cfig_g_lookup_t
(
pt
, "mac", (*&
m
);

356 i(
su
) {

357 
cut
->
rou_fo
.
mac
[0] = 
m
;

358 
cut
->
rou_fo
.
mac_n
 = 1;

360 
cut
->
rou_fo
.
mac
[0] = 127;

361 
cut
->
rou_fo
.
mac_n
 = 1;

363 
su
 =

364 
	`cfig_g_lookup_t
(
pt
, "max_master",

365 (*&
m
);

366 i(
su
) {

367 
cut
->
ms
.
mp_ms
.
max_ma
 = 
m
;

369 
cut
->
ms
.
mp_ms
.
max_ma
 = 127;

371 
su
 =

372 
	`cfig_g_lookup_t
(
pt
, "max_frames",

373 (*&
m
);

374 i(
su
) {

375 
cut
->
ms
.
mp_ms
.
max_ames
 = 
m
;

377 
cut
->
ms
.
mp_ms
.
max_ames
 = 1;

379 
su
 =

380 
	`cfig_g_lookup_t
(
pt
, "baud", (*&
m
);

381 i(
su
) {

382 
cut
->
ms
.
mp_ms
.
baud
 = 
m
;

384 
cut
->
ms
.
mp_ms
.
baud
 = 9600;

386 
su
 =

387 
	`cfig_g_lookup_rg
(
pt
, "ry", &
r_m
);

388 i(
su
) {

389 
r_m
[0]) {

391 
cut
->
ms
.
mp_ms
.
ry
 = 
PARITY_EVEN
;

394 
cut
->
ms
.
mp_ms
.
ry
 = 
PARITY_ODD
;

397 
cut
->
ms
.
mp_ms
.
ry
 = 
PARITY_NONE
;

401 
cut
->
ms
.
mp_ms
.
ry
 = 
PARITY_NONE
;

403 
su
 =

404 
	`cfig_g_lookup_t
(
pt
, "databits",

405 (*&
m
);

406 i(
su
 && 
m
 >= 5 &&aram <= 8) {

407 
cut
->
ms
.
mp_ms
.
dabs
 = 
m
;

409 
cut
->
ms
.
mp_ms
.
dabs
 = 8;

411 
su
 =

412 
	`cfig_g_lookup_t
(
pt
, "stopbits",

413 (*&
m
);

414 i(
su
 && 
m
 >= 1 &&aram <= 2) {

415 
cut
->
ms
.
mp_ms
.
bs
 = 
m
;

417 
cut
->
ms
.
mp_ms
.
bs
 = 1;

419 
su
 =

420 
	`cfig_g_lookup_t
(
pt
, "twk", (*&
m
);

421 i(
su
) {

422 
cut
->
rou_fo
.
t
 = 
m
;

424 
cut
->
rou_fo
.
t
 = 
	`g_xt__dt
();

428 
	`PRINT
(
ERROR
, "E: %unsup܋d\n", 
dev_ty
);

429  
l
;

433 
	`cfig_deroy
(&
cfg
);

434  
l
;

437 
	`cfig_deroy
(&
cfg
);

438 
	`tf
("cmd filearse success\r\n");

439  
ue
;

440 
	}
}

442 
bo
 
	$r_cmd
(

443 
gc
,

444 *
gv
[])

446 cڡ *
tSg
 = "hc:D:";

447 cڡ *
bSg
 = "p:n:D:";

448 cڡ *
mpSg
 = "m:b:p:d:s:n:D:";

449 cڡ 
ti
 
Ois
[] = {

450 {"cfig", 
qued_gumt
, 
NULL
, 'c'},

451 {"devi", 
qued_gumt
, 
NULL
, 'D'},

452 {"twk", 
qued_gumt
, 
NULL
, 'n'},

453 {"pt", 
qued_gumt
, 
NULL
, 'P'},

454 {"mac", 
qued_gumt
, 
NULL
, 'm'},

455 {"baud", 
qued_gumt
, 
NULL
, 'b'},

456 {"ry", 
qued_gumt
, 
NULL
, 'p'},

457 {"dabs", 
qued_gumt
, 
NULL
, 'd'},

458 {"bs", 
qued_gumt
, 
NULL
, 's'},

459 {"hp", 
no_gumt
, 
NULL
, 'h'},

460 {
NULL
, 
no_gumt
, NULL, 0},

463 
t
, 
dev_t
, 
dex
, 
su
, 
fd
;

464 
ROUTER_PORT
 *
cut
 = 
hd
;

466 i(
gc
 < 2)

467 
	`t_hp
();

470 
t
 = 
	`gt_lg
(
gc
, 
gv
, 
tSg
, 
Ois
, &
dex
);

471 
	`tf
("݈%c\r\n", 
t
);

472 
t
 != -1) {

473 
t
) {

475 
	`t_hp
();

476  
l
;

479  
	`ad_cfig
(
ݏrg
);

484 i(
hd
 =
NULL
) {

485 
hd
 = (
ROUTER_PORT
 *
	`mloc
((ROUTER_PORT));

486 
hd
->
xt
 = 
NULL
;

487 
cut
 = 
hd
;

489 
ROUTER_PORT
 *
tmp
 = 
cut
;

490 
cut
 = cut->
xt
;

491 
cut
 = (
ROUTER_PORT
 *
	`mloc
((ROUTER_PORT));

492 
cut
->
xt
 = 
NULL
;

493 
tmp
->
xt
 = 
cut
;

496 
pt_cou
++;

497 i(
	`rcmp
(
ݏrg
, "bip") == 0) {

498 
cut
->
ty
 = 
BIP
;

500 i(
td
 < 
gc
 && 
gv
[optind][0] != '-') {

501 
cut
->
i
 = 
gv
[
td
];

503 
cut
->
i
 = "eth0";

507 
cut
->
ms
.
b_ms
.
pt
 = 0xBAC0;

508 
cut
->
rou_fo
.
t
 = 
	`g_xt__dt
();

511 
fd
 = 
	`sock
(
AF_INET
, 
SOCK_DGRAM
, 0);

512 i(
fd
) {

513 
ieq
 
i
;

514 
	`y
(
i
.
i_me
, 
cut
->
i
,

515 (
i
.
i_me
) - 1);

516 
su
 = 
	`iol
(
fd
, 
SIOCGIFADDR
, &
i
);

517 i(
su
 != -1) {

518 
	`o
(
fd
);

520 
	`PRINT
(
ERROR
,

522  
l
;

526 
dev_t
 =

527 
	`gt_lg
(
gc
, 
gv
, 
bSg
, 
Ois
, &
dex
);

528 
dev_t
 != -1 && dev_opt != 'd') {

529 
dev_t
) {

531 
su
 = 
	`oi
(
ݏrg
);

532 i(
su
) {

533 
cut
->
ms
.
b_ms
.
pt
 =

534 (
ut16_t

su
;

536 
cut
->
ms
.
b_ms
.
pt
 = 0xBAC0;

540 
su
 = 
	`oi
(
ݏrg
);

541 i(
su
) {

542 
cut
->
rou_fo
.
t
 =

543 (
ut16_t

su
;

545 
cut
->
rou_fo
.
t
 = 
pt_cou
;

549 
dev_t
 =

550 
	`gt_lg
(
gc
, 
gv
, 
bSg
, 
Ois
,

551 &
dex
);

553 
t
 = 
dev_t
;

554 } i(
	`rcmp
(
ݏrg
, "mstp") == 0) {

555 
cut
->
ty
 = 
MSTP
;

557 i(
td
 < 
gc
 && 
gv
[optind][0] != '-') {

558 
cut
->
i
 = 
gv
[
td
];

560 
cut
->
i
 = "/dev/ttyS0";

564 
fd
 = 
	`ݒ
(
cut
->
i
, 
O_NOCTTY
 | 
O_NONBLOCK
);

565 i(
fd
 != -1) {

566 
	`o
(
fd
);

568 
	`PRINT
(
ERROR
,

570  
l
;

574 
cut
->
rou_fo
.
mac
[0] = 127;

575 
cut
->
rou_fo
.
mac_n
 = 1;

576 
cut
->
ms
.
mp_ms
.
max_ma
 = 127;

577 
cut
->
ms
.
mp_ms
.
max_ames
 = 1;

578 
cut
->
ms
.
mp_ms
.
baud
 = 9600;

579 
cut
->
ms
.
mp_ms
.
ry
 = 
PARITY_NONE
;

580 
cut
->
ms
.
mp_ms
.
dabs
 = 8;

581 
cut
->
ms
.
mp_ms
.
bs
 = 1;

582 
cut
->
rou_fo
.
t
 = 
	`g_xt__dt
();

584 
dev_t
 =

585 
	`gt_lg
(
gc
, 
gv
, 
mpSg
, 
Ois
, &
dex
);

586 
dev_t
 != -1 && dev_opt != 'D') {

587 
dev_t
) {

589 
su
 = 
	`oi
(
ݏrg
);

590 i(
su
) {

591 
cut
->
rou_fo
.
mac
[0] =

592 (
ut8_t

su
;

594 i(
gv
[
td
][0] != '-') {

595 
cut
->
ms
.
mp_ms
.
max_ma
 =

596 (
ut8_t

	`oi
(
gv
[
td
]);

597 i(
cut
->
ms
.
mp_ms
.

598 
max_ma
 <

599 
cut
->
rou_fo
.
mac
[0])

600 
cut
->
ms
.
mp_ms
.

601 
max_ma
 =

602 
cut
->
rou_fo
.
mac
[0];

604 i(
gv
[
td
 + 1][0] != '-') {

605 
cut
->
ms
.
mp_ms
.

606 
max_ames
 =

607 (
ut8_t

	`oi
(
gv
[
td
 + 1]);

612 
su
 = 
	`oi
(
ݏrg
);

613 i(
su
) {

614 
cut
->
ms
.
mp_ms
.
baud
 =

615 (
ut32_t

su
;

619 
ݏrg
[0]) {

621 
cut
->
ms
.
mp_ms
.
ry
 =

622 
PARITY_EVEN
;

625 
cut
->
ms
.
mp_ms
.
ry
 =

626 
PARITY_ODD
;

629 
cut
->
ms
.
mp_ms
.
ry
 =

630 
PARITY_NONE
;

635 
su
 = 
	`oi
(
ݏrg
);

636 i(
su
 >= 5 &&esult <= 8) {

637 
cut
->
ms
.
mp_ms
.
dabs
 =

638 (
ut8_t

su
;

642 
su
 = 
	`oi
(
ݏrg
);

643 i(
su
 >= 1 &&esult <= 2) {

644 
cut
->
ms
.
mp_ms
.
bs
 =

645 (
ut8_t

su
;

649 
su
 = 
	`oi
(
ݏrg
);

650 i(
su
) {

651 
cut
->
rou_fo
.
t
 =

652 (
ut16_t

su
;

656 
dev_t
 =

657 
	`gt_lg
(
gc
, 
gv
, 
mpSg
, 
Ois
,

658 &
dex
);

660 
t
 = 
dev_t
;

662 
	`PRINT
(
ERROR
, "E: %unknown\n", 
ݏrg
);

663  
l
;

668  
ue
;

669 
	}
}

671 
	$_pt_thads
(

672 
ROUTER_PORT
 * 
pt_li
)

674 
ROUTER_PORT
 *
pt
 = 
pt_li
;

675 
had_t
 *
thad
;

677 
pt
 !
NULL
) {

678 
pt
->
ty
) {

679 
BIP
:

680 
pt
->
func
 = &
dl__thad
;

682 
MSTP
:

683 
pt
->
func
 = &
dl_mp_thad
;

687 
pt
->
e
 = 
INIT
;

688 
thad
 = (
had_t
 *
	`mloc
((pthread_t));

689 
	`had_
(
thad
, 
NULL
, 
pt
->
func
,ort);

691 
	`had_dach
(*
thad
);

693 
pt
 =t->
xt
;

695 
	}
}

697 
bo
 
	$_rour
(

700 
MSGBOX_ID
 
msgboxid
;

701 
ROUTER_PORT
 *
pt
;

703 
msgboxid
 = 
	`_msgbox
();

704 i(
msgboxid
 =
INVALID_MSGBOX_ID
)

705  
l
;

707 
pt
 = 
hd
;

709 
pt
 !
NULL
) {

710 
pt
->
ma_id
 = 
msgboxid
;

711 
pt
 =t->
xt
;

714 
	`_pt_thads
(
hd
);

717 
pt
 = 
hd
;

718 
pt
 !
NULL
) {

719 i(
pt
->
e
 =
RUNNING
) {

720 
pt
 =t->
xt
;

722 } i(
pt
->
e
 =
INIT_FAILED
) {

723 
	`PRINT
(
ERROR
, "E: Faedؚliz%s\n", 
pt
->
i
);

724  
l
;

726 
	`PRINT
(
INFO
, "Initializing...\n");

727 
	`p
(1);

732  
ue
;

733 
	}
}

735 
	$nup
(

738 
ROUTER_PORT
 *
pt
;

739 
BACMSG
 
msg
;

741 i(
hd
 =
NULL
)

744 
msg
.
ig
 = 
hd
->
ma_id
;

745 
msg
.
ty
 = 
SERVICE
;

746 
msg
.
subty
 = 
SHUTDOWN
;

748 
	`d_msgbox
(
hd
->
ma_id
);

751 
pt
 = 
hd
;

752 
pt
 !
NULL
) {

753 i(
pt
->
e
 =
RUNNING
)

754 
	`nd_to_msgbox
(
pt
->
pt_id
, &
msg
);

755 
pt
 =t->
xt
;

758 
pt
 = 
hd
;

759 
pt
 !
NULL
) {

760 i(
pt
->
e
 =
FINISHED
) {

761 
	`nup_dts
(
pt
->
rou_fo
.
dts
);

762 
pt
 =t->
xt
;

763 
	`
(
hd
->
i
);

764 
	`
(
hd
);

765 
hd
 = 
pt
;

769 
	`had_mux_deroy
(&
msg_lock
);

770 
	}
}

772 
	$t_msg
(

773 
BACMSG
 * 
msg
)

775 i(
msg
->
ty
 =
DATA
) {

776 
i
;

777 
MSG_DATA
 *
da
 = (MSG_DATA *
msg
->data;

779 i(
da
->
pdu_n
) {

780 
	`PRINT
(
DEBUG
, "Message PDU: ");

781 
i
 = 0; i < 
da
->
pdu_n
; i++)

782 
	`PRINT
(
DEBUG
, "%02X ", 
da
->
pdu
[
i
]);

783 
	`PRINT
(
DEBUG
, "\n");

786 
	}
}

788 
ut16_t
 
	$oss_msg
(

789 
BACMSG
 * 
msg
,

790 
MSG_DATA
 * 
da
,

791 
ut8_t
 ** 
buff
)

794 
BACNET_ADDRESS
 
addr
;

795 
BACNET_NPDU_DATA
 
du_da
;

796 
ROUTER_PORT
 *
t
;

797 
ROUTER_PORT
 *
dept
;

798 
ut8_t
 
du
[
MAX_NPDU
];

799 
t16_t
 
buff_n
 = 0;

800 
du_offt
;

801 
du_n
;

802 
du_n
;

804 
	`memmove
(
da
, 
msg
->da, (
MSG_DATA
));

806 
du_offt
 = 
	`du_decode
(
da
->
pdu
, &da->
de
, &
addr
, &
du_da
);

807 
du_n
 = 
da
->
pdu_n
 - 
du_offt
;

809 
t
 = 
	`fd_
(
msg
->
ig
);

810 
dept
 = 
	`fd_dt
(
da
->
de
.
t
, 
NULL
);

811 
	`as
(
t
);

813 i(
t
 && 
dept
) {

814 
da
->
c
.
t
 = 
t
->
rou_fo
.net;

817 i(
addr
.
t
 > 0 &&ddr.È< 
BACNET_BROADCAST_NETWORK
 &&

818 
da
->
c
.
t
 !
addr
.net)

819 
	`memmove
(&
da
->
c
, &
addr
, (
BACNET_ADDRESS
));

822 i(
da
->
de
.
t
 =
BACNET_BROADCAST_NETWORK
 ||

823 
dept
->
rou_fo
.
t
 !
da
->
de
.net) {

824 
du_n
 =

825 
	`du_code_pdu
(
du
, &
da
->
de
, &da->
c
, &
du_da
);

827 
du_n
 = 
	`du_code_pdu
(
du
, 
NULL
, &
da
->
c
, &
du_da
);

830 
buff_n
 = 
du_n
 + 
da
->
pdu_n
 - 
du_offt
;

832 *
buff
 = (
ut8_t
 *
	`mloc
(
buff_n
);

833 
	`memmove
(*
buff
, 
du
, 
du_n
);

834 
	`memmove
(*
buff
 + 
du_n
, &
da
->
pdu
[
du_offt
], 
du_n
);

842 
	`_da
((
MSG_DATA
 *
msg
->
da
);

844  
buff_n
;

845 
	}
}

847 
	$kbh
(

850 cڡ 
STDIN
 = 0;

851 
bo
 
lized
 = 
l
;

853 i(!
lized
) {

855 
rmios
 
rm
;

856 
	`tcg
(
STDIN
, &
rm
);

857 
rm
.
c_lag
 &~
ICANON
;

858 
	`tcr
(
STDIN
, 
TCSANOW
, &
rm
);

859 
	`tbuf
(
d
, 
NULL
);

860 
lized
 = 
ue
;

863 
bysWag
;

864 
	`iol
(
STDIN
, 
FIONREAD
, &
bysWag
);

865  
bysWag
;

866 
	}
}

868 
bo
 
	$is_twk_msg
(

869 
BACMSG
 * 
msg
)

872 
ut8_t
 
cڌ_by
;

873 
MSG_DATA
 *
da
 = (MSG_DATA *
msg
->data;

875 
cڌ_by
 = 
da
->
pdu
[1];

877  
cڌ_by
 & 0x80;

878 
	}
}

880 
ut16_t
 
	$g_xt__dt
(

884 
ROUTER_PORT
 *
pt
 = 
hd
;

885 
ut16_t
 
i
 = 1;

886 
pt
) {

887 i(
pt
->
rou_fo
.
t
 =
i
) {

888 
pt
 = 
hd
;

889 
i
++;

893 
pt
 =t->
xt
;

895  
i
;

896 
	}
}

	@demo/router/msgqueue.c

29 
	~<dio.h
>

30 
	~<o.h
>

31 
	~<rg.h
>

32 
	~<dlib.h
>

33 
	~<had.h
>

34 
	~"msgqueue.h
"

36 
had_mux_t
 
	gmsg_lock
 = 
PTHREAD_MUTEX_INITIALIZER
;

38 
MSGBOX_ID
 
	$_msgbox
(

41 
MSGBOX_ID
 
msgboxid
;

43 
msgboxid
 = 
	`msgg
(
IPC_PRIVATE
, 0666 | 
IPC_CREAT
);

44 i(
msgboxid
 =
INVALID_MSGBOX_ID
) {

45  
INVALID_MSGBOX_ID
;

48  
msgboxid
;

49 
	}
}

51 
bo
 
	$nd_to_msgbox
(

52 
MSGBOX_ID
 
de
,

53 
BACMSG
 * 
msg
)

56 
r
;

58 
r
 = 
	`msgd
(
de
, 
msg
, (
BACMSG
)-(
MSGTYPE
), 0);

59 i(
r
) {

60  
l
;

62  
ue
;

63 
	}
}

65 
BACMSG
 *
	$cv_om_msgbox
(

66 
MSGBOX_ID
 
c
,

67 
BACMSG
 * 
msg
)

70 
cv_bys
;

72 
cv_bys
 = 
	`msgrcv
(
c
, 
msg
, (
BACMSG
)-(
MSGTYPE
), 0, 
IPC_NOWAIT
);

73 i(
cv_bys
 > 0) {

74  
msg
;

76  
NULL
;

78 
	}
}

80 
	$d_msgbox
(

81 
MSGBOX_ID
 
msgboxid
)

84 i(
msgboxid
 =
INVALID_MSGBOX_ID
)

87 
	`msgl
(
msgboxid
, 
IPC_RMID
, 
NULL
);

88 
	}
}

90 
	$_da
(

91 
MSG_DATA
 * 
da
)

94 i(
da
->
pdu
) {

95 
	`
(
da
->
pdu
);

96 
da
->
pdu
 = 
NULL
;

98 i(
da
) {

99 
	`
(
da
);

100 
da
 = 
NULL
;

102 
	}
}

104 
	$check_da
(

105 
MSG_DATA
 * 
da
)

109 
	`had_mux_lock
(&
msg_lock
);

110 i(--
da
->
f_cou
 == 0) {

111 
	`_da
(
da
);

113 
	`had_mux_uock
(&
msg_lock
);

114 
	}
}

	@demo/router/msgqueue.h

29 #ide
MSGQUEUE_H


30 
	#MSGQUEUE_H


	)

32 
	~<dt.h
>

33 
	~<dbo.h
>

34 
	~<sys/tys.h
>

35 
	~<sys/c.h
>

36 
	~<sys/msg.h
>

37 
	~"bacdef.h
"

38 
	~"du.h
"

40 
had_mux_t
 
msg_lock
;

42 
	#INVALID_MSGBOX_ID
 -1

	)

44 
	tMSGBOX_ID
;

47 
	mDATA
 = 1,

48 
	mSERVICE


49 } 
	tMSGTYPE
;

52 
	mSHUTDOWN
,

53 
	mCHG_IP
,

54 
	mCHG_MAC


55 } 
	tMSGSUBTYPE
;

57 
	s_mesge
 {

58 
MSGTYPE
 
	mty
;

59 
MSGBOX_ID
 
	mig
;

60 
MSGSUBTYPE
 
	msubty
;

61 *
	mda
;

63 } 
	tBACMSG
;

66 
	s_msg_da
 {

67 
BACNET_ADDRESS
 
	mde
;

68 
BACNET_ADDRESS
 
	mc
;

69 
ut8_t
 *
	mpdu
;

70 
ut16_t
 
	mpdu_n
;

71 
ut8_t
 
	mf_cou
;

72 } 
	tMSG_DATA
;

74 
MSGBOX_ID
 
_msgbox
(

78 
bo
 
nd_to_msgbox
(

79 
MSGBOX_ID
 
de
,

80 
BACMSG
 * 
msg
);

83 
BACMSG
 *
cv_om_msgbox
(

84 
MSGBOX_ID
 
c
,

85 
BACMSG
 * 
msg
);

87 
d_msgbox
(

88 
MSGBOX_ID
 
msgboxid
);

91 
_da
(

92 
MSG_DATA
 * 
da
);

95 
check_da
(

96 
MSG_DATA
 * 
da
);

	@demo/router/mstpmodule.c

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<rg.h
>

32 
	~"mpmodu.h
"

33 
	~"bact.h
"

34 
	~"dlmp_lux.h
"

35 
	~<rmios.h
>

37 
	#MSTP_THREAD_PRINT_ENABLED


	)

38 #ifde
MSTP_THREAD_PRINT_ENABLED


39 
	#mp_thad_debug
(...
	`rtf
(
dr
, 
__VA_ARGS__
)

	)

41 
	#mp_thad_debug
(...)

	)

44 *
	$dl_mp_thad
(

45 *
pArgs
)

48 
ROUTER_PORT
 *
pt
 = (ROUTER_PORT *
pArgs
;

49 
mp_pt_ru_t
 
mp_pt
 = { (
MSTP_RECEIVE_STATE
) 0 };

50 vީ
SHARED_MSTP_DATA
 
shed_pt_da
 = { 0 };

51 
ut16_t
 
pdu_n
;

52 
ut8_t
 
shutdown
 = 0;

54 
shed_pt_da
.
Ty_timeout
 = 260;

55 
shed_pt_da
.
MSTP_Packs
 = 0;

56 
shed_pt_da
.
Tuge_timeout
 = 50;

57 
shed_pt_da
.
RS485_Hd
 = -1;

58 
shed_pt_da
.
RS485_Baud
 = 
B38400
;

59 
shed_pt_da
.
RS485MOD
 = 0;

61 
pt
->
ms
.
mp_ms
.
dabs
) {

63 
shed_pt_da
.
RS485MOD
 = 
CS5
;

66 
shed_pt_da
.
RS485MOD
 = 
CS6
;

69 
shed_pt_da
.
RS485MOD
 = 
CS7
;

72 
shed_pt_da
.
RS485MOD
 = 
CS8
;

76 
pt
->
ms
.
mp_ms
.
ry
) {

77 
PARITY_EVEN
:

78 
shed_pt_da
.
RS485MOD
 |
PARENB
;

80 
PARITY_ODD
:

81 
shed_pt_da
.
RS485MOD
 |
PARENB
 | 
PARODD
;

87 i(
pt
->
ms
.
mp_ms
.
bs
 == 2)

88 
shed_pt_da
.
RS485MOD
 |
CSTOPB
;

90 
mp_pt
.
UrDa
 = (*&
shed_pt_da
;

91 
	`dlmp_t_baud_
(&
mp_pt
, 
pt
->
ms
.
mp_ms
.
baud
);

92 
	`dlmp_t_mac_addss
(&
mp_pt
, 
pt
->
rou_fo
.
mac
[0]);

93 
	`dlmp_t_max_fo_ames
(&
mp_pt
,

94 
pt
->
ms
.
mp_ms
.
max_ames
);

95 
	`dlmp_t_max_ma
(&
mp_pt
, 
pt
->
ms
.
mp_ms
.
max_ma
);

96 i(!
	`dlmp_
(&
mp_pt
, 
pt
->
i
))

97 
	`tf
("MSTP % faed. St.\n", 
pt
->
i
);

99 
pt
->
pt_id
 = 
	`_msgbox
();

100 i(
pt
->
pt_id
 =
INVALID_MSGBOX_ID
) {

101 
pt
->
e
 = 
INIT_FAILED
;

102  
NULL
;

105 
pt
->
e
 = 
RUNNING
;

107 !
shutdown
) {

109 
BACMSG
 
msg_age
, *
bacmsg
;

110 
MSG_DATA
 *
msg_da
;

112 
bacmsg
 = 
	`cv_om_msgbox
(
pt
->
pt_id
, &
msg_age
);

114 i(
bacmsg
) {

115 
bacmsg
->
ty
) {

116 
DATA
:

117 
msg_da
 = (
MSG_DATA
 *
bacmsg
->
da
;

119 i(
msg_da
->
de
.
t
 =
BACNET_BROADCAST_NETWORK
) {

120 
	`dlmp_g_brd_addss
(&(
msg_da
->
de
));

122 
msg_da
->
de
.
mac
[0] = msg_da->de.
adr
[0];

123 
msg_da
->
de
.
mac_n
 = 1;

126 
	`dlmp_nd_pdu
(&
mp_pt
, &(
msg_da
->
de
),

127 
msg_da
->
pdu
, msg_da->
pdu_n
);

129 
	`check_da
(
msg_da
);

133 
SERVICE
:

134 
bacmsg
->
subty
) {

135 
SHUTDOWN
:

136 
shutdown
 = 1;

147 
pdu_n
 = 
	`dlmp_ive
(&
mp_pt
, 
NULL
, NULL, 0, 5);

149 i(
pdu_n
 > 0) {

150 
msg_da
 = (
MSG_DATA
 *
	`mloc
((MSG_DATA));

151 
	`memmove
(&(
msg_da
->
c
),

152 (cڡ *&(
shed_pt_da
.
Reive_Pack
.
addss
),

153 (
shed_pt_da
.
Reive_Pack
.
addss
));

154 
msg_da
->
c
.
adr
[0] = msg_da->c.
mac
[0];

155 
msg_da
->
c
.
n
 = 1;

156 
msg_da
->
pdu
 = (
ut8_t
 *
	`mloc
(
pdu_n
);

157 
	`memmove
(
msg_da
->
pdu
,

158 (cڡ *&(
shed_pt_da
.
Reive_Pack
.
pdu
),

159 
pdu_n
);

160 
msg_da
->
pdu_n
 =du_len;

162 
msg_age
.
ty
 = 
DATA
;

163 
msg_age
.
subty
 = (
MSGSUBTYPE
) 0;

164 
msg_age
.
ig
 = 
pt
->
pt_id
;

165 
msg_age
.
da
 = 
msg_da
;

167 i(!
	`nd_to_msgbox
(
pt
->
ma_id
, &
msg_age
)) {

168 
	`_da
(
msg_da
);

174 
	`dlmp_nup
(&
mp_pt
);

175 
pt
->
e
 = 
FINISHED
;

177  
NULL
;

179 
	}
}

	@demo/router/mstpmodule.h

29 #ide
MSTPMODULE_H


30 
	#MSTPMODULE_H


	)

32 
	~"p܉had.h
"

34 *
dl_mp_thad
(

35 *
pArgs
);

	@demo/router/network_layer.c

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<rg.h
>

32 
	~"twk_y.h
"

33 
	~"bact.h
"

35 
ut16_t
 
	$oss_twk_mesge
(

36 
BACMSG
 * 
msg
,

37 
MSG_DATA
 * 
da
,

38 
ut8_t
 ** 
buff
)

41 
BACNET_NPDU_DATA
 
du_da
;

42 
ROUTER_PORT
 *
t
;

43 
ROUTER_PORT
 *
dept
;

44 
ut16_t
 
t
;

45 
ut8_t
 
r_code
;

46 
t16_t
 
buff_n
 = 0;

47 
du_offt
;

48 
du_n
;

50 
	`memmove
(
da
, 
msg
->da, (
MSG_DATA
));

52 
du_offt
 = 
	`du_decode
(
da
->
pdu
, &da->
de
, 
NULL
, &
du_da
);

53 
du_n
 = 
da
->
pdu_n
 - 
du_offt
;

55 
t
 = 
	`fd_
(
msg
->
ig
);

56 
da
->
c
.
t
 = 
t
->
rou_fo
.net;

58 
du_da
.
twk_mesge_ty
) {

60 
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
:

61 
	`PRINT
(
INFO
, "Recieved Who-Is-Router-To-Network message\n");

62 i(
du_n
) {

64 
	`decode_unsigd16
(&
da
->
pdu
[
du_offt
], &
t
);

65 i(
t
->
rou_fo
.
t
 ==et) {

66 
	`PRINT
(
INFO
, "Message discarded: NET directly connected\n");

70 
dept
 = 
	`fd_dt
(
t
, 
NULL
);

71 i(
dept
) {

73 
	`PRINT
(
INFO
, "Sending I-Am-Router-To-Network message\n");

74 
buff_n
 =

75 
_twk_mesge


76 (
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
, 
da
, 
buff
,

77 &
t
);

79 
da
->
de
.
t
 =et;

84 
	`PRINT
(
INFO
, "Sending I-Am-Router-To-Network message\n");

85 
buff_n
 =

86 
_twk_mesge


87 (
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
, 
da
, 
buff
, 
NULL
);

92 
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
:

94 
	`PRINT
(
INFO
, "Recieved I-Am-Router-To-Network message\n");

95 
t_cou
 = 
du_n
 / 2;

96 
i
;

97 
i
 = 0; i < 
t_cou
; i++) {

98 
	`decode_unsigd16
(&
da
->
pdu
[
du_offt
 + 2 * 
i
], &
t
);

99 
	`add_dt
(&
t
->
rou_fo
, 
t
, 
da
->
c
);

103 
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
:

107 
r_code
 = 
da
->
pdu
[
du_offt
];

108 
r_code
) {

110 
	`PRINT
(
ERROR
, "Error!\n");

113 
	`PRINT
(
ERROR
, "Error: Network unreachable\n");

116 
	`PRINT
(
ERROR
, "Error: Network is busy\n");

119 
	`PRINT
(
ERROR
, "Error: Unknownetwork messageype\n");

122 
	`PRINT
(
ERROR
, "Error: Messageooong\n");

127 
NETWORK_MESSAGE_INIT_RT_TABLE
:

128 
	`PRINT
(
INFO
, "Recieved Initialize-Routing-Table message\n");

129 i(
da
->
pdu
[
du_offt
] > 0) {

130 
t_cou
 = 
da
->
pdu
[
du_offt
];

131 
t_cou
--) {

132 
i
 = 1;

133 
	`decode_unsigd16
(&
da
->
pdu
[
du_offt
 + 
i
], &
t
);

134 
	`add_dt
(&
t
->
rou_fo
, 
t
, 
da
->
c
);

135 i(
da
->
pdu
[
du_offt
 + 
i
 + 3] > 0)

136 
i
 = 
da
->
pdu
[
du_offt
 + i + 3] + 4;

138 
i
 = i + 4;

140 
buff_n
 =

141 
	`_twk_mesge
(
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
,

142 
da
, 
buff
, 
NULL
);

144 
buff_n
 =

145 
	`_twk_mesge
(
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
,

146 
da
, 
buff
, &buff);

149 
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
:

150 
	`PRINT
(
INFO
, "Recieved Initialize-Routing-Table-Ack message\n");

151 i(
da
->
pdu
[
du_offt
] > 0) {

152 
t_cou
 = 
da
->
pdu
[
du_offt
];

153 
t_cou
--) {

154 
i
 = 1;

155 
	`decode_unsigd16
(&
da
->
pdu
[
du_offt
 + 
i
], &
t
);

156 
	`add_dt
(&
t
->
rou_fo
, 
t
, 
da
->
c
);

157 i(
da
->
pdu
[
du_offt
 + 
i
 + 3] > 0)

158 
i
 = 
da
->
pdu
[
du_offt
 + i + 3] + 4;

160 
i
 = i + 4;

165 
NETWORK_MESSAGE_INVALID
:

166 
NETWORK_MESSAGE_I_COULD_BE_ROUTER_TO_NETWORK
:

167 
NETWORK_MESSAGE_ROUTER_BUSY_TO_NETWORK
:

168 
NETWORK_MESSAGE_ROUTER_AVAILABLE_TO_NETWORK
:

169 
NETWORK_MESSAGE_ESTABLISH_CONNECTION_TO_NETWORK
:

170 
NETWORK_MESSAGE_DISCONNECT_CONNECTION_TO_NETWORK
:

175 
	`PRINT
(
ERROR
, "Error: Message unsupported\n");

179  
buff_n
;

180 
	}
}

182 
ut16_t
 
	$_twk_mesge
(

183 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

184 
MSG_DATA
 * 
da
,

185 
ut8_t
 ** 
buff
,

186 *
v
)

189 
t16_t
 
buff_n
;

190 
bo
 
da_exg_y
 = 
l
;

191 
BACNET_NPDU_DATA
 
du_da
;

193 i(
twk_mesge_ty
 =
NETWORK_MESSAGE_INIT_RT_TABLE
)

194 
da_exg_y
 = 
ue
;

195 
	`_du
(&
du_da
, 
twk_mesge_ty
, 
da_exg_y
);

197 *
buff
 = (
ut8_t
 *
	`mloc
(128);

200 
da
->
de
.
t
 = 
BACNET_BROADCAST_NETWORK
;

201 
buff_n
 = 
	`du_code_pdu
(*
buff
, &
da
->
de
, 
NULL
, &
du_da
);

203 
twk_mesge_ty
) {

205 
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
:

206 i(
v
 !
NULL
) {

207 
ut8_t
 *
vr
 = (ut8_*
v
;

208 
ut16_t
 
v16
 = (
vr
[0]) + (valptr[1] << 8);

209 
buff_n
 +
	`code_unsigd16
(*
buff
 + buff_n, 
v16
);

213 
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
:

214 i(
v
 !
NULL
) {

215 
ut8_t
 *
vr
 = (ut8_*
v
;

216 
ut16_t
 
v16
 = (
vr
[0]) + (valptr[1] << 8);

217 
buff_n
 +
	`code_unsigd16
(*
buff
 + buff_n, 
v16
);

219 
ROUTER_PORT
 *
pt
 = 
hd
;

220 
DNET
 *
dt
;

221 
pt
 !
NULL
) {

222 i(
pt
->
rou_fo
.
t
 !
da
->
c
.net) {

223 
buff_n
 +=

224 
	`code_unsigd16
(*
buff
 + 
buff_n
,

225 
pt
->
rou_fo
.
t
);

226 
dt
 = 
pt
->
rou_fo
.
dts
;

227 
dt
 !
NULL
) {

228 
buff_n
 +=

229 
	`code_unsigd16
(*
buff
 + 
buff_n
, 
dt
->
t
);

230 
dt
 = dt->
xt
;

232 
pt
 =t->
xt
;

234 
dt
 = 
pt
->
rou_fo
.
dts
;

235 
dt
 !
NULL
) {

236 
buff_n
 +=

237 
	`code_unsigd16
(*
buff
 + 
buff_n
, 
dt
->
t
);

238 
dt
 = dt->
xt
;

240 
pt
 =t->
xt
;

246 
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
:

248 
ut8_t
 *
vr
 = (ut8_*
v
;

249 
ut16_t
 
v16
 = (
vr
[0]) + (valptr[1] << 8);

250 
buff_n
 +
	`code_unsigd16
(*
buff
 + buff_n, 
v16
);

253 
NETWORK_MESSAGE_INIT_RT_TABLE
:

254 
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
:

255 i((
ut8_t
 *
v
) {

256 (*
buff
)[
buff_n
++] = (
ut8_t

pt_cou
;

258 i(
pt_cou
 > 0) {

259 
ROUTER_PORT
 *
pt
 = 
hd
;

260 
ut8_t
 
ptID
 = 1;

262 
pt
 !
NULL
) {

263 
buff_n
 +=

264 
	`code_unsigd16
(*
buff
 + 
buff_n
,

265 
pt
->
rou_fo
.
t
);

266 (*
buff
)[
buff_n
++] = 
ptID
++;

267 (*
buff
)[
buff_n
++] = 0;

268 
pt
 =t->
xt
;

272 (*
buff
)[
buff_n
++] = (
ut8_t
) 0;

275 
NETWORK_MESSAGE_INVALID
:

276 
NETWORK_MESSAGE_I_COULD_BE_ROUTER_TO_NETWORK
:

277 
NETWORK_MESSAGE_ROUTER_BUSY_TO_NETWORK
:

278 
NETWORK_MESSAGE_ROUTER_AVAILABLE_TO_NETWORK
:

279 
NETWORK_MESSAGE_ESTABLISH_CONNECTION_TO_NETWORK
:

280 
NETWORK_MESSAGE_DISCONNECT_CONNECTION_TO_NETWORK
:

286  
buff_n
;

287 
	}
}

289 
	$nd_twk_mesge
(

290 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

291 
MSG_DATA
 * 
da
,

292 
ut8_t
 ** 
buff
,

293 *
v
)

296 
BACMSG
 
msg
;

297 
ROUTER_PORT
 *
pt
 = 
hd
;

298 
t16_t
 
buff_n
;

300 i(!
da
) {

301 
da
 = (
MSG_DATA
 *
	`mloc
((MSG_DATA));

302 
da
->
de
.
t
 = 
BACNET_BROADCAST_NETWORK
;

303 
da
->
de
.
n
 = 0;

306 
buff_n
 = 
	`_twk_mesge
(
twk_mesge_ty
, 
da
, 
buff
, 
v
);

309 
da
->
pdu
 = *
buff
;

310 
da
->
pdu_n
 = 
buff_n
;

311 
msg
.
ig
 = 
hd
->
ma_id
;

312 
msg
.
ty
 = 
DATA
;

313 
msg
.
da
 = data;

315 
da
->
f_cou
 = 
pt_cou
;

316 
pt
 !
NULL
) {

317 i(
pt
->
e
 =
FINISHED
) {

318 
pt
 =t->
xt
;

321 
	`nd_to_msgbox
(
pt
->
pt_id
, &
msg
);

322 
pt
 =t->
xt
;

324 
	}
}

326 
	$_du
(

327 
BACNET_NPDU_DATA
 * 
du_da
,

328 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

329 
bo
 
da_exg_y
)

332 i(
du_da
) {

333 
du_da
->
da_exg_y
 = data_expecting_reply;

334 
du_da
->
oc_vsi
 = 
BACNET_PROTOCOL_VERSION
;

335 
du_da
->
twk_y_mesge
 = 
ue
;

336 
du_da
->
twk_mesge_ty
 =etwork_message_type;

337 
du_da
->
vd_id
 = 0;

338 
du_da
->
iܙy
 = 
MESSAGE_PRIORITY_NORMAL
;

339 
du_da
->
h_cou
 = 
HOP_COUNT_DEFAULT
;

341 
	}
}

	@demo/router/network_layer.h

29 #ide
NETWORK_LAYER_H


30 
	#NETWORK_LAYER_H


	)

32 
	~<ddef.h
>

33 
	~<dt.h
>

34 
	~<dbo.h
>

35 
	~<dio.h
>

36 
	~<dlib.h
>

37 
	~"banum.h
"

38 
	~"bacdef.h
"

39 
	~"du.h
"

40 
	~"t.h
"

41 
	~"p܉had.h
"

43 
ut16_t
 
oss_twk_mesge
(

44 
BACMSG
 * 
msg
,

45 
MSG_DATA
 * 
da
,

46 
ut8_t
 ** 
buff
);

48 
ut16_t
 
_twk_mesge
(

49 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

50 
MSG_DATA
 * 
da
,

51 
ut8_t
 ** 
buff
,

52 *
v
);

54 
nd_twk_mesge
(

55 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

56 
MSG_DATA
 * 
da
,

57 
ut8_t
 ** 
buff
,

58 *
v
);

60 
_du
(

61 
BACNET_NPDU_DATA
 * 
du_da
,

62 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

63 
bo
 
da_exg_y
);

	@demo/router/portthread.c

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<rg.h
>

32 
	~"p܉had.h
"

34 
ROUTER_PORT
 *
	$fd_
(

35 
MSGBOX_ID
 
id
)

38 
ROUTER_PORT
 *
pt
 = 
hd
;

40 
pt
 !
NULL
) {

41 i(
pt
->
pt_id
 =
id
)

42  
pt
;

43 
pt
 =t->
xt
;

46  
NULL
;

47 
	}
}

49 
ROUTER_PORT
 *
	$fd_dt
(

50 
ut16_t
 
t
,

51 
BACNET_ADDRESS
 * 
addr
)

54 
ROUTER_PORT
 *
pt
 = 
hd
;

55 
DNET
 *
dt
;

58 i(
t
 =
BACNET_BROADCAST_NETWORK
)

59  
pt
;

61 
pt
 !
NULL
) {

64 i(
t
 =
pt
->
rou_fo
.net)

65  
pt
;

68 i(
pt
->
rou_fo
.
dts
) {

69 
dt
 = 
pt
->
rou_fo
.
dts
;

70 
dt
 !
NULL
) {

71 i(
t
 =
dt
->net) {

72 i(
addr
) {

73 
	`memmove
(&
addr
->
n
, &
dt
->
mac_n
, 1);

74 
	`memmove
(&
addr
->
adr
[0], &
dt
->
mac
[0], 
MAX_MAC_LEN
);

76  
pt
;

78 
dt
 = dt->
xt
;

81 
pt
 =t->
xt
;

84  
NULL
;

85 
	}
}

87 
	$add_dt
(

88 
RT_ENTRY
 * 
rou_fo
,

89 
ut16_t
 
t
,

90 
BACNET_ADDRESS
 
addr
)

93 
DNET
 *
dt
 = 
rou_fo
->
dts
;

94 
DNET
 *
tmp
;

96 i(
dt
 =
NULL
) {

97 
rou_fo
->
dts
 = (
DNET
 *
	`mloc
((DNET));

98 
	`memmove
(&
rou_fo
->
dts
->
mac_n
, &
addr
.
n
, 1);

99 
	`memmove
(&
rou_fo
->
dts
->
mac
[0], &
addr
.
adr
[0], 
MAX_MAC_LEN
);

100 
rou_fo
->
dts
->
t
 =et;

101 
rou_fo
->
dts
->
e
 = 
ue
;

102 
rou_fo
->
dts
->
xt
 = 
NULL
;

105 
dt
 !
NULL
) {

106 i(
dt
->
t
 ==et)

108 
tmp
 = 
dt
;

109 
dt
 = dt->
xt
;

112 
dt
 = (
DNET
 *
	`mloc
((DNET));

113 
	`memmove
(&
dt
->
mac_n
, &
addr
.
n
, 1);

114 
	`memmove
(&
dt
->
mac
[0], &
addr
.
adr
[0], 
MAX_MAC_LEN
);

115 
dt
->
t
 =et;

116 
dt
->
e
 = 
ue
;

117 
dt
->
xt
 = 
NULL
;

118 
tmp
->
xt
 = 
dt
;

120 
	}
}

122 
	$nup_dts
(

123 
DNET
 * 
dts
)

126 
DNET
 *
dt
 = 
dts
;

127 
dt
 !
NULL
) {

128 
dt
 = dt->
xt
;

129 
	`
(
dts
);

130 
dts
 = 
dt
;

132 
	}
}

	@demo/router/portthread.h

29 #ide
PORTTHREAD_H


30 
	#PORTTHREAD_H


	)

32 
	~<dt.h
>

33 
	~<dbo.h
>

34 
	~<had.h
>

35 
	~"msgqueue.h
"

36 
	~"bacdef.h
"

37 
	~"du.h
"

39 
	#ERROR
 1

	)

40 
	#INFO
 2

	)

41 
	#DEBUG
 3

	)

43 
	#DEBUG_LEVEL
 3

	)

44 #ifde
DEBUG_LEVEL


45 
	#PRINT
(
debug_v
, ...if(debug_v <
DEBUG_LEVEL

	`rtf
(
dr
, 
__VA_ARGS__
)

	)

47 
	#PRINT
(...)

	)

51 
	mBIP
 = 1,

52 
	mMSTP
 = 2

53 } 
	tDL_TYPE
;

56 
	mINIT
,

57 
	mINIT_FAILED
,

58 
	mRUNNING
,

59 
	mFINISHED


60 } 
	tPORT_STATE
;

64 *
	tPORT_FUNC
) (

68 
	mPARITY_NONE
,

69 
	mPARITY_EVEN
,

70 
	mPARITY_ODD


71 } 
	tPARITY
;

74 
	u_pt_ms
 {

76 
ut16_t
 
	mpt
;

77 } 
	mb_ms
;

79 
ut32_t
 
	mbaud
;

80 
PARITY
 
	mry
;

81 
ut8_t
 
	mdabs
;

82 
ut8_t
 
	mbs
;

83 
ut8_t
 
	mmax_ma
;

84 
ut8_t
 
	mmax_ames
;

85 } 
	mmp_ms
;

86 } 
	tPORT_PARAMS
;

89 
	s_dt
 {

90 
ut8_t
 
	mmac
[
MAX_MAC_LEN
];

91 
ut8_t
 
	mmac_n
;

92 
ut16_t
 
	mt
;

93 
bo
 
	me
;

94 
_dt
 *
	mxt
;

95 } 
	tDNET
;

98 
	s_routg_b_y
 {

99 
ut8_t
 
	mmac
[
MAX_MAC_LEN
];

100 
ut8_t
 
	mmac_n
;

101 
ut16_t
 
	mt
;

102 
DNET
 *
	mdts
;

103 } 
	tRT_ENTRY
;

105 
	s_pt
 {

106 
DL_TYPE
 
	mty
;

107 
PORT_STATE
 
	me
;

108 
MSGBOX_ID
 
	mma_id
;

109 
MSGBOX_ID
 
	mpt_id
;

110 *
	mi
;

111 
PORT_FUNC
 
	mfunc
;

112 
RT_ENTRY
 
	mrou_fo
;

113 
PORT_PARAMS
 
	mms
;

114 
_pt
 *
	mxt
;

115 } 
	tROUTER_PORT
;

117 
ROUTER_PORT
 *
hd
;

118 
pt_cou
;

121 
ROUTER_PORT
 *
fd_
(

122 
MSGBOX_ID
 
id
);

125 
ROUTER_PORT
 *
fd_dt
(

126 
ut16_t
 
t
,

127 
BACNET_ADDRESS
 * 
addr
);

130 
add_dt
(

131 
RT_ENTRY
 * 
rou_fo
,

132 
ut16_t
 
t
,

133 
BACNET_ADDRESS
 
addr
);

135 
nup_dts
(

136 
DNET
 * 
dts
);

	@demo/scov/main.c

26 
	~<ddef.h
>

27 
	~<dt.h
>

28 
	~<dio.h
>

29 
	~<dlib.h
>

30 
	~<o.h
>

31 
	~<time.h
>

32 
	~<y.h
>

34 
	#PRINT_ENABLED
 1

	)

36 
	~"bacdef.h
"

37 
	~"cfig.h
"

38 
	~"baext.h
"

39 
	~"ba.h
"

40 
	~"m.h
"

41 
	~"f.h
"

42 
	~"tsm.h
"

43 
	~"addss.h
"

44 
	~"du.h
"

45 
	~"du.h
"

46 
	~"devi.h
"

47 
	~"t.h
"

48 
	~"dk.h
"

49 
	~"whois.h
"

51 
	~"fame.h
"

52 
	~"hdrs.h
"

53 
	~".h
"

54 
	~"txbuf.h
"

55 
	~"dnv.h
"

58 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

61 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

63 
ut32_t
 
	gTg_Devi_Pross_Idtifr
 = 0;

65 
ut8_t
 
	gReque_Invoke_ID
 = 0;

67 
BACNET_ADDRESS
 
	gTg_Addss
;

69 
bo
 
	gE_Deed
 = 
l
;

71 
BACNET_SUBSCRIBE_COV_DATA
 *
	gCOV_Subsibe_Da
 = 
NULL
;

73 
bo
 
	gSime_Ack_Deed
 = 
l
;

74 
bo
 
	gCl_Requeed
 = 
l
;

76 
	$MyEHdr
(

77 
BACNET_ADDRESS
 * 
c
,

78 
ut8_t
 
voke_id
,

79 
BACNET_ERROR_CLASS
 
r_ass
,

80 
BACNET_ERROR_CODE
 
r_code
)

82 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

83 (
voke_id
 =
Reque_Invoke_ID
)) {

84 
	`tf
("BACnet Error: %s: %s\r\n",

85 
	`baext_r_ass_me
((
r_ass
),

86 
	`baext_r_code_me
((
r_code
));

87 
E_Deed
 = 
ue
;

89 
	}
}

91 
	$MyAbtHdr
(

92 
BACNET_ADDRESS
 * 
c
,

93 
ut8_t
 
voke_id
,

94 
ut8_t
 
abt_as
,

95 
bo
 
rv
)

97 (
rv
;

98 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

99 (
voke_id
 =
Reque_Invoke_ID
)) {

100 
	`tf
("BACnet Abort: %s\r\n",

101 
	`baext_abt_as_me
((
abt_as
));

102 
E_Deed
 = 
ue
;

104 
	}
}

106 
	$MyRejeHdr
(

107 
BACNET_ADDRESS
 * 
c
,

108 
ut8_t
 
voke_id
,

109 
ut8_t
 
je_as
)

111 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

112 (
voke_id
 =
Reque_Invoke_ID
)) {

113 
	`tf
("BACnet Reject: %s\r\n",

114 
	`baext_je_as_me
((
je_as
));

115 
E_Deed
 = 
ue
;

117 
	}
}

119 
	$My_Uncfmed_COV_Nifiti_Hdr
(

120 
ut8_t
 * 
rvi_que
,

121 
ut16_t
 
rvi_n
,

122 
BACNET_ADDRESS
 * 
c
)

124 
	`hdr_ucov_nifiti
(
rvi_que
, 
rvi_n
, 
c
);

125 
	}
}

127 
	$My_Cfmed_COV_Nifiti_Hdr
(

128 
ut8_t
 * 
rvi_que
,

129 
ut16_t
 
rvi_n
,

130 
BACNET_ADDRESS
 * 
c
,

131 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

133 
	`hdr_ccov_nifiti
(
rvi_que
, 
rvi_n
, 
c
, 
rvi_da
);

134 
	}
}

136 
	$MyWrePrݔtySimeAckHdr
(

137 
BACNET_ADDRESS
 * 
c
,

138 
ut8_t
 
voke_id
)

140 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

141 (
voke_id
 =
Reque_Invoke_ID
)) {

142 
	`tf
("SubscribeCOV Acknowledged!\r\n");

143 
Sime_Ack_Deed
 = 
ue
;

145 
	}
}

147 
	$In_Svi_Hdrs
(

150 
	`Devi_In
(
NULL
);

153 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

155 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

158 
du_t_uecognized_rvi_hdr_hdr


159 (
hdr_uecognized_rvi
);

161 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

162 
hdr_ad_ݔty
);

164 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_COV_NOTIFICATION
,

165 
My_Cfmed_COV_Nifiti_Hdr
);

166 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_COV_NOTIFICATION
,

167 
My_Uncfmed_COV_Nifiti_Hdr
);

169 
	`du_t_cfmed_sime_ack_hdr
(
SERVICE_CONFIRMED_SUBSCRIBE_COV
,

170 
MyWrePrݔtySimeAckHdr
);

172 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_SUBSCRIBE_COV
, 
MyEHdr
);

173 
	`du_t_abt_hdr
(
MyAbtHdr
);

174 
	`du_t_je_hdr
(
MyRejeHdr
);

175 
	}
}

177 
	$nup
(

180 
BACNET_SUBSCRIBE_COV_DATA
 *
cov_da
 = 
NULL
;

181 
BACNET_SUBSCRIBE_COV_DATA
 *
cov_da_d
 = 
NULL
;

183 
cov_da
 = 
COV_Subsibe_Da
;

184 
cov_da
) {

185 
cov_da_d
 = 
cov_da
;

186 
cov_da
 = cov_da->
xt
;

187 
	`
(
cov_da_d
);

189 
	}
}

191 
	$ma
(

192 
gc
,

193 *
gv
[])

195 
BACNET_ADDRESS
 
c
 = {

198 
ut16_t
 
pdu_n
 = 0;

199 
timeout
 = 100;

200 
max_du
 = 0;

201 
time_t
 
d_cds
 = 0;

202 
time_t
 
ϡ_cds
 = 0;

203 
time_t
 
cut_cds
 = 0;

204 
time_t
 
timeout_cds
 = 0;

205 
time_t
 
d_cds
 = 0;

206 
bo
 
found
 = 
l
;

207 *
fame
 = 
NULL
;

208 
bo
 
t_uge_r
 = 
l
;

209 
bo
 
t_uge_vbo
 = 
l
;

210 
BACNET_SUBSCRIBE_COV_DATA
 *
cov_da
 = 
NULL
;

211 
gi
 = 0;

212 
g_mag
 = 0;

214 i(
gc
 < 6) {

215 
t_uge_r
 = 
ue
;

217 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

218 
t_uge_r
 = 
ue
;

219 
t_uge_vbo
 = 
ue
;

221 i(
t_uge_r
) {

222 
fame
 = 
	`fame_move_th
(
gv
[0]);

223 
	`tf
("Usage: %s device-id object-type object-instance "

224 "oss-id <[un]cfmeditime|nl>\r\n", 
fame
);

225 i(!
t_uge_vbo
) {

229 i(
t_uge_vbo
) {

230 
	`tf
("\r\n" "device-id:\r\n"

258 
fame
, filename, filename);

262 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

263 i(
Tg_Devi_Obje_In
 >
BACNET_MAX_INSTANCE
) {

264 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

265 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

268 
	`ex
(
nup
);

269 
COV_Subsibe_Da
 = 
	`oc
(1, (
BACNET_SUBSCRIBE_COV_DATA
));

270 
cov_da
 = 
COV_Subsibe_Da
;

271 
gi
 = 2;

272 
cov_da
) {

273 
cov_da
->
mڙedObjeIdtifr
.
ty
 = 
	`
(
gv
[
gi
], 
NULL
, 0);

274 i(
cov_da
->
mڙedObjeIdtifr
.
ty
 >
MAX_BACNET_OBJECT_TYPE
) {

275 
	`rtf
(
dr
, "object-type=%u - it must beesshan %u\r\n",

276 
cov_da
->
mڙedObjeIdtifr
.
ty
,

277 
MAX_BACNET_OBJECT_TYPE
);

280 
gi
++;

281 
cov_da
->
mڙedObjeIdtifr
.

 =

282 
	`
(
gv
[
gi
], 
NULL
, 0);

283 i(
cov_da
->
mڙedObjeIdtifr
.

 > 
BACNET_MAX_INSTANCE
) {

284 
	`rtf
(
dr
, "object-instance=%u - it must beesshan %u\r\n",

285 
cov_da
->
mڙedObjeIdtifr
.

,

286 
BACNET_MAX_INSTANCE
 + 1);

289 
gi
++;

290 
cov_da
->
subsibProssIdtifr
 = 
	`
(
gv
[
gi
], 
NULL
, 0);

291 
gi
++;

292 i(
	`rcmp
(
gv
[
gi
], "cancel") == 0) {

293 
cov_da
->
nΩiReque
 = 
ue
;

294 
gi
++;

296 
cov_da
->
nΩiReque
 = 
l
;

297 i(
	`rcmp
(
gv
[
gi
], "confirmed") == 0) {

298 
cov_da
->
issueCfmedNifitis
 = 
ue
;

299 } i(
	`rcmp
(
gv
[
gi
], "unconfirmed") == 0) {

300 
cov_da
->
issueCfmedNifitis
 = 
l
;

302 
	`rtf
(
dr
, "unknowti: %s\r\n", 
gv
[
gi
]);

305 
gi
++;

306 
g_mag
 = 
gc
 - 
gi
;

307 i(
g_mag
 > 0) {

308 
cov_da
->
litime
 = 
	`
(
gv
[
gi
], 
NULL
, 0);

309 
gi
++;

311 
cov_da
->
litime
 = 0;

314 
g_mag
 = 
gc
 - 
gi
;

315 i(
g_mag
 < 5) {

318 
cov_da
->
xt
 = 
	`oc
(1, (
BACNET_SUBSCRIBE_COV_DATA
));

319 
cov_da
 = cov_da->
xt
;

323 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

324 
	`addss_
();

325 
	`In_Svi_Hdrs
();

326 
	`dnv_
();

327 
	`ex
(
dk_nup
);

329 
ϡ_cds
 = 
	`time
(
NULL
);

330 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

332 
found
 =

333 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

334 &
Tg_Addss
);

335 i(!
found
) {

336 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

337 
Tg_Devi_Obje_In
);

340 
cov_da
 = 
COV_Subsibe_Da
;

344 
cut_cds
 = 
	`time
(
NULL
);

346 i(
cut_cds
 !
ϡ_cds
) {

348 
d_cds
 = 
cut_cds
 - 
ϡ_cds
;

349 
d_cds
 +
d_cds
;

350 
	`tsm_tim_mlicds
((
d_cds
 * 1000));

352 
ϡ_cds
 = 
cut_cds
;

354 i(
E_Deed
) {

358 i(!
found
) {

359 
found
 =

360 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

361 &
Tg_Addss
);

363 i(
found
) {

364 i(
Reque_Invoke_ID
 == 0) {

365 
Sime_Ack_Deed
 = 
l
;

366 i(
cov_da
->
nΩiReque
) {

367 
Cl_Requeed
 = 
ue
;

369 
Cl_Requeed
 = 
l
;

371 
Tg_Devi_Pross_Idtifr
 =

372 
cov_da
->
subsibProssIdtifr
;

373 
Reque_Invoke_ID
 =

374 
	`Sd_COV_Subsibe
(
Tg_Devi_Obje_In
,

375 
cov_da
);

376 i(!
cov_da
->
nΩiReque
 &&

377 (
timeout_cds
 < 
cov_da
->
litime
)) {

379 
timeout_cds
 = 
cov_da
->
litime
;

381 
	`tf
("Sent SubscribeCOVequest. "

383 ((
timeout_cds
 - 
d_cds
));

384 } i(
	`tsm_voke_id_
(
Reque_Invoke_ID
)) {

385 i(
cov_da
->
xt
) {

386 
cov_da
 = cov_da->
xt
;

387 
Reque_Invoke_ID
 = 0;

389 i(
Cl_Requeed
 && 
Sime_Ack_Deed
) {

393 } i(
	`tsm_voke_id_ed
(
Reque_Invoke_ID
)) {

394 
	`rtf
(
dr
, "\rError: TSM Timeout!\r\n");

395 
	`tsm__voke_id
(
Reque_Invoke_ID
);

396 
E_Deed
 = 
ue
;

401 i(
d_cds
 > 
timeout_cds
) {

402 
E_Deed
 = 
ue
;

403 
	`tf
("\rError: APDU Timeout!\r\n");

408 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

410 i(
pdu_n
) {

411 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

413 i(
E_Deed
) {

417 i(
d_cds
 > 
timeout_cds
) {

421 i(
E_Deed
)

424 
	}
}

	@demo/server/main.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<dlib.h
>

29 
	~<sigl.h
>

30 
	~<time.h
>

32 
	~"cfig.h
"

33 
	~"rv.h
"

34 
	~"addss.h
"

35 
	~"bacdef.h
"

36 
	~"hdrs.h
"

37 
	~".h
"

38 
	~"dnv.h
"

39 
	~"bacdcode.h
"

40 
	~"du.h
"

41 
	~"du.h
"

42 
	~"m.h
"

43 
	~"tsm.h
"

44 
	~"devi.h
"

45 
	~"bacfe.h
"

46 
	~"dk.h
"

47 
	~"dcc.h
"

48 
	~"gevt.h
"

49 
	~"t.h
"

50 
	~"txbuf.h
"

51 
	~"lc.h
"

52 
	~"vsi.h
"

54 
	~"devi.h
"

55 
	~"dlog.h
"

56 #i
defed
(
INTRINSIC_REPORTING
)

57 
	~"nc.h
"

59 #i
defed
(
BACFILE
)

60 
	~"bacfe.h
"

72 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

77 
	$In_Svi_Hdrs
(

80 
	`Devi_In
(
NULL
);

82 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

83 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_HAS
, 
hdr_who_has
);

85 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

88 
du_t_uecognized_rvi_hdr_hdr


89 (
hdr_uecognized_rvi
);

92 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

93 
hdr_ad_ݔty
);

94 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

95 
hdr_ad_ݔty_muɝ
);

96 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

97 
hdr_wre_ݔty
);

98 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROP_MULTIPLE
,

99 
hdr_wre_ݔty_muɝ
);

100 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_RANGE
,

101 
hdr_ad_nge
);

102 #i
	`defed
(
BACFILE
)

103 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_ATOMIC_READ_FILE
,

104 
hdr_omic_ad_fe
);

105 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
,

106 
hdr_omic_wre_fe
);

108 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

109 
hdr_lize_devi
);

110 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_UTC_TIME_SYNCHRONIZATION
,

111 
hdr_timesync_utc
);

112 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_TIME_SYNCHRONIZATION
,

113 
hdr_timesync
);

114 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_SUBSCRIBE_COV
,

115 
hdr_cov_subsibe
);

116 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_COV_NOTIFICATION
,

117 
hdr_ucov_nifiti
);

119 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

120 
hdr_devi_communiti_cڌ
);

122 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_PRIVATE_TRANSFER
,

123 
hdr_uncfmed_ive_sr
);

124 #i
	`defed
(
INTRINSIC_REPORTING
)

125 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
,

126 
hdr_m_ack
);

127 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_GET_EVENT_INFORMATION
,

128 
hdr_g_evt_fmi
);

129 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_GET_ALARM_SUMMARY
,

130 
hdr_g_m_summy
);

132 
	}
}

146 
	$ma
(

147 
gc
,

148 *
gv
[])

150 
BACNET_ADDRESS
 
c
 = {

153 
ut16_t
 
pdu_n
 = 0;

154 
timeout
 = 1;

155 
time_t
 
ϡ_cds
 = 0;

156 
time_t
 
cut_cds
 = 0;

157 
ut32_t
 
d_cds
 = 0;

158 
ut32_t
 
d_mlicds
 = 0;

159 
ut32_t
 
addss_bdg_tmr
 = 0;

160 
ut32_t
 
c_sn_tmr
 = 0;

163 i(
gc
 > 1)

164 
	`Devi_S_Obje_In_Numb
(
	`
(
gv
[1], 
NULL
, 0));

165 
	`tf
("BACnet Server Demo\n" "BACnet Stack Version %s\n"

166 "BACÈDevi ID: %u\n" "Max APDU: %d\n", 
BACt_Vsi
,

167 
	`Devi_Obje_In_Numb
(), 
MAX_APDU
);

170 
	`addss_
();

171 
	`In_Svi_Hdrs
();

172 
	`dnv_
();

173 
	`ex
(
dk_nup
);

175 
ϡ_cds
 = 
	`time
(
NULL
);

177 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

181 
cut_cds
 = 
	`time
(
NULL
);

184 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

187 i(
pdu_n
) {

188 
	`tf
("\nA vaildacketeceived\n");

189 
	`tf
("\ckgth i%d\n",
pdu_n
);

190 
	`tf
("\d i%s\n",
Rx_Buf
);

191 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

194 
d_cds
 = (
ut32_t
(
cut_cds
 - 
ϡ_cds
);

195 i(
d_cds
) {

196 
ϡ_cds
 = 
cut_cds
;

197 
	`dcc_tim_cds
(
d_cds
);

198 #i
	`defed
(
BACDL_BIP
&& 
BBMD_ENABLED


199 
	`bvlc_man_tim
(
d_cds
);

201 
	`dnv_man_tim
(
d_cds
);

202 
	`Ld_Cڌ_S_Mache_Hdr
();

203 
d_mlicds
 = 
d_cds
 * 1000;

204 
	`hdr_cov_tim_cds
(
d_cds
);

205 
	`tsm_tim_mlicds
(
d_mlicds
);

206 
	`d_log_tim
(
d_cds
);

207 #i
	`defed
(
INTRINSIC_REPORTING
)

208 
	`Devi_lol_ptg
();

211 
	`hdr_cov_sk
();

213 
addss_bdg_tmr
 +
d_cds
;

214 i(
addss_bdg_tmr
 >= 60) {

215 
	`addss_che_tim
(
addss_bdg_tmr
);

216 
addss_bdg_tmr
 = 0;

218 #i
	`defed
(
INTRINSIC_REPORTING
)

220 
c_sn_tmr
 +
d_cds
;

221 i(
c_sn_tmr
 >
NC_RESCAN_RECIPIENTS_SECS
) {

222 
	`Nifiti_Css_fd_c
();

223 
c_sn_tmr
 = 0;

232 
	}
}

	@demo/server/server.h

26 #ide
SERVER_H_


27 
	#SERVER_H_


	)

	@demo/timesync/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<y.h
>

32 
	~<time.h
>

33 
	~<o.h
>

34 
	~"baext.h
"

35 
	~"cfig.h
"

36 
	~"bacdef.h
"

37 
	~"du.h
"

38 
	~"du.h
"

39 
	~"devi.h
"

40 
	~"t.h
"

41 
	~"dk.h
"

42 
	~"timesync.h
"

43 
	~"vsi.h
"

45 
	~"fame.h
"

46 
	~"hdrs.h
"

47 
	~".h
"

48 
	~"txbuf.h
"

49 
	~"dnv.h
"

52 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

54 
bo
 
	gE_Deed
 = 
l
;

56 
	$MyAbtHdr
(

57 
BACNET_ADDRESS
 * 
c
,

58 
ut8_t
 
voke_id
,

59 
ut8_t
 
abt_as
,

60 
bo
 
rv
)

63 (
c
;

64 (
voke_id
;

65 (
rv
;

66 
	`tf
("BACÈAbt: %s\n", 
	`baext_abt_as_me
(
abt_as
));

67 
E_Deed
 = 
ue
;

68 
	}
}

70 
	$MyRejeHdr
(

71 
BACNET_ADDRESS
 * 
c
,

72 
ut8_t
 
voke_id
,

73 
ut8_t
 
je_as
)

76 (
c
;

77 (
voke_id
;

78 
	`tf
("BACÈReje: %s\n", 
	`baext_je_as_me
(
je_as
));

79 
E_Deed
 = 
ue
;

80 
	}
}

82 
	$In_Svi_Hdrs
(

85 
	`Devi_In
(
NULL
);

88 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

91 
du_t_uecognized_rvi_hdr_hdr


92 (
hdr_uecognized_rvi
);

94 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

95 
hdr_ad_ݔty
);

97 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_UTC_TIME_SYNCHRONIZATION
,

98 
hdr_timesync_utc
);

99 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_TIME_SYNCHRONIZATION
,

100 
hdr_timesync
);

102 
	`du_t_abt_hdr
(
MyAbtHdr
);

103 
	`du_t_je_hdr
(
MyRejeHdr
);

104 
	}
}

112 
	$addss_om_ascii
(

113 
ut8_t
 *
mac
,

114 *
g
)

116 
a
[6] = {0}, 
p
 = 0;

117 
ut16_t
 
pt
 = 0;

118 
c
, 
n
 = 0;

120 
c
 = 
	`ssnf
(
g
, "%3u.%3u.%3u.%3u:%5u", &
a
[0],&a[1],&a[2],&a[3],&
p
);

121 i((
c
 == 4) || (c == 5)) {

122 
mac
[0] = 
a
[0];

123 
mac
[1] = 
a
[1];

124 
mac
[2] = 
a
[2];

125 
mac
[3] = 
a
[3];

126 i(
c
 == 4) {

127 
pt
 = 
	`hts
((
ut16_t
) 0xBAC0);

129 
pt
 = 
	`hts
((
ut16_t

p
);

131 
	`memy
(&
mac
[4], &
pt
, 2);

132 
n
 = 6;

134 
c
 = 
	`ssnf
(
g
, "%2x:%2x:%2x:%2x:%2x:%2x",

135 &
a
[0],&a[1],&a[2],&a[3],&a[4],&a[5]);

136 i(
c
 == 6) {

137 
mac
[0] = 
a
[0];

138 
mac
[1] = 
a
[1];

139 
mac
[2] = 
a
[2];

140 
mac
[3] = 
a
[3];

141 
mac
[4] = 
a
[4];

142 
mac
[5] = 
a
[5];

143 
n
 = 6;

144 } i(
c
 == 1) {

145 
a
[0] = ()
	`
(
g
, 
NULL
, 0);

146 i(
a
[0] <= 255) {

147 
mac
[0] = 
a
[0];

148 
n
 = 1;

153  
n
;

154 
	}
}

156 
	$t_uge
(*
fame
)

158 
	`tf
("Uge: %[--dt][--dadr][--mac][--vsi][--hp]\n", 
fame
);

159 
	}
}

161 
	$t_hp
(*
fame
)

163 
	`tf
("Send BACnet TimeSynchronizationequest.\n"

184 
fame
,

185 
fame
,

186 
fame
);

195 
fame
);

197 
	}
}

199 
	$ma
(

200 
gc
,

201 *
gv
[])

203 
BACNET_ADDRESS
 
c
 = {

206 
ut16_t
 
pdu_n
 = 0;

207 
timeout
 = 100;

208 
time_t
 
d_cds
 = 0;

209 
time_t
 
ϡ_cds
 = 0;

210 
time_t
 
cut_cds
 = 0;

211 
time_t
 
timeout_cds
 = 0;

212 
time_t
 
wtime
;

213 
tm
 *
my_time
;

214 
BACNET_DATE
 
bde
;

215 
BACNET_TIME
 
btime
;

216 
BACNET_ADDRESS
 
de
;

217 
dt
 = -1;

218 
ut8_t
 
mac
[
MAX_MAC_LEN
];

219 
ut8_t
 
adr
[
MAX_MAC_LEN
];

220 
gi
 = 0;

221 
n
 = 0, 
mac_n
 = 0;

222 
bo
 
glob_brd
 = 
ue
;

225 
gi
 = 1;rg< 
gc
;rgi++) {

226 i(
	`rcmp
(
gv
[
gi
], "--help") == 0) {

227 
	`t_uge
(
	`fame_move_th
(
gv
[0]));

228 
	`t_hp
(
	`fame_move_th
(
gv
[0]));

231 i(
	`rcmp
(
gv
[
gi
], "--version") == 0) {

232 
	`tf
("%s %s\n",

233 
	`fame_move_th
(
gv
[0]),

234 
BACNET_VERSION_TEXT
);

235 
	`tf
("Copyright (C) 2014 by Steve Karg\n"

241 i(
	`rcmp
(
gv
[
gi
], "--mac") == 0) {

242 i(++
gi
 < 
gc
) {

243 
mac_n
 = 
	`addss_om_ascii
(&
mac
[0], 
gv
[
gi
]);

244 i(
mac_n
) {

245 
glob_brd
 = 
l
;

249 i(
	`rcmp
(
gv
[
gi
], "--dnet") == 0) {

250 i(++
gi
 < 
gc
) {

251 
dt
 = 
	`
(
gv
[
gi
], 
NULL
, 0);

252 i((
dt
 >0&& (dÈ<
BACNET_BROADCAST_NETWORK
)) {

253 
glob_brd
 = 
l
;

257 i(
	`rcmp
(
gv
[
gi
], "--dadr") == 0) {

258 i(++
gi
 < 
gc
) {

259 
n
 = 
	`addss_om_ascii
(&
adr
[0], 
gv
[
gi
]);

260 i(
n
) {

261 
glob_brd
 = 
l
;

266 i(
glob_brd
) {

267 
	`dk_g_brd_addss
(&
de
);

269 i(
n
 && 
mac_n
) {

270 
	`memy
(&
de
.
mac
[0], &mac[0], 
mac_n
);

271 
de
.
mac_n
 = mac_len;

272 
	`memy
(&
de
.
adr
[0], &adr[0], 
n
);

273 
de
.
n
 =en;

274 i((
dt
 >0&& (dÈ<
BACNET_BROADCAST_NETWORK
)) {

275 
de
.
t
 = 
dt
;

277 
de
.
t
 = 
BACNET_BROADCAST_NETWORK
;

279 } i(
mac_n
) {

280 
	`memy
(&
de
.
mac
[0], &mac[0], 
mac_n
);

281 
de
.
mac_n
 = mac_len;

282 
de
.
n
 = 0;

283 i((
dt
 >0&& (dÈ<
BACNET_BROADCAST_NETWORK
)) {

284 
de
.
t
 = 
dt
;

286 
de
.
t
 = 0;

289 i((
dt
 >0&& (dÈ<
BACNET_BROADCAST_NETWORK
)) {

290 
de
.
t
 = 
dt
;

292 
de
.
t
 = 
BACNET_BROADCAST_NETWORK
;

294 
de
.
mac_n
 = 0;

295 
de
.
n
 = 0;

299 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

300 
	`In_Svi_Hdrs
();

301 
	`dnv_
();

302 
	`ex
(
dk_nup
);

304 
ϡ_cds
 = 
	`time
(
NULL
);

305 
timeout_cds
 = 
	`du_timeout
() / 1000;

307 
	`time
(&
wtime
);

308 
my_time
 = 
	`loime
(&
wtime
);

309 
bde
.
yr
 = 
my_time
->
tm_yr
 + 1900;

310 
bde
.
mth
 = 
my_time
->
tm_m
 + 1;

311 
bde
.
day
 = 
my_time
->
tm_mday
;

312 
bde
.
wday
 = 
my_time
->
tm_wday
 ? my_time->tm_wday : 7;

313 
btime
.
hour
 = 
my_time
->
tm_hour
;

314 
btime
.
m
 = 
my_time
->
tm_m
;

315 
btime
.
c
 = 
my_time
->
tm_c
;

316 
btime
.
hunddths
 = 0;

317 
	`Sd_TimeSync_Reme
(&
de
, &
bde
, &
btime
);

321 
cut_cds
 = 
	`time
(
NULL
);

323 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

325 i(
pdu_n
) {

326 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

328 i(
E_Deed
)

331 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

332 i(
d_cds
 > 
timeout_cds
)

335 
ϡ_cds
 = 
cut_cds
;

339 
	}
}

	@demo/ucov/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"cov.h
"

36 
	~"tsm.h
"

37 
	~"addss.h
"

38 
	~"cfig.h
"

39 
	~"bacdef.h
"

40 
	~"du.h
"

41 
	~"du.h
"

42 
	~"devi.h
"

43 
	~"t.h
"

44 
	~"dk.h
"

45 
	~"whois.h
"

47 
	~"fame.h
"

48 
	~"hdrs.h
"

49 
	~".h
"

50 
	~"txbuf.h
"

51 
	~"dnv.h
"

53 
	$In_Svi_Hdrs
(

56 
	`Devi_In
(
NULL
);

59 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

61 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

64 
du_t_uecognized_rvi_hdr_hdr


65 (
hdr_uecognized_rvi
);

67 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

68 
hdr_ad_ݔty
);

69 
	}
}

71 
	$ma
(

72 
gc
,

73 *
gv
[])

75 *
vue_rg
 = 
NULL
;

76 
bo
 
us
 = 
l
;

77 
BACNET_COV_DATA
 
cov_da
;

78 
BACNET_PROPERTY_VALUE
 
vue_li
;

79 
ut8_t
 
g
;

81 i(
gc
 < 7) {

83 
	`tf
("Usage: %sid device-id object-type object-instance "

131 
	`fame_move_th
(
gv
[0]), filename_remove_path(argv[0]));

135 
cov_da
.
subsibProssIdtifr
 = 
	`
(
gv
[1], 
NULL
, 0);

136 
cov_da
.
tgDeviIdtifr
 = 
	`
(
gv
[2], 
NULL
, 0);

137 
cov_da
.
mڙedObjeIdtifr
.
ty
 = 
	`
(
gv
[3], 
NULL
, 0);

138 
cov_da
.
mڙedObjeIdtifr
.

 = 
	`
(
gv
[4], 
NULL
, 0);

139 
cov_da
.
timeRemag
 = 
	`
(
gv
[5], 
NULL
, 0);

140 
cov_da
.
liOfVues
 = &
vue_li
;

141 
vue_li
.
xt
 = 
NULL
;

142 
vue_li
.
ݔtyIdtifr
 = 
	`
(
gv
[6], 
NULL
, 0);

143 
g
 = 
	`
(
gv
[7], 
NULL
, 0);

144 
vue_rg
 = 
gv
[8];

146 i(
gc
 > 9)

147 
vue_li
.
iܙy
 = 
	`
(
gv
[9], 
NULL
, 0);

149 
vue_li
.
iܙy
 = 
BACNET_NO_PRIORITY
;

151 i(
gc
 > 10)

152 
vue_li
.
ݔtyAayIndex
 = 
	`
(
gv
[10], 
NULL
, 0);

154 
vue_li
.
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

156 i(
cov_da
.
tgDeviIdtifr
 >
BACNET_MAX_INSTANCE
) {

157 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

158 
cov_da
.
tgDeviIdtifr
, 
BACNET_MAX_INSTANCE
);

161 i(
cov_da
.
mڙedObjeIdtifr
.
ty
 >
MAX_BACNET_OBJECT_TYPE
) {

162 
	`rtf
(
dr
, "object-type=%u - it must beesshan %u\r\n",

163 
cov_da
.
mڙedObjeIdtifr
.
ty
, 
MAX_BACNET_OBJECT_TYPE
);

166 i(
cov_da
.
mڙedObjeIdtifr
.

 > 
BACNET_MAX_INSTANCE
) {

167 
	`rtf
(
dr
, "object-instance=%u - it must beesshan %u\r\n",

168 
cov_da
.
mڙedObjeIdtifr
.

,

169 
BACNET_MAX_INSTANCE
 + 1);

172 i(
cov_da
.
liOfVues
->
ݔtyIdtifr
 > 
MAX_BACNET_PROPERTY_ID
) {

173 
	`rtf
(
dr
, "property-identifier=%u - it must beesshan %u\r\n",

174 
cov_da
.
liOfVues
->
ݔtyIdtifr
,

175 
MAX_BACNET_PROPERTY_ID
 + 1);

178 i(
g
 >
MAX_BACNET_APPLICATION_TAG
) {

179 
	`rtf
(
dr
, "g=%u - imu bsth %u\r\n", 
g
,

180 
MAX_BACNET_APPLICATION_TAG
);

183 
us
 =

184 
	`ba_r_iti_da
(
g
, 
vue_rg
,

185 &
cov_da
.
liOfVues
->
vue
);

186 i(!
us
) {

188 
	`rtf
(
dr
, "unableoarseheag value\r\n");

192 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

193 
	`In_Svi_Hdrs
();

194 
	`dnv_
();

195 
	`ex
(
dk_nup
);

196 
	`Sd_UCOV_Nify
(&
Hdr_Tnsm_Bufr
[0], &
cov_da
);

199 
	}
}

	@demo/uptransfer/main.c

26 
	~<ddef.h
>

27 
	~<dt.h
>

28 
	~<dio.h
>

29 
	~<dlib.h
>

30 
	~<o.h
>

31 
	~<time.h
>

32 
	~<y.h
>

34 
	#PRINT_ENABLED
 1

	)

36 
	~"bacdef.h
"

37 
	~"cfig.h
"

38 
	~"baext.h
"

39 
	~"ba.h
"

40 
	~"m.h
"

41 
	~"f.h
"

42 
	~"tsm.h
"

43 
	~"addss.h
"

44 
	~"du.h
"

45 
	~"du.h
"

46 
	~"devi.h
"

47 
	~"t.h
"

48 
	~"dk.h
"

49 
	~"whois.h
"

51 
	~"fame.h
"

52 
	~"hdrs.h
"

53 
	~".h
"

54 
	~"txbuf.h
"

55 
	~"dnv.h
"

58 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

61 
bo
 
	gTg_Brd
;

62 
ut16_t
 
	gTg_DNET
;

63 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

64 
ut16_t
 
	gTg_Vd_Idtifr
 = 260;

65 
ut32_t
 
	gTg_Svi_Numb
 = 0;

67 #ide
MAX_PROPERTY_VALUES


68 
	#MAX_PROPERTY_VALUES
 64

	)

70 
BACNET_APPLICATION_DATA_VALUE


71 
	gTg_Obje_Prݔty_Vue
[
MAX_PROPERTY_VALUES
];

73 
ut8_t
 
	gSvi_Pams
[
MAX_APDU
];

75 
ut8_t
 
	gReque_Invoke_ID
 = 0;

76 
BACNET_ADDRESS
 
	gTg_Addss
;

77 
bo
 
	gE_Deed
 = 
l
;

79 
	$MyEHdr
(

80 
BACNET_ADDRESS
 * 
c
,

81 
ut8_t
 
voke_id
,

82 
BACNET_ERROR_CLASS
 
r_ass
,

83 
BACNET_ERROR_CODE
 
r_code
)

85 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

86 (
voke_id
 =
Reque_Invoke_ID
)) {

87 
	`tf
("BACnet Error: %s: %s\r\n",

88 
	`baext_r_ass_me
((
r_ass
),

89 
	`baext_r_code_me
((
r_code
));

90 
E_Deed
 = 
ue
;

92 
	}
}

94 
	$MyAbtHdr
(

95 
BACNET_ADDRESS
 * 
c
,

96 
ut8_t
 
voke_id
,

97 
ut8_t
 
abt_as
,

98 
bo
 
rv
)

100 (
rv
;

101 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

102 (
voke_id
 =
Reque_Invoke_ID
)) {

103 
	`tf
("BACnet Abort: %s\r\n",

104 
	`baext_abt_as_me
((
abt_as
));

105 
E_Deed
 = 
ue
;

107 
	}
}

109 
	$MyRejeHdr
(

110 
BACNET_ADDRESS
 * 
c
,

111 
ut8_t
 
voke_id
,

112 
ut8_t
 
je_as
)

114 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

115 (
voke_id
 =
Reque_Invoke_ID
)) {

116 
	`tf
("BACnet Reject: %s\r\n",

117 
	`baext_je_as_me
((
je_as
));

118 
E_Deed
 = 
ue
;

120 
	}
}

122 
	$In_Svi_Hdrs
(

125 
	`Devi_In
(
NULL
);

128 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

130 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

133 
du_t_uecognized_rvi_hdr_hdr


134 (
hdr_uecognized_rvi
);

136 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

137 
hdr_ad_ݔty
);

139 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_PRIVATE_TRANSFER
,

140 
hdr_uncfmed_ive_sr
);

142 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
, 
MyEHdr
);

143 
	`du_t_abt_hdr
(
MyAbtHdr
);

144 
	`du_t_je_hdr
(
MyRejeHdr
);

145 
	}
}

147 
	$ma
(

148 
gc
,

149 *
gv
[])

151 
BACNET_ADDRESS
 
c
 = {

154 
ut16_t
 
pdu_n
 = 0;

155 
timeout
 = 10;

156 
max_du
 = 0;

157 
time_t
 
d_cds
 = 0;

158 
time_t
 
ϡ_cds
 = 0;

159 
time_t
 
cut_cds
 = 0;

160 
time_t
 
timeout_cds
 = 0;

161 
time_t
 
d_cds
 = 0;

162 
bo
 
found
 = 
l
;

163 *
fame
 = 
NULL
;

164 *
vue_rg
 = 
NULL
;

165 
bo
 
us
 = 
l
;

166 
gs_mag
 = 0, 
g_vue_g
 = 0, 
i
 = 0;

167 
BACNET_APPLICATION_TAG
 
ݔty_g
;

168 
ut8_t
 
cڋxt_g
 = 0;

169 
BACNET_PRIVATE_TRANSFER_DATA
 
ive_da
 = { 0 };

170 
n
 = 0;

171 
bo
 
_mesge
 = 
l
;

173 i(
gc
 < 6) {

174 
fame
 = 
	`fame_move_th
(
gv
[0]);

175 
	`tf
("Usage: %s <device-instance|broadcast|dnet=> vendor-id"

176 " svi-numbag vu[g vue...]\r\n", 
fame
);

177 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

178 
	`tf
("device-instance:\r\n"

208 "%99 260 23 4 1.1\r\n", 
fame
);

213 i(
	`rcmp
(
gv
[1], "broadcast") == 0) {

214 
Tg_Brd
 = 
ue
;

215 
Tg_DNET
 = 
BACNET_BROADCAST_NETWORK
;

216 } i(
	`cmp
(
gv
[1], "dnet=", 5) == 0) {

217 
Tg_Brd
 = 
ue
;

218 
Tg_DNET
 = 
	`
(&
gv
[1][5], 
NULL
, 0);

220 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

222 
Tg_Vd_Idtifr
 = 
	`
(
gv
[2], 
NULL
, 0);

223 
Tg_Svi_Numb
 = 
	`
(
gv
[3], 
NULL
, 0);

224 i((!
Tg_Brd
) &&

225 (
Tg_Devi_Obje_In
 > 
BACNET_MAX_INSTANCE
)) {

226 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

227 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

230 
gs_mag
 = (
gc
 - (6 - 2));

231 
i
 = 0; i < 
MAX_PROPERTY_VALUES
; i++) {

232 
g_vue_g
 = (6 - 2+ (
i
 * 2);

234 i(
	`tou
(
gv
[
g_vue_g
][0]) == 'C') {

235 
cڋxt_g
 = 
	`
(&
gv
[
g_vue_g
][1], 
NULL
, 0);

236 
g_vue_g
++;

237 
gs_mag
--;

238 
Tg_Obje_Prݔty_Vue
[
i
].
cڋxt_g
 = context_tag;

239 
Tg_Obje_Prݔty_Vue
[
i
].
cڋxt_ecific
 = 
ue
;

241 
Tg_Obje_Prݔty_Vue
[
i
].
cڋxt_ecific
 = 
l
;

243 
ݔty_g
 = 
	`
(
gv
[
g_vue_g
], 
NULL
, 0);

244 
gs_mag
--;

245 i(
gs_mag
 <= 0) {

246 
	`rtf
(
dr
, "Error:otnoughag-valueairs\r\n");

249 
vue_rg
 = 
gv
[
g_vue_g
 + 1];

250 
gs_mag
--;

253 i(
ݔty_g
 >
MAX_BACNET_APPLICATION_TAG
) {

254 
	`rtf
(
dr
, "Error:ag=%u - it must beesshan %u\r\n",

255 
ݔty_g
, 
MAX_BACNET_APPLICATION_TAG
);

258 
us
 =

259 
	`ba_r_iti_da
(
ݔty_g
, 
vue_rg
,

260 &
Tg_Obje_Prݔty_Vue
[
i
]);

261 i(!
us
) {

263 
	`rtf
(
dr
, "Error: unableoarseheag value\r\n");

266 
Tg_Obje_Prݔty_Vue
[
i
].
xt
 = 
NULL
;

267 i(
i
 > 0) {

268 
Tg_Obje_Prݔty_Vue
[
i
 - 1].
xt
 =

269 &
Tg_Obje_Prݔty_Vue
[
i
];

271 i(
gs_mag
 <= 0) {

275 i(
gs_mag
 > 0) {

276 
	`rtf
(
dr
, "Error: Exceeded %dag-valueairs.\r\n",

277 
MAX_PROPERTY_VALUES
);

281 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

282 
	`addss_
();

283 
	`In_Svi_Hdrs
();

284 
	`dnv_
();

285 
	`ex
(
dk_nup
);

287 
ϡ_cds
 = 
	`time
(
NULL
);

288 i(
Tg_Brd
) {

289 
	`dk_g_brd_addss
(&
Tg_Addss
);

290 
Tg_Addss
.
t
 = 
Tg_DNET
;

291 
found
 = 
ue
;

292 
timeout_cds
 = 0;

294 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

296 
found
 =

297 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

298 &
Tg_Addss
);

299 i(!
found
) {

300 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

301 
Tg_Devi_Obje_In
);

307 
cut_cds
 = 
	`time
(
NULL
);

309 i(
cut_cds
 !
ϡ_cds
) {

311 
d_cds
 = 
cut_cds
 - 
ϡ_cds
;

312 
d_cds
 +
d_cds
;

313 
	`tsm_tim_mlicds
(((
cut_cds
 - 
ϡ_cds
) * 1000));

315 i(
E_Deed
)

318 i(!
found
) {

319 
found
 =

320 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

321 &
Tg_Addss
);

323 i(!
_mesge
) {

324 i(
found
) {

325 
n
 =

326 
	`ba_code_da
(&
Svi_Pams
[0],

327 &
Tg_Obje_Prݔty_Vue
[0]);

328 
ive_da
.
rviPams
 = &
Svi_Pams
[0];

329 
ive_da
.
rviPamsL
 = 
n
;

330 
ive_da
.
vdID
 = 
Tg_Vd_Idtifr
;

331 
ive_da
.
rviNumb
 = 
Tg_Svi_Numb
;

332 
	`Sd_UncfmedPriveTnsr
(&
Tg_Addss
,

333 &
ive_da
);

334 
	`tf
("Sent PrivateTransfer.");

335 i(
timeout_cds
) {

336 
	`tf
(" Waiting %u seconds.\r\n",

337 ((
timeout_cds
 - 
d_cds
));

339 
	`tf
("\r\n");

341 
_mesge
 = 
ue
;

343 i(
d_cds
 > 
timeout_cds
) {

344 
	`tf
("\rError: APDU Timeout!\r\n");

345 
E_Deed
 = 
ue
;

351 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

353 i(
pdu_n
) {

354 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

356 i(
E_Deed
) {

360 i(
d_cds
 > 
timeout_cds
) {

364 
ϡ_cds
 = 
cut_cds
;

367 i(
E_Deed
)

370 
	}
}

	@demo/whohas/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"f.h
"

36 
	~"tsm.h
"

37 
	~"addss.h
"

38 
	~"cfig.h
"

39 
	~"bacdef.h
"

40 
	~"du.h
"

41 
	~"du.h
"

42 
	~"devi.h
"

43 
	~"t.h
"

44 
	~"dk.h
"

45 
	~"whohas.h
"

47 
	~"fame.h
"

48 
	~"hdrs.h
"

49 
	~".h
"

50 
	~"txbuf.h
"

51 
	~"dnv.h
"

54 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

57 
BACNET_OBJECT_TYPE
 
	gTg_Obje_Ty
 = 
MAX_BACNET_OBJECT_TYPE
;

58 
ut32_t
 
	gTg_Obje_In
 = 
BACNET_MAX_INSTANCE
;

59 *
	gTg_Obje_Name
 = 
NULL
;

60 
t32_t
 
	gTg_Obje_In_M
 = -1;

61 
t32_t
 
	gTg_Obje_In_Max
 = -1;

63 
bo
 
	gE_Deed
 = 
l
;

65 
	$MyAbtHdr
(

66 
BACNET_ADDRESS
 * 
c
,

67 
ut8_t
 
voke_id
,

68 
ut8_t
 
abt_as
,

69 
bo
 
rv
)

72 (
c
;

73 (
voke_id
;

74 (
rv
;

75 
	`tf
("BACÈAbt: %s\r\n", 
	`baext_abt_as_me
(
abt_as
));

76 
E_Deed
 = 
ue
;

77 
	}
}

79 
	$MyRejeHdr
(

80 
BACNET_ADDRESS
 * 
c
,

81 
ut8_t
 
voke_id
,

82 
ut8_t
 
je_as
)

85 (
c
;

86 (
voke_id
;

87 
	`tf
("BACÈReje: %s\r\n", 
	`baext_je_as_me
(
je_as
));

88 
E_Deed
 = 
ue
;

89 
	}
}

91 
	$In_Svi_Hdrs
(

94 
	`Devi_In
(
NULL
);

97 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

100 
du_t_uecognized_rvi_hdr_hdr


101 (
hdr_uecognized_rvi
);

103 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

104 
hdr_ad_ݔty
);

106 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_HAVE
, 
hdr_i_have
);

108 
	`du_t_abt_hdr
(
MyAbtHdr
);

109 
	`du_t_je_hdr
(
MyRejeHdr
);

110 
	}
}

112 
	$t_uge
(

113 *
fame
)

115 
	`tf
("Usage: %s [device-instance-min device-instance-min] "

116 "<obje-ty obje- | obje-me> [--hp]\r\n", 
fame
);

117 
	}
}

119 
	$t_hp
(

120 *
fame
)

122 
	`t_uge
(
fame
);

123 
	`tf
("Send BACnet WhoHasequesto devices, \r\n"

129 
BACNET_MAX_INSTANCE
, (
	`du_timeout
(), 
BACNET_MAX_OBJECT
,

130 
BACNET_MAX_INSTANCE
);

131 
	}
}

133 
	$ma
(

134 
gc
,

135 *
gv
[])

137 
BACNET_ADDRESS
 
c
 = {

140 
ut16_t
 
pdu_n
 = 0;

141 
timeout
 = 100;

142 
time_t
 
d_cds
 = 0;

143 
time_t
 
ϡ_cds
 = 0;

144 
time_t
 
cut_cds
 = 0;

145 
time_t
 
timeout_cds
 = 0;

146 
gi
 = 0;

147 
bo
 
by_me
 = 
l
;

149 i(
gc
 < 2) {

150 
	`t_uge
(
	`fame_move_th
(
gv
[0]));

154 
gi
 = 1;rg< 
gc
;rgi++) {

155 i(
	`rcmp
(
gv
[
gi
], "--help") == 0) {

156 
	`t_hp
(
	`fame_move_th
(
gv
[0]));

161 i(
gc
 < 3) {

163 
Tg_Obje_In_M
 = 
Tg_Obje_In_Max
 = -1;

164 
Tg_Obje_Name
 = 
gv
[1];

165 
by_me
 = 
ue
;

166 } i(
gc
 < 4) {

168 
Tg_Obje_In_M
 = 
Tg_Obje_In_Max
 = -1;

169 
Tg_Obje_Ty
 = 
	`
(
gv
[1], 
NULL
, 0);

170 
Tg_Obje_In
 = 
	`
(
gv
[2], 
NULL
, 0);

171 } i(
gc
 < 5) {

173 
Tg_Obje_In_M
 = 
	`
(
gv
[1], 
NULL
, 0);

174 
Tg_Obje_In_Max
 = 
	`
(
gv
[2], 
NULL
, 0);

175 
Tg_Obje_Name
 = 
gv
[3];

176 
by_me
 = 
ue
;

177 } i(
gc
 < 6) {

179 
Tg_Obje_In_M
 = 
	`
(
gv
[1], 
NULL
, 0);

180 
Tg_Obje_In_Max
 = 
	`
(
gv
[2], 
NULL
, 0);

181 
Tg_Obje_Ty
 = 
	`
(
gv
[3], 
NULL
, 0);

182 
Tg_Obje_In
 = 
	`
(
gv
[4], 
NULL
, 0);

184 
	`t_uge
(
	`fame_move_th
(
gv
[0]));

187 i(
by_me
) {

188 i(
Tg_Obje_Name
) {

189 i(
Tg_Obje_Name
[0] == 0) {

190 
	`rtf
(
dr
,

195 
	`rtf
(
dr
, "missing object-name value.\r\n");

199 i(
Tg_Obje_In
 > 
BACNET_MAX_INSTANCE
) {

200 
	`rtf
(
dr
, "object-instance=%u - it must beesshan %u\r\n",

201 
Tg_Obje_In
, 
BACNET_MAX_INSTANCE
 + 1);

204 i(
Tg_Obje_Ty
 > 
BACNET_MAX_OBJECT
) {

205 
	`rtf
(
dr
, "object-type=%u - it must beesshan %u\r\n",

206 
Tg_Obje_Ty
, 
BACNET_MAX_OBJECT
 + 1);

210 i(
Tg_Obje_In_M
 > 
BACNET_MAX_INSTANCE
) {

211 
	`rtf
(
dr
, "object-instance-min=%u - it must beesshan %u\r\n",

212 
Tg_Obje_In_M
, 
BACNET_MAX_INSTANCE
 + 1);

215 i(
Tg_Obje_In_Max
 > 
BACNET_MAX_INSTANCE
) {

216 
	`rtf
(
dr
, "object-instance-max=%u - it must beesshan %u\r\n",

217 
Tg_Obje_In_Max
, 
BACNET_MAX_INSTANCE
 + 1);

221 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

222 
	`In_Svi_Hdrs
();

223 
	`dnv_
();

224 
	`ex
(
dk_nup
);

226 
ϡ_cds
 = 
	`time
(
NULL
);

227 
timeout_cds
 = 
	`du_timeout
() / 1000;

229 i(
by_me
) {

230 
	`Sd_WhoHas_Name
(
Tg_Obje_In_M
,

231 
Tg_Obje_In_Max
, 
Tg_Obje_Name
);

233 
	`Sd_WhoHas_Obje
(
Tg_Obje_In_M
,

234 
Tg_Obje_In_Max
, 
Tg_Obje_Ty
,

235 
Tg_Obje_In
);

240 
cut_cds
 = 
	`time
(
NULL
);

242 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

244 i(
pdu_n
) {

245 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

247 i(
E_Deed
)

250 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

251 i(
d_cds
 > 
timeout_cds
)

254 
ϡ_cds
 = 
cut_cds
;

258 
	}
}

	@demo/whois/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<y.h
>

32 
	~<time.h
>

33 
	~<o.h
>

34 
	~"baext.h
"

35 
	~"m.h
"

36 
	~"addss.h
"

37 
	~"cfig.h
"

38 
	~"bacdef.h
"

39 
	~"du.h
"

40 
	~"du.h
"

41 
	~"devi.h
"

42 
	~"dk.h
"

43 
	~"baext.h
"

45 
	~"fame.h
"

46 
	~"hdrs.h
"

47 
	~".h
"

48 
	~"txbuf.h
"

49 #i
defed
(
BACDL_MSTP
)

50 
	~"rs485.h
"

52 
	~"dnv.h
"

53 
	~"t.h
"

56 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

59 
t32_t
 
	gTg_Obje_In_M
 = -1;

60 
t32_t
 
	gTg_Obje_In_Max
 = -1;

61 
bo
 
	gE_Deed
 = 
l
;

63 
	#BAC_ADDRESS_MULT
 1

	)

65 
	saddss_y
 {

66 
addss_y
 *
	mxt
;

67 
ut8_t
 
	mFgs
;

68 
ut32_t
 
	mdevi_id
;

69 
	mmax_du
;

70 
BACNET_ADDRESS
 
	maddss
;

73 
	saddss_b
 {

74 
addss_y
 *
	mf
;

75 
addss_y
 *
	mϡ
;

76 } 
	gAddss_Tab
 = {

80 
addss_y
 *
	$loc_addss_y
(

83 
addss_y
 *
rv
;

84 
rv
 = (
addss_y
 *
	`oc
(1, (address_entry));

85 i(
Addss_Tab
.
f
 == 0) {

86 
Addss_Tab
.
f
 = Addss_Tab.
ϡ
 = 
rv
;

88 
Addss_Tab
.
ϡ
->
xt
 = 
rv
;

89 
Addss_Tab
.
ϡ
 = 
rv
;

91  
rv
;

92 
	}
}

96 
bo
 
	$ba_addss_mches
(

97 
BACNET_ADDRESS
 * 
a1
,

98 
BACNET_ADDRESS
 * 
a2
)

100 
i
 = 0;

101 i(
a1
->
t
 !
a2
->net)

102  
l
;

103 i(
a1
->
n
 !
a2
->len)

104  
l
;

105 ; 
i
 < 
a1
->
n
; i++)

106 i(
a1
->
adr
[
i
] !
a2
->adr[i])

107  
l
;

108  
ue
;

109 
	}
}

111 
	$addss_b_add
(

112 
ut32_t
 
devi_id
,

113 
max_du
,

114 
BACNET_ADDRESS
 * 
c
)

116 
addss_y
 *
pMch
;

117 
ut8_t
 
ags
 = 0;

119 
pMch
 = 
Addss_Tab
.
f
;

120 
pMch
) {

121 i(
pMch
->
devi_id
 == device_id) {

122 i(
	`ba_addss_mches
(&
pMch
->
addss
, 
c
))

124 
ags
 |
BAC_ADDRESS_MULT
;

125 
pMch
->
Fgs
 |
BAC_ADDRESS_MULT
;

127 
pMch
 =Mch->
xt
;

130 
pMch
 = 
	`loc_addss_y
();

132 
pMch
->
Fgs
 = 
ags
;

133 
pMch
->
devi_id
 = device_id;

134 
pMch
->
max_du
 = max_apdu;

135 
pMch
->
addss
 = *
c
;

138 
	}
}

142 
	$my_i_am_hdr
(

143 
ut8_t
 * 
rvi_que
,

144 
ut16_t
 
rvi_n
,

145 
BACNET_ADDRESS
 * 
c
)

147 
n
 = 0;

148 
ut32_t
 
devi_id
 = 0;

149 
max_du
 = 0;

150 
gmti
 = 0;

151 
ut16_t
 
vd_id
 = 0;

152 
i
 = 0;

154 (
rvi_n
;

155 
n
 =

156 
	`m_decode_rvi_que
(
rvi_que
, &
devi_id
, &
max_du
,

157 &
gmti
, &
vd_id
);

158 #i
PRINT_ENABLED


159 
	`rtf
(
dr
, "Received I-Am Request");

161 i(
n
 != -1) {

162 #i
PRINT_ENABLED


163 
	`rtf
(
dr
, " from %lu, MAC = ", (
devi_id
);

164 i((
c
->
mac_n
 =6&& (c->
n
 == 0)) {

165 
	`rtf
(
dr
, "%u.%u.%u.%u %02X%02X\n",

166 ()
c
->
mac
[0], ()src->mac[1],

167 ()
c
->
mac
[2], ()src->mac[3],

168 ()
c
->
mac
[4], ()src->mac[5]);

170 
i
 = 0; i < 
c
->
mac_n
; i++) {

171 
	`rtf
(
dr
, "%02X", ()
c
->
mac
[
i
]);

172 i(
i
 < (
c
->
mac_n
-1)) {

173 
	`rtf
(
dr
, ":");

176 
	`rtf
(
dr
, "\n");

179 
	`addss_b_add
(
devi_id
, 
max_du
, 
c
);

181 #i
PRINT_ENABLED


182 
	`rtf
(
dr
, ", but unableo decode it.\n");

187 
	}
}

189 
	$MyAbtHdr
(

190 
BACNET_ADDRESS
 * 
c
,

191 
ut8_t
 
voke_id
,

192 
ut8_t
 
abt_as
,

193 
bo
 
rv
)

196 (
c
;

197 (
voke_id
;

198 (
rv
;

199 
	`rtf
(
dr
, "BACnet Abort: %s\r\n",

200 
	`baext_abt_as_me
(
abt_as
));

201 
E_Deed
 = 
ue
;

202 
	}
}

204 
	$MyRejeHdr
(

205 
BACNET_ADDRESS
 * 
c
,

206 
ut8_t
 
voke_id
,

207 
ut8_t
 
je_as
)

210 (
c
;

211 (
voke_id
;

212 
	`rtf
(
dr
, "BACnet Reject: %s\r\n",

213 
	`baext_je_as_me
(
je_as
));

214 
E_Deed
 = 
ue
;

215 
	}
}

217 
	$_rvi_hdrs
(

220 
	`Devi_In
(
NULL
);

225 
du_t_uecognized_rvi_hdr_hdr


226 (
hdr_uecognized_rvi
);

228 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

229 
hdr_ad_ݔty
);

231 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
my_i_am_hdr
);

233 
	`du_t_abt_hdr
(
MyAbtHdr
);

234 
	`du_t_je_hdr
(
MyRejeHdr
);

235 
	}
}

237 
	$t_maddr
(

238 
ut8_t
 * 
addr
,

239 
n
)

241 
j
 = 0;

243 
j
 < 
n
) {

244 i(
j
 != 0) {

245 
	`tf
(":");

247 
	`tf
("%02X", 
addr
[
j
]);

248 
j
++;

250 
j
 < 
MAX_MAC_LEN
) {

251 
	`tf
(" ");

252 
j
++;

254 
	}
}

256 
	$t_addss_che
(

259 
BACNET_ADDRESS
 
addss
;

260 
tٮ_addss
 = 0;

261 
dup_addss
 = 0;

262 
addss_y
 *
addr
;

263 
ut8_t
 
lol_dr
 = 0;

268 
	`tf
(";%-7s %-20s %-5s %-20s %-4s\n", "Device", "MAC (hex)", "SNET",

270 
	`tf
(";-------- -------------------- ----- -------------------- ----\n");

273 
addr
 = 
Addss_Tab
.
f
;

274 
addr
) {

275 
	`ba_addss_cy
(&
addss
, &
addr
->address);

276 
tٮ_addss
++;

277 i(
addr
->
Fgs
 & 
BAC_ADDRESS_MULT
) {

278 
dup_addss
++;

279 
	`tf
(";");

281 
	`tf
(" ");

283 
	`tf
(" %-7u ", 
addr
->
devi_id
);

284 
	`t_maddr
(
addss
.
mac
,ddss.
mac_n
);

285 
	`tf
(" %-5hu ", 
addss
.
t
);

286 i(
addss
.
t
) {

287 
	`t_maddr
(
addss
.
adr
,ddss.
n
);

289 
	`t_maddr
(&
lol_dr
, 1);

291 
	`tf
(" %-4hu ", 
addr
->
max_du
);

292 
	`tf
("\n");

294 
addr
 =ddr->
xt
;

296 
	`tf
(";\n; Tٮ Devis: %u\n", 
tٮ_addss
);

297 i(
dup_addss
) {

298 
	`tf
("; * Dui Devis: %u\n", 
dup_addss
);

300 
	}
}

302 
	$t_uge
(

303 *
exe_me
)

305 
	`tf
("Usage:\n" "\n" "%s [[network]:[address]] "

306 "[devi--m [devi--max]] [--hp]\n", 
exe_me
);

308 
	}
}

311 
	$t_hp
(

312 *
exe_me
)

314 
	`tf
("Usage:\n" "\n" "%s [[network]:[address]] "

335 "%s\n\n", 
exe_me
,xe_name,xe_name,xe_name,xe_name,xe_name,

336 
exe_me
);

338 
	}
}

345 
	$r_bac_addss
(

346 
BACNET_ADDRESS
 * 
de
,

347 *
c


350 
i
 = 0;

351 
ut16_t
 
s
;

352 
a
[4], 
p
;

353 
c
 = 
	`ssnf
(
c
, "%u.%u.%u.%u:%u", &
a
[0], &a[1], &a[2], &a[3], &
p
);

355 
de
->
n
 = 0;

357 i(
c
 == 1) {

358 i(
a
[0] < 256) {

359 
de
->
adr
[0] = 
a
[0];

360 
de
->
n
 = 1;

361 } i(
a
[0] < 0x0FFFF) {

362 
s
 = 
	`hts
((
ut16_t

a
[0]);

363 
	`memy
(&
de
->
adr
[0], &
s
, 2);

364 
de
->
n
 = 2;

367 } i(
c
 == 5) {

368 
i
 = 0; i < 4; i++) {

369 i((
a
[
i
] < 0) || (a[i] > 255)) {

372 
de
->
adr
[
i
] = 
a
[i];

374 
s
 = 
	`hts
((
ut16_t

p
);

375 
	`memy
(&
de
->
adr
[
i
], &
s
, 2);

376 
de
->
n
 = 6;

378  
de
->
n
;

379 
	}
}

381 
	$ma
(

382 
gc
,

383 *
gv
[])

385 
BACNET_ADDRESS
 
c
 = {

388 
ut16_t
 
pdu_n
 = 0;

389 
timeout
 = 100;

390 
time_t
 
tٮ_cds
 = 0;

391 
time_t
 
d_cds
 = 0;

392 
time_t
 
ϡ_cds
 = 0;

393 
time_t
 
cut_cds
 = 0;

394 
time_t
 
timeout_cds
 = 0;

395 
BACNET_ADDRESS
 
de
;

396 
gi
;

399 
gi
 = 1;rg< 
gc
;rgi++) {

400 i(
	`rcmp
(
gv
[
gi
], "--help") == 0) {

401 
	`t_hp
(
	`fame_move_th
(
gv
[0]));

406 
	`dk_g_brd_addss
(&
de
);

409 i(
gc
 >= 2) {

410 *
s
;

411 
v
 = 
	`
(
gv
[1], &
s
, 0);

412 i(*
s
++ == ':') {

413 i(
gv
[1][0] != ':')

414 
de
.
t
 = (
ut16_t

v
;

415 
de
.
mac_n
 = 0;

416 i(
	`isdig
(*
s
))

417 
	`r_bac_addss
(&
de
, 
s
);

419 
Tg_Obje_In_M
 = 
Tg_Obje_In_Max
 = 
v
;

423 i(
gc
 <= 2) {

425 } i(
gc
 == 3) {

426 i(
Tg_Obje_In_M
 == -1)

427 
Tg_Obje_In_M
 = 
Tg_Obje_In_Max
 =

428 
	`
(
gv
[2], 
NULL
, 0);

430 
Tg_Obje_In_Max
 = 
	`
(
gv
[2], 
NULL
, 0);

431 } i(
gc
 == 4) {

432 
Tg_Obje_In_M
 = 
	`
(
gv
[2], 
NULL
, 0);

433 
Tg_Obje_In_Max
 = 
	`
(
gv
[3], 
NULL
, 0);

435 
	`t_uge
(
	`fame_move_th
(
gv
[0]));

439 i(
Tg_Obje_In_M
 > 
BACNET_MAX_INSTANCE
) {

440 
	`rtf
(
dr
, "device-instance-min=%u - it must beesshan %u\r\n",

441 
Tg_Obje_In_M
, 
BACNET_MAX_INSTANCE
 + 1);

444 i(
Tg_Obje_In_Max
 > 
BACNET_MAX_INSTANCE
) {

445 
	`rtf
(
dr
, "device-instance-max=%u - it must beesshan %u\r\n",

446 
Tg_Obje_In_Max
, 
BACNET_MAX_INSTANCE
 + 1);

451 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

452 
	`_rvi_hdrs
();

453 
	`addss_
();

454 
	`dnv_
();

455 
	`ex
(
dk_nup
);

457 
ϡ_cds
 = 
	`time
(
NULL
);

458 
timeout_cds
 = 
	`du_timeout
() / 1000;

460 
	`Sd_WhoIs_To_Nwk
(&
de
, 
Tg_Obje_In_M
,

461 
Tg_Obje_In_Max
);

465 
cut_cds
 = 
	`time
(
NULL
);

467 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

469 i(
pdu_n
) {

470 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

472 i(
E_Deed
)

475 
d_cds
 = 
cut_cds
 - 
ϡ_cds
;

476 i(
d_cds
) {

477 #i
	`defed
(
BACDL_BIP
&& 
BBMD_ENABLED


478 
	`bvlc_man_tim
(
d_cds
);

481 
tٮ_cds
 +
d_cds
;

482 i(
tٮ_cds
 > 
timeout_cds
)

485 
ϡ_cds
 = 
cut_cds
;

487 
	`t_addss_che
();

490 
	}
}

	@demo/whoisrouter/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"addss.h
"

36 
	~"cfig.h
"

37 
	~"bacdef.h
"

38 
	~"du.h
"

39 
	~"du.h
"

40 
	~"devi.h
"

41 
	~"dk.h
"

43 #ide
DEBUG_ENABLED


44 
	#DEBUG_ENABLED
 0

	)

46 
	~"debug.h
"

47 
	~"fame.h
"

48 
	~"hdrs.h
"

49 
	~".h
"

50 
	~"txbuf.h
"

51 #i
defed
(
BACDL_MSTP
)

52 
	~"rs485.h
"

54 
	~"dnv.h
"

57 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

60 
t32_t
 
	gTg_Rour_Nwk
 = 0;

61 
BACNET_ADDRESS
 
	gTg_Rour_Addss
;

63 
bo
 
	gE_Deed
 = 
l
;

65 
	$MyAbtHdr
(

66 
BACNET_ADDRESS
 * 
c
,

67 
ut8_t
 
voke_id
,

68 
ut8_t
 
abt_as
,

69 
bo
 
rv
)

72 (
c
;

73 (
voke_id
;

74 (
rv
;

75 
	`tf
("BACÈAbt: %s\r\n", 
	`baext_abt_as_me
(
abt_as
));

76 
E_Deed
 = 
ue
;

77 
	}
}

79 
	$MyRejeHdr
(

80 
BACNET_ADDRESS
 * 
c
,

81 
ut8_t
 
voke_id
,

82 
ut8_t
 
je_as
)

85 (
c
;

86 (
voke_id
;

87 
	`tf
("BACÈReje: %s\r\n", 
	`baext_je_as_me
(
je_as
));

88 
E_Deed
 = 
ue
;

89 
	}
}

91 
	$My_Rour_Hdr
(

92 
BACNET_ADDRESS
 * 
c
,

93 
BACNET_NPDU_DATA
 * 
du_da
,

94 
ut8_t
 * 
du
,

95 
ut16_t
 
du_n
)

97 
ut16_t
 
du_offt
 = 0;

98 
ut16_t
 
dt
 = 0;

99 
ut16_t
 
n
 = 0;

100 
ut16_t
 
j
 = 0;

102 
du_da
->
twk_mesge_ty
) {

103 
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
:

105 
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
:

106 
	`tf
("I-Am Routero Network from ");

107 
j
 = 0; j < 
MAX_MAC_LEN
; j++) {

108 i(
j
 < 
c
->
mac_n
) {

109 
	`tf
("%02X", 
c
->
mac
[
j
]);

112 
	`tf
("\nNetworks: ");

113 
du_n
 >= 2) {

114 
n
 = 
	`decode_unsigd16
(&
du
[
du_offt
], &
dt
);

115 
	`tf
("%hu", 
dt
);

116 
du_n
 -
n
;

117 
du_offt
 +
n
;

118 i(
du_n
 >= 2) {

119 
	`tf
(", ");

122 
	`tf
("\n");

123 i(
du_n
) {

124 
	`tf
("Warning! Extra byteeceived!\n");

127 
NETWORK_MESSAGE_I_COULD_BE_ROUTER_TO_NETWORK
:

128 
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
:

129 
NETWORK_MESSAGE_ROUTER_BUSY_TO_NETWORK
:

130 
NETWORK_MESSAGE_ROUTER_AVAILABLE_TO_NETWORK
:

131 
NETWORK_MESSAGE_INIT_RT_TABLE
:

132 
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
:

133 
NETWORK_MESSAGE_ESTABLISH_CONNECTION_TO_NETWORK
:

134 
NETWORK_MESSAGE_DISCONNECT_CONNECTION_TO_NETWORK
:

138 
	}
}

140 
	$My_NPDU_Hdr
(

141 
BACNET_ADDRESS
 * 
c
,

142 
ut8_t
 * 
pdu
,

143 
ut16_t
 
pdu_n
)

145 
du_offt
 = 0;

146 
BACNET_ADDRESS
 
de
 = { 0 };

147 
BACNET_NPDU_DATA
 
du_da
 = { 0 };

149 
du_offt
 = 
	`du_decode
(&
pdu
[0], &
de
, 
c
, &
du_da
);

150 i(
du_da
.
twk_y_mesge
) {

151 
	`My_Rour_Hdr
(
c
, &
du_da
, &
pdu
[
du_offt
],

152 (
ut16_t
(
pdu_n
 - 
du_offt
));

153 } i((
du_offt
 > 0&& (du_off<
pdu_n
)) {

154 i((
du_da
.
oc_vsi
 =
BACNET_PROTOCOL_VERSION
) &&

155 ((
de
.
t
 =0|| (de.È=
BACNET_BROADCAST_NETWORK
))) {

159 
	`du_hdr
(
c
, &
pdu
[
du_offt
],

160 (
ut16_t
(
pdu_n
 - 
du_offt
));

162 i(
de
.
t
) {

163 
	`debug_tf
("NPDU: DNET=%d. Disrded!\n", 
de
.
t
);

165 
	`debug_tf
("NPDU: BACnet Protocol Version=%d. Discarded!\n",

166 
du_da
.
oc_vsi
);

172 
	}
}

174 
	$In_Svi_Hdrs
(

177 
	`Devi_In
(
NULL
);

180 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

183 
du_t_uecognized_rvi_hdr_hdr


184 (
hdr_uecognized_rvi
);

186 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

187 
hdr_ad_ݔty
);

189 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_add
);

191 
	`du_t_abt_hdr
(
MyAbtHdr
);

192 
	`du_t_je_hdr
(
MyRejeHdr
);

193 
	}
}

196 
	$addss_r
(

197 
BACNET_ADDRESS
 * 
d
,

198 
gc
,

199 *
gv
[])

201 
dt
 = 0;

202 
mac
[6];

203 
cou
 = 0;

204 
dex
 = 0;

206 i(
gc
 > 0) {

207 
cou
 =

208 
	`ssnf
(
gv
[0], "%x:%x:%x:%x:%x:%x", &
mac
[0], &mac[1], &mac[2],

209 &
mac
[3], &mac[4], &mac[5]);

210 
d
->
mac_n
 = 
cou
;

211 
dex
 = 0; index < 
MAX_MAC_LEN
; index++) {

212 i(
dex
 < 
cou
) {

213 
d
->
mac
[
dex
] = mac[index];

215 
d
->
mac
[
dex
] = 0;

219 i(
gc
 > 1) {

220 
cou
 = 
	`ssnf
(
gv
[1], "%d", &
dt
);

221 
d
->
t
 = 
dt
;

223 i(
dt
) {

224 i(
gc
 > 2) {

225 
cou
 =

226 
	`ssnf
(
gv
[2], "%x:%x:%x:%x:%x:%x", &
mac
[0], &mac[1], &mac[2],

227 &
mac
[3], &mac[4], &mac[5]);

228 
d
->
n
 = 
cou
;

229 
dex
 = 0; index < 
MAX_MAC_LEN
; index++) {

230 i(
dex
 < 
cou
) {

231 
d
->
adr
[
dex
] = 
mac
[index];

233 
d
->
adr
[
dex
] = 0;

237 
	`rtf
(
dr
, "Aon-zero DNETequires DADR.\r\n");

240 
d
->
n
 = 0;

241 
dex
 = 0; index < 
MAX_MAC_LEN
; index++) {

242 
d
->
adr
[
dex
] = 0;

245 
	}
}

247 
	$ma
(

248 
gc
,

249 *
gv
[])

251 
BACNET_ADDRESS
 
c
 = {

254 
ut16_t
 
pdu_n
 = 0;

255 
timeout
 = 100;

256 
time_t
 
tٮ_cds
 = 0;

257 
time_t
 
d_cds
 = 0;

258 
time_t
 
ϡ_cds
 = 0;

259 
time_t
 
cut_cds
 = 0;

260 
time_t
 
timeout_cds
 = 0;

262 i(
gc
 < 2) {

263 
	`tf
("Uge: %DNET [MAC]\r\n", 
	`fame_move_th
(
gv
[0]));

266 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

267 
	`tf
("Send BACnet Who-Is-Router-To-Network messageoetwork.\r\n"

276 "%-1\r\n", 
	`fame_move_th
(
gv
[0]),

277 
	`fame_move_th
(
gv
[0]));

281 i(
gc
 > 1) {

282 
Tg_Rour_Nwk
 = 
	`
(
gv
[1], 
NULL
, 0);

283 i(
Tg_Rour_Nwk
 > 65535) {

284 
	`rtf
(
dr
, "DNET=%u - it must be 0o 65535\r\n",

285 
Tg_Rour_Nwk
);

289 i(
gc
 > 2) {

290 
	`addss_r
(&
Tg_Rour_Addss
, 
gc
 - 2, &
gv
[2]);

292 
	`dk_g_brd_addss
(&
Tg_Rour_Addss
);

295 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

296 
	`In_Svi_Hdrs
();

297 
	`addss_
();

298 
	`dnv_
();

299 
	`ex
(
dk_nup
);

301 
ϡ_cds
 = 
	`time
(
NULL
);

302 
timeout_cds
 = 
	`du_timeout
() / 1000;

304 
	`Sd_Who_Is_Rour_To_Nwk
(&
Tg_Rour_Addss
,

305 
Tg_Rour_Nwk
);

309 
cut_cds
 = 
	`time
(
NULL
);

311 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

313 i(
pdu_n
) {

314 
	`My_NPDU_Hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

316 i(
E_Deed
)

319 
d_cds
 = 
cut_cds
 - 
ϡ_cds
;

320 i(
d_cds
) {

321 #i
	`defed
(
BACDL_BIP
&& 
BBMD_ENABLED


322 
	`bvlc_man_tim
(
d_cds
);

325 
tٮ_cds
 +
d_cds
;

326 i(
tٮ_cds
 > 
timeout_cds
)

329 
ϡ_cds
 = 
cut_cds
;

333 
	}
}

	@demo/writefile/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<o.h
>

33 
	~"baext.h
"

34 
	~"m.h
"

35 
	~"awf.h
"

36 
	~"tsm.h
"

37 
	~"addss.h
"

38 
	~"cfig.h
"

39 
	~"bacdef.h
"

40 
	~"du.h
"

41 
	~"du.h
"

42 
	~"devi.h
"

43 
	~"t.h
"

44 
	~"dk.h
"

45 
	~"whois.h
"

47 
	~"fame.h
"

48 
	~"hdrs.h
"

49 
	~".h
"

50 
	~"txbuf.h
"

51 
	~"dnv.h
"

54 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

57 
ut32_t
 
	gTg_Fe_Obje_In
 = 4194303;

58 
ut32_t
 
	gTg_Devi_Obje_In
 = 4194303;

59 
ut32_t
 
	gTg_Fe_Requeed_O_Cou
;

60 
ut8_t
 
	gTg_Fe_Requeed_O_Pad_By
;

61 
BACNET_ADDRESS
 
	gTg_Addss
;

62 *
	gLol_Fe_Name
 = 
NULL
;

63 
bo
 
	gEnd_Of_Fe_Deed
 = 
l
;

64 
bo
 
	gE_Deed
 = 
l
;

65 
ut8_t
 
	gCut_Invoke_ID
 = 0;

67 
	$Atomic_Wre_Fe_E_Hdr
(

68 
BACNET_ADDRESS
 * 
c
,

69 
ut8_t
 
voke_id
,

70 
BACNET_ERROR_CLASS
 
r_ass
,

71 
BACNET_ERROR_CODE
 
r_code
)

73 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

74 (
voke_id
 =
Cut_Invoke_ID
)) {

75 
	`tf
("\r\nBACnet Error!\r\n");

76 
	`tf
("E Css: %s\r\n", 
	`baext_r_ass_me
(
r_ass
));

77 
	`tf
("E Code: %s\r\n", 
	`baext_r_code_me
(
r_code
));

78 
E_Deed
 = 
ue
;

80 
	}
}

82 
	$MyAbtHdr
(

83 
BACNET_ADDRESS
 * 
c
,

84 
ut8_t
 
voke_id
,

85 
ut8_t
 
abt_as
,

86 
bo
 
rv
)

88 (
rv
;

89 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

90 (
voke_id
 =
Cut_Invoke_ID
)) {

91 
	`tf
("BACnet Abort: %s\r\n",

92 
	`baext_abt_as_me
((
abt_as
));

93 
E_Deed
 = 
ue
;

95 
	}
}

97 
	$MyRejeHdr
(

98 
BACNET_ADDRESS
 * 
c
,

99 
ut8_t
 
voke_id
,

100 
ut8_t
 
je_as
)

102 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

103 (
voke_id
 =
Cut_Invoke_ID
)) {

104 
	`tf
("BACnet Reject: %s\r\n",

105 
	`baext_je_as_me
((
je_as
));

106 
E_Deed
 = 
ue
;

108 
	}
}

110 
	$LolIAmHdr
(

111 
ut8_t
 * 
rvi_que
,

112 
ut16_t
 
rvi_n
,

113 
BACNET_ADDRESS
 * 
c
)

115 
n
 = 0;

116 
ut32_t
 
devi_id
 = 0;

117 
max_du
 = 0;

118 
gmti
 = 0;

119 
ut16_t
 
vd_id
 = 0;

121 (
c
;

122 (
rvi_n
;

123 
n
 =

124 
	`m_decode_rvi_que
(
rvi_que
, &
devi_id
, &
max_du
,

125 &
gmti
, &
vd_id
);

126 i(
n
 != -1) {

127 
	`addss_add
(
devi_id
, 
max_du
, 
c
);

129 
	`rtf
(
dr
, "!\n");

132 
	}
}

134 
	$In_Svi_Hdrs
(

137 
	`Devi_In
(
NULL
);

140 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

142 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
LolIAmHdr
);

145 
du_t_uecognized_rvi_hdr_hdr


146 (
hdr_uecognized_rvi
);

148 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

149 
hdr_ad_ݔty
);

151 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
,

152 
Atomic_Wre_Fe_E_Hdr
);

153 
	`du_t_abt_hdr
(
MyAbtHdr
);

154 
	`du_t_je_hdr
(
MyRejeHdr
);

155 
	}
}

157 
	$ma
(

158 
gc
,

159 *
gv
[])

161 
BACNET_ADDRESS
 
c
 = {

164 
ut16_t
 
pdu_n
 = 0;

165 
timeout
 = 100;

166 
max_du
 = 0;

167 
time_t
 
d_cds
 = 0;

168 
time_t
 
ϡ_cds
 = 0;

169 
time_t
 
cut_cds
 = 0;

170 
time_t
 
timeout_cds
 = 0;

171 
feSPosi
 = 0;

172 
queedOCou
 = 0;

173 
ut8_t
 
voke_id
 = 0;

174 
bo
 
found
 = 
l
;

175 
ut16_t
 
my_max_du
 = 0;

176 
FILE
 *
pFe
 = 
NULL
;

177 
BACNET_OCTET_STRING
 
feDa
;

178 
size_t
 
n
 = 0;

179 
bo
 
d_by
 = 
l
;

181 i(
gc
 < 4) {

183 
tf


185 
	`fame_move_th
(
gv
[0]));

189 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

190 
Tg_Fe_Obje_In
 = 
	`
(
gv
[2], 
NULL
, 0);

191 
Lol_Fe_Name
 = 
gv
[3];

192 i(
Tg_Devi_Obje_In
 >
BACNET_MAX_INSTANCE
) {

193 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

194 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
);

197 i(
Tg_Fe_Obje_In
 >
BACNET_MAX_INSTANCE
) {

198 
	`rtf
(
dr
, "file-instance=%u - it must beesshan %u\r\n",

199 
Tg_Fe_Obje_In
, 
BACNET_MAX_INSTANCE
 + 1);

202 i(
gc
 > 4) {

203 
Tg_Fe_Requeed_O_Cou
 = 
	`
(
gv
[4], 
NULL
, 0);

205 i(
gc
 > 5) {

206 
Tg_Fe_Requeed_O_Pad_By
 = 
	`
(
gv
[5], 
NULL
, 0);

207 
d_by
 = 
ue
;

210 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

211 
	`addss_
();

212 
	`In_Svi_Hdrs
();

213 
	`dnv_
();

214 
	`ex
(
dk_nup
);

216 
ϡ_cds
 = 
	`time
(
NULL
);

217 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

219 
found
 =

220 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

221 &
Tg_Addss
);

222 i(!
found
) {

223 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

224 
Tg_Devi_Obje_In
);

229 
cut_cds
 = 
	`time
(
NULL
);

232 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

235 i(
pdu_n
) {

236 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

239 i(
cut_cds
 !
ϡ_cds
) {

240 
	`tsm_tim_mlicds
(((
cut_cds
 - 
ϡ_cds
) * 1000));

243 i(!
found
) {

244 
found
 =

245 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

246 &
Tg_Addss
);

248 i(
found
) {

249 i(
Tg_Fe_Requeed_O_Cou
) {

250 
queedOCou
 = 
Tg_Fe_Requeed_O_Cou
;

256 i(
max_du
 < 
MAX_APDU
) {

257 
my_max_du
 = 
max_du
;

259 
my_max_du
 = 
MAX_APDU
;

262 i(
my_max_du
 <= 50) {

263 
queedOCou
 = 
my_max_du
 - 19;

264 } i(
my_max_du
 <= 480) {

265 
queedOCou
 = 
my_max_du
 - 32;

266 } i(
my_max_du
 <= 1476) {

267 
queedOCou
 = 
my_max_du
 - 64;

269 
queedOCou
 = 
my_max_du
 / 2;

274 i((
voke_id
 =0|| 
	`tsm_voke_id_
(invoke_id)) {

275 i(
End_Of_Fe_Deed
 || 
E_Deed
) {

276 
	`tf
("\r\n");

279 i(
voke_id
 != 0) {

280 
feSPosi
 +
queedOCou
;

284 
pFe
 = 
	`fݒ
(
Lol_Fe_Name
, "rb");

285 i(
pFe
) {

286 (
	`fek
(
pFe
, 
feSPosi
, 
SEEK_SET
);

287 
n
 =

288 
	`d
(
	`org_vue
(&
feDa
), 1,

289 
queedOCou
, 
pFe
);

290 i(
n
 < 
queedOCou
) {

291 
End_Of_Fe_Deed
 = 
ue
;

292 i(
d_by
) {

293 
	`memt
(
	`org_vue
(&
feDa
+ 
n
 + 1,

294 (
Tg_Fe_Requeed_O_Pad_By
,

295 
queedOCou
 - 
n
);

296 
n
 = 
queedOCou
;

299 
	`org_un
(&
feDa
, 
n
);

300 
	`fo
(
pFe
);

302 
End_Of_Fe_Deed
 = 
ue
;

304 
	`tf
("\rSdg %d bys", ()(
feSPosi
 + 
n
));

305 
voke_id
 =

306 
Sd_Atomic_Wre_Fe_Sm


307 (
Tg_Devi_Obje_In
,

308 
Tg_Fe_Obje_In
, 
feSPosi
, &
feDa
);

309 
Cut_Invoke_ID
 = 
voke_id
;

310 } i(
	`tsm_voke_id_ed
(
voke_id
)) {

311 
	`rtf
(
dr
, "\rError: TSM Timeout!\r\n");

312 
	`tsm__voke_id
(
voke_id
);

313 
E_Deed
 = 
ue
;

319 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

320 i(
d_cds
 > 
timeout_cds
) {

321 
	`rtf
(
dr
, "\rError: APDU Timeout!\r\n");

322 
E_Deed
 = 
ue
;

327 
ϡ_cds
 = 
cut_cds
;

330 i(
E_Deed
) {

334 
	}
}

	@demo/writeprop/main.c

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dio.h
>

30 
	~<dlib.h
>

31 
	~<time.h
>

32 
	~<rg.h
>

33 
	~<o.h
>

34 
	~<y.h
>

35 
	~"baext.h
"

36 
	~"m.h
"

37 
	~"f.h
"

38 
	~"tsm.h
"

39 
	~"addss.h
"

40 
	~"cfig.h
"

41 
	~"bacdef.h
"

42 
	~"du.h
"

43 
	~"du.h
"

44 
	~"devi.h
"

45 
	~"t.h
"

46 
	~"dk.h
"

47 
	~"whois.h
"

49 
	~"fame.h
"

50 
	~"hdrs.h
"

51 
	~".h
"

52 
	~"txbuf.h
"

53 
	~"dnv.h
"

55 #ide
MAX_PROPERTY_VALUES


56 
	#MAX_PROPERTY_VALUES
 64

	)

60 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

63 
ut32_t
 
	gTg_Devi_Obje_In
 = 
BACNET_MAX_INSTANCE
;

64 
ut32_t
 
	gTg_Obje_In
 = 
BACNET_MAX_INSTANCE
;

65 
BACNET_OBJECT_TYPE
 
	gTg_Obje_Ty
 = 
OBJECT_ANALOG_INPUT
;

66 
BACNET_PROPERTY_ID
 
	gTg_Obje_Prݔty
 = 
PROP_ACKED_TRANSITIONS
;

68 
t32_t
 
	gTg_Obje_Prݔty_Index
 = 
BACNET_ARRAY_ALL
;

69 
BACNET_APPLICATION_DATA_VALUE


70 
	gTg_Obje_Prݔty_Vue
[
MAX_PROPERTY_VALUES
];

73 
ut8_t
 
	gTg_Obje_Prݔty_Priܙy
 = 0;

76 
ut8_t
 
	gReque_Invoke_ID
 = 0;

77 
BACNET_ADDRESS
 
	gTg_Addss
;

79 
bo
 
	gE_Deed
 = 
l
;

81 
	$MyEHdr
(

82 
BACNET_ADDRESS
 * 
c
,

83 
ut8_t
 
voke_id
,

84 
BACNET_ERROR_CLASS
 
r_ass
,

85 
BACNET_ERROR_CODE
 
r_code
)

87 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

88 (
voke_id
 =
Reque_Invoke_ID
)) {

89 
	`tf
("BACnet Error: %s: %s\r\n",

90 
	`baext_r_ass_me
((
r_ass
),

91 
	`baext_r_code_me
((
r_code
));

92 
E_Deed
 = 
ue
;

94 
	}
}

96 
	$MyAbtHdr
(

97 
BACNET_ADDRESS
 * 
c
,

98 
ut8_t
 
voke_id
,

99 
ut8_t
 
abt_as
,

100 
bo
 
rv
)

102 (
rv
;

103 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

104 (
voke_id
 =
Reque_Invoke_ID
)) {

105 
	`tf
("BACnet Abort: %s\r\n",

106 
	`baext_abt_as_me
((
abt_as
));

107 
E_Deed
 = 
ue
;

109 
	}
}

111 
	$MyRejeHdr
(

112 
BACNET_ADDRESS
 * 
c
,

113 
ut8_t
 
voke_id
,

114 
ut8_t
 
je_as
)

116 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

117 (
voke_id
 =
Reque_Invoke_ID
)) {

118 
	`tf
("BACnet Reject: %s\r\n",

119 
	`baext_je_as_me
((
je_as
));

120 
E_Deed
 = 
ue
;

122 
	}
}

124 
	$MyWrePrݔtySimeAckHdr
(

125 
BACNET_ADDRESS
 * 
c
,

126 
ut8_t
 
voke_id
)

128 i(
	`addss_mch
(&
Tg_Addss
, 
c
) &&

129 (
voke_id
 =
Reque_Invoke_ID
)) {

130 
	`tf
("\r\nWriteProperty Acknowledged!\r\n");

132 
	}
}

134 
	$In_Svi_Hdrs
(

137 
	`Devi_In
(
NULL
);

140 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

142 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
hdr_i_am_bd
);

145 
du_t_uecognized_rvi_hdr_hdr


146 (
hdr_uecognized_rvi
);

148 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

149 
hdr_ad_ݔty
);

151 
	`du_t_cfmed_sime_ack_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

152 
MyWrePrݔtySimeAckHdr
);

154 
	`du_t_r_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
, 
MyEHdr
);

155 
	`du_t_abt_hdr
(
MyAbtHdr
);

156 
	`du_t_je_hdr
(
MyRejeHdr
);

157 
	}
}

159 
	$ma
(

160 
gc
,

161 *
gv
[])

163 
BACNET_ADDRESS
 
c
 = {

166 
ut16_t
 
pdu_n
 = 0;

167 
timeout
 = 100;

168 
max_du
 = 0;

169 
time_t
 
d_cds
 = 0;

170 
time_t
 
ϡ_cds
 = 0;

171 
time_t
 
cut_cds
 = 0;

172 
time_t
 
timeout_cds
 = 0;

173 
bo
 
found
 = 
l
;

174 *
vue_rg
 = 
NULL
;

175 
bo
 
us
 = 
l
;

176 
gs_mag
 = 0, 
g_vue_g
 = 0, 
i
 = 0;

177 
BACNET_APPLICATION_TAG
 
ݔty_g
;

178 
ut8_t
 
cڋxt_g
 = 0;

180 i(
gc
 < 9) {

182 
	`tf
("Usage: %s device-instance object-type object-instance "

184 
	`fame_move_th
(
gv
[0]));

185 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

186 
	`tf
("device-instance:\r\n"

240 "%123 1 0 85 16 -1 0 0\r\n", 
	`fame_move_th
(
gv
[0]),

241 
	`fame_move_th
(
gv
[0]));

246 
Tg_Devi_Obje_In
 = 
	`
(
gv
[1], 
NULL
, 0);

247 
Tg_Obje_Ty
 = 
	`
(
gv
[2], 
NULL
, 0);

248 
Tg_Obje_In
 = 
	`
(
gv
[3], 
NULL
, 0);

249 
Tg_Obje_Prݔty
 = 
	`
(
gv
[4], 
NULL
, 0);

250 
Tg_Obje_Prݔty_Priܙy
 = (
ut8_t

	`
(
gv
[5], 
NULL
, 0);

251 
Tg_Obje_Prݔty_Index
 = 
	`
(
gv
[6], 
NULL
, 0);

252 i(
Tg_Obje_Prݔty_Index
 == -1)

253 
Tg_Obje_Prݔty_Index
 = 
BACNET_ARRAY_ALL
;

254 i(
Tg_Devi_Obje_In
 > 
BACNET_MAX_INSTANCE
) {

255 
	`rtf
(
dr
, "device-instance=%u - it must beesshan %u\r\n",

256 
Tg_Devi_Obje_In
, 
BACNET_MAX_INSTANCE
 + 1);

259 i(
Tg_Obje_Ty
 > 
MAX_BACNET_OBJECT_TYPE
) {

260 
	`rtf
(
dr
, "object-type=%u - it must beesshan %u\r\n",

261 
Tg_Obje_Ty
, 
MAX_BACNET_OBJECT_TYPE
 + 1);

264 i(
Tg_Obje_In
 > 
BACNET_MAX_INSTANCE
) {

265 
	`rtf
(
dr
, "object-instance=%u - it must beesshan %u\r\n",

266 
Tg_Obje_In
, 
BACNET_MAX_INSTANCE
 + 1);

269 i(
Tg_Obje_Prݔty
 > 
MAX_BACNET_PROPERTY_ID
) {

270 
	`rtf
(
dr
, "property=%u - it must beesshan %u\r\n",

271 
Tg_Obje_Prݔty
, 
MAX_BACNET_PROPERTY_ID
 + 1);

274 
gs_mag
 = (
gc
 - 7);

276 
g_vue_g
 = 7;

277 
i
 = 0; i < 
MAX_PROPERTY_VALUES
; i++) {

279 i(
	`tou
(
gv
[
g_vue_g
][0]) == 'C') {

280 
cڋxt_g
 = (
ut8_t

	`
(&
gv
[
g_vue_g
][1], 
NULL
, 0);

281 
g_vue_g
++;

282 
gs_mag
--;

283 
Tg_Obje_Prݔty_Vue
[
i
].
cڋxt_g
 = context_tag;

284 
Tg_Obje_Prݔty_Vue
[
i
].
cڋxt_ecific
 = 
ue
;

286 
Tg_Obje_Prݔty_Vue
[
i
].
cڋxt_ecific
 = 
l
;

288 
ݔty_g
 = 
	`
(
gv
[
g_vue_g
], 
NULL
, 0);

289 
g_vue_g
++;

290 
gs_mag
--;

291 i(
gs_mag
 <= 0) {

292 
	`rtf
(
dr
, "Error:otnoughag-valueairs\r\n");

295 
vue_rg
 = 
gv
[
g_vue_g
];

296 
g_vue_g
++;

297 
gs_mag
--;

300 i(
ݔty_g
 >
MAX_BACNET_APPLICATION_TAG
) {

301 
	`rtf
(
dr
, "Error:ag=%u - it must beesshan %u\r\n",

302 
ݔty_g
, 
MAX_BACNET_APPLICATION_TAG
);

305 
us
 =

306 
	`ba_r_iti_da
(
ݔty_g
, 
vue_rg
,

307 &
Tg_Obje_Prݔty_Vue
[
i
]);

308 i(!
us
) {

310 
	`rtf
(
dr
, "Error: unableoarseheag value\r\n");

313 
Tg_Obje_Prݔty_Vue
[
i
].
xt
 = 
NULL
;

314 i(
i
 > 0) {

315 
Tg_Obje_Prݔty_Vue
[
i
 - 1].
xt
 =

316 &
Tg_Obje_Prݔty_Vue
[
i
];

318 i(
gs_mag
 <= 0) {

322 i(
gs_mag
 > 0) {

323 
	`rtf
(
dr
, "Error: Exceeded %dag-valueairs.\r\n",

324 
MAX_PROPERTY_VALUES
);

328 
	`Devi_S_Obje_In_Numb
(
BACNET_MAX_INSTANCE
);

329 
	`addss_
();

330 
	`In_Svi_Hdrs
();

331 
	`dnv_
();

332 
	`ex
(
dk_nup
);

334 
ϡ_cds
 = 
	`time
(
NULL
);

335 
timeout_cds
 = (
	`du_timeout
(/ 1000* 
	`du_s
();

337 
found
 =

338 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

339 &
Tg_Addss
);

340 i(!
found
) {

341 
	`Sd_WhoIs
(
Tg_Devi_Obje_In
,

342 
Tg_Devi_Obje_In
);

347 
cut_cds
 = 
	`time
(
NULL
);

350 i(
cut_cds
 !
ϡ_cds
)

351 
	`tsm_tim_mlicds
((
ut16_t
((
cut_cds
 -

352 
ϡ_cds
) * 1000));

353 i(
E_Deed
)

356 i(!
found
) {

357 
found
 =

358 
	`addss_bd_que
(
Tg_Devi_Obje_In
, &
max_du
,

359 &
Tg_Addss
);

361 i(
found
) {

362 i(
Reque_Invoke_ID
 == 0) {

363 
Reque_Invoke_ID
 =

364 
	`Sd_Wre_Prݔty_Reque
(
Tg_Devi_Obje_In
,

365 
Tg_Obje_Ty
, 
Tg_Obje_In
,

366 
Tg_Obje_Prݔty
, &
Tg_Obje_Prݔty_Vue
[0],

367 
Tg_Obje_Prݔty_Priܙy
,

368 
Tg_Obje_Prݔty_Index
);

369 } i(
	`tsm_voke_id_
(
Reque_Invoke_ID
))

371 i(
	`tsm_voke_id_ed
(
Reque_Invoke_ID
)) {

372 
	`rtf
(
dr
, "\rError: TSM Timeout!\r\n");

373 
	`tsm__voke_id
(
Reque_Invoke_ID
);

374 
E_Deed
 = 
ue
;

380 
d_cds
 +(
cut_cds
 - 
ϡ_cds
);

381 i(
d_cds
 > 
timeout_cds
) {

382 
E_Deed
 = 
ue
;

383 
	`tf
("\rError: APDU Timeout!\r\n");

389 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

392 i(
pdu_n
) {

393 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

397 
ϡ_cds
 = 
cut_cds
;

399 i(
E_Deed
)

402 
	}
}

	@include/abort.h

24 #ide
ABORT_H


25 
	#ABORT_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

30 #ifde
__lulus


34 
BACNET_ABORT_REASON
 
abt_cvt_r_code
(

35 
BACNET_ERROR_CODE
 
r_code
);

37 
abt_code_du
(

38 
ut8_t
 * 
du
,

39 
ut8_t
 
voke_id
,

40 
ut8_t
 
abt_as
,

41 
bo
 
rv
);

43 
abt_decode_rvi_que
(

44 
ut8_t
 * 
du
,

45 
du_n
,

46 
ut8_t
 * 
voke_id
,

47 
ut8_t
 * 
abt_as
);

49 #ifde
TEST


50 
	~"e.h
"

51 
abt_decode_du
(

52 
ut8_t
 * 
du
,

53 
du_n
,

54 
ut8_t
 * 
voke_id
,

55 
ut8_t
 * 
abt_as
,

56 
bo
 * 
rv
);

58 
Abt
(

59 
Te
 * 
pTe
);

62 #ifde
__lulus


	@include/address.h

24 #ide
ADDRESS_H


25 
	#ADDRESS_H


	)

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dbo.h
>

30 
	~"bacdef.h
"

31 
	~"adnge.h
"

33 #ifde
__lulus


37 
addss_
(

40 
addss__l
(

43 
addss_add
(

44 
ut32_t
 
devi_id
,

45 
max_du
,

46 
BACNET_ADDRESS
 * 
c
);

48 
addss_move_devi
(

49 
ut32_t
 
devi_id
);

51 
bo
 
addss_g_by_devi
(

52 
ut32_t
 
devi_id
,

53 *
max_du
,

54 
BACNET_ADDRESS
 * 
c
);

56 
bo
 
addss_g_by_dex
(

57 
dex
,

58 
ut32_t
 * 
devi_id
,

59 *
max_du
,

60 
BACNET_ADDRESS
 * 
c
);

62 
bo
 
addss_devi_g_by_dex
(

63 
dex
,

64 
ut32_t
 * 
devi_id
,

65 
ut32_t
 * 
devi_l
,

66 *
max_du
,

67 
BACNET_ADDRESS
 * 
c
);

69 
bo
 
addss_g_devi_id
(

70 
BACNET_ADDRESS
 * 
c
,

71 
ut32_t
 * 
devi_id
);

73 
addss_cou
(

76 
bo
 
addss_mch
(

77 
BACNET_ADDRESS
 * 
de
,

78 
BACNET_ADDRESS
 * 
c
);

80 
bo
 
addss_bd_que
(

81 
ut32_t
 
devi_id
,

82 *
max_du
,

83 
BACNET_ADDRESS
 * 
c
);

85 
bo
 
addss_devi_bd_que
(

86 
ut32_t
 
devi_id
,

87 
ut32_t
 * 
devi_l
,

88 *
max_du
,

89 
BACNET_ADDRESS
 * 
c
);

91 
addss_add_bdg
(

92 
ut32_t
 
devi_id
,

93 
max_du
,

94 
BACNET_ADDRESS
 * 
c
);

96 
addss_li_code
(

97 
ut8_t
 * 
du
,

98 
du_n
);

100 
_addss_li_code
(

101 
ut8_t
 * 
du
,

102 
BACNET_READ_RANGE_DATA
 * 
pReque
);

104 
addss_t_devi_TTL
(

105 
ut32_t
 
devi_id
,

106 
ut32_t
 
TimeOut
,

107 
bo
 
SticFg
);

109 
addss_che_tim
(

110 
ut16_t
 
uSecds
);

112 
addss_eed_y_dex_t
(
ut32_t
 
t_eed_y_dex
);

113 
addss_own_devi_id_t
(
ut32_t
 
own_id
);

115 #ifde
__lulus


	@include/alarm_ack.h

24 #ide
ALARM_ACK_H_


25 
	#ALARM_ACK_H_


	)

27 
	~"banum.h
"

28 
	~<dt.h
>

29 
	~<dbo.h
>

30 
	~"ba.h
"

31 
	~"timeamp.h
"

34 
ut32_t
 
	mackProssIdtifr
;

35 
BACNET_OBJECT_ID
 
	mevtObjeIdtifr
;

36 
BACNET_EVENT_STATE
 
	mevtSAcked
;

37 
BACNET_TIMESTAMP
 
	mevtTimeSmp
;

38 
BACNET_CHARACTER_STRING
 
	mackSour
;

39 
BACNET_TIMESTAMP
 
	mackTimeSmp
;

40 } 
	tBACNET_ALARM_ACK_DATA
;

46 *
	tm_ack_funi
) (

47 
	tBACNET_ALARM_ACK_DATA
 * 
	tmack_da
,

48 
	tBACNET_ERROR_CODE
 * 
	tr_code
);

50 #ifde
__lulus


59 
	`m_ack_code_du
(

60 
ut8_t
 * 
du
,

61 
ut8_t
 
voke_id
,

62 
BACNET_ALARM_ACK_DATA
 * 
da
);

69 
	`m_ack_code_rvi_que
(

70 
ut8_t
 * 
du
,

71 
BACNET_ALARM_ACK_DATA
 * 
da
);

78 
	`m_ack_decode_rvi_que
(

79 
ut8_t
 * 
du
,

80 
du_n
,

81 
BACNET_ALARM_ACK_DATA
 * 
da
);

83 #ifde
__lulus


84 
	}
}

	@include/apdu.h

24 #ide
APDU_H


25 
	#APDU_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~"bacdef.h
"

30 
	~"banum.h
"

32 
	s_cfmed_rvi_da
 {

33 
bo
 
	mgmd_mesge
;

34 
bo
 
	mme_flows
;

35 
bo
 
	mgmd_ڣ_aced
;

36 
	mmax_gs
;

37 
	mmax_
;

38 
ut8_t
 
	mvoke_id
;

39 
ut8_t
 
	mqu_numb
;

40 
ut8_t
 
	mod_wdow_numb
;

41 } 
	tBACNET_CONFIRMED_SERVICE_DATA
;

43 
	s_cfmed_rvi_ack_da
 {

44 
bo
 
	mgmd_mesge
;

45 
bo
 
	mme_flows
;

46 
ut8_t
 
	mvoke_id
;

47 
ut8_t
 
	mqu_numb
;

48 
ut8_t
 
	mod_wdow_numb
;

49 } 
	tBACNET_CONFIRMED_SERVICE_ACK_DATA
;

51 #ifde
__lulus


62 *
uncfmed_funi
) (

63 
	tut8_t
 * 
	trvi_que
,

64 
	tut16_t
 
	tn
,

65 
	tBACNET_ADDRESS
 * 
	tc
);

84 *
cfmed_funi
) (

85 
	tut8_t
 * 
	trvi_que
,

86 
	tut16_t
 
	trvi_n
,

87 
	tBACNET_ADDRESS
 * 
	tc
,

88 
	tBACNET_CONFIRMED_SERVICE_DATA
 * 
	trvi_da
);

92 *
cfmed_sime_ack_funi
) (

93 
	tBACNET_ADDRESS
 * 
	tc
,

94 
	tut8_t
 
	tvoke_id
);

98 *
cfmed_ack_funi
) (

99 
	tut8_t
 * 
	trvi_que
,

100 
	tut16_t
 
	trvi_n
,

101 
	tBACNET_ADDRESS
 * 
	tc
,

102 
	tBACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
	trvi_da
);

106 *
r_funi
) (

107 
	tBACNET_ADDRESS
 * 
	tc
,

108 
	tut8_t
 
	tvoke_id
,

109 
	tBACNET_ERROR_CLASS
 
	tr_ass
,

110 
	tBACNET_ERROR_CODE
 
	tr_code
);

114 *
abt_funi
) (

115 
	tBACNET_ADDRESS
 * 
	tc
,

116 
	tut8_t
 
	tvoke_id
,

117 
	tut8_t
 
	tabt_as
,

118 
	tbo
 
	trv
);

122 *
je_funi
) (

123 
	tBACNET_ADDRESS
 * 
	tc
,

124 
	tut8_t
 
	tvoke_id
,

125 
	tut8_t
 
	tje_as
);

127 
du_t_cfmed_ack_hdr
(

128 
BACNET_CONFIRMED_SERVICE
 
rvi_choi
,

129 
cfmed_ack_funi
 
pFuni
);

131 
du_t_cfmed_sime_ack_hdr
(

132 
BACNET_CONFIRMED_SERVICE
 
rvi_choi
,

133 
cfmed_sime_ack_funi
 
pFuni
);

136 
du_t_uecognized_rvi_hdr_hdr
(

137 
cfmed_funi
 
pFuni
);

139 
du_t_cfmed_hdr
(

140 
BACNET_CONFIRMED_SERVICE
 
rvi_choi
,

141 
cfmed_funi
 
pFuni
);

143 
du_t_uncfmed_hdr
(

144 
BACNET_UNCONFIRMED_SERVICE
 
rvi_choi
,

145 
uncfmed_funi
 
pFuni
);

148 
bo
 
du_rvi_su܋d
(

149 
BACNET_SERVICES_SUPPORTED
 
rvi_su܋d
);

154 
bo
 
du_rvi_su܋d_to_dex
(

155 
BACNET_SERVICES_SUPPORTED
 
rvi_su܋d
,

156 
size_t
 * 
dex
,

157 
bo
 * 
bIsCfmed
);

160 
du_t_r_hdr
(

161 
BACNET_CONFIRMED_SERVICE
 
rvi_choi
,

162 
r_funi
 
pFuni
);

164 
du_t_abt_hdr
(

165 
abt_funi
 
pFuni
);

167 
du_t_je_hdr
(

168 
je_funi
 
pFuni
);

170 
ut16_t
 
du_decode_cfmed_rvi_que
(

171 
ut8_t
 * 
du
,

172 
ut16_t
 
du_n
,

173 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
,

174 
ut8_t
 * 
rvi_choi
,

175 
ut8_t
 ** 
rvi_que
,

176 
ut16_t
 * 
rvi_que_n
);

178 
ut16_t
 
du_timeout
(

180 
du_timeout_t
(

181 
ut16_t
 
vue
);

182 
ut8_t
 
du_s
(

184 
du_s_t
(

185 
ut8_t
 
vue
);

187 
du_hdr
(

188 
BACNET_ADDRESS
 * 
c
,

189 
ut8_t
 * 
du
,

190 
ut16_t
 
pdu_n
);

192 #ifde
__lulus


	@include/arcnet.h

24 #ide
ARCNET_H


25 
	#ARCNET_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<ddef.h
>

30 
	~"bacdef.h
"

31 
	~"du.h
"

34 
	#MAX_HEADER
 (1+1+2+2+1+1+1+1)

	)

35 
	#MAX_MPDU
 (
MAX_HEADER
+
MAX_PDU
)

	)

37 #ifde
__lulus


41 
bo
 
_vid
(

43 
_nup
(

45 
bo
 
_
(

46 *
r_me
);

50 
_nd_pdu
(

51 
BACNET_ADDRESS
 * 
de
,

52 
BACNET_NPDU_DATA
 * 
du_da
,

53 
ut8_t
 * 
pdu
,

54 
pdu_n
);

58 
ut16_t
 
_ive
(

59 
BACNET_ADDRESS
 * 
c
,

60 
ut8_t
 * 
pdu
,

61 
ut16_t
 
max_pdu
,

62 
timeout
);

64 
_g_my_addss
(

65 
BACNET_ADDRESS
 * 
my_addss
);

66 
_g_brd_addss
(

67 
BACNET_ADDRESS
 * 
de
);

69 #ifde
__lulus


	@include/arf.h

24 #ide
ATOMIC_READ_FILE_H


25 
	#ATOMIC_READ_FILE_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacdcode.h
"

30 
	~"bacr.h
"

32 
	sBACt_Atomic_Rd_Fe_Da
 {

33 
BACNET_OBJECT_TYPE
 
	mobje_ty
;

34 
ut32_t
 
	mobje_
;

35 
BACNET_FILE_ACCESS_METHOD
 
	macss
;

38 
t32_t
 
	mfeSPosi
;

39 
ut32_t
 
	mqueedOCou
;

40 } 
	mam
;

42 
t32_t
 
	mfeSRecd
;

44 
ut32_t
 
	mRecdCou
;

45 } 
	mcd
;

46 } 
	mty
;

47 
BACNET_OCTET_STRING
 
	mfeDa
;

48 
bo
 
	mdOfFe
;

49 } 
	tBACNET_ATOMIC_READ_FILE_DATA
;

51 #ifde
__lulus


57 
f_code_du
(

58 
ut8_t
 * 
du
,

59 
ut8_t
 
voke_id
,

60 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
);

63 
f_decode_rvi_que
(

64 
ut8_t
 * 
du
,

65 
du_n
,

66 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
);

68 
f_decode_du
(

69 
ut8_t
 * 
du
,

70 
du_n
,

71 
ut8_t
 * 
voke_id
,

72 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
);

77 
f_ack_code_du
(

78 
ut8_t
 * 
du
,

79 
ut8_t
 
voke_id
,

80 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
);

83 
f_ack_decode_rvi_que
(

84 
ut8_t
 * 
du
,

85 
du_n
,

86 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
);

88 
f_ack_decode_du
(

89 
ut8_t
 * 
du
,

90 
du_n
,

91 
ut8_t
 * 
voke_id
,

92 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
);

94 #ifde
TEST


95 
	~"e.h
"

97 
_AtomicRdFe
(

98 
Te
 * 
pTe
);

99 
_AtomicRdFeAck
(

100 
Te
 * 
pTe
);

103 #ifde
__lulus


	@include/awf.h

24 #ide
ATOMIC_WRITE_FILE_H


25 
	#ATOMIC_WRITE_FILE_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacdcode.h
"

31 
	sBACt_Atomic_Wre_Fe_Da
 {

32 
BACNET_OBJECT_TYPE
 
	mobje_ty
;

33 
ut32_t
 
	mobje_
;

34 
BACNET_FILE_ACCESS_METHOD
 
	macss
;

37 
t32_t
 
	mfeSPosi
;

38 } 
	mam
;

40 
t32_t
 
	mfeSRecd
;

41 
ut32_t
 
	mtuedRecdCou
;

42 } 
	mcd
;

43 } 
	mty
;

44 
BACNET_OCTET_STRING
 
	mfeDa
;

45 } 
	tBACNET_ATOMIC_WRITE_FILE_DATA
;

47 #ifde
__lulus


53 
awf_code_du
(

54 
ut8_t
 * 
du
,

55 
ut8_t
 
voke_id
,

56 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
);

59 
awf_decode_rvi_que
(

60 
ut8_t
 * 
du
,

61 
du_n
,

62 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
);

64 
awf_decode_du
(

65 
ut8_t
 * 
du
,

66 
du_n
,

67 
ut8_t
 * 
voke_id
,

68 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
);

72 
awf_ack_code_du
(

73 
ut8_t
 * 
du
,

74 
ut8_t
 
voke_id
,

75 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
);

78 
awf_ack_decode_rvi_que
(

79 
ut8_t
 * 
du
,

80 
du_n
,

81 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
);

83 
awf_ack_decode_du
(

84 
ut8_t
 * 
du
,

85 
du_n
,

86 
ut8_t
 * 
voke_id
,

87 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
);

89 #ifde
TEST


90 
	~"e.h
"

92 
_AtomicWreFe
(

93 
Te
 * 
pTe
);

94 
_AtomicWreFeAck
(

95 
Te
 * 
pTe
);

98 #ifde
__lulus


	@include/bacaddr.h

24 #ide
BACADDR_H


25 
	#BACADDR_H


	)

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dbo.h
>

30 
	~"bacdef.h
"

32 #ifde
__lulus


36 
ba_addss_cy
(

37 
BACNET_ADDRESS
 * 
de
,

38 
BACNET_ADDRESS
 * 
c
);

39 
bo
 
ba_addss_me
(

40 
BACNET_ADDRESS
 * 
de
,

41 
BACNET_ADDRESS
 * 
c
);

43 #ifde
__lulus


	@include/bacapp.h

24 #ide
BACAPP_H


25 
	#BACAPP_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~<dio.h
>

30 
	~"bacdef.h
"

31 
	~"bacr.h
"

32 
	~"dime.h
"

33 #i
defed
 (
BACAPP_LIGHTING_COMMAND
)

34 
	~"lightg.h
"

36 #i
defed
 (
BACAPP_DEVICE_OBJECT_PROP_REF
)

37 
	~"bacdevobjݻf.h
"

40 
	gBACt_Aliti_Da_Vue
;

41 
	sBACt_Aliti_Da_Vue
 {

42 
bo
 
	mcڋxt_ecific
;

43 
ut8_t
 
	mcڋxt_g
;

44 
ut8_t
 
	mg
;

47 #i
defed
 (
BACAPP_BOOLEAN
)

48 
bo
 
	mBoޗn
;

50 #i
defed
 (
BACAPP_UNSIGNED
)

51 
ut32_t
 
	mUnsigd_I
;

53 #i
defed
 (
BACAPP_SIGNED
)

54 
t32_t
 
	mSigd_I
;

56 #i
defed
 (
BACAPP_REAL
)

57 
	mRl
;

59 #i
defed
 (
BACAPP_DOUBLE
)

60 
	mDoub
;

62 #i
defed
 (
BACAPP_OCTET_STRING
)

63 
BACNET_OCTET_STRING
 
	mO_Sg
;

65 #i
defed
 (
BACAPP_CHARACTER_STRING
)

66 
BACNET_CHARACTER_STRING
 
	mCha_Sg
;

68 #i
defed
 (
BACAPP_BIT_STRING
)

69 
BACNET_BIT_STRING
 
	mB_Sg
;

71 #i
defed
 (
BACAPP_ENUMERATED
)

72 
ut32_t
 
	mEnumed
;

74 #i
defed
 (
BACAPP_DATE
)

75 
BACNET_DATE
 
	mDe
;

77 #i
defed
 (
BACAPP_TIME
)

78 
BACNET_TIME
 
	mTime
;

80 #i
defed
 (
BACAPP_OBJECT_ID
)

81 
BACNET_OBJECT_ID
 
	mObje_Id
;

83 #i
defed
 (
BACAPP_LIGHTING_COMMAND
)

84 
BACNET_LIGHTING_COMMAND
 
	mLightg_Commd
;

86 #i
defed
 (
BACAPP_DEVICE_OBJECT_PROP_REF
)

87 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE


88 
	mDevi_Obje_Prݔty_Ren
;

90 } 
	mty
;

92 
BACt_Aliti_Da_Vue
 *
	mxt
;

93 } 
	tBACNET_APPLICATION_DATA_VALUE
;

95 
	gBACt_Acss_E
;

96 
	sBACt_Acss_E
 {

97 
BACNET_ERROR_CLASS
 
	mr_ass
;

98 
BACNET_ERROR_CODE
 
	mr_code
;

99 } 
	tBACNET_ACCESS_ERROR
;

101 
	gBACt_Prݔty_Ren
;

102 
	sBACt_Prݔty_Ren
 {

103 
BACNET_PROPERTY_ID
 
	mݔtyIdtifr
;

104 
ut32_t
 
	mݔtyAayIndex
;

107 
BACNET_APPLICATION_DATA_VALUE
 *
	mvue
;

108 
BACNET_ACCESS_ERROR
 
	mr
;

110 
BACt_Prݔty_Ren
 *
	mxt
;

111 } 
	tBACNET_PROPERTY_REFERENCE
;

113 
	gBACt_Prݔty_Vue
;

114 
	sBACt_Prݔty_Vue
 {

115 
BACNET_PROPERTY_ID
 
	mݔtyIdtifr
;

116 
ut32_t
 
	mݔtyAayIndex
;

117 
BACNET_APPLICATION_DATA_VALUE
 
	mvue
;

118 
ut8_t
 
	miܙy
;

120 
BACt_Prݔty_Vue
 *
	mxt
;

121 } 
	tBACNET_PROPERTY_VALUE
;

124 
	gBACt_Obje_Prݔty_Vue
;

125 
	sBACt_Obje_Prݔty_Vue
 {

126 
BACNET_OBJECT_TYPE
 
	mobje_ty
;

127 
ut32_t
 
	mobje_
;

128 
BACNET_PROPERTY_ID
 
	mobje_ݔty
;

129 
ut32_t
 
	my_dex
;

130 
BACNET_APPLICATION_DATA_VALUE
 *
	mvue
;

131 } 
	tBACNET_OBJECT_PROPERTY_VALUE
;

133 #ifde
__lulus


136 
ba_code_da
(

137 
ut8_t
 * 
du
,

138 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
);

139 
ba_decode_da
(

140 
ut8_t
 * 
du
,

141 
ut8_t
 
g_da_ty
,

142 
ut32_t
 
n_vue_ty
,

143 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
);

145 
ba_decode_iti_da
(

146 
ut8_t
 * 
du
,

147 
max_du_n
,

148 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
);

150 
bo
 
ba_decode_iti_da_
(

151 
ut8_t
 * 
w_du
,

152 
ut32_t
 
w_du_n
,

153 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
);

155 
ba_code_iti_da
(

156 
ut8_t
 * 
du
,

157 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
);

159 
ba_decode_cڋxt_da
(

160 
ut8_t
 * 
du
,

161 
max_du_n
,

162 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
,

163 
BACNET_PROPERTY_ID
 
ݔty
);

165 
ba_code_cڋxt_da
(

166 
ut8_t
 * 
du
,

167 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
,

168 
BACNET_PROPERTY_ID
 
ݔty
);

170 
ba_code_cڋxt_da_vue
(

171 
ut8_t
 * 
du
,

172 
ut8_t
 
cڋxt_g_numb
,

173 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
);

175 
BACNET_APPLICATION_TAG
 
ba_cڋxt_g_ty
(

176 
BACNET_PROPERTY_ID
 
ݔty
,

177 
ut8_t
 
g_numb
);

179 
bo
 
ba_cy
(

180 
BACNET_APPLICATION_DATA_VALUE
 * 
de_vue
,

181 
BACNET_APPLICATION_DATA_VALUE
 * 
c_vue
);

187 
ba_da_n
(

188 
ut8_t
 * 
du
,

189 
max_du_n
,

190 
BACNET_PROPERTY_ID
 
ݔty
);

191 
ba_decode_da_n
(

192 
ut8_t
 * 
du
,

193 
ut8_t
 
g_da_ty
,

194 
ut32_t
 
n_vue_ty
);

195 
ba_decode_iti_da_n
(

196 
ut8_t
 * 
du
,

197 
max_du_n
);

198 
ba_decode_cڋxt_da_n
(

199 
ut8_t
 * 
du
,

200 
max_du_n
,

201 
BACNET_PROPERTY_ID
 
ݔty
);

203 #ide
BACAPP_PRINT_ENABLED


204 #i
PRINT_ENABLED
 || 
defed
 
TEST


205 
	#BACAPP_PRINT_ENABLED


	)

206 
	#BACAPP_SNPRINTF_ENABLED


	)

210 #ifde
BACAPP_SNPRINTF_ENABLED


211 
ba_tf_vue
(

212 *
r
,

213 
size_t
 
r_n
,

214 
BACNET_OBJECT_PROPERTY_VALUE
 * 
obje_vue
);

217 #ifde
BACAPP_PRINT_ENABLED


218 
bo
 
ba_r_iti_da
(

219 
BACNET_APPLICATION_TAG
 
g_numb
,

220 cڡ *
gv
,

221 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
);

222 
bo
 
ba_t_vue
(

223 
FILE
 * 
am
,

224 
BACNET_OBJECT_PROPERTY_VALUE
 * 
vue
);

227 
	#ba_r_iti_da
(
x
,
y
,
z

l


	)

228 
	#ba_t_vue
(
x
,
y

l


	)

231 #ifde
TEST


232 
	~"e.h
"

233 
	~"dime.h
"

234 
bo
 
ba_me_vue
(

235 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
,

236 
BACNET_APPLICATION_DATA_VALUE
 * 
_vue
);

238 
BACtAlitiDaLgth
(

239 
Te
 * 
pTe
);

240 
BACtAlitiDa
(

241 
Te
 * 
pTe
);

244 #ifde
__lulus


	@include/bacdcode.h

24 #ide
BACDCODE_H


25 
	#BACDCODE_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~<ddef.h
>

30 
	~"bacdef.h
"

31 
	~"dime.h
"

32 
	~"bacr.h
"

33 
	~"bact.h
"

34 
	~"bal.h
"

35 
	~"bs.h
"

37 #ifde
__lulus


43 
code_g
(

44 
ut8_t
 * 
du
,

45 
ut8_t
 
g_numb
,

46 
bo
 
cڋxt_ecific
,

47 
ut32_t
 
n_vue_ty
);

51 
code_ݒg_g
(

52 
ut8_t
 * 
du
,

53 
ut8_t
 
g_numb
);

54 
code_osg_g
(

55 
ut8_t
 * 
du
,

56 
ut8_t
 
g_numb
);

57 
decode_g_numb
(

58 
ut8_t
 * 
du
,

59 
ut8_t
 * 
g_numb
);

60 
decode_g_numb_
(

61 
ut8_t
 * 
du
,

62 
ut32_t
 
du_n_mag
,

63 
ut8_t
 * 
g_numb
);

64 
decode_g_numb_d_vue
(

65 
ut8_t
 * 
du
,

66 
ut8_t
 * 
g_numb
,

67 
ut32_t
 * 
vue
);

68 
decode_g_numb_d_vue_
(

69 
ut8_t
 * 
du
,

70 
ut32_t
 
du_n_mag
,

71 
ut8_t
 * 
g_numb
,

72 
ut32_t
 * 
vue
);

74 
bo
 
decode_is_ݒg_g_numb
(

75 
ut8_t
 * 
du
,

76 
ut8_t
 
g_numb
);

78 
bo
 
decode_is_osg_g_numb
(

79 
ut8_t
 * 
du
,

80 
ut8_t
 
g_numb
);

82 
bo
 
decode_is_cڋxt_g
(

83 
ut8_t
 * 
du
,

84 
ut8_t
 
g_numb
);

85 
bo
 
decode_is_cڋxt_g_wh_ngth
(

86 
ut8_t
 * 
du
,

87 
ut8_t
 
g_numb
,

88 *
g_ngth
);

90 
bo
 
decode_is_ݒg_g
(

91 
ut8_t
 * 
du
);

93 
bo
 
decode_is_osg_g
(

94 
ut8_t
 * 
du
);

97 
code_iti_nu
(

98 
ut8_t
 * 
du
);

99 
code_cڋxt_nu
(

100 
ut8_t
 * 
du
,

101 
ut8_t
 
g_numb
);

104 
code_iti_boޗn
(

105 
ut8_t
 * 
du
,

106 
bo
 
boޗn_vue
);

107 
bo
 
decode_boޗn
(

108 
ut32_t
 
n_vue
);

109 
code_cڋxt_boޗn
(

110 
ut8_t
 * 
du
,

111 
ut8_t
 
g_numb
,

112 
bo
 
boޗn_vue
);

113 
bo
 
decode_cڋxt_boޗn
(

114 
ut8_t
 * 
du
);

116 
decode_cڋxt_boޗn2
(

117 
ut8_t
 * 
du
,

118 
ut8_t
 
g_numb
,

119 
bo
 * 
boޗn_vue
);

123 
decode_brg
(

124 
ut8_t
 * 
du
,

125 
ut32_t
 
n_vue
,

126 
BACNET_BIT_STRING
 * 
b_rg
);

128 
decode_cڋxt_brg
(

129 
ut8_t
 * 
du
,

130 
ut8_t
 
g_numb
,

131 
BACNET_BIT_STRING
 * 
b_rg
);

133 
code_brg
(

134 
ut8_t
 * 
du
,

135 
BACNET_BIT_STRING
 * 
b_rg
);

136 
code_iti_brg
(

137 
ut8_t
 * 
du
,

138 
BACNET_BIT_STRING
 * 
b_rg
);

139 
code_cڋxt_brg
(

140 
ut8_t
 * 
du
,

141 
ut8_t
 
g_numb
,

142 
BACNET_BIT_STRING
 * 
b_rg
);

147 
code_iti_
(

148 
ut8_t
 * 
du
,

149 
vue
);

150 
code_cڋxt_
(

151 
ut8_t
 * 
du
,

152 
ut8_t
 
g_numb
,

153 
vue
);

158 
code_iti_doub
(

159 
ut8_t
 * 
du
,

160 
vue
);

162 
code_cڋxt_doub
(

163 
ut8_t
 * 
du
,

164 
ut8_t
 
g_numb
,

165 
vue
);

170 
decode_obje_id
(

171 
ut8_t
 * 
du
,

172 
ut16_t
 * 
obje_ty
,

173 
ut32_t
 * 

);

175 
decode_obje_id_
(

176 
ut8_t
 * 
du
,

177 
ut32_t
 
n_vue
,

178 
ut16_t
 * 
obje_ty
,

179 
ut32_t
 * 

);

181 
decode_cڋxt_obje_id
(

182 
ut8_t
 * 
du
,

183 
ut8_t
 
g_numb
,

184 
ut16_t
 * 
obje_ty
,

185 
ut32_t
 * 

);

187 
code_ba_obje_id
(

188 
ut8_t
 * 
du
,

189 
obje_ty
,

190 
ut32_t
 

);

191 
code_cڋxt_obje_id
(

192 
ut8_t
 * 
du
,

193 
ut8_t
 
g_numb
,

194 
obje_ty
,

195 
ut32_t
 

);

196 
code_iti_obje_id
(

197 
ut8_t
 * 
du
,

198 
obje_ty
,

199 
ut32_t
 

);

204 
code_o_rg
(

205 
ut8_t
 * 
du
,

206 
BACNET_OCTET_STRING
 * 
o_rg
);

207 
code_iti_o_rg
(

208 
ut8_t
 * 
du
,

209 
BACNET_OCTET_STRING
 * 
o_rg
);

210 
code_cڋxt_o_rg
(

211 
ut8_t
 * 
du
,

212 
ut8_t
 
g_numb
,

213 
BACNET_OCTET_STRING
 * 
o_rg
);

214 
decode_o_rg
(

215 
ut8_t
 * 
du
,

216 
ut32_t
 
n_vue
,

217 
BACNET_OCTET_STRING
 * 
o_rg
);

218 
decode_cڋxt_o_rg
(

219 
ut8_t
 * 
du
,

220 
ut8_t
 
g_numb
,

221 
BACNET_OCTET_STRING
 * 
o_rg
);

227 
ut32_t
 
code_ba_cha_rg_
(

228 
ut8_t
 * 
du
,

229 
ut32_t
 
max_du
,

230 
ut8_t
 
codg
,

231 *
pSg
,

232 
ut32_t
 
ngth
);

233 
code_ba_cha_rg
(

234 
ut8_t
 * 
du
,

235 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

236 
code_iti_cha_rg
(

237 
ut8_t
 * 
du
,

238 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

239 
code_cڋxt_cha_rg
(

240 
ut8_t
 * 
du
,

241 
ut8_t
 
g_numb
,

242 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

243 
decode_cha_rg
(

244 
ut8_t
 * 
du
,

245 
ut32_t
 
n_vue
,

246 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

247 
decode_cڋxt_cha_rg
(

248 
ut8_t
 * 
du
,

249 
ut8_t
 
g_numb
,

250 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

256 
code_ba_unsigd
(

257 
ut8_t
 * 
du
,

258 
ut32_t
 
vue
);

259 
code_cڋxt_unsigd
(

260 
ut8_t
 * 
du
,

261 
ut8_t
 
g_numb
,

262 
ut32_t
 
vue
);

263 
code_iti_unsigd
(

264 
ut8_t
 * 
du
,

265 
ut32_t
 
vue
);

266 
decode_unsigd
(

267 
ut8_t
 * 
du
,

268 
ut32_t
 
n_vue
,

269 
ut32_t
 * 
vue
);

270 
decode_cڋxt_unsigd
(

271 
ut8_t
 * 
du
,

272 
ut8_t
 
g_numb
,

273 
ut32_t
 * 
vue
);

278 
code_ba_sigd
(

279 
ut8_t
 * 
du
,

280 
t32_t
 
vue
);

281 
code_iti_sigd
(

282 
ut8_t
 * 
du
,

283 
t32_t
 
vue
);

284 
code_cڋxt_sigd
(

285 
ut8_t
 * 
du
,

286 
ut8_t
 
g_numb
,

287 
t32_t
 
vue
);

288 
decode_sigd
(

289 
ut8_t
 * 
du
,

290 
ut32_t
 
n_vue
,

291 
t32_t
 * 
vue
);

292 
decode_cڋxt_sigd
(

293 
ut8_t
 * 
du
,

294 
ut8_t
 
g_numb
,

295 
t32_t
 * 
vue
);

301 
decode_umed
(

302 
ut8_t
 * 
du
,

303 
ut32_t
 
n_vue
,

304 
ut32_t
 * 
vue
);

305 
decode_cڋxt_umed
(

306 
ut8_t
 * 
du
,

307 
ut8_t
 
g_vue
,

308 
ut32_t
 * 
vue
);

309 
code_ba_umed
(

310 
ut8_t
 * 
du
,

311 
ut32_t
 
vue
);

312 
code_iti_umed
(

313 
ut8_t
 * 
du
,

314 
ut32_t
 
vue
);

315 
code_cڋxt_umed
(

316 
ut8_t
 * 
du
,

317 
ut8_t
 
g_numb
,

318 
ut32_t
 
vue
);

323 
code_ba_time
(

324 
ut8_t
 * 
du
,

325 
BACNET_TIME
 * 
btime
);

326 
code_iti_time
(

327 
ut8_t
 * 
du
,

328 
BACNET_TIME
 * 
btime
);

329 
decode_ba_time
(

330 
ut8_t
 * 
du
,

331 
BACNET_TIME
 * 
btime
);

332 
decode_ba_time_
(

333 
ut8_t
 * 
du
,

334 
ut32_t
 
n_vue
,

335 
BACNET_TIME
 * 
btime
);

336 
code_cڋxt_time
(

337 
ut8_t
 * 
du
,

338 
ut8_t
 
g_numb
,

339 
BACNET_TIME
 * 
btime
);

340 
decode_iti_time
(

341 
ut8_t
 * 
du
,

342 
BACNET_TIME
 * 
btime
);

343 
decode_cڋxt_ba_time
(

344 
ut8_t
 * 
du
,

345 
ut8_t
 
g_numb
,

346 
BACNET_TIME
 * 
btime
);

358 
code_ba_de
(

359 
ut8_t
 * 
du
,

360 
BACNET_DATE
 * 
bde
);

361 
code_iti_de
(

362 
ut8_t
 * 
du
,

363 
BACNET_DATE
 * 
bde
);

364 
code_cڋxt_de
(

365 
ut8_t
 * 
du
,

366 
ut8_t
 
g_numb
,

367 
BACNET_DATE
 * 
bde
);

368 
decode_de
(

369 
ut8_t
 * 
du
,

370 
BACNET_DATE
 * 
bde
);

371 
decode_de_
(

372 
ut8_t
 * 
du
,

373 
ut32_t
 
n_vue
,

374 
BACNET_DATE
 * 
bde
);

375 
decode_iti_de
(

376 
ut8_t
 * 
du
,

377 
BACNET_DATE
 * 
bde
);

378 
decode_cڋxt_de
(

379 
ut8_t
 * 
du
,

380 
ut8_t
 
g_numb
,

381 
BACNET_DATE
 * 
bde
);

386 
ut8_t
 
code_max_gs_max_du
(

387 
max_gs
,

388 
max_du
);

389 
decode_max_gs
(

390 
ut8_t
 
o
);

391 
decode_max_du
(

392 
ut8_t
 
o
);

395 
code_sime_ack
(

396 
ut8_t
 * 
du
,

397 
ut8_t
 
voke_id
,

398 
ut8_t
 
rvi_choi
);

402 
	#IS_EXTENDED_TAG_NUMBER
(
x
((x & 0xF0=0xF0)

	)

406 
	#IS_EXTENDED_VALUE
(
x
((x & 0x07=5)

	)

410 
	#IS_CONTEXT_SPECIFIC
(
x
((x & 
BIT3
=BIT3)

	)

414 
	#IS_OPENING_TAG
(
x
((x & 0x07=6)

	)

418 
	#IS_CLOSING_TAG
(
x
((x & 0x07=7)

	)

420 #ifde
TEST


421 
	~"e.h
"

422 
_BACDCode
(

423 
Te
 * 
pTe
);

426 #ifde
__lulus


	@include/bacdef.h

24 #ide
BACDEF_H


25 
	#BACDEF_H


	)

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~"banum.h
"

30 
	~"cfig.h
"

32 #i
defed
(
_MSC_VER
)

35 #agm
wng

dib
 : 4996)

39 
	#BACNET_PROTOCOL_VERSION
 1

	)

42 #ide
BACNET_PROTOCOL_REVISION


43 
	#BACNET_PROTOCOL_REVISION
 12

	)

47 #i(
BACNET_PROTOCOL_REVISION
 == 0)

48 
	#MAX_ASHRAE_OBJECT_TYPE
 18

	)

49 
	#MAX_BACNET_SERVICES_SUPPORTED
 35

	)

50 #i(
BACNET_PROTOCOL_REVISION
 == 1)

51 
	#MAX_ASHRAE_OBJECT_TYPE
 21

	)

52 
	#MAX_BACNET_SERVICES_SUPPORTED
 37

	)

53 #i(
BACNET_PROTOCOL_REVISION
 == 2)

55 
	#MAX_ASHRAE_OBJECT_TYPE
 23

	)

56 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

57 #i(
BACNET_PROTOCOL_REVISION
 == 3)

58 
	#MAX_ASHRAE_OBJECT_TYPE
 23

	)

59 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

60 #i(
BACNET_PROTOCOL_REVISION
 == 4)

62 
	#MAX_ASHRAE_OBJECT_TYPE
 25

	)

63 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

64 #i(
BACNET_PROTOCOL_REVISION
 == 5)

65 
	#MAX_ASHRAE_OBJECT_TYPE
 30

	)

66 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

67 #i(
BACNET_PROTOCOL_REVISION
 == 6)

68 
	#MAX_ASHRAE_OBJECT_TYPE
 31

	)

69 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

70 #i(
BACNET_PROTOCOL_REVISION
 == 7)

71 
	#MAX_ASHRAE_OBJECT_TYPE
 31

	)

72 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

73 #i(
BACNET_PROTOCOL_REVISION
 == 8)

74 
	#MAX_ASHRAE_OBJECT_TYPE
 31

	)

75 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

76 #i(
BACNET_PROTOCOL_REVISION
 == 9)

78 
	#MAX_ASHRAE_OBJECT_TYPE
 38

	)

79 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

80 #i(
BACNET_PROTOCOL_REVISION
 == 10)

81 
	#MAX_ASHRAE_OBJECT_TYPE
 51

	)

82 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

83 #i(
BACNET_PROTOCOL_REVISION
 == 11)

84 
	#MAX_ASHRAE_OBJECT_TYPE
 51

	)

85 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

86 #i(
BACNET_PROTOCOL_REVISION
 == 12)

88 
	#MAX_ASHRAE_OBJECT_TYPE
 51

	)

89 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

90 #i(
BACNET_PROTOCOL_REVISION
 == 13)

91 
	#MAX_ASHRAE_OBJECT_TYPE
 53

	)

92 
	#MAX_BACNET_SERVICES_SUPPORTED
 40

	)

93 #i(
BACNET_PROTOCOL_REVISION
 == 14) || (BACNET_PROTOCOL_REVISION == 15)

95 
	#MAX_ASHRAE_OBJECT_TYPE
 55

	)

96 
	#MAX_BACNET_SERVICES_SUPPORTED
 41

	)

97 #i(
BACNET_PROTOCOL_REVISION
 == 16)

100 
	#MAX_ASHRAE_OBJECT_TYPE
 56

	)

101 
	#MAX_BACNET_SERVICES_SUPPORTED
 41

	)

102 #i(
BACNET_PROTOCOL_REVISION
 == 17)

104 
	#MAX_ASHRAE_OBJECT_TYPE
 57

	)

105 
	#MAX_BACNET_SERVICES_SUPPORTED
 41

	)

106 #i(
BACNET_PROTOCOL_REVISION
 == 18) || (BACNET_PROTOCOL_REVISION == 19)

108 
	#MAX_ASHRAE_OBJECT_TYPE
 60

	)

109 
	#MAX_BACNET_SERVICES_SUPPORTED
 44

	)

111 #r 
MAX_ASHRAE_OBJECT_TYPE
 
d
 
MAX_BACNET_SERVICES_SUPPORTED
 
n
 
defed
!

116 
	#BACNET_MAX_INSTANCE
 (0x3FFFFF)

	)

117 
	#BACNET_INSTANCE_BITS
 22

	)

119 
	#BACNET_MAX_OBJECT
 (0x3FF)

	)

122 
	#BACNET_ARRAY_ALL
 0xFFFFFFFFU

	)

124 
	#BACNET_NO_DEV_ID
 0xFFFFFFFFu

	)

125 
	#BACNET_NO_DEV_TYPE
 0xFFFFu

	)

127 
	#BACNET_NO_PRIORITY
 0

	)

128 
	#BACNET_MIN_PRIORITY
 1

	)

129 
	#BACNET_MAX_PRIORITY
 16

	)

131 
	#BACNET_BROADCAST_NETWORK
 (0xFFFF)

	)

136 
	#MAX_MAC_LEN
 7

	)

137 
	sBACt_Devi_Addss
 {

139 
ut8_t
 
	mmac_n
;

142 
ut8_t
 
	mmac
[
MAX_MAC_LEN
];

146 
ut16_t
 
	mt
;

149 
ut8_t
 
	mn
;

150 
ut8_t
 
	madr
[
MAX_MAC_LEN
];

152 
BACt_Devi_Addss
 
	tBACNET_ADDRESS
;

157 
	sBACt_Obje_Id
 {

158 
ut16_t
 
	mty
;

159 
ut32_t
 
	m
;

160 } 
	tBACNET_OBJECT_ID
;

162 
	#MAX_NPDU
 (1+1+2+1+
MAX_MAC_LEN
+2+1+MAX_MAC_LEN+1+1+2)

	)

163 
	#MAX_PDU
 (
MAX_APDU
 + 
MAX_NPDU
)

	)

165 
	#BACNET_ID_VALUE
(
ba_obje_
, 
ba_obje_ty
((((ba_obje_ty& 
BACNET_MAX_OBJECT
<< 
BACNET_INSTANCE_BITS
| ((ba_obje_& 
BACNET_MAX_INSTANCE
))

	)

166 
	#BACNET_INSTANCE
(
ba_obje_id_num
((ba_obje_id_num)&
BACNET_MAX_INSTANCE
)

	)

167 
	#BACNET_TYPE
(
ba_obje_id_num
(((ba_obje_id_num>> 
BACNET_INSTANCE_BITS
 ) & 
BACNET_MAX_OBJECT
)

	)

169 
	#BACNET_STATUS_OK
 (0)

	)

170 
	#BACNET_STATUS_ERROR
 (-1)

	)

171 
	#BACNET_STATUS_ABORT
 (-2)

	)

172 
	#BACNET_STATUS_REJECT
 (-3)

	)

	@include/bacdevobjpropref.h

24 #ide
_BAC_DEV_PROP_REF_H_


25 
	#_BAC_DEV_PROP_REF_H_


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~<ddef.h
>

30 
	~"bacdef.h
"

31 
	~"banum.h
"

34 
BACNET_OBJECT_ID
 
	mobjeIdtifr
;

35 
BACNET_PROPERTY_ID
 
	mݔtyIdtifr
;

36 
ut32_t
 
	myIndex
;

37 
BACNET_OBJECT_ID
 
	mdeviIndtifr
;

38 } 
	tBACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
;

45 
BACNET_OBJECT_ID
 
	mdeviIndtifr
;

46 
BACNET_OBJECT_ID
 
	mobjeIdtifr
;

47 } 
	tBACNET_DEVICE_OBJECT_REFERENCE
;

51 #ifde
__lulus


55 
ba_code_devi_obj_ݔty_f
(

56 
ut8_t
 * 
du
,

57 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 * 
vue
);

59 
ba_code_cڋxt_devi_obj_ݔty_f
(

60 
ut8_t
 * 
du
,

61 
ut8_t
 
g_numb
,

62 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 * 
vue
);

64 
ba_decode_devi_obj_ݔty_f
(

65 
ut8_t
 * 
du
,

66 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 * 
vue
);

68 
ba_decode_cڋxt_devi_obj_ݔty_f
(

69 
ut8_t
 * 
du
,

70 
ut8_t
 
g_numb
,

71 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 * 
vue
);

74 
ba_code_devi_obj_f
(

75 
ut8_t
 * 
du
,

76 
BACNET_DEVICE_OBJECT_REFERENCE
 * 
vue
);

78 
ba_code_cڋxt_devi_obj_f
(

79 
ut8_t
 * 
du
,

80 
ut8_t
 
g_numb
,

81 
BACNET_DEVICE_OBJECT_REFERENCE
 * 
vue
);

83 
ba_decode_devi_obj_f
(

84 
ut8_t
 * 
du
,

85 
BACNET_DEVICE_OBJECT_REFERENCE
 * 
vue
);

87 
ba_decode_cڋxt_devi_obj_f
(

88 
ut8_t
 * 
du
,

89 
ut8_t
 
g_numb
,

90 
BACNET_DEVICE_OBJECT_REFERENCE
 * 
vue
);

92 #ifde
TEST


93 
	~"e.h
"

94 
BACtDeviObjePrݔtyRen
(

95 
Te
 * 
pTe
);

98 #ifde
__lulus


	@include/bacenum.h

24 #ide
BACENUM_H


25 
	#BACENUM_H


	)

28 
	mPROP_ACKED_TRANSITIONS
 = 0,

29 
	mPROP_ACK_REQUIRED
 = 1,

30 
	mPROP_ACTION
 = 2,

31 
	mPROP_ACTION_TEXT
 = 3,

32 
	mPROP_ACTIVE_TEXT
 = 4,

33 
	mPROP_ACTIVE_VT_SESSIONS
 = 5,

34 
	mPROP_ALARM_VALUE
 = 6,

35 
	mPROP_ALARM_VALUES
 = 7,

36 
	mPROP_ALL
 = 8,

37 
	mPROP_ALL_WRITES_SUCCESSFUL
 = 9,

38 
	mPROP_APDU_SEGMENT_TIMEOUT
 = 10,

39 
	mPROP_APDU_TIMEOUT
 = 11,

40 
	mPROP_APPLICATION_SOFTWARE_VERSION
 = 12,

41 
	mPROP_ARCHIVE
 = 13,

42 
	mPROP_BIAS
 = 14,

43 
	mPROP_CHANGE_OF_STATE_COUNT
 = 15,

44 
	mPROP_CHANGE_OF_STATE_TIME
 = 16,

45 
	mPROP_NOTIFICATION_CLASS
 = 17,

46 
	mPROP_BLANK_1
 = 18,

47 
	mPROP_CONTROLLED_VARIABLE_REFERENCE
 = 19,

48 
	mPROP_CONTROLLED_VARIABLE_UNITS
 = 20,

49 
	mPROP_CONTROLLED_VARIABLE_VALUE
 = 21,

50 
	mPROP_COV_INCREMENT
 = 22,

51 
	mPROP_DATE_LIST
 = 23,

52 
	mPROP_DAYLIGHT_SAVINGS_STATUS
 = 24,

53 
	mPROP_DEADBAND
 = 25,

54 
	mPROP_DERIVATIVE_CONSTANT
 = 26,

55 
	mPROP_DERIVATIVE_CONSTANT_UNITS
 = 27,

56 
	mPROP_DESCRIPTION
 = 28,

57 
	mPROP_DESCRIPTION_OF_HALT
 = 29,

58 
	mPROP_DEVICE_ADDRESS_BINDING
 = 30,

59 
	mPROP_DEVICE_TYPE
 = 31,

60 
	mPROP_EFFECTIVE_PERIOD
 = 32,

61 
	mPROP_ELAPSED_ACTIVE_TIME
 = 33,

62 
	mPROP_ERROR_LIMIT
 = 34,

63 
	mPROP_EVENT_ENABLE
 = 35,

64 
	mPROP_EVENT_STATE
 = 36,

65 
	mPROP_EVENT_TYPE
 = 37,

66 
	mPROP_EXCEPTION_SCHEDULE
 = 38,

67 
	mPROP_FAULT_VALUES
 = 39,

68 
	mPROP_FEEDBACK_VALUE
 = 40,

69 
	mPROP_FILE_ACCESS_METHOD
 = 41,

70 
	mPROP_FILE_SIZE
 = 42,

71 
	mPROP_FILE_TYPE
 = 43,

72 
	mPROP_FIRMWARE_REVISION
 = 44,

73 
	mPROP_HIGH_LIMIT
 = 45,

74 
	mPROP_INACTIVE_TEXT
 = 46,

75 
	mPROP_IN_PROCESS
 = 47,

76 
	mPROP_INSTANCE_OF
 = 48,

77 
	mPROP_INTEGRAL_CONSTANT
 = 49,

78 
	mPROP_INTEGRAL_CONSTANT_UNITS
 = 50,

79 
	mPROP_ISSUE_CONFIRMED_NOTIFICATIONS
 = 51,

80 
	mPROP_LIMIT_ENABLE
 = 52,

81 
	mPROP_LIST_OF_GROUP_MEMBERS
 = 53,

82 
	mPROP_LIST_OF_OBJECT_PROPERTY_REFERENCES
 = 54,

83 
	mPROP_LIST_OF_SESSION_KEYS
 = 55,

84 
	mPROP_LOCAL_DATE
 = 56,

85 
	mPROP_LOCAL_TIME
 = 57,

86 
	mPROP_LOCATION
 = 58,

87 
	mPROP_LOW_LIMIT
 = 59,

88 
	mPROP_MANIPULATED_VARIABLE_REFERENCE
 = 60,

89 
	mPROP_MAXIMUM_OUTPUT
 = 61,

90 
	mPROP_MAX_APDU_LENGTH_ACCEPTED
 = 62,

91 
	mPROP_MAX_INFO_FRAMES
 = 63,

92 
	mPROP_MAX_MASTER
 = 64,

93 
	mPROP_MAX_PRES_VALUE
 = 65,

94 
	mPROP_MINIMUM_OFF_TIME
 = 66,

95 
	mPROP_MINIMUM_ON_TIME
 = 67,

96 
	mPROP_MINIMUM_OUTPUT
 = 68,

97 
	mPROP_MIN_PRES_VALUE
 = 69,

98 
	mPROP_MODEL_NAME
 = 70,

99 
	mPROP_MODIFICATION_DATE
 = 71,

100 
	mPROP_NOTIFY_TYPE
 = 72,

101 
	mPROP_NUMBER_OF_APDU_RETRIES
 = 73,

102 
	mPROP_NUMBER_OF_STATES
 = 74,

103 
	mPROP_OBJECT_IDENTIFIER
 = 75,

104 
	mPROP_OBJECT_LIST
 = 76,

105 
	mPROP_OBJECT_NAME
 = 77,

106 
	mPROP_OBJECT_PROPERTY_REFERENCE
 = 78,

107 
	mPROP_OBJECT_TYPE
 = 79,

108 
	mPROP_OPTIONAL
 = 80,

109 
	mPROP_OUT_OF_SERVICE
 = 81,

110 
	mPROP_OUTPUT_UNITS
 = 82,

111 
	mPROP_EVENT_PARAMETERS
 = 83,

112 
	mPROP_POLARITY
 = 84,

113 
	mPROP_PRESENT_VALUE
 = 85,

114 
	mPROP_PRIORITY
 = 86,

115 
	mPROP_PRIORITY_ARRAY
 = 87,

116 
	mPROP_PRIORITY_FOR_WRITING
 = 88,

117 
	mPROP_PROCESS_IDENTIFIER
 = 89,

118 
	mPROP_PROGRAM_CHANGE
 = 90,

119 
	mPROP_PROGRAM_LOCATION
 = 91,

120 
	mPROP_PROGRAM_STATE
 = 92,

121 
	mPROP_PROPORTIONAL_CONSTANT
 = 93,

122 
	mPROP_PROPORTIONAL_CONSTANT_UNITS
 = 94,

123 
	mPROP_PROTOCOL_CONFORMANCE_CLASS
 = 95,

124 
	mPROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
 = 96,

125 
	mPROP_PROTOCOL_SERVICES_SUPPORTED
 = 97,

126 
	mPROP_PROTOCOL_VERSION
 = 98,

127 
	mPROP_READ_ONLY
 = 99,

128 
	mPROP_REASON_FOR_HALT
 = 100,

129 
	mPROP_RECIPIENT
 = 101,

130 
	mPROP_RECIPIENT_LIST
 = 102,

131 
	mPROP_RELIABILITY
 = 103,

132 
	mPROP_RELINQUISH_DEFAULT
 = 104,

133 
	mPROP_REQUIRED
 = 105,

134 
	mPROP_RESOLUTION
 = 106,

135 
	mPROP_SEGMENTATION_SUPPORTED
 = 107,

136 
	mPROP_SETPOINT
 = 108,

137 
	mPROP_SETPOINT_REFERENCE
 = 109,

138 
	mPROP_STATE_TEXT
 = 110,

139 
	mPROP_STATUS_FLAGS
 = 111,

140 
	mPROP_SYSTEM_STATUS
 = 112,

141 
	mPROP_TIME_DELAY
 = 113,

142 
	mPROP_TIME_OF_ACTIVE_TIME_RESET
 = 114,

143 
	mPROP_TIME_OF_STATE_COUNT_RESET
 = 115,

144 
	mPROP_TIME_SYNCHRONIZATION_RECIPIENTS
 = 116,

145 
	mPROP_UNITS
 = 117,

146 
	mPROP_UPDATE_INTERVAL
 = 118,

147 
	mPROP_UTC_OFFSET
 = 119,

148 
	mPROP_VENDOR_IDENTIFIER
 = 120,

149 
	mPROP_VENDOR_NAME
 = 121,

150 
	mPROP_VT_CLASSES_SUPPORTED
 = 122,

151 
	mPROP_WEEKLY_SCHEDULE
 = 123,

152 
	mPROP_ATTEMPTED_SAMPLES
 = 124,

153 
	mPROP_AVERAGE_VALUE
 = 125,

154 
	mPROP_BUFFER_SIZE
 = 126,

155 
	mPROP_CLIENT_COV_INCREMENT
 = 127,

156 
	mPROP_COV_RESUBSCRIPTION_INTERVAL
 = 128,

157 
	mPROP_CURRENT_NOTIFY_TIME
 = 129,

158 
	mPROP_EVENT_TIME_STAMPS
 = 130,

159 
	mPROP_LOG_BUFFER
 = 131,

160 
	mPROP_LOG_DEVICE_OBJECT_PROPERTY
 = 132,

163 
	mPROP_ENABLE
 = 133,

164 
	mPROP_LOG_INTERVAL
 = 134,

165 
	mPROP_MAXIMUM_VALUE
 = 135,

166 
	mPROP_MINIMUM_VALUE
 = 136,

167 
	mPROP_NOTIFICATION_THRESHOLD
 = 137,

168 
	mPROP_PREVIOUS_NOTIFY_TIME
 = 138,

169 
	mPROP_PROTOCOL_REVISION
 = 139,

170 
	mPROP_RECORDS_SINCE_NOTIFICATION
 = 140,

171 
	mPROP_RECORD_COUNT
 = 141,

172 
	mPROP_START_TIME
 = 142,

173 
	mPROP_STOP_TIME
 = 143,

174 
	mPROP_STOP_WHEN_FULL
 = 144,

175 
	mPROP_TOTAL_RECORD_COUNT
 = 145,

176 
	mPROP_VALID_SAMPLES
 = 146,

177 
	mPROP_WINDOW_INTERVAL
 = 147,

178 
	mPROP_WINDOW_SAMPLES
 = 148,

179 
	mPROP_MAXIMUM_VALUE_TIMESTAMP
 = 149,

180 
	mPROP_MINIMUM_VALUE_TIMESTAMP
 = 150,

181 
	mPROP_VARIANCE_VALUE
 = 151,

182 
	mPROP_ACTIVE_COV_SUBSCRIPTIONS
 = 152,

183 
	mPROP_BACKUP_FAILURE_TIMEOUT
 = 153,

184 
	mPROP_CONFIGURATION_FILES
 = 154,

185 
	mPROP_DATABASE_REVISION
 = 155,

186 
	mPROP_DIRECT_READING
 = 156,

187 
	mPROP_LAST_RESTORE_TIME
 = 157,

188 
	mPROP_MAINTENANCE_REQUIRED
 = 158,

189 
	mPROP_MEMBER_OF
 = 159,

190 
	mPROP_MODE
 = 160,

191 
	mPROP_OPERATION_EXPECTED
 = 161,

192 
	mPROP_SETTING
 = 162,

193 
	mPROP_SILENCED
 = 163,

194 
	mPROP_TRACKING_VALUE
 = 164,

195 
	mPROP_ZONE_MEMBERS
 = 165,

196 
	mPROP_LIFE_SAFETY_ALARM_VALUES
 = 166,

197 
	mPROP_MAX_SEGMENTS_ACCEPTED
 = 167,

198 
	mPROP_PROFILE_NAME
 = 168,

199 
	mPROP_AUTO_SLAVE_DISCOVERY
 = 169,

200 
	mPROP_MANUAL_SLAVE_ADDRESS_BINDING
 = 170,

201 
	mPROP_SLAVE_ADDRESS_BINDING
 = 171,

202 
	mPROP_SLAVE_PROXY_ENABLE
 = 172,

203 
	mPROP_LAST_NOTIFY_RECORD
 = 173,

204 
	mPROP_SCHEDULE_DEFAULT
 = 174,

205 
	mPROP_ACCEPTED_MODES
 = 175,

206 
	mPROP_ADJUST_VALUE
 = 176,

207 
	mPROP_COUNT
 = 177,

208 
	mPROP_COUNT_BEFORE_CHANGE
 = 178,

209 
	mPROP_COUNT_CHANGE_TIME
 = 179,

210 
	mPROP_COV_PERIOD
 = 180,

211 
	mPROP_INPUT_REFERENCE
 = 181,

212 
	mPROP_LIMIT_MONITORING_INTERVAL
 = 182,

213 
	mPROP_LOGGING_OBJECT
 = 183,

214 
	mPROP_LOGGING_RECORD
 = 184,

215 
	mPROP_PRESCALE
 = 185,

216 
	mPROP_PULSE_RATE
 = 186,

217 
	mPROP_SCALE
 = 187,

218 
	mPROP_SCALE_FACTOR
 = 188,

219 
	mPROP_UPDATE_TIME
 = 189,

220 
	mPROP_VALUE_BEFORE_CHANGE
 = 190,

221 
	mPROP_VALUE_SET
 = 191,

222 
	mPROP_VALUE_CHANGE_TIME
 = 192,

224 
	mPROP_ALIGN_INTERVALS
 = 193,

226 
	mPROP_INTERVAL_OFFSET
 = 195,

227 
	mPROP_LAST_RESTART_REASON
 = 196,

228 
	mPROP_LOGGING_TYPE
 = 197,

230 
	mPROP_RESTART_NOTIFICATION_RECIPIENTS
 = 202,

231 
	mPROP_TIME_OF_DEVICE_RESTART
 = 203,

232 
	mPROP_TIME_SYNCHRONIZATION_INTERVAL
 = 204,

233 
	mPROP_TRIGGER
 = 205,

234 
	mPROP_UTC_TIME_SYNCHRONIZATION_RECIPIENTS
 = 206,

236 
	mPROP_NODE_SUBTYPE
 = 207,

237 
	mPROP_NODE_TYPE
 = 208,

238 
	mPROP_STRUCTURED_OBJECT_LIST
 = 209,

239 
	mPROP_SUBORDINATE_ANNOTATIONS
 = 210,

240 
	mPROP_SUBORDINATE_LIST
 = 211,

242 
	mPROP_ACTUAL_SHED_LEVEL
 = 212,

243 
	mPROP_DUTY_WINDOW
 = 213,

244 
	mPROP_EXPECTED_SHED_LEVEL
 = 214,

245 
	mPROP_FULL_DUTY_BASELINE
 = 215,

248 
	mPROP_REQUESTED_SHED_LEVEL
 = 218,

249 
	mPROP_SHED_DURATION
 = 219,

250 
	mPROP_SHED_LEVEL_DESCRIPTIONS
 = 220,

251 
	mPROP_SHED_LEVELS
 = 221,

252 
	mPROP_STATE_DESCRIPTION
 = 222,

255 
	mPROP_DOOR_ALARM_STATE
 = 226,

256 
	mPROP_DOOR_EXTENDED_PULSE_TIME
 = 227,

257 
	mPROP_DOOR_MEMBERS
 = 228,

258 
	mPROP_DOOR_OPEN_TOO_LONG_TIME
 = 229,

259 
	mPROP_DOOR_PULSE_TIME
 = 230,

260 
	mPROP_DOOR_STATUS
 = 231,

261 
	mPROP_DOOR_UNLOCK_DELAY_TIME
 = 232,

262 
	mPROP_LOCK_STATUS
 = 233,

263 
	mPROP_MASKED_ALARM_VALUES
 = 234,

264 
	mPROP_SECURED_STATUS
 = 235,

267 
	mPROP_ABSENTEE_LIMIT
 = 244,

268 
	mPROP_ACCESS_ALARM_EVENTS
 = 245,

269 
	mPROP_ACCESS_DOORS
 = 246,

270 
	mPROP_ACCESS_EVENT
 = 247,

271 
	mPROP_ACCESS_EVENT_AUTHENTICATION_FACTOR
 = 248,

272 
	mPROP_ACCESS_EVENT_CREDENTIAL
 = 249,

273 
	mPROP_ACCESS_EVENT_TIME
 = 250,

274 
	mPROP_ACCESS_TRANSACTION_EVENTS
 = 251,

275 
	mPROP_ACCOMPANIMENT
 = 252,

276 
	mPROP_ACCOMPANIMENT_TIME
 = 253,

277 
	mPROP_ACTIVATION_TIME
 = 254,

278 
	mPROP_ACTIVE_AUTHENTICATION_POLICY
 = 255,

279 
	mPROP_ASSIGNED_ACCESS_RIGHTS
 = 256,

280 
	mPROP_AUTHENTICATION_FACTORS
 = 257,

281 
	mPROP_AUTHENTICATION_POLICY_LIST
 = 258,

282 
	mPROP_AUTHENTICATION_POLICY_NAMES
 = 259,

283 
	mPROP_AUTHENTICATION_STATUS
 = 260,

284 
	mPROP_AUTHORIZATION_MODE
 = 261,

285 
	mPROP_BELONGS_TO
 = 262,

286 
	mPROP_CREDENTIAL_DISABLE
 = 263,

287 
	mPROP_CREDENTIAL_STATUS
 = 264,

288 
	mPROP_CREDENTIALS
 = 265,

289 
	mPROP_CREDENTIALS_IN_ZONE
 = 266,

290 
	mPROP_DAYS_REMAINING
 = 267,

291 
	mPROP_ENTRY_POINTS
 = 268,

292 
	mPROP_EXIT_POINTS
 = 269,

293 
	mPROP_EXPIRATION_TIME
 = 270,

294 
	mPROP_EXTENDED_TIME_ENABLE
 = 271,

295 
	mPROP_FAILED_ATTEMPT_EVENTS
 = 272,

296 
	mPROP_FAILED_ATTEMPTS
 = 273,

297 
	mPROP_FAILED_ATTEMPTS_TIME
 = 274,

298 
	mPROP_LAST_ACCESS_EVENT
 = 275,

299 
	mPROP_LAST_ACCESS_POINT
 = 276,

300 
	mPROP_LAST_CREDENTIAL_ADDED
 = 277,

301 
	mPROP_LAST_CREDENTIAL_ADDED_TIME
 = 278,

302 
	mPROP_LAST_CREDENTIAL_REMOVED
 = 279,

303 
	mPROP_LAST_CREDENTIAL_REMOVED_TIME
 = 280,

304 
	mPROP_LAST_USE_TIME
 = 281,

305 
	mPROP_LOCKOUT
 = 282,

306 
	mPROP_LOCKOUT_RELINQUISH_TIME
 = 283,

307 
	mPROP_MASTER_EXEMPTION
 = 284,

308 
	mPROP_MAX_FAILED_ATTEMPTS
 = 285,

309 
	mPROP_MEMBERS
 = 286,

310 
	mPROP_MUSTER_POINT
 = 287,

311 
	mPROP_NEGATIVE_ACCESS_RULES
 = 288,

312 
	mPROP_NUMBER_OF_AUTHENTICATION_POLICIES
 = 289,

313 
	mPROP_OCCUPANCY_COUNT
 = 290,

314 
	mPROP_OCCUPANCY_COUNT_ADJUST
 = 291,

315 
	mPROP_OCCUPANCY_COUNT_ENABLE
 = 292,

316 
	mPROP_OCCUPANCY_EXEMPTION
 = 293,

317 
	mPROP_OCCUPANCY_LOWER_LIMIT
 = 294,

318 
	mPROP_OCCUPANCY_LOWER_LIMIT_ENFORCED
 = 295,

319 
	mPROP_OCCUPANCY_STATE
 = 296,

320 
	mPROP_OCCUPANCY_UPPER_LIMIT
 = 297,

321 
	mPROP_OCCUPANCY_UPPER_LIMIT_ENFORCED
 = 298,

322 
	mPROP_PASSBACK_EXEMPTION
 = 299,

323 
	mPROP_PASSBACK_MODE
 = 300,

324 
	mPROP_PASSBACK_TIMEOUT
 = 301,

325 
	mPROP_POSITIVE_ACCESS_RULES
 = 302,

326 
	mPROP_REASON_FOR_DISABLE
 = 303,

327 
	mPROP_SUPPORTED_FORMATS
 = 304,

328 
	mPROP_SUPPORTED_FORMAT_CLASSES
 = 305,

329 
	mPROP_THREAT_AUTHORITY
 = 306,

330 
	mPROP_THREAT_LEVEL
 = 307,

331 
	mPROP_TRACE_FLAG
 = 308,

332 
	mPROP_TRANSACTION_NOTIFICATION_CLASS
 = 309,

333 
	mPROP_USER_EXTERNAL_IDENTIFIER
 = 310,

334 
	mPROP_USER_INFORMATION_REFERENCE
 = 311,

336 
	mPROP_USER_NAME
 = 317,

337 
	mPROP_USER_TYPE
 = 318,

338 
	mPROP_USES_REMAINING
 = 319,

339 
	mPROP_ZONE_FROM
 = 320,

340 
	mPROP_ZONE_TO
 = 321,

341 
	mPROP_ACCESS_EVENT_TAG
 = 322,

342 
	mPROP_GLOBAL_IDENTIFIER
 = 323,

344 
	mPROP_VERIFICATION_TIME
 = 326,

345 
	mPROP_BASE_DEVICE_SECURITY_POLICY
 = 327,

346 
	mPROP_DISTRIBUTION_KEY_REVISION
 = 328,

347 
	mPROP_DO_NOT_HIDE
 = 329,

348 
	mPROP_KEY_SETS
 = 330,

349 
	mPROP_LAST_KEY_SERVER
 = 331,

350 
	mPROP_NETWORK_ACCESS_SECURITY_POLICIES
 = 332,

351 
	mPROP_PACKET_REORDER_TIME
 = 333,

352 
	mPROP_SECURITY_PDU_TIMEOUT
 = 334,

353 
	mPROP_SECURITY_TIME_WINDOW
 = 335,

354 
	mPROP_SUPPORTED_SECURITY_ALGORITHM
 = 336,

355 
	mPROP_UPDATE_KEY_SET_TIMEOUT
 = 337,

356 
	mPROP_BACKUP_AND_RESTORE_STATE
 = 338,

357 
	mPROP_BACKUP_PREPARATION_TIME
 = 339,

358 
	mPROP_RESTORE_COMPLETION_TIME
 = 340,

359 
	mPROP_RESTORE_PREPARATION_TIME
 = 341,

361 
	mPROP_BIT_MASK
 = 342,

362 
	mPROP_BIT_TEXT
 = 343,

363 
	mPROP_IS_UTC
 = 344,

364 
	mPROP_GROUP_MEMBERS
 = 345,

365 
	mPROP_GROUP_MEMBER_NAMES
 = 346,

366 
	mPROP_MEMBER_STATUS_FLAGS
 = 347,

367 
	mPROP_REQUESTED_UPDATE_INTERVAL
 = 348,

368 
	mPROP_COVU_PERIOD
 = 349,

369 
	mPROP_COVU_RECIPIENTS
 = 350,

370 
	mPROP_EVENT_MESSAGE_TEXTS
 = 351,

372 
	mPROP_EVENT_MESSAGE_TEXTS_CONFIG
 = 352,

373 
	mPROP_EVENT_DETECTION_ENABLE
 = 353,

374 
	mPROP_EVENT_ALGORITHM_INHIBIT
 = 354,

375 
	mPROP_EVENT_ALGORITHM_INHIBIT_REF
 = 355,

376 
	mPROP_TIME_DELAY_NORMAL
 = 356,

377 
	mPROP_RELIABILITY_EVALUATION_INHIBIT
 = 357,

378 
	mPROP_FAULT_PARAMETERS
 = 358,

379 
	mPROP_FAULT_TYPE
 = 359,

380 
	mPROP_LOCAL_FORWARDING_ONLY
 = 360,

381 
	mPROP_PROCESS_IDENTIFIER_FILTER
 = 361,

382 
	mPROP_SUBSCRIBED_RECIPIENTS
 = 362,

383 
	mPROP_PORT_FILTER
 = 363,

385 
	mPROP_AUTHORIZATION_EXEMPTIONS
 = 364,

387 
	mPROP_ALLOW_GROUP_DELAY_INHIBIT
 = 365,

388 
	mPROP_CHANNEL_NUMBER
 = 366,

389 
	mPROP_CONTROL_GROUPS
 = 367,

390 
	mPROP_EXECUTION_DELAY
 = 368,

391 
	mPROP_LAST_PRIORITY
 = 369,

392 
	mPROP_WRITE_STATUS
 = 370,

394 
	mPROP_PROPERTY_LIST
 = 371,

396 
	mPROP_SERIAL_NUMBER
 = 372,

398 
	mPROP_BLINK_WARN_ENABLE
 = 373,

399 
	mPROP_DEFAULT_FADE_TIME
 = 374,

400 
	mPROP_DEFAULT_RAMP_RATE
 = 375,

401 
	mPROP_DEFAULT_STEP_INCREMENT
 = 376,

402 
	mPROP_EGRESS_TIME
 = 377,

403 
	mPROP_IN_PROGRESS
 = 378,

404 
	mPROP_INSTANTANEOUS_POWER
 = 379,

405 
	mPROP_LIGHTING_COMMAND
 = 380,

406 
	mPROP_LIGHTING_COMMAND_DEFAULT_PRIORITY
 = 381,

407 
	mPROP_MAX_ACTUAL_VALUE
 = 382,

408 
	mPROP_MIN_ACTUAL_VALUE
 = 383,

409 
	mPROP_POWER
 = 384,

410 
	mPROP_TRANSITION
 = 385,

411 
	mPROP_EGRESS_ACTIVE
 = 386,

413 
	mPROP_INTERFACE_VALUE
 = 387,

414 
	mPROP_FAULT_HIGH_LIMIT
 = 388,

415 
	mPROP_FAULT_LOW_LIMIT
 = 389,

416 
	mPROP_LOW_DIFF_LIMIT
 = 390,

417 
	mPROP_STRIKE_COUNT
 = 391,

418 
	mPROP_TIME_OF_STRIKE_COUNT_RESET
 = 392,

419 
	mPROP_DEFAULT_TIMEOUT
 = 393,

420 
	mPROP_INITIAL_TIMEOUT
 = 394,

421 
	mPROP_LAST_STATE_CHANGE
 = 395,

422 
	mPROP_STATE_CHANGE_VALUES
 = 396,

423 
	mPROP_TIMER_RUNNING
 = 397,

424 
	mPROP_TIMER_STATE
 = 398,

426 
	mPROP_APDU_LENGTH
 = 399,

427 
	mPROP_IP_ADDRESS
 = 400,

428 
	mPROP_IP_DEFAULT_GATEWAY
 = 401,

429 
	mPROP_IP_DHCP_ENABLE
 = 402,

430 
	mPROP_IP_DHCP_LEASE_TIME
 = 403,

431 
	mPROP_IP_DHCP_LEASE_TIME_REMAINING
 = 404,

432 
	mPROP_IP_DHCP_SERVER
 = 405,

433 
	mPROP_IP_DNS_SERVER
 = 406,

434 
	mPROP_BACNET_IP_GLOBAL_ADDRESS
 = 407,

435 
	mPROP_BACNET_IP_MODE
 = 408,

436 
	mPROP_BACNET_IP_MULTICAST_ADDRESS
 = 409,

437 
	mPROP_BACNET_IP_NAT_TRAVERSAL
 = 410,

438 
	mPROP_IP_SUBNET_MASK
 = 411,

439 
	mPROP_BACNET_IP_UDP_PORT
 = 412,

440 
	mPROP_BBMD_ACCEPT_FD_REGISTRATIONS
 = 413,

441 
	mPROP_BBMD_BROADCAST_DISTRIBUTION_TABLE
 = 414,

442 
	mPROP_BBMD_FOREIGN_DEVICE_TABLE
 = 415,

443 
	mPROP_CHANGES_PENDING
 = 416,

444 
	mPROP_COMMAND
 = 417,

445 
	mPROP_FD_BBMD_ADDRESS
 = 418,

446 
	mPROP_FD_SUBSCRIPTION_LIFETIME
 = 419,

447 
	mPROP_LINK_SPEED
 = 420,

448 
	mPROP_LINK_SPEEDS
 = 421,

449 
	mPROP_LINK_SPEED_AUTONEGOTIATE
 = 422,

450 
	mPROP_MAC_ADDRESS
 = 423,

451 
	mPROP_NETWORK_INTERFACE_NAME
 = 424,

452 
	mPROP_NETWORK_NUMBER
 = 425,

453 
	mPROP_NETWORK_NUMBER_QUALITY
 = 426,

454 
	mPROP_NETWORK_TYPE
 = 427,

455 
	mPROP_ROUTING_TABLE
 = 428,

456 
	mPROP_VIRTUAL_MAC_ADDRESS_TABLE
 = 429,

458 
	mPROP_COMMAND_TIME_ARRAY
 = 430,

459 
	mPROP_CURRENT_COMMAND_PRIORITY
 = 431,

460 
	mPROP_LAST_COMMAND_TIME
 = 432,

461 
	mPROP_VALUE_SOURCE
 = 433,

462 
	mPROP_VALUE_SOURCE_ARRAY
 = 434,

463 
	mPROP_BACNET_IPV6_MODE
 = 435,

464 
	mPROP_IPV6_ADDRESS
 = 436,

465 
	mPROP_IPV6_PREFIX_LENGTH
 = 437,

466 
	mPROP_BACNET_IPV6_UDP_PORT
 = 438,

467 
	mPROP_IPV6_DEFAULT_GATEWAY
 = 439,

468 
	mPROP_BACNET_IPV6_MULTICAST_ADDRESS
 = 440,

469 
	mPROP_IPV6_DNS_SERVER
 = 441,

470 
	mPROP_IPV6_AUTO_ADDRESSING_ENABLE
 = 442,

471 
	mPROP_IPV6_DHCP_LEASE_TIME
 = 443,

472 
	mPROP_IPV6_DHCP_LEASE_TIME_REMAINING
 = 444,

473 
	mPROP_IPV6_DHCP_SERVER
 = 445,

474 
	mPROP_IPV6_ZONE_INDEX
 = 446,

475 
	mPROP_ASSIGNED_LANDING_CALLS
 = 447,

476 
	mPROP_CAR_ASSIGNED_DIRECTION
 = 448,

477 
	mPROP_CAR_DOOR_COMMAND
 = 449,

478 
	mPROP_CAR_DOOR_STATUS
 = 450,

479 
	mPROP_CAR_DOOR_TEXT
 = 451,

480 
	mPROP_CAR_DOOR_ZONE
 = 452,

481 
	mPROP_CAR_DRIVE_STATUS
 = 453,

482 
	mPROP_CAR_LOAD
 = 454,

483 
	mPROP_CAR_LOAD_UNITS
 = 455,

484 
	mPROP_CAR_MODE
 = 456,

485 
	mPROP_CAR_MOVING_DIRECTION
 = 457,

486 
	mPROP_CAR_POSITION
 = 458,

487 
	mPROP_ELEVATOR_GROUP
 = 459,

488 
	mPROP_ENERGY_METER
 = 460,

489 
	mPROP_ENERGY_METER_REF
 = 461,

490 
	mPROP_ESCALATOR_MODE
 = 462,

491 
	mPROP_FAULT_SIGNALS
 = 463,

492 
	mPROP_FLOOR_TEXT
 = 464,

493 
	mPROP_GROUP_ID
 = 465,

495 
	mPROP_GROUP_MODE
 = 467,

496 
	mPROP_HIGHER_DECK
 = 468,

497 
	mPROP_INSTALLATION_ID
 = 469,

498 
	mPROP_LANDING_CALLS
 = 470,

499 
	mPROP_LANDING_CALL_CONTROL
 = 471,

500 
	mPROP_LANDING_DOOR_STATUS
 = 472,

501 
	mPROP_LOWER_DECK
 = 473,

502 
	mPROP_MACHINE_ROOM_ID
 = 474,

503 
	mPROP_MAKING_CAR_CALL
 = 475,

504 
	mPROP_NEXT_STOPPING_FLOOR
 = 476,

505 
	mPROP_OPERATION_DIRECTION
 = 477,

506 
	mPROP_PASSENGER_ALARM
 = 478,

507 
	mPROP_POWER_MODE
 = 479,

508 
	mPROP_REGISTERED_CAR_CALL
 = 480,

509 
	mPROP_ACTIVE_COV_MULTIPLE_SUBSCRIPTIONS
 = 481,

510 
	mPROP_PROTOCOL_LEVEL
 = 482,

511 
	mPROP_REFERENCE_PORT
 = 483,

512 
	mPROP_DEPLOYED_PROFILE_LOCATION
 = 484,

513 
	mPROP_PROFILE_LOCATION
 = 485,

514 
	mPROP_TAGS
 = 486,

515 
	mPROP_SUBORDINATE_NODE_TYPES
 = 487,

516 
	mPROP_SUBORDINATE_TAGS
 = 488,

517 
	mPROP_SUBORDINATE_RELATIONSHIPS
 = 489,

518 
	mPROP_DEFAULT_SUBORDINATE_RELATIONSHIP
 = 490,

519 
	mPROP_REPRESENTS
 = 491,

529 
	mMAX_BACNET_PROPERTY_ID
 = 4194303

530 } 
	tBACNET_PROPERTY_ID
;

534 
	mEVENT_LOW_LIMIT_ENABLE
 = 1,

535 
	mEVENT_HIGH_LIMIT_ENABLE
 = 2

536 } 
	tBACNET_LIMIT_ENABLE
;

539 
	mACTION_DIRECT
 = 0,

540 
	mACTION_REVERSE
 = 1

541 } 
	tBACNET_ACTION
;

544 
	mMIN_BINARY_PV
 = 0,

545 
	mBINARY_INACTIVE
 = 0,

546 
	mBINARY_ACTIVE
 = 1,

547 
	mMAX_BINARY_PV
 = 1,

548 
	mBINARY_NULL
 = 255

549 } 
	tBACNET_BINARY_PV
;

552 
	mACTION_BINARY_PV
,

553 
	mACTION_UNSIGNED
,

554 
	mACTION_FLOAT


555 } 
	tBACNET_ACTION_VALUE_TYPE
;

558 
	mEVENT_STATE_NORMAL
 = 0,

559 
	mEVENT_STATE_FAULT
 = 1,

560 
	mEVENT_STATE_OFFNORMAL
 = 2,

561 
	mEVENT_STATE_HIGH_LIMIT
 = 3,

562 
	mEVENT_STATE_LOW_LIMIT
 = 4

563 } 
	tBACNET_EVENT_STATE
;

566 
	mEVENT_ENABLE_TO_OFFNORMAL
 = 1,

567 
	mEVENT_ENABLE_TO_FAULT
 = 2,

568 
	mEVENT_ENABLE_TO_NORMAL
 = 4

569 } 
	tBACNET_EVENT_ENABLE
;

572 
	mSTATUS_OPERATIONAL
 = 0,

573 
	mSTATUS_OPERATIONAL_READ_ONLY
 = 1,

574 
	mSTATUS_DOWNLOAD_REQUIRED
 = 2,

575 
	mSTATUS_DOWNLOAD_IN_PROGRESS
 = 3,

576 
	mSTATUS_NON_OPERATIONAL
 = 4,

577 
	mSTATUS_BACKUP_IN_PROGRESS
 = 5,

578 
	mMAX_DEVICE_STATUS
 = 6

579 } 
	tBACNET_DEVICE_STATUS
;

583 
	mUNITS_METERS_PER_SECOND_PER_SECOND
 = 166,

585 
	mUNITS_SQUARE_METERS
 = 0,

586 
	mUNITS_SQUARE_CENTIMETERS
 = 116,

587 
	mUNITS_SQUARE_FEET
 = 1,

588 
	mUNITS_SQUARE_INCHES
 = 115,

590 
	mUNITS_CURRENCY1
 = 105,

591 
	mUNITS_CURRENCY2
 = 106,

592 
	mUNITS_CURRENCY3
 = 107,

593 
	mUNITS_CURRENCY4
 = 108,

594 
	mUNITS_CURRENCY5
 = 109,

595 
	mUNITS_CURRENCY6
 = 110,

596 
	mUNITS_CURRENCY7
 = 111,

597 
	mUNITS_CURRENCY8
 = 112,

598 
	mUNITS_CURRENCY9
 = 113,

599 
	mUNITS_CURRENCY10
 = 114,

601 
	mUNITS_MILLIAMPERES
 = 2,

602 
	mUNITS_AMPERES
 = 3,

603 
	mUNITS_AMPERES_PER_METER
 = 167,

604 
	mUNITS_AMPERES_PER_SQUARE_METER
 = 168,

605 
	mUNITS_AMPERE_SQUARE_METERS
 = 169,

606 
	mUNITS_DECIBELS
 = 199,

607 
	mUNITS_DECIBELS_MILLIVOLT
 = 200,

608 
	mUNITS_DECIBELS_VOLT
 = 201,

609 
	mUNITS_FARADS
 = 170,

610 
	mUNITS_HENRYS
 = 171,

611 
	mUNITS_OHMS
 = 4,

612 
	mUNITS_OHM_METERS
 = 172,

613 
	mUNITS_MILLIOHMS
 = 145,

614 
	mUNITS_KILOHMS
 = 122,

615 
	mUNITS_MEGOHMS
 = 123,

616 
	mUNITS_MICROSIEMENS
 = 190,

617 
	mUNITS_MILLISIEMENS
 = 202,

618 
	mUNITS_SIEMENS
 = 173,

619 
	mUNITS_SIEMENS_PER_METER
 = 174,

620 
	mUNITS_TESLAS
 = 175,

621 
	mUNITS_VOLTS
 = 5,

622 
	mUNITS_MILLIVOLTS
 = 124,

623 
	mUNITS_KILOVOLTS
 = 6,

624 
	mUNITS_MEGAVOLTS
 = 7,

625 
	mUNITS_VOLT_AMPERES
 = 8,

626 
	mUNITS_KILOVOLT_AMPERES
 = 9,

627 
	mUNITS_MEGAVOLT_AMPERES
 = 10,

628 
	mUNITS_VOLT_AMPERES_REACTIVE
 = 11,

629 
	mUNITS_KILOVOLT_AMPERES_REACTIVE
 = 12,

630 
	mUNITS_MEGAVOLT_AMPERES_REACTIVE
 = 13,

631 
	mUNITS_VOLTS_PER_DEGREE_KELVIN
 = 176,

632 
	mUNITS_VOLTS_PER_METER
 = 177,

633 
	mUNITS_DEGREES_PHASE
 = 14,

634 
	mUNITS_POWER_FACTOR
 = 15,

635 
	mUNITS_WEBERS
 = 178,

637 
	mUNITS_JOULES
 = 16,

638 
	mUNITS_KILOJOULES
 = 17,

639 
	mUNITS_KILOJOULES_PER_KILOGRAM
 = 125,

640 
	mUNITS_MEGAJOULES
 = 126,

641 
	mUNITS_WATT_HOURS
 = 18,

642 
	mUNITS_KILOWATT_HOURS
 = 19,

643 
	mUNITS_MEGAWATT_HOURS
 = 146,

644 
	mUNITS_WATT_HOURS_REACTIVE
 = 203,

645 
	mUNITS_KILOWATT_HOURS_REACTIVE
 = 204,

646 
	mUNITS_MEGAWATT_HOURS_REACTIVE
 = 205,

647 
	mUNITS_BTUS
 = 20,

648 
	mUNITS_KILO_BTUS
 = 147,

649 
	mUNITS_MEGA_BTUS
 = 148,

650 
	mUNITS_THERMS
 = 21,

651 
	mUNITS_TON_HOURS
 = 22,

653 
	mUNITS_JOULES_PER_KILOGRAM_DRY_AIR
 = 23,

654 
	mUNITS_KILOJOULES_PER_KILOGRAM_DRY_AIR
 = 149,

655 
	mUNITS_MEGAJOULES_PER_KILOGRAM_DRY_AIR
 = 150,

656 
	mUNITS_BTUS_PER_POUND_DRY_AIR
 = 24,

657 
	mUNITS_BTUS_PER_POUND
 = 117,

659 
	mUNITS_JOULES_PER_DEGREE_KELVIN
 = 127,

660 
	mUNITS_KILOJOULES_PER_DEGREE_KELVIN
 = 151,

661 
	mUNITS_MEGAJOULES_PER_DEGREE_KELVIN
 = 152,

662 
	mUNITS_JOULES_PER_KILOGRAM_DEGREE_KELVIN
 = 128,

664 
	mUNITS_NEWTON
 = 153,

666 
	mUNITS_CYCLES_PER_HOUR
 = 25,

667 
	mUNITS_CYCLES_PER_MINUTE
 = 26,

668 
	mUNITS_HERTZ
 = 27,

669 
	mUNITS_KILOHERTZ
 = 129,

670 
	mUNITS_MEGAHERTZ
 = 130,

671 
	mUNITS_PER_HOUR
 = 131,

673 
	mUNITS_GRAMS_OF_WATER_PER_KILOGRAM_DRY_AIR
 = 28,

674 
	mUNITS_PERCENT_RELATIVE_HUMIDITY
 = 29,

676 
	mUNITS_MICROMETERS
 = 194,

677 
	mUNITS_MILLIMETERS
 = 30,

678 
	mUNITS_CENTIMETERS
 = 118,

679 
	mUNITS_KILOMETERS
 = 193,

680 
	mUNITS_METERS
 = 31,

681 
	mUNITS_INCHES
 = 32,

682 
	mUNITS_FEET
 = 33,

684 
	mUNITS_CANDELAS
 = 179,

685 
	mUNITS_CANDELAS_PER_SQUARE_METER
 = 180,

686 
	mUNITS_WATTS_PER_SQUARE_FOOT
 = 34,

687 
	mUNITS_WATTS_PER_SQUARE_METER
 = 35,

688 
	mUNITS_LUMENS
 = 36,

689 
	mUNITS_LUXES
 = 37,

690 
	mUNITS_FOOT_CANDLES
 = 38,

692 
	mUNITS_MILLIGRAMS
 = 196,

693 
	mUNITS_GRAMS
 = 195,

694 
	mUNITS_KILOGRAMS
 = 39,

695 
	mUNITS_POUNDS_MASS
 = 40,

696 
	mUNITS_TONS
 = 41,

698 
	mUNITS_GRAMS_PER_SECOND
 = 154,

699 
	mUNITS_GRAMS_PER_MINUTE
 = 155,

700 
	mUNITS_KILOGRAMS_PER_SECOND
 = 42,

701 
	mUNITS_KILOGRAMS_PER_MINUTE
 = 43,

702 
	mUNITS_KILOGRAMS_PER_HOUR
 = 44,

703 
	mUNITS_POUNDS_MASS_PER_SECOND
 = 119,

704 
	mUNITS_POUNDS_MASS_PER_MINUTE
 = 45,

705 
	mUNITS_POUNDS_MASS_PER_HOUR
 = 46,

706 
	mUNITS_TONS_PER_HOUR
 = 156,

708 
	mUNITS_MILLIWATTS
 = 132,

709 
	mUNITS_WATTS
 = 47,

710 
	mUNITS_KILOWATTS
 = 48,

711 
	mUNITS_MEGAWATTS
 = 49,

712 
	mUNITS_BTUS_PER_HOUR
 = 50,

713 
	mUNITS_KILO_BTUS_PER_HOUR
 = 157,

714 
	mUNITS_HORSEPOWER
 = 51,

715 
	mUNITS_TONS_REFRIGERATION
 = 52,

717 
	mUNITS_PASCALS
 = 53,

718 
	mUNITS_HECTOPASCALS
 = 133,

719 
	mUNITS_KILOPASCALS
 = 54,

720 
	mUNITS_MILLIBARS
 = 134,

721 
	mUNITS_BARS
 = 55,

722 
	mUNITS_POUNDS_FORCE_PER_SQUARE_INCH
 = 56,

723 
	mUNITS_MILLIMETERS_OF_WATER
 = 206,

724 
	mUNITS_CENTIMETERS_OF_WATER
 = 57,

725 
	mUNITS_INCHES_OF_WATER
 = 58,

726 
	mUNITS_MILLIMETERS_OF_MERCURY
 = 59,

727 
	mUNITS_CENTIMETERS_OF_MERCURY
 = 60,

728 
	mUNITS_INCHES_OF_MERCURY
 = 61,

730 
	mUNITS_DEGREES_CELSIUS
 = 62,

731 
	mUNITS_DEGREES_KELVIN
 = 63,

732 
	mUNITS_DEGREES_KELVIN_PER_HOUR
 = 181,

733 
	mUNITS_DEGREES_KELVIN_PER_MINUTE
 = 182,

734 
	mUNITS_DEGREES_FAHRENHEIT
 = 64,

735 
	mUNITS_DEGREE_DAYS_CELSIUS
 = 65,

736 
	mUNITS_DEGREE_DAYS_FAHRENHEIT
 = 66,

737 
	mUNITS_DELTA_DEGREES_FAHRENHEIT
 = 120,

738 
	mUNITS_DELTA_DEGREES_KELVIN
 = 121,

740 
	mUNITS_YEARS
 = 67,

741 
	mUNITS_MONTHS
 = 68,

742 
	mUNITS_WEEKS
 = 69,

743 
	mUNITS_DAYS
 = 70,

744 
	mUNITS_HOURS
 = 71,

745 
	mUNITS_MINUTES
 = 72,

746 
	mUNITS_SECONDS
 = 73,

747 
	mUNITS_HUNDREDTHS_SECONDS
 = 158,

748 
	mUNITS_MILLISECONDS
 = 159,

750 
	mUNITS_NEWTON_METERS
 = 160,

752 
	mUNITS_MILLIMETERS_PER_SECOND
 = 161,

753 
	mUNITS_MILLIMETERS_PER_MINUTE
 = 162,

754 
	mUNITS_METERS_PER_SECOND
 = 74,

755 
	mUNITS_METERS_PER_MINUTE
 = 163,

756 
	mUNITS_METERS_PER_HOUR
 = 164,

757 
	mUNITS_KILOMETERS_PER_HOUR
 = 75,

758 
	mUNITS_FEET_PER_SECOND
 = 76,

759 
	mUNITS_FEET_PER_MINUTE
 = 77,

760 
	mUNITS_MILES_PER_HOUR
 = 78,

762 
	mUNITS_CUBIC_FEET
 = 79,

763 
	mUNITS_CUBIC_METERS
 = 80,

764 
	mUNITS_IMPERIAL_GALLONS
 = 81,

765 
	mUNITS_MILLILITERS
 = 197,

766 
	mUNITS_LITERS
 = 82,

767 
	mUNITS_US_GALLONS
 = 83,

769 
	mUNITS_CUBIC_FEET_PER_SECOND
 = 142,

770 
	mUNITS_CUBIC_FEET_PER_MINUTE
 = 84,

771 
	mUNITS_CUBIC_FEET_PER_HOUR
 = 191,

772 
	mUNITS_CUBIC_METERS_PER_SECOND
 = 85,

773 
	mUNITS_CUBIC_METERS_PER_MINUTE
 = 165,

774 
	mUNITS_CUBIC_METERS_PER_HOUR
 = 135,

775 
	mUNITS_IMPERIAL_GALLONS_PER_MINUTE
 = 86,

776 
	mUNITS_MILLILITERS_PER_SECOND
 = 198,

777 
	mUNITS_LITERS_PER_SECOND
 = 87,

778 
	mUNITS_LITERS_PER_MINUTE
 = 88,

779 
	mUNITS_LITERS_PER_HOUR
 = 136,

780 
	mUNITS_US_GALLONS_PER_MINUTE
 = 89,

781 
	mUNITS_US_GALLONS_PER_HOUR
 = 192,

783 
	mUNITS_DEGREES_ANGULAR
 = 90,

784 
	mUNITS_DEGREES_CELSIUS_PER_HOUR
 = 91,

785 
	mUNITS_DEGREES_CELSIUS_PER_MINUTE
 = 92,

786 
	mUNITS_DEGREES_FAHRENHEIT_PER_HOUR
 = 93,

787 
	mUNITS_DEGREES_FAHRENHEIT_PER_MINUTE
 = 94,

788 
	mUNITS_JOULE_SECONDS
 = 183,

789 
	mUNITS_KILOGRAMS_PER_CUBIC_METER
 = 186,

790 
	mUNITS_KW_HOURS_PER_SQUARE_METER
 = 137,

791 
	mUNITS_KW_HOURS_PER_SQUARE_FOOT
 = 138,

792 
	mUNITS_MEGAJOULES_PER_SQUARE_METER
 = 139,

793 
	mUNITS_MEGAJOULES_PER_SQUARE_FOOT
 = 140,

794 
	mUNITS_NO_UNITS
 = 95,

795 
	mUNITS_NEWTON_SECONDS
 = 187,

796 
	mUNITS_NEWTONS_PER_METER
 = 188,

797 
	mUNITS_PARTS_PER_MILLION
 = 96,

798 
	mUNITS_PARTS_PER_BILLION
 = 97,

799 
	mUNITS_PERCENT
 = 98,

800 
	mUNITS_PERCENT_OBSCURATION_PER_FOOT
 = 143,

801 
	mUNITS_PERCENT_OBSCURATION_PER_METER
 = 144,

802 
	mUNITS_PERCENT_PER_SECOND
 = 99,

803 
	mUNITS_PER_MINUTE
 = 100,

804 
	mUNITS_PER_SECOND
 = 101,

805 
	mUNITS_PSI_PER_DEGREE_FAHRENHEIT
 = 102,

806 
	mUNITS_RADIANS
 = 103,

807 
	mUNITS_RADIANS_PER_SECOND
 = 184,

808 
	mUNITS_REVOLUTIONS_PER_MINUTE
 = 104,

809 
	mUNITS_SQUARE_METERS_PER_NEWTON
 = 185,

810 
	mUNITS_WATTS_PER_METER_PER_DEGREE_KELVIN
 = 189,

811 
	mUNITS_WATTS_PER_SQUARE_METER_DEGREE_KELVIN
 = 141,

812 
	mUNITS_PER_MILLE
 = 207,

813 
	mUNITS_GRAMS_PER_GRAM
 = 208,

814 
	mUNITS_KILOGRAMS_PER_KILOGRAM
 = 209,

815 
	mUNITS_GRAMS_PER_KILOGRAM
 = 210,

816 
	mUNITS_MILLIGRAMS_PER_GRAM
 = 211,

817 
	mUNITS_MILLIGRAMS_PER_KILOGRAM
 = 212,

818 
	mUNITS_GRAMS_PER_MILLILITER
 = 213,

819 
	mUNITS_GRAMS_PER_LITER
 = 214,

820 
	mUNITS_MILLIGRAMS_PER_LITER
 = 215,

821 
	mUNITS_MICROGRAMS_PER_LITER
 = 216,

822 
	mUNITS_GRAMS_PER_CUBIC_METER
 = 217,

823 
	mUNITS_MILLIGRAMS_PER_CUBIC_METER
 = 218,

824 
	mUNITS_MICROGRAMS_PER_CUBIC_METER
 = 219,

825 
	mUNITS_NANOGRAMS_PER_CUBIC_METER
 = 220,

826 
	mUNITS_GRAMS_PER_CUBIC_CENTIMETER
 = 221,

827 
	mUNITS_BECQUERELS
 = 222,

828 
	mUNITS_KILOBECQUERELS
 = 223,

829 
	mUNITS_MEGABECQUERELS
 = 224,

830 
	mUNITS_GRAY
 = 225,

831 
	mUNITS_MILLIGRAY
 = 226,

832 
	mUNITS_MICROGRAY
 = 227,

833 
	mUNITS_SIEVERTS
 = 228,

834 
	mUNITS_MILLISIEVERTS
 = 229,

835 
	mUNITS_MICROSIEVERTS
 = 230,

836 
	mUNITS_MICROSIEVERTS_PER_HOUR
 = 231,

837 
	mUNITS_DECIBELS_A
 = 232,

838 
	mUNITS_NEPHELOMETRIC_TURBIDITY_UNIT
 = 233,

839 
	mUNITS_PH
 = 234,

840 
	mUNITS_GRAMS_PER_SQUARE_METER
 = 235,

841 
	mUNITS_MINUTES_PER_DEGREE_KELVIN
 = 236,

842 
	mUNITS_OHM_METER_SQUARED_PER_METER
 = 237,

843 
	mUNITS_AMPERE_SECONDS
 = 238,

844 
	mUNITS_VOLT_AMPERE_HOURS
 = 239,

845 
	mUNITS_KILOVOLT_AMPERE_HOURS
 = 240,

846 
	mUNITS_MEGAVOLT_AMPERE_HOURS
 = 241,

847 
	mUNITS_VOLT_AMPERE_HOURS_REACTIVE
 = 242,

848 
	mUNITS_KILOVOLT_AMPERE_HOURS_REACTIVE
 = 243,

849 
	mUNITS_MEGAVOLT_AMPERE_HOURS_REACTIVE
 = 244,

850 
	mUNITS_VOLT_SQUARE_HOURS
 = 245,

851 
	mUNITS_AMPERE_SQUARE_HOURS
 = 246,

852 
	mUNITS_JOULE_PER_HOURS
 = 247,

853 
	mUNITS_CUBIC_FEET_PER_DAY
 = 248,

854 
	mUNITS_CUBIC_METERS_PER_DAY
 = 249,

855 
	mUNITS_WATT_HOURS_PER_CUBIC_METER
 = 250,

856 
	mUNITS_JOULES_PER_CUBIC_METER
 = 251,

857 
	mUNITS_MOLE_PERCENT
 = 252,

858 
	mUNITS_PASCAL_SECONDS
 = 253,

859 
	mUNITS_MILLION_STANDARD_CUBIC_FEET_PER_MINUTE
 = 254,

861 
	mUNITS_STANDARD_CUBIC_FEET_PER_DAY
 = 47808,

862 
	mUNITS_MILLION_STANDARD_CUBIC_FEET_PER_DAY
 = 47809,

863 
	mUNITS_THOUSAND_CUBIC_FEET_PER_DAY
 = 47810,

864 
	mUNITS_THOUSAND_STANDARD_CUBIC_FEET_PER_DAY
 = 47811,

865 
	mUNITS_POUNDS_MASS_PER_DAY
 = 47812,

867 
	mUNITS_MILLIREMS
 = 47814,

868 
	mUNITS_MILLIREMS_PER_HOUR
 = 47815,

876 
	mUNITS_PROPRIETARY_RANGE_MIN
 = 256,

877 
	mUNITS_PROPRIETARY_RANGE_MAX
 = 65535

878 } 
	tBACNET_ENGINEERING_UNITS
;

881 
	mPOLARITY_NORMAL
 = 0,

882 
	mPOLARITY_REVERSE
 = 1,

883 
	mMAX_POLARITY
 = 2

884 } 
	tBACNET_POLARITY
;

887 
	mPROGRAM_REQUEST_READY
 = 0,

888 
	mPROGRAM_REQUEST_LOAD
 = 1,

889 
	mPROGRAM_REQUEST_RUN
 = 2,

890 
	mPROGRAM_REQUEST_HALT
 = 3,

891 
	mPROGRAM_REQUEST_RESTART
 = 4,

892 
	mPROGRAM_REQUEST_UNLOAD
 = 5

893 } 
	tBACNET_PROGRAM_REQUEST
;

896 
	mPROGRAM_STATE_IDLE
 = 0,

897 
	mPROGRAM_STATE_LOADING
 = 1,

898 
	mPROGRAM_STATE_RUNNING
 = 2,

899 
	mPROGRAM_STATE_WAITING
 = 3,

900 
	mPROGRAM_STATE_HALTED
 = 4,

901 
	mPROGRAM_STATE_UNLOADING
 = 5

902 } 
	tBACNET_PROGRAM_STATE
;

905 
	mPROGRAM_ERROR_NORMAL
 = 0,

906 
	mPROGRAM_ERROR_LOAD_FAILED
 = 1,

907 
	mPROGRAM_ERROR_INTERNAL
 = 2,

908 
	mPROGRAM_ERROR_PROGRAM
 = 3,

909 
	mPROGRAM_ERROR_OTHER
 = 4,

916 
	mPROGRAM_ERROR_PROPRIETARY_MIN
 = 64,

917 
	mPROGRAM_ERROR_PROPRIETARY_MAX
 = 65535

918 } 
	tBACNET_PROGRAM_ERROR
;

921 
	mRESTART_REASON_UNKNOWN
 = 0,

922 
	mRESTART_REASON_COLDSTART
 = 1,

923 
	mRESTART_REASON_WARMSTART
 = 2,

924 
	mRESTART_REASON_DETECTED_POWER_LOST
 = 3,

925 
	mRESTART_REASON_DETECTED_POWER_OFF
 = 4,

926 
	mRESTART_REASON_HARDWARE_WATCHDOG
 = 5,

927 
	mRESTART_REASON_SOFTWARE_WATCHDOG
 = 6,

928 
	mRESTART_REASON_SUSPENDED
 = 7,

935 
	mRESTART_REASON_PROPRIETARY_MIN
 = 64,

936 
	mRESTART_REASON_PROPRIETARY_MAX
 = 255

937 } 
	tBACNET_RESTART_REASON
;

940 
	mPROP_STATE_BOOLEAN_VALUE
 = 0,

941 
	mPROP_STATE_BINARY_VALUE
 = 1,

942 
	mPROP_STATE_EVENT_TYPE
 = 2,

943 
	mPROP_STATE_POLARITY
 = 3,

944 
	mPROP_STATE_PROGRAM_CHANGE
 = 4,

945 
	mPROP_STATE_PROGRAM_STATE
 = 5,

946 
	mPROP_STATE_REASON_FOR_HALT
 = 6,

947 
	mPROP_STATE_RELIABILITY
 = 7,

948 
	mPROP_STATE_EVENT_STATE
 = 8,

949 
	mPROP_STATE_SYSTEM_STATUS
 = 9,

950 
	mPROP_STATE_UNITS
 = 10,

951 
	mPROP_STATE_UNSIGNED_VALUE
 = 11,

952 
	mPROP_STATE_LIFE_SAFETY_MODE
 = 12,

953 
	mPROP_STATE_LIFE_SAFETY_STATE
 = 13,

954 
	mPROP_STATE_RESTART_REASON
 = 14,

955 
	mPROP_STATE_DOOR_ALARM_STATE
 = 15,

956 
	mPROP_STATE_ACTION
 = 16,

957 
	mPROP_STATE_DOOR_SECURED_STATUS
 = 17,

958 
	mPROP_STATE_DOOR_STATUS
 = 18,

959 
	mPROP_STATE_DOOR_VALUE
 = 19,

960 
	mPROP_STATE_FILE_ACCESS_METHOD
 = 20,

961 
	mPROP_STATE_LOCK_STATUS
 = 21,

962 
	mPROP_STATE_LIFE_SAFETY_OPERATION
 = 22,

963 
	mPROP_STATE_MAINTENANCE
 = 23,

964 
	mPROP_STATE_NODE_TYPE
 = 24,

965 
	mPROP_STATE_NOTIFY_TYPE
 = 25,

966 
	mPROP_STATE_SECURITY_LEVEL
 = 26,

967 
	mPROP_STATE_SHED_STATE
 = 27,

968 
	mPROP_STATE_SILENCED_STATE
 = 28,

969 
	mPROP_STATE_ACCESS_EVENT
 = 30,

970 
	mPROP_STATE_ZONE_OCCUPANCY_STATE
 = 31,

971 
	mPROP_STATE_ACCESS_CRED_DISABLE_REASON
 = 32,

972 
	mPROP_STATE_ACCESS_CRED_DISABLE
 = 33,

973 
	mPROP_STATE_AUTHENTICATION_STATUS
 = 34

974 } 
	tBACNET_PROPERTY_STATES
;

977 
	mRELIABILITY_NO_FAULT_DETECTED
 = 0,

978 
	mRELIABILITY_NO_SENSOR
 = 1,

979 
	mRELIABILITY_OVER_RANGE
 = 2,

980 
	mRELIABILITY_UNDER_RANGE
 = 3,

981 
	mRELIABILITY_OPEN_LOOP
 = 4,

982 
	mRELIABILITY_SHORTED_LOOP
 = 5,

983 
	mRELIABILITY_NO_OUTPUT
 = 6,

984 
	mRELIABILITY_UNRELIABLE_OTHER
 = 7,

985 
	mRELIABILITY_PROCESS_ERROR
 = 8,

986 
	mRELIABILITY_MULTI_STATE_FAULT
 = 9,

987 
	mRELIABILITY_CONFIGURATION_ERROR
 = 10,

988 
	mRELIABILITY_MEMBER_FAULT
 = 11,

989 
	mRELIABILITY_COMMUNICATION_FAILURE
 = 12,

990 
	mRELIABILITY_TRIPPED
 = 13,

997 
	mRELIABILITY_PROPRIETARY_MIN
 = 64,

998 
	mRELIABILITY_PROPRIETARY_MAX
 = 65535

999 } 
	tBACNET_RELIABILITY
;

1002 
	mEVENT_CHANGE_OF_BITSTRING
 = 0,

1003 
	mEVENT_CHANGE_OF_STATE
 = 1,

1004 
	mEVENT_CHANGE_OF_VALUE
 = 2,

1005 
	mEVENT_COMMAND_FAILURE
 = 3,

1006 
	mEVENT_FLOATING_LIMIT
 = 4,

1007 
	mEVENT_OUT_OF_RANGE
 = 5,

1010 
	mEVENT_CHANGE_OF_LIFE_SAFETY
 = 8,

1011 
	mEVENT_EXTENDED
 = 9,

1012 
	mEVENT_BUFFER_READY
 = 10,

1013 
	mEVENT_UNSIGNED_RANGE
 = 11,

1014 
	mEVENT_ACCESS_EVENT
 = 13,

1015 
	mEVENT_DOUBLE_OUT_OF_RANGE
 = 14,

1016 
	mEVENT_SIGNED_OUT_OF_RANGE
 = 15,

1017 
	mEVENT_UNSIGNED_OUT_OF_RANGE
 = 16,

1018 
	mEVENT_CHANGE_OF_CHARACTERSTRING
 = 17,

1019 
	mEVENT_CHANGE_OF_STATUS_FLAGS
 = 18,

1020 
	mEVENT_CHANGE_OF_RELIABILITY
 = 19,

1021 
	mEVENT_NONE
 = 20,

1022 
	mEVENT_CHANGE_OF_DISCRETE_VALUE
 = 21,

1023 
	mEVENT_CHANGE_OF_TIMER
 = 22,

1034 
	mEVENT_PROPRIETARY_MIN
 = 64,

1035 
	mEVENT_PROPRIETARY_MAX
 = 65535

1036 } 
	tBACNET_EVENT_TYPE
;

1039 
	mFILE_RECORD_ACCESS
 = 0,

1040 
	mFILE_STREAM_ACCESS
 = 1,

1041 
	mFILE_RECORD_AND_STREAM_ACCESS
 = 2

1042 } 
	tBACNET_FILE_ACCESS_METHOD
;

1045 
	mMIN_LIFE_SAFETY_MODE
 = 0,

1046 
	mLIFE_SAFETY_MODE_OFF
 = 0,

1047 
	mLIFE_SAFETY_MODE_ON
 = 1,

1048 
	mLIFE_SAFETY_MODE_TEST
 = 2,

1049 
	mLIFE_SAFETY_MODE_MANNED
 = 3,

1050 
	mLIFE_SAFETY_MODE_UNMANNED
 = 4,

1051 
	mLIFE_SAFETY_MODE_ARMED
 = 5,

1052 
	mLIFE_SAFETY_MODE_DISARMED
 = 6,

1053 
	mLIFE_SAFETY_MODE_PREARMED
 = 7,

1054 
	mLIFE_SAFETY_MODE_SLOW
 = 8,

1055 
	mLIFE_SAFETY_MODE_FAST
 = 9,

1056 
	mLIFE_SAFETY_MODE_DISCONNECTED
 = 10,

1057 
	mLIFE_SAFETY_MODE_ENABLED
 = 11,

1058 
	mLIFE_SAFETY_MODE_DISABLED
 = 12,

1059 
	mLIFE_SAFETY_MODE_AUTOMATIC_RELEASE_DISABLED
 = 13,

1060 
	mLIFE_SAFETY_MODE_DEFAULT
 = 14,

1061 
	mMAX_LIFE_SAFETY_MODE
 = 15,

1068 
	mLIFE_SAFETY_MODE_PROPRIETARY_MIN
 = 256,

1069 
	mLIFE_SAFETY_MODE_PROPRIETARY_MAX
 = 65535

1070 } 
	tBACNET_LIFE_SAFETY_MODE
;

1073 
	mLIFE_SAFETY_OP_NONE
 = 0,

1074 
	mLIFE_SAFETY_OP_SILENCE
 = 1,

1075 
	mLIFE_SAFETY_OP_SILENCE_AUDIBLE
 = 2,

1076 
	mLIFE_SAFETY_OP_SILENCE_VISUAL
 = 3,

1077 
	mLIFE_SAFETY_OP_RESET
 = 4,

1078 
	mLIFE_SAFETY_OP_RESET_ALARM
 = 5,

1079 
	mLIFE_SAFETY_OP_RESET_FAULT
 = 6,

1080 
	mLIFE_SAFETY_OP_UNSILENCE
 = 7,

1081 
	mLIFE_SAFETY_OP_UNSILENCE_AUDIBLE
 = 8,

1082 
	mLIFE_SAFETY_OP_UNSILENCE_VISUAL
 = 9,

1089 
	mLIFE_SAFETY_OP_PROPRIETARY_MIN
 = 64,

1090 
	mLIFE_SAFETY_OP_PROPRIETARY_MAX
 = 65535

1091 } 
	tBACNET_LIFE_SAFETY_OPERATION
;

1094 
	mMIN_LIFE_SAFETY_STATE
 = 0,

1095 
	mLIFE_SAFETY_STATE_QUIET
 = 0,

1096 
	mLIFE_SAFETY_STATE_PRE_ALARM
 = 1,

1097 
	mLIFE_SAFETY_STATE_ALARM
 = 2,

1098 
	mLIFE_SAFETY_STATE_FAULT
 = 3,

1099 
	mLIFE_SAFETY_STATE_FAULT_PRE_ALARM
 = 4,

1100 
	mLIFE_SAFETY_STATE_FAULT_ALARM
 = 5,

1101 
	mLIFE_SAFETY_STATE_NOT_READY
 = 6,

1102 
	mLIFE_SAFETY_STATE_ACTIVE
 = 7,

1103 
	mLIFE_SAFETY_STATE_TAMPER
 = 8,

1104 
	mLIFE_SAFETY_STATE_TEST_ALARM
 = 9,

1105 
	mLIFE_SAFETY_STATE_TEST_ACTIVE
 = 10,

1106 
	mLIFE_SAFETY_STATE_TEST_FAULT
 = 11,

1107 
	mLIFE_SAFETY_STATE_TEST_FAULT_ALARM
 = 12,

1108 
	mLIFE_SAFETY_STATE_HOLDUP
 = 13,

1109 
	mLIFE_SAFETY_STATE_DURESS
 = 14,

1110 
	mLIFE_SAFETY_STATE_TAMPER_ALARM
 = 15,

1111 
	mLIFE_SAFETY_STATE_ABNORMAL
 = 16,

1112 
	mLIFE_SAFETY_STATE_EMERGENCY_POWER
 = 17,

1113 
	mLIFE_SAFETY_STATE_DELAYED
 = 18,

1114 
	mLIFE_SAFETY_STATE_BLOCKED
 = 19,

1115 
	mLIFE_SAFETY_STATE_LOCAL_ALARM
 = 20,

1116 
	mLIFE_SAFETY_STATE_GENERAL_ALARM
 = 21,

1117 
	mLIFE_SAFETY_STATE_SUPERVISORY
 = 22,

1118 
	mLIFE_SAFETY_STATE_TEST_SUPERVISORY
 = 23,

1119 
	mMAX_LIFE_SAFETY_STATE
 = 24,

1126 
	mLIFE_SAFETY_STATE_PROPRIETARY_MIN
 = 256,

1127 
	mLIFE_SAFETY_STATE_PROPRIETARY_MAX
 = 65535

1128 } 
	tBACNET_LIFE_SAFETY_STATE
;

1131 
	mSILENCED_STATE_UNSILENCED
 = 0,

1132 
	mSILENCED_STATE_AUDIBLE_SILENCED
 = 1,

1133 
	mSILENCED_STATE_VISIBLE_SILENCED
 = 2,

1134 
	mSILENCED_STATE_ALL_SILENCED
 = 3,

1141 
	mSILENCED_STATE_PROPRIETARY_MIN
 = 64,

1142 
	mSILENCED_STATE_PROPRIETARY_MAX
 = 65535

1143 } 
	tBACNET_SILENCED_STATE
;

1146 
	mMAINTENANCE_NONE
 = 0,

1147 
	mMAINTENANCE_PERIODIC_TEST
 = 1,

1148 
	mMAINTENANCE_NEED_SERVICE_OPERATIONAL
 = 2,

1149 
	mMAINTENANCE_NEED_SERVICE_INOPERATIVE
 = 3,

1156 
	mMAINTENANCE_PROPRIETARY_MIN
 = 256,

1157 
	mMAINTENANCE_PROPRIETARY_MAX
 = 65535

1158 } 
	tBACNET_MAINTENANCE
;

1161 
	mNOTIFY_ALARM
 = 0,

1162 
	mNOTIFY_EVENT
 = 1,

1163 
	mNOTIFY_ACK_NOTIFICATION
 = 2

1164 } 
	tBACNET_NOTIFY_TYPE
;

1167 
	mOBJECT_ANALOG_INPUT
 = 0,

1168 
	mOBJECT_ANALOG_OUTPUT
 = 1,

1169 
	mOBJECT_ANALOG_VALUE
 = 2,

1170 
	mOBJECT_BINARY_INPUT
 = 3,

1171 
	mOBJECT_BINARY_OUTPUT
 = 4,

1172 
	mOBJECT_BINARY_VALUE
 = 5,

1173 
	mOBJECT_CALENDAR
 = 6,

1174 
	mOBJECT_COMMAND
 = 7,

1175 
	mOBJECT_DEVICE
 = 8,

1176 
	mOBJECT_EVENT_ENROLLMENT
 = 9,

1177 
	mOBJECT_FILE
 = 10,

1178 
	mOBJECT_GROUP
 = 11,

1179 
	mOBJECT_LOOP
 = 12,

1180 
	mOBJECT_MULTI_STATE_INPUT
 = 13,

1181 
	mOBJECT_MULTI_STATE_OUTPUT
 = 14,

1182 
	mOBJECT_NOTIFICATION_CLASS
 = 15,

1183 
	mOBJECT_PROGRAM
 = 16,

1184 
	mOBJECT_SCHEDULE
 = 17,

1185 
	mOBJECT_AVERAGING
 = 18,

1186 
	mOBJECT_MULTI_STATE_VALUE
 = 19,

1187 
	mOBJECT_TRENDLOG
 = 20,

1188 
	mOBJECT_LIFE_SAFETY_POINT
 = 21,

1189 
	mOBJECT_LIFE_SAFETY_ZONE
 = 22,

1190 
	mOBJECT_ACCUMULATOR
 = 23,

1191 
	mOBJECT_PULSE_CONVERTER
 = 24,

1192 
	mOBJECT_EVENT_LOG
 = 25,

1193 
	mOBJECT_GLOBAL_GROUP
 = 26,

1194 
	mOBJECT_TREND_LOG_MULTIPLE
 = 27,

1195 
	mOBJECT_LOAD_CONTROL
 = 28,

1196 
	mOBJECT_STRUCTURED_VIEW
 = 29,

1197 
	mOBJECT_ACCESS_DOOR
 = 30,

1198 
	mOBJECT_TIMER
 = 31,

1200 
	mOBJECT_ACCESS_CREDENTIAL
 = 32,

1201 
	mOBJECT_ACCESS_POINT
 = 33,

1202 
	mOBJECT_ACCESS_RIGHTS
 = 34,

1203 
	mOBJECT_ACCESS_USER
 = 35,

1204 
	mOBJECT_ACCESS_ZONE
 = 36,

1205 
	mOBJECT_CREDENTIAL_DATA_INPUT
 = 37,

1206 
	mOBJECT_NETWORK_SECURITY
 = 38,

1207 
	mOBJECT_BITSTRING_VALUE
 = 39,

1208 
	mOBJECT_CHARACTERSTRING_VALUE
 = 40,

1209 
	mOBJECT_DATE_PATTERN_VALUE
 = 41,

1210 
	mOBJECT_DATE_VALUE
 = 42,

1211 
	mOBJECT_DATETIME_PATTERN_VALUE
 = 43,

1212 
	mOBJECT_DATETIME_VALUE
 = 44,

1213 
	mOBJECT_INTEGER_VALUE
 = 45,

1214 
	mOBJECT_LARGE_ANALOG_VALUE
 = 46,

1215 
	mOBJECT_OCTETSTRING_VALUE
 = 47,

1216 
	mOBJECT_POSITIVE_INTEGER_VALUE
 = 48,

1217 
	mOBJECT_TIME_PATTERN_VALUE
 = 49,

1218 
	mOBJECT_TIME_VALUE
 = 50,

1219 
	mOBJECT_NOTIFICATION_FORWARDER
 = 51,

1220 
	mOBJECT_ALERT_ENROLLMENT
 = 52,

1221 
	mOBJECT_CHANNEL
 = 53,

1222 
	mOBJECT_LIGHTING_OUTPUT
 = 54,

1223 
	mOBJECT_BINARY_LIGHTING_OUTPUT
 = 55,

1224 
	mOBJECT_NETWORK_PORT
 = 56,

1231 
	mOBJECT_PROPRIETARY_MIN
 = 128,

1232 
	mOBJECT_PROPRIETARY_MAX
 = 1023,

1233 
	mMAX_BACNET_OBJECT_TYPE
 = 1024

1234 } 
	tBACNET_OBJECT_TYPE
;

1237 
	mSEGMENTATION_BOTH
 = 0,

1238 
	mSEGMENTATION_TRANSMIT
 = 1,

1239 
	mSEGMENTATION_RECEIVE
 = 2,

1240 
	mSEGMENTATION_NONE
 = 3,

1241 
	mMAX_BACNET_SEGMENTATION
 = 4

1242 } 
	tBACNET_SEGMENTATION
;

1245 
	mVT_CLASS_DEFAULT
 = 0,

1246 
	mVT_CLASS_ANSI_X34
 = 1,

1247 
	mVT_CLASS_DEC_VT52
 = 2,

1248 
	mVT_CLASS_DEC_VT100
 = 3,

1249 
	mVT_CLASS_DEC_VT220
 = 4,

1250 
	mVT_CLASS_HP_700_94
 = 5,

1251 
	mVT_CLASS_IBM_3130
 = 6,

1258 
	mVT_CLASS_PROPRIETARY_MIN
 = 64,

1259 
	mVT_CLASS_PROPRIETARY_MAX
 = 65535

1260 } 
	tBACNET_VT_CLASS
;

1263 
	mCHARACTER_ANSI_X34
 = 0,

1264 
	mCHARACTER_UTF8
 = 0,

1265 
	mCHARACTER_MS_DBCS
 = 1,

1266 
	mCHARACTER_JISC_6226
 = 2,

1267 
	mCHARACTER_UCS4
 = 3,

1268 
	mCHARACTER_UCS2
 = 4,

1269 
	mCHARACTER_ISO8859
 = 5,

1270 
	mMAX_CHARACTER_STRING_ENCODING
 = 6

1271 } 
	tBACNET_CHARACTER_STRING_ENCODING
;

1274 
	mBACNET_APPLICATION_TAG_NULL
 = 0,

1275 
	mBACNET_APPLICATION_TAG_BOOLEAN
 = 1,

1276 
	mBACNET_APPLICATION_TAG_UNSIGNED_INT
 = 2,

1277 
	mBACNET_APPLICATION_TAG_SIGNED_INT
 = 3,

1278 
	mBACNET_APPLICATION_TAG_REAL
 = 4,

1279 
	mBACNET_APPLICATION_TAG_DOUBLE
 = 5,

1280 
	mBACNET_APPLICATION_TAG_OCTET_STRING
 = 6,

1281 
	mBACNET_APPLICATION_TAG_CHARACTER_STRING
 = 7,

1282 
	mBACNET_APPLICATION_TAG_BIT_STRING
 = 8,

1283 
	mBACNET_APPLICATION_TAG_ENUMERATED
 = 9,

1284 
	mBACNET_APPLICATION_TAG_DATE
 = 10,

1285 
	mBACNET_APPLICATION_TAG_TIME
 = 11,

1286 
	mBACNET_APPLICATION_TAG_OBJECT_ID
 = 12,

1287 
	mBACNET_APPLICATION_TAG_RESERVE1
 = 13,

1288 
	mBACNET_APPLICATION_TAG_RESERVE2
 = 14,

1289 
	mBACNET_APPLICATION_TAG_RESERVE3
 = 15,

1290 
	mMAX_BACNET_APPLICATION_TAG
 = 16,

1295 
	mBACNET_APPLICATION_TAG_EMPTYLIST
,

1297 
	mBACNET_APPLICATION_TAG_WEEKNDAY
,

1299 
	mBACNET_APPLICATION_TAG_DATERANGE
,

1301 
	mBACNET_APPLICATION_TAG_DATETIME
,

1303 
	mBACNET_APPLICATION_TAG_TIMESTAMP
,

1305 
	mBACNET_APPLICATION_TAG_ERROR
,

1307 
	mBACNET_APPLICATION_TAG_DEVICE_OBJECT_PROPERTY_REFERENCE
,

1309 
	mBACNET_APPLICATION_TAG_DEVICE_OBJECT_REFERENCE
,

1311 
	mBACNET_APPLICATION_TAG_OBJECT_PROPERTY_REFERENCE
,

1313 
	mBACNET_APPLICATION_TAG_DESTINATION
,

1315 
	mBACNET_APPLICATION_TAG_RECIPIENT
,

1317 
	mBACNET_APPLICATION_TAG_COV_SUBSCRIPTION
,

1319 
	mBACNET_APPLICATION_TAG_CALENDAR_ENTRY
,

1321 
	mBACNET_APPLICATION_TAG_WEEKLY_SCHEDULE
,

1323 
	mBACNET_APPLICATION_TAG_SPECIAL_EVENT
,

1325 
	mBACNET_APPLICATION_TAG_READ_ACCESS_SPECIFICATION
,

1327 
	mBACNET_APPLICATION_TAG_LIGHTING_COMMAND


1328 } 
	tBACNET_APPLICATION_TAG
;

1333 
	mPDU_TYPE_CONFIRMED_SERVICE_REQUEST
 = 0,

1334 
	mPDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
 = 0x10,

1335 
	mPDU_TYPE_SIMPLE_ACK
 = 0x20,

1336 
	mPDU_TYPE_COMPLEX_ACK
 = 0x30,

1337 
	mPDU_TYPE_SEGMENT_ACK
 = 0x40,

1338 
	mPDU_TYPE_ERROR
 = 0x50,

1339 
	mPDU_TYPE_REJECT
 = 0x60,

1340 
	mPDU_TYPE_ABORT
 = 0x70

1341 } 
	tBACNET_PDU_TYPE
;

1345 
	mSERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
 = 0,

1346 
	mSERVICE_CONFIRMED_COV_NOTIFICATION
 = 1,

1347 
	mSERVICE_CONFIRMED_EVENT_NOTIFICATION
 = 2,

1348 
	mSERVICE_CONFIRMED_GET_ALARM_SUMMARY
 = 3,

1349 
	mSERVICE_CONFIRMED_GET_ENROLLMENT_SUMMARY
 = 4,

1350 
	mSERVICE_CONFIRMED_GET_EVENT_INFORMATION
 = 29,

1351 
	mSERVICE_CONFIRMED_SUBSCRIBE_COV
 = 5,

1352 
	mSERVICE_CONFIRMED_SUBSCRIBE_COV_PROPERTY
 = 28,

1353 
	mSERVICE_CONFIRMED_LIFE_SAFETY_OPERATION
 = 27,

1355 
	mSERVICE_CONFIRMED_ATOMIC_READ_FILE
 = 6,

1356 
	mSERVICE_CONFIRMED_ATOMIC_WRITE_FILE
 = 7,

1358 
	mSERVICE_CONFIRMED_ADD_LIST_ELEMENT
 = 8,

1359 
	mSERVICE_CONFIRMED_REMOVE_LIST_ELEMENT
 = 9,

1360 
	mSERVICE_CONFIRMED_CREATE_OBJECT
 = 10,

1361 
	mSERVICE_CONFIRMED_DELETE_OBJECT
 = 11,

1362 
	mSERVICE_CONFIRMED_READ_PROPERTY
 = 12,

1363 
	mSERVICE_CONFIRMED_READ_PROP_CONDITIONAL
 = 13,

1364 
	mSERVICE_CONFIRMED_READ_PROP_MULTIPLE
 = 14,

1365 
	mSERVICE_CONFIRMED_READ_RANGE
 = 26,

1366 
	mSERVICE_CONFIRMED_WRITE_PROPERTY
 = 15,

1367 
	mSERVICE_CONFIRMED_WRITE_PROP_MULTIPLE
 = 16,

1369 
	mSERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
 = 17,

1370 
	mSERVICE_CONFIRMED_PRIVATE_TRANSFER
 = 18,

1371 
	mSERVICE_CONFIRMED_TEXT_MESSAGE
 = 19,

1372 
	mSERVICE_CONFIRMED_REINITIALIZE_DEVICE
 = 20,

1374 
	mSERVICE_CONFIRMED_VT_OPEN
 = 21,

1375 
	mSERVICE_CONFIRMED_VT_CLOSE
 = 22,

1376 
	mSERVICE_CONFIRMED_VT_DATA
 = 23,

1378 
	mSERVICE_CONFIRMED_AUTHENTICATE
 = 24,

1379 
	mSERVICE_CONFIRMED_REQUEST_KEY
 = 25,

1385 
	mMAX_BACNET_CONFIRMED_SERVICE
 = 30

1386 } 
	tBACNET_CONFIRMED_SERVICE
;

1389 
	mSERVICE_UNCONFIRMED_I_AM
 = 0,

1390 
	mSERVICE_UNCONFIRMED_I_HAVE
 = 1,

1391 
	mSERVICE_UNCONFIRMED_COV_NOTIFICATION
 = 2,

1392 
	mSERVICE_UNCONFIRMED_EVENT_NOTIFICATION
 = 3,

1393 
	mSERVICE_UNCONFIRMED_PRIVATE_TRANSFER
 = 4,

1394 
	mSERVICE_UNCONFIRMED_TEXT_MESSAGE
 = 5,

1395 
	mSERVICE_UNCONFIRMED_TIME_SYNCHRONIZATION
 = 6,

1396 
	mSERVICE_UNCONFIRMED_WHO_HAS
 = 7,

1397 
	mSERVICE_UNCONFIRMED_WHO_IS
 = 8,

1398 
	mSERVICE_UNCONFIRMED_UTC_TIME_SYNCHRONIZATION
 = 9,

1400 
	mSERVICE_UNCONFIRMED_WRITE_GROUP
 = 10,

1406 
	mMAX_BACNET_UNCONFIRMED_SERVICE
 = 11

1407 } 
	tBACNET_UNCONFIRMED_SERVICE
;

1412 
	mSERVICE_SUPPORTED_ACKNOWLEDGE_ALARM
 = 0,

1413 
	mSERVICE_SUPPORTED_CONFIRMED_COV_NOTIFICATION
 = 1,

1414 
	mSERVICE_SUPPORTED_CONFIRMED_EVENT_NOTIFICATION
 = 2,

1415 
	mSERVICE_SUPPORTED_GET_ALARM_SUMMARY
 = 3,

1416 
	mSERVICE_SUPPORTED_GET_ENROLLMENT_SUMMARY
 = 4,

1417 
	mSERVICE_SUPPORTED_GET_EVENT_INFORMATION
 = 39,

1418 
	mSERVICE_SUPPORTED_SUBSCRIBE_COV
 = 5,

1419 
	mSERVICE_SUPPORTED_SUBSCRIBE_COV_PROPERTY
 = 38,

1420 
	mSERVICE_SUPPORTED_LIFE_SAFETY_OPERATION
 = 37,

1422 
	mSERVICE_SUPPORTED_ATOMIC_READ_FILE
 = 6,

1423 
	mSERVICE_SUPPORTED_ATOMIC_WRITE_FILE
 = 7,

1425 
	mSERVICE_SUPPORTED_ADD_LIST_ELEMENT
 = 8,

1426 
	mSERVICE_SUPPORTED_REMOVE_LIST_ELEMENT
 = 9,

1427 
	mSERVICE_SUPPORTED_CREATE_OBJECT
 = 10,

1428 
	mSERVICE_SUPPORTED_DELETE_OBJECT
 = 11,

1429 
	mSERVICE_SUPPORTED_READ_PROPERTY
 = 12,

1430 
	mSERVICE_SUPPORTED_READ_PROP_CONDITIONAL
 = 13,

1431 
	mSERVICE_SUPPORTED_READ_PROP_MULTIPLE
 = 14,

1432 
	mSERVICE_SUPPORTED_READ_RANGE
 = 35,

1433 
	mSERVICE_SUPPORTED_WRITE_PROPERTY
 = 15,

1434 
	mSERVICE_SUPPORTED_WRITE_PROP_MULTIPLE
 = 16,

1435 
	mSERVICE_SUPPORTED_WRITE_GROUP
 = 40,

1437 
	mSERVICE_SUPPORTED_DEVICE_COMMUNICATION_CONTROL
 = 17,

1438 
	mSERVICE_SUPPORTED_PRIVATE_TRANSFER
 = 18,

1439 
	mSERVICE_SUPPORTED_TEXT_MESSAGE
 = 19,

1440 
	mSERVICE_SUPPORTED_REINITIALIZE_DEVICE
 = 20,

1442 
	mSERVICE_SUPPORTED_VT_OPEN
 = 21,

1443 
	mSERVICE_SUPPORTED_VT_CLOSE
 = 22,

1444 
	mSERVICE_SUPPORTED_VT_DATA
 = 23,

1446 
	mSERVICE_SUPPORTED_AUTHENTICATE
 = 24,

1447 
	mSERVICE_SUPPORTED_REQUEST_KEY
 = 25,

1448 
	mSERVICE_SUPPORTED_I_AM
 = 26,

1449 
	mSERVICE_SUPPORTED_I_HAVE
 = 27,

1450 
	mSERVICE_SUPPORTED_UNCONFIRMED_COV_NOTIFICATION
 = 28,

1451 
	mSERVICE_SUPPORTED_UNCONFIRMED_EVENT_NOTIFICATION
 = 29,

1452 
	mSERVICE_SUPPORTED_UNCONFIRMED_PRIVATE_TRANSFER
 = 30,

1453 
	mSERVICE_SUPPORTED_UNCONFIRMED_TEXT_MESSAGE
 = 31,

1454 
	mSERVICE_SUPPORTED_TIME_SYNCHRONIZATION
 = 32,

1455 
	mSERVICE_SUPPORTED_UTC_TIME_SYNCHRONIZATION
 = 36,

1456 
	mSERVICE_SUPPORTED_WHO_HAS
 = 33,

1457 
	mSERVICE_SUPPORTED_WHO_IS
 = 34

1461 } 
	tBACNET_SERVICES_SUPPORTED
;

1464 
	mBVLC_RESULT
 = 0,

1465 
	mBVLC_WRITE_BROADCAST_DISTRIBUTION_TABLE
 = 1,

1466 
	mBVLC_READ_BROADCAST_DIST_TABLE
 = 2,

1467 
	mBVLC_READ_BROADCAST_DIST_TABLE_ACK
 = 3,

1468 
	mBVLC_FORWARDED_NPDU
 = 4,

1469 
	mBVLC_REGISTER_FOREIGN_DEVICE
 = 5,

1470 
	mBVLC_READ_FOREIGN_DEVICE_TABLE
 = 6,

1471 
	mBVLC_READ_FOREIGN_DEVICE_TABLE_ACK
 = 7,

1472 
	mBVLC_DELETE_FOREIGN_DEVICE_TABLE_ENTRY
 = 8,

1473 
	mBVLC_DISTRIBUTE_BROADCAST_TO_NETWORK
 = 9,

1474 
	mBVLC_ORIGINAL_UNICAST_NPDU
 = 10,

1475 
	mBVLC_ORIGINAL_BROADCAST_NPDU
 = 11,

1476 
	mBVLC_SECURE_BVLL
 = 12,

1477 
	mMAX_BVLC_FUNCTION
 = 13

1478 } 
	tBACNET_BVLC_FUNCTION
;

1481 
	mBVLC_RESULT_SUCCESSFUL_COMPLETION
 = 0x0000,

1482 
	mBVLC_RESULT_WRITE_BROADCAST_DISTRIBUTION_TABLE_NAK
 = 0x0010,

1483 
	mBVLC_RESULT_READ_BROADCAST_DISTRIBUTION_TABLE_NAK
 = 0x0020,

1484 
	mBVLC_RESULT_REGISTER_FOREIGN_DEVICE_NAK
 = 0X0030,

1485 
	mBVLC_RESULT_READ_FOREIGN_DEVICE_TABLE_NAK
 = 0x0040,

1486 
	mBVLC_RESULT_DELETE_FOREIGN_DEVICE_TABLE_ENTRY_NAK
 = 0x0050,

1487 
	mBVLC_RESULT_DISTRIBUTE_BROADCAST_TO_NETWORK_NAK
 = 0x0060

1488 } 
	tBACNET_BVLC_RESULT
;

1492 
	mSTATUS_FLAG_IN_ALARM
 = 0,

1493 
	mSTATUS_FLAG_FAULT
 = 1,

1494 
	mSTATUS_FLAG_OVERRIDDEN
 = 2,

1495 
	mSTATUS_FLAG_OUT_OF_SERVICE
 = 3

1496 } 
	tBACNET_STATUS_FLAGS
;

1499 
	mLOG_STATUS_LOG_DISABLED
 = 0,

1500 
	mLOG_STATUS_BUFFER_PURGED
 = 1,

1501 
	mLOG_STATUS_LOG_INTERRUPTED
 = 2

1502 } 
	tBACNET_LOG_STATUS
;

1505 
	mLOGGING_TYPE_POLLED
 = 0,

1506 
	mLOGGING_TYPE_COV
 = 1,

1507 
	mLOGGING_TYPE_TRIGGERED
 = 2

1508 } 
	tBACNET_LOGGING_TYPE
;

1511 
	mACKNOWLEDGMENT_FILTER_ALL
 = 0,

1512 
	mACKNOWLEDGMENT_FILTER_ACKED
 = 1,

1513 
	mACKNOWLEDGMENT_FILTER_NOT_ACKED
 = 2

1514 } 
	tBACNET_ACKNOWLEDGMENT_FILTER
;

1517 
	mEVENT_STATE_FILTER_OFFNORMAL
 = 0,

1518 
	mEVENT_STATE_FILTER_FAULT
 = 1,

1519 
	mEVENT_STATE_FILTER_NORMAL
 = 2,

1520 
	mEVENT_STATE_FILTER_ALL
 = 3,

1521 
	mEVENT_STATE_FILTER_ACTIVE
 = 4

1522 } 
	tBACNET_EVENT_STATE_FILTER
;

1525 
	mSELECTION_LOGIC_AND
 = 0,

1526 
	mSELECTION_LOGIC_OR
 = 1,

1527 
	mSELECTION_LOGIC_ALL
 = 2

1528 } 
	tBACNET_SELECTION_LOGIC
;

1531 
	mRELATION_SPECIFIER_EQUAL
 = 0,

1532 
	mRELATION_SPECIFIER_NOT_EQUAL
 = 1,

1533 
	mRELATION_SPECIFIER_LESS_THAN
 = 2,

1534 
	mRELATION_SPECIFIER_GREATER_THAN
 = 3,

1535 
	mRELATION_SPECIFIER_LESS_THAN_OR_EQUAL
 = 4,

1536 
	mRELATION_SPECIFIER_GREATER_THAN_OR_EQUAL
 = 5

1537 } 
	tBACNET_RELATION_SPECIFIER
;

1540 
	mCOMMUNICATION_ENABLE
 = 0,

1541 
	mCOMMUNICATION_DISABLE
 = 1,

1542 
	mCOMMUNICATION_DISABLE_INITIATION
 = 2,

1543 
	mMAX_BACNET_COMMUNICATION_ENABLE_DISABLE
 = 3

1544 } 
	tBACNET_COMMUNICATION_ENABLE_DISABLE
;

1547 
	mMESSAGE_PRIORITY_NORMAL
 = 0,

1548 
	mMESSAGE_PRIORITY_URGENT
 = 1,

1549 
	mMESSAGE_PRIORITY_CRITICAL_EQUIPMENT
 = 2,

1550 
	mMESSAGE_PRIORITY_LIFE_SAFETY
 = 3

1551 } 
	tBACNET_MESSAGE_PRIORITY
;

1558 
	mNETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
 = 0,

1559 
	mNETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
 = 1,

1560 
	mNETWORK_MESSAGE_I_COULD_BE_ROUTER_TO_NETWORK
 = 2,

1561 
	mNETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
 = 3,

1562 
	mNETWORK_MESSAGE_ROUTER_BUSY_TO_NETWORK
 = 4,

1563 
	mNETWORK_MESSAGE_ROUTER_AVAILABLE_TO_NETWORK
 = 5,

1564 
	mNETWORK_MESSAGE_INIT_RT_TABLE
 = 6,

1565 
	mNETWORK_MESSAGE_INIT_RT_TABLE_ACK
 = 7,

1566 
	mNETWORK_MESSAGE_ESTABLISH_CONNECTION_TO_NETWORK
 = 8,

1567 
	mNETWORK_MESSAGE_DISCONNECT_CONNECTION_TO_NETWORK
 = 9,

1568 
	mNETWORK_MESSAGE_CHALLENGE_REQUEST
 = 10,

1569 
	mNETWORK_MESSAGE_SECURITY_PAYLOAD
 = 11,

1570 
	mNETWORK_MESSAGE_SECURITY_RESPONSE
 = 12,

1571 
	mNETWORK_MESSAGE_REQUEST_KEY_UPDATE
 = 13,

1572 
	mNETWORK_MESSAGE_UPDATE_KEY_SET
 = 14,

1573 
	mNETWORK_MESSAGE_UPDATE_DISTRIBUTION_KEY
 = 15,

1574 
	mNETWORK_MESSAGE_REQUEST_MASTER_KEY
 = 16,

1575 
	mNETWORK_MESSAGE_SET_MASTER_KEY
 = 17,

1576 
	mNETWORK_MESSAGE_WHAT_IS_NETWORK_NUMBER
 = 18,

1577 
	mNETWORK_MESSAGE_NETWORK_NUMBER_IS
 = 19,

1580 
	mNETWORK_MESSAGE_INVALID
 = 0x100

1581 } 
	tBACNET_NETWORK_MESSAGE_TYPE
;

1584 
	mREINITIALIZED_STATE_COLD_START
 = 0,

1585 
	mREINITIALIZED_STATE_WARM_START
 = 1,

1586 
	mREINITIALIZED_STATE_START_BACKUP
 = 2,

1587 
	mREINITIALIZED_STATE_END_BACKUP
 = 3,

1588 
	mREINITIALIZED_STATE_START_RESTORE
 = 4,

1589 
	mREINITIALIZED_STATE_END_RESTORE
 = 5,

1590 
	mREINITIALIZED_STATE_ABORT_RESTORE
 = 6,

1591 
	mREINITIALIZED_STATE_IDLE
 = 255

1592 } 
	tBACNET_REINITIALIZED_STATE_OF_DEVICE
;

1595 
	mABORT_REASON_OTHER
 = 0,

1596 
	mABORT_REASON_BUFFER_OVERFLOW
 = 1,

1597 
	mABORT_REASON_INVALID_APDU_IN_THIS_STATE
 = 2,

1598 
	mABORT_REASON_PREEMPTED_BY_HIGHER_PRIORITY_TASK
 = 3,

1599 
	mABORT_REASON_SEGMENTATION_NOT_SUPPORTED
 = 4,

1600 
	mABORT_REASON_SECURITY_ERROR
 = 5,

1601 
	mABORT_REASON_INSUFFICIENT_SECURITY
 = 6,

1605 
	mMAX_BACNET_ABORT_REASON
 = 7,

1608 
	mFIRST_PROPRIETARY_ABORT_REASON
 = 64,

1609 
	mLAST_PROPRIETARY_ABORT_REASON
 = 65535

1610 } 
	tBACNET_ABORT_REASON
;

1613 
	mREJECT_REASON_OTHER
 = 0,

1614 
	mREJECT_REASON_BUFFER_OVERFLOW
 = 1,

1615 
	mREJECT_REASON_INCONSISTENT_PARAMETERS
 = 2,

1616 
	mREJECT_REASON_INVALID_PARAMETER_DATA_TYPE
 = 3,

1617 
	mREJECT_REASON_INVALID_TAG
 = 4,

1618 
	mREJECT_REASON_MISSING_REQUIRED_PARAMETER
 = 5,

1619 
	mREJECT_REASON_PARAMETER_OUT_OF_RANGE
 = 6,

1620 
	mREJECT_REASON_TOO_MANY_ARGUMENTS
 = 7,

1621 
	mREJECT_REASON_UNDEFINED_ENUMERATION
 = 8,

1622 
	mREJECT_REASON_UNRECOGNIZED_SERVICE
 = 9,

1626 
	mMAX_BACNET_REJECT_REASON
 = 10,

1629 
	mFIRST_PROPRIETARY_REJECT_REASON
 = 64,

1630 
	mLAST_PROPRIETARY_REJECT_REASON
 = 65535

1631 } 
	tBACNET_REJECT_REASON
;

1634 
	mERROR_CLASS_DEVICE
 = 0,

1635 
	mERROR_CLASS_OBJECT
 = 1,

1636 
	mERROR_CLASS_PROPERTY
 = 2,

1637 
	mERROR_CLASS_RESOURCES
 = 3,

1638 
	mERROR_CLASS_SECURITY
 = 4,

1639 
	mERROR_CLASS_SERVICES
 = 5,

1640 
	mERROR_CLASS_VT
 = 6,

1641 
	mERROR_CLASS_COMMUNICATION
 = 7,

1645 
	mMAX_BACNET_ERROR_CLASS
 = 8,

1648 
	mFIRST_PROPRIETARY_ERROR_CLASS
 = 64,

1649 
	mLAST_PROPRIETARY_ERROR_CLASS
 = 65535

1650 } 
	tBACNET_ERROR_CLASS
;

1658 
	mERROR_CODE_OTHER
 = 0,

1661 
	mERROR_CODE_DEVICE_BUSY
 = 3,

1662 
	mERROR_CODE_CONFIGURATION_IN_PROGRESS
 = 2,

1663 
	mERROR_CODE_OPERATIONAL_PROBLEM
 = 25,

1666 
	mERROR_CODE_DYNAMIC_CREATION_NOT_SUPPORTED
 = 4,

1667 
	mERROR_CODE_NO_OBJECTS_OF_SPECIFIED_TYPE
 = 17,

1668 
	mERROR_CODE_OBJECT_DELETION_NOT_PERMITTED
 = 23,

1669 
	mERROR_CODE_OBJECT_IDENTIFIER_ALREADY_EXISTS
 = 24,

1670 
	mERROR_CODE_READ_ACCESS_DENIED
 = 27,

1671 
	mERROR_CODE_UNKNOWN_OBJECT
 = 31,

1672 
	mERROR_CODE_UNSUPPORTED_OBJECT_TYPE
 = 36,

1675 
	mERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
 = 41,

1676 
	mERROR_CODE_DATATYPE_NOT_SUPPORTED
 = 47,

1677 
	mERROR_CODE_INCONSISTENT_SELECTION_CRITERION
 = 8,

1678 
	mERROR_CODE_INVALID_ARRAY_INDEX
 = 42,

1679 
	mERROR_CODE_INVALID_DATA_TYPE
 = 9,

1680 
	mERROR_CODE_NOT_COV_PROPERTY
 = 44,

1681 
	mERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
 = 45,

1682 
	mERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
 = 50,

1684 
	mERROR_CODE_UNKNOWN_PROPERTY
 = 32,

1685 
	mERROR_CODE_VALUE_OUT_OF_RANGE
 = 37,

1686 
	mERROR_CODE_WRITE_ACCESS_DENIED
 = 40,

1689 
	mERROR_CODE_NO_SPACE_FOR_OBJECT
 = 18,

1690 
	mERROR_CODE_NO_SPACE_TO_ADD_LIST_ELEMENT
 = 19,

1691 
	mERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
 = 20,

1694 
	mERROR_CODE_AUTHENTICATION_FAILED
 = 1,

1696 
	mERROR_CODE_INCOMPATIBLE_SECURITY_LEVELS
 = 6,

1697 
	mERROR_CODE_INVALID_OPERATOR_NAME
 = 12,

1698 
	mERROR_CODE_KEY_GENERATION_ERROR
 = 15,

1699 
	mERROR_CODE_PASSWORD_FAILURE
 = 26,

1700 
	mERROR_CODE_SECURITY_NOT_SUPPORTED
 = 28,

1701 
	mERROR_CODE_TIMEOUT
 = 30,

1705 
	mERROR_CODE_COV_SUBSCRIPTION_FAILED
 = 43,

1706 
	mERROR_CODE_DUPLICATE_NAME
 = 48,

1707 
	mERROR_CODE_DUPLICATE_OBJECT_ID
 = 49,

1708 
	mERROR_CODE_FILE_ACCESS_DENIED
 = 5,

1709 
	mERROR_CODE_INCONSISTENT_PARAMETERS
 = 7,

1710 
	mERROR_CODE_INVALID_CONFIGURATION_DATA
 = 46,

1711 
	mERROR_CODE_INVALID_FILE_ACCESS_METHOD
 = 10,

1712 
	mERROR_CODE_INVALID_FILE_START_POSITION
 = 11,

1713 
	mERROR_CODE_INVALID_PARAMETER_DATA_TYPE
 = 13,

1714 
	mERROR_CODE_INVALID_TIME_STAMP
 = 14,

1715 
	mERROR_CODE_MISSING_REQUIRED_PARAMETER
 = 16,

1717 
	mERROR_CODE_PROPERTY_IS_NOT_A_LIST
 = 22,

1718 
	mERROR_CODE_SERVICE_REQUEST_DENIED
 = 29,

1721 
	mERROR_CODE_UNKNOWN_VT_CLASS
 = 34,

1722 
	mERROR_CODE_UNKNOWN_VT_SESSION
 = 35,

1723 
	mERROR_CODE_NO_VT_SESSIONS_AVAILABLE
 = 21,

1724 
	mERROR_CODE_VT_SESSION_ALREADY_CLOSED
 = 38,

1725 
	mERROR_CODE_VT_SESSION_TERMINATION_FAILURE
 = 39,

1728 
	mERROR_CODE_RESERVED1
 = 33,

1730 
	mERROR_CODE_ABORT_BUFFER_OVERFLOW
 = 51,

1731 
	mERROR_CODE_ABORT_INVALID_APDU_IN_THIS_STATE
 = 52,

1732 
	mERROR_CODE_ABORT_PREEMPTED_BY_HIGHER_PRIORITY_TASK
 = 53,

1733 
	mERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
 = 54,

1734 
	mERROR_CODE_ABORT_PROPRIETARY
 = 55,

1735 
	mERROR_CODE_ABORT_OTHER
 = 56,

1736 
	mERROR_CODE_INVALID_TAG
 = 57,

1737 
	mERROR_CODE_NETWORK_DOWN
 = 58,

1738 
	mERROR_CODE_REJECT_BUFFER_OVERFLOW
 = 59,

1739 
	mERROR_CODE_REJECT_INCONSISTENT_PARAMETERS
 = 60,

1740 
	mERROR_CODE_REJECT_INVALID_PARAMETER_DATA_TYPE
 = 61,

1741 
	mERROR_CODE_REJECT_INVALID_TAG
 = 62,

1742 
	mERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
 = 63,

1743 
	mERROR_CODE_REJECT_PARAMETER_OUT_OF_RANGE
 = 64,

1744 
	mERROR_CODE_REJECT_TOO_MANY_ARGUMENTS
 = 65,

1745 
	mERROR_CODE_REJECT_UNDEFINED_ENUMERATION
 = 66,

1746 
	mERROR_CODE_REJECT_UNRECOGNIZED_SERVICE
 = 67,

1747 
	mERROR_CODE_REJECT_PROPRIETARY
 = 68,

1748 
	mERROR_CODE_REJECT_OTHER
 = 69,

1749 
	mERROR_CODE_UNKNOWN_DEVICE
 = 70,

1750 
	mERROR_CODE_UNKNOWN_ROUTE
 = 71,

1751 
	mERROR_CODE_VALUE_NOT_INITIALIZED
 = 72,

1752 
	mERROR_CODE_INVALID_EVENT_STATE
 = 73,

1753 
	mERROR_CODE_NO_ALARM_CONFIGURED
 = 74,

1754 
	mERROR_CODE_LOG_BUFFER_FULL
 = 75,

1755 
	mERROR_CODE_LOGGED_VALUE_PURGED
 = 76,

1756 
	mERROR_CODE_NO_PROPERTY_SPECIFIED
 = 77,

1757 
	mERROR_CODE_NOT_CONFIGURED_FOR_TRIGGERED_LOGGING
 = 78,

1758 
	mERROR_CODE_UNKNOWN_SUBSCRIPTION
 = 79,

1759 
	mERROR_CODE_PARAMETER_OUT_OF_RANGE
 = 80,

1760 
	mERROR_CODE_LIST_ELEMENT_NOT_FOUND
 = 81,

1761 
	mERROR_CODE_BUSY
 = 82,

1762 
	mERROR_CODE_COMMUNICATION_DISABLED
 = 83,

1763 
	mERROR_CODE_SUCCESS
 = 84,

1764 
	mERROR_CODE_ACCESS_DENIED
 = 85,

1765 
	mERROR_CODE_BAD_DESTINATION_ADDRESS
 = 86,

1766 
	mERROR_CODE_BAD_DESTINATION_DEVICE_ID
 = 87,

1767 
	mERROR_CODE_BAD_SIGNATURE
 = 88,

1768 
	mERROR_CODE_BAD_SOURCE_ADDRESS
 = 89,

1769 
	mERROR_CODE_BAD_TIMESTAMP
 = 90,

1770 
	mERROR_CODE_CANNOT_USE_KEY
 = 91,

1771 
	mERROR_CODE_CANNOT_VERIFY_MESSAGE_ID
 = 92,

1772 
	mERROR_CODE_CORRECT_KEY_REVISION
 = 93,

1773 
	mERROR_CODE_DESTINATION_DEVICE_ID_REQUIRED
 = 94,

1774 
	mERROR_CODE_DUPLICATE_MESSAGE
 = 95,

1775 
	mERROR_CODE_ENCRYPTION_NOT_CONFIGURED
 = 96,

1776 
	mERROR_CODE_ENCRYPTION_REQUIRED
 = 97,

1777 
	mERROR_CODE_INCORRECT_KEY
 = 98,

1778 
	mERROR_CODE_INVALID_KEY_DATA
 = 99,

1779 
	mERROR_CODE_KEY_UPDATE_IN_PROGRESS
 = 100,

1780 
	mERROR_CODE_MALFORMED_MESSAGE
 = 101,

1781 
	mERROR_CODE_NOT_KEY_SERVER
 = 102,

1782 
	mERROR_CODE_SECURITY_NOT_CONFIGURED
 = 103,

1783 
	mERROR_CODE_SOURCE_SECURITY_REQUIRED
 = 104,

1784 
	mERROR_CODE_TOO_MANY_KEYS
 = 105,

1785 
	mERROR_CODE_UNKNOWN_AUTHENTICATION_TYPE
 = 106,

1786 
	mERROR_CODE_UNKNOWN_KEY
 = 107,

1787 
	mERROR_CODE_UNKNOWN_KEY_REVISION
 = 108,

1788 
	mERROR_CODE_UNKNOWN_SOURCE_MESSAGE
 = 109,

1789 
	mERROR_CODE_NOT_ROUTER_TO_DNET
 = 110,

1790 
	mERROR_CODE_ROUTER_BUSY
 = 111,

1791 
	mERROR_CODE_UNKNOWN_NETWORK_MESSAGE
 = 112,

1792 
	mERROR_CODE_MESSAGE_TOO_LONG
 = 113,

1793 
	mERROR_CODE_SECURITY_ERROR
 = 114,

1794 
	mERROR_CODE_ADDRESSING_ERROR
 = 115,

1795 
	mERROR_CODE_WRITE_BDT_FAILED
 = 116,

1796 
	mERROR_CODE_READ_BDT_FAILED
 = 117,

1797 
	mERROR_CODE_REGISTER_FOREIGN_DEVICE_FAILED
 = 118,

1798 
	mERROR_CODE_READ_FDT_FAILED
 = 119,

1799 
	mERROR_CODE_DELETE_FDT_ENTRY_FAILED
 = 120,

1800 
	mERROR_CODE_DISTRIBUTE_BROADCAST_FAILED
 = 121,

1801 
	mERROR_CODE_UNKNOWN_FILE_SIZE
 = 122,

1802 
	mERROR_CODE_ABORT_APDU_TOO_LONG
 = 123,

1803 
	mERROR_CODE_ABORT_APPLICATION_EXCEEDED_REPLY_TIME
 = 124,

1804 
	mERROR_CODE_ABORT_OUT_OF_RESOURCES
 = 125,

1805 
	mERROR_CODE_ABORT_TSM_TIMEOUT
 = 126,

1806 
	mERROR_CODE_ABORT_WINDOW_SIZE_OUT_OF_RANGE
 = 127,

1807 
	mERROR_CODE_FILE_FULL
 = 128,

1808 
	mERROR_CODE_INCONSISTENT_CONFIGURATION
 = 129,

1809 
	mERROR_CODE_INCONSISTENT_OBJECT_TYPE
 = 130,

1810 
	mERROR_CODE_INTERNAL_ERROR
 = 131,

1811 
	mERROR_CODE_NOT_CONFIGURED
 = 132,

1812 
	mERROR_CODE_OUT_OF_MEMORY
 = 133,

1813 
	mERROR_CODE_VALUE_TOO_LONG
 = 134,

1814 
	mERROR_CODE_ABORT_INSUFFICIENT_SECURITY
 = 135,

1815 
	mERROR_CODE_ABORT_SECURITY_ERROR
 = 136,

1817 
	mMAX_BACNET_ERROR_CODE
 = 137,

1825 
	mFIRST_PROPRIETARY_ERROR_CODE
 = 256,

1826 
	mLAST_PROPRIETARY_ERROR_CODE
 = 65535

1827 } 
	tBACNET_ERROR_CODE
;

1830 
	mBACNET_REINIT_COLDSTART
 = 0,

1831 
	mBACNET_REINIT_WARMSTART
 = 1,

1832 
	mBACNET_REINIT_STARTBACKUP
 = 2,

1833 
	mBACNET_REINIT_ENDBACKUP
 = 3,

1834 
	mBACNET_REINIT_STARTRESTORE
 = 4,

1835 
	mBACNET_REINIT_ENDRESTORE
 = 5,

1836 
	mBACNET_REINIT_ABORTRESTORE
 = 6,

1837 
	mMAX_BACNET_REINITIALIZED_STATE
 = 7,

1838 
	mBACNET_REINIT_IDLE
 = 255

1839 } 
	tBACNET_REINITIALIZED_STATE
;

1841 
	eBACtNodeTy
 {

1842 
	mBACNET_NODE_UNKNOWN
 = 0,

1843 
	mBACNET_NODE_SYSTEM
 = 1,

1844 
	mBACNET_NODE_NETWORK
 = 2,

1845 
	mBACNET_NODE_DEVICE
 = 3,

1846 
	mBACNET_NODE_ORGANIZATIONAL
 = 4,

1847 
	mBACNET_NODE_AREA
 = 5,

1848 
	mBACNET_NODE_EQUIPMENT
 = 6,

1849 
	mBACNET_NODE_POINT
 = 7,

1850 
	mBACNET_NODE_COLLECTION
 = 8,

1851 
	mBACNET_NODE_PROPERTY
 = 9,

1852 
	mBACNET_NODE_FUNCTIONAL
 = 10,

1853 
	mBACNET_NODE_OTHER
 = 11

1854 } 
	tBACNET_NODE_TYPE
;

1856 
	eBACtShedS
 {

1857 
	mBACNET_SHED_INACTIVE
 = 0,

1858 
	mBACNET_SHED_REQUEST_PENDING
 = 1,

1859 
	mBACNET_SHED_COMPLIANT
 = 2,

1860 
	mBACNET_SHED_NON_COMPLIANT
 = 3

1861 } 
	tBACNET_SHED_STATE
;

1863 
	eBACtLightgOti
 {

1864 
	mBACNET_LIGHTS_NONE
 = 0,

1865 
	mBACNET_LIGHTS_FADE_TO
 = 1,

1866 
	mBACNET_LIGHTS_RAMP_TO
 = 2,

1867 
	mBACNET_LIGHTS_STEP_UP
 = 3,

1868 
	mBACNET_LIGHTS_STEP_DOWN
 = 4,

1869 
	mBACNET_LIGHTS_STEP_ON
 = 5,

1870 
	mBACNET_LIGHTS_STEP_OFF
 = 6,

1871 
	mBACNET_LIGHTS_WARN
 = 7,

1872 
	mBACNET_LIGHTS_WARN_OFF
 = 8,

1873 
	mBACNET_LIGHTS_WARN_RELINQUISH
 = 9,

1874 
	mBACNET_LIGHTS_STOP
 = 10,

1875 
	mMAX_BACNET_LIGHTING_OPERATION
 = 11,

1879 
	mBACNET_LIGHTS_PROPRIETARY_FIRST
 = 256,

1880 
	mBACNET_LIGHTS_PROPRIETARY_LAST
 = 65535

1881 } 
	tBACNET_LIGHTING_OPERATION
;

1883 
	eBACtLightgInProgss
 {

1884 
	mBACNET_LIGHTING_IDLE
 = 0,

1885 
	mBACNET_LIGHTING_FADE_ACTIVE
 = 1,

1886 
	mBACNET_LIGHTING_RAMP_ACTIVE
 = 2,

1887 
	mBACNET_LIGHTING_NOT_CONTROLLED
 = 3,

1888 
	mBACNET_LIGHTING_OTHER
 = 4,

1889 
	mMAX_BACNET_LIGHTING_IN_PROGRESS
 = 5

1890 } 
	tBACNET_LIGHTING_IN_PROGRESS
;

1892 
	eBACtLightgTnsi
 {

1893 
	mBACNET_LIGHTING_TRANSITION_IDLE
 = 0,

1894 
	mBACNET_LIGHTING_TRANSITION_FADE
 = 1,

1895 
	mBACNET_LIGHTING_TRANSITION_RAMP
 = 2,

1896 
	mMAX_BACNET_LIGHTING_TRANSITION
 = 3,

1900 
	mBACNET_LIGHTING_TRANSITION_PROPRIETARY_FIRST
 = 64,

1901 
	mBACNET_LIGHTING_TRANSITION_PROPRIETARY_LAST
 = 255

1902 } 
	tBACNET_LIGHTING_TRANSITION
;

1906 
	eBACtDaysOfWk
 {

1907 
	mBACNET_DAYS_OF_WEEK_MONDAY
 = 0,

1908 
	mBACNET_DAYS_OF_WEEK_TUESDAY
 = 1,

1909 
	mBACNET_DAYS_OF_WEEK_WEDNESDAY
 = 2,

1910 
	mBACNET_DAYS_OF_WEEK_THURSDAY
 = 3,

1911 
	mBACNET_DAYS_OF_WEEK_FRIDAY
 = 4,

1912 
	mBACNET_DAYS_OF_WEEK_SATURDAY
 = 5,

1913 
	mBACNET_DAYS_OF_WEEK_SUNDAY
 = 6,

1914 
	mMAX_BACNET_DAYS_OF_WEEK
 = 7

1915 } 
	tBACNET_DAYS_OF_WEEK
;

1917 
	eBACtEvtTnsiBs
 {

1918 
	mTRANSITION_TO_OFFNORMAL
 = 0,

1919 
	mTRANSITION_TO_FAULT
 = 1,

1920 
	mTRANSITION_TO_NORMAL
 = 2,

1921 
	mMAX_BACNET_EVENT_TRANSITION
 = 3

1922 } 
	tBACNET_EVENT_TRANSITION_BITS
;

1925 
	eBACtEvtTnsiMask
 {

1926 
	mTRANSITION_TO_OFFNORMAL_MASKED
 = 1,

1927 
	mTRANSITION_TO_FAULT_MASKED
 = 2,

1928 
	mTRANSITION_TO_NORMAL_MASKED
 = 4

1929 } 
	tBACNET_EVENT_TRANSITION_MASK
;

1934 
	mDOOR_ALARM_STATE_NORMAL
 = 0,

1935 
	mDOOR_ALARM_STATE_ALARM
 = 1,

1936 
	mDOOR_ALARM_STATE_DOOR_OPEN_TOO_LONG
 = 2,

1937 
	mDOOR_ALARM_STATE_FORCED_OPEN
 = 3,

1938 
	mDOOR_ALARM_STATE_TAMPER
 = 4,

1939 
	mDOOR_ALARM_STATE_DOOR_FAULT
 = 5,

1940 
	mDOOR_ALARM_STATE_LOCK_DOWN
 = 6,

1941 
	mDOOR_ALARM_STATE_FREE_ACCESS
 = 7,

1942 
	mDOOR_ALARM_STATE_EGRESS_OPEN
 = 8

1943 } 
	tBACNET_DOOR_ALARM_STATE
;

1947 
	mDOOR_SECURED_STATUS_SECURED
 = 0,

1948 
	mDOOR_SECURED_STATUS_UNSECURED
 = 1,

1949 
	mDOOR_SECURED_STATUS_UNKNOWN
 = 2

1950 } 
	tBACNET_DOOR_SECURED_STATUS
;

1954 
	mDOOR_STATUS_CLOSED
 = 0,

1955 
	mDOOR_STATUS_OPENED
 = 1,

1956 
	mDOOR_STATUS_UNKNOWN
 = 2,

1957 
	mDOOR_STATUS_DOOR_FAULT
 = 4,

1958 
	mDOOR_STATUS_UNUSED
 = 5

1959 } 
	tBACNET_DOOR_STATUS
;

1963 
	mDOOR_VALUE_LOCK
 = 0,

1964 
	mDOOR_VALUE_UNLOCK
 = 1,

1965 
	mDOOR_VALUE_PULSE_UNLOCK
 = 2,

1966 
	mDOOR_VALUE_EXTENDED_PULSE_UNLOCK
 = 3

1967 } 
	tBACNET_DOOR_VALUE
;

1971 
	mLOCK_STATUS_LOCKED
 = 0,

1972 
	mLOCK_STATUS_UNLOCKED
 = 1,

1973 
	mLOCK_STATUS_LOCK_FAULT
 = 2,

1974 
	mLOCK_STATUS_UNUSED
 = 3,

1975 
	mLOCK_STATUS_UNKNOWN
 = 4

1976 } 
	tBACNET_LOCK_STATUS
;

1980 
	mACCESS_EVENT_NONE
 = 0,

1981 
	mACCESS_EVENT_GRANTED
 = 1,

1982 
	mACCESS_EVENT_MUSTER
 = 2,

1983 
	mACCESS_EVENT_PASSBACK_DETECTED
 = 3,

1984 
	mACCESS_EVENT_DURESS
 = 4,

1985 
	mACCESS_EVENT_TRACE
 = 5,

1986 
	mACCESS_EVENT_LOCKOUT_MAX_ATTEMPTS
 = 6,

1987 
	mACCESS_EVENT_LOCKOUT_OTHER
 = 7,

1988 
	mACCESS_EVENT_LOCKOUT_RELINQUISHED
 = 8,

1989 
	mACCESS_EVENT_LOCKED_BY_HIGHER_AUTHORITY
 = 9,

1990 
	mACCESS_EVENT_OUT_OF_SERVICE
 = 10,

1991 
	mACCESS_EVENT_OUT_OF_SERVICE_RELINQUISHED
 = 11,

1992 
	mACCESS_EVENT_ACCOMPANIMENT_BY
 = 12,

1993 
	mACCESS_EVENT_AUTHENTICATION_FACTOR_READ
 = 13,

1994 
	mACCESS_EVENT_AUTHORIZATION_DELAYED
 = 14,

1995 
	mACCESS_EVENT_VERIFICATION_REQUIRED
 = 15,

1997 
	mACCESS_EVENT_DENIED_DENY_ALL
 = 128,

1998 
	mACCESS_EVENT_DENIED_UNKNOWN_CREDENTIAL
 = 129,

1999 
	mACCESS_EVENT_DENIED_AUTHENTICATION_UNAVAILABLE
 = 130,

2000 
	mACCESS_EVENT_DENIED_AUTHENTICATION_FACTOR_TIMEOUT
 = 131,

2001 
	mACCESS_EVENT_DENIED_INCORRECT_AUTHENTICATION_FACTOR
 = 132,

2002 
	mACCESS_EVENT_DENIED_ZONE_NO_ACCESS_RIGHTS
 = 133,

2003 
	mACCESS_EVENT_DENIED_POINT_NO_ACCESS_RIGHTS
 = 134,

2004 
	mACCESS_EVENT_DENIED_NO_ACCESS_RIGHTS
 = 135,

2005 
	mACCESS_EVENT_DENIED_OUT_OF_TIME_RANGE
 = 136,

2006 
	mACCESS_EVENT_DENIED_THREAT_LEVEL
 = 137,

2007 
	mACCESS_EVENT_DENIED_PASSBACK
 = 138,

2008 
	mACCESS_EVENT_DENIED_UNEXPECTED_LOCATION_USAGE
 = 139,

2009 
	mACCESS_EVENT_DENIED_MAX_ATTEMPTS
 = 140,

2010 
	mACCESS_EVENT_DENIED_LOWER_OCCUPANCY_LIMIT
 = 141,

2011 
	mACCESS_EVENT_DENIED_UPPER_OCCUPANCY_LIMIT
 = 142,

2012 
	mACCESS_EVENT_DENIED_AUTHENTICATION_FACTOR_LOST
 = 143,

2013 
	mACCESS_EVENT_DENIED_AUTHENTICATION_FACTOR_STOLEN
 = 144,

2014 
	mACCESS_EVENT_DENIED_AUTHENTICATION_FACTOR_DAMAGED
 = 145,

2015 
	mACCESS_EVENT_DENIED_AUTHENTICATION_FACTOR_DESTROYED
 = 146,

2016 
	mACCESS_EVENT_DENIED_AUTHENTICATION_FACTOR_DISABLED
 = 147,

2017 
	mACCESS_EVENT_DENIED_AUTHENTICATION_FACTOR_ERROR
 = 148,

2018 
	mACCESS_EVENT_DENIED_CREDENTIAL_UNASSIGNED
 = 149,

2019 
	mACCESS_EVENT_DENIED_CREDENTIAL_NOT_PROVISIONED
 = 150,

2020 
	mACCESS_EVENT_DENIED_CREDENTIAL_NOT_YET_ACTIVE
 = 151,

2021 
	mACCESS_EVENT_DENIED_CREDENTIAL_EXPIRED
 = 152,

2022 
	mACCESS_EVENT_DENIED_CREDENTIAL_MANUAL_DISABLE
 = 153,

2023 
	mACCESS_EVENT_DENIED_CREDENTIAL_LOCKOUT
 = 154,

2024 
	mACCESS_EVENT_DENIED_CREDENTIAL_MAX_DAYS
 = 155,

2025 
	mACCESS_EVENT_DENIED_CREDENTIAL_MAX_USES
 = 156,

2026 
	mACCESS_EVENT_DENIED_CREDENTIAL_INACTIVITY
 = 157,

2027 
	mACCESS_EVENT_DENIED_CREDENTIAL_DISABLED
 = 158,

2028 
	mACCESS_EVENT_DENIED_NO_ACCOMPANIMENT
 = 159,

2029 
	mACCESS_EVENT_DENIED_INCORRECT_ACCOMPANIMENT
 = 160,

2030 
	mACCESS_EVENT_DENIED_LOCKOUT
 = 161,

2031 
	mACCESS_EVENT_DENIED_VERIFICATION_FAILED
 = 162,

2032 
	mACCESS_EVENT_DENIED_VERIFICATION_TIMEOUT
 = 163,

2033 
	mACCESS_EVENT_DENIED_OTHER
 = 164

2034 } 
	tBACNET_ACCESS_EVENT
;

2038 
	mAUTHENTICATION_STATUS_NOT_READY
 = 0,

2039 
	mAUTHENTICATION_STATUS_READY
 = 1,

2040 
	mAUTHENTICATION_STATUS_DISABLED
 = 2,

2041 
	mAUTHENTICATION_STATUS_WAITING_FOR_AUTHENTICATION_FACTOR
 = 3,

2042 
	mAUTHENTICATION_STATUS_WAITING_FOR_ACCOMPANIMENT
 = 4,

2043 
	mAUTHENTICATION_STATUS_WAITING_FOR_VERIFICATION
 = 5,

2044 
	mAUTHENTICATION_STATUS_IN_PROGRESS
 = 6

2045 } 
	tBACNET_AUTHENTICATION_STATUS
;

2049 
	mAUTHORIZATION_MODE_AUTHORIZE
 = 0,

2050 
	mAUTHORIZATION_MODE_GRANT_ACTIVE
 = 1,

2051 
	mAUTHORIZATION_MODE_DENY_ALL
 = 2,

2052 
	mAUTHORIZATION_MODE_VERIFICATION_REQUIRED
 = 3,

2053 
	mAUTHORIZATION_MODE_AUTHORIZATION_DELAYED
 = 4,

2054 
	mAUTHORIZATION_MODE_NONE
 = 5

2055 } 
	tBACNET_AUTHORIZATION_MODE
;

2059 
	mACCESS_PASSBACK_MODE_PASSBACK_OFF
 = 0,

2060 
	mACCESS_PASSBACK_MODE_HARD_PASSBACK
 = 1,

2061 
	mACCESS_PASSBACK_MODE_SOFT_PASSBACK
 = 2

2062 } 
	tBACNET_ACCESS_PASSBACK_MODE
;

2066 
	mACCESS_ZONE_OCCUPANCY_STATE_NORMAL
 = 0,

2067 
	mACCESS_ZONE_OCCUPANCY_STATE_BELOW_LOWER_LIMIT
 = 1,

2068 
	mACCESS_ZONE_OCCUPANCY_STATE_AT_LOWER_LIMIT
 = 2,

2069 
	mACCESS_ZONE_OCCUPANCY_STATE_AT_UPPER_LIMIT
 = 3,

2070 
	mACCESS_ZONE_OCCUPANCY_STATE_ABOVE_UPPER_LIMIT
 = 4,

2071 
	mACCESS_ZONE_OCCUPANCY_STATE_DISABLED
 = 5,

2072 
	mACCESS_ZONE_OCCUPANCY_STATE_NOT_SUPPORTED
 = 6

2073 } 
	tBACNET_ACCESS_ZONE_OCCUPANCY_STATE
;

2077 
	mACCESS_USER_TYPE_ASSET
 = 0,

2078 
	mACCESS_USER_TYPE_GROUP
 = 1,

2079 
	mACCESS_USER_TYPE_PERSON
 = 2

2080 } 
	tBACNET_ACCESS_USER_TYPE
;

2084 
	mACCESS_AUTHENTICATION_FACTOR_DISABLE_NONE
 = 0,

2085 
	mACCESS_AUTHENTICATION_FACTOR_DISABLE_DISABLED
 = 1,

2086 
	mACCESS_AUTHENTICATION_FACTOR_DISABLE_DISABLED_LOST
 = 2,

2087 
	mACCESS_AUTHENTICATION_FACTOR_DISABLE_DISABLED_STOLEN
 = 3,

2088 
	mACCESS_AUTHENTICATION_FACTOR_DISABLE_DISABLED_DAMAGED
 = 4,

2089 
	mACCESS_AUTHENTICATION_FACTOR_DISABLE_DISABLED_DESTROYED
 = 5

2090 } 
	tBACNET_ACCESS_AUTHENTICATION_FACTOR_DISABLE
;

2094 
	mAUTHORIZATION_EXEMPTION_PASSBACK
 = 0,

2095 
	mAUTHORIZATION_EXEMPTION_OCCUPANCY_CHECK
 = 1,

2096 
	mAUTHORIZATION_EXEMPTION_ACCESS_RIGHTS
 = 2,

2097 
	mAUTHORIZATION_EXEMPTION_LOCKOUT
 = 3,

2098 
	mAUTHORIZATION_EXEMPTION_DENY
 = 4,

2099 
	mAUTHORIZATION_EXEMPTION_VERIFICATION
 = 5,

2100 
	mAUTHORIZATION_EXEMPTION_AUTHORIZATION_DELAY
 = 6

2101 } 
	tBACNET_AUTHORIZATION_EXEMPTION
;

2105 
	mNETWORK_REJECT_UNKNOWN_ERROR
 = 0,

2106 
	mNETWORK_REJECT_NO_ROUTE
 = 1,

2107 
	mNETWORK_REJECT_ROUTER_BUSY
 = 2,

2108 
	mNETWORK_REJECT_UNKNOWN_MESSAGE_TYPE
 = 3,

2109 
	mNETWORK_REJECT_MESSAGE_TOO_LONG
 = 4,

2110 
	mNETWORK_REJECT_BACNET_SECURITY
 = 5,

2111 
	mNETWORK_REJECT_BAD_ADDRESS
 = 6,

2113 
	mNETWORK_REJECT_REASON_INVALID


2114 } 
	tBACNET_NETWORK_REJECT_REASONS
;

2116 
	eBACtWreStus
 {

2117 
	mBACNET_WRITE_STATUS_IDLE
 = 0,

2118 
	mBACNET_WRITE_STATUS_IN_PROGRESS
 = 1,

2119 
	mBACNET_WRITE_STATUS_SUCCESSFUL
 = 2,

2120 
	mBACNET_WRITE_STATUS_FAILED
 = 3

2121 } 
	tBACNET_WRITE_STATUS
;

2125 
	mPORT_TYPE_ETHERNET
 = 0,

2126 
	mPORT_TYPE_ARCNET
 = 1,

2127 
	mPORT_TYPE_MSTP
 = 2,

2128 
	mPORT_TYPE_PTP
 = 3,

2129 
	mPORT_TYPE_LONTALK
 = 4,

2130 
	mPORT_TYPE_BIP
 = 5,

2131 
	mPORT_TYPE_ZIGBEE
 = 6,

2132 
	mPORT_TYPE_VIRTUAL
 = 7,

2133 
	mPORT_TYPE_NON_BACNET
 = 8,

2134 
	mPORT_TYPE_BIP6
 = 9,

2138 
	mPORT_TYPE_MAX
 = 255

2139 } 
	tBACNET_PORT_TYPE
;

2143 
	mPORT_QUALITY_UNKNOWN
 = 0,

2144 
	mPORT_QUALITY_LEARNED
 = 1,

2145 
	mPORT_QUALITY_LEARNED_CONFIGURED
 = 2,

2146 
	mPORT_QUALITY_CONFIGURED
 = 3

2147 } 
	tBACNET_PORT_QUALITY
;

2151 
	mPORT_COMMAND_IDLE
 = 0,

2152 
	mPORT_COMMAND_DISCARD_CHANGES
 = 1,

2153 
	mPORT_COMMAND_RENEW_FD_REGISTRATION
 = 2,

2154 
	mPORT_COMMAND_RESTART_SLAVE_DISCOVERY
 = 3,

2155 
	mPORT_COMMAND_RENEW_DHCP
 = 4,

2156 
	mPORT_COMMAND_RESTART_AUTONEGOTIATION
 = 5,

2157 
	mPORT_COMMAND_DISCONNECT
 = 6,

2158 
	mPORT_COMMAND_RESTART_PORT
 = 7

2162 } 
	tBACNET_PORT_COMMAND
;

2165 
	mBACNET_SECURITY_LEVEL_INCAPABLE
 = 0,

2166 
	mBACNET_SECURITY_LEVEL_PLAIN
 = 1,

2167 
	mBACNET_SECURITY_LEVEL_SIGNED
 = 2,

2168 
	mBACNET_SECURITY_LEVEL_ENCRYPTED
 = 3,

2169 
	mBACNET_SECURITY_LEVEL_SIGNED_END_TO_END
 = 4,

2170 
	mBACNET_SECURITY_LEVEL_ENCRYPTED_END_TO_END
 = 5

2171 } 
	tBACNET_SECURITY_LEVEL
;

2174 
	mBACNET_SECURITY_POLICY_PLAIN_NOT_TRUSTED
 = 0,

2175 
	mBACNET_SECURITY_POLICY_PLAIN_TRUSTED
 = 1,

2176 
	mBACNET_SECURITY_POLICY_SIGNED_TRUSTED
 = 2,

2177 
	mBACNET_SECURITY_POLICY_ENCRYPTED_TRUSTED
 = 3

2178 } 
	tBACNET_SECURITY_POLICY
;

2181 
	mKIA_AES_MD5
 = 0,

2182 
	mKIA_AES_SHA256
 = 1,

2184 
	mKIA_MAX_KEY_IDENTIFIER_ALGORITHM
 = 255

2185 } 
	tBACNET_KEY_IDENTIFIER_ALGORITHM
;

2188 
	mKIKN_NOT_USED
 = 0,

2189 
	mKIKN_DEVICE_MASTER
 = 1,

2190 
	mKIKN_DISTRIBUTION
 = 2,

2191 
	mKIKN_INSTALLATION
 = 3,

2192 
	mKIKN_GENERAL_NETWORK_ACCESS
 = 4,

2193 
	mKIKN_USER_AUTHENTICATED
 = 5,

2194 
	mKIKN_MIN_APPLICATION_SPECIFIC
 = 6,

2195 
	mKIKN_MAX_APPLICATION_SPECIFIC
 = 127,

2197 
	mKIKN_MAX_KEY_IDENTIFIER_KEY_NUMBER
 = 255

2198 } 
	tBACNET_KEY_IDENTIFIER_KEY_NUMBER
;

2201 
	mSEC_RESP_SUCCESS
 = 0,

2202 
	mSEC_RESP_ACCESS_DENIED
 = 1,

2203 
	mSEC_RESP_BAD_DESTINATION_ADDRESS
 = 2,

2204 
	mSEC_RESP_BAD_DESTINATION_DEVICE_ID
 = 3,

2205 
	mSEC_RESP_BAD_SIGNATURE
 = 4,

2206 
	mSEC_RESP_BAD_SOURCE_ADDRESS
 = 5,

2207 
	mSEC_RESP_BAD_TIMESTAMP
 = 6,

2208 
	mSEC_RESP_CANNOT_USE_KEY
 = 7,

2209 
	mSEC_RESP_CANNOT_VERIFY_MESSAGE_ID
 = 8,

2210 
	mSEC_RESP_CORRECT_KEY_REVISION
 = 9,

2211 
	mSEC_RESP_DESTINATION_DEVICE_ID_REQUIRED
 = 10,

2212 
	mSEC_RESP_DUPLICATE_MESSAGE
 = 11,

2213 
	mSEC_RESP_ENCRYPTION_NOT_CONFIGURED
 = 12,

2214 
	mSEC_RESP_ENCRYPTION_REQUIRED
 = 13,

2215 
	mSEC_RESP_INCORRECT_KEY
 = 14,

2216 
	mSEC_RESP_INVALID_KEY_DATA
 = 15,

2217 
	mSEC_RESP_KEY_UPDATE_IN_PROGRESS
 = 16,

2218 
	mSEC_RESP_MALFORMED_MESSAGE
 = 17,

2219 
	mSEC_RESP_NOT_KEY_SERVER
 = 18,

2220 
	mSEC_RESP_SECURITY_NOT_CONFIGURED
 = 19,

2221 
	mSEC_RESP_SOURCE_SECURITY_REQUIRED
 = 20,

2222 
	mSEC_RESP_TOO_MANY_KEYS
 = 21,

2223 
	mSEC_RESP_UNKNOWN_AUTHENTICATION_TYPE
 = 22,

2224 
	mSEC_RESP_UNKNOWN_KEY
 = 23,

2225 
	mSEC_RESP_UNKNOWN_KEY_REVISION
 = 24,

2226 
	mSEC_RESP_UNKNOWN_SOURCE_MESSAGE
 = 25

2227 } 
	tBACNET_SECURITY_RESPONSE_CODE
;

2231 
	mACCESS_CREDENTIAL_DISABLE_NONE
 = 0,

2232 
	mACCESS_CREDENTIAL_DISABLE_DISABLE
 = 1,

2233 
	mACCESS_CREDENTIAL_DISABLE_DISABLE_MANUAL
 = 2,

2234 
	mACCESS_CREDENTIAL_DISABLE_DISABLE_LOCKOUT
 = 3

2235 } 
	tBACNET_ACCESS_CREDENTIAL_DISABLE
;

2239 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED
 = 0,

2240 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED_NEEDS_PROVISIONING
 = 1,

2241 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED_UNASSIGNED
 = 2,

2242 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED_NOT_YET_ACTIVE
 = 3,

2243 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED_EXPIRED
 = 4,

2244 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED_LOCKOUT
 = 5,

2245 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED_MAX_DAYS
 = 6,

2246 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED_MAX_USES
 = 7,

2247 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED_INACTIVITY
 = 8,

2248 
	mACCESS_CREDENTIAL_DISABLE_REASON_DISABLED_MANUAL
 = 9

2252 } 
	tBACNET_ACCESS_CREDENTIAL_DISABLE_REASON
;

2256 
	mAUTHENTICATION_FACTOR_TYPE_UNDEFINED
 = 0,

2257 
	mAUTHENTICATION_FACTOR_TYPE_ERROR
 = 1,

2258 
	mAUTHENTICATION_FACTOR_TYPE_CUSTOM
 = 2,

2259 
	mAUTHENTICATION_FACTOR_TYPE_SIMPLE_NUMBER16
 = 3,

2260 
	mAUTHENTICATION_FACTOR_TYPE_SIMPLE_NUMBER32
 = 4,

2261 
	mAUTHENTICATION_FACTOR_TYPE_SIMPLE_NUMBER56
 = 5,

2262 
	mAUTHENTICATION_FACTOR_TYPE_SIMPLE_ALPHA_NUMERIC
 = 6,

2263 
	mAUTHENTICATION_FACTOR_TYPE_ABA_TRACK2
 = 7,

2264 
	mAUTHENTICATION_FACTOR_TYPE_WIEGAND26
 = 8,

2265 
	mAUTHENTICATION_FACTOR_TYPE_WIEGAND37
 = 9,

2266 
	mAUTHENTICATION_FACTOR_TYPE_WIEGAND37_FACILITY
 = 10,

2267 
	mAUTHENTICATION_FACTOR_TYPE_FACILITY16_CARD32
 = 11,

2268 
	mAUTHENTICATION_FACTOR_TYPE_FACILITY32_CARD32
 = 12,

2269 
	mAUTHENTICATION_FACTOR_TYPE_FASC_N
 = 13,

2270 
	mAUTHENTICATION_FACTOR_TYPE_FASC_N_BCD
 = 14,

2271 
	mAUTHENTICATION_FACTOR_TYPE_FASC_N_LARGE
 = 15,

2272 
	mAUTHENTICATION_FACTOR_TYPE_FASC_N_LARGE_BCD
 = 16,

2273 
	mAUTHENTICATION_FACTOR_TYPE_GSA75
 = 17,

2274 
	mAUTHENTICATION_FACTOR_TYPE_CHUID
 = 18,

2275 
	mAUTHENTICATION_FACTOR_TYPE_CHUID_FULL
 = 19,

2276 
	mAUTHENTICATION_FACTOR_TYPE_GUID
 = 20,

2277 
	mAUTHENTICATION_FACTOR_TYPE_CBEFF_A
 = 21,

2278 
	mAUTHENTICATION_FACTOR_TYPE_CBEFF_B
 = 22,

2279 
	mAUTHENTICATION_FACTOR_TYPE_CBEFF_C
 = 23,

2280 
	mAUTHENTICATION_FACTOR_TYPE_USER_PASSWORD
 = 24

2281 } 
	tBACNET_AUTHENTICATION_FACTOR_TYPE
;

2284 
	mNETWORK_TYPE_ETHERNET
 = 0,

2285 
	mNETWORK_TYPE_ARCNET
 = 1,

2286 
	mNETWORK_TYPE_MSTP
 = 2,

2287 
	mNETWORK_TYPE_PTP
 = 3,

2288 
	mNETWORK_TYPE_LONTALK
 = 4,

2289 
	mNETWORK_TYPE_BACNET_IPV4
 = 5,

2290 
	mNETWORK_TYPE_ZIGBEE
 = 6,

2291 
	mNETWORK_TYPE_VIRTUAL
 = 7,

2293 
	mNETWORK_TYPE_BACNET_IPV6
 = 9,

2294 
	mNETWORK_TYPE_SERIAL
 = 10,

2301 
	mNETWORK_TYPE_PROPRIETARY_MIN
 = 64,

2302 
	mNETWORK_TYPE_PROPRIETARY_MAX
 = 255

2303 } 
	tBACNET_NETWORK_TYPE
;

2307 
	mNETWORK_NUMBER_QUALITIY_UNKNOWN
 = 0,

2308 
	mNETWORK_NUMBER_QUALITIY_LEARNED
 = 1,

2309 
	mNETWORK_NUMBER_QUALITIY_LEARNED_CONFIGURED
 = 2,

2310 
	mNETWORK_NUMBER_QUALITIY_CONFIGURED
 = 3

2311 } 
	tBACNET_NETWORK_NUMBER_QUALITY
;

2313 
	eBACtNwkPtCommd_T
 {

2314 
	mNETWORK_PORT_COMMAND_IDLE
 = 0,

2315 
	mNETWORK_PORT_COMMAND_DISCARD_CHANGES
 = 1,

2316 
	mNETWORK_PORT_COMMAND_RENEW_FD_REGISTRATION
 = 2,

2317 
	mNETWORK_PORT_COMMAND_RESTART_SLAVE_DISCOVERY
 = 3,

2318 
	mNETWORK_PORT_COMMAND_RENEW_DHCP
 = 4,

2319 
	mNETWORK_PORT_COMMAND_RESTART_AUTONEGOTIATION
 = 5,

2320 
	mNETWORK_PORT_COMMAND_DISCONNECT
 = 6,

2321 
	mNETWORK_PORT_COMMAND_RESTART_PORT
 = 7,

2329 
	mNETWORK_PORT_COMMAND_PROPRIETARY_MIN
 = 128,

2330 
	mNETWORK_PORT_COMMAND_PROPRIETARY_MAX
 = 255

2331 } 
	tBACNET_NETWORK_PORT_COMMAND
;

	@include/bacerror.h

24 #ide
BACERROR_H


25 
	#BACERROR_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"banum.h
"

31 #ifde
__lulus


35 
ba_code_du
(

36 
ut8_t
 * 
du
,

37 
ut8_t
 
voke_id
,

38 
BACNET_CONFIRMED_SERVICE
 
rvi
,

39 
BACNET_ERROR_CLASS
 
r_ass
,

40 
BACNET_ERROR_CODE
 
r_code
);

42 
ba_decode_rvi_que
(

43 
ut8_t
 * 
du
,

44 
du_n
,

45 
ut8_t
 * 
voke_id
,

46 
BACNET_CONFIRMED_SERVICE
 * 
rvi
,

47 
BACNET_ERROR_CLASS
 * 
r_ass
,

48 
BACNET_ERROR_CODE
 * 
r_code
);

50 
ba_decode_r_ass_d_code
(

51 
ut8_t
 * 
du
,

52 
du_n
,

53 
BACNET_ERROR_CLASS
 * 
r_ass
,

54 
BACNET_ERROR_CODE
 * 
r_code
);

56 #ifde
TEST


57 
	~"e.h
"

58 
ba_decode_du
(

59 
ut8_t
 * 
du
,

60 
du_n
,

61 
ut8_t
 * 
voke_id
,

62 
BACNET_CONFIRMED_SERVICE
 * 
rvi
,

63 
BACNET_ERROR_CLASS
 * 
r_ass
,

64 
BACNET_ERROR_CODE
 * 
r_code
);

66 
BACE
(

67 
Te
 * 
pTe
);

70 #ifde
__lulus


	@include/bacint.h

24 #ide
BACINT_H


25 
	#BACINT_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~<ddef.h
>

31 #ifde
__lulus


36 
code_unsigd16
(

37 
ut8_t
 * 
du
,

38 
ut16_t
 
vue
);

39 
decode_unsigd16
(

40 
ut8_t
 * 
du
,

41 
ut16_t
 * 
vue
);

42 
code_unsigd24
(

43 
ut8_t
 * 
du
,

44 
ut32_t
 
vue
);

45 
decode_unsigd24
(

46 
ut8_t
 * 
du
,

47 
ut32_t
 * 
vue
);

48 
code_unsigd32
(

49 
ut8_t
 * 
du
,

50 
ut32_t
 
vue
);

51 
decode_unsigd32
(

52 
ut8_t
 * 
du
,

53 
ut32_t
 * 
vue
);

56 
code_sigd8
(

57 
ut8_t
 * 
du
,

58 
t8_t
 
vue
);

59 
decode_sigd8
(

60 
ut8_t
 * 
du
,

61 
t32_t
 * 
vue
);

62 
code_sigd16
(

63 
ut8_t
 * 
du
,

64 
t16_t
 
vue
);

65 
decode_sigd16
(

66 
ut8_t
 * 
du
,

67 
t32_t
 * 
vue
);

68 
code_sigd24
(

69 
ut8_t
 * 
du
,

70 
t32_t
 
vue
);

71 
decode_sigd24
(

72 
ut8_t
 * 
du
,

73 
t32_t
 * 
vue
);

74 
code_sigd32
(

75 
ut8_t
 * 
du
,

76 
t32_t
 
vue
);

77 
decode_sigd32
(

78 
ut8_t
 * 
du
,

79 
t32_t
 * 
vue
);

81 #ifde
TEST


82 
	~"e.h
"

83 
BACtIegs
(

84 
Te
 * 
pTe
);

87 #ifde
__lulus


	@include/bacnet.h

24 #ide
BACNET_H


25 
	#BACNET_H


	)

30 
	~"vsi.h
"

31 
	~"cfig.h
"

32 
	~"addss.h
"

33 
	~"du.h
"

34 
	~"ba.h
"

35 
	~"bacdcode.h
"

36 
	~"bact.h
"

37 
	~"bal.h
"

38 
	~"bacr.h
"

39 
	~"bacdef.h
"

40 
	~"banum.h
"

41 
	~"ba.h
"

42 
	~"baext.h
"

43 
	~"dk.h
"

44 
	~"dxt.h
"

45 
	~"du.h
"

46 
	~"je.h
"

47 
	~"tsm.h
"

50 
	~"f.h
"

51 
	~"awf.h
"

52 
	~"cov.h
"

53 
	~"dcc.h
"

54 
	~"m.h
"

55 
	~"ihave.h
"

56 
	~"rd.h
"

57 
	~".h
"

58 
	~"m.h
"

59 
	~"timesync.h
"

60 
	~"whohas.h
"

61 
	~"whois.h
"

62 
	~"wp.h
"

63 
	~"evt.h
"

64 
	~"lso.h
"

65 
	~"m_ack.h
"

70 
	~"devi.h
"

73 
	~"ai.h
"

74 
	~"ao.h
"

75 
	~"av.h
"

76 
	~"bacfe.h
"

77 
	~"bi.h
"

78 
	~"bo.h
"

79 
	~"bv.h
"

80 
	~"lc.h
"

81 
	~"l.h
"

82 
	~"mso.h
"

85 
	~"txbuf.h
"

86 
	~".h
"

87 
	~"hdrs.h
"

	@include/bacprop.h

24 #ide
BACPROP_H


25 
	#BACPROP_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~"banum.h
"

32 sigd 
	m_id
;

33 sigd 
	mg_id
;

34 } 
	tPROP_TAG_DATA
;

36 #ifde
__lulus


40 sigd 
bar_g_by_dex_deu
(

41 
PROP_TAG_DATA
 * 
da_li
,

42 sigd 
dex
,

43 sigd 
deu_t
);

45 sigd 
bar_ݔty_g
(

46 
BACNET_OBJECT_TYPE
 
ty
,

47 sigd 

);

49 #ifde
__lulus


	@include/bacpropstates.h

24 #ide
_BAC_PROP_STATES_H_


25 
	#_BAC_PROP_STATES_H_


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"banum.h
"

30 
	~"ba.h
"

31 
	~"timeamp.h
"

34 
	mBOOLEAN_VALUE
,

35 
	mBINARY_VALUE
,

36 
	mEVENT_TYPE
,

37 
	mPOLARITY
,

38 
	mPROGRAM_CHANGE
,

39 
	mPROGRAM_STATE
,

40 
	mREASON_FOR_HALT
,

41 
	mRELIABILITY
,

42 
	mSTATE
,

43 
	mSYSTEM_STATUS
,

44 
	mUNITS
,

45 
	mUNSIGNED_VALUE
,

46 
	mLIFE_SAFETY_MODE
,

47 
	mLIFE_SAFETY_STATE


48 } 
	tBACNET_PROPERTY_STATE_TYPE
;

51 
BACNET_PROPERTY_STATE_TYPE
 
	mg
;

53 
bo
 
	mboޗnVue
;

54 
BACNET_BINARY_PV
 
	mbyVue
;

55 
BACNET_EVENT_TYPE
 
	mevtTy
;

56 
BACNET_POLARITY
 
	mpެy
;

57 
BACNET_PROGRAM_REQUEST
 
	mogmChge
;

58 
BACNET_PROGRAM_STATE
 
	mogmS
;

59 
BACNET_PROGRAM_ERROR
 
	mogmE
;

60 
BACNET_RELIABILITY
 
	mlby
;

61 
BACNET_EVENT_STATE
 
	me
;

62 
BACNET_DEVICE_STATUS
 
	msyemStus
;

63 
BACNET_ENGINEERING_UNITS
 
	muns
;

64 
ut32_t
 
	munsigdVue
;

65 
BACNET_LIFE_SAFETY_MODE
 
	mliSatyMode
;

66 
BACNET_LIFE_SAFETY_STATE
 
	mliSatyS
;

67 } 
	me
;

68 } 
	tBACNET_PROPERTY_STATE
;

70 #ifde
__lulus


74 
ba_decode_ݔty_e
(

75 
ut8_t
 * 
du
,

76 
BACNET_PROPERTY_STATE
 * 
vue
);

78 
ba_decode_cڋxt_ݔty_e
(

79 
ut8_t
 * 
du
,

80 
ut8_t
 
g_numb
,

81 
BACNET_PROPERTY_STATE
 * 
vue
);

83 
ba_code_ݔty_e
(

84 
ut8_t
 * 
du
,

85 
BACNET_PROPERTY_STATE
 * 
vue
);

87 #ifde
__lulus


	@include/bacreal.h

24 #ide
BACREAL_H


25 
	#BACREAL_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~<ddef.h
>

31 #ifde
__lulus


35 
decode__
(

36 
ut8_t
 * 
du
,

37 
ut32_t
 
n_vue
,

38 *
_vue
);

40 
decode_
(

41 
ut8_t
 * 
du
,

42 *
_vue
);

44 
decode_cڋxt_
(

45 
ut8_t
 * 
du
,

46 
ut8_t
 
g_numb
,

47 *
_vue
);

48 
code_ba_
(

49 
vue
,

50 
ut8_t
 * 
du
);

51 
decode_doub
(

52 
ut8_t
 * 
du
,

53 *
_vue
);

54 
decode_cڋxt_doub
(

55 
ut8_t
 * 
du
,

56 
ut8_t
 
g_numb
,

57 *
doub_vue
);

58 
decode_doub_
(

59 
ut8_t
 * 
du
,

60 
ut32_t
 
n_vue
,

61 *
doub_vue
);

63 
code_ba_doub
(

64 
vue
,

65 
ut8_t
 * 
du
);

67 #ifde
TEST


68 
	~"e.h
"

70 
BAC
(

71 
Te
 * 
pTe
);

72 
BACdoub
(

73 
Te
 * 
pTe
);

76 #ifde
__lulus


	@include/bacstr.h

24 #ide
BACSTR_H


25 
	#BACSTR_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~<ddef.h
>

30 
	~"bacdef.h
"

31 
	~"cfig.h
"

35 
	sBACt_B_Sg
 {

36 
ut8_t
 
	mbs_ud
;

37 
ut8_t
 
	mvue
[
MAX_BITSTRING_BYTES
];

38 } 
	tBACNET_BIT_STRING
;

40 
	sBACt_Cha_Sg
 {

41 
size_t
 
	mngth
;

42 
ut8_t
 
	mcodg
;

44 
	mvue
[
MAX_CHARACTER_STRING_BYTES
];

45 } 
	tBACNET_CHARACTER_STRING
;

49 
	sBACt_O_Sg
 {

50 
size_t
 
	mngth
;

52 
ut8_t
 
	mvue
[
MAX_OCTET_STRING_BYTES
];

53 } 
	tBACNET_OCTET_STRING
;

55 #ifde
__lulus


59 
brg_
(

60 
BACNET_BIT_STRING
 * 
b_rg
);

61 
brg_t_b
(

62 
BACNET_BIT_STRING
 * 
b_rg
,

63 
ut8_t
 
b_numb
,

64 
bo
 
vue
);

65 
bo
 
brg_b
(

66 
BACNET_BIT_STRING
 * 
b_rg
,

67 
ut8_t
 
b_numb
);

68 
ut8_t
 
brg_bs_ud
(

69 
BACNET_BIT_STRING
 * 
b_rg
);

71 
ut8_t
 
brg_bys_ud
(

72 
BACNET_BIT_STRING
 * 
b_rg
);

73 
ut8_t
 
brg_bs_cy
(

74 
BACNET_BIT_STRING
 * 
b_rg
);

76 
ut8_t
 
brg_o
(

77 
BACNET_BIT_STRING
 * 
b_rg
,

78 
ut8_t
 
o_dex
);

79 
bo
 
brg_t_o
(

80 
BACNET_BIT_STRING
 * 
b_rg
,

81 
ut8_t
 
dex
,

82 
ut8_t
 
o
);

83 
bo
 
brg_t_bs_ud
(

84 
BACNET_BIT_STRING
 * 
b_rg
,

85 
ut8_t
 
bys_ud
,

86 
ut8_t
 
unud_bs
);

87 
bo
 
brg_cy
(

88 
BACNET_BIT_STRING
 * 
de
,

89 
BACNET_BIT_STRING
 * 
c
);

90 
bo
 
brg_me
(

91 
BACNET_BIT_STRING
 * 
brg1
,

92 
BACNET_BIT_STRING
 * 
brg2
);

93 
bo
 
brg__ascii
(

94 
BACNET_BIT_STRING
 * 
b_rg
,

95 cڡ *
ascii
);

99 
bo
 
charg_
(

100 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

101 
ut8_t
 
codg
,

102 cڡ *
vue
,

103 
size_t
 
ngth
);

105 
bo
 
charg__si
(

106 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

107 cڡ *
vue
);

108 
bo
 
charg_cy
(

109 
BACNET_CHARACTER_STRING
 * 
de
,

110 
BACNET_CHARACTER_STRING
 * 
c
);

111 
bo
 
charg_si_cy
(

112 *
de
,

113 
size_t
 
de_max_n
,

114 
BACNET_CHARACTER_STRING
 * 
c
);

116 
bo
 
charg_me
(

117 
BACNET_CHARACTER_STRING
 * 
de
,

118 
BACNET_CHARACTER_STRING
 * 
c
);

119 
bo
 
charg_si_me
(

120 
BACNET_CHARACTER_STRING
 * 
de
,

121 cڡ *
c
);

123 
bo
 
charg_nd
(

124 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

125 cڡ *
vue
,

126 
size_t
 
ngth
);

130 
bo
 
charg_un
(

131 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

132 
size_t
 
ngth
);

133 
bo
 
charg_t_codg
(

134 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

135 
ut8_t
 
codg
);

137 *
charg_vue
(

138 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

140 
size_t
 
charg_ngth
(

141 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

142 
ut8_t
 
charg_codg
(

143 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

144 
size_t
 
charg_cy
(

145 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

146 
bo
 
charg_b
(

147 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

148 
bo
 
charg_vid
(

149 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

150 
bo
 
utf8_isvid
(

151 cڡ *
r
,

152 
size_t
 
ngth
);

156 
bo
 
org_
(

157 
BACNET_OCTET_STRING
 * 
o_rg
,

158 
ut8_t
 * 
vue
,

159 
size_t
 
ngth
);

160 #ifde
PRINT_ENABLED


163 
bo
 
org__ascii_hex
(

164 
BACNET_OCTET_STRING
 * 
o_rg
,

165 cڡ *
ascii_hex
);

167 
bo
 
org_cy
(

168 
BACNET_OCTET_STRING
 * 
de
,

169 
BACNET_OCTET_STRING
 * 
c
);

170 
size_t
 
org_cy_vue
(

171 
ut8_t
 * 
de
,

172 
size_t
 
ngth
,

173 
BACNET_OCTET_STRING
 * 
c
);

175 
bo
 
org_nd
(

176 
BACNET_OCTET_STRING
 * 
o_rg
,

177 
ut8_t
 * 
vue
,

178 
size_t
 
ngth
);

182 
bo
 
org_un
(

183 
BACNET_OCTET_STRING
 * 
o_rg
,

184 
size_t
 
ngth
);

186 
ut8_t
 *
org_vue
(

187 
BACNET_OCTET_STRING
 * 
o_rg
);

189 
size_t
 
org_ngth
(

190 
BACNET_OCTET_STRING
 * 
o_rg
);

191 
size_t
 
org_cy
(

192 
BACNET_OCTET_STRING
 * 
o_rg
);

194 
bo
 
org_vue_me
(

195 
BACNET_OCTET_STRING
 * 
o_rg1
,

196 
BACNET_OCTET_STRING
 * 
o_rg2
);

198 #ifde
TEST


199 
	~"e.h
"

200 
BACtSgs
(

201 
Te
 * 
pTe
);

204 #ifde
__lulus


	@include/bactext.h

24 #ide
BACTEXT_H


25 
	#BACTEXT_H


	)

28 #i
PRINT_ENABLED


29 
	#BACTEXT_PRINT_ENABLED


	)

31 #ifde
TEST


32 
	#BACTEXT_PRINT_ENABLED


	)

36 
	~<dbo.h
>

37 
	~<dt.h
>

38 
	~"dxt.h
"

40 #ifde
__lulus


44 cڡ *
baext_cfmed_rvi_me
(

45 
dex
);

46 cڡ *
baext_uncfmed_rvi_me
(

47 
dex
);

48 cڡ *
baext_iti_g_me
(

49 
dex
);

50 
bo
 
baext_iti_g_dex
(

51 cڡ *
ch_me
,

52 *
found_dex
);

53 cڡ *
baext_obje_ty_me
(

54 
dex
);

55 
bo
 
baext_obje_ty_dex
(

56 cڡ *
ch_me
,

57 *
found_dex
);

58 cڡ *
baext_ݔty_me
(

59 
dex
);

60 
bo
 
baext_ݔty_dex
(

61 cڡ *
ch_me
,

62 *
found_dex
);

63 cڡ *
baext_grg_un_me
(

64 
dex
);

65 
bo
 
baext_grg_un_dex
(

66 cڡ *
ch_me
,

67 *
found_dex
);

68 cڡ *
baext_je_as_me
(

69 
dex
);

70 cڡ *
baext_abt_as_me
(

71 
dex
);

72 cڡ *
baext_r_ass_me
(

73 
dex
);

74 cڡ *
baext_r_code_me
(

75 
dex
);

76 
baext_ݔty_id
(

77 cڡ *
me
);

78 cڡ *
baext_mth_me
(

79 
dex
);

80 cڡ *
baext_wk_of_mth_me
(

81 
dex
);

82 cڡ *
baext_day_of_wk_me
(

83 
dex
);

84 cڡ *
baext_evt_e_me
(

85 
dex
);

86 cڡ *
baext_by_e_vue_me
(

87 
dex
);

88 cڡ *
baext_by_pެy_me
(

89 
dex
);

90 
bo
 
baext_by_e_vue_dex
(

91 cڡ *
ch_me
,

92 *
found_dex
);

93 cڡ *
baext_lby_me
(

94 
dex
);

95 cڡ *
baext_devi_us_me
(

96 
dex
);

97 cڡ *
baext_gmti_me
(

98 
dex
);

99 
bo
 
baext_gmti_dex
(

100 cڡ *
ch_me
,

101 *
found_dex
);

102 cڡ *
baext_node_ty_me
(

103 
dex
);

105 cڡ *
baext_evt_si_me
(

106 
dex
);

107 
bo
 
baext_evt_si_dex
(

108 cڡ *
ch_me
,

109 *
found_dex
);

111 cڡ *
baext_days_of_wk_me
(

112 
dex
);

113 
bo
 
baext_days_of_wk_dex
(

114 cڡ *
ch_me
,

115 *
found_dex
);

117 cڡ *
baext_twk_y_msg_me
(

118 
dex
);

120 cڡ *
baext_li_ty_e_me
(

121 
dex
);

123 cڡ *
baext_lightg_ݔi_me
(

124 
dex
);

126 cڡ *
baext_lightg__ogss
(

127 
dex
);

129 cڡ *
baext_lightg_si
(

130 
dex
);

131 #ifde
__lulus


	@include/bactimevalue.h

25 #ide
_BAC_TIME_VALUE_H_


26 
	#_BAC_TIME_VALUE_H_


	)

28 
	~<dt.h
>

29 
	~<dbo.h
>

30 
	~<ddef.h
>

31 
	~"bacdef.h
"

32 
	~"banum.h
"

33 
	~"ba.h
"

36 
BACNET_TIME
 
	mTime
;

37 
BACNET_APPLICATION_DATA_VALUE
 
	mVue
;

38 } 
	tBACNET_TIME_VALUE
;

41 #ifde
__lulus


45 
ba_code_time_vue
(
ut8_t
 * 
du
,

46 
BACNET_TIME_VALUE
 * 
vue
);

48 
ba_code_cڋxt_time_vue
(
ut8_t
 * 
du
,

49 
ut8_t
 
g_numb
,

50 
BACNET_TIME_VALUE
 * 
vue
);

52 
ba_decode_time_vue
(
ut8_t
 * 
du
,

53 
BACNET_TIME_VALUE
 * 
vue
);

55 
ba_decode_cڋxt_time_vue
(
ut8_t
 * 
du
,

56 
ut8_t
 
g_numb
,

57 
BACNET_TIME_VALUE
 * 
vue
);

59 #ifde
__lulus


	@include/bigend.h

24 #ide
BIGEND_H


25 
	#BIGEND_H


	)

27 #ifde
__lulus


47 
big_dn
(

50 #ifde
__lulus


	@include/bip.h

24 #ide
BIP_H


25 
	#BIP_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<ddef.h
>

30 
	~"bacdef.h
"

31 
	~"du.h
"

32 
	~"t.h
"

35 
	#MAX_HEADER
 (1 + 1 + 2)

	)

36 
	#MAX_MPDU
 (
MAX_HEADER
+
MAX_PDU
)

	)

38 
	#BVLL_TYPE_BACNET_IP
 (0x81)

	)

40 
bo
 
BIP_Debug
;

42 #ifde
__lulus


49 
bo
 
b_
(

50 *
iame
);

51 
b_t_r
(

52 *
iame
);

53 
b_nup
(

57 
b_t_sock
(

58 
sock_fd
);

59 
b_sock
(

61 
bo
 
b_vid
(

63 
b_g_brd_addss
(

64 
BACNET_ADDRESS
 * 
de
);

65 
b_g_my_addss
(

66 
BACNET_ADDRESS
 * 
my_addss
);

70 
b_nd_pdu
(

71 
BACNET_ADDRESS
 * 
de
,

72 
BACNET_NPDU_DATA
 * 
du_da
,

73 
ut8_t
 * 
pdu
,

74 
pdu_n
);

78 
ut16_t
 
b_ive
(

79 
BACNET_ADDRESS
 * 
c
,

80 
ut8_t
 * 
pdu
,

81 
ut16_t
 
max_pdu
,

82 
timeout
);

85 
b_t_pt
(

86 
ut16_t
 
pt
);

88 
ut16_t
 
b_g_pt
(

92 
b_t_addr
(

93 
ut32_t
 
t_addss
);

95 
ut32_t
 
b_g_addr
(

99 
b_t_brd_addr
(

100 
ut32_t
 
t_addss
);

102 
ut32_t
 
b_g_brd_addr
(

110 
b_gaddrbyme
(

111 cڡ *
ho_me
);

114 #ifde
__lulus


	@include/bip6.h

13 #ide
BIP6_H


14 
	#BIP6_H


	)

16 
	~<dbo.h
>

17 
	~<dt.h
>

18 
	~<ddef.h
>

19 
	~"bacdef.h
"

20 
	~"du.h
"

21 
	~"bvlc6.h
"

24 
	#BIP6_HEADER_MAX
 (1 + 1 + 2)

	)

25 
	#BIP6_MPDU_MAX
 (
BIP6_HEADER_MAX
+
MAX_PDU
)

	)

27 
	#MAX_MPDU
 
BIP6_MPDU_MAX


	)

29 #ifde
__lulus


36 
bo
 
b6_
(

37 *
iame
);

38 
b6_nup
(

40 
b6_g_brd_addss
(

41 
BACNET_ADDRESS
 * 
my_addss
);

42 
b6_g_my_addss
(

43 
BACNET_ADDRESS
 * 
my_addss
);

44 
b6_nd_pdu
(

45 
BACNET_ADDRESS
 * 
de
,

46 
BACNET_NPDU_DATA
 * 
du_da
,

47 
ut8_t
 * 
pdu
,

48 
pdu_n
);

49 
ut16_t
 
b6_ive
(

50 
BACNET_ADDRESS
 * 
c
,

51 
ut8_t
 * 
pdu
,

52 
ut16_t
 
max_pdu
,

53 
timeout
);

56 
bo
 
b6_addss_mch_lf
(

57 
BACNET_IP6_ADDRESS
 *
addr
);

59 
b6_t_r
(

60 *
iame
);

62 
bo
 
b6_t_addr
(

63 
BACNET_IP6_ADDRESS
 *
addr
);

64 
bo
 
b6_g_addr
(

65 
BACNET_IP6_ADDRESS
 *
addr
);

67 
b6_t_pt
(

68 
ut16_t
 
pt
);

69 
ut16_t
 
b6_g_pt
(

72 
bo
 
b6_t_brd_addr
(

73 
BACNET_IP6_ADDRESS
 *
addr
);

75 
bo
 
b6_g_brd_addr
(

76 
BACNET_IP6_ADDRESS
 *
addr
);

78 
b6_nd_mpdu
(

79 
BACNET_IP6_ADDRESS
 *
addr
,

80 
ut8_t
 * 
mtu
,

81 
ut16_t
 
mtu_n
);

83 
bo
 
b6_nd_sucss
();

84 
bo
 
b6_nd_ed
();

86 #ifde
__lulus


	@include/bits.h

24 #ide
BITS_H


25 
	#BITS_H


	)

30 
	#BIT
(
x
(1<<(x))

	)

31 
	#BIT0
 (0x01)

	)

32 
	#BIT1
 (0x02)

	)

33 
	#BIT2
 (0x04)

	)

34 
	#BIT3
 (0x08)

	)

35 
	#BIT4
 (0x10)

	)

36 
	#BIT5
 (0x20)

	)

37 
	#BIT6
 (0x40)

	)

38 
	#BIT7
 (0x80)

	)

39 
	#BIT8
 (0x0100)

	)

40 
	#BIT9
 (0x0200)

	)

41 
	#BIT10
 (0x0400)

	)

42 
	#BIT11
 (0x0800)

	)

43 
	#BIT12
 (0x1000)

	)

44 
	#BIT13
 (0x2000)

	)

45 
	#BIT14
 (0x4000)

	)

46 
	#BIT15
 (0x8000)

	)

47 
	#BIT16
 (0x010000UL)

	)

48 
	#BIT17
 (0x020000UL)

	)

49 
	#BIT18
 (0x040000UL)

	)

50 
	#BIT19
 (0x080000UL)

	)

51 
	#BIT20
 (0x100000UL)

	)

52 
	#BIT21
 (0x200000UL)

	)

53 
	#BIT22
 (0x400000UL)

	)

54 
	#BIT23
 (0x800000UL)

	)

55 
	#BIT24
 (0x01000000UL)

	)

56 
	#BIT25
 (0x02000000UL)

	)

57 
	#BIT26
 (0x04000000UL)

	)

58 
	#BIT27
 (0x08000000UL)

	)

59 
	#BIT28
 (0x10000000UL)

	)

60 
	#BIT29
 (0x20000000UL)

	)

61 
	#BIT30
 (0x40000000UL)

	)

62 
	#BIT31
 (0x80000000UL)

	)

65 
	#BIT_SET
(
a
,
b
(|(1<<(b)))

	)

66 
	#BIT_CLEAR
(
a
,
b
(&~(1<<(b)))

	)

67 
	#BIT_FLIP
(
a
,
b
(^(1<<(b)))

	)

68 
	#BIT_CHECK
(
a
,
b
(& (1<<(b)))

	)

71 
	#BITMASK_SET
(
x
,
y
((x|(y))

	)

72 
	#BITMASK_CLEAR
(
x
,
y
((x&(~(y)))

	)

73 
	#BITMASK_FLIP
(
x
,
y
((x^(y))

	)

74 
	#BITMASK_CHECK
(
x
,
y
((x& (y))

	)

76 #ide
_BV


77 
	#_BV
(
x
(1<<(x))

	)

	@include/bvlc.h

24 #ide
BVLC_H


25 
	#BVLC_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<ddef.h
>

30 
	~<time.h
>

31 
	~"bacdef.h
"

32 
	~"du.h
"

33 
	~"b.h
"

35 
	gsockaddr_
;

37 #ifde
__lulus


42 #i
defed
(
BBMD_ENABLED
) && BBMD_ENABLED

43 
bvlc_man_tim
(

44 
time_t
 
cds
);

46 
	#bvlc_man_tim
(
x
)

	)

51 
bo
 
	gvid
;

53 
_addr
 
	gde_addss
;

55 
ut16_t
 
	gde_pt
;

57 
_addr
 
	gbrd_mask
;

58 } 
	tBBMD_TABLE_ENTRY
;

60 
ut16_t
 
bvlc_ive
(

61 
BACNET_ADDRESS
 * 
c
,

62 
ut8_t
 * 
du
,

63 
ut16_t
 
max_du
,

64 
timeout
);

66 
bvlc_nd_pdu
(

67 
BACNET_ADDRESS
 * 
de
,

68 
BACNET_NPDU_DATA
 * 
du_da
,

69 
ut8_t
 * 
pdu
,

70 
pdu_n
);

72 
bvlc_nd_mpdu
(

73 
sockaddr_
 *
de
,

74 
ut8_t
 * 
mtu
,

75 
ut16_t
 
mtu_n
);

77 #i
defed
(
BBMD_CLIENT_ENABLED
) && BBMD_CLIENT_ENABLED

78 
bvlc_code_wre_bdt_
(

79 
ut8_t
 * 
pdu
,

80 
s
);

81 
bvlc_code_ad_fdt
(

82 
ut8_t
 * 
pdu
);

83 
bvlc_code_de_fdt_y
(

84 
ut8_t
 * 
pdu
,

85 
ut32_t
 
addss
,

86 
ut16_t
 
pt
);

87 
bvlc_code_ig_uni_du
(

88 
ut8_t
 * 
pdu
,

89 
ut8_t
 * 
du
,

90 
du_ngth
);

91 
bvlc_code_ig_brd_du
(

92 
ut8_t
 * 
pdu
,

93 
ut8_t
 * 
du
,

94 
du_ngth
);

96 
bvlc_code_ad_bdt
(

97 
ut8_t
 * 
pdu
);

98 
bvlc_bbmd_ad_bdt
(

99 
ut32_t
 
bbmd_addss
,

100 
ut16_t
 
bbmd_pt
);

103 
bvlc_gi_wh_bbmd
(

104 
ut32_t
 
bbmd_addss
,

105 
ut16_t
 
bbmd_pt
,

106 
ut16_t
 
time_to_live_cds
);

109 
bvlc_f_n_bbmd
(

110 
sockaddr_
 *
sout
,

111 
ut8_t
 * 
du
,

112 
ut16_t
 
ived_bys
);

117 
BACNET_BVLC_RESULT
 
bvlc_g_ϡ_su
(

124 
BACNET_BVLC_FUNCTION
 
bvlc_g_funi_code
(

135 
bvlc_g_bdt_lol
(

136 cڡ 
BBMD_TABLE_ENTRY
** 
b
);

139 
bvlc_r_bdt_lol
();

143 
bo
 
bvlc_add_bdt_y_lol
(

144 
BBMD_TABLE_ENTRY
* 
y
);

149 
bvlc_bdt_backup_lol
(

155 
bvlc_bdt_e_lol
(

173 
bvlc_t_glob_addss_f_t
(cڡ 
_addr
* 
addr
);

177 
bvlc_dib_t
();

179 #ifde
__lulus


	@include/bvlc6.h

9 #ide
BVLC6_H


10 
	#BVLC6_H


	)

12 
	~<dbo.h
>

13 
	~<dt.h
>

14 
	~<ddef.h
>

15 
	~<time.h
>

16 
	~"bacdef.h
"

17 
	~"du.h
"

23 
	#BVLL_TYPE_BACNET_IP6
 (0x82)

	)

30 
	#BVLC6_RESULT
 0x00

	)

31 
	#BVLC6_ORIGINAL_UNICAST_NPDU
 0x01

	)

32 
	#BVLC6_ORIGINAL_BROADCAST_NPDU
 0x02

	)

33 
	#BVLC6_ADDRESS_RESOLUTION
 0x03

	)

34 
	#BVLC6_FORWARDED_ADDRESS_RESOLUTION
 0x04

	)

35 
	#BVLC6_ADDRESS_RESOLUTION_ACK
 0x05

	)

36 
	#BVLC6_VIRTUAL_ADDRESS_RESOLUTION
 0x06

	)

37 
	#BVLC6_VIRTUAL_ADDRESS_RESOLUTION_ACK
 0x07

	)

38 
	#BVLC6_FORWARDED_NPDU
 0x08

	)

39 
	#BVLC6_REGISTER_FOREIGN_DEVICE
 0x09

	)

40 
	#BVLC6_DELETE_FOREIGN_DEVICE
 0x0A

	)

41 
	#BVLC6_SECURE_BVLL
 0x0B

	)

42 
	#BVLC6_DISTRIBUTE_BROADCAST_TO_NETWORK
 0x0C

	)

49 
	#BVLC6_RESULT_SUCCESSFUL_COMPLETION
 0x0000

	)

50 
	#BVLC6_RESULT_ADDRESS_RESOLUTION_NAK
 0x0030

	)

51 
	#BVLC6_RESULT_VIRTUAL_ADDRESS_RESOLUTION_NAK
 0x0060

	)

52 
	#BVLC6_RESULT_REGISTER_FOREIGN_DEVICE_NAK
 0x0090

	)

53 
	#BVLC6_RESULT_DELETE_FOREIGN_DEVICE_NAK
 0x00A0

	)

54 
	#BVLC6_RESULT_DISTRIBUTE_BROADCAST_TO_NETWORK_NAK
 0x00C0

	)

73 
	#BIP6_MULTICAST_GROUP_ID
 0xBAC0

	)

80 
	#BIP6_MULTICAST_rved_0
 0xFF00

	)

81 
	#BIP6_MULTICAST_NODE_LOCAL
 0xFF01

	)

82 
	#BIP6_MULTICAST_LINK_LOCAL
 0xFF02

	)

83 
	#BIP6_MULTICAST_rved_3
 0xFF03

	)

84 
	#BIP6_MULTICAST_ADMIN_LOCAL
 0xFF04

	)

85 
	#BIP6_MULTICAST_SITE_LOCAL
 0xFF05

	)

86 
	#BIP6_MULTICAST_ORG_LOCAL
 0xFF08

	)

87 
	#BIP6_MULTICAST_GLOBAL
 0xFF0E

	)

91 
	#IP6_ADDRESS_MAX
 16

	)

93 
	#BIP6_ADDRESS_MAX
 18

	)

104 
	sBACt_IP6_Addss
 {

105 
ut8_t
 
	maddss
[
IP6_ADDRESS_MAX
];

106 
ut16_t
 
	mpt
;

107 } 
	tBACNET_IP6_ADDRESS
;

121 
	gBACt_IP6_Brd_Diributi_Tab_Ery
;

122 
	sBACt_IP6_Brd_Diributi_Tab_Ery
 {

124 
bo
 
	mvid
;

126 
BACNET_IP6_ADDRESS
 
	mb6_addss
;

127 
BACt_IP6_Brd_Diributi_Tab_Ery
 *
	mxt
;

128 } 
	tBACNET_IP6_BROADCAST_DISTRIBUTION_TABLE_ENTRY
;

146 
	gBACt_IP6_Feign_Devi_Tab_Ery
;

147 
	sBACt_IP6_Feign_Devi_Tab_Ery
 {

149 
bo
 
	mvid
;

151 
BACNET_IP6_ADDRESS
 
	mb6_addss
;

153 
ut16_t
 
	ml_cds
;

155 
ut16_t
 
	ml_cds_mag
;

156 
BACt_IP6_Feign_Devi_Tab_Ery
 *
	mxt
;

157 } 
	tBACNET_IP6_FOREIGN_DEVICE_TABLE_ENTRY
;

160 #ifde
__lulus


164 
bvlc6_code_addss
(

165 
ut8_t
 * 
pdu
,

166 
ut16_t
 
pdu_size
,

167 
BACNET_IP6_ADDRESS
 * 
6_addss
);

168 
bvlc6_decode_addss
(

169 
ut8_t
 * 
pdu
,

170 
ut16_t
 
pdu_n
,

171 
BACNET_IP6_ADDRESS
 * 
6_addss
);

172 
bo
 
bvlc6_addss_cy
(

173 
BACNET_IP6_ADDRESS
 * 
d
,

174 
BACNET_IP6_ADDRESS
 * 
c
);

175 
bo
 
bvlc6_addss_dif
(

176 
BACNET_IP6_ADDRESS
 * 
d
,

177 
BACNET_IP6_ADDRESS
 * 
c
);

179 
bo
 
bvlc6_addss_t
(

180 
BACNET_IP6_ADDRESS
 * 
addr
,

181 
ut16_t
 
addr0
,

182 
ut16_t
 
addr1
,

183 
ut16_t
 
addr2
,

184 
ut16_t
 
addr3
,

185 
ut16_t
 
addr4
,

186 
ut16_t
 
addr5
,

187 
ut16_t
 
addr6
,

188 
ut16_t
 
addr7
);

189 
bo
 
bvlc6_addss_g
(

190 
BACNET_IP6_ADDRESS
 * 
addr
,

191 
ut16_t
 *
addr0
,

192 
ut16_t
 *
addr1
,

193 
ut16_t
 *
addr2
,

194 
ut16_t
 *
addr3
,

195 
ut16_t
 *
addr4
,

196 
ut16_t
 *
addr5
,

197 
ut16_t
 *
addr6
,

198 
ut16_t
 *
addr7
);

200 
bo
 
bvlc6_vmac_addss_t
(

201 
BACNET_ADDRESS
 * 
addr
,

202 
ut32_t
 
devi_id
);

203 
bo
 
bvlc6_vmac_addss_g
(

204 
BACNET_ADDRESS
 * 
addr
,

205 
ut32_t
 *
devi_id
);

207 
bvlc6_code_hd
(

208 
ut8_t
 * 
pdu
,

209 
ut16_t
 
pdu_size
,

210 
ut8_t
 
mesge_ty
,

211 
ut16_t
 
ngth
);

212 
bvlc6_decode_hd
(

213 
ut8_t
 * 
pdu
,

214 
ut16_t
 
pdu_n
,

215 
ut8_t
 * 
mesge_ty
,

216 
ut16_t
 * 
ngth
);

218 
bvlc6_code_su
(

219 
ut8_t
 * 
pdu
,

220 
ut16_t
 
pdu_size
,

221 
ut32_t
 
vmac
,

222 
ut16_t
 
su_code
);

223 
bvlc6_decode_su
(

224 
ut8_t
 * 
pdu
,

225 
ut16_t
 
pdu_n
,

226 
ut32_t
 * 
vmac
,

227 
ut16_t
 * 
su_code
);

229 
bvlc6_code_ig_uni
(

230 
ut8_t
 * 
pdu
,

231 
ut16_t
 
pdu_size
,

232 
ut32_t
 
vmac_c
,

233 
ut32_t
 
vmac_d
,

234 
ut8_t
 * 
du
,

235 
ut16_t
 
du_n
);

236 
bvlc6_decode_ig_uni
(

237 
ut8_t
 * 
pdu
,

238 
ut16_t
 
pdu_n
,

239 
ut32_t
 * 
vmac_c
,

240 
ut32_t
 * 
vmac_d
,

241 
ut8_t
 * 
du
,

242 
ut16_t
 
du_size
,

243 
ut16_t
 * 
du_n
);

245 
bvlc6_code_ig_brd
(

246 
ut8_t
 * 
pdu
,

247 
ut16_t
 
pdu_size
,

248 
ut32_t
 
vmac
,

249 
ut8_t
 * 
du
,

250 
ut16_t
 
du_n
);

251 
bvlc6_decode_ig_brd
(

252 
ut8_t
 * 
pdu
,

253 
ut16_t
 
pdu_n
,

254 
ut32_t
 * 
vmac
,

255 
ut8_t
 * 
du
,

256 
ut16_t
 
du_size
,

257 
ut16_t
 * 
du_n
);

259 
bvlc6_code_addss_suti
(

260 
ut8_t
 * 
pdu
,

261 
ut16_t
 
pdu_size
,

262 
ut32_t
 
vmac_c
,

263 
ut32_t
 
vmac_rg
);

264 
bvlc6_decode_addss_suti
(

265 
ut8_t
 * 
pdu
,

266 
ut16_t
 
pdu_n
,

267 
ut32_t
 * 
vmac_c
,

268 
ut32_t
 * 
vmac_rg
);

270 
bvlc6_code_fwded_addss_suti
(

271 
ut8_t
 * 
pdu
,

272 
ut16_t
 
pdu_size
,

273 
ut32_t
 
vmac_c
,

274 
ut32_t
 
vmac_rg
,

275 
BACNET_IP6_ADDRESS
 * 
b6_addss
);

276 
bvlc6_decode_fwded_addss_suti
(

277 
ut8_t
 * 
pdu
,

278 
ut16_t
 
pdu_n
,

279 
ut32_t
 * 
vmac_c
,

280 
ut32_t
 * 
vmac_rg
,

281 
BACNET_IP6_ADDRESS
 * 
b6_addss
);

283 
bvlc6_code_addss_suti_ack
(

284 
ut8_t
 * 
pdu
,

285 
ut16_t
 
pdu_size
,

286 
ut32_t
 
vmac_c
,

287 
ut32_t
 
vmac_d
);

288 
bvlc6_decode_addss_suti_ack
(

289 
ut8_t
 * 
pdu
,

290 
ut16_t
 
pdu_n
,

291 
ut32_t
 * 
vmac_c
,

292 
ut32_t
 * 
vmac_d
);

294 
bvlc6_code_vtu_addss_suti
(

295 
ut8_t
 * 
pdu
,

296 
ut16_t
 
pdu_size
,

297 
ut32_t
 
vmac_c
);

298 
bvlc6_decode_vtu_addss_suti
(

299 
ut8_t
 * 
pdu
,

300 
ut16_t
 
pdu_n
,

301 
ut32_t
 * 
vmac_c
);

303 
bvlc6_code_vtu_addss_suti_ack
(

304 
ut8_t
 * 
pdu
,

305 
ut16_t
 
pdu_size
,

306 
ut32_t
 
vmac_c
,

307 
ut32_t
 
vmac_d
);

308 
bvlc6_decode_vtu_addss_suti_ack
(

309 
ut8_t
 * 
pdu
,

310 
ut16_t
 
pdu_n
,

311 
ut32_t
 * 
vmac_c
,

312 
ut32_t
 * 
vmac_d
);

314 
bvlc6_code_fwded_du
(

315 
ut8_t
 * 
pdu
,

316 
ut16_t
 
pdu_size
,

317 
ut32_t
 
vmac_c
,

318 
BACNET_IP6_ADDRESS
 * 
addss
,

319 
ut8_t
 * 
du
,

320 
ut16_t
 
du_n
);

321 
bvlc6_decode_fwded_du
(

322 
ut8_t
 * 
pdu
,

323 
ut16_t
 
pdu_n
,

324 
ut32_t
 * 
vmac_c
,

325 
BACNET_IP6_ADDRESS
 * 
addss
,

326 
ut8_t
 * 
du
,

327 
ut16_t
 
du_size
,

328 
ut16_t
 * 
du_n
);

330 
bvlc6_code_gi_feign_devi
(

331 
ut8_t
 * 
pdu
,

332 
ut16_t
 
pdu_size
,

333 
ut32_t
 
vmac_c
,

334 
ut16_t
 
l_cds
);

335 
bvlc6_decode_gi_feign_devi
(

336 
ut8_t
 * 
pdu
,

337 
ut16_t
 
pdu_n
,

338 
ut32_t
 * 
vmac_c
,

339 
ut16_t
 * 
l_cds
);

341 
bvlc6_code_de_feign_devi
(

342 
ut8_t
 * 
pdu
,

343 
ut16_t
 
pdu_size
,

344 
ut32_t
 
vmac_c
,

345 
BACNET_IP6_FOREIGN_DEVICE_TABLE_ENTRY
 * 
fdt_y
);

346 
bvlc6_decode_de_feign_devi
(

347 
ut8_t
 * 
pdu
,

348 
ut16_t
 
pdu_n
,

349 
ut32_t
 * 
vmac_c
,

350 
BACNET_IP6_FOREIGN_DEVICE_TABLE_ENTRY
 * 
fdt_y
);

352 
bvlc6_code_cu_bv
(

353 
ut8_t
 * 
pdu
,

354 
ut16_t
 
pdu_size
,

355 
ut8_t
 * 
sbuf
,

356 
ut16_t
 
sbuf_n
);

357 
bvlc6_decode_cu_bv
(

358 
ut8_t
 * 
pdu
,

359 
ut16_t
 
pdu_n
,

360 
ut8_t
 * 
sbuf
,

361 
ut16_t
 
sbuf_size
,

362 
ut16_t
 * 
sbuf_n
);

364 
bvlc6_code_diribu_brd_to_twk
(

365 
ut8_t
 * 
pdu
,

366 
ut16_t
 
pdu_size
,

367 
ut32_t
 
vmac
,

368 
ut8_t
 * 
du
,

369 
ut16_t
 
du_n
);

370 
bvlc6_decode_diribu_brd_to_twk
(

371 
ut8_t
 * 
pdu
,

372 
ut16_t
 
pdu_n
,

373 
ut32_t
 * 
vmac
,

374 
ut8_t
 * 
du
,

375 
ut16_t
 
du_size
,

376 
ut16_t
 * 
du_n
);

379 
bvlc6_man_tim
(
time_t
 
cds
);

380 
bvlc6_hdr
(

381 
BACNET_IP6_ADDRESS
 *
addr
,

382 
BACNET_ADDRESS
 * 
c
,

383 
ut8_t
 * 
du
,

384 
ut16_t
 
du_n
);

385 
bvlc6_gi_wh_bbmd
(

386 
BACNET_IP6_ADDRESS
 *
bbmd_addr
,

387 
ut32_t
 
vmac_c
,

388 
ut16_t
 
time_to_live_cds
);

389 
ut16_t
 
bvlc6_g_ϡ_su
(

391 
ut8_t
 
bvlc6_g_funi_code
(

393 
bvlc6_
();

395 #ifde
TEST


396 
	~"e.h
"

397 
_BVLC6
(

398 
Te
 * 
pTe
);

401 #ifde
__lulus


	@include/bytes.h

24 #ide
BYTES_H


25 
	#BYTES_H


	)

29 
	~<dt.h
>

31 #ide
LO_NIB


32 
	#LO_NIB
(
b
((b& 0xF)

	)

35 #ide
HI_NIB


36 
	#HI_NIB
(
b
((b>> 4)

	)

42 #ide
LO_BYTE


44 
	#LO_BYTE
(
w
((
ut8_t
)(w))

	)

50 #ide
HI_BYTE


52 
	#HI_BYTE
(
w
((
ut8_t
)((
ut16_t
)(w>> 8))

	)

58 #ide
LO_WORD


60 
	#LO_WORD
(
x
((
ut16_t
)(x))

	)

66 #ide
HI_WORD


68 
	#HI_WORD
(
x
((
ut16_t
)((
ut32_t
)(x>> 16))

	)

74 #ide
MAKE_WORD


76 
	#MAKE_WORD
(
lo
,
hi
) \

77 ((
ut16_t
)(((
ut8_t
)(
lo
))|(((ut16_t)((ut8_t)(
hi
)))<<8)))

	)

83 #ide
MAKE_LONG


85 
	#MAKE_LONG
(
lo
,
hi
) \

86 ((
ut32_t
)(((
ut16_t
)(
lo
))|(((ut32_t)((ut16_t)(
hi
)))<<16)))

	)

	@include/client.h

25 #ide
CLIENT_H


26 
	#CLIENT_H


	)

28 
	~<ddef.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"du.h
"

33 
	~"du.h
"

34 
	~"ba.h
"

35 
	~"banum.h
"

36 
	~"m.h
"

37 
	~"wpm.h
"

38 
	~"cov.h
"

39 
	~"evt.h
"

40 
	~"lso.h
"

41 
	~"m_ack.h
"

42 
	~"nsr.h
"

44 #ifde
__lulus


49 
Sd_I_Am
(

50 
ut8_t
 * 
bufr
);

51 
Sd_I_Am_To_Nwk
(

52 
BACNET_ADDRESS
 * 
rg_addss
,

53 
ut32_t
 
devi_id
,

54 
max_du
,

55 
gmti
,

56 
ut16_t
 
vd_id
);

57 
m_code_pdu
(

58 
ut8_t
 * 
bufr
,

59 
BACNET_ADDRESS
 * 
de
,

60 
BACNET_NPDU_DATA
 * 
du_da
);

61 
Sd_I_Am_Uni
(

62 
ut8_t
 * 
bufr
,

63 
BACNET_ADDRESS
 * 
c
);

64 
m_uni_code_pdu
(

65 
ut8_t
 * 
bufr
,

66 
BACNET_ADDRESS
 * 
c
,

67 
BACNET_ADDRESS
 * 
de
,

68 
BACNET_NPDU_DATA
 * 
du_da
);

70 
Sd_WhoIs
(

71 
t32_t
 
low_lim
,

72 
t32_t
 
high_lim
);

74 
Sd_WhoIs_Glob
(

75 
t32_t
 
low_lim
,

76 
t32_t
 
high_lim
);

78 
Sd_WhoIs_Lol
(

79 
t32_t
 
low_lim
,

80 
t32_t
 
high_lim
);

82 
Sd_WhoIs_Reme
(

83 
BACNET_ADDRESS
 * 
rg_addss
,

84 
t32_t
 
low_lim
,

85 
t32_t
 
high_lim
);

87 
Sd_WhoIs_To_Nwk
(

88 
BACNET_ADDRESS
 * 
rg_addss
,

89 
t32_t
 
low_lim
,

90 
t32_t
 
high_lim
);

92 
Sd_WhoHas_Obje
(

93 
t32_t
 
low_lim
,

94 
t32_t
 
high_lim
,

95 
BACNET_OBJECT_TYPE
 
obje_ty
,

96 
ut32_t
 
obje_
);

98 
Sd_WhoHas_Name
(

99 
t32_t
 
low_lim
,

100 
t32_t
 
high_lim
,

101 cڡ *
obje_me
);

103 
Sd_I_Have
(

104 
ut32_t
 
devi_id
,

105 
BACNET_OBJECT_TYPE
 
obje_ty
,

106 
ut32_t
 
obje_
,

107 
BACNET_CHARACTER_STRING
 * 
obje_me
);

109 
Sd_UCOV_Nify
(

110 
ut8_t
 * 
bufr
,

111 
BACNET_COV_DATA
 * 
cov_da
);

112 
ucov_nify_code_pdu
(

113 
ut8_t
 * 
bufr
,

114 
BACNET_ADDRESS
 * 
de
,

115 
BACNET_NPDU_DATA
 * 
du_da
,

116 
BACNET_COV_DATA
 * 
cov_da
);

117 
ut8_t
 
Sd_COV_Subsibe
(

118 
ut32_t
 
devi_id
,

119 
BACNET_SUBSCRIBE_COV_DATA
 * 
cov_da
);

122 
ut8_t
 
Sd_GEvt
(

123 
BACNET_ADDRESS
 * 
rg_addss
,

124 
BACNET_OBJECT_ID
 *
ϡReivedObjeIdtifr
);

125 
ut8_t
 
Sd_GEvt_Glob
();

128 
ut8_t
 
Sd_Rd_Prݔty_Reque_Addss
(

129 
BACNET_ADDRESS
 * 
de
,

130 
ut16_t
 
max_du
,

131 
BACNET_OBJECT_TYPE
 
obje_ty
,

132 
ut32_t
 
obje_
,

133 
BACNET_PROPERTY_ID
 
obje_ݔty
,

134 
ut32_t
 
y_dex
);

135 
ut8_t
 
Sd_Rd_Prݔty_Reque
(

136 
ut32_t
 
devi_id
,

137 
BACNET_OBJECT_TYPE
 
obje_ty
,

138 
ut32_t
 
obje_
,

139 
BACNET_PROPERTY_ID
 
obje_ݔty
,

140 
ut32_t
 
y_dex
);

141 
ut8_t
 
Sd_Rd_Prݔty_Muɝ_Reque
(

142 
ut8_t
 * 
pdu
,

143 
size_t
 
max_pdu
,

144 
ut32_t
 
devi_id
,

145 
BACNET_READ_ACCESS_DATA
 * 
ad_acss_da
);

148 
ut8_t
 
Sd_Wre_Prݔty_Reque
(

149 
ut32_t
 
devi_id
,

150 
BACNET_OBJECT_TYPE
 
obje_ty
,

151 
ut32_t
 
obje_
,

152 
BACNET_PROPERTY_ID
 
obje_ݔty
,

153 
BACNET_APPLICATION_DATA_VALUE
 * 
obje_vue
,

154 
ut8_t
 
iܙy
,

155 
ut32_t
 
y_dex
);

156 
ut8_t
 
Sd_Wre_Prݔty_Reque_Da
(

157 
ut32_t
 
devi_id
,

158 
BACNET_OBJECT_TYPE
 
obje_ty
,

159 
ut32_t
 
obje_
,

160 
BACNET_PROPERTY_ID
 
obje_ݔty
,

161 
ut8_t
 * 
iti_da
,

162 
iti_da_n
,

163 
ut8_t
 
iܙy
,

164 
ut32_t
 
y_dex
);

165 
ut8_t
 
Sd_Wre_Prݔty_Muɝ_Reque_Da
(

166 
ut32_t
 
devi_id
,

167 
BACNET_WRITE_ACCESS_DATA
 * 
wre_acss_da
);

170 
ut8_t
 
Sd_Relize_Devi_Reque
(

171 
ut32_t
 
devi_id
,

172 
BACNET_REINITIALIZED_STATE
 
e
,

173 *
sswd
);

176 
ut8_t
 
Sd_Devi_Communiti_Cڌ_Reque
(

177 
ut32_t
 
devi_id
,

178 
ut16_t
 
timeDuti
,

179 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
e
,

180 *
sswd
);

182 
Sd_TimeSync
(

183 
BACNET_DATE
 * 
bde
,

184 
BACNET_TIME
 * 
btime
);

185 
Sd_TimeSync_Reme
(

186 
BACNET_ADDRESS
 * 
de
,

187 
BACNET_DATE
 * 
bde
,

188 
BACNET_TIME
 * 
btime
);

189 
Sd_TimeSyncUTC
(

190 
BACNET_DATE
 * 
bde
,

191 
BACNET_TIME
 * 
btime
);

192 
Sd_TimeSyncUTC_Reme
(

193 
BACNET_ADDRESS
 * 
de
,

194 
BACNET_DATE
 * 
bde
,

195 
BACNET_TIME
 * 
btime
);

196 
Sd_TimeSyncUTC_Devi
();

197 
Sd_TimeSync_Devi
();

199 
ut8_t
 
Sd_Atomic_Rd_Fe_Sm
(

200 
ut32_t
 
devi_id
,

201 
ut32_t
 
fe_
,

202 
feSPosi
,

203 
queedOCou
);

204 
ut8_t
 
Sd_Atomic_Wre_Fe_Sm
(

205 
ut32_t
 
devi_id
,

206 
ut32_t
 
fe_
,

207 
feSPosi
,

208 
BACNET_OCTET_STRING
 * 
feDa
);

210 
Sd_UEvt_Nify
(

211 
ut8_t
 * 
bufr
,

212 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
,

213 
BACNET_ADDRESS
 * 
de
);

215 
ut8_t
 
Sd_CEvt_Nify
(

216 
ut32_t
 
devi_id
,

217 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
);

219 
Sd_Nwk_Lay_Mesge
(

220 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
,

221 
BACNET_ADDRESS
 * 
d
,

222 *
iArgs
);

223 
Sd_Who_Is_Rour_To_Nwk
(

224 
BACNET_ADDRESS
 * 
d
,

225 
dt
);

226 
Sd_I_Am_Rour_To_Nwk
(

227 cڡ 
DNET_li
[]);

228 
Sd_Reje_Mesge_To_Nwk
(

229 
BACNET_ADDRESS
 * 
d
,

230 
ut8_t
 
je_as
,

231 
dt
);

232 
Sd_Inlize_Routg_Tab
(

233 
BACNET_ADDRESS
 * 
d
,

234 cڡ 
DNET_li
[]);

235 
Sd_Inlize_Routg_Tab_Ack
(

236 
BACNET_ADDRESS
 * 
d
,

237 cڡ 
DNET_li
[]);

239 
ut8_t
 
Sd_Li_Saty_Oti_Da
(

240 
ut32_t
 
devi_id
,

241 
BACNET_LSO_DATA
 * 
da
);

242 
ut8_t
 
Sd_Arm_Acknowdgemt
(

243 
ut32_t
 
devi_id
,

244 
BACNET_ALARM_ACK_DATA
 * 
da
);

246 
Sd_UncfmedPriveTnsr
(

247 
BACNET_ADDRESS
 * 
de
,

248 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
);

250 #ifde
__lulus


	@include/config.h

25 #ide
CONFIG_H


26 
	#CONFIG_H


	)

33 #i!(
defed
(
BACDL_ETHERNET
|| defed(
BACDL_ARCNET
) || \

34 
defed
(
BACDL_MSTP
|| defed(
BACDL_BIP
|| defed(
BACDL_BIP6
) || \

35 
defed
(
BACDL_TEST
|| defed(
BACDL_ALL
|| 
	$defed
(
BACDL_NONE
))

36 
	#BACDL_BIP


	)

40 #i(
	`defed
(
BACDL_BIP
|| defed(
BACDL_ALL
))

45 #i!
	`defed
(
BBMD_ENABLED
)

46 
	#BBMD_ENABLED
 1

	)

51 #i
	`defed
(
BACDL_BIP6
)

52 #i!
	`defed
(
BBMD6_ENABLED
)

53 
	#BBMD6_ENABLED
 0

	)

58 #i!
	`defed
(
MAX_NUM_DEVICES
)

59 #ifde
BAC_ROUTING


60 
	#MAX_NUM_DEVICES
 3

	)

62 
	#MAX_NUM_DEVICES
 1

	)

70 #i!
	`defed
(
BIG_ENDIAN
)

71 
	#BIG_ENDIAN
 0

	)

75 #i!
	`defed
(
BACNET_VENDOR_ID
)

76 
	#BACNET_VENDOR_ID
 260

	)

78 #i!
	`defed
(
BACNET_VENDOR_NAME
)

79 
	#BACNET_VENDOR_NAME
 "BACÈSckSourFge"

	)

87 #i!
	`defed
(
MAX_APDU
)

90 #i
	`defed
(
BACDL_BIP
)

91 
	#MAX_APDU
 1476

	)

94 #i
	`defed
(
BACDL_BIP6
)

95 
	#MAX_APDU
 1476

	)

96 #i
	`defed
 (
BACDL_ETHERNET
)

97 
	#MAX_APDU
 1476

	)

99 
	#MAX_APDU
 480

	)

108 #i!
	`defed
(
MAX_TSM_TRANSACTIONS
)

109 
	#MAX_TSM_TRANSACTIONS
 255

	)

116 #i!
	`defed
(
MAX_ADDRESS_CACHE
)

117 
	#MAX_ADDRESS_CACHE
 255

	)

121 #i!
	`defed
(
PRINT_ENABLED
)

122 
	#PRINT_ENABLED
 0

	)

127 #i!(
	`defed
(
BACAPP_ALL
) || \

128 
	`defed
(
BACAPP_MINIMAL
) || \

129 
	`defed
(
BACAPP_NULL
) || \

130 
	`defed
(
BACAPP_BOOLEAN
) || \

131 
	`defed
(
BACAPP_UNSIGNED
) || \

132 
	`defed
(
BACAPP_SIGNED
) || \

133 
	`defed
(
BACAPP_REAL
) || \

134 
	`defed
(
BACAPP_DOUBLE
) || \

135 
	`defed
(
BACAPP_OCTET_STRING
) || \

136 
	`defed
(
BACAPP_CHARACTER_STRING
) || \

137 
	`defed
(
BACAPP_BIT_STRING
) || \

138 
	`defed
(
BACAPP_ENUMERATED
) || \

139 
	`defed
(
BACAPP_DATE
) || \

140 
	`defed
(
BACAPP_TIME
) || \

141 
	`defed
(
BACAPP_DEVICE_OBJECT_PROP_REF
) || \

142 
	$defed
(
BACAPP_OBJECT_ID
))

143 
	#BACAPP_ALL


	)

146 #i
	`defed
 (
BACAPP_ALL
)

147 
	#BACAPP_NULL


	)

148 
	#BACAPP_BOOLEAN


	)

149 
	#BACAPP_UNSIGNED


	)

150 
	#BACAPP_SIGNED


	)

151 
	#BACAPP_REAL


	)

152 
	#BACAPP_DOUBLE


	)

153 
	#BACAPP_OCTET_STRING


	)

154 
	#BACAPP_CHARACTER_STRING


	)

155 
	#BACAPP_BIT_STRING


	)

156 
	#BACAPP_ENUMERATED


	)

157 
	#BACAPP_DATE


	)

158 
	#BACAPP_TIME


	)

159 
	#BACAPP_OBJECT_ID


	)

160 
	#BACAPP_DEVICE_OBJECT_PROP_REF


	)

161 #i
	`defed
 (
BACAPP_MINIMAL
)

162 
	#BACAPP_NULL


	)

163 
	#BACAPP_BOOLEAN


	)

164 
	#BACAPP_UNSIGNED


	)

165 
	#BACAPP_SIGNED


	)

166 
	#BACAPP_REAL


	)

167 
	#BACAPP_CHARACTER_STRING


	)

168 
	#BACAPP_ENUMERATED


	)

169 
	#BACAPP_DATE


	)

170 
	#BACAPP_TIME


	)

171 
	#BACAPP_OBJECT_ID


	)

177 #ide
MAX_BITSTRING_BYTES


178 
	#MAX_BITSTRING_BYTES
 (15)

	)

181 #ide
MAX_CHARACTER_STRING_BYTES


182 
	#MAX_CHARACTER_STRING_BYTES
 (
MAX_APDU
-6)

	)

185 #ide
MAX_OCTET_STRING_BYTES


186 
	#MAX_OCTET_STRING_BYTES
 (
MAX_APDU
-6)

	)

207 #ifde
TEST


208 
	#BACNET_SVC_I_HAVE_A
 1

	)

209 
	#BACNET_SVC_WP_A
 1

	)

210 
	#BACNET_SVC_RP_A
 1

	)

211 
	#BACNET_SVC_RPM_A
 1

	)

212 
	#BACNET_SVC_DCC_A
 1

	)

213 
	#BACNET_SVC_RD_A
 1

	)

214 
	#BACNET_SVC_TS_A
 1

	)

215 
	#BACNET_SVC_SERVER
 0

	)

216 
	#BACNET_USE_OCTETSTRING
 1

	)

217 
	#BACNET_USE_DOUBLE
 1

	)

218 
	#BACNET_USE_SIGNED
 1

	)

220 
	#BACNET_SVC_I_HAVE_A
 1

	)

221 
	#BACNET_SVC_WP_A
 1

	)

222 
	#BACNET_SVC_RP_A
 1

	)

223 
	#BACNET_SVC_RPM_A
 1

	)

224 
	#BACNET_SVC_DCC_A
 1

	)

225 
	#BACNET_SVC_RD_A
 1

	)

226 
	#BACNET_SVC_TS_A
 1

	)

227 
	#BACNET_SVC_SERVER
 0

	)

228 
	#BACNET_USE_OCTETSTRING
 1

	)

229 
	#BACNET_USE_DOUBLE
 1

	)

230 
	#BACNET_USE_SIGNED
 1

	)

234 #ide
BACNET_SVC_I_HAVE_A


235 
	#BACNET_SVC_I_HAVE_A
 0

	)

238 #ide
BACNET_SVC_WP_A


239 
	#BACNET_SVC_WP_A
 0

	)

242 #ide
BACNET_SVC_RP_A


243 
	#BACNET_SVC_RP_A
 0

	)

246 #ide
BACNET_SVC_RPM_A


247 
	#BACNET_SVC_RPM_A
 0

	)

250 #ide
BACNET_SVC_DCC_A


251 
	#BACNET_SVC_DCC_A
 0

	)

254 #ide
BACNET_SVC_RD_A


255 
	#BACNET_SVC_RD_A
 0

	)

258 #ide
BACNET_SVC_SERVER


259 
	#BACNET_SVC_SERVER
 1

	)

262 #ide
BACNET_USE_OCTETSTRING


263 
	#BACNET_USE_OCTETSTRING
 0

	)

266 #ide
BACNET_USE_DOUBLE


267 
	#BACNET_USE_DOUBLE
 0

	)

270 #ide
BACNET_USE_SIGNED


271 
	#BACNET_USE_SIGNED
 0

	)

	@include/cov.h

24 #ide
COV_H


25 
	#COV_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"ba.h
"

31 
	sBACt_COV_Da
 {

32 
ut32_t
 
	msubsibProssIdtifr
;

33 
ut32_t
 
	mtgDeviIdtifr
;

34 
BACNET_OBJECT_ID
 
	mmڙedObjeIdtifr
;

35 
ut32_t
 
	mtimeRemag
;

37 
BACNET_PROPERTY_VALUE
 *
	mliOfVues
;

38 } 
	tBACNET_COV_DATA
;

40 
	gBACt_Subsibe_COV_Da
;

41 
	sBACt_Subsibe_COV_Da
 {

42 
ut32_t
 
	msubsibProssIdtifr
;

43 
BACNET_OBJECT_ID
 
	mmڙedObjeIdtifr
;

44 
bo
 
	mnΩiReque
;

45 
bo
 
	missueCfmedNifitis
;

46 
ut32_t
 
	mlitime
;

47 
BACNET_PROPERTY_REFERENCE
 
	mmڙedPrݔty
;

48 
bo
 
	mcovInemtP
;

49 
	mcovInemt
;

50 
BACNET_ERROR_CLASS
 
	mr_ass
;

51 
BACNET_ERROR_CODE
 
	mr_code
;

52 
BACt_Subsibe_COV_Da
 *
	mxt
;

53 } 
	tBACNET_SUBSCRIBE_COV_DATA
;

55 #ifde
__lulus


59 
ucov_nify_code_du
(

60 
ut8_t
 * 
du
,

61 
BACNET_COV_DATA
 * 
da
);

63 
ucov_nify_decode_du
(

64 
ut8_t
 * 
du
,

65 
du_n
,

66 
BACNET_COV_DATA
 * 
da
);

68 
ucov_nify_nd
(

69 
ut8_t
 * 
bufr
,

70 
BACNET_COV_DATA
 * 
da
);

72 
ccov_nify_code_du
(

73 
ut8_t
 * 
du
,

74 
ut8_t
 
voke_id
,

75 
BACNET_COV_DATA
 * 
da
);

77 
ccov_nify_decode_du
(

78 
ut8_t
 * 
du
,

79 
du_n
,

80 
ut8_t
 * 
voke_id
,

81 
BACNET_COV_DATA
 * 
da
);

84 
cov_nify_decode_rvi_que
(

85 
ut8_t
 * 
du
,

86 
du_n
,

87 
BACNET_COV_DATA
 * 
da
);

89 
cov_subsibe_ݔty_decode_rvi_que
(

90 
ut8_t
 * 
du
,

91 
du_n
,

92 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
);

94 
cov_subsibe_ݔty_code_du
(

95 
ut8_t
 * 
du
,

96 
ut8_t
 
voke_id
,

97 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
);

99 
cov_subsibe_decode_rvi_que
(

100 
ut8_t
 * 
du
,

101 
du_n
,

102 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
);

104 
cov_subsibe_code_du
(

105 
ut8_t
 * 
du
,

106 
ut8_t
 
voke_id
,

107 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
);

109 
cov_da_vue_li_lk
(

110 
BACNET_COV_DATA
 *
da
,

111 
BACNET_PROPERTY_VALUE
 *
vue_li
,

112 
size_t
 
cou
);

114 #ifde
TEST


115 
	~"e.h
"

116 
COVNify
(

117 
Te
 * 
pTe
);

118 
COVSubsibePrݔty
(

119 
Te
 * 
pTe
);

120 
COVSubsibe
(

121 
Te
 * 
pTe
);

124 #ifde
__lulus


	@include/crc.h

24 #ide
CRC_H


25 
	#CRC_H


	)

27 
	~<ddef.h
>

28 
	~<dt.h
>

30 #ifde
__lulus


34 
ut8_t
 
CRC_Cc_Hd
(

35 
ut8_t
 
daVue
,

36 
ut8_t
 
cVue
);

37 
ut16_t
 
CRC_Cc_Da
(

38 
ut8_t
 
daVue
,

39 
ut16_t
 
cVue
);

41 #ifde
__lulus


	@include/datalink.h

24 #ide
DATALINK_H


25 
	#DATALINK_H


	)

27 
	~"cfig.h
"

28 
	~"bacdef.h
"

30 #i
defed
(
BACDL_ETHERNET
)

31 
	~"ht.h
"

33 
	#dk_
 
ht_


	)

34 
	#dk_nd_pdu
 
ht_nd_pdu


	)

35 
	#dk_ive
 
ht_ive


	)

36 
	#dk_nup
 
ht_nup


	)

37 
	#dk_g_brd_addss
 
ht_g_brd_addss


	)

38 
	#dk_g_my_addss
 
ht_g_my_addss


	)

40 #i
defed
(
BACDL_ARCNET
)

41 
	~".h
"

43 
	#dk_
 
_


	)

44 
	#dk_nd_pdu
 
_nd_pdu


	)

45 
	#dk_ive
 
_ive


	)

46 
	#dk_nup
 
_nup


	)

47 
	#dk_g_brd_addss
 
_g_brd_addss


	)

48 
	#dk_g_my_addss
 
_g_my_addss


	)

50 #i
defed
(
BACDL_MSTP
)

51 
	~"dlmp.h
"

53 
	#dk_
 
dlmp_


	)

54 
	#dk_nd_pdu
 
dlmp_nd_pdu


	)

55 
	#dk_ive
 
dlmp_ive


	)

56 
	#dk_nup
 
dlmp_nup


	)

57 
	#dk_g_brd_addss
 
dlmp_g_brd_addss


	)

58 
	#dk_g_my_addss
 
dlmp_g_my_addss


	)

60 #i
defed
(
BACDL_BIP
)

61 
	~"b.h
"

62 
	~"bvlc.h
"

64 
	#dk_
 
b_


	)

65 #i
defed
(
BBMD_ENABLED
) && BBMD_ENABLED

66 
	#dk_nd_pdu
 
bvlc_nd_pdu


	)

67 
	#dk_ive
 
bvlc_ive


	)

69 
	#dk_nd_pdu
 
b_nd_pdu


	)

70 
	#dk_ive
 
b_ive


	)

72 
	#dk_nup
 
b_nup


	)

73 
	#dk_g_brd_addss
 
b_g_brd_addss


	)

74 #ifde
BAC_ROUTING


75 
roud_g_my_addss
(

76 
BACNET_ADDRESS
 * 
my_addss
);

77 
	#dk_g_my_addss
 
roud_g_my_addss


	)

79 
	#dk_g_my_addss
 
b_g_my_addss


	)

82 #i
defed
(
BACDL_BIP6
)

83 
	~"b6.h
"

84 
	~"bvlc6.h
"

85 
	#dk_
 
b6_


	)

86 
	#dk_nd_pdu
 
b6_nd_pdu


	)

87 
	#dk_ive
 
b6_ive


	)

88 
	#dk_nup
 
b6_nup


	)

89 
	#dk_g_brd_addss
 
b6_g_brd_addss


	)

90 
	#dk_g_my_addss
 
b6_g_my_addss


	)

92 #i
defed
(
BACDL_ALL
|| defed(
BACDL_NONE
)

93 
	~"du.h
"

95 
	#MAX_HEADER
 (8)

	)

96 
	#MAX_MPDU
 (
MAX_HEADER
+
MAX_PDU
)

	)

98 #ifde
__lulus


102 
dk_nd_pdu
(

103 
BACNET_ADDRESS
 * 
de
,

104 
BACNET_NPDU_DATA
 * 
du_da
,

105 
ut8_t
 * 
pdu
,

106 
pdu_n
);

107 
ut16_t
 
dk_ive
(

108 
BACNET_ADDRESS
 * 
c
,

109 
ut8_t
 * 
pdu
,

110 
ut16_t
 
max_pdu
,

111 
timeout
);

112 
dk_nup
(

114 
dk_g_brd_addss
(

115 
BACNET_ADDRESS
 * 
de
);

116 
dk_g_my_addss
(

117 
BACNET_ADDRESS
 * 
my_addss
);

118 
dk_t_r
(

119 *
iame
);

120 
dk_t
(

121 *
dk_rg
);

123 #ifde
__lulus


	@include/datetime.h

24 #ide
DATE_TIME_H


25 
	#DATE_TIME_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

30 
	eBACt_Wkday
 {

31 
	mBACNET_WEEKDAY_MONDAY
 = 1,

32 
	mBACNET_WEEKDAY_TUESDAY
 = 2,

33 
	mBACNET_WEEKDAY_WEDNESDAY
 = 3,

34 
	mBACNET_WEEKDAY_THURSDAY
 = 4,

35 
	mBACNET_WEEKDAY_FRIDAY
 = 5,

36 
	mBACNET_WEEKDAY_SATURDAY
 = 6,

37 
	mBACNET_WEEKDAY_SUNDAY
 = 7

38 } 
	tBACNET_WEEKDAY
;

41 
	sBACt_De
 {

42 
ut16_t
 
	myr
;

43 
ut8_t
 
	mmth
;

44 
ut8_t
 
	mday
;

45 
ut8_t
 
	mwday
;

46 } 
	tBACNET_DATE
;

49 
	sBACt_Time
 {

50 
ut8_t
 
	mhour
;

51 
ut8_t
 
	mm
;

52 
ut8_t
 
	mc
;

53 
ut8_t
 
	mhunddths
;

54 } 
	tBACNET_TIME
;

56 
	sBACt_DeTime
 {

57 
BACNET_DATE
 
	mde
;

58 
BACNET_TIME
 
	mtime
;

59 } 
	tBACNET_DATE_TIME
;

61 #ifde
__lulus


66 
dime_t_de
(

67 
BACNET_DATE
 * 
bde
,

68 
ut16_t
 
yr
,

69 
ut8_t
 
mth
,

70 
ut8_t
 
day
);

71 
dime_t_time
(

72 
BACNET_TIME
 * 
btime
,

73 
ut8_t
 
hour
,

74 
ut8_t
 
mu
,

75 
ut8_t
 
cds
,

76 
ut8_t
 
hunddths
);

77 
dime_t
(

78 
BACNET_DATE_TIME
 * 
bdime
,

79 
BACNET_DATE
 * 
bde
,

80 
BACNET_TIME
 * 
btime
);

81 
dime_t_vues
(

82 
BACNET_DATE_TIME
 * 
bdime
,

83 
ut16_t
 
yr
,

84 
ut8_t
 
mth
,

85 
ut8_t
 
day
,

86 
ut8_t
 
hour
,

87 
ut8_t
 
mu
,

88 
ut8_t
 
cds
,

89 
ut8_t
 
hunddths
);

91 
bo
 
dime_is_vid
(

92 
BACNET_DATE
 * 
bde
,

93 
BACNET_TIME
 * 
btime
);

94 
bo
 
dime_time_is_vid
(

95 
BACNET_TIME
 *
btime
);

96 
bo
 
dime_de_is_vid
(

97 
BACNET_DATE
 *
bde
);

99 
ut32_t
 
dime_days_s_och
(

100 
BACNET_DATE
 *
bde
);

101 
dime_days_s_och_to_de
(

102 
ut32_t
 
days
,

103 
BACNET_DATE
 *
bde
);

104 
ut32_t
 
dime_day_of_yr
(

105 
BACNET_DATE
 *
bde
);

106 
dime_day_of_yr_to_de
(

107 
ut32_t
 
days
,

108 
ut16_t
 
yr
,

109 
BACNET_DATE
 *
bde
);

110 
bo
 
dime_is_˭_yr
(

111 
ut16_t
 
yr
);

112 
ut8_t
 
dime_mth_days
(

113 
ut16_t
 
yr
,

114 
ut8_t
 
mth
);

115 
ut8_t
 
dime_day_of_wk
(

116 
ut16_t
 
yr
,

117 
ut8_t
 
mth
,

118 
ut8_t
 
day
);

119 
bo
 
dime_ymd_is_vid
(

120 
ut16_t
 
yr
,

121 
ut8_t
 
mth
,

122 
ut8_t
 
day
);

123 
ut32_t
 
dime_cds_s_midnight
(

124 
BACNET_TIME
 *
btime
);

125 
ut16_t
 
dime_mus_s_midnight
(

126 
BACNET_TIME
 *
btime
);

132 
dime_com_de
(

133 
BACNET_DATE
 * 
de1
,

134 
BACNET_DATE
 * 
de2
);

135 
dime_com_time
(

136 
BACNET_TIME
 * 
time1
,

137 
BACNET_TIME
 * 
time2
);

138 
dime_com
(

139 
BACNET_DATE_TIME
 * 
dime1
,

140 
BACNET_DATE_TIME
 * 
dime2
);

145 
dime_wdrd_com_de
(

146 
BACNET_DATE
 * 
de1
,

147 
BACNET_DATE
 * 
de2
);

148 
dime_wdrd_com_time
(

149 
BACNET_TIME
 * 
time1
,

150 
BACNET_TIME
 * 
time2
);

151 
dime_wdrd_com
(

152 
BACNET_DATE_TIME
 * 
dime1
,

153 
BACNET_DATE_TIME
 * 
dime2
);

156 
dime_cy_de
(

157 
BACNET_DATE
 * 
de
,

158 
BACNET_DATE
 * 
c
);

159 
dime_cy_time
(

160 
BACNET_TIME
 * 
de
,

161 
BACNET_TIME
 * 
c
);

162 
dime_cy
(

163 
BACNET_DATE_TIME
 * 
de
,

164 
BACNET_DATE_TIME
 * 
c
);

167 
dime_add_mus
(

168 
BACNET_DATE_TIME
 * 
bdime
,

169 
t32_t
 
mus
);

172 
bo
 
dime_wdrd
(

173 
BACNET_DATE_TIME
 * 
bdime
);

174 
bo
 
dime_wdrd_e
(

175 
BACNET_DATE_TIME
 * 
bdime
);

176 
dime_wdrd_t
(

177 
BACNET_DATE_TIME
 * 
bdime
);

178 
dime_de_wdrd_t
(

179 
BACNET_DATE
 * 
bde
);

180 
dime_time_wdrd_t
(

181 
BACNET_TIME
 * 
btime
);

183 
ba_code_dime
(

184 
ut8_t
 * 
du
,

185 
BACNET_DATE_TIME
 * 
vue
);

187 
ba_code_cڋxt_dime
(

188 
ut8_t
 * 
du
,

189 
ut8_t
 
g_numb
,

190 
BACNET_DATE_TIME
 * 
vue
);

192 
ba_decode_dime
(

193 
ut8_t
 * 
du
,

194 
BACNET_DATE_TIME
 * 
vue
);

196 
ba_decode_cڋxt_dime
(

197 
ut8_t
 * 
du
,

198 
ut8_t
 
g_numb
,

199 
BACNET_DATE_TIME
 * 
vue
);

201 #ifde
TEST


202 
	~"e.h
"

203 
DeTime
(

204 
Te
 * 
pTe
);

207 #ifde
__lulus


	@include/dcc.h

24 #ide
DCC_H


25 
	#DCC_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"banum.h
"

30 
	~"bacr.h
"

32 #ifde
__lulus


37 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
dcc_ab_us
(

39 
bo
 
dcc_communiti_abd
(

41 
bo
 
dcc_communiti_dibd
(

43 
bo
 
dcc_communiti_ti_dibd
(

46 
ut32_t
 
dcc_duti_cds
(

50 
dcc_tim_cds
(

51 
ut32_t
 
cds
);

53 
bo
 
dcc_t_us_duti
(

54 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
us
,

55 
ut16_t
 
mus
);

58 
dcc_code_du
(

59 
ut8_t
 * 
du
,

60 
ut8_t
 
voke_id
,

61 
ut16_t
 
timeDuti
,

62 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
ab_dib
,

63 
BACNET_CHARACTER_STRING
 * 
sswd
);

66 
dcc_decode_rvi_que
(

67 
ut8_t
 * 
du
,

68 
du_n
,

69 
ut16_t
 * 
timeDuti
,

70 
BACNET_COMMUNICATION_ENABLE_DISABLE
 * 
ab_dib
,

71 
BACNET_CHARACTER_STRING
 * 
sswd
);

73 #ifde
TEST


74 
	~"e.h
"

75 
dcc_decode_du
(

76 
ut8_t
 * 
du
,

77 
du_n
,

78 
ut8_t
 * 
voke_id
,

79 
ut16_t
 * 
timeDuti
,

80 
BACNET_COMMUNICATION_ENABLE_DISABLE
 * 
ab_dib
,

81 
BACNET_CHARACTER_STRING
 * 
sswd
);

83 
_DeviCommunitiCڌ
(

84 
Te
 * 
pTe
);

87 #ifde
__lulus


	@include/debug.h

24 #ide
DEBUG_H


25 
	#DEBUG_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~<dio.h
>

30 
	~"bacdef.h
"

32 #ide
DEBUG_ENABLED


33 
	#DEBUG_ENABLED
 0

	)

36 #ifde
__lulus


40 
debug_tf
(

41 cڡ *
fm
,

43 #i
DEBUG_ENABLED


54 #ifde
__lulus


	@include/dlenv.h

25 #ide
DLENV_H


26 
	#DLENV_H


	)

28 #ifde
__lulus


32 
dnv_
(

34 
dnv_gi_as_feign_devi
(

36 
dnv_man_tim
(

37 
ut16_t
 
d_cds
);

40 
dnv_bbmd_addss_t
(

41 
addss
);

42 
dnv_bbmd_pt_t
(

43 
pt
);

44 
dnv_bbmd_l_t
(

45 
l_cs
);

46 
dnv_bbmd_su
(

49 #ifde
__lulus


	@include/dlmstp.h

24 #ide
DLMSTP_H


25 
	#DLMSTP_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<ddef.h
>

30 
	~"bacdef.h
"

31 
	~"du.h
"

35 
	#MAX_HEADER
 (2+1+1+1+2+1+2)

	)

36 
	#MAX_MPDU
 (
MAX_HEADER
+
MAX_PDU
)

	)

38 
	sdlmp_ck
 {

39 
bo
 
	mady
;

40 
BACNET_ADDRESS
 
	maddss
;

41 
ut8_t
 
	mame_ty
;

42 
ut16_t
 
	mpdu_n
;

43 
ut8_t
 
	mpdu
[
MAX_MPDU
];

44 } 
	tDLMSTP_PACKET
;

46 #ifde
__lulus


50 
bo
 
dlmp_
(

51 *
iame
);

52 
dlmp_t
(

54 
dlmp_nup
(

58 
dlmp_nd_pdu
(

59 
BACNET_ADDRESS
 * 
de
,

60 
BACNET_NPDU_DATA
 * 
du_da
,

61 
ut8_t
 * 
pdu
,

62 
pdu_n
);

65 
ut16_t
 
dlmp_ive
(

66 
BACNET_ADDRESS
 * 
c
,

67 
ut8_t
 * 
pdu
,

68 
ut16_t
 
max_pdu
,

69 
timeout
);

78 
dlmp_t_max_fo_ames
(

79 
ut8_t
 
max_fo_ames
);

80 
ut8_t
 
dlmp_max_fo_ames
(

88 
dlmp_t_max_ma
(

89 
ut8_t
 
max_ma
);

90 
ut8_t
 
dlmp_max_ma
(

94 
dlmp_t_mac_addss
(

95 
ut8_t
 
my_addss
);

96 
ut8_t
 
dlmp_mac_addss
(

99 
dlmp_g_my_addss
(

100 
BACNET_ADDRESS
 * 
my_addss
);

101 
dlmp_g_brd_addss
(

102 
BACNET_ADDRESS
 * 
de
);

105 
dlmp_t_baud_
(

106 
ut32_t
 
baud
);

107 
ut32_t
 
dlmp_baud_
(

110 
dlmp_fl_ba_addss
(

111 
BACNET_ADDRESS
 * 
c
,

112 
ut8_t
 
mp_addss
);

114 
bo
 
dlmp_se_ma
(

116 
bo
 
dlmp_nd_pdu_queue_emy
();

117 
bo
 
dlmp_nd_pdu_queue_fu
();

119 #ifde
__lulus


	@include/ethernet.h

24 #ide
ETHERNET_H


25 
	#ETHERNET_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<ddef.h
>

30 
	~"bacdef.h
"

31 
	~"du.h
"

34 
	#MAX_HEADER
 (6+6+2+1+1+1)

	)

35 
	#MAX_MPDU
 (
MAX_HEADER
+
MAX_PDU
)

	)

37 #ifde
__lulus


41 
bo
 
ht_vid
(

43 
ht_nup
(

45 
bo
 
ht_
(

46 *
r_me
);

50 
ht_nd_pdu
(

51 
BACNET_ADDRESS
 * 
de
,

52 
BACNET_NPDU_DATA
 * 
du_da
,

53 
ut8_t
 * 
pdu
,

54 
pdu_n
);

58 
ut16_t
 
ht_ive
(

59 
BACNET_ADDRESS
 * 
c
,

60 
ut8_t
 * 
pdu
,

61 
ut16_t
 
max_pdu
,

62 
timeout
);

64 
ht_t_my_addss
(

65 
BACNET_ADDRESS
 * 
my_addss
);

66 
ht_g_my_addss
(

67 
BACNET_ADDRESS
 * 
my_addss
);

68 
ht_g_brd_addss
(

69 
BACNET_ADDRESS
 * 
de
);

72 
ht_debug_addss
(

73 cڡ *
fo
,

74 
BACNET_ADDRESS
 * 
de
);

75 
ht_nd
(

76 
ut8_t
 * 
mtu
,

77 
mtu_n
);

79 #ifde
__lulus


	@include/event.h

24 #ide
BACNET_EVENT_H_


25 
	#BACNET_EVENT_H_


	)

27 
	~"banum.h
"

28 
	~<dt.h
>

29 
	~<dbo.h
>

30 
	~"ba.h
"

31 
	~"timeamp.h
"

32 
	~"barݡes.h
"

33 
	~"bacdevobjݻf.h
"

36 
	mCHANGE_OF_VALUE_BITS
,

37 
	mCHANGE_OF_VALUE_REAL


38 } 
	tCHANGE_OF_VALUE_TYPE
;

44 
	sBACt_Evt_Nifiti_Da
 {

45 
ut32_t
 
	mossIdtifr
;

46 
BACNET_OBJECT_ID
 
	mtgObjeIdtifr
;

47 
BACNET_OBJECT_ID
 
	mevtObjeIdtifr
;

48 
BACNET_TIMESTAMP
 
	mtimeSmp
;

49 
ut32_t
 
	mnifitiCss
;

50 
ut8_t
 
	miܙy
;

51 
BACNET_EVENT_TYPE
 
	mevtTy
;

52 
BACNET_CHARACTER_STRING
 *
	mmesgeText
;

53 
BACNET_NOTIFY_TYPE
 
	mnifyTy
;

54 
bo
 
	mackRequed
;

55 
BACNET_EVENT_STATE
 
	momS
;

56 
BACNET_EVENT_STATE
 
	mtoS
;

67 
BACNET_BIT_STRING
 
	mndBSg
;

68 
BACNET_BIT_STRING
 
	musFgs
;

69 } 
	mchgeOfBrg
;

74 
BACNET_PROPERTY_STATE
 
	mwS
;

75 
BACNET_BIT_STRING
 
	musFgs
;

76 } 
	mchgeOfS
;

82 
BACNET_BIT_STRING
 
	mchgedBs
;

83 
	mchgeVue
;

84 } 
	mwVue
;

85 
CHANGE_OF_VALUE_TYPE
 
	mg
;

86 
BACNET_BIT_STRING
 
	musFgs
;

87 } 
	mchgeOfVue
;

97 
	mnVue
;

98 
BACNET_BIT_STRING
 
	musFgs
;

99 
	mtPotVue
;

100 
	mrLim
;

101 } 
	mtgLim
;

106 
	mexedgVue
;

107 
BACNET_BIT_STRING
 
	musFgs
;

108 
	mddbd
;

109 
	mexededLim
;

110 } 
	moutOfRge
;

115 
BACNET_LIFE_SAFETY_STATE
 
	mwS
;

116 
BACNET_LIFE_SAFETY_MODE
 
	mwMode
;

117 
BACNET_BIT_STRING
 
	musFgs
;

118 
BACNET_LIFE_SAFETY_OPERATION
 
	mݔiExed
;

119 } 
	mchgeOfLiSaty
;

129 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 
	mbufrPrݔty
;

130 
ut32_t
 
	meviousNifiti
;

131 
ut32_t
 
	mcutNifiti
;

132 } 
	mbufrRdy
;

137 
ut32_t
 
	mexedgVue
;

138 
BACNET_BIT_STRING
 
	musFgs
;

139 
ut32_t
 
	mexededLim
;

140 } 
	munsigdRge
;

141 } 
	mnifitiPams
;

142 } 
	tBACNET_EVENT_NOTIFICATION_DATA
;

145 #ifde
__lulus


154 
vt_nify_code_du
(

155 
ut8_t
 * 
du
,

156 
ut8_t
 
voke_id
,

157 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
);

164 
uevt_nify_code_du
(

165 
ut8_t
 * 
du
,

166 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
);

173 
evt_nify_code_rvi_que
(

174 
ut8_t
 * 
du
,

175 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
);

182 
evt_nify_decode_rvi_que
(

183 
ut8_t
 * 
du
,

184 
du_n
,

185 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
);

192 
uevt_nify_nd
(

193 
ut8_t
 * 
bufr
,

194 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
,

195 
BACNET_ADDRESS
 * 
de
);

198 #ifde
__lulus


	@include/fifo.h

6 #ide
FIFO_H


7 
	#FIFO_H


	)

9 
	~<dt.h
>

10 
	~<dbo.h
>

17 
	sfifo_bufr_t
 {

19 vީ
	mhd
;

21 vީ
	m
;

23 vީ
ut8_t
 *
	mbufr
;

25 
	mbufr_n
;

27 
fifo_bufr_t
 
	tFIFO_BUFFER
;

30 #ifde
__lulus


34 
FIFO_Cou
(

35 
FIFO_BUFFER
 cڡ *
b
);

37 
bo
 
FIFO_Fu
(

38 
FIFO_BUFFER
 cڡ *
b
);

40 
bo
 
FIFO_Avaab
(

41 
FIFO_BUFFER
 cڡ *
b
,

42 
cou
);

44 
bo
 
FIFO_Emy
(

45 
FIFO_BUFFER
 cڡ *
b
);

47 
ut8_t
 
FIFO_Pk
(

48 
FIFO_BUFFER
 cڡ *
b
);

50 
ut8_t
 
FIFO_G
(

51 
FIFO_BUFFER
 * 
b
);

53 
FIFO_Pu
(

54 
FIFO_BUFFER
 * 
b
,

55 
ut8_t
 * 
da_bys
,

56 
ngth
);

58 
bo
 
FIFO_Put
(

59 
FIFO_BUFFER
 * 
b
,

60 
ut8_t
 
da_by
);

62 
bo
 
FIFO_Add
(

63 
FIFO_BUFFER
 * 
b
,

64 
ut8_t
 * 
da_bys
,

65 
cou
);

67 
FIFO_Flush
(

68 
FIFO_BUFFER
 * 
b
);

71 
FIFO_In
(

72 
FIFO_BUFFER
 * 
b
,

73 vީ
ut8_t
 * 
bufr
,

74 
bufr_n
);

76 #ifde
TEST


77 
	~"e.h
"

78 
FIFOBufr
(

79 
Te
 * 
pTe
);

82 #ifde
__lulus


	@include/filename.h

24 #ide
FILENAME_H


25 
	#FILENAME_H


	)

27 #ifde
__lulus


31 *
fame_move_th
(

32 cڡ *
fame_
);

34 #ifde
__lulus


	@include/get_alarm_sum.h

26 #ide
BACNET_GET_ALARM_SUM_H_


27 
	#BACNET_GET_ALARM_SUM_H_


	)

29 
	~"banum.h
"

30 
	~<dt.h
>

31 
	~<dbo.h
>

32 
	~"ba.h
"

33 
	~"timeamp.h
"

36 
	sBACt_G_Arm_Summy_Da
 {

37 
BACNET_OBJECT_ID
 
	mobjeIdtifr
;

38 
BACNET_EVENT_STATE
 
	mmS
;

39 
BACNET_BIT_STRING
 
	macknowdgedTnsis
;

40 } 
	tBACNET_GET_ALARM_SUMMARY_DATA
;

47 *
	tg_m_summy_funi
) (

48 
	tdex
,

49 
	tBACNET_GET_ALARM_SUMMARY_DATA
 * 
	tgm_da
);

52 #ifde
__lulus


57 
	`hdr_g_m_summy_t
(

58 
BACNET_OBJECT_TYPE
 
obje_ty
,

59 
g_m_summy_funi
 
pFuni
);

62 
	`g_m_summy_ack_code_du_
(

63 
ut8_t
 * 
du
,

64 
ut8_t
 
voke_id
);

66 
	`g_m_summy_ack_code_du_da
(

67 
ut8_t
 * 
du
,

68 
size_t
 
max_du
,

69 
BACNET_GET_ALARM_SUMMARY_DATA
 * 
g_m_da
);

71 
	`g_m_summy_ack_decode_du_da
(

72 
ut8_t
 * 
du
,

73 
size_t
 
max_du
,

74 
BACNET_GET_ALARM_SUMMARY_DATA
 * 
g_m_da
);

76 #ifde
__lulus


77 
	}
}

	@include/getevent.h

24 #ide
GETEVENT_H


25 
	#GETEVENT_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacdef.h
"

30 
	~"banum.h
"

31 
	~"timeamp.h
"

32 
	~"evt.h
"

34 
	gBACt_G_Evt_Infmi_Da
;

35 
	sBACt_G_Evt_Infmi_Da
 {

36 
BACNET_OBJECT_ID
 
	mobjeIdtifr
;

37 
BACNET_EVENT_STATE
 
	mevtS
;

38 
BACNET_BIT_STRING
 
	macknowdgedTnsis
;

39 
BACNET_TIMESTAMP
 
	mevtTimeSmps
[3];

40 
BACNET_NOTIFY_TYPE
 
	mnifyTy
;

41 
BACNET_BIT_STRING
 
	mevtEb
;

42 
ut32_t
 
	mevtPriܙs
[3];

43 
BACt_G_Evt_Infmi_Da
 *
	mxt
;

44 } 
	tBACNET_GET_EVENT_INFORMATION_DATA
;

50 *
	tg_evt_fo_funi
) (

51 
	tdex
,

52 
	tBACNET_GET_EVENT_INFORMATION_DATA
 * 
	tgevt_da
);

54 #ifde
__lulus


58 
	`gevt_code_du
(

59 
ut8_t
 * 
du
,

60 
ut8_t
 
voke_id
,

61 
BACNET_OBJECT_ID
 * 
ϡReivedObjeIdtifr
);

63 
	`gevt_decode_rvi_que
(

64 
ut8_t
 * 
du
,

65 
du_n
,

66 
BACNET_OBJECT_ID
 * 
obje_id
);

68 
	`gevt_ack_code_du_
(

69 
ut8_t
 * 
du
,

70 
size_t
 
max_du
,

71 
ut8_t
 
voke_id
);

73 
	`gevt_ack_code_du_da
(

74 
ut8_t
 * 
du
,

75 
size_t
 
max_du
,

76 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
g_evt_da
);

78 
	`gevt_ack_code_du_d
(

79 
ut8_t
 * 
du
,

80 
size_t
 
max_du
,

81 
bo
 
meEvts
);

83 
	`gevt_ack_decode_rvi_que
(

84 
ut8_t
 * 
du
,

85 
du_n
,

86 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
g_evt_da
,

87 
bo
 * 
meEvts
);

89 #ifde
TEST


90 
	~"e.h
"

91 
	`gevt_decode_du
(

92 
ut8_t
 * 
du
,

93 
du_n
,

94 
ut8_t
 * 
voke_id
,

95 
BACNET_OBJECT_ID
 * 
ϡReivedObjeIdtifr
);

97 
	`gevt_ack_decode_du
(

98 
ut8_t
 * 
du
,

99 
du_n
,

100 
ut8_t
 * 
voke_id
,

101 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
g_evt_da
,

102 
bo
 * 
meEvts
);

104 
	`GEvtInfmiAck
(

105 
Te
 * 
pTe
);

107 
	`GEvtInfmi
(

108 
Te
 * 
pTe
);

112 #ifde
__lulus


113 
	}
}

	@include/handlers.h

25 #ide
HANDLERS_H


26 
	#HANDLERS_H


	)

28 
	~<ddef.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"du.h
"

33 
	~"ba.h
"

34 
	~"rd.h
"

35 
	~".h
"

36 
	~"m.h
"

37 
	~"wp.h
"

38 
	~"adnge.h
"

39 
	~"gevt.h
"

40 
	~"g_m_sum.h
"

41 
	~"m_ack.h
"

44 #ifde
__lulus


48 
hdr_uecognized_rvi
(

49 
ut8_t
 * 
rvi_que
,

50 
ut16_t
 
rvi_n
,

51 
BACNET_ADDRESS
 * 
de
,

52 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

54 
du_hdr
(

55 
BACNET_ADDRESS
 * 
c
,

56 
ut8_t
 * 
pdu
,

57 
ut16_t
 
pdu_n
);

59 
routg_du_hdr
(

60 
BACNET_ADDRESS
 * 
c
,

61 *
DNET_li
,

62 
ut8_t
 * 
pdu
,

63 
ut16_t
 
pdu_n
);

65 
hdr_who_is
(

66 
ut8_t
 * 
rvi_que
,

67 
ut16_t
 
rvi_n
,

68 
BACNET_ADDRESS
 * 
c
);

70 
hdr_who_is_uni
(

71 
ut8_t
 * 
rvi_que
,

72 
ut16_t
 
rvi_n
,

73 
BACNET_ADDRESS
 * 
c
);

75 
hdr_who_is_b_f_routg
(

76 
ut8_t
 * 
rvi_que
,

77 
ut16_t
 
rvi_n
,

78 
BACNET_ADDRESS
 * 
c
);

80 
hdr_who_is_uni_f_routg
(

81 
ut8_t
 * 
rvi_que
,

82 
ut16_t
 
rvi_n
,

83 
BACNET_ADDRESS
 * 
c
);

85 
hdr_who_has
(

86 
ut8_t
 * 
rvi_que
,

87 
ut16_t
 
rvi_n
,

88 
BACNET_ADDRESS
 * 
c
);

90 
hdr_who_has_f_routg
(

91 
ut8_t
 * 
rvi_que
,

92 
ut16_t
 
rvi_n
,

93 
BACNET_ADDRESS
 * 
c
);

95 
hdr_i_am_add
(

96 
ut8_t
 * 
rvi_que
,

97 
ut16_t
 
rvi_n
,

98 
BACNET_ADDRESS
 * 
c
);

100 
hdr_i_am_bd
(

101 
ut8_t
 * 
rvi_que
,

102 
ut16_t
 
rvi_n
,

103 
BACNET_ADDRESS
 * 
c
);

105 
hdr_ad_ݔty
(

106 
ut8_t
 * 
rvi_que
,

107 
ut16_t
 
rvi_n
,

108 
BACNET_ADDRESS
 * 
c
,

109 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

111 
hdr_ad_ݔty_ack
(

112 
ut8_t
 * 
rvi_que
,

113 
ut16_t
 
rvi_n
,

114 
BACNET_ADDRESS
 * 
c
,

115 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
);

117 
hdr_wre_ݔty
(

118 
ut8_t
 * 
rvi_que
,

119 
ut16_t
 
rvi_n
,

120 
BACNET_ADDRESS
 * 
c
,

121 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

123 
hdr_wre_ݔty_muɝ
(

124 
ut8_t
 * 
rvi_que
,

125 
ut16_t
 
rvi_n
,

126 
BACNET_ADDRESS
 * 
c
,

127 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

129 
bo
 
WPVideSg
(

130 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

131 
iMaxL
,

132 
bo
 
bEmyAowed
,

133 
BACNET_ERROR_CLASS
 * 
pECss
,

134 
BACNET_ERROR_CODE
 * 
pECode
);

136 
bo
 
WPVideArgTy
(

137 
BACNET_APPLICATION_DATA_VALUE
 * 
pVue
,

138 
ut8_t
 
ucExedTy
,

139 
BACNET_ERROR_CLASS
 * 
pECss
,

140 
BACNET_ERROR_CODE
 * 
pECode
);

142 
hdr_omic_ad_fe
(

143 
ut8_t
 * 
rvi_que
,

144 
ut16_t
 
rvi_n
,

145 
BACNET_ADDRESS
 * 
c
,

146 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

148 
hdr_omic_ad_fe_ack
(

149 
ut8_t
 * 
rvi_que
,

150 
ut16_t
 
rvi_n
,

151 
BACNET_ADDRESS
 * 
c
,

152 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
);

154 
hdr_omic_wre_fe
(

155 
ut8_t
 * 
rvi_que
,

156 
ut16_t
 
rvi_n
,

157 
BACNET_ADDRESS
 * 
c
,

158 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

160 
hdr_lize_devi
(

161 
ut8_t
 * 
rvi_que
,

162 
ut16_t
 
rvi_n
,

163 
BACNET_ADDRESS
 * 
c
,

164 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

166 
hdr_devi_communiti_cڌ
(

167 
ut8_t
 * 
rvi_que
,

168 
ut16_t
 
rvi_n
,

169 
BACNET_ADDRESS
 * 
c
,

170 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

171 
hdr_dcc_sswd_t
(

172 *
w_sswd
);

174 
hdr_i_have
(

175 
ut8_t
 * 
rvi_que
,

176 
ut16_t
 
rvi_n
,

177 
BACNET_ADDRESS
 * 
c
);

180 
hdr_timesync
(

181 
ut8_t
 * 
rvi_que
,

182 
ut16_t
 
rvi_n
,

183 
BACNET_ADDRESS
 * 
c
);

184 
hdr_timesync_utc
(

185 
ut8_t
 * 
rvi_que
,

186 
ut16_t
 
rvi_n
,

187 
BACNET_ADDRESS
 * 
c
);

189 
hdr_timesync_code_cs
(

190 
ut8_t
 * 
du
,

191 
max_du
);

192 
hdr_timesync_sk
(
BACNET_DATE_TIME
 *
bdime
);

193 
hdr_timesync_
(

195 
bo
 
hdr_timesync_c_wre
(

196 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

197 
ut32_t
 
hdr_timesync_rv
();

198 
bo
 
hdr_timesync_rv_t
(
ut32_t
 
mus
);

199 
ut32_t
 
hdr_timesync_rv_offt
();

200 
bo
 
hdr_timesync_rv_offt_t
(
ut32_t
 
mus
);

201 
bo
 
hdr_timesync_rv_ign
();

202 
bo
 
hdr_timesync_rv_ign_t
(bo 
ag
);

203 
bo
 
hdr_timesync_c_addss_t
(

204 
dex
,

205 
BACNET_ADDRESS
 * 
addss
);

207 
hdr_ad_ݔty_muɝ
(

208 
ut8_t
 * 
rvi_que
,

209 
ut16_t
 
rvi_n
,

210 
BACNET_ADDRESS
 * 
c
,

211 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

213 
hdr_ad_ݔty_muɝ_ack
(

214 
ut8_t
 * 
rvi_que
,

215 
ut16_t
 
rvi_n
,

216 
BACNET_ADDRESS
 * 
c
,

217 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
);

220 
m_ack_decode_rvi_que
(

221 
ut8_t
 * 
du
,

222 
du_n
,

223 
BACNET_READ_ACCESS_DATA
 * 
ad_acss_da
);

225 
_ack_t_da
(

226 
BACNET_READ_PROPERTY_DATA
 * 
da
);

228 
m_ack_t_da
(

229 
BACNET_READ_ACCESS_DATA
 * 
m_da
);

231 
hdr_cov_subsibe
(

232 
ut8_t
 * 
rvi_que
,

233 
ut16_t
 
rvi_n
,

234 
BACNET_ADDRESS
 * 
c
,

235 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

236 
bo
 
hdr_cov_fsm
(

238 
hdr_cov_sk
(

240 
hdr_cov_tim_cds
(

241 
ut32_t
 
d_cds
);

242 
hdr_cov_
(

244 
hdr_cov_code_substis
(

245 
ut8_t
 * 
du
,

246 
max_du
);

248 
hdr_ucov_nifiti
(

249 
ut8_t
 * 
rvi_que
,

250 
ut16_t
 
rvi_n
,

251 
BACNET_ADDRESS
 * 
c
);

252 
hdr_ccov_nifiti
(

253 
ut8_t
 * 
rvi_que
,

254 
ut16_t
 
rvi_n
,

255 
BACNET_ADDRESS
 * 
c
,

256 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

258 
hdr_lso
(

259 
ut8_t
 * 
rvi_que
,

260 
ut16_t
 
rvi_n
,

261 
BACNET_ADDRESS
 * 
c
,

262 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

264 
hdr_m_ack
(

265 
ut8_t
 * 
rvi_que
,

266 
ut16_t
 
rvi_n
,

267 
BACNET_ADDRESS
 * 
c
,

268 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

270 
hdr_m_ack_t
(

271 
BACNET_OBJECT_TYPE
 
obje_ty
,

272 
m_ack_funi
 
pFuni
);

274 
hdr_cf_ive_s
(

275 
ut8_t
 * 
rvi_que
,

276 
ut16_t
 
rvi_n
,

277 
BACNET_ADDRESS
 * 
c
,

278 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

280 
hdr_cf_ive_s_ack
(

281 
ut8_t
 * 
rvi_que
,

282 
ut16_t
 
rvi_n
,

283 
BACNET_ADDRESS
 * 
c
,

284 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
);

286 
hdr_uncfmed_ive_sr
(

287 
ut8_t
 * 
rvi_que
,

288 
ut16_t
 
rvi_n
,

289 
BACNET_ADDRESS
 * 
c
);

291 
hdr_ad_nge
(

292 
ut8_t
 * 
rvi_que
,

293 
ut16_t
 
rvi_n
,

294 
BACNET_ADDRESS
 * 
c
,

295 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

297 
hdr_ad_nge_ack
(

298 
ut8_t
 * 
rvi_que
,

299 
ut16_t
 
rvi_n
,

300 
BACNET_ADDRESS
 * 
c
,

301 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
);

303 
hdr_g_evt_fmi_t
(

304 
BACNET_OBJECT_TYPE
 
obje_ty
,

305 
g_evt_fo_funi
 
pFuni
);

307 
hdr_g_evt_fmi
(

308 
ut8_t
 * 
rvi_que
,

309 
ut16_t
 
rvi_n
,

310 
BACNET_ADDRESS
 * 
c
,

311 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

313 
hdr_g_m_summy_t
(

314 
BACNET_OBJECT_TYPE
 
obje_ty
,

315 
g_m_summy_funi
 
pFuni
);

317 
hdr_g_m_summy
(

318 
ut8_t
 * 
rvi_que
,

319 
ut16_t
 
rvi_n
,

320 
BACNET_ADDRESS
 * 
c
,

321 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
);

323 
g_m_summy_ack_hdr
(

324 
ut8_t
 * 
rvi_que
,

325 
ut16_t
 
rvi_n
,

326 
BACNET_ADDRESS
 * 
c
,

327 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 * 
rvi_da
);

330 #ifde
__lulus


	@include/iam.h

24 #ide
IAM_H


25 
	#IAM_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacdef.h
"

30 
	~"baddr.h
"

31 
	~"du.h
"

33 #ifde
__lulus


37 
m_code_du
(

38 
ut8_t
 * 
du
,

39 
ut32_t
 
devi_id
,

40 
max_du
,

41 
gmti
,

42 
ut16_t
 
vd_id
);

44 
m_decode_rvi_que
(

45 
ut8_t
 * 
du
,

46 
ut32_t
 * 
pDevi_id
,

47 *
pMax_du
,

48 *
pSegmti
,

49 
ut16_t
 * 
pVd_id
);

51 #ifde
TEST


52 
	~"e.h
"

53 
m_decode_du
(

54 
ut8_t
 * 
du
,

55 
ut32_t
 * 
pDevi_id
,

56 *
pMax_du
,

57 *
pSegmti
,

58 
ut16_t
 * 
pVd_id
);

60 
IAm
(

61 
Te
 * 
pTe
);

64 #ifde
__lulus


	@include/ihave.h

24 #ide
IHAVE_H


25 
	#IHAVE_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacr.h
"

31 
	sBACt_I_Have_Da
 {

32 
BACNET_OBJECT_ID
 
	mdevi_id
;

33 
BACNET_OBJECT_ID
 
	mobje_id
;

34 
BACNET_CHARACTER_STRING
 
	mobje_me
;

35 } 
	tBACNET_I_HAVE_DATA
;

37 #ifde
__lulus


41 
ihave_code_du
(

42 
ut8_t
 * 
du
,

43 
BACNET_I_HAVE_DATA
 * 
da
);

45 
ihave_decode_rvi_que
(

46 
ut8_t
 * 
du
,

47 
du_n
,

48 
BACNET_I_HAVE_DATA
 * 
da
);

50 
ihave_decode_du
(

51 
ut8_t
 * 
du
,

52 
du_n
,

53 
BACNET_I_HAVE_DATA
 * 
da
);

55 #ifde
TEST


56 
	~"e.h
"

57 
IHave
(

58 
Te
 * 
pTe
);

61 #ifde
__lulus


	@include/indtext.h

24 #ide
INDTEXT_H


25 
	#INDTEXT_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<rg.h
>

33 cڡ 
	mdex
;

34 cڡ *
	mpSg
;

35 } 
	tINDTEXT_DATA
;

37 #ifde
__lulus


46 
bo
 
dxt_by_rg
(

47 
INDTEXT_DATA
 * 
da_li
,

48 cڡ *
ch_me
,

49 *
found_dex
);

51 
bo
 
dxt_by_irg
(

52 
INDTEXT_DATA
 * 
da_li
,

53 cڡ *
ch_me
,

54 *
found_dex
);

57 
dxt_by_rg_deu
(

58 
INDTEXT_DATA
 * 
da_li
,

59 cڡ *
ch_me
,

60 
deu_dex
);

62 
dxt_by_irg_deu
(

63 
INDTEXT_DATA
 * 
da_li
,

64 cڡ *
ch_me
,

65 
deu_dex
);

68 cڡ *
dxt_by_dex
(

69 
INDTEXT_DATA
 * 
da_li
,

70 
dex
);

73 cڡ *
dxt_by_dex_deu
(

74 
INDTEXT_DATA
 * 
da_li
,

75 
dex
,

76 cڡ *
deu_me
);

81 cڡ *
dxt_by_dex_l_deu
(

82 
INDTEXT_DATA
 * 
da_li
,

83 
dex
,

84 
l_dex
,

85 cڡ *
befe_l_deu_me
,

86 cڡ *
deu_me
);

89 
dxt_cou
(

90 
INDTEXT_DATA
 * 
da_li
);

93 #i!
defed
(
__BORLANDC__
&& !defed(
_MSC_VER
)

94 
ricmp
(

95 cڡ *
s1
,

96 cڡ *
s2
);

99 #ifde
TEST


100 
	~"e.h
"

101 
IndexText
(

102 
Te
 * 
pTe
);

105 #ifde
__lulus


	@include/key.h

24 #ide
KEY_H


25 
	#KEY_H


	)

27 
	~<dt.h
>

31 
ut32_t
 
	tKEY
;

34 
	#KEY_TYPE_OFFSET
 22

	)

35 
	#KEY_TYPE_MASK
 0x000003FFL

	)

36 
	#KEY_ID_MASK
 0x003FFFFFL

	)

37 
	#KEY_ID_MAX
 (
KEY_ID_MASK
 + 1L)

	)

38 
	#KEY_TYPE_MAX
 (
KEY_TYPE_MASK
 + 1L)

	)

39 
	#KEY_LAST
(
key
((key & 
KEY_ID_MASK
=
KEY_ID_MAX
)

	)

41 
	#KEY_ENCODE
(
ty
,
id
) ( (()\

42 (()(
ty
& 
KEY_TYPE_MASK
<< 
KEY_TYPE_OFFSET
) |\

43 (()(
id
& 
KEY_ID_MASK
)

	)

45 
	#KEY_DECODE_TYPE
(
key
(()((()(key>> 
KEY_TYPE_OFFSET
)\

46 & 
KEY_TYPE_MASK
))

	)

48 
	#KEY_DECODE_ID
(
key
(()(()(key& 
KEY_ID_MASK
))

	)

	@include/keylist.h

24 #ide
KEYLIST_H


25 
	#KEYLIST_H


	)

27 
	~"key.h
"

34 
	sKeyli_Node
 {

35 
KEY
 
	mkey
;

36 *
	mda
;

39 
	sKeyli
 {

40 
Keyli_Node
 **
	my
;

41 
	mcou
;

42 
	msize
;

43 } 
	tKEYLIST_TYPE
;

44 
KEYLIST_TYPE
 *
	tOS_Keyli
;

46 #ifde
__lulus


51 
OS_Keyli
 
Keyli_Ce
(

56 
Keyli_De
(

57 
OS_Keyli
 
li
);

61 
Keyli_Da_Add
(

62 
OS_Keyli
 
li
,

63 
KEY
 
key
,

64 *
da
);

68 *
Keyli_Da_De
(

69 
OS_Keyli
 
li
,

70 
KEY
 
key
);

74 *
Keyli_Da_De_By_Index
(

75 
OS_Keyli
 
li
,

76 
dex
);

79 *
Keyli_Da_P
(

80 
OS_Keyli
 
li
);

83 *
Keyli_Da
(

84 
OS_Keyli
 
li
,

85 
KEY
 
key
);

88 
Keyli_Index
(

89 
OS_Keyli
 
li
,

90 
KEY
 
key
);

93 *
Keyli_Da_Index
(

94 
OS_Keyli
 
li
,

95 
dex
);

98 
KEY
 
Keyli_Key
(

99 
OS_Keyli
 
li
,

100 
dex
);

103 
KEY
 
Keyli_Next_Emy_Key
(

104 
OS_Keyli
 
li
,

105 
KEY
 
key
);

108 
Keyli_Cou
(

109 
OS_Keyli
 
li
);

111 #ifde
TEST


112 
	~"e.h
"

113 
KeyLi
(

114 
Te
 * 
pTe
);

117 #ifde
__lulus


	@include/lighting.h

24 #ide
LIGHTING_H


25 
	#LIGHTING_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"banum.h
"

42 
	sBACtLightgCommd
 {

43 
BACNET_LIGHTING_OPERATION
 
	mݔi
;

45 
bo
 
	mu_rg_v
:1;

46 
bo
 
	mu_mp_
:1;

47 
bo
 
	mu__emt
:1;

48 
bo
 
	mu_de_time
:1;

49 
bo
 
	mu_iܙy
:1;

50 
	mrg_v
;

51 
	mmp_
;

52 
	m_emt
;

53 
ut32_t
 
	mde_time
;

54 
ut8_t
 
	miܙy
;

55 } 
	tBACNET_LIGHTING_COMMAND
;

57 #ifde
__lulus


61 
lightg_commd_code
(

62 
ut8_t
 * 
du
,

63 
BACNET_LIGHTING_COMMAND
 * 
da
);

64 
lightg_commd_code_cڋxt
(

65 
ut8_t
 * 
du
,

66 
ut8_t
 
g_numb
,

67 
BACNET_LIGHTING_COMMAND
 * 
vue
);

68 
lightg_commd_decode
(

69 
ut8_t
 * 
du
,

70 
du_max_n
,

71 
BACNET_LIGHTING_COMMAND
 * 
da
);

72 
bo
 
lightg_commd_cy
(

73 
BACNET_LIGHTING_COMMAND
 * 
d
,

74 
BACNET_LIGHTING_COMMAND
 * 
c
);

75 
bo
 
lightg_commd_me
(

76 
BACNET_LIGHTING_COMMAND
 * 
d
,

77 
BACNET_LIGHTING_COMMAND
 * 
c
);

79 #ifde
__lulus


	@include/lso.h

24 #ide
LSO_H


25 
	#LSO_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"banum.h
"

30 
	~"bacdef.h
"

31 
	~"bacr.h
"

33 #ifde
__lulus


40 
ut32_t
 
ossId
;

41 
BACNET_CHARACTER_STRING
 
quegSrc
;

42 
BACNET_LIFE_SAFETY_OPERATION
 
ݔi
;

43 
BACNET_OBJECT_ID
 
rgObje
;

44 } 
	tBACNET_LSO_DATA
;

47 
lso_code_du
(

48 
ut8_t
 * 
du
,

49 
ut8_t
 
voke_id
,

50 
BACNET_LSO_DATA
 * 
da
);

52 
lso_decode_rvi_que
(

53 
ut8_t
 * 
du
,

54 
du_n
,

55 
BACNET_LSO_DATA
 * 
da
);

58 #ifde
TEST


59 
	~"e.h
"

60 
LSO
(

61 
Te
 * 
pTe
);

64 #ifde
__lulus


	@include/memcopy.h

24 #ide
MEMCOPY_H


25 
	#MEMCOPY_H


	)

29 
	~<dt.h
>

30 
	~<dbo.h
>

32 #ifde
__lulus


38 
size_t
 
memcy
(

39 *
de
,

40 *
c
,

41 
size_t
 
offt
,

42 
size_t
 
n
,

43 
size_t
 
max
);

45 #ifde
__lulus


	@include/mstp.h

25 #ide
MSTP_H


26 
	#MSTP_H


	)

28 
	~<ddef.h
>

29 
	~<dt.h
>

30 
	~<dbo.h
>

31 
	~"mpdef.h
"

33 
	smp_pt_ru_t
 {

34 
MSTP_RECEIVE_STATE
 
	mive_e
;

37 
MSTP_MASTER_STATE
 
	mma_e
;

41 
	mReiveE
:1;

43 
	mDaAvaab
:1;

44 
	mReivedInvidFme
:1;

48 
	mReivedVidFme
:1;

52 
	mReivedVidFmeNFUs
:1;

55 
	mSeMa
:1;

57 
ut8_t
 
	mDaRegi
;

59 
ut16_t
 
	mDaCRC
;

61 
ut8_t
 
	mDaCRCAuMSB
;

62 
ut8_t
 
	mDaCRCAuLSB
;

64 
ut16_t
 
	mDaLgth
;

66 
ut8_t
 
	mDeiAddss
;

70 
ut8_t
 
	mEvtCou
;

72 
ut8_t
 
	mFmeTy
;

76 
ut8_t
 
	mFmeCou
;

78 
ut8_t
 
	mHdCRC
;

80 
ut8_t
 
	mHdCRCAu
;

83 
ut32_t
 
	mIndex
;

91 
ut8_t
 *
	mIutBufr
;

92 
ut16_t
 
	mIutBufrSize
;

96 
ut8_t
 
	mNext_Sti
;

99 
ut8_t
 
	mPl_Sti
;

102 
	mRryCou
;

112 
ut32_t
(

113 *
STim
) (

114 *
	mpArg
);

116 *
	mSTimRet
) (

117 *
	mpArg
);

127 
ut8_t
 
	mSourAddss
;

133 
	mTokCou
;

139 
ut8_t
 
	mThis_Sti
;

148 
ut8_t
 
	mNmax_fo_ames
;

155 
ut8_t
 
	mNmax_ma
;

164 
ut8_t
 *
	mOuutBufr
;

165 
ut16_t
 
	mOuutBufrSize
;

168 *
	mUrDa
;

172 #ifde
__lulus


176 
MSTP_In
(

177 vީ
mp_pt_ru_t
 *
mp_pt
);

178 
MSTP_Reive_Fme_FSM
(

179 vީ
mp_pt_ru_t


180 *
mp_pt
);

181 
bo
 
MSTP_Ma_Node_FSM
(

182 vީ
mp_pt_ru_t


183 *
mp_pt
);

184 
MSTP_Sve_Node_FSM
(

185 vީ
mp_pt_ru_t
 *
mp_pt
);

188 
bo
 
MSTP_Le_Aive
(

189 vީ
mp_pt_ru_t
 *
mp_pt
);

191 
ut16_t
 
MSTP_Ce_Fme
(

192 
ut8_t
 * 
bufr
,

193 
ut16_t
 
bufr_n
,

194 
ut8_t
 
ame_ty
,

195 
ut8_t
 
dei
,

196 
ut8_t
 
sour
,

197 
ut8_t
 * 
da
,

198 
ut16_t
 
da_n
);

200 
MSTP_Ce_And_Sd_Fme
(

201 vީ
mp_pt_ru_t
 *
mp_pt
,

202 
ut8_t
 
ame_ty
,

203 
ut8_t
 
dei
,

204 
ut8_t
 
sour
,

205 
ut8_t
 * 
da
,

206 
ut16_t
 
da_n
);

208 
MSTP_Fl_BACt_Addss
(

209 
BACNET_ADDRESS
 * 
c
,

210 
ut8_t
 
mp_addss
);

214 
ut16_t
 
MSTP_Put_Reive
(

215 vީ
mp_pt_ru_t
 *
mp_pt
);

219 
ut16_t
 
MSTP_G_Sd
(

220 vީ
mp_pt_ru_t
 *
mp_pt
,

221 
timeout
);

225 
ut16_t
 
MSTP_G_Rly
(

226 vީ
mp_pt_ru_t
 *
mp_pt
,

227 
timeout
);

229 #ifde
__lulus


	@include/mstpdef.h

24 #ide
MSTPDEF_H


25 
	#MSTPDEF_H


	)

27 
	~<ddef.h
>

28 
	~<dt.h
>

29 
	~<dbo.h
>

30 
	~"bacdef.h
"

36 
	#MSTP_BROADCAST_ADDRESS
 255

	)

40 
	#FRAME_TYPE_TOKEN
 0

	)

41 
	#FRAME_TYPE_POLL_FOR_MASTER
 1

	)

42 
	#FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
 2

	)

43 
	#FRAME_TYPE_TEST_REQUEST
 3

	)

44 
	#FRAME_TYPE_TEST_RESPONSE
 4

	)

45 
	#FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
 5

	)

46 
	#FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
 6

	)

47 
	#FRAME_TYPE_REPLY_POSTPONED
 7

	)

54 
	#FRAME_TYPE_PROPRIETARY_MIN
 128

	)

55 
	#FRAME_TYPE_PROPRIETARY_MAX
 255

	)

57 
	#CRC16_INITIAL_VALUE
 (0xFFFF)

	)

61 
	mMSTP_RECEIVE_STATE_IDLE
 = 0,

62 
	mMSTP_RECEIVE_STATE_PREAMBLE
 = 1,

63 
	mMSTP_RECEIVE_STATE_HEADER
 = 2,

64 
	mMSTP_RECEIVE_STATE_DATA
 = 3,

65 
	mMSTP_RECEIVE_STATE_SKIP_DATA
 = 4

66 } 
	tMSTP_RECEIVE_STATE
;

70 
	mMSTP_MASTER_STATE_INITIALIZE
 = 0,

71 
	mMSTP_MASTER_STATE_IDLE
 = 1,

72 
	mMSTP_MASTER_STATE_USE_TOKEN
 = 2,

73 
	mMSTP_MASTER_STATE_WAIT_FOR_REPLY
 = 3,

74 
	mMSTP_MASTER_STATE_DONE_WITH_TOKEN
 = 4,

75 
	mMSTP_MASTER_STATE_PASS_TOKEN
 = 5,

76 
	mMSTP_MASTER_STATE_NO_TOKEN
 = 6,

77 
	mMSTP_MASTER_STATE_POLL_FOR_MASTER
 = 7,

78 
	mMSTP_MASTER_STATE_ANSWER_DATA_REQUEST
 = 8

79 } 
	tMSTP_MASTER_STATE
;

83 
	#Tno_tok
 500

	)

94 
	#Ttuound
 (40UL)

	)

99 
	#Npl
 50

	)

102 
	#Ny_tok
 1

	)

106 
	#Tame_g
 20

	)

111 
	#Tpodrive
 15

	)

115 
	#T
 10

	)

120 
	#Tuge_day
 15

	)

122 
	#DEFAULT_MAX_INFO_FRAMES
 1

	)

123 
	#DEFAULT_MAX_MASTER
 127

	)

124 
	#DEFAULT_MAC_ADDRESS
 127

	)

126 #ifde
__lulus


131 #ifde
__lulus


	@include/mstptext.h

24 #ide
MSTPTEXT_H


25 
	#MSTPTEXT_H


	)

27 #ifde
__lulus


31 cڡ *
mext_ive_e
(

32 
dex
);

33 cڡ *
mext_ma_e
(

34 
dex
);

35 cڡ *
mext_ame_ty
(

36 
dex
);

38 #ifde
__lulus


	@include/mydata.h

7 
	#MY_MAX_STR
 32

	)

8 
	#MY_MAX_BLOCK
 8

	)

10 
	#MY_SVC_READ
 0

	)

11 
	#MY_SVC_WRITE
 1

	)

13 
	#MY_ERR_OK
 0

	)

14 
	#MY_ERR_BAD_INDEX
 1

	)

16 
	sMyDa
 {

17 
ut8_t
 
	mcMyBy1
;

18 
ut8_t
 
	mcMyBy2
;

19 
	mfMyRl
;

20 
t8_t
 
	msMySg
[
MY_MAX_STR
 + 1];

21 } 
	tDATABLOCK
;

	@include/npdu.h

24 #ide
NPDU_H


25 
	#NPDU_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~"bacdef.h
"

30 
	~"banum.h
"

33 #ide
HOP_COUNT_DEFAULT


34 
	#HOP_COUNT_DEFAULT
 255

	)

38 
	sba_du_da_t
 {

39 
ut8_t
 
	moc_vsi
;

41 
bo
 
	mda_exg_y
;

42 
bo
 
	mtwk_y_mesge
;

43 
BACNET_MESSAGE_PRIORITY
 
	miܙy
;

45 
BACNET_NETWORK_MESSAGE_TYPE
 
	mtwk_mesge_ty
;

46 
ut16_t
 
	mvd_id
;

47 
ut8_t
 
	mh_cou
;

48 } 
	tBACNET_NPDU_DATA
;

50 
	grour_pt_t
;

53 
	#ROUTER_PORT_INFO_LEN
 2

	)

55 
	srour_pt_t
 {

56 
ut16_t
 
	mdt
;

57 
ut8_t
 
	mid
;

58 
ut8_t
 
	mfo
[
ROUTER_PORT_INFO_LEN
];

59 
ut8_t
 
	mfo_n
;

60 
rour_pt_t
 *
	mxt
;

61 } 
	tBACNET_ROUTER_PORT
;

63 #ifde
__lulus


67 
ut8_t
 
du_code_max_g_max_du
(

68 
max_gs
,

69 
max_du
);

71 
du_code_pdu
(

72 
ut8_t
 * 
du
,

73 
BACNET_ADDRESS
 * 
de
,

74 
BACNET_ADDRESS
 * 
c
,

75 
BACNET_NPDU_DATA
 * 
du_da
);

77 
du_code_du_da
(

78 
BACNET_NPDU_DATA
 * 
du
,

79 
bo
 
da_exg_y
,

80 
BACNET_MESSAGE_PRIORITY
 
iܙy
);

82 
du_cy_da
(

83 
BACNET_NPDU_DATA
 * 
de
,

84 
BACNET_NPDU_DATA
 * 
c
);

86 
du_decode
(

87 
ut8_t
 * 
du
,

88 
BACNET_ADDRESS
 * 
de
,

89 
BACNET_ADDRESS
 * 
c
,

90 
BACNET_NPDU_DATA
 * 
du_da
);

92 #ifde
__lulus


	@include/objects.h

24 #ide
OBJECTS_H


25 
	#OBJECTS_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~<ddef.h
>

30 
	~"bacdef.h
"

31 
	~"bacr.h
"

32 
	~"banum.h
"

34 
	uBACtS_t
 {

35 
	mFlt
;

36 
t32_t
 
	mIeg
;

37 } 
	tBACNET_SCALE_T
;

40 
	sobje_accumut_t
 {

41 
BACNET_OBJECT_ID
 
	mObje_Idtifr
;

42 
BACNET_CHARACTER_STRING
 
	mObje_Name
;

43 
BACNET_OBJECT_TYPE
 
	mObje_Ty
;

44 
ut32_t
 
	mP_Vue
;

45 
BACNET_STATUS_FLAGS
 
	mStus_Fgs
;

46 
BACNET_EVENT_STATE
 
	mEvt_S
;

47 
bo
 
	mOut_Of_Svi
;

48 
BACNET_SCALE_T
 
	mS
;

49 
BACNET_ENGINEERING_UNITS
 
	mUns
;

50 
ut32_t
 
	mMax_Ps_Vue
;

51 } 
	tOBJECT_ACCUMULATOR_T
;

53 
	sobje_devi_t
 {

54 
BACNET_OBJECT_ID
 
	mObje_Idtifr
;

55 
BACNET_CHARACTER_STRING
 
	mObje_Name
;

56 
BACNET_OBJECT_TYPE
 
	mObje_Ty
;

57 
BACNET_DEVICE_STATUS
 
	mSyem_Stus
;

58 
BACNET_CHARACTER_STRING
 
	mVd_Name
;

59 
ut16_t
 
	mVd_Idtifr
;

60 
BACNET_CHARACTER_STRING
 
	mMod_Name
;

61 
BACNET_CHARACTER_STRING
 
	mFmwe_Revisi
;

62 
BACNET_CHARACTER_STRING
 
	mAliti_Sowe_Vsi
;

63 
BACNET_CHARACTER_STRING
 
	mLoti
;

64 
BACNET_CHARACTER_STRING
 
	mDesti
;

65 
ut8_t
 
	mProc_Vsi
;

66 
ut8_t
 
	mProc_Revisi
;

67 
BACNET_BIT_STRING
 
	mProc_Svis_Su܋d
;

68 
BACNET_BIT_STRING
 
	mProc_Obje_Tys_Su܋d
;

69 
OS_Keyli
 
	mObje_Li
;

70 
ut32_t
 
	mMax_APDU_Lgth_Aced
;

71 
BACNET_SEGMENTATION
 
	mSegmti_Su܋d
;

72 
ut32_t
 
	mAPDU_Timeout
;

73 
ut8_t
 
	mNumb_Of_APDU_Rrs
;

74 
ut32_t
 
	mDaba_Revisi
;

75 } 
	tOBJECT_DEVICE_T
;

	@include/proplist.h

24 #ide
PROPLIST_H


25 
	#PROPLIST_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacdef.h
"

30 
	~"banum.h
"

31 
	~".h
"

35 
	sݔty_li_t
 {

36 cڡ *
	mpLi
;

37 
	mcou
;

40 
	secl_ݔty_li_t
 {

41 
ݔty_li_t
 
	mRequed
;

42 
ݔty_li_t
 
	mOiڮ
;

43 
ݔty_li_t
 
	mPrrry
;

46 #ifde
__lulus


50 
ݔty_li_cou
(

51 cڡ *
pLi
);

52 cڡ * 
ݔty_li_tiڮ
(

53 
BACNET_OBJECT_TYPE
 
obje_ty
);

54 cڡ * 
ݔty_li_qued
(

55 
BACNET_OBJECT_TYPE
 
obje_ty
);

56 
ݔty_li_ecl
(

57 
BACNET_OBJECT_TYPE
 
obje_ty
,

58 
ecl_ݔty_li_t
 *
pPrݔtyLi
);

59 
BACNET_PROPERTY_ID
 
ݔty_li_ecl_ݔty
(

60 
BACNET_OBJECT_TYPE
 
obje_ty
,

61 
BACNET_PROPERTY_ID
 
ecl_ݔty
,

62 
dex
);

63 
ݔty_li_ecl_cou
(

64 
BACNET_OBJECT_TYPE
 
obje_ty
,

65 
BACNET_PROPERTY_ID
 
ecl_ݔty
);

66 
ݔty_li_code
(

67 
BACNET_READ_PROPERTY_DATA
 * 
da
,

68 cڡ *
pLiRequed
,

69 cڡ *
pLiOiڮ
,

70 cڡ *
pLiPrrry
);

72 #ifde
__lulus


	@include/ptransfer.h

24 #ide
PRIVATE_TRANSFER_H


25 
	#PRIVATE_TRANSFER_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

30 
	sBACt_Prive_Tnsr_Da
 {

31 
ut16_t
 
	mvdID
;

32 
ut32_t
 
	mrviNumb
;

33 
ut8_t
 *
	mrviPams
;

34 
	mrviPamsL
;

35 } 
	tBACNET_PRIVATE_TRANSFER_DATA
;

37 #ifde
__lulus


41 
nsr_code_du
(

42 
ut8_t
 * 
du
,

43 
ut8_t
 
voke_id
,

44 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
);

45 
unsr_code_du
(

46 
ut8_t
 * 
du
,

47 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
);

48 
nsr_decode_rvi_que
(

49 
ut8_t
 * 
du
,

50 
du_n
,

51 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
);

53 
nsr_r_code_du
(

54 
ut8_t
 * 
du
,

55 
ut8_t
 
voke_id
,

56 
BACNET_ERROR_CLASS
 
r_ass
,

57 
BACNET_ERROR_CODE
 
r_code
,

58 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
);

59 
nsr_r_decode_rvi_que
(

60 
ut8_t
 * 
du
,

61 
du_n
,

62 
BACNET_ERROR_CLASS
 * 
r_ass
,

63 
BACNET_ERROR_CODE
 * 
r_code
,

64 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
);

66 
nsr_ack_code_du
(

67 
ut8_t
 * 
du
,

68 
ut8_t
 
voke_id
,

69 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
);

73 #ifde
TEST


74 
	~"e.h
"

75 
_Prive_Tnsr_Reque
(

76 
Te
 * 
pTe
);

77 
_Prive_Tnsr_Ack
(

78 
Te
 * 
pTe
);

79 
_Prive_Tnsr_E
(

80 
Te
 * 
pTe
);

83 #ifde
__lulus


	@include/rd.h

24 #ide
REINITIALIZE_DEVICE_H


25 
	#REINITIALIZE_DEVICE_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

30 
	sBACt_Relize_Devi_Da
 {

31 
BACNET_REINITIALIZED_STATE
 
	me
;

32 
BACNET_CHARACTER_STRING
 
	msswd
;

33 
BACNET_ERROR_CLASS
 
	mr_ass
;

34 
BACNET_ERROR_CODE
 
	mr_code
;

35 } 
	tBACNET_REINITIALIZE_DEVICE_DATA
;

37 
	$bo
(

38 *
	tlize_devi_funi
) (

39 
	tBACNET_REINITIALIZE_DEVICE_DATA
 * 
	trd_da
);

42 #ifde
__lulus


47 
	`rd_code_du
(

48 
ut8_t
 * 
du
,

49 
ut8_t
 
voke_id
,

50 
BACNET_REINITIALIZED_STATE
 
e
,

51 
BACNET_CHARACTER_STRING
 * 
sswd
);

54 
	`rd_decode_rvi_que
(

55 
ut8_t
 * 
du
,

56 
du_n
,

57 
BACNET_REINITIALIZED_STATE
 * 
e
,

58 
BACNET_CHARACTER_STRING
 * 
sswd
);

60 #ifde
TEST


61 
	~"e.h
"

62 
	`rd_decode_du
(

63 
ut8_t
 * 
du
,

64 
du_n
,

65 
ut8_t
 * 
voke_id
,

66 
BACNET_REINITIALIZED_STATE
 * 
e
,

67 
BACNET_CHARACTER_STRING
 * 
sswd
);

69 
	`_RelizeDevi
(

70 
Te
 * 
pTe
);

73 #ifde
__lulus


74 
	}
}

	@include/readrange.h

24 #ide
READRANGE_H


25 
	#READRANGE_H


	)

27 
	~"bacr.h
"

28 
	~"dime.h
"

30 #ifde
__lulus


34 
BACt_Rd_Rge_Da
;

35 
	sBACt_Rd_Rge_Da
 {

36 
BACNET_OBJECT_TYPE
 
obje_ty
;

37 
ut32_t
 
obje_
;

38 
BACNET_PROPERTY_ID
 
obje_ݔty
;

39 
ut32_t
 
y_dex
;

40 
ut8_t
 *
iti_da
;

41 
iti_da_n
;

42 
BACNET_BIT_STRING
 
ResuFgs
;

43 
RequeTy
;

44 
Ovhd
;

45 
ut32_t
 
ImCou
;

46 
ut32_t
 
FSequ
;

48 
ut32_t
 
RefIndex
;

49 
ut32_t
 
RefSeqNum
;

50 
BACNET_DATE_TIME
 
RefTime
;

51 } 
Rge
;

52 
t32_t
 
Cou
;

53 
BACNET_ERROR_CLASS
 
r_ass
;

54 
BACNET_ERROR_CODE
 
r_code
;

55 } 
	tBACNET_READ_RANGE_DATA
;

61 
	#RR_BY_POSITION
 1

	)

62 
	#RR_BY_SEQUENCE
 2

	)

63 
	#RR_BY_TIME
 4

	)

64 
	#RR_READ_ALL
 8

	)

65 
	#RR_ARRAY_OF_LISTS
 16

	)

69 
RESULT_FLAG_FIRST_ITEM
 = 0,

70 
RESULT_FLAG_LAST_ITEM
 = 1,

71 
RESULT_FLAG_MORE_ITEMS
 = 2

72 } 
	tBACNET_RESULT_FLAGS
;

98 
	#RR_OVERHEAD
 16

	)

99 
	#RR_1ST_SEQ_OVERHEAD
 5

	)

100 
	#RR_INDEX_OVERHEAD
 3

	)

110 *
_hdr_funi
) (

111 
	tut8_t
 * 
	tdu
,

112 
	tBACNET_READ_RANGE_DATA
 * 
	tpReque
);

117 
	sݔtyfo
 {

118 
RequeTys
;

119 
_hdr_funi
 
Hdr
;

120 } 
	tRR_PROP_INFO
;

129 
bo
(

130 *
	t_fo_funi
) (

131 
	tBACNET_READ_RANGE_DATA
 * 
	tpReque
,

132 
	tRR_PROP_INFO
 * 
	tpInfo
);

134 
_code_du
(

135 
ut8_t
 * 
du
,

136 
ut8_t
 
voke_id
,

137 
BACNET_READ_RANGE_DATA
 * 
da
);

139 
_decode_rvi_que
(

140 
ut8_t
 * 
du
,

141 
du_n
,

142 
BACNET_READ_RANGE_DATA
 * 
da
);

144 
_ack_code_du
(

145 
ut8_t
 * 
du
,

146 
ut8_t
 
voke_id
,

147 
BACNET_READ_RANGE_DATA
 * 
da
);

149 
_ack_decode_rvi_que
(

150 
ut8_t
 * 
du
,

151 
du_n
,

152 
BACNET_READ_RANGE_DATA
 * 
da
);

154 
ut8_t
 
Sd_RdRge_Reque
(

155 
ut32_t
 
devi_id
,

156 
BACNET_READ_RANGE_DATA
 * 
ad_acss_da
);

158 #ifde
__lulus


	@include/reject.h

24 #ide
REJECT_H


25 
	#REJECT_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

30 #ifde
__lulus


34 
BACNET_REJECT_REASON
 
je_cvt_r_code
(

35 
BACNET_ERROR_CODE
 
r_code
);

37 
je_code_du
(

38 
ut8_t
 * 
du
,

39 
ut8_t
 
voke_id
,

40 
ut8_t
 
je_as
);

42 
je_decode_rvi_que
(

43 
ut8_t
 * 
du
,

44 
du_n
,

45 
ut8_t
 * 
voke_id
,

46 
ut8_t
 * 
je_as
);

48 #ifde
TEST


49 
je_decode_du
(

50 
ut8_t
 * 
du
,

51 
du_n
,

52 
ut8_t
 * 
voke_id
,

53 
ut8_t
 * 
je_as
);

55 
Reje
(

56 
Te
 * 
pTe
);

59 #ifde
__lulus


	@include/ringbuf.h

24 #ide
RINGBUF_H


25 
	#RINGBUF_H


	)

30 
	~<dt.h
>

31 
	~<dbo.h
>

33 
	srg_bufr_t
 {

34 vީ
ut8_t
 *
	mbufr
;

35 
	memt_size
;

36 
	memt_cou
;

37 vީ
	mhd
;

38 vީ
	m
;

40 
rg_bufr_t
 
	tRING_BUFFER
;

42 #ifde
__lulus


46 
Rgbuf_Cou
(

47 
RING_BUFFER
 cڡ *
b
);

48 
bo
 
Rgbuf_Fu
(

49 
RING_BUFFER
 cڡ *
b
);

50 
bo
 
Rgbuf_Emy
(

51 
RING_BUFFER
 cڡ *
b
);

52 vީ
ut8_t
 *
Rgbuf_Pk
(

53 
RING_BUFFER
 cڡ *
b
);

54 
bo
 
Rgbuf_P
(

55 
RING_BUFFER
 * 
b
,

56 
ut8_t
 * 
da_emt
);

57 
bo
 
Rgbuf_Put
(

58 
RING_BUFFER
 * 
b
,

59 
ut8_t
 * 
da_emt
);

60 
bo
 
Rgbuf_Put_Frt
(

61 
RING_BUFFER
 * 
b
,

62 
ut8_t
 * 
da_emt
);

63 vީ
ut8_t
 *
Rgbuf_Da_Pk
(

64 
RING_BUFFER
 * 
b
);

65 
bo
 
Rgbuf_Da_Put
(

66 
RING_BUFFER
 * 
b
, vީ
ut8_t
 *
da_emt
);

68 
Rgbuf_In
(

69 
RING_BUFFER
 * 
b
,

70 vީ
ut8_t
 * 
bufr
,

71 
emt_size
,

72 
emt_cou
);

74 #ifde
TEST


75 
	~"e.h
"

76 
RgBufSize16
(

77 
Te
 * 
pTe
);

78 
RgBufSize32
(

79 
Te
 * 
pTe
);

82 #ifde
__lulus


	@include/rp.h

24 #ide
READPROPERTY_H


25 
	#READPROPERTY_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacdef.h
"

30 
	~"banum.h
"

32 
	sBACt_Rd_Prݔty_Da
 {

33 
BACNET_OBJECT_TYPE
 
	mobje_ty
;

34 
ut32_t
 
	mobje_
;

35 
BACNET_PROPERTY_ID
 
	mobje_ݔty
;

36 
ut32_t
 
	my_dex
;

37 
ut8_t
 *
	miti_da
;

38 
	miti_da_n
;

39 
BACNET_ERROR_CLASS
 
	mr_ass
;

40 
BACNET_ERROR_CODE
 
	mr_code
;

41 } 
	tBACNET_READ_PROPERTY_DATA
;

44 
	gBACt_Rd_Acss_Da
;

56 *
	tad_ݔty_funi
) (

57 
	tBACNET_READ_PROPERTY_DATA
 * 
	t_da
);

59 #ifde
__lulus


64 
	`_code_du
(

65 
ut8_t
 * 
du
,

66 
ut8_t
 
voke_id
,

67 
BACNET_READ_PROPERTY_DATA
 * 
da
);

70 
	`_decode_rvi_que
(

71 
ut8_t
 * 
du
,

72 
du_n
,

73 
BACNET_READ_PROPERTY_DATA
 * 
da
);

76 
	`_ack_code_du_
(

77 
ut8_t
 * 
du
,

78 
ut8_t
 
voke_id
,

79 
BACNET_READ_PROPERTY_DATA
 * 
da
);

81 
	`_ack_code_du_obje_ݔty_d
(

82 
ut8_t
 * 
du
);

85 
	`_ack_code_du
(

86 
ut8_t
 * 
du
,

87 
ut8_t
 
voke_id
,

88 
BACNET_READ_PROPERTY_DATA
 * 
da
);

90 
	`_ack_decode_rvi_que
(

91 
ut8_t
 * 
du
,

92 
du_n
,

93 
BACNET_READ_PROPERTY_DATA
 * 
da
);

96 
	`_ack_fuy_decode_rvi_que
(

97 
ut8_t
 * 
du
,

98 
du_n
,

99 
BACt_Rd_Acss_Da
 *
ad_acss_da
);

101 #ifde
TEST


102 
	~"e.h
"

103 
	`_decode_du
(

104 
ut8_t
 * 
du
,

105 
du_n
,

106 
ut8_t
 * 
voke_id
,

107 
BACNET_READ_PROPERTY_DATA
 * 
da
);

109 
	`_ack_decode_du
(

110 
ut8_t
 * 
du
,

111 
du_n
,

112 
ut8_t
 * 
voke_id
,

113 
BACNET_READ_PROPERTY_DATA
 * 
da
);

115 
	`_RdPrݔty
(

116 
Te
 * 
pTe
);

117 
	`_RdPrݔtyAck
(

118 
Te
 * 
pTe
);

121 #ifde
__lulus


122 
	}
}

	@include/rpm.h

24 #ide
RPM_H


25 
	#RPM_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"banum.h
"

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~"li.h
"

38 
	sBACt_RPM_Da
 {

39 
BACNET_OBJECT_TYPE
 
	mobje_ty
;

40 
ut32_t
 
	mobje_
;

41 
BACNET_PROPERTY_ID
 
	mobje_ݔty
;

42 
ut32_t
 
	my_dex
;

43 
BACNET_ERROR_CLASS
 
	mr_ass
;

44 
BACNET_ERROR_CODE
 
	mr_code
;

45 } 
	tBACNET_RPM_DATA
;

47 
	gBACt_Rd_Acss_Da
;

48 
	sBACt_Rd_Acss_Da
 {

49 
BACNET_OBJECT_TYPE
 
	mobje_ty
;

50 
ut32_t
 
	mobje_
;

52 
BACNET_PROPERTY_REFERENCE
 *
	mliOfPrݔts
;

53 
BACt_Rd_Acss_Da
 *
	mxt
;

54 } 
	tBACNET_READ_ACCESS_DATA
;

67 *
	tm_ݔty_lis_funi
) (

68 cڡ **
	tpRequed
,

69 cڡ **
	tpOiڮ
,

70 cڡ **
	tpPrrry
);

73 *
	tm_obje_ݔty_lis_funi
) (

74 
	tBACNET_OBJECT_TYPE
 
	tobje_ty
,

75 
	tecl_ݔty_li_t
 * 
	tpPrݔtyLi
);

77 #ifde
__lulus


88 
	`m_code_du_
(

89 
ut8_t
 * 
du
,

90 
ut8_t
 
voke_id
);

92 
	`m_code_du_obje_beg
(

93 
ut8_t
 * 
du
,

94 
BACNET_OBJECT_TYPE
 
obje_ty
,

95 
ut32_t
 
obje_
);

97 
	`m_code_du_obje_ݔty
(

98 
ut8_t
 * 
du
,

99 
BACNET_PROPERTY_ID
 
obje_ݔty
,

100 
ut32_t
 
y_dex
);

102 
	`m_code_du_obje_d
(

103 
ut8_t
 * 
du
);

105 
	`m_code_du
(

106 
ut8_t
 * 
du
,

107 
size_t
 
max_du
,

108 
ut8_t
 
voke_id
,

109 
BACNET_READ_ACCESS_DATA
 * 
ad_acss_da
);

112 
	`m_decode_obje_id
(

113 
ut8_t
 * 
du
,

114 
du_n
,

115 
BACNET_RPM_DATA
 * 
mda
);

118 
	`m_decode_obje_d
(

119 
ut8_t
 * 
du
,

120 
du_n
);

123 
	`m_decode_obje_ݔty
(

124 
ut8_t
 * 
du
,

125 
du_n
,

126 
BACNET_RPM_DATA
 * 
mda
);

129 
	`m_ack_code_du_
(

130 
ut8_t
 * 
du
,

131 
ut8_t
 
voke_id
);

133 
	`m_ack_code_du_obje_beg
(

134 
ut8_t
 * 
du
,

135 
BACNET_RPM_DATA
 * 
mda
);

137 
	`m_ack_code_du_obje_ݔty
(

138 
ut8_t
 * 
du
,

139 
BACNET_PROPERTY_ID
 
obje_ݔty
,

140 
ut32_t
 
y_dex
);

142 
	`m_ack_code_du_obje_ݔty_vue
(

143 
ut8_t
 * 
du
,

144 
ut8_t
 * 
iti_da
,

145 
iti_da_n
);

147 
	`m_ack_code_du_obje_ݔty_r
(

148 
ut8_t
 * 
du
,

149 
BACNET_ERROR_CLASS
 
r_ass
,

150 
BACNET_ERROR_CODE
 
r_code
);

152 
	`m_ack_code_du_obje_d
(

153 
ut8_t
 * 
du
);

155 
	`m_ack_decode_obje_id
(

156 
ut8_t
 * 
du
,

157 
du_n
,

158 
BACNET_OBJECT_TYPE
 * 
obje_ty
,

159 
ut32_t
 * 
obje_
);

161 
	`m_ack_decode_obje_d
(

162 
ut8_t
 * 
du
,

163 
du_n
);

164 
	`m_ack_decode_obje_ݔty
(

165 
ut8_t
 * 
du
,

166 
du_n
,

167 
BACNET_PROPERTY_ID
 * 
obje_ݔty
,

168 
ut32_t
 * 
y_dex
);

169 #ifde
TEST


170 
	~"e.h
"

171 
	`m_decode_du
(

172 
ut8_t
 * 
du
,

173 
du_n
,

174 
ut8_t
 * 
voke_id
,

175 
ut8_t
 ** 
rvi_que
,

176 *
rvi_que_n
);

178 
	`m_ack_decode_du
(

179 
ut8_t
 * 
du
,

180 
du_n
,

181 
ut8_t
 * 
voke_id
,

182 
ut8_t
 ** 
rvi_que
,

183 *
rvi_que_n
);

185 
	`RdPrݔtyMuɝ
(

186 
Te
 * 
pTe
);

187 
	`RdPrݔtyMuɝAck
(

188 
Te
 * 
pTe
);

191 #ifde
__lulus


192 
	}
}

	@include/sbuf.h

24 #ide
SBUF_H


25 
	#SBUF_H


	)

30 
	~<dt.h
>

31 
	~<dbo.h
>

33 
	sic_bufr_t
 {

34 *
	mda
;

35 
	msize
;

36 
	mcou
;

38 
ic_bufr_t
 
	tSTATIC_BUFFER
;

40 #ifde
__lulus


44 
sbuf_
(

45 
STATIC_BUFFER
 * 
b
,

46 *
da
,

47 
size
);

50 
bo
 
sbuf_emy
(

51 
STATIC_BUFFER
 cڡ *
b
);

53 *
sbuf_da
(

54 
STATIC_BUFFER
 cڡ *
b
);

56 
sbuf_size
(

57 
STATIC_BUFFER
 * 
b
);

59 
sbuf_cou
(

60 
STATIC_BUFFER
 * 
b
);

62 
bo
 
sbuf_put
(

63 
STATIC_BUFFER
 * 
b
,

64 
offt
,

65 *
da
,

66 
da_size
);

68 
bo
 
sbuf_nd
(

69 
STATIC_BUFFER
 * 
b
,

70 *
da
,

71 
da_size
);

73 
bo
 
sbuf_un
(

74 
STATIC_BUFFER
 * 
b
,

75 
cou
);

77 #ifde
__lulus


	@include/timestamp.h

24 #ide
_TIMESTAMP_H_


25 
	#_TIMESTAMP_H_


	)

27 
	~"bacdcode.h
"

30 
	mTIME_STAMP_TIME
 = 0,

31 
	mTIME_STAMP_SEQUENCE
 = 1,

32 
	mTIME_STAMP_DATETIME
 = 2

33 } 
	tBACNET_TIMESTAMP_TAG
;

35 
ut8_t
 
	tTYPE_BACNET_TIMESTAMP_TYPE
;

38 
TYPE_BACNET_TIMESTAMP_TYPE
 
	mg
;

40 
BACNET_TIME
 
	mtime
;

41 
ut16_t
 
	mquNum
;

42 
BACNET_DATE_TIME
 
	mdeTime
;

43 } 
	mvue
;

44 } 
	tBACNET_TIMESTAMP
;

46 #ifde
__lulus


51 
ba_timeamp_cy
(

52 
BACNET_TIMESTAMP
 * 
de
,

53 
BACNET_TIMESTAMP
 * 
c
);

55 
ba_code_timeamp
(

56 
ut8_t
 * 
du
,

57 
BACNET_TIMESTAMP
 * 
vue
);

58 
ba_decode_timeamp
(

59 
ut8_t
 * 
du
,

60 
BACNET_TIMESTAMP
 * 
vue
);

63 
ba_code_cڋxt_timeamp
(

64 
ut8_t
 * 
du
,

65 
ut8_t
 
g_numb
,

66 
BACNET_TIMESTAMP
 * 
vue
);

67 
ba_decode_cڋxt_timeamp
(

68 
ut8_t
 * 
du
,

69 
ut8_t
 
g_numb
,

70 
BACNET_TIMESTAMP
 * 
vue
);

72 #ifde
__lulus


	@include/timesync.h

24 #ide
TIMESYNC_H


25 
	#TIMESYNC_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacdef.h
"

31 
	gBACt_Rec_Li
;

32 
	sBACt_Rec_Li
 {

39 
ut8_t
 
	mg
;

41 
BACNET_OBJECT_ID
 
	mdevi
;

42 
BACNET_ADDRESS
 
	maddss
;

43 } 
	mty
;

45 
BACt_Rec_Li
 *
	mxt
;

46 } 
	tBACNET_RECIPIENT_LIST
;

48 #ifde
__lulus


53 
timesync_utc_code_du
(

54 
ut8_t
 * 
du
,

55 
BACNET_DATE
 * 
my_de
,

56 
BACNET_TIME
 * 
my_time
);

57 
timesync_code_du
(

58 
ut8_t
 * 
du
,

59 
BACNET_DATE
 * 
my_de
,

60 
BACNET_TIME
 * 
my_time
);

61 
timesync_code_du_rvi
(

62 
ut8_t
 * 
du
,

63 
BACNET_UNCONFIRMED_SERVICE
 
rvi
,

64 
BACNET_DATE
 * 
my_de
,

65 
BACNET_TIME
 * 
my_time
);

67 
timesync_decode_rvi_que
(

68 
ut8_t
 * 
du
,

69 
du_n
,

70 
BACNET_DATE
 * 
my_de
,

71 
BACNET_TIME
 * 
my_time
);

72 
timesync_utc_decode_du
(

73 
ut8_t
 * 
du
,

74 
du_n
,

75 
BACNET_DATE
 * 
my_de
,

76 
BACNET_TIME
 * 
my_time
);

77 
timesync_decode_du
(

78 
ut8_t
 * 
du
,

79 
du_n
,

80 
BACNET_DATE
 * 
my_de
,

81 
BACNET_TIME
 * 
my_time
);

83 
timesync_code_timesync_cs
(

84 
ut8_t
 * 
du
,

85 
max_du
,

86 
BACNET_RECIPIENT_LIST
 * 
c
);

87 
timesync_decode_timesync_cs
(

88 
ut8_t
 * 
du
,

89 
du_n
,

90 
BACNET_RECIPIENT_LIST
 * 
c
);

92 #ifde
TEST


93 
	~"e.h
"

94 
TimeSync
(

95 
Te
 * 
pTe
);

98 #ifde
__lulus


	@include/tsm.h

24 #ide
TSM_H


25 
	#TSM_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<ddef.h
>

30 
	~"bacdef.h
"

31 
	~"du.h
"

35 #i(!
MAX_TSM_TRANSACTIONS
)

36 
	#tsm__voke_id
(
x
()x;

	)

39 
	mTSM_STATE_IDLE
,

40 
	mTSM_STATE_AWAIT_CONFIRMATION
,

41 
	mTSM_STATE_AWAIT_RESPONSE
,

42 
	mTSM_STATE_SEGMENTED_REQUEST
,

43 
	mTSM_STATE_SEGMENTED_CONFIRMATION


44 } 
	tBACNET_TSM_STATE
;

49 
	sBACt_TSM_Da
 {

51 
ut8_t
 
	mRryCou
;

69 
ut16_t
 
	mRequeTim
;

71 
ut8_t
 
	mInvokeID
;

73 
BACNET_TSM_STATE
 
	me
;

75 
BACNET_ADDRESS
 
	mde
;

77 
BACNET_NPDU_DATA
 
	mdu_da
;

79 
ut8_t
 
	mdu
[
MAX_PDU
];

80 
	mdu_n
;

81 } 
	tBACNET_TSM_DATA
;

83 #ifde
__lulus


87 
bo
 
tsm_i_avaab
(

89 
ut8_t
 
tsm_i_id_cou
(

91 
tsm_tim_mlicds
(

92 
ut16_t
 
mlicds
);

94 
tsm__voke_id
(

95 
ut8_t
 
vokeID
);

97 
ut8_t
 
tsm_xt__vokeID
(

99 
tsm_vokeID_t
(

100 
ut8_t
 
vokeID
);

102 
tsm_t_cfmed_ungmd_i
(

103 
ut8_t
 
vokeID
,

104 
BACNET_ADDRESS
 * 
de
,

105 
BACNET_NPDU_DATA
 * 
ndpu_da
,

106 
ut8_t
 * 
du
,

107 
ut16_t
 
du_n
);

109 
bo
 
tsm_g_i_pdu
(

110 
ut8_t
 
vokeID
,

111 
BACNET_ADDRESS
 * 
de
,

112 
BACNET_NPDU_DATA
 * 
ndpu_da
,

113 
ut8_t
 * 
du
,

114 
ut16_t
 * 
du_n
);

116 
bo
 
tsm_voke_id_
(

117 
ut8_t
 
vokeID
);

118 
bo
 
tsm_voke_id_ed
(

119 
ut8_t
 
vokeID
);

121 #ifde
__lulus


	@include/txbuf.h

25 #ide
TXBUF_H


26 
	#TXBUF_H


	)

28 
	~<ddef.h
>

29 
	~<dt.h
>

30 
	~"cfig.h
"

31 
	~"dk.h
"

33 
ut8_t
 
Hdr_Tnsm_Bufr
[
MAX_PDU
];

	@include/version.h

24 #ide
VERSION_H


25 
	#VERSION_H


	)

28 #ide
BACNET_VERSION


29 
	#BACNET_VERSION
(
x
,
y
,
z
(((x)<<16)+((y)<<8)+(z))

	)

32 
	#BACNET_VERSION_TEXT
 "0.8.6"

	)

33 
	#BACNET_VERSION_CODE
 
	`BACNET_VERSION
(0,8,6)

	)

34 
	#BACNET_VERSION_MAJOR
 ((
BACNET_VERSION_CODE
>>16)&0xFF)

	)

35 
	#BACNET_VERSION_MINOR
 ((
BACNET_VERSION_CODE
>>8)&0xFF)

	)

36 
	#BACNET_VERSION_MAINTENANCE
 (
BACNET_VERSION_CODE
&0xFF)

	)

37 *
BACt_Vsi
;

	@include/vmac.h

6 #ide
VMAC_H


7 
	#VMAC_H


	)

9 
	~<dt.h
>

10 
	~<dbo.h
>

13 
	#VMAC_MAC_MAX
 18

	)

19 
	svmac_da
 {

20 
ut8_t
 
	mmac
[18];

21 
ut8_t
 
	mmac_n
;

25 #ifde
__lulus


29 
VMAC_Cou
();

30 
vmac_da
 *
VMAC_Fd_By_Key
(
ut32_t
 
devi_id
);

31 
bo
 
VMAC_Fd_By_Da
(
vmac_da
 *
vmac
, 
ut32_t
 *
devi_id
);

32 
bo
 
VMAC_Add
(
ut32_t
 
devi_id
, 
vmac_da
 *
pVMAC
);

33 
bo
 
VMAC_De
(
ut32_t
 
devi_id
);

34 
bo
 
VMAC_Dif
(

35 
vmac_da
 *
vmac1
,

36 
vmac_da
 *
vmac2
);

37 
bo
 
VMAC_Mch
(

38 
vmac_da
 *
vmac1
,

39 
vmac_da
 *
vmac2
);

40 
VMAC_C˪up
();

41 
VMAC_In
();

43 #ifde
TEST


44 
	~"e.h
"

45 
VMAC
(

46 
Te
 * 
pTe
);

49 #ifde
__lulus


	@include/whohas.h

24 #ide
WHOHAS_H


25 
	#WHOHAS_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacr.h
"

31 
	sBACt_Who_Has_Da
 {

32 
t32_t
 
	mlow_lim
;

33 
t32_t
 
	mhigh_lim
;

34 
bo
 
	mis_obje_me
;

36 
BACNET_OBJECT_ID
 
	midtifr
;

37 
BACNET_CHARACTER_STRING
 
	mme
;

38 } 
	mobje
;

39 } 
	tBACNET_WHO_HAS_DATA
;

41 #ifde
__lulus


46 
whohas_code_du
(

47 
ut8_t
 * 
du
,

48 
BACNET_WHO_HAS_DATA
 * 
da
);

50 
whohas_decode_rvi_que
(

51 
ut8_t
 * 
du
,

52 
du_n
,

53 
BACNET_WHO_HAS_DATA
 * 
da
);

55 
whohas_decode_du
(

56 
ut8_t
 * 
du
,

57 
du_n
,

58 
BACNET_WHO_HAS_DATA
 * 
da
);

60 #ifde
TEST


61 
	~"e.h
"

62 
WhoHas
(

63 
Te
 * 
pTe
);

66 #ifde
__lulus


	@include/whois.h

24 #ide
WHOIS_H


25 
	#WHOIS_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

30 #ifde
__lulus


35 
whois_code_du
(

36 
ut8_t
 * 
du
,

37 
t32_t
 
low_lim
,

38 
t32_t
 
high_lim
);

40 
whois_decode_rvi_que
(

41 
ut8_t
 * 
du
,

42 
du_n
,

43 
t32_t
 * 
pLow_lim
,

44 
t32_t
 * 
pHigh_lim
);

46 #ifde
TEST


47 
whois_decode_du
(

48 
ut8_t
 * 
du
,

49 
du_n
,

50 
t32_t
 * 
pLow_lim
,

51 
t32_t
 * 
pHigh_lim
);

53 
WhoIs
(

54 
Te
 * 
pTe
);

57 #ifde
__lulus


	@include/wp.h

24 #ide
WRITEPROPERTY_H


25 
	#WRITEPROPERTY_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

29 
	~"bacdcode.h
"

30 
	~"ba.h
"

36 
	sBACt_Wre_Prݔty_Da
 {

37 
BACNET_OBJECT_TYPE
 
	mobje_ty
;

38 
ut32_t
 
	mobje_
;

39 
BACNET_PROPERTY_ID
 
	mobje_ݔty
;

40 
ut32_t
 
	my_dex
;

41 
ut8_t
 
	miti_da
[
MAX_APDU
];

42 
	miti_da_n
;

43 
ut8_t
 
	miܙy
;

44 
BACNET_ERROR_CLASS
 
	mr_ass
;

45 
BACNET_ERROR_CODE
 
	mr_code
;

46 } 
	tBACNET_WRITE_PROPERTY_DATA
;

58 
	$bo
(

59 *
	twre_ݔty_funi
) (

60 
	tBACNET_WRITE_PROPERTY_DATA
 * 
	twp_da
);

62 #ifde
__lulus


67 
	`wp_code_du
(

68 
ut8_t
 * 
du
,

69 
ut8_t
 
voke_id
,

70 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

73 
	`wp_decode_rvi_que
(

74 
ut8_t
 * 
du
,

75 
du_n
,

76 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

78 #ifde
TEST


79 
	~"e.h
"

80 
	`wp_decode_du
(

81 
ut8_t
 * 
du
,

82 
du_n
,

83 
ut8_t
 * 
voke_id
,

84 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

86 
	`WrePrݔty
(

87 
Te
 * 
pTe
);

88 
	`WrePrݔtyTag
(

89 
Te
 * 
pTe
,

90 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
);

93 #ifde
__lulus


94 
	}
}

	@include/wpm.h

25 #ide
WRITEPROPERTYMULTIPLE_H


26 
	#WRITEPROPERTYMULTIPLE_H


	)

28 
	~<dt.h
>

29 
	~<dbo.h
>

30 
	~"bacdcode.h
"

31 
	~"ba.h
"

32 
	~"wp.h
"

34 #ifde
__lulus


38 
BACt_Wre_Acss_Da
;

39 
	sBACt_Wre_Acss_Da
 {

40 
BACNET_OBJECT_TYPE
 
obje_ty
;

41 
ut32_t
 
obje_
;

43 
BACNET_PROPERTY_VALUE
 *
liOfPrݔts
;

44 
BACt_Wre_Acss_Da
 *
xt
;

45 } 
	tBACNET_WRITE_ACCESS_DATA
;

48 
wpm_decode_obje_id
(

49 
ut8_t
 * 
du
,

50 
ut16_t
 
du_n
,

51 
BACNET_WRITE_PROPERTY_DATA
 * 
da
);

53 
wpm_decode_obje_ݔty
(

54 
ut8_t
 * 
du
,

55 
ut16_t
 
du_n
,

56 
BACNET_WRITE_PROPERTY_DATA
 * 
wpm_da
);

60 
wpm_code_du_
(

61 
ut8_t
 * 
du
,

62 
ut8_t
 
voke_id
);

63 
wpm_code_du_obje_beg
(

64 
ut8_t
 * 
du
,

65 
BACNET_OBJECT_TYPE
 
obje_ty
,

66 
ut32_t
 
obje_
);

67 
wpm_code_du_obje_d
(

68 
ut8_t
 * 
du
);

69 
wpm_code_du_obje_ݔty
(

70 
ut8_t
 * 
du
,

71 
BACNET_WRITE_PROPERTY_DATA
 * 
wpda
);

72 
wpm_code_du
(

73 
ut8_t
 * 
du
,

74 
size_t
 
max_du
,

75 
ut8_t
 
voke_id
,

76 
BACNET_WRITE_ACCESS_DATA
 * 
wre_acss_da
);

79 
wpm_ack_code_du_
(

80 
ut8_t
 * 
du
,

81 
ut8_t
 
voke_id
);

83 
wpm_r_ack_code_du
(

84 
ut8_t
 * 
du
,

85 
ut8_t
 
voke_id
,

86 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

89 #ifde
__lulus


	@lib/main.cpp

1 
	~"ma.h
"

6 
	$SomeFuni
(cڡ 
LPCSTR
 
somext
)

8 
	`MesgeBoxA
(0, 
somext
, "DLL Mesge", 
MB_OK
 | 
MB_ICONINFORMATION
);

9 
	}
}

11 
BOOL
 
WINAPI
 
	$DMa
(
HINSTANCE
 
hDLL
, 
DWORD
 
fdwRs
, 
LPVOID
 
vRerved
)

13 
fdwRs
)

15 
DLL_PROCESS_ATTACH
:

20 
DLL_PROCESS_DETACH
:

24 
DLL_THREAD_ATTACH
:

28 
DLL_THREAD_DETACH
:

32  
TRUE
;

33 
	}
}

	@lib/main.h

1 #ide
__MAIN_H__


2 
	#__MAIN_H__


	)

4 
	~<wdows.h
>

10 #ifde
BUILD_DLL


11 
	#DLL_EXPORT
 
	`__deec
(
dexpt
)

	)

13 
	#DLL_EXPORT
 
	`__deec
(
dimpt
)

	)

16 #ifde
__lulus


20 
DLL_EXPORT
 
SomeFuni
(

21 cڡ 
LPCSTR
 
somext
);

23 #ifde
__lulus


	@ports/arm7/_stdint.h

3 #ide
STDINT_H


4 
	#STDINT_H


	)

6 
	~<ddef.h
>

8 
	tut8_t
;

9 sigd 
	tt8_t
;

10 
	tut16_t
;

11 sigd 
	tt16_t
;

13 
	tut32_t
;

14 sigd 
	tt32_t
;

	@ports/arm7/bip.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~"bacdcode.h
"

38 
	~"b.h
"

39 
	~"h.h
"

40 
	~"t.h
"

42 
	gBIP_Sock
 = -1;

44 
ut16_t
 
	gBIP_Pt
 = 0xBAC0;

46 
_addr
 
	gBIP_Addss
;

48 
_addr
 
	gBIP_Brd_Addss
;

50 
	$b_t_sock
(

51 
sock_fd
)

53 
BIP_Sock
 = 
sock_fd
;

54 
	}
}

56 
	$b_sock
(

59  
BIP_Sock
;

60 
	}
}

62 
bo
 
	$b_vid
(

65  (
BIP_Sock
 != -1);

66 
	}
}

68 
	$b_nup
(

73 
BIP_Sock
 = -1;

76 
	}
}

79 
	$b_t_addr
(

80 
ut32_t
 
t_addss
)

83 
BIP_Addss
.
s_addr
 = 
t_addss
;

84 
	}
}

87 
ut32_t
 
	$b_g_addr
(

90  
BIP_Addss
.
s_addr
;

91 
	}
}

94 
	$b_t_brd_addr
(

95 
ut32_t
 
t_addss
)

98 
BIP_Brd_Addss
.
s_addr
 = 
t_addss
;

99 
	}
}

102 
ut32_t
 
	$b_g_brd_addr
(

105  
BIP_Brd_Addss
.
s_addr
;

106 
	}
}

109 
	$b_t_pt
(

110 
ut16_t
 
pt
)

112 
BIP_Pt
 = 
pt
;

113 
	}
}

116 
ut16_t
 
	$b_g_pt
(

119  
BIP_Pt
;

120 
	}
}

124 
	$b_nd_pdu
(

125 
BACNET_ADDRESS
 * 
de
,

126 
BACNET_NPDU_DATA
 * 
du_da
,

127 
ut8_t
 * 
pdu
,

128 
pdu_n
)

131 
sockaddr_
 
b_de
;

132 
ut8_t
 
mtu
[4];

133 
mtu_n
 = 0;

134 
bys_
 = 0;

135 
UDP_HDR
 
udphdr
;

136 
IP_HDR
 
hdr
;

137 
ut8_t
 
mac
[6];

139 (
du_da
;

145 
mtu
[0] = 
BVLL_TYPE_BACNET_IP
;

146 
b_de
.
s_my
 = 
AF_INET
;

148 i(
de
->
mac_n
 == 6) {

149 
	`memy
(&(
b_de
.
s_addr
.
s_addr
), &
de
->
mac
[0], 4);

150 
	`decode_unsigd16
(&
de
->
mac
[4], &(
b_de
.
s_pt
));

151 
	`memt
(&(
b_de
.
s_zo
), '\0', 8);

152 
mtu
[1] = 
BVLC_ORIGINAL_UNICAST_NPDU
;

155 i(
de
->
mac_n
 == 0) {

156 
b_de
.
s_addr
.
s_addr
 = 
BIP_Brd_Addss
.s_addr;

157 
b_de
.
s_pt
 = 
	`hts
(
BIP_Pt
);

158 
	`memt
(&(
b_de
.
s_zo
), '\0', 8);

159 
mtu
[1] = 
BVLC_ORIGINAL_BROADCAST_NPDU
;

163 
mtu_n
 = 2;

164 
mtu_n
 +=

165 
	`code_unsigd16
(&
mtu
[
mtu_n
],

166 (
ut16_t
(
pdu_n
 + 4 ));

167 
mtu_n
 +
pdu_n
;

170 
	`ARPIsResved
(
b_de
.
s_addr
.
s_addr
, 
mac
);

172 
hdr
.
vhl
 = 0x45;

173 
hdr
.
tos
 = 0;

174 
hdr
.
n
 = 
	`hts
(
mtu_n
 + (
IP_HDR
+ (
UDP_HDR
));

175 ++
id
;

176 
hdr
.
id
 = 
	`hts
(ipid);

177 
hdr
.
offt
[0] = iphdr.ipoffset[1] = 0;

178 
hdr
.
l
 = 
UIP_TTL
;

179 
hdr
.
o
 = 
UIP_PROTO_UDP
;

180 
hdr
.
chksum
 = 0;

181 
hdr
.
caddr
 = 
BIP_Addss
.
s_addr
;

182 
hdr
.
deaddr
 = 
b_de
.
s_addr
.
s_addr
;

185 
hdr
.
chksum
 = ~(
	`_gchksum
((
ut8_t
 *) & iphdr));

188 
udphdr
.
t
 = 
	`hts
(
BIP_Pt
);

189 
udphdr
.
dept
 = 
b_de
.
s_pt
;

190 
udphdr
.
ud
 = 
	`hts
(
mtu_n
 + (
UDP_HDR
));

192 
udphdr
.
udpchksum
 = 0;

194 
	`EthtSdHd
(
mac
, 
UIP_ETHTYPE_IP
);

195 
	`EthtSd
((
ut8_t
 *& 
hdr
, (
IP_HDR
));

196 
	`EthtSd
((
ut8_t
 *& 
udphdr
, (
UDP_HDR
));

197 
	`EthtSd
(
mtu
, 4);

198 
	`EthtSd
(
pdu
, 
pdu_n
);

199 
	`EthtFlush
();

200 
u_
.

.

++;

202 
	}
}

206 
ut16_t
 
	$b_ive
(

207 
BACNET_ADDRESS
 * 
c
,

208 
ut8_t
 * 
pdu
,

209 
ut16_t
 
max_pdu
,

210 
timeout
)

213 
	}
}

215 
	$b_g_my_addss
(

216 
BACNET_ADDRESS
 * 
my_addss
)

218 
i
 = 0;

220 
my_addss
->
mac_n
 = 6;

221 (
	`code_unsigd32
(&
my_addss
->
mac
[0], 
	`htl
(
BIP_Addss
.
s_addr
));

222 (
	`code_unsigd16
(&
my_addss
->
mac
[4], 
	`hts
(
BIP_Pt
));

223 
my_addss
->
t
 = 0;

224 
my_addss
->
n
 = 0;

225 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

227 
my_addss
->
adr
[
i
] = 0;

231 
	}
}

233 
	$b_g_brd_addss
(

234 
BACNET_ADDRESS
 * 
de
)

236 
i
 = 0;

238 i(
de
) {

239 
de
->
mac_n
 = 6;

240 (
	`code_unsigd32
(&
de
->
mac
[0],

241 
	`htl
(
BIP_Brd_Addss
.
s_addr
));

242 (
	`code_unsigd16
(&
de
->
mac
[4], 
	`hts
(
BIP_Pt
));

243 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

244 
de
->
n
 = 0;

245 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

247 
de
->
adr
[
i
] = 0;

252 
	}
}

	@ports/arm7/net.h

26 #ide
NET_H


27 
	#NET_H


	)

29 
	~"dt.h
"

31 
	ssockaddr
 {

32 
ut16_t
 
	m_my
;

33 
	m_da
[14];

37 
	s_addr
 {

38 
ut32_t
 
	ms_addr
;

41 
	ssockaddr_
 {

42 
t16_t
 
	ms_my
;

43 
ut16_t
 
	ms_pt
;

44 
_addr
 
	ms_addr
;

45 
	ms_zo
[8];

49 
	tsockn_t
;

60 #ide
hts


61 
	#hts
(
n
((((
ut16_t
)(& 0xff)<< 8| ((& 0xff00>> 8))

	)

64 
	#ohs
(
n
(((((
ut16_t
)& 0xFF)<< 8| (((ut16_t)& 0xFF00>> 8))

	)

65 
	#htl
(
n
(((((
ut32_t
)(n) & 0xFF)) << 24) | \

66 ((((
ut32_t
)(
n
) & 0xFF00)) << 8) | \

67 ((((
ut32_t
)(
n
) & 0xFF0000)) >> 8) | \

68 ((((
ut32_t
)(
n
& 0xFF000000)>> 24))

	)

70 
	#ohl
(
n
(((((
ut32_t
)(n) & 0xFF)) << 24) | \

71 ((((
ut32_t
)(
n
) & 0xFF00)) << 8) | \

72 ((((
ut32_t
)(
n
) & 0xFF0000)) >> 8) | \

73 ((((
ut32_t
)(
n
& 0xFF000000)>> 24))

	)

76 
	#AF_UNIX
 1

	)

77 
	#AF_INET
 2

	)

78 
	#AF_IMPLINK
 3

	)

79 
	#AF_PUP
 4

	)

80 
	#AF_CHAOS
 5

	)

81 
	#AF_NS
 6

	)

82 
	#AF_IPX
 
AF_NS


	)

83 
	#AF_ISO
 7

	)

84 
	#AF_OSI
 
AF_ISO


	)

85 
	#AF_ECMA
 8

	)

86 
	#AF_DATAKIT
 9

	)

87 
	#AF_CCITT
 10

	)

88 
	#AF_SNA
 11

	)

89 
	#AF_DECt
 12

	)

90 
	#AF_DLI
 13

	)

91 
	#AF_LAT
 14

	)

92 
	#AF_HYLINK
 15

	)

93 
	#AF_APPLETALK
 16

	)

94 
	#AF_NETBIOS
 17

	)

95 
	#AF_VOICEVIEW
 18

	)

96 
	#AF_FIREFOX
 19

	)

97 
	#AF_UNKNOWN1
 20

	)

98 
	#AF_BAN
 21

	)

99 
	#AF_ATM
 22

	)

100 
	#AF_INET6
 23

	)

101 
	#AF_CLUSTER
 24

	)

102 
	#AF_12844
 25

	)

103 
	#AF_IRDA
 26

	)

104 
	#AF_NETDES
 28

	)

106 
	#AF_TCNPROCESS
 29

	)

107 
	#AF_TCNMESSAGE
 30

	)

108 
	#AF_ICLFXBM
 31

	)

110 
	#AF_MAX
 32

	)

112 
t_addss
(

113 
ut32_t
 * 
t_addss
,

114 
ut8_t
 
o1
,

115 
ut8_t
 
o2
,

116 
ut8_t
 
o3
,

117 
ut8_t
 
o4
);

	@ports/arm7/stdbool.h

1 #ide
STDBOOL_H


2 
	#STDBOOL_H


	)

6 #ide
__lulus


9 #ide
bo


10 
	#bo
 
_Bo


	)

12 #ide
ue


13 
	#ue
 1

	)

15 #ide
l


16 
	#l
 0

	)

18 
	#__bo_ue_l_e_defed
 1

	)

21 #ide
FALSE


22 
	#FALSE
 0

	)

25 #ide
TRUE


26 
	#TRUE
 1

	)

	@ports/at91sam7s/ai.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

35 
	~"ai.h
"

36 
	~"hdrs.h
"

38 #ide
MAX_ANALOG_INPUTS


39 
	#MAX_ANALOG_INPUTS
 2

	)

41 #i(
MAX_ANALOG_INPUTS
 > 9)

42 #r 
Modify
 
the
 
Alog_Iut_Name
 
to
 
hd
 
muɝ
 
digs


45 
	gP_Vue
[
MAX_ANALOG_INPUTS
];

48 cڡ 
	gAlog_Iut_Prݔts_Requed
[] = {

49 
PROP_OBJECT_IDENTIFIER
,

50 
PROP_OBJECT_NAME
,

51 
PROP_OBJECT_TYPE
,

52 
PROP_PRESENT_VALUE
,

53 
PROP_STATUS_FLAGS
,

54 
PROP_EVENT_STATE
,

55 
PROP_OUT_OF_SERVICE
,

56 
PROP_UNITS
,

60 cڡ 
	gAlog_Iut_Prݔts_Oiڮ
[] = {

61 
PROP_DESCRIPTION
,

65 cڡ 
	gAlog_Iut_Prݔts_Prrry
[] = {

69 
	$Alog_Iut_Prݔty_Lis
(

70 cڡ **
pRequed
,

71 cڡ **
pOiڮ
,

72 cڡ **
pPrrry
)

74 i(
pRequed
)

75 *
pRequed
 = 
Alog_Iut_Prݔts_Requed
;

76 i(
pOiڮ
)

77 *
pOiڮ
 = 
Alog_Iut_Prݔts_Oiڮ
;

78 i(
pPrrry
)

79 *
pPrrry
 = 
Alog_Iut_Prݔts_Prrry
;

82 
	}
}

87 
bo
 
	$Alog_Iut_Vid_In
(

88 
ut32_t
 
obje_
)

90 i(
obje_
 < 
MAX_ANALOG_INPUTS
)

91  
ue
;

93  
l
;

94 
	}
}

97 
	$Alog_Iut_Cou
(

100  
MAX_ANALOG_INPUTS
;

101 
	}
}

104 
ut32_t
 
	$Alog_Iut_Index_To_In
(

105 
dex
)

107  
dex
;

108 
	}
}

110 
bo
 
	$Alog_Iut_Obje_Name
(

111 
ut32_t
 
obje_
,

112 
BACNET_CHARACTER_STRING
 * 
obje_me
)

114 
xt_rg
[16] = "AI-0";

115 
bo
 
us
 = 
l
;

117 i(
obje_
 < 
MAX_ANALOG_INPUTS
) {

118 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

119 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

122  
us
;

123 
	}
}

125 
	$Alog_Iut_P_Vue
(

126 
ut32_t
 
obje_
)

128 
vue
 = 0.0;

130 i(
obje_
 < 
MAX_ANALOG_INPUTS
)

131 
vue
 = 
P_Vue
[
obje_
];

133  
vue
;

134 
	}
}

136 
	$Alog_Iut_P_Vue_S
(

137 
ut32_t
 
obje_
,

138 
vue
)

140 i(
obje_
 < 
MAX_ANALOG_INPUTS
) {

141 
P_Vue
[
obje_
] = 
vue
;

143 
	}
}

147 
	$Alog_Iut_Rd_Prݔty
(

148 
BACNET_READ_PROPERTY_DATA
 * 
da
)

150 
du_n
 = 0;

151 
BACNET_BIT_STRING
 
b_rg
;

152 
BACNET_CHARACTER_STRING
 
ch_rg
;

153 
ut8_t
 *
du
 = 
NULL
;

155 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

156 (
da
->
iti_da_n
 == 0)) {

159 
du
 = 
da
->
iti_da
;

160 
da
->
obje_ݔty
) {

161 
PROP_OBJECT_IDENTIFIER
:

162 
du_n
 =

163 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_INPUT
,

164 
da
->
obje_
);

168 
PROP_OBJECT_NAME
:

169 
PROP_DESCRIPTION
:

170 
	`Alog_Iut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

171 
du_n
 =

172 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

174 
PROP_OBJECT_TYPE
:

175 
du_n
 =

176 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_INPUT
);

178 
PROP_PRESENT_VALUE
:

179 
du_n
 =

180 
	`code_iti_
(&
du
[0],

181 
	`Alog_Iut_P_Vue
(
da
->
obje_
));

183 
PROP_STATUS_FLAGS
:

184 
	`brg_
(&
b_rg
);

185 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

186 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

187 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

188 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

189 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

191 
PROP_EVENT_STATE
:

192 
du_n
 =

193 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

195 
PROP_OUT_OF_SERVICE
:

196 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

198 
PROP_UNITS
:

199 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

202 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

203 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

204 
du_n
 = 
BACNET_STATUS_ERROR
;

208 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

209 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

210 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

211 
du_n
 = 
BACNET_STATUS_ERROR
;

214  
du_n
;

215 
	}
}

217 
	$Alog_Iut_In
(

221 
	}
}

	@ports/at91sam7s/at91sam7s256.h

42 #ide
AT91SAM7S256_H


43 
	#AT91SAM7S256_H


	)

45 vީ
	tAT91_REG
;

50 
	s_AT91S_SYS
 {

51 
AT91_REG
 
	mAIC_SMR
[32];

52 
AT91_REG
 
	mAIC_SVR
[32];

53 
AT91_REG
 
	mAIC_IVR
;

54 
AT91_REG
 
	mAIC_FVR
;

55 
AT91_REG
 
	mAIC_ISR
;

56 
AT91_REG
 
	mAIC_IPR
;

57 
AT91_REG
 
	mAIC_IMR
;

58 
AT91_REG
 
	mAIC_CISR
;

59 
AT91_REG
 
	mRerved0
[2];

60 
AT91_REG
 
	mAIC_IECR
;

61 
AT91_REG
 
	mAIC_IDCR
;

62 
AT91_REG
 
	mAIC_ICCR
;

63 
AT91_REG
 
	mAIC_ISCR
;

64 
AT91_REG
 
	mAIC_EOICR
;

65 
AT91_REG
 
	mAIC_SPU
;

66 
AT91_REG
 
	mAIC_DCR
;

67 
AT91_REG
 
	mRerved1
[1];

68 
AT91_REG
 
	mAIC_FFER
;

69 
AT91_REG
 
	mAIC_FFDR
;

70 
AT91_REG
 
	mAIC_FFSR
;

71 
AT91_REG
 
	mRerved2
[45];

72 
AT91_REG
 
	mDBGU_CR
;

73 
AT91_REG
 
	mDBGU_MR
;

74 
AT91_REG
 
	mDBGU_IER
;

75 
AT91_REG
 
	mDBGU_IDR
;

76 
AT91_REG
 
	mDBGU_IMR
;

77 
AT91_REG
 
	mDBGU_CSR
;

78 
AT91_REG
 
	mDBGU_RHR
;

79 
AT91_REG
 
	mDBGU_THR
;

80 
AT91_REG
 
	mDBGU_BRGR
;

81 
AT91_REG
 
	mRerved3
[7];

82 
AT91_REG
 
	mDBGU_CIDR
;

83 
AT91_REG
 
	mDBGU_EXID
;

84 
AT91_REG
 
	mDBGU_FNTR
;

85 
AT91_REG
 
	mRerved4
[45];

86 
AT91_REG
 
	mDBGU_RPR
;

87 
AT91_REG
 
	mDBGU_RCR
;

88 
AT91_REG
 
	mDBGU_TPR
;

89 
AT91_REG
 
	mDBGU_TCR
;

90 
AT91_REG
 
	mDBGU_RNPR
;

91 
AT91_REG
 
	mDBGU_RNCR
;

92 
AT91_REG
 
	mDBGU_TNPR
;

93 
AT91_REG
 
	mDBGU_TNCR
;

94 
AT91_REG
 
	mDBGU_PTCR
;

95 
AT91_REG
 
	mDBGU_PTSR
;

96 
AT91_REG
 
	mRerved5
[54];

97 
AT91_REG
 
	mPIOA_PER
;

98 
AT91_REG
 
	mPIOA_PDR
;

99 
AT91_REG
 
	mPIOA_PSR
;

100 
AT91_REG
 
	mRerved6
[1];

101 
AT91_REG
 
	mPIOA_OER
;

102 
AT91_REG
 
	mPIOA_ODR
;

103 
AT91_REG
 
	mPIOA_OSR
;

104 
AT91_REG
 
	mRerved7
[1];

105 
AT91_REG
 
	mPIOA_IFER
;

106 
AT91_REG
 
	mPIOA_IFDR
;

107 
AT91_REG
 
	mPIOA_IFSR
;

108 
AT91_REG
 
	mRerved8
[1];

109 
AT91_REG
 
	mPIOA_SODR
;

110 
AT91_REG
 
	mPIOA_CODR
;

111 
AT91_REG
 
	mPIOA_ODSR
;

112 
AT91_REG
 
	mPIOA_PDSR
;

113 
AT91_REG
 
	mPIOA_IER
;

114 
AT91_REG
 
	mPIOA_IDR
;

115 
AT91_REG
 
	mPIOA_IMR
;

116 
AT91_REG
 
	mPIOA_ISR
;

117 
AT91_REG
 
	mPIOA_MDER
;

118 
AT91_REG
 
	mPIOA_MDDR
;

119 
AT91_REG
 
	mPIOA_MDSR
;

120 
AT91_REG
 
	mRerved9
[1];

121 
AT91_REG
 
	mPIOA_PPUDR
;

122 
AT91_REG
 
	mPIOA_PPUER
;

123 
AT91_REG
 
	mPIOA_PPUSR
;

124 
AT91_REG
 
	mRerved10
[1];

125 
AT91_REG
 
	mPIOA_ASR
;

126 
AT91_REG
 
	mPIOA_BSR
;

127 
AT91_REG
 
	mPIOA_ABSR
;

128 
AT91_REG
 
	mRerved11
[9];

129 
AT91_REG
 
	mPIOA_OWER
;

130 
AT91_REG
 
	mPIOA_OWDR
;

131 
AT91_REG
 
	mPIOA_OWSR
;

132 
AT91_REG
 
	mRerved12
[469];

133 
AT91_REG
 
	mPMC_SCER
;

134 
AT91_REG
 
	mPMC_SCDR
;

135 
AT91_REG
 
	mPMC_SCSR
;

136 
AT91_REG
 
	mRerved13
[1];

137 
AT91_REG
 
	mPMC_PCER
;

138 
AT91_REG
 
	mPMC_PCDR
;

139 
AT91_REG
 
	mPMC_PCSR
;

140 
AT91_REG
 
	mRerved14
[1];

141 
AT91_REG
 
	mPMC_MOR
;

142 
AT91_REG
 
	mPMC_MCFR
;

143 
AT91_REG
 
	mRerved15
[1];

144 
AT91_REG
 
	mPMC_PLLR
;

145 
AT91_REG
 
	mPMC_MCKR
;

146 
AT91_REG
 
	mRerved16
[3];

147 
AT91_REG
 
	mPMC_PCKR
[3];

148 
AT91_REG
 
	mRerved17
[5];

149 
AT91_REG
 
	mPMC_IER
;

150 
AT91_REG
 
	mPMC_IDR
;

151 
AT91_REG
 
	mPMC_SR
;

152 
AT91_REG
 
	mPMC_IMR
;

153 
AT91_REG
 
	mRerved18
[36];

154 
AT91_REG
 
	mRSTC_RCR
;

155 
AT91_REG
 
	mRSTC_RSR
;

156 
AT91_REG
 
	mRSTC_RMR
;

157 
AT91_REG
 
	mRerved19
[5];

158 
AT91_REG
 
	mRTTC_RTMR
;

159 
AT91_REG
 
	mRTTC_RTAR
;

160 
AT91_REG
 
	mRTTC_RTVR
;

161 
AT91_REG
 
	mRTTC_RTSR
;

162 
AT91_REG
 
	mPITC_PIMR
;

163 
AT91_REG
 
	mPITC_PISR
;

164 
AT91_REG
 
	mPITC_PIVR
;

165 
AT91_REG
 
	mPITC_PIIR
;

166 
AT91_REG
 
	mWDTC_WDCR
;

167 
AT91_REG
 
	mWDTC_WDMR
;

168 
AT91_REG
 
	mWDTC_WDSR
;

169 
AT91_REG
 
	mRerved20
[5];

170 
AT91_REG
 
	mVREG_MR
;

171 } 
	tAT91S_SYS
,

172 *
	tAT91PS_SYS
;

178 
	s_AT91S_AIC
 {

179 
AT91_REG
 
	mAIC_SMR
[32];

180 
AT91_REG
 
	mAIC_SVR
[32];

181 
AT91_REG
 
	mAIC_IVR
;

182 
AT91_REG
 
	mAIC_FVR
;

183 
AT91_REG
 
	mAIC_ISR
;

184 
AT91_REG
 
	mAIC_IPR
;

185 
AT91_REG
 
	mAIC_IMR
;

186 
AT91_REG
 
	mAIC_CISR
;

187 
AT91_REG
 
	mRerved0
[2];

188 
AT91_REG
 
	mAIC_IECR
;

189 
AT91_REG
 
	mAIC_IDCR
;

190 
AT91_REG
 
	mAIC_ICCR
;

191 
AT91_REG
 
	mAIC_ISCR
;

192 
AT91_REG
 
	mAIC_EOICR
;

193 
AT91_REG
 
	mAIC_SPU
;

194 
AT91_REG
 
	mAIC_DCR
;

195 
AT91_REG
 
	mRerved1
[1];

196 
AT91_REG
 
	mAIC_FFER
;

197 
AT91_REG
 
	mAIC_FFDR
;

198 
AT91_REG
 
	mAIC_FFSR
;

199 } 
	tAT91S_AIC
,

200 *
	tAT91PS_AIC
;

203 
	#AT91C_AIC_PRIOR
 ((0x7 << 0

	)

204 
	#AT91C_AIC_PRIOR_LOWEST
 ((0x0

	)

205 
	#AT91C_AIC_PRIOR_HIGHEST
 ((0x7

	)

206 
	#AT91C_AIC_SRCTYPE
 ((0x3 << 5

	)

207 
	#AT91C_AIC_SRCTYPE_INT_LEVEL_SENSITIVE
 ((0x0 << 5

	)

208 
	#AT91C_AIC_SRCTYPE_INT_EDGE_TRIGGERED
 ((0x1 << 5

	)

209 
	#AT91C_AIC_SRCTYPE_EXT_HIGH_LEVEL
 ((0x2 << 5

	)

210 
	#AT91C_AIC_SRCTYPE_EXT_POSITIVE_EDGE
 ((0x3 << 5

	)

212 
	#AT91C_AIC_NFIQ
 ((0x1 << 0

	)

213 
	#AT91C_AIC_NIRQ
 ((0x1 << 1

	)

215 
	#AT91C_AIC_DCR_PROT
 ((0x1 << 0

	)

216 
	#AT91C_AIC_DCR_GMSK
 ((0x1 << 1

	)

221 
	s_AT91S_PDC
 {

222 
AT91_REG
 
	mPDC_RPR
;

223 
AT91_REG
 
	mPDC_RCR
;

224 
AT91_REG
 
	mPDC_TPR
;

225 
AT91_REG
 
	mPDC_TCR
;

226 
AT91_REG
 
	mPDC_RNPR
;

227 
AT91_REG
 
	mPDC_RNCR
;

228 
AT91_REG
 
	mPDC_TNPR
;

229 
AT91_REG
 
	mPDC_TNCR
;

230 
AT91_REG
 
	mPDC_PTCR
;

231 
AT91_REG
 
	mPDC_PTSR
;

232 } 
	tAT91S_PDC
,

233 *
	tAT91PS_PDC
;

236 
	#AT91C_PDC_RXTEN
 ((0x1 << 0

	)

237 
	#AT91C_PDC_RXTDIS
 ((0x1 << 1

	)

238 
	#AT91C_PDC_TXTEN
 ((0x1 << 8

	)

239 
	#AT91C_PDC_TXTDIS
 ((0x1 << 9

	)

245 
	s_AT91S_DBGU
 {

246 
AT91_REG
 
	mDBGU_CR
;

247 
AT91_REG
 
	mDBGU_MR
;

248 
AT91_REG
 
	mDBGU_IER
;

249 
AT91_REG
 
	mDBGU_IDR
;

250 
AT91_REG
 
	mDBGU_IMR
;

251 
AT91_REG
 
	mDBGU_CSR
;

252 
AT91_REG
 
	mDBGU_RHR
;

253 
AT91_REG
 
	mDBGU_THR
;

254 
AT91_REG
 
	mDBGU_BRGR
;

255 
AT91_REG
 
	mRerved0
[7];

256 
AT91_REG
 
	mDBGU_CIDR
;

257 
AT91_REG
 
	mDBGU_EXID
;

258 
AT91_REG
 
	mDBGU_FNTR
;

259 
AT91_REG
 
	mRerved1
[45];

260 
AT91_REG
 
	mDBGU_RPR
;

261 
AT91_REG
 
	mDBGU_RCR
;

262 
AT91_REG
 
	mDBGU_TPR
;

263 
AT91_REG
 
	mDBGU_TCR
;

264 
AT91_REG
 
	mDBGU_RNPR
;

265 
AT91_REG
 
	mDBGU_RNCR
;

266 
AT91_REG
 
	mDBGU_TNPR
;

267 
AT91_REG
 
	mDBGU_TNCR
;

268 
AT91_REG
 
	mDBGU_PTCR
;

269 
AT91_REG
 
	mDBGU_PTSR
;

270 } 
	tAT91S_DBGU
,

271 *
	tAT91PS_DBGU
;

274 
	#AT91C_US_RSTRX
 ((0x1 << 2

	)

275 
	#AT91C_US_RSTTX
 ((0x1 << 3

	)

276 
	#AT91C_US_RXEN
 ((0x1 << 4

	)

277 
	#AT91C_US_RXDIS
 ((0x1 << 5

	)

278 
	#AT91C_US_TXEN
 ((0x1 << 6

	)

279 
	#AT91C_US_TXDIS
 ((0x1 << 7

	)

280 
	#AT91C_US_RSTSTA
 ((0x1 << 8

	)

282 
	#AT91C_US_PAR
 ((0x7 << 9

	)

283 
	#AT91C_US_PAR_EVEN
 ((0x0 << 9

	)

284 
	#AT91C_US_PAR_ODD
 ((0x1 << 9

	)

285 
	#AT91C_US_PAR_SPACE
 ((0x2 << 9

	)

286 
	#AT91C_US_PAR_MARK
 ((0x3 << 9

	)

287 
	#AT91C_US_PAR_NONE
 ((0x4 << 9

	)

288 
	#AT91C_US_PAR_MULTI_DROP
 ((0x6 << 9

	)

289 
	#AT91C_US_CHMODE
 ((0x3 << 14

	)

290 
	#AT91C_US_CHMODE_NORMAL
 ((0x0 << 14

	)

291 
	#AT91C_US_CHMODE_AUTO
 ((0x1 << 14

	)

292 
	#AT91C_US_CHMODE_LOCAL
 ((0x2 << 14

	)

293 
	#AT91C_US_CHMODE_REMOTE
 ((0x3 << 14

	)

295 
	#AT91C_US_RXRDY
 ((0x1 << 0

	)

296 
	#AT91C_US_TXRDY
 ((0x1 << 1

	)

297 
	#AT91C_US_ENDRX
 ((0x1 << 3

	)

298 
	#AT91C_US_ENDTX
 ((0x1 << 4

	)

299 
	#AT91C_US_OVRE
 ((0x1 << 5

	)

300 
	#AT91C_US_FRAME
 ((0x1 << 6

	)

301 
	#AT91C_US_PARE
 ((0x1 << 7

	)

302 
	#AT91C_US_TXEMPTY
 ((0x1 << 9

	)

303 
	#AT91C_US_TXBUFE
 ((0x1 << 11

	)

304 
	#AT91C_US_RXBUFF
 ((0x1 << 12

	)

305 
	#AT91C_US_COMM_TX
 ((0x1 << 30

	)

306 
	#AT91C_US_COMM_RX
 ((0x1 << 31

	)

311 
	#AT91C_US_FORCE_NTRST
 ((0x1 << 0

	)

316 
	s_AT91S_PIO
 {

317 
AT91_REG
 
	mPIO_PER
;

318 
AT91_REG
 
	mPIO_PDR
;

319 
AT91_REG
 
	mPIO_PSR
;

320 
AT91_REG
 
	mRerved0
[1];

321 
AT91_REG
 
	mPIO_OER
;

322 
AT91_REG
 
	mPIO_ODR
;

323 
AT91_REG
 
	mPIO_OSR
;

324 
AT91_REG
 
	mRerved1
[1];

325 
AT91_REG
 
	mPIO_IFER
;

326 
AT91_REG
 
	mPIO_IFDR
;

327 
AT91_REG
 
	mPIO_IFSR
;

328 
AT91_REG
 
	mRerved2
[1];

329 
AT91_REG
 
	mPIO_SODR
;

330 
AT91_REG
 
	mPIO_CODR
;

331 
AT91_REG
 
	mPIO_ODSR
;

332 
AT91_REG
 
	mPIO_PDSR
;

333 
AT91_REG
 
	mPIO_IER
;

334 
AT91_REG
 
	mPIO_IDR
;

335 
AT91_REG
 
	mPIO_IMR
;

336 
AT91_REG
 
	mPIO_ISR
;

337 
AT91_REG
 
	mPIO_MDER
;

338 
AT91_REG
 
	mPIO_MDDR
;

339 
AT91_REG
 
	mPIO_MDSR
;

340 
AT91_REG
 
	mRerved3
[1];

341 
AT91_REG
 
	mPIO_PPUDR
;

342 
AT91_REG
 
	mPIO_PPUER
;

343 
AT91_REG
 
	mPIO_PPUSR
;

344 
AT91_REG
 
	mRerved4
[1];

345 
AT91_REG
 
	mPIO_ASR
;

346 
AT91_REG
 
	mPIO_BSR
;

347 
AT91_REG
 
	mPIO_ABSR
;

348 
AT91_REG
 
	mRerved5
[9];

349 
AT91_REG
 
	mPIO_OWER
;

350 
AT91_REG
 
	mPIO_OWDR
;

351 
AT91_REG
 
	mPIO_OWSR
;

352 } 
	tAT91S_PIO
,

353 *
	tAT91PS_PIO
;

359 
	s_AT91S_CKGR
 {

360 
AT91_REG
 
	mCKGR_MOR
;

361 
AT91_REG
 
	mCKGR_MCFR
;

362 
AT91_REG
 
	mRerved0
[1];

363 
AT91_REG
 
	mCKGR_PLLR
;

364 } 
	tAT91S_CKGR
,

365 *
	tAT91PS_CKGR
;

368 
	#AT91C_CKGR_MOSCEN
 ((0x1 << 0

	)

369 
	#AT91C_CKGR_OSCBYPASS
 ((0x1 << 1

	)

370 
	#AT91C_CKGR_OSCOUNT
 ((0xFF << 8

	)

372 
	#AT91C_CKGR_MAINF
 ((0xFFFF << 0

	)

373 
	#AT91C_CKGR_MAINRDY
 ((0x1 << 16

	)

375 
	#AT91C_CKGR_DIV
 ((0xFF << 0

	)

376 
	#AT91C_CKGR_DIV_0
 ((0x0

	)

377 
	#AT91C_CKGR_DIV_BYPASS
 ((0x1

	)

378 
	#AT91C_CKGR_PLLCOUNT
 ((0x3F << 8

	)

379 
	#AT91C_CKGR_OUT
 ((0x3 << 14

	)

380 
	#AT91C_CKGR_OUT_0
 ((0x0 << 14

	)

381 
	#AT91C_CKGR_OUT_1
 ((0x1 << 14

	)

382 
	#AT91C_CKGR_OUT_2
 ((0x2 << 14

	)

383 
	#AT91C_CKGR_OUT_3
 ((0x3 << 14

	)

384 
	#AT91C_CKGR_MUL
 ((0x7FF << 16

	)

385 
	#AT91C_CKGR_USBDIV
 ((0x3 << 28

	)

386 
	#AT91C_CKGR_USBDIV_0
 ((0x0 << 28

	)

387 
	#AT91C_CKGR_USBDIV_1
 ((0x1 << 28

	)

388 
	#AT91C_CKGR_USBDIV_2
 ((0x2 << 28

	)

393 
	s_AT91S_PMC
 {

394 
AT91_REG
 
	mPMC_SCER
;

395 
AT91_REG
 
	mPMC_SCDR
;

396 
AT91_REG
 
	mPMC_SCSR
;

397 
AT91_REG
 
	mRerved0
[1];

398 
AT91_REG
 
	mPMC_PCER
;

399 
AT91_REG
 
	mPMC_PCDR
;

400 
AT91_REG
 
	mPMC_PCSR
;

401 
AT91_REG
 
	mRerved1
[1];

402 
AT91_REG
 
	mPMC_MOR
;

403 
AT91_REG
 
	mPMC_MCFR
;

404 
AT91_REG
 
	mRerved2
[1];

405 
AT91_REG
 
	mPMC_PLLR
;

406 
AT91_REG
 
	mPMC_MCKR
;

407 
AT91_REG
 
	mRerved3
[3];

408 
AT91_REG
 
	mPMC_PCKR
[3];

409 
AT91_REG
 
	mRerved4
[5];

410 
AT91_REG
 
	mPMC_IER
;

411 
AT91_REG
 
	mPMC_IDR
;

412 
AT91_REG
 
	mPMC_SR
;

413 
AT91_REG
 
	mPMC_IMR
;

414 } 
	tAT91S_PMC
,

415 *
	tAT91PS_PMC
;

418 
	#AT91C_PMC_PCK
 ((0x1 << 0

	)

419 
	#AT91C_PMC_UDP
 ((0x1 << 7

	)

420 
	#AT91C_PMC_PCK0
 ((0x1 << 8

	)

421 
	#AT91C_PMC_PCK1
 ((0x1 << 9

	)

422 
	#AT91C_PMC_PCK2
 ((0x1 << 10

	)

429 
	#AT91C_PMC_CSS
 ((0x3 << 0

	)

430 
	#AT91C_PMC_CSS_SLOW_CLK
 ((0x0

	)

431 
	#AT91C_PMC_CSS_MAIN_CLK
 ((0x1

	)

432 
	#AT91C_PMC_CSS_PLL_CLK
 ((0x3

	)

433 
	#AT91C_PMC_PRES
 ((0x7 << 2

	)

434 
	#AT91C_PMC_PRES_CLK
 ((0x0 << 2

	)

435 
	#AT91C_PMC_PRES_CLK_2
 ((0x1 << 2

	)

436 
	#AT91C_PMC_PRES_CLK_4
 ((0x2 << 2

	)

437 
	#AT91C_PMC_PRES_CLK_8
 ((0x3 << 2

	)

438 
	#AT91C_PMC_PRES_CLK_16
 ((0x4 << 2

	)

439 
	#AT91C_PMC_PRES_CLK_32
 ((0x5 << 2

	)

440 
	#AT91C_PMC_PRES_CLK_64
 ((0x6 << 2

	)

443 
	#AT91C_PMC_MOSCS
 ((0x1 << 0

	)

444 
	#AT91C_PMC_LOCK
 ((0x1 << 2

	)

445 
	#AT91C_PMC_MCKRDY
 ((0x1 << 3

	)

446 
	#AT91C_PMC_PCK0RDY
 ((0x1 << 8

	)

447 
	#AT91C_PMC_PCK1RDY
 ((0x1 << 9

	)

448 
	#AT91C_PMC_PCK2RDY
 ((0x1 << 10

	)

456 
	s_AT91S_RSTC
 {

457 
AT91_REG
 
	mRSTC_RCR
;

458 
AT91_REG
 
	mRSTC_RSR
;

459 
AT91_REG
 
	mRSTC_RMR
;

460 } 
	tAT91S_RSTC
,

461 *
	tAT91PS_RSTC
;

464 
	#AT91C_RSTC_PROCRST
 ((0x1 << 0

	)

465 
	#AT91C_RSTC_PERRST
 ((0x1 << 2

	)

466 
	#AT91C_RSTC_EXTRST
 ((0x1 << 3

	)

467 
	#AT91C_RSTC_KEY
 ((0xFF << 24

	)

469 
	#AT91C_RSTC_URSTS
 ((0x1 << 0

	)

470 
	#AT91C_RSTC_BODSTS
 ((0x1 << 1

	)

471 
	#AT91C_RSTC_RSTTYP
 ((0x7 << 8

	)

472 
	#AT91C_RSTC_RSTTYP_POWERUP
 ((0x0 << 8

	)

473 
	#AT91C_RSTC_RSTTYP_WAKEUP
 ((0x1 << 8

	)

474 
	#AT91C_RSTC_RSTTYP_WATCHDOG
 ((0x2 << 8

	)

475 
	#AT91C_RSTC_RSTTYP_SOFTWARE
 ((0x3 << 8

	)

476 
	#AT91C_RSTC_RSTTYP_USER
 ((0x4 << 8

	)

477 
	#AT91C_RSTC_RSTTYP_BROWNOUT
 ((0x5 << 8

	)

478 
	#AT91C_RSTC_NRSTL
 ((0x1 << 16

	)

479 
	#AT91C_RSTC_SRCMP
 ((0x1 << 17

	)

481 
	#AT91C_RSTC_URSTEN
 ((0x1 << 0

	)

482 
	#AT91C_RSTC_URSTIEN
 ((0x1 << 4

	)

483 
	#AT91C_RSTC_ERSTL
 ((0xF << 8

	)

484 
	#AT91C_RSTC_BODIEN
 ((0x1 << 16

	)

489 
	s_AT91S_RTTC
 {

490 
AT91_REG
 
	mRTTC_RTMR
;

491 
AT91_REG
 
	mRTTC_RTAR
;

492 
AT91_REG
 
	mRTTC_RTVR
;

493 
AT91_REG
 
	mRTTC_RTSR
;

494 } 
	tAT91S_RTTC
,

495 *
	tAT91PS_RTTC
;

498 
	#AT91C_RTTC_RTPRES
 ((0xFFFF << 0

	)

499 
	#AT91C_RTTC_ALMIEN
 ((0x1 << 16

	)

500 
	#AT91C_RTTC_RTTINCIEN
 ((0x1 << 17

	)

501 
	#AT91C_RTTC_RTTRST
 ((0x1 << 18

	)

503 
	#AT91C_RTTC_ALMV
 ((0x0 << 0

	)

505 
	#AT91C_RTTC_CRTV
 ((0x0 << 0

	)

507 
	#AT91C_RTTC_ALMS
 ((0x1 << 0

	)

508 
	#AT91C_RTTC_RTTINC
 ((0x1 << 1

	)

513 
	s_AT91S_PITC
 {

514 
AT91_REG
 
	mPITC_PIMR
;

515 
AT91_REG
 
	mPITC_PISR
;

516 
AT91_REG
 
	mPITC_PIVR
;

517 
AT91_REG
 
	mPITC_PIIR
;

518 } 
	tAT91S_PITC
,

519 *
	tAT91PS_PITC
;

522 
	#AT91C_PITC_PIV
 ((0xFFFFF << 0

	)

523 
	#AT91C_PITC_PITEN
 ((0x1 << 24

	)

524 
	#AT91C_PITC_PITIEN
 ((0x1 << 25

	)

526 
	#AT91C_PITC_PITS
 ((0x1 << 0

	)

528 
	#AT91C_PITC_CPIV
 ((0xFFFFF << 0

	)

529 
	#AT91C_PITC_PICNT
 ((0xFFF << 20

	)

535 
	s_AT91S_WDTC
 {

536 
AT91_REG
 
	mWDTC_WDCR
;

537 
AT91_REG
 
	mWDTC_WDMR
;

538 
AT91_REG
 
	mWDTC_WDSR
;

539 } 
	tAT91S_WDTC
,

540 *
	tAT91PS_WDTC
;

543 
	#AT91C_WDTC_WDRSTT
 ((0x1 << 0

	)

544 
	#AT91C_WDTC_KEY
 ((0xFF << 24

	)

546 
	#AT91C_WDTC_WDV
 ((0xFFF << 0

	)

547 
	#AT91C_WDTC_WDFIEN
 ((0x1 << 12

	)

548 
	#AT91C_WDTC_WDRSTEN
 ((0x1 << 13

	)

549 
	#AT91C_WDTC_WDRPROC
 ((0x1 << 14

	)

550 
	#AT91C_WDTC_WDDIS
 ((0x1 << 15

	)

551 
	#AT91C_WDTC_WDD
 ((0xFFF << 16

	)

552 
	#AT91C_WDTC_WDDBGHLT
 ((0x1 << 28

	)

553 
	#AT91C_WDTC_WDIDLEHLT
 ((0x1 << 29

	)

555 
	#AT91C_WDTC_WDUNF
 ((0x1 << 0

	)

556 
	#AT91C_WDTC_WDERR
 ((0x1 << 1

	)

561 
	s_AT91S_VREG
 {

562 
AT91_REG
 
	mVREG_MR
;

563 } 
	tAT91S_VREG
,

564 *
	tAT91PS_VREG
;

567 
	#AT91C_VREG_PSTDBY
 ((0x1 << 0

	)

572 
	s_AT91S_MC
 {

573 
AT91_REG
 
	mMC_RCR
;

574 
AT91_REG
 
	mMC_ASR
;

575 
AT91_REG
 
	mMC_AASR
;

576 
AT91_REG
 
	mRerved0
[21];

577 
AT91_REG
 
	mMC_FMR
;

578 
AT91_REG
 
	mMC_FCR
;

579 
AT91_REG
 
	mMC_FSR
;

580 } 
	tAT91S_MC
,

581 *
	tAT91PS_MC
;

584 
	#AT91C_MC_RCB
 ((0x1 << 0

	)

586 
	#AT91C_MC_UNDADD
 ((0x1 << 0

	)

587 
	#AT91C_MC_MISADD
 ((0x1 << 1

	)

588 
	#AT91C_MC_ABTSZ
 ((0x3 << 8

	)

589 
	#AT91C_MC_ABTSZ_BYTE
 ((0x0 << 8

	)

590 
	#AT91C_MC_ABTSZ_HWORD
 ((0x1 << 8

	)

591 
	#AT91C_MC_ABTSZ_WORD
 ((0x2 << 8

	)

592 
	#AT91C_MC_ABTTYP
 ((0x3 << 10

	)

593 
	#AT91C_MC_ABTTYP_DATAR
 ((0x0 << 10

	)

594 
	#AT91C_MC_ABTTYP_DATAW
 ((0x1 << 10

	)

595 
	#AT91C_MC_ABTTYP_FETCH
 ((0x2 << 10

	)

596 
	#AT91C_MC_MST0
 ((0x1 << 16

	)

597 
	#AT91C_MC_MST1
 ((0x1 << 17

	)

598 
	#AT91C_MC_SVMST0
 ((0x1 << 24

	)

599 
	#AT91C_MC_SVMST1
 ((0x1 << 25

	)

601 
	#AT91C_MC_FRDY
 ((0x1 << 0

	)

602 
	#AT91C_MC_LOCKE
 ((0x1 << 2

	)

603 
	#AT91C_MC_PROGE
 ((0x1 << 3

	)

604 
	#AT91C_MC_NEBP
 ((0x1 << 7

	)

605 
	#AT91C_MC_FWS
 ((0x3 << 8

	)

606 
	#AT91C_MC_FWS_0FWS
 ((0x0 << 8

	)

607 
	#AT91C_MC_FWS_1FWS
 ((0x1 << 8

	)

608 
	#AT91C_MC_FWS_2FWS
 ((0x2 << 8

	)

609 
	#AT91C_MC_FWS_3FWS
 ((0x3 << 8

	)

610 
	#AT91C_MC_FMCN
 ((0xFF << 16

	)

612 
	#AT91C_MC_FCMD
 ((0xF << 0

	)

613 
	#AT91C_MC_FCMD_START_PROG
 ((0x1

	)

614 
	#AT91C_MC_FCMD_LOCK
 ((0x2

	)

615 
	#AT91C_MC_FCMD_PROG_AND_LOCK
 ((0x3

	)

616 
	#AT91C_MC_FCMD_UNLOCK
 ((0x4

	)

617 
	#AT91C_MC_FCMD_ERASE_ALL
 ((0x8

	)

618 
	#AT91C_MC_FCMD_SET_GP_NVM
 ((0xB

	)

619 
	#AT91C_MC_FCMD_CLR_GP_NVM
 ((0xD

	)

620 
	#AT91C_MC_FCMD_SET_SECURITY
 ((0xF

	)

621 
	#AT91C_MC_PAGEN
 ((0x3FF << 8

	)

622 
	#AT91C_MC_KEY
 ((0xFF << 24

	)

624 
	#AT91C_MC_SECURITY
 ((0x1 << 4

	)

625 
	#AT91C_MC_GPNVM0
 ((0x1 << 8

	)

626 
	#AT91C_MC_GPNVM1
 ((0x1 << 9

	)

627 
	#AT91C_MC_GPNVM2
 ((0x1 << 10

	)

628 
	#AT91C_MC_GPNVM3
 ((0x1 << 11

	)

629 
	#AT91C_MC_GPNVM4
 ((0x1 << 12

	)

630 
	#AT91C_MC_GPNVM5
 ((0x1 << 13

	)

631 
	#AT91C_MC_GPNVM6
 ((0x1 << 14

	)

632 
	#AT91C_MC_GPNVM7
 ((0x1 << 15

	)

633 
	#AT91C_MC_LOCKS0
 ((0x1 << 16

	)

634 
	#AT91C_MC_LOCKS1
 ((0x1 << 17

	)

635 
	#AT91C_MC_LOCKS2
 ((0x1 << 18

	)

636 
	#AT91C_MC_LOCKS3
 ((0x1 << 19

	)

637 
	#AT91C_MC_LOCKS4
 ((0x1 << 20

	)

638 
	#AT91C_MC_LOCKS5
 ((0x1 << 21

	)

639 
	#AT91C_MC_LOCKS6
 ((0x1 << 22

	)

640 
	#AT91C_MC_LOCKS7
 ((0x1 << 23

	)

641 
	#AT91C_MC_LOCKS8
 ((0x1 << 24

	)

642 
	#AT91C_MC_LOCKS9
 ((0x1 << 25

	)

643 
	#AT91C_MC_LOCKS10
 ((0x1 << 26

	)

644 
	#AT91C_MC_LOCKS11
 ((0x1 << 27

	)

645 
	#AT91C_MC_LOCKS12
 ((0x1 << 28

	)

646 
	#AT91C_MC_LOCKS13
 ((0x1 << 29

	)

647 
	#AT91C_MC_LOCKS14
 ((0x1 << 30

	)

648 
	#AT91C_MC_LOCKS15
 ((0x1 << 31

	)

653 
	s_AT91S_SPI
 {

654 
AT91_REG
 
	mSPI_CR
;

655 
AT91_REG
 
	mSPI_MR
;

656 
AT91_REG
 
	mSPI_RDR
;

657 
AT91_REG
 
	mSPI_TDR
;

658 
AT91_REG
 
	mSPI_SR
;

659 
AT91_REG
 
	mSPI_IER
;

660 
AT91_REG
 
	mSPI_IDR
;

661 
AT91_REG
 
	mSPI_IMR
;

662 
AT91_REG
 
	mRerved0
[4];

663 
AT91_REG
 
	mSPI_CSR
[4];

664 
AT91_REG
 
	mRerved1
[48];

665 
AT91_REG
 
	mSPI_RPR
;

666 
AT91_REG
 
	mSPI_RCR
;

667 
AT91_REG
 
	mSPI_TPR
;

668 
AT91_REG
 
	mSPI_TCR
;

669 
AT91_REG
 
	mSPI_RNPR
;

670 
AT91_REG
 
	mSPI_RNCR
;

671 
AT91_REG
 
	mSPI_TNPR
;

672 
AT91_REG
 
	mSPI_TNCR
;

673 
AT91_REG
 
	mSPI_PTCR
;

674 
AT91_REG
 
	mSPI_PTSR
;

675 } 
	tAT91S_SPI
,

676 *
	tAT91PS_SPI
;

679 
	#AT91C_SPI_SPIEN
 ((0x1 << 0

	)

680 
	#AT91C_SPI_SPIDIS
 ((0x1 << 1

	)

681 
	#AT91C_SPI_SWRST
 ((0x1 << 7

	)

682 
	#AT91C_SPI_LASTXFER
 ((0x1 << 24

	)

684 
	#AT91C_SPI_MSTR
 ((0x1 << 0

	)

685 
	#AT91C_SPI_PS
 ((0x1 << 1

	)

686 
	#AT91C_SPI_PS_FIXED
 ((0x0 << 1

	)

687 
	#AT91C_SPI_PS_VARIABLE
 ((0x1 << 1

	)

688 
	#AT91C_SPI_PCSDEC
 ((0x1 << 2

	)

689 
	#AT91C_SPI_FDIV
 ((0x1 << 3

	)

690 
	#AT91C_SPI_MODFDIS
 ((0x1 << 4

	)

691 
	#AT91C_SPI_LLB
 ((0x1 << 7

	)

692 
	#AT91C_SPI_PCS
 ((0xF << 16

	)

693 
	#AT91C_SPI_DLYBCS
 ((0xFF << 24

	)

695 
	#AT91C_SPI_RD
 ((0xFFFF << 0

	)

696 
	#AT91C_SPI_RPCS
 ((0xF << 16

	)

698 
	#AT91C_SPI_TD
 ((0xFFFF << 0

	)

699 
	#AT91C_SPI_TPCS
 ((0xF << 16

	)

701 
	#AT91C_SPI_RDRF
 ((0x1 << 0

	)

702 
	#AT91C_SPI_TDRE
 ((0x1 << 1

	)

703 
	#AT91C_SPI_MODF
 ((0x1 << 2

	)

704 
	#AT91C_SPI_OVRES
 ((0x1 << 3

	)

705 
	#AT91C_SPI_ENDRX
 ((0x1 << 4

	)

706 
	#AT91C_SPI_ENDTX
 ((0x1 << 5

	)

707 
	#AT91C_SPI_RXBUFF
 ((0x1 << 6

	)

708 
	#AT91C_SPI_TXBUFE
 ((0x1 << 7

	)

709 
	#AT91C_SPI_NSSR
 ((0x1 << 8

	)

710 
	#AT91C_SPI_TXEMPTY
 ((0x1 << 9

	)

711 
	#AT91C_SPI_SPIENS
 ((0x1 << 16

	)

716 
	#AT91C_SPI_CPOL
 ((0x1 << 0

	)

717 
	#AT91C_SPI_NCPHA
 ((0x1 << 1

	)

718 
	#AT91C_SPI_CSAAT
 ((0x1 << 3

	)

719 
	#AT91C_SPI_BITS
 ((0xF << 4

	)

720 
	#AT91C_SPI_BITS_8
 ((0x0 << 4

	)

721 
	#AT91C_SPI_BITS_9
 ((0x1 << 4

	)

722 
	#AT91C_SPI_BITS_10
 ((0x2 << 4

	)

723 
	#AT91C_SPI_BITS_11
 ((0x3 << 4

	)

724 
	#AT91C_SPI_BITS_12
 ((0x4 << 4

	)

725 
	#AT91C_SPI_BITS_13
 ((0x5 << 4

	)

726 
	#AT91C_SPI_BITS_14
 ((0x6 << 4

	)

727 
	#AT91C_SPI_BITS_15
 ((0x7 << 4

	)

728 
	#AT91C_SPI_BITS_16
 ((0x8 << 4

	)

729 
	#AT91C_SPI_SCBR
 ((0xFF << 8

	)

730 
	#AT91C_SPI_DLYBS
 ((0xFF << 16

	)

731 
	#AT91C_SPI_DLYBCT
 ((0xFF << 24

	)

736 
	s_AT91S_ADC
 {

737 
AT91_REG
 
	mADC_CR
;

738 
AT91_REG
 
	mADC_MR
;

739 
AT91_REG
 
	mRerved0
[2];

740 
AT91_REG
 
	mADC_CHER
;

741 
AT91_REG
 
	mADC_CHDR
;

742 
AT91_REG
 
	mADC_CHSR
;

743 
AT91_REG
 
	mADC_SR
;

744 
AT91_REG
 
	mADC_LCDR
;

745 
AT91_REG
 
	mADC_IER
;

746 
AT91_REG
 
	mADC_IDR
;

747 
AT91_REG
 
	mADC_IMR
;

748 
AT91_REG
 
	mADC_CDR0
;

749 
AT91_REG
 
	mADC_CDR1
;

750 
AT91_REG
 
	mADC_CDR2
;

751 
AT91_REG
 
	mADC_CDR3
;

752 
AT91_REG
 
	mADC_CDR4
;

753 
AT91_REG
 
	mADC_CDR5
;

754 
AT91_REG
 
	mADC_CDR6
;

755 
AT91_REG
 
	mADC_CDR7
;

756 
AT91_REG
 
	mRerved1
[44];

757 
AT91_REG
 
	mADC_RPR
;

758 
AT91_REG
 
	mADC_RCR
;

759 
AT91_REG
 
	mADC_TPR
;

760 
AT91_REG
 
	mADC_TCR
;

761 
AT91_REG
 
	mADC_RNPR
;

762 
AT91_REG
 
	mADC_RNCR
;

763 
AT91_REG
 
	mADC_TNPR
;

764 
AT91_REG
 
	mADC_TNCR
;

765 
AT91_REG
 
	mADC_PTCR
;

766 
AT91_REG
 
	mADC_PTSR
;

767 } 
	tAT91S_ADC
,

768 *
	tAT91PS_ADC
;

771 
	#AT91C_ADC_SWRST
 ((0x1 << 0

	)

772 
	#AT91C_ADC_START
 ((0x1 << 1

	)

774 
	#AT91C_ADC_TRGEN
 ((0x1 << 0

	)

775 
	#AT91C_ADC_TRGEN_DIS
 ((0x0

	)

776 
	#AT91C_ADC_TRGEN_EN
 ((0x1

	)

777 
	#AT91C_ADC_TRGSEL
 ((0x7 << 1

	)

778 
	#AT91C_ADC_TRGSEL_TIOA0
 ((0x0 << 1

	)

779 
	#AT91C_ADC_TRGSEL_TIOA1
 ((0x1 << 1

	)

780 
	#AT91C_ADC_TRGSEL_TIOA2
 ((0x2 << 1

	)

781 
	#AT91C_ADC_TRGSEL_TIOA3
 ((0x3 << 1

	)

782 
	#AT91C_ADC_TRGSEL_TIOA4
 ((0x4 << 1

	)

783 
	#AT91C_ADC_TRGSEL_TIOA5
 ((0x5 << 1

	)

784 
	#AT91C_ADC_TRGSEL_EXT
 ((0x6 << 1

	)

785 
	#AT91C_ADC_LOWRES
 ((0x1 << 4

	)

786 
	#AT91C_ADC_LOWRES_10_BIT
 ((0x0 << 4

	)

787 
	#AT91C_ADC_LOWRES_8_BIT
 ((0x1 << 4

	)

788 
	#AT91C_ADC_SLEEP
 ((0x1 << 5

	)

789 
	#AT91C_ADC_SLEEP_NORMAL_MODE
 ((0x0 << 5

	)

790 
	#AT91C_ADC_SLEEP_MODE
 ((0x1 << 5

	)

791 
	#AT91C_ADC_PRESCAL
 ((0x3F << 8

	)

792 
	#AT91C_ADC_STARTUP
 ((0x1F << 16

	)

793 
	#AT91C_ADC_SHTIM
 ((0xF << 24

	)

795 
	#AT91C_ADC_CH0
 ((0x1 << 0

	)

796 
	#AT91C_ADC_CH1
 ((0x1 << 1

	)

797 
	#AT91C_ADC_CH2
 ((0x1 << 2

	)

798 
	#AT91C_ADC_CH3
 ((0x1 << 3

	)

799 
	#AT91C_ADC_CH4
 ((0x1 << 4

	)

800 
	#AT91C_ADC_CH5
 ((0x1 << 5

	)

801 
	#AT91C_ADC_CH6
 ((0x1 << 6

	)

802 
	#AT91C_ADC_CH7
 ((0x1 << 7

	)

806 
	#AT91C_ADC_EOC0
 ((0x1 << 0

	)

807 
	#AT91C_ADC_EOC1
 ((0x1 << 1

	)

808 
	#AT91C_ADC_EOC2
 ((0x1 << 2

	)

809 
	#AT91C_ADC_EOC3
 ((0x1 << 3

	)

810 
	#AT91C_ADC_EOC4
 ((0x1 << 4

	)

811 
	#AT91C_ADC_EOC5
 ((0x1 << 5

	)

812 
	#AT91C_ADC_EOC6
 ((0x1 << 6

	)

813 
	#AT91C_ADC_EOC7
 ((0x1 << 7

	)

814 
	#AT91C_ADC_OVRE0
 ((0x1 << 8

	)

815 
	#AT91C_ADC_OVRE1
 ((0x1 << 9

	)

816 
	#AT91C_ADC_OVRE2
 ((0x1 << 10

	)

817 
	#AT91C_ADC_OVRE3
 ((0x1 << 11

	)

818 
	#AT91C_ADC_OVRE4
 ((0x1 << 12

	)

819 
	#AT91C_ADC_OVRE5
 ((0x1 << 13

	)

820 
	#AT91C_ADC_OVRE6
 ((0x1 << 14

	)

821 
	#AT91C_ADC_OVRE7
 ((0x1 << 15

	)

822 
	#AT91C_ADC_DRDY
 ((0x1 << 16

	)

823 
	#AT91C_ADC_GOVRE
 ((0x1 << 17

	)

824 
	#AT91C_ADC_ENDRX
 ((0x1 << 18

	)

825 
	#AT91C_ADC_RXBUFF
 ((0x1 << 19

	)

827 
	#AT91C_ADC_LDATA
 ((0x3FF << 0

	)

832 
	#AT91C_ADC_DATA
 ((0x3FF << 0

	)

844 
	s_AT91S_SSC
 {

845 
AT91_REG
 
	mSSC_CR
;

846 
AT91_REG
 
	mSSC_CMR
;

847 
AT91_REG
 
	mRerved0
[2];

848 
AT91_REG
 
	mSSC_RCMR
;

849 
AT91_REG
 
	mSSC_RFMR
;

850 
AT91_REG
 
	mSSC_TCMR
;

851 
AT91_REG
 
	mSSC_TFMR
;

852 
AT91_REG
 
	mSSC_RHR
;

853 
AT91_REG
 
	mSSC_THR
;

854 
AT91_REG
 
	mRerved1
[2];

855 
AT91_REG
 
	mSSC_RSHR
;

856 
AT91_REG
 
	mSSC_TSHR
;

857 
AT91_REG
 
	mRerved2
[2];

858 
AT91_REG
 
	mSSC_SR
;

859 
AT91_REG
 
	mSSC_IER
;

860 
AT91_REG
 
	mSSC_IDR
;

861 
AT91_REG
 
	mSSC_IMR
;

862 
AT91_REG
 
	mRerved3
[44];

863 
AT91_REG
 
	mSSC_RPR
;

864 
AT91_REG
 
	mSSC_RCR
;

865 
AT91_REG
 
	mSSC_TPR
;

866 
AT91_REG
 
	mSSC_TCR
;

867 
AT91_REG
 
	mSSC_RNPR
;

868 
AT91_REG
 
	mSSC_RNCR
;

869 
AT91_REG
 
	mSSC_TNPR
;

870 
AT91_REG
 
	mSSC_TNCR
;

871 
AT91_REG
 
	mSSC_PTCR
;

872 
AT91_REG
 
	mSSC_PTSR
;

873 } 
	tAT91S_SSC
,

874 *
	tAT91PS_SSC
;

877 
	#AT91C_SSC_RXEN
 ((0x1 << 0

	)

878 
	#AT91C_SSC_RXDIS
 ((0x1 << 1

	)

879 
	#AT91C_SSC_TXEN
 ((0x1 << 8

	)

880 
	#AT91C_SSC_TXDIS
 ((0x1 << 9

	)

881 
	#AT91C_SSC_SWRST
 ((0x1 << 15

	)

883 
	#AT91C_SSC_CKS
 ((0x3 << 0

	)

884 
	#AT91C_SSC_CKS_DIV
 ((0x0

	)

885 
	#AT91C_SSC_CKS_TK
 ((0x1

	)

886 
	#AT91C_SSC_CKS_RK
 ((0x2

	)

887 
	#AT91C_SSC_CKO
 ((0x7 << 2

	)

888 
	#AT91C_SSC_CKO_NONE
 ((0x0 << 2

	)

889 
	#AT91C_SSC_CKO_CONTINOUS
 ((0x1 << 2

	)

890 
	#AT91C_SSC_CKO_DATA_TX
 ((0x2 << 2

	)

891 
	#AT91C_SSC_CKI
 ((0x1 << 5

	)

892 
	#AT91C_SSC_START
 ((0xF << 8

	)

893 
	#AT91C_SSC_START_CONTINOUS
 ((0x0 << 8

	)

894 
	#AT91C_SSC_START_TX
 ((0x1 << 8

	)

895 
	#AT91C_SSC_START_LOW_RF
 ((0x2 << 8

	)

896 
	#AT91C_SSC_START_HIGH_RF
 ((0x3 << 8

	)

897 
	#AT91C_SSC_START_FALL_RF
 ((0x4 << 8

	)

898 
	#AT91C_SSC_START_RISE_RF
 ((0x5 << 8

	)

899 
	#AT91C_SSC_START_LEVEL_RF
 ((0x6 << 8

	)

900 
	#AT91C_SSC_START_EDGE_RF
 ((0x7 << 8

	)

901 
	#AT91C_SSC_START_0
 ((0x8 << 8

	)

902 
	#AT91C_SSC_STTDLY
 ((0xFF << 16

	)

903 
	#AT91C_SSC_PERIOD
 ((0xFF << 24

	)

905 
	#AT91C_SSC_DATLEN
 ((0x1F << 0

	)

906 
	#AT91C_SSC_LOOP
 ((0x1 << 5

	)

907 
	#AT91C_SSC_MSBF
 ((0x1 << 7

	)

908 
	#AT91C_SSC_DATNB
 ((0xF << 8

	)

909 
	#AT91C_SSC_FSLEN
 ((0xF << 16

	)

910 
	#AT91C_SSC_FSOS
 ((0x7 << 20

	)

911 
	#AT91C_SSC_FSOS_NONE
 ((0x0 << 20

	)

912 
	#AT91C_SSC_FSOS_NEGATIVE
 ((0x1 << 20

	)

913 
	#AT91C_SSC_FSOS_POSITIVE
 ((0x2 << 20

	)

914 
	#AT91C_SSC_FSOS_LOW
 ((0x3 << 20

	)

915 
	#AT91C_SSC_FSOS_HIGH
 ((0x4 << 20

	)

916 
	#AT91C_SSC_FSOS_TOGGLE
 ((0x5 << 20

	)

917 
	#AT91C_SSC_FSEDGE
 ((0x1 << 24

	)

920 
	#AT91C_SSC_DATDEF
 ((0x1 << 5

	)

921 
	#AT91C_SSC_FSDEN
 ((0x1 << 23

	)

923 
	#AT91C_SSC_TXRDY
 ((0x1 << 0

	)

924 
	#AT91C_SSC_TXEMPTY
 ((0x1 << 1

	)

925 
	#AT91C_SSC_ENDTX
 ((0x1 << 2

	)

926 
	#AT91C_SSC_TXBUFE
 ((0x1 << 3

	)

927 
	#AT91C_SSC_RXRDY
 ((0x1 << 4

	)

928 
	#AT91C_SSC_OVRUN
 ((0x1 << 5

	)

929 
	#AT91C_SSC_ENDRX
 ((0x1 << 6

	)

930 
	#AT91C_SSC_RXBUFF
 ((0x1 << 7

	)

931 
	#AT91C_SSC_TXSYN
 ((0x1 << 10

	)

932 
	#AT91C_SSC_RXSYN
 ((0x1 << 11

	)

933 
	#AT91C_SSC_TXENA
 ((0x1 << 16

	)

934 
	#AT91C_SSC_RXENA
 ((0x1 << 17

	)

942 
	s_AT91S_USART
 {

943 
AT91_REG
 
	mUS_CR
;

944 
AT91_REG
 
	mUS_MR
;

945 
AT91_REG
 
	mUS_IER
;

946 
AT91_REG
 
	mUS_IDR
;

947 
AT91_REG
 
	mUS_IMR
;

948 
AT91_REG
 
	mUS_CSR
;

949 
AT91_REG
 
	mUS_RHR
;

950 
AT91_REG
 
	mUS_THR
;

951 
AT91_REG
 
	mUS_BRGR
;

952 
AT91_REG
 
	mUS_RTOR
;

953 
AT91_REG
 
	mUS_TTGR
;

954 
AT91_REG
 
	mRerved0
[5];

955 
AT91_REG
 
	mUS_FIDI
;

956 
AT91_REG
 
	mUS_NER
;

957 
AT91_REG
 
	mRerved1
[1];

958 
AT91_REG
 
	mUS_IF
;

959 
AT91_REG
 
	mRerved2
[44];

960 
AT91_REG
 
	mUS_RPR
;

961 
AT91_REG
 
	mUS_RCR
;

962 
AT91_REG
 
	mUS_TPR
;

963 
AT91_REG
 
	mUS_TCR
;

964 
AT91_REG
 
	mUS_RNPR
;

965 
AT91_REG
 
	mUS_RNCR
;

966 
AT91_REG
 
	mUS_TNPR
;

967 
AT91_REG
 
	mUS_TNCR
;

968 
AT91_REG
 
	mUS_PTCR
;

969 
AT91_REG
 
	mUS_PTSR
;

970 } 
	tAT91S_USART
,

971 *
	tAT91PS_USART
;

974 
	#AT91C_US_STTBRK
 ((0x1 << 9

	)

975 
	#AT91C_US_STPBRK
 ((0x1 << 10

	)

976 
	#AT91C_US_STTTO
 ((0x1 << 11

	)

977 
	#AT91C_US_SENDA
 ((0x1 << 12

	)

978 
	#AT91C_US_RSTIT
 ((0x1 << 13

	)

979 
	#AT91C_US_RSTNACK
 ((0x1 << 14

	)

980 
	#AT91C_US_RETTO
 ((0x1 << 15

	)

981 
	#AT91C_US_DTREN
 ((0x1 << 16

	)

982 
	#AT91C_US_DTRDIS
 ((0x1 << 17

	)

983 
	#AT91C_US_RTSEN
 ((0x1 << 18

	)

984 
	#AT91C_US_RTSDIS
 ((0x1 << 19

	)

986 
	#AT91C_US_USMODE
 ((0xF << 0

	)

987 
	#AT91C_US_USMODE_NORMAL
 ((0x0

	)

988 
	#AT91C_US_USMODE_RS485
 ((0x1

	)

989 
	#AT91C_US_USMODE_HWHSH
 ((0x2

	)

990 
	#AT91C_US_USMODE_MODEM
 ((0x3

	)

991 
	#AT91C_US_USMODE_ISO7816_0
 ((0x4

	)

992 
	#AT91C_US_USMODE_ISO7816_1
 ((0x6

	)

993 
	#AT91C_US_USMODE_IRDA
 ((0x8

	)

994 
	#AT91C_US_USMODE_SWHSH
 ((0xC

	)

995 
	#AT91C_US_CLKS
 ((0x3 << 4

	)

996 
	#AT91C_US_CLKS_CLOCK
 ((0x0 << 4

	)

997 
	#AT91C_US_CLKS_FDIV1
 ((0x1 << 4

	)

998 
	#AT91C_US_CLKS_SLOW
 ((0x2 << 4

	)

999 
	#AT91C_US_CLKS_EXT
 ((0x3 << 4

	)

1000 
	#AT91C_US_CHRL
 ((0x3 << 6

	)

1001 
	#AT91C_US_CHRL_5_BITS
 ((0x0 << 6

	)

1002 
	#AT91C_US_CHRL_6_BITS
 ((0x1 << 6

	)

1003 
	#AT91C_US_CHRL_7_BITS
 ((0x2 << 6

	)

1004 
	#AT91C_US_CHRL_8_BITS
 ((0x3 << 6

	)

1005 
	#AT91C_US_SYNC
 ((0x1 << 8

	)

1006 
	#AT91C_US_NBSTOP
 ((0x3 << 12

	)

1007 
	#AT91C_US_NBSTOP_1_BIT
 ((0x0 << 12

	)

1008 
	#AT91C_US_NBSTOP_15_BIT
 ((0x1 << 12

	)

1009 
	#AT91C_US_NBSTOP_2_BIT
 ((0x2 << 12

	)

1010 
	#AT91C_US_MSBF
 ((0x1 << 16

	)

1011 
	#AT91C_US_MODE9
 ((0x1 << 17

	)

1012 
	#AT91C_US_CKLO
 ((0x1 << 18

	)

1013 
	#AT91C_US_OVER
 ((0x1 << 19

	)

1014 
	#AT91C_US_INACK
 ((0x1 << 20

	)

1015 
	#AT91C_US_DSNACK
 ((0x1 << 21

	)

1016 
	#AT91C_US_MAX_ITER
 ((0x1 << 24

	)

1017 
	#AT91C_US_FILTER
 ((0x1 << 28

	)

1019 
	#AT91C_US_RXBRK
 ((0x1 << 2

	)

1020 
	#AT91C_US_TIMEOUT
 ((0x1 << 8

	)

1021 
	#AT91C_US_ITERATION
 ((0x1 << 10

	)

1022 
	#AT91C_US_NACK
 ((0x1 << 13

	)

1023 
	#AT91C_US_RIIC
 ((0x1 << 16

	)

1024 
	#AT91C_US_DSRIC
 ((0x1 << 17

	)

1025 
	#AT91C_US_DCDIC
 ((0x1 << 18

	)

1026 
	#AT91C_US_CTSIC
 ((0x1 << 19

	)

1030 
	#AT91C_US_RI
 ((0x1 << 20

	)

1031 
	#AT91C_US_DSR
 ((0x1 << 21

	)

1032 
	#AT91C_US_DCD
 ((0x1 << 22

	)

1033 
	#AT91C_US_CTS
 ((0x1 << 23

	)

1038 
	s_AT91S_TWI
 {

1039 
AT91_REG
 
	mTWI_CR
;

1040 
AT91_REG
 
	mTWI_MMR
;

1041 
AT91_REG
 
	mRerved0
[1];

1042 
AT91_REG
 
	mTWI_IADR
;

1043 
AT91_REG
 
	mTWI_CWGR
;

1044 
AT91_REG
 
	mRerved1
[3];

1045 
AT91_REG
 
	mTWI_SR
;

1046 
AT91_REG
 
	mTWI_IER
;

1047 
AT91_REG
 
	mTWI_IDR
;

1048 
AT91_REG
 
	mTWI_IMR
;

1049 
AT91_REG
 
	mTWI_RHR
;

1050 
AT91_REG
 
	mTWI_THR
;

1051 } 
	tAT91S_TWI
,

1052 *
	tAT91PS_TWI
;

1055 
	#AT91C_TWI_START
 ((0x1 << 0

	)

1056 
	#AT91C_TWI_STOP
 ((0x1 << 1

	)

1057 
	#AT91C_TWI_MSEN
 ((0x1 << 2

	)

1058 
	#AT91C_TWI_MSDIS
 ((0x1 << 3

	)

1059 
	#AT91C_TWI_SWRST
 ((0x1 << 7

	)

1061 
	#AT91C_TWI_IADRSZ
 ((0x3 << 8

	)

1062 
	#AT91C_TWI_IADRSZ_NO
 ((0x0 << 8

	)

1063 
	#AT91C_TWI_IADRSZ_1_BYTE
 ((0x1 << 8

	)

1064 
	#AT91C_TWI_IADRSZ_2_BYTE
 ((0x2 << 8

	)

1065 
	#AT91C_TWI_IADRSZ_3_BYTE
 ((0x3 << 8

	)

1066 
	#AT91C_TWI_MREAD
 ((0x1 << 12

	)

1067 
	#AT91C_TWI_DADR
 ((0x7F << 16

	)

1069 
	#AT91C_TWI_CLDIV
 ((0xFF << 0

	)

1070 
	#AT91C_TWI_CHDIV
 ((0xFF << 8

	)

1071 
	#AT91C_TWI_CKDIV
 ((0x7 << 16

	)

1073 
	#AT91C_TWI_TXCOMP
 ((0x1 << 0

	)

1074 
	#AT91C_TWI_RXRDY
 ((0x1 << 1

	)

1075 
	#AT91C_TWI_TXRDY
 ((0x1 << 2

	)

1076 
	#AT91C_TWI_OVRE
 ((0x1 << 6

	)

1077 
	#AT91C_TWI_UNRE
 ((0x1 << 7

	)

1078 
	#AT91C_TWI_NACK
 ((0x1 << 8

	)

1086 
	s_AT91S_TC
 {

1087 
AT91_REG
 
	mTC_CCR
;

1088 
AT91_REG
 
	mTC_CMR
;

1089 
AT91_REG
 
	mRerved0
[2];

1090 
AT91_REG
 
	mTC_CV
;

1091 
AT91_REG
 
	mTC_RA
;

1092 
AT91_REG
 
	mTC_RB
;

1093 
AT91_REG
 
	mTC_RC
;

1094 
AT91_REG
 
	mTC_SR
;

1095 
AT91_REG
 
	mTC_IER
;

1096 
AT91_REG
 
	mTC_IDR
;

1097 
AT91_REG
 
	mTC_IMR
;

1098 } 
	tAT91S_TC
,

1099 *
	tAT91PS_TC
;

1102 
	#AT91C_TC_CLKEN
 ((0x1 << 0

	)

1103 
	#AT91C_TC_CLKDIS
 ((0x1 << 1

	)

1104 
	#AT91C_TC_SWTRG
 ((0x1 << 2

	)

1106 
	#AT91C_TC_CLKS
 ((0x7 << 0

	)

1107 
	#AT91C_TC_CLKS_TIMER_DIV1_CLOCK
 ((0x0

	)

1108 
	#AT91C_TC_CLKS_TIMER_DIV2_CLOCK
 ((0x1

	)

1109 
	#AT91C_TC_CLKS_TIMER_DIV3_CLOCK
 ((0x2

	)

1110 
	#AT91C_TC_CLKS_TIMER_DIV4_CLOCK
 ((0x3

	)

1111 
	#AT91C_TC_CLKS_TIMER_DIV5_CLOCK
 ((0x4

	)

1112 
	#AT91C_TC_CLKS_XC0
 ((0x5

	)

1113 
	#AT91C_TC_CLKS_XC1
 ((0x6

	)

1114 
	#AT91C_TC_CLKS_XC2
 ((0x7

	)

1115 
	#AT91C_TC_CLKI
 ((0x1 << 3

	)

1116 
	#AT91C_TC_BURST
 ((0x3 << 4

	)

1117 
	#AT91C_TC_BURST_NONE
 ((0x0 << 4

	)

1118 
	#AT91C_TC_BURST_XC0
 ((0x1 << 4

	)

1119 
	#AT91C_TC_BURST_XC1
 ((0x2 << 4

	)

1120 
	#AT91C_TC_BURST_XC2
 ((0x3 << 4

	)

1121 
	#AT91C_TC_CPCSTOP
 ((0x1 << 6

	)

1122 
	#AT91C_TC_LDBSTOP
 ((0x1 << 6

	)

1123 
	#AT91C_TC_CPCDIS
 ((0x1 << 7

	)

1124 
	#AT91C_TC_LDBDIS
 ((0x1 << 7

	)

1125 
	#AT91C_TC_ETRGEDG
 ((0x3 << 8

	)

1126 
	#AT91C_TC_ETRGEDG_NONE
 ((0x0 << 8

	)

1127 
	#AT91C_TC_ETRGEDG_RISING
 ((0x1 << 8

	)

1128 
	#AT91C_TC_ETRGEDG_FALLING
 ((0x2 << 8

	)

1129 
	#AT91C_TC_ETRGEDG_BOTH
 ((0x3 << 8

	)

1130 
	#AT91C_TC_EEVTEDG
 ((0x3 << 8

	)

1131 
	#AT91C_TC_EEVTEDG_NONE
 ((0x0 << 8

	)

1132 
	#AT91C_TC_EEVTEDG_RISING
 ((0x1 << 8

	)

1133 
	#AT91C_TC_EEVTEDG_FALLING
 ((0x2 << 8

	)

1134 
	#AT91C_TC_EEVTEDG_BOTH
 ((0x3 << 8

	)

1135 
	#AT91C_TC_EEVT
 ((0x3 << 10

	)

1136 
	#AT91C_TC_EEVT_TIOB
 ((0x0 << 10

	)

1137 
	#AT91C_TC_EEVT_XC0
 ((0x1 << 10

	)

1138 
	#AT91C_TC_EEVT_XC1
 ((0x2 << 10

	)

1139 
	#AT91C_TC_EEVT_XC2
 ((0x3 << 10

	)

1140 
	#AT91C_TC_ABETRG
 ((0x1 << 10

	)

1141 
	#AT91C_TC_ENETRG
 ((0x1 << 12

	)

1142 
	#AT91C_TC_WAVESEL
 ((0x3 << 13

	)

1143 
	#AT91C_TC_WAVESEL_UP
 ((0x0 << 13

	)

1144 
	#AT91C_TC_WAVESEL_UPDOWN
 ((0x1 << 13

	)

1145 
	#AT91C_TC_WAVESEL_UP_AUTO
 ((0x2 << 13

	)

1146 
	#AT91C_TC_WAVESEL_UPDOWN_AUTO
 ((0x3 << 13

	)

1147 
	#AT91C_TC_CPCTRG
 ((0x1 << 14

	)

1148 
	#AT91C_TC_WAVE
 ((0x1 << 15

	)

1149 
	#AT91C_TC_ACPA
 ((0x3 << 16

	)

1150 
	#AT91C_TC_ACPA_NONE
 ((0x0 << 16

	)

1151 
	#AT91C_TC_ACPA_SET
 ((0x1 << 16

	)

1152 
	#AT91C_TC_ACPA_CLEAR
 ((0x2 << 16

	)

1153 
	#AT91C_TC_ACPA_TOGGLE
 ((0x3 << 16

	)

1154 
	#AT91C_TC_LDRA
 ((0x3 << 16

	)

1155 
	#AT91C_TC_LDRA_NONE
 ((0x0 << 16

	)

1156 
	#AT91C_TC_LDRA_RISING
 ((0x1 << 16

	)

1157 
	#AT91C_TC_LDRA_FALLING
 ((0x2 << 16

	)

1158 
	#AT91C_TC_LDRA_BOTH
 ((0x3 << 16

	)

1159 
	#AT91C_TC_ACPC
 ((0x3 << 18

	)

1160 
	#AT91C_TC_ACPC_NONE
 ((0x0 << 18

	)

1161 
	#AT91C_TC_ACPC_SET
 ((0x1 << 18

	)

1162 
	#AT91C_TC_ACPC_CLEAR
 ((0x2 << 18

	)

1163 
	#AT91C_TC_ACPC_TOGGLE
 ((0x3 << 18

	)

1164 
	#AT91C_TC_LDRB
 ((0x3 << 18

	)

1165 
	#AT91C_TC_LDRB_NONE
 ((0x0 << 18

	)

1166 
	#AT91C_TC_LDRB_RISING
 ((0x1 << 18

	)

1167 
	#AT91C_TC_LDRB_FALLING
 ((0x2 << 18

	)

1168 
	#AT91C_TC_LDRB_BOTH
 ((0x3 << 18

	)

1169 
	#AT91C_TC_AEEVT
 ((0x3 << 20

	)

1170 
	#AT91C_TC_AEEVT_NONE
 ((0x0 << 20

	)

1171 
	#AT91C_TC_AEEVT_SET
 ((0x1 << 20

	)

1172 
	#AT91C_TC_AEEVT_CLEAR
 ((0x2 << 20

	)

1173 
	#AT91C_TC_AEEVT_TOGGLE
 ((0x3 << 20

	)

1174 
	#AT91C_TC_ASWTRG
 ((0x3 << 22

	)

1175 
	#AT91C_TC_ASWTRG_NONE
 ((0x0 << 22

	)

1176 
	#AT91C_TC_ASWTRG_SET
 ((0x1 << 22

	)

1177 
	#AT91C_TC_ASWTRG_CLEAR
 ((0x2 << 22

	)

1178 
	#AT91C_TC_ASWTRG_TOGGLE
 ((0x3 << 22

	)

1179 
	#AT91C_TC_BCPB
 ((0x3 << 24

	)

1180 
	#AT91C_TC_BCPB_NONE
 ((0x0 << 24

	)

1181 
	#AT91C_TC_BCPB_SET
 ((0x1 << 24

	)

1182 
	#AT91C_TC_BCPB_CLEAR
 ((0x2 << 24

	)

1183 
	#AT91C_TC_BCPB_TOGGLE
 ((0x3 << 24

	)

1184 
	#AT91C_TC_BCPC
 ((0x3 << 26

	)

1185 
	#AT91C_TC_BCPC_NONE
 ((0x0 << 26

	)

1186 
	#AT91C_TC_BCPC_SET
 ((0x1 << 26

	)

1187 
	#AT91C_TC_BCPC_CLEAR
 ((0x2 << 26

	)

1188 
	#AT91C_TC_BCPC_TOGGLE
 ((0x3 << 26

	)

1189 
	#AT91C_TC_BEEVT
 ((0x3 << 28

	)

1190 
	#AT91C_TC_BEEVT_NONE
 ((0x0 << 28

	)

1191 
	#AT91C_TC_BEEVT_SET
 ((0x1 << 28

	)

1192 
	#AT91C_TC_BEEVT_CLEAR
 ((0x2 << 28

	)

1193 
	#AT91C_TC_BEEVT_TOGGLE
 ((0x3 << 28

	)

1194 
	#AT91C_TC_BSWTRG
 ((0x3 << 30

	)

1195 
	#AT91C_TC_BSWTRG_NONE
 ((0x0 << 30

	)

1196 
	#AT91C_TC_BSWTRG_SET
 ((0x1 << 30

	)

1197 
	#AT91C_TC_BSWTRG_CLEAR
 ((0x2 << 30

	)

1198 
	#AT91C_TC_BSWTRG_TOGGLE
 ((0x3 << 30

	)

1200 
	#AT91C_TC_COVFS
 ((0x1 << 0

	)

1201 
	#AT91C_TC_LOVRS
 ((0x1 << 1

	)

1202 
	#AT91C_TC_CPAS
 ((0x1 << 2

	)

1203 
	#AT91C_TC_CPBS
 ((0x1 << 3

	)

1204 
	#AT91C_TC_CPCS
 ((0x1 << 4

	)

1205 
	#AT91C_TC_LDRAS
 ((0x1 << 5

	)

1206 
	#AT91C_TC_LDRBS
 ((0x1 << 6

	)

1207 
	#AT91C_TC_ETRGS
 ((0x1 << 7

	)

1208 
	#AT91C_TC_CLKSTA
 ((0x1 << 16

	)

1209 
	#AT91C_TC_MTIOA
 ((0x1 << 17

	)

1210 
	#AT91C_TC_MTIOB
 ((0x1 << 18

	)

1218 
	s_AT91S_TCB
 {

1219 
AT91S_TC
 
	mTCB_TC0
;

1220 
AT91_REG
 
	mRerved0
[4];

1221 
AT91S_TC
 
	mTCB_TC1
;

1222 
AT91_REG
 
	mRerved1
[4];

1223 
AT91S_TC
 
	mTCB_TC2
;

1224 
AT91_REG
 
	mRerved2
[4];

1225 
AT91_REG
 
	mTCB_BCR
;

1226 
AT91_REG
 
	mTCB_BMR
;

1227 } 
	tAT91S_TCB
,

1228 *
	tAT91PS_TCB
;

1231 
	#AT91C_TCB_SYNC
 ((0x1 << 0

	)

1233 
	#AT91C_TCB_TC0XC0S
 ((0x3 << 0

	)

1234 
	#AT91C_TCB_TC0XC0S_TCLK0
 ((0x0

	)

1235 
	#AT91C_TCB_TC0XC0S_NONE
 ((0x1

	)

1236 
	#AT91C_TCB_TC0XC0S_TIOA1
 ((0x2

	)

1237 
	#AT91C_TCB_TC0XC0S_TIOA2
 ((0x3

	)

1238 
	#AT91C_TCB_TC1XC1S
 ((0x3 << 2

	)

1239 
	#AT91C_TCB_TC1XC1S_TCLK1
 ((0x0 << 2

	)

1240 
	#AT91C_TCB_TC1XC1S_NONE
 ((0x1 << 2

	)

1241 
	#AT91C_TCB_TC1XC1S_TIOA0
 ((0x2 << 2

	)

1242 
	#AT91C_TCB_TC1XC1S_TIOA2
 ((0x3 << 2

	)

1243 
	#AT91C_TCB_TC2XC2S
 ((0x3 << 4

	)

1244 
	#AT91C_TCB_TC2XC2S_TCLK2
 ((0x0 << 4

	)

1245 
	#AT91C_TCB_TC2XC2S_NONE
 ((0x1 << 4

	)

1246 
	#AT91C_TCB_TC2XC2S_TIOA0
 ((0x2 << 4

	)

1247 
	#AT91C_TCB_TC2XC2S_TIOA1
 ((0x3 << 4

	)

1252 
	s_AT91S_PWMC_CH
 {

1253 
AT91_REG
 
	mPWMC_CMR
;

1254 
AT91_REG
 
	mPWMC_CDTYR
;

1255 
AT91_REG
 
	mPWMC_CPRDR
;

1256 
AT91_REG
 
	mPWMC_CCNTR
;

1257 
AT91_REG
 
	mPWMC_CUPDR
;

1258 
AT91_REG
 
	mPWMC_Rerved
[3];

1259 } 
	tAT91S_PWMC_CH
,

1260 *
	tAT91PS_PWMC_CH
;

1263 
	#AT91C_PWMC_CPRE
 ((0xF << 0

	)

1264 
	#AT91C_PWMC_CPRE_MCK
 ((0x0

	)

1265 
	#AT91C_PWMC_CPRE_MCKA
 ((0xB

	)

1266 
	#AT91C_PWMC_CPRE_MCKB
 ((0xC

	)

1267 
	#AT91C_PWMC_CALG
 ((0x1 << 8

	)

1268 
	#AT91C_PWMC_CPOL
 ((0x1 << 9

	)

1269 
	#AT91C_PWMC_CPD
 ((0x1 << 10

	)

1271 
	#AT91C_PWMC_CDTY
 ((0x0 << 0

	)

1273 
	#AT91C_PWMC_CPRD
 ((0x0 << 0

	)

1275 
	#AT91C_PWMC_CCNT
 ((0x0 << 0

	)

1277 
	#AT91C_PWMC_CUPD
 ((0x0 << 0

	)

1282 
	s_AT91S_PWMC
 {

1283 
AT91_REG
 
	mPWMC_MR
;

1284 
AT91_REG
 
	mPWMC_ENA
;

1285 
AT91_REG
 
	mPWMC_DIS
;

1286 
AT91_REG
 
	mPWMC_SR
;

1287 
AT91_REG
 
	mPWMC_IER
;

1288 
AT91_REG
 
	mPWMC_IDR
;

1289 
AT91_REG
 
	mPWMC_IMR
;

1290 
AT91_REG
 
	mPWMC_ISR
;

1291 
AT91_REG
 
	mRerved0
[55];

1292 
AT91_REG
 
	mPWMC_VR
;

1293 
AT91_REG
 
	mRerved1
[64];

1294 
AT91S_PWMC_CH
 
	mPWMC_CH
[32];

1295 } 
	tAT91S_PWMC
,

1296 *
	tAT91PS_PWMC
;

1299 
	#AT91C_PWMC_DIVA
 ((0xFF << 0

	)

1300 
	#AT91C_PWMC_PREA
 ((0xF << 8

	)

1301 
	#AT91C_PWMC_PREA_MCK
 ((0x0 << 8

	)

1302 
	#AT91C_PWMC_DIVB
 ((0xFF << 16

	)

1303 
	#AT91C_PWMC_PREB
 ((0xF << 24

	)

1304 
	#AT91C_PWMC_PREB_MCK
 ((0x0 << 24

	)

1306 
	#AT91C_PWMC_CHID0
 ((0x1 << 0

	)

1307 
	#AT91C_PWMC_CHID1
 ((0x1 << 1

	)

1308 
	#AT91C_PWMC_CHID2
 ((0x1 << 2

	)

1309 
	#AT91C_PWMC_CHID3
 ((0x1 << 3

	)

1310 
	#AT91C_PWMC_CHID4
 ((0x1 << 4

	)

1311 
	#AT91C_PWMC_CHID5
 ((0x1 << 5

	)

1312 
	#AT91C_PWMC_CHID6
 ((0x1 << 6

	)

1313 
	#AT91C_PWMC_CHID7
 ((0x1 << 7

	)

1324 
	s_AT91S_UDP
 {

1325 
AT91_REG
 
	mUDP_NUM
;

1326 
AT91_REG
 
	mUDP_GLBSTATE
;

1327 
AT91_REG
 
	mUDP_FADDR
;

1328 
AT91_REG
 
	mRerved0
[1];

1329 
AT91_REG
 
	mUDP_IER
;

1330 
AT91_REG
 
	mUDP_IDR
;

1331 
AT91_REG
 
	mUDP_IMR
;

1332 
AT91_REG
 
	mUDP_ISR
;

1333 
AT91_REG
 
	mUDP_ICR
;

1334 
AT91_REG
 
	mRerved1
[1];

1335 
AT91_REG
 
	mUDP_RSTEP
;

1336 
AT91_REG
 
	mRerved2
[1];

1337 
AT91_REG
 
	mUDP_CSR
[8];

1338 
AT91_REG
 
	mUDP_FDR
[8];

1339 
AT91_REG
 
	mRerved3
[1];

1340 
AT91_REG
 
	mUDP_TXVC
;

1341 } 
	tAT91S_UDP
,

1342 *
	tAT91PS_UDP
;

1345 
	#AT91C_UDP_FRM_NUM
 ((0x7FF << 0

	)

1346 
	#AT91C_UDP_FRM_ERR
 ((0x1 << 16

	)

1347 
	#AT91C_UDP_FRM_OK
 ((0x1 << 17

	)

1349 
	#AT91C_UDP_FADDEN
 ((0x1 << 0

	)

1350 
	#AT91C_UDP_CONFG
 ((0x1 << 1

	)

1351 
	#AT91C_UDP_ESR
 ((0x1 << 2

	)

1352 
	#AT91C_UDP_RSMINPR
 ((0x1 << 3

	)

1353 
	#AT91C_UDP_RMWUPE
 ((0x1 << 4

	)

1355 
	#AT91C_UDP_FADD
 ((0xFF << 0

	)

1356 
	#AT91C_UDP_FEN
 ((0x1 << 8

	)

1358 
	#AT91C_UDP_EPINT0
 ((0x1 << 0

	)

1359 
	#AT91C_UDP_EPINT1
 ((0x1 << 1

	)

1360 
	#AT91C_UDP_EPINT2
 ((0x1 << 2

	)

1361 
	#AT91C_UDP_EPINT3
 ((0x1 << 3

	)

1362 
	#AT91C_UDP_EPINT4
 ((0x1 << 4

	)

1363 
	#AT91C_UDP_EPINT5
 ((0x1 << 5

	)

1364 
	#AT91C_UDP_EPINT6
 ((0x1 << 6

	)

1365 
	#AT91C_UDP_EPINT7
 ((0x1 << 7

	)

1366 
	#AT91C_UDP_RXSUSP
 ((0x1 << 8

	)

1367 
	#AT91C_UDP_RXRSM
 ((0x1 << 9

	)

1368 
	#AT91C_UDP_EXTRSM
 ((0x1 << 10

	)

1369 
	#AT91C_UDP_SOFINT
 ((0x1 << 11

	)

1370 
	#AT91C_UDP_WAKEUP
 ((0x1 << 13

	)

1374 
	#AT91C_UDP_ENDBUSRES
 ((0x1 << 12

	)

1377 
	#AT91C_UDP_EP0
 ((0x1 << 0

	)

1378 
	#AT91C_UDP_EP1
 ((0x1 << 1

	)

1379 
	#AT91C_UDP_EP2
 ((0x1 << 2

	)

1380 
	#AT91C_UDP_EP3
 ((0x1 << 3

	)

1381 
	#AT91C_UDP_EP4
 ((0x1 << 4

	)

1382 
	#AT91C_UDP_EP5
 ((0x1 << 5

	)

1383 
	#AT91C_UDP_EP6
 ((0x1 << 6

	)

1384 
	#AT91C_UDP_EP7
 ((0x1 << 7

	)

1386 
	#AT91C_UDP_TXCOMP
 ((0x1 << 0

	)

1387 
	#AT91C_UDP_RX_DATA_BK0
 ((0x1 << 1

	)

1388 
	#AT91C_UDP_RXSETUP
 ((0x1 << 2

	)

1389 
	#AT91C_UDP_ISOERROR
 ((0x1 << 3

	)

1390 
	#AT91C_UDP_TXPKTRDY
 ((0x1 << 4

	)

1391 
	#AT91C_UDP_FORCESTALL
 ((0x1 << 5

	)

1392 
	#AT91C_UDP_RX_DATA_BK1
 ((0x1 << 6

	)

1393 
	#AT91C_UDP_DIR
 ((0x1 << 7

	)

1394 
	#AT91C_UDP_EPTYPE
 ((0x7 << 8

	)

1395 
	#AT91C_UDP_EPTYPE_CTRL
 ((0x0 << 8

	)

1396 
	#AT91C_UDP_EPTYPE_ISO_OUT
 ((0x1 << 8

	)

1397 
	#AT91C_UDP_EPTYPE_BULK_OUT
 ((0x2 << 8

	)

1398 
	#AT91C_UDP_EPTYPE_INT_OUT
 ((0x3 << 8

	)

1399 
	#AT91C_UDP_EPTYPE_ISO_IN
 ((0x5 << 8

	)

1400 
	#AT91C_UDP_EPTYPE_BULK_IN
 ((0x6 << 8

	)

1401 
	#AT91C_UDP_EPTYPE_INT_IN
 ((0x7 << 8

	)

1402 
	#AT91C_UDP_DTGLE
 ((0x1 << 11

	)

1403 
	#AT91C_UDP_EPEDS
 ((0x1 << 15

	)

1404 
	#AT91C_UDP_RXBYTECNT
 ((0x7FF << 16

	)

1406 
	#AT91C_UDP_TXVDIS
 ((0x1 << 8

	)

1407 
	#AT91C_UDP_PUON
 ((0x1 << 9

	)

1414 
	#AT91C_AIC_IVR
 ((
AT91_REG
 *0xFFFFF100

	)

1415 
	#AT91C_AIC_SMR
 ((
AT91_REG
 *0xFFFFF000

	)

1416 
	#AT91C_AIC_FVR
 ((
AT91_REG
 *0xFFFFF104

	)

1417 
	#AT91C_AIC_DCR
 ((
AT91_REG
 *0xFFFFF138

	)

1418 
	#AT91C_AIC_EOICR
 ((
AT91_REG
 *0xFFFFF130

	)

1419 
	#AT91C_AIC_SVR
 ((
AT91_REG
 *0xFFFFF080

	)

1420 
	#AT91C_AIC_FFSR
 ((
AT91_REG
 *0xFFFFF148

	)

1421 
	#AT91C_AIC_ICCR
 ((
AT91_REG
 *0xFFFFF128

	)

1422 
	#AT91C_AIC_ISR
 ((
AT91_REG
 *0xFFFFF108

	)

1423 
	#AT91C_AIC_IMR
 ((
AT91_REG
 *0xFFFFF110

	)

1424 
	#AT91C_AIC_IPR
 ((
AT91_REG
 *0xFFFFF10C

	)

1425 
	#AT91C_AIC_FFER
 ((
AT91_REG
 *0xFFFFF140

	)

1426 
	#AT91C_AIC_IECR
 ((
AT91_REG
 *0xFFFFF120

	)

1427 
	#AT91C_AIC_ISCR
 ((
AT91_REG
 *0xFFFFF12C

	)

1428 
	#AT91C_AIC_FFDR
 ((
AT91_REG
 *0xFFFFF144

	)

1429 
	#AT91C_AIC_CISR
 ((
AT91_REG
 *0xFFFFF114

	)

1430 
	#AT91C_AIC_IDCR
 ((
AT91_REG
 *0xFFFFF124

	)

1431 
	#AT91C_AIC_SPU
 ((
AT91_REG
 *0xFFFFF134

	)

1433 
	#AT91C_DBGU_TCR
 ((
AT91_REG
 *0xFFFFF30C

	)

1434 
	#AT91C_DBGU_RNPR
 ((
AT91_REG
 *0xFFFFF310

	)

1435 
	#AT91C_DBGU_TNPR
 ((
AT91_REG
 *0xFFFFF318

	)

1436 
	#AT91C_DBGU_TPR
 ((
AT91_REG
 *0xFFFFF308

	)

1437 
	#AT91C_DBGU_RPR
 ((
AT91_REG
 *0xFFFFF300

	)

1438 
	#AT91C_DBGU_RCR
 ((
AT91_REG
 *0xFFFFF304

	)

1439 
	#AT91C_DBGU_RNCR
 ((
AT91_REG
 *0xFFFFF314

	)

1440 
	#AT91C_DBGU_PTCR
 ((
AT91_REG
 *0xFFFFF320

	)

1441 
	#AT91C_DBGU_PTSR
 ((
AT91_REG
 *0xFFFFF324

	)

1442 
	#AT91C_DBGU_TNCR
 ((
AT91_REG
 *0xFFFFF31C

	)

1444 
	#AT91C_DBGU_EXID
 ((
AT91_REG
 *0xFFFFF244

	)

1445 
	#AT91C_DBGU_BRGR
 ((
AT91_REG
 *0xFFFFF220

	)

1446 
	#AT91C_DBGU_IDR
 ((
AT91_REG
 *0xFFFFF20C

	)

1447 
	#AT91C_DBGU_CSR
 ((
AT91_REG
 *0xFFFFF214

	)

1448 
	#AT91C_DBGU_CIDR
 ((
AT91_REG
 *0xFFFFF240

	)

1449 
	#AT91C_DBGU_MR
 ((
AT91_REG
 *0xFFFFF204

	)

1450 
	#AT91C_DBGU_IMR
 ((
AT91_REG
 *0xFFFFF210

	)

1451 
	#AT91C_DBGU_CR
 ((
AT91_REG
 *0xFFFFF200

	)

1452 
	#AT91C_DBGU_FNTR
 ((
AT91_REG
 *0xFFFFF248

	)

1453 
	#AT91C_DBGU_THR
 ((
AT91_REG
 *0xFFFFF21C

	)

1454 
	#AT91C_DBGU_RHR
 ((
AT91_REG
 *0xFFFFF218

	)

1455 
	#AT91C_DBGU_IER
 ((
AT91_REG
 *0xFFFFF208

	)

1457 
	#AT91C_PIOA_ODR
 ((
AT91_REG
 *0xFFFFF414

	)

1458 
	#AT91C_PIOA_SODR
 ((
AT91_REG
 *0xFFFFF430

	)

1459 
	#AT91C_PIOA_ISR
 ((
AT91_REG
 *0xFFFFF44C

	)

1460 
	#AT91C_PIOA_ABSR
 ((
AT91_REG
 *0xFFFFF478

	)

1461 
	#AT91C_PIOA_IER
 ((
AT91_REG
 *0xFFFFF440

	)

1462 
	#AT91C_PIOA_PPUDR
 ((
AT91_REG
 *0xFFFFF460

	)

1463 
	#AT91C_PIOA_IMR
 ((
AT91_REG
 *0xFFFFF448

	)

1464 
	#AT91C_PIOA_PER
 ((
AT91_REG
 *0xFFFFF400

	)

1465 
	#AT91C_PIOA_IFDR
 ((
AT91_REG
 *0xFFFFF424

	)

1466 
	#AT91C_PIOA_OWDR
 ((
AT91_REG
 *0xFFFFF4A4

	)

1467 
	#AT91C_PIOA_MDSR
 ((
AT91_REG
 *0xFFFFF458

	)

1468 
	#AT91C_PIOA_IDR
 ((
AT91_REG
 *0xFFFFF444

	)

1469 
	#AT91C_PIOA_ODSR
 ((
AT91_REG
 *0xFFFFF438

	)

1470 
	#AT91C_PIOA_PPUSR
 ((
AT91_REG
 *0xFFFFF468

	)

1471 
	#AT91C_PIOA_OWSR
 ((
AT91_REG
 *0xFFFFF4A8

	)

1472 
	#AT91C_PIOA_BSR
 ((
AT91_REG
 *0xFFFFF474

	)

1473 
	#AT91C_PIOA_OWER
 ((
AT91_REG
 *0xFFFFF4A0

	)

1474 
	#AT91C_PIOA_IFER
 ((
AT91_REG
 *0xFFFFF420

	)

1475 
	#AT91C_PIOA_PDSR
 ((
AT91_REG
 *0xFFFFF43C

	)

1476 
	#AT91C_PIOA_PPUER
 ((
AT91_REG
 *0xFFFFF464

	)

1477 
	#AT91C_PIOA_OSR
 ((
AT91_REG
 *0xFFFFF418

	)

1478 
	#AT91C_PIOA_ASR
 ((
AT91_REG
 *0xFFFFF470

	)

1479 
	#AT91C_PIOA_MDDR
 ((
AT91_REG
 *0xFFFFF454

	)

1480 
	#AT91C_PIOA_CODR
 ((
AT91_REG
 *0xFFFFF434

	)

1481 
	#AT91C_PIOA_MDER
 ((
AT91_REG
 *0xFFFFF450

	)

1482 
	#AT91C_PIOA_PDR
 ((
AT91_REG
 *0xFFFFF404

	)

1483 
	#AT91C_PIOA_IFSR
 ((
AT91_REG
 *0xFFFFF428

	)

1484 
	#AT91C_PIOA_OER
 ((
AT91_REG
 *0xFFFFF410

	)

1485 
	#AT91C_PIOA_PSR
 ((
AT91_REG
 *0xFFFFF408

	)

1487 
	#AT91C_CKGR_MOR
 ((
AT91_REG
 *0xFFFFFC20

	)

1488 
	#AT91C_CKGR_PLLR
 ((
AT91_REG
 *0xFFFFFC2C

	)

1489 
	#AT91C_CKGR_MCFR
 ((
AT91_REG
 *0xFFFFFC24

	)

1491 
	#AT91C_PMC_IDR
 ((
AT91_REG
 *0xFFFFFC64

	)

1492 
	#AT91C_PMC_MOR
 ((
AT91_REG
 *0xFFFFFC20

	)

1493 
	#AT91C_PMC_PLLR
 ((
AT91_REG
 *0xFFFFFC2C

	)

1494 
	#AT91C_PMC_PCER
 ((
AT91_REG
 *0xFFFFFC10

	)

1495 
	#AT91C_PMC_PCKR
 ((
AT91_REG
 *0xFFFFFC40

	)

1496 
	#AT91C_PMC_MCKR
 ((
AT91_REG
 *0xFFFFFC30

	)

1497 
	#AT91C_PMC_SCDR
 ((
AT91_REG
 *0xFFFFFC04

	)

1498 
	#AT91C_PMC_PCDR
 ((
AT91_REG
 *0xFFFFFC14

	)

1499 
	#AT91C_PMC_SCSR
 ((
AT91_REG
 *0xFFFFFC08

	)

1500 
	#AT91C_PMC_PCSR
 ((
AT91_REG
 *0xFFFFFC18

	)

1501 
	#AT91C_PMC_MCFR
 ((
AT91_REG
 *0xFFFFFC24

	)

1502 
	#AT91C_PMC_SCER
 ((
AT91_REG
 *0xFFFFFC00

	)

1503 
	#AT91C_PMC_IMR
 ((
AT91_REG
 *0xFFFFFC6C

	)

1504 
	#AT91C_PMC_IER
 ((
AT91_REG
 *0xFFFFFC60

	)

1505 
	#AT91C_PMC_SR
 ((
AT91_REG
 *0xFFFFFC68

	)

1507 
	#AT91C_RSTC_RCR
 ((
AT91_REG
 *0xFFFFFD00

	)

1508 
	#AT91C_RSTC_RMR
 ((
AT91_REG
 *0xFFFFFD08

	)

1509 
	#AT91C_RSTC_RSR
 ((
AT91_REG
 *0xFFFFFD04

	)

1511 
	#AT91C_RTTC_RTSR
 ((
AT91_REG
 *0xFFFFFD2C

	)

1512 
	#AT91C_RTTC_RTMR
 ((
AT91_REG
 *0xFFFFFD20

	)

1513 
	#AT91C_RTTC_RTVR
 ((
AT91_REG
 *0xFFFFFD28

	)

1514 
	#AT91C_RTTC_RTAR
 ((
AT91_REG
 *0xFFFFFD24

	)

1516 
	#AT91C_PITC_PIVR
 ((
AT91_REG
 *0xFFFFFD38

	)

1517 
	#AT91C_PITC_PISR
 ((
AT91_REG
 *0xFFFFFD34

	)

1518 
	#AT91C_PITC_PIIR
 ((
AT91_REG
 *0xFFFFFD3C

	)

1519 
	#AT91C_PITC_PIMR
 ((
AT91_REG
 *0xFFFFFD30

	)

1521 
	#AT91C_WDTC_WDCR
 ((
AT91_REG
 *0xFFFFFD40

	)

1522 
	#AT91C_WDTC_WDSR
 ((
AT91_REG
 *0xFFFFFD48

	)

1523 
	#AT91C_WDTC_WDMR
 ((
AT91_REG
 *0xFFFFFD44

	)

1525 
	#AT91C_VREG_MR
 ((
AT91_REG
 *0xFFFFFD60

	)

1527 
	#AT91C_MC_ASR
 ((
AT91_REG
 *0xFFFFFF04

	)

1528 
	#AT91C_MC_RCR
 ((
AT91_REG
 *0xFFFFFF00

	)

1529 
	#AT91C_MC_FCR
 ((
AT91_REG
 *0xFFFFFF64

	)

1530 
	#AT91C_MC_AASR
 ((
AT91_REG
 *0xFFFFFF08

	)

1531 
	#AT91C_MC_FSR
 ((
AT91_REG
 *0xFFFFFF68

	)

1532 
	#AT91C_MC_FMR
 ((
AT91_REG
 *0xFFFFFF60

	)

1534 
	#AT91C_SPI_PTCR
 ((
AT91_REG
 *0xFFFE0120

	)

1535 
	#AT91C_SPI_TPR
 ((
AT91_REG
 *0xFFFE0108

	)

1536 
	#AT91C_SPI_TCR
 ((
AT91_REG
 *0xFFFE010C

	)

1537 
	#AT91C_SPI_RCR
 ((
AT91_REG
 *0xFFFE0104

	)

1538 
	#AT91C_SPI_PTSR
 ((
AT91_REG
 *0xFFFE0124

	)

1539 
	#AT91C_SPI_RNPR
 ((
AT91_REG
 *0xFFFE0110

	)

1540 
	#AT91C_SPI_RPR
 ((
AT91_REG
 *0xFFFE0100

	)

1541 
	#AT91C_SPI_TNCR
 ((
AT91_REG
 *0xFFFE011C

	)

1542 
	#AT91C_SPI_RNCR
 ((
AT91_REG
 *0xFFFE0114

	)

1543 
	#AT91C_SPI_TNPR
 ((
AT91_REG
 *0xFFFE0118

	)

1545 
	#AT91C_SPI_IER
 ((
AT91_REG
 *0xFFFE0014

	)

1546 
	#AT91C_SPI_SR
 ((
AT91_REG
 *0xFFFE0010

	)

1547 
	#AT91C_SPI_IDR
 ((
AT91_REG
 *0xFFFE0018

	)

1548 
	#AT91C_SPI_CR
 ((
AT91_REG
 *0xFFFE0000

	)

1549 
	#AT91C_SPI_MR
 ((
AT91_REG
 *0xFFFE0004

	)

1550 
	#AT91C_SPI_IMR
 ((
AT91_REG
 *0xFFFE001C

	)

1551 
	#AT91C_SPI_TDR
 ((
AT91_REG
 *0xFFFE000C

	)

1552 
	#AT91C_SPI_RDR
 ((
AT91_REG
 *0xFFFE0008

	)

1553 
	#AT91C_SPI_CSR
 ((
AT91_REG
 *0xFFFE0030

	)

1555 
	#AT91C_ADC_PTSR
 ((
AT91_REG
 *0xFFFD8124

	)

1556 
	#AT91C_ADC_PTCR
 ((
AT91_REG
 *0xFFFD8120

	)

1557 
	#AT91C_ADC_TNPR
 ((
AT91_REG
 *0xFFFD8118

	)

1558 
	#AT91C_ADC_TNCR
 ((
AT91_REG
 *0xFFFD811C

	)

1559 
	#AT91C_ADC_RNPR
 ((
AT91_REG
 *0xFFFD8110

	)

1560 
	#AT91C_ADC_RNCR
 ((
AT91_REG
 *0xFFFD8114

	)

1561 
	#AT91C_ADC_RPR
 ((
AT91_REG
 *0xFFFD8100

	)

1562 
	#AT91C_ADC_TCR
 ((
AT91_REG
 *0xFFFD810C

	)

1563 
	#AT91C_ADC_TPR
 ((
AT91_REG
 *0xFFFD8108

	)

1564 
	#AT91C_ADC_RCR
 ((
AT91_REG
 *0xFFFD8104

	)

1566 
	#AT91C_ADC_CDR2
 ((
AT91_REG
 *0xFFFD8038

	)

1567 
	#AT91C_ADC_CDR3
 ((
AT91_REG
 *0xFFFD803C

	)

1568 
	#AT91C_ADC_CDR0
 ((
AT91_REG
 *0xFFFD8030

	)

1569 
	#AT91C_ADC_CDR5
 ((
AT91_REG
 *0xFFFD8044

	)

1570 
	#AT91C_ADC_CHDR
 ((
AT91_REG
 *0xFFFD8014

	)

1571 
	#AT91C_ADC_SR
 ((
AT91_REG
 *0xFFFD801C

	)

1572 
	#AT91C_ADC_CDR4
 ((
AT91_REG
 *0xFFFD8040

	)

1573 
	#AT91C_ADC_CDR1
 ((
AT91_REG
 *0xFFFD8034

	)

1574 
	#AT91C_ADC_LCDR
 ((
AT91_REG
 *0xFFFD8020

	)

1575 
	#AT91C_ADC_IDR
 ((
AT91_REG
 *0xFFFD8028

	)

1576 
	#AT91C_ADC_CR
 ((
AT91_REG
 *0xFFFD8000

	)

1577 
	#AT91C_ADC_CDR7
 ((
AT91_REG
 *0xFFFD804C

	)

1578 
	#AT91C_ADC_CDR6
 ((
AT91_REG
 *0xFFFD8048

	)

1579 
	#AT91C_ADC_IER
 ((
AT91_REG
 *0xFFFD8024

	)

1580 
	#AT91C_ADC_CHER
 ((
AT91_REG
 *0xFFFD8010

	)

1581 
	#AT91C_ADC_CHSR
 ((
AT91_REG
 *0xFFFD8018

	)

1582 
	#AT91C_ADC_MR
 ((
AT91_REG
 *0xFFFD8004

	)

1583 
	#AT91C_ADC_IMR
 ((
AT91_REG
 *0xFFFD802C

	)

1585 
	#AT91C_SSC_TNCR
 ((
AT91_REG
 *0xFFFD411C

	)

1586 
	#AT91C_SSC_RPR
 ((
AT91_REG
 *0xFFFD4100

	)

1587 
	#AT91C_SSC_RNCR
 ((
AT91_REG
 *0xFFFD4114

	)

1588 
	#AT91C_SSC_TPR
 ((
AT91_REG
 *0xFFFD4108

	)

1589 
	#AT91C_SSC_PTCR
 ((
AT91_REG
 *0xFFFD4120

	)

1590 
	#AT91C_SSC_TCR
 ((
AT91_REG
 *0xFFFD410C

	)

1591 
	#AT91C_SSC_RCR
 ((
AT91_REG
 *0xFFFD4104

	)

1592 
	#AT91C_SSC_RNPR
 ((
AT91_REG
 *0xFFFD4110

	)

1593 
	#AT91C_SSC_TNPR
 ((
AT91_REG
 *0xFFFD4118

	)

1594 
	#AT91C_SSC_PTSR
 ((
AT91_REG
 *0xFFFD4124

	)

1596 
	#AT91C_SSC_RHR
 ((
AT91_REG
 *0xFFFD4020

	)

1597 
	#AT91C_SSC_RSHR
 ((
AT91_REG
 *0xFFFD4030

	)

1598 
	#AT91C_SSC_TFMR
 ((
AT91_REG
 *0xFFFD401C

	)

1599 
	#AT91C_SSC_IDR
 ((
AT91_REG
 *0xFFFD4048

	)

1600 
	#AT91C_SSC_THR
 ((
AT91_REG
 *0xFFFD4024

	)

1601 
	#AT91C_SSC_RCMR
 ((
AT91_REG
 *0xFFFD4010

	)

1602 
	#AT91C_SSC_IER
 ((
AT91_REG
 *0xFFFD4044

	)

1603 
	#AT91C_SSC_TSHR
 ((
AT91_REG
 *0xFFFD4034

	)

1604 
	#AT91C_SSC_SR
 ((
AT91_REG
 *0xFFFD4040

	)

1605 
	#AT91C_SSC_CMR
 ((
AT91_REG
 *0xFFFD4004

	)

1606 
	#AT91C_SSC_TCMR
 ((
AT91_REG
 *0xFFFD4018

	)

1607 
	#AT91C_SSC_CR
 ((
AT91_REG
 *0xFFFD4000

	)

1608 
	#AT91C_SSC_IMR
 ((
AT91_REG
 *0xFFFD404C

	)

1609 
	#AT91C_SSC_RFMR
 ((
AT91_REG
 *0xFFFD4014

	)

1611 
	#AT91C_US1_RNCR
 ((
AT91_REG
 *0xFFFC4114

	)

1612 
	#AT91C_US1_PTCR
 ((
AT91_REG
 *0xFFFC4120

	)

1613 
	#AT91C_US1_TCR
 ((
AT91_REG
 *0xFFFC410C

	)

1614 
	#AT91C_US1_PTSR
 ((
AT91_REG
 *0xFFFC4124

	)

1615 
	#AT91C_US1_TNPR
 ((
AT91_REG
 *0xFFFC4118

	)

1616 
	#AT91C_US1_RCR
 ((
AT91_REG
 *0xFFFC4104

	)

1617 
	#AT91C_US1_RNPR
 ((
AT91_REG
 *0xFFFC4110

	)

1618 
	#AT91C_US1_RPR
 ((
AT91_REG
 *0xFFFC4100

	)

1619 
	#AT91C_US1_TNCR
 ((
AT91_REG
 *0xFFFC411C

	)

1620 
	#AT91C_US1_TPR
 ((
AT91_REG
 *0xFFFC4108

	)

1622 
	#AT91C_US1_IF
 ((
AT91_REG
 *0xFFFC404C

	)

1623 
	#AT91C_US1_NER
 ((
AT91_REG
 *0xFFFC4044

	)

1624 
	#AT91C_US1_RTOR
 ((
AT91_REG
 *0xFFFC4024

	)

1625 
	#AT91C_US1_CSR
 ((
AT91_REG
 *0xFFFC4014

	)

1626 
	#AT91C_US1_IDR
 ((
AT91_REG
 *0xFFFC400C

	)

1627 
	#AT91C_US1_IER
 ((
AT91_REG
 *0xFFFC4008

	)

1628 
	#AT91C_US1_THR
 ((
AT91_REG
 *0xFFFC401C

	)

1629 
	#AT91C_US1_TTGR
 ((
AT91_REG
 *0xFFFC4028

	)

1630 
	#AT91C_US1_RHR
 ((
AT91_REG
 *0xFFFC4018

	)

1631 
	#AT91C_US1_BRGR
 ((
AT91_REG
 *0xFFFC4020

	)

1632 
	#AT91C_US1_IMR
 ((
AT91_REG
 *0xFFFC4010

	)

1633 
	#AT91C_US1_FIDI
 ((
AT91_REG
 *0xFFFC4040

	)

1634 
	#AT91C_US1_CR
 ((
AT91_REG
 *0xFFFC4000

	)

1635 
	#AT91C_US1_MR
 ((
AT91_REG
 *0xFFFC4004

	)

1637 
	#AT91C_US0_TNPR
 ((
AT91_REG
 *0xFFFC0118

	)

1638 
	#AT91C_US0_RNPR
 ((
AT91_REG
 *0xFFFC0110

	)

1639 
	#AT91C_US0_TCR
 ((
AT91_REG
 *0xFFFC010C

	)

1640 
	#AT91C_US0_PTCR
 ((
AT91_REG
 *0xFFFC0120

	)

1641 
	#AT91C_US0_PTSR
 ((
AT91_REG
 *0xFFFC0124

	)

1642 
	#AT91C_US0_TNCR
 ((
AT91_REG
 *0xFFFC011C

	)

1643 
	#AT91C_US0_TPR
 ((
AT91_REG
 *0xFFFC0108

	)

1644 
	#AT91C_US0_RCR
 ((
AT91_REG
 *0xFFFC0104

	)

1645 
	#AT91C_US0_RPR
 ((
AT91_REG
 *0xFFFC0100

	)

1646 
	#AT91C_US0_RNCR
 ((
AT91_REG
 *0xFFFC0114

	)

1648 
	#AT91C_US0_BRGR
 ((
AT91_REG
 *0xFFFC0020

	)

1649 
	#AT91C_US0_NER
 ((
AT91_REG
 *0xFFFC0044

	)

1650 
	#AT91C_US0_CR
 ((
AT91_REG
 *0xFFFC0000

	)

1651 
	#AT91C_US0_IMR
 ((
AT91_REG
 *0xFFFC0010

	)

1652 
	#AT91C_US0_FIDI
 ((
AT91_REG
 *0xFFFC0040

	)

1653 
	#AT91C_US0_TTGR
 ((
AT91_REG
 *0xFFFC0028

	)

1654 
	#AT91C_US0_MR
 ((
AT91_REG
 *0xFFFC0004

	)

1655 
	#AT91C_US0_RTOR
 ((
AT91_REG
 *0xFFFC0024

	)

1656 
	#AT91C_US0_CSR
 ((
AT91_REG
 *0xFFFC0014

	)

1657 
	#AT91C_US0_RHR
 ((
AT91_REG
 *0xFFFC0018

	)

1658 
	#AT91C_US0_IDR
 ((
AT91_REG
 *0xFFFC000C

	)

1659 
	#AT91C_US0_THR
 ((
AT91_REG
 *0xFFFC001C

	)

1660 
	#AT91C_US0_IF
 ((
AT91_REG
 *0xFFFC004C

	)

1661 
	#AT91C_US0_IER
 ((
AT91_REG
 *0xFFFC0008

	)

1663 
	#AT91C_TWI_IER
 ((
AT91_REG
 *0xFFFB8024

	)

1664 
	#AT91C_TWI_CR
 ((
AT91_REG
 *0xFFFB8000

	)

1665 
	#AT91C_TWI_SR
 ((
AT91_REG
 *0xFFFB8020

	)

1666 
	#AT91C_TWI_IMR
 ((
AT91_REG
 *0xFFFB802C

	)

1667 
	#AT91C_TWI_THR
 ((
AT91_REG
 *0xFFFB8034

	)

1668 
	#AT91C_TWI_IDR
 ((
AT91_REG
 *0xFFFB8028

	)

1669 
	#AT91C_TWI_IADR
 ((
AT91_REG
 *0xFFFB800C

	)

1670 
	#AT91C_TWI_MMR
 ((
AT91_REG
 *0xFFFB8004

	)

1671 
	#AT91C_TWI_CWGR
 ((
AT91_REG
 *0xFFFB8010

	)

1672 
	#AT91C_TWI_RHR
 ((
AT91_REG
 *0xFFFB8030

	)

1674 
	#AT91C_TC0_SR
 ((
AT91_REG
 *0xFFFA0020

	)

1675 
	#AT91C_TC0_RC
 ((
AT91_REG
 *0xFFFA001C

	)

1676 
	#AT91C_TC0_RB
 ((
AT91_REG
 *0xFFFA0018

	)

1677 
	#AT91C_TC0_CCR
 ((
AT91_REG
 *0xFFFA0000

	)

1678 
	#AT91C_TC0_CMR
 ((
AT91_REG
 *0xFFFA0004

	)

1679 
	#AT91C_TC0_IER
 ((
AT91_REG
 *0xFFFA0024

	)

1680 
	#AT91C_TC0_RA
 ((
AT91_REG
 *0xFFFA0014

	)

1681 
	#AT91C_TC0_IDR
 ((
AT91_REG
 *0xFFFA0028

	)

1682 
	#AT91C_TC0_CV
 ((
AT91_REG
 *0xFFFA0010

	)

1683 
	#AT91C_TC0_IMR
 ((
AT91_REG
 *0xFFFA002C

	)

1685 
	#AT91C_TC1_RB
 ((
AT91_REG
 *0xFFFA0058

	)

1686 
	#AT91C_TC1_CCR
 ((
AT91_REG
 *0xFFFA0040

	)

1687 
	#AT91C_TC1_IER
 ((
AT91_REG
 *0xFFFA0064

	)

1688 
	#AT91C_TC1_IDR
 ((
AT91_REG
 *0xFFFA0068

	)

1689 
	#AT91C_TC1_SR
 ((
AT91_REG
 *0xFFFA0060

	)

1690 
	#AT91C_TC1_CMR
 ((
AT91_REG
 *0xFFFA0044

	)

1691 
	#AT91C_TC1_RA
 ((
AT91_REG
 *0xFFFA0054

	)

1692 
	#AT91C_TC1_RC
 ((
AT91_REG
 *0xFFFA005C

	)

1693 
	#AT91C_TC1_IMR
 ((
AT91_REG
 *0xFFFA006C

	)

1694 
	#AT91C_TC1_CV
 ((
AT91_REG
 *0xFFFA0050

	)

1696 
	#AT91C_TC2_CMR
 ((
AT91_REG
 *0xFFFA0084

	)

1697 
	#AT91C_TC2_CCR
 ((
AT91_REG
 *0xFFFA0080

	)

1698 
	#AT91C_TC2_CV
 ((
AT91_REG
 *0xFFFA0090

	)

1699 
	#AT91C_TC2_RA
 ((
AT91_REG
 *0xFFFA0094

	)

1700 
	#AT91C_TC2_RB
 ((
AT91_REG
 *0xFFFA0098

	)

1701 
	#AT91C_TC2_IDR
 ((
AT91_REG
 *0xFFFA00A8

	)

1702 
	#AT91C_TC2_IMR
 ((
AT91_REG
 *0xFFFA00AC

	)

1703 
	#AT91C_TC2_RC
 ((
AT91_REG
 *0xFFFA009C

	)

1704 
	#AT91C_TC2_IER
 ((
AT91_REG
 *0xFFFA00A4

	)

1705 
	#AT91C_TC2_SR
 ((
AT91_REG
 *0xFFFA00A0

	)

1707 
	#AT91C_TCB_BMR
 ((
AT91_REG
 *0xFFFA00C4

	)

1708 
	#AT91C_TCB_BCR
 ((
AT91_REG
 *0xFFFA00C0

	)

1710 
	#AT91C_PWMC_CH3_CUPDR
 ((
AT91_REG
 *0xFFFCC270

	)

1711 
	#AT91C_PWMC_CH3_Rerved
 ((
AT91_REG
 *0xFFFCC274

	)

1712 
	#AT91C_PWMC_CH3_CPRDR
 ((
AT91_REG
 *0xFFFCC268

	)

1713 
	#AT91C_PWMC_CH3_CDTYR
 ((
AT91_REG
 *0xFFFCC264

	)

1714 
	#AT91C_PWMC_CH3_CCNTR
 ((
AT91_REG
 *0xFFFCC26C

	)

1715 
	#AT91C_PWMC_CH3_CMR
 ((
AT91_REG
 *0xFFFCC260

	)

1717 
	#AT91C_PWMC_CH2_Rerved
 ((
AT91_REG
 *0xFFFCC254

	)

1718 
	#AT91C_PWMC_CH2_CMR
 ((
AT91_REG
 *0xFFFCC240

	)

1719 
	#AT91C_PWMC_CH2_CCNTR
 ((
AT91_REG
 *0xFFFCC24C

	)

1720 
	#AT91C_PWMC_CH2_CPRDR
 ((
AT91_REG
 *0xFFFCC248

	)

1721 
	#AT91C_PWMC_CH2_CUPDR
 ((
AT91_REG
 *0xFFFCC250

	)

1722 
	#AT91C_PWMC_CH2_CDTYR
 ((
AT91_REG
 *0xFFFCC244

	)

1724 
	#AT91C_PWMC_CH1_Rerved
 ((
AT91_REG
 *0xFFFCC234

	)

1725 
	#AT91C_PWMC_CH1_CUPDR
 ((
AT91_REG
 *0xFFFCC230

	)

1726 
	#AT91C_PWMC_CH1_CPRDR
 ((
AT91_REG
 *0xFFFCC228

	)

1727 
	#AT91C_PWMC_CH1_CCNTR
 ((
AT91_REG
 *0xFFFCC22C

	)

1728 
	#AT91C_PWMC_CH1_CDTYR
 ((
AT91_REG
 *0xFFFCC224

	)

1729 
	#AT91C_PWMC_CH1_CMR
 ((
AT91_REG
 *0xFFFCC220

	)

1731 
	#AT91C_PWMC_CH0_Rerved
 ((
AT91_REG
 *0xFFFCC214

	)

1732 
	#AT91C_PWMC_CH0_CPRDR
 ((
AT91_REG
 *0xFFFCC208

	)

1733 
	#AT91C_PWMC_CH0_CDTYR
 ((
AT91_REG
 *0xFFFCC204

	)

1734 
	#AT91C_PWMC_CH0_CMR
 ((
AT91_REG
 *0xFFFCC200

	)

1735 
	#AT91C_PWMC_CH0_CUPDR
 ((
AT91_REG
 *0xFFFCC210

	)

1736 
	#AT91C_PWMC_CH0_CCNTR
 ((
AT91_REG
 *0xFFFCC20C

	)

1738 
	#AT91C_PWMC_IDR
 ((
AT91_REG
 *0xFFFCC014

	)

1739 
	#AT91C_PWMC_DIS
 ((
AT91_REG
 *0xFFFCC008

	)

1740 
	#AT91C_PWMC_IER
 ((
AT91_REG
 *0xFFFCC010

	)

1741 
	#AT91C_PWMC_VR
 ((
AT91_REG
 *0xFFFCC0FC

	)

1742 
	#AT91C_PWMC_ISR
 ((
AT91_REG
 *0xFFFCC01C

	)

1743 
	#AT91C_PWMC_SR
 ((
AT91_REG
 *0xFFFCC00C

	)

1744 
	#AT91C_PWMC_IMR
 ((
AT91_REG
 *0xFFFCC018

	)

1745 
	#AT91C_PWMC_MR
 ((
AT91_REG
 *0xFFFCC000

	)

1746 
	#AT91C_PWMC_ENA
 ((
AT91_REG
 *0xFFFCC004

	)

1748 
	#AT91C_UDP_IMR
 ((
AT91_REG
 *0xFFFB0018

	)

1749 
	#AT91C_UDP_FADDR
 ((
AT91_REG
 *0xFFFB0008

	)

1750 
	#AT91C_UDP_NUM
 ((
AT91_REG
 *0xFFFB0000

	)

1751 
	#AT91C_UDP_FDR
 ((
AT91_REG
 *0xFFFB0050

	)

1752 
	#AT91C_UDP_ISR
 ((
AT91_REG
 *0xFFFB001C

	)

1753 
	#AT91C_UDP_CSR
 ((
AT91_REG
 *0xFFFB0030

	)

1754 
	#AT91C_UDP_IDR
 ((
AT91_REG
 *0xFFFB0014

	)

1755 
	#AT91C_UDP_ICR
 ((
AT91_REG
 *0xFFFB0020

	)

1756 
	#AT91C_UDP_RSTEP
 ((
AT91_REG
 *0xFFFB0028

	)

1757 
	#AT91C_UDP_TXVC
 ((
AT91_REG
 *0xFFFB0074

	)

1758 
	#AT91C_UDP_GLBSTATE
 ((
AT91_REG
 *0xFFFB0004

	)

1759 
	#AT91C_UDP_IER
 ((
AT91_REG
 *0xFFFB0010

	)

1764 
	#AT91C_PIO_PA0
 ((1 << 0

	)

1765 
	#AT91C_PA0_PWM0
 ((
AT91C_PIO_PA0


	)

1766 
	#AT91C_PA0_TIOA0
 ((
AT91C_PIO_PA0


	)

1767 
	#AT91C_PIO_PA1
 ((1 << 1

	)

1768 
	#AT91C_PA1_PWM1
 ((
AT91C_PIO_PA1


	)

1769 
	#AT91C_PA1_TIOB0
 ((
AT91C_PIO_PA1


	)

1770 
	#AT91C_PIO_PA10
 ((1 << 10

	)

1771 
	#AT91C_PA10_DTXD
 ((
AT91C_PIO_PA10


	)

1772 
	#AT91C_PA10_NPCS2
 ((
AT91C_PIO_PA10


	)

1773 
	#AT91C_PIO_PA11
 ((1 << 11

	)

1774 
	#AT91C_PA11_NPCS0
 ((
AT91C_PIO_PA11


	)

1775 
	#AT91C_PA11_PWM0
 ((
AT91C_PIO_PA11


	)

1776 
	#AT91C_PIO_PA12
 ((1 << 12

	)

1777 
	#AT91C_PA12_MISO
 ((
AT91C_PIO_PA12


	)

1778 
	#AT91C_PA12_PWM1
 ((
AT91C_PIO_PA12


	)

1779 
	#AT91C_PIO_PA13
 ((1 << 13

	)

1780 
	#AT91C_PA13_MOSI
 ((
AT91C_PIO_PA13


	)

1781 
	#AT91C_PA13_PWM2
 ((
AT91C_PIO_PA13


	)

1782 
	#AT91C_PIO_PA14
 ((1 << 14

	)

1783 
	#AT91C_PA14_SPCK
 ((
AT91C_PIO_PA14


	)

1784 
	#AT91C_PA14_PWM3
 ((
AT91C_PIO_PA14


	)

1785 
	#AT91C_PIO_PA15
 ((1 << 15

	)

1786 
	#AT91C_PA15_TF
 ((
AT91C_PIO_PA15


	)

1787 
	#AT91C_PA15_TIOA1
 ((
AT91C_PIO_PA15


	)

1788 
	#AT91C_PIO_PA16
 ((1 << 16

	)

1789 
	#AT91C_PA16_TK
 ((
AT91C_PIO_PA16


	)

1790 
	#AT91C_PA16_TIOB1
 ((
AT91C_PIO_PA16


	)

1791 
	#AT91C_PIO_PA17
 ((1 << 17

	)

1792 
	#AT91C_PA17_TD
 ((
AT91C_PIO_PA17


	)

1793 
	#AT91C_PA17_PCK1
 ((
AT91C_PIO_PA17


	)

1794 
	#AT91C_PIO_PA18
 ((1 << 18

	)

1795 
	#AT91C_PA18_RD
 ((
AT91C_PIO_PA18


	)

1796 
	#AT91C_PA18_PCK2
 ((
AT91C_PIO_PA18


	)

1797 
	#AT91C_PIO_PA19
 ((1 << 19

	)

1798 
	#AT91C_PA19_RK
 ((
AT91C_PIO_PA19


	)

1799 
	#AT91C_PA19_FIQ
 ((
AT91C_PIO_PA19


	)

1800 
	#AT91C_PIO_PA2
 ((1 << 2

	)

1801 
	#AT91C_PA2_PWM2
 ((
AT91C_PIO_PA2


	)

1802 
	#AT91C_PA2_SCK0
 ((
AT91C_PIO_PA2


	)

1803 
	#AT91C_PIO_PA20
 ((1 << 20

	)

1804 
	#AT91C_PA20_RF
 ((
AT91C_PIO_PA20


	)

1805 
	#AT91C_PA20_IRQ0
 ((
AT91C_PIO_PA20


	)

1806 
	#AT91C_PIO_PA21
 ((1 << 21

	)

1807 
	#AT91C_PA21_RXD1
 ((
AT91C_PIO_PA21


	)

1808 
	#AT91C_PA21_PCK1
 ((
AT91C_PIO_PA21


	)

1809 
	#AT91C_PIO_PA22
 ((1 << 22

	)

1810 
	#AT91C_PA22_TXD1
 ((
AT91C_PIO_PA22


	)

1811 
	#AT91C_PA22_NPCS3
 ((
AT91C_PIO_PA22


	)

1812 
	#AT91C_PIO_PA23
 ((1 << 23

	)

1813 
	#AT91C_PA23_SCK1
 ((
AT91C_PIO_PA23


	)

1814 
	#AT91C_PA23_PWM0
 ((
AT91C_PIO_PA23


	)

1815 
	#AT91C_PIO_PA24
 ((1 << 24

	)

1816 
	#AT91C_PA24_RTS1
 ((
AT91C_PIO_PA24


	)

1817 
	#AT91C_PA24_PWM1
 ((
AT91C_PIO_PA24


	)

1818 
	#AT91C_PIO_PA25
 ((1 << 25

	)

1819 
	#AT91C_PA25_CTS1
 ((
AT91C_PIO_PA25


	)

1820 
	#AT91C_PA25_PWM2
 ((
AT91C_PIO_PA25


	)

1821 
	#AT91C_PIO_PA26
 ((1 << 26

	)

1822 
	#AT91C_PA26_DCD1
 ((
AT91C_PIO_PA26


	)

1823 
	#AT91C_PA26_TIOA2
 ((
AT91C_PIO_PA26


	)

1824 
	#AT91C_PIO_PA27
 ((1 << 27

	)

1825 
	#AT91C_PA27_DTR1
 ((
AT91C_PIO_PA27


	)

1826 
	#AT91C_PA27_TIOB2
 ((
AT91C_PIO_PA27


	)

1827 
	#AT91C_PIO_PA28
 ((1 << 28

	)

1828 
	#AT91C_PA28_DSR1
 ((
AT91C_PIO_PA28


	)

1829 
	#AT91C_PA28_TCLK1
 ((
AT91C_PIO_PA28


	)

1830 
	#AT91C_PIO_PA29
 ((1 << 29

	)

1831 
	#AT91C_PA29_RI1
 ((
AT91C_PIO_PA29


	)

1832 
	#AT91C_PA29_TCLK2
 ((
AT91C_PIO_PA29


	)

1833 
	#AT91C_PIO_PA3
 ((1 << 3

	)

1834 
	#AT91C_PA3_TWD
 ((
AT91C_PIO_PA3


	)

1835 
	#AT91C_PA3_NPCS3
 ((
AT91C_PIO_PA3


	)

1836 
	#AT91C_PIO_PA30
 ((1 << 30

	)

1837 
	#AT91C_PA30_IRQ1
 ((
AT91C_PIO_PA30


	)

1838 
	#AT91C_PA30_NPCS2
 ((
AT91C_PIO_PA30


	)

1839 
	#AT91C_PIO_PA31
 ((1 << 31

	)

1840 
	#AT91C_PA31_NPCS1
 ((
AT91C_PIO_PA31


	)

1841 
	#AT91C_PA31_PCK2
 ((
AT91C_PIO_PA31


	)

1842 
	#AT91C_PIO_PA4
 ((1 << 4

	)

1843 
	#AT91C_PA4_TWCK
 ((
AT91C_PIO_PA4


	)

1844 
	#AT91C_PA4_TCLK0
 ((
AT91C_PIO_PA4


	)

1845 
	#AT91C_PIO_PA5
 ((1 << 5

	)

1846 
	#AT91C_PA5_RXD0
 ((
AT91C_PIO_PA5


	)

1847 
	#AT91C_PA5_NPCS3
 ((
AT91C_PIO_PA5


	)

1848 
	#AT91C_PIO_PA6
 ((1 << 6

	)

1849 
	#AT91C_PA6_TXD0
 ((
AT91C_PIO_PA6


	)

1850 
	#AT91C_PA6_PCK0
 ((
AT91C_PIO_PA6


	)

1851 
	#AT91C_PIO_PA7
 ((1 << 7

	)

1852 
	#AT91C_PA7_RTS0
 ((
AT91C_PIO_PA7


	)

1853 
	#AT91C_PA7_PWM3
 ((
AT91C_PIO_PA7


	)

1854 
	#AT91C_PIO_PA8
 ((1 << 8

	)

1855 
	#AT91C_PA8_CTS0
 ((
AT91C_PIO_PA8


	)

1856 
	#AT91C_PA8_ADTRG
 ((
AT91C_PIO_PA8


	)

1857 
	#AT91C_PIO_PA9
 ((1 << 9

	)

1858 
	#AT91C_PA9_DRXD
 ((
AT91C_PIO_PA9


	)

1859 
	#AT91C_PA9_NPCS1
 ((
AT91C_PIO_PA9


	)

1864 
	#AT91C_ID_FIQ
 ((0

	)

1865 
	#AT91C_ID_SYS
 ((1

	)

1866 
	#AT91C_ID_PIOA
 ((2

	)

1867 
	#AT91C_ID_3_Rerved
 ((3

	)

1868 
	#AT91C_ID_ADC
 ((4

	)

1869 
	#AT91C_ID_SPI
 ((5

	)

1870 
	#AT91C_ID_US0
 ((6

	)

1871 
	#AT91C_ID_US1
 ((7

	)

1872 
	#AT91C_ID_SSC
 ((8

	)

1873 
	#AT91C_ID_TWI
 ((9

	)

1874 
	#AT91C_ID_PWMC
 ((10

	)

1875 
	#AT91C_ID_UDP
 ((11

	)

1876 
	#AT91C_ID_TC0
 ((12

	)

1877 
	#AT91C_ID_TC1
 ((13

	)

1878 
	#AT91C_ID_TC2
 ((14

	)

1879 
	#AT91C_ID_15_Rerved
 ((15

	)

1880 
	#AT91C_ID_16_Rerved
 ((16

	)

1881 
	#AT91C_ID_17_Rerved
 ((17

	)

1882 
	#AT91C_ID_18_Rerved
 ((18

	)

1883 
	#AT91C_ID_19_Rerved
 ((19

	)

1884 
	#AT91C_ID_20_Rerved
 ((20

	)

1885 
	#AT91C_ID_21_Rerved
 ((21

	)

1886 
	#AT91C_ID_22_Rerved
 ((22

	)

1887 
	#AT91C_ID_23_Rerved
 ((23

	)

1888 
	#AT91C_ID_24_Rerved
 ((24

	)

1889 
	#AT91C_ID_25_Rerved
 ((25

	)

1890 
	#AT91C_ID_26_Rerved
 ((26

	)

1891 
	#AT91C_ID_27_Rerved
 ((27

	)

1892 
	#AT91C_ID_28_Rerved
 ((28

	)

1893 
	#AT91C_ID_29_Rerved
 ((29

	)

1894 
	#AT91C_ID_IRQ0
 ((30

	)

1895 
	#AT91C_ID_IRQ1
 ((31

	)

1900 
	#AT91C_BASE_SYS
 ((
AT91PS_SYS
0xFFFFF000

	)

1901 
	#AT91C_BASE_AIC
 ((
AT91PS_AIC
0xFFFFF000

	)

1902 
	#AT91C_BASE_PDC_DBGU
 ((
AT91PS_PDC
0xFFFFF300

	)

1903 
	#AT91C_BASE_DBGU
 ((
AT91PS_DBGU
0xFFFFF200

	)

1904 
	#AT91C_BASE_PIOA
 ((
AT91PS_PIO
0xFFFFF400

	)

1905 
	#AT91C_BASE_CKGR
 ((
AT91PS_CKGR
0xFFFFFC20

	)

1906 
	#AT91C_BASE_PMC
 ((
AT91PS_PMC
0xFFFFFC00

	)

1907 
	#AT91C_BASE_RSTC
 ((
AT91PS_RSTC
0xFFFFFD00

	)

1908 
	#AT91C_BASE_RTTC
 ((
AT91PS_RTTC
0xFFFFFD20

	)

1909 
	#AT91C_BASE_PITC
 ((
AT91PS_PITC
0xFFFFFD30

	)

1910 
	#AT91C_BASE_WDTC
 ((
AT91PS_WDTC
0xFFFFFD40

	)

1911 
	#AT91C_BASE_VREG
 ((
AT91PS_VREG
0xFFFFFD60

	)

1912 
	#AT91C_BASE_MC
 ((
AT91PS_MC
0xFFFFFF00

	)

1913 
	#AT91C_BASE_PDC_SPI
 ((
AT91PS_PDC
0xFFFE0100

	)

1914 
	#AT91C_BASE_SPI
 ((
AT91PS_SPI
0xFFFE0000

	)

1915 
	#AT91C_BASE_PDC_ADC
 ((
AT91PS_PDC
0xFFFD8100

	)

1916 
	#AT91C_BASE_ADC
 ((
AT91PS_ADC
0xFFFD8000

	)

1917 
	#AT91C_BASE_PDC_SSC
 ((
AT91PS_PDC
0xFFFD4100

	)

1918 
	#AT91C_BASE_SSC
 ((
AT91PS_SSC
0xFFFD4000

	)

1919 
	#AT91C_BASE_PDC_US1
 ((
AT91PS_PDC
0xFFFC4100

	)

1920 
	#AT91C_BASE_US1
 ((
AT91PS_USART
0xFFFC4000

	)

1921 
	#AT91C_BASE_PDC_US0
 ((
AT91PS_PDC
0xFFFC0100

	)

1922 
	#AT91C_BASE_US0
 ((
AT91PS_USART
0xFFFC0000

	)

1923 
	#AT91C_BASE_TWI
 ((
AT91PS_TWI
0xFFFB8000

	)

1924 
	#AT91C_BASE_TC0
 ((
AT91PS_TC
0xFFFA0000

	)

1925 
	#AT91C_BASE_TC1
 ((
AT91PS_TC
0xFFFA0040

	)

1926 
	#AT91C_BASE_TC2
 ((
AT91PS_TC
0xFFFA0080

	)

1927 
	#AT91C_BASE_TCB
 ((
AT91PS_TCB
0xFFFA0000

	)

1928 
	#AT91C_BASE_PWMC_CH3
 ((
AT91PS_PWMC_CH
0xFFFCC260

	)

1929 
	#AT91C_BASE_PWMC_CH2
 ((
AT91PS_PWMC_CH
0xFFFCC240

	)

1930 
	#AT91C_BASE_PWMC_CH1
 ((
AT91PS_PWMC_CH
0xFFFCC220

	)

1931 
	#AT91C_BASE_PWMC_CH0
 ((
AT91PS_PWMC_CH
0xFFFCC200

	)

1932 
	#AT91C_BASE_PWMC
 ((
AT91PS_PWMC
0xFFFCC000

	)

1933 
	#AT91C_BASE_UDP
 ((
AT91PS_UDP
0xFFFB0000

	)

1938 
	#AT91C_ISRAM
 ((*0x00200000

	)

1939 
	#AT91C_ISRAM_SIZE
 ((0x00010000

	)

1940 
	#AT91C_IFLASH
 ((*0x00100000

	)

1941 
	#AT91C_IFLASH_SIZE
 ((0x00040000

	)

	@ports/at91sam7s/av.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"banum.h
"

33 
	~"ba.h
"

34 
	~"cfig.h
"

35 
	~"av.h
"

36 
	~"hdrs.h
"

38 #ide
MAX_ANALOG_VALUES


39 
	#MAX_ANALOG_VALUES
 4

	)

41 #i(
MAX_ANALOG_VALUES
 > 9)

42 #r 
Modify
 
the
 
Alog_Vue_Name
 
to
 
hd
 
muɝ
 
digs


48 
	#ANALOG_LEVEL_NULL
 255

	)

51 
	#ANALOG_RELINQUISH_DEFAULT
 0

	)

55 
ut8_t
 
	gP_Vue
[
MAX_ANALOG_VALUES
];

58 cڡ 
	gAlog_Vue_Prݔts_Requed
[] = {

59 
PROP_OBJECT_IDENTIFIER
,

60 
PROP_OBJECT_NAME
,

61 
PROP_OBJECT_TYPE
,

62 
PROP_PRESENT_VALUE
,

63 
PROP_STATUS_FLAGS
,

64 
PROP_EVENT_STATE
,

65 
PROP_OUT_OF_SERVICE
,

66 
PROP_UNITS
,

70 cڡ 
	gAlog_Vue_Prݔts_Oiڮ
[] = {

71 
PROP_DESCRIPTION
,

73 
PROP_PRIORITY_ARRAY
,

74 
PROP_RELINQUISH_DEFAULT
,

79 cڡ 
	gAlog_Vue_Prݔts_Prrry
[] = {

83 
	$Alog_Vue_Prݔty_Lis
(

84 cڡ **
pRequed
,

85 cڡ **
pOiڮ
,

86 cڡ **
pPrrry
)

88 i(
pRequed
)

89 *
pRequed
 = 
Alog_Vue_Prݔts_Requed
;

90 i(
pOiڮ
)

91 *
pOiڮ
 = 
Alog_Vue_Prݔts_Oiڮ
;

92 i(
pPrrry
)

93 *
pPrrry
 = 
Alog_Vue_Prݔts_Prrry
;

96 
	}
}

98 
	$Alog_Vue_In
(

101 
i
;

104 
i
 = 0; i < 
MAX_ANALOG_VALUES
; i++) {

105 
P_Vue
[
i
] = 
ANALOG_LEVEL_NULL
;

109 
	}
}

114 
bo
 
	$Alog_Vue_Vid_In
(

115 
ut32_t
 
obje_
)

117 i(
obje_
 < 
MAX_ANALOG_VALUES
)

118  
ue
;

120  
l
;

121 
	}
}

125 
	$Alog_Vue_Cou
(

128  
MAX_ANALOG_VALUES
;

129 
	}
}

134 
ut32_t
 
	$Alog_Vue_Index_To_In
(

135 
dex
)

137  
dex
;

138 
	}
}

143 
	$Alog_Vue_In_To_Index
(

144 
ut32_t
 
obje_
)

146 
dex
 = 
MAX_ANALOG_VALUES
;

148 i(
obje_
 < 
MAX_ANALOG_VALUES
)

149 
dex
 = 
obje_
;

151  
dex
;

152 
	}
}

154 
	$Alog_Vue_P_Vue
(

155 
ut32_t
 
obje_
)

157 
vue
 = 
ANALOG_RELINQUISH_DEFAULT
;

158 
dex
 = 0;

160 
dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

161 i(
dex
 < 
MAX_ANALOG_VALUES
) {

162 
vue
 = 
P_Vue
[
dex
];

165  
vue
;

166 
	}
}

168 
bo
 
	$Alog_Vue_Obje_Name
(

169 
ut32_t
 
obje_
,

170 
BACNET_CHARACTER_STRING
 * 
obje_me
)

172 
xt_rg
[16] = "AV-0";

173 
bo
 
us
 = 
l
;

175 i(
obje_
 < 
MAX_ANALOG_VALUES
) {

176 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

177 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

180  
us
;

181 
	}
}

184 
	$Alog_Vue_Rd_Prݔty
(

185 
BACNET_READ_PROPERTY_DATA
 * 
da
)

187 
du_n
 = 0;

188 
BACNET_BIT_STRING
 
b_rg
;

189 
BACNET_CHARACTER_STRING
 
ch_rg
;

190 
_vue
 = () 1.414;

192 
n
 = 0;

193 
obje_dex
 = 0;

194 
i
 = 0;

195 
bo
 
e
 = 
l
;

197 
ut8_t
 *
du
 = 
NULL
;

199 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

200 (
da
->
iti_da_n
 == 0)) {

203 
du
 = 
da
->
iti_da
;

204 
da
->
obje_ݔty
) {

205 
PROP_OBJECT_IDENTIFIER
:

206 
du_n
 =

207 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_VALUE
,

208 
da
->
obje_
);

210 
PROP_OBJECT_NAME
:

211 
PROP_DESCRIPTION
:

212 
	`Alog_Vue_Obje_Name
(
da
->
obje_
, &
ch_rg
);

213 
du_n
 =

214 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

216 
PROP_OBJECT_TYPE
:

217 
du_n
 =

218 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_VALUE
);

220 
PROP_PRESENT_VALUE
:

221 
_vue
 = 
	`Alog_Vue_P_Vue
(
da
->
obje_
);

222 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

224 
PROP_STATUS_FLAGS
:

225 
	`brg_
(&
b_rg
);

226 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

227 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

228 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

229 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

230 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

232 
PROP_EVENT_STATE
:

233 
du_n
 =

234 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

236 
PROP_OUT_OF_SERVICE
:

238 
obje_dex
 =

239 
	`Alog_Vue_In_To_Index
(
da
->
obje_
);

240 
e
 = 
Alog_Vue_Out_Of_Svi
[
obje_dex
];

242 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

244 
PROP_UNITS
:

245 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

248 
PROP_PRIORITY_ARRAY
:

250 i(
da
->
y_dex
 == 0)

251 
du_n
 =

252 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

255 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

256 
obje_dex
 =

257 
	`Alog_Vue_In_To_Index
(
da
->
obje_
);

258 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

260 i(
P_Vue
[
obje_dex
][
i
] =
ANALOG_LEVEL_NULL
)

261 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

263 
_vue
 = 
P_Vue
[
obje_dex
][
i
];

264 
n
 =

265 
	`code_iti_
(&
du
[
du_n
],

266 
_vue
);

269 i((
du_n
 + 
n
< 
MAX_APDU
)

270 
du_n
 +
n
;

272 
da
->
r_code
 =

273 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

274 
du_n
 = 
BACNET_STATUS_ABORT
;

279 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

280 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

281 i(
P_Vue
[
obje_dex
][
da
->
y_dex
 - 1] ==

282 
ANALOG_LEVEL_NULL
)

283 
du_n
 = 
	`code_iti_nu
(&
du
[0]);

285 
_vue
 =

286 
P_Vue
[
obje_dex
][
da
->
y_dex
 -

288 
du_n
 =

289 
	`code_iti_
(&
du
[0], 
_vue
);

292 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

293 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

294 
du_n
 = 
BACNET_STATUS_ERROR
;

299 
PROP_RELINQUISH_DEFAULT
:

300 
_vue
 = 
ANALOG_RELINQUISH_DEFAULT
;

301 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

305 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

306 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

307 
du_n
 = 
BACNET_STATUS_ERROR
;

311 i((
du_n
 >= 0) &&

313 (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

315 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

316 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

317 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

318 
du_n
 = 
BACNET_STATUS_ERROR
;

321  
du_n
;

322 
	}
}

325 
bo
 
	$Alog_Vue_Wre_Prݔty
(

326 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

328 
bo
 
us
 = 
l
;

329 
obje_dex
 = 0;

330 
iܙy
 = 0;

331 
ut8_t
 
v
 = 
ANALOG_LEVEL_NULL
;

332 
n
 = 0;

333 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

335 i(!
	`Alog_Vue_Vid_In
(
wp_da
->
obje_
)) {

336 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

337 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

338  
l
;

341 
n
 =

342 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

343 
wp_da
->
iti_da_n
, &
vue
);

345 i(
n
 < 0) {

347 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

348 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

349  
l
;

351 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

352 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

354 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

355 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

356  
l
;

358 
wp_da
->
obje_ݔty
) {

359 
PROP_PRESENT_VALUE
:

360 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_REAL
) {

361 
iܙy
 = 
wp_da
->priority;

365 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

366 (
iܙy
 != 6 ) &&

367 (
vue
.
ty
.
Rl
 >= 0.0) && (value.type.Real <= 100.0)) {

368 
v
 = (
ut8_t

vue
.
ty
.
Rl
;

369 
obje_dex
 =

370 
Alog_Vue_In_To_Index


371 (
wp_da
->
obje_
);

372 
iܙy
--;

373 
P_Vue
[
obje_dex
] = 
v
;

379 
us
 = 
ue
;

380 } i(
iܙy
 == 6) {

384 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

385 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

387 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

388 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

391 } i(
vue
.
g
 =
BACNET_APPLICATION_TAG_NULL
) {

392 
v
 = 
ANALOG_LEVEL_NULL
;

393 
obje_dex
 =

394 
	`Alog_Vue_In_To_Index
(
wp_da
->
obje_
);

395 
iܙy
 = 
wp_da
->priority;

396 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

397 
iܙy
--;

398 
P_Vue
[
obje_dex
][
iܙy
] = 
v
;

405 
us
 = 
ue
;

407 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

408 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

412 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

413 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

417 
PROP_OUT_OF_SERVICE
:

418 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_BOOLEAN
) {

419 
obje_dex
 =

420 
	`Alog_Vue_In_To_Index
(
wp_da
->
obje_
);

421 
Alog_Vue_Out_Of_Svi
[
obje_dex
] = 
vue
.
ty
.
Boޗn
;

422 
us
 = 
ue
;

424 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

425 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

429 
PROP_OUT_OF_SERVICE
:

430 
PROP_UNITS
:

431 
PROP_RELINQUISH_DEFAULT
:

432 
PROP_OBJECT_IDENTIFIER
:

433 
PROP_OBJECT_NAME
:

434 
PROP_OBJECT_TYPE
:

435 
PROP_STATUS_FLAGS
:

436 
PROP_EVENT_STATE
:

437 
PROP_DESCRIPTION
:

438 
PROP_PRIORITY_ARRAY
:

439 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

440 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

443 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

444 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

448  
us
;

449 
	}
}

	@ports/at91sam7s/bi.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

35 
	~"bi.h
"

36 
	~"hdrs.h
"

38 
	#MAX_BINARY_INPUTS
 8

	)

39 #i(
MAX_BINARY_INPUTS
 > 9)

40 #r 
Modify
 
the
 
By_Iut_Name
 
to
 
hd
 
muɝ
 
digs


43 
BACNET_BINARY_PV
 
	gP_Vue
[
MAX_BINARY_INPUTS
];

46 cڡ 
	gBy_Iut_Prݔts_Requed
[] = {

47 
PROP_OBJECT_IDENTIFIER
,

48 
PROP_OBJECT_NAME
,

49 
PROP_OBJECT_TYPE
,

50 
PROP_PRESENT_VALUE
,

51 
PROP_STATUS_FLAGS
,

52 
PROP_EVENT_STATE
,

53 
PROP_OUT_OF_SERVICE
,

54 
PROP_POLARITY
,

58 cڡ 
	gBy_Iut_Prݔts_Oiڮ
[] = {

59 
PROP_DESCRIPTION
,

63 cڡ 
	gBy_Iut_Prݔts_Prrry
[] = {

67 
	$By_Iut_Prݔty_Lis
(

68 cڡ **
pRequed
,

69 cڡ **
pOiڮ
,

70 cڡ **
pPrrry
)

72 i(
pRequed
) {

73 *
pRequed
 = 
By_Iut_Prݔts_Requed
;

75 i(
pOiڮ
) {

76 *
pOiڮ
 = 
By_Iut_Prݔts_Oiڮ
;

78 i(
pPrrry
) {

79 *
pPrrry
 = 
By_Iut_Prݔts_Prrry
;

83 
	}
}

85 
	$By_Iut_In
(

88 
i
;

90 
i
 = 0; i < 
MAX_BINARY_INPUTS
; i++) {

91 
P_Vue
[
i
] = 
BINARY_INACTIVE
;

93 
	}
}

96 
bo
 
	$By_Iut_Vid_In
(

97 
ut32_t
 
obje_
)

99 i(
obje_
 < 
MAX_BINARY_INPUTS
)

100  
ue
;

102  
l
;

103 
	}
}

106 
	$By_Iut_Cou
(

109  
MAX_BINARY_INPUTS
;

110 
	}
}

113 
ut32_t
 
	$By_Iut_Index_To_In
(

114 
dex
)

116  
dex
;

117 
	}
}

122 
	$By_Iut_In_To_Index
(

123 
ut32_t
 
obje_
)

125 
dex
 = 
MAX_BINARY_INPUTS
;

127 i(
obje_
 < 
MAX_BINARY_INPUTS
)

128 
dex
 = 
obje_
;

130  
dex
;

131 
	}
}

133 
BACNET_BINARY_PV
 
	$By_Iut_P_Vue
(

134 
ut32_t
 
obje_
)

136 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

137 
dex
 = 0;

139 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

140 i(
dex
 < 
MAX_BINARY_INPUTS
) {

141 
vue
 = 
P_Vue
[
dex
];

144  
vue
;

145 
	}
}

147 
bo
 
	$By_Iut_Obje_Name
(

148 
ut32_t
 
obje_
,

149 
BACNET_CHARACTER_STRING
 * 
obje_me
)

151 
xt_rg
[16] = "BI-0";

152 
bo
 
us
 = 
l
;

154 i(
obje_
 < 
MAX_BINARY_INPUTS
) {

155 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

156 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

159  
us
;

160 
	}
}

164 
	$By_Iut_Rd_Prݔty
(

165 
BACNET_READ_PROPERTY_DATA
 * 
da
)

167 
du_n
 = 0;

168 
BACNET_BIT_STRING
 
b_rg
;

169 
BACNET_CHARACTER_STRING
 
ch_rg
;

170 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

171 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

172 
ut8_t
 *
du
 = 
NULL
;

174 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

175 (
da
->
iti_da_n
 == 0)) {

178 
du
 = 
da
->
iti_da
;

179 
da
->
obje_ݔty
) {

180 
PROP_OBJECT_IDENTIFIER
:

181 
du_n
 =

182 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_BINARY_INPUT
,

183 
da
->
obje_
);

185 
PROP_OBJECT_NAME
:

186 
PROP_DESCRIPTION
:

187 
	`By_Iut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

188 
du_n
 =

189 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

191 
PROP_OBJECT_TYPE
:

192 
du_n
 =

193 
	`code_iti_umed
(&
du
[0], 
OBJECT_BINARY_INPUT
);

195 
PROP_PRESENT_VALUE
:

196 
vue
 = 
	`By_Iut_P_Vue
(
da
->
obje_
);

197 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
vue
);

199 
PROP_STATUS_FLAGS
:

201 
	`brg_
(&
b_rg
);

202 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

203 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

204 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

205 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

206 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

208 
PROP_EVENT_STATE
:

210 
du_n
 =

211 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

213 
PROP_OUT_OF_SERVICE
:

214 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

216 
PROP_POLARITY
:

217 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
pެy
);

220 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

221 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

222 
du_n
 = 
BACNET_STATUS_ERROR
;

226 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

227 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

228 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

229 
du_n
 = 
BACNET_STATUS_ERROR
;

232  
du_n
;

233 
	}
}

	@ports/at91sam7s/blinker.c

13 
	~"brd.h
"

16 
	gblkcou
;

18 
	$blk
(

19 
code
)

22 vީ
AT91PS_PIO
 
pPIO
 = 
AT91C_BASE_PIOA
;

23 vީ
j
, 
k
;

28 
j
 = 
code
; j != 0; j--) {

30 
pPIO
->
PIO_CODR
 = 
LED1
;

32 
k
 = 600000; k != 0; k--);

34 
pPIO
->
PIO_SODR
 = 
LED1
;

36 
k
 = 600000; k != 0; k--);

39 
k
 = 5000000; (
code
 != 0) && (k != 0); k--);

40 
blkcou
++;

42 
	}
}

	@ports/at91sam7s/board.h

15 #ide
Brd_h


16 
	#Brd_h


	)

18 
	~"91m7s256.h
"

19 
	~"i.h
"

20 
	#__le
 
le


	)

27 
	#INT_SRAM
 0x00200000

	)

28 
	#INT_SRAM_REMAP
 0x00000000

	)

30 
	#INT_FLASH
 0x00000000

	)

31 
	#INT_FLASH_REMAP
 0x01000000

	)

33 
	#FLASH_PAGE_NB
 512

	)

34 
	#FLASH_PAGE_SIZE
 128

	)

39 
	#LED1
 (1<<0

	)

40 
	#LED2
 (1<<1

	)

41 
	#LED3
 (1<<2

	)

42 
	#LED4
 (1<<3

	)

43 
	#NB_LEB
 4

	)

44 
	#LED_MASK
 (
LED1
|
LED2
|
LED3
|
LED4
)

	)

50 
	#SW1_MASK
 (1<<19

	)

51 
	#SW2_MASK
 (1<<20

	)

52 
	#SW3_MASK
 (1<<15

	)

53 
	#SW4_MASK
 (1<<14

	)

54 
	#SW_MASK
 (
SW1_MASK
|
SW2_MASK
|
SW3_MASK
|
SW4_MASK
)

	)

56 
	#SW1
 (1<<19

	)

57 
	#SW2
 (1<<20

	)

58 
	#SW3
 (1<<15

	)

59 
	#SW4
 (1<<14

	)

65 
	#DBGU_RXD
 
AT91C_PA9_DRXD


	)

66 
	#DBGU_TXD
 
AT91C_PA10_DTXD


	)

67 
	#AT91C_DBGU_BAUD
 115200

	)

68 
	#US_RXD_PIN
 
AT91C_PA5_RXD0


	)

69 
	#US_TXD_PIN
 
AT91C_PA6_TXD0


	)

70 
	#US_RTS_PIN
 
AT91C_PA7_RTS0


	)

71 
	#US_CTS_PIN
 
AT91C_PA8_CTS0


	)

76 
	#EXT_OC
 18432000

	)

77 
	#MCK
 47923200

	)

78 
	#MCKKHz
 (
MCK
/1000

	)

	@ports/at91sam7s/bv.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

35 
	~"bv.h
"

36 
	~"hdrs.h
"

38 #ide
MAX_BINARY_VALUES


39 
	#MAX_BINARY_VALUES
 8

	)

41 #i(
MAX_BINARY_VALUES
 > 9)

42 #r 
Modify
 
the
 
By_Vue_Name
 
to
 
hd
 
muɝ
 
digs


45 
BACNET_BINARY_PV
 
	gP_Vue
[
MAX_BINARY_VALUES
];

48 cڡ 
	gBy_Vue_Prݔts_Requed
[] = {

49 
PROP_OBJECT_IDENTIFIER
,

50 
PROP_OBJECT_NAME
,

51 
PROP_OBJECT_TYPE
,

52 
PROP_PRESENT_VALUE
,

53 
PROP_STATUS_FLAGS
,

54 
PROP_EVENT_STATE
,

55 
PROP_OUT_OF_SERVICE
,

59 cڡ 
	gBy_Vue_Prݔts_Oiڮ
[] = {

60 
PROP_DESCRIPTION
,

64 cڡ 
	gBy_Vue_Prݔts_Prrry
[] = {

68 
	$By_Vue_Prݔty_Lis
(

69 cڡ **
pRequed
,

70 cڡ **
pOiڮ
,

71 cڡ **
pPrrry
)

73 i(
pRequed
)

74 *
pRequed
 = 
By_Vue_Prݔts_Requed
;

75 i(
pOiڮ
)

76 *
pOiڮ
 = 
By_Vue_Prݔts_Oiڮ
;

77 i(
pPrrry
)

78 *
pPrrry
 = 
By_Vue_Prݔts_Prrry
;

81 
	}
}

83 
	$By_Vue_In
(

86 
i
;

88 
i
 = 0; i < 
MAX_BINARY_VALUES
; i++) {

89 
P_Vue
[
i
] = 
BINARY_INACTIVE
;

91 
	}
}

94 
bo
 
	$By_Vue_Vid_In
(

95 
ut32_t
 
obje_
)

97 i(
obje_
 < 
MAX_BINARY_VALUES
)

98  
ue
;

100  
l
;

101 
	}
}

104 
	$By_Vue_Cou
(

107  
MAX_BINARY_VALUES
;

108 
	}
}

111 
ut32_t
 
	$By_Vue_Index_To_In
(

112 
dex
)

114  
dex
;

115 
	}
}

118 
	$By_Vue_In_To_Index
(

119 
ut32_t
 
obje_
)

121 
dex
 = 
MAX_BINARY_VALUES
;

123 i(
obje_
 < 
MAX_BINARY_VALUES
)

124 
dex
 = 
obje_
;

126  
dex
;

127 
	}
}

129 
BACNET_BINARY_PV
 
	$By_Vue_P_Vue
(

130 
ut32_t
 
obje_
)

132 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

134 i(
obje_
 < 
MAX_BINARY_VALUES
) {

135 
vue
 = 
P_Vue
[
obje_
];

138  
vue
;

139 
	}
}

142 
bo
 
	$By_Vue_Obje_Name
(

143 
ut32_t
 
obje_
,

144 
BACNET_CHARACTER_STRING
 * 
obje_me
)

146 
xt_rg
[16] = "BV-0";

147 
bo
 
us
 = 
l
;

149 i(
obje_
 < 
MAX_BINARY_VALUES
) {

150 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

151 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

154  
us
;

155 
	}
}

158 
	$By_Vue_Rd_Prݔty
(

159 
BACNET_READ_PROPERTY_DATA
 * 
da
)

161 
du_n
 = 0;

162 
BACNET_BIT_STRING
 
b_rg
;

163 
BACNET_CHARACTER_STRING
 
ch_rg
;

164 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

165 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

167 
ut8_t
 *
du
 = 
NULL
;

169 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

170 (
da
->
iti_da_n
 == 0)) {

173 
du
 = 
da
->
iti_da
;

174 
da
->
obje_ݔty
) {

175 
PROP_OBJECT_IDENTIFIER
:

176 
du_n
 =

177 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_BINARY_VALUE
,

178 
da
->
obje_
);

182 
PROP_OBJECT_NAME
:

183 
PROP_DESCRIPTION
:

184 
	`By_Vue_Obje_Name
(
da
->
obje_
, &
ch_rg
);

185 
du_n
 =

186 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

188 
PROP_OBJECT_TYPE
:

189 
du_n
 =

190 
	`code_iti_umed
(&
du
[0], 
OBJECT_BINARY_VALUE
);

192 
PROP_PRESENT_VALUE
:

193 
e_vue
 =

194 
	`By_Vue_P_Vue
(
da
->
obje_
);

195 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

197 
PROP_STATUS_FLAGS
:

199 
	`brg_
(&
b_rg
);

200 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

201 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

202 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

203 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

204 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

206 
PROP_EVENT_STATE
:

208 
du_n
 =

209 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

211 
PROP_OUT_OF_SERVICE
:

212 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

214 
PROP_POLARITY
:

216 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
pެy
);

219 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

220 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

221 
du_n
 = 
BACNET_STATUS_ERROR
;

225 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

226 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

227 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

228 
du_n
 = 
BACNET_STATUS_ERROR
;

231  
du_n
;

232 
	}
}

235 
bo
 
	$By_Vue_Wre_Prݔty
(

236 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

238 
bo
 
us
 = 
l
;

239 
obje_dex
 = 0;

240 
iܙy
 = 0;

241 
BACNET_BINARY_PV
 
v
 = 
BINARY_NULL
;

242 
n
 = 0;

243 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

245 i(!
	`By_Vue_Vid_In
(
wp_da
->
obje_
)) {

246 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

247 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

248  
l
;

251 
n
 =

252 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

253 
wp_da
->
iti_da_n
, &
vue
);

255 i(
n
 < 0) {

257 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

258 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

259  
l
;

261 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

262 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

264 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

265 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

266  
l
;

268 
wp_da
->
obje_ݔty
) {

269 
PROP_PRESENT_VALUE
:

270 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_ENUMERATED
) {

271 
iܙy
 = 
wp_da
->priority;

275 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

276 (
iܙy
 != 6 ) &&

277 (
vue
.
ty
.
Enumed
 >
MIN_BINARY_PV
) &&

278 (
vue
.
ty
.
Enumed
 <
MAX_BINARY_PV
)) {

279 
v
 = 
vue
.
ty
.
Enumed
;

280 
obje_dex
 =

281 
By_Vue_In_To_Index


282 (
wp_da
->
obje_
);

283 
iܙy
--;

285 
P_Vue
[
obje_dex
] = 
v
;

290 
us
 = 
ue
;

291 } i(
iܙy
 == 6) {

295 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

296 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

298 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

299 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

302 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

303 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

306 
PROP_OUT_OF_SERVICE
:

308 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_BOOLEAN
) {

309 
obje_dex
 =

310 
	`By_Vue_In_To_Index
(
wp_da
->
obje_
);

311 
By_Vue_Out_Of_Svi
[
obje_dex
] = 
vue
.
ty
.
Boޗn
;

312 
us
 = 
ue
;

314 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

315 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

319 
PROP_OBJECT_IDENTIFIER
:

320 
PROP_OBJECT_NAME
:

321 
PROP_DESCRIPTION
:

322 
PROP_OBJECT_TYPE
:

323 
PROP_STATUS_FLAGS
:

324 
PROP_EVENT_STATE
:

325 
PROP_PRIORITY_ARRAY
:

326 
PROP_RELINQUISH_DEFAULT
:

327 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

328 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

331 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

332 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

336  
us
;

337 
	}
}

	@ports/at91sam7s/device.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<dlib.h
>

29 
	~<rg.h
>

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"bacr.h
"

33 
	~"banum.h
"

34 
	~"du.h
"

35 
	~"dcc.h
"

36 
	~"dk.h
"

37 
	~"rs485.h
"

38 
	~"vsi.h
"

39 
	~"hdrs.h
"

41 
	~"devi.h
"

42 
	~"ai.h
"

43 
	~"av.h
"

44 
	~"bi.h
"

45 
	~"bv.h
"

46 
	~"wp.h
"

47 
	~"dcc.h
"

50 
Devi_Rd_Prݔty_Lol
(

51 
BACNET_READ_PROPERTY_DATA
 * 
da
);

52 
bo
 
Devi_Wre_Prݔty_Lol
(

53 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

55 
	smy_obje_funis
 {

56 
BACNET_OBJECT_TYPE
 
	mObje_Ty
;

57 
obje__funi
 
	mObje_In
;

58 
obje_cou_funi
 
	mObje_Cou
;

59 
obje_dex_to__funi
 
	mObje_Index_To_In
;

60 
obje_vid__funi
 
	mObje_Vid_In
;

61 
obje_me_funi
 
	mObje_Name
;

62 
ad_ݔty_funi
 
	mObje_Rd_Prݔty
;

63 
wre_ݔty_funi
 
	mObje_Wre_Prݔty
;

64 
m_ݔty_lis_funi
 
	mObje_RPM_Li
;

65 } 
	gObje_Tab
[] = {

67 
OBJECT_DEVICE
, 
NULL
,

68 
Devi_Cou
, 
Devi_Index_To_In
,

69 
Devi_Vid_Obje_In_Numb
, 
Devi_Obje_Name
,

70 
Devi_Rd_Prݔty_Lol
, 
Devi_Wre_Prݔty_Lol
,

71 
Devi_Prݔty_Lis
}, {

72 
OBJECT_ANALOG_INPUT
, 
Alog_Iut_In
, 
Alog_Iut_Cou
,

73 
Alog_Iut_Index_To_In
, 
Alog_Iut_Vid_In
,

74 
Alog_Iut_Obje_Name
, 
Alog_Iut_Rd_Prݔty
, 
NULL
,

75 
Alog_Iut_Prݔty_Lis
}, {

76 
OBJECT_ANALOG_VALUE
, 
Alog_Vue_In
, 
Alog_Vue_Cou
,

77 
Alog_Vue_Index_To_In
, 
Alog_Vue_Vid_In
,

78 
Alog_Vue_Obje_Name
, 
Alog_Vue_Rd_Prݔty
,

79 
Alog_Vue_Wre_Prݔty
, 
Alog_Vue_Prݔty_Lis
}, {

80 
OBJECT_BINARY_INPUT
, 
By_Iut_In
, 
By_Iut_Cou
,

81 
By_Iut_Index_To_In
, 
By_Iut_Vid_In
,

82 
By_Iut_Obje_Name
, 
By_Iut_Rd_Prݔty
, 
NULL
,

83 
By_Iut_Prݔty_Lis
}, {

84 
OBJECT_BINARY_VALUE
, 
By_Vue_In
, 
By_Vue_Cou
,

85 
By_Vue_Index_To_In
, 
By_Vue_Vid_In
,

86 
By_Vue_Obje_Name
, 
By_Vue_Rd_Prݔty
,

87 
By_Vue_Wre_Prݔty
, 
By_Vue_Prݔty_Lis
}, {

88 
MAX_BACNET_OBJECT_TYPE
, 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL}

95 
ut32_t
 
	gObje_In_Numb
;

96 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

97 
BACNET_CHARACTER_STRING
 
	gMy_Obje_Name
;

98 
ut32_t
 
	gDaba_Revisi
;

99 
BACNET_REINITIALIZED_STATE
 
	gRelize_S
 = 
BACNET_REINIT_IDLE
;

100 cڡ *
	gRe_Passwd
 = "rehmite";

103 cڡ 
	gDevi_Prݔts_Requed
[] = {

104 
PROP_OBJECT_IDENTIFIER
,

105 
PROP_OBJECT_NAME
,

106 
PROP_OBJECT_TYPE
,

107 
PROP_SYSTEM_STATUS
,

108 
PROP_VENDOR_NAME
,

109 
PROP_VENDOR_IDENTIFIER
,

110 
PROP_MODEL_NAME
,

111 
PROP_FIRMWARE_REVISION
,

112 
PROP_APPLICATION_SOFTWARE_VERSION
,

113 
PROP_PROTOCOL_VERSION
,

114 
PROP_PROTOCOL_REVISION
,

115 
PROP_PROTOCOL_SERVICES_SUPPORTED
,

116 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

117 
PROP_OBJECT_LIST
,

118 
PROP_MAX_APDU_LENGTH_ACCEPTED
,

119 
PROP_SEGMENTATION_SUPPORTED
,

120 
PROP_APDU_TIMEOUT
,

121 
PROP_NUMBER_OF_APDU_RETRIES
,

122 
PROP_MAX_MASTER
,

123 
PROP_MAX_INFO_FRAMES
,

124 
PROP_DEVICE_ADDRESS_BINDING
,

125 
PROP_DATABASE_REVISION
,

129 cڡ 
	gDevi_Prݔts_Oiڮ
[] = {

130 
PROP_DESCRIPTION
,

131 
PROP_LOCATION
,

135 cڡ 
	gDevi_Prݔts_Prrry
[] = {

140 
my_obje_funis
 *
	$Devi_Objes_Fd_Funis
(

141 
BACNET_OBJECT_TYPE
 
Obje_Ty
)

143 
my_obje_funis
 *
pObje
 = 
NULL
;

145 
pObje
 = &
Obje_Tab
[0];

146 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

148 i(
pObje
->
Obje_Ty
 == Object_Type) {

149  (
pObje
);

152 
pObje
++;

155  (
NULL
);

156 
	}
}

158 
	$Rd_Prݔty_Comm
(

159 
my_obje_funis
 *
pObje
,

160 
BACNET_READ_PROPERTY_DATA
 * 
da
)

162 
du_n
 = 
BACNET_STATUS_ERROR
;

163 
BACNET_CHARACTER_STRING
 
ch_rg
;

164 
ut8_t
 *
du
 = 
NULL
;

166 i((
da
->
iti_da
 =
NULL
) ||

167 (
da
->
iti_da_n
 == 0)) {

170 
du
 = 
da
->
iti_da
;

171 
da
->
obje_ݔty
) {

172 
PROP_OBJECT_IDENTIFIER
:

174 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

175 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

176 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

177 
du_n
 = 
BACNET_STATUS_ERROR
;

181 i(
da
->
obje_ty
 =
OBJECT_DEVICE
) {

182 
da
->
obje_
 = 
Obje_In_Numb
;

184 
du_n
 =

185 
	`code_iti_obje_id
(&
du
[0], 
da
->
obje_ty
,

186 
da
->
obje_
);

189 
PROP_OBJECT_NAME
:

191 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

192 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

193 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

194 
du_n
 = 
BACNET_STATUS_ERROR
;

196 
	`charg__si
(&
ch_rg
, "");

197 i(
pObje
->
Obje_Name
) {

198 (
pObje
->
	`Obje_Name
(
da
->
obje_
,

199 &
ch_rg
);

201 
du_n
 =

202 
	`code_iti_cha_rg
(&
du
[0],

203 &
ch_rg
);

206 
PROP_OBJECT_TYPE
:

208 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

209 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

210 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

211 
du_n
 = 
BACNET_STATUS_ERROR
;

213 
du_n
 =

214 
	`code_iti_umed
(&
du
[0],

215 
da
->
obje_ty
);

219 i(
pObje
->
Obje_Rd_Prݔty
) {

220 
du_n
 = 
pObje
->
	`Obje_Rd_Prݔty
(
da
);

225  
du_n
;

226 
	}
}

230 
	$Devi_Rd_Prݔty
(

231 
BACNET_READ_PROPERTY_DATA
 * 
da
)

233 
du_n
 = 
BACNET_STATUS_ERROR
;

234 
my_obje_funis
 *
pObje
 = 
NULL
;

237 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
da
->
obje_ty
);

238 i(
pObje
) {

239 i(
pObje
->
Obje_Vid_In
 &&

240 
pObje
->
	`Obje_Vid_In
(
da
->
obje_
)) {

241 
du_n
 = 
	`Rd_Prݔty_Comm
(
pObje
, 
da
);

243 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

244 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

247 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

248 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

251  
du_n
;

252 
	}
}

254 
bo
 
	$Devi_Wre_Prݔty
(

255 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

257 
bo
 
us
 = 
l
;

258 
my_obje_funis
 *
pObje
 = 
NULL
;

261 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
wp_da
->
obje_ty
);

262 i(
pObje
) {

263 i(
pObje
->
Obje_Vid_In
 &&

264 
pObje
->
	`Obje_Vid_In
(
wp_da
->
obje_
)) {

265 i(
pObje
->
Obje_Wre_Prݔty
) {

266 
us
 = 
pObje
->
	`Obje_Wre_Prݔty
(
wp_da
);

268 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

269 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

272 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

273 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

276 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

277 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

280  
us
;

281 
	}
}

284 
	$Devi_Objes_Prݔty_Li
(

285 
BACNET_OBJECT_TYPE
 
obje_ty
,

286 
ecl_ݔty_li_t
 *
pPrݔtyLi
)

288 
my_obje_funis
 *
pObje
 = 
NULL
;

290 
pPrݔtyLi
->
Requed
.
pLi
 = 
NULL
;

291 
pPrݔtyLi
->
Oiڮ
.
pLi
 = 
NULL
;

292 
pPrݔtyLi
->
Prrry
.
pLi
 = 
NULL
;

299 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

300 i((
pObje
 !
NULL
&& (pObje->
Obje_RPM_Li
 != NULL)) {

301 
pObje
->
	`Obje_RPM_Li
(&
pPrݔtyLi
->
Requed
.
pLi
,

302 &
pPrݔtyLi
->
Oiڮ
.
pLi
, &pPrݔtyLi->
Prrry
.pList);

306 
pPrݔtyLi
->
Requed
.
cou
 =

307 
pPrݔtyLi
->
Requed
.
pLi
 ==

308 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Requed
.
pLi
);

310 
pPrݔtyLi
->
Oiڮ
.
cou
 =

311 
pPrݔtyLi
->
Oiڮ
.
pLi
 ==

312 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Oiڮ
.
pLi
);

314 
pPrݔtyLi
->
Prrry
.
cou
 =

315 
pPrݔtyLi
->
Prrry
.
pLi
 ==

316 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Prrry
.
pLi
);

319 
	}
}

321 
	$Devi_Prݔty_Lis
(

322 cڡ **
pRequed
,

323 cڡ **
pOiڮ
,

324 cڡ **
pPrrry
)

326 i(
pRequed
)

327 *
pRequed
 = 
Devi_Prݔts_Requed
;

328 i(
pOiڮ
)

329 *
pOiڮ
 = 
Devi_Prݔts_Oiڮ
;

330 i(
pPrrry
)

331 *
pPrrry
 = 
Devi_Prݔts_Prrry
;

334 
	}
}

336 
	$Devi_Cou
(

340 
	}
}

342 
ut32_t
 
	$Devi_Index_To_In
(

343 
dex
)

345 
dex
 = index;

346  
Obje_In_Numb
;

347 
	}
}

349 
bo
 
	$Devi_Obje_Name
(

350 
ut32_t
 
obje_
,

351 
BACNET_CHARACTER_STRING
 * 
obje_me
)

353 
bo
 
us
 = 
l
;

355 i(
obje_
 =
Obje_In_Numb
) {

356 
us
 = 
	`charg_cy
(
obje_me
, &
My_Obje_Name
);

359  
us
;

360 
	}
}

362 
bo
 
	$Devi_S_Obje_Name
(

363 
BACNET_CHARACTER_STRING
 * 
obje_me
)

365 
bo
 
us
 = 
l
;

367 i(!
	`charg_me
(&
My_Obje_Name
, 
obje_me
)) {

369 
us
 = 
	`charg_cy
(&
My_Obje_Name
, 
obje_me
);

370 
	`Devi_Inc_Daba_Revisi
();

373  
us
;

374 
	}
}

376 
bo
 
	$Devi_Relize
(

377 
BACNET_REINITIALIZE_DEVICE_DATA
 * 
rd_da
)

379 
bo
 
us
 = 
l
;

382 i(
	`charg_si_me
(&
rd_da
->
sswd
, 
Re_Passwd
)) {

383 
rd_da
->
e
) {

384 
BACNET_REINIT_COLDSTART
:

385 
BACNET_REINIT_WARMSTART
:

386 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

390 
Relize_S
 = 
rd_da
->
e
;

391 
us
 = 
ue
;

393 
BACNET_REINIT_STARTBACKUP
:

394 
BACNET_REINIT_ENDBACKUP
:

395 
BACNET_REINIT_STARTRESTORE
:

396 
BACNET_REINIT_ENDRESTORE
:

397 
BACNET_REINIT_ABORTRESTORE
:

398 i(
	`dcc_communiti_dibd
()) {

399 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

400 
rd_da
->
r_code
 = 
ERROR_CODE_COMMUNICATION_DISABLED
;

402 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

403 
rd_da
->
r_code
 =

404 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

408 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

409 
rd_da
->
r_code
 = 
ERROR_CODE_PARAMETER_OUT_OF_RANGE
;

413 
rd_da
->
r_ass
 = 
ERROR_CLASS_SECURITY
;

414 
rd_da
->
r_code
 = 
ERROR_CODE_PASSWORD_FAILURE
;

417  
us
;

418 
	}
}

420 
BACNET_REINITIALIZED_STATE
 
	$Devi_Relized_S
(

423  
Relize_S
;

424 
	}
}

426 
	$Devi_In
(

427 
obje_funis_t
 * 
obje_b
)

429 
my_obje_funis
 *
pObje
 = 
NULL
;

433 (
obje_b
;

435 
pObje
 = &
Obje_Tab
[0];

436 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

437 i(
pObje
->
Obje_In
) {

438 
pObje
->
	`Obje_In
();

440 
pObje
++;

442 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

443 
Obje_In_Numb
 = 12345;

444 
	`charg__si
(&
My_Obje_Name
, "ARM7 Demo Device");

445 
	}
}

448 
ut32_t
 
	$Devi_Obje_In_Numb
(

451  
Obje_In_Numb
;

452 
	}
}

454 
bo
 
	$Devi_S_Obje_In_Numb
(

455 
ut32_t
 
obje_id
)

457 
bo
 
us
 = 
ue
;

459 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

460 
Obje_In_Numb
 = 
obje_id
;

462 
us
 = 
l
;

464  
us
;

465 
	}
}

467 
bo
 
	$Devi_Vid_Obje_In_Numb
(

468 
ut32_t
 
obje_id
)

470  (
Obje_In_Numb
 =
obje_id
);

471 
	}
}

473 
BACNET_DEVICE_STATUS
 
	$Devi_Syem_Stus
(

476  
Syem_Stus
;

477 
	}
}

479 
	$Devi_S_Syem_Stus
(

480 
BACNET_DEVICE_STATUS
 
us
,

481 
bo
 
lol
)

484 
su
 = -1;

486 i(
us
 < 
MAX_DEVICE_STATUS
) {

487 
Syem_Stus
 = 
us
;

488 
su
 = 0;

491  
su
;

492 
	}
}

494 
ut16_t
 
	$Devi_Vd_Idtifr
(

497  
BACNET_VENDOR_ID
;

498 
	}
}

500 
BACNET_SEGMENTATION
 
	$Devi_Segmti_Su܋d
(

503  
SEGMENTATION_NONE
;

504 
	}
}

506 
ut32_t
 
	$Devi_Daba_Revisi
(

509  
Daba_Revisi
;

510 
	}
}

512 
	$Devi_Inc_Daba_Revisi
(

515 
Daba_Revisi
++;

516 
	}
}

520 
	$Devi_Obje_Li_Cou
(

523 
cou
 = 0;

524 
my_obje_funis
 *
pObje
 = 
NULL
;

527 
pObje
 = &
Obje_Tab
[0];

528 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

529 i(
pObje
->
Obje_Cou
) {

530 
cou
 +
pObje
->
	`Obje_Cou
();

532 
pObje
++;

535  
cou
;

536 
	}
}

538 
bo
 
	$Devi_Obje_Li_Idtifr
(

539 
ut32_t
 
y_dex
,

540 *
obje_ty
,

541 
ut32_t
 * 

)

543 
bo
 
us
 = 
l
;

544 
ut32_t
 
cou
 = 0;

545 
ut32_t
 
obje_dex
 = 0;

546 
my_obje_funis
 *
pObje
 = 
NULL
;

549 i(
y_dex
 == 0) {

550  
us
;

552 
obje_dex
 = 
y_dex
 - 1;

554 
pObje
 = &
Obje_Tab
[0];

555 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

556 i(
pObje
->
Obje_Cou
 &&Obje->
Obje_Index_To_In
) {

557 
obje_dex
 -
cou
;

558 
cou
 = 
pObje
->
	`Obje_Cou
();

559 i(
obje_dex
 < 
cou
) {

560 *
obje_ty
 = 
pObje
->
Obje_Ty
;

561 *

 = 
pObje
->
	`Obje_Index_To_In
(
obje_dex
);

562 
us
 = 
ue
;

566 
pObje
++;

569  
us
;

570 
	}
}

572 
bo
 
	$Devi_Vid_Obje_Name
(

573 
BACNET_CHARACTER_STRING
 * 
obje_me1
,

574 *
obje_ty
,

575 
ut32_t
 * 
obje_
)

577 
bo
 
found
 = 
l
;

578 
ty
 = 0;

579 
ut32_t
 

;

580 
ut32_t
 
max_objes
 = 0, 
i
 = 0;

581 
bo
 
check_id
 = 
l
;

582 
BACNET_CHARACTER_STRING
 
obje_me2
;

583 
my_obje_funis
 *
pObje
 = 
NULL
;

585 
max_objes
 = 
	`Devi_Obje_Li_Cou
();

586 
i
 = 1; i <
max_objes
; i++) {

587 
check_id
 = 
	`Devi_Obje_Li_Idtifr
(
i
, &
ty
, &

);

588 i(
check_id
) {

589 
pObje
 = 
	`Devi_Objes_Fd_Funis
((
BACNET_OBJECT_TYPE

ty
);

590 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL) &&

591 (
pObje
->
	`Obje_Name
(

, &
obje_me2
) &&

592 
	`charg_me
(
obje_me1
, &
obje_me2
))) {

593 
found
 = 
ue
;

594 i(
obje_ty
) {

595 *
obje_ty
 = 
ty
;

597 i(
obje_
) {

598 *
obje_
 = 

;

605  
found
;

606 
	}
}

608 
bo
 
	$Devi_Vid_Obje_Id
(

609 
obje_ty
,

610 
ut32_t
 
obje_
)

612 
bo
 
us
 = 
l
;

613 
my_obje_funis
 *
pObje
 = 
NULL
;

615 
pObje
 = 
	`Devi_Objes_Fd_Funis
((
BACNET_OBJECT_TYPE

obje_ty
);

616 i((
pObje
 !
NULL
&& (pObje->
Obje_Vid_In
 != NULL)) {

617 
us
 = 
pObje
->
	`Obje_Vid_In
(
obje_
);

620  
us
;

621 
	}
}

623 
bo
 
	$Devi_Obje_Name_Cy
(

624 
BACNET_OBJECT_TYPE
 
obje_ty
,

625 
ut32_t
 
obje_
,

626 
BACNET_CHARACTER_STRING
 * 
obje_me
)

628 
my_obje_funis
 *
pObje
 = 
NULL
;

629 
bo
 
found
 = 
l
;

631 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

632 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL)) {

633 
found
 = 
pObje
->
	`Obje_Name
(
obje_
, 
obje_me
);

636  
found
;

637 
	}
}

640 
	$Devi_Rd_Prݔty_Lol
(

641 
BACNET_READ_PROPERTY_DATA
 * 
da
)

643 
du_n
 = 0;

644 
n
 = 0;

645 
BACNET_BIT_STRING
 
b_rg
;

646 
BACNET_CHARACTER_STRING
 
ch_rg
;

647 
ut32_t
 
i
 = 0;

648 
obje_ty
 = 0;

649 
ut32_t
 

 = 0;

650 
ut32_t
 
cou
 = 0;

651 
ut8_t
 *
du
 = 
NULL
;

652 
my_obje_funis
 *
pObje
 = 
NULL
;

654 i((
da
->
iti_da
 =
NULL
) ||

655 (
da
->
iti_da_n
 == 0)) {

658 
du
 = 
da
->
iti_da
;

659 ()
da
->
obje_ݔty
) {

660 
PROP_DESCRIPTION
:

661 
	`charg__si
(&
ch_rg
, "BACnet Demo");

662 
du_n
 =

663 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

665 
PROP_LOCATION
:

666 
	`charg__si
(&
ch_rg
, "USA");

667 
du_n
 =

668 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

670 
PROP_SYSTEM_STATUS
:

671 
du_n
 =

672 
	`code_iti_umed
(&
du
[0],

673 
	`Devi_Syem_Stus
());

675 
PROP_VENDOR_NAME
:

676 
	`charg__si
(&
ch_rg
, 
BACNET_VENDOR_NAME
);

677 
du_n
 =

678 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

680 
PROP_VENDOR_IDENTIFIER
:

681 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
BACNET_VENDOR_ID
);

683 
PROP_MODEL_NAME
:

684 
	`charg__si
(&
ch_rg
, "GNU Demo");

685 
du_n
 =

686 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

688 
PROP_FIRMWARE_REVISION
:

689 
	`charg__si
(&
ch_rg
, 
BACt_Vsi
);

690 
du_n
 =

691 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

693 
PROP_APPLICATION_SOFTWARE_VERSION
:

694 
	`charg__si
(&
ch_rg
, "1.0");

695 
du_n
 =

696 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

698 
PROP_PROTOCOL_VERSION
:

699 
du_n
 =

700 
	`code_iti_unsigd
(&
du
[0], 
BACNET_PROTOCOL_VERSION
);

702 
PROP_PROTOCOL_REVISION
:

703 
du_n
 =

704 
	`code_iti_unsigd
(&
du
[0],

705 
BACNET_PROTOCOL_REVISION
);

707 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

709 
	`brg_
(&
b_rg
);

710 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

712 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

713 
	`du_rvi_su܋d
((
BACNET_SERVICES_SUPPORTED

i
));

715 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

717 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

720 
	`brg_
(&
b_rg
);

721 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

723 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

726 
i
 = 0;

727 
pObje
 = &
Obje_Tab
[
i
];

728 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

729 i((
pObje
->
Obje_Cou
&& (pObje->
	`Obje_Cou
() > 0)) {

730 
	`brg_t_b
(&
b_rg
, 
pObje
->
Obje_Ty
, 
ue
);

732 
pObje
++;

734 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

736 
PROP_OBJECT_LIST
:

737 
cou
 = 
	`Devi_Obje_Li_Cou
();

739 i(
da
->
y_dex
 == 0)

740 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

745 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

746 
i
 = 1; i <
cou
; i++) {

747 i(
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
,

748 &

)) {

749 
n
 =

750 
	`code_iti_obje_id
(&
du
[
du_n
],

751 
obje_ty
, 

);

752 
du_n
 +
n
;

755 i((
du_n
 + 
n
>
MAX_APDU
) {

757 
da
->
r_code
 =

758 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

759 
du_n
 = 
BACNET_STATUS_ABORT
;

764 
da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

765 
da
->
r_code
 = 
ERROR_CODE_OTHER
;

766 
du_n
 = 
BACNET_STATUS_ERROR
;

771 i(
	`Devi_Obje_Li_Idtifr
(
da
->
y_dex
,

772 &
obje_ty
, &

))

773 
du_n
 =

774 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

775 

);

777 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

778 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

779 
du_n
 = 
BACNET_STATUS_ERROR
;

783 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

784 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

786 
PROP_SEGMENTATION_SUPPORTED
:

787 
du_n
 =

788 
	`code_iti_umed
(&
du
[0],

789 
	`Devi_Segmti_Su܋d
());

791 
PROP_APDU_TIMEOUT
:

792 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_timeout
());

794 
PROP_NUMBER_OF_APDU_RETRIES
:

795 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_s
());

797 
PROP_DEVICE_ADDRESS_BINDING
:

800 
PROP_DATABASE_REVISION
:

801 
du_n
 =

802 
	`code_iti_unsigd
(&
du
[0],

803 
	`Devi_Daba_Revisi
());

805 
PROP_MAX_INFO_FRAMES
:

806 
du_n
 =

807 
	`code_iti_unsigd
(&
du
[0],

808 
	`dlmp_max_fo_ames
());

810 
PROP_MAX_MASTER
:

811 
du_n
 =

812 
	`code_iti_unsigd
(&
du
[0], 
	`dlmp_max_ma
());

815 
du_n
 =

816 
	`code_iti_unsigd
(&
du
[0], 
	`RS485_G_Baud_Re
());

819 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

820 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

821 
du_n
 = 
BACNET_STATUS_ERROR
;

825 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

826 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

827 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

828 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

829 
du_n
 = 
BACNET_STATUS_ERROR
;

832  
du_n
;

833 
	}
}

835 
bo
 
	$Devi_Wre_Prݔty_Lol
(

836 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

838 
bo
 
us
 = 
l
;

839 
n
 = 0;

840 
ut8_t
 
codg
 = 0;

841 
size_t
 
ngth
 = 0;

842 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

845 
n
 =

846 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

847 
wp_da
->
iti_da_n
, &
vue
);

849 i(
n
 < 0) {

851 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

852 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

853  
l
;

855 i((
wp_da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

856 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

858 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

859 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

860  
l
;

862 ()
wp_da
->
obje_ݔty
) {

863 
PROP_OBJECT_IDENTIFIER
:

864 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_OBJECT_ID
) {

865 i((
vue
.
ty
.
Obje_Id
.ty =
OBJECT_DEVICE
) &&

866 (
	`Devi_S_Obje_In_Numb
(
vue
.
ty
.

867 
Obje_Id
.

))) {

869 
us
 = 
ue
;

871 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

872 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

875 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

876 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

879 
PROP_MAX_INFO_FRAMES
:

880 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

881 i(
vue
.
ty
.
Unsigd_I
 <= 255) {

882 
	`dlmp_t_max_fo_ames
(
vue
.
ty
.
Unsigd_I
);

883 
us
 = 
ue
;

885 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

886 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

889 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

890 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

893 
PROP_MAX_MASTER
:

894 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

895 i((
vue
.
ty
.
Unsigd_I
 > 0) &&

896 (
vue
.
ty
.
Unsigd_I
 <= 127)) {

897 
	`dlmp_t_max_ma
(
vue
.
ty
.
Unsigd_I
);

898 
us
 = 
ue
;

900 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

901 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

904 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

905 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

908 
PROP_OBJECT_NAME
:

909 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

910 
ngth
 = 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
);

911 i(
ngth
 < 1) {

912 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

913 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

914 } i(
ngth
 < 
	`charg_cy
(&
My_Obje_Name
)) {

915 
codg
 =

916 
	`charg_codg
(&
vue
.
ty
.
Cha_Sg
);

917 i(
codg
 < 
MAX_CHARACTER_STRING_ENCODING
) {

919 i(
	`Devi_Vid_Obje_Name
(&
vue
.
ty
.

920 
Cha_Sg
, 
NULL
, NULL)) {

921 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

922 
wp_da
->
r_code
 = 
ERROR_CODE_DUPLICATE_NAME
;

924 
	`Devi_S_Obje_Name
(&
vue
.
ty
.

925 
Cha_Sg
);

926 
us
 = 
ue
;

929 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

930 
wp_da
->
r_code
 =

931 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

934 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

935 
wp_da
->
r_code
 =

936 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

939 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

940 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

944 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

945 i(
vue
.
ty
.
Unsigd_I
 <= 115200) {

946 
	`RS485_S_Baud_Re
(
vue
.
ty
.
Unsigd_I
);

947 
us
 = 
ue
;

949 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

950 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

953 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

954 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

957 
PROP_NUMBER_OF_APDU_RETRIES
:

958 
PROP_APDU_TIMEOUT
:

959 
PROP_VENDOR_IDENTIFIER
:

960 
PROP_SYSTEM_STATUS
:

961 
PROP_LOCATION
:

962 
PROP_DESCRIPTION
:

963 
PROP_MODEL_NAME
:

964 
PROP_VENDOR_NAME
:

965 
PROP_FIRMWARE_REVISION
:

966 
PROP_APPLICATION_SOFTWARE_VERSION
:

967 
PROP_LOCAL_TIME
:

968 
PROP_UTC_OFFSET
:

969 
PROP_LOCAL_DATE
:

970 
PROP_DAYLIGHT_SAVINGS_STATUS
:

971 
PROP_PROTOCOL_VERSION
:

972 
PROP_PROTOCOL_REVISION
:

973 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

974 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

975 
PROP_OBJECT_LIST
:

976 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

977 
PROP_SEGMENTATION_SUPPORTED
:

978 
PROP_DEVICE_ADDRESS_BINDING
:

979 
PROP_DATABASE_REVISION
:

980 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

981 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

982 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

985 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

986 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

990 
n
 =en;

992  
us
;

993 
	}
}

	@ports/at91sam7s/dlmstp.c

35 
	~<dbo.h
>

36 
	~<dt.h
>

37 
	~<ddef.h
>

38 
	~<rg.h
>

39 
	~"bacdef.h
"

40 
	~"dlmp.h
"

41 
	~"mpdef.h
"

42 
	~"rs485.h
"

43 
	~"c.h
"

44 
	~"du.h
"

45 
	~"bs.h
"

46 
	~"bys.h
"

47 
	~"baddr.h
"

48 
	~"rgbuf.h
"

49 
	~"tim.h
"

50 
	~"brd.h
"

58 
MSTP_RECEIVE_STATE
 
	gReive_S
;

61 
MSTP_MASTER_STATE
 
	gMa_S
;

63 
	smp_ag_t
 {

67 
	mReivedInvidFme
:1;

71 
	mReivedVidFme
:1;

73 
	mReivedVidFmeNFUs
:1;

76 
	mSeMa
:1;

79 
	mReivePackPdg
:1;

80 } 
	gMSTP_Fg
;

83 
ut32_t
 
	gDaLgth
;

85 
ut8_t
 
	gDeiAddss
;

89 
ut8_t
 
	gEvtCou
;

91 
ut8_t
 
	gFmeTy
;

98 
ut8_t
 *
	gIutBufr
;

99 
ut16_t
 
	gIutBufrSize
;

101 
ut8_t
 
	gSourAddss
;

106 
ut8_t
 
	gThis_Sti
;

114 
ut8_t
 
	gNmax_fo_ames
 = 1;

120 
ut8_t
 
	gNmax_ma
 = 127;

124 
	#Tno_tok
 500

	)

130 
	#Ty_timeout
 260

	)

136 
	#Tuge_timeout
 60

	)

140 
	#Npl
 50

	)

143 
	#Ny_tok
 1

	)

147 
	#Nm_os
 4

	)

155 
	#Tame_abt
 30

	)

159 
	#Tame_g
 20

	)

164 
	#Tpodrive
 15

	)

169 
	#Ty_day
 250

	)

173 
	#T
 10

	)

178 
	#Tuge_day
 15

	)

181 
	#INCREMENT_AND_LIMIT_UINT8
(
x
{i(x < 0xFFx++;}

	)

184 
	smp_pdu_ck
 {

185 
bo
 
	mda_exg_y
;

186 
ut8_t
 
	mdei_mac
;

187 
ut16_t
 
	mngth
;

188 
ut8_t
 
	mbufr
[
MAX_MPDU
];

191 #ide
MSTP_PDU_PACKET_COUNT


192 
	#MSTP_PDU_PACKET_COUNT
 2

	)

194 
mp_pdu_ck
 
	gPDU_Bufr
[
MSTP_PDU_PACKET_COUNT
];

195 
RING_BUFFER
 
	gPDU_Queue
;

197 
bo
 
	$dlmp_
(

198 *
iame
)

200 (
iame
;

202 
	`RS485_Inlize
();

203 
	`Rgbuf_In
(&
PDU_Queue
, (
ut8_t
 *& 
PDU_Bufr
,

204 (
mp_pdu_ck
), 
MSTP_PDU_PACKET_COUNT
);

206  
ue
;

207 
	}
}

209 
	$dlmp_nup
(

213 
	}
}

215 
	$dlmp_fl_ba_addss
(

216 
BACNET_ADDRESS
 * 
c
,

217 
ut8_t
 
mp_addss
)

219 
i
 = 0;

221 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

223 
c
->
mac_n
 = 0;

224 
c
->
mac
[0] = 0;

226 
c
->
mac_n
 = 1;

227 
c
->
mac
[0] = 
mp_addss
;

230 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

231 
c
->
mac
[
i
] = 0;

233 
c
->
t
 = 0;

234 
c
->
n
 = 0;

235 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

236 
c
->
adr
[
i
] = 0;

238 
	}
}

240 
bo
 
	$dlmp_com_da_exg_y
(

241 
ut8_t
 * 
que_pdu
,

242 
ut16_t
 
que_pdu_n
,

243 
ut8_t
 
c_addss
,

244 
ut8_t
 * 
y_pdu
,

245 
ut16_t
 
y_pdu_n
,

246 
ut8_t
 
de_addss
)

248 
ut16_t
 
offt
;

252 
	sDER_com_t
 {

253 
BACNET_NPDU_DATA
 
du_da
;

254 
BACNET_ADDRESS
 
addss
;

255 
ut8_t
 
pdu_ty
;

256 
ut8_t
 
voke_id
;

257 
ut8_t
 
rvi_choi
;

259 
DER_com_t
 
que
;

260 
DER_com_t
 
y
;

263 
que
.
addss
.
mac
[0] = 
c_addss
;

264 
que
.
addss
.
mac_n
 = 1;

265 
offt
 =

266 
	`du_decode
(&
que_pdu
[0], 
NULL
, &
que
.
addss
,

267 &
que
.
du_da
);

268 i(
que
.
du_da
.
twk_y_mesge
) {

269  
l
;

271 
que
.
pdu_ty
 = 
que_pdu
[
offt
] & 0xF0;

272 i(
que
.
pdu_ty
 !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
) {

273  
l
;

275 
que
.
voke_id
 = 
que_pdu
[
offt
 + 2];

277 i(
que_pdu
[
offt
] & 
BIT3
)

278 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 5];

280 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 3];

282 
y
.
addss
.
mac
[0] = 
de_addss
;

283 
y
.
addss
.
mac_n
 = 1;

284 
offt
 =

285 
	`du_decode
(&
y_pdu
[0], &
y
.
addss
, 
NULL
, &y.
du_da
);

286 i(
y
.
du_da
.
twk_y_mesge
) {

287  
l
;

291 
y
.
pdu_ty
 = 
y_pdu
[
offt
] & 0xF0;

292 
y
.
pdu_ty
) {

293 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

294 
y
.
voke_id
 = 
y_pdu
[
offt
 + 2];

296 i(
y_pdu
[
offt
] & 
BIT3
)

297 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 5];

299 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 3];

301 
PDU_TYPE_SIMPLE_ACK
:

302 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

303 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

305 
PDU_TYPE_COMPLEX_ACK
:

306 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

308 i(
y_pdu
[
offt
] & 
BIT3
)

309 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 4];

311 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

313 
PDU_TYPE_ERROR
:

314 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

315 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

317 
PDU_TYPE_REJECT
:

318 
PDU_TYPE_ABORT
:

319 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

322  
l
;

324 i(
que
.
voke_id
 !
y
.invoke_id) {

325  
l
;

328 i((
y
.
pdu_ty
 !
PDU_TYPE_REJECT
) &&

329 (
y
.
pdu_ty
 !
PDU_TYPE_ABORT
)) {

330 i(
que
.
rvi_choi
 !
y
.service_choice) {

331  
l
;

334 i(
que
.
du_da
.
oc_vsi
 !
y
.npdu_data.protocol_version) {

335  
l
;

340 i(
que
.
du_da
.
iܙy
 !
y
.npdu_data.priority) {

341  
l
;

344 i(!
	`ba_addss_me
(&
que
.
addss
, &
y
.address)) {

345  
l
;

348  
ue
;

349 
	}
}

364 
	$MSTP_Sd_Fme
(

365 
ut8_t
 
ame_ty
,

366 
ut8_t
 
dei
,

367 
ut8_t
 
sour
,

368 
ut8_t
 * 
da
,

369 
ut16_t
 
da_n
)

371 
ut8_t
 
c8
 = 0xFF;

372 
ut16_t
 
c16
 = 0xFFFF;

373 
ut8_t
 
bufr
[8];

374 
ut16_t
 
i
 = 0;

377 
bufr
[0] = 0x55;

378 
bufr
[1] = 0xFF;

379 
bufr
[2] = 
ame_ty
;

380 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[2], crc8);

381 
bufr
[3] = 
dei
;

382 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[3], crc8);

383 
bufr
[4] = 
sour
;

384 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[4], crc8);

385 
bufr
[5] = 
	`HI_BYTE
(
da_n
);

386 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[5], crc8);

387 
bufr
[6] = 
	`LO_BYTE
(
da_n
);

388 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[6], crc8);

389 
bufr
[7] = ~
c8
;

390 
	`RS485_Tuound_Day
();

391 
	`RS485_Tnsmr_Eb
(
ue
);

392 
	`RS485_Sd_Da
(
bufr
, 8);

394 i(
da_n
) {

396 
i
 = 0; i < 
da_n
; i++) {

397 
c16
 = 
	`CRC_Cc_Da
(
da
[
i
], crc16);

399 
c16
 = ~crc16;

400 
bufr
[0] = (
c16
 & 0x00FF);

401 
bufr
[1] = ((
c16
 & 0xFF00) >> 8);

402 
	`RS485_Sd_Da
(
da
, 
da_n
);

403 
	`RS485_Sd_Da
(
bufr
, 2);

405 
	`RS485_Tnsmr_Eb
(
l
);

406 
	}
}

408 
	$MSTP_Reive_Fme_FSM
(

412 
ut8_t
 
DaRegi
 = 0;

414 
ut16_t
 
DaCRC
 = 0;

416 
ut8_t
 
HdCRC
 = 0;

419 
ut16_t
 
Index
 = 0;

421 
Reive_S
) {

422 
MSTP_RECEIVE_STATE_IDLE
:

425 i(
	`RS485_ReiveE
()) {

427 
	`Tim_S_Ret
();

428 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

429 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

430 
	`Tim_S_Ret
();

431 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

432 i(
DaRegi
 == 0x55) {

435 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

439 
MSTP_RECEIVE_STATE_PREAMBLE
:

442 i(
	`Tim_S
(> 
Tame_abt
) {

446 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

447 } i(
	`RS485_ReiveE
()) {

449 
	`Tim_S_Ret
();

450 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

452 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

453 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

454 
	`Tim_S_Ret
();

455 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

456 i(
DaRegi
 == 0xFF) {

458 
Index
 = 0;

459 
HdCRC
 = 0xFF;

461 
Reive_S
 = 
MSTP_RECEIVE_STATE_HEADER
;

462 } i(
DaRegi
 == 0x55) {

465 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

469 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

473 
MSTP_RECEIVE_STATE_HEADER
:

476 i(
	`Tim_S
(> 
Tame_abt
) {

480 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

482 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

483 } i(
	`RS485_ReiveE
()) {

485 
	`Tim_S_Ret
();

486 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

489 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

491 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

492 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

493 
	`Tim_S_Ret
();

494 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

495 i(
Index
 == 0) {

497 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

498 
FmeTy
 = 
DaRegi
;

499 
Index
 = 1;

500 } i(
Index
 == 1) {

502 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

503 
DeiAddss
 = 
DaRegi
;

504 
Index
 = 2;

505 } i(
Index
 == 2) {

507 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

508 
SourAddss
 = 
DaRegi
;

509 
Index
 = 3;

510 } i(
Index
 == 3) {

512 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

513 
DaLgth
 = 
DaRegi
 * 256;

514 
Index
 = 4;

515 } i(
Index
 == 4) {

517 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

518 
DaLgth
 +
DaRegi
;

519 
Index
 = 5;

520 } i(
Index
 == 5) {

522 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

525 i(
HdCRC
 != 0x55) {

529 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

531 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

533 i(
DaLgth
 == 0) {

535 i((
DeiAddss
 =
This_Sti
) ||

536 (
DeiAddss
 ==

537 
MSTP_BROADCAST_ADDRESS
)) {

541 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

544 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
ue
;

547 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

550 i((
DeiAddss
 =
This_Sti
) ||

551 (
DeiAddss
 ==

552 
MSTP_BROADCAST_ADDRESS
)) {

553 i(
DaLgth
 <
IutBufrSize
) {

555 
Reive_S
 = 
MSTP_RECEIVE_STATE_DATA
;

558 
Reive_S
 =

559 
MSTP_RECEIVE_STATE_SKIP_DATA
;

563 
Reive_S
 = 
MSTP_RECEIVE_STATE_SKIP_DATA
;

565 
Index
 = 0;

566 
DaCRC
 = 0xFFFF;

572 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

574 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

578 
MSTP_RECEIVE_STATE_DATA
:

579 
MSTP_RECEIVE_STATE_SKIP_DATA
:

582 i(
	`Tim_S
(> 
Tame_abt
) {

586 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

588 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

589 } i(
	`RS485_ReiveE
()) {

591 
	`Tim_S_Ret
();

592 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

595 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

597 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

598 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

599 
	`Tim_S_Ret
();

600 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

601 i(
Index
 < 
DaLgth
) {

603 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

604 i(
Index
 < 
IutBufrSize
) {

605 
IutBufr
[
Index
] = 
DaRegi
;

607 
Index
++;

608 } i(
Index
 =
DaLgth
) {

610 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

611 
Index
++;

612 } i(
Index
 =(
DaLgth
 + 1)) {

614 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

617 i(
DaCRC
 == 0xF0B8) {

618 i(
Reive_S
 =
MSTP_RECEIVE_STATE_DATA
) {

620 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

623 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
ue
;

626 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

628 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

630 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

631 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

637 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

642 
	}
}

645 
bo
 
	$MSTP_Ma_Node_FSM
(

651 
ut8_t
 
FmeCou
;

655 
ut8_t
 
Next_Sti
;

658 
ut8_t
 
Pl_Sti
;

661 
RryCou
;

666 
TokCou
;

668 
ut8_t
 
xt_pl_i
 = 0;

669 
ut8_t
 
xt_this_i
 = 0;

670 
ut8_t
 
xt_xt_i
 = 0;

672 
ut16_t
 
my_timeout
 = 10, 
ns_timeout
 = 0;

673 
bo
 
mched
 = 
l
;

675 
bo
 
si_now
 = 
l
;

677 
mp_pdu_ck
 *
pkt
;

680 
xt_pl_i
 = (
Pl_Sti
 + 1% (
Nmax_ma
 + 1);

681 
xt_this_i
 = (
This_Sti
 + 1% (
Nmax_ma
 + 1);

682 
xt_xt_i
 = (
Next_Sti
 + 1% (
Nmax_ma
 + 1);

683 
Ma_S
) {

684 
MSTP_MASTER_STATE_INITIALIZE
:

687 
Next_Sti
 = 
This_Sti
;

688 
Pl_Sti
 = 
This_Sti
;

691 
TokCou
 = 
Npl
;

692 
MSTP_Fg
.
SeMa
 = 
l
;

693 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

694 
si_now
 = 
ue
;

696 
MSTP_MASTER_STATE_IDLE
:

698 i(
	`Tim_S
(>
Tno_tok
) {

701 
EvtCou
 = 0;

704 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

705 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

706 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

707 
Ma_S
 = 
MSTP_MASTER_STATE_NO_TOKEN
;

708 
si_now
 = 
ue
;

709 } i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

712 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

714 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

715 
FmeTy
) {

716 
FRAME_TYPE_TOKEN
:

719 i(
DeiAddss
 =
MSTP_BROADCAST_ADDRESS
)

721 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

722 
FmeCou
 = 0;

723 
MSTP_Fg
.
SeMa
 = 
l
;

724 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

725 
si_now
 = 
ue
;

727 
FRAME_TYPE_POLL_FOR_MASTER
:

730 i(
DeiAddss
 =
This_Sti
) {

731 
	`MSTP_Sd_Fme
(

732 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

733 
SourAddss
, 
This_Sti
, 
NULL
, 0);

736 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

738 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

740 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

742 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

744 i(
DeiAddss
 !
MSTP_BROADCAST_ADDRESS
) {

745 
Ma_S
 =

746 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
;

749 
FRAME_TYPE_TEST_REQUEST
:

750 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TEST_RESPONSE
,

751 
SourAddss
, 
This_Sti
, &
IutBufr
[0],

752 
DaLgth
);

754 
FRAME_TYPE_TEST_RESPONSE
:

760 i(
Ma_S
 !
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
) {

761 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

768 
MSTP_MASTER_STATE_USE_TOKEN
:

770 i(
	`Rgbuf_Emy
(&
PDU_Queue
)) {

772 
FmeCou
 = 
Nmax_fo_ames
;

773 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

774 
si_now
 = 
ue
;

776 
ut8_t
 
ame_ty
;

777 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
PDU_Queue
);

778 i(
pkt
->
da_exg_y
) {

779 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

781 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

783 
	`MSTP_Sd_Fme
(
ame_ty
, 
pkt
->
dei_mac
, 
This_Sti
,

784 (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

785 
FmeCou
++;

786 
ame_ty
) {

787 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

789 i(
pkt
->
dei_mac
 =
MSTP_BROADCAST_ADDRESS
)

790 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

792 
Ma_S
 = 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

794 
FRAME_TYPE_TEST_REQUEST
:

795 
Ma_S
 = 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

797 
FRAME_TYPE_TEST_RESPONSE
:

798 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

801 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

804 (
	`Rgbuf_P
(&
PDU_Queue
, 
NULL
);

807 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

810 i(
	`Tim_S
(>
Ty_timeout
) {

813 
FmeCou
 = 
Nmax_fo_ames
;

814 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

821 
si_now
 = 
ue
;

823 i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

826 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

827 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

828 
si_now
 = 
ue
;

829 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

830 i(
DeiAddss
 =
This_Sti
) {

832 
FmeTy
) {

833 
FRAME_TYPE_REPLY_POSTPONED
:

835 
Ma_S
 =

836 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

838 
FRAME_TYPE_TEST_RESPONSE
:

839 
Ma_S
 =

840 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

842 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

848 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

849 
Ma_S
 =

850 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

855 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

866 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

868 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

869 
si_now
 = 
ue
;

875 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
:

877 i(
FmeCou
 < 
Nmax_fo_ames
) {

880 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

881 
si_now
 = 
ue
;

882 } i((
MSTP_Fg
.
SeMa
 =
l
) &&

883 (
Next_Sti
 =
This_Sti
)) {

887 
Pl_Sti
 = 
xt_this_i
;

888 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

889 
This_Sti
, 
NULL
, 0);

890 
RryCou
 = 0;

891 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

892 } i(
TokCou
 < (
Npl
 - 1)) {

894 i((
MSTP_Fg
.
SeMa
 =
ue
) &&

895 (
Next_Sti
 !
xt_this_i
)) {

900 
FmeCou
 = 0;

901 
TokCou
++;

902 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

903 
si_now
 = 
ue
;

913 
TokCou
++;

915 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

916 
This_Sti
, 
NULL
, 0);

917 
RryCou
 = 0;

918 
EvtCou
 = 0;

919 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

921 } i(
xt_pl_i
 =
Next_Sti
) {

922 i(
MSTP_Fg
.
SeMa
 =
ue
) {

924 
Pl_Sti
 = 
xt_xt_i
;

925 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

926 
This_Sti
, 
NULL
, 0);

928 
Next_Sti
 = 
This_Sti
;

929 
RryCou
 = 0;

930 
TokCou
 = 1;

933 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

936 
Pl_Sti
 = 
This_Sti
;

938 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

939 
This_Sti
, 
NULL
, 0);

940 
RryCou
 = 0;

941 
TokCou
 = 1;

942 
EvtCou
 = 0;

943 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

947 
Pl_Sti
 = 
xt_pl_i
;

948 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

949 
This_Sti
, 
NULL
, 0);

950 
RryCou
 = 0;

951 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

956 
MSTP_MASTER_STATE_PASS_TOKEN
:

957 i(
	`Tim_S
(<
Tuge_timeout
) {

958 i(
EvtCou
 > 
Nm_os
) {

963 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

964 
si_now
 = 
ue
;

967 i(
RryCou
 < 
Ny_tok
) {

969 
RryCou
++;

971 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

972 
This_Sti
, 
NULL
, 0);

973 
EvtCou
 = 0;

980 
Pl_Sti
 = 
xt_xt_i
;

982 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

983 
This_Sti
, 
NULL
, 0);

985 
Next_Sti
 = 
This_Sti
;

986 
RryCou
 = 0;

987 
TokCou
 = 0;

990 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

999 
MSTP_MASTER_STATE_NO_TOKEN
:

1000 
my_timeout
 = 
Tno_tok
 + (
T
 * 
This_Sti
);

1001 i(
	`Tim_S
(< 
my_timeout
) {

1002 i(
EvtCou
 > 
Nm_os
) {

1007 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1008 
si_now
 = 
ue
;

1011 
ns_timeout
 = 
Tno_tok
 + (
T
 * (
This_Sti
 + 1));

1012 i(
	`Tim_S
(< 
ns_timeout
) {

1016 
Pl_Sti
 = 
xt_this_i
;

1018 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

1019 
This_Sti
, 
NULL
, 0);

1021 
Next_Sti
 = 
This_Sti
;

1022 
RryCou
 = 0;

1023 
TokCou
 = 0;

1027 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1034 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

1035 i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

1036 i((
DeiAddss
 =
This_Sti
)

1037 && (
FmeTy
 =
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
)) {

1039 
MSTP_Fg
.
SeMa
 = 
l
;

1040 
Next_Sti
 = 
SourAddss
;

1041 
EvtCou
 = 0;

1043 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1044 
This_Sti
, 
NULL
, 0);

1045 
Pl_Sti
 = 
This_Sti
;

1046 
TokCou
 = 0;

1047 
RryCou
 = 0;

1048 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1055 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1056 
si_now
 = 
ue
;

1058 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1059 } i((
	`Tim_S
(> 
Tuge_timeout
) ||

1060 (
MSTP_Fg
.
ReivedInvidFme
 =
ue
)) {

1061 i(
MSTP_Fg
.
SeMa
 =
ue
) {

1065 
FmeCou
 = 0;

1067 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1068 
si_now
 = 
ue
;

1070 i(
Next_Sti
 !
This_Sti
) {

1074 
EvtCou
 = 0;

1076 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1077 
This_Sti
, 
NULL
, 0);

1078 
RryCou
 = 0;

1079 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1081 i(
xt_pl_i
 !
This_Sti
) {

1083 
Pl_Sti
 = 
xt_pl_i
;

1085 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
,

1086 
Pl_Sti
, 
This_Sti
, 
NULL
, 0);

1087 
RryCou
 = 0;

1093 
MSTP_Fg
.
SeMa
 = 
ue
;

1094 
FmeCou
 = 0;

1095 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1096 
si_now
 = 
ue
;

1100 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

1106 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
:

1107 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
PDU_Queue
);

1108 i(
pkt
 !
NULL
) {

1109 
mched
 =

1110 
	`dlmp_com_da_exg_y
(&
IutBufr
[0],

1111 
DaLgth
, 
SourAddss
, &
pkt
->
bufr
[0],kt->
ngth
,

1112 
pkt
->
dei_mac
);

1114 
mched
 = 
l
;

1116 i(
mched
) {

1124 
ut8_t
 
ame_ty
;

1125 i(
pkt
->
da_exg_y
) {

1126 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

1128 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

1130 
	`MSTP_Sd_Fme
(
ame_ty
, 
pkt
->
dei_mac
, 
This_Sti
,

1131 (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

1132 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1134 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1136 (
	`Rgbuf_P
(&
PDU_Queue
, 
NULL
);

1137 } i((
	`Tim_S
(> 
Ty_day
|| (
pkt
 !
NULL
)) {

1147 
	`MSTP_Sd_Fme
(
FRAME_TYPE_REPLY_POSTPONED
, 
SourAddss
,

1148 
This_Sti
, 
NULL
, 0);

1149 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1151 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1155 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1159  
si_now
;

1160 
	}
}

1162 
	$MSTP_Sve_Node_FSM
(

1166 
mp_pdu_ck
 *
pkt
;

1168 
bo
 
mched
 = 
l
;

1170 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1171 i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

1174 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

1175 } i(
MSTP_Fg
.
ReivedVidFme
) {

1176 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1177 
FmeTy
) {

1178 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

1179 i(
DeiAddss
 !
MSTP_BROADCAST_ADDRESS
) {

1181 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

1184 
FRAME_TYPE_TEST_REQUEST
:

1185 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TEST_RESPONSE
, 
SourAddss
,

1186 
This_Sti
, &
IutBufr
[0], 
DaLgth
);

1188 
FRAME_TYPE_TOKEN
:

1189 
FRAME_TYPE_POLL_FOR_MASTER
:

1190 
FRAME_TYPE_TEST_RESPONSE
:

1191 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

1195 } i(
MSTP_Fg
.
ReivePackPdg
) {

1196 i(!
	`Rgbuf_Emy
(&
PDU_Queue
)) {

1197 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
PDU_Queue
);

1198 
mched
 =

1199 
	`dlmp_com_da_exg_y
(&
IutBufr
[0],

1200 
DaLgth
, 
SourAddss
, &
pkt
->
bufr
[0],kt->
ngth
,

1201 
pkt
->
dei_mac
);

1202 i(
mched
) {

1210 
ut8_t
 
ame_ty
;

1211 i(
pkt
->
da_exg_y
) {

1212 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

1214 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

1216 
	`MSTP_Sd_Fme
(
ame_ty
, 
pkt
->
dei_mac
, 
This_Sti
,

1217 (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

1218 (
	`Rgbuf_P
(&
PDU_Queue
, 
NULL
);

1221 
MSTP_Fg
.
ReivePackPdg
 = 
l
;

1222 } i((
	`Tim_S
(> 
Ty_day
)) {

1228 
MSTP_Fg
.
ReivePackPdg
 = 
l
;

1231 
	}
}

1234 
	$dlmp_nd_pdu
(

1235 
BACNET_ADDRESS
 * 
de
,

1236 
BACNET_NPDU_DATA
 * 
du_da
,

1237 
ut8_t
 * 
pdu
,

1238 
pdu_n
)

1240 
bys_
 = 0;

1241 
mp_pdu_ck
 *
pkt
;

1242 
ut16_t
 
i
 = 0;

1244 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Da_Pk
(&
PDU_Queue
);

1245 i(
pkt
) {

1246 
pkt
->
da_exg_y
 = 
du_da
->data_expecting_reply;

1247 
i
 = 0; i < 
pdu_n
; i++) {

1248 
pkt
->
bufr
[
i
] = 
pdu
[i];

1250 
pkt
->
ngth
 = 
pdu_n
;

1251 i(
de
 && de->
mac_n
) {

1252 
pkt
->
dei_mac
 = 
de
->
mac
[0];

1255 
pkt
->
dei_mac
 = 
MSTP_BROADCAST_ADDRESS
;

1257 i(
	`Rgbuf_Da_Put
(&
PDU_Queue
, (
ut8_t
 *)
pkt
)) {

1258 
bys_
 = 
pdu_n
;

1262  
bys_
;

1263 
	}
}

1266 
ut16_t
 
	$dlmp_ive
(

1267 
BACNET_ADDRESS
 * 
c
,

1268 
ut8_t
 * 
pdu
,

1269 
ut16_t
 
max_pdu
,

1270 
timeout
)

1272 
ut16_t
 
pdu_n
 = 0;

1275 i(!
IutBufr
) {

1276 
IutBufr
 = 
pdu
;

1277 
IutBufrSize
 = 
max_pdu
;

1279 (
MSTP_Fg
.
ReivedVidFme
 =
l
) &&

1280 (
MSTP_Fg
.
ReivedVidFmeNFUs
 =
l
) &&

1281 (
MSTP_Fg
.
ReivedInvidFme
 =
l
)) {

1283 
	`MSTP_Reive_Fme_FSM
();

1285 i(!
	`RS485_DaAvaab
(
NULL
)) {

1289 i(
MSTP_Fg
.
ReivedVidFmeNFUs
) {

1290 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

1292 i(
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
) {

1294 i(
This_Sti
 <= 127) {

1295 
	`MSTP_Ma_Node_FSM
()) {

1298 } i(
This_Sti
 < 255) {

1299 
	`MSTP_Sve_Node_FSM
();

1303 i(
MSTP_Fg
.
ReivePackPdg
) {

1304 
MSTP_Fg
.
ReivePackPdg
 = 
l
;

1305 
pdu_n
 = 
DaLgth
;

1306 
c
->
mac_n
 = 1;

1307 
c
->
mac
[0] = 
SourAddss
;

1311  
pdu_n
;

1312 
	}
}

1314 
	$dlmp_t_mac_addss
(

1315 
ut8_t
 
mac_addss
)

1318 i(
mac_addss
 <= 127) {

1319 
This_Sti
 = 
mac_addss
;

1325 i(
mac_addss
 > 
Nmax_ma
)

1326 
	`dlmp_t_max_ma
(127);

1330 
	}
}

1332 
ut8_t
 
	$dlmp_mac_addss
(

1335  
This_Sti
;

1336 
	}
}

1345 
	$dlmp_t_max_fo_ames
(

1346 
ut8_t
 
max_fo_ames
)

1348 i(
max_fo_ames
 >= 1) {

1349 
Nmax_fo_ames
 = 
max_fo_ames
;

1358 
	}
}

1360 
ut8_t
 
	$dlmp_max_fo_ames
(

1363  
Nmax_fo_ames
;

1364 
	}
}

1371 
	$dlmp_t_max_ma
(

1372 
ut8_t
 
max_ma
)

1374 i(
max_ma
 <= 127) {

1375 i(
This_Sti
 <
max_ma
) {

1376 
Nmax_ma
 = 
max_ma
;

1386 
	}
}

1388 
ut8_t
 
	$dlmp_max_ma
(

1391  
Nmax_ma
;

1392 
	}
}

1394 
	$dlmp_g_my_addss
(

1395 
BACNET_ADDRESS
 * 
my_addss
)

1397 
i
 = 0;

1399 
my_addss
->
mac_n
 = 1;

1400 
my_addss
->
mac
[0] = 
This_Sti
;

1401 
my_addss
->
t
 = 0;

1402 
my_addss
->
n
 = 0;

1403 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1404 
my_addss
->
adr
[
i
] = 0;

1408 
	}
}

1410 
	$dlmp_g_brd_addss
(

1411 
BACNET_ADDRESS
 * 
de
)

1413 
i
 = 0;

1415 i(
de
) {

1416 
de
->
mac_n
 = 1;

1417 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

1418 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

1419 
de
->
n
 = 0;

1420 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1421 
de
->
adr
[
i
] = 0;

1426 
	}
}

	@ports/at91sam7s/init.c

18 
	~"brd.h
"

22 
AT91F_Spurious_hdr
(

24 
AT91F_Deu_IRQ_hdr
(

26 
AT91F_Deu_FIQ_hdr
(

35 
	$LowLevIn
(

38 
i
;

39 
AT91PS_PMC
 
pPMC
 = 
AT91C_BASE_PMC
;

45 
AT91C_BASE_MC
->
MC_FMR
 =

46 (((
AT91C_MC_FMCN
& (50 << 16)| 
AT91C_MC_FWS_1FWS
);

50 
AT91C_BASE_WDTC
->
WDTC_WDMR
 = 
AT91C_WDTC_WDDIS
;

57 
pPMC
->
PMC_MOR
 = ((
AT91C_CKGR_OSCOUNT
 & (0x06 << 8)| 
AT91C_CKGR_MOSCEN
);

60 !(
pPMC
->
PMC_SR
 & 
AT91C_PMC_MOSCS
));

79 
pPMC
->
PMC_PLLR
 =

80 ((
AT91C_CKGR_DIV
 & 14| (
AT91C_CKGR_PLLCOUNT
 & (10 << 8)) |

81 (
AT91C_CKGR_MUL
 & (72 << 16)));

84 !(
pPMC
->
PMC_SR
 & 
AT91C_PMC_LOCK
));

94 
pPMC
->
PMC_MCKR
 = 
AT91C_PMC_CSS_PLL_CLK
 | 
AT91C_PMC_PRES_CLK_2
;

97 
AT91C_BASE_AIC
->
AIC_SVR
[0] = (
AT91F_Deu_FIQ_hdr
;

98 
i
 = 1; i < 31; i++) {

99 
AT91C_BASE_AIC
->
AIC_SVR
[
i
] = (
AT91F_Deu_IRQ_hdr
;

101 
AT91C_BASE_AIC
->
AIC_SPU
 = (
AT91F_Spurious_hdr
;

102 
	}
}

	@ports/at91sam7s/irq.c

10 
	$AT91F_Spurious_hdr
(

14 
	}
}

19 
	$AT91F_Deu_FIQ_hdr
(

23 
	}
}

28 
	$AT91F_Deu_IRQ_hdr
(

32 
	}
}

	@ports/at91sam7s/isr.c

20 
	#IRQ_MASK
 0x00000080

	)

21 
	#FIQ_MASK
 0x00000040

	)

22 
	#INT_MASK
 (
IRQ_MASK
 | 
FIQ_MASK
)

	)

24 
le
 
	$__g_
(

27 
tv
;

28 
asm
 volatile (

29 " mr %0, cp":"" (
tv
): );

30  
tv
;

31 
	}
}

33 
le
 
	$__t_
(

34 
v
)

36 
asm
 volatile (

37 " m cp, %0": :"r" (
v
));

38 
	}
}

40 
	$dibIRQ
(

43 
_
;

44 
_
 = 
	`__g_
();

45 
	`__t_
(
_
 | 
IRQ_MASK
);

46  
_
;

47 
	}
}

49 
	$eIRQ
(

50 
dCPSR
)

52 
_
;

54 
_
 = 
	`__g_
();

55 
	`__t_
((
_
 & ~
IRQ_MASK
| (
dCPSR
 & IRQ_MASK));

56  
_
;

57 
	}
}

59 
	$abIRQ
(

62 
_
;

64 
_
 = 
	`__g_
();

65 
	`__t_
(
_
 & ~
IRQ_MASK
);

66  
_
;

67 
	}
}

69 
	$dibFIQ
(

72 
_
;

74 
_
 = 
	`__g_
();

75 
	`__t_
(
_
 | 
FIQ_MASK
);

76  
_
;

77 
	}
}

79 
	$eFIQ
(

80 
dCPSR
)

82 
_
;

84 
_
 = 
	`__g_
();

85 
	`__t_
((
_
 & ~
FIQ_MASK
| (
dCPSR
 & FIQ_MASK));

86  
_
;

87 
	}
}

89 
	$abFIQ
(

92 
_
;

94 
_
 = 
	`__g_
();

95 
	`__t_
(
_
 & ~
FIQ_MASK
);

96  
_
;

97 
	}
}

	@ports/at91sam7s/isr.h

26 #ide
ISR_H


27 
	#ISR_H


	)

29 
	~<dt.h
>

31 #i
defed
(
__ICCARM__
)

32 
	~<sics.h
>

33 
	#i_ab
(
	`__ab_u
()

	)

34 
	#i_dib
(
	`__dib_u
()

	)

36 #i
defed
(
__GNUC__
)

37 
	#i_ab
(
	`abIRQ
();
	`abFIQ
();

	)

38 
	#i_dib
(
	`dibFIQ
();
	`dibIRQ
();

	)

41 #ifde
__lulus


45 
dibIRQ
(

48 
eIRQ
(

49 
dCPSR
);

51 
abIRQ
(

54 
dibFIQ
(

57 
eFIQ
(

58 
dCPSR
);

60 
abFIQ
(

63 #ifde
__lulus


	@ports/at91sam7s/main.c

27 
	~"brd.h
"

28 
	~"tim.h
"

30 
	~<dlib.h
>

31 
	~<rg.h
>

32 
	~<dbo.h
>

33 
	~<dt.h
>

35 
	~"rs485.h
"

36 
	~"dk.h
"

37 
	~"du.h
"

38 
	~"du.h
"

39 
	~"dcc.h
"

40 
	~"m.h
"

41 
	~"hdrs.h
"

42 
	~".h
"

43 
	~"devi.h
"

44 
	~"dcc.h
"

45 
	~"m.h
"

46 
	~"txbuf.h
"

51 
LowLevIn
(

53 
abIRQ
(

55 
abFIQ
(

59 
	gFiqCou
 = 0;

61 
	gLED_Tim_1
 = 0;

62 
	gLED_Tim_2
 = 0;

63 
	gLED_Tim_3
 = 0;

64 
	gLED_Tim_4
 = 1000;

65 
	gDCC_Tim
 = 1000;

67 
	#LEDS_ENABLED


	)

68 
	#RS485_ENABLED


	)

70 
le
 
	$mlicd_tim
(

73 
Tim_Mlicds
) {

74 
Tim_Mlicds
--;

75 i(
LED_Tim_1
) {

76 
LED_Tim_1
--;

78 i(
LED_Tim_2
) {

79 
LED_Tim_2
--;

81 i(
LED_Tim_3
) {

82 
LED_Tim_3
--;

84 i(
LED_Tim_4
) {

85 
LED_Tim_4
--;

87 i(
DCC_Tim
) {

88 
DCC_Tim
--;

92 
	}
}

94 
le
 
	$
(

98 vީ
AT91PS_PMC
 
pPMC
 = 
AT91C_BASE_PMC
;

99 
pPMC
->
PMC_PCER
 =PMC->
PMC_PCSR
 | (1 << 
AT91C_ID_PIOA
);

101 #ifde
LEDS_ENABLED


103 vީ
AT91PS_PIO
 
pPIO
 = 
AT91C_BASE_PIOA
;

106 
pPIO
->
PIO_PER
 = 
LED_MASK
 | 
SW1_MASK
;

109 
pPIO
->
PIO_OER
 = 
LED_MASK
;

112 
pPIO
->
PIO_SODR
 = 
LED_MASK
;

115 
pPIO
->
PIO_BSR
 = 
SW1_MASK
;

118 vީ
AT91PS_AIC
 
pAIC
 = 
AT91C_BASE_AIC
;

121 
pAIC
->
AIC_IDCR
 = (1 << 
AT91C_ID_FIQ
);

124 
pAIC
->
AIC_SMR
[
AT91C_ID_FIQ
] = (
AT91C_AIC_SRCTYPE_INT_EDGE_TRIGGERED
);

127 
pAIC
->
AIC_ICCR
 = (1 << 
AT91C_ID_FIQ
);

130 
pAIC
->
AIC_IDCR
 = (0 << 
AT91C_ID_FIQ
);

133 
pAIC
->
AIC_IECR
 = (1 << 
AT91C_ID_FIQ
);

135 
	}
}

137 
le
 
	$ba_
(

140 #i
	`defed
(
BACDL_MSTP
)

141 
ut8_t
 
MAC_Addss
 = 0x55;

143 
	`RS485_S_Baud_Re
(38400);

144 
	`dlmp_t_mac_addss
(
MAC_Addss
);

145 
	`dlmp_t_max_ma
(127);

146 
	`dlmp_t_max_fo_ames
(1);

147 
	`dlmp_
(
NULL
);

149 
	`Devi_S_Obje_In_Numb
(22222);

151 
	`Devi_In
(
NULL
);

153 
du_t_uecognized_rvi_hdr_hdr


154 (
hdr_uecognized_rvi
);

155 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_HAS
, 
hdr_who_has
);

157 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

160 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

161 
hdr_ad_ݔty
);

162 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

163 
hdr_ad_ݔty_muɝ
);

164 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

165 
hdr_lize_devi
);

166 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

167 
hdr_wre_ݔty
);

169 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

170 
hdr_devi_communiti_cڌ
);

171 
	}
}

173 
ut8_t
 
	gReive_PDU
[
MAX_MPDU
];

174 
	$ma
(

177 
IdCou
 = 0;

178 
ut16_t
 
pdu_n
 = 0;

179 
BACNET_ADDRESS
 
c
;

180 #ifde
LEDS_ENABLED


181 
bo
 
LED1_Off_Ebd
 = 
ue
;

182 
bo
 
LED2_Off_Ebd
 = 
ue
;

183 
bo
 
LED3_Off_Ebd
 = 
ue
;

185 vީ
AT91PS_PIO
 
pPIO
 = 
AT91C_BASE_PIOA
;

190 
	`LowLevIn
();

191 
	`TimIn
();

192 
	`
();

193 
	`ba_
();

195 
	`i_ab
();

197 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

200 
	`mlicd_tim
();

201 i(!
DCC_Tim
) {

202 
	`dcc_tim_cds
(1);

203 
DCC_Tim
 = 1000;

205 #ifde
LEDS_ENABLED


207 i(((
pPIO
->
PIO_ODSR
 & 
LED1
=LED1&& (
LED1_Off_Ebd
)) {

208 
LED1_Off_Ebd
 = 
l
;

210 
LED_Tim_1
 = 20;

212 i(!
LED_Tim_1
) {

214 
pPIO
->
PIO_SODR
 = 
LED1
;

215 
LED1_Off_Ebd
 = 
ue
;

218 i(((
pPIO
->
PIO_ODSR
 & 
LED2
=LED2&& (
LED2_Off_Ebd
)) {

219 
LED2_Off_Ebd
 = 
l
;

221 
LED_Tim_2
 = 20;

223 i(!
LED_Tim_2
) {

225 
pPIO
->
PIO_SODR
 = 
LED2
;

226 
LED2_Off_Ebd
 = 
ue
;

229 i(((
pPIO
->
PIO_ODSR
 & 
LED3
=LED3&& (
LED3_Off_Ebd
)) {

230 
LED3_Off_Ebd
 = 
l
;

232 
LED_Tim_3
 = 500;

234 i(!
LED_Tim_3
) {

236 
pPIO
->
PIO_SODR
 = 
LED3
;

237 
LED3_Off_Ebd
 = 
ue
;

240 i(!
LED_Tim_4
) {

241 i((
pPIO
->
PIO_ODSR
 & 
LED4
) == LED4) {

243 
pPIO
->
PIO_CODR
 = 
LED4
;

246 
pPIO
->
PIO_SODR
 = 
LED4
;

249 
LED_Tim_4
 = 1000;

253 
IdCou
++;

255 
pdu_n
 =

256 
	`dk_ive
(&
c
, &
Reive_PDU
[0], (Receive_PDU), 0);

257 i(
pdu_n
) {

258 #ifde
LEDS_ENABLED


259 
pPIO
->
PIO_CODR
 = 
LED3
;

261 
	`du_hdr
(&
c
, &
Reive_PDU
[0], 
pdu_n
);

264 
	}
}

	@ports/at91sam7s/rs485.c

30 
	~<ddef.h
>

31 
	~<dt.h
>

32 
	~<dbo.h
>

33 
	~<dlib.h
>

34 
	~<dio.h
>

35 
	~"tim.h
"

39 
	~"brd.h
"

42 vީ
AT91S_USART
 *
	gRS485_I
 = 
AT91C_BASE_US0
;

44 
	gRS485_Baud
 = 38400;

55 
	#Ttuound
 (40UL)

	)

65 
	$RS485_Inlize
(

69 vީ
AT91PS_PMC
 
pPMC
 = 
AT91C_BASE_PMC
;

70 
pPMC
->
PMC_PCER
 =PMC->
PMC_PCSR
 | (1 << 
AT91C_ID_US0
);

74 vީ
AT91PS_AIC
 
pAIC
 = 
AT91C_BASE_AIC
;

75 
pAIC
->
AIC_IDCR
 = (1 << 
AT91C_ID_US0
);

76 
pAIC
->
AIC_ICCR
 = (1 << 
AT91C_ID_US0
);

79 *
AT91C_PIOA_PDR
 = 
AT91C_PA5_RXD0
 | 
AT91C_PA6_TXD0
 | 
AT91C_PA7_RTS0
;

81 
RS485_I
->
US_CR
 = 
AT91C_US_RSTRX
 |

82 
AT91C_US_RSTTX
 |

83 
AT91C_US_RSTSTA
 |

84 
AT91C_US_RXDIS
 |

85 
AT91C_US_TXDIS
;

87 
RS485_I
->
US_MR
 = 
AT91C_US_USMODE_RS485
 |

88 
AT91C_US_CLKS_CLOCK
 |

89 
AT91C_US_CHRL_8_BITS
 |

90 
AT91C_US_PAR_NONE
 |

91 
AT91C_US_NBSTOP_1_BIT
;

94 
RS485_I
->
US_TTGR
 = 1;

97 
RS485_I
->
US_RTOR
 = 0;

100 
RS485_I
->
US_BRGR
 = 
MCK
 / 16 / 
RS485_Baud
;

102 
RS485_I
->
US_CR
 = 
AT91C_US_RXEN
 |

103 
AT91C_US_TXEN
;

106 
	}
}

108 
	$RS485_C˪up
(

112 
	}
}

120 
ut32_t
 
	$RS485_G_Baud_Re
(

123  
RS485_Baud
;

124 
	}
}

132 
bo
 
	$RS485_S_Baud_Re
(

133 
ut32_t
 
baud
)

135 
bo
 
vid
 = 
ue
;

137 
baud
) {

144 
RS485_Baud
 = 
baud
;

145 
RS485_I
->
US_BRGR
 = 
MCK
 / 16 / 
baud
;

149 
vid
 = 
l
;

153  
vid
;

154 
	}
}

162 
	$RS485_Tuound_Day
(

165 
ut16_t
 
tuound_time
;

170 
tuound_time
 = 2 + ((
Ttuound
 * 1000UL/ 
RS485_Baud
);

171 
	`Tim_S
(< 
tuound_time
) {

174 
	}
}

182 
	$RS485_Tnsmr_Eb
(

183 
bo
 
ab
)

185 (
ab
;

186 
	}
}

194 
	$RS485_Sd_Da
(

195 
ut8_t
 * 
bufr
,

196 
ut16_t
 
nbys
)

199 vީ
AT91PS_PIO
 
pPIO
 = 
AT91C_BASE_PIOA
;

201 
pPIO
->
PIO_CODR
 = 
LED1
;

203 
nbys
) {

204 !(
RS485_I
->
US_CSR
 & 
AT91C_US_TXRDY
)) {

207 
RS485_I
->
US_THR
 = *
bufr
;

208 
bufr
++;

209 
nbys
--;

211 !(
RS485_I
->
US_CSR
 & 
AT91C_US_TXRDY
)) {

215 
	`Tim_S_Ret
();

216 
	}
}

224 
bo
 
	$RS485_ReiveE
(

227 
bo
 
ReiveE
 = 
l
;

229 vީ
AT91PS_PIO
 
pPIO
 = 
AT91C_BASE_PIOA
;

232 i(
RS485_I
->
US_CSR
 & (
AT91C_US_OVRE
 | 
AT91C_US_FRAME
)) {

234 
RS485_I
->
US_CR
 = 
AT91C_US_RSTSTA
;

235 
ReiveE
 = 
ue
;

237 
pPIO
->
PIO_CODR
 = 
LED2
;

240  
ReiveE
;

241 
	}
}

249 
bo
 
	$RS485_DaAvaab
(

250 
ut8_t
 * 
DaRegi
)

252 
bo
 
DaAvaab
 = 
l
;

254 vީ
AT91PS_PIO
 
pPIO
 = 
AT91C_BASE_PIOA
;

256 i(
RS485_I
->
US_CSR
 & 
AT91C_US_RXRDY
) {

258 i(
DaRegi
) {

259 *
DaRegi
 = 
RS485_I
->
US_RHR
;

261 
DaAvaab
 = 
ue
;

263 
pPIO
->
PIO_CODR
 = 
LED2
;

266  
DaAvaab
;

267 
	}
}

269 #ifde
TEST_RS485


270 
	$ma
(

273 
i
 = 0;

274 
ut8_t
 
DaRegi
;

276 
	`RS485_S_Baud_Re
(38400);

277 
	`RS485_Inlize
();

280 i(
	`RS485_ReiveE
()) {

281 
	`rtf
(
dr
, "ERROR ");

282 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

283 
	`rtf
(
dr
, "%02X ", 
DaRegi
);

286 
	}
}

	@ports/at91sam7s/rs485.h

26 #ide
RS485_H


27 
	#RS485_H


	)

29 
	~<dt.h
>

31 #ifde
__lulus


35 
RS485_Inlize
(

38 
RS485_Tnsmr_Eb
(

39 
bo
 
ab
);

41 
RS485_Sd_Da
(

42 
ut8_t
 * 
bufr
,

43 
ut16_t
 
nbys
);

45 
bo
 
RS485_ReiveE
(

47 
bo
 
RS485_DaAvaab
(

48 
ut8_t
 * 
da
);

50 
RS485_Tuound_Day
(

52 
ut32_t
 
RS485_G_Baud_Re
(

54 
bo
 
RS485_S_Baud_Re
(

55 
ut32_t
 
baud
);

57 #ifde
__lulus


	@ports/at91sam7s/timer.c

43 
	~<dt.h
>

44 
	~"brd.h
"

45 
	~"dlmp.h
"

48 vީ
	gTim_Mlicds
;

50 vީ
	gSTime
;

52 
	$Tim0_Sup
(

53 
mlicds
)

66 
AT91PS_TCB
 
pTCB
 = 
AT91C_BASE_TCB
;

68 
pTCB
->
TCB_BCR
 = 0;

93 
pTCB
->
TCB_BMR
 = 0x15;

113 
AT91PS_TC
 
pTC
 = 
AT91C_BASE_TC0
;

115 
pTC
->
TC_CCR
 = 0x5;

195 
pTC
->
TC_CMR
 = 0x4004;

218 
pTC
->
TC_RC
 = ((
MCK
 / 1024 / 1000+ 1* 
mlicds
;

253 
pTC
->
TC_IER
 = 0x10;

288 
pTC
->
TC_IDR
 = 0xEF;

289 
	}
}

301 
	$Tim0IrqHdr
(

305 vީ
AT91PS_TC
 
pTC
 = 
AT91C_BASE_TC0
;

306 vީ
dummy
;

309 
dummy
 = 
pTC
->
TC_SR
;

311 
Tim_Mlicds
++;

312 i(
STime
 < 60000) {

313 
STime
++;

315 ()
dummy
;

316 
	}
}

318 
	$Tim_S
(

321  
STime
;

322 
	}
}

324 
	$Tim_S_Ret
(

327 
STime
 = 0;

328 
	}
}

339 
	$TimIn
(

343 vީ
AT91PS_PMC
 
pPMC
 = 
AT91C_BASE_PMC
;

344 
pPMC
->
PMC_PCER
 =PMC->
PMC_PCSR
 | (1 << 
AT91C_ID_TC0
);

346 vީ
AT91PS_AIC
 
pAIC
 = 
AT91C_BASE_AIC
;

349 
pAIC
->
AIC_IDCR
 = (1 << 
AT91C_ID_TC0
);

352 
pAIC
->
AIC_SVR
[
AT91C_ID_TC0
] = (
Tim0IrqHdr
;

355 
pAIC
->
AIC_SMR
[
AT91C_ID_TC0
] =

356 (
AT91C_AIC_SRCTYPE_INT_LEVEL_SENSITIVE
 | 0x4);

359 
pAIC
->
AIC_ICCR
 = (1 << 
AT91C_ID_TC0
);

362 
pAIC
->
AIC_IDCR
 = (0 << 
AT91C_ID_TC0
);

365 
pAIC
->
AIC_IECR
 = (1 << 
AT91C_ID_TC0
);

367 
	`Tim0_Sup
(1);

368 
	}
}

	@ports/at91sam7s/timer.h

26 #ide
TIMER_H


27 
	#TIMER_H


	)

29 
	~<dt.h
>

31 vީ
Tim_Mlicds
;

33 #ifde
__lulus


37 
TimIn
(

39 
Tim_S
(

41 
Tim_S_Ret
(

44 #ifde
__lulus


	@ports/atmega168/ai.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

37 
	#MAX_ANALOG_INPUTS
 9

	)

38 #i(
MAX_ANALOG_INPUTS
 > 9)

39 #r 
Modify
 
the
 
Alog_Iut_Name
 
to
 
hd
 
muɝ
 
digs


42 
	gP_Vue
[
MAX_ANALOG_INPUTS
];

47 
bo
 
	$Alog_Iut_Vid_In
(

48 
ut32_t
 
obje_
)

50 i(
obje_
 < 
MAX_ANALOG_INPUTS
)

51  
ue
;

53  
l
;

54 
	}
}

57 
	$Alog_Iut_Cou
(

60  
MAX_ANALOG_INPUTS
;

61 
	}
}

64 
ut32_t
 
	$Alog_Iut_Index_To_In
(

65 
dex
)

67  
dex
;

68 
	}
}

71 
	$Alog_Iut_In_To_Index
(

72 
ut32_t
 
obje_
)

74  
obje_
;

75 
	}
}

78 *
	$Alog_Iut_Name
(

79 
ut32_t
 
obje_
)

81 
xt_rg
[5] = "AI-0";

83 i(
obje_
 < 
MAX_ANALOG_INPUTS
) {

84 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

85  
xt_rg
;

88  
NULL
;

89 
	}
}

93 
	$Alog_Iut_Encode_Prݔty_APDU
(

94 
ut8_t
 * 
du
,

95 
ut32_t
 
obje_
,

96 
BACNET_PROPERTY_ID
 
ݔty
,

97 
ut32_t
 
y_dex
,

98 
BACNET_ERROR_CLASS
 * 
r_ass
,

99 
BACNET_ERROR_CODE
 * 
r_code
)

101 
du_n
 = 0;

102 
BACNET_BIT_STRING
 
b_rg
;

103 
BACNET_CHARACTER_STRING
 
ch_rg
;

104 
obje_dex
;

107 (
y_dex
;

108 
ݔty
) {

109 
PROP_OBJECT_IDENTIFIER
:

110 
du_n
 =

111 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_INPUT
,

112 
obje_
);

117 
PROP_OBJECT_NAME
:

118 
PROP_DESCRIPTION
:

119 
	`charg__si
(&
ch_rg
,

120 
	`Alog_Iut_Name
(
obje_
));

121 
du_n
 =

122 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

124 
PROP_OBJECT_TYPE
:

125 
du_n
 =

126 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_INPUT
);

128 
PROP_PRESENT_VALUE
:

129 
obje_dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

130 
du_n
 =

131 
	`code_iti_
(&
du
[0], 
P_Vue
[
obje_dex
]);

133 
PROP_STATUS_FLAGS
:

134 
	`brg_
(&
b_rg
);

135 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

136 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

137 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

138 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

139 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

141 
PROP_EVENT_STATE
:

142 
du_n
 =

143 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

145 
PROP_OUT_OF_SERVICE
:

146 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

148 
PROP_UNITS
:

149 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

152 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

153 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

154 
du_n
 = -1;

158 i((
du_n
 >0&& (
y_dex
 !
BACNET_ARRAY_ALL
)) {

159 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

160 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

161 
du_n
 = -1;

164  
du_n
;

165 
	}
}

	@ports/atmega168/ai.h

25 #ide
AI_H


26 
	#AI_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~".h
"

32 
	~"wp.h
"

34 #ifde
__lulus


37 
Alog_Iut_Prݔty_Lis
(

38 cڡ **
pRequed
,

39 cڡ **
pOiڮ
,

40 cڡ **
pPrrry
);

42 
bo
 
Alog_Iut_Vid_In
(

43 
ut32_t
 
obje_
);

44 
Alog_Iut_Cou
(

46 
ut32_t
 
Alog_Iut_Index_To_In
(

47 
dex
);

48 
Alog_Iut_In_To_Index
(

49 
ut32_t
 

);

50 
bo
 
Alog_Iut_Obje_In_Add
(

51 
ut32_t
 

);

53 *
Alog_Iut_Name
(

54 
ut32_t
 
obje_
);

55 
bo
 
Alog_Iut_Name_S
(

56 
ut32_t
 
obje_
,

57 *
w_me
);

59 *
Alog_Iut_Desti
(

60 
ut32_t
 

);

61 
bo
 
Alog_Iut_Desti_S
(

62 
ut32_t
 

,

63 *
w_me
);

65 
bo
 
Alog_Iut_Uns_S
(

66 
ut32_t
 

,

67 
ut16_t
 
uns
);

68 
ut16_t
 
Alog_Iut_Uns
(

69 
ut32_t
 

);

71 
Alog_Iut_Rd_Prݔty
(

72 
BACNET_READ_PROPERTY_DATA
 * 
da
);

73 
bo
 
Alog_Iut_Wre_Prݔty
(

74 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

76 
Alog_Iut_P_Vue
(

77 
ut32_t
 
obje_
);

78 
Alog_Iut_P_Vue_S
(

79 
ut32_t
 
obje_
,

80 
vue
);

82 
Alog_Iut_In
(

85 #ifde
TEST


86 
	~"e.h
"

87 
AlogIut
(

88 
Te
 * 
pTe
);

91 #ifde
__lulus


94 
	#ANALOG_INPUT_OBJ_FUNCTIONS
 \

95 
OBJECT_ANALOG_INPUT
, 
Alog_Iut_In
, 
Alog_Iut_Cou
, \

96 
Alog_Iut_Index_To_In
, 
Alog_Iut_Vid_In
, \

97 
Alog_Iut_Name
, 
Alog_Iut_Rd_Prݔty
, 
NULL
, \

98 
Alog_Iut_Prݔty_Lis
, 
NULL
, 
	)
NULL

	@ports/atmega168/apdu.c

34 
	~<dbo.h
>

35 
	~<dt.h
>

36 
	~<ddef.h
>

37 
	~"bs.h
"

38 
	~"du.h
"

39 
	~"bacdef.h
"

40 
	~"bacdcode.h
"

41 
	~"banum.h
"

42 
	~"hdrs.h
"

44 
bo
 
	$du_rvi_su܋d
(

45 
BACNET_SERVICES_SUPPORTED
 
rvi_su܋d
)

47 
bo
 
us
 = 
l
;

49 i(
rvi_su܋d
 =
SERVICE_SUPPORTED_READ_PROPERTY
) {

50 
us
 = 
ue
;

52 i(
rvi_su܋d
 =
SERVICE_SUPPORTED_WHO_IS
) {

53 
us
 = 
ue
;

55 #ifde
WRITE_PROPERTY


56 i(
rvi_su܋d
 =
SERVICE_SUPPORTED_WRITE_PROPERTY
) {

57 
us
 = 
ue
;

61  
us
;

62 
	}
}

64 
ut16_t
 
	$du_decode_cfmed_rvi_que
(

65 
ut8_t
 * 
du
,

66 
ut16_t
 
du_n
,

67 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
,

68 
ut8_t
 * 
rvi_choi
,

69 
ut8_t
 ** 
rvi_que
,

70 
ut16_t
 * 
rvi_que_n
)

72 
ut16_t
 
n
 = 0;

74 
rvi_da
->
gmd_mesge
 = (
du
[0] & 
BIT3
? 
ue
 : 
l
;

75 
rvi_da
->
me_flows
 = (
du
[0] & 
BIT2
? 
ue
 : 
l
;

76 
rvi_da
->
gmd_ڣ_aced
 =

77 (
du
[0] & 
BIT1
? 
ue
 : 
l
;

78 
rvi_da
->
max_gs
 = 
	`decode_max_gs
(
du
[1]);

79 
rvi_da
->
max_
 = 
	`decode_max_du
(
du
[1]);

80 
rvi_da
->
voke_id
 = 
du
[2];

81 
n
 = 3;

82 i(
rvi_da
->
gmd_mesge
) {

83 
rvi_da
->
qu_numb
 = 
du
[
n
++];

84 
rvi_da
->
od_wdow_numb
 = 
du
[
n
++];

86 *
rvi_choi
 = 
du
[
n
++];

87 *
rvi_que
 = &
du
[
n
];

88 *
rvi_que_n
 = 
du_n
 - 
n
;

90  
n
;

91 
	}
}

93 
	$du_hdr
(

94 
BACNET_ADDRESS
 * 
c
,

95 
ut8_t
 * 
du
,

96 
ut16_t
 
du_n
)

98 
BACNET_CONFIRMED_SERVICE_DATA
 
rvi_da
 = { 0 };

99 
ut8_t
 
rvi_choi
 = 0;

100 
ut8_t
 *
rvi_que
 = 
NULL
;

101 
ut16_t
 
rvi_que_n
 = 0;

103 i(
du
) {

105 
du
[0] & 0xF0) {

106 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

107 
	`du_decode_cfmed_rvi_que
(&
du
[0],

108 
du_n
, &
rvi_da
, &
rvi_choi
, &
rvi_que
,

109 &
rvi_que_n
);

110 i(
rvi_choi
 =
SERVICE_CONFIRMED_READ_PROPERTY
) {

111 
	`hdr_ad_ݔty
(
rvi_que
, 
rvi_que_n
,

112 
c
, &
rvi_da
);

114 #ifde
WRITE_PROPERTY


115 i(
rvi_choi
 =
SERVICE_CONFIRMED_WRITE_PROPERTY
) {

116 
	`hdr_wre_ݔty
(
rvi_que
,

117 
rvi_que_n
, 
c
, &
rvi_da
);

121 
	`hdr_uecognized_rvi
(
rvi_que
,

122 
rvi_que_n
, 
c
, &
rvi_da
);

125 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
:

126 
rvi_choi
 = 
du
[1];

127 
rvi_que
 = &
du
[2];

128 
rvi_que_n
 = 
du_n
 - 2;

129 i(
rvi_choi
 =
SERVICE_UNCONFIRMED_WHO_IS
) {

130 
	`hdr_who_is
(
rvi_que
, 
rvi_que_n
, 
c
);

133 
PDU_TYPE_SIMPLE_ACK
:

134 
PDU_TYPE_COMPLEX_ACK
:

135 
PDU_TYPE_SEGMENT_ACK
:

136 
PDU_TYPE_ERROR
:

137 
PDU_TYPE_REJECT
:

138 
PDU_TYPE_ABORT
:

144 
	}
}

	@ports/atmega168/av.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"hdwe.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~"wp.h
"

37 
	~"av.h
"

39 #i(
MAX_ANALOG_VALUES
 > 10)

40 #r 
Modify
 
the
 
Alog_Vue_Name
 
to
 
hd
 
muɝ
 
digs


43 
	gAV_P_Vue
[
MAX_ANALOG_VALUES
];

48 
bo
 
	$Alog_Vue_Vid_In
(

49 
ut32_t
 
obje_
)

51 i(
obje_
 < 
MAX_ANALOG_VALUES
)

52  
ue
;

54  
l
;

55 
	}
}

59 
	$Alog_Vue_Cou
(

62  
MAX_ANALOG_VALUES
;

63 
	}
}

68 
ut32_t
 
	$Alog_Vue_Index_To_In
(

69 
dex
)

71  
dex
;

72 
	}
}

77 
	$Alog_Vue_In_To_Index
(

78 
ut32_t
 
obje_
)

80  
obje_
;

81 
	}
}

84 *
	$Alog_Vue_Name
(

85 
ut32_t
 
obje_
)

87 
xt_rg
[5] = "AV-";

89 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

91  
xt_rg
;

92 
	}
}

95 
	$Alog_Vue_Encode_Prݔty_APDU
(

96 
ut8_t
 * 
du
,

97 
ut32_t
 
obje_
,

98 
BACNET_PROPERTY_ID
 
ݔty
,

99 
ut32_t
 
y_dex
,

100 
BACNET_ERROR_CLASS
 * 
r_ass
,

101 
BACNET_ERROR_CODE
 * 
r_code
)

103 
du_n
 = 0;

104 
BACNET_BIT_STRING
 
b_rg
;

105 
BACNET_CHARACTER_STRING
 
ch_rg
;

106 
obje_dex
;

108 
ݔty
) {

109 
PROP_OBJECT_IDENTIFIER
:

110 
du_n
 =

111 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_VALUE
,

112 
obje_
);

114 
PROP_OBJECT_NAME
:

115 
	`charg__si
(&
ch_rg
,

116 
	`Alog_Vue_Name
(
obje_
));

117 
du_n
 =

118 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

120 
PROP_OBJECT_TYPE
:

121 
du_n
 =

122 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_VALUE
);

124 
PROP_PRESENT_VALUE
:

125 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

126 
du_n
 =

127 
	`code_iti_
(&
du
[0],

128 
AV_P_Vue
[
obje_dex
]);

130 
PROP_STATUS_FLAGS
:

131 
	`brg_
(&
b_rg
);

132 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

133 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

134 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

135 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

136 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

138 
PROP_EVENT_STATE
:

139 
du_n
 =

140 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

142 
PROP_OUT_OF_SERVICE
:

143 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

145 
PROP_UNITS
:

146 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

149 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

150 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

151 
du_n
 = -1;

155 i((
du_n
 >0&& (
y_dex
 !
BACNET_ARRAY_ALL
)) {

156 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

157 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

158 
du_n
 = -1;

161  
du_n
;

162 
	}
}

165 
bo
 
	$Alog_Vue_Wre_Prݔty
(

166 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
,

167 
BACNET_ERROR_CLASS
 * 
r_ass
,

168 
BACNET_ERROR_CODE
 * 
r_code
)

170 
bo
 
us
 = 
l
;

171 
obje_dex
 = 0;

172 
n
 = 0;

173 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

175 i(!
	`Alog_Vue_Vid_In
(
wp_da
->
obje_
)) {

176 *
r_ass
 = 
ERROR_CLASS_OBJECT
;

177 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

178  
l
;

181 
n
 =

182 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

183 
wp_da
->
iti_da_n
, &
vue
);

185 i(
n
 < 0) {

187 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

188 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

189  
l
;

191 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

192 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

194 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

195 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

196  
l
;

198 
wp_da
->
obje_ݔty
) {

199 
PROP_PRESENT_VALUE
:

200 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_REAL
) {

201 
obje_dex
 =

202 
	`Alog_Vue_In_To_Index
(
wp_da
->
obje_
);

203 
AV_P_Vue
[
obje_dex
] = 
vue
.
ty
.
Rl
;

204 
us
 = 
ue
;

206 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

207 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

210 
PROP_OBJECT_IDENTIFIER
:

211 
PROP_OBJECT_NAME
:

212 
PROP_OBJECT_TYPE
:

213 
PROP_STATUS_FLAGS
:

214 
PROP_EVENT_STATE
:

215 
PROP_OUT_OF_SERVICE
:

216 
PROP_DESCRIPTION
:

217 
PROP_PRIORITY_ARRAY
:

218 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

219 *
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

222 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

223 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

227  
us
;

228 
	}
}

230 #ifde
TEST


231 
	~<as.h
>

232 
	~<rg.h
>

233 
	~"e.h
"

235 
	$Alog_Vue
(

236 
Te
 * 
pTe
)

238 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

239 
n
 = 0;

240 
ut32_t
 
n_vue
 = 0;

241 
ut8_t
 
g_numb
 = 0;

242 
BACNET_OBJECT_TYPE
 
decoded_ty
 = 
OBJECT_ANALOG_VALUE
;

243 
ut32_t
 
decoded_
 = 0;

244 
ut32_t
 

 = 123;

245 
BACNET_ERROR_CLASS
 
r_ass
;

246 
BACNET_ERROR_CODE
 
r_code
;

248 
n
 =

249 
	`Alog_Vue_Encode_Prݔty_APDU
(&
du
[0], 

,

250 
PROP_OBJECT_IDENTIFIER
, 
BACNET_ARRAY_ALL
, &
r_ass
, &
r_code
);

251 
	`_
(
pTe
, 
n
 != 0);

252 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

253 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

254 
n
 =

255 
	`decode_obje_id
(&
du
[
n
], (*&
decoded_ty
, &
decoded_
);

256 
	`_
(
pTe
, 
decoded_ty
 =
OBJECT_ANALOG_VALUE
);

257 
	`_
(
pTe
, 
decoded_
 =

);

260 
	}
}

262 #ifde
TEST_ANALOG_VALUE


263 
	$ma
(

266 
Te
 *
pTe
;

267 
bo
 
rc
;

269 
pTe
 = 
	`_
("BACÈAlog Vue", 
NULL
);

271 
rc
 = 
	`_addTeFuni
(
pTe
, 
Alog_Vue
);

272 
	`as
(
rc
);

274 
	`_tSm
(
pTe
, 
dout
);

275 
	`_run
(
pTe
);

276 (
	`_pt
(
pTe
);

277 
	`_deroy
(
pTe
);

280 
	}
}

	@ports/atmega168/av.h

25 #ide
AV_H


26 
	#AV_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~"wp.h
"

34 #ide
MAX_ANALOG_VALUES


35 
	#MAX_ANALOG_VALUES
 4

	)

38 #ifde
__lulus


41 
Alog_Vue_Prݔty_Lis
(

42 cڡ **
pRequed
,

43 cڡ **
pOiڮ
,

44 cڡ **
pPrrry
);

45 
bo
 
Alog_Vue_Vid_In
(

46 
ut32_t
 
obje_
);

47 
Alog_Vue_Cou
(

49 
ut32_t
 
Alog_Vue_Index_To_In
(

50 
dex
);

51 *
Alog_Vue_Name
(

52 
ut32_t
 
obje_
);

54 
Alog_Vue_Encode_Prݔty_APDU
(

55 
ut8_t
 * 
du
,

56 
ut32_t
 
obje_
,

57 
BACNET_PROPERTY_ID
 
ݔty
,

58 
ut32_t
 
y_dex
,

59 
BACNET_ERROR_CLASS
 * 
r_ass
,

60 
BACNET_ERROR_CODE
 * 
r_code
);

62 
bo
 
Alog_Vue_Wre_Prݔty
(

63 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
,

64 
BACNET_ERROR_CLASS
 * 
r_ass
,

65 
BACNET_ERROR_CODE
 * 
r_code
);

67 
bo
 
Alog_Vue_P_Vue_S
(

68 
ut32_t
 
obje_
,

69 
vue
,

70 
ut8_t
 
iܙy
);

71 
Alog_Vue_P_Vue
(

72 
ut32_t
 
obje_
);

74 
Alog_Vue_In
(

77 #ifde
TEST


78 
	~"e.h
"

79 
Alog_Vue
(

80 
Te
 * 
pTe
);

83 #ifde
__lulus


	@ports/atmega168/avr035.h

1 #ide
AVR035_H


2 
	#AVR035_H


	)

7 
	#BIT_SET
(
a
,
b
(|(1<<(b)))

	)

8 
	#BIT_CLEAR
(
a
,
b
(&~(1<<(b)))

	)

9 
	#BIT_FLIP
(
a
,
b
(^(1<<(b)))

	)

10 
	#BIT_CHECK
(
a
,
b
(& (1<<(b)))

	)

13 
	#BITMASK_SET
(
x
,
y
((x|(y))

	)

14 
	#BITMASK_CLEAR
(
x
,
y
((x&(~(y)))

	)

15 
	#BITMASK_FLIP
(
x
,
y
((x^(y))

	)

16 
	#BITMASK_CHECK
(
x
,
y
((x& (y))

	)

	@ports/atmega168/bv.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"hdwe.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"banum.h
"

35 
	~"cfig.h
"

36 
	~"wp.h
"

37 
	~"bv.h
"

39 #i(
MAX_BINARY_VALUES
 > 10)

40 #r 
Modify
 
the
 
By_Vue_Name
 
to
 
hd
 
muɝ
 
digs


43 
BACNET_BINARY_PV
 
	gP_Vue
[
MAX_BINARY_VALUES
];

46 
bo
 
	$By_Vue_Vid_In
(

47 
ut32_t
 
obje_
)

49 i(
obje_
 < 
MAX_BINARY_VALUES
)

50  
ue
;

52  
l
;

53 
	}
}

56 
	$By_Vue_Cou
(

59  
MAX_BINARY_VALUES
;

60 
	}
}

63 
ut32_t
 
	$By_Vue_Index_To_In
(

64 
dex
)

66  
dex
;

67 
	}
}

70 
	$By_Vue_In_To_Index
(

71 
ut32_t
 
obje_
)

73 
dex
 = 
MAX_BINARY_VALUES
;

75 i(
obje_
 < 
MAX_BINARY_VALUES
)

76 
dex
 = 
obje_
;

78  
dex
;

79 
	}
}

81 
BACNET_BINARY_PV
 
	$By_Vue_P_Vue
(

82 
ut32_t
 
obje_
)

84 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

86 i(
obje_
 < 
MAX_BINARY_VALUES
) {

87 
vue
 = 
P_Vue
[
obje_
];

90  
vue
;

91 
	}
}

94 *
	$By_Vue_Name
(

95 
ut32_t
 
obje_
)

97 
xt_rg
[5] = "BV-0";

99 i(
obje_
 < 
MAX_BINARY_VALUES
) {

100 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

101  
xt_rg
;

104  
NULL
;

105 
	}
}

108 
	$By_Vue_Encode_Prݔty_APDU
(

109 
ut8_t
 * 
du
,

110 
ut32_t
 
obje_
,

111 
BACNET_PROPERTY_ID
 
ݔty
,

112 
ut32_t
 
y_dex
,

113 
BACNET_ERROR_CLASS
 * 
r_ass
,

114 
BACNET_ERROR_CODE
 * 
r_code
)

116 
du_n
 = 0;

117 
BACNET_BIT_STRING
 
b_rg
;

118 
BACNET_CHARACTER_STRING
 
ch_rg
;

119 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

120 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

122 
ݔty
) {

123 
PROP_OBJECT_IDENTIFIER
:

124 
du_n
 =

125 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_BINARY_VALUE
,

126 
obje_
);

130 
PROP_OBJECT_NAME
:

131 
	`charg__si
(&
ch_rg
,

132 
	`By_Vue_Name
(
obje_
));

133 
du_n
 =

134 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

136 
PROP_OBJECT_TYPE
:

137 
du_n
 =

138 
	`code_iti_umed
(&
du
[0], 
OBJECT_BINARY_VALUE
);

140 
PROP_PRESENT_VALUE
:

141 
e_vue
 = 
	`By_Vue_P_Vue
(
obje_
);

142 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

144 
PROP_STATUS_FLAGS
:

146 
	`brg_
(&
b_rg
);

147 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

148 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

149 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

150 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

151 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

153 
PROP_EVENT_STATE
:

155 
du_n
 =

156 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

158 
PROP_OUT_OF_SERVICE
:

159 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

161 
PROP_POLARITY
:

163 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
pެy
);

166 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

167 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

168 
du_n
 = -1;

172 i((
du_n
 >0&& (
y_dex
 !
BACNET_ARRAY_ALL
)) {

173 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

174 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

175 
du_n
 = -1;

178  
du_n
;

179 
	}
}

182 
bo
 
	$By_Vue_Wre_Prݔty
(

183 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
,

184 
BACNET_ERROR_CLASS
 * 
r_ass
,

185 
BACNET_ERROR_CODE
 * 
r_code
)

187 
bo
 
us
 = 
l
;

188 
obje_dex
 = 0;

189 
n
 = 0;

190 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

192 i(!
	`By_Vue_Vid_In
(
wp_da
->
obje_
)) {

193 *
r_ass
 = 
ERROR_CLASS_OBJECT
;

194 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

195  
l
;

198 
n
 =

199 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

200 
wp_da
->
iti_da_n
, &
vue
);

202 i(
n
 < 0) {

204 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

205 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

206  
l
;

208 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

209 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

211 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

212 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

213  
l
;

215 
wp_da
->
obje_ݔty
) {

216 
PROP_PRESENT_VALUE
:

217 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_ENUMERATED
) {

218 i((
vue
.
ty
.
Enumed
 =
BINARY_ACTIVE
) ||

219 (
vue
.
ty
.
Enumed
 =
BINARY_INACTIVE
)) {

220 
obje_dex
 =

221 
By_Vue_In_To_Index


222 (
wp_da
->
obje_
);

224 
P_Vue
[
obje_dex
] =

225 (
BACNET_BINARY_PV

vue
.
ty
.
Enumed
;

230 i(
P_Vue
[0] =
BINARY_ACTIVE
) {

231 
	`LED_GREEN_ON
();

233 
	`LED_GREEN_OFF
();

235 
us
 = 
ue
;

237 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

238 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

241 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

242 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

245 
PROP_OUT_OF_SERVICE
:

247 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_BOOLEAN
) {

248 
obje_dex
 =

249 
	`By_Vue_In_To_Index
(
wp_da
->
obje_
);

250 
By_Vue_Out_Of_Svi
[
obje_dex
] = 
vue
.
ty
.
Boޗn
;

251 
us
 = 
ue
;

253 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

254 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

258 
PROP_OBJECT_IDENTIFIER
:

259 
PROP_OBJECT_NAME
:

260 
PROP_OBJECT_TYPE
:

261 
PROP_STATUS_FLAGS
:

262 
PROP_EVENT_STATE
:

263 
PROP_POLARITY
:

264 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

265 *
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

268 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

269 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

273  
us
;

274 
	}
}

276 #ifde
TEST


277 
	~<as.h
>

278 
	~<rg.h
>

279 
	~"e.h
"

281 
	$By_Vue
(

282 
Te
 * 
pTe
)

284 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

285 
n
 = 0;

286 
ut32_t
 
n_vue
 = 0;

287 
ut8_t
 
g_numb
 = 0;

288 
BACNET_OBJECT_TYPE
 
decoded_ty
 = 
OBJECT_BINARY_VALUE
;

289 
ut32_t
 
decoded_
 = 0;

290 
ut32_t
 

 = 123;

291 
BACNET_ERROR_CLASS
 
r_ass
;

292 
BACNET_ERROR_CODE
 
r_code
;

295 
n
 =

296 
	`By_Vue_Encode_Prݔty_APDU
(&
du
[0], 

,

297 
PROP_OBJECT_IDENTIFIER
, 
BACNET_ARRAY_ALL
, &
r_ass
, &
r_code
);

298 
	`_
(
pTe
, 
n
 != 0);

299 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

300 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

301 
n
 =

302 
	`decode_obje_id
(&
du
[
n
], (*&
decoded_ty
, &
decoded_
);

303 
	`_
(
pTe
, 
decoded_ty
 =
OBJECT_BINARY_VALUE
);

304 
	`_
(
pTe
, 
decoded_
 =

);

307 
	}
}

309 #ifde
TEST_BINARY_VALUE


310 
	$ma
(

313 
Te
 *
pTe
;

314 
bo
 
rc
;

316 
pTe
 = 
	`_
("BACÈBy_Vue", 
NULL
);

318 
rc
 = 
	`_addTeFuni
(
pTe
, 
By_Vue
);

319 
	`as
(
rc
);

321 
	`_tSm
(
pTe
, 
dout
);

322 
	`_run
(
pTe
);

323 (
	`_pt
(
pTe
);

324 
	`_deroy
(
pTe
);

327 
	}
}

	@ports/atmega168/bv.h

25 #ide
BV_H


26 
	#BV_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"bacdef.h
"

31 
	~"ba.h
"

32 
	~"wp.h
"

34 #ide
MAX_BINARY_VALUES


35 
	#MAX_BINARY_VALUES
 10

	)

39 #ifde
__lulus


43 
By_Vue_Prݔty_Lis
(

44 cڡ **
pRequed
,

45 cڡ **
pOiڮ
,

46 cڡ **
pPrrry
);

47 
bo
 
By_Vue_Vid_In
(

48 
ut32_t
 
obje_
);

49 
By_Vue_Cou
(

51 
ut32_t
 
By_Vue_Index_To_In
(

52 
dex
);

53 *
By_Vue_Name
(

54 
ut32_t
 
obje_
);

56 
By_Vue_In
(

59 
By_Vue_Encode_Prݔty_APDU
(

60 
ut8_t
 * 
du
,

61 
ut32_t
 
obje_
,

62 
BACNET_PROPERTY_ID
 
ݔty
,

63 
ut32_t
 
y_dex
,

64 
BACNET_ERROR_CLASS
 * 
r_ass
,

65 
BACNET_ERROR_CODE
 * 
r_code
);

67 
bo
 
By_Vue_Wre_Prݔty
(

68 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
,

69 
BACNET_ERROR_CLASS
 * 
r_ass
,

70 
BACNET_ERROR_CODE
 * 
r_code
);

72 #ifde
TEST


73 
	~"e.h
"

74 
By_Vue
(

75 
Te
 * 
pTe
);

78 #ifde
__lulus


	@ports/atmega168/device.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~"bacdef.h
"

29 
	~"bacdcode.h
"

30 
	~"bacr.h
"

31 
	~"banum.h
"

32 
	~"du.h
"

33 
	~"dcc.h
"

34 
	~"dlmp.h
"

35 
	~"rs485.h
"

36 
	~"vsi.h
"

37 
	~"ack.h
"

39 
	~"devi.h
"

40 
	~"av.h
"

41 
	~"bv.h
"

42 
	~"wp.h
"

48 
ut32_t
 
	gObje_In_Numb
 = 260001;

49 
	gObje_Name
[20] = "My Device";

50 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

52 
	$Devi_In
(

62 
	}
}

65 
ut32_t
 
	$Devi_Obje_In_Numb
(

68  
Obje_In_Numb
;

69 
	}
}

71 
bo
 
	$Devi_S_Obje_In_Numb
(

72 
ut32_t
 
obje_id
)

74 
bo
 
us
 = 
ue
;

76 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

77 
Obje_In_Numb
 = 
obje_id
;

85 
us
 = 
l
;

87  
us
;

88 
	}
}

90 
bo
 
	$Devi_Vid_Obje_In_Numb
(

91 
ut32_t
 
obje_id
)

94  (
Obje_In_Numb
 =
obje_id
);

95 
	}
}

97 
ut16_t
 
	$Devi_Vd_Idtifr
(

100  
BACNET_VENDOR_ID
;

101 
	}
}

103 
	$Devi_Obje_Li_Cou
(

106 
cou
 = 1;

109 
cou
 +
	`Alog_Vue_Cou
();

110 
cou
 +
	`By_Vue_Cou
();

112  
cou
;

113 
	}
}

115 
bo
 
	$Devi_Obje_Li_Idtifr
(

116 
ut32_t
 
y_dex
,

117 *
obje_ty
,

118 
ut32_t
 * 

)

120 
bo
 
us
 = 
l
;

121 
ut32_t
 
obje_dex
 = 0;

122 
ut32_t
 
obje_cou
 = 0;

125 i(
y_dex
 == 1) {

126 *
obje_ty
 = 
OBJECT_DEVICE
;

127 *

 = 
Obje_In_Numb
;

128 
us
 = 
ue
;

133 
obje_dex
 = 
y_dex
 - 1;

135 
obje_cou
 = 1;

138 i(!
us
) {

140 
obje_dex
 -
obje_cou
;

141 
obje_cou
 = 
	`Alog_Vue_Cou
();

142 i(
obje_dex
 < 
obje_cou
) {

143 *
obje_ty
 = 
OBJECT_ANALOG_VALUE
;

144 *

 = 
	`Alog_Vue_Index_To_In
(
obje_dex
);

145 
us
 = 
ue
;

149 i(!
us
) {

150 
obje_dex
 -
obje_cou
;

151 
obje_cou
 = 
	`By_Vue_Cou
();

153 i(
obje_dex
 < 
obje_cou
) {

154 *
obje_ty
 = 
OBJECT_BINARY_VALUE
;

155 *

 = 
	`By_Vue_Index_To_In
(
obje_dex
);

156 
us
 = 
ue
;

160  
us
;

161 
	}
}

164 
	$Devi_Encode_Prݔty_APDU
(

165 
ut8_t
 * 
du
,

166 
ut32_t
 
obje_
,

167 
BACNET_PROPERTY_ID
 
ݔty
,

168 
ut32_t
 
y_dex
,

169 
BACNET_ERROR_CLASS
 * 
r_ass
,

170 
BACNET_ERROR_CODE
 * 
r_code
)

172 
du_n
 = 0;

173 
n
 = 0;

174 
BACNET_BIT_STRING
 
b_rg
;

175 
BACNET_CHARACTER_STRING
 
ch_rg
;

176 
ut32_t
 
i
 = 0;

177 
obje_ty
 = 0;

178 
ut32_t
 

 = 0;

179 
ut32_t
 
cou
 = 0;

181 
obje_
 = object_instance;

183 ()
ݔty
) {

184 
PROP_OBJECT_IDENTIFIER
:

185 
du_n
 =

186 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_DEVICE
,

187 
Obje_In_Numb
);

189 
PROP_OBJECT_NAME
:

190 
	`charg__si
(&
ch_rg
, 
Obje_Name
);

191 
du_n
 =

192 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

194 
PROP_OBJECT_TYPE
:

195 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
OBJECT_DEVICE
);

197 
PROP_SYSTEM_STATUS
:

198 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
Syem_Stus
);

200 
PROP_VENDOR_NAME
:

201 
	`charg__si
(&
ch_rg
, 
BACNET_VENDOR_NAME
);

202 
du_n
 =

203 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

205 
PROP_VENDOR_IDENTIFIER
:

206 
du_n
 =

207 
	`code_iti_unsigd
(&
du
[0],

208 
	`Devi_Vd_Idtifr
());

210 
PROP_MODEL_NAME
:

211 
	`charg__si
(&
ch_rg
, "GNU Demo");

212 
du_n
 =

213 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

215 
PROP_FIRMWARE_REVISION
:

216 
	`charg__si
(&
ch_rg
, 
BACNET_VERSION_TEXT
);

217 
du_n
 =

218 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

220 
PROP_APPLICATION_SOFTWARE_VERSION
:

221 
	`charg__si
(&
ch_rg
, "1.0");

222 
du_n
 =

223 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

225 
PROP_PROTOCOL_VERSION
:

226 
du_n
 =

227 
	`code_iti_unsigd
(&
du
[0], 
BACNET_PROTOCOL_VERSION
);

229 
PROP_PROTOCOL_REVISION
:

230 
du_n
 =

231 
	`code_iti_unsigd
(&
du
[0],

232 
BACNET_PROTOCOL_REVISION
);

234 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

236 
	`brg_
(&
b_rg
);

237 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

239 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

240 
	`du_rvi_su܋d
((
BACNET_SERVICES_SUPPORTED

i
));

242 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

244 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

247 
	`brg_
(&
b_rg
);

249 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

251 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

254 
	`brg_t_b
(&
b_rg
, 
OBJECT_DEVICE
, 
ue
);

255 
	`brg_t_b
(&
b_rg
, 
OBJECT_ANALOG_VALUE
, 
ue
);

256 
	`brg_t_b
(&
b_rg
, 
OBJECT_BINARY_VALUE
, 
ue
);

257 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

259 
PROP_OBJECT_LIST
:

260 
cou
 = 
	`Devi_Obje_Li_Cou
();

262 i(
y_dex
 == 0)

263 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

268 i(
y_dex
 =
BACNET_ARRAY_ALL
) {

269 
i
 = 1; i <
cou
; i++) {

270 
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
, &

);

271 
n
 =

272 
	`code_iti_obje_id
(&
du
[
du_n
],

273 
obje_ty
, 

);

274 
du_n
 +
n
;

277 i((
du_n
 + 
n
>
MAX_APDU
) {

279 *
r_code
 =

280 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

281 
du_n
 = 
BACNET_STATUS_ABORT
;

286 i(
	`Devi_Obje_Li_Idtifr
(
y_dex
, &
obje_ty
,

287 &

))

288 
du_n
 =

289 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

290 

);

292 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

293 *
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

294 
du_n
 = 
BACNET_STATUS_ERROR
;

298 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

299 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

301 
PROP_SEGMENTATION_SUPPORTED
:

302 
du_n
 =

303 
	`code_iti_umed
(&
du
[0], 
SEGMENTATION_NONE
);

305 
PROP_APDU_TIMEOUT
:

306 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 60000);

308 
PROP_NUMBER_OF_APDU_RETRIES
:

309 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 0);

311 
PROP_DEVICE_ADDRESS_BINDING
:

314 
PROP_DATABASE_REVISION
:

315 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 0);

317 
PROP_MAX_INFO_FRAMES
:

318 
du_n
 =

319 
	`code_iti_unsigd
(&
du
[0],

320 
	`dlmp_max_fo_ames
());

322 
PROP_MAX_MASTER
:

323 
du_n
 =

324 
	`code_iti_unsigd
(&
du
[0], 
	`dlmp_max_ma
());

327 
du_n
 =

328 
	`code_iti_unsigd
(&
du
[0], 
	`RS485_G_Baud_Re
());

331 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`ack_size
());

334 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`ack_unud
());

337 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

338 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

339 
du_n
 = -1;

343 i((
du_n
 >0&& (
ݔty
 !
PROP_OBJECT_LIST
) &&

344 (
y_dex
 !
BACNET_ARRAY_ALL
)) {

345 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

346 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

347 
du_n
 = 
BACNET_STATUS_ERROR
;

350  
du_n
;

351 
	}
}

353 
bo
 
	$Devi_Wre_Prݔty
(

354 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
,

355 
BACNET_ERROR_CLASS
 * 
r_ass
,

356 
BACNET_ERROR_CODE
 * 
r_code
)

358 
bo
 
us
 = 
l
;

359 
n
 = 0;

360 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

362 i(!
	`Devi_Vid_Obje_In_Numb
(
wp_da
->
obje_
)) {

363 *
r_ass
 = 
ERROR_CLASS_OBJECT
;

364 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

365  
l
;

368 
n
 =

369 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

370 
wp_da
->
iti_da_n
, &
vue
);

372 i(
n
 < 0) {

374 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

375 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

376  
l
;

378 i((
wp_da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

379 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

381 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

382 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

383  
l
;

385 ()
wp_da
->
obje_ݔty
) {

386 
PROP_OBJECT_IDENTIFIER
:

387 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_OBJECT_ID
) {

388 i((
vue
.
ty
.
Obje_Id
.ty =
OBJECT_DEVICE
) &&

389 (
	`Devi_S_Obje_In_Numb
(
vue
.
ty
.

390 
Obje_Id
.

))) {

392 
us
 = 
ue
;

394 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

395 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

398 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

399 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

402 
PROP_MAX_INFO_FRAMES
:

403 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

404 i(
vue
.
ty
.
Unsigd_I
 <= 255) {

405 
	`dlmp_t_max_fo_ames
(
vue
.
ty
.
Unsigd_I
);

406 
us
 = 
ue
;

408 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

409 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

412 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

413 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

416 
PROP_MAX_MASTER
:

417 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

418 i((
vue
.
ty
.
Unsigd_I
 > 0) &&

419 (
vue
.
ty
.
Unsigd_I
 <= 127)) {

420 
	`dlmp_t_max_ma
(
vue
.
ty
.
Unsigd_I
);

421 
us
 = 
ue
;

423 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

424 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

427 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

428 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

431 
PROP_OBJECT_NAME
:

432 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

433 
ut8_t
 
codg
;

435 
codg
 =

436 
	`charg_codg
(&
vue
.
ty
.
Cha_Sg
);

437 i(
codg
 =
CHARACTER_ANSI_X34
) {

438 i(
	`charg_si_cy
(&
Obje_Name
[0],

439 (
Obje_Name
),

440 &
vue
.
ty
.
Cha_Sg
)) {

441 
us
 = 
ue
;

443 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

444 *
r_code
 = 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

447 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

448 *
r_code
 = 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

451 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

452 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

456 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

457 i(
vue
.
ty
.
Unsigd_I
 > 115200) {

458 
	`RS485_S_Baud_Re
(
vue
.
ty
.
Unsigd_I
);

459 
us
 = 
ue
;

461 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

462 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

465 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

466 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

469 
PROP_NUMBER_OF_APDU_RETRIES
:

470 
PROP_APDU_TIMEOUT
:

471 
PROP_VENDOR_IDENTIFIER
:

472 
PROP_SYSTEM_STATUS
:

473 
PROP_LOCATION
:

474 
PROP_DESCRIPTION
:

475 
PROP_MODEL_NAME
:

476 
PROP_VENDOR_NAME
:

477 
PROP_FIRMWARE_REVISION
:

478 
PROP_APPLICATION_SOFTWARE_VERSION
:

479 
PROP_LOCAL_TIME
:

480 
PROP_UTC_OFFSET
:

481 
PROP_LOCAL_DATE
:

482 
PROP_DAYLIGHT_SAVINGS_STATUS
:

483 
PROP_PROTOCOL_VERSION
:

484 
PROP_PROTOCOL_REVISION
:

485 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

486 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

487 
PROP_OBJECT_LIST
:

488 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

489 
PROP_SEGMENTATION_SUPPORTED
:

490 
PROP_DEVICE_ADDRESS_BINDING
:

491 
PROP_DATABASE_REVISION
:

492 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

493 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

494 *
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

497 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

498 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

502  
us
;

503 
	}
}

	@ports/atmega168/device.h

34 #ide
DEVICE_H


35 
	#DEVICE_H


	)

37 
	~<dbo.h
>

38 
	~<dt.h
>

39 
	~"bacdef.h
"

40 
	~"banum.h
"

41 
	~"wp.h
"

42 
	~"adnge.h
"

45 *
	tobje_cou_funi
) (

47 
	$ut32_t
(

48 *
	tobje_dex_to__funi
)

50 
	tdex
);

52 *
	tobje_me_funi
)

54 
	tut32_t
 
	tobje_
);

56 #ifde
__lulus


60 
	`Devi_Obje_Funi_S
(

61 
BACNET_OBJECT_TYPE
 
obje_ty
,

62 
obje_cou_funi
 
cou_funi
,

63 
obje_dex_to__funi
 
dex_funi
,

64 
obje_me_funi
 
me_funi
);

66 
	`Devi_In
(

69 
	`Devi_Prݔty_Lis
(

70 cڡ **
pRequed
,

71 cڡ **
pOiڮ
,

72 cڡ **
pPrrry
);

74 
ut32_t
 
	`Devi_Obje_In_Numb
(

76 
bo
 
	`Devi_S_Obje_In_Numb
(

77 
ut32_t
 
obje_id
);

78 
bo
 
	`Devi_Vid_Obje_In_Numb
(

79 
ut32_t
 
obje_id
);

80 
	`Devi_Obje_Li_Cou
(

82 
bo
 
	`Devi_Obje_Li_Idtifr
(

83 
ut32_t
 
y_dex
,

84 *
obje_ty
,

85 
ut32_t
 * 

);

87 
BACNET_DEVICE_STATUS
 
	`Devi_Syem_Stus
(

89 
	`Devi_S_Syem_Stus
(

90 
BACNET_DEVICE_STATUS
 
us
);

92 cڡ *
	`Devi_Vd_Name
(

95 
ut16_t
 
	`Devi_Vd_Idtifr
(

98 cڡ *
	`Devi_Mod_Name
(

100 
bo
 
	`Devi_S_Mod_Name
(

101 cڡ *
me
,

102 
size_t
 
ngth
);

104 cڡ *
	`Devi_Fmwe_Revisi
(

107 cڡ *
	`Devi_Aliti_Sowe_Vsi
(

109 
bo
 
	`Devi_S_Aliti_Sowe_Vsi
(

110 cڡ *
me
,

111 
size_t
 
ngth
);

113 
bo
 
	`Devi_S_Obje_Name
(

114 cڡ *
me
,

115 
size_t
 
ngth
);

116 cڡ *
	`Devi_Obje_Name
(

119 cڡ *
	`Devi_Desti
(

121 
bo
 
	`Devi_S_Desti
(

122 cڡ *
me
,

123 
size_t
 
ngth
);

125 cڡ *
	`Devi_Loti
(

127 
bo
 
	`Devi_S_Loti
(

128 cڡ *
me
,

129 
size_t
 
ngth
);

132 
ut8_t
 
	`Devi_Proc_Vsi
(

134 
ut8_t
 
	`Devi_Proc_Revisi
(

136 
BACNET_SEGMENTATION
 
	`Devi_Segmti_Su܋d
(

139 
ut8_t
 
	`Devi_Daba_Revisi
(

141 
	`Devi_S_Daba_Revisi
(

142 
ut8_t
 
visi
);

144 
bo
 
	`Devi_Vid_Obje_Name
(

145 cڡ *
obje_me
,

146 *
obje_ty
,

147 
ut32_t
 * 
obje_
);

148 *
	`Devi_Vid_Obje_Id
(

149 
obje_ty
,

150 
ut32_t
 
obje_
);

152 
	`Devi_Encode_Prݔty_APDU
(

153 
ut8_t
 * 
du
,

154 
ut32_t
 
obje_
,

155 
BACNET_PROPERTY_ID
 
ݔty
,

156 
ut32_t
 
y_dex
,

157 
BACNET_ERROR_CLASS
 * 
r_ass
,

158 
BACNET_ERROR_CODE
 * 
r_code
);

160 
bo
 
	`Devi_Wre_Prݔty
(

161 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
,

162 
BACNET_ERROR_CLASS
 * 
r_ass
,

163 
BACNET_ERROR_CODE
 * 
r_code
);

165 
bo
 
	`DeviGRRInfo
(

166 
ut32_t
 
Obje
,

167 
BACNET_PROPERTY_ID
 
Prݔty
,

168 
RR_PROP_INFO
 * 
pInfo
,

169 
BACNET_ERROR_CLASS
 * 
r_ass
,

170 
BACNET_ERROR_CODE
 * 
r_code
);

173 #ifde
__lulus


174 
	}
}

	@ports/atmega168/dlmstp.c

35 
	~<dbo.h
>

36 
	~<dt.h
>

37 
	~<ddef.h
>

38 
	~<rg.h
>

39 
	~"bacdef.h
"

40 
	~"mpdef.h
"

41 
	~"dlmp.h
"

42 
	~"rs485.h
"

43 
	~"c.h
"

44 
	~"du.h
"

45 
	~"bs.h
"

46 
	~"bys.h
"

47 
	~"baddr.h
"

49 
	~".h
"

50 
	~"txbuf.h
"

56 
	~"hdwe.h
"

57 
	~"tim.h
"

60 
MSTP_RECEIVE_STATE
 
	gReive_S
;

63 
MSTP_MASTER_STATE
 
	gMa_S
;

65 
	smp_ag_t
 {

69 
	mReivedInvidFme
:1;

73 
	mReivedVidFme
:1;

76 
	mSeMa
:1;

79 
	mTnsmPackPdg
:1;

82 
	mTnsmPackDER
:1;

85 
	mReivePackPdg
:1;

86 } 
	gMSTP_Fg
;

89 
ut16_t
 
	gDaLgth
;

91 
ut8_t
 
	gDeiAddss
;

95 
ut8_t
 
	gEvtCou
;

97 
ut8_t
 
	gFmeTy
;

104 
ut8_t
 *
	gIutBufr
;

105 
ut16_t
 
	gIutBufrSize
;

107 
ut8_t
 
	gSourAddss
;

112 
ut8_t
 
	gThis_Sti
;

120 
ut8_t
 
	gNmax_fo_ames
;

126 
ut8_t
 
	gNmax_ma
;

134 
ut8_t
 *
	gTnsmPack
;

135 
ut16_t
 
	gTnsmPackL
;

136 
ut8_t
 
	gTnsmPackDe
;

142 
	#Ty_timeout
 295

	)

148 
	#Tuge_timeout
 95

	)

152 
	#Nm_os
 4

	)

160 
	#Tame_abt
 30

	)

165 
	#Ty_day
 250

	)

168 
	#INCREMENT_AND_LIMIT_UINT8
(
x
{i(x < 0xFFx++;}

	)

170 
bo
 
	$dlmp_
(

171 *
iame
)

173 
iame
 = ifname;

175 
	`RS485_Inlize
();

177  
ue
;

178 
	}
}

180 
	$dlmp_nup
(

184 
	}
}

186 
	$dlmp_fl_ba_addss
(

187 
BACNET_ADDRESS
 * 
c
,

188 
ut8_t
 
mp_addss
)

190 
i
 = 0;

192 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

194 
c
->
mac_n
 = 0;

195 
c
->
mac
[0] = 0;

197 
c
->
mac_n
 = 1;

198 
c
->
mac
[0] = 
mp_addss
;

201 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

202 
c
->
mac
[
i
] = 0;

204 
c
->
t
 = 0;

205 
c
->
n
 = 0;

206 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

207 
c
->
adr
[
i
] = 0;

209 
	}
}

212 
bo
 
Sd_I_Am_Fg
;

215 
ut16_t
 
	$dlmp_code_uncfmed_ame
(

218 
BACNET_ADDRESS
 
de
;

219 
BACNET_NPDU_DATA
 
du_da
;

220 
ut16_t
 
n
 = 0;

222 i(
Sd_I_Am_Fg
) {

223 
Sd_I_Am_Fg
 = 
l
;

224 
TnsmPack
 = 
Hdr_Tnsm_Bufr
;

225 
n
 = 
	`m_code_pdu
(&
TnsmPack
[0], &
de
, &
du_da
);

228  
n
;

229 
	}
}

244 
	$MSTP_Sd_Fme
(

245 
ut8_t
 
ame_ty
,

246 
ut8_t
 
dei
,

247 
ut8_t
 
sour
,

248 
ut8_t
 * 
pdu
,

249 
ut16_t
 
pdu_n
)

251 
ut8_t
 
c8
 = 0xFF;

252 
ut16_t
 
c16
 = 0xFFFF;

253 
ut8_t
 
bufr
[8];

254 
ut8_t
 
dac
[2];

255 
ut16_t
 
i
 = 0;

258 
bufr
[0] = 0x55;

259 
bufr
[1] = 0xFF;

260 
bufr
[2] = 
ame_ty
;

261 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[2], crc8);

262 
bufr
[3] = 
dei
;

263 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[3], crc8);

264 
bufr
[4] = 
sour
;

265 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[4], crc8);

267 
bufr
[5] = 
	`HI_BYTE
(
pdu_n
);

268 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[5], crc8);

269 
bufr
[6] = 
	`LO_BYTE
(
pdu_n
);

270 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[6], crc8);

271 
bufr
[7] = ~
c8
;

272 i(
pdu_n
) {

274 
i
 = 0; i < 
pdu_n
; i++) {

275 
c16
 = 
	`CRC_Cc_Da
(
pdu
[
i
], crc16);

277 
c16
 = ~crc16;

278 
dac
[0] = (
c16
 & 0x00FF);

279 
dac
[1] = ((
c16
 & 0xFF00) >> 8);

282 
	`RS485_Tuound_Day
();

283 
	`RS485_Tnsmr_Eb
(
ue
);

284 
	`RS485_Sd_Da
(
bufr
, 8);

286 i(
pdu_n
) {

287 
	`RS485_Sd_Da
(
pdu
, 
pdu_n
);

288 
	`RS485_Sd_Da
(
dac
, 2);

290 
	`RS485_Tnsmr_Eb
(
l
);

291 
	}
}

293 
	$MSTP_Reive_Fme_FSM
(

297 
ut8_t
 
DaRegi
 = 0;

299 
ut16_t
 
DaCRC
 = 0;

301 
ut8_t
 
HdCRC
 = 0;

304 
ut16_t
 
Index
 = 0;

306 
Reive_S
) {

307 
MSTP_RECEIVE_STATE_IDLE
:

309 i(
	`RS485_ReiveE
()) {

311 
	`Tim_S_Ret
();

312 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

313 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

314 
	`Tim_S_Ret
();

315 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

316 i(
DaRegi
 == 0x55) {

319 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

323 
MSTP_RECEIVE_STATE_PREAMBLE
:

326 i(
	`Tim_S
(> 
Tame_abt
) {

330 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

331 } i(
	`RS485_ReiveE
()) {

333 
	`Tim_S_Ret
();

334 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

336 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

337 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

338 
	`Tim_S_Ret
();

339 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

340 i(
DaRegi
 == 0xFF) {

342 
Index
 = 0;

343 
HdCRC
 = 0xFF;

345 
Reive_S
 = 
MSTP_RECEIVE_STATE_HEADER
;

346 } i(
DaRegi
 == 0x55) {

349 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

353 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

357 
MSTP_RECEIVE_STATE_HEADER
:

359 i(
	`Tim_S
(> 
Tame_abt
) {

362 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

364 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

365 } i(
	`RS485_ReiveE
()) {

367 
	`Tim_S_Ret
();

368 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

370 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

372 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

373 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

374 
	`Tim_S_Ret
();

375 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

376 i(
Index
 == 0) {

378 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

379 
FmeTy
 = 
DaRegi
;

380 
Index
 = 1;

381 } i(
Index
 == 1) {

383 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

384 
DeiAddss
 = 
DaRegi
;

385 
Index
 = 2;

386 } i(
Index
 == 2) {

388 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

389 
SourAddss
 = 
DaRegi
;

390 
Index
 = 3;

391 } i(
Index
 == 3) {

393 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

394 
DaLgth
 = 
DaRegi
 * 256;

395 
Index
 = 4;

396 } i(
Index
 == 4) {

398 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

399 
DaLgth
 +
DaRegi
;

400 
Index
 = 5;

401 } i(
Index
 == 5) {

403 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

406 i(
HdCRC
 != 0x55) {

410 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

412 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

418 i((
DaLgth
&& (DaLgth <
IutBufrSize
)) {

420 
Index
 = 0;

421 
DaCRC
 = 0xFFFF;

423 
Reive_S
 = 
MSTP_RECEIVE_STATE_DATA
;

425 i(
DaLgth
 == 0) {

427 i((
DeiAddss
 =
This_Sti
) ||

428 (
DeiAddss
 ==

429 
MSTP_BROADCAST_ADDRESS
)) {

433 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

441 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

444 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

450 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

452 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

456 
MSTP_RECEIVE_STATE_DATA
:

458 i(
	`Tim_S
(> 
Tame_abt
) {

461 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

463 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

464 } i(
	`RS485_ReiveE
()) {

466 
	`Tim_S_Ret
();

467 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

470 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

472 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

473 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

474 
	`Tim_S_Ret
();

475 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

476 i(
Index
 < 
DaLgth
) {

478 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

479 
IutBufr
[
Index
] = 
DaRegi
;

480 
Index
++;

481 } i(
Index
 =
DaLgth
) {

483 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

484 
Index
++;

485 } i(
Index
 =(
DaLgth
 + 1)) {

487 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

490 i(
DaCRC
 == 0xF0B8) {

491 i((
DeiAddss
 =
This_Sti
) ||

492 (
DeiAddss
 =
MSTP_BROADCAST_ADDRESS
)) {

496 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

499 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

501 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

507 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

512 
	}
}

515 
bo
 
	$MSTP_Ma_Node_FSM
(

521 
ut8_t
 
FmeCou
;

525 
ut8_t
 
Next_Sti
;

528 
ut8_t
 
Pl_Sti
;

531 
RryCou
;

536 
TokCou
;

538 
ut8_t
 
xt_pl_i
 = 0;

539 
ut8_t
 
xt_this_i
 = 0;

540 
ut8_t
 
xt_xt_i
 = 0;

542 
ut16_t
 
my_timeout
 = 10, 
ns_timeout
 = 0;

544 
bo
 
si_now
 = 
l
;

547 
xt_pl_i
 = (
Pl_Sti
 + 1% (
Nmax_ma
 + 1);

548 
xt_this_i
 = (
This_Sti
 + 1% (
Nmax_ma
 + 1);

549 
xt_xt_i
 = (
Next_Sti
 + 1% (
Nmax_ma
 + 1);

550 
Ma_S
) {

551 
MSTP_MASTER_STATE_INITIALIZE
:

554 
Next_Sti
 = 
This_Sti
;

555 
Pl_Sti
 = 
This_Sti
;

558 
TokCou
 = 
Npl
;

559 
MSTP_Fg
.
SeMa
 = 
l
;

560 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

561 
si_now
 = 
ue
;

563 
MSTP_MASTER_STATE_IDLE
:

565 i(
	`Tim_S
(>
Tno_tok
) {

568 
EvtCou
 = 0;

569 
Ma_S
 = 
MSTP_MASTER_STATE_NO_TOKEN
;

572 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

573 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

574 
si_now
 = 
ue
;

575 } i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

578 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

580 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

581 
FmeTy
) {

582 
FRAME_TYPE_TOKEN
:

585 i(
DeiAddss
 =
MSTP_BROADCAST_ADDRESS
)

587 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

588 
FmeCou
 = 0;

589 
MSTP_Fg
.
SeMa
 = 
l
;

590 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

591 
si_now
 = 
ue
;

593 
FRAME_TYPE_POLL_FOR_MASTER
:

596 i(
DeiAddss
 =
This_Sti
) {

597 
	`MSTP_Sd_Fme
(
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

598 
SourAddss
, 
This_Sti
, 
NULL
, 0);

601 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

603 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

605 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

607 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

609 i(
DeiAddss
 !
MSTP_BROADCAST_ADDRESS
) {

610 
Ma_S
 =

611 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
;

614 
FRAME_TYPE_TEST_REQUEST
:

615 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TEST_RESPONSE
,

616 
SourAddss
, 
This_Sti
, &
IutBufr
[0],

617 
DaLgth
);

619 
FRAME_TYPE_TEST_RESPONSE
:

625 i(
Ma_S
 !
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
) {

626 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

633 
MSTP_MASTER_STATE_USE_TOKEN
:

637 
TnsmPackL
 = 
	`dlmp_code_uncfmed_ame
();

638 i(
TnsmPackL
) {

639 
	`MSTP_Sd_Fme
(
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
,

640 
MSTP_BROADCAST_ADDRESS
, 
This_Sti
,

641 (
ut8_t
 *& 
TnsmPack
[0], 
TnsmPackL
);

642 
FmeCou
++;

645 
FmeCou
 = 
Nmax_fo_ames
;

646 
si_now
 = 
ue
;

648 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

650 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

653 i(
	`Tim_S
(>
Ty_timeout
) {

656 
FmeCou
 = 
Nmax_fo_ames
;

657 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

662 
si_now
 = 
ue
;

664 i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

667 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

668 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

669 
si_now
 = 
ue
;

670 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

671 i(
DeiAddss
 =
This_Sti
) {

673 
FmeTy
) {

674 
FRAME_TYPE_REPLY_POSTPONED
:

676 
Ma_S
 =

677 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

679 
FRAME_TYPE_TEST_RESPONSE
:

680 
Ma_S
 =

681 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

683 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

687 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

688 
Ma_S
 =

689 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

694 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

705 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

707 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

708 
si_now
 = 
ue
;

714 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
:

716 i(
FmeCou
 < 
Nmax_fo_ames
) {

719 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

720 
si_now
 = 
ue
;

721 } i((
MSTP_Fg
.
SeMa
 =
l
) &&

722 (
Next_Sti
 =
This_Sti
)) {

726 
Pl_Sti
 = 
xt_this_i
;

727 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

728 
This_Sti
, 
NULL
, 0);

729 
RryCou
 = 0;

730 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

733 i(
TokCou
 < (
Npl
 - 1)) {

734 i((
MSTP_Fg
.
SeMa
 =
ue
) &&

735 (
Next_Sti
 !
xt_this_i
)) {

739 
FmeCou
 = 0;

740 
TokCou
++;

741 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

742 
si_now
 = 
ue
;

749 
TokCou
++;

751 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

752 
This_Sti
, 
NULL
, 0);

753 
RryCou
 = 0;

754 
EvtCou
 = 0;

755 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

757 } i(
xt_pl_i
 =
Next_Sti
) {

758 i(
MSTP_Fg
.
SeMa
 =
ue
) {

760 
Pl_Sti
 = 
xt_xt_i
;

761 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

762 
This_Sti
, 
NULL
, 0);

764 
Next_Sti
 = 
This_Sti
;

765 
RryCou
 = 0;

766 
TokCou
 = 1;

769 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

772 
Pl_Sti
 = 
This_Sti
;

774 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

775 
This_Sti
, 
NULL
, 0);

776 
RryCou
 = 0;

777 
TokCou
 = 1;

778 
EvtCou
 = 0;

779 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

783 
Pl_Sti
 = 
xt_pl_i
;

784 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

785 
This_Sti
, 
NULL
, 0);

786 
RryCou
 = 0;

787 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

792 
MSTP_MASTER_STATE_PASS_TOKEN
:

793 i(
	`Tim_S
(<
Tuge_timeout
) {

794 i(
EvtCou
 > 
Nm_os
) {

798 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

799 
si_now
 = 
ue
;

802 i(
RryCou
 < 
Ny_tok
) {

804 
RryCou
++;

806 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

807 
This_Sti
, 
NULL
, 0);

808 
EvtCou
 = 0;

815 
Pl_Sti
 = 
xt_xt_i
;

817 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

818 
This_Sti
, 
NULL
, 0);

820 
Next_Sti
 = 
This_Sti
;

821 
RryCou
 = 0;

822 
TokCou
 = 0;

825 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

833 
MSTP_MASTER_STATE_NO_TOKEN
:

834 
my_timeout
 = 
Tno_tok
 + (
T
 * 
This_Sti
);

835 i(
	`Tim_S
(< 
my_timeout
) {

836 i(
EvtCou
 > 
Nm_os
) {

840 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

841 
si_now
 = 
ue
;

844 
ns_timeout
 = 
Tno_tok
 + (
T
 * (
This_Sti
 + 1));

845 i(
	`Tim_S
(< 
ns_timeout
) {

849 
Pl_Sti
 = 
xt_this_i
;

851 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

852 
This_Sti
, 
NULL
, 0);

854 
Next_Sti
 = 
This_Sti
;

855 
RryCou
 = 0;

856 
TokCou
 = 0;

859 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

866 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

867 i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

868 i((
DeiAddss
 =
This_Sti
)

869 && (
FmeTy
 =
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
)) {

871 
MSTP_Fg
.
SeMa
 = 
l
;

872 
Next_Sti
 = 
SourAddss
;

873 
EvtCou
 = 0;

875 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

876 
This_Sti
, 
NULL
, 0);

877 
Pl_Sti
 = 
This_Sti
;

878 
TokCou
 = 0;

879 
RryCou
 = 0;

880 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

887 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

888 
si_now
 = 
ue
;

890 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

891 } i((
	`Tim_S
(> 
Tuge_timeout
) ||

892 (
MSTP_Fg
.
ReivedInvidFme
 =
ue
)) {

893 i(
MSTP_Fg
.
SeMa
 =
ue
) {

897 
FmeCou
 = 0;

899 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

900 
si_now
 = 
ue
;

902 i(
Next_Sti
 !
This_Sti
) {

906 
EvtCou
 = 0;

908 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

909 
This_Sti
, 
NULL
, 0);

910 
RryCou
 = 0;

911 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

913 i(
xt_pl_i
 !
This_Sti
) {

915 
Pl_Sti
 = 
xt_pl_i
;

917 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
,

918 
Pl_Sti
, 
This_Sti
, 
NULL
, 0);

919 
RryCou
 = 0;

924 
MSTP_Fg
.
SeMa
 = 
ue
;

925 
FmeCou
 = 0;

926 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

927 
si_now
 = 
ue
;

931 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

937 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
:

940 i(
MSTP_Fg
.
TnsmPackPdg
) {

949 
	`MSTP_Sd_Fme
(
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
,

950 
TnsmPackDe
, 
This_Sti
,

951 (
ut8_t
 *& 
TnsmPack
[0], 
TnsmPackL
);

952 
MSTP_Fg
.
TnsmPackPdg
 = 
l
;

953 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

964 
	`MSTP_Sd_Fme
(
FRAME_TYPE_REPLY_POSTPONED
, 
SourAddss
,

965 
This_Sti
, 
NULL
, 0);

966 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

969 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

972 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

976  
si_now
;

977 
	}
}

980 
	$dlmp_nd_pdu
(

981 
BACNET_ADDRESS
 * 
de
,

982 
BACNET_NPDU_DATA
 * 
du_da
,

983 
ut8_t
 * 
pdu
,

984 
pdu_n
)

986 
bys_
 = 0;

988 i(
MSTP_Fg
.
TnsmPackPdg
 =
l
) {

989 
MSTP_Fg
.
TnsmPackDER
 = 
du_da
->
da_exg_y
;

990 
TnsmPack
 = 
pdu
;

991 
TnsmPackL
 = 
pdu_n
;

992 
bys_
 = 
pdu_n
;

993 i(
de
 && de->
mac_n
) {

994 
TnsmPackDe
 = 
de
->
mac
[0];

997 
TnsmPackDe
 = 
MSTP_BROADCAST_ADDRESS
;

999 
MSTP_Fg
.
TnsmPackPdg
 = 
ue
;

1002  
bys_
;

1003 
	}
}

1006 
ut16_t
 
	$dlmp_ive
(

1007 
BACNET_ADDRESS
 * 
c
,

1008 
ut8_t
 * 
pdu
,

1009 
ut16_t
 
max_pdu
,

1010 
timeout
)

1012 
ut16_t
 
pdu_n
 = 0;

1015 
timeout
 =imeout;

1017 i(!
IutBufr
) {

1018 
IutBufr
 = 
pdu
;

1019 
IutBufrSize
 = 
max_pdu
;

1022 i((
MSTP_Fg
.
ReivedVidFme
 =
l
) &&

1023 (
MSTP_Fg
.
ReivedInvidFme
 =
l
)) {

1025 
	`MSTP_Reive_Fme_FSM
();

1026 i(
MSTP_Fg
.
ReivedVidFme
 || MSTP_Fg.
ReivedInvidFme
)

1030 i(
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
)

1035 i(
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
) {

1036 i(
This_Sti
 <
DEFAULT_MAX_MASTER
) {

1037 
	`MSTP_Ma_Node_FSM
()) {

1043 i(
MSTP_Fg
.
ReivePackPdg
) {

1044 
MSTP_Fg
.
ReivePackPdg
 = 
l
;

1045 
pdu_n
 = 
DaLgth
;

1046 
c
->
mac_n
 = 1;

1047 
c
->
mac
[0] = 
SourAddss
;

1051  
pdu_n
;

1052 
	}
}

1054 
	$dlmp_t_mac_addss
(

1055 
ut8_t
 
mac_addss
)

1058 i(
mac_addss
 <= 127) {

1059 
This_Sti
 = 
mac_addss
;

1065 i(
mac_addss
 > 
Nmax_ma
)

1066 
	`dlmp_t_max_ma
(
mac_addss
);

1070 
	}
}

1072 
ut8_t
 
	$dlmp_mac_addss
(

1075  
This_Sti
;

1076 
	}
}

1085 
	$dlmp_t_max_fo_ames
(

1086 
ut8_t
 
max_fo_ames
)

1088 i(
max_fo_ames
 >= 1) {

1089 
Nmax_fo_ames
 = 
max_fo_ames
;

1098 
	}
}

1100 
ut8_t
 
	$dlmp_max_fo_ames
(

1103  
Nmax_fo_ames
;

1104 
	}
}

1111 
	$dlmp_t_max_ma
(

1112 
ut8_t
 
max_ma
)

1114 i(
max_ma
 <= 127) {

1115 i(
This_Sti
 <
max_ma
) {

1116 
Nmax_ma
 = 
max_ma
;

1126 
	}
}

1128 
ut8_t
 
	$dlmp_max_ma
(

1131  
Nmax_ma
;

1132 
	}
}

1134 
	$dlmp_g_my_addss
(

1135 
BACNET_ADDRESS
 * 
my_addss
)

1137 
i
 = 0;

1139 
my_addss
->
mac_n
 = 1;

1140 
my_addss
->
mac
[0] = 
This_Sti
;

1141 
my_addss
->
t
 = 0;

1142 
my_addss
->
n
 = 0;

1143 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1144 
my_addss
->
adr
[
i
] = 0;

1148 
	}
}

1150 
	$dlmp_g_brd_addss
(

1151 
BACNET_ADDRESS
 * 
de
)

1153 
i
 = 0;

1155 i(
de
) {

1156 
de
->
mac_n
 = 1;

1157 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

1158 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

1159 
de
->
n
 = 0;

1160 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1161 
de
->
adr
[
i
] = 0;

1166 
	}
}

	@ports/atmega168/h_rp.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~".h
"

40 
	~"devi.h
"

41 
	~"av.h
"

42 
	~"bv.h
"

46 
	$Encode_Prݔty_APDU
(

47 
ut8_t
 * 
du
,

48 
BACNET_READ_PROPERTY_DATA
 * 
_da
,

49 
BACNET_ERROR_CLASS
 * 
r_ass
,

50 
BACNET_ERROR_CODE
 * 
r_code
)

52 
du_n
 = -1;

55 
_da
->
obje_ty
) {

56 
OBJECT_DEVICE
:

58 i(
_da
->
obje_
 =
BACNET_MAX_INSTANCE
) {

59 
_da
->
obje_
 = 
	`Devi_Obje_In_Numb
();

61 i(
	`Devi_Vid_Obje_In_Numb
(
_da
->
obje_
)) {

62 
du_n
 =

63 
	`Devi_Encode_Prݔty_APDU
(&
du
[0],

64 
_da
->
obje_
,p_da->
obje_ݔty
,

65 
_da
->
y_dex
, 
r_ass
, 
r_code
);

68 
OBJECT_ANALOG_VALUE
:

69 i(
	`Alog_Vue_Vid_In
(
_da
->
obje_
)) {

70 
du_n
 =

71 
	`Alog_Vue_Encode_Prݔty_APDU
(&
du
[0],

72 
_da
->
obje_
,p_da->
obje_ݔty
,

73 
_da
->
y_dex
, 
r_ass
, 
r_code
);

76 
OBJECT_BINARY_VALUE
:

77 i(
	`By_Vue_Vid_In
(
_da
->
obje_
)) {

78 
du_n
 =

79 
	`By_Vue_Encode_Prݔty_APDU
(&
du
[0],

80 
_da
->
obje_
,p_da->
obje_ݔty
,

81 
_da
->
y_dex
, 
r_ass
, 
r_code
);

85 *
r_ass
 = 
ERROR_CLASS_OBJECT
;

86 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

90  
du_n
;

91 
	}
}

93 
	$hdr_ad_ݔty
(

94 
ut8_t
 * 
rvi_que
,

95 
ut16_t
 
rvi_n
,

96 
BACNET_ADDRESS
 * 
c
,

97 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

99 
BACNET_READ_PROPERTY_DATA
 
da
;

100 
n
 = 0;

101 
ack_n
 = 0;

102 
ݔty_n
 = 0;

103 
pdu_n
 = 0;

104 
BACNET_NPDU_DATA
 
du_da
;

105 
BACNET_ERROR_CLASS
 
r_ass
 = 
ERROR_CLASS_OBJECT
;

106 
BACNET_ERROR_CODE
 
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

107 
BACNET_ADDRESS
 
my_addss
;

110 
	`dk_g_my_addss
(&
my_addss
);

111 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

112 
pdu_n
 =

113 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

114 &
du_da
);

115 i(
rvi_da
->
gmd_mesge
) {

117 
n
 =

118 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

119 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

120 
ue
);

121 
RP_ABORT
;

123 
n
 = 
	`_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

124 i(
n
 < 0) {

126 
n
 =

127 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

128 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

129 
RP_ABORT
;

132 
ack_n
 =

133 
	`_ack_code_du_
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

134 
rvi_da
->
voke_id
, &
da
);

136 
ݔty_n
 =

137 
	`Encode_Prݔty_APDU
(&
Hdr_Tnsm_Bufr
[
pdu_n
 + 
ack_n
],

138 &
da
, &
r_ass
, &
r_code
);

139 i(
ݔty_n
 >= 0) {

140 
n
 =

141 
	`_ack_code_du_obje_ݔty_d
(&
Hdr_Tnsm_Bufr


142 [
pdu_n
 + 
ݔty_n
 + 
ack_n
]);

143 
n
 +
ack_n
 + 
ݔty_n
;

145 
ݔty_n
) {

147 
BACNET_STATUS_ABORT
:

148 
n
 =

149 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

150 
rvi_da
->
voke_id
,

151 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
, 
ue
);

154 
n
 =

155 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

156 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_READ_PROPERTY
,

157 
r_ass
, 
r_code
);

161 
RP_ABORT
:

162 
pdu_n
 +
n
;

163 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

164 
pdu_n
);

167 
	}
}

	@ports/atmega168/h_whois.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"whois.h
"

35 
	~"m.h
"

36 
	~"devi.h
"

37 
	~".h
"

38 
	~"txbuf.h
"

40 
bo
 
	gSd_I_Am_Fg
 = 
ue
;

42 
	$hdr_who_is
(

43 
ut8_t
 * 
rvi_que
,

44 
ut16_t
 
rvi_n
,

45 
BACNET_ADDRESS
 * 
c
)

47 
n
 = 0;

48 
t32_t
 
low_lim
 = 0;

49 
t32_t
 
high_lim
 = 0;

50 
t32_t
 
rg_devi
;

52 (
c
;

53 
n
 =

54 
	`whois_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
low_lim
,

55 &
high_lim
);

56 i(
n
 == 0) {

57 
Sd_I_Am_Fg
 = 
ue
;

58 } i(
n
 !
BACNET_STATUS_ERROR
) {

60 
rg_devi
 = 
	`Devi_Obje_In_Numb
();

61 i((
rg_devi
 >
low_lim
&& (rg_devi <
high_lim
)) {

62 
Sd_I_Am_Fg
 = 
ue
;

67 
	}
}

	@ports/atmega168/h_wp.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~"wp.h
"

40 
	~"devi.h
"

41 
	~"av.h
"

42 
	~"bv.h
"

45 
BACNET_WRITE_PROPERTY_DATA
 
	gwp_da
;

47 
	$hdr_wre_ݔty
(

48 
ut8_t
 * 
rvi_que
,

49 
ut16_t
 
rvi_n
,

50 
BACNET_ADDRESS
 * 
c
,

51 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

53 
n
 = 0;

54 
pdu_n
 = 0;

55 
BACNET_NPDU_DATA
 
du_da
;

56 
BACNET_ERROR_CLASS
 
r_ass
 = 
ERROR_CLASS_OBJECT
;

57 
BACNET_ERROR_CODE
 
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

58 
BACNET_ADDRESS
 
my_addss
;

61 
n
 = 
	`wp_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
wp_da
);

63 
	`dk_g_my_addss
(&
my_addss
);

64 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

65 
pdu_n
 =

66 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

67 &
du_da
);

69 i(
n
 <= 0) {

70 
n
 =

71 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

72 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

73 } i(
rvi_da
->
gmd_mesge
) {

74 
n
 =

75 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

76 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

77 
ue
);

79 
wp_da
.
obje_ty
) {

80 
OBJECT_DEVICE
:

81 i(
	`Devi_Wre_Prݔty
(&
wp_da
, &
r_ass
, &
r_code
)) {

82 
n
 =

83 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

84 
rvi_da
->
voke_id
,

85 
SERVICE_CONFIRMED_WRITE_PROPERTY
);

87 
n
 =

88 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

89 
rvi_da
->
voke_id
,

90 
SERVICE_CONFIRMED_WRITE_PROPERTY
, 
r_ass
,

91 
r_code
);

94 
OBJECT_ANALOG_VALUE
:

95 i(
	`Alog_Vue_Wre_Prݔty
(&
wp_da
, &
r_ass
,

96 &
r_code
)) {

97 
n
 =

98 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

99 
rvi_da
->
voke_id
,

100 
SERVICE_CONFIRMED_WRITE_PROPERTY
);

102 
n
 =

103 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

104 
rvi_da
->
voke_id
,

105 
SERVICE_CONFIRMED_WRITE_PROPERTY
, 
r_ass
,

106 
r_code
);

109 
OBJECT_BINARY_VALUE
:

110 i(
	`By_Vue_Wre_Prݔty
(&
wp_da
, &
r_ass
,

111 &
r_code
)) {

112 
n
 =

113 
	`code_sime_ack
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

114 
rvi_da
->
voke_id
,

115 
SERVICE_CONFIRMED_WRITE_PROPERTY
);

117 
n
 =

118 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

119 
rvi_da
->
voke_id
,

120 
SERVICE_CONFIRMED_WRITE_PROPERTY
, 
r_ass
,

121 
r_code
);

125 
n
 =

126 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

127 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_WRITE_PROPERTY
,

128 
r_ass
, 
r_code
);

132 
pdu_n
 +
n
;

133 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

134 
pdu_n
);

137 
	}
}

	@ports/atmega168/hardware.h

25 #ide
HARDWARE_H


26 
	#HARDWARE_H


	)

28 #i!
defed
(
F_CPU
)

30 
	#F_CPU
 7372800UL

	)

33 #i
defed
(
__IAR_SYSTEMS_ICC__
|| defed(
__IAR_SYSTEMS_ASM__
)

34 
	~<iom168.h
>

36 #i!
defed
(
__AVR_ATmega168__
)

37 #r 
Fmwe
 
is
 
cfigud
 
ATmega168
 
ly
 (-
mmcu
=
mega168
)

40 
	~"r2gcc.h
"

41 
	~"avr035.h
"

43 
	#LED_NPDU_INIT
(
	`BIT_SET
(
DDRD
, 
DDD5
)

	)

44 
	#LED_NPDU_ON
(
	`BIT_CLEAR
(
PORTD
, 
PD5
)

	)

45 
	#LED_NPDU_OFF
(
	`BIT_SET
(
PORTD
, 
PD5
)

	)

50 
	#LED_GREEN_INIT
(
	`BIT_SET
(
DDRD
, 
DDD4
)

	)

51 
	#LED_GREEN_ON
(
	`BIT_CLEAR
(
PORTD
, 
PD4
)

	)

52 
	#LED_GREEN_OFF
(
	`BIT_SET
(
PORTD
, 
PD4
)

	)

	@ports/atmega168/iar2gcc.h

34 #ide
IAR2GCC_H


35 
	#IAR2GCC_H


	)

37 #i!
defed
(
F_CPU
)

38 
	#F_CPU
 (7372800)

	)

42 #i
defed
(
__IAR_SYSTEMS_ICC__
|| defed(
__IAR_SYSTEMS_ASM__
)

43 
	~<avr.h
>

44 
	~<ivr.h
>

46 #ide
_BV


47 
	#_BV
(
b_num
(1 << (b_num))

	)

51 
le
 
	$_day_us
(

52 
ut8_t
 
miocds
)

55 
	`__day_cyes
(
F_CPU
 / 1000000UL);

56 } 
miocds
--);

57 
	}
}

61 #i
defed
(
__GNUC__
)

62 
	~<avr/io.h
>

65 
	mb0
:1;

66 
	mb1
:1;

67 
	mb2
:1;

68 
	mb3
:1;

69 
	mb4
:1;

70 
	mb5
:1;

71 
	mb6
:1;

72 
	mb7
:1;

73 } 
	tBRegiTy
;

75 #ide
ue


76 
	#ue
 1

	)

79 #ide
l


80 
	#l
 0

	)

83 
	#GPIO_BITREG
(
pt
,
bnum
) \

84 ((vީ
BRegiTy
*)
	`_SFR_MEM_ADDR
(
pt
) \

85 )->
b
 ## 
bnum


	)

87 
	#PINA_B0
 
	`GPIO_BITREG
(
PINA
,0)

	)

88 
	#PINA_B1
 
	`GPIO_BITREG
(
PINA
,1)

	)

89 
	#PINA_B2
 
	`GPIO_BITREG
(
PINA
,2)

	)

90 
	#PINA_B3
 
	`GPIO_BITREG
(
PINA
,3)

	)

91 
	#PINA_B4
 
	`GPIO_BITREG
(
PINA
,4)

	)

92 
	#PINA_B5
 
	`GPIO_BITREG
(
PINA
,5)

	)

93 
	#PINA_B6
 
	`GPIO_BITREG
(
PINA
,6)

	)

94 
	#PINA_B7
 
	`GPIO_BITREG
(
PINA
,7)

	)

96 
	#PORTA_B0
 
	`GPIO_BITREG
(
PORTA
,0)

	)

97 
	#PORTA_B1
 
	`GPIO_BITREG
(
PORTA
,1)

	)

98 
	#PORTA_B2
 
	`GPIO_BITREG
(
PORTA
,2)

	)

99 
	#PORTA_B3
 
	`GPIO_BITREG
(
PORTA
,3)

	)

100 
	#PORTA_B4
 
	`GPIO_BITREG
(
PORTA
,4)

	)

101 
	#PORTA_B5
 
	`GPIO_BITREG
(
PORTA
,5)

	)

102 
	#PORTA_B6
 
	`GPIO_BITREG
(
PORTA
,6)

	)

103 
	#PORTA_B7
 
	`GPIO_BITREG
(
PORTA
,7)

	)

105 
	#PINB_B0
 
	`GPIO_BITREG
(
PINB
,0)

	)

106 
	#PINB_B1
 
	`GPIO_BITREG
(
PINB
,1)

	)

107 
	#PINB_B2
 
	`GPIO_BITREG
(
PINB
,2)

	)

108 
	#PINB_B3
 
	`GPIO_BITREG
(
PINB
,3)

	)

109 
	#PINB_B4
 
	`GPIO_BITREG
(
PINB
,4)

	)

110 
	#PINB_B5
 
	`GPIO_BITREG
(
PINB
,5)

	)

111 
	#PINB_B6
 
	`GPIO_BITREG
(
PINB
,6)

	)

112 
	#PINB_B7
 
	`GPIO_BITREG
(
PINB
,7)

	)

114 
	#PORTB_B0
 
	`GPIO_BITREG
(
PORTB
,0)

	)

115 
	#PORTB_B1
 
	`GPIO_BITREG
(
PORTB
,1)

	)

116 
	#PORTB_B2
 
	`GPIO_BITREG
(
PORTB
,2)

	)

117 
	#PORTB_B3
 
	`GPIO_BITREG
(
PORTB
,3)

	)

118 
	#PORTB_B4
 
	`GPIO_BITREG
(
PORTB
,4)

	)

119 
	#PORTB_B5
 
	`GPIO_BITREG
(
PORTB
,5)

	)

120 
	#PORTB_B6
 
	`GPIO_BITREG
(
PORTB
,6)

	)

121 
	#PORTB_B7
 
	`GPIO_BITREG
(
PORTB
,7)

	)

123 
	#PINC_B0
 
	`GPIO_BITREG
(
PINC
,0)

	)

124 
	#PINC_B1
 
	`GPIO_BITREG
(
PINC
,1)

	)

125 
	#PINC_B2
 
	`GPIO_BITREG
(
PINC
,2)

	)

126 
	#PINC_B3
 
	`GPIO_BITREG
(
PINC
,3)

	)

127 
	#PINC_B4
 
	`GPIO_BITREG
(
PINC
,4)

	)

128 
	#PINC_B5
 
	`GPIO_BITREG
(
PINC
,5)

	)

129 
	#PINC_B6
 
	`GPIO_BITREG
(
PINC
,6)

	)

130 
	#PINC_B7
 
	`GPIO_BITREG
(
PINC
,7)

	)

132 
	#PORTC_B0
 
	`GPIO_BITREG
(
PORTC
,0)

	)

133 
	#PORTC_B1
 
	`GPIO_BITREG
(
PORTC
,1)

	)

134 
	#PORTC_B2
 
	`GPIO_BITREG
(
PORTC
,2)

	)

135 
	#PORTC_B3
 
	`GPIO_BITREG
(
PORTC
,3)

	)

136 
	#PORTC_B4
 
	`GPIO_BITREG
(
PORTC
,4)

	)

137 
	#PORTC_B5
 
	`GPIO_BITREG
(
PORTC
,5)

	)

138 
	#PORTC_B6
 
	`GPIO_BITREG
(
PORTC
,6)

	)

139 
	#PORTC_B7
 
	`GPIO_BITREG
(
PORTC
,7)

	)

141 
	#PIND_B0
 
	`GPIO_BITREG
(
PIND
,0)

	)

142 
	#PIND_B1
 
	`GPIO_BITREG
(
PIND
,1)

	)

143 
	#PIND_B2
 
	`GPIO_BITREG
(
PIND
,2)

	)

144 
	#PIND_B3
 
	`GPIO_BITREG
(
PIND
,3)

	)

145 
	#PIND_B4
 
	`GPIO_BITREG
(
PIND
,4)

	)

146 
	#PIND_B5
 
	`GPIO_BITREG
(
PIND
,5)

	)

147 
	#PIND_B6
 
	`GPIO_BITREG
(
PIND
,6)

	)

148 
	#PIND_B7
 
	`GPIO_BITREG
(
PIND
,7)

	)

150 
	#PORTD_B0
 
	`GPIO_BITREG
(
PORTD
,0)

	)

151 
	#PORTD_B1
 
	`GPIO_BITREG
(
PORTD
,1)

	)

152 
	#PORTD_B2
 
	`GPIO_BITREG
(
PORTD
,2)

	)

153 
	#PORTD_B3
 
	`GPIO_BITREG
(
PORTD
,3)

	)

154 
	#PORTD_B4
 
	`GPIO_BITREG
(
PORTD
,4)

	)

155 
	#PORTD_B5
 
	`GPIO_BITREG
(
PORTD
,5)

	)

156 
	#PORTD_B6
 
	`GPIO_BITREG
(
PORTD
,6)

	)

157 
	#PORTD_B7
 
	`GPIO_BITREG
(
PORTD
,7)

	)

159 
	#GPIOR0_B0
 
	`GPIO_BITREG
(
GPIOR0
,0)

	)

160 
	#GPIOR0_B1
 
	`GPIO_BITREG
(
GPIOR0
,1)

	)

161 
	#GPIOR0_B2
 
	`GPIO_BITREG
(
GPIOR0
,2)

	)

162 
	#GPIOR0_B3
 
	`GPIO_BITREG
(
GPIOR0
,3)

	)

163 
	#GPIOR0_B4
 
	`GPIO_BITREG
(
GPIOR0
,4)

	)

164 
	#GPIOR0_B5
 
	`GPIO_BITREG
(
GPIOR0
,5)

	)

165 
	#GPIOR0_B6
 
	`GPIO_BITREG
(
GPIOR0
,6)

	)

166 
	#GPIOR0_B7
 
	`GPIO_BITREG
(
GPIOR0
,7)

	)

168 
	#GPIOR1_B0
 
	`GPIO_BITREG
(
GPIOR1
,0)

	)

169 
	#GPIOR1_B1
 
	`GPIO_BITREG
(
GPIOR1
,1)

	)

170 
	#GPIOR1_B2
 
	`GPIO_BITREG
(
GPIOR1
,2)

	)

171 
	#GPIOR1_B3
 
	`GPIO_BITREG
(
GPIOR1
,3)

	)

172 
	#GPIOR1_B4
 
	`GPIO_BITREG
(
GPIOR1
,4)

	)

173 
	#GPIOR1_B5
 
	`GPIO_BITREG
(
GPIOR1
,5)

	)

174 
	#GPIOR1_B6
 
	`GPIO_BITREG
(
GPIOR1
,6)

	)

175 
	#GPIOR1_B7
 
	`GPIO_BITREG
(
GPIOR1
,7)

	)

177 
	#GPIOR2_B0
 
	`GPIO_BITREG
(
GPIOR2
,0)

	)

178 
	#GPIOR2_B1
 
	`GPIO_BITREG
(
GPIOR2
,1)

	)

179 
	#GPIOR2_B2
 
	`GPIO_BITREG
(
GPIOR2
,2)

	)

180 
	#GPIOR2_B3
 
	`GPIO_BITREG
(
GPIOR2
,3)

	)

181 
	#GPIOR2_B4
 
	`GPIO_BITREG
(
GPIOR2
,4)

	)

182 
	#GPIOR2_B5
 
	`GPIO_BITREG
(
GPIOR2
,5)

	)

183 
	#GPIOR2_B6
 
	`GPIO_BITREG
(
GPIOR2
,6)

	)

184 
	#GPIOR2_B7
 
	`GPIO_BITREG
(
GPIOR2
,7)

	)

189 #i
defed
(
__GNUC__
)

190 
	#__ab_u
(
	`i
()

	)

191 
	#__dib_u
(
	`i
()

	)

195 #i
defed
(
__ICCAVR__
)

196 
	#PRAGMA
(
x

	`_Pgma
#x )

	)

197 
	#ISR
(
vec

	`PRAGMA

ve
=ve
__u
 
hdr_
##
	`vec
()

	)

199 #i
defed
(
__GNUC__
)

200 
	~<avr/u.h
>

204 #i
defed
(
__ICCAVR__
)

205 
	#FLASH_DECLARE
(
x

__ash
 
	)
x

207 #i
defed
(
__GNUC__
)

208 
	#FLASH_DECLARE
(
x
x 
	`__ibu__
((
__ogmem__
))

	)

212 #i
defed
(
__ICCAVR__
)

213 
	#EEPROM_DECLARE
(
x

__om
 
	)
x

215 #i
defed
(
__GNUC__
)

216 
	~<avr/om.h
>

217 
	#EEPROM_DECLARE
(
x
x 
	`__ibu__
((
	`i
 (".om")))

	)

221 #i
defed
(
__GNUC__
)

223 
	#__muɝly_unsigd
(
x
,
y
((x)*(y))

	)

225 
	#__ro


	)

	@ports/atmega168/main.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~"hdwe.h
"

29 
	~"tim.h
"

30 
	~"rs485.h
"

31 
	~"dk.h
"

32 
	~"du.h
"

33 
	~"hdrs.h
"

34 
	~"txbuf.h
"

35 
	~"m.h
"

36 
	~"devi.h
"

37 
	~"av.h
"

40 
bo
 
Sd_I_Am_Fg
;

42 cڡ *
	gBACt_Vsi
 = "1.0";

48 
bo
 
	$dcc_communiti_abd
(

51  
ue
;

52 
	}
}

54 
	$
(

60 
CLKPR
 = 
	`_BV
(
CLKPCE
);

75 
CLKPR
 = 0;

79 
DDRB
 = 0;

80 
PORTB
 = 0;

81 
DDRC
 = 0;

82 
PORTC
 = 0;

83 
DDRD
 = 0;

84 
PORTD
 = 0;

87 
	`BIT_CLEAR
(
MCUSR
, 
WDRF
);

88 
WDTCSR
 = 0;

91 
	`RS485_Inlize
();

95 
	`LED_NPDU_OFF
();

96 
	`LED_NPDU_INIT
();

98 
	`LED_GREEN_INIT
();

99 
	`LED_GREEN_OFF
();

102 
	`Tim_Inlize
();

105 
	`__ab_u
();

106 
	}
}

108 
	$sk_mlicds
(

111 
Tim_Mlicds
) {

112 
Tim_Mlicds
--;

114 
	`RS485_LED_Tims
();

116 
	}
}

118 
ut8_t
 
	gAddss_Swch
;

120 
	$put_swch_ad
(

123 
ut8_t
 
vue
;

124 
ut8_t
 
d_vue
 = 0;

126 
vue
 = 
	`BITMASK_CHECK
(
PINC
, 0x0F);

127 
vue
 |(
	`BITMASK_CHECK
(
PINB
, 0x07) << 4);

128 i(
vue
 !
d_vue
) {

129 
d_vue
 = 
vue
;

131 i(
d_vue
 !
Addss_Swch
) {

132 
Addss_Swch
 = 
d_vue
;

133 #i
	`defed
(
BACDL_MSTP
)

134 
	`dlmp_t_mac_addss
(
Addss_Swch
);

136 
	`Devi_S_Obje_In_Numb
(86000 + 
Addss_Swch
);

137 
Sd_I_Am_Fg
 = 
ue
;

140 
	}
}

142 
ut8_t
 
	gPDUBufr
[
MAX_MPDU
];

143 
	$ma
(

146 
ut16_t
 
pdu_n
 = 0;

147 
BACNET_ADDRESS
 
c
;

149 
	`
();

150 #i
	`defed
(
BACDL_MSTP
)

151 
	`RS485_S_Baud_Re
(38400);

152 
	`dlmp_t_max_ma
(127);

153 
	`dlmp_t_max_fo_ames
(1);

155 
	`dk_
(
NULL
);

157 
	`put_swch_ad
();

158 
	`sk_mlicds
();

161 
pdu_n
 = 
	`dk_ive
(&
c
, &
PDUBufr
[0], (PDUBuffer), 0);

162 i(
pdu_n
) {

163 
	`LED_NPDU_ON
();

164 
	`du_hdr
(&
c
, &
PDUBufr
[0], 
pdu_n
);

165 
	`LED_NPDU_OFF
();

168 
	}
}

	@ports/atmega168/rs485.c

29 
	~<ddef.h
>

30 
	~<dt.h
>

31 
	~<dbo.h
>

32 
	~<dlib.h
>

33 
	~<dio.h
>

37 
	~"hdwe.h
"

38 
	~"tim.h
"

41 
ut8_t
 
	gLED1_Off_Tim
;

42 
ut8_t
 
	gLED3_Off_Tim
;

45 
ut32_t
 
	gRS485_Baud
 = 9600;

54 
	$RS485_Inlize
(

58 
UCSR0B
 = 
	`_BV
(
TXEN0
| _BV(
RXEN0
);

67 
UCSR0C
 = 
	`_BV
(
UCSZ01
| _BV(
UCSZ00
);

69 
	`BIT_CLEAR
(
PRR
, 
PRUSART0
);

72 
	`BIT_CLEAR
(
PORTD
, 
PD2
);

73 
	`BIT_SET
(
DDRD
, 
DDD2
);

75 
	`BIT_SET
(
PORTD
, 
PD6
);

76 
	`BIT_SET
(
PORTD
, 
PD7
);

77 
	`BIT_SET
(
DDRD
, 
DDD6
);

78 
	`BIT_SET
(
DDRD
, 
DDD7
);

81 
	}
}

89 
ut32_t
 
	$RS485_G_Baud_Re
(

92  
RS485_Baud
;

93 
	}
}

101 
bo
 
	$RS485_S_Baud_Re
(

102 
ut32_t
 
baud
)

104 
bo
 
vid
 = 
ue
;

106 
baud
) {

113 
RS485_Baud
 = 
baud
;

115 
	`BIT_SET
(
UCSR0A
, 
U2X0
);

117 
UBRR0
 = (
F_CPU
 / (8UL * 
RS485_Baud
)) - 1;

121 
vid
 = 
l
;

125  
vid
;

126 
	}
}

134 
	$RS485_Tnsmr_Eb
(

135 
bo
 
ab
)

137 i(
ab
) {

138 
	`BIT_SET
(
PORTD
, 
PD2
);

140 
	`BIT_CLEAR
(
PORTD
, 
PD2
);

142 
	}
}

150 
	$RS485_Tuound_Day
(

153 
ut8_t
 
nbys
 = 4;

155 
	`RS485_Tnsmr_Eb
(
l
);

156 
nbys
) {

157 !
	`BIT_CHECK
(
UCSR0A
, 
UDRE0
)) {

161 
UDR0
 = 0xff;

162 
nbys
--;

165 !
	`BIT_CHECK
(
UCSR0A
, 
TXC0
)) {

170 
	`BIT_SET
(
UCSR0A
, 
TXC0
);

171 
	}
}

179 
	$RS485_LED_Tims
(

182 i(
LED1_Off_Tim
) {

183 
LED1_Off_Tim
--;

184 i(
LED1_Off_Tim
 == 0) {

185 
	`BIT_SET
(
PORTD
, 
PD6
);

188 i(
LED3_Off_Tim
) {

189 
LED3_Off_Tim
--;

190 i(
LED3_Off_Tim
 == 0) {

191 
	`BIT_SET
(
PORTD
, 
PD7
);

194 
	}
}

202 
	$RS485_LED1_On
(

205 
	`BIT_CLEAR
(
PORTD
, 
PD6
);

206 
LED1_Off_Tim
 = 20;

207 
	}
}

215 
	$RS485_LED3_On
(

218 
	`BIT_CLEAR
(
PORTD
, 
PD7
);

219 
LED3_Off_Tim
 = 20;

220 
	}
}

228 
	$RS485_Sd_Da
(

229 
ut8_t
 * 
bufr
,

230 
ut16_t
 
nbys
)

232 
	`RS485_LED3_On
();

233 
nbys
) {

234 !
	`BIT_CHECK
(
UCSR0A
, 
UDRE0
)) {

238 
UDR0
 = *
bufr
;

239 
bufr
++;

240 
nbys
--;

243 !
	`BIT_CHECK
(
UCSR0A
, 
TXC0
)) {

248 
	`BIT_SET
(
UCSR0A
, 
TXC0
);

250 
	`Tim_S_Ret
();

251 
	}
}

259 
bo
 
	$RS485_ReiveE
(

262 
bo
 
ReiveE
 = 
l
;

263 vީ
ut8_t
 
dummy_da
;

267 i(
	`BIT_CHECK
(
UCSR0A
, 
FE0
)) {

269 
	`BITMASK_CLEAR
(
UCSR0A
, (
	`_BV
(
FE0
| _BV(
DOR0
| _BV(
UPE0
)));

270 
ReiveE
 = 
ue
;

274 i(
	`BIT_CHECK
(
UCSR0A
, 
DOR0
)) {

277 
dummy_da
 = 
UDR0
;

278 ()
dummy_da
;

279 } 
	`BIT_CHECK
(
UCSR0A
, 
RXC0
));

280 
ReiveE
 = 
ue
;

282 i(
ReiveE
) {

283 
	`RS485_LED1_On
();

286  
ReiveE
;

287 
	}
}

295 
bo
 
	$RS485_DaAvaab
(

296 
ut8_t
 * 
da
)

298 
bo
 
DaAvaab
 = 
l
;

301 i(
	`BIT_CHECK
(
UCSR0A
, 
RXC0
)) {

302 *
da
 = 
UDR0
;

303 
DaAvaab
 = 
ue
;

304 
	`RS485_LED1_On
();

307  
DaAvaab
;

308 
	}
}

310 #ifde
TEST_RS485


311 
	$ma
(

314 
i
 = 0;

315 
ut8_t
 
DaRegi
;

317 
	`RS485_S_Baud_Re
(38400);

318 
	`RS485_Inlize
();

321 i(
	`RS485_ReiveE
()) {

322 
	`rtf
(
dr
, "ERROR ");

323 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

324 
	`rtf
(
dr
, "%02X ", 
DaRegi
);

327 
	}
}

	@ports/atmega168/rs485.h

36 #ide
RS485_H


37 
	#RS485_H


	)

39 
	~<dt.h
>

41 #ifde
__lulus


45 
RS485_Inlize
(

48 
RS485_Tnsmr_Eb
(

49 
bo
 
ab
);

51 
RS485_Sd_Da
(

52 
ut8_t
 * 
bufr
,

53 
ut16_t
 
nbys
);

55 
bo
 
RS485_ReiveE
(

57 
bo
 
RS485_DaAvaab
(

58 
ut8_t
 * 
da
);

60 
RS485_Tuound_Day
(

62 
ut32_t
 
RS485_G_Baud_Re
(

64 
bo
 
RS485_S_Baud_Re
(

65 
ut32_t
 
baud
);

67 
RS485_LED_Tims
(

70 #ifde
__lulus


	@ports/atmega168/stack.c

25 
	~<dt.h
>

26 
	~"hdwe.h
"

29 #i
defed
(
__GNUC__
)

30 
ut8_t
 
_d
;

31 
ut8_t
 
__ack
;

34 #i
defed
(
__GNUC__
)

35 
	#STACK_CANARY
 (0xC5)

	)

36 
	$ack_
(

37 
	`__ibu__
 ((
ked
)__ibu__ ((
	`i
(".init1")));

40 
	$ack_
(

43 #i
	`defed
(
__GNUC__
)

45 
ut8_t
 *
p
 = &
_d
;

47 
p
 <&
__ack
) {

48 *
p
 = 
STACK_CANARY
;

49 
p
++;

52 
__asm
 volatile (

59 
	}
}

61 
	$ack_size
(

64 #i
	`defed
(
__GNUC__
)

65  (&
__ack
- (&
_d
);

69 
	}
}

71 
ut8_t
 
	$ack_by
(

72 
offt
)

74 #i
	`defed
(
__GNUC__
)

75  *(&
_d
 + 
offt
);

77 
offt
 = offset;

80 
	}
}

82 
	$ack_unud
(

85 
cou
 = 0;

86 #i
	`defed
(
__GNUC__
)

87 
ut8_t
 *
p
 = &
_d
;

89 
p
 <&
__ack
) {

90 i((*
p
!
STACK_CANARY
) {

91 
cou
 = 
p
 - (&
_d
);

94 
p
++;

97  
cou
;

98 
	}
}

	@ports/atmega168/stack.h

25 #ide
STACK_H


26 
	#STACK_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

31 #ifde
__lulus


36 
ack_
(

39 
ack_size
(

42 
ut8_t
 
ack_by
(

43 
offt
);

45 
ack_unud
(

48 #ifde
__lulus


	@ports/atmega168/stdbool.h

1 #ide
STDBOOL_H


2 
	#STDBOOL_H


	)

6 #ide
__lulus


8 #ide
bo


9 
	#bo
 
_Bo


	)

11 #ide
ue


12 
	#ue
 1

	)

14 #ide
l


15 
	#l
 0

	)

17 
	#__bo_ue_l_e_defed
 1

	)

20 #ide
FALSE


21 
	#FALSE
 0

	)

24 #ide
TRUE


25 
	#TRUE
 1

	)

	@ports/atmega168/stdint.h

3 #ide
STDINT_H


4 
	#STDINT_H
 1

	)

6 
	~<ddef.h
>

8 
	tut8_t
;

9 sigd 
	tt8_t
;

10 
	tut16_t
;

11 sigd 
	tt16_t
;

12 
	tut32_t
;

13 sigd 
	tt32_t
;

	@ports/atmega168/timer.c

25 
	~<dt.h
>

26 
	~"hdwe.h
"

31 
	#TIMER_PRESCALER
 64

	)

33 
	#TIMER_TICKS
 (
F_CPU
/
TIMER_PRESCALER
/1000)

	)

34 #i(
TIMER_TICKS
 > 0xFF)

35 #r 
Tim
 
Psr
 
vue
 
is
 
too
 
sml


37 
	#TIMER_COUNT
 (0xFF-
TIMER_TICKS
)

	)

39 vީ
ut8_t
 
	gTim_Mlicds
 = 0;

41 vީ
ut16_t
 
	gSTime
;

44 
	$Tim_Inlize
(

48 
TCCR1A
 = 0;

60 
TCCR0B
 = 
	`_BV
(
CS01
| _BV(
CS00
);

62 
	`BIT_CLEAR
(
TIFR0
, 
TOV0
);

64 
TCNT0
 = 
TIMER_COUNT
;

66 
	`BIT_SET
(
TIMSK0
, 
TOIE0
);

68 
	`BIT_CLEAR
(
PRR
, 
PRTIM0
);

69 
	}
}

74 
	$ISR
(
TIMER0_OVF_ve
)

77 
TCNT0
 = 
TIMER_COUNT
;

80 i(
Tim_Mlicds
 < 0xFF)

81 
Tim_Mlicds
++;

82 i(
STime
 < 0xFFFF)

83 
STime
++;

84 
	}
}

87 
ut16_t
 
	$Tim_S
(

90 
ut16_t
 
tim
;

92 
	`BIT_CLEAR
(
TIMSK0
, 
TOIE0
);

93 
tim
 = 
STime
;

94 
	`BIT_SET
(
TIMSK0
, 
TOIE0
);

96  
tim
;

97 
	}
}

100 
	$Tim_S_Ret
(

103 
	`BIT_CLEAR
(
TIMSK0
, 
TOIE0
);

104 
STime
 = 0;

105 
	`BIT_SET
(
TIMSK0
, 
TOIE0
);

106 
	}
}

	@ports/atmega168/timer.h

25 #ide
TIMER_H


26 
	#TIMER_H


	)

28 vީ
ut8_t
 
Tim_Mlicds
;

30 #ifde
__lulus


34 
Tim_Inlize
(

36 
ut16_t
 
Tim_S
(

38 
Tim_S_Ret
(

41 #ifde
__lulus


	@ports/atmega8/ai.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

37 
	#MAX_ANALOG_INPUTS
 9

	)

38 #i(
MAX_ANALOG_INPUTS
 > 9)

39 #r 
Modify
 
the
 
Alog_Iut_Name
 
to
 
hd
 
muɝ
 
digs


42 
	gP_Vue
[
MAX_ANALOG_INPUTS
];

47 
bo
 
	$Alog_Iut_Vid_In
(

48 
ut32_t
 
obje_
)

50 i(
obje_
 < 
MAX_ANALOG_INPUTS
)

51  
ue
;

53  
l
;

54 
	}
}

57 
	$Alog_Iut_Cou
(

60  
MAX_ANALOG_INPUTS
;

61 
	}
}

64 
ut32_t
 
	$Alog_Iut_Index_To_In
(

65 
dex
)

67  
dex
;

68 
	}
}

71 
	$Alog_Iut_In_To_Index
(

72 
ut32_t
 
obje_
)

74  
obje_
;

75 
	}
}

78 *
	$Alog_Iut_Name
(

79 
ut32_t
 
obje_
)

81 
xt_rg
[5] = "AI-0";

83 i(
obje_
 < 
MAX_ANALOG_INPUTS
) {

84 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

85  
xt_rg
;

88  
NULL
;

89 
	}
}

93 
	$Alog_Iut_Encode_Prݔty_APDU
(

94 
ut8_t
 * 
du
,

95 
ut32_t
 
obje_
,

96 
BACNET_PROPERTY_ID
 
ݔty
,

97 
ut32_t
 
y_dex
,

98 
BACNET_ERROR_CLASS
 * 
r_ass
,

99 
BACNET_ERROR_CODE
 * 
r_code
)

101 
du_n
 = 0;

102 
BACNET_BIT_STRING
 
b_rg
;

103 
BACNET_CHARACTER_STRING
 
ch_rg
;

104 
obje_dex
;

106 
ݔty
) {

107 
PROP_OBJECT_IDENTIFIER
:

108 
du_n
 =

109 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_INPUT
,

110 
obje_
);

115 
PROP_OBJECT_NAME
:

116 
PROP_DESCRIPTION
:

117 
	`charg__si
(&
ch_rg
,

118 
	`Alog_Iut_Name
(
obje_
));

119 
du_n
 =

120 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

122 
PROP_OBJECT_TYPE
:

123 
du_n
 =

124 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_INPUT
);

126 
PROP_PRESENT_VALUE
:

127 
obje_dex
 = 
	`Alog_Iut_In_To_Index
(
obje_
);

128 
du_n
 =

129 
	`code_iti_
(&
du
[0], 
P_Vue
[
obje_dex
]);

131 
PROP_STATUS_FLAGS
:

132 
	`brg_
(&
b_rg
);

133 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

134 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

135 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

136 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

137 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

139 
PROP_EVENT_STATE
:

140 
du_n
 =

141 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

143 
PROP_OUT_OF_SERVICE
:

144 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

146 
PROP_UNITS
:

147 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

150 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

151 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

152 
du_n
 = -1;

156 i((
du_n
 >0&& (
y_dex
 !
BACNET_ARRAY_ALL
)) {

157 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

158 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

159 
du_n
 = -1;

162  
du_n
;

163 
	}
}

	@ports/atmega8/apdu.c

34 
	~<dbo.h
>

35 
	~<dt.h
>

36 
	~<ddef.h
>

37 
	~"bs.h
"

38 
	~"du.h
"

39 
	~"bacdef.h
"

40 
	~"bacdcode.h
"

41 
	~"banum.h
"

42 
	~"hdrs.h
"

44 
bo
 
	$du_rvi_su܋d
(

45 
BACNET_SERVICES_SUPPORTED
 
rvi_su܋d
)

47 
bo
 
us
 = 
l
;

49 i(
rvi_su܋d
 =
SERVICE_SUPPORTED_READ_PROPERTY
) {

50 
us
 = 
ue
;

53  
us
;

54 
	}
}

56 
ut16_t
 
	$du_decode_cfmed_rvi_que
(

57 
ut8_t
 * 
du
,

58 
ut16_t
 
du_n
,

59 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
,

60 
ut8_t
 * 
rvi_choi
,

61 
ut8_t
 ** 
rvi_que
,

62 
ut16_t
 * 
rvi_que_n
)

64 
ut16_t
 
n
 = 0;

66 
rvi_da
->
gmd_mesge
 = (
du
[0] & 
BIT3
? 
ue
 : 
l
;

67 
rvi_da
->
me_flows
 = (
du
[0] & 
BIT2
? 
ue
 : 
l
;

68 
rvi_da
->
gmd_ڣ_aced
 =

69 (
du
[0] & 
BIT1
? 
ue
 : 
l
;

70 
rvi_da
->
max_gs
 = 
	`decode_max_gs
(
du
[1]);

71 
rvi_da
->
max_
 = 
	`decode_max_du
(
du
[1]);

72 
rvi_da
->
voke_id
 = 
du
[2];

73 
n
 = 3;

74 i(
rvi_da
->
gmd_mesge
) {

75 
rvi_da
->
qu_numb
 = 
du
[
n
++];

76 
rvi_da
->
od_wdow_numb
 = 
du
[
n
++];

78 *
rvi_choi
 = 
du
[
n
++];

79 *
rvi_que
 = &
du
[
n
];

80 *
rvi_que_n
 = 
du_n
 - 
n
;

82  
n
;

83 
	}
}

85 
	$du_hdr
(

86 
BACNET_ADDRESS
 * 
c
,

87 
ut8_t
 * 
du
,

88 
ut16_t
 
du_n
)

90 
BACNET_CONFIRMED_SERVICE_DATA
 
rvi_da
 = { 0 };

91 
ut8_t
 
rvi_choi
 = 0;

92 
ut8_t
 *
rvi_que
 = 
NULL
;

93 
ut16_t
 
rvi_que_n
 = 0;

94 
ut16_t
 
n
 = 0;

96 i(
du
) {

98 
du
[0] & 0xF0) {

99 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

100 
n
 = 
	`du_decode_cfmed_rvi_que
(&
du
[0],

101 
du_n
, &
rvi_da
, &
rvi_choi
, &
rvi_que
,

102 &
rvi_que_n
);

103 i(
rvi_choi
 =
SERVICE_CONFIRMED_READ_PROPERTY
) {

104 
	`hdr_ad_ݔty
(
rvi_que
, 
rvi_que_n
,

105 
c
, &
rvi_da
);

107 
	`hdr_uecognized_rvi
(
rvi_que
,

108 
rvi_que_n
, 
c
, &
rvi_da
);

111 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
:

112 
PDU_TYPE_SIMPLE_ACK
:

113 
PDU_TYPE_COMPLEX_ACK
:

114 
PDU_TYPE_SEGMENT_ACK
:

115 
PDU_TYPE_ERROR
:

116 
PDU_TYPE_REJECT
:

117 
PDU_TYPE_ABORT
:

123 
	}
}

	@ports/atmega8/av.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"hdwe.h
"

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"ba.h
"

35 
	~"cfig.h
"

36 
	~"wp.h
"

37 
	~"av.h
"

39 #i(
MAX_ANALOG_VALUES
 > 10)

40 #r 
Modify
 
the
 
Alog_Vue_Name
 
to
 
hd
 
muɝ
 
digs


43 
	gAV_P_Vue
[
MAX_ANALOG_VALUES
];

48 
bo
 
	$Alog_Vue_Vid_In
(

49 
ut32_t
 
obje_
)

51 i(
obje_
 < 
MAX_ANALOG_VALUES
)

52  
ue
;

54  
l
;

55 
	}
}

59 
	$Alog_Vue_Cou
(

62  
MAX_ANALOG_VALUES
;

63 
	}
}

68 
ut32_t
 
	$Alog_Vue_Index_To_In
(

69 
dex
)

71  
dex
;

72 
	}
}

77 
	$Alog_Vue_In_To_Index
(

78 
ut32_t
 
obje_
)

80  
obje_
;

81 
	}
}

84 *
	$Alog_Vue_Name
(

85 
ut32_t
 
obje_
)

87 
xt_rg
[5] = "AV-";

89 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

91  
xt_rg
;

92 
	}
}

95 
	$Alog_Vue_Encode_Prݔty_APDU
(

96 
ut8_t
 * 
du
,

97 
ut32_t
 
obje_
,

98 
BACNET_PROPERTY_ID
 
ݔty
,

99 
ut32_t
 
y_dex
,

100 
BACNET_ERROR_CLASS
 * 
r_ass
,

101 
BACNET_ERROR_CODE
 * 
r_code
)

103 
du_n
 = 0;

104 
BACNET_BIT_STRING
 
b_rg
;

105 
BACNET_CHARACTER_STRING
 
ch_rg
;

106 
obje_dex
;

108 
ݔty
) {

109 
PROP_OBJECT_IDENTIFIER
:

110 
du_n
 =

111 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_VALUE
,

112 
obje_
);

114 
PROP_OBJECT_NAME
:

115 
	`charg__si
(&
ch_rg
,

116 
	`Alog_Vue_Name
(
obje_
));

117 
du_n
 =

118 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

120 
PROP_OBJECT_TYPE
:

121 
du_n
 =

122 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_VALUE
);

124 
PROP_PRESENT_VALUE
:

125 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

126 
du_n
 =

127 
	`code_iti_
(&
du
[0],

128 
AV_P_Vue
[
obje_dex
]);

130 
PROP_STATUS_FLAGS
:

131 
	`brg_
(&
b_rg
);

132 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

133 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

134 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

135 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

136 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

138 
PROP_EVENT_STATE
:

139 
du_n
 =

140 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

142 
PROP_OUT_OF_SERVICE
:

143 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

145 
PROP_UNITS
:

146 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

149 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

150 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

151 
du_n
 = -1;

155 i((
du_n
 >0&& (
y_dex
 !
BACNET_ARRAY_ALL
)) {

156 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

157 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

158 
du_n
 = -1;

161  
du_n
;

162 
	}
}

165 
bo
 
	$Alog_Vue_Wre_Prݔty
(

166 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
,

167 
BACNET_ERROR_CLASS
 * 
r_ass
,

168 
BACNET_ERROR_CODE
 * 
r_code
)

170 
bo
 
us
 = 
l
;

171 
obje_dex
 = 0;

172 
n
 = 0;

173 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

175 i(!
	`Alog_Vue_Vid_In
(
wp_da
->
obje_
)) {

176 *
r_ass
 = 
ERROR_CLASS_OBJECT
;

177 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

178  
l
;

181 
n
 =

182 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

183 
wp_da
->
iti_da_n
, &
vue
);

185 i(
n
 < 0) {

187 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

188 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

189  
l
;

191 
wp_da
->
obje_ݔty
) {

192 
PROP_PRESENT_VALUE
:

193 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_REAL
) {

194 
obje_dex
 =

195 
	`Alog_Vue_In_To_Index
(
wp_da
->
obje_
);

196 
AV_P_Vue
[
obje_dex
] = 
vue
.
ty
.
Rl
;

197 
us
 = 
ue
;

199 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

200 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

204 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

205 *
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

209  
us
;

210 
	}
}

212 #ifde
TEST


213 
	~<as.h
>

214 
	~<rg.h
>

215 
	~"e.h
"

217 
	$Alog_Vue
(

218 
Te
 * 
pTe
)

220 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

221 
n
 = 0;

222 
ut32_t
 
n_vue
 = 0;

223 
ut8_t
 
g_numb
 = 0;

224 
BACNET_OBJECT_TYPE
 
decoded_ty
 = 
OBJECT_ANALOG_VALUE
;

225 
ut32_t
 
decoded_
 = 0;

226 
ut32_t
 

 = 123;

227 
BACNET_ERROR_CLASS
 
r_ass
;

228 
BACNET_ERROR_CODE
 
r_code
;

230 
n
 =

231 
	`Alog_Vue_Encode_Prݔty_APDU
(&
du
[0], 

,

232 
PROP_OBJECT_IDENTIFIER
, 
BACNET_ARRAY_ALL
, &
r_ass
, &
r_code
);

233 
	`_
(
pTe
, 
n
 != 0);

234 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

235 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

236 
n
 =

237 
	`decode_obje_id
(&
du
[
n
], (*&
decoded_ty
, &
decoded_
);

238 
	`_
(
pTe
, 
decoded_ty
 =
OBJECT_ANALOG_VALUE
);

239 
	`_
(
pTe
, 
decoded_
 =

);

242 
	}
}

244 #ifde
TEST_ANALOG_VALUE


245 
	$ma
(

248 
Te
 *
pTe
;

249 
bo
 
rc
;

251 
pTe
 = 
	`_
("BACÈAlog Vue", 
NULL
);

253 
rc
 = 
	`_addTeFuni
(
pTe
, 
Alog_Vue
);

254 
	`as
(
rc
);

256 
	`_tSm
(
pTe
, 
dout
);

257 
	`_run
(
pTe
);

258 (
	`_pt
(
pTe
);

259 
	`_deroy
(
pTe
);

262 
	}
}

	@ports/atmega8/avr035.h

1 #ide
AVR035_H


2 
	#AVR035_H


	)

7 
	#BIT_SET
(
a
,
b
(|(1<<(b)))

	)

8 
	#BIT_CLEAR
(
a
,
b
(&~(1<<(b)))

	)

9 
	#BIT_FLIP
(
a
,
b
(^(1<<(b)))

	)

10 
	#BIT_CHECK
(
a
,
b
(& (1<<(b)))

	)

13 
	#BITMASK_SET
(
x
,
y
((x|(y))

	)

14 
	#BITMASK_CLEAR
(
x
,
y
((x&(~(y)))

	)

15 
	#BITMASK_FLIP
(
x
,
y
((x^(y))

	)

16 
	#BITMASK_CHECK
(
x
,
y
((x& (y))

	)

	@ports/atmega8/bv.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"hdwe.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"banum.h
"

35 
	~"cfig.h
"

36 
	~"wp.h
"

37 
	~"bv.h
"

39 #i(
MAX_BINARY_VALUES
 > 10)

40 #r 
Modify
 
the
 
By_Vue_Name
 
to
 
hd
 
muɝ
 
digs


43 
BACNET_BINARY_PV
 
	gP_Vue
[
MAX_BINARY_VALUES
];

46 
bo
 
	$By_Vue_Vid_In
(

47 
ut32_t
 
obje_
)

49 i(
obje_
 < 
MAX_BINARY_VALUES
)

50  
ue
;

52  
l
;

53 
	}
}

56 
	$By_Vue_Cou
(

59  
MAX_BINARY_VALUES
;

60 
	}
}

63 
ut32_t
 
	$By_Vue_Index_To_In
(

64 
dex
)

66  
dex
;

67 
	}
}

70 
	$By_Vue_In_To_Index
(

71 
ut32_t
 
obje_
)

73 
dex
 = 
MAX_BINARY_VALUES
;

75 i(
obje_
 < 
MAX_BINARY_VALUES
)

76 
dex
 = 
obje_
;

78  
dex
;

79 
	}
}

81 
BACNET_BINARY_PV
 
	$By_Vue_P_Vue
(

82 
ut32_t
 
obje_
)

84 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

86 i(
obje_
 < 
MAX_BINARY_VALUES
) {

87 
vue
 = 
P_Vue
[
obje_
];

90  
vue
;

91 
	}
}

94 *
	$By_Vue_Name
(

95 
ut32_t
 
obje_
)

97 
xt_rg
[5] = "BV-0";

99 i(
obje_
 < 
MAX_BINARY_VALUES
) {

100 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

101  
xt_rg
;

104  
NULL
;

105 
	}
}

108 
	$By_Vue_Encode_Prݔty_APDU
(

109 
ut8_t
 * 
du
,

110 
ut32_t
 
obje_
,

111 
BACNET_PROPERTY_ID
 
ݔty
,

112 
ut32_t
 
y_dex
,

113 
BACNET_ERROR_CLASS
 * 
r_ass
,

114 
BACNET_ERROR_CODE
 * 
r_code
)

116 
du_n
 = 0;

117 
BACNET_BIT_STRING
 
b_rg
;

118 
BACNET_CHARACTER_STRING
 
ch_rg
;

119 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

120 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

122 
ݔty
) {

123 
PROP_OBJECT_IDENTIFIER
:

124 
du_n
 =

125 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_BINARY_VALUE
,

126 
obje_
);

130 
PROP_OBJECT_NAME
:

131 
	`charg__si
(&
ch_rg
,

132 
	`By_Vue_Name
(
obje_
));

133 
du_n
 =

134 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

136 
PROP_OBJECT_TYPE
:

137 
du_n
 =

138 
	`code_iti_umed
(&
du
[0], 
OBJECT_BINARY_VALUE
);

140 
PROP_PRESENT_VALUE
:

141 
e_vue
 = 
	`By_Vue_P_Vue
(
obje_
);

142 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

144 
PROP_STATUS_FLAGS
:

146 
	`brg_
(&
b_rg
);

147 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

148 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

149 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

150 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

151 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

153 
PROP_EVENT_STATE
:

155 
du_n
 =

156 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

158 
PROP_OUT_OF_SERVICE
:

159 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

161 
PROP_POLARITY
:

163 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
pެy
);

166 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

167 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

168 
du_n
 = -1;

172 i((
du_n
 >0&& (
y_dex
 !
BACNET_ARRAY_ALL
)) {

173 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

174 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

175 
du_n
 = -1;

178  
du_n
;

179 
	}
}

182 
bo
 
	$By_Vue_Wre_Prݔty
(

183 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
,

184 
BACNET_ERROR_CLASS
 * 
r_ass
,

185 
BACNET_ERROR_CODE
 * 
r_code
)

187 
bo
 
us
 = 
l
;

188 
obje_dex
 = 0;

189 
n
 = 0;

190 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

192 i(!
	`By_Vue_Vid_In
(
wp_da
->
obje_
)) {

193 *
r_ass
 = 
ERROR_CLASS_OBJECT
;

194 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

195  
l
;

198 
n
 =

199 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

200 
wp_da
->
iti_da_n
, &
vue
);

202 i(
n
 < 0) {

204 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

205 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

206  
l
;

208 
wp_da
->
obje_ݔty
) {

209 
PROP_PRESENT_VALUE
:

210 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_ENUMERATED
) {

211 i((
vue
.
ty
.
Enumed
 =
BINARY_ACTIVE
) ||

212 (
vue
.
ty
.
Enumed
 =
BINARY_INACTIVE
)) {

213 
obje_dex
 =

214 
By_Vue_In_To_Index


215 (
wp_da
->
obje_
);

217 
P_Vue
[
obje_dex
] =

218 (
BACNET_BINARY_PV

vue
.
ty
.
Enumed
;

223 i(
P_Vue
[0] =
BINARY_ACTIVE
) {

224 
	`LED_GREEN_ON
();

226 
	`LED_GREEN_OFF
();

228 
us
 = 
ue
;

230 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

231 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

234 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

235 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

239 
PROP_OUT_OF_SERVICE
:

240 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_BOOLEAN
) {

241 
obje_dex
 =

242 
	`By_Vue_In_To_Index
(
wp_da
->
obje_
);

243 
By_Vue_Out_Of_Svi
[
obje_dex
] = 
vue
.
ty
.
Boޗn
;

244 
us
 = 
ue
;

246 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

247 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

252 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

253 *
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

257  
us
;

258 
	}
}

260 #ifde
TEST


261 
	~<as.h
>

262 
	~<rg.h
>

263 
	~"e.h
"

265 
	$By_Vue
(

266 
Te
 * 
pTe
)

268 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

269 
n
 = 0;

270 
ut32_t
 
n_vue
 = 0;

271 
ut8_t
 
g_numb
 = 0;

272 
BACNET_OBJECT_TYPE
 
decoded_ty
 = 
OBJECT_BINARY_VALUE
;

273 
ut32_t
 
decoded_
 = 0;

274 
ut32_t
 

 = 123;

275 
BACNET_ERROR_CLASS
 
r_ass
;

276 
BACNET_ERROR_CODE
 
r_code
;

279 
n
 =

280 
	`By_Vue_Encode_Prݔty_APDU
(&
du
[0], 

,

281 
PROP_OBJECT_IDENTIFIER
, 
BACNET_ARRAY_ALL
, &
r_ass
, &
r_code
);

282 
	`_
(
pTe
, 
n
 != 0);

283 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

284 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
);

285 
n
 =

286 
	`decode_obje_id
(&
du
[
n
], (*&
decoded_ty
, &
decoded_
);

287 
	`_
(
pTe
, 
decoded_ty
 =
OBJECT_BINARY_VALUE
);

288 
	`_
(
pTe
, 
decoded_
 =

);

291 
	}
}

293 #ifde
TEST_BINARY_VALUE


294 
	$ma
(

297 
Te
 *
pTe
;

298 
bo
 
rc
;

300 
pTe
 = 
	`_
("BACÈBy_Vue", 
NULL
);

302 
rc
 = 
	`_addTeFuni
(
pTe
, 
By_Vue
);

303 
	`as
(
rc
);

305 
	`_tSm
(
pTe
, 
dout
);

306 
	`_run
(
pTe
);

307 (
	`_pt
(
pTe
);

308 
	`_deroy
(
pTe
);

311 
	}
}

	@ports/atmega8/device.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~"bacdef.h
"

29 
	~"bacdcode.h
"

30 
	~"bacr.h
"

31 
	~"banum.h
"

32 
	~"du.h
"

33 
	~"dcc.h
"

34 
	~"dlmp.h
"

35 
	~"rs485.h
"

36 
	~"vsi.h
"

38 
	~"devi.h
"

39 
	~"av.h
"

45 
ut32_t
 
	gObje_In_Numb
 = 260001;

46 *
	gObje_Name
 = "My Device";

47 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

49 
	$Devi_In
(

50 
obje_funis_t
 * 
obje_b
)

52 (
obje_b
;

60 
	}
}

63 
ut32_t
 
	$Devi_Obje_In_Numb
(

66  
Obje_In_Numb
;

67 
	}
}

69 
bo
 
	$Devi_S_Obje_In_Numb
(

70 
ut32_t
 
obje_id
)

72 
bo
 
us
 = 
ue
;

74 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

75 
Obje_In_Numb
 = 
obje_id
;

83 
us
 = 
l
;

85  
us
;

86 
	}
}

88 
bo
 
	$Devi_Vid_Obje_In_Numb
(

89 
ut32_t
 
obje_id
)

92  ((
Obje_In_Numb
 =
obje_id
) ||

93 (
obje_id
 =
BACNET_MAX_INSTANCE
));

94 
	}
}

96 
ut16_t
 
	$Devi_Vd_Idtifr
(

99  
BACNET_VENDOR_ID
;

100 
	}
}

102 
	$Devi_Obje_Li_Cou
(

105 
cou
 = 1;

107 #i
MAX_ANALOG_VALUES


109 
cou
 +
	`Alog_Vue_Cou
();

111 #i
MAX_BINARY_VALUES


113 
cou
 +
	`By_Vue_Cou
();

116  
cou
;

117 
	}
}

119 
bo
 
	$Devi_Obje_Li_Idtifr
(

120 
ut32_t
 
y_dex
,

121 *
obje_ty
,

122 
ut32_t
 * 

)

124 
bo
 
us
 = 
l
;

125 
ut32_t
 
obje_dex
 = 0;

126 
ut32_t
 
obje_cou
 = 0;

129 i(
y_dex
 == 1) {

130 *
obje_ty
 = 
OBJECT_DEVICE
;

131 *

 = 
Obje_In_Numb
;

132 
us
 = 
ue
;

137 
obje_dex
 = 
y_dex
 - 1;

139 
obje_cou
 = 1;

141 #i
MAX_ANALOG_VALUES


143 i(!
us
) {

145 
obje_dex
 -
obje_cou
;

146 
obje_cou
 = 
	`Alog_Vue_Cou
();

147 i(
obje_dex
 < 
obje_cou
) {

148 *
obje_ty
 = 
OBJECT_ANALOG_VALUE
;

149 *

 = 
	`Alog_Vue_Index_To_In
(
obje_dex
);

150 
us
 = 
ue
;

154 #i
MAX_BINARY_VALUES


156 i(!
us
) {

157 
obje_dex
 -
obje_cou
;

158 
obje_cou
 = 
	`By_Vue_Cou
();

160 i(
obje_dex
 < 
obje_cou
) {

161 *
obje_ty
 = 
OBJECT_BINARY_VALUE
;

162 *

 = 
	`By_Vue_Index_To_In
(
obje_dex
);

163 
us
 = 
ue
;

168  
us
;

169 
	}
}

172 
	$Devi_Encode_Prݔty_APDU
(

173 
ut8_t
 * 
du
,

174 
ut32_t
 
obje_
,

175 
BACNET_PROPERTY_ID
 
ݔty
,

176 
ut32_t
 
y_dex
,

177 
BACNET_ERROR_CLASS
 * 
r_ass
,

178 
BACNET_ERROR_CODE
 * 
r_code
)

180 
du_n
 = 0;

181 
n
 = 0;

182 
BACNET_BIT_STRING
 
b_rg
;

183 
BACNET_CHARACTER_STRING
 
ch_rg
;

184 
ut32_t
 
i
 = 0;

185 
obje_ty
 = 0;

186 
ut32_t
 

 = 0;

187 
ut32_t
 
cou
 = 0;

189 
obje_
 = object_instance;

191 
ݔty
) {

192 
PROP_OBJECT_IDENTIFIER
:

193 
du_n
 =

194 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_DEVICE
,

195 
Obje_In_Numb
);

197 
PROP_OBJECT_NAME
:

198 
	`charg__si
(&
ch_rg
, 
Obje_Name
);

199 
du_n
 =

200 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

202 
PROP_OBJECT_TYPE
:

203 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
OBJECT_DEVICE
);

205 
PROP_SYSTEM_STATUS
:

206 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
Syem_Stus
);

208 
PROP_VENDOR_NAME
:

209 
	`charg__si
(&
ch_rg
, 
BACNET_VENDOR_NAME
);

210 
du_n
 =

211 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

213 
PROP_VENDOR_IDENTIFIER
:

214 
du_n
 =

215 
	`code_iti_unsigd
(&
du
[0],

216 
	`Devi_Vd_Idtifr
());

218 
PROP_MODEL_NAME
:

219 
	`charg__si
(&
ch_rg
, "GNU Demo");

220 
du_n
 =

221 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

223 
PROP_FIRMWARE_REVISION
:

224 
	`charg__si
(&
ch_rg
, 
BACNET_VERSION_TEXT
);

225 
du_n
 =

226 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

228 
PROP_APPLICATION_SOFTWARE_VERSION
:

229 
	`charg__si
(&
ch_rg
, "1.0");

230 
du_n
 =

231 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

233 
PROP_PROTOCOL_VERSION
:

234 
du_n
 =

235 
	`code_iti_unsigd
(&
du
[0], 
BACNET_PROTOCOL_VERSION
);

237 
PROP_PROTOCOL_REVISION
:

238 
du_n
 =

239 
	`code_iti_unsigd
(&
du
[0],

240 
BACNET_PROTOCOL_REVISION
);

242 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

244 
	`brg_
(&
b_rg
);

245 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

247 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

248 
	`du_rvi_su܋d
((
BACNET_SERVICES_SUPPORTED

i
));

250 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

252 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

255 
	`brg_
(&
b_rg
);

257 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

259 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

262 
	`brg_t_b
(&
b_rg
, 
OBJECT_DEVICE
, 
ue
);

263 #i
MAX_ANALOG_VALUES


264 
	`brg_t_b
(&
b_rg
, 
OBJECT_ANALOG_VALUE
, 
ue
);

266 #i
MAX_BINARY_VALUES


267 
	`brg_t_b
(&
b_rg
, 
OBJECT_BINARY_VALUE
, 
ue
);

269 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

271 
PROP_OBJECT_LIST
:

272 
cou
 = 
	`Devi_Obje_Li_Cou
();

274 i(
y_dex
 == 0)

275 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

280 i(
y_dex
 =
BACNET_ARRAY_ALL
) {

281 
i
 = 1; i <
cou
; i++) {

282 
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
, &

);

283 
n
 =

284 
	`code_iti_obje_id
(&
du
[
du_n
],

285 
obje_ty
, 

);

286 
du_n
 +
n
;

289 i((
du_n
 + 
n
>
MAX_APDU
) {

290 *
r_code
 =

291 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

292 
du_n
 = 
BACNET_STATUS_ABORT
;

297 i(
	`Devi_Obje_Li_Idtifr
(
y_dex
, &
obje_ty
,

298 &

))

299 
du_n
 =

300 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

301 

);

303 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

304 *
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

305 
du_n
 = 
BACNET_STATUS_ERROR
;

309 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

310 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

312 
PROP_SEGMENTATION_SUPPORTED
:

313 
du_n
 =

314 
	`code_iti_umed
(&
du
[0], 
SEGMENTATION_NONE
);

316 
PROP_APDU_TIMEOUT
:

317 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 60000);

319 
PROP_NUMBER_OF_APDU_RETRIES
:

320 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 0);

322 
PROP_DEVICE_ADDRESS_BINDING
:

325 
PROP_DATABASE_REVISION
:

326 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 0);

329 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

330 *
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

331 
du_n
 = -1;

335 i((
du_n
 >0&& (
ݔty
 !
PROP_OBJECT_LIST
) &&

336 (
y_dex
 !
BACNET_ARRAY_ALL
)) {

337 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

338 *
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

339 
du_n
 = 
BACNET_STATUS_ERROR
;

342  
du_n
;

343 
	}
}

	@ports/atmega8/dlmstp.c

35 
	~<dbo.h
>

36 
	~<dt.h
>

37 
	~<ddef.h
>

38 
	~<rg.h
>

39 
	~"bacdef.h
"

40 
	~"dlmp.h
"

41 
	~"rs485.h
"

42 
	~"c.h
"

43 
	~"du.h
"

44 
	~"bs.h
"

45 
	~"bys.h
"

46 
	~"baddr.h
"

47 
	~"txbuf.h
"

53 
	~"hdwe.h
"

54 
	~"tim.h
"

60 
	#MSTP_BROADCAST_ADDRESS
 255

	)

64 
	#FRAME_TYPE_TOKEN
 0

	)

65 
	#FRAME_TYPE_POLL_FOR_MASTER
 1

	)

66 
	#FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
 2

	)

67 
	#FRAME_TYPE_TEST_REQUEST
 3

	)

68 
	#FRAME_TYPE_TEST_RESPONSE
 4

	)

69 
	#FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
 5

	)

70 
	#FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
 6

	)

71 
	#FRAME_TYPE_REPLY_POSTPONED
 7

	)

78 
	#FRAME_TYPE_PROPRIETARY_MIN
 128

	)

79 
	#FRAME_TYPE_PROPRIETARY_MAX
 255

	)

83 
	mMSTP_RECEIVE_STATE_IDLE
 = 0,

84 
	mMSTP_RECEIVE_STATE_PREAMBLE
 = 1,

85 
	mMSTP_RECEIVE_STATE_HEADER
 = 2,

86 
	mMSTP_RECEIVE_STATE_DATA
 = 3

87 } 
	tMSTP_RECEIVE_STATE
;

90 
MSTP_RECEIVE_STATE
 
	gReive_S
;

91 
	smp_ag_t
 {

95 
	mReivedInvidFme
:1;

96 
	mReivedVidFme
:1;

99 
	mTnsmPackPdg
:1;

102 
	mTnsmPackDER
:1;

105 
	mReivePackPdg
:1;

106 } 
	gMSTP_Fg
;

109 
ut16_t
 
	gDaLgth
;

111 
ut8_t
 
	gDeiAddss
;

113 
ut8_t
 
	gFmeTy
;

120 
ut8_t
 *
	gIutBufr
;

121 
ut16_t
 
	gIutBufrSize
;

123 
ut8_t
 
	gSourAddss
;

128 
ut8_t
 
	gThis_Sti
;

136 
ut8_t
 *
	gTnsmPack
;

137 
ut16_t
 
	gTnsmPackL
;

138 
ut8_t
 
	gTnsmPackDe
;

146 
	#Tame_abt
 30

	)

150 
	#Tame_g
 20

	)

155 
	#Ty_day
 250

	)

159 
	#T
 10

	)

164 
	#Tuge_day
 15

	)

167 
	#INCREMENT_AND_LIMIT_UINT8
(
x
{i(x < 0xFFx++;}

	)

169 
bo
 
	$dlmp_
(

170 *
iame
)

172 
iame
 = ifname;

174 
	`RS485_Inlize
();

176  
ue
;

177 
	}
}

179 
	$dlmp_nup
(

183 
	}
}

185 
	$dlmp_fl_ba_addss
(

186 
BACNET_ADDRESS
 * 
c
,

187 
ut8_t
 
mp_addss
)

189 
i
 = 0;

191 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

193 
c
->
mac_n
 = 0;

194 
c
->
mac
[0] = 0;

196 
c
->
mac_n
 = 1;

197 
c
->
mac
[0] = 
mp_addss
;

200 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

201 
c
->
mac
[
i
] = 0;

203 
c
->
t
 = 0;

204 
c
->
n
 = 0;

205 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

206 
c
->
adr
[
i
] = 0;

208 
	}
}

223 
	$MSTP_Sd_Fme
(

224 
ut8_t
 
ame_ty
,

225 
ut8_t
 
dei
,

226 
ut8_t
 
sour
,

227 
ut8_t
 * 
pdu
,

228 
ut16_t
 
pdu_n
)

230 
ut8_t
 
c8
 = 0xFF;

231 
ut16_t
 
c16
 = 0xFFFF;

232 
ut8_t
 
bufr
[8];

233 
ut8_t
 
dac
[2];

234 
ut16_t
 
i
 = 0;

237 
bufr
[0] = 0x55;

238 
bufr
[1] = 0xFF;

239 
bufr
[2] = 
ame_ty
;

240 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[2], crc8);

241 
bufr
[3] = 
dei
;

242 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[3], crc8);

243 
bufr
[4] = 
sour
;

244 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[4], crc8);

245 
bufr
[5] = 
	`HI_BYTE
(
pdu_n
);

246 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[5], crc8);

247 
bufr
[6] = 
	`LO_BYTE
(
pdu_n
);

248 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[6], crc8);

249 
bufr
[7] = ~
c8
;

250 i(
pdu_n
) {

252 
i
 = 0; i < 
pdu_n
; i++) {

253 
c16
 = 
	`CRC_Cc_Da
(
pdu
[
i
], crc16);

255 
c16
 = ~crc16;

256 
dac
[0] = (
c16
 & 0x00FF);

257 
dac
[1] = ((
c16
 & 0xFF00) >> 8);

260 
	`RS485_Tuound_Day
();

261 
	`RS485_Tnsmr_Eb
(
ue
);

262 
	`RS485_Sd_Da
(
bufr
, 8);

264 i(
pdu_n
) {

265 
	`RS485_Sd_Da
(
pdu
, 
pdu_n
);

266 
	`RS485_Sd_Da
(
dac
, 2);

268 
	`RS485_Tnsmr_Eb
(
l
);

269 
	}
}

274 
bo
 
	$c_hd_good
(

275 
ut8_t
 * 
bufr
,

276 
ut8_t
 
n
)

278 
ut8_t
 
i
;

279 
ut8_t
 
c8
 = 0xFF;

281 
i
 = 0; i < 
n
; i++) {

282 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[
i
], crc8);

285  (
c8
 == 0x55);

286 
	}
}

289 
	$mp_ive_hdr
(

292 
ut8_t
 
da_gi
 = 0;

294 i(
	`RS485_ReiveE
()) {

295 
	`tim_s_t
();

296 } i(
	`RS485_DaAvaab
(&
da_gi
)) {

297 
	`tim_s_t
();

298 i((
MSTP_Reive_Pack
.
mb1
 =
l
) &&

299 (
da_gi
 == 0x55)) {

300 
MSTP_Reive_Pack
.
mb1
 = 
ue
;

303 i((
MSTP_Reive_Pack
.
mb2
 =
l
) &&

304 (
MSTP_Reive_Pack
.
mb1
 =
ue
)) {

305 i(
da_gi
 == 0xFF) {

306 
MSTP_Reive_Pack
.
mb2
 = 
ue
;

307 
MSTP_Reive_Pack
.
dex
 = 0;

308 
MSTP_Reive_Pack
.
da_n
 = 0;

309 } i(
da_gi
 == 0x55) {

313 
MSTP_Reive_Pack
.
mb1
 = 
l
;

317 i(
DaLgth
 == 0) {

318 
MSTP_Reive_Pack
.
hd
[MSTP_Reive_Pack.
dex
] =

319 
da_gi
;

320 i(
MSTP_Reive_Pack
.
dex
 == 5) {

321 i(
	`c_hd_good
(
MSTP_Reive_Pack
.
hd
, 6)) {

322 
FmeTy
 = 
MSTP_Reive_Pack
.
hd
[0];

323 
DeiAddss
 = 
MSTP_Reive_Pack
.
hd
[1];

324 
SourAddss
 = 
MSTP_Reive_Pack
.
hd
[2];

325 
DaLgth
 =

326 (
MSTP_Reive_Pack
.
hd
[3] * 256) +

327 
MSTP_Reive_Pack
.
hd
[4];

328 i(
DaLgth
 == 0) {

329 
MSTP_Reive_Pack
.
vid_ame
 = 
ue
;

331 
MSTP_Reive_Pack
.
dex
 = 0;

334 
MSTP_Reive_Pack
.
mb2
 = 
l
;

335 
MSTP_Reive_Pack
.
mb2
 = 
l
;

336 
MSTP_Reive_Pack
.
dex
 = 0;

340 
MSTP_Reive_Pack
.
bufr
[MSTP_Reive_Pack.
dex
] =

341 
da_gi
;

342 i(
ck_fo
->
dex
 =ck_fo->
n
) {

344 
ck_fo
->
ady
 = 
ue
;

345 } i(
ck_fo
->
dex
 >ack_fo->
bufr
)) {

347 
ck_fo
->
n
 =ack_fo->
dex
;

348 
ck_fo
->
ady
 = 
ue
;

350 
ck_fo
->
dex
++;

352 
MSTP_Reive_Pack
.
dex
++;

353 i(
ck_fo
->
ady
) {

355 i(!
	`c_ck_good
(
ck_fo
->
bufr
,

356 
ck_fo
->
n
 + 1)) {

357 
ck_fo
->
ady
 = 
l
;

360 
ck_fo
->
c
 =ack_fo->
bufr
[ck_fo->
n
];

362 
ck_fo
->
dex
 = 0;

363 
ck_fo
->
mb1
 = 
l
;

364 
ck_fo
->
mb2
 = 
l
;

365 
	`d_tup_off
();

369 i(
ReivePamb1
 =
ue
) {

370 i(
	`tim_s_d
(
Tame_abt
)) {

372 
Index
 = 0;

373 
ReivePamb1
 = 
l
;

374 
ReivePamb2
 = 
l
;

378 
	}
}

381 
	$MSTP_Reive_Fme_FSM
(

385 
ut8_t
 
DaRegi
 = 0;

387 
ut16_t
 
DaCRC
 = 0;

389 
ut8_t
 
HdCRC
 = 0;

392 
ut16_t
 
Index
 = 0;

394 
Reive_S
) {

395 
MSTP_RECEIVE_STATE_IDLE
:

397 i(
	`RS485_ReiveE
()) {

399 
	`tim_s_t
();

400 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

401 
	`tim_s_t
();

402 i(
DaRegi
 == 0x55) {

405 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

409 
MSTP_RECEIVE_STATE_PREAMBLE
:

412 i(
	`tim_s_d
(
Tame_abt
)) {

416 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

417 } i(
	`RS485_ReiveE
()) {

419 
	`tim_s_t
();

421 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

422 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

423 
	`tim_s_t
();

424 i(
DaRegi
 == 0xFF) {

426 
Index
 = 0;

427 
HdCRC
 = 0xFF;

429 
Reive_S
 = 
MSTP_RECEIVE_STATE_HEADER
;

430 } i(
DaRegi
 == 0x55) {

433 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

437 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

441 
MSTP_RECEIVE_STATE_HEADER
:

443 i(
	`tim_s_d
(
Tame_abt
)) {

446 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

448 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

449 } i(
	`RS485_ReiveE
()) {

451 
	`tim_s_t
();

453 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

455 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

456 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

457 
	`tim_s_t
();

458 i(
Index
 == 0) {

460 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

461 
FmeTy
 = 
DaRegi
;

462 
Index
 = 1;

463 } i(
Index
 == 1) {

465 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

466 
DeiAddss
 = 
DaRegi
;

467 
Index
 = 2;

468 } i(
Index
 == 2) {

470 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

471 
SourAddss
 = 
DaRegi
;

472 
Index
 = 3;

473 } i(
Index
 == 3) {

475 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

476 
DaLgth
 = 
DaRegi
 * 256;

477 
Index
 = 4;

478 } i(
Index
 == 4) {

480 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

481 
DaLgth
 +
DaRegi
;

482 
Index
 = 5;

483 } i(
Index
 == 5) {

485 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

488 i(
HdCRC
 != 0x55) {

492 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

494 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

500 i((
DaLgth
&& (DaLgth <
IutBufrSize
)) {

502 
Index
 = 0;

503 
DaCRC
 = 0xFFFF;

505 
Reive_S
 = 
MSTP_RECEIVE_STATE_DATA
;

507 i(
DaLgth
 == 0) {

509 i((
DeiAddss
 =
This_Sti
) ||

510 (
DeiAddss
 ==

511 
MSTP_BROADCAST_ADDRESS
)) {

515 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

523 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

526 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

532 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

534 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

538 
MSTP_RECEIVE_STATE_DATA
:

540 i(
	`tim_s_d
(
Tame_abt
)) {

543 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

545 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

546 } i(
	`RS485_ReiveE
()) {

548 
	`tim_s_t
();

551 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

553 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

554 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

555 
	`tim_s_t
();

556 i(
Index
 < 
DaLgth
) {

558 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

559 
IutBufr
[
Index
] = 
DaRegi
;

560 
Index
++;

561 } i(
Index
 =
DaLgth
) {

563 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

564 
Index
++;

565 } i(
Index
 =(
DaLgth
 + 1)) {

567 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

570 i(
DaCRC
 == 0xF0B8) {

571 i((
DeiAddss
 =
This_Sti
) ||

572 (
DeiAddss
 =
MSTP_BROADCAST_ADDRESS
)) {

576 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

579 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

581 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

587 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

592 
	}
}

594 
	$MSTP_Sve_Node_FSM
(

597 i(
MSTP_Fg
.
ReivedVidFme
) {

598 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

599 
FmeTy
) {

600 
FRAME_TYPE_TOKEN
:

602 
FRAME_TYPE_POLL_FOR_MASTER
:

604 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

606 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

608 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

610 
FRAME_TYPE_TEST_REQUEST
:

611 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TEST_RESPONSE
, 
SourAddss
,

612 
This_Sti
, &
IutBufr
[0], 
DaLgth
);

614 
FRAME_TYPE_TEST_RESPONSE
:

618 } i(
MSTP_Fg
.
TnsmPackPdg
) {

627 
	`MSTP_Sd_Fme
(
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
,

628 
TnsmPackDe
, 
This_Sti
, (
ut8_t
 *& 
TnsmPack
[0],

629 
TnsmPackL
);

630 
MSTP_Fg
.
TnsmPackPdg
 = 
l
;

631 
MSTP_Fg
.
ReivePackPdg
 = 
l
;

633 
	}
}

636 
	$dlmp_nd_pdu
(

637 
BACNET_ADDRESS
 * 
de
,

638 
BACNET_NPDU_DATA
 * 
du_da
,

639 
ut8_t
 * 
pdu
,

640 
pdu_n
)

642 
bys_
 = 0;

644 i(
MSTP_Fg
.
TnsmPackPdg
 =
l
) {

645 
MSTP_Fg
.
TnsmPackDER
 = 
du_da
->
da_exg_y
;

646 
TnsmPack
 = 
pdu
;

647 
TnsmPackL
 = 
pdu_n
;

648 
bys_
 = 
pdu_n
;

649 
TnsmPackDe
 = 
de
->
mac
[0];

650 
MSTP_Fg
.
TnsmPackPdg
 = 
ue
;

653  
bys_
;

654 
	}
}

657 
ut16_t
 
	$dlmp_ive
(

658 
BACNET_ADDRESS
 * 
c
,

659 
ut8_t
 * 
pdu
,

660 
ut16_t
 
max_pdu
,

661 
timeout
)

663 
ut16_t
 
pdu_n
 = 0;

666 
timeout
 =imeout;

668 i(!
IutBufr
) {

669 
IutBufr
 = 
pdu
;

670 
IutBufrSize
 = 
max_pdu
;

673 i((
MSTP_Fg
.
ReivedVidFme
 =
l
) &&

674 (
MSTP_Fg
.
ReivedInvidFme
 =
l
) &&

675 (
MSTP_Fg
.
ReivePackPdg
 =
l
)) {

677 
	`MSTP_Reive_Fme_FSM
();

678 i(
MSTP_Fg
.
ReivedVidFme
 || MSTP_Fg.
ReivedInvidFme
)

682 i(
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
)

687 i(
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
) {

688 
	`MSTP_Sve_Node_FSM
();

691 i(
MSTP_Fg
.
ReivePackPdg
) {

692 
MSTP_Fg
.
ReivePackPdg
 = 
l
;

693 
pdu_n
 = 
DaLgth
;

694 
c
->
mac_n
 = 1;

695 
c
->
mac
[0] = 
SourAddss
;

699  
pdu_n
;

700 
	}
}

702 
	$dlmp_t_mac_addss
(

703 
ut8_t
 
mac_addss
)

706 i(
mac_addss
 <= 127) {

707 
This_Sti
 = 
mac_addss
;

716 
	}
}

718 
ut8_t
 
	$dlmp_mac_addss
(

721  
This_Sti
;

722 
	}
}

724 
	$dlmp_g_my_addss
(

725 
BACNET_ADDRESS
 * 
my_addss
)

727 
i
 = 0;

729 
my_addss
->
mac_n
 = 1;

730 
my_addss
->
mac
[0] = 
This_Sti
;

731 
my_addss
->
t
 = 0;

732 
my_addss
->
n
 = 0;

733 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

734 
my_addss
->
adr
[
i
] = 0;

738 
	}
}

740 
	$dlmp_g_brd_addss
(

741 
BACNET_ADDRESS
 * 
de
)

743 
i
 = 0;

745 i(
de
) {

746 
de
->
mac_n
 = 1;

747 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

748 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

749 
de
->
n
 = 0;

750 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

751 
de
->
adr
[
i
] = 0;

756 
	}
}

	@ports/atmega8/h_rp.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<rg.h
>

29 
	~<o.h
>

30 
	~"cfig.h
"

31 
	~"txbuf.h
"

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"ba.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"abt.h
"

38 
	~".h
"

40 
	~"devi.h
"

41 #i
MAX_ANALOG_VALUES


42 
	~"av.h
"

44 #i
MAX_BINARY_VALUES


45 
	~"bv.h
"

48 
Devi_Encode_Prݔty_APDU
(

49 
ut8_t
 * 
du
,

50 
ut32_t
 
obje_
,

51 
BACNET_PROPERTY_ID
 
ݔty
,

52 
ut32_t
 
y_dex
,

53 
BACNET_ERROR_CLASS
 * 
r_ass
,

54 
BACNET_ERROR_CODE
 * 
r_code
);

59 
	$Encode_Prݔty_APDU
(

60 
ut8_t
 * 
du
,

61 
BACNET_READ_PROPERTY_DATA
 * 
_da
,

62 
BACNET_ERROR_CLASS
 * 
r_ass
,

63 
BACNET_ERROR_CODE
 * 
r_code
)

65 
du_n
 = -1;

68 
_da
->
obje_ty
) {

69 
OBJECT_DEVICE
:

70 i(
	`Devi_Vid_Obje_In_Numb
(
_da
->
obje_
)) {

71 
du_n
 =

72 
	`Devi_Encode_Prݔty_APDU
(&
du
[0],

73 
_da
->
obje_
,p_da->
obje_ݔty
,

74 
_da
->
y_dex
, 
r_ass
, 
r_code
);

77 #i
MAX_ANALOG_VALUES


78 
OBJECT_ANALOG_VALUE
:

79 i(
	`Alog_Vue_Vid_In
(
_da
->
obje_
)) {

80 
du_n
 =

81 
	`Alog_Vue_Encode_Prݔty_APDU
(&
du
[0],

82 
_da
->
obje_
,p_da->
obje_ݔty
,

83 
_da
->
y_dex
, 
r_ass
, 
r_code
);

87 #i
MAX_BINARY_VALUES


88 
OBJECT_BINARY_VALUE
:

89 i(
	`By_Vue_Vid_In
(
_da
->
obje_
)) {

90 
du_n
 =

91 
	`By_Vue_Encode_Prݔty_APDU
(&
du
[0],

92 
_da
->
obje_
,p_da->
obje_ݔty
,

93 
_da
->
y_dex
, 
r_ass
, 
r_code
);

98 *
r_ass
 = 
ERROR_CLASS_OBJECT
;

99 *
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

103  
du_n
;

104 
	}
}

106 
	$hdr_ad_ݔty
(

107 
ut8_t
 * 
rvi_que
,

108 
ut16_t
 
rvi_n
,

109 
BACNET_ADDRESS
 * 
c
,

110 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
)

112 
BACNET_READ_PROPERTY_DATA
 
da
;

113 
n
 = 0;

114 
ack_n
 = 0;

115 
ݔty_n
 = 0;

116 
pdu_n
 = 0;

117 
BACNET_NPDU_DATA
 
du_da
;

118 
bys_
 = 0;

119 
BACNET_ERROR_CLASS
 
r_ass
 = 
ERROR_CLASS_OBJECT
;

120 
BACNET_ERROR_CODE
 
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

121 
BACNET_ADDRESS
 
my_addss
;

124 
	`dk_g_my_addss
(&
my_addss
);

125 
	`du_code_du_da
(&
du_da
, 
l
, 
MESSAGE_PRIORITY_NORMAL
);

126 
pdu_n
 =

127 
	`du_code_pdu
(&
Hdr_Tnsm_Bufr
[0], 
c
, &
my_addss
,

128 &
du_da
);

129 i(
rvi_da
->
gmd_mesge
) {

131 
n
 =

132 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

133 
rvi_da
->
voke_id
, 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
,

134 
ue
);

135 
RP_ABORT
;

137 
n
 = 
	`_decode_rvi_que
(
rvi_que
, 
rvi_n
, &
da
);

138 i(
n
 < 0) {

140 
n
 =

141 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

142 
rvi_da
->
voke_id
, 
ABORT_REASON_OTHER
, 
ue
);

143 
RP_ABORT
;

146 
ack_n
 =

147 
	`_ack_code_du_
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

148 
rvi_da
->
voke_id
, &
da
);

150 
ݔty_n
 =

151 
	`Encode_Prݔty_APDU
(&
Hdr_Tnsm_Bufr
[
pdu_n
 + 
ack_n
],

152 &
da
, &
r_ass
, &
r_code
);

153 i(
ݔty_n
 >= 0) {

154 
n
 =

155 
	`_ack_code_du_obje_ݔty_d
(&
Hdr_Tnsm_Bufr


156 [
pdu_n
 + 
ݔty_n
 + 
ack_n
]);

157 
n
 +
ack_n
 + 
ݔty_n
;

159 
ݔty_n
) {

161 
BACNET_STATUS_ABORT
:

162 
n
 =

163 
	`abt_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

164 
rvi_da
->
voke_id
,

165 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
, 
ue
);

168 
n
 =

169 
	`ba_code_du
(&
Hdr_Tnsm_Bufr
[
pdu_n
],

170 
rvi_da
->
voke_id
, 
SERVICE_CONFIRMED_READ_PROPERTY
,

171 
r_ass
, 
r_code
);

175 
RP_ABORT
:

176 
pdu_n
 +
n
;

177 
bys_
 =

178 
	`dk_nd_pdu
(
c
, &
du_da
, &
Hdr_Tnsm_Bufr
[0],

179 
pdu_n
);

182 
	}
}

	@ports/atmega8/hardware.h

25 #ide
HARDWARE_H


26 
	#HARDWARE_H


	)

28 #i!
defed
(
F_CPU
)

30 
	#F_CPU
 7372800UL

	)

33 #i
defed
(
__IAR_SYSTEMS_ICC__
|| defed(
__IAR_SYSTEMS_ASM__
)

34 
	~<iom168.h
>

35 
	#WATCHDOG_INIT
({
	`BIT_CLEAR
(
MCUSR
, 
WDRF
); 
WDTCSR
 = 0;}

	)

37 #i!
defed
(
__AVR_ATmega168__
)

38 #r 
Fmwe
 
is
 
cfigud
 
ATmega168
 
ly
 (-
mmcu
=
mega168
)

40 #i
defed
(
__AVR_ATmega168__
)

41 
	#WATCHDOG_INIT
({
	`BIT_CLEAR
(
MCUSR
, 
WDRF
); 
WDTCSR
 = 0;}

	)

43 
	#WATCHDOG_INIT
({
	`BIT_CLEAR
(
MCUCSR
, 
WDRF
); 
WDTCR
 = 0;}

	)

48 
	~"r2gcc.h
"

49 
	~"avr035.h
"

51 
	#LED_NPDU_INIT
(
	`BIT_SET
(
DDRD
, 
DDD5
)

	)

52 
	#LED_NPDU_ON
(
	`BIT_CLEAR
(
PORTD
, 
PD5
)

	)

53 
	#LED_NPDU_OFF
(
	`BIT_SET
(
PORTD
, 
PD5
)

	)

58 
	#LED_GREEN_INIT
(
	`BIT_SET
(
DDRD
, 
DDD4
)

	)

59 
	#LED_GREEN_ON
(
	`BIT_CLEAR
(
PORTD
, 
PD4
)

	)

60 
	#LED_GREEN_OFF
(
	`BIT_SET
(
PORTD
, 
PD4
)

	)

	@ports/atmega8/iar2gcc.h

24 #ide
IAR2GCC_H


25 
	#IAR2GCC_H


	)

29 #i!
defed
(
F_CPU
)

30 #r 
You
 
mu
 
defe
 
F_CPU
 - 
ock
 
equcy
!

33 #i
defed
 (
__CROSSWORKS_AVR
)

34 
	~<avr.h
>

35 
	~<dt.h
>

39 #i
defed
(
__ICCAVR__
)

40 
	~<avr.h
>

41 
	~<sics.h
>

42 
	~<dt.h
>

45 
le
 
	$_day_us
(

46 
ut8_t
 
miocds
)

49 
	`__day_cyes
(
F_CPU
 / 1000000UL);

50 } 
miocds
--);

51 
	}
}

54 #i
defed
(
__GNUC__
)

55 
	~<ut/day.h
>

59 #i
defed
 (
__CROSSWORKS_AVR
)

60 #i(
__TARGET_PROCESSOR
 =
ATmega644P
)

61 
	#PRR
 
PRR0


	)

62 
	#UBRR0
 
UBRR0W


	)

63 
	#UBRR1
 
UBRR1W


	)

65 
	#PA0
 
PORTA0


	)

66 
	#PA1
 
PORTA1


	)

67 
	#PA2
 
PORTA2


	)

68 
	#PA3
 
PORTA3


	)

69 
	#PA4
 
PORTA4


	)

70 
	#PA5
 
PORTA5


	)

71 
	#PA6
 
PORTA6


	)

72 
	#PA7
 
PORTA7


	)

74 
	#PB0
 
PORTB0


	)

75 
	#PB1
 
PORTB1


	)

76 
	#PB2
 
PORTB2


	)

77 
	#PB3
 
PORTB3


	)

78 
	#PB4
 
PORTB4


	)

79 
	#PB5
 
PORTB5


	)

80 
	#PB6
 
PORTB6


	)

81 
	#PB7
 
PORTB7


	)

83 
	#PC0
 
PORTC0


	)

84 
	#PC1
 
PORTC1


	)

85 
	#PC2
 
PORTC2


	)

86 
	#PC3
 
PORTC3


	)

87 
	#PC4
 
PORTC4


	)

88 
	#PC5
 
PORTC5


	)

89 
	#PC6
 
PORTC6


	)

90 
	#PC7
 
PORTC7


	)

92 
	#PD0
 
PORTD0


	)

93 
	#PD1
 
PORTD1


	)

94 
	#PD2
 
PORTD2


	)

95 
	#PD3
 
PORTD3


	)

96 
	#PD4
 
PORTD4


	)

97 
	#PD5
 
PORTD5


	)

98 
	#PD6
 
PORTD6


	)

99 
	#PD7
 
PORTD7


	)

105 #i
defed
(
__GNUC__
)

106 
	~<avr/io.h
>

109 
	mb0
:1;

110 
	mb1
:1;

111 
	mb2
:1;

112 
	mb3
:1;

113 
	mb4
:1;

114 
	mb5
:1;

115 
	mb6
:1;

116 
	mb7
:1;

117 } 
	tBRegiTy
;

119 #ide
ue


120 
	#ue
 1

	)

123 #ide
l


124 
	#l
 0

	)

127 
	#GPIO_BITREG
(
pt
,
bnum
) \

128 ((vީ
BRegiTy
*)
	`_SFR_MEM_ADDR
(
pt
) \

129 )->
b
 ## 
bnum


	)

131 
	#PINA_B0
 
	`GPIO_BITREG
(
PINA
,0)

	)

132 
	#PINA_B1
 
	`GPIO_BITREG
(
PINA
,1)

	)

133 
	#PINA_B2
 
	`GPIO_BITREG
(
PINA
,2)

	)

134 
	#PINA_B3
 
	`GPIO_BITREG
(
PINA
,3)

	)

135 
	#PINA_B4
 
	`GPIO_BITREG
(
PINA
,4)

	)

136 
	#PINA_B5
 
	`GPIO_BITREG
(
PINA
,5)

	)

137 
	#PINA_B6
 
	`GPIO_BITREG
(
PINA
,6)

	)

138 
	#PINA_B7
 
	`GPIO_BITREG
(
PINA
,7)

	)

140 
	#PORTA_B0
 
	`GPIO_BITREG
(
PORTA
,0)

	)

141 
	#PORTA_B1
 
	`GPIO_BITREG
(
PORTA
,1)

	)

142 
	#PORTA_B2
 
	`GPIO_BITREG
(
PORTA
,2)

	)

143 
	#PORTA_B3
 
	`GPIO_BITREG
(
PORTA
,3)

	)

144 
	#PORTA_B4
 
	`GPIO_BITREG
(
PORTA
,4)

	)

145 
	#PORTA_B5
 
	`GPIO_BITREG
(
PORTA
,5)

	)

146 
	#PORTA_B6
 
	`GPIO_BITREG
(
PORTA
,6)

	)

147 
	#PORTA_B7
 
	`GPIO_BITREG
(
PORTA
,7)

	)

149 
	#PINB_B0
 
	`GPIO_BITREG
(
PINB
,0)

	)

150 
	#PINB_B1
 
	`GPIO_BITREG
(
PINB
,1)

	)

151 
	#PINB_B2
 
	`GPIO_BITREG
(
PINB
,2)

	)

152 
	#PINB_B3
 
	`GPIO_BITREG
(
PINB
,3)

	)

153 
	#PINB_B4
 
	`GPIO_BITREG
(
PINB
,4)

	)

154 
	#PINB_B5
 
	`GPIO_BITREG
(
PINB
,5)

	)

155 
	#PINB_B6
 
	`GPIO_BITREG
(
PINB
,6)

	)

156 
	#PINB_B7
 
	`GPIO_BITREG
(
PINB
,7)

	)

158 
	#PORTB_B0
 
	`GPIO_BITREG
(
PORTB
,0)

	)

159 
	#PORTB_B1
 
	`GPIO_BITREG
(
PORTB
,1)

	)

160 
	#PORTB_B2
 
	`GPIO_BITREG
(
PORTB
,2)

	)

161 
	#PORTB_B3
 
	`GPIO_BITREG
(
PORTB
,3)

	)

162 
	#PORTB_B4
 
	`GPIO_BITREG
(
PORTB
,4)

	)

163 
	#PORTB_B5
 
	`GPIO_BITREG
(
PORTB
,5)

	)

164 
	#PORTB_B6
 
	`GPIO_BITREG
(
PORTB
,6)

	)

165 
	#PORTB_B7
 
	`GPIO_BITREG
(
PORTB
,7)

	)

167 
	#PINC_B0
 
	`GPIO_BITREG
(
PINC
,0)

	)

168 
	#PINC_B1
 
	`GPIO_BITREG
(
PINC
,1)

	)

169 
	#PINC_B2
 
	`GPIO_BITREG
(
PINC
,2)

	)

170 
	#PINC_B3
 
	`GPIO_BITREG
(
PINC
,3)

	)

171 
	#PINC_B4
 
	`GPIO_BITREG
(
PINC
,4)

	)

172 
	#PINC_B5
 
	`GPIO_BITREG
(
PINC
,5)

	)

173 
	#PINC_B6
 
	`GPIO_BITREG
(
PINC
,6)

	)

174 
	#PINC_B7
 
	`GPIO_BITREG
(
PINC
,7)

	)

176 
	#PORTC_B0
 
	`GPIO_BITREG
(
PORTC
,0)

	)

177 
	#PORTC_B1
 
	`GPIO_BITREG
(
PORTC
,1)

	)

178 
	#PORTC_B2
 
	`GPIO_BITREG
(
PORTC
,2)

	)

179 
	#PORTC_B3
 
	`GPIO_BITREG
(
PORTC
,3)

	)

180 
	#PORTC_B4
 
	`GPIO_BITREG
(
PORTC
,4)

	)

181 
	#PORTC_B5
 
	`GPIO_BITREG
(
PORTC
,5)

	)

182 
	#PORTC_B6
 
	`GPIO_BITREG
(
PORTC
,6)

	)

183 
	#PORTC_B7
 
	`GPIO_BITREG
(
PORTC
,7)

	)

185 
	#PIND_B0
 
	`GPIO_BITREG
(
PIND
,0)

	)

186 
	#PIND_B1
 
	`GPIO_BITREG
(
PIND
,1)

	)

187 
	#PIND_B2
 
	`GPIO_BITREG
(
PIND
,2)

	)

188 
	#PIND_B3
 
	`GPIO_BITREG
(
PIND
,3)

	)

189 
	#PIND_B4
 
	`GPIO_BITREG
(
PIND
,4)

	)

190 
	#PIND_B5
 
	`GPIO_BITREG
(
PIND
,5)

	)

191 
	#PIND_B6
 
	`GPIO_BITREG
(
PIND
,6)

	)

192 
	#PIND_B7
 
	`GPIO_BITREG
(
PIND
,7)

	)

194 
	#PORTD_B0
 
	`GPIO_BITREG
(
PORTD
,0)

	)

195 
	#PORTD_B1
 
	`GPIO_BITREG
(
PORTD
,1)

	)

196 
	#PORTD_B2
 
	`GPIO_BITREG
(
PORTD
,2)

	)

197 
	#PORTD_B3
 
	`GPIO_BITREG
(
PORTD
,3)

	)

198 
	#PORTD_B4
 
	`GPIO_BITREG
(
PORTD
,4)

	)

199 
	#PORTD_B5
 
	`GPIO_BITREG
(
PORTD
,5)

	)

200 
	#PORTD_B6
 
	`GPIO_BITREG
(
PORTD
,6)

	)

201 
	#PORTD_B7
 
	`GPIO_BITREG
(
PORTD
,7)

	)

203 
	#GPIOR0_B0
 
	`GPIO_BITREG
(
GPIOR0
,0)

	)

204 
	#GPIOR0_B1
 
	`GPIO_BITREG
(
GPIOR0
,1)

	)

205 
	#GPIOR0_B2
 
	`GPIO_BITREG
(
GPIOR0
,2)

	)

206 
	#GPIOR0_B3
 
	`GPIO_BITREG
(
GPIOR0
,3)

	)

207 
	#GPIOR0_B4
 
	`GPIO_BITREG
(
GPIOR0
,4)

	)

208 
	#GPIOR0_B5
 
	`GPIO_BITREG
(
GPIOR0
,5)

	)

209 
	#GPIOR0_B6
 
	`GPIO_BITREG
(
GPIOR0
,6)

	)

210 
	#GPIOR0_B7
 
	`GPIO_BITREG
(
GPIOR0
,7)

	)

212 
	#GPIOR1_B0
 
	`GPIO_BITREG
(
GPIOR1
,0)

	)

213 
	#GPIOR1_B1
 
	`GPIO_BITREG
(
GPIOR1
,1)

	)

214 
	#GPIOR1_B2
 
	`GPIO_BITREG
(
GPIOR1
,2)

	)

215 
	#GPIOR1_B3
 
	`GPIO_BITREG
(
GPIOR1
,3)

	)

216 
	#GPIOR1_B4
 
	`GPIO_BITREG
(
GPIOR1
,4)

	)

217 
	#GPIOR1_B5
 
	`GPIO_BITREG
(
GPIOR1
,5)

	)

218 
	#GPIOR1_B6
 
	`GPIO_BITREG
(
GPIOR1
,6)

	)

219 
	#GPIOR1_B7
 
	`GPIO_BITREG
(
GPIOR1
,7)

	)

221 
	#GPIOR2_B0
 
	`GPIO_BITREG
(
GPIOR2
,0)

	)

222 
	#GPIOR2_B1
 
	`GPIO_BITREG
(
GPIOR2
,1)

	)

223 
	#GPIOR2_B2
 
	`GPIO_BITREG
(
GPIOR2
,2)

	)

224 
	#GPIOR2_B3
 
	`GPIO_BITREG
(
GPIOR2
,3)

	)

225 
	#GPIOR2_B4
 
	`GPIO_BITREG
(
GPIOR2
,4)

	)

226 
	#GPIOR2_B5
 
	`GPIO_BITREG
(
GPIOR2
,5)

	)

227 
	#GPIOR2_B6
 
	`GPIO_BITREG
(
GPIOR2
,6)

	)

228 
	#GPIOR2_B7
 
	`GPIO_BITREG
(
GPIOR2
,7)

	)

233 #i
defed
(
__GNUC__
)

234 
	#__ab_u
(
	`i
()

	)

235 
	#__dib_u
(
	`i
()

	)

239 #i
defed
(
__ICCAVR__
)

240 
	#PRAGMA
(
x

	`_Pgma
#x )

	)

241 
	#ISR
(
vec
) \

243 
	`PRAGMA

ve
=
vec
 ) 
__u
 
hdr_
##
	`vec
(); \

244 
	`PRAGMA

ve
=
vec
 ) 
__u
 
hdr_
##
	`vec
()

	)

245 #i
defed
(
__GNUC__
)

246 
	~<avr/u.h
>

247 #i
defed
 (
__CROSSWORKS_AVR
)

248 
	#ISR
(
vec

hdr_
##
	`vec
(
__u
[vec]

	)

250 #r 
ISR
(
n
 
defed
!

254 #i
defed
(
__ICCAVR__
)

255 
	#FLASH_DECLARE
(
x

__ash
 
	)
x

256 #i
defed
(
__GNUC__
)

257 
	#FLASH_DECLARE
(
x
x 
	`__ibu__
((
__ogmem__
))

	)

258 #i
defed
 (
__CROSSWORKS_AVR
)

259 
	#FLASH_DECLARE
 (
x
cڡ 
__code
 
	)
x

263 #i
defed
(
__ICCAVR__
)

264 
	#EEPROM_DECLARE
(
x

__om
 
	)
x

265 #i
defed
(
__GNUC__
)

266 
	~<avr/om.h
>

267 
	#EEPROM_DECLARE
(
x
x 
	`__ibu__
((
	`i
 (".om")))

	)

268 #i((
__GNUC__
 < 4|| ((__GNUC__ =4&& (
__GNUC_MINOR__
 < 3)) || \

269 ((
	g__GNUC__
 =4&& (
__GNUC_MINOR__
 =3&& (
__GNUC_PATCHLEVEL__
 <= 3)))

271 #ide
__EEPUT


272 
	#__EEPUT
 
_EEPUT


	)

274 #ide
__EEGET


275 
	#__EEGET
 
_EEGET


	)

278 #i
defed
 (
__CROSSWORKS_AVR
)

280 
__ut8_om_e
(

281 
by
,

282 
addr
);

283 
__ut8_om_ld
(

284 
addr
);

285 
	#__EEPUT
(
addr
, 
v
) \

286 
	`__ut8_om_e
(()(
v
), ()(
addr
))

	)

287 
	#__EEGET
(
v
, 
addr
) \

288 (
v

	`__ut8_om_ld
(()(
addr
))

	)

292 #i
defed
(
__GNUC__
)

294 
	#__muɝly_unsigd
(
x
,
y
((x)*(y))

	)

296 
	#__ro


	)

300 #i
defed
(
__ICCAVR__
|| defed(
__CROSSWORKS_AVR
)

301 
	#WDTO_15MS
 0

	)

302 
	#WDTO_30MS
 1

	)

303 
	#WDTO_60MS
 2

	)

304 
	#WDTO_120MS
 3

	)

305 
	#WDTO_250MS
 4

	)

306 
	#WDTO_500MS
 5

	)

307 
	#WDTO_1S
 6

	)

308 
	#WDTO_2S
 7

	)

312 #i(
defed
(
__ICCAVR__
&& (defed(
__ATmega644P__
))) || \

313 (
defed
(
__CROSSWORKS_AVR
&& (
	g__TARGET_PROCESSOR
 =
ATmega644P
))

314 
	#pow_adc_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRADC
))

	)

315 
	#pow_i_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRSPI
))

	)

316 
	#pow_u0_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRUSART0
))

	)

317 
	#pow_u1_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRUSART1
))

	)

318 
	#pow_tim0_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRTIM0
))

	)

319 
	#pow_tim1_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRTIM1
))

	)

320 
	#pow_tim2_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRTIM2
))

	)

322 #i(
defed
(
__ICCAVR__
&& (defed(
__ATmega1284P__
))) || \

323 (
defed
(
__CROSSWORKS_AVR
&& (
__TARGET_PROCESSOR
 =
ATmega1284P
))

324 
	#pow_adc_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRADC
))

	)

325 
	#pow_i_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRSPI
))

	)

326 
	#pow_u0_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRUSART0
))

	)

327 
	#pow_u1_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRUSART1
))

	)

328 
	#pow_tim0_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRTIM0
))

	)

329 
	#pow_tim1_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRTIM1
))

	)

330 
	#pow_tim2_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRTIM2
))

	)

332 #i(
defed
(
__GNUC__
&& ((__GNUC__ =4&& (
__GNUC_MINOR__
 < 5)))

333 #i
defed
(
__AVR_ATmega644P__
)

335 
	#pow_u1_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRUSART1
))

	)

336 #i
defed
(
__AVR_ATmega1284P__
)

337 
	#pow_u1_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRUSART1
))

	)

341 #i
defed
(
__CROSSWORKS_AVR
)

342 
	#le


	)

	@ports/atmega8/main.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~"hdwe.h
"

29 
	~"tim.h
"

30 
	~"rs485.h
"

31 
	~"dk.h
"

32 
	~"du.h
"

33 
	~"txbuf.h
"

34 
	~"m.h
"

35 
	~"devi.h
"

36 
	~"av.h
"

37 
	~"hdrs.h
"

40 cڡ *
	gBACt_Vsi
 = "1.0";

46 
bo
 
	$dcc_communiti_abd
(

49  
ue
;

50 
	}
}

52 
	$
(

56 #i
	`defed
(
__AVR_ATmega168__
)

59 
CLKPR
 = 
	`_BV
(
CLKPCE
);

74 
CLKPR
 = 0;

79 
DDRB
 = 0;

80 
PORTB
 = 0;

81 
DDRC
 = 0;

82 
PORTC
 = 0;

83 
DDRD
 = 0;

84 
PORTD
 = 0;

87 
	`WATCHDOG_INIT
();

90 
	`RS485_Inlize
();

91 
	`RS485_S_Baud_Re
(38400);

93 
	`tim_
();

95 
	`__ab_u
();

96 
	}
}

98 
ut8_t
 
	gPDUBufr
[
MAX_MPDU
];

100 
	$ma
(

103 
ut16_t
 
pdu_n
 = 0;

104 
BACNET_ADDRESS
 
c
;

106 
	`
();

107 
	`dk_
(
NULL
);

111 
pdu_n
 = 
	`dk_ive
(&
c
, &
PDUBufr
[0], (PDUBuffer), 0);

112 i(
pdu_n
) {

113 
	`du_hdr
(&
c
, &
PDUBufr
[0], 
pdu_n
);

116 
	}
}

	@ports/atmega8/rs485.c

29 
	~<ddef.h
>

30 
	~<dt.h
>

31 
	~<dbo.h
>

32 
	~<dlib.h
>

33 
	~<dio.h
>

34 
	~"bs.h
"

37 #i(
defed
(
__ICCAVR__
&& (defed(
__ATmega168__
))) || \

38 (
defed
(
__GNUC__
&& 
	$defed
(
__AVR_ATmega168__
))

40 
	#UCSRB
 
UCSR0B


	)

41 
	#TXEN
 
TXEN0


	)

42 
	#RXEN
 
RXEN0


	)

43 
	#UCSRC
 
UCSR0C


	)

44 
	#UCSZ1
 
UCSZ01


	)

45 
	#UCSZ0
 
UCSZ00


	)

46 
	#UCSRA
 
UCSR0A


	)

47 
	#U2X
 
U2X0


	)

48 
	#UBRRL
 
UBRR0


	)

49 
	#UCSRA
 
UCSR0A


	)

50 
	#UDRE
 
UDRE0


	)

51 
	#UDR
 
UDR0


	)

52 
	#TXC
 
TXC0


	)

53 
	#FE
 
FE0


	)

54 
	#DOR
 
DOR0


	)

55 
	#UPE
 
UPE0


	)

56 
	#DOR
 
DOR0


	)

57 
	#RXC
 
RXC0


	)

60 
	~"hdwe.h
"

61 
	~"tim.h
"

64 
ut32_t
 
RS485_Baud
;

75 
	#Ttuound
 (40UL)

	)

85 
	$RS485_Inlize
(

89 
UCSRB
 = 
	`_BV
(
TXEN
| _BV(
RXEN
);

98 
UCSRC
 = 
	`_BV
(
UCSZ1
| _BV(
UCSZ0
);

99 #i
	`defed
(
__AVR_ATmega168__
)

101 
	`BIT_CLEAR
(
PRR
, 
PRUSART0
);

105 
	`BIT_CLEAR
(
PORTD
, 
PD2
);

106 
	`BIT_SET
(
DDRD
, 
DDD2
);

109 
	}
}

117 
ut32_t
 
	$RS485_G_Baud_Re
(

120  
RS485_Baud
;

121 
	}
}

129 
bo
 
	$RS485_S_Baud_Re
(

130 
ut32_t
 
baud
)

132 
bo
 
vid
 = 
ue
;

134 
baud
) {

141 
RS485_Baud
 = 
baud
;

143 
	`BIT_SET
(
UCSRA
, 
U2X
);

145 
UBRRL
 = (
F_CPU
 / (8UL * 
RS485_Baud
)) - 1;

149 
vid
 = 
l
;

153  
vid
;

154 
	}
}

162 
	$RS485_Tnsmr_Eb
(

163 
bo
 
ab
)

165 i(
ab
) {

166 
	`BIT_SET
(
PORTD
, 
PD2
);

168 
	`BIT_CLEAR
(
PORTD
, 
PD2
);

170 
	}
}

178 
	$RS485_Tuound_Day
(

181 
ut8_t
 
nbys
 = 4;

183 
	`RS485_Tnsmr_Eb
(
l
);

184 
nbys
) {

185 !
	`BIT_CHECK
(
UCSR0A
, 
UDRE0
)) {

189 
UDR0
 = 0xff;

190 
nbys
--;

193 !
	`BIT_CHECK
(
UCSR0A
, 
TXC0
)) {

198 
	`BIT_SET
(
UCSR0A
, 
TXC0
);

199 
	}
}

207 
	$RS485_Sd_Da
(

208 
ut8_t
 * 
bufr
,

209 
ut16_t
 
nbys
)

211 
nbys
) {

212 !
	`BIT_CHECK
(
UCSRA
, 
UDRE
)) {

216 
UDR
 = *
bufr
;

217 
bufr
++;

218 
nbys
--;

221 !
	`BIT_CHECK
(
UCSRA
, 
TXC
)) {

226 
	`BIT_SET
(
UCSRA
, 
TXC
);

228 
	`tim_s_t
();

229 
	}
}

238 
bo
 
	$RS485_ReiveE
(

241 
bo
 
ReiveE
 = 
l
;

242 
ut8_t
 
dummy_da
;

246 i(
	`BIT_CHECK
(
UCSRA
, 
FE0
)) {

248 
	`BITMASK_CLEAR
(
UCSRA
, (
	`_BV
(
FE
| _BV(
DOR
| _BV(
UPE
)));

249 
ReiveE
 = 
ue
;

253 i(
	`BIT_CHECK
(
UCSRA
, 
DOR
)) {

256 
dummy_da
 = 
UDR
;

257 } 
	`BIT_CHECK
(
UCSRA
, 
RXC
));

258 
ReiveE
 = 
ue
;

261  
ReiveE
;

262 
	}
}

270 
bo
 
	$RS485_DaAvaab
(

271 
ut8_t
 * 
da
)

273 
bo
 
DaAvaab
 = 
l
;

276 i(
	`BIT_CHECK
(
UCSRA
, 
RXC
)) {

277 *
da
 = 
UDR
;

278 
DaAvaab
 = 
ue
;

281  
DaAvaab
;

282 
	}
}

284 #ifde
TEST_RS485


285 
	$ma
(

288 
i
 = 0;

289 
ut8_t
 
DaRegi
;

291 
	`RS485_S_Baud_Re
(38400);

292 
	`RS485_Inlize
();

295 i(
	`RS485_ReiveE
()) {

296 
	`rtf
(
dr
, "ERROR ");

297 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

298 
	`rtf
(
dr
, "%02X ", 
DaRegi
);

301 
	}
}

	@ports/atmega8/rs485.h

36 #ide
RS485_H


37 
	#RS485_H


	)

39 
	~<dt.h
>

41 #ifde
__lulus


45 
RS485_Inlize
(

48 
RS485_Tnsmr_Eb
(

49 
bo
 
ab
);

51 
RS485_Sd_Da
(

52 
ut8_t
 * 
bufr
,

53 
ut16_t
 
nbys
);

55 
bo
 
RS485_ReiveE
(

57 
bo
 
RS485_DaAvaab
(

58 
ut8_t
 * 
da
);

60 
RS485_Tuound_Day
(

62 
ut32_t
 
RS485_G_Baud_Re
(

64 
bo
 
RS485_S_Baud_Re
(

65 
ut32_t
 
baud
);

67 #ifde
__lulus


	@ports/atmega8/stdbool.h

1 #ide
STDBOOL_H


2 
	#STDBOOL_H


	)

6 #ide
__lulus


8 #ide
bo


9 
	#bo
 
_Bo


	)

11 #ide
ue


12 
	#ue
 1

	)

14 #ide
l


15 
	#l
 0

	)

17 
	#__bo_ue_l_e_defed
 1

	)

20 #ide
FALSE


21 
	#FALSE
 0

	)

24 #ide
TRUE


25 
	#TRUE
 1

	)

	@ports/atmega8/stdint.h

3 #ide
STDINT_H


4 
	#STDINT_H
 1

	)

6 
	~<ddef.h
>

8 
	tut8_t
;

9 sigd 
	tt8_t
;

10 
	tut16_t
;

11 sigd 
	tt16_t
;

12 
	tut32_t
;

13 sigd 
	tt32_t
;

	@ports/atmega8/timer.c

25 
	~<dbo.h
>

26 
	~<dt.h
>

27 
	~"hdwe.h
"

32 
	#TIMER_PRESCALER
 64

	)

34 
	#TIMER_TICKS
 (
F_CPU
/
TIMER_PRESCALER
/1000)

	)

35 #i(
TIMER_TICKS
 > 0xFF)

36 #r 
Tim
 
Psr
 
vue
 
is
 
too
 
sml


38 
	#TIMER_COUNT
 (0xFF-
TIMER_TICKS
)

	)

40 vީ
ut16_t
 
	gTim_S
;

43 
	$tim_
(

47 
TCCR1A
 = 0;

59 #i
	`defed
(
__AVR_ATmega168__
)

60 
TCCR0B
 = 
	`_BV
(
CS01
| _BV(
CS00
);

62 
	`BIT_CLEAR
(
TIFR0
, 
TOV0
);

64 
TCNT0
 = 
TIMER_COUNT
;

66 
	`BIT_SET
(
TIMSK0
, 
TOIE0
);

68 
	`BIT_CLEAR
(
PRR
, 
PRTIM0
);

70 
	}
}

75 
	$ISR
(
TIMER0_OVF_ve
)

78 
TCNT0
 = 
TIMER_COUNT
;

81 
Tim_S
++;

82 
	}
}

85 
bo
 
	$tim_s_d
(

86 
ut16_t
 
vue
)

88 
bo
 
us
 = 
l
;

89 
ut8_t
 
eg
;

91 
eg
 = 
SREG
;

92 
	`__dib_u
();

93 i(
Tim_S
 >
vue
) {

94 
us
 = 
ue
;

96 
SREG
 = 
eg
;

98  
us
;

99 
	}
}

101 
	$tim_s_t
(

104 
ut8_t
 
eg
;

106 
eg
 = 
SREG
;

107 
	`__dib_u
();

108 
Tim_S
 = 0;

109 
SREG
 = 
eg
;

110 
	}
}

	@ports/atmega8/timer.h

25 #ide
TIMER_H


26 
	#TIMER_H


	)

28 #ifde
__lulus


32 
tim_
(

34 
bo
 
tim_s_d
(

35 
ut16_t
 
vue
);

36 
tim_s_t
(

39 #ifde
__lulus


	@ports/bdk-atxx4-mstp/adc-block.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~"hdwe.h
"

28 
	~"adc.h
"

31 #i (
F_CPU
 >> 1) < 1000000

32 
	#ADPS_8BIT
 (1)

	)

33 
	#ADPS_10BIT
 (3)

	)

34 #i(
F_CPU
 >> 2) < 1000000

35 
	#ADPS_8BIT
 (2)

	)

36 
	#ADPS_10BIT
 (4)

	)

37 #i(
F_CPU
 >> 3) < 1000000

38 
	#ADPS_8BIT
 (3)

	)

39 
	#ADPS_10BIT
 (5)

	)

40 #i(
F_CPU
 >> 4) < 1000000

41 
	#ADPS_8BIT
 (4)

	)

42 
	#ADPS_10BIT
 (6)

	)

43 #i(
F_CPU
 >> 5) < 1000000

44 
	#ADPS_8BIT
 (5)

	)

45 
	#ADPS_10BIT
 (7)

	)

62 
	$adc_ab
(

63 
ut8_t
 
dex
)

65 
dex
 = index;

67 
	}
}

74 
ut8_t
 
	$adc_su_8b
(

75 
ut8_t
 
chl
)

77 
ut8_t
 
vue
 = 0;

79 
ADCSRA
 & (1 << 
ADSC
));

80 
ADMUX
 = 
chl
 | (1 << 
ADLAR
| (0 << 
REFS1
| (1 << 
REFS0
);

82 
	`_day_us
(10);

84 
ADCSRA
 = (1 << 
ADEN
| (1 << 
ADSC
| (1 << 
ADIF
| 
ADPS_8BIT
;

86 (
ADCSRA
 & (1 << 
ADIF
)) == 0);

87 
vue
 = 
ADCH
;

89  
vue
;

90 
	}
}

97 
ut16_t
 
	$adc_su_10b
(

98 
ut8_t
 
chl
)

100 
ut16_t
 
vue
 = 0;

102 
ADCSRA
 & (1 << 
ADSC
));

103 
ADMUX
 = 
chl
 | (0 << 
ADLAR
| (0 << 
REFS1
| (1 << 
REFS0
);

105 
	`_day_us
(10);

107 
ADCSRA
 = (1 << 
ADEN
| (1 << 
ADSC
| (1 << 
ADIF
| 
ADPS_10BIT
;

109 (
ADCSRA
 & (1 << 
ADIF
)) == 0);

110 
vue
 = 
ADCL
;

111 
vue
 |(
ADCH
 << 8);

113  
vue
;

114 
	}
}

121 
	$adc_
(

126 
	`BITMASK_CLEAR
(
ADCSRB
, 
	`_BV
(
ACME
| _BV(
ADTS2
| _BV(
ADTS1
| _BV(
ADTS0
));

128 
	`BIT_SET
(
DIDR0
, 
ADC0D
);

130 
	`BIT_CLEAR
(
PRR
, 
PRADC
);

131 
	}
}

	@ports/bdk-atxx4-mstp/adc.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~"hdwe.h
"

28 
	~"adc.h
"

31 #i (
F_CPU
 >> 1) < 1000000

32 
	#ADPS_8BIT
 (1)

	)

33 
	#ADPS_10BIT
 (3)

	)

34 #i(
F_CPU
 >> 2) < 1000000

35 
	#ADPS_8BIT
 (2)

	)

36 
	#ADPS_10BIT
 (4)

	)

37 #i(
F_CPU
 >> 3) < 1000000

38 
	#ADPS_8BIT
 (3)

	)

39 
	#ADPS_10BIT
 (5)

	)

40 #i(
F_CPU
 >> 4) < 1000000

41 
	#ADPS_8BIT
 (4)

	)

42 
	#ADPS_10BIT
 (6)

	)

43 #i(
F_CPU
 >> 5) < 1000000

44 
	#ADPS_8BIT
 (5)

	)

45 
	#ADPS_10BIT
 (7)

	)

51 
	#ADC_CHANNELS_MAX
 8

	)

52 vީ
ut16_t
 
	gSame_Resu
[
ADC_CHANNELS_MAX
];

53 vީ
ut8_t
 
	gEbd_Chls
;

55 
	$ISR
(
ADC_ve
)

57 
ut8_t
 
dex
;

58 
ut8_t
 
mask
;

59 
ut8_t
 
chls
;

60 
ut16_t
 
vue
 = 0;

63 
dex
 = 
	`BITMASK_CHECK
(
ADMUX
, ((1 << 
MUX2
| (1 << 
MUX1
| (1 << 
MUX0
)));

65 
vue
 = 
ADCL
;

66 
vue
 |(
ADCH
 << 8);

67 
Same_Resu
[
dex
] = 
vue
;

68 
chls
 = 
Ebd_Chls
;

69 
	`__ab_u
();

71 
	`BITMASK_CLEAR
(
ADMUX
, ((1 << 
MUX2
| (1 << 
MUX1
| (1 << 
MUX0
)));

73 
chls
) {

74 
dex
++;

75 i(
dex
 >
ADC_CHANNELS_MAX
) {

76 
dex
 = 0;

78 
mask
 = 1 << 
dex
;

79 i(
chls
 & 
mask
) {

84 
	`BITMASK_SET
(
ADMUX
, ((
dex
<< 
MUX0
));

86 
	`BIT_SET
(
ADCSRA
, 
ADSC
);

87 
	}
}

89 
	$adc_ab
(

90 
ut8_t
 
dex
)

92 i(
Ebd_Chls
) {

94 
	`BIT_SET
(
Ebd_Chls
, 
dex
);

96 i(
dex
 < 
ADC_CHANNELS_MAX
) {

98 
	`BIT_SET
(
Ebd_Chls
, 
dex
);

100 
	`BITMASK_CLEAR
(
ADMUX
, ((1 << 
MUX2
| (1 << 
MUX1
| (1 << 
MUX0
)));

102 
	`BITMASK_SET
(
ADMUX
, ((
dex
<< 
MUX0
));

104 
	`BIT_SET
(
ADCSRA
, 
ADSC
);

107 
	}
}

109 
ut8_t
 
	$adc_su_8b
(

110 
ut8_t
 
dex
)

112 
ut8_t
 
su
 = 0;

113 
ut8_t
 
eg
;

115 i(
dex
 < 
ADC_CHANNELS_MAX
) {

116 
	`adc_ab
(
dex
);

117 
eg
 = 
SREG
;

118 
	`__dib_u
();

119 
su
 = (
ut8_t
(
Same_Resu
[
dex
] >> 2);

120 
SREG
 = 
eg
;

123  
su
;

124 
	}
}

126 
ut16_t
 
	$adc_su_10b
(

127 
ut8_t
 
dex
)

129 
ut16_t
 
su
 = 0;

130 
ut8_t
 
eg
;

132 i(
dex
 < 
ADC_CHANNELS_MAX
) {

133 
	`adc_ab
(
dex
);

134 
eg
 = 
SREG
;

135 
	`__dib_u
();

136 
su
 = 
Same_Resu
[
dex
];

137 
SREG
 = 
eg
;

140  
su
;

141 
	}
}

143 
	$adc_
(

150 
ADMUX
 = (0 << 
ADLAR
| (0 << 
REFS1
| (1 << 
REFS0
);

157 
ADCSRA
 =

158 (1 << 
ADEN
| (1 << 
ADIE
| (1 << 
ADIF
| (0 << 
ADATE
| 
ADPS_10BIT
;

169 
ADCSRB
 = (0 << 
ADTS2
| (0 << 
ADTS1
| (0 << 
ADTS0
);

170 
	`pow_adc_ab
();

171 
	}
}

	@ports/bdk-atxx4-mstp/adc.h

24 #ide
ADC_H


25 
	#ADC_H


	)

27 
	~<dt.h
>

29 #ifde
__lulus


33 
adc_ab
(

34 
ut8_t
 
dex
);

35 
ut8_t
 
adc_su_8b
(

36 
ut8_t
 
dex
);

37 
ut16_t
 
adc_su_10b
(

38 
ut8_t
 
dex
);

39 
adc_
(

42 #ifde
__lulus


	@ports/bdk-atxx4-mstp/ai.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

35 
	~"ai.h
"

36 
	~"hdrs.h
"

38 #ide
MAX_ANALOG_INPUTS


39 
	#MAX_ANALOG_INPUTS
 2

	)

42 
	gP_Vue
[
MAX_ANALOG_INPUTS
];

45 cڡ 
	gAlog_Iut_Prݔts_Requed
[] = {

46 
PROP_OBJECT_IDENTIFIER
,

47 
PROP_OBJECT_NAME
,

48 
PROP_OBJECT_TYPE
,

49 
PROP_PRESENT_VALUE
,

50 
PROP_STATUS_FLAGS
,

51 
PROP_EVENT_STATE
,

52 
PROP_OUT_OF_SERVICE
,

53 
PROP_UNITS
,

57 cڡ 
	gAlog_Iut_Prݔts_Oiڮ
[] = {

61 cڡ 
	gAlog_Iut_Prݔts_Prrry
[] = {

65 
	$Alog_Iut_Prݔty_Lis
(

66 cڡ **
pRequed
,

67 cڡ **
pOiڮ
,

68 cڡ **
pPrrry
)

70 i(
pRequed
)

71 *
pRequed
 = 
Alog_Iut_Prݔts_Requed
;

72 i(
pOiڮ
)

73 *
pOiڮ
 = 
Alog_Iut_Prݔts_Oiڮ
;

74 i(
pPrrry
)

75 *
pPrrry
 = 
Alog_Iut_Prݔts_Prrry
;

78 
	}
}

80 
	$Alog_Iut_In
(

84 
	}
}

89 
bo
 
	$Alog_Iut_Vid_In
(

90 
ut32_t
 
obje_
)

92 i(
obje_
 < 
MAX_ANALOG_INPUTS
)

93  
ue
;

95  
l
;

96 
	}
}

99 
	$Alog_Iut_Cou
(

102  
MAX_ANALOG_INPUTS
;

103 
	}
}

106 
ut32_t
 
	$Alog_Iut_Index_To_In
(

107 
dex
)

109  
dex
;

110 
	}
}

112 
bo
 
	$Alog_Iut_Obje_Name
(

113 
ut32_t
 
obje_
,

114 
BACNET_CHARACTER_STRING
 * 
obje_me
)

116 
xt_rg
[32];

117 
bo
 
us
 = 
l
;

119 i(
obje_
 < 
MAX_ANALOG_INPUTS
) {

120 
	`rtf
(
xt_rg
, "AI-%lu", 
obje_
);

121 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

124  
us
;

125 
	}
}

127 
	$Alog_Iut_P_Vue
(

128 
ut32_t
 
obje_
)

130 
vue
 = 0.0;

132 i(
obje_
 < 
MAX_ANALOG_INPUTS
) {

133 
vue
 = 
P_Vue
[
obje_
];

136  
vue
;

137 
	}
}

139 
	$Alog_Iut_P_Vue_S
(

140 
ut32_t
 
obje_
,

141 
vue
)

143 i(
obje_
 < 
MAX_ANALOG_INPUTS
) {

144 
P_Vue
[
obje_
] = 
vue
;

146 
	}
}

150 
	$Alog_Iut_Rd_Prݔty
(

151 
BACNET_READ_PROPERTY_DATA
 * 
da
)

153 
du_n
 = 0;

154 
BACNET_CHARACTER_STRING
 
ch_rg
 = { 0 };

155 
BACNET_BIT_STRING
 
b_rg
 = { 0 };

156 
ut8_t
 *
du
 = 
NULL
;

158 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

159 (
da
->
iti_da_n
 == 0)) {

162 
du
 = 
da
->
iti_da
;

163 
da
->
obje_ݔty
) {

164 
PROP_OBJECT_IDENTIFIER
:

165 
du_n
 =

166 
	`code_iti_obje_id
(&
du
[0], 
da
->
obje_ty
,

167 
da
->
obje_
);

169 
PROP_OBJECT_NAME
:

170 
	`Alog_Iut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

171 
du_n
 =

172 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

174 
PROP_OBJECT_TYPE
:

175 
du_n
 =

176 
	`code_iti_umed
(&
du
[0], 
da
->
obje_ty
);

178 
PROP_PRESENT_VALUE
:

179 
du_n
 =

180 
	`code_iti_
(&
du
[0],

181 
	`Alog_Iut_P_Vue
(
da
->
obje_
));

183 
PROP_STATUS_FLAGS
:

184 
	`brg_
(&
b_rg
);

185 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

186 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

187 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

188 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

189 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

191 
PROP_EVENT_STATE
:

192 
du_n
 =

193 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

195 
PROP_OUT_OF_SERVICE
:

196 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

198 
PROP_UNITS
:

199 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

202 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

203 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

204 
du_n
 = 
BACNET_STATUS_ERROR
;

208 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

209 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

210 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

211 
du_n
 = 
BACNET_STATUS_ERROR
;

214  
du_n
;

215 
	}
}

	@ports/bdk-atxx4-mstp/av.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"banum.h
"

35 
	~"ba.h
"

36 
	~"cfig.h
"

37 
	~"wp.h
"

38 
	~"av.h
"

39 
	~"hdrs.h
"

40 
	~"hdwe.h
"

42 #ide
MAX_ANALOG_VALUES


43 
	#MAX_ANALOG_VALUES
 2

	)

46 
	gP_Vue
[
MAX_ANALOG_VALUES
];

49 cڡ 
	gAlog_Vue_Prݔts_Requed
[] = {

50 
PROP_OBJECT_IDENTIFIER
,

51 
PROP_OBJECT_NAME
,

52 
PROP_OBJECT_TYPE
,

53 
PROP_PRESENT_VALUE
,

54 
PROP_STATUS_FLAGS
,

55 
PROP_EVENT_STATE
,

56 
PROP_OUT_OF_SERVICE
,

57 
PROP_UNITS
,

61 cڡ 
	gAlog_Vue_Prݔts_Oiڮ
[] = {

63 
PROP_PRIORITY_ARRAY
,

64 
PROP_RELINQUISH_DEFAULT
,

69 cڡ 
	gAlog_Vue_Prݔts_Prrry
[] = {

73 
	$Alog_Vue_Prݔty_Lis
(

74 cڡ **
pRequed
,

75 cڡ **
pOiڮ
,

76 cڡ **
pPrrry
)

78 i(
pRequed
)

79 *
pRequed
 = 
Alog_Vue_Prݔts_Requed
;

80 i(
pOiڮ
)

81 *
pOiڮ
 = 
Alog_Vue_Prݔts_Oiڮ
;

82 i(
pPrrry
)

83 *
pPrrry
 = 
Alog_Vue_Prݔts_Prrry
;

86 
	}
}

88 
	$Alog_Vue_In
(

92 
	}
}

97 
bo
 
	$Alog_Vue_Vid_In
(

98 
ut32_t
 
obje_
)

100 i(
obje_
 < 
MAX_ANALOG_VALUES
)

101  
ue
;

103  
l
;

104 
	}
}

108 
	$Alog_Vue_Cou
(

111  
MAX_ANALOG_VALUES
;

112 
	}
}

117 
ut32_t
 
	$Alog_Vue_Index_To_In
(

118 
dex
)

120  
dex
;

121 
	}
}

126 
	$Alog_Vue_In_To_Index
(

127 
ut32_t
 
obje_
)

129 
dex
 = 
MAX_ANALOG_VALUES
;

131 i(
obje_
 < 
MAX_ANALOG_VALUES
)

132 
dex
 = 
obje_
;

134  
dex
;

135 
	}
}

137 
	$Alog_Vue_P_Vue
(

138 
ut32_t
 
obje_
)

140 
vue
 = 0;

141 
dex
 = 0;

143 
dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

144 i(
dex
 < 
MAX_ANALOG_VALUES
) {

145 
vue
 = 
P_Vue
[
dex
];

148  
vue
;

149 
	}
}

151 
bo
 
	$Alog_Vue_P_Vue_S
(

152 
ut32_t
 
obje_
,

153 
vue
,

154 
ut8_t
 
iܙy
)

156 
dex
 = 0;

157 
bo
 
us
 = 
l
;

159 
iܙy
 =riority;

160 
dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

161 i(
dex
 < 
MAX_ANALOG_VALUES
) {

162 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

163 (
iܙy
 != 6 ) &&

164 (
vue
 >= 0.0) && (value <= 100.0)) {

165 
P_Vue
[
dex
] = 
vue
;

171 
us
 = 
ue
;

174  
us
;

175 
	}
}

178 
bo
 
	$Alog_Vue_Obje_Name
(

179 
ut32_t
 
obje_
,

180 
BACNET_CHARACTER_STRING
 * 
obje_me
)

182 
xt_rg
[32] = "";

183 
dex
 = 0;

184 
bo
 
us
 = 
l
;

186 
dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

187 i(
dex
 < 
MAX_ANALOG_VALUES
) {

188 
	`rtf
(
xt_rg
, "AV-%lu", 
obje_
);

189 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

192  
us
;

193 
	}
}

196 
	$Alog_Vue_Rd_Prݔty
(

197 
BACNET_READ_PROPERTY_DATA
 * 
da
)

199 
du_n
 = 0;

200 
BACNET_BIT_STRING
 
b_rg
;

201 
_vue
 = 1.414F;

202 
BACNET_CHARACTER_STRING
 
ch_rg
 = { 0 };

204 
obje_dex
 = 0;

205 
i
 = 0;

206 
bo
 
e
 = 
l
;

208 
ut8_t
 *
du
 = 
NULL
;

210 i((
da
->
iti_da
 =
NULL
) ||

211 (
da
->
iti_da_n
 == 0)) {

214 
du
 = 
da
->
iti_da
;

215 
da
->
obje_ݔty
) {

216 
PROP_OBJECT_IDENTIFIER
:

217 
du_n
 =

218 
	`code_iti_obje_id
(&
du
[0], 
da
->
obje_ty
,

219 
da
->
obje_
);

221 
PROP_OBJECT_NAME
:

222 
	`Alog_Vue_Obje_Name
(
da
->
obje_
, &
ch_rg
);

223 
du_n
 =

224 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

226 
PROP_OBJECT_TYPE
:

227 
du_n
 =

228 
	`code_iti_umed
(&
du
[0], 
da
->
obje_ty
);

230 
PROP_PRESENT_VALUE
:

231 
_vue
 = 
	`Alog_Vue_P_Vue
(
da
->
obje_
);

232 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

234 
PROP_STATUS_FLAGS
:

235 
	`brg_
(&
b_rg
);

236 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

237 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

238 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

239 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

240 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

242 
PROP_EVENT_STATE
:

243 
du_n
 =

244 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

246 
PROP_OUT_OF_SERVICE
:

248 
obje_dex
 =

249 
	`Alog_Vue_In_To_Index
(
da
->
obje_
);

250 
e
 = 
Alog_Vue_Out_Of_Svi
[
obje_dex
];

252 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

254 
PROP_UNITS
:

255 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

258 
PROP_PRIORITY_ARRAY
:

260 i(
da
->
y_dex
 == 0)

261 
du_n
 =

262 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

265 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

266 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

267 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

269 i(
P_Vue
[
obje_dex
][
i
] =
ANALOG_LEVEL_NULL
)

270 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

272 
_vue
 = 
P_Vue
[
obje_dex
][
i
];

273 
n
 =

274 
	`code_iti_
(&
du
[
du_n
],

275 
_vue
);

278 i((
du_n
 + 
n
< 
MAX_APDU
)

279 
du_n
 +
n
;

281 
da
->
r_code
 =

282 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

283 
du_n
 = 
BACNET_STATUS_ABORT
;

288 
obje_dex
 =

289 
	`Alog_Vue_In_To_Index
(
da
->
obje_
);

290 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

291 i(
P_Vue
[
obje_dex
][
da
->
y_dex
 - 1] ==

292 
ANALOG_LEVEL_NULL
)

293 
du_n
 = 
	`code_iti_nu
(&
du
[0]);

295 
_vue
 =

296 
P_Vue
[
obje_dex
][
da
->
y_dex
 -

298 
du_n
 =

299 
	`code_iti_
(&
du
[0], 
_vue
);

302 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

303 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

304 
du_n
 = 
BACNET_STATUS_ERROR
;

309 
PROP_RELINQUISH_DEFAULT
:

310 
_vue
 = 
ANALOG_RELINQUISH_DEFAULT
;

311 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

315 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

316 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

317 
du_n
 = 
BACNET_STATUS_ERROR
;

321 i((
du_n
 >= 0) &&

323 (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

325 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

326 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

327 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

328 
du_n
 = 
BACNET_STATUS_ERROR
;

331  
du_n
;

332 
	}
}

335 
bo
 
	$Alog_Vue_Wre_Prݔty
(

336 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

338 
bo
 
us
 = 
l
;

340 
obje_dex
 = 0;

341 
iܙy
 = 0;

343 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

344 
n
 = 0;

347 
n
 =

348 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

349 
wp_da
->
iti_da_n
, &
vue
);

351 i(
n
 < 0) {

353 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

354 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

355  
l
;

357 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

358 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

360 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

361 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

362  
l
;

364 
wp_da
->
obje_ݔty
) {

365 
PROP_PRESENT_VALUE
:

366 
us
 =

367 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_REAL
,

368 &
wp_da
->
r_ass
, &wp_da->
r_code
);

369 i(
us
) {

370 
us
 =

371 
	`Alog_Vue_P_Vue_S
(
wp_da
->
obje_
,

372 
vue
.
ty
.
Rl
, 
wp_da
->
iܙy
);

373 i(!
us
) {

374 i(
wp_da
->
iܙy
 == 6) {

378 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

379 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

381 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

382 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

387 
PROP_OUT_OF_SERVICE
:

389 
us
 =

390 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

391 &
wp_da
->
r_ass
, &wp_da->
r_code
);

392 i(
us
) {

393 
obje_dex
 =

394 
	`Alog_Vue_In_To_Index
(
wp_da
->
obje_
);

395 
Alog_Vue_Out_Of_Svi
[
obje_dex
] = 
vue
.
ty
.
Boޗn
;

399 
PROP_UNITS
:

401 
us
 =

402 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

403 &
wp_da
->
r_ass
, &wp_da->
r_code
);

404 i(
us
) {

405 
obje_dex
 =

406 
	`Alog_Vue_In_To_Index
(
wp_da
->
obje_
);

407 
Alog_Vue_Uns
[
obje_dex
] = 
vue
.
ty
.
Unsigd_I
;

411 
PROP_PRIORITY_ARRAY
:

412 
PROP_OBJECT_IDENTIFIER
:

413 
PROP_OBJECT_NAME
:

414 
PROP_OBJECT_TYPE
:

415 
PROP_STATUS_FLAGS
:

416 
PROP_EVENT_STATE
:

417 
PROP_DESCRIPTION
:

418 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

419 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

421 
PROP_RELINQUISH_DEFAULT
:

423 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

424 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

428 
n
 =en;

430  
us
;

431 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/AVRBootloader.cpp

23 
	~"AVRBold.h
"

25 
	~<sam
>

26 
	~<iom
>

28 
	#MEM_PROGRESS_GRANULARITY
 256

29 

	)

32 
	gAVRBold
::
	$AVRBold

CommChl
 * 
_comm
 ) :

33 
AVRProgmm
::
	$AVRProgmm

_comm
 )

36 
	}
}

40 
AVRBold
::~
	$AVRBold
()

43 
	}
}

46 
bo
 
AVRBold
::
	$rProgmmgMode
()

48  
ue
;

49 
	}
}

52 
bo
 
	gAVRBold
::
	$aveProgmmgMode
()

54  
ue
;

55 
	}
}

58 
bo
 
	gAVRBold
::
	$chE
()

61 
comm
->
	`ndBy
( 'e' );

62 
comm
->
	`ushTX
();

65 if
comm
->
	`gBy
() != '\r' )

66 
throw
 
w
 
	`EMsg
( "Chiprase failed! "

69  
ue
;

70 
	}
}

73 
bo
 
	gAVRBold
::
	$adOSCCAL

pos
, * 
vue
 )

75  
l
;

76 
	}
}

79 
bo
 
	gAVRBold
::
	$adSigtu
* 
sig0
, * 
sig1
, * 
sig2
 )

82 
comm
->
	`ndBy
( 's' );

83 
comm
->
	`ushTX
();

86 *
sig2
 = 
comm
->
	`gBy
();

87 *
sig1
 = 
comm
->
	`gBy
();

88 *
sig0
 = 
comm
->
	`gBy
();

89 
	}
}

92 
bo
 
	gAVRBold
::
	$checkSigtu

sig0
, 
sig1
, 
sig2
 )

94 
sig
[3];

97 
	`adSigtu

sig
, sig+1, sig+2 );

100 if
sig
[0] !
sig0
 || sig[1] !
sig1
 || sig[2] !
sig2
 )

102 
orgam
 
msg
;

103 
msg
 << "Signature doesot match selected device! ";

104 
msg
 << "Au sigtu: (" << 
hex


105 << "0x" << 
	`tw
(2<< 
sig
[0] << " "

106 << "0x" << 
	`tw
(2<< 
sig
[1] << " "

107 << "0x" << 
	`tw
(2<< 
sig
[2] << ") "

108 << "Sigtu from XML-fe: (" << 
hex


109 << "0x" << 
	`tw
(2<< 
sig0
 << " "

110 << "0x" << 
	`tw
(2<< 
sig1
 << " "

111 << "0x" << 
	`tw
(2<< 
sig2
 << ").";

113 
throw
 
w
 
	`EMsg

msg
.
	`r
() );

116  
ue
;

117 
	}
}

120 
bo
 
	gAVRBold
::
	$wreFshBy

addss
, 
vue
 )

122 
	`tAddss

addss
 >> 1 );

125 if
addss
 & 0x01 )

126 
vue
 = (value << 8) | 0x00ff;

128 
vue
 |= 0xff00;

131 
	`wreFshLowBy

vue
 & 0xff );

132 
	`wreFshHighBy

vue
 >> 8 );

135 
	`tAddss

addss
 >> 1 );

136 
	`wreFshPage
();

138  
ue
;

139 
	}
}

142 
bo
 
	gAVRBold
::
	$wreEEPROMBy

addss
, 
vue
 )

144 if
addss
 >= 0x10000 )

145 
throw
 
w
 
	`EMsg
( "EEPROMddressesbove 64kre currentlyot supported!" );

147 
	`tAddss

addss
 );

150 
comm
->
	`ndBy
( 'D' );

151 
comm
->
	`ndBy

vue
 );

152 
comm
->
	`ushTX
();

155 if
comm
->
	`gBy
() != '\r' )

156 
throw
 
w
 
	`EMsg
( "Writing byteo EEPROM failed! "

159  
ue
;

160 
	}
}

163 
bo
 
	gAVRBold
::
	$wreFsh

HEXFe
 * 
da
 )

165 
t
, 
d
;

166 
bo
 
autoemt
;

167 
addss
;

170 if
gesize
 == -1 )

171 
throw
 
w
 
	`EMsg
( "Programmeragesize isot set!" );

174 
comm
->
	`ndBy
( 'b' );

175 
comm
->
	`ushTX
();

177 if
comm
->
	`gBy
() == 'Y' )

179 
Ut
.
	`log
( "Using block mode...\r\n" );

180  
	`wreFshBlock

da
 );

184 
t
 = 
da
->
	`gRgeS
();

185 
d
 = 
da
->
	`gRgeEnd
();

188 
comm
->
	`ndBy
( 'a' );

189 
comm
->
	`ushTX
();

191 if
comm
->
	`gBy
() == 'Y' )

192 
autoemt
 = 
ue
;

194 
autoemt
 = 
l
;

197 
	`tAddss

t
 >> 1 );

200 
addss
 = 
t
;

201 if
addss
 & 1 )

204 
	`wreFshLowBy
( 0xff );

205 
	`wreFshHighBy

da
->
	`gDa

addss
 ) );

206 
addss
++;

209 if(
addss
 % 
gesize
) == 0 ||

210 
addss
 > 
d
 )

212 
	`tAddss
(
addss
-2) >> 1 );

213 
	`wreFshPage
();

214 
	`tAddss

addss
 >> 1 );

219  (
d
-
addss
+1) >= 2 )

222 if!
autoemt
 )

223 
	`tAddss

addss
 >> 1 );

226 
	`wreFshLowBy

da
->
	`gDa

addss
 ) );

227 
	`wreFshHighBy

da
->
	`gDa

addss
+1 ) );

228 
addss
 += 2;

230 if(
addss
 % 
MEM_PROGRESS_GRANULARITY
) == 0 )

231 
Ut
.
	`ogss
( "#" );

234 if(
addss
 % 
gesize
) == 0 ||

235 
addss
 > 
d
 )

237 
	`tAddss
(
addss
-2) >> 1 );

238 
	`wreFshPage
();

239 
	`tAddss

addss
 >> 1 );

244 if
addss
 =
d
 )

247 
	`wreFshLowBy

da
->
	`gDa

addss
 ) );

248 
	`wreFshHighBy
( 0xff );

249 
addss
+=2;

252 
	`tAddss
(
addss
-2) >> 1 );

253 
	`wreFshPage
();

256 
Ut
.
	`ogss
( "\r\n" );

257  
ue
;

258 
	}
}

261 
bo
 
	gAVRBold
::
	$wreFshBlock

HEXFe
 * 
da
 )

263 
t
, 
d
;

264 
blocksize
;

265 
bycou
;

266 
addss
;

269 
blocksize
 = (
comm
->
	`gBy
() << 8) | comm->getByte();

272 
t
 = 
da
->
	`gRgeS
();

273 
d
 = 
da
->
	`gRgeEnd
();

276 
addss
 = 
t
;

277 if
addss
 & 1 )

279 
	`tAddss

addss
 >> 1 );

282 
	`wreFshLowBy
( 0xff );

283 
	`wreFshHighBy

da
->
	`gDa

addss
 ) );

284 
addss
++;

287 if(
addss
 % 
gesize
) == 0 ||

288 
addss
 > 
d
 )

290 
	`tAddss
(
addss
-2) >> 1 );

291 
	`wreFshPage
();

292 
	`tAddss

addss
 >> 1 );

297 if(
addss
 % 
blocksize
) > 0 )

299 
bycou
 = 
blocksize
 - (
addss
 % blocksize);

301 if(
addss
+
bycou
-1> 
d
 )

303 
bycou
 = 
d
-
addss
+1;

304 
bycou
 &= ~0x01;

307 if
bycou
 > 0 )

309 
	`tAddss

addss
 >> 1 );

312 
comm
->
	`ndBy
( 'B' );

313 
comm
->
	`ndBy
(
bycou
>>8) & 0xff );

314 
comm
->
	`ndBy

bycou
 & 0xff );

315 
comm
->
	`ndBy
( 'F' );

317  
bycou
 > 0 )

319 
comm
->
	`ndBy

da
->
	`gDa

addss
 ) );

320 
addss
++;

321 
bycou
--;

324 if
comm
->
	`gBy
() != '\r' )

325 
throw
 
w
 
	`EMsg
( "Writing Flash block failed! "

328 
Ut
.
	`ogss
( "#" );

333  (
d
-
addss
+1>
blocksize
 )

335 
bycou
 = 
blocksize
;

337 
	`tAddss

addss
 >> 1 );

340 
comm
->
	`ndBy
( 'B' );

341 
comm
->
	`ndBy
(
bycou
>>8) & 0xff );

342 
comm
->
	`ndBy

bycou
 & 0xff );

343 
comm
->
	`ndBy
( 'F' );

345  
bycou
 > 0 )

347 
comm
->
	`ndBy

da
->
	`gDa

addss
 ) );

348 
addss
++;

349 
bycou
--;

352 if
comm
->
	`gBy
() != '\r' )

353 
throw
 
w
 
	`EMsg
( "Writing Flash block failed! "

356 
Ut
.
	`ogss
( "#" );

360 if(
d
-
addss
+1) >= 1 )

362 
bycou
 = (
d
-
addss
+1);

363 if
bycou
 & 1 )

364 
bycou
++;

366 
	`tAddss

addss
 >> 1 );

369 
comm
->
	`ndBy
( 'B' );

370 
comm
->
	`ndBy
(
bycou
>>8) & 0xff );

371 
comm
->
	`ndBy

bycou
 & 0xff );

372 
comm
->
	`ndBy
( 'F' );

374  
bycou
 > 0 )

376 if
addss
 > 
d
 )

377 
comm
->
	`ndBy
( 0xff );

379 
comm
->
	`ndBy

da
->
	`gDa

addss
 ) );

381 
addss
++;

382 
bycou
--;

385 if
comm
->
	`gBy
() != '\r' )

386 
throw
 
w
 
	`EMsg
( "Writing Flash block failed! "

389 
Ut
.
	`ogss
( "#" );

392 
Ut
.
	`ogss
( "\r\n" );

393  
ue
;

394 
	}
}

397 
bo
 
	gAVRBold
::
	$adFsh

HEXFe
 * 
da
 )

399 
t
, 
d
;

400 
bo
 
autoemt
;

401 
addss
;

403 if
gesize
 == -1 )

404 
throw
 
w
 
	`EMsg
( "Programmeragesize isot set!" );

407 
comm
->
	`ndBy
( 'b' );

408 
comm
->
	`ushTX
();

410 if
comm
->
	`gBy
() == 'Y' )

412 
Ut
.
	`log
( "Using block mode...\r\n" );

413  
	`adFshBlock

da
 );

417 
t
 = 
da
->
	`gRgeS
();

418 
d
 = 
da
->
	`gRgeEnd
();

421 
comm
->
	`ndBy
( 'a' );

422 
comm
->
	`ushTX
();

424 if
comm
->
	`gBy
() == 'Y' )

425 
autoemt
 = 
ue
;

427 
autoemt
 = 
l
;

430 
	`tAddss

t
 >> 1 );

433 
addss
 = 
t
;

434 if
addss
 & 1 )

437 
comm
->
	`ndBy
( 'R' );

438 
comm
->
	`ushTX
();

440 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

441 
comm
->
	`gBy
();

442 
addss
++;

446  (
d
-
addss
+1) >= 2 )

449 if!
autoemt
 )

450 
	`tAddss

addss
 >> 1 );

453 
comm
->
	`ndBy
( 'R' );

454 
comm
->
	`ushTX
();

456 
da
->
	`tDa

addss
+1, 
comm
->
	`gBy
() );

457 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

458 
addss
 += 2;

460 if(
addss
 % 
MEM_PROGRESS_GRANULARITY
) == 0 )

461 
Ut
.
	`ogss
( "#" );

466 if
addss
 =
d
 )

469 
comm
->
	`ndBy
( 'R' );

470 
comm
->
	`ushTX
();

472 
comm
->
	`gBy
();

473 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

476 
Ut
.
	`ogss
( "\r\n" );

477  
ue
;

478 
	}
}

481 
bo
 
	gAVRBold
::
	$adFshBlock

HEXFe
 * 
da
 )

483 
t
, 
d
;

484 
blocksize
;

485 
bycou
;

486 
addss
;

489 
blocksize
 = (
comm
->
	`gBy
() << 8) | comm->getByte();

492 
t
 = 
da
->
	`gRgeS
();

493 
d
 = 
da
->
	`gRgeEnd
();

496 
addss
 = 
t
;

497 if
addss
 & 1 )

499 
	`tAddss

addss
 >> 1 );

502 
comm
->
	`ndBy
( 'R' );

503 
comm
->
	`ushTX
();

505 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

506 
comm
->
	`gBy
();

507 
addss
++;

511 if(
addss
 % 
blocksize
) > 0 )

513 
bycou
 = 
blocksize
 - (
addss
 % blocksize);

515 if(
addss
+
bycou
-1> 
d
 )

517 
bycou
 = 
d
-
addss
+1;

518 
bycou
 &= ~0x01;

521 if
bycou
 > 0 )

523 
	`tAddss

addss
 >> 1 );

526 
comm
->
	`ndBy
( 'g' );

527 
comm
->
	`ndBy
(
bycou
>>8) & 0xff );

528 
comm
->
	`ndBy

bycou
 & 0xff );

529 
comm
->
	`ndBy
( 'F' );

531  
bycou
 > 0 )

533 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

534 
addss
++;

535 
bycou
--;

538 
Ut
.
	`ogss
( "#" );

543  (
d
-
addss
+1>
blocksize
 )

545 
bycou
 = 
blocksize
;

547 
	`tAddss

addss
 >> 1 );

550 
comm
->
	`ndBy
( 'g' );

551 
comm
->
	`ndBy
(
bycou
>>8) & 0xff );

552 
comm
->
	`ndBy

bycou
 & 0xff );

553 
comm
->
	`ndBy
( 'F' );

555  
bycou
 > 0 )

557 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

558 
addss
++;

559 
bycou
--;

562 
Ut
.
	`ogss
( "#" );

566 if(
d
-
addss
+1) >= 1 )

568 
bycou
 = (
d
-
addss
+1);

569 if
bycou
 & 1 )

570 
bycou
++;

572 
	`tAddss

addss
 >> 1 );

575 
comm
->
	`ndBy
( 'g' );

576 
comm
->
	`ndBy
(
bycou
>>8) & 0xff );

577 
comm
->
	`ndBy

bycou
 & 0xff );

578 
comm
->
	`ndBy
( 'F' );

580  
bycou
 > 0 )

582 if
addss
 > 
d
 )

583 
comm
->
	`gBy
();

585 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

587 
addss
++;

588 
bycou
--;

591 
Ut
.
	`ogss
( "#" );

594 
Ut
.
	`ogss
( "\r\n" );

595  
ue
;

596 
	}
}

599 
bo
 
	gAVRBold
::
	$wreEEPROM

HEXFe
 * 
da
 )

601 
t
, 
d
;

602 
bo
 
autoemt
;

603 
addss
;

606 
comm
->
	`ndBy
( 'b' );

607 
comm
->
	`ushTX
();

609 if
comm
->
	`gBy
() == 'Y' )

611 
Ut
.
	`log
( "Using block mode...\r\n" );

612  
	`wreEEPROMBlock

da
 );

616 
t
 = 
da
->
	`gRgeS
();

617 
d
 = 
da
->
	`gRgeEnd
();

620 
comm
->
	`ndBy
( 'a' );

621 
comm
->
	`ushTX
();

623 if
comm
->
	`gBy
() == 'Y' )

624 
autoemt
 = 
ue
;

626 
autoemt
 = 
l
;

629 
	`tAddss

t
 );

632 
addss
 = 
t
;

636 if!
autoemt
 )

637 
	`tAddss

addss
 );

640 
comm
->
	`ndBy
( 'D' );

641 
comm
->
	`ndBy

da
->
	`gDa

addss
 ) );

642 
comm
->
	`ushTX
();

644 if
comm
->
	`gBy
() != '\r' )

645 
throw
 
w
 
	`EMsg
( "Writing byteo EEPROM failed! "

648 if(
addss
 % 
MEM_PROGRESS_GRANULARITY
) == 0 )

649 
Ut
.
	`ogss
( "#" );

651 
addss
++;

652 }  
addss
 <
d
 );

654 
Ut
.
	`ogss
( "\r\n" );

655  
ue
;

656 
	}
}

659 
bo
 
	gAVRBold
::
	$wreEEPROMBlock

HEXFe
 * 
da
 )

661 
t
, 
d
;

662 
blocksize
;

663 
bycou
;

664 
addss
;

667 
blocksize
 = (
comm
->
	`gBy
() << 8) | comm->getByte();

670 
t
 = 
da
->
	`gRgeS
();

671 
d
 = 
da
->
	`gRgeEnd
();

674 
addss
 = 
t
;

675  
addss
 <
d
 )

677 
bycou
 = 
blocksize
;

679 if(
addss
+
bycou
-1> 
d
 )

681 
bycou
 = 
d
-
addss
+1;

684 
	`tAddss

addss
 );

687 
comm
->
	`ndBy
( 'B' );

688 
comm
->
	`ndBy
(
bycou
>>8) & 0xff );

689 
comm
->
	`ndBy

bycou
 & 0xff );

690 
comm
->
	`ndBy
( 'E' );

692  
bycou
 > 0 )

694 
comm
->
	`ndBy

da
->
	`gDa

addss
 ) );

695 
comm
->
	`ushTX
();

697 
addss
++;

698 
bycou
--;

701 if
comm
->
	`gBy
() != '\r' )

702 
throw
 
w
 
	`EMsg
( "Writing EEPROM block failed! "

705 
Ut
.
	`ogss
( "#" );

708 
Ut
.
	`ogss
( "\r\n" );

709  
ue
;

710 
	}
}

713 
bo
 
	gAVRBold
::
	$adEEPROM

HEXFe
 * 
da
 )

715 
t
, 
d
;

716 
bo
 
autoemt
;

717 
addss
;

720 
comm
->
	`ndBy
( 'b' );

721 
comm
->
	`ushTX
();

723 if
comm
->
	`gBy
() == 'Y' )

725 
Ut
.
	`log
( "Using block mode...\r\n" );

726  
	`adEEPROMBlock

da
 );

730 
t
 = 
da
->
	`gRgeS
();

731 
d
 = 
da
->
	`gRgeEnd
();

734 
comm
->
	`ndBy
( 'a' );

735 
comm
->
	`ushTX
();

737 if
comm
->
	`gBy
() == 'Y' )

738 
autoemt
 = 
ue
;

740 
autoemt
 = 
l
;

743 
	`tAddss

t
 );

746 
addss
 = 
t
;

750 if!
autoemt
 )

751 
	`tAddss

addss
 );

754 
comm
->
	`ndBy
( 'd' );

755 
comm
->
	`ushTX
();

757 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

759 if(
addss
 % 
MEM_PROGRESS_GRANULARITY
) == 0 )

760 
Ut
.
	`ogss
( "#" );

762 
addss
++;

763 }  
addss
 <
d
 );

765 
Ut
.
	`ogss
( "\r\n" );

766  
ue
;

767 
	}
}

770 
bo
 
	gAVRBold
::
	$adEEPROMBlock

HEXFe
 * 
da
 )

772 
t
, 
d
;

773 
blocksize
;

774 
bycou
;

775 
addss
;

778 
blocksize
 = (
comm
->
	`gBy
() << 8) | comm->getByte();

781 
t
 = 
da
->
	`gRgeS
();

782 
d
 = 
da
->
	`gRgeEnd
();

785 
addss
 = 
t
;

786  
addss
 <
d
 )

788 
bycou
 = 
blocksize
;

790 if(
addss
+
bycou
-1> 
d
 )

792 
bycou
 = 
d
-
addss
+1;

795 
	`tAddss

addss
 );

798 
comm
->
	`ndBy
( 'g' );

799 
comm
->
	`ndBy
(
bycou
>>8) & 0xff );

800 
comm
->
	`ndBy

bycou
 & 0xff );

801 
comm
->
	`ndBy
( 'E' );

803  
bycou
 > 0 )

805 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

806 
addss
++;

807 
bycou
--;

810 
Ut
.
	`ogss
( "#" );

813 
Ut
.
	`ogss
( "\r\n" );

814  
ue
;

815 
	}
}

818 
bo
 
	gAVRBold
::
	$wreLockBs

bs
 )

821 
comm
->
	`ndBy
( 'l' );

822 
comm
->
	`ndBy

bs
 & 0xff );

823 
comm
->
	`ushTX
();

826 if
comm
->
	`gBy
() != '\r' )

827 
throw
 
w
 
	`EMsg
( "Writingock bits failed! "

830  
ue
;

831 
	}
}

834 
bo
 
	gAVRBold
::
	$adLockBs
* 
bs
 )

837 
comm
->
	`ndBy
( 'r' );

838 
comm
->
	`ushTX
();

841 *
bs
 = 
comm
->
	`gBy
();

843  
ue
;

844 
	}
}

847 
bo
 
	gAVRBold
::
	$wreFuBs

bs
 )

849  
l
;

850 
	}
}

853 
bo
 
	gAVRBold
::
	$adFuBs
* 
bs
 )

855 
lowfu
, 
highfu
;

858 
comm
->
	`ndBy
( 'N' );

859 
comm
->
	`ushTX
();

862 
highfu
 = 
comm
->
	`gBy
();

865 
comm
->
	`ndBy
( 'F' );

866 
comm
->
	`ushTX
();

869 
lowfu
 = 
comm
->
	`gBy
();

871 *
bs
 = (
highfu
 << 8| 
lowfu
;

873  
ue
;

874 
	}
}

877 
bo
 
	gAVRBold
::
	$wreExndedFuBs

bs
 )

879  
l
;

880 
	}
}

883 
bo
 
	gAVRBold
::
	$adExndedFuBs
* 
bs
 )

886 
comm
->
	`ndBy
( 'Q' );

887 
comm
->
	`ushTX
();

890 *
bs
 = 
comm
->
	`gBy
();

892  
ue
;

893 
	}
}

896 
bo
 
	gAVRBold
::
	$ogmmSoweVsi
* 
maj
, * 
m
 )

899 
comm
->
	`ndBy
( 'V' );

900 
comm
->
	`ushTX
();

903 *
maj
 = 
comm
->
	`gBy
();

904 *
m
 = 
comm
->
	`gBy
();

906  
ue
;

907 
	}
}

910 
bo
 
	gAVRBold
::
	$ogmmHdweVsi
* 
maj
, * 
m
 )

912  
l
;

913 
	}
}

916 
	gAVRBold
::
	$tAddss

addss
 )

919 if
addss
 < 0x10000 ) {

920 
comm
->
	`ndBy
( 'A' );

921 
comm
->
	`ndBy
(
addss
 >> 8) & 0xff );

922 
comm
->
	`ndBy

addss
 & 0xff );

923 
comm
->
	`ushTX
();

925 
comm
->
	`ndBy
( 'H' );

926 
comm
->
	`ndBy
(
addss
 >> 16) & 0xff );

927 
comm
->
	`ndBy
(
addss
 >> 8) & 0xff );

928 
comm
->
	`ndBy

addss
 & 0xff );

929 
comm
->
	`ushTX
();

933 if
comm
->
	`gBy
() != '\r' ) {

934 
throw
 
w
 
	`EMsg
( "Settingddress forrogramming operations failed! "

937 
	}
}

940 
	gAVRBold
::
	$wreFshLowBy

vue
 )

942 
comm
->
	`ndBy
( 'c' );

943 
comm
->
	`ndBy

vue
 );

944 
comm
->
	`ushTX
();

946 if
comm
->
	`gBy
() != '\r' )

947 
throw
 
w
 
	`EMsg
( "Writing Flashow byte failed! "

949 
	}
}

952 
	gAVRBold
::
	$wreFshHighBy

vue
 )

954 
comm
->
	`ndBy
( 'C' );

955 
comm
->
	`ndBy

vue
 );

956 
comm
->
	`ushTX
();

958 if
comm
->
	`gBy
() != '\r' )

959 
throw
 
w
 
	`EMsg
( "Writing Flash high byte failed! "

961 
	}
}

964 
	gAVRBold
::
	$wreFshPage
()

966 
comm
->
	`ndBy
( 'm' );

967 
comm
->
	`ushTX
();

969 if
comm
->
	`gBy
() != '\r' )

970 
throw
 
w
 
	`EMsg
( "Writing Flashage failed! "

972 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/AVRBootloader.hpp

23 #ide
AVRBOOTLOADER_HPP


24 
	#AVRBOOTLOADER_HPP


	)

26 
usg
 
mea
 
	gd
;

28 
	~"AVRProgmm.h
"

29 
	~"Uty.h
"

31 as
	cAVRBold
 : 
public
 
AVRProgmm


33 
eed
:

34 
vtu
 
tAddss

addss
 );

35 
vtu
 
wreFshLowBy

vue
 );

36 
vtu
 
wreFshHighBy

vue
 );

37 
vtu
 
wreFshPage
();

39 
vtu
 
bo
 
wreFshBlock

HEXFe
 * 
da
 );

40 
vtu
 
bo
 
adFshBlock

HEXFe
 * 
da
 );

41 
vtu
 
bo
 
wreEEPROMBlock

HEXFe
 * 
da
 );

42 
vtu
 
bo
 
adEEPROMBlock

HEXFe
 * 
da
 );

44 
	mpublic
:

46 
AVRBold

CommChl
 * 
_comm
 );

49 ~
AVRBold
();

52 
vtu
 
bo
 
rProgmmgMode
();

53 
vtu
 
bo
 
aveProgmmgMode
();

55 
vtu
 
bo
 
chE
();

57 
vtu
 
bo
 
adOSCCAL

pos
, * 
vue
 );

58 
vtu
 
bo
 
adSigtu
* 
sig0
, * 
sig1
, * 
sig2
 );

59 
vtu
 
bo
 
checkSigtu

sig0
, 
sig1
, 
sig2
 );

61 
vtu
 
bo
 
wreFshBy

addss
, 
vue
 );

62 
vtu
 
bo
 
wreEEPROMBy

addss
, 
vue
 );

64 
vtu
 
bo
 
wreFsh

HEXFe
 * 
da
 );

65 
vtu
 
bo
 
adFsh

HEXFe
 * 
da
 );

67 
vtu
 
bo
 
wreEEPROM

HEXFe
 * 
da
 );

68 
vtu
 
bo
 
adEEPROM

HEXFe
 * 
da
 );

70 
vtu
 
bo
 
wreLockBs

bs
 );

71 
vtu
 
bo
 
adLockBs
* 
bs
 );

73 
vtu
 
bo
 
wreFuBs

bs
 );

74 
vtu
 
bo
 
adFuBs
* 
bs
 );

75 
vtu
 
bo
 
wreExndedFuBs

bs
 );

76 
vtu
 
bo
 
adExndedFuBs
* 
bs
 );

78 
vtu
 
bo
 
ogmmSoweVsi
* 
maj
, * 
m
 );

79 
vtu
 
bo
 
ogmmHdweVsi
* 
maj
, * 
m
 );

	@ports/bdk-atxx4-mstp/avrosp/AVRDevice.cpp

23 
	~"AVRDevi.h
"

27 
	gAVRDevi
::
	$AVRDevi
cڡ 
rg
 & 
_deviName
 ) :

28 
	$deviName

_deviName
 )

30 
ashSize
 =

31 
omSize
 = 0;

32 
hasFuBs
 = 
l
;

33 
hasExndedFuBs
 = 
l
;

34 
sigtu0
 =

35 
sigtu1
 =

36 
sigtu2
 = 0;

37 
gesize
 = -1;

38 
	}
}

42 
	gAVRDevi
::~
	$AVRDevi
()

45 
	}
}

48 
AVRDevi
::
adPamsFromAVRStudio

ve
<
rg
> & 
chth
 )

50 
rg
 
th
;

51 
rg
 
	gsigtu
;

52 
rg
 
	gche
;

54 #ide
NOREGISTRY


56 
	gy


58 
	gth
 = 
Ut
.
gRegiryVue
( "SOFTWARE\\Atmel\\AVRTools\\", "AVRToolsPath" );

59 
	gth
 += "\\PartDescriptionFiles";

60 
	gchth
.
push_back

th
 );

61 } 
tch

EMsg
 * 
e
 )

63 
de
 
	ge
;

68 
	gth
.
a
();

69 
	gi
;

70  
	gi
 = 0; i < 
	gchth
.
size
(); i++ )

72 
	gth
 = 
chth
[
i
] + "\\" + 
deviName
 + ".xml";

73 if
	gUt
.
feExis

th
 ) )

77 if
	gi
 =
chth
.
size
() )

78 
throw
 
w
 
EMsg
( "Device XML fileot found in searchath!" );

81 
	gUt
.
log
"Psg '" + 
th
 + "'...\r\n" );

82 
XMLFe
 
f

th
 );

84 
	gashSize
 = 
oi

f
.
gVue
"AVRPART\\MEMORY\\PROG_FLASH" ).
c_r
() );

85 
	gomSize
 = 
oi

f
.
gVue
"AVRPART\\MEMORY\\EEPROM" ).
c_r
() );

87 
	gche
 += "<AVRPART><MEMORY><PROG_FLASH>";

88 
	gche
 +
f
.
gVue
( "AVRPART\\MEMORY\\PROG_FLASH" );

89 
	gche
 += "</PROG_FLASH><EEPROM>";

90 
	gche
 +
f
.
gVue
( "AVRPART\\MEMORY\\EEPROM" );

91 
	gche
 += "</EEPROM>";

93 if
	gf
.
exis
( "AVRPART\\MEMORY\\BOOT_CONFIG" ) )

95 
	ggesize
 = 
oi

f
.
gVue
"AVRPART\\MEMORY\\BOOT_CONFIG\\PAGESIZE" ).
c_r
() );

96 
	ggesize
 <<= 1;

98 
	gche
 += "<BOOT_CONFIG><PAGESIZE>";

99 
	gche
 +
f
.
gVue
( "AVRPART\\MEMORY\\BOOT_CONFIG\\PAGESIZE" );

100 
	gche
 += "</PAGESIZE></BOOT_CONFIG>";

103 
	gche
 += "</MEMORY>";

105 if
	gf
.
exis
( "AVRPART\\FUSE" ) )

107 
	ghasFuBs
 = 
ue
;

109 
	gche
 += "<FUSE>";

111 if
	gf
.
exis
( "AVRPART\\FUSE\\EXTENDED" ) )

113 
	ghasExndedFuBs
 = 
ue
;

114 
	gche
 += "<EXTENDED></EXTENDED>";

117 
	gche
 += "</FUSE>";

120 
	gsigtu
 = 
f
.
gVue
( "AVRPART\\ADMIN\\SIGNATURE\\ADDR000" );

121 
	gsigtu
.
a
( 0, 1 );

122 
	gsigtu0
 = 
Ut
.
cvtHex

sigtu
 );

124 
	gsigtu
 = 
f
.
gVue
( "AVRPART\\ADMIN\\SIGNATURE\\ADDR001" );

125 
	gsigtu
.
a
( 0, 1 );

126 
	gsigtu1
 = 
Ut
.
cvtHex

sigtu
 );

128 
	gsigtu
 = 
f
.
gVue
( "AVRPART\\ADMIN\\SIGNATURE\\ADDR002" );

129 
	gsigtu
.
a
( 0, 1 );

130 
	gsigtu2
 = 
Ut
.
cvtHex

sigtu
 );

132 
	gche
 += "<ADMIN><SIGNATURE><ADDR000>";

133 
	gche
 +
f
.
gVue
( "AVRPART\\ADMIN\\SIGNATURE\\ADDR000" );

134 
	gche
 += "</ADDR000><ADDR001>";

135 
	gche
 +
f
.
gVue
( "AVRPART\\ADMIN\\SIGNATURE\\ADDR001" );

136 
	gche
 += "</ADDR001><ADDR002>";

137 
	gche
 +
f
.
gVue
( "AVRPART\\ADMIN\\SIGNATURE\\ADDR002" );

138 
	gche
 += "</ADDR002></SIGNATURE></ADMIN></AVRPART>\r\n";

141 
	gUt
.
log
( "Saving cached XMLarameters...\r\n" );

142 
	gUt
.
veSg

che
, 
chth
[1] + "\\" + 
deviName
 + ".xml" );

146 
	gAVRDevi
::
	$gSigtu
* 
sig0
, * 
sig1
, * 
sig2
 )

148 if
sig0
 =
NULL
 || 
sig1
 =NULL || 
sig2
 == NULL )

149 
throw
 
w
 
	`EMsg
( "Cannot copy signature byteso NULL-pointers!" );

151 *
sig0
 = 
sigtu0
;

152 *
sig1
 = 
sigtu1
;

153 *
sig2
 = 
sigtu2
;

154 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/AVRDevice.hpp

23 #ide
AVRDEVICE_HPP


24 
	#AVRDEVICE_HPP


	)

26 
usg
 
mea
 
	gd
;

29 
	~<rg
>

30 
	~<ve
>

31 
	~"Uty.h
"

32 
	~"XMLPr.h
"

33 
	~"EMsg.h
"

35 as
	cAVRDevi


37 
	meed
:

38 
rg
 
deviName
;

40 
	mashSize
;

41 
	momSize
;

42 
bo
 
	mhasFuBs
;

43 
bo
 
	mhasExndedFuBs
;

44 
	msigtu0
;

45 
	msigtu1
;

46 
	msigtu2
;

47 
	mgesize
;

49 
	mpublic
:

51 
AVRDevi
cڡ 
rg
 & 
_deviName
 );

54 ~
AVRDevi
();

57 
adPamsFromAVRStudio

ve
<
rg
> & 
chth
 );

59 
	$gFshSize
({  
ashSize
; }

60 
	$gEEPROMSize
({  
omSize
; 
	}
}

61 
	$gPageSize
({  
gesize
; 
	}
}

62 
bo
 
	$gFuStus
({  
hasFuBs
; 
	}
}

63 
bo
 
	$gXFuStus
({  
hasExndedFuBs
; 
	}
}

65 
gSigtu
* 
sig0
, * 
sig1
, * 
sig2
 );

	@ports/bdk-atxx4-mstp/avrosp/AVRInSystemProg.cpp

22 
	~"AVRInSyemProg.h
"

24 
	~<sam
>

25 
	~<iom
>

27 
	#MEM_PROGRESS_GRANULARITY
 256

28 

	)

31 
	gAVRInSyemProg
::
	$AVRInSyemProg

CommChl
 * 
_comm
 ) :

32 
AVRProgmm
::
	$AVRProgmm

_comm
 )

35 
	}
}

39 
AVRInSyemProg
::~
	$AVRInSyemProg
()

42 
	}
}

45 
bo
 
AVRInSyemProg
::
	$rProgmmgMode
()

48 
comm
->
	`ndBy
( 'T' );

49 
comm
->
	`ndBy
( 0x64 );

50 
comm
->
	`ushTX
();

53 if
comm
->
	`gBy
() != '\r' )

54 
throw
 
w
 
	`EMsg
( "Enteringrogramming mode failed! "

58 
comm
->
	`ndBy
( 'P' );

59 
comm
->
	`ushTX
();

62 if
comm
->
	`gBy
() != '\r' )

63 
throw
 
w
 
	`EMsg
( "Enteringrogramming mode failed! "

66  
ue
;

67 
	}
}

70 
bo
 
	gAVRInSyemProg
::
	$aveProgmmgMode
()

73 
comm
->
	`ndBy
( 'L' );

74 
comm
->
	`ushTX
();

77 if
comm
->
	`gBy
() != '\r' )

78 
throw
 
w
 
	`EMsg
( "Leavingrogramming mode failed! "

81  
ue
;

82 
	}
}

85 
bo
 
	gAVRInSyemProg
::
	$chE
()

88 
comm
->
	`ndBy
( 'e' );

89 
comm
->
	`ushTX
();

91 if
comm
->
	`gBy
() != '\r' )

92 
throw
 
w
 
	`EMsg
( "Chiprase failed! "

95  
ue
;

96 
	}
}

99 
bo
 
	gAVRInSyemProg
::
	$adOSCCAL

pos
, * 
vue
 )

102 
comm
->
	`ndBy
( '.' );

103 
comm
->
	`ndBy
( 0x38 );

104 
comm
->
	`ndBy
( 0x00 );

105 
comm
->
	`ndBy

pos
 );

106 
comm
->
	`ndBy
( 0x00 );

107 
comm
->
	`ushTX
();

109 *
vue
 = 
comm
->
	`gBy
();

111 if
comm
->
	`gBy
() != '\r' )

112 
throw
 
w
 
	`EMsg
( "OSCCAL valueeadout failed! "

115  
ue
;

116 
	}
}

119 
bo
 
	gAVRInSyemProg
::
	$adSigtu
* 
sig0
, * 
sig1
, * 
sig2
 )

122 
comm
->
	`ndBy
( 's' );

123 
comm
->
	`ushTX
();

126 *
sig2
 = 
comm
->
	`gBy
();

127 *
sig1
 = 
comm
->
	`gBy
();

128 *
sig0
 = 
comm
->
	`gBy
();

129 
	}
}

132 
bo
 
	gAVRInSyemProg
::
	$checkSigtu

sig0
, 
sig1
, 
sig2
 )

134 
sig
[3];

137 
	`adSigtu

sig
, sig+1, sig+2 );

140 if
sig
[0] !
sig0
 || sig[1] !
sig1
 || sig[2] !
sig2
 )

142 
orgam
 
msg
;

143 
msg
 << "Signature doesot match selected device! ";

144 
msg
 << "Au sigtu: (" << 
hex


145 << "0x" << 
	`tw
(2<< 
sig
[0] << " "

146 << "0x" << 
	`tw
(2<< 
sig
[1] << " "

147 << "0x" << 
	`tw
(2<< 
sig
[2] << ") "

148 << "Sigtu from XML-fe: (" << 
hex


149 << "0x" << 
	`tw
(2<< 
sig0
 << " "

150 << "0x" << 
	`tw
(2<< 
sig1
 << " "

151 << "0x" << 
	`tw
(2<< 
sig2
 << ").";

153 
throw
 
w
 
	`EMsg

msg
.
	`r
() );

156  
ue
;

157 
	}
}

160 
bo
 
	gAVRInSyemProg
::
	$wreFshBy

addss
, 
vue
 )

162 if
addss
 >= 0x20000 )

163 
throw
 
w
 
	`EMsg
( "Flashddressesbove 128kre currentlyot supported!" );

165 
	`tAddss

addss
 >> 1 );

168 if
addss
 & 0x01 )

169 
vue
 = (value << 8) | 0x00ff;

171 
vue
 |= 0xff00;

174 
	`wreFshLowBy

vue
 & 0xff );

175 
	`wreFshHighBy

vue
 >> 8 );

178 if
gesize
 != -1 )

180 
	`tAddss

addss
 >> 1 );

181 
	`wreFshPage
();

184  
ue
;

185 
	}
}

188 
bo
 
	gAVRInSyemProg
::
	$wreEEPROMBy

addss
, 
vue
 )

190 if
addss
 >= 0x10000 )

191 
throw
 
w
 
	`EMsg
( "EEPROMddressesbove 64kre currentlyot supported!" );

193 
	`tAddss

addss
 );

196 
comm
->
	`ndBy
( 'D' );

197 
comm
->
	`ndBy

vue
 );

198 
comm
->
	`ushTX
();

201 if
comm
->
	`gBy
() != '\r' )

202 
throw
 
w
 
	`EMsg
( "Writing byteo EEPROM failed! "

205  
ue
;

206 
	}
}

209 
bo
 
	gAVRInSyemProg
::
	$wreFsh

HEXFe
 * 
da
 )

211 
t
, 
d
;

212 
bo
 
autoemt
;

213 
addss
;

216 if
gesize
 == -1 )

217 
throw
 
w
 
	`EMsg
( "Programmeragesize isot set!" );

220 
t
 = 
da
->
	`gRgeS
();

221 
d
 = 
da
->
	`gRgeEnd
();

224 
comm
->
	`ndBy
( 'a' );

225 
comm
->
	`ushTX
();

227 if
comm
->
	`gBy
() == 'Y' )

228 
autoemt
 = 
ue
;

230 
autoemt
 = 
l
;

233 
	`tAddss

t
 >> 1 );

236 
addss
 = 
t
;

237 if
addss
 & 1 )

240 
	`wreFshLowBy
( 0xff );

241 
	`wreFshHighBy

da
->
	`gDa

addss
 ) );

243 
addss
++;

246 if
gesize
 != -1 )

248 if!(
addss
 % 
gesize
) )

250 
	`tAddss
(
addss
-1) >> 1 );

251 
	`wreFshPage
();

252 
	`tAddss

addss
 >> 1 );

261 if!
autoemt
 )

262 
	`tAddss

addss
 >> 1 );

265 
	`wreFshLowBy

da
->
	`gDa

addss
 ) );

266 
	`wreFshHighBy

da
->
	`gDa

addss
+1 ) );

268 
addss
 += 2;

270 if(
addss
 % 
MEM_PROGRESS_GRANULARITY
) == 0 )

271 
Ut
.
	`ogss
( "#" );

274 if
gesize
 != -1 )

276 if(
addss
 % 
gesize
) == 0 )

278 
	`tAddss
(
addss
-2) >> 1 );

279 
	`wreFshPage
();

280 
	`tAddss

addss
 >> 1 );

283 }  
addss
 < 
d
 );

286 if
addss
 =
d
 )

289 
	`wreFshLowBy

da
->
	`gDa

addss
 ) );

290 
	`wreFshHighBy
( 0xff );

294 if
gesize
 != -1 )

296 if
addss
 =
d
 ||

297 (
d
+1)%
gesize
 != 0 )

299 
	`tAddss
(
addss
-2) >> 1 );

300 
	`wreFshPage
();

304 
Ut
.
	`ogss
( "\r\n" );

305  
ue
;

306 
	}
}

309 
bo
 
	gAVRInSyemProg
::
	$adFsh

HEXFe
 * 
da
 )

311 
t
, 
d
;

312 
bo
 
autoemt
;

313 
addss
;

315 if
gesize
 == -1 )

316 
throw
 
w
 
	`EMsg
( "Programmeragesize isot set!" );

319 
t
 = 
da
->
	`gRgeS
();

320 
d
 = 
da
->
	`gRgeEnd
();

323 
comm
->
	`ndBy
( 'a' );

324 
comm
->
	`ushTX
();

326 if
comm
->
	`gBy
() == 'Y' )

327 
autoemt
 = 
ue
;

329 
autoemt
 = 
l
;

332 
	`tAddss

t
 >> 1 );

335 
addss
 = 
t
;

336 if
addss
 & 1 )

339 
comm
->
	`ndBy
( 'R' );

340 
comm
->
	`ushTX
();

342 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

343 
comm
->
	`gBy
();

345 
addss
++;

352 if!
autoemt
 )

353 
	`tAddss

addss
 >> 1 );

356 
comm
->
	`ndBy
( 'R' );

357 
comm
->
	`ushTX
();

359 
da
->
	`tDa

addss
+1, 
comm
->
	`gBy
() );

360 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

362 
addss
 += 2;

364 if(
addss
 % 
MEM_PROGRESS_GRANULARITY
) == 0 )

365 
Ut
.
	`ogss
( "#" );

367 }  
addss
 < 
d
 );

370 if
addss
 =
d
 )

373 
comm
->
	`ndBy
( 'R' );

374 
comm
->
	`ushTX
();

376 
comm
->
	`gBy
();

377 
da
->
	`tDa

addss
-1, 
comm
->
	`gBy
() );

380 
Ut
.
	`ogss
( "\r\n" );

381  
ue
;

382 
	}
}

385 
bo
 
	gAVRInSyemProg
::
	$wreEEPROM

HEXFe
 * 
da
 )

387 
t
, 
d
;

388 
bo
 
autoemt
;

389 
addss
;

392 
t
 = 
da
->
	`gRgeS
();

393 
d
 = 
da
->
	`gRgeEnd
();

396 
comm
->
	`ndBy
( 'a' );

397 
comm
->
	`ushTX
();

399 if
comm
->
	`gBy
() == 'Y' )

400 
autoemt
 = 
ue
;

402 
autoemt
 = 
l
;

405 
	`tAddss

t
 );

408 
addss
 = 
t
;

412 if!
autoemt
 )

413 
	`tAddss

addss
 );

416 
comm
->
	`ndBy
( 'D' );

417 
comm
->
	`ndBy

da
->
	`gDa

addss
 ) );

418 
comm
->
	`ushTX
();

420 if
comm
->
	`gBy
() != '\r' )

421 
throw
 
w
 
	`EMsg
( "Writing byteo EEPROM failed! "

424 if(
addss
 % 
MEM_PROGRESS_GRANULARITY
) == 0 )

425 
Ut
.
	`ogss
( "#" );

427 
addss
++;

428 }  
addss
 <
d
 );

430 
Ut
.
	`ogss
( "\r\n" );

431  
ue
;

432 
	}
}

435 
bo
 
	gAVRInSyemProg
::
	$adEEPROM

HEXFe
 * 
da
 )

437 
t
, 
d
;

438 
bo
 
autoemt
;

439 
addss
;

442 
t
 = 
da
->
	`gRgeS
();

443 
d
 = 
da
->
	`gRgeEnd
();

446 
comm
->
	`ndBy
( 'a' );

447 
comm
->
	`ushTX
();

449 if
comm
->
	`gBy
() == 'Y' )

450 
autoemt
 = 
ue
;

452 
autoemt
 = 
l
;

455 
	`tAddss

t
 );

458 
addss
 = 
t
;

462 if!
autoemt
 )

463 
	`tAddss

addss
 );

466 
comm
->
	`ndBy
( 'd' );

467 
comm
->
	`ushTX
();

469 
da
->
	`tDa

addss
, 
comm
->
	`gBy
() );

471 if(
addss
 % 
MEM_PROGRESS_GRANULARITY
) == 0 )

472 
Ut
.
	`ogss
( "#" );

474 
addss
++;

475 }  
addss
 <
d
 );

477 
Ut
.
	`ogss
( "\r\n" );

478  
ue
;

479 
	}
}

482 
bo
 
	gAVRInSyemProg
::
	$wreLockBs

bs
 )

485 
comm
->
	`ndBy
( '.' );

486 
comm
->
	`ndBy
( 0xac );

487 
comm
->
	`ndBy
( 0xe0 );

488 
comm
->
	`ndBy
( 0x00 );

489 
comm
->
	`ndBy

bs
 );

491 
comm
->
	`ushTX
();

492 
comm
->
	`gBy
();

494 if
comm
->
	`gBy
() != '\r' )

495 
throw
 
w
 
	`EMsg
( "Writingock bits failed! "

498  
ue
;

499 
	}
}

502 
bo
 
	gAVRInSyemProg
::
	$adLockBs
* 
bs
 )

505 
comm
->
	`ndBy
( '.' );

506 
comm
->
	`ndBy
( 0x58 );

507 
comm
->
	`ndBy
( 0x00 );

508 
comm
->
	`ndBy
( 0x00 );

509 
comm
->
	`ndBy
( 0x00 );

510 
comm
->
	`ushTX
();

512 *
bs
 = 
comm
->
	`gBy
();

514 if
comm
->
	`gBy
() != '\r' )

515 
throw
 
w
 
	`EMsg
( "Lock byteeadout failed! "

518  
ue
;

519 
	}
}

522 
bo
 
	gAVRInSyemProg
::
	$wreFuBs

bs
 )

525 
comm
->
	`ndBy
( '.' );

526 
comm
->
	`ndBy
( 0xac );

527 
comm
->
	`ndBy
( 0xa0 );

528 
comm
->
	`ndBy
( 0x00 );

529 
comm
->
	`ndBy

bs
 & 0xff );

530 
comm
->
	`ushTX
();

532 
comm
->
	`gBy
();

534 if
comm
->
	`gBy
() != '\r' )

535 
throw
 
w
 
	`EMsg
( "Low fuse byterogramming failed! "

539 
comm
->
	`ndBy
( '.' );

540 
comm
->
	`ndBy
( 0xac );

541 
comm
->
	`ndBy
( 0xa8 );

542 
comm
->
	`ndBy
( 0x00 );

543 
comm
->
	`ndBy

bs
 >> 8 );

544 
comm
->
	`ushTX
();

546 
comm
->
	`gBy
();

548 if
comm
->
	`gBy
() != '\r' )

549 
throw
 
w
 
	`EMsg
( "High fuse byterogramming failed! "

552  
ue
;

553 
	}
}

556 
bo
 
	gAVRInSyemProg
::
	$adFuBs
* 
bs
 )

558 
low
, 
high
;

561 
comm
->
	`ndBy
( '.' );

562 
comm
->
	`ndBy
( 0x50 );

563 
comm
->
	`ndBy
( 0x00 );

564 
comm
->
	`ndBy
( 0x00 );

565 
comm
->
	`ndBy
( 0x00 );

566 
comm
->
	`ushTX
();

568 
low
 = 
comm
->
	`gBy
();

570 if
comm
->
	`gBy
() != '\r' )

571 
throw
 
w
 
	`EMsg
( "Low fuse byteeadout failed! "

575 
comm
->
	`ndBy
( '.' );

576 
comm
->
	`ndBy
( 0x58 );

577 
comm
->
	`ndBy
( 0x08 );

578 
comm
->
	`ndBy
( 0x00 );

579 
comm
->
	`ndBy
( 0x00 );

580 
comm
->
	`ushTX
();

582 
high
 = 
comm
->
	`gBy
();

584 if
comm
->
	`gBy
() != '\r' )

585 
throw
 
w
 
	`EMsg
( "Low fuse byteeadout failed! "

589 *
bs
 = (
high
 << 8| 
low
;

591  
ue
;

592 
	}
}

595 
bo
 
	gAVRInSyemProg
::
	$wreExndedFuBs

bs
 )

598 
comm
->
	`ndBy
( '.' );

599 
comm
->
	`ndBy
( 0xac );

600 
comm
->
	`ndBy
( 0xa4 );

601 
comm
->
	`ndBy
( 0x00 );

602 
comm
->
	`ndBy

bs
 );

603 
comm
->
	`ushTX
();

605 
comm
->
	`gBy
();

607 if
comm
->
	`gBy
() != '\r' )

608 
throw
 
w
 
	`EMsg
( "Extended fuse byterogramming failed! "

611  
ue
;

612 
	}
}

615 
bo
 
	gAVRInSyemProg
::
	$adExndedFuBs
* 
bs
 )

618 
comm
->
	`ndBy
( '.' );

619 
comm
->
	`ndBy
( 0x50 );

620 
comm
->
	`ndBy
( 0x08 );

621 
comm
->
	`ndBy
( 0x00 );

622 
comm
->
	`ndBy
( 0x00 );

623 
comm
->
	`ushTX
();

625 *
bs
 = 
comm
->
	`gBy
();

627 if
comm
->
	`gBy
() != '\r' )

628 
throw
 
w
 
	`EMsg
( "Extended fuse byteeadout failed! "

631  
ue
;

632 
	}
}

635 
bo
 
	gAVRInSyemProg
::
	$ogmmSoweVsi
* 
maj
, * 
m
 )

638 
comm
->
	`ndBy
( 'V' );

639 
comm
->
	`ushTX
();

642 *
maj
 = 
comm
->
	`gBy
();

643 *
m
 = 
comm
->
	`gBy
();

645  
ue
;

646 
	}
}

649 
bo
 
	gAVRInSyemProg
::
	$ogmmHdweVsi
* 
maj
, * 
m
 )

652 
comm
->
	`ndBy
( 'v' );

653 
comm
->
	`ushTX
();

656 *
maj
 = 
comm
->
	`gBy
();

657 *
m
 = 
comm
->
	`gBy
();

659  
ue
;

660 
	}
}

663 
	gAVRInSyemProg
::
	$tAddss

addss
 )

666 
comm
->
	`ndBy
( 'A' );

667 
comm
->
	`ndBy

addss
 >> 8 );

668 
comm
->
	`ndBy

addss
 & 0xff );

669 
comm
->
	`ushTX
();

672 if
comm
->
	`gBy
() != '\r' )

673 
throw
 
w
 
	`EMsg
( "Settingddress forrogramming operations failed! "

675 
	}
}

678 
	gAVRInSyemProg
::
	$wreFshLowBy

vue
 )

680 
comm
->
	`ndBy
( 'c' );

681 
comm
->
	`ndBy

vue
 );

682 
comm
->
	`ushTX
();

684 if
comm
->
	`gBy
() != '\r' )

685 
throw
 
w
 
	`EMsg
( "Writing Flashow byte failed! "

687 
	}
}

690 
	gAVRInSyemProg
::
	$wreFshHighBy

vue
 )

692 
comm
->
	`ndBy
( 'C' );

693 
comm
->
	`ndBy

vue
 );

694 
comm
->
	`ushTX
();

696 if
comm
->
	`gBy
() != '\r' )

697 
throw
 
w
 
	`EMsg
( "Writing Flash high byte failed! "

699 
	}
}

702 
	gAVRInSyemProg
::
	$wreFshPage
()

704 
comm
->
	`ndBy
( 'm' );

705 
comm
->
	`ushTX
();

707 if
comm
->
	`gBy
() != '\r' )

708 
throw
 
w
 
	`EMsg
( "Writing Flashage failed! "

710 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/AVRInSystemProg.hpp

22 #ide
AVRINSYSTEMPROG_HPP


23 
	#AVRINSYSTEMPROG_HPP


	)

25 
usg
 
mea
 
	gd
;

27 
	~"AVRProgmm.h
"

28 
	~"Uty.h
"

30 as
	cAVRInSyemProg
 : 
public
 
AVRProgmm


32 
eed
:

33 
tAddss

addss
 );

34 
wreFshLowBy

vue
 );

35 
wreFshHighBy

vue
 );

36 
wreFshPage
();

38 
	mpublic
:

40 
AVRInSyemProg

CommChl
 * 
_comm
 );

43 ~
AVRInSyemProg
();

46 
vtu
 
bo
 
rProgmmgMode
();

47 
vtu
 
bo
 
aveProgmmgMode
();

49 
vtu
 
bo
 
chE
();

51 
vtu
 
bo
 
adOSCCAL

pos
, * 
vue
 );

52 
vtu
 
bo
 
adSigtu
* 
sig0
, * 
sig1
, * 
sig2
 );

53 
vtu
 
bo
 
checkSigtu

sig0
, 
sig1
, 
sig2
 );

55 
vtu
 
bo
 
wreFshBy

addss
, 
vue
 );

56 
vtu
 
bo
 
wreEEPROMBy

addss
, 
vue
 );

58 
vtu
 
bo
 
wreFsh

HEXFe
 * 
da
 );

59 
vtu
 
bo
 
adFsh

HEXFe
 * 
da
 );

61 
vtu
 
bo
 
wreEEPROM

HEXFe
 * 
da
 );

62 
vtu
 
bo
 
adEEPROM

HEXFe
 * 
da
 );

64 
vtu
 
bo
 
wreLockBs

bs
 );

65 
vtu
 
bo
 
adLockBs
* 
bs
 );

67 
vtu
 
bo
 
wreFuBs

bs
 );

68 
vtu
 
bo
 
adFuBs
* 
bs
 );

69 
vtu
 
bo
 
wreExndedFuBs

bs
 );

70 
vtu
 
bo
 
adExndedFuBs
* 
bs
 );

72 
vtu
 
bo
 
ogmmSoweVsi
* 
maj
, * 
m
 );

73 
vtu
 
bo
 
ogmmHdweVsi
* 
maj
, * 
m
 );

	@ports/bdk-atxx4-mstp/avrosp/AVRProgrammer.cpp

24 
	~"AVRProgmm.h
"

28 
	gAVRProgmm
::
	$AVRProgmm

CommChl
 * 
_comm
 ) :

29 
	`gesize
( -1 )

31 if
_comm
 =
NULL
 )

32 
throw
 
w
 
	`EMsg
( "NULLointerrovided for communication channel!" );

34 
comm
 = 
_comm
;

35 
	}
}

39 
	gAVRProgmm
::~
	$AVRProgmm
()

42 
	}
}

45 
rg
 
AVRProgmm
::
	$adProgmmID

CommChl
 * 
_comm
 )

47 
rg
 
	`id
( "1234567" );

49 if
_comm
 =
NULL
 )

50 
throw
 
w
 
	`EMsg
( "NULLointerrovided for communication channel!" );

53  
i
 = 0; i < 10; i++ )

54 
_comm
->
	`ndBy
( 27 );

57 
_comm
->
	`ndBy
( 'S' );

58 
_comm
->
	`ushTX
();

61  
i
 = 0; i < 
id
.
	`size
(); i++ )

63 
id
[
i
] = 
_comm
->
	`gBy
();

66  
id
;

67 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/AVRProgrammer.hpp

24 #ide
AVRPROGRAMMER_HPP


25 
	#AVRPROGRAMMER_HPP


	)

27 
usg
 
mea
 
	gd
;

29 
	~"EMsg.h
"

30 
	~"HEXPr.h
"

31 
	~"CommChl.h
"

33 as
	cAVRProgmm


35 
	meed
:

36 
gesize
;

37 
CommChl
 * 
	mcomm
;

39 
	mpublic
:

41 
AVRProgmm

CommChl
 * 
_comm
 );

44 ~
AVRProgmm
();

47 
rg
 
adProgmmID

CommChl
 * 
_comm
 );

50 
	$tPagesize

_gesize
 ) { 
gesize
 = _pagesize; }

52 
vtu
 
bo
 
	`rProgmmgMode
() = 0;

53 
vtu
 
bo
 
	`aveProgmmgMode
() = 0;

55 
vtu
 
bo
 
	`chE
() = 0;

57 
vtu
 
bo
 
	`adOSCCAL

pos
, * 
vue
 ) = 0;

58 
vtu
 
bo
 
	`adSigtu
* 
sig0
, * 
sig1
, * 
sig2
 ) = 0;

59 
vtu
 
bo
 
	`checkSigtu

sig0
, 
sig1
, 
sig2
 ) = 0;

61 
vtu
 
bo
 
	`wreFshBy

addss
, 
vue
 ) = 0;

62 
vtu
 
bo
 
	`wreEEPROMBy

addss
, 
vue
 ) = 0;

64 
vtu
 
bo
 
	`wreFsh

HEXFe
 * 
da
 ) = 0;

65 
vtu
 
bo
 
	`adFsh

HEXFe
 * 
da
 ) = 0;

67 
vtu
 
bo
 
	`wreEEPROM

HEXFe
 * 
da
 ) = 0;

68 
vtu
 
bo
 
	`adEEPROM

HEXFe
 * 
da
 ) = 0;

70 
vtu
 
bo
 
	`wreLockBs

bs
 ) = 0;

71 
vtu
 
bo
 
	`adLockBs
* 
bs
 ) = 0;

73 
vtu
 
bo
 
	`wreFuBs

bs
 ) = 0;

74 
vtu
 
bo
 
	`adFuBs
* 
bs
 ) = 0;

75 
vtu
 
bo
 
	`wreExndedFuBs

bs
 ) = 0;

76 
vtu
 
bo
 
	`adExndedFuBs
* 
bs
 ) = 0;

78 
vtu
 
bo
 
	`ogmmSoweVsi
* 
maj
, * 
m
 ) = 0;

79 
vtu
 
bo
 
	`ogmmHdweVsi
* 
maj
, * 
m
 ) = 0;

80 
	}
};

	@ports/bdk-atxx4-mstp/avrosp/CommChannel.cpp

28 
	~"CommChl.h
"

32 
	gCommChl
::~
	$CommChl
()

35 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/CommChannel.hpp

28 #ide
COMMCHANNEL_HPP


29 
	#COMMCHANNEL_HPP


	)

31 
usg
 
mea
 
	gd
;

33 as
	cCommChl


35 
	mpublic
:

37 
vtu
 ~
CommChl
() = 0;

40 
vtu
 
ݒChl
() = 0;

43 
vtu
 
oChl
() = 0;

46 
vtu
 
ndBy

da
 ) = 0;

49 
vtu
 
gBy
() = 0;

52 
vtu
 
ushTX
() = 0;

55 
vtu
 
ushRX
() = 0;

58 
vtu
 
ndMuɝ
* 
da
, 
bufsize
 ) = 0;

	@ports/bdk-atxx4-mstp/avrosp/ErrorMsg.cpp

22 
	~"EMsg.h
"

25 
	gEMsg
::
	$EMsg
cڡ 
rg
 & 
_mesge
 ) :

26 
	$mesge

_mesge
 )

29 
	}
}

33 
EMsg
::~
	$EMsg
()

36 
	}
}

40 cڡ 
rg
 & 
EMsg
::
	$Wh
()

42  
mesge
;

43 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/ErrorMsg.hpp

22 #ide
ERRORMSG_HPP


23 
	#ERRORMSG_HPP


	)

25 
usg
 
mea
 
	gd
;

27 
	~<dlib.h
>

28 
	~<ioam
>

29 
	~<rg
>

32 as
	cEMsg


34 
	meed
:

35 
rg
 
mesge
;

37 
	mpublic
:

39 
EMsg
cڡ 
rg
 & 
_mesge
 );

42 ~
EMsg
();

45 
vtu
 cڡ 
	mrg
 & 
Wh
();

	@ports/bdk-atxx4-mstp/avrosp/HEXParser.cpp

21 
	~"HEXPr.h
"

25 
	sHEXRecd


27 
	mngth
;

28 
	mofft
;

29 
	mty
;

30 * 
	mda
;

34 
	gHEXFe
::
	$wreRecd

ofam
 & 
f
, 
HEXRecd
 * 

 )

36 
checksum
;

37 
cdPos
;

40 
checksum
 = 

->
ngth
;

41 
checksum
 +(((

->
offt
 >> 8) & 0xff);

42 
checksum
 +((

->
offt
 & 0xff);

43 
checksum
 +

->
ty
;

46 
f
.
	`fl
('0');

47 
f
 << ":" << 
hex


48 << 
	`tw
(2<< (

->
ngth


49 << 
	`tw
(4<< (

->
offt


50 << 
	`tw
(2<< (

->
ty
;

53  
cdPos
 = 0;ecdPo< 

->
ngth
;ecordPos++ )

55 
checksum
 +

->
da
[ 
cdPos
 ];

56 
f
 << 
hex
 << 
	`tw
(2<< (

->
da
[ 
cdPos
 ];

60 
checksum
 = 0 - checksum;

61 
f
 << 
	`tw
(2<< (
checksum
 << 
dl
;

64 if!
f
.
	`good
() )

65 
throw
 
w
 
	`EMsg
( "Error writing HEXecordo file!" );

66 
	}
}

69 
	gHEXFe
::
	$rRecd
cڡ 
rg
 & 
hexLe
, 
HEXRecd
 * 

 )

71 
checksum
;

72 
cdPos
;

74 if
hexLe
.
	`size
() < 11 )

75 
throw
 
w
 
	`EMsg
( "Wrong HEX file format, missing fields! "

76 "Lom fwas: (" + 
hexLe
 + ")." );

79 if
hexLe
[0] != ':' )

80 
throw
 
w
 
	`EMsg
( "Wrong HEX file format, doesot start with colon! "

81 "Lom fwas: (" + 
hexLe
 + ")." );

84 

->
ngth
 = 
Ut
.
	`cvtHex

hexLe
.
	`subr
( 1, 2 ) );

85 

->
offt
 = 
Ut
.
	`cvtHex

hexLe
.
	`subr
( 3, 4 ) );

86 

->
ty
 = 
Ut
.
	`cvtHex

hexLe
.
	`subr
( 7, 2 ) );

89 if
hexLe
.
	`size
(< (11+

->
ngth
*2) )

90 
throw
 
w
 
	`EMsg
( "Wrong HEX file format, missing fields! "

91 "Lom fwas: (" + 
hexLe
 + ")." );

94 
checksum
 = 

->
ngth
;

95 
checksum
 +(((

->
offt
 >> 8) & 0xff);

96 
checksum
 +((

->
offt
 & 0xff);

97 
checksum
 +

->
ty
;

100 if

->
ngth
 )

102 

->
da
 = 
w
 [e->
ngth
 ];

105  
cdPos
 = 0;ecdPo< 

->
ngth
;ecordPos++ )

107 

->
da
[ 
cdPos
 ] = 
Ut
.
	`cvtHex

hexLe
.
	`subr
( 9 +ecordPos*2, 2 ) );

108 
checksum
 +

->
da
[ 
cdPos
 ];

113 
checksum
 +
Ut
.
	`cvtHex

hexLe
.
	`subr
9 + 

->
ngth
*2, 2 ) );

114 if
checksum
 != 0 )

116 
throw
 
w
 
	`EMsg
( "Wrong checksum for HEXecord! "

117 "Lom fwas: (" + 
hexLe
 + ")." );

119 
	}
}

124 
	gHEXFe
::
	$HEXFe

bufrsize
, 
vue
 )

126 if
bufrsize
 <= 0 )

127 
throw
 
w
 
	`EMsg
( "Cannot have zero-size HEX buffer!" );

129 
da
 = 
w
 [ 
bufrsize
 ];

131 if!
da
 )

132 
throw
 
w
 
	`EMsg
( "Memoryllocation failed for HEX-line-buffer!" );

134 
size
 = 
bufrsize
;

136 
	`rA

vue
 );

137 
	}
}

141 
	gHEXFe
::~
	$HEXFe
()

143 if
da
 ) 
de
 data;

144 
	}
}

147 
	gHEXFe
::
	$adFe
cڡ 
rg
 & 
_fame
 )

149 
ifam
 
f
;

150 
rg
 
hexLe
;

151 
HEXRecd
 
c
;

153 
baAddss
;

154 
daPos
;

157 
f
.
	`ݒ

_fame
.
	`c_r
(), 
ios
::

 );

158 if!
f
 )

159 
throw
 
w
 
	`EMsg
( "Error opening HEX file for input!" );

162 
baAddss
 = 0;

163 
t
 = 
size
;

164 
d
 = 0;

167 
f
 >> 
hexLe
;

168  !
f
.
	`eof
() )

170 
Ut
.
	`ogss
( "#" );

173 
	`rRecd

hexLe
, &
c
 );

175  
c
.
ty
 )

179 if
baAddss
 + 
c
.
offt
 +ec.
ngth
 > 
size
 )

180 
throw
 
w
 
	`EMsg
( "HEX file defines data outside bufferimits! "

183 "Lom fwas: (" + 
hexLe
 + ")." );

185  
daPos
 = 0; daPo< 
c
.
ngth
; dataPos++ )

186 
da
[ 
baAddss
 + 
c
.
offt
 + 
daPos
 ] =ec.data[ dataPos ];

189 if
baAddss
 + 
c
.
offt
 < 
t
 )

190 
t
 = 
baAddss
 + 
c
.
offt
;

192 if
baAddss
 + 
c
.
offt
 +ec.
ngth
 - 1 > 
d
 )

193 
d
 = 
baAddss
 + 
c
.
offt
 +ec.
ngth
 - 1;

199 
baAddss
 = (
c
.
da
[0] << 8) |ec.data[1];

200 
baAddss
 <<= 4;

207 
baAddss
 = (
c
.
da
[0] << 8) |ec.data[1];

208 
baAddss
 <<= 16;

215 
f
.
	`o
();

216 
Ut
.
	`ogss
( "\r\n" );

220 
throw
 
w
 
	`EMsg
( "Unsupported HEXecord format! "

221 "Lom fwas: (" + 
hexLe
 + ")." );

224 
f
 >> 
hexLe
;

229 
throw
 
w
 
	`EMsg
( "Prematurend of filencountered! Make sure file "

231 
	}
}

234 
	gHEXFe
::
	$wreFe
cڡ 
rg
 & 
_fame
 )

236 
ofam
 
f
;

237 
HEXRecd
 
c
;

239 
baAddss
;

240 
offt
;

241 
daPos
;

245 
_f
,

246 
_wrg
,

247 
_sd64k


248 } 
us
;

251 
f
.
	`ݒ

_fame
.
	`c_r
(), 
ios
::
out
 );

252 if!
f
 )

253 
throw
 
w
 
	`EMsg
( "Error opening HEX file for output!" );

256 
us
 = 
_f
;

257 
c
.
da
 = 
w
 [ 16 ];

259 
baAddss
 = 
t
 & ~0xffff;

260 
offt
 = 
t
 & 0xffff;

261 
daPos
 = 0;

264 
c
.
ngth
 = 2;

265 
c
.
offt
 = 0;

266 
c
.
ty
 = 0x02;

267 
c
.
da
[1] = 0x00;

268 
c
.
da
[0] = 
baAddss
 >> 12;

269 
	`wreRecd

f
, &
c
 );

276 
c
.
da
[ 
daPos
 ] = da[ 
baAddss
 + 
offt
 + dataPos ];

277 
daPos
++;

280 if
offt
 + 
daPos
 >= 0x10000 ||

281 
daPos
 >= 16 ||

282 
baAddss
 + 
offt
 + 
daPos
 > 
d
 )

285 
c
.
ngth
 = 
daPos
;

286 
c
.
offt
 = offset;

287 
c
.
ty
 = 0x00;

289 
Ut
.
	`ogss
( "#" );

290 
	`wreRecd

f
, &
c
 );

292 
offt
 +
daPos
;

293 
daPos
 = 0;

297 if
offt
 + 
daPos
 >= 0x10000 )

300 
offt
 -= 0x10000;

301 
baAddss
 += 0x10000;

304 
c
.
ngth
 = 2;

305 
c
.
offt
 = 0;

306 
c
.
ty
 = 0x02;

307 
c
.
da
[0] = 
baAddss
 >> 12;

308 
c
.
da
[1] = 0x00;

310 
	`wreRecd

f
, &
c
 );

312 }  
baAddss
 + 
offt
 + 
daPos
 <
d
 );

316 
c
.
ngth
 = 0;

317 
c
.
offt
 = 0;

318 
c
.
ty
 = 0x01;

320 
	`wreRecd

f
, &
c
 );

322 
f
.
	`o
();

323 
Ut
.
	`ogss
( "\r\n" );

324 
	}
}

327 
	gHEXFe
::
	$tUdRge

_t
, 
_d
 )

329 if
_t
 < 0 || 
_d
 >
size
 || _start > _end )

330 
throw
 
w
 
	`EMsg
( "Invalidange! Start must be 0 orarger,nd must be "

333 
t
 = 
_t
;

334 
d
 = 
_d
;

335 
	}
}

338 
	gHEXFe
::
	$rA

vue
 )

340  
i
 = 0; i < 
size
; i++ )

341 
da
[
i
] = ((
vue
 & 0xff);

342 
	}
}

345 
	gHEXFe
::
	$gDa

addss
 )

347 if
addss
 < 0 ||dds>
size
 )

348 
throw
 
w
 
	`EMsg
( "Address outsideegalange!" );

350  
da
[ 
addss
 ];

351 
	}
}

354 
	gHEXFe
::
	$tDa

addss
, 
vue
 )

356 if
addss
 < 0 ||dds>
size
 )

357 
throw
 
w
 
	`EMsg
( "Address outsideegalange!" );

359 
da
[ 
addss
 ] = ((
vue
 & 0xff);

360 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/HEXParser.hpp

21 #ide
HEXPARSER_HPP


22 
	#HEXPARSER_HPP


	)

24 
usg
 
mea
 
	gd
;

26 
	~"EMsg.h
"

27 
	~"Uty.h
"

28 
	~<ioam
>

29 
	~<fam
>

30 
	~<iom
>

32 
	gHEXRecd
;

34 as
	cHEXFe


36 
	meed
:

37 * 
da
;

38 
	mt
, 
	md
;

39 
	msize
;

41 
wreRecd

ofam
 & 
f
, 
HEXRecd
 * 

 );

42 
rRecd
cڡ 
rg
 & 
hexLe
, 
HEXRecd
 * 

 );

44 
	mpublic
:

46 
HEXFe

bufrsize
, 
vue
 = 0xff );

49 ~
HEXFe
();

52 
adFe
cڡ 
rg
 & 
_fame
 );

53 
wreFe
cڡ 
rg
 & 
_fame
 );

55 
tUdRge

_t
, 
_d
 );

56 
rA

vue
 = 0xff );

58 
	$gRgeS
({  
t
; }

59 
	$gRgeEnd
({  
d
; 
	}
}

60 
gDa

addss
 );

61 
tDa

addss
, 
vue
 );

62 
	$gSize
({  
size
; 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/JobInfo.cpp

22 
	~"JobInfo.h
"

24 
	~<cio.h
>

26 
	#VERSIONSTRING
 "$Revision: 1163 $"

27 

	)

28 
	#TIMEOUT
 5

	)

29 
	#TIMEOUTSTRING
 "5"

	)

32 
	gJobInfo
::
	$JobInfo
()

35 
showHp
 = 
l
;

36 
stMode
 = 
l
;

37 
noProgssIndit
 = 
l
;

38 
adSigtu
 = 
l
;

39 
chE
 = 
l
;

40 
gHWvisi
 = 
l
;

41 
gSWvisi
 = 
l
;

42 
ogmFsh
 = 
l
;

43 
ogmEEPROM
 = 
l
;

44 
adFsh
 = 
l
;

45 
adEEPROM
 = 
l
;

46 
vifyFsh
 = 
l
;

47 
vifyEEPROM
 = 
l
;

48 
adLockBs
 = 
l
;

49 
adFuBs
 = 
l
;

50 
adOSCCAL
 = 
l
;

52 
deviName
.
	`a
();

53 
putFeFsh
.
	`a
();

54 
putFeEEPROM
.
	`a
();

55 
ouutFeFsh
.
	`a
();

56 
ouutFeEEPROM
.
	`a
();

58 
OSCCAL_Pam
 = -1;

59 
OSCCAL_FshAddss
 = -1;

60 
OSCCAL_EEPROMAddss
 = -1;

62 
ogmLockBs
 = -1;

63 
vifyLockBs
 = -1;

65 
ogmFuBs
 = -1;

66 
ogmExndedFuBs
 = -1;

67 
vifyFuBs
 = -1;

68 
vifyExndedFuBs
 = -1;

70 
memyFlP
 = -1;

72 
ashSAddss
 = -1;

73 
ashEndAddss
 = -1;

75 
omSAddss
 = -1;

76 
omEndAddss
 = -1;

78 
comPt
 = -1;

79 
	}
}

83 
	gJobInfo
::
	$rCommdle

gc
, *
gv
[] )

85 * 
m
;

86 
comma
;

89 
rg
 
owũh
 = 
gv
[0];

90 
ash_pos
 = 
owũh
.
	`fd_ϡ_of
( "\\/" );

91 if
ash_pos
 =
rg
::
os
 )

93 
owũh
.
	`assign
( "." );

96 
owũh
.
	`a

ash_pos
 );

99 
chth
.
	`push_back
( "." );

100 
chth
.
	`push_back

owũh
 );

102 if
gc
 <= 1 )

104 
showHp
 = 
ue
;

109  
i
 = 1; i < 
gc
; i++ )

111 
m
 = 
gv
[
i
];

114 if
m
[0] != '-' )

115 
throw
 
w
 
	`EMsg
( "Allarameters must start with '-'!" );

117 if
	`

m
 ) <= 1 )

118 
throw
 
w
 
	`EMsg
( "Parameters cannot be justhe minus withoutny characters!" );

121  
m
[1] )

124 if
	`

m
 ) <= 2 )

125 
throw
 
w
 
	`EMsg
( "Cannot use -a without memoryype!" );

127 if
	`

m
 ) <= 5 )

128 
throw
 
w
 
	`EMsg
( "Cannot use -a without startndndddress!" );

131 
comma
 = 2;

132  (
m
[
comma
] != 0) && (param[comma] != ',') )

133 
comma
++;

135 if
comma
 =
	`

m
 ) )

136 
throw
 
w
 
	`EMsg
( "No comma separator found in -aarameter!" );

138 
m
[
comma
] = 0;

141  
m
[2] )

144 
y


146 
ashSAddss
 = 
	`cvtHex

m
 + 3 );

148 
	`tch

EMsg
 * 
e
 )

150 
de
 
e
;

151 
throw
 
w
 
	`EMsg
( "Number formatrror in startimit for -afarameter!" );

154 
y


156 
ashEndAddss
 = 
	`cvtHex

m
 + 
comma
 + 1 );

158 
	`tch

EMsg
 * 
e
 )

160 
de
 
e
;

161 
throw
 
w
 
	`EMsg
( "Number formatrror inndimit for -afarameter!" );

164 if
ashEndAddss
 < 
ashSAddss
 )

165 
throw
 
w
 
	`EMsg
( "Cannot have Flashndimitesshan startimit!" );

170 
y


172 
omSAddss
 = 
	`cvtHex

m
 + 3 );

174 
	`tch

EMsg
 * 
e
 )

176 
de
 
e
;

177 
throw
 
w
 
	`EMsg
( "Number formatrror in startimit for -aearameter!" );

180 
y


182 
omEndAddss
 = 
	`cvtHex

m
 + 
comma
 + 1 );

184 
	`tch

EMsg
 * 
e
 )

186 
de
 
e
;

187 
throw
 
w
 
	`EMsg
( "Number formatrror inndimit for -aearameter!" );

190 if
omEndAddss
 < 
omSAddss
 )

191 
throw
 
w
 
	`EMsg
( "Cannot have EEPROMndimitesshan startimit!" );

196 
throw
 
w
 
	`EMsg
( "Unknown choice for -a, use -af or -ae!" );

204 if
	`

m
 ) != 3 )

205 
throw
 
w
 
	`EMsg
( "Specify SW og HWevision,ot just -b!" );

207  
m
[2] )

210 
gHWvisi
 = 
ue
;

214 
gSWvisi
 = 
ue
;

218 
throw
 
w
 
	`EMsg
( "Unknown choice for -b, use -bs or -bh!" );

225 i(
	`

m
 ) < 6 ) || (strlen(aram ) > 7) ||

226 (
m
[2] != 'C' ||aram[3] != 'O' ||aram[4] != 'M' ) ||

227 (
m
[5] < '1' ||aram[5] > '9')) {

228 
throw
 
w
 
	`EMsg
( "COMortarameter syntax is -cCOM1o -cCOM99" );

230 
comPt
 = 
m
[5] - '0';

231 i(
m
[6] != 0) {

232 
comPt
 = (comP܈* 10+ 
m
[6] - '0';

238 if
	`

m
 ) <= 2 )

239 
throw
 
w
 
	`EMsg
( "Cannot use -d withouthe deviceame!" );

242 
deviName
.
	`assign

m
 + 2 );

247 if
	`

m
 ) != 2 )

248 
throw
 
w
 
	`EMsg
( "Parameter -eeedsoxtrarguments!" );

250 
chE
 = 
ue
;

255 if
	`

m
 ) != 4 )

256 
throw
 
w
 
	`EMsg
( "Usewo hex digits forhe -Earameter!" );

258 
y


260 
ogmExndedFuBs
 = 
	`cvtHex

m
 + 2 );

262 
	`tch

EMsg
 * 
e
 )

264 
de
 
e
;

265 
throw
 
w
 
	`EMsg
( "Hexumber formatrror for -Earameter!" );

272 if
	`

m
 ) != 6 )

273 
throw
 
w
 
	`EMsg
( "Use four hex digits forhe -farameter!" );

275 
y


277 
ogmFuBs
 = 
	`cvtHex

m
 + 2 );

279 
	`tch

EMsg
 * 
e
 )

281 
de
 
e
;

282 
throw
 
w
 
	`EMsg
( "Hexumber formatrror for -farameter!" );

289 if
	`

m
 ) != 6 )

290 
throw
 
w
 
	`EMsg
( "Use four hex digits forhe -Farameter!" );

292 
y


294 
vifyFuBs
 = 
	`cvtHex

m
 + 2 );

296 
	`tch

EMsg
 * 
e
 )

298 
de
 
e
;

299 
throw
 
w
 
	`EMsg
( "Hexumber formatrror for -Farameter!" );

306 if
	`

m
 ) != 2 )

307 
throw
 
w
 
	`EMsg
( "Parameter -geedsoxtrarguments!" );

309 
stMode
 = 
ue
;

314 if
	`

m
 ) != 4 )

315 
throw
 
w
 
	`EMsg
( "Usewo hex digits forhe -Garameter!" );

317 
y


319 
vifyExndedFuBs
 = 
	`cvtHex

m
 + 2 );

321 
	`tch

EMsg
 * 
e
 )

323 
de
 
e
;

324 
throw
 
w
 
	`EMsg
( "Hexumber formatrror for -Garameter!" );

332 if
	`

m
 ) != 2 )

333 
throw
 
w
 
	`EMsg
( "Parameter -hnd -?eedsoxtrarguments!" );

335 
showHp
 = 
ue
;

340 if
	`

m
 ) <= 2 )

341 
throw
 
w
 
	`EMsg
( "Cannot use -i without memoryype!" );

343 if
	`

m
 ) <= 3 )

344 
throw
 
w
 
	`EMsg
( "Cannot use -i without fileame!" );

347  
m
[2] )

350 
putFeFsh
.
	`assign

m
 + 3 );

354 
putFeEEPROM
.
	`assign

m
 + 3 );

358 
throw
 
w
 
	`EMsg
( "Unknown choice for -i, use -if or -ie!" );

365 if
	`

m
 ) != 4 )

366 
throw
 
w
 
	`EMsg
( "Usewo hex digits forhe -larameter!" );

368 
y


370 
ogmLockBs
 = 
	`cvtHex

m
 + 2 );

372 
	`tch

EMsg
 * 
e
 )

374 
de
 
e
;

375 
throw
 
w
 
	`EMsg
( "Hexumber formatrror for -larameter!" );

382 if
	`

m
 ) != 4 )

383 
throw
 
w
 
	`EMsg
( "Usewo hex digits forhe -larameter!" );

385 
y


387 
vifyLockBs
 = 
	`cvtHex

m
 + 2 );

389 
	`tch

EMsg
 * 
e
 )

391 
de
 
e
;

392 
throw
 
w
 
	`EMsg
( "Hexumber formatrror for -Larameter!" );

399 if
	`

m
 ) <= 2 )

400 
throw
 
w
 
	`EMsg
( "Cannot use -o without memoryype!" );

402 if
	`

m
 ) <= 3 )

403 
throw
 
w
 
	`EMsg
( "Cannot use -o without fileame!" );

406  
m
[2] )

409 
ouutFeFsh
.
	`assign

m
 + 3 );

413 
ouutFeEEPROM
.
	`assign

m
 + 3 );

417 
throw
 
w
 
	`EMsg
( "Unknown choice for -o, use -of or -oe!" );

424  
	`

m
 ) )

427 
adOSCCAL
 = 
ue
;

428 
OSCCAL_Pam
 = 0;

433 
adOSCCAL
 = 
ue
;

434 
y


436 
OSCCAL_Pam
 = 
	`cvtHex

m
 + 2 );

438 
	`tch

EMsg
 * 
e
 )

440 
de
 
e
;

441 
throw
 
w
 
	`EMsg
( "Hexumber formatrror for -Oarameter!" );

448 if
m
[2] != '#' )

449 
throw
 
w
 
	`EMsg
( "Use one orwo hex digits for -Ondwo for -O#!" );

451 
adOSCCAL
 = 
l
;

452 
y


454 
OSCCAL_Pam
 = 
	`cvtHex

m
 + 3 );

456 
	`tch

EMsg
 * 
e
 )

458 
de
 
e
;

459 
throw
 
w
 
	`EMsg
( "Hexumber formatrror for -O#arameter!" );

465 
throw
 
w
 
	`EMsg
( "Invalid use of -O or -O#arameter!" );

472 if
	`

m
 ) != 3 )

473 
throw
 
w
 
	`EMsg
( "Specify memoryype,ot just -p!" );

475  
m
[2] )

478 
ogmFsh
 = 
ue
;

482 
ogmEEPROM
 = 
ue
;

486 
ogmFsh
 = 
ue
;

487 
ogmEEPROM
 = 
ue
;

491 
throw
 
w
 
	`EMsg
( "Unknown choice for -p, use -pf, -pe or -pb!" );

498 if
	`

m
 ) != 2 )

499 
throw
 
w
 
	`EMsg
( "Parameter -qeedsoxtrarguments!" );

501 
adFuBs
 = 
ue
;

506 if
	`

m
 ) != 3 )

507 
throw
 
w
 
	`EMsg
( "Specify memoryype,ot just -r!" );

509  
m
[2] )

512 
adFsh
 = 
ue
;

516 
adEEPROM
 = 
ue
;

520 
adFsh
 = 
ue
;

521 
adEEPROM
 = 
ue
;

525 
throw
 
w
 
	`EMsg
( "Unknown choice for -r, use -rf, -re or -rb!" );

532 if
	`

m
 ) != 2 )

533 
throw
 
w
 
	`EMsg
( "Parameter -seedsoxtrarguments!" );

535 
adSigtu
 = 
ue
;

540 if
	`

m
 ) <= 2 )

541 
throw
 
w
 
	`EMsg
( "Cannot use -S without memoryype!" );

543 if
	`

m
 ) <= 3 )

544 
throw
 
w
 
	`EMsg
( "Cannot use -S without byteddress!" );

546  
m
[2] )

549 
y


551 
OSCCAL_FshAddss
 = 
	`cvtHex

m
 + 3 );

553 
	`tch

EMsg
 * 
e
 )

555 
de
 
e
;

556 
throw
 
w
 
	`EMsg
( "Cannot convert hexumber for -Sfarameter!" );

561 
y


563 
OSCCAL_EEPROMAddss
 = 
	`cvtHex

m
 + 3 );

565 
	`tch

EMsg
 * 
e
 )

567 
de
 
e
;

568 
throw
 
w
 
	`EMsg
( "Cannot convert hexumber for -Searameter!" );

573 
throw
 
w
 
	`EMsg
( "Unknown choice for -S, use -Sf or -Se!" );

580 if
	`

m
 ) != 3 )

581 
throw
 
w
 
	`EMsg
( "Specify memoryype,ot just -v!" );

583  
m
[2] )

586 
vifyFsh
 = 
ue
;

590 
vifyEEPROM
 = 
ue
;

594 
vifyFsh
 = 
ue
;

595 
vifyEEPROM
 = 
ue
;

599 
throw
 
w
 
	`EMsg
( "Unknown choice for -v, use -vf, -ve or -vb!" );

606 if
	`

m
 ) != 4 )

607 
throw
 
w
 
	`EMsg
( "Usewo hex digits forhe -xarameter!" );

609 
y


611 
memyFlP
 = 
	`cvtHex

m
 + 2 );

613 
	`tch

EMsg
 * 
e
 )

615 
de
 
e
;

616 
throw
 
w
 
	`EMsg
( "Hexumber formatrror for -xarameter!" );

623 if
	`

m
 ) != 2 )

624 
throw
 
w
 
	`EMsg
( "Parameter -yeedsoxtrarguments!" );

626 
adLockBs
 = 
ue
;

631 if
	`

m
 ) != 2 )

632 
throw
 
w
 
	`EMsg
( "Parameter -zeedsoxtrarguments!" );

634 
noProgssIndit
 = 
ue
;

639 
throw
 
w
 
	`EMsg
( "Unknowarameter!" );

642 
	}
}

645 
	gJobInfo
::
	$hp
()

647 
cout


648 << "Commd LSwches:" << 
dl


649 << " [-d deviame] [-ife] [- infe] [-ooutfe] [- outfe]" << 
dl


650 << " [-s] [-O index] [-O#vue] [-Saddr] [-Saddr] [-e] [-f|e|b]" << 
dl


651 << " [-f|e|b] [-v f|e|b] [-vue] [-L vue] [-y] [-vue] [-E vue]" << 
dl


652 << " [-F vue] [-G vue] [-q] [-x vue] [-a࡬t,] [- s,]" << 
dl


653 << " [-pt] [-b h|s] [-g] [-z] [-h|?]" << 
dl


654 << 
dl


655 << "Pams:" << 
dl


656 << "d Deviame. Mu bd whrogmmghdevi." << 
dl


657 << "i NamoFLASH iufe. Requed f܅rogmmg ovifiti" << 
dl


658 << " othFLASH memy. Thffm iI Exnded HEX." << 
dl


659 << " NamoEEPROM iufe. Requed f܅rogmmg ovifiti" << 
dl


660 << " othEEPROM memy. Thffm iI Exnded HEX." << 
dl


661 << "o NamoFLASH ouufe. Requed f܄douothFLASH memy." << 
dl


662 << " Thffm iI Exnded HEX." << 
dl


663 << " NamoEEPROM ouufe. Requed f܄douothEEPROM" << 
dl


664 << " memy. Thffm iI Exnded HEX." << 
dl


665 << " Rd sigtu bys." << 
dl
;

666 
	`gch
();

667 
cout


668 << "O Rd osct cibti by. 'dex' itiڮ." << 
dl


669 << "O# Ur-defed osct cibti vue." << 
dl


670 << "S Wrosct c. byFLASH memy. 'addr' ibyddss." << 
dl


671 << "S Wrosct c. byEEPROM memy. 'addr' ibyddss." << 
dl


672 << " E devi. I୶d whnhrogmmgam,he" << 
dl


673 << " devi wbad befܐy othrogmmgakea." << 
dl


674 << " Progm devi; FLASH (f), EEPROM (e bh (b). Cܻdg" << 
dl


675 << " iufequed." << 
dl


676 << " Rd oudevi; FLASH (f), EEPROM (e bh (b). Cܻdg" << 
dl


677 << " ouufequed" << 
dl


678 << "v Vify devi; FLASH (f), EEPROM (e bh (b). C bud wh" << 
dl


679 << " -܇le. Cܻdg iufequed." << 
dl


680 << " Sock by. 'vue' i 8-b hex. vue." << 
dl


681 << "L Vifyock by. 'vue' i 8-b hex. vutvifyga." << 
dl


682 << "y Rd backock by." << 
dl


683 << " S fu bys. 'vue' i16-b hex. vudesibghe" << 
dl


684 << " stgf܁hundow fu bys." << 
dl


685 << "E Sxnded fu by. 'vue' i 8-b hex. vudesibghe" << 
dl


686 << "xnd fu stgs." << 
dl


687 << "F Vify fu bys. 'vue' i16-b hex. vutvifyga." << 
dl
;

688 
	`gch
();

689 
cout


690 << "G Vifyxnded fu by. 'vue' i 8-b hex. vuto" << 
dl


691 << " vifyga." << 
dl


692 << "q Rd back fu bys." << 
dl


693 << "x Funecifdotiڠwh vu(00-ff). Thdeu is" << 
dl


694 << "nمrogmotiڠn scifd ithpufes." << 
dl


695 << "a FLASHddsnge. Scifthaddsngoݔis. The" << 
dl


696 << " deu ithtFLASH. Bydds hex." << 
dl


697 << " EEPROMddsnge. Scifthaddsngoݔis." << 
dl


698 << " Thdeu ithtEEPROM. Bydds hex." << 
dl


699 << " Se communitiڅt; 'COM1''COM99'. Ithim is" << 
dl


700 << " omdhogm wsthCOMtf܇rogmm." << 
dl


701 << "b Gevisis; hdwvisi (hd sowvisi (s)." << 
dl


702 << "g Sݔi." << 
dl


703 << "z Nشogsdit. E.g. ipgبff܆oguos, u" << 
dl


704 << "hitiځavoidhchaud f܁hdit." << 
dl


705 << "h|? Hfmi (ovrideh stgs)." << 
dl


706 << 
dl


707 << "Exame:" << 
dl


708 << " AVROSP -dATmega128 -ifmyp.hex -pf" << 
dl
;

709 
	}
}

712 
	gJobInfo
::
	$cvtHex
* 
txt
 )

714 
rg
 
	`t

txt
 );

715  
Ut
.
	`cvtHex

t
 );

716 
	}
}

719 
	gJobInfo
::
	$doJob
()

721 
snCOM
;

722 
SlPt
 * 
com
;

723 
AVRProgmm
 * 
og
;

724 
AVRDevi
 * 
avr
;

725 
rg
 
ogmmID
;

726 
sig0
, 
sig1
, 
sig2
;

729 if
stMode
 )

731 
Ut
.
	`muLog
();

732 
Ut
.
	`muProgss
();

735 if
noProgssIndit
 )

736 
Ut
.
	`muProgss
();

739 
Ut
.
	`log
"AVR On-sour Progmm " 
VERSIONSTRING
 " (C) 2004 Atmel Corp.\n\r\n\r" );

742 if
showHp
 )

744 
	`hp
();

748 
Ut
.
	`log
"Sp܈timeout" 
TIMEOUTSTRING
 " sec.\r\n" );

751 if
comPt
 == -1 )

753 
Ut
.
	`log
( "Scanning COMorts for supportedrogrammer...\n\r" );

755  
snCOM
 = 1; scanCOM <= 99; scanCOM++ )

757 
Ut
.
	`ogss
"COM" + Ut.
	`cvtLg

snCOM
 ) + "...\r\n" );

759 
y


762 
com
 = 
NULL
;

763 
com
 = 
w
 
	`SlPt

snCOM
, 
TIMEOUT
 );

764 
com
->
	`ݒChl
();

765 
ogmmID
 = 
AVRProgmm
::
	`adProgmmID

com
 );

768 if
ogmmID
 == "AVRBOOT" ||rogrammerID == "AVR ISP" )

773 
de
 
com
;

774 
Ut
.
	`ogss

ogmmID
 + " found -ot supported!\r\n" );

776 
	`tch

EMsg
 * 
e
 )

779 if
com
 !
NULL
 ) 
de
 com;

780 
de
 
e
;

785 if
snCOM
 > 99 )

787 
Ut
.
	`log
( "No supportedrogrammers found!\r\n" );

791 
comPt
 = 
snCOM
;

796 
com
 = 
w
 
	`SlPt

comPt
, 
TIMEOUT
 );

797 
com
->
	`ݒChl
();

798 
ogmmID
 = 
AVRProgmm
::
	`adProgmmID

com
 );

801 if
ogmmID
 != "AVRBOOT" &&rogrammerID != "AVR ISP" )

802 
throw
 
w
 
	`EMsg
( "Programmerot supported!" );

805 
Ut
.
	`log
"Found " + 
ogmmID
 + " oCOM" + Ut.
	`cvtLg

comPt
 ) + "!\r\n" );

808 if
ogmmID
 == "AVRBOOT" )

810 
og
 = 
w
 
	`AVRBold

com
 );

813 if
ogmmID
 == "AVR ISP" )

815 
og
 = 
w
 
	`AVRInSyemProg

com
 );

818 
Ut
.
	`log
( "Enteringrogramming mode...\r\n" );

819 
og
->
	`rProgmmgMode
();

822 
	`doDeviInddt

og
 );

825 if
deviName
.
	`size
() == 0 )

827 
Ut
.
	`log
( "Deviceameot specified!\r\n" );

832 
avr
 = 
w
 
	`AVRDevi

deviName
 );

833 
Ut
.
	`log
( "Parsing XML file for devicearameters...\r\n" );

834 
Ut
.
	`rPh

chth
 );

835 
avr
->
	`adPamsFromAVRStudio

chth
 );

838 
avr
->
	`gSigtu
&
sig0
, &
sig1
, &
sig2
 );

839 if
og
->
	`checkSigtu

sig0
, 
sig1
, 
sig2
 ) )

840 
Ut
.
	`log
( "Signature matches device!\r\n" );

843 
	`doDeviDdt

og
, 
avr
 );

846 
Ut
.
	`log
( "Leavingrogramming mode...\r\n" );

847 
og
->
	`aveProgmmgMode
();

849 
de
 
avr
;

850 
de
 
og
;

851 
de
 
com
;

852 
	}
}

855 
	gJobInfo
::
	$doDeviInddt

AVRProgmm
 * 
og
 )

857 
sig0
, 
sig1
, 
sig2
;

858 
m
, 
maj
;

861 if
adSigtu
 )

863 
Ut
.
	`log
( "Reading signature bytes: " );

864 if!
og
->
	`adSigtu
&
sig0
, &
sig1
, &
sig2
 ) )

865 
throw
 
w
 
	`EMsg
( "Signatureeadout isot supported byhisrogrammer!" );

868 
cout
.
	`fl
( '0' );

869 
cout
 << 
hex


870 << "0x" << 
	`tw
(2<< 
sig0
 << " "

871 << "0x" << 
	`tw
(2<< 
sig1
 << " "

872 << "0x" << 
	`tw
(2<< 
sig2
 << 
dl
;

876 if
gSWvisi
 )

878 
Ut
.
	`log
( "Readingrogrammer softwareevision: " );

879 if!
og
->
	`ogmmSoweVsi
&
maj
, &
m
 ) )

880 
throw
 
w
 
	`EMsg
( "Softwareevisioneadout isot supported byhisrogrammer!" );

883 
cout
 << ((
maj
 & 0xff<< "." << ((
m
 & 0xff<< 
dl
;

887 if
gHWvisi
 )

889 
Ut
.
	`log
( "Readingrogrammer hardwareevision: " );

890 if!
og
->
	`ogmmHdweVsi
&
maj
, &
m
 ) )

891 
throw
 
w
 
	`EMsg
( "Hardwareevisioneadout isot supported byhisrogrammer!" );

894 
cout
 << ((
maj
 & 0xff<< "." << ((
m
 & 0xff<< 
dl
;

896 
	}
}

899 
	gJobInfo
::
	$doDeviDdt

AVRProgmm
 * 
og
, 
AVRDevi
 * 
avr
 )

901 
HEXFe
 * 
hex
;

902 
HEXFe
 * 
hex_v
;

903 
pos
;

904 
bs
;

907 
og
->
	`tPagesize

avr
->
	`gPageSize
() );

910 if
ashEndAddss
 != -1 )

912 if
ashEndAddss
 >
avr
->
	`gFshSize
() )

913 
throw
 
w
 
	`EMsg
( "Specified Flashddressange is outside deviceddress space!" );

916 
ashSAddss
 = 0;

917 
ashEndAddss
 = 
avr
->
	`gFshSize
() - 1;

920 if
omEndAddss
 != -1 )

922 if
omEndAddss
 >
avr
->
	`gEEPROMSize
() )

923 
throw
 
w
 
	`EMsg
( "Specified EEPROMddressange is outside deviceddress space!" );

926 
omSAddss
 = 0;

927 
omEndAddss
 = 
avr
->
	`gEEPROMSize
() - 1;

932 if
adFsh
 )

935 if
ouutFeFsh
.
	`size
() == 0 )

936 
throw
 
w
 
	`EMsg
( "Cannotead Flash without output file specified!" );

939 
hex
 = 
w
 
	`HEXFe

avr
->
	`gFshSize
() );

940 
hex
->
	`tUdRge

ashSAddss
, 
ashEndAddss
 );

943 
Ut
.
	`log
( "Reading Flash contents...\r\n" );

944 if!
og
->
	`adFsh

hex
 ) )

945 
throw
 
w
 
	`EMsg
( "Flasheadout isot supported byhisrogrammer!" );

946 
Ut
.
	`log
( "Writing HEX output file...\r\n" );

947 
hex
->
	`wreFe

ouutFeFsh
 );

949 
de
 
hex
;

954 if
adEEPROM
 )

957 if
ouutFeEEPROM
.
	`size
() == 0 )

958 
throw
 
w
 
	`EMsg
( "Cannotead EEPROM without output file specified!" );

961 
hex
 = 
w
 
	`HEXFe

avr
->
	`gEEPROMSize
() );

962 
hex
->
	`tUdRge

omSAddss
, 
omEndAddss
 );

965 
Ut
.
	`log
( "Reading EEPROM contents...\r\n" );

966 if!
og
->
	`adEEPROM

hex
 ) )

967 
throw
 
w
 
	`EMsg
( "EEPROMeadout isot supported byhisrogrammer!" );

968 
Ut
.
	`log
( "Writing HEX output file...\r\n" );

969 
hex
->
	`wreFe

ouutFeEEPROM
 );

971 
de
 
hex
;

976 if
adLockBs
 )

978 
Ut
.
	`log
( "Readingock bits...\r\n" );

979 if!
og
->
	`adLockBs
&
bs
 ) )

980 
throw
 
w
 
	`EMsg
( "Lock biteadout isot supported byhisrogrammer!" );

981 
cout
 << "0x" << 
d
::
hex
 << 
	`tw
(2<< 
bs
 << 
dl
;

986 if
adFuBs
 )

988 if!
avr
->
	`gFuStus
() )

989 
throw
 
w
 
	`EMsg
( "Selected device haso fuse bits!" );

991 
Ut
.
	`log
( "Reading fuse bits...\r\n" );

992 if!
og
->
	`adFuBs
&
bs
 ) )

993 
throw
 
w
 
	`EMsg
( "Fuse biteadout isot supported byhisrogrammer!" );

994 
cout
 << "0x" << 
d
::
hex
 << 
	`tw
(4<< 
bs
 << 
dl
;

996 if
avr
->
	`gXFuStus
() )

998 if!
og
->
	`adExndedFuBs
&
bs
 ) )

999 
throw
 
w
 
	`EMsg
( "Extended fuse biteadout isot supported byhisrogrammer!" );

1000 
cout
 << "0x" << 
d
::
hex
 << 
	`tw
(2<< 
bs
 << 
dl
;

1006 if
chE
 )

1008 
Ut
.
	`log
( "Erasing chip contents...\r\n" );

1009 if!
og
->
	`chE
() )

1010 
throw
 
w
 
	`EMsg
( "Chiprase isot supported byhisrogrammer!" );

1015 if
ogmFsh
 || 
vifyFsh
 )

1018 if
putFeFsh
.
	`size
() == 0 )

1019 
throw
 
w
 
	`EMsg
( "Cannotrogram or verify Flash without input file specified!" );

1022 
hex
 = 
w
 
	`HEXFe

avr
->
	`gFshSize
() );

1025 if
memyFlP
 != -1 )

1026 
hex
->
	`rA

memyFlP
 );

1029 
Ut
.
	`log
( "Reading HEX input file for flash operations...\r\n" );

1030 
hex
->
	`adFe

putFeFsh
 );

1033 if
hex
->
	`gRgeS
(> 
ashEndAddss
 ||

1034 
hex
->
	`gRgeEnd
(< 
ashSAddss
 )

1035 
throw
 
w
 
	`EMsg
( "HEX file defines data outside specifiedange!" );

1037 if
memyFlP
 == -1 )

1039 if
hex
->
	`gRgeS
(> 
ashSAddss
 )

1040 
ashSAddss
 = 
hex
->
	`gRgeS
();

1042 if
hex
->
	`gRgeEnd
(< 
ashEndAddss
 )

1043 
ashEndAddss
 = 
hex
->
	`gRgeEnd
();

1046 
hex
->
	`tUdRge

ashSAddss
, 
ashEndAddss
 );

1051 if
ogmFsh
 )

1054 
Ut
.
	`log
( "Programming Flash contents...\r\n" );

1055 if!
og
->
	`wreFsh

hex
 ) )

1056 
throw
 
w
 
	`EMsg
( "Flashrogramming isot supported byhisrogrammer!" );

1061 if
vifyFsh
 )

1064 
hex_v
 = 
w
 
	`HEXFe

avr
->
	`gFshSize
() );

1067 
Ut
.
	`log
( "Reading Flash contents...\r\n" );

1068 
hex_v
->
	`tUdRge

hex
->
	`gRgeS
(), hex->
	`gRgeEnd
() );

1069 if!
og
->
	`adFsh

hex_v
 ) )

1070 
throw
 
w
 
	`EMsg
( "Flasheadout isot supported byhisrogrammer!" );

1073 
Ut
.
	`log
( "Comparing Flash data...\r\n" );

1075  
pos
 = 
hex
->
	`gRgeS
();o<hex->
	`gRgeEnd
();os++ )

1077 if
hex
->
	`gDa

pos
 ) !
hex_v
->getData(os ) )

1079 
cout
 << "Uquadds0x" << 
d
::
hex
 << 
pos
 << "!" << 
dl
;

1084 if
pos
 > 
hex
->
	`gRgeEnd
() )

1086 
cout
 << "Equ!" << 
dl
;

1089 
de
 
hex_v
;

1092 if
ogmFsh
 || 
vifyFsh
 )

1093 
de
 
hex
;

1097 if
ogmEEPROM
 || 
vifyEEPROM
 )

1100 if
putFeEEPROM
.
	`size
() == 0 )

1101 
throw
 
w
 
	`EMsg
( "Cannotrogram or verify EEPROM without input file specified!" );

1104 
hex
 = 
w
 
	`HEXFe

avr
->
	`gEEPROMSize
() );

1107 if
memyFlP
 != -1 )

1108 
hex
->
	`rA

memyFlP
 );

1111 
Ut
.
	`log
( "Reading HEX input file for EEPROM operations...\r\n" );

1112 
hex
->
	`adFe

putFeEEPROM
 );

1115 if
hex
->
	`gRgeS
(> 
omEndAddss
 ||

1116 
hex
->
	`gRgeEnd
(< 
omSAddss
 )

1117 
throw
 
w
 
	`EMsg
( "HEX file defines data outside specifiedange!" );

1119 if
memyFlP
 == -1 )

1121 if
hex
->
	`gRgeS
(> 
omSAddss
 )

1122 
omSAddss
 = 
hex
->
	`gRgeS
();

1124 if
hex
->
	`gRgeEnd
(< 
omEndAddss
 )

1125 
omEndAddss
 = 
hex
->
	`gRgeEnd
();

1128 
hex
->
	`tUdRge

omSAddss
, 
omEndAddss
 );

1133 if
ogmEEPROM
 )

1136 
Ut
.
	`log
( "Programming EEPROM contents...\r\n" );

1137 if!
og
->
	`wreEEPROM

hex
 ) )

1138 
throw
 
w
 
	`EMsg
( "EEPROMrogramming isot supported byhisrogrammer!" );

1142 if
vifyEEPROM
 )

1145 
hex_v
 = 
w
 
	`HEXFe

avr
->
	`gEEPROMSize
() );

1148 
Ut
.
	`log
( "Reading EEPROM contents...\r\n" );

1149 
hex_v
->
	`tUdRge

hex
->
	`gRgeS
(), hex->
	`gRgeEnd
() );

1150 if!
og
->
	`adEEPROM

hex_v
 ) )

1151 
throw
 
w
 
	`EMsg
( "EEPROMeadout isot supported byhisrogrammer!" );

1154 
Ut
.
	`log
( "Comparing EEPROM data...\r\n" );

1155  
pos
 = 
hex
->
	`gRgeS
();o<hex->
	`gRgeEnd
();os++ )

1157 if
hex
->
	`gDa

pos
 ) !
hex_v
->getData(os ) )

1159 
cout
 << "Uquadds0x" << 
d
::
hex
 << 
pos
 << "!" << 
dl
;

1164 if
pos
 > 
hex
->
	`gRgeEnd
() )

1166 
cout
 << "Equ!" << 
dl
;

1169 
de
 
hex_v
;

1172 if
ogmEEPROM
 || 
vifyEEPROM
 )

1173 
de
 
hex
;

1177 if
ogmLockBs
 != -1 )

1179 
Ut
.
	`log
( "Programmingock bits...\r\n" );

1180 if!
og
->
	`wreLockBs

ogmLockBs
 ) )

1181 
throw
 
w
 
	`EMsg
( "Lock bitrogramming isot supported byhisrogrammer!" );

1186 if
ogmFuBs
 != -1 )

1188 if!
avr
->
	`gFuStus
() )

1189 
throw
 
w
 
	`EMsg
( "Selected device haso fuse bits!" );

1191 
Ut
.
	`log
( "Programming fuse bits...\r\n" );

1192 if!
og
->
	`wreFuBs

ogmFuBs
 ) )

1193 
throw
 
w
 
	`EMsg
( "Fuse bitrogramming isot supported byhisrogrammer!" );

1198 if
ogmExndedFuBs
 != -1 )

1200 if!
avr
->
	`gXFuStus
() )

1201 
throw
 
w
 
	`EMsg
( "Selected device hasoxtended fuse bits!" );

1203 
Ut
.
	`log
( "Programmingxtended fuse bits...\r\n" );

1204 if!
og
->
	`wreExndedFuBs

ogmExndedFuBs
 ) )

1205 
throw
 
w
 
	`EMsg
( "Extended fuse bitrogramming isot supported byhisrogrammer!" );

1210 if
vifyLockBs
 != -1 )

1212 
Ut
.
	`log
( "Verifyingock bits...\r\n" );

1213 if!
og
->
	`adLockBs
&
bs
 ) )

1214 
throw
 
w
 
	`EMsg
( "Lock biteadout isot supported byhisrogrammer!" );

1215 if
bs
 =
vifyLockBs
 )

1216 
cout
 << "Equ!" << 
dl
;

1218 
cout
 << "Uqu!" << 
dl
;

1223 if
vifyFuBs
 != -1 )

1225 if!
avr
->
	`gFuStus
() )

1226 
throw
 
w
 
	`EMsg
( "Selected device haso fuse bits!" );

1228 
Ut
.
	`log
( "Verifying fuse bits...\r\n" );

1229 if!
og
->
	`adFuBs
&
bs
 ) )

1230 
throw
 
w
 
	`EMsg
( "Fuse biteadout isot supported byhisrogrammer!" );

1231 if
bs
 =
vifyFuBs
 )

1232 
cout
 << "Equ!" << 
dl
;

1234 
cout
 << "Uqu!" << 
dl
;

1239 if
vifyExndedFuBs
 != -1 )

1241 if!
avr
->
	`gXFuStus
() )

1242 
throw
 
w
 
	`EMsg
( "Selected device hasoxtended fuse bits!" );

1244 
Ut
.
	`log
( "Verifyingxtended fuse bits...\r\n" );

1245 if!
og
->
	`adExndedFuBs
&
bs
 ) )

1246 
throw
 
w
 
	`EMsg
( "Extended fuse biteadout isot supported byhisrogrammer!" );

1247 if
bs
 =
vifyExndedFuBs
 )

1248 
cout
 << "Equ!" << 
dl
;

1250 
cout
 << "Uqu!" << 
dl
;

1255 if
OSCCAL_Pam
 != -1 )

1258 if
adOSCCAL
 )

1260 
Ut
.
	`log
( "Reading OSCCAL from device...\r\n" );

1261 
pos
 = 
OSCCAL_Pam
;

1262 if!
og
->
	`adOSCCAL

pos
, &
OSCCAL_Pam
 ) )

1263 
throw
 
w
 
	`EMsg
( "OSCCALarametereadout isot supported byhisrogrammer!" );

1264 
cout
 << "0x" << 
d
::
hex
 << 
	`tw
(2<< 
OSCCAL_Pam
 << 
dl
;

1270 if
OSCCAL_FshAddss
 != -1 )

1272 if
OSCCAL_Pam
 == -1 )

1273 
throw
 
w
 
	`EMsg
( "OSCCAL valueot specified!" );

1275 
Ut
.
	`log
( "Programming OSCCAL valueo Flash...\r\n" );

1276 if!
og
->
	`wreFshBy

OSCCAL_FshAddss
, 
OSCCAL_Pam
 ) )

1277 
throw
 
w
 
	`EMsg
( "Flashrogramming isot supported byhisrogrammer!" );

1282 if
OSCCAL_EEPROMAddss
 != -1 )

1284 if
OSCCAL_Pam
 == -1 )

1285 
throw
 
w
 
	`EMsg
( "OSCCAL valueot specified!" );

1287 
Ut
.
	`log
( "Programming OSCCAL valueo EEPROM...\r\n" );

1288 if!
og
->
	`wreEEPROMBy

OSCCAL_EEPROMAddss
, 
OSCCAL_Pam
 ) )

1289 
throw
 
w
 
	`EMsg
( "EEPROMrogramming isot supported byhisrogrammer!" );

1292 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/JobInfo.hpp

22 #ide
JOBINFO_HPP


23 
	#JOBINFO_HPP


	)

25 
usg
 
mea
 
	gd
;

27 
	~<ioam
>

28 
	~<ve
>

29 
	~<rg
>

30 
	~<iom
>

31 
	~"EMsg.h
"

32 
	~"AVRProgmm.h
"

33 
	~"AVRBold.h
"

34 
	~"AVRInSyemProg.h
"

35 
	~"AVRDevi.h
"

36 
	~"SlPt.h
"

37 
	~"Uty.h
"

40 as
	cJobInfo


42 
	meed
:

43 
cvtHex
* 
txt
 );

44 
hp
();

45 
doDeviInddt

AVRProgmm
 * 
og
 );

46 
doDeviDdt

AVRProgmm
 * 
og
, 
AVRDevi
 * 
avr
 );

49 
bo
 
	mshowHp
;

50 
bo
 
	mstMode
;

51 
bo
 
	mnoProgssIndit
;

52 
bo
 
	madSigtu
;

53 
bo
 
	mchE
;

54 
bo
 
	mgHWvisi
;

55 
bo
 
	mgSWvisi
;

56 
bo
 
	mogmFsh
;

57 
bo
 
	mogmEEPROM
;

58 
bo
 
	madFsh
;

59 
bo
 
	madEEPROM
;

60 
bo
 
	mvifyFsh
;

61 
bo
 
	mvifyEEPROM
;

62 
bo
 
	madLockBs
;

63 
bo
 
	madFuBs
;

64 
bo
 
	madOSCCAL
;

66 
rg
 
	mdeviName
;

67 
rg
 
	mputFeFsh
;

68 
rg
 
	mputFeEEPROM
;

69 
rg
 
	mouutFeFsh
;

70 
rg
 
	mouutFeEEPROM
;

72 
	mOSCCAL_Pam
;

74 
	mOSCCAL_FshAddss
;

75 
	mOSCCAL_EEPROMAddss
;

77 
	mogmLockBs
;

78 
	mvifyLockBs
;

80 
	mogmFuBs
;

81 
	mogmExndedFuBs
;

82 
	mvifyFuBs
;

83 
	mvifyExndedFuBs
;

85 
	mmemyFlP
;

87 
	mashSAddss
;

88 
	mashEndAddss
;

90 
	momSAddss
;

91 
	momEndAddss
;

93 
	mcomPt
;

95 
	mve
<
	mrg
> 
	mchth
;

97 
	mpublic
:

98 
JobInfo
();

100 
rCommdle

gc
, *
gv
[] );

101 
doJob
();

	@ports/bdk-atxx4-mstp/avrosp/SerialPort.cpp

22 
	~"SlPt.h
"

26 
	gSlPt
::
	$SlPt

_ptNumb
, 
_timeout
 )

28 if
_timeout
 < 0 )

29 
throw
 
w
 
	`EMsg
( "Negative COM-portimeoutotllowed!" );

31 if
_ptNumb
 < 1 || _portNumber > 99 )

32 
throw
 
w
 
	`EMsg
( "Only COM1o COM99 is supported!" );

35 
ptNumb
 = 
_ptNumb
;

36 
timeout
 = 
_timeout
;

37 
chlOn
 = 
l
;

38 
	}
}

42 
	gSlPt
::~
	$SlPt
()

44 
	`oChl
();

45 
	}
}

49 
	gSlPt
::
	$ݒChl
()

52 
comName
[64] = "COM1";

54 
COMMTIMEOUTS
 
comTimeouts
;

57 if
chlOn
 )

58 
throw
 
w
 
	`EMsg
( "Channellready open! Cannot openortwice." );

61 i(
ptNumb
 < 10) {

62 
comName
[3] = '0' + 
ptNumb
;

63 } i(
ptNumb
 < 100) {

67 
	`rtf
(
comName
, "\\\\.\\COM%ld", 
ptNumb
);

69 
rlHd
 = 
	`CeFe

comName
, 
GENERIC_READ
 | 
GENERIC_WRITE
, 0, 
NULL
,

70 
OPEN_EXISTING
, 
FILE_ATTRIBUTE_NORMAL
, 
NULL
 );

73 if
rlHd
 =
INVALID_HANDLE_VALUE
 )

74 
throw
 
w
 
	`EMsg
( "Error opening COMort!" );

76 
chlOn
 = 
ue
;

79 if!
	`GCommTimeouts

rlHd
, &
dComTimeouts
 ) )

80 
throw
 
w
 
	`EMsg
( "Erroreading COMort settings!" );

83 if!
	`GCommTimeouts

rlHd
, &
comTimeouts
 ) )

84 
throw
 
w
 
	`EMsg
( "Erroreading COMort settings!" );

86 
comTimeouts
.
RdIvTimeout
 = 
MAXDWORD
;

87 
comTimeouts
.
RdTٮTimeoutCڡt
 = 0;

88 
comTimeouts
.
RdTٮTimeoutMuɝlr
 = 0;

91 if!
	`SCommTimeouts

rlHd
, &
comTimeouts
 ) )

92 
throw
 
w
 
	`EMsg
( "Error changing COMort settings!" );

93 
	}
}

97 
	gSlPt
::
	$oChl
()

99 if!
chlOn
 )

103 if!
	`SCommTimeouts

rlHd
, &
dComTimeouts
 ) )

104 
throw
 
w
 
	`EMsg
( "Error changing COMort settings!" );

107 if
rlHd
 !
INVALID_HANDLE_VALUE
 )

108 if!
	`CloHd

rlHd
 ) )

109 
throw
 
w
 
	`EMsg
( "Error closing COMort!" );

111 
chlOn
 = 
l
;

112 
	}
}

117 
	gSlPt
::
	$ndBy

da
 )

119 
DWORD
 
wrn
;

122 if!
chlOn
 )

123 
throw
 
w
 
	`EMsg
( "Channelot open! Cannot sendo unopened channel." );

126 if!
	`WreFe

rlHd
, &
da
, 1, &
wrn
, 
NULL
 ) )

127 
throw
 
w
 
	`EMsg
( "Error writing byteo COMort!" );

128 
	}
}

132 
	gSlPt
::
	$gBy
()

134 
time_t
 
tTime
;

135 
tTime
 = 
	`time

NULL
 );

136 
DWORD
 
adnum
;

137 
da
;

140 if!
chlOn
 )

141 
throw
 
w
 
	`EMsg
( "Channelot open! Cannotead from unopened channel." );

147 if!
	`RdFe

rlHd
, &
da
, 1, &
adnum
, 
NULL
 ) )

149 
throw
 
w
 
	`EMsg
( "Erroreading byte from COMort!" );

152 if
adnum
 == 1 )

153  ((
da
) & 0xff;

155 }  
	`time
(
NULL
- 
tTime
 < 
timeout
 );

158 
throw
 
w
 
	`EMsg
( "Timeout during COM-portead operation!" );

159 
	}
}

163 
	gSlPt
::
	$ushTX
()

166 if!
chlOn
 )

167 
throw
 
w
 
	`EMsg
( "Channelot open! Cannot flushn unopened channel." );

170 if!
	`PurgeComm

rlHd
, 
PURGE_TXCLEAR
 ) )

171 
throw
 
w
 
	`EMsg
( "Error flushing COMort TX buffer!" );

172 
	}
}

176 
	gSlPt
::
	$ushRX
()

179 if!
chlOn
 )

180 
throw
 
w
 
	`EMsg
( "Channelot open! Cannot flushn unopened channel." );

183 if!
	`PurgeComm

rlHd
, 
PURGE_RXCLEAR
 ) )

184 
throw
 
w
 
	`EMsg
( "Error flushing COMort RX buffer!" );

185 
	}
}

189 
	gSlPt
::
	$ndMuɝ
* 
da
, 
bufsize
 )

191 
DWORD
 
wrn
;

194 if!
chlOn
 )

195 
throw
 
w
 
	`EMsg
( "Channelot open! Cannot writeo unopened channel." );

198 if!
	`WreFe

rlHd
, 
da
, 
bufsize
, &
wrn
, 
NULL
 ) )

199 
throw
 
w
 
	`EMsg
( "Error writing multiple byteso COMort!" );

200 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/SerialPort.hpp

22 #ide
SERIALPORT_HPP


23 
	#SERIALPORT_HPP


	)

25 
usg
 
mea
 
	gd
;

27 
	#WIN32_LEAN_AND_MEAN


	)

28 
	~<wdows.h
>

29 
	~<time.h
>

30 
	~<ioam
>

31 
	~"CommChl.h
"

32 
	~"EMsg.h
"

35 as
	cSlPt
 : 
public
 
CommChl


37 
eed
:

38 
ptNumb
;

39 
	mtimeout
;

40 
HANDLE
 
	mrlHd
;

41 
COMMTIMEOUTS
 
	mdComTimeouts
;

42 
bo
 
	mchlOn
;

44 
	mpublic
:

47 
SlPt

p܊umb
, 
timeout
 );

50 ~
SlPt
();

53 
vtu
 
ݒChl
();

56 
vtu
 
oChl
();

59 
vtu
 
ndBy

da
 );

62 
vtu
 
gBy
();

65 
vtu
 
ushTX
();

68 
vtu
 
ushRX
();

71 
vtu
 
ndMuɝ
* 
da
, 
bufsize
 );

	@ports/bdk-atxx4-mstp/avrosp/Utility.cpp

21 
	~"Uty.h
"

23 
	~<ioam
>

24 
	~<fam
>

25 
	~<dlib.h
>

28 
Uty
 
	gUt
;

32 
	gUty
::
	$Uty
() :

33 
	`noLog

l
 ),

34 
	$noProgss

l
 )

37 
	}
}

41 
	gUty
::~
	$Uty
()

44 
	}
}

48 
Uty
::
	$log
cڡ 
rg
 & 
txt
 )

50 if!
noLog
 )

51 
cout
 << 
txt
;

52 
	}
}

55 
	gUty
::
	$ogss
cڡ 
rg
 & 
txt
 )

57 if!
noProgss
 )

58 
cout
 << 
txt
;

59 
	}
}

62 
	gUty
::
	$cvtHex
cڡ 
rg
 & 
txt
 )

64 
su
 = 0;

65 
dig
;

66 
i
;

68 if
txt
.
	`size
() == 0 )

69 
throw
 
w
 
	`EMsg
( "Cannot convert zero-length hex-stringoumber!" );

71 if
txt
.
	`size
() > 8 )

72 
throw
 
w
 
	`EMsg
( "Hex conversion overflow! Too many hex digits in string." );

75  
i
 = 0; i < 
txt
.
	`size
(); i++ )

78 if
txt
[
i
] >= '0' &&xt[i] <= '9' )

79 
dig
 = 
txt
[
i
] - '0';

80 if
txt
[
i
] >= 'a' &&xt[i] <= 'f' )

81 
dig
 = 
txt
[
i
] - 'a' + 10;

82 if
txt
[
i
] >= 'A' &&xt[i] <= 'F' )

83 
dig
 = 
txt
[
i
] - 'A' + 10;

85 
throw
 
w
 
	`EMsg
( "Invalid hex digit found!" );

88 
su
 = (su << 4| 
dig
;

91  
su
;

92 
	}
}

95 
rg
 
	gUty
::
	$cvtLg

num
, 
dix
 )

97 
buf
[18];

98 
rg
 
s
;

100 
	`

num
, 
buf
, 
dix
 );

101 
s
 = 
buf
;

102  
s
;

103 
	}
}

106 
	gUty
::
rPh

ve
<
rg
> & 
li
 )

109 * 
thr
 = 
gv
( "PATH" );

110 if
	gthr
 !
NULL
 && 
thr
[0] != 0 ) {

111 
rg
 
th
 = 
thr
;

112 
	gpos
;

114  (
	gpos
 = 
th
.
fd_f_of
";" )<h.
ngth
() ) {

115 
li
.
push_back

th
.
subr
0, 
pos
 ) );

116 
	gth
.
a
0, 
pos
+1 );

119 
	gli
.
push_back

th
 );

124 
bo
 
	gUty
::
	$feExis

rg
 
fame
 )

127 
ifam
 
f
;

128 
f
.
	`ݒ

fame
.
	`c_r
(), 
ios
::

 );

129 if!
f
 ) {

130  
l
;

132 
f
.
	`o
();

133  
ue
;

135 
	}
}

138 
	gUty
::
	$veSg

rg
 
txt
, sg 
fame
 )

140 
ofam
 
f
;

142 
f
.
	`ݒ

fame
.
	`c_r
(), 
ios
::
out
 );

143 if!
f
 )

144 
throw
 
w
 
	`EMsg
( "Error opening HEX file for output!" );

146 
f
 << 
txt
;

148 
f
.
	`o
();

149 
	}
}

152 #ide
NOREGISTRY


153 
rg
 
	gUty
::
	$gRegiryVue
cڡ 
rg
 & 
th
, cڡ sg & 
vue
 )

156 cڡ 
BUFSIZE
=1000;

157 
rg
 
su
;

158 
HKEY
 
hKey
;

159 
szAVRPh
[
BUFSIZE
];

160 
DWORD
 
dwBufL
=
BUFSIZE
;

161 
LONG
 
lR
;

164 
lR
 = 
	`RegOnKeyEx

HKEY_LOCAL_MACHINE
, 
th
.
	`c_r
(), 0, 
KEY_QUERY_VALUE
, &
hKey
 );

165 if
lR
 !
ERROR_SUCCESS
 )

166 
throw
 
w
 
	`EMsg
"E wh ongegiry key: (" + 
th
 + ")!" );

169 
lR
 = 
	`RegQuyVueEx

hKey
, 
vue
.
	`c_r
(), 
NULL
, NULL, (
LPBYTE

szAVRPh
, &
dwBufL
);

170 if(
lR
 !
ERROR_SUCCESS
|| (
dwBufL
 > 
BUFSIZE
) )

171 
throw
 
w
 
	`EMsg
"E whdg key vue: (" + 
vue
 + ")!" );

174 
	`RegCloKey

hKey
 );

175 
su
 = 
szAVRPh
;

176  
su
;

177 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/Utility.hpp

21 #ide
UTILITY_HPP


22 
	#UTILITY_HPP


	)

24 
usg
 
mea
 
	gd
;

26 #ide
NOREGISTRY


27 
	#WIN32_LEAN_AND_MEAN


	)

28 
	~<wdows.h
>

31 
	~<ve
>

32 
	~<rg
>

33 
	~"EMsg.h
"

35 as
	cUty


37 
	meed
:

38 
bo
 
noLog
;

39 
bo
 
	mnoProgss
;

41 
	mpublic
:

43 
Uty
();

46 ~
Uty
();

49 
	$muLog
({ 
noLog
 = 
ue
; }

50 
	$muProgss
({ 
noProgss
 = 
ue
; 
	}
}

52 
log
cڡ 
rg
 & 
txt
 );

53 
ogss
cڡ 
rg
 & 
txt
 );

55 
cvtHex
cڡ 
rg
 & 
txt
 );

56 
rg
 
cvtLg

num
, 
dix
 = 10 );

58 
rPh

ve
<
rg
> & 
li
 );

59 
bo
 
feExis

rg
 
fame
 );

60 
veSg

rg
 
txt
, sg 
fame
 );

62 #ide
NOREGISTRY


63 
rg
 
gRegiryVue
cڡ sg & 
th
, cڡ sg & 
vue
 );

67 
Uty
 
Ut
;

	@ports/bdk-atxx4-mstp/avrosp/XMLParser.cpp

22 
	~"XMLPr.h
"

26 
	eXMLNodeTy


28 
	mxml_node
,

29 
	mxml_sub


33 as
	cXMLAbNode


35 
	meed
:

36 
rg
 
me
;

37 
XMLNodeTy
 
	mty
;

39 
	mpublic
:

41 
XMLAbNode
cڡ 
rg
 & 
_me
, 
XMLNodeTy
 
_ty
 );

44 ~
XMLAbNode
();

47 cڡ 
	mrg
 & 
gName
();

48 
XMLNodeTy
 
gTy
();

50 
bo
 
isName
cڡ 
rg
 & 
_me
 );

52 
vtu
 
t
() = 0;

57 as
	cXMLTe
 : 
public
 
XMLAbNode


59 
eed
:

60 
li
<
XMLAbNode
 *> 
nodes
;

62 
	mpublic
:

64 
XMLTe
cڡ 
rg
 & 
_me
 );

67 ~
XMLTe
();

70 
addNode

XMLAbNode
 * 
wnode
 );

71 
bo
 
cڏsNode
cڡ 
rg
 & 
_me
 );

72 
XMLAbNode
 * 
gNode
cڡ 
rg
 & 
_me
 );

74 
t
();

79 as
	cXMLNode
 : 
public
 
XMLAbNode


81 
eed
:

82 
rg
 
vue
;

84 
	mpublic
:

86 
XMLNode
cڡ 
rg
 & 
_me
, cڡ sg & 
_vue
 );

89 ~
XMLNode
();

92 
bo
 
isEmy
();

93 cڡ 
	mrg
 & 
gVue
();

95 
t
();

101 
	gXMLFe
::
	$moveCommts

rg
 & 
txt
 )

103 
pos
 = 0;

105 
tFoundAt
;

106 
dFoundAt
;

112 
tFoundAt
 = 
txt
.
	`fd
"<!--", 
pos
 );

115 if
tFoundAt
 =
rg
::
os
 )

117 
pos
 = 
txt
.
	`size
();

122 
dFoundAt
 = 
txt
.
	`fd
"-->", 
tFoundAt
 );

125 if
dFoundAt
 =
rg
::
os
 )

126 
throw
 
w
 
	`EMsg
( "Unclosed commentagncountered! "

131 
txt
.
	`a

tFoundAt
, 
dFoundAt
 - startFoundAt + 3 );

133 
pos
 = 
tFoundAt
;

135 }  
pos
 < 
txt
.
	`size
() );

136 
	}
}

138 
	gXMLFe
::
	$moveSXML

rg
 & 
txt
 )

140 
pos
 = 0;

142 
tFoundAt
;

143 
dFoundAt
;

146 
tFoundAt
 = 
txt
.
	`fd
"<?xml", 
pos
 );

149 if
tFoundAt
 =
rg
::
os
 )

151 
pos
 = 
txt
.
	`size
();

156 
dFoundAt
 = 
txt
.
	`fd
">", 
tFoundAt
 );

159 
txt
.
	`a

tFoundAt
, 
dFoundAt
 - startFoundAt );

160 
	}
}

163 
	gXMLFe
::
	$moveAribus

rg
 & 
txt
 )

165 
pos
;

167 
tFoundAt
;

168 
dFoundAt
;

170 
aFoundAt
;

171 
ashFoundAt
;

175  
pos
 = 0;o< 
txt
.
	`size
();os++ )

177 if
txt
[
pos
] == '\n' ||xt[pos] == '\r' ||xt[pos] == '\t' )

178 
txt
.
	`a

pos
, 1, " " );

181 
pos
 = 0;

187 
tFoundAt
 = 
txt
.
	`fd
"<", 
pos
 );

190 if
tFoundAt
 =
rg
::
os
 )

194 
dFoundAt
 = 
txt
.
	`fd
">", 
tFoundAt
 );

197 if
dFoundAt
 =
rg
::
os
 )

198 
throw
 
w
 
	`EMsg
( "Unclosedagncountered! "

203  
txt
[
tFoundAt
+1] == ' ' )

205 
txt
.
	`a

tFoundAt
+1, 1 );

206 
dFoundAt
--;

210 
aFoundAt
 = 
txt
.
	`fd
" ", 
tFoundAt
 );

211 if
aFoundAt
 < 
dFoundAt
 && sFoundA!
rg
::
os
 )

214 i
txt
.
	`
(
dFoundAt
-1) == '/' )

216 
dFoundAt
--;

220 
txt
.
	`a

aFoundAt
, 
dFoundAt
 - spaceFoundAt );

221 
dFoundAt
 -dFoundA- 
aFoundAt
;

225 
pos
 = 
dFoundAt
 + 1;

227 }  
pos
 < 
txt
.
	`size
() );

228 
	}
}

231 
	gXMLFe
::
	$adFe
cڡ 
rg
 & 
_fame
 )

233 
ifam
 
f
;

234 
rg
 
cڋs
;

235 
rg
 
me
;

238 
f
.
	`ݒ

_fame
.
	`c_r
(), 
ios
::

 );

239 if!
f
 )

240 
throw
 
w
 
	`EMsg
( "Error opening XML file for input!" );

243 
cڋs
.
	`a
();

244 
me
.
	`a
();

247 
cڋs
 +
me
 + " ";

248 
f
 >> 
me
;

249 }  !
f
.
	`eof
() );

251 
f
.
	`o
();

254 
	`moveCommts

cڋs
 );

255 
	`moveAribus

cڋs
 );

256 
	`moveSXML
 ( 
cڋs
 );

259 
ro
 = 
w
 
	`XMLTe
( "root" );

260 
	`rFgmt

cڋs
, 
ro
 );

262 
Ut
.
	`ogss
( "\r\n" );

263 
	}
}

266 
	gXMLFe
::
	$rFgmt

rg
 & 
agmt
, 
XMLTe
 * 

 )

268 
tFoundAt
;

269 
dFoundAt
;

271 
rg
 
osgSg
;

272 
osgFoundAt
;

274 
rg
 
gName
;

275 
rg
 
gVue
;

277 
XMLTe
 * 
wTe
;

278 
XMLNode
 * 
wNode
;

280 
áedFoundAt
;

283 
Ut
.
	`ogss
( "#" );

285  
ue
 )

288 
tFoundAt
 = 
agmt
.
	`fd
( "<", 0 );

289 if
tFoundAt
 =
rg
::
os
 )

293 if
agmt
[
tFoundAt
+1] == '/' )

297 
dFoundAt
 = 
agmt
.
	`fd
">", 
tFoundAt
 );

298 if
dFoundAt
 =
rg
::
os
 )

299 
throw
 
w
 
	`EMsg
( "Unclosedagncountered! "

304 
gName
 = 
agmt
.
	`subr

tFoundAt
+1, 
dFoundAt
-startFoundAt-1 );

305 if
gName
.
	`size
() == 0 )

306 
throw
 
w
 
	`EMsg
( "Unnamedagncountered! "

310 
agmt
.
	`a
0, 
tFoundAt
+
gName
.
	`size
()+2 );

313 if
gName
[gName.
	`size
()-1] == '/' )

316 
gName
.
	`a
ЏgName.
	`size
()-1 );

317 
gVue
.
	`a
();

318 
wNode
 = 
w
 
	`XMLNode

gName
, 
gVue
 );

319 

->
	`addNode

wNode
 );

323 
osgSg
.
	`a
();

324 
osgSg
 +"</" + 
gName
 + ">";

325 
osgFoundAt
 = 
agmt
.
	`fd

osgSg
, 0 );

326 if
osgFoundAt
 =
rg
::
os
 )

327 
throw
 
w
 
	`EMsg
( "Closingagot found! "

328 "Ongag '<" + 
gName
 + ">' found, "

329 "bun closg '" + 
osgSg
 + "'." );

332 
áedFoundAt
 = 
agmt
.
	`fd
( "<", 0 );

333 if
áedFoundAt
 =
osgFoundAt
 )

336 
gVue
 = 
agmt
.
	`subr
0, 
osgFoundAt
 );

339 
wNode
 = 
w
 
	`XMLNode

gName
, 
gVue
 );

340 

->
	`addNode

wNode
 );

344 
wTe
 = 
w
 
	`XMLTe

gName
 );

345 

->
	`addNode

wTe
 );

346 
	`rFgmt

agmt
, 
wTe
 );

349 
osgFoundAt
 = 
agmt
.
	`fd

osgSg
, 0 );

350 if
osgFoundAt
 =
rg
::
os
 )

351 
throw
 
w
 
	`EMsg
( "Closingagot found! "

352 "Ongag '<" + 
gName
 + ">' found, "

353 "bun closg '" + 
osgSg
 + "'." );

357 
agmt
.
	`a
0, 
osgFoundAt
 + 
osgSg
.
	`size
() );

360 
	}
}

364 
	gXMLFe
::
	$XMLFe
cڡ 
rg
 & 
_fame
 )

366 
	`adFe

_fame
 );

367 
	}
}

371 
	gXMLFe
::~
	$XMLFe
()

373 if
ro
 !
NULL
 )

374 
de
 
ro
;

375 
	}
}

378 
bo
 
	gXMLFe
::
	$exis
cڡ 
rg
 & 
th
 )

380 
XMLAbNode
 * 
cutNode
 = 
ro
;

381 
XMLTe
 * 
cutTe
;

382 
mePos
;

383 
tPos
;

384 
rg
 
gName
;

386 
mePos
 = 0;

388  
ue
 )

391 
tPos
 = 
th
.
	`fd
"\\", 
mePos
 );

392 if
tPos
 =
rg
::
os
 )

393 
tPos
 = 
th
.
	`size
();

396 
gName
 = 
th
.
	`subr

mePos
, 
tPos
-namePos );

397 
cutTe
 = (
XMLTe
 *
cutNode
;

398 if!
cutTe
->
	`cڏsNode

gName
 ) )

399  
l
;

401 
cutNode
 = 
cutTe
->
	`gNode

gName
 );

404 if
tPos
 < 
th
.
	`size
() )

407 if
cutNode
->
	`gTy
(!
xml_sub
 )

409  
l
;

412 
mePos
 = 
tPos
 + 1;

420  
ue
;

421 
	}
}

424 cڡ 
	grg
 & 
	gXMLFe
::
	$gVue
cڡ 
rg
 & 
th
 )

426 
XMLAbNode
 * 
cutNode
 = 
ro
;

427 
XMLTe
 * 
cutTe
;

428 
mePos
;

429 
tPos
;

430 
rg
 
gName
;

432 
mePos
 = 0;

434  
ue
 )

437 
tPos
 = 
th
.
	`fd
"\\", 
mePos
 );

438 if
tPos
 =
rg
::
os
 )

439 
tPos
 = 
th
.
	`size
();

442 
gName
 = 
th
.
	`subr

mePos
, 
tPos
-namePos );

443 
cutTe
 = (
XMLTe
 *
cutNode
;

444 if!
cutTe
->
	`cڏsNode

gName
 ) )

445 
throw
 
w
 
	`EMsg
"Nod'" + 
gName
 + "'ot found!" );

447 
cutNode
 = 
cutTe
->
	`gNode

gName
 );

450 if
tPos
 < 
th
.
	`size
() )

453 if
cutNode
->
	`gTy
(!
xml_sub
 )

455 
throw
 
w
 
	`EMsg
"Iegh: (" + 
th
 + ")!" );

458 
mePos
 = 
tPos
 + 1;

467 if
cutNode
->
	`gTy
(!
xml_node
 )

468 
throw
 
w
 
	`EMsg
"Nod'" + 
gName
 + "' isotnlement!" );

470  ((
XMLNode
 *
cutNode
)->
	`gVue
();

471 
	}
}

474 
	gXMLFe
::
	$t
()

476 
ro
->
	`t
();

477 
	}
}

481 
	gXMLAbNode
::
	$XMLAbNode
cڡ 
rg
 & 
_me
, 
XMLNodeTy
 
_ty
 ) :

482 
	`me

_me
 ),

483 
	$ty

_ty
 )

486 
	}
}

490 
	gXMLAbNode
::~
	$XMLAbNode
()

493 
	}
}

496 cڡ 
rg
 & 
XMLAbNode
::
	$gName
()

498  
me
;

499 
	}
}

502 
XMLNodeTy
 
	gXMLAbNode
::
	$gTy
()

504  
ty
;

505 
	}
}

508 
bo
 
	gXMLAbNode
::
	$isName
cڡ 
rg
 & 
_me
 )

510  (
me
 =
_me
);

511 
	}
}

515 
	gXMLTe
::
	$XMLTe
cڡ 
rg
 & 
_me
 ) :

516 
XMLAbNode
::
	$XMLAbNode

_me
, 
xml_sub
 )

519 
	}
}

523 
	gXMLTe
::~
	$XMLTe
()

526 
li
<
XMLAbNode
 *>::

 
i
;

529  
i
 = 
nodes
.
	`beg
(); i !nodes.
	`d
(); i++ )

531 
	`de
 (*
i
);

533 
	}
}

536 
	gXMLTe
::
	$addNode

XMLAbNode
 * 
wnode
 )

538 
nodes
.
	`push_back

wnode
 );

539 
	}
}

542 
bo
 
	gXMLTe
::
	$cڏsNode
cڡ 
rg
 & 
_me
 )

545 
li
<
XMLAbNode
 *>::

 
i
;

548 
i
 = 
nodes
.
	`beg
();

550  
i
 !
nodes
.
	`d
() )

552 if(*
i
)->
	`isName

_me
 ) )

553  
ue
;

555 
i
++;

558  
l
;

559 
	}
}

562 
XMLAbNode
 * 
	gXMLTe
::
	$gNode
cڡ 
rg
 & 
_me
 )

565 
li
<
XMLAbNode
 *>::

 
i
;

568 
i
 = 
nodes
.
	`beg
();

570  
i
 !
nodes
.
	`d
() )

572 if(*
i
)->
	`isName

_me
 ) )

573  *
i
;

575 
i
++;

578  
NULL
;

579 
	}
}

582 
	gXMLTe
::
	$t
()

585 
li
<
XMLAbNode
 *>::

 
i
;

587 
cout
 << "TREE[ Name: \"" << 
me
 << "\" ]:" << 
dl
;

590 
i
 = 
nodes
.
	`beg
();

592  
i
 !
nodes
.
	`d
() )

594 (*
i
)->
	`t
();

596 
i
++;

599 
cout
 << ":END[\"" << 
me
 << "\"]" << 
dl
;

600 
	}
}

604 
	gXMLNode
::
	$XMLNode
cڡ 
rg
 & 
_me
, cڡ sg & 
_vue
 ) :

605 
XMLAbNode
::
	`XMLAbNode

_me
, 
xml_node
 ),

606 
	$vue

_vue
 )

609 
	}
}

613 
	gXMLNode
::~
	$XMLNode
()

616 
	}
}

619 
bo
 
XMLNode
::
	$isEmy
()

621  
vue
.
	`emy
();

622 
	}
}

625 cڡ 
	grg
 & 
	gXMLNode
::
	$gVue
()

627  
vue
;

628 
	}
}

631 
	gXMLNode
::
	$t
()

633 
cout
 << "NODE[ Name: \"" << 
me
 << "\" Vue: \"" << 
vue
 << "\" ]" << 
dl
;

634 
	}
}

	@ports/bdk-atxx4-mstp/avrosp/XMLParser.hpp

22 #ide
XMLPARSER_HPP


23 
	#XMLPARSER_HPP


	)

25 
usg
 
mea
 
	gd
;

27 
	~"EMsg.h
"

28 
	~"Uty.h
"

29 
	~<ioam
>

30 
	~<fam
>

31 
	~<li
>

33 
ass
 
	gXMLAbNode
;

34 
ass
 
	gXMLTe
;

35 
ass
 
	gXMLNode
;

39 as
	cXMLFe


41 
	meed
:

42 
XMLTe
 * 
ro
;

44 
	mXMLFe
::
moveSXML

rg
 & 
txt
 );

45 
moveCommts

rg
 & 
txt
 );

46 
moveAribus

rg
 & 
txt
 );

47 
adFe
cڡ 
rg
 & 
_fame
 );

48 
rFgmt

rg
 & 
agmt
, 
XMLTe
 * 

 );

50 
	mpublic
:

52 
XMLFe
cڡ 
rg
 & 
_fame
 );

55 ~
XMLFe
();

58 
bo
 
exis
cڡ 
rg
 & 
th
 );

59 cڡ 
	mrg
 & 
gVue
cڡ 
rg
 & 
th
 );

61 
t
();

	@ports/bdk-atxx4-mstp/avrosp/main.cpp

21 
	~"JobInfo.h
"

22 
	~<ve
>

23 
	~<rg
>

25 
usg
 
mea
 
	gd
;

28 
	$ma
(
gc
, *
gv
[])

30 
JobInfo
 
j
;

32 
y


34 
j
.
	`rCommdle

gc
, 
gv
 );

35 
j
.
	`doJob
();

37 
	`tch

EMsg
 * 
e
 )

39 
cout
 << 
dl
 << "Anrror occurred:" <<ndl;

40 
cout
 << " [" << 
e
->
	`Wh
(<< "]" << 
dl
;

42 
de
 
e
;

46 
	}
}

	@ports/bdk-atxx4-mstp/bacnet.c

25 
	~<dt.h
>

26 
	~<dbo.h
>

28 
	~"hdwe.h
"

29 
	~"tim.h
"

30 
	~"rom.h
"

31 
	~"nvda.h
"

32 
	~"rs485.h
"

33 
	~"put.h
"

34 
	~"adc.h
"

35 
	~"d.h
"

37 
	~"dk.h
"

38 
	~"du.h
"

39 
	~"hdrs.h
"

40 
	~".h
"

41 
	~"txbuf.h
"

42 
	~"dcc.h
"

43 
	~"m.h
"

44 
	~"devi.h
"

45 
	~"ai.h
"

46 
	~"av.h
"

47 
	~"bi.h
"

48 
	~"bo.h
"

50 
	~"ba.h
"

53 
ut8_t
 
	gMSTP_MAC_Addss
;

55 
im
 
	gDCC_Tim
;

56 
	#DCC_CYCLE_SECONDS
 1

	)

58 
bo
 
	$rom_vsi_
(

61 
ut16_t
 
vsi
 = 0;

62 
ut16_t
 
id
 = 0;

63 
bo
 
us
 = 
l
;

64 
rv
;

66 
rv
 = 
	`rom_bys_ad
(
NV_SEEPROM_TYPE_0
, (
ut8_t
 *& 
id
, 2);

67 i(
rv
 > 0) {

68 
rv
 = 
	`rom_bys_ad
(
NV_SEEPROM_VERSION_0
, (
ut8_t
 *& 
vsi
,

72 i((
rv
 > 0&& (
id
 =
SEEPROM_ID
&& (
vsi
 =
SEEPROM_VERSION
)) {

73 
us
 = 
ue
;

74 } i(
rv
 > 0) {

75 
vsi
 = 
SEEPROM_VERSION
;

76 
id
 = 
SEEPROM_ID
;

77 
	`rom_bys_wre
(
NV_SEEPROM_TYPE_0
, (
ut8_t
 *& 
id
, 2);

78 
	`rom_bys_wre
(
NV_SEEPROM_VERSION_0
, (
ut8_t
 *& 
vsi
, 2);

85  
us
;

86 
	}
}

88 
	$devi_id_
(
ut8_t
 
mac
)

90 
ut32_t
 
devi_id
 = 0;

93 
	`om_bys_ad
(
NV_EEPROM_DEVICE_0
, (
ut8_t
 *& 
devi_id
,

94 (
devi_id
));

95 i(
devi_id
 < 
BACNET_MAX_INSTANCE
) {

96 
	`Devi_S_Obje_In_Numb
(
devi_id
);

99 
	`Devi_S_Obje_In_Numb
(
MSTP_MAC_Addss
);

101 
	}
}

103 
	$ba_
(

106 
ut8_t
 
max_ma
 = 0;

108 
MSTP_MAC_Addss
 = 
	`put_addss
();

109 
	`dlmp_t_mac_addss
(
MSTP_MAC_Addss
);

110 
	`om_bys_ad
(
NV_EEPROM_MAX_MASTER
, &
max_ma
, 1);

111 i(
max_ma
 > 127) {

112 
max_ma
 = 127;

114 
	`dlmp_t_max_ma
(
max_ma
);

115 
	`dlmp_
(
NULL
);

117 i(!
	`rom_vsi_
()) {

121 
	`Devi_In
(
NULL
);

122 
	`devi_id_
(
MSTP_MAC_Addss
);

124 
du_t_uecognized_rvi_hdr_hdr


125 (
hdr_uecognized_rvi
);

127 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

128 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_HAS
, 
hdr_who_has
);

131 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

132 
hdr_ad_ݔty
);

133 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

134 
hdr_ad_ݔty_muɝ
);

135 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

136 
hdr_lize_devi
);

137 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

138 
hdr_wre_ݔty
);

140 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

141 
hdr_devi_communiti_cڌ
);

143 
	`tim_rv_t_cds
(&
DCC_Tim
, 
DCC_CYCLE_SECONDS
);

145 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

146 
	}
}

148 
ut8_t
 
	gPDUBufr
[
MAX_MPDU
];

149 
	$ba_sk
(

152 
ut8_t
 
mp_mac_addss
;

153 
ut16_t
 
pdu_n
;

154 
BACNET_ADDRESS
 
c
;

155 
ut16_t
 
vue
;

156 
bo
 
bu_vue
;

157 
ut8_t
 
i
;

158 
BACNET_BINARY_PV
 
by_vue
 = 
BINARY_INACTIVE
;

159 
BACNET_POLARITY
 
pެy
;

160 
bo
 
out_of_rvi
;

162 
mp_mac_addss
 = 
	`put_addss
();

163 i(
MSTP_MAC_Addss
 !
mp_mac_addss
) {

165 
MSTP_MAC_Addss
 = 
mp_mac_addss
;

166 
	`dlmp_t_mac_addss
(
MSTP_MAC_Addss
);

167 
	`devi_id_
(
MSTP_MAC_Addss
);

168 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

171 
vue
 = 
	`adc_su_10b
(7);

172 
	`Alog_Iut_P_Vue_S
(0, 
vue
);

173 
i
 = 0; i < 5; i++) {

174 
bu_vue
 = 
	`put_bu_vue
(
i
);

175 i(
bu_vue
) {

176 
by_vue
 = 
BINARY_ACTIVE
;

178 
by_vue
 = 
BINARY_INACTIVE
;

180 
	`By_Iut_P_Vue_S
(
i
, 
by_vue
);

183 
i
 = 0; i < 2; i++) {

184 
out_of_rvi
 = 
	`By_Ouut_Out_Of_Svi
(
i
);

185 i(!
out_of_rvi
) {

186 
by_vue
 = 
	`By_Ouut_P_Vue
(
i
);

187 
pެy
 = 
	`By_Ouut_Pެy
(
i
);

188 i(
pެy
 !
POLARITY_NORMAL
) {

189 i(
by_vue
 =
BINARY_ACTIVE
) {

190 
by_vue
 = 
BINARY_INACTIVE
;

192 
by_vue
 = 
BINARY_ACTIVE
;

195 i(
by_vue
 =
BINARY_ACTIVE
) {

196 i(
i
 == 0) {

197 
	`d_
(
LED_2
);

199 
	`d_
(
LED_3
);

202 i(
i
 == 0) {

203 
	`d_off
(
LED_2
);

205 
	`d_off
(
LED_3
);

211 i(
	`tim_rv_exped
(&
DCC_Tim
)) {

212 
	`tim_rv_t
(&
DCC_Tim
);

213 
	`dcc_tim_cds
(
DCC_CYCLE_SECONDS
);

216 
pdu_n
 = 
	`dk_ive
(&
c
, &
PDUBufr
[0], (PDUBuffer), 0);

217 i(
pdu_n
) {

218 
	`du_hdr
(&
c
, &
PDUBufr
[0], 
pdu_n
);

220 
	}
}

	@ports/bdk-atxx4-mstp/bacnet.h

24 #ide
BACNET_H


25 
	#BACNET_H


	)

27 
	~<dt.h
>

29 #ifde
__lulus


33 
ba_
(

35 
ba_sk
(

38 #ifde
__lulus


	@ports/bdk-atxx4-mstp/bi.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

35 
	~"bi.h
"

36 
	~"hdrs.h
"

38 #ide
MAX_BINARY_INPUTS


39 
	#MAX_BINARY_INPUTS
 5

	)

42 
BACNET_BINARY_PV
 
	gP_Vue
[
MAX_BINARY_INPUTS
];

45 cڡ 
	gBy_Iut_Prݔts_Requed
[] = {

46 
PROP_OBJECT_IDENTIFIER
,

47 
PROP_OBJECT_NAME
,

48 
PROP_OBJECT_TYPE
,

49 
PROP_PRESENT_VALUE
,

50 
PROP_STATUS_FLAGS
,

51 
PROP_EVENT_STATE
,

52 
PROP_OUT_OF_SERVICE
,

53 
PROP_POLARITY
,

57 cڡ 
	gBy_Iut_Prݔts_Oiڮ
[] = {

61 cڡ 
	gBy_Iut_Prݔts_Prrry
[] = {

65 
	$By_Iut_Prݔty_Lis
(

66 cڡ **
pRequed
,

67 cڡ **
pOiڮ
,

68 cڡ **
pPrrry
)

70 i(
pRequed
) {

71 *
pRequed
 = 
By_Iut_Prݔts_Requed
;

73 i(
pOiڮ
) {

74 *
pOiڮ
 = 
By_Iut_Prݔts_Oiڮ
;

76 i(
pPrrry
) {

77 *
pPrrry
 = 
By_Iut_Prݔts_Prrry
;

81 
	}
}

83 
	$By_Iut_In
(

86 
i
;

88 
i
 = 0; i < 
MAX_BINARY_INPUTS
; i++) {

89 
P_Vue
[
i
] = 
BINARY_INACTIVE
;

91 
	}
}

94 
bo
 
	$By_Iut_Vid_In
(

95 
ut32_t
 
obje_
)

97 i(
obje_
 < 
MAX_BINARY_INPUTS
)

98  
ue
;

100  
l
;

101 
	}
}

104 
	$By_Iut_Cou
(

107  
MAX_BINARY_INPUTS
;

108 
	}
}

111 
ut32_t
 
	$By_Iut_Index_To_In
(

112 
dex
)

114  
dex
;

115 
	}
}

120 
	$By_Iut_In_To_Index
(

121 
ut32_t
 
obje_
)

123 
dex
 = 
MAX_BINARY_INPUTS
;

125 i(
obje_
 < 
MAX_BINARY_INPUTS
)

126 
dex
 = 
obje_
;

128  
dex
;

129 
	}
}

131 
BACNET_BINARY_PV
 
	$By_Iut_P_Vue
(

132 
ut32_t
 
obje_
)

134 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

135 
dex
 = 0;

137 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

138 i(
dex
 < 
MAX_BINARY_INPUTS
) {

139 
vue
 = 
P_Vue
[
dex
];

142  
vue
;

143 
	}
}

145 
bo
 
	$By_Iut_P_Vue_S
(

146 
ut32_t
 
obje_
,

147 
BACNET_BINARY_PV
 
vue
)

149 
dex
 = 0;

151 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

152 i(
dex
 < 
MAX_BINARY_INPUTS
) {

153 
P_Vue
[
dex
] = 
vue
;

154  
ue
;

157  
l
;

158 
	}
}

160 
bo
 
	$By_Iut_Obje_Name
(

161 
ut32_t
 
obje_
,

162 
BACNET_CHARACTER_STRING
 * 
obje_me
)

164 
xt_rg
[32];

165 
bo
 
us
 = 
l
;

167 i(
obje_
 < 
MAX_BINARY_INPUTS
) {

168 
	`rtf
(
xt_rg
, "BI-%lu", 
obje_
);

169 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

172  
us
;

173 
	}
}

177 
	$By_Iut_Rd_Prݔty
(

178 
BACNET_READ_PROPERTY_DATA
 * 
da
)

180 
du_n
 = 0;

181 
BACNET_BIT_STRING
 
b_rg
 = { 0 };

182 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

183 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

184 
BACNET_CHARACTER_STRING
 
ch_rg
 = { 0 };

185 
ut8_t
 *
du
 = 
NULL
;

187 i((
da
->
iti_da
 =
NULL
) ||

188 (
da
->
iti_da_n
 == 0)) {

191 
du
 = 
da
->
iti_da
;

192 
da
->
obje_ݔty
) {

193 
PROP_OBJECT_IDENTIFIER
:

194 
du_n
 =

195 
	`code_iti_obje_id
(&
du
[0], 
da
->
obje_ty
,

196 
da
->
obje_
);

198 
PROP_OBJECT_NAME
:

199 
	`By_Iut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

200 
du_n
 =

201 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

203 
PROP_OBJECT_TYPE
:

204 
du_n
 =

205 
	`code_iti_umed
(&
du
[0], 
da
->
obje_ty
);

207 
PROP_PRESENT_VALUE
:

208 
vue
 = 
	`By_Iut_P_Vue
(
da
->
obje_
);

209 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
vue
);

211 
PROP_STATUS_FLAGS
:

213 
	`brg_
(&
b_rg
);

214 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

215 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

216 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

217 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

218 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

220 
PROP_EVENT_STATE
:

222 
du_n
 =

223 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

225 
PROP_OUT_OF_SERVICE
:

226 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

228 
PROP_POLARITY
:

229 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
pެy
);

232 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

233 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

234 
du_n
 = 
BACNET_STATUS_ERROR
;

238 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

239 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

240 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

241 
du_n
 = 
BACNET_STATUS_ERROR
;

244  
du_n
;

245 
	}
}

	@ports/bdk-atxx4-mstp/bname.c

25 
	~<dt.h
>

26 
	~<dbo.h
>

27 
	~<dlib.h
>

28 
	~<rg.h
>

29 
	~"hdwe.h
"

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"bacr.h
"

33 
	~"nvda.h
"

34 
	~"rom.h
"

35 
	~"devi.h
"

36 
	~"bme.h
"

38 
bo
 
	$ba_me_isvid
(

39 
ut8_t
 
codg
,

40 
ut8_t
 
ngth
,

41 *
r
)

43 
bo
 
vid
 = 
l
;

45 i((
codg
 < 
MAX_CHARACTER_STRING_ENCODING
) &&

46 (
ngth
 <
NV_EEPROM_NAME_SIZE
)) {

47 i(
codg
 =
CHARACTER_UTF8
) {

48 
vid
 = 
	`utf8_isvid
(
r
, 
ngth
);

50 
vid
 = 
ue
;

54  
vid
;

55 
	}
}

57 
bo
 
	$ba_me_ve
(

58 
ut16_t
 
offt
,

59 
ut8_t
 
codg
,

60 *
r
,

61 
ut8_t
 
ngth
)

63 
ut8_t
 
bufr
[
NV_EEPROM_NAME_SIZE
] = { 0 };

64 
ut8_t
 
i
 = 0;

66 i(
	`ba_me_isvid
(
codg
, 
ngth
, 
r
)) {

67 
	`om_bys_wre
(
	`NV_EEPROM_NAME_LENGTH
(
offt
), &
ngth
, 1);

68 
	`om_bys_wre
(
	`NV_EEPROM_NAME_ENCODING
(
offt
),

69 (
ut8_t
 *& 
codg
, 1);

70 
i
 = 0; i < 
ngth
; i++) {

71 
bufr
[
i
] = 
r
[i];

73 
	`om_bys_wre
(
	`NV_EEPROM_NAME_STRING
(
offt
), &
bufr
[0],

74 
NV_EEPROM_NAME_SIZE
);

75  
ue
;

78  
l
;

79 
	}
}

81 
bo
 
	$ba_me_t
(

82 
ut16_t
 
offt
,

83 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

85 
ut8_t
 
codg
 = 0;

86 
ut8_t
 
ngth
 = 0;

87 *
r
 = 
NULL
;

89 
ngth
 = 
	`charg_ngth
(
ch_rg
);

90 
codg
 = 
	`charg_codg
(
ch_rg
);

91 
r
 = 
	`charg_vue
(
ch_rg
);

92  
	`ba_me_ve
(
offt
, 
codg
, 
r
, 
ngth
);

93 
	}
}

95 
bo
 
	$ba_me_wre_unique
(

96 
ut16_t
 
offt
,

97 
obje_ty
,

98 
ut32_t
 
obje_
,

99 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

100 
BACNET_ERROR_CLASS
 * 
r_ass
,

101 
BACNET_ERROR_CODE
 * 
r_code
)

103 
bo
 
us
 = 
l
;

104 
size_t
 
ngth
 = 0;

105 
ut8_t
 
codg
 = 0;

106 
dui_ty
 = 0;

107 
ut32_t
 
dui_
 = 0;

109 
ngth
 = 
	`charg_ngth
(
ch_rg
);

110 i(
ngth
 < 1) {

111 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

112 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

113 } i(
ngth
 <
NV_EEPROM_NAME_SIZE
) {

114 
codg
 = 
	`charg_codg
(
ch_rg
);

115 i(
codg
 < 
MAX_CHARACTER_STRING_ENCODING
) {

116 i(
	`Devi_Vid_Obje_Name
(
ch_rg
, &
dui_ty
,

117 &
dui_
)) {

118 i((
dui_ty
 =
obje_ty
) &&

119 (
dui_
 =
obje_
)) {

121 
us
 = 
ue
;

123 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

124 *
r_code
 = 
ERROR_CODE_DUPLICATE_NAME
;

127 
us
 = 
	`ba_me_t
(
offt
, 
ch_rg
);

128 i(
us
) {

129 
	`Devi_Inc_Daba_Revisi
();

131 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

132 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

136 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

137 *
r_code
 = 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

140 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

141 *
r_code
 = 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

144  
us
;

145 
	}
}

148 
bo
 
	$ba_me_wre
(

149 
ut16_t
 
offt
,

150 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

151 
BACNET_ERROR_CLASS
 * 
r_ass
,

152 
BACNET_ERROR_CODE
 * 
r_code
)

154 
bo
 
us
 = 
l
;

155 
size_t
 
ngth
 = 0;

156 
ut8_t
 
codg
 = 0;

158 
ngth
 = 
	`charg_ngth
(
ch_rg
);

159 i(
ngth
 <
NV_EEPROM_NAME_SIZE
) {

160 
codg
 = 
	`charg_codg
(
ch_rg
);

161 i(
codg
 < 
MAX_CHARACTER_STRING_ENCODING
) {

162 
us
 = 
	`ba_me_t
(
offt
, 
ch_rg
);

163 i(!
us
) {

164 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

165 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

168 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

169 *
r_code
 = 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

172 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

173 *
r_code
 = 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

176  
us
;

177 
	}
}

179 
	$ba_me_
(

180 
ut16_t
 
offt
,

181 *
deu_rg
)

183 (
	`ba_me_ve
(
offt
, 
CHARACTER_UTF8
, 
deu_rg
,

184 
	`
(
deu_rg
));

185 
	}
}

187 
	$ba_me
(

188 
ut16_t
 
offt
,

189 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

190 *
deu_rg
)

192 
ut8_t
 
codg
 = 0;

193 
ut8_t
 
ngth
 = 0;

194 
me
[
NV_EEPROM_NAME_SIZE
 + 1] = "";

196 
	`om_bys_ad
(
	`NV_EEPROM_NAME_ENCODING
(
offt
), &
codg
, 1);

197 
	`om_bys_ad
(
	`NV_EEPROM_NAME_LENGTH
(
offt
), &
ngth
, 1);

198 
	`om_bys_ad
(
	`NV_EEPROM_NAME_STRING
(
offt
), (
ut8_t
 *& 
me
,

199 
NV_EEPROM_NAME_SIZE
);

200 i(
	`ba_me_isvid
(
codg
, 
ngth
, 
me
)) {

201 
	`charg_
(
ch_rg
, 
codg
, &
me
[0], 
ngth
);

202 } i(
deu_rg
) {

203 
	`ba_me_
(
offt
, 
deu_rg
);

204 
	`charg__si
(
ch_rg
, 
deu_rg
);

206 
	}
}

	@ports/bdk-atxx4-mstp/bname.h

24 #ide
BACNET_NAME_H


25 
	#BACNET_NAME_H


	)

27 
	~<dt.h
>

28 
	~"bacr.h
"

30 #ifde
__lulus


34 
bo
 
ba_me_t
(

35 
ut16_t
 
om_offt
,

36 
BACNET_CHARACTER_STRING
 * 
ch_rg
);

37 
ba_me_
(

38 
ut16_t
 
om_offt
,

39 *
deu_rg
);

40 
bo
 
ba_me_ve
(

41 
ut16_t
 
offt
,

42 
ut8_t
 
codg
,

43 *
r
,

44 
ut8_t
 
ngth
);

45 
ba_me
(

46 
ut16_t
 
om_offt
,

47 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

48 *
deu_rg
);

49 
bo
 
ba_me_wre_unique
(

50 
ut16_t
 
offt
,

51 
obje_ty
,

52 
ut32_t
 
obje_
,

53 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

54 
BACNET_ERROR_CLASS
 * 
r_ass
,

55 
BACNET_ERROR_CODE
 * 
r_code
);

57 
bo
 
ba_me_wre
(

58 
ut16_t
 
offt
,

59 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

60 
BACNET_ERROR_CLASS
 * 
r_ass
,

61 
BACNET_ERROR_CODE
 * 
r_code
);

63 #ifde
__lulus


	@ports/bdk-atxx4-mstp/bo.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

35 
	~"wp.h
"

36 
	~"hdwe.h
"

37 
	~"d.h
"

38 
	~"nvda.h
"

39 
	~"bo.h
"

40 
	~"hdrs.h
"

42 #ide
MAX_BINARY_OUTPUTS


43 
	#MAX_BINARY_OUTPUTS
 2

	)

48 
	#RELINQUISH_DEFAULT
 
BINARY_INACTIVE


	)

50 
ut8_t
 
	gBy_Ouut_Lev
[
MAX_BINARY_OUTPUTS
][
BACNET_MAX_PRIORITY
];

53 
ut8_t
 
	gOut_Of_Svi
[
MAX_BINARY_OUTPUTS
];

55 
ut8_t
 
	gPެy
[
MAX_BINARY_OUTPUTS
];

58 cڡ 
	gBy_Ouut_Prݔts_Requed
[] = {

59 
PROP_OBJECT_IDENTIFIER
,

60 
PROP_OBJECT_NAME
,

61 
PROP_OBJECT_TYPE
,

62 
PROP_PRESENT_VALUE
,

63 
PROP_STATUS_FLAGS
,

64 
PROP_EVENT_STATE
,

65 
PROP_OUT_OF_SERVICE
,

66 
PROP_POLARITY
,

67 
PROP_PRIORITY_ARRAY
,

68 
PROP_RELINQUISH_DEFAULT
,

72 cڡ 
	gBy_Ouut_Prݔts_Oiڮ
[] = {

73 
PROP_ACTIVE_TEXT
,

74 
PROP_INACTIVE_TEXT
,

78 cڡ 
	gBy_Ouut_Prݔts_Prrry
[] = {

82 
	$By_Ouut_Prݔty_Lis
(

83 cڡ **
pRequed
,

84 cڡ **
pOiڮ
,

85 cڡ **
pPrrry
)

87 i(
pRequed
)

88 *
pRequed
 = 
By_Ouut_Prݔts_Requed
;

89 i(
pOiڮ
)

90 *
pOiڮ
 = 
By_Ouut_Prݔts_Oiڮ
;

91 i(
pPrrry
)

92 *
pPrrry
 = 
By_Ouut_Prݔts_Prrry
;

95 
	}
}

98 
bo
 
	$By_Ouut_Vid_In
(

99 
ut32_t
 
obje_
)

101 i(
obje_
 < 
MAX_BINARY_OUTPUTS
)

102  
ue
;

104  
l
;

105 
	}
}

108 
	$By_Ouut_Cou
(

111  
MAX_BINARY_OUTPUTS
;

112 
	}
}

115 
ut32_t
 
	$By_Ouut_Index_To_In
(

116 
dex
)

118  
dex
;

119 
	}
}

122 
	$By_Ouut_In_To_Index
(

123 
ut32_t
 
obje_
)

125 
dex
 = 
MAX_BINARY_OUTPUTS
;

127 i(
obje_
 < 
MAX_BINARY_OUTPUTS
)

128 
dex
 = 
obje_
;

130  
dex
;

131 
	}
}

133 
BACNET_BINARY_PV
 
	$P_Vue
(

134 
dex
)

136 
BACNET_BINARY_PV
 
vue
 = 
RELINQUISH_DEFAULT
;

137 
BACNET_BINARY_PV
 
cut_vue
 = 
RELINQUISH_DEFAULT
;

138 
i
 = 0;

140 i(
dex
 < 
MAX_BINARY_OUTPUTS
) {

141 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

142 
cut_vue
 = (
BACNET_BINARY_PV

By_Ouut_Lev
[
dex
][
i
];

143 i(
cut_vue
 !
BINARY_NULL
) {

144 
vue
 = (
BACNET_BINARY_PV

By_Ouut_Lev
[
dex
][
i
];

150  
vue
;

151 
	}
}

153 
BACNET_BINARY_PV
 
	$By_Ouut_P_Vue
(

154 
ut32_t
 
obje_
)

156 
dex
 = 0;

158 
dex
 = 
	`By_Ouut_In_To_Index
(
obje_
);

160  
	`P_Vue
(
dex
);

161 
	}
}

163 
bo
 
	$By_Ouut_P_Vue_S
(

164 
ut32_t
 

,

165 
BACNET_BINARY_PV
 
by_vue
,

166 
iܙy
)

168 
bo
 
us
 = 
l
;

170 i(

 < 
MAX_BINARY_OUTPUTS
) {

171 i(
iܙy
 < 
BACNET_MAX_PRIORITY
) {

172 
By_Ouut_Lev
[

][
iܙy
] = (
ut8_t

by_vue
;

173 
	`rom_bys_wre
(
	`NV_SEEPROM_BINARY_OUTPUT
(

,

174 
NV_SEEPROM_BO_PRIORITY_ARRAY_1
 + 
iܙy
),

175 &
By_Ouut_Lev
[

][
iܙy
], 1);

176 
us
 = 
ue
;

180  
us
;

181 
	}
}

183 
bo
 
	$By_Ouut_Pެy_S
(

184 
ut32_t
 

,

185 
BACNET_POLARITY
 
pެy
)

187 
bo
 
us
 = 
l
;

189 i(

 < 
MAX_BINARY_OUTPUTS
) {

190 i(
pެy
 < 
MAX_POLARITY
) {

191 
Pެy
[

] = 
pެy
;

192 
	`rom_bys_wre
(
	`NV_SEEPROM_BINARY_OUTPUT
(

,

193 
NV_SEEPROM_BO_POLARITY
), &
Pެy
[

], 1);

194 
us
 = 
ue
;

198  
us
;

199 
	}
}

201 
BACNET_POLARITY
 
	$By_Ouut_Pެy
(

202 
ut32_t
 

)

204 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

206 i(

 < 
MAX_BINARY_OUTPUTS
) {

207 
pެy
 = (
BACNET_POLARITY

Pެy
[

];

210  
pެy
;

211 
	}
}

213 
	$By_Ouut_Out_Of_Svi_S
(

214 
ut32_t
 

,

215 
bo
 
ag
)

217 i(

 < 
MAX_BINARY_OUTPUTS
) {

218 
Out_Of_Svi
[

] = 
ag
;

219 
	`rom_bys_wre
(
	`NV_SEEPROM_BINARY_OUTPUT
(

,

220 
NV_SEEPROM_BO_OUT_OF_SERVICE
), &
Out_Of_Svi
[

], 1);

222 
	}
}

224 
bo
 
	$By_Ouut_Out_Of_Svi
(

225 
ut32_t
 

)

227 
bo
 
ag
 = 
l
;

229 i(

 < 
MAX_BINARY_OUTPUTS
) {

230 
ag
 = 
Out_Of_Svi
[

];

233  
ag
;

234 
	}
}

237 
bo
 
	$By_Ouut_Obje_Name
(

238 
ut32_t
 
obje_
,

239 
BACNET_CHARACTER_STRING
 * 
obje_me
)

241 
xt_rg
[32];

242 
bo
 
us
 = 
l
;

244 i(
obje_
 < 
MAX_BINARY_OUTPUTS
) {

245 
	`rtf
(
xt_rg
, "BO-%lu", 
obje_
);

246 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

249  
us
;

250 
	}
}

253 
	$By_Ouut_Rd_Prݔty
(

254 
BACNET_READ_PROPERTY_DATA
 * 
da
)

256 
n
 = 0;

257 
du_n
 = 0;

258 
BACNET_BIT_STRING
 
b_rg
 = { 0 };

259 
BACNET_CHARACTER_STRING
 
ch_rg
 = { 0 };

260 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

261 
obje_dex
 = 0;

262 
i
 = 0;

263 
bo
 
e
 = 
l
;

264 
ut8_t
 *
du
 = 
NULL
;

266 i((
da
->
iti_da
 =
NULL
) ||

267 (
da
->
iti_da_n
 == 0)) {

270 
du
 = 
da
->
iti_da
;

271 
da
->
obje_ݔty
) {

272 
PROP_OBJECT_IDENTIFIER
:

273 
du_n
 =

274 
	`code_iti_obje_id
(&
du
[0], 
da
->
obje_ty
,

275 
da
->
obje_
);

277 
PROP_OBJECT_NAME
:

278 
	`By_Ouut_Obje_Name
(
da
->
obje_
, &
ch_rg
);

279 
du_n
 =

280 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

282 
PROP_OBJECT_TYPE
:

283 
du_n
 =

284 
	`code_iti_umed
(&
du
[0], 
da
->
obje_ty
);

286 
PROP_PRESENT_VALUE
:

287 
e_vue
 =

288 
	`By_Ouut_P_Vue
(
da
->
obje_
);

289 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

291 
PROP_STATUS_FLAGS
:

293 
	`brg_
(&
b_rg
);

294 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

295 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

296 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

297 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

298 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

300 
PROP_EVENT_STATE
:

302 
du_n
 =

303 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

305 
PROP_OUT_OF_SERVICE
:

306 
obje_dex
 =

307 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

308 
e
 = 
Out_Of_Svi
[
obje_dex
];

309 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

311 
PROP_POLARITY
:

312 
obje_dex
 =

313 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

314 
du_n
 =

315 
	`code_iti_umed
(&
du
[0],

316 
Pެy
[
obje_dex
]);

318 
PROP_PRIORITY_ARRAY
:

320 i(
da
->
y_dex
 == 0)

321 
du_n
 =

322 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

325 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

326 
obje_dex
 =

327 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

328 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

330 
e_vue
 = (
BACNET_BINARY_PV
)

331 
By_Ouut_Lev
[
obje_dex
][
i
];

332 i(
e_vue
 =
BINARY_NULL
) {

333 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

335 
n
 =

336 
	`code_iti_umed
(&
du
[
du_n
],

337 
e_vue
);

340 i((
du_n
 + 
n
< 
MAX_APDU
)

341 
du_n
 +
n
;

343 
da
->
r_code
 =

344 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

345 
du_n
 = 
BACNET_STATUS_ABORT
;

350 
obje_dex
 =

351 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

352 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

353 
e_vue
 = (
BACNET_BINARY_PV
)

354 
By_Ouut_Lev
[
obje_dex
][
da
->
y_dex
 -

356 i(
e_vue
 =
BINARY_NULL
) {

357 
du_n
 = 
	`code_iti_nu
(&
du
[apdu_len]);

359 
du_n
 =

360 
	`code_iti_umed
(&
du
[
du_n
],

361 
e_vue
);

364 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

365 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

366 
du_n
 = 
BACNET_STATUS_ERROR
;

370 
PROP_RELINQUISH_DEFAULT
:

371 
e_vue
 = 
RELINQUISH_DEFAULT
;

372 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

374 
PROP_ACTIVE_TEXT
:

375 
	`charg__si
(&
ch_rg
, "on");

376 
du_n
 =

377 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

379 
PROP_INACTIVE_TEXT
:

380 
	`charg__si
(&
ch_rg
, "off");

381 
du_n
 =

382 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

385 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

386 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

387 
du_n
 = 
BACNET_STATUS_ERROR
;

391 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

392 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

393 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

394 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

395 
du_n
 = 
BACNET_STATUS_ERROR
;

398  
du_n
;

399 
	}
}

402 
bo
 
	$By_Ouut_Wre_Prݔty
(

403 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

405 
bo
 
us
 = 
l
;

406 
iܙy
 = 0;

407 
BACNET_BINARY_PV
 
v
 = 
BINARY_NULL
;

408 
n
 = 0;

409 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

412 
n
 =

413 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

414 
wp_da
->
iti_da_n
, &
vue
);

416 i(
n
 < 0) {

418 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

419 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

420  
l
;

422 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

423 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

425 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

426 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

427  
l
;

429 
wp_da
->
obje_ݔty
) {

430 
PROP_PRESENT_VALUE
:

431 
us
 =

432 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

433 &
wp_da
->
r_ass
, &wp_da->
r_code
);

434 i(
us
) {

435 
iܙy
 = 
wp_da
->priority;

439 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

440 (
iܙy
 != 6 ) &&

441 (
vue
.
ty
.
Enumed
 <
MAX_BINARY_PV
)) {

442 
v
 = (
BACNET_BINARY_PV

vue
.
ty
.
Enumed
;

443 
iܙy
--;

444 
	`By_Ouut_P_Vue_S
(
wp_da
->
obje_
,

445 
v
, 
iܙy
);

446 } i(
iܙy
 == 6) {

450 
us
 = 
l
;

451 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

452 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

454 
us
 = 
l
;

455 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

456 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

459 
us
 =

460 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_NULL
,

461 &
wp_da
->
r_ass
, &wp_da->
r_code
);

462 i(
us
) {

463 
v
 = 
BINARY_NULL
;

464 
iܙy
 = 
wp_da
->priority;

465 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

466 
iܙy
--;

467 
By_Ouut_P_Vue_S


468 (
wp_da
->
obje_
, 
v
, 
iܙy
);

469 } i(
iܙy
 == 6) {

470 
us
 = 
l
;

474 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

475 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

477 
us
 = 
l
;

478 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

479 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

484 
PROP_OUT_OF_SERVICE
:

485 
us
 =

486 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

487 &
wp_da
->
r_ass
, &wp_da->
r_code
);

488 i(
us
) {

489 
	`By_Ouut_Out_Of_Svi_S
(
wp_da
->
obje_
,

490 
vue
.
ty
.
Boޗn
);

493 
PROP_POLARITY
:

494 
us
 =

495 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

496 &
wp_da
->
r_ass
, &wp_da->
r_code
);

497 i(
us
) {

498 i(
vue
.
ty
.
Enumed
 < 
MAX_POLARITY
) {

499 
	`By_Ouut_Pެy_S
(
wp_da
->
obje_
,

500 (
BACNET_POLARITY

vue
.
ty
.
Enumed
);

502 
us
 = 
l
;

503 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

504 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

508 
PROP_OBJECT_IDENTIFIER
:

509 
PROP_OBJECT_NAME
:

510 
PROP_OBJECT_TYPE
:

511 
PROP_STATUS_FLAGS
:

512 
PROP_EVENT_STATE
:

513 
PROP_PRIORITY_ARRAY
:

514 
PROP_RELINQUISH_DEFAULT
:

515 
PROP_ACTIVE_TEXT
:

516 
PROP_INACTIVE_TEXT
:

517 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

518 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

521 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

522 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

526 
n
 =en;

528  
us
;

529 
	}
}

531 
	$By_Ouut_In
(

534 
i
, 
j
;

538 
i
 = 0; i < 
MAX_BINARY_OUTPUTS
; i++) {

539 
	`rom_bys_ad
(
	`NV_SEEPROM_BINARY_OUTPUT
(
i
, 
NV_SEEPROM_BO_POLARITY
),

540 &
Pެy
[
i
], 1);

541 i(
Pެy
[
i
] >
MAX_POLARITY
) {

542 
	`By_Ouut_Pެy_S
(
i
, 
POLARITY_NORMAL
);

544 
	`rom_bys_ad
(
	`NV_SEEPROM_BINARY_OUTPUT
(
i
,

545 
NV_SEEPROM_BO_OUT_OF_SERVICE
), &
Out_Of_Svi
[
i
], 1);

546 i(
Out_Of_Svi
[
i
] > 1) {

547 
	`By_Ouut_Out_Of_Svi_S
(
i
, 
l
);

549 
j
 = 0; j < 
BACNET_MAX_PRIORITY
; j++) {

550 
	`rom_bys_ad
(
	`NV_SEEPROM_BINARY_OUTPUT
(
i
,

551 
NV_SEEPROM_BO_PRIORITY_ARRAY_1
 + 
j
),

552 &
By_Ouut_Lev
[
i
][
j
], 1);

557 
	}
}

	@ports/bdk-atxx4-mstp/bootloader/defines.h

2 #ide
PPINC


3 
	#_ATMEGA644P


	)

4 
	#_B2048


	)

5 #ifde
__ICCAVR__


6 
	~"iom644.h
"

8 #i
__GNUC__


9 
	~<avr/io.h
>

11 #i(
__GNUC__
 <4&& (
__GNUC_MINOR__
 < 3)

13 #i!
defed
(
EEWE
&& defed(
EEPE
)

14 
	#EEWE
 
EEPE


	)

17 #i!
defed
(
EEMWE
&& defed(
EEMPE
)

18 
	#EEMWE
 
EEMPE


	)

25 
	#PROGPORT
 
PORTB


	)

26 
	#PROGPIN
 
PINB


	)

27 
	#PROG_NO
 
PB0


	)

30 
	#CPU_FREQ
 18430000

	)

31 
	#BAUD_RATE
 115200

	)

32 
	#BRREG_VALUE
 9

	)

35 
	#BAUD_RATE_LOW_REG
 
UBRR1


	)

36 
	#UART_CONTROL_REG
 
UCSR1B


	)

37 
	#ENABLE_TRANSMITTER_BIT
 
TXEN1


	)

38 
	#ENABLE_RECEIVER_BIT
 
RXEN1


	)

39 
	#UART_STATUS_REG
 
UCSR1A


	)

40 
	#TRANSMIT_COMPLETE_BIT
 
TXC1


	)

41 
	#RECEIVE_COMPLETE_BIT
 
RXC1


	)

42 
	#UART_DATA_REG
 
UDR1


	)

45 
	#SPMCR_REG
 
SPMCSR


	)

46 
	#PAGESIZE
 256

	)

47 
	#APP_END
 61440

	)

51 
	#PARTCODE
 0

	)

52 
	#SIGNATURE_BYTE_1
 0x1E

	)

53 
	#SIGNATURE_BYTE_2
 0x96

	)

54 
	#SIGNATURE_BYTE_3
 0x0A

	)

57 
	#PPINC


	)

	@ports/bdk-atxx4-mstp/bootloader/flash.h

20 #i
defed
(
__ICCAVR__
)

23 
	~<avr.h
>

25 
	#_GET_LOCK_BITS
(
	`__AddrToZByToSPMCR_LPM
(
__ash
 *0x0001, 0x09 )

	)

26 
	#_GET_LOW_FUSES
(
	`__AddrToZByToSPMCR_LPM
(
__ash
 *0x0000, 0x09 )

	)

27 
	#_GET_HIGH_FUSES
(
	`__AddrToZByToSPMCR_LPM
(
__ash
 *0x0003, 0x09 )

	)

28 
	#_GET_EXTENDED_FUSES
(
	`__AddrToZByToSPMCR_LPM
(
__ash
 *0x0002, 0x09 )

	)

29 
	#_SET_LOCK_BITS
(
da

	`__DaToR0ByToSPMCR_SPM
da, 0x09 )

	)

30 
	#_ENABLE_RWW_SECTION
(
	`__DaToR0ByToSPMCR_SPM
0x00, 0x11 )

	)

32 
	#_WAIT_FOR_SPM
( 
SPMCR_REG
 & (1<<
SPMEN
);

	)

34 #ide
LARGE_MEMORY


35 
	#_LOAD_PROGRAM_MEMORY
(
addr

	`__ld_ogm_memy
(cڡ 
__ash
 *ddr)

	)

36 
	#_FILL_TEMP_WORD
(
addr
,
da

	`__AddrToZWdToR1R0ByToSPMCR_SPM
(
__ash
 *ddr), da, 0x01 )

	)

37 
	#_PAGE_ERASE
(
addr

	`__AddrToZByToSPMCR_SPM
(
__ash
 *ddr), 0x03 )

	)

38 
	#_PAGE_WRITE
(
addr

	`__AddrToZByToSPMCR_SPM
(
__ash
 *ddr), 0x05 )

	)

40 
	#_LOAD_PROGRAM_MEMORY
(
addr

	`__exnded_ld_ogm_memy
(cڡ 
__rash
 *ddr)

	)

41 
	#_FILL_TEMP_WORD
(
addr
,
da

	`__AddrToZ24WdToR1R0ByToSPMCR_SPM
(
__rash
 *ddr), da, 0x01 )

	)

42 
	#_PAGE_ERASE
(
addr

	`__AddrToZ24ByToSPMCR_SPM
(
__rash
 *ddr), 0x03 )

	)

43 
	#_PAGE_WRITE
(
addr

	`__AddrToZ24ByToSPMCR_SPM
(
__rash
 *ddr), 0x05 )

	)

46 #i
__GNUC__
 > 0

49 
	~<avr/bo.h
>

50 
	~<avr/pgma.h
>

52 #i
defed
(
GET_LOCK_BITS
)

53 
	#_GET_LOCK_BITS
(
	`bo_lock_fu_bs_g
(
GET_LOCK_BITS
)

	)

54 
	#_GET_LOW_FUSES
(
	`bo_lock_fu_bs_g
(
GET_LOW_FUSE_BITS
)

	)

55 
	#_GET_HIGH_FUSES
(
	`bo_lock_fu_bs_g
(
GET_HIGH_FUSE_BITS
)

	)

56 
	#_GET_EXTENDED_FUSES
(
	`bo_lock_fu_bs_g
(
GET_EXTENDED_FUSE_BITS
)

	)

58 
	#_SET_LOCK_BITS
(
da

	`bo_lock_bs_t
(~da)

	)

59 
	#_ENABLE_RWW_SECTION
(
	`bo_rww_ab
()

	)

61 
	#_WAIT_FOR_SPM
(
	`bo_m_busy_wa
()

	)

63 #ide
LARGE_MEMORY


64 
	#_LOAD_PROGRAM_MEMORY
(
addr

	`pgm_ad_by_ì
ddr)

	)

66 
	#_LOAD_PROGRAM_MEMORY
(
addr

	`pgm_ad_by_r
ddr)

	)

68 
	#_FILL_TEMP_WORD
(
addr
,
da

	`bo_ge_fl
ddr, da)

	)

69 
	#_PAGE_ERASE
(
addr

	`bo_ge_a
ddr)

	)

70 
	#_PAGE_WRITE
(
addr

	`bo_ge_wre
ddr)

	)

	@ports/bdk-atxx4-mstp/bootloader/main.c

27 
	~"defes.h
"

28 
	~"rl.h
"

29 
	~"ash.h
"

48 #ifde
LARGE_MEMORY


49 
	#ADDR_T
 

	)

51 
	#ADDR_T
 

	)

54 #ide
REMOVE_BLOCK_SUPPORT


55 
BlockLd
(

56 
size
,

57 
mem
,

58 
ADDR_T
 * 
addss
);

59 
BlockRd
(

60 
size
,

61 
mem
,

62 
ADDR_T
 * 
addss
);

65 
	#BLOCKSIZE
 
PAGESIZE


	)

69 #ifde
__ICCAVR__


70 
__C_sk
 
	$ma
(

73 
	$ma
(

77 
ADDR_T
 
addss
;

78 
mp_t
;

79 
v
;

84 *
fun
) (

86 
PROGPORT
 |(1 << 
PROG_NO
);

87 
	`bout
();

91 i(!(
PROGPIN
 & (1 << 
PROG_NO
))) {

94 
v
 = 
	`cch
();

97 i(
v
 == 'a') {

98 
	`ndch
('Y');

103 i(
v
 == 'A') {

104 
addss
 = (
	`cch
() << 8) |ecchar();

105 
	`ndch
('\r');

110 i(
v
 == 'e') {

111 
addss
 = 0;dds< 
APP_END
;dds+
PAGESIZE
) {

112 
	`_WAIT_FOR_SPM
();

113 #ifde
__ICCAVR__


114 #agm
dg_suss
=
Pe1053


116 
	`_PAGE_ERASE
(
addss
);

117 #ifde
__ICCAVR__


118 #agm
dg_deu
=
Pe1053


122 
	`ndch
('\r');

124 #ide
REMOVE_BLOCK_SUPPORT


126 i(
v
 == 'b') {

127 
	`ndch
('Y');

128 
	`ndch
((
BLOCKSIZE
 >> 8) & 0xFF);

129 
	`ndch
(
BLOCKSIZE
 & 0xFF);

134 i(
v
 == 'B') {

135 
mp_t
 = (
	`cch
() << 8) |ecchar();

136 
v
 = 
	`cch
();

137 
	`ndch
(
	`BlockLd
(
mp_t
, 
v
, &
addss
));

142 i(
v
 == 'g') {

143 
mp_t
 = (
	`cch
() << 8) |ecchar();

144 
v
 = 
	`cch
();

145 
	`BlockRd
(
mp_t
, 
v
, &
addss
);

149 #ide
REMOVE_FLASH_BYTE_SUPPORT


151 i(
v
 == 'R') {

153 
	`_WAIT_FOR_SPM
();

154 
	`_ENABLE_RWW_SECTION
();

155 #ifde
__ICCAVR__


156 #agm
dg_suss
=
Pe1053


158 
	`ndch
(
	`_LOAD_PROGRAM_MEMORY
((
addss
 << 1) + 1));

159 
	`ndch
(
	`_LOAD_PROGRAM_MEMORY
((
addss
 << 1) + 0));

160 #ifde
__ICCAVR__


161 #agm
dg_deu
=
Pe1053


164 
addss
++;

169 i(
v
 == 'c') {

170 
mp_t
 = 
	`cch
();

171 
	`ndch
('\r');

176 i(
v
 == 'C') {

177 
mp_t
 |(
	`cch
() << 8);

178 
	`_WAIT_FOR_SPM
();

179 #ifde
__ICCAVR__


180 #agm
dg_suss
=
Pe1053


182 
	`_FILL_TEMP_WORD
((
addss
 << 1), 
mp_t
);

183 #ifde
__ICCAVR__


184 #agm
dg_deu
=
Pe1053


186 
addss
++;

187 
	`ndch
('\r');

192 i(
v
 == 'm') {

193 i(
addss
 >(
APP_END
 >> 1)) {

194 
	`ndch
('?');

196 
	`_WAIT_FOR_SPM
();

197 #ifde
__ICCAVR__


198 #agm
dg_suss
=
Pe1053


200 
	`_PAGE_WRITE
(
addss
 << 1);

201 #ifde
__ICCAVR__


202 #agm
dg_deu
=
Pe1053


206 
	`ndch
('\r');

210 #ide
REMOVE_EEPROM_BYTE_SUPPORT


212 i(
v
 == 'D') {

213 
	`_WAIT_FOR_SPM
();

214 
EEARL
 = 
addss
;

215 
EEARH
 = (
addss
 >> 8);

216 
EEDR
 = 
	`cch
();

217 
EECR
 |(1 << 
EEMWE
);

218 
EECR
 |(1 << 
EEWE
);

219 
EECR
 & (1 << 
EEWE
))

222 
addss
++;

223 
	`ndch
('\r');

228 i(
v
 == 'd') {

229 
EEARL
 = 
addss
;

230 
EEARH
 = (
addss
 >> 8);

231 
EECR
 |(1 << 
EERE
);

232 
	`ndch
(
EEDR
);

233 
addss
++;

237 #ide
REMOVE_FUSE_AND_LOCK_BIT_SUPPORT


239 i(
v
 == 'l') {

240 
	`_WAIT_FOR_SPM
();

241 
	`_SET_LOCK_BITS
(
	`cch
());

242 
	`ndch
('\r');

244 #i
	`defed
(
_GET_LOCK_BITS
)

246 i(
v
 == 'r') {

247 
	`_WAIT_FOR_SPM
();

248 
	`ndch
(
	`_GET_LOCK_BITS
());

253 i(
v
 == 'F') {

254 
	`_WAIT_FOR_SPM
();

255 
	`ndch
(
	`_GET_LOW_FUSES
());

260 i(
v
 == 'N') {

261 
	`_WAIT_FOR_SPM
();

262 
	`ndch
(
	`_GET_HIGH_FUSES
());

267 i(
v
 == 'Q') {

268 
	`_WAIT_FOR_SPM
();

269 
	`ndch
(
	`_GET_EXTENDED_FUSES
());

274 #ide
REMOVE_AVRPROG_SUPPORT


276 i((
v
 == 'P') || (val == 'L')) {

277 
	`ndch
('\r');

282 i(
v
 == 'E') {

283 
	`_WAIT_FOR_SPM
();

284 
	`_ENABLE_RWW_SECTION
();

285 
	`ndch
('\r');

286 
	`fun
();

291 i(
v
 == 'p') {

292 
	`ndch
('S');

297 i(
v
 == 't') {

298 #i
PARTCODE
+0 > 0

299 
	`ndch
(
PARTCODE
);

301 
	`ndch
(0);

306 i((
v
 == 'x') || (val == 'y') || (val == 'T')) {

307 
	`cch
();

308 
	`ndch
('\r');

313 i(
v
 == 'S') {

314 
	`ndch
('A');

315 
	`ndch
('V');

316 
	`ndch
('R');

317 
	`ndch
('B');

318 
	`ndch
('O');

319 
	`ndch
('O');

320 
	`ndch
('T');

325 i(
v
 == 'V') {

326 
	`ndch
('1');

327 
	`ndch
('5');

332 i(
v
 == 's') {

333 
	`ndch
(
SIGNATURE_BYTE_3
);

334 
	`ndch
(
SIGNATURE_BYTE_2
);

335 
	`ndch
(
SIGNATURE_BYTE_1
);

340 i(
v
 != 0x1b) {

341 
	`ndch
('?');

345 
	`_WAIT_FOR_SPM
();

346 
	`_ENABLE_RWW_SECTION
();

347 
	`fun
();

349 
	}
}

352 #ide
REMOVE_BLOCK_SUPPORT


353 
	$BlockLd
(

354 
size
,

355 
mem
,

356 
ADDR_T
 * 
addss
)

358 
bufr
[
BLOCKSIZE
];

359 
da
;

360 
ADDR_T
 
mddss
;

363 i(
mem
 == 'E') {

365 
mddss
 = 0;emdds< 
size
;empaddress++)

366 
bufr
[
mddss
] = 
	`cch
();

369 
	`_WAIT_FOR_SPM
();

370 
mddss
 = 0;emdds< 
size
;empaddress++) {

371 
EEARL
 = *
addss
;

372 
EEARH
 = ((*
addss
) >> 8);

373 
EEDR
 = 
bufr
[
mddss
];

374 
EECR
 |(1 << 
EEMWE
);

375 
EECR
 |(1 << 
EEWE
);

376 
EECR
 & (1 << 
EEWE
))

379 (*
addss
)++;

386 i(
mem
 == 'F') {

387 (*
addss
) <<= 1;

388 
mddss
 = (*
addss
);

391 
da
 = 
	`cch
();

392 
da
 |(
	`cch
() << 8);

393 #ifde
__ICCAVR__


394 #agm
dg_suss
=
Pe1053


396 
	`_FILL_TEMP_WORD
(*
addss
, 
da
);

397 #ifde
__ICCAVR__


398 #agm
dg_deu
=
Pe1053


400 (*
addss
) += 2;

401 
size
 -= 2;

402 } 
size
);

404 #ifde
__ICCAVR__


405 #agm
dg_suss
=
Pe1053


407 
	`_PAGE_WRITE
(
mddss
);

408 #ifde
__ICCAVR__


409 #agm
dg_deu
=
Pe1053


411 
	`_WAIT_FOR_SPM
();

412 
	`_ENABLE_RWW_SECTION
();

414 (*
addss
) >>= 1;

422 
	}
}

425 
	$BlockRd
(

426 
size
,

427 
mem
,

428 
ADDR_T
 * 
addss
)

431 i(
mem
 == 'E') {

433 
EEARL
 = *
addss
;

434 
EEARH
 = ((*
addss
) >> 8);

435 (*
addss
)++;

436 
EECR
 |(1 << 
EERE
);

437 
	`ndch
(
EEDR
);

439 
size
--;

440 } 
size
);

444 i(
mem
 == 'F') {

445 (*
addss
) <<= 1;

448 #ifde
__ICCAVR__


449 #agm
dg_suss
=
Pe1053


451 
	`ndch
(
	`_LOAD_PROGRAM_MEMORY
(*
addss
));

452 
	`ndch
(
	`_LOAD_PROGRAM_MEMORY
((*
addss
) + 1));

453 #ifde
__ICCAVR__


454 #agm
dg_deu
=
Pe1053


456 (*
addss
) += 2;

457 
size
 -= 2;

458 } 
size
);

460 (*
addss
) >>= 1;

462 
	}
}

	@ports/bdk-atxx4-mstp/bootloader/serial.c

19 
	~"defes.h
"

22 
	$bout
(

25 
BAUD_RATE_LOW_REG
 = 
BRREG_VALUE
;

26 
UART_CONTROL_REG
 = (1 << 
ENABLE_RECEIVER_BIT
| (1 << 
ENABLE_TRANSMITTER_BIT
);

27 
	}
}

30 
	$ndch
(

31 
c
)

33 
UART_DATA_REG
 = 
c
;

34 !(
UART_STATUS_REG
 & (1 << 
TRANSMIT_COMPLETE_BIT
)));

35 
UART_STATUS_REG
 |(1 << 
TRANSMIT_COMPLETE_BIT
);

36 
	}
}

39 
	$cch
(

42 !(
UART_STATUS_REG
 & (1 << 
RECEIVE_COMPLETE_BIT
)));

43  
UART_DATA_REG
;

44 
	}
}

	@ports/bdk-atxx4-mstp/bootloader/serial.h

20 
bout
(

22 
ndch
(

24 
cch
(

	@ports/bdk-atxx4-mstp/crossworks/stdbool.h

1 #ide
STDBOOL_H


2 
	#STDBOOL_H


	)

6 #ide
__lulus


7 
	t_Bo
;

8 #ide
bo


9 
	#bo
 
_Bo


	)

11 #ide
ue


12 
	#ue
 1

	)

14 #ide
l


15 
	#l
 0

	)

17 
	#__bo_ue_l_e_defed
 1

	)

	@ports/bdk-atxx4-mstp/device.c

25 
	~<dbo.h
>

26 
	~<dt.h
>

27 
	~<dlib.h
>

28 
	~<rg.h
>

29 
	~"bacdef.h
"

30 
	~"bacdcode.h
"

31 
	~"bacr.h
"

32 
	~"banum.h
"

33 
	~"du.h
"

34 
	~"dcc.h
"

35 
	~"dk.h
"

36 
	~"rs485.h
"

37 
	~"vsi.h
"

38 
	~"nvda.h
"

39 
	~"ack.h
"

40 
	~"hdrs.h
"

41 
	~"bme.h
"

43 
	~"devi.h
"

44 
	~"ai.h
"

45 
	~"av.h
"

46 
	~"bi.h
"

47 
	~"bo.h
"

50 
Devi_Rd_Prݔty_Lol
(

51 
BACNET_READ_PROPERTY_DATA
 * 
da
);

52 
bo
 
Devi_Wre_Prݔty_Lol
(

53 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

55 
	smy_obje_funis
 {

56 
BACNET_OBJECT_TYPE
 
	mObje_Ty
;

57 
obje__funi
 
	mObje_In
;

58 
obje_cou_funi
 
	mObje_Cou
;

59 
obje_dex_to__funi
 
	mObje_Index_To_In
;

60 
obje_vid__funi
 
	mObje_Vid_In
;

61 
obje_me_funi
 
	mObje_Name
;

62 
ad_ݔty_funi
 
	mObje_Rd_Prݔty
;

63 
wre_ݔty_funi
 
	mObje_Wre_Prݔty
;

64 
m_ݔty_lis_funi
 
	mObje_RPM_Li
;

65 } 
	gObje_Tab
[] = {

67 
OBJECT_DEVICE
, 
NULL
,

68 
Devi_Cou
, 
Devi_Index_To_In
,

69 
Devi_Vid_Obje_In_Numb
, 
Devi_Obje_Name
,

70 
Devi_Rd_Prݔty_Lol
, 
Devi_Wre_Prݔty_Lol
,

71 
Devi_Prݔty_Lis
}, {

72 
OBJECT_ANALOG_INPUT
, 
Alog_Iut_In
, 
Alog_Iut_Cou
,

73 
Alog_Iut_Index_To_In
, 
Alog_Iut_Vid_In
,

74 
Alog_Iut_Obje_Name
, 
Alog_Iut_Rd_Prݔty
, 
NULL
,

75 
Alog_Iut_Prݔty_Lis
}, {

76 
OBJECT_ANALOG_VALUE
, 
Alog_Vue_In
, 
Alog_Vue_Cou
,

77 
Alog_Vue_Index_To_In
, 
Alog_Vue_Vid_In
,

78 
Alog_Vue_Obje_Name
, 
Alog_Vue_Rd_Prݔty
,

79 
Alog_Vue_Wre_Prݔty
, 
Alog_Vue_Prݔty_Lis
}, {

80 
OBJECT_BINARY_INPUT
, 
By_Iut_In
, 
By_Iut_Cou
,

81 
By_Iut_Index_To_In
, 
By_Iut_Vid_In
,

82 
By_Iut_Obje_Name
, 
By_Iut_Rd_Prݔty
, 
NULL
,

83 
By_Iut_Prݔty_Lis
}, {

84 
OBJECT_BINARY_OUTPUT
, 
By_Ouut_In
, 
By_Ouut_Cou
,

85 
By_Ouut_Index_To_In
, 
By_Ouut_Vid_In
,

86 
By_Ouut_Obje_Name
, 
By_Ouut_Rd_Prݔty
,

87 
By_Ouut_Wre_Prݔty
, 
By_Ouut_Prݔty_Lis
}, {

88 
MAX_BACNET_OBJECT_TYPE
, 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL}

95 
ut32_t
 
	gObje_In_Numb
;

96 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

97 
ut32_t
 
	gDaba_Revisi
;

98 
BACNET_REINITIALIZED_STATE
 
	gRelize_S
 = 
BACNET_REINIT_IDLE
;

99 cڡ *
	gRe_Passwd
 = "rehmite";

102 cڡ 
	gDevi_Prݔts_Requed
[] = {

103 
PROP_OBJECT_IDENTIFIER
,

104 
PROP_OBJECT_NAME
,

105 
PROP_OBJECT_TYPE
,

106 
PROP_SYSTEM_STATUS
,

107 
PROP_VENDOR_NAME
,

108 
PROP_VENDOR_IDENTIFIER
,

109 
PROP_MODEL_NAME
,

110 
PROP_FIRMWARE_REVISION
,

111 
PROP_APPLICATION_SOFTWARE_VERSION
,

112 
PROP_PROTOCOL_VERSION
,

113 
PROP_PROTOCOL_REVISION
,

114 
PROP_PROTOCOL_SERVICES_SUPPORTED
,

115 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

116 
PROP_OBJECT_LIST
,

117 
PROP_MAX_APDU_LENGTH_ACCEPTED
,

118 
PROP_SEGMENTATION_SUPPORTED
,

119 
PROP_APDU_TIMEOUT
,

120 
PROP_NUMBER_OF_APDU_RETRIES
,

121 
PROP_DEVICE_ADDRESS_BINDING
,

122 
PROP_DATABASE_REVISION
,

126 cڡ 
	gDevi_Prݔts_Oiڮ
[] = {

127 
PROP_MAX_MASTER
,

128 
PROP_MAX_INFO_FRAMES
,

129 
PROP_DESCRIPTION
,

130 
PROP_LOCATION
,

134 cڡ 
	gDevi_Prݔts_Prrry
[] = {

141 
my_obje_funis
 *
	$Devi_Objes_Fd_Funis
(

142 
BACNET_OBJECT_TYPE
 
Obje_Ty
)

144 
my_obje_funis
 *
pObje
 = 
NULL
;

146 
pObje
 = &
Obje_Tab
[0];

147 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

149 i(
pObje
->
Obje_Ty
 == Object_Type) {

150  (
pObje
);

153 
pObje
++;

156  (
NULL
);

157 
	}
}

161 
	$Devi_Rd_Prݔty
(

162 
BACNET_READ_PROPERTY_DATA
 * 
da
)

164 
du_n
 = 
BACNET_STATUS_ERROR
;

165 
my_obje_funis
 *
pObje
 = 
NULL
;

168 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

169 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

170 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
da
->
obje_ty
);

171 i(
pObje
 !
NULL
) {

172 i(
pObje
->
Obje_Vid_In
 &&

173 
pObje
->
	`Obje_Vid_In
(
da
->
obje_
)) {

174 i(
pObje
->
Obje_Rd_Prݔty
) {

175 
du_n
 = 
pObje
->
	`Obje_Rd_Prݔty
(
da
);

180  
du_n
;

181 
	}
}

183 
bo
 
	$Devi_Wre_Prݔty
(

184 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

186 
bo
 
us
 = 
l
;

187 
my_obje_funis
 *
pObje
 = 
NULL
;

190 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
wp_da
->
obje_ty
);

191 i(
pObje
) {

192 i(
pObje
->
Obje_Vid_In
 &&

193 
pObje
->
	`Obje_Vid_In
(
wp_da
->
obje_
)) {

194 i(
pObje
->
Obje_Wre_Prݔty
) {

195 
us
 = 
pObje
->
	`Obje_Wre_Prݔty
(
wp_da
);

197 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

198 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

201 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

202 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

205 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

206 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

209  
us
;

210 
	}
}

212 
	$lol_ݔty_li_cou
(

213 cڡ *
pLi
)

215 
ݔty_cou
 = 0;

217 i(
pLi
) {

218 *
pLi
 != -1) {

219 
ݔty_cou
++;

220 
pLi
++;

224  
ݔty_cou
;

225 
	}
}

228 
	$Devi_Objes_Prݔty_Li
(

229 
BACNET_OBJECT_TYPE
 
obje_ty
,

230 
ecl_ݔty_li_t
 *
pPrݔtyLi
)

232 
my_obje_funis
 *
pObje
 = 
NULL
;

234 
pPrݔtyLi
->
Requed
.
pLi
 = 
NULL
;

235 
pPrݔtyLi
->
Oiڮ
.
pLi
 = 
NULL
;

236 
pPrݔtyLi
->
Prrry
.
pLi
 = 
NULL
;

243 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

244 i((
pObje
 !
NULL
&& (pObje->
Obje_RPM_Li
 != NULL)) {

245 
pObje
->
	`Obje_RPM_Li
(&
pPrݔtyLi
->
Requed
.
pLi
,

246 &
pPrݔtyLi
->
Oiڮ
.
pLi
, &pPrݔtyLi->
Prrry
.pList);

250 
pPrݔtyLi
->
Requed
.
cou
 =

251 
pPrݔtyLi
->
Requed
.
pLi
 ==

252 
NULL
 ? 0 : 
	`lol_ݔty_li_cou
(
pPrݔtyLi
->
Requed
.
pLi
);

254 
pPrݔtyLi
->
Oiڮ
.
cou
 =

255 
pPrݔtyLi
->
Oiڮ
.
pLi
 ==

256 
NULL
 ? 0 : 
	`lol_ݔty_li_cou
(
pPrݔtyLi
->
Oiڮ
.
pLi
);

258 
pPrݔtyLi
->
Prrry
.
cou
 =

259 
pPrݔtyLi
->
Prrry
.
pLi
 ==

260 
NULL
 ? 0 : 
	`lol_ݔty_li_cou
(
pPrݔtyLi
->
Prrry
.
pLi
);

263 
	}
}

265 
	$Devi_Prݔty_Lis
(

266 cڡ **
pRequed
,

267 cڡ **
pOiڮ
,

268 cڡ **
pPrrry
)

270 i(
pRequed
)

271 *
pRequed
 = 
Devi_Prݔts_Requed
;

272 i(
pOiڮ
)

273 *
pOiڮ
 = 
Devi_Prݔts_Oiڮ
;

274 i(
pPrrry
)

275 *
pPrrry
 = 
Devi_Prݔts_Prrry
;

278 
	}
}

280 
	$Devi_Cou
(

284 
	}
}

286 
ut32_t
 
	$Devi_Index_To_In
(

287 
dex
)

289 
dex
 = index;

290  
Obje_In_Numb
;

291 
	}
}

293 *
	$Devi_Name_Deu
(

296 
xt_rg
[32];

298 
	`rtf
(
xt_rg
, "DEVICE-%lu", 
Obje_In_Numb
);

300  
xt_rg
;

301 
	}
}

303 
bo
 
	$Devi_Obje_Name
(

304 
ut32_t
 
obje_
,

305 
BACNET_CHARACTER_STRING
 * 
obje_me
)

307 
bo
 
us
 = 
l
;

309 i(
obje_
 =
Obje_In_Numb
) {

310 
	`ba_me
(
NV_EEPROM_DEVICE_NAME
, 
obje_me
, 
	`Devi_Name_Deu
());

311 
us
 = 
ue
;

314  
us
;

315 
	}
}

317 
bo
 
	$Devi_Relize
(

318 
BACNET_REINITIALIZE_DEVICE_DATA
 * 
rd_da
)

320 
bo
 
us
 = 
l
;

323 i(
	`charg_si_me
(&
rd_da
->
sswd
, 
Re_Passwd
)) {

324 
rd_da
->
e
) {

325 
BACNET_REINIT_COLDSTART
:

326 
BACNET_REINIT_WARMSTART
:

327 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

331 
Relize_S
 = 
rd_da
->
e
;

332 
us
 = 
ue
;

334 
BACNET_REINIT_STARTBACKUP
:

335 
BACNET_REINIT_ENDBACKUP
:

336 
BACNET_REINIT_STARTRESTORE
:

337 
BACNET_REINIT_ENDRESTORE
:

338 
BACNET_REINIT_ABORTRESTORE
:

339 i(
	`dcc_communiti_dibd
()) {

340 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

341 
rd_da
->
r_code
 = 
ERROR_CODE_COMMUNICATION_DISABLED
;

343 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

344 
rd_da
->
r_code
 =

345 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

349 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

350 
rd_da
->
r_code
 = 
ERROR_CODE_PARAMETER_OUT_OF_RANGE
;

354 
rd_da
->
r_ass
 = 
ERROR_CLASS_SECURITY
;

355 
rd_da
->
r_code
 = 
ERROR_CODE_PASSWORD_FAILURE
;

358  
us
;

359 
	}
}

361 
BACNET_REINITIALIZED_STATE
 
	$Devi_Relized_S
(

364  
Relize_S
;

365 
	}
}

367 
	$Devi_In
(

368 
obje_funis_t
 * 
obje_b
)

370 
my_obje_funis
 *
pObje
 = 
NULL
;

374 (
obje_b
;

376 
pObje
 = &
Obje_Tab
[0];

377 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

378 i(
pObje
->
Obje_In
) {

379 
pObje
->
	`Obje_In
();

381 
pObje
++;

383 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

384 
	}
}

387 
ut32_t
 
	$Devi_Obje_In_Numb
(

390  
Obje_In_Numb
;

391 
	}
}

393 
bo
 
	$Devi_S_Obje_In_Numb
(

394 
ut32_t
 
obje_id
)

396 
bo
 
us
 = 
ue
;

398 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

399 i(
obje_id
 !
Obje_In_Numb
) {

400 
	`Devi_Inc_Daba_Revisi
();

401 
Obje_In_Numb
 = 
obje_id
;

404 
us
 = 
l
;

406  
us
;

407 
	}
}

409 
bo
 
	$Devi_Vid_Obje_In_Numb
(

410 
ut32_t
 
obje_id
)

412  (
Obje_In_Numb
 =
obje_id
);

413 
	}
}

415 
BACNET_DEVICE_STATUS
 
	$Devi_Syem_Stus
(

418  
Syem_Stus
;

419 
	}
}

421 
	$Devi_S_Syem_Stus
(

422 
BACNET_DEVICE_STATUS
 
us
,

423 
bo
 
lol
)

426 
su
 = -1;

428 i(
us
 < 
MAX_DEVICE_STATUS
) {

429 
Syem_Stus
 = 
us
;

430 
su
 = 0;

433  
su
;

434 
	}
}

436 
ut16_t
 
	$Devi_Vd_Idtifr
(

439  
BACNET_VENDOR_ID
;

440 
	}
}

442 
BACNET_SEGMENTATION
 
	$Devi_Segmti_Su܋d
(

445  
SEGMENTATION_NONE
;

446 
	}
}

448 
ut32_t
 
	$Devi_Daba_Revisi
(

451  
Daba_Revisi
;

452 
	}
}

454 
	$Devi_Inc_Daba_Revisi
(

457 
Daba_Revisi
++;

458 
	}
}

462 
	$Devi_Obje_Li_Cou
(

465 
cou
 = 0;

466 
my_obje_funis
 *
pObje
 = 
NULL
;

469 
pObje
 = &
Obje_Tab
[0];

470 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

471 i(
pObje
->
Obje_Cou
) {

472 
cou
 +
pObje
->
	`Obje_Cou
();

474 
pObje
++;

477  
cou
;

478 
	}
}

480 
bo
 
	$Devi_Obje_Li_Idtifr
(

481 
ut32_t
 
y_dex
,

482 *
obje_ty
,

483 
ut32_t
 * 

)

485 
bo
 
us
 = 
l
;

486 
ut32_t
 
cou
 = 0;

487 
ut32_t
 
obje_dex
 = 0;

488 
my_obje_funis
 *
pObje
 = 
NULL
;

491 i(
y_dex
 == 0) {

492  
us
;

494 
obje_dex
 = 
y_dex
 - 1;

496 
pObje
 = &
Obje_Tab
[0];

497 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

498 i(
pObje
->
Obje_Cou
 &&Obje->
Obje_Index_To_In
) {

499 
obje_dex
 -
cou
;

500 
cou
 = 
pObje
->
	`Obje_Cou
();

501 i(
obje_dex
 < 
cou
) {

502 *
obje_ty
 = 
pObje
->
Obje_Ty
;

503 *

 = 
pObje
->
	`Obje_Index_To_In
(
obje_dex
);

504 
us
 = 
ue
;

508 
pObje
++;

511  
us
;

512 
	}
}

514 
bo
 
	$Devi_Vid_Obje_Name
(

515 
BACNET_CHARACTER_STRING
 * 
obje_me1
,

516 *
obje_ty
,

517 
ut32_t
 * 
obje_
)

519 
bo
 
found
 = 
l
;

520 
ty
 = 0;

521 
ut32_t
 

;

522 
ut32_t
 
max_objes
 = 0, 
i
 = 0;

523 
bo
 
check_id
 = 
l
;

524 
BACNET_CHARACTER_STRING
 
obje_me2
;

525 
my_obje_funis
 *
pObje
 = 
NULL
;

527 
max_objes
 = 
	`Devi_Obje_Li_Cou
();

528 
i
 = 1; i <
max_objes
; i++) {

529 
check_id
 = 
	`Devi_Obje_Li_Idtifr
(
i
, &
ty
, &

);

530 i(
check_id
) {

531 
pObje
 = 
	`Devi_Objes_Fd_Funis
((
BACNET_OBJECT_TYPE

ty
);

532 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL) &&

533 (
pObje
->
	`Obje_Name
(

, &
obje_me2
) &&

534 
	`charg_me
(
obje_me1
, &
obje_me2
))) {

535 
found
 = 
ue
;

536 i(
obje_ty
) {

537 *
obje_ty
 = 
ty
;

539 i(
obje_
) {

540 *
obje_
 = 

;

547  
found
;

548 
	}
}

550 
bo
 
	$Devi_Vid_Obje_Id
(

551 
obje_ty
,

552 
ut32_t
 
obje_
)

554 
bo
 
us
 = 
l
;

555 
my_obje_funis
 *
pObje
 = 
NULL
;

557 
pObje
 = 
	`Devi_Objes_Fd_Funis
((
BACNET_OBJECT_TYPE

obje_ty
);

558 i((
pObje
 !
NULL
&& (pObje->
Obje_Vid_In
 != NULL)) {

559 
us
 = 
pObje
->
	`Obje_Vid_In
(
obje_
);

562  
us
;

563 
	}
}

565 
bo
 
	$Devi_Obje_Name_Cy
(

566 
BACNET_OBJECT_TYPE
 
obje_ty
,

567 
ut32_t
 
obje_
,

568 
BACNET_CHARACTER_STRING
 * 
obje_me
)

570 
my_obje_funis
 *
pObje
 = 
NULL
;

571 
bo
 
found
 = 
l
;

573 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

574 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL)) {

575 
found
 = 
pObje
->
	`Obje_Name
(
obje_
, 
obje_me
);

578  
found
;

579 
	}
}

582 
	$Devi_Rd_Prݔty_Lol
(

583 
BACNET_READ_PROPERTY_DATA
 * 
da
)

585 
du_n
 = 0;

586 
n
 = 0;

587 
BACNET_BIT_STRING
 
b_rg
 = { 0 };

588 
BACNET_CHARACTER_STRING
 
ch_rg
 = { 0 };

589 
ut32_t
 
i
 = 0;

590 
obje_ty
 = 0;

591 
ut32_t
 

 = 0;

592 
ut32_t
 
cou
 = 0;

593 
ut8_t
 *
du
 = 
NULL
;

594 
my_obje_funis
 *
pObje
 = 
NULL
;

596 i((
da
->
iti_da
 =
NULL
) ||

597 (
da
->
iti_da_n
 == 0)) {

600 
du
 = 
da
->
iti_da
;

601 (
da
->
obje_ݔty
) {

602 
PROP_OBJECT_IDENTIFIER
:

603 
du_n
 =

604 
	`code_iti_obje_id
(&
du
[0], 
da
->
obje_ty
,

605 
da
->
obje_
);

607 
PROP_OBJECT_NAME
:

608 
	`Devi_Obje_Name
(
da
->
obje_
, &
ch_rg
);

609 
du_n
 =

610 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

612 
PROP_OBJECT_TYPE
:

613 
du_n
 =

614 
	`code_iti_umed
(&
du
[0], 
da
->
obje_ty
);

616 
PROP_DESCRIPTION
:

617 
	`ba_me
(
NV_EEPROM_DEVICE_DESCRIPTION
, &
ch_rg
,

619 
du_n
 =

620 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

622 
PROP_LOCATION
:

623 
	`ba_me
(
NV_EEPROM_DEVICE_LOCATION
, &
ch_rg
,

625 
du_n
 =

626 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

628 
PROP_SYSTEM_STATUS
:

629 
du_n
 =

630 
	`code_iti_umed
(&
du
[0],

631 
	`Devi_Syem_Stus
());

633 
PROP_VENDOR_NAME
:

634 
	`charg__si
(&
ch_rg
, 
BACNET_VENDOR_NAME
);

635 
du_n
 =

636 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

638 
PROP_VENDOR_IDENTIFIER
:

639 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
BACNET_VENDOR_ID
);

641 
PROP_MODEL_NAME
:

642 
	`charg__si
(&
ch_rg
, "bdk-atxx4-mstp");

643 
du_n
 =

644 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

646 
PROP_FIRMWARE_REVISION
:

647 
	`charg__si
(&
ch_rg
, 
BACt_Vsi
);

648 
du_n
 =

649 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

651 
PROP_APPLICATION_SOFTWARE_VERSION
:

652 
	`charg__si
(&
ch_rg
, "1.0");

653 
du_n
 =

654 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

656 
PROP_PROTOCOL_VERSION
:

657 
du_n
 =

658 
	`code_iti_unsigd
(&
du
[0], 
BACNET_PROTOCOL_VERSION
);

660 
PROP_PROTOCOL_REVISION
:

661 
du_n
 =

662 
	`code_iti_unsigd
(&
du
[0],

663 
BACNET_PROTOCOL_REVISION
);

665 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

667 
	`brg_
(&
b_rg
);

668 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

670 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

671 
	`du_rvi_su܋d
((
BACNET_SERVICES_SUPPORTED

i
));

673 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

675 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

678 
	`brg_
(&
b_rg
);

679 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

681 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

684 
i
 = 0;

685 
pObje
 = &
Obje_Tab
[
i
];

686 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

687 i((
pObje
->
Obje_Cou
&& (pObje->
	`Obje_Cou
() > 0)) {

688 
	`brg_t_b
(&
b_rg
, 
pObje
->
Obje_Ty
, 
ue
);

690 
pObje
++;

692 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

694 
PROP_OBJECT_LIST
:

695 
cou
 = 
	`Devi_Obje_Li_Cou
();

697 i(
da
->
y_dex
 == 0)

698 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

703 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

704 
i
 = 1; i <
cou
; i++) {

705 i(
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
,

706 &

)) {

707 
n
 =

708 
	`code_iti_obje_id
(&
du
[
du_n
],

709 
obje_ty
, 

);

710 
du_n
 +
n
;

713 i((
du_n
 + 
n
>
MAX_APDU
) {

715 
da
->
r_code
 =

716 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

717 
du_n
 = 
BACNET_STATUS_ABORT
;

722 
da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

723 
da
->
r_code
 = 
ERROR_CODE_OTHER
;

724 
du_n
 = 
BACNET_STATUS_ERROR
;

729 i(
	`Devi_Obje_Li_Idtifr
(
da
->
y_dex
,

730 &
obje_ty
, &

))

731 
du_n
 =

732 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

733 

);

735 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

736 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

737 
du_n
 = 
BACNET_STATUS_ERROR
;

741 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

742 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

744 
PROP_SEGMENTATION_SUPPORTED
:

745 
du_n
 =

746 
	`code_iti_umed
(&
du
[0],

747 
	`Devi_Segmti_Su܋d
());

749 
PROP_APDU_TIMEOUT
:

750 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_timeout
());

752 
PROP_NUMBER_OF_APDU_RETRIES
:

753 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_s
());

755 
PROP_DEVICE_ADDRESS_BINDING
:

758 
PROP_DATABASE_REVISION
:

759 
du_n
 =

760 
	`code_iti_unsigd
(&
du
[0],

761 
	`Devi_Daba_Revisi
());

763 
PROP_MAX_INFO_FRAMES
:

764 
du_n
 =

765 
	`code_iti_unsigd
(&
du
[0],

766 
	`dlmp_max_fo_ames
());

768 
PROP_MAX_MASTER
:

769 
du_n
 =

770 
	`code_iti_unsigd
(&
du
[0], 
	`dlmp_max_ma
());

773 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`ack_size
());

776 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`ack_unud
());

779 
du_n
 =

780 
	`code_iti_unsigd
(&
du
[0], 
	`rs485_baud_
());

783 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

784 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

785 
du_n
 = 
BACNET_STATUS_ERROR
;

789 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

790 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

791 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

792 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

793 
du_n
 = 
BACNET_STATUS_ERROR
;

796  
du_n
;

797 
	}
}

799 
bo
 
	$Devi_Wre_Prݔty_Lol
(

800 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

802 
bo
 
us
 = 
l
;

803 
n
 = 0;

804 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

805 
ut8_t
 
max_ma
 = 0;

808 
n
 =

809 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

810 
wp_da
->
iti_da_n
, &
vue
);

812 i(
n
 < 0) {

814 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

815 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

816  
l
;

818 i((
wp_da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

819 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

821 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

822 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

823  
l
;

825 (
wp_da
->
obje_ݔty
) {

826 
PROP_OBJECT_IDENTIFIER
:

827 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_OBJECT_ID
) {

828 i((
vue
.
ty
.
Obje_Id
.ty =
OBJECT_DEVICE
) &&

829 (
	`Devi_S_Obje_In_Numb
(
vue
.
ty
.

830 
Obje_Id
.

))) {

831 
	`om_bys_wre
(
NV_EEPROM_DEVICE_0
,

832 (
ut8_t
 *& 
vue
.
ty
.
Obje_Id
.

, 4);

834 
us
 = 
ue
;

836 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

837 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

840 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

841 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

844 
PROP_MAX_INFO_FRAMES
:

845 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

846 i(
vue
.
ty
.
Unsigd_I
 <= 255) {

847 
	`dlmp_t_max_fo_ames
(
vue
.
ty
.
Unsigd_I
);

848 
us
 = 
ue
;

850 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

851 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

854 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

855 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

858 
PROP_MAX_MASTER
:

859 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

860 i((
vue
.
ty
.
Unsigd_I
 > 0) &&

861 (
vue
.
ty
.
Unsigd_I
 <= 127)) {

862 
max_ma
 = 
vue
.
ty
.
Unsigd_I
;

863 
	`dlmp_t_max_ma
(
max_ma
);

864 
	`om_bys_wre
(
NV_EEPROM_MAX_MASTER
, &
max_ma
, 1);

865 
us
 = 
ue
;

867 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

868 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

871 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

872 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

875 
PROP_OBJECT_NAME
:

876 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

877 
us
 =

878 
	`ba_me_wre_unique
(
NV_EEPROM_DEVICE_NAME
,

879 
wp_da
->
obje_ty
, wp_da->
obje_
,

880 &
vue
.
ty
.
Cha_Sg
, &
wp_da
->
r_ass
,

881 &
wp_da
->
r_code
);

883 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

884 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

887 
PROP_DESCRIPTION
:

888 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

889 
us
 =

890 
	`ba_me_wre
(
NV_EEPROM_DEVICE_DESCRIPTION
,

891 &
vue
.
ty
.
Cha_Sg
, &
wp_da
->
r_ass
,

892 &
wp_da
->
r_code
);

894 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

895 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

898 
PROP_LOCATION
:

899 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

900 
us
 =

901 
	`ba_me_wre
(
NV_EEPROM_DEVICE_LOCATION
,

902 &
vue
.
ty
.
Cha_Sg
, &
wp_da
->
r_ass
,

903 &
wp_da
->
r_code
);

905 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

906 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

910 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

911 i((
vue
.
ty
.
Unsigd_I
 <= 115200) &&

912 (
	`rs485_baud__t
(
vue
.
ty
.
Unsigd_I
))) {

913 
us
 = 
ue
;

915 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

916 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

919 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

920 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

923 
PROP_OBJECT_TYPE
:

924 
PROP_VENDOR_NAME
:

925 
PROP_FIRMWARE_REVISION
:

926 
PROP_APPLICATION_SOFTWARE_VERSION
:

927 
PROP_DAYLIGHT_SAVINGS_STATUS
:

928 
PROP_PROTOCOL_VERSION
:

929 
PROP_PROTOCOL_REVISION
:

930 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

931 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

932 
PROP_OBJECT_LIST
:

933 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

934 
PROP_SEGMENTATION_SUPPORTED
:

935 
PROP_DEVICE_ADDRESS_BINDING
:

936 
PROP_DATABASE_REVISION
:

939 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

940 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

943 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

944 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

948  
us
;

949 
	}
}

	@ports/bdk-atxx4-mstp/dlmstp.c

35 
	~<dbo.h
>

36 
	~<dt.h
>

37 
	~<ddef.h
>

38 
	~<rg.h
>

39 
	~"bacdef.h
"

40 
	~"dlmp.h
"

41 
	~"mpdef.h
"

42 
	~"rs485.h
"

43 
	~"c.h
"

44 
	~"du.h
"

45 
	~"bs.h
"

46 
	~"bys.h
"

47 
	~"baddr.h
"

48 
	~"rgbuf.h
"

49 
	~"tim.h
"

57 #ide
MSTP_PDU_PACKET_COUNT


58 #r 
MSTP_PDU_PACKET_COUNT
 
mu
 
be
 
defed
!

62 
MSTP_RECEIVE_STATE
 
	gReive_S
;

65 
MSTP_MASTER_STATE
 
	gMa_S
;

67 
	smp_ag_t
 {

71 
	mReivedInvidFme
:1;

75 
	mReivedVidFme
:1;

77 
	mReivedVidFmeNFUs
:1;

80 
	mSeMa
:1;

83 
	mReivePackPdg
:1;

84 } 
	gMSTP_Fg
;

87 
ut32_t
 
	gDaLgth
;

89 
ut8_t
 
	gDeiAddss
;

93 
ut8_t
 
	gEvtCou
;

95 
ut8_t
 
	gFmeTy
;

102 
ut8_t
 *
	gIutBufr
;

103 
ut16_t
 
	gIutBufrSize
;

105 
ut8_t
 
	gSourAddss
;

110 
ut8_t
 
	gThis_Sti
;

118 
ut8_t
 
	gNmax_fo_ames
 = 
MSTP_PDU_PACKET_COUNT
;

124 
ut8_t
 
	gNmax_ma
 = 127;

128 
	#Tno_tok
 500

	)

134 
	#Ty_timeout
 260

	)

140 
	#Tuge_timeout
 60

	)

144 
	#Npl
 50

	)

147 
	#Ny_tok
 1

	)

151 
	#Nm_os
 4

	)

159 
	#Tame_abt
 30

	)

163 
	#Tame_g
 20

	)

168 
	#Tpodrive
 15

	)

173 
	#Ty_day
 250

	)

177 
	#T
 10

	)

182 
	#Tuge_day
 15

	)

185 
	#INCREMENT_AND_LIMIT_UINT8
(
x
{i(x < 0xFFx++;}

	)

188 
	smp_pdu_ck
 {

189 
bo
 
	mda_exg_y
;

190 
ut8_t
 
	mdei_mac
;

191 
ut16_t
 
	mngth
;

192 
ut8_t
 
	mbufr
[
MAX_MPDU
];

194 
mp_pdu_ck
 
	gPDU_Bufr
[
MSTP_PDU_PACKET_COUNT
];

195 
RING_BUFFER
 
	gPDU_Queue
;

197 
bo
 
	$dlmp_
(

198 *
iame
)

200 
iame
 = ifname;

202 
	`Rgbuf_In
(&
PDU_Queue
, (
ut8_t
 *& 
PDU_Bufr
,

203 (
mp_pdu_ck
), 
MSTP_PDU_PACKET_COUNT
);

205  
ue
;

206 
	}
}

208 
	$dlmp_nup
(

212 
	}
}

214 
	$dlmp_fl_ba_addss
(

215 
BACNET_ADDRESS
 * 
c
,

216 
ut8_t
 
mp_addss
)

218 
i
 = 0;

220 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

222 
c
->
mac_n
 = 0;

223 
c
->
mac
[0] = 0;

225 
c
->
mac_n
 = 1;

226 
c
->
mac
[0] = 
mp_addss
;

229 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

230 
c
->
mac
[
i
] = 0;

232 
c
->
t
 = 0;

233 
c
->
n
 = 0;

234 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

235 
c
->
adr
[
i
] = 0;

237 
	}
}

239 
bo
 
	$dlmp_com_da_exg_y
(

240 
ut8_t
 * 
que_pdu
,

241 
ut16_t
 
que_pdu_n
,

242 
ut8_t
 
c_addss
,

243 
ut8_t
 * 
y_pdu
,

244 
ut16_t
 
y_pdu_n
,

245 
ut8_t
 
de_addss
)

247 
ut16_t
 
offt
;

251 
	sDER_com_t
 {

252 
BACNET_NPDU_DATA
 
du_da
;

253 
BACNET_ADDRESS
 
addss
;

254 
ut8_t
 
pdu_ty
;

255 
ut8_t
 
voke_id
;

256 
ut8_t
 
rvi_choi
;

258 
DER_com_t
 
que
;

259 
DER_com_t
 
y
;

262 
que
.
addss
.
mac
[0] = 
c_addss
;

263 
que
.
addss
.
mac_n
 = 1;

264 
offt
 =

265 
	`du_decode
(&
que_pdu
[0], 
NULL
, &
que
.
addss
,

266 &
que
.
du_da
);

267 i(
que
.
du_da
.
twk_y_mesge
) {

268  
l
;

270 
que
.
pdu_ty
 = 
que_pdu
[
offt
] & 0xF0;

271 i(
que
.
pdu_ty
 !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
) {

272  
l
;

274 
que
.
voke_id
 = 
que_pdu
[
offt
 + 2];

276 i(
que_pdu
[
offt
] & 
BIT3
)

277 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 5];

279 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 3];

281 
y
.
addss
.
mac
[0] = 
de_addss
;

282 
y
.
addss
.
mac_n
 = 1;

283 
offt
 =

284 
	`du_decode
(&
y_pdu
[0], &
y
.
addss
, 
NULL
, &y.
du_da
);

285 i(
y
.
du_da
.
twk_y_mesge
) {

286  
l
;

290 
y
.
pdu_ty
 = 
y_pdu
[
offt
] & 0xF0;

291 
y
.
pdu_ty
) {

292 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

293 
y
.
voke_id
 = 
y_pdu
[
offt
 + 2];

295 i(
y_pdu
[
offt
] & 
BIT3
)

296 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 5];

298 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 3];

300 
PDU_TYPE_SIMPLE_ACK
:

301 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

302 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

304 
PDU_TYPE_COMPLEX_ACK
:

305 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

307 i(
y_pdu
[
offt
] & 
BIT3
)

308 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 4];

310 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

312 
PDU_TYPE_ERROR
:

313 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

314 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

316 
PDU_TYPE_REJECT
:

317 
PDU_TYPE_ABORT
:

318 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

321  
l
;

323 i(
que
.
voke_id
 !
y
.invoke_id) {

324  
l
;

327 i((
y
.
pdu_ty
 !
PDU_TYPE_REJECT
) &&

328 (
y
.
pdu_ty
 !
PDU_TYPE_ABORT
)) {

329 i(
que
.
rvi_choi
 !
y
.service_choice) {

330  
l
;

333 i(
que
.
du_da
.
oc_vsi
 !
y
.npdu_data.protocol_version) {

334  
l
;

339 i(
que
.
du_da
.
iܙy
 !
y
.npdu_data.priority) {

340  
l
;

343 i(!
	`ba_addss_me
(&
que
.
addss
, &
y
.address)) {

344  
l
;

347  
ue
;

348 
	}
}

363 
	$MSTP_Sd_Fme
(

364 
ut8_t
 
ame_ty
,

365 
ut8_t
 
dei
,

366 
ut8_t
 
sour
,

367 
ut8_t
 * 
da
,

368 
ut16_t
 
da_n
)

370 
ut8_t
 
c8
 = 0xFF;

371 
ut16_t
 
c16
 = 0xFFFF;

372 
ut8_t
 
bufr
[8];

373 
ut8_t
 
bufr_c
[2];

374 
ut16_t
 
i
 = 0;

377 
bufr
[0] = 0x55;

378 
bufr
[1] = 0xFF;

379 
bufr
[2] = 
ame_ty
;

380 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[2], crc8);

381 
bufr
[3] = 
dei
;

382 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[3], crc8);

383 
bufr
[4] = 
sour
;

384 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[4], crc8);

385 
bufr
[5] = 
	`HI_BYTE
(
da_n
);

386 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[5], crc8);

387 
bufr
[6] = 
	`LO_BYTE
(
da_n
);

388 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[6], crc8);

389 
bufr
[7] = ~
c8
;

390 i(
da_n
) {

392 
i
 = 0; i < 
da_n
; i++) {

393 
c16
 = 
	`CRC_Cc_Da
(
da
[
i
], crc16);

395 
c16
 = ~crc16;

396 
bufr_c
[0] = (
c16
 & 0x00FF);

397 
bufr_c
[1] = ((
c16
 & 0xFF00) >> 8);

402 
	`rs485_tuound_day
();

403 
	`rs485_s_ab
(
ue
);

404 
	`rs485_bys_nd
(
bufr
, 8);

405 i(
da_n
) {

406 
	`rs485_bys_nd
(
da
, 
da_n
);

407 
	`rs485_bys_nd
(
bufr_c
, 2);

409 
	`rs485_s_ab
(
l
);

410 
	}
}

412 
	$MSTP_Reive_Fme_FSM
(

416 
ut8_t
 
DaRegi
 = 0;

418 
ut16_t
 
DaCRC
 = 0;

420 
ut8_t
 
HdCRC
 = 0;

423 
ut16_t
 
Index
 = 0;

425 
Reive_S
) {

426 
MSTP_RECEIVE_STATE_IDLE
:

429 i(
	`rs485_ive_r
()) {

431 
	`rs485_s_time_t
();

432 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

433 } i(
	`rs485_by_avaab
(&
DaRegi
)) {

434 
	`rs485_s_time_t
();

435 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

436 i(
DaRegi
 == 0x55) {

439 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

443 
MSTP_RECEIVE_STATE_PREAMBLE
:

446 i(
	`rs485_s_time_d
(
Tame_abt
)) {

450 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

451 } i(
	`rs485_ive_r
()) {

453 
	`rs485_s_time_t
();

454 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

456 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

457 } i(
	`rs485_by_avaab
(&
DaRegi
)) {

458 
	`rs485_s_time_t
();

459 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

460 i(
DaRegi
 == 0xFF) {

462 
Index
 = 0;

463 
HdCRC
 = 0xFF;

465 
Reive_S
 = 
MSTP_RECEIVE_STATE_HEADER
;

466 } i(
DaRegi
 == 0x55) {

469 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

473 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

477 
MSTP_RECEIVE_STATE_HEADER
:

480 i(
	`rs485_s_time_d
(
Tame_abt
)) {

484 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

486 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

487 } i(
	`rs485_ive_r
()) {

489 
	`rs485_s_time_t
();

490 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

493 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

495 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

496 } i(
	`rs485_by_avaab
(&
DaRegi
)) {

497 
	`rs485_s_time_t
();

498 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

499 i(
Index
 == 0) {

501 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

502 
FmeTy
 = 
DaRegi
;

503 
Index
 = 1;

504 } i(
Index
 == 1) {

506 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

507 
DeiAddss
 = 
DaRegi
;

508 
Index
 = 2;

509 } i(
Index
 == 2) {

511 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

512 
SourAddss
 = 
DaRegi
;

513 
Index
 = 3;

514 } i(
Index
 == 3) {

516 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

517 
DaLgth
 = 
DaRegi
 * 256;

518 
Index
 = 4;

519 } i(
Index
 == 4) {

521 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

522 
DaLgth
 +
DaRegi
;

523 
Index
 = 5;

524 } i(
Index
 == 5) {

526 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

529 i(
HdCRC
 != 0x55) {

533 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

535 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

537 i(
DaLgth
 == 0) {

539 i((
DeiAddss
 =
This_Sti
) ||

540 (
DeiAddss
 ==

541 
MSTP_BROADCAST_ADDRESS
)) {

545 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

548 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
ue
;

551 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

554 i((
DeiAddss
 =
This_Sti
) ||

555 (
DeiAddss
 ==

556 
MSTP_BROADCAST_ADDRESS
)) {

557 i(
DaLgth
 <
IutBufrSize
) {

559 
Reive_S
 = 
MSTP_RECEIVE_STATE_DATA
;

562 
Reive_S
 =

563 
MSTP_RECEIVE_STATE_SKIP_DATA
;

567 
Reive_S
 = 
MSTP_RECEIVE_STATE_SKIP_DATA
;

569 
Index
 = 0;

570 
DaCRC
 = 0xFFFF;

576 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

578 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

582 
MSTP_RECEIVE_STATE_DATA
:

583 
MSTP_RECEIVE_STATE_SKIP_DATA
:

586 i(
	`rs485_s_time_d
(
Tame_abt
)) {

590 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

592 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

593 } i(
	`rs485_ive_r
()) {

595 
	`rs485_s_time_t
();

596 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

599 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

601 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

602 } i(
	`rs485_by_avaab
(&
DaRegi
)) {

603 
	`rs485_s_time_t
();

604 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

605 i(
Index
 < 
DaLgth
) {

607 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

608 i(
Index
 < 
IutBufrSize
) {

609 
IutBufr
[
Index
] = 
DaRegi
;

611 
Index
++;

612 } i(
Index
 =
DaLgth
) {

614 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

615 
Index
++;

616 } i(
Index
 =(
DaLgth
 + 1)) {

618 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

621 i(
DaCRC
 == 0xF0B8) {

622 i(
Reive_S
 =
MSTP_RECEIVE_STATE_DATA
) {

624 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

627 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
ue
;

631 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

633 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

639 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

644 
	}
}

646 #ifde
MSTP_DEBUG_STATES


647 
MSTP_MASTER_STATE
 
	gMa_S_Log
[128];

648 
	gma_e_log_dex
 = 0;

649 
	$log_ma_e
(

650 
MSTP_MASTER_STATE
 
e
)

652 
Ma_S_Log
[
ma_e_log_dex
] = 
e
;

653 
ma_e_log_dex
++;

654 i(
ma_e_log_dex
 > 128) {

655 
ma_e_log_dex
 = 0;

657 
	}
}

659 
	#log_ma_e
(
n
(;

	)

663 
bo
 
	$MSTP_Ma_Node_FSM
(

669 
ut8_t
 
FmeCou
 = 0;

673 
ut8_t
 
Next_Sti
 = 0;

676 
ut8_t
 
Pl_Sti
 = 0;

679 
RryCou
 = 0;

684 
TokCou
 = 0;

686 
ut8_t
 
xt_pl_i
 = 0;

687 
ut8_t
 
xt_this_i
 = 0;

688 
ut8_t
 
xt_xt_i
 = 0;

690 
ut16_t
 
my_timeout
 = 10, 
ns_timeout
 = 0;

691 
bo
 
mched
 = 
l
;

692 
bo
 
timeout
 = 
l
;

694 
bo
 
si_now
 = 
l
;

696 
mp_pdu_ck
 *
pkt
 = 
NULL
;

699 
xt_pl_i
 = (
Pl_Sti
 + 1% (
Nmax_ma
 + 1);

700 
xt_this_i
 = (
This_Sti
 + 1% (
Nmax_ma
 + 1);

701 
xt_xt_i
 = (
Next_Sti
 + 1% (
Nmax_ma
 + 1);

702 
	`log_ma_e
(
Ma_S
);

703 
Ma_S
) {

704 
MSTP_MASTER_STATE_INITIALIZE
:

707 
Next_Sti
 = 
This_Sti
;

708 
Pl_Sti
 = 
This_Sti
;

711 
TokCou
 = 
Npl
;

712 
MSTP_Fg
.
SeMa
 = 
l
;

713 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

714 
si_now
 = 
ue
;

716 
MSTP_MASTER_STATE_IDLE
:

718 i(
	`rs485_s_time_d
(
Tno_tok
)) {

721 
EvtCou
 = 0;

724 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

725 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

726 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

727 
Ma_S
 = 
MSTP_MASTER_STATE_NO_TOKEN
;

728 
si_now
 = 
ue
;

729 } i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

732 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

734 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

735 
FmeTy
) {

736 
FRAME_TYPE_TOKEN
:

739 i(
DeiAddss
 =
MSTP_BROADCAST_ADDRESS
)

741 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

742 
FmeCou
 = 0;

743 
MSTP_Fg
.
SeMa
 = 
l
;

744 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

745 
si_now
 = 
ue
;

747 
FRAME_TYPE_POLL_FOR_MASTER
:

750 i(
DeiAddss
 =
This_Sti
) {

751 
	`MSTP_Sd_Fme
(
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

752 
SourAddss
, 
This_Sti
, 
NULL
, 0);

755 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

757 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

759 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

761 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

763 i(
DeiAddss
 !
MSTP_BROADCAST_ADDRESS
) {

764 
Ma_S
 =

765 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
;

768 
FRAME_TYPE_TEST_REQUEST
:

769 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TEST_RESPONSE
,

770 
SourAddss
, 
This_Sti
, &
IutBufr
[0],

771 
DaLgth
);

773 
FRAME_TYPE_TEST_RESPONSE
:

779 i(
Ma_S
 !
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
) {

780 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

787 
MSTP_MASTER_STATE_USE_TOKEN
:

789 i(
	`Rgbuf_Emy
(&
PDU_Queue
)) {

791 
FmeCou
 = 
Nmax_fo_ames
;

792 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

793 
si_now
 = 
ue
;

795 
ut8_t
 
ame_ty
;

796 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
PDU_Queue
);

797 i(
pkt
->
da_exg_y
) {

798 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

800 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

802 
	`MSTP_Sd_Fme
(
ame_ty
, 
pkt
->
dei_mac
, 
This_Sti
,

803 (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

804 
FmeCou
++;

805 
ame_ty
) {

806 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

808 i(
pkt
->
dei_mac
 =
MSTP_BROADCAST_ADDRESS
)

809 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

811 
Ma_S
 = 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

813 
FRAME_TYPE_TEST_REQUEST
:

814 
Ma_S
 = 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

816 
FRAME_TYPE_TEST_RESPONSE
:

817 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

820 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

823 (
	`Rgbuf_P
(&
PDU_Queue
, 
NULL
);

826 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

829 i(
	`rs485_s_time_d
(
Ty_timeout
)) {

832 
FmeCou
 = 
Nmax_fo_ames
;

833 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

840 
si_now
 = 
ue
;

842 i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

845 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

846 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

847 
si_now
 = 
ue
;

848 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

849 i(
DeiAddss
 =
This_Sti
) {

851 
FmeTy
) {

852 
FRAME_TYPE_REPLY_POSTPONED
:

854 
Ma_S
 =

855 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

857 
FRAME_TYPE_TEST_RESPONSE
:

858 
Ma_S
 =

859 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

861 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

867 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

868 
Ma_S
 =

869 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

874 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

885 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

887 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

888 
si_now
 = 
ue
;

894 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
:

896 i(
FmeCou
 < 
Nmax_fo_ames
) {

899 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

900 
si_now
 = 
ue
;

901 } i((
MSTP_Fg
.
SeMa
 =
l
) &&

902 (
Next_Sti
 =
This_Sti
)) {

906 
Pl_Sti
 = 
xt_this_i
;

907 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

908 
This_Sti
, 
NULL
, 0);

909 
RryCou
 = 0;

910 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

913 i(
TokCou
 < (
Npl
 - 1)) {

914 i((
MSTP_Fg
.
SeMa
 =
ue
) &&

915 (
Next_Sti
 !
xt_this_i
)) {

920 
FmeCou
 = 0;

921 
TokCou
++;

922 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

923 
si_now
 = 
ue
;

933 
TokCou
++;

935 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

936 
This_Sti
, 
NULL
, 0);

937 
RryCou
 = 0;

938 
EvtCou
 = 0;

939 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

941 } i(
xt_pl_i
 =
Next_Sti
) {

942 i(
MSTP_Fg
.
SeMa
 =
ue
) {

944 
Pl_Sti
 = 
xt_xt_i
;

945 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

946 
This_Sti
, 
NULL
, 0);

948 
Next_Sti
 = 
This_Sti
;

949 
RryCou
 = 0;

950 
TokCou
 = 1;

953 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

956 
Pl_Sti
 = 
This_Sti
;

958 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

959 
This_Sti
, 
NULL
, 0);

960 
RryCou
 = 0;

961 
TokCou
 = 1;

962 
EvtCou
 = 0;

963 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

967 
Pl_Sti
 = 
xt_pl_i
;

968 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

969 
This_Sti
, 
NULL
, 0);

970 
RryCou
 = 0;

971 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

976 
MSTP_MASTER_STATE_PASS_TOKEN
:

977 i(
	`rs485_s_time_d
(
Tuge_timeout
)) {

978 i(
RryCou
 < 
Ny_tok
) {

980 
RryCou
++;

982 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

983 
This_Sti
, 
NULL
, 0);

984 
EvtCou
 = 0;

991 
Pl_Sti
 = 
xt_xt_i
;

993 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

994 
This_Sti
, 
NULL
, 0);

996 
Next_Sti
 = 
This_Sti
;

997 
RryCou
 = 0;

998 
TokCou
 = 0;

1001 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1004 i(
EvtCou
 > 
Nm_os
) {

1009 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1010 
si_now
 = 
ue
;

1019 
MSTP_MASTER_STATE_NO_TOKEN
:

1020 
my_timeout
 = 
Tno_tok
 + (
T
 * 
This_Sti
);

1021 i(
	`rs485_s_time_d
(
my_timeout
)) {

1022 
ns_timeout
 = 
Tno_tok
 + (
T
 * (
This_Sti
 + 1));

1023 i(
	`rs485_s_time_d
(
ns_timeout
)) {

1025 
	`rs485_s_time_t
();

1026 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1031 
Pl_Sti
 = 
xt_this_i
;

1033 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

1034 
This_Sti
, 
NULL
, 0);

1036 
Next_Sti
 = 
This_Sti
;

1037 
RryCou
 = 0;

1038 
TokCou
 = 0;

1042 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1045 i(
EvtCou
 > 
Nm_os
) {

1050 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1051 
si_now
 = 
ue
;

1058 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

1059 i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

1060 i((
DeiAddss
 =
This_Sti
)

1061 && (
FmeTy
 =
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
)) {

1063 
MSTP_Fg
.
SeMa
 = 
l
;

1064 
Next_Sti
 = 
SourAddss
;

1065 
EvtCou
 = 0;

1067 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1068 
This_Sti
, 
NULL
, 0);

1069 
Pl_Sti
 = 
This_Sti
;

1070 
TokCou
 = 0;

1071 
RryCou
 = 0;

1072 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1079 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1080 
si_now
 = 
ue
;

1082 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1083 } i((
	`rs485_s_time_d
(
Tuge_timeout
)) ||

1084 (
MSTP_Fg
.
ReivedInvidFme
 =
ue
)) {

1085 i(
MSTP_Fg
.
SeMa
 =
ue
) {

1089 
FmeCou
 = 0;

1091 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1092 
si_now
 = 
ue
;

1094 i(
Next_Sti
 !
This_Sti
) {

1098 
EvtCou
 = 0;

1100 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1101 
This_Sti
, 
NULL
, 0);

1102 
RryCou
 = 0;

1103 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1105 i(
xt_pl_i
 !
This_Sti
) {

1107 
Pl_Sti
 = 
xt_pl_i
;

1109 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
,

1110 
Pl_Sti
, 
This_Sti
, 
NULL
, 0);

1111 
RryCou
 = 0;

1117 
MSTP_Fg
.
SeMa
 = 
ue
;

1118 
FmeCou
 = 0;

1119 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1120 
si_now
 = 
ue
;

1124 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

1127 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
:

1131 
timeout
 = 
	`rs485_s_time_d
(
Ty_day
);

1132 i(!
timeout
) {

1133 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
PDU_Queue
);

1134 i(
pkt
 !
NULL
) {

1135 
mched
 =

1136 
	`dlmp_com_da_exg_y
(&
IutBufr
[0],

1137 
DaLgth
, 
SourAddss
, &
pkt
->
bufr
[0],

1138 
pkt
->
ngth
,kt->
dei_mac
);

1140 
mched
 = 
l
;

1143 i(
mched
) {

1151 
ut8_t
 
ame_ty
;

1152 i(
pkt
->
da_exg_y
) {

1153 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

1155 
ame_ty
 =

1156 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

1158 
	`MSTP_Sd_Fme
(
ame_ty
, 
pkt
->
dei_mac
,

1159 
This_Sti
, (
ut8_t
 *& 
pkt
->
bufr
[0],

1160 
pkt
->
ngth
);

1161 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1163 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1165 (
	`Rgbuf_P
(&
PDU_Queue
, 
NULL
);

1166 } i((
pkt
 !
NULL
|| 
timeout
) {

1176 
	`MSTP_Sd_Fme
(
FRAME_TYPE_REPLY_POSTPONED
, 
SourAddss
,

1177 
This_Sti
, 
NULL
, 0);

1178 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1180 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1184 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1188  
si_now
;

1189 
	}
}

1192 
	$dlmp_nd_pdu
(

1193 
BACNET_ADDRESS
 * 
de
,

1194 
BACNET_NPDU_DATA
 * 
du_da
,

1195 
ut8_t
 * 
pdu
,

1196 
pdu_n
)

1198 
bys_
 = 0;

1199 
mp_pdu_ck
 *
pkt
;

1200 
ut16_t
 
i
 = 0;

1202 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Da_Pk
(&
PDU_Queue
);

1203 i(
pkt
) {

1204 
pkt
->
da_exg_y
 = 
du_da
->data_expecting_reply;

1205 
i
 = 0; i < 
pdu_n
; i++) {

1206 
pkt
->
bufr
[
i
] = 
pdu
[i];

1208 
pkt
->
ngth
 = 
pdu_n
;

1209 i(
de
 && de->
mac_n
) {

1210 
pkt
->
dei_mac
 = 
de
->
mac
[0];

1213 
pkt
->
dei_mac
 = 
MSTP_BROADCAST_ADDRESS
;

1215 i(
	`Rgbuf_Da_Put
(&
PDU_Queue
, (
ut8_t
 *)
pkt
)) {

1216 
bys_
 = 
pdu_n
;

1220  
bys_
;

1221 
	}
}

1224 
ut16_t
 
	$dlmp_ive
(

1225 
BACNET_ADDRESS
 * 
c
,

1226 
ut8_t
 * 
pdu
,

1227 
ut16_t
 
max_pdu
,

1228 
timeout
)

1230 
ut16_t
 
pdu_n
 = 0;

1233 i(!
IutBufr
) {

1234 
IutBufr
 = 
pdu
;

1235 
IutBufrSize
 = 
max_pdu
;

1237 (
MSTP_Fg
.
ReivedVidFme
 =
l
) &&

1238 (
MSTP_Fg
.
ReivedVidFmeNFUs
 =
l
) &&

1239 (
MSTP_Fg
.
ReivedInvidFme
 =
l
)) {

1241 
	`MSTP_Reive_Fme_FSM
();

1243 i(!
	`rs485_by_avaab
(
NULL
)) {

1247 i(
MSTP_Fg
.
ReivedVidFmeNFUs
) {

1248 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

1250 i(
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
) {

1252 i(
This_Sti
 <
DEFAULT_MAX_MASTER
) {

1253 
	`MSTP_Ma_Node_FSM
()) {

1257 #i
SLEEP_ENABLED


1258 
	`p_mode
();

1262 i(
MSTP_Fg
.
ReivePackPdg
) {

1263 
MSTP_Fg
.
ReivePackPdg
 = 
l
;

1264 
pdu_n
 = 
DaLgth
;

1265 
c
->
mac_n
 = 1;

1266 
c
->
mac
[0] = 
SourAddss
;

1270  
pdu_n
;

1271 
	}
}

1273 
	$dlmp_t_mac_addss
(

1274 
ut8_t
 
mac_addss
)

1277 i(
mac_addss
 <= 127) {

1278 
This_Sti
 = 
mac_addss
;

1279 i(
mac_addss
 > 
Nmax_ma
)

1280 
	`dlmp_t_max_ma
(127);

1284 
	}
}

1286 
ut8_t
 
	$dlmp_mac_addss
(

1289  
This_Sti
;

1290 
	}
}

1299 
	$dlmp_t_max_fo_ames
(

1300 
ut8_t
 
max_fo_ames
)

1302 i(
max_fo_ames
 >
MSTP_PDU_PACKET_COUNT
) {

1303 
Nmax_fo_ames
 = 
max_fo_ames
;

1307 
	}
}

1309 
ut8_t
 
	$dlmp_max_fo_ames
(

1312  
Nmax_fo_ames
;

1313 
	}
}

1320 
	$dlmp_t_max_ma
(

1321 
ut8_t
 
max_ma
)

1323 i(
max_ma
 <= 127) {

1324 i(
This_Sti
 <
max_ma
) {

1325 
Nmax_ma
 = 
max_ma
;

1330 
	}
}

1332 
ut8_t
 
	$dlmp_max_ma
(

1335  
Nmax_ma
;

1336 
	}
}

1338 
	$dlmp_g_my_addss
(

1339 
BACNET_ADDRESS
 * 
my_addss
)

1341 
i
 = 0;

1343 
my_addss
->
mac_n
 = 1;

1344 
my_addss
->
mac
[0] = 
This_Sti
;

1345 
my_addss
->
t
 = 0;

1346 
my_addss
->
n
 = 0;

1347 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1348 
my_addss
->
adr
[
i
] = 0;

1352 
	}
}

1354 
	$dlmp_g_brd_addss
(

1355 
BACNET_ADDRESS
 * 
de
)

1357 
i
 = 0;

1359 i(
de
) {

1360 
de
->
mac_n
 = 1;

1361 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

1362 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

1363 
de
->
n
 = 0;

1364 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1365 
de
->
adr
[
i
] = 0;

1370 
	}
}

	@ports/bdk-atxx4-mstp/eeprom.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~<dlib.h
>

27 
	~"hdwe.h
"

28 
	~"om.h
"

33 
	$om_bys_ad
(

34 
ut16_t
 
addr
,

35 
ut8_t
 * 
buf
,

36 
n
)

38 
cou
 = 0;

40 
n
) {

41 
	`__EEGET
(
buf
[
cou
], 
addr
);

42 
cou
++;

43 
addr
++;

44 
n
--;

47  
cou
;

48 
	}
}

50 
	$om_bys_wre
(

51 
ut16_t
 
addr
,

52 
ut8_t
 * 
buf
,

53 
n
)

55 
cou
 = 0;

57 
n
) {

58 
	`__EEPUT
(
addr
, 
buf
[
cou
]);

59 
cou
++;

60 
addr
++;

61 
n
--;

64  
cou
;

65 
	}
}

	@ports/bdk-atxx4-mstp/eeprom.h

24 #ide
EEPROM_H


25 
	#EEPROM_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

30 #ifde
__lulus


34 
om_bys_ad
(

35 
ut16_t
 
_addss
,

36 
ut8_t
 * 
bufr
,

37 
nbys
);

38 
om_bys_wre
(

39 
ut16_t
 
_addss
,

40 
ut8_t
 * 
bufr
,

41 
nbys
);

43 #ifde
__lulus


	@ports/bdk-atxx4-mstp/fuses.c

25 
	~"hdwe.h
"

27 #i
defed
(
__GNUC__
) && (__GNUC__ >= 4)

29 
	gFUSES
 = {

55 .
low
 = (
FUSE_CKSEL3
 & 
FUSE_SUT1
),

74 .
	ghigh
 = (
FUSE_BOOTSZ1
 & 
FUSE_EESAVE
 & 
FUSE_SPIEN
 & 
FUSE_JTAGEN
),

88 .
	gexnded
 = (
FUSE_BODLEVEL1
 & 
FUSE_BODLEVEL0
)

92 
	gLOCKBITS
 = 
LOCKBITS_DEFAULT
;

	@ports/bdk-atxx4-mstp/hardware.h

25 #ide
HARDWARE_H


26 
	#HARDWARE_H


	)

28 #i!
defed
(
F_CPU
)

30 
	#F_CPU
 18432000UL

	)

34 #i
defed
(
__ICCAVR__
)

35 #i
defed
(
__ATmega644P__
)

36 
	~<iom644p.h
>

38 #i
defed
(
__ATmega1284P__
)

39 
	~<iom1284p.h
>

44 #i
defed
(
__GNUC__
)

45 
	~<avr/io.h
>

46 
	~<avr/wdt.h
>

47 
	~<avr/pow.h
>

48 #i
defed
(
__AVR_ATmega644P__
)

50 #i
defed
(
__AVR_ATmega1284P__
)

53 #r 
F
 
ATmega644P
 

 
ATmega1284p
 
ly
 (-
mmcu
=
mega644p
 -mmcu=
mega1284p
)

57 #i
defed
 (
__CROSSWORKS_AVR
)

58 
	~<avr.h
>

59 #i(
__TARGET_PROCESSOR
 !
ATmega644P
)

60 #r 
Fmwe
 
is
 
cfigud
 
ATmega644P
 
ly


64 
	~"r2gcc.h
"

65 
	~"bs.h
"

71 #ide
SEEPROM_PAGE_SIZE


72 
	#SEEPROM_PAGE_SIZE
 16

	)

74 #ide
SEEPROM_WORD_ADDRESS_16BIT


75 
	#SEEPROM_WORD_ADDRESS_16BIT
 0

	)

79 
	#SEEPROM_I2C_ADDRESS
 0xA0

	)

81 
	#SEEPROM_I2C_CLOCK
 400000L

	)

83 
	#SEEPROM_WRITE_CYCLE
 5

	)

85 
	#LED_2
 2

	)

86 
	#LED_3
 3

	)

87 
	#LED_4
 1

	)

88 
	#LED_5
 0

	)

89 
	#MAX_LEDS
 4

	)

	@ports/bdk-atxx4-mstp/iar2gcc.h

24 #ide
IAR2GCC_H


25 
	#IAR2GCC_H


	)

29 #i!
defed
(
F_CPU
)

30 #r 
You
 
mu
 
defe
 
F_CPU
 - 
ock
 
equcy
!

33 #i
defed
 (
__CROSSWORKS_AVR
)

34 
	~<avr.h
>

35 
	~<dt.h
>

39 #i
defed
(
__ICCAVR__
)

40 
	~<avr.h
>

41 
	~<sics.h
>

42 
	~<dt.h
>

45 
le
 
	$_day_us
(

46 
ut8_t
 
miocds
)

49 
	`__day_cyes
(
F_CPU
 / 1000000UL);

50 } 
miocds
--);

51 
	}
}

54 #i
defed
(
__GNUC__
)

55 
	~<ut/day.h
>

59 #i
defed
 (
__CROSSWORKS_AVR
)

60 #i(
__TARGET_PROCESSOR
 =
ATmega644P
)

61 
	#PRR
 
PRR0


	)

62 
	#UBRR0
 
UBRR0W


	)

63 
	#UBRR1
 
UBRR1W


	)

65 
	#PA0
 
PORTA0


	)

66 
	#PA1
 
PORTA1


	)

67 
	#PA2
 
PORTA2


	)

68 
	#PA3
 
PORTA3


	)

69 
	#PA4
 
PORTA4


	)

70 
	#PA5
 
PORTA5


	)

71 
	#PA6
 
PORTA6


	)

72 
	#PA7
 
PORTA7


	)

74 
	#PB0
 
PORTB0


	)

75 
	#PB1
 
PORTB1


	)

76 
	#PB2
 
PORTB2


	)

77 
	#PB3
 
PORTB3


	)

78 
	#PB4
 
PORTB4


	)

79 
	#PB5
 
PORTB5


	)

80 
	#PB6
 
PORTB6


	)

81 
	#PB7
 
PORTB7


	)

83 
	#PC0
 
PORTC0


	)

84 
	#PC1
 
PORTC1


	)

85 
	#PC2
 
PORTC2


	)

86 
	#PC3
 
PORTC3


	)

87 
	#PC4
 
PORTC4


	)

88 
	#PC5
 
PORTC5


	)

89 
	#PC6
 
PORTC6


	)

90 
	#PC7
 
PORTC7


	)

92 
	#PD0
 
PORTD0


	)

93 
	#PD1
 
PORTD1


	)

94 
	#PD2
 
PORTD2


	)

95 
	#PD3
 
PORTD3


	)

96 
	#PD4
 
PORTD4


	)

97 
	#PD5
 
PORTD5


	)

98 
	#PD6
 
PORTD6


	)

99 
	#PD7
 
PORTD7


	)

105 #i
defed
(
__GNUC__
)

106 
	~<avr/io.h
>

109 
	mb0
:1;

110 
	mb1
:1;

111 
	mb2
:1;

112 
	mb3
:1;

113 
	mb4
:1;

114 
	mb5
:1;

115 
	mb6
:1;

116 
	mb7
:1;

117 } 
	tBRegiTy
;

119 #ide
ue


120 
	#ue
 1

	)

123 #ide
l


124 
	#l
 0

	)

127 
	#GPIO_BITREG
(
pt
,
bnum
) \

128 ((vީ
BRegiTy
*)
	`_SFR_MEM_ADDR
(
pt
) \

129 )->
b
 ## 
bnum


	)

131 
	#PINA_B0
 
	`GPIO_BITREG
(
PINA
,0)

	)

132 
	#PINA_B1
 
	`GPIO_BITREG
(
PINA
,1)

	)

133 
	#PINA_B2
 
	`GPIO_BITREG
(
PINA
,2)

	)

134 
	#PINA_B3
 
	`GPIO_BITREG
(
PINA
,3)

	)

135 
	#PINA_B4
 
	`GPIO_BITREG
(
PINA
,4)

	)

136 
	#PINA_B5
 
	`GPIO_BITREG
(
PINA
,5)

	)

137 
	#PINA_B6
 
	`GPIO_BITREG
(
PINA
,6)

	)

138 
	#PINA_B7
 
	`GPIO_BITREG
(
PINA
,7)

	)

140 
	#PORTA_B0
 
	`GPIO_BITREG
(
PORTA
,0)

	)

141 
	#PORTA_B1
 
	`GPIO_BITREG
(
PORTA
,1)

	)

142 
	#PORTA_B2
 
	`GPIO_BITREG
(
PORTA
,2)

	)

143 
	#PORTA_B3
 
	`GPIO_BITREG
(
PORTA
,3)

	)

144 
	#PORTA_B4
 
	`GPIO_BITREG
(
PORTA
,4)

	)

145 
	#PORTA_B5
 
	`GPIO_BITREG
(
PORTA
,5)

	)

146 
	#PORTA_B6
 
	`GPIO_BITREG
(
PORTA
,6)

	)

147 
	#PORTA_B7
 
	`GPIO_BITREG
(
PORTA
,7)

	)

149 
	#PINB_B0
 
	`GPIO_BITREG
(
PINB
,0)

	)

150 
	#PINB_B1
 
	`GPIO_BITREG
(
PINB
,1)

	)

151 
	#PINB_B2
 
	`GPIO_BITREG
(
PINB
,2)

	)

152 
	#PINB_B3
 
	`GPIO_BITREG
(
PINB
,3)

	)

153 
	#PINB_B4
 
	`GPIO_BITREG
(
PINB
,4)

	)

154 
	#PINB_B5
 
	`GPIO_BITREG
(
PINB
,5)

	)

155 
	#PINB_B6
 
	`GPIO_BITREG
(
PINB
,6)

	)

156 
	#PINB_B7
 
	`GPIO_BITREG
(
PINB
,7)

	)

158 
	#PORTB_B0
 
	`GPIO_BITREG
(
PORTB
,0)

	)

159 
	#PORTB_B1
 
	`GPIO_BITREG
(
PORTB
,1)

	)

160 
	#PORTB_B2
 
	`GPIO_BITREG
(
PORTB
,2)

	)

161 
	#PORTB_B3
 
	`GPIO_BITREG
(
PORTB
,3)

	)

162 
	#PORTB_B4
 
	`GPIO_BITREG
(
PORTB
,4)

	)

163 
	#PORTB_B5
 
	`GPIO_BITREG
(
PORTB
,5)

	)

164 
	#PORTB_B6
 
	`GPIO_BITREG
(
PORTB
,6)

	)

165 
	#PORTB_B7
 
	`GPIO_BITREG
(
PORTB
,7)

	)

167 
	#PINC_B0
 
	`GPIO_BITREG
(
PINC
,0)

	)

168 
	#PINC_B1
 
	`GPIO_BITREG
(
PINC
,1)

	)

169 
	#PINC_B2
 
	`GPIO_BITREG
(
PINC
,2)

	)

170 
	#PINC_B3
 
	`GPIO_BITREG
(
PINC
,3)

	)

171 
	#PINC_B4
 
	`GPIO_BITREG
(
PINC
,4)

	)

172 
	#PINC_B5
 
	`GPIO_BITREG
(
PINC
,5)

	)

173 
	#PINC_B6
 
	`GPIO_BITREG
(
PINC
,6)

	)

174 
	#PINC_B7
 
	`GPIO_BITREG
(
PINC
,7)

	)

176 
	#PORTC_B0
 
	`GPIO_BITREG
(
PORTC
,0)

	)

177 
	#PORTC_B1
 
	`GPIO_BITREG
(
PORTC
,1)

	)

178 
	#PORTC_B2
 
	`GPIO_BITREG
(
PORTC
,2)

	)

179 
	#PORTC_B3
 
	`GPIO_BITREG
(
PORTC
,3)

	)

180 
	#PORTC_B4
 
	`GPIO_BITREG
(
PORTC
,4)

	)

181 
	#PORTC_B5
 
	`GPIO_BITREG
(
PORTC
,5)

	)

182 
	#PORTC_B6
 
	`GPIO_BITREG
(
PORTC
,6)

	)

183 
	#PORTC_B7
 
	`GPIO_BITREG
(
PORTC
,7)

	)

185 
	#PIND_B0
 
	`GPIO_BITREG
(
PIND
,0)

	)

186 
	#PIND_B1
 
	`GPIO_BITREG
(
PIND
,1)

	)

187 
	#PIND_B2
 
	`GPIO_BITREG
(
PIND
,2)

	)

188 
	#PIND_B3
 
	`GPIO_BITREG
(
PIND
,3)

	)

189 
	#PIND_B4
 
	`GPIO_BITREG
(
PIND
,4)

	)

190 
	#PIND_B5
 
	`GPIO_BITREG
(
PIND
,5)

	)

191 
	#PIND_B6
 
	`GPIO_BITREG
(
PIND
,6)

	)

192 
	#PIND_B7
 
	`GPIO_BITREG
(
PIND
,7)

	)

194 
	#PORTD_B0
 
	`GPIO_BITREG
(
PORTD
,0)

	)

195 
	#PORTD_B1
 
	`GPIO_BITREG
(
PORTD
,1)

	)

196 
	#PORTD_B2
 
	`GPIO_BITREG
(
PORTD
,2)

	)

197 
	#PORTD_B3
 
	`GPIO_BITREG
(
PORTD
,3)

	)

198 
	#PORTD_B4
 
	`GPIO_BITREG
(
PORTD
,4)

	)

199 
	#PORTD_B5
 
	`GPIO_BITREG
(
PORTD
,5)

	)

200 
	#PORTD_B6
 
	`GPIO_BITREG
(
PORTD
,6)

	)

201 
	#PORTD_B7
 
	`GPIO_BITREG
(
PORTD
,7)

	)

203 
	#GPIOR0_B0
 
	`GPIO_BITREG
(
GPIOR0
,0)

	)

204 
	#GPIOR0_B1
 
	`GPIO_BITREG
(
GPIOR0
,1)

	)

205 
	#GPIOR0_B2
 
	`GPIO_BITREG
(
GPIOR0
,2)

	)

206 
	#GPIOR0_B3
 
	`GPIO_BITREG
(
GPIOR0
,3)

	)

207 
	#GPIOR0_B4
 
	`GPIO_BITREG
(
GPIOR0
,4)

	)

208 
	#GPIOR0_B5
 
	`GPIO_BITREG
(
GPIOR0
,5)

	)

209 
	#GPIOR0_B6
 
	`GPIO_BITREG
(
GPIOR0
,6)

	)

210 
	#GPIOR0_B7
 
	`GPIO_BITREG
(
GPIOR0
,7)

	)

212 
	#GPIOR1_B0
 
	`GPIO_BITREG
(
GPIOR1
,0)

	)

213 
	#GPIOR1_B1
 
	`GPIO_BITREG
(
GPIOR1
,1)

	)

214 
	#GPIOR1_B2
 
	`GPIO_BITREG
(
GPIOR1
,2)

	)

215 
	#GPIOR1_B3
 
	`GPIO_BITREG
(
GPIOR1
,3)

	)

216 
	#GPIOR1_B4
 
	`GPIO_BITREG
(
GPIOR1
,4)

	)

217 
	#GPIOR1_B5
 
	`GPIO_BITREG
(
GPIOR1
,5)

	)

218 
	#GPIOR1_B6
 
	`GPIO_BITREG
(
GPIOR1
,6)

	)

219 
	#GPIOR1_B7
 
	`GPIO_BITREG
(
GPIOR1
,7)

	)

221 
	#GPIOR2_B0
 
	`GPIO_BITREG
(
GPIOR2
,0)

	)

222 
	#GPIOR2_B1
 
	`GPIO_BITREG
(
GPIOR2
,1)

	)

223 
	#GPIOR2_B2
 
	`GPIO_BITREG
(
GPIOR2
,2)

	)

224 
	#GPIOR2_B3
 
	`GPIO_BITREG
(
GPIOR2
,3)

	)

225 
	#GPIOR2_B4
 
	`GPIO_BITREG
(
GPIOR2
,4)

	)

226 
	#GPIOR2_B5
 
	`GPIO_BITREG
(
GPIOR2
,5)

	)

227 
	#GPIOR2_B6
 
	`GPIO_BITREG
(
GPIOR2
,6)

	)

228 
	#GPIOR2_B7
 
	`GPIO_BITREG
(
GPIOR2
,7)

	)

233 #i
defed
(
__GNUC__
)

234 
	#__ab_u
(
	`i
()

	)

235 
	#__dib_u
(
	`i
()

	)

239 #i
defed
(
__ICCAVR__
)

240 
	#PRAGMA
(
x

	`_Pgma
#x )

	)

241 
	#ISR
(
vec
) \

243 
	`PRAGMA

ve
=
vec
 ) 
__u
 
hdr_
##
	`vec
(); \

244 
	`PRAGMA

ve
=
vec
 ) 
__u
 
hdr_
##
	`vec
()

	)

245 #i
defed
(
__GNUC__
)

246 
	~<avr/u.h
>

247 #i
defed
 (
__CROSSWORKS_AVR
)

248 
	#ISR
(
vec

hdr_
##
	`vec
(
__u
[vec]

	)

250 #r 
ISR
(
n
 
defed
!

254 #i
defed
(
__ICCAVR__
)

255 
	#FLASH_DECLARE
(
x

__ash
 
	)
x

256 #i
defed
(
__GNUC__
)

257 
	#FLASH_DECLARE
(
x
x 
	`__ibu__
((
__ogmem__
))

	)

258 #i
defed
 (
__CROSSWORKS_AVR
)

259 
	#FLASH_DECLARE
 (
x
cڡ 
__code
 
	)
x

263 #i
defed
(
__ICCAVR__
)

264 
	#EEPROM_DECLARE
(
x

__om
 
	)
x

265 #i
defed
(
__GNUC__
)

266 
	~<avr/om.h
>

267 
	#EEPROM_DECLARE
(
x
x 
	`__ibu__
((
	`i
 (".om")))

	)

268 #i((
__GNUC__
 < 4|| ((__GNUC__ =4&& (
__GNUC_MINOR__
 < 3)) || \

269 ((
	g__GNUC__
 =4&& (
__GNUC_MINOR__
 =3&& (
__GNUC_PATCHLEVEL__
 <= 3)))

271 #ide
__EEPUT


272 
	#__EEPUT
 
_EEPUT


	)

274 #ide
__EEGET


275 
	#__EEGET
 
_EEGET


	)

278 #i
defed
 (
__CROSSWORKS_AVR
)

280 
__ut8_om_e
(

281 
by
,

282 
addr
);

283 
__ut8_om_ld
(

284 
addr
);

285 
	#__EEPUT
(
addr
, 
v
) \

286 
	`__ut8_om_e
(()(
v
), ()(
addr
))

	)

287 
	#__EEGET
(
v
, 
addr
) \

288 (
v

	`__ut8_om_ld
(()(
addr
))

	)

292 #i
defed
(
__GNUC__
)

294 
	#__muɝly_unsigd
(
x
,
y
((x)*(y))

	)

296 
	#__ro


	)

300 #i
defed
(
__ICCAVR__
|| defed(
__CROSSWORKS_AVR
)

301 
	#WDTO_15MS
 0

	)

302 
	#WDTO_30MS
 1

	)

303 
	#WDTO_60MS
 2

	)

304 
	#WDTO_120MS
 3

	)

305 
	#WDTO_250MS
 4

	)

306 
	#WDTO_500MS
 5

	)

307 
	#WDTO_1S
 6

	)

308 
	#WDTO_2S
 7

	)

312 #i(
defed
(
__ICCAVR__
&& (defed(
__ATmega644P__
))) || \

313 (
defed
(
__CROSSWORKS_AVR
&& (
	g__TARGET_PROCESSOR
 =
ATmega644P
))

314 
	#pow_adc_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRADC
))

	)

315 
	#pow_i_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRSPI
))

	)

316 
	#pow_u0_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRUSART0
))

	)

317 
	#pow_u1_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRUSART1
))

	)

318 
	#pow_tim0_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRTIM0
))

	)

319 
	#pow_tim1_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRTIM1
))

	)

320 
	#pow_tim2_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRTIM2
))

	)

322 #i(
defed
(
__ICCAVR__
&& (defed(
__ATmega1284P__
))) || \

323 (
defed
(
__CROSSWORKS_AVR
&& (
__TARGET_PROCESSOR
 =
ATmega1284P
))

324 
	#pow_adc_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRADC
))

	)

325 
	#pow_i_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRSPI
))

	)

326 
	#pow_u0_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRUSART0
))

	)

327 
	#pow_u1_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRUSART1
))

	)

328 
	#pow_tim0_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRTIM0
))

	)

329 
	#pow_tim1_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRTIM1
))

	)

330 
	#pow_tim2_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRTIM2
))

	)

332 #i(
defed
(
__GNUC__
&& ((__GNUC__ =4&& (
__GNUC_MINOR__
 < 5)))

333 #i
defed
(
__AVR_ATmega644P__
)

335 
	#pow_u1_ab
((
PRR
 &(
ut8_t
)~(1 << 
PRUSART1
))

	)

336 #i
defed
(
__AVR_ATmega1284P__
)

337 
	#pow_u1_ab
((
PRR0
 &(
ut8_t
)~(1 << 
PRUSART1
))

	)

341 #i
defed
(
__CROSSWORKS_AVR
)

342 
	#le


	)

	@ports/bdk-atxx4-mstp/init.c

25 
	~"hdwe.h
"

27 
	~".h
"

29 
	$
(

33 
MCUSR
 = 0;

37 
CLKPR
 = 
	`_BV
(
CLKPCE
);

52 
CLKPR
 = 0;

56 
DDRA
 = 0;

57 
PORTA
 = 0;

58 
DDRB
 = 0;

59 
PORTB
 = 0;

60 
DDRC
 = 0;

61 
PORTC
 = 0;

62 
DDRD
 = 0;

63 
PORTD
 = 0;

64 
	}
}

	@ports/bdk-atxx4-mstp/init.h

24 #ide
INIT_H


25 
	#INIT_H


	)

27 
	~<dt.h
>

29 #ifde
__lulus


33 

(

36 #ifde
__lulus


	@ports/bdk-atxx4-mstp/input.c

25 
	~<dt.h
>

26 
	~<dbo.h
>

27 
	~"hdwe.h
"

28 
	~"tim.h
"

30 
	~"put.h
"

32 #ide
BDK_VERSION


33 
	#BDK_VERSION
 4

	)

36 
ut8_t
 
	gAddss_Swch
;

37 
ut8_t
 
	gBus
;

38 
im
 
	gDeboun_Tim
;

40 #ide
BDK_V1_HACK


41 
	#BDK_V1_HACK
 0

	)

44 #i
BDK_V1_HACK


46 
	$put_swch_wkound
(

50 
	`BIT_SET
(
DDRA
, 
DDA0
);

51 
	`BIT_SET
(
DDRA
, 
DDA1
);

52 
	`BIT_SET
(
DDRA
, 
DDA2
);

53 
	`BIT_SET
(
DDRA
, 
DDA3
);

54 
	`BIT_SET
(
DDRA
, 
DDA4
);

55 
	`BIT_SET
(
DDRA
, 
DDA5
);

56 
	`BIT_SET
(
DDRA
, 
DDA6
);

58 
	`BIT_CLEAR
(
PORTA
, 
PORTA0
);

59 
	`BIT_CLEAR
(
PORTA
, 
PORTA1
);

60 
	`BIT_CLEAR
(
PORTA
, 
PORTA2
);

61 
	`BIT_CLEAR
(
PORTA
, 
PORTA3
);

62 
	`BIT_CLEAR
(
PORTA
, 
PORTA4
);

63 
	`BIT_CLEAR
(
PORTA
, 
PORTA5
);

64 
	`BIT_CLEAR
(
PORTA
, 
PORTA6
);

66 
	`BIT_CLEAR
(
DDRA
, 
DDA0
);

67 
	`BIT_CLEAR
(
DDRA
, 
DDA1
);

68 
	`BIT_CLEAR
(
DDRA
, 
DDA2
);

69 
	`BIT_CLEAR
(
DDRA
, 
DDA3
);

70 
	`BIT_CLEAR
(
DDRA
, 
DDA4
);

71 
	`BIT_CLEAR
(
DDRA
, 
DDA5
);

72 
	`BIT_CLEAR
(
DDRA
, 
DDA6
);

75 
	}
}

79 
	$put_sk
(

82 
ut8_t
 
vue
;

83 
ut8_t
 
d_addss
 = 0;

84 
ut8_t
 
d_bus
 = 0;

87 i(
	`tim_rv_exped
(&
Deboun_Tim
)) {

88 
	`tim_rv_t
(&
Deboun_Tim
);

90 #i
BDK_V1_HACK


92 
vue
 = (
PINA
 & 0x7F);

95 
vue
 = ~
PINA
;

96 
vue
 &= 0x7F;

98 i(
vue
 =
d_addss
) {

100 
Addss_Swch
 = 
d_addss
;

102 
d_addss
 = 
vue
;

103 #i(
BDK_VERSION
==4)

105 
vue
 = 
	`BITMASK_CHECK
(
PINB
, 0x0E);

106 
vue
 >>= 1;

109 
vue
 = 
	`BITMASK_CHECK
(
PINB
, 0x1F);

111 i(
vue
 =
d_bus
) {

113 
Bus
 = 
d_bus
;

115 
d_bus
 = 
vue
;

117 #i
BDK_V1_HACK


118 
	`put_swch_wkound
();

120 
	}
}

122 
ut8_t
 
	$put_addss
(

125  
Addss_Swch
;

126 
	}
}

128 
ut8_t
 
	$put_r٬y_vue
(

129 
ut8_t
 
dex
)

131  
Bus
;

132 
	}
}

134 
bo
 
	$put_bu_vue
(

135 
ut8_t
 
dex
)

137 
bo
 
vue
 = 
l
;

139 
dex
) {

141 
vue
 = 
	`BIT_CHECK
(
Bus
, 0);

144 
vue
 = 
	`BIT_CHECK
(
Bus
, 1);

147 
vue
 = 
	`BIT_CHECK
(
Bus
, 2);

150 
vue
 = 
	`BIT_CHECK
(
Bus
, 3);

153 
vue
 = 
	`BIT_CHECK
(
Bus
, 4);

159  
vue
;

160 
	}
}

163 
	$put_
(

167 
	`BIT_CLEAR
(
DDRA
, 
DDA0
);

168 
	`BIT_CLEAR
(
DDRA
, 
DDA1
);

169 
	`BIT_CLEAR
(
DDRA
, 
DDA2
);

170 
	`BIT_CLEAR
(
DDRA
, 
DDA3
);

171 
	`BIT_CLEAR
(
DDRA
, 
DDA4
);

172 
	`BIT_CLEAR
(
DDRA
, 
DDA5
);

173 
	`BIT_CLEAR
(
DDRA
, 
DDA6
);

175 
	`BIT_SET
(
PORTA
, 
PORTA0
);

176 
	`BIT_SET
(
PORTA
, 
PORTA1
);

177 
	`BIT_SET
(
PORTA
, 
PORTA2
);

178 
	`BIT_SET
(
PORTA
, 
PORTA3
);

179 
	`BIT_SET
(
PORTA
, 
PORTA4
);

180 
	`BIT_SET
(
PORTA
, 
PORTA5
);

181 
	`BIT_SET
(
PORTA
, 
PORTA6
);

183 #i(
BDK_VERSION
==4)

184 
	`BIT_CLEAR
(
DDRB
, 
DDB1
);

185 
	`BIT_CLEAR
(
DDRB
, 
DDB2
);

186 
	`BIT_CLEAR
(
DDRB
, 
DDB3
);

188 
	`BIT_CLEAR
(
DDRB
, 
DDB1
);

189 
	`BIT_CLEAR
(
DDRB
, 
DDB2
);

190 
	`BIT_CLEAR
(
DDRB
, 
DDB3
);

191 
	`BIT_CLEAR
(
DDRB
, 
DDB4
);

193 
	`tim_rv_t
(&
Deboun_Tim
, 30);

194 
	}
}

	@ports/bdk-atxx4-mstp/input.h

24 #ide
INPUT_H


25 
	#INPUT_H


	)

27 
	~<dt.h
>

29 #ifde
__lulus


33 
put_
(

35 
put_sk
(

37 
ut8_t
 
put_addss
(

39 
bo
 
put_bu_vue
(

40 
ut8_t
 
dex
);

41 
ut8_t
 
put_r٬y_vue
(

42 
ut8_t
 
dex
);

43 #ifde
__lulus


	@ports/bdk-atxx4-mstp/led.c

24 
	~<dt.h
>

25 
	~"hdwe.h
"

26 
	~"tim.h
"

27 
	~"d.h
"

29 #ide
BDK_VERSION


30 
	#BDK_VERSION
 4

	)

33 
im
 
	gOff_Day_Tim
[
MAX_LEDS
];

40 
	$d_
(

41 
ut8_t
 
dex
)

43 
dex
) {

45 
	`BIT_SET
(
PORTD
, 
PD7
);

48 
	`BIT_SET
(
PORTD
, 
PD6
);

51 #i(
BDK_VERSION
==4)

52 
	`BIT_SET
(
PORTB
, 
PB0
);

54 
	`BIT_SET
(
PORTC
, 
PC7
);

58 #i(
BDK_VERSION
==4)

59 
	`BIT_SET
(
PORTB
, 
PB4
);

61 
	`BIT_SET
(
PORTC
, 
PC6
);

67 i(
dex
 < 
MAX_LEDS
) {

68 
	`tim_rv_no_expe
(&
Off_Day_Tim
[
dex
]);

70 
	}
}

77 
	$d_off
(

78 
ut8_t
 
dex
)

80 
dex
) {

82 
	`BIT_CLEAR
(
PORTD
, 
PD7
);

85 
	`BIT_CLEAR
(
PORTD
, 
PD6
);

88 #i(
BDK_VERSION
==4)

89 
	`BIT_CLEAR
(
PORTB
, 
PB0
);

91 
	`BIT_CLEAR
(
PORTC
, 
PC7
);

95 #i(
BDK_VERSION
==4)

96 
	`BIT_CLEAR
(
PORTB
, 
PB4
);

98 
	`BIT_CLEAR
(
PORTC
, 
PC6
);

104 i(
dex
 < 
MAX_LEDS
) {

105 
	`tim_rv_no_expe
(&
Off_Day_Tim
[
dex
]);

107 
	}
}

114 
bo
 
	$d_e
(

115 
ut8_t
 
dex
)

117 
dex
) {

119  (
	`BIT_CHECK
(
PIND
, 
PIND7
));

121  (
	`BIT_CHECK
(
PIND
, 
PIND6
));

123 #i(
BDK_VERSION
==4)

124  (
	`BIT_CHECK
(
PINB
, 
PINC0
));

126  (
	`BIT_CHECK
(
PINC
, 
PINC7
));

129 #i(
BDK_VERSION
==4)

130  (
	`BIT_CHECK
(
PINB
, 
PINC4
));

132  (
	`BIT_CHECK
(
PINC
, 
PINC6
));

138  
l
;

139 
	}
}

146 
	$d_togg
(

147 
ut8_t
 
dex
)

149 i(
	`d_e
(
dex
)) {

150 
	`d_off
(
dex
);

152 
	`d_
(
dex
);

154 
	}
}

161 
	$d_off_day
(

162 
ut8_t
 
dex
,

163 
ut32_t
 
day_ms
)

165 i(
dex
 < 
MAX_LEDS
) {

166 
	`tim_rv_t
(&
Off_Day_Tim
[
dex
], 
day_ms
);

168 
	}
}

175 
	$d__rv
(

176 
ut8_t
 
dex
,

177 
ut16_t
 
rv_ms
)

179 i(
dex
 < 
MAX_LEDS
) {

180 
	`d_
(
dex
);

181 
	`tim_rv_t
(&
Off_Day_Tim
[
dex
], 
rv_ms
);

183 
	}
}

190 
	$d_sk
(

193 
ut8_t
 
i
;

195 
i
 = 0; i < 
MAX_LEDS
; i++) {

196 i(
	`tim_rv_exped
(&
Off_Day_Tim
[
i
])) {

197 
	`tim_rv_no_expe
(&
Off_Day_Tim
[
i
]);

198 
	`d_off
(
i
);

201 
	}
}

208 
	$d_
(

211 
ut8_t
 
i
;

214 
	`BIT_SET
(
DDRD
, 
DDD7
);

215 
	`BIT_SET
(
DDRD
, 
DDD6
);

216 #i(
BDK_VERSION
==4)

217 
	`BIT_SET
(
DDRB
, 
DDB0
);

218 
	`BIT_SET
(
DDRB
, 
DDB4
);

220 
	`BIT_SET
(
DDRC
, 
DDC7
);

221 
	`BIT_SET
(
DDRC
, 
DDC6
);

223 
i
 = 0; i < 
MAX_LEDS
; i++) {

224 
	`d__rv
(
i
, 500);

226 
	}
}

	@ports/bdk-atxx4-mstp/led.h

24 #ide
LED_H


25 
	#LED_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

30 #ifde
__lulus


34 
d_
(

35 
ut8_t
 
dex
);

36 
d__rv
(

37 
ut8_t
 
dex
,

38 
ut16_t
 
rv_ms
);

39 
d_off
(

40 
ut8_t
 
dex
);

41 
d_off_day
(

42 
ut8_t
 
dex
,

43 
ut32_t
 
day_ms
);

44 
d_togg
(

45 
ut8_t
 
dex
);

46 
bo
 
d_e
(

47 
ut8_t
 
dex
);

48 
d_sk
(

50 
d_
(

53 #ifde
__lulus


	@ports/bdk-atxx4-mstp/main.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~"hdwe.h
"

29 
	~".h
"

30 
	~"ack.h
"

31 
	~"tim.h
"

32 
	~"put.h
"

33 
	~"d.h
"

34 
	~"adc.h
"

35 
	~"nvda.h
"

36 
	~"tim.h
"

37 
	~"rs485.h
"

38 
	~"rl.h
"

39 
	~"ba.h
"

40 
	~".h
"

41 
	~"wchdog.h
"

42 
	~"vsi.h
"

45 *
	gBACt_Vsi
 = 
BACNET_VERSION_TEXT
;

50 
	$ma
(

53 
	`
();

55 #ifde
NDEBUG


56 
	`wchdog_
(2000);

58 
	`wchdog_
(0);

60 
	`tim_
();

61 
	`adc_
();

62 
	`put_
();

63 
	`rom_
();

64 
	`rs485_
();

65 
	`rl_
();

66 
	`d_
();

67 
	`ba_
();

68 
	`_
();

70 
	`__ab_u
();

72 
	`wchdog_t
();

73 
	`put_sk
();

74 
	`ba_sk
();

75 
	`d_sk
();

76 
	`_sk
();

78 
	}
}

	@ports/bdk-atxx4-mstp/nvdata.h

25 #ide
NVDATA_H


26 
	#NVDATA_H


	)

28 
	~"rom.h
"

29 
	~"om.h
"

35 
	#NV_EEPROM_MAC
 0

	)

37 
	#NV_EEPROM_BAUD_K
 1

	)

38 
	#NV_EEPROM_MAX_MASTER
 2

	)

40 
	#NV_EEPROM_DEVICE_0
 3

	)

41 
	#NV_EEPROM_DEVICE_1
 4

	)

42 
	#NV_EEPROM_DEVICE_2
 5

	)

43 
	#NV_EEPROM_DEVICE_3
 6

	)

48 
	#NV_EEPROM_NAME_LENGTH
(
n
()+0)

	)

49 
	#NV_EEPROM_NAME_ENCODING
(
n
()+1)

	)

50 
	#NV_EEPROM_NAME_STRING
(
n
()+2)

	)

51 
	#NV_EEPROM_NAME_SIZE
 30

	)

52 
	#NV_EEPROM_NAME_OFFSET
 (1+1+
NV_EEPROM_NAME_SIZE
)

	)

54 
	#NV_EEPROM_DEVICE_NAME
 32

	)

56 
	#NV_EEPROM_DEVICE_DESCRIPTION
 \

57 (
NV_EEPROM_DEVICE_NAME
+
NV_EEPROM_NAME_OFFSET
)

	)

59 
	#NV_EEPROM_DEVICE_LOCATION
 \

60 (
NV_EEPROM_DEVICE_DESCRIPTION
+
NV_EEPROM_NAME_OFFSET
)

	)

66 
	#SEEPROM_ID
 0xBAC0

	)

67 
	#SEEPROM_VERSION
 0x0001

	)

69 
	#SEEPROM_BYTES_MAX
 (2*1024)

	)

74 
	#NV_SEEPROM_TYPE_0
 0

	)

75 
	#NV_SEEPROM_TYPE_1
 1

	)

76 
	#NV_SEEPROM_VERSION_0
 2

	)

77 
	#NV_SEEPROM_VERSION_1
 3

	)

81 
	#NV_SEEPROM_BINARY_OUTPUT_0
 32

	)

83 
	#NV_SEEPROM_BO_POLARITY
 0

	)

84 
	#NV_SEEPROM_BO_OUT_OF_SERVICE
 1

	)

85 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_1
 2

	)

86 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_2
 3

	)

87 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_3
 4

	)

88 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_4
 5

	)

89 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_5
 6

	)

90 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_6
 7

	)

91 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_7
 8

	)

92 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_8
 9

	)

93 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_9
 10

	)

94 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_10
 11

	)

95 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_11
 12

	)

96 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_12
 13

	)

97 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_13
 14

	)

98 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_14
 15

	)

99 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_15
 16

	)

100 
	#NV_SEEPROM_BO_PRIORITY_ARRAY_16
 17

	)

102 
	#NV_SEEPROM_BINARY_OUTPUT_SIZE
 18

	)

103 
	#NV_SEEPROM_BINARY_OUTPUT
(
n
,
p
) \

104 (
NV_SEEPROM_BINARY_OUTPUT_0
 + \

105 (
NV_SEEPROM_BINARY_OUTPUT_SIZE
 * (
n
)+ (
p
))

	)

109 #ifde
__lulus


116 #ifde
__lulus


	@ports/bdk-atxx4-mstp/rs485.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~<dlib.h
>

27 
	~"hdwe.h
"

28 
	~"fifo.h
"

29 
	~"tim.h
"

30 
	~"d.h
"

31 
	~"nvda.h
"

33 
	~"rs485.h
"

36 
ut32_t
 
	gBaud_Re
 = 9600;

47 
	#Ttuound
 (40UL)

	)

51 
ut8_t
 
	gReive_Bufr_Da
[128];

52 
FIFO_BUFFER
 
	gReive_Bufr
;

54 
im
 
	gS_Tim
;

61 
bo
 
	$rs485_s_time_d
(

62 
ut16_t
 
mlicds
)

64  
	`tim_d_mlicds_sht
(&
S_Tim
, 
mlicds
);

65 
	}
}

72 
	$rs485_s_time_t
(

75 
	`tim_d_t
(&
S_Tim
);

76 
	}
}

83 
	$rs485_s_
(

87 
	`BIT_SET
(
DDRD
, 
DDD4
);

88 
	}
}

95 
	$rs485_s_ab
(

96 
bo
 
ab
)

98 i(
ab
) {

99 
	`BIT_SET
(
PORTD
, 
PD4
);

101 
	`BIT_CLEAR
(
PORTD
, 
PD4
);

103 
	}
}

110 
	$rs485_iv_ab
(

113 
UCSR0B
 = 
	`_BV
(
TXEN0
| _BV(
RXEN0
| _BV(
RXCIE0
);

114 
	}
}

121 
	$rs485_tuound_day
(

124 
ut8_t
 
nbys
 = 4;

129 
	`rs485_s_ab
(
l
);

130 
nbys
) {

132 
UDR0
 = 0xff;

133 !
	`BIT_CHECK
(
UCSR0A
, 
UDRE0
)) {

136 
nbys
--;

138 !
	`BIT_CHECK
(
UCSR0A
, 
TXC0
)) {

143 
	`BIT_SET
(
UCSR0A
, 
TXC0
);

144 
	}
}

151 
	$ISR
(
USART0_RX_ve
)

153 
ut8_t
 
da_by
;

155 i(
	`BIT_CHECK
(
UCSR0A
, 
RXC0
)) {

157 
da_by
 = 
UDR0
;

158 #ifde
MSTP_MONITOR


159 
UDR1
 = 
da_by
;

161 (
	`FIFO_Put
(&
Reive_Bufr
, 
da_by
);

163 
	}
}

170 
bo
 
	$rs485_by_avaab
(

171 
ut8_t
 * 
da_gi
)

173 
bo
 
da_avaab
 = 
l
;

175 i(!
	`FIFO_Emy
(&
Reive_Bufr
)) {

176 
	`d__rv
(
LED_4
, 1);

177 i(
da_gi
) {

178 *
da_gi
 = 
	`FIFO_G
(&
Reive_Bufr
);

180 
da_avaab
 = 
ue
;

183  
da_avaab
;

184 
	}
}

191 
bo
 
	$rs485_ive_r
(

194  
l
;

195 
	}
}

202 
	$rs485_bys_nd
(

203 
ut8_t
 * 
bufr
,

204 
ut16_t
 
nbys
)

206 
	`d_
(
LED_5
);

207 !
	`BIT_CHECK
(
UCSR0A
, 
UDRE0
)) {

210 
nbys
) {

212 
UDR0
 = *
bufr
;

213 #ifde
MSTP_MONITOR


214 
UDR1
 = *
bufr
;

216 !
	`BIT_CHECK
(
UCSR0A
, 
UDRE0
)) {

219 
bufr
++;

220 
nbys
--;

223 !
	`BIT_CHECK
(
UCSR0A
, 
TXC0
)) {

228 
	`BIT_SET
(
UCSR0A
, 
TXC0
);

229 
	`tim_d_t
(&
S_Tim
);

230 
	`d_off_day
(
LED_5
, 1);

233 
	}
}

240 
ut32_t
 
	$rs485_baud_
(

243  
Baud_Re
;

244 
	}
}

251 
	$rs485_baud__cfigu
(

255 
	`BIT_SET
(
UCSR0A
, 
U2X0
);

257 
UBRR0
 = (
F_CPU
 / (8UL * 
Baud_Re
)) - 1;

258 
	}
}

265 
bo
 
	$rs485_baud__t
(

266 
ut32_t
 
baud
)

268 
bo
 
vid
 = 
ue
;

269 
ut8_t
 
baud_k
 = 0;

271 
baud
) {

278 
Baud_Re
 = 
baud
;

279 
	`rs485_baud__cfigu
();

281 
baud_k
 = 
baud
 / 1000;

282 
	`om_bys_wre
(
NV_EEPROM_BAUD_K
, &
baud_k
, 1);

285 
vid
 = 
l
;

289  
vid
;

290 
	}
}

297 
	$rs485_u_
(

301 
	`BIT_CLEAR
(
DDRD
, 
DDD0
);

302 
	`BIT_SET
(
PORTD
, 
PD0
);

304 
UCSR0B
 = 
	`_BV
(
TXEN0
| _BV(
RXEN0
);

312 
UCSR0C
 = 
	`_BV
(
UCSZ01
| _BV(
UCSZ00
);

313 
	`pow_u0_ab
();

314 
	}
}

321 
	$rs485__nvda
(

324 
ut8_t
 
baud_k
 = 9;

326 
	`om_bys_ad
(
NV_EEPROM_BAUD_K
, &
baud_k
, 1);

327 
baud_k
) {

329 
Baud_Re
 = 9600;

332 
Baud_Re
 = 19200;

335 
Baud_Re
 = 38400;

338 
Baud_Re
 = 57600;

341 
Baud_Re
 = 76800;

344 
Baud_Re
 = 115200;

348 
Baud_Re
 = 38400;

349 
baud_k
 = 38400 / 1000;

350 
	`om_bys_wre
(
NV_EEPROM_BAUD_K
, &
baud_k
, 1);

353 
	`rs485_baud__cfigu
();

354 
	}
}

361 
	$rs485_
(

364 
	`FIFO_In
(&
Reive_Bufr
, &
Reive_Bufr_Da
[0],

365 ((
Reive_Bufr_Da
));

366 
	`tim_d_t
(&
S_Tim
);

367 
	`rs485_s_
();

368 
	`rs485_u_
();

369 
	`rs485__nvda
();

370 
	`rs485_iv_ab
();

371 
	`rs485_s_ab
(
l
);

372 
	}
}

	@ports/bdk-atxx4-mstp/rs485.h

24 #ide
RS485_H


25 
	#RS485_H


	)

27 
	~<dt.h
>

29 #ifde
__lulus


33 
rs485_
(

35 
rs485_s_ab
(

36 
bo
 
ab
);

37 
bo
 
rs485_by_avaab
(

38 
ut8_t
 * 
da_gi
);

39 
bo
 
rs485_ive_r
(

41 
rs485_bys_nd
(

42 
ut8_t
 * 
bufr
,

43 
ut16_t
 
nbys
);

44 
ut32_t
 
rs485_baud_
(

46 
bo
 
rs485_baud__t
(

47 
ut32_t
 
baud
);

49 
rs485_tuound_day
(

51 
rs485_s_time_t
(

53 
bo
 
rs485_s_time_d
(

54 
ut16_t
 
mlicds
);

56 #ifde
__lulus


	@ports/bdk-atxx4-mstp/seeprom.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<dlib.h
>

29 
	~"hdwe.h
"

31 
	~"rom.h
"

35 #ide
SEEPROM_I2C_ADDRESS


36 
	#SEEPROM_I2C_ADDRESS
 0xA0

	)

40 #ide
SEEPROM_I2C_CLOCK


41 
	#SEEPROM_I2C_CLOCK
 400000UL

	)

45 #ide
SEEPROM_PAGE_SIZE


46 
	#SEEPROM_PAGE_SIZE
 128

	)

50 #ide
SEEPROM_WORD_ADDRESS_16BIT


51 
	#SEEPROM_WORD_ADDRESS_16BIT
 1

	)

55 #ide
EEPROM_WRITE_CYCLE


56 
	#EEPROM_WRITE_CYCLE
 5

	)

60 
	#TW_STATUS_MASK
 (
	`_BV
(
TWS7
)|_BV(
TWS6
)|_BV(
TWS5
)|_BV(
TWS4
)|_BV(
TWS3
))

	)

62 
	#TW_START
 0x08

	)

64 
	#TW_REP_START
 0x10

	)

67 
	#TW_MT_SLA_ACK
 0x18

	)

69 
	#TW_MT_SLA_NACK
 0x20

	)

71 
	#TW_MT_DATA_ACK
 0x28

	)

73 
	#TW_MT_DATA_NACK
 0x30

	)

75 
	#TW_MT_ARB_LOST
 0x38

	)

78 
	#TW_MR_ARB_LOST
 0x38

	)

80 
	#TW_MR_SLA_ACK
 0x40

	)

82 
	#TW_MR_SLA_NACK
 0x48

	)

84 
	#TW_MR_DATA_ACK
 0x50

	)

86 
	#TW_MR_DATA_NACK
 0x58

	)

89 
	#TW_READ
 1

	)

91 
	#TW_WRITE
 0

	)

96 
	#MAX_ITER
 (((
SEEPROM_I2C_CLOCK
/1000)/10)*
SEEPROM_WRITE_CYCLE
)

	)

103 
	$rom_bys_ad
(

104 
ut16_t
 
addr
,

105 
ut8_t
 * 
buf
,

106 
n
)

108 
ut8_t
 
a
, 
tw
, 
n
 = 0;

109 
rv
 = 0;

110 
ut8_t
 
tw
;

111 
ut16_t
 
timeout
 = 0xFFFF;

113 #i
SEEPROM_WORD_ADDRESS_16BIT


115 
a
 = 
SEEPROM_I2C_ADDRESS
;

118 
a
 = 
SEEPROM_I2C_ADDRESS
 | (((
addr
 >> 8) & 0x07) << 1);

121 
t
:

122 i(
n
++ >
MAX_ITER
) {

125 
beg
:

127 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWSTA
| _BV(
TWEN
);

129 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0) {

130 
timeout
--;

131 i(
timeout
 == 0) {

135 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

136 
tw
) {

137 
TW_REP_START
:

139 
TW_START
:

141 
TW_MT_ARB_LOST
:

145 
beg
;

158 
TWDR
 = 
a
 | 
TW_WRITE
;

160 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWEN
);

162 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0);

163 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

164 
tw
) {

165 
TW_MT_SLA_ACK
:

167 
TW_MT_SLA_NACK
:

173 
t
;

174 
TW_MT_ARB_LOST
:

176 
beg
;

179 
r
;

181 #i
SEEPROM_WORD_ADDRESS_16BIT


183 
TWDR
 = (
addr
 >> 8);

185 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWEN
);

187 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0);

188 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

189 
tw
) {

190 
TW_MT_DATA_ACK
:

192 
TW_MT_DATA_NACK
:

193 
qu
;

194 
TW_MT_ARB_LOST
:

195 
beg
;

198 
r
;

202 
TWDR
 = 
addr
;

204 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWEN
);

206 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0);

207 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

208 
tw
) {

209 
TW_MT_DATA_ACK
:

211 
TW_MT_DATA_NACK
:

212 
qu
;

213 
TW_MT_ARB_LOST
:

214 
beg
;

217 
r
;

230 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWSTA
| _BV(
TWEN
);

232 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0);

233 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

234 
tw
) {

235 
TW_START
:

237 
TW_REP_START
:

239 
TW_MT_ARB_LOST
:

240 
beg
;

242 
r
;

246 
TWDR
 = 
a
 | 
TW_READ
;

248 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWEN
);

250 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0);

251 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

252 
tw
) {

253 
TW_MR_SLA_ACK
:

255 
TW_MR_SLA_NACK
:

256 
qu
;

257 
TW_MR_ARB_LOST
:

258 
beg
;

260 
r
;

266 
tw
 = 
	`_BV
(
TWINT
| _BV(
TWEN
| _BV(
TWEA
);

267 ; 
n
 > 0;en--) {

268 i(
n
 == 1) {

270 
tw
 = 
	`_BV
(
TWINT
| _BV(
TWEN
);

273 
TWCR
 = 
tw
;

275 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0);

276 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

277 
tw
) {

278 
TW_MR_DATA_NACK
:

280 
n
 = 0;

282 
TW_MR_DATA_ACK
:

283 *
buf
 = 
TWDR
;

284 
buf
++;

285 
rv
++;

288 
r
;

291 
qu
:

296 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWSTO
| _BV(
TWEN
);

297  
rv
;

298 
r
:

299 
rv
 = -1;

300 
qu
;

301 
	}
}

308 
	$rom_bys_wre_ge
(

309 
ut16_t
 
addr
,

310 
ut8_t
 * 
buf
,

311 
n
)

313 
ut8_t
 
a
, 
n
 = 0;

314 
rv
 = 0;

315 
ut16_t
 
daddr
;

316 
ut8_t
 
tw
;

317 
ut16_t
 
ge_d_addr
;

318 
ut16_t
 
timeout
 = 0xFFFF;

321 
ge_d_addr
 = 
addr
 | (
SEEPROM_PAGE_SIZE
 - 1);

322 i((
addr
 + 
n
> 
ge_d_addr
) {

323 
daddr
 = 
ge_d_addr
 + 1;

324 
n
 = 
daddr
 - 
addr
;

326 #i
SEEPROM_WORD_ADDRESS_16BIT


328 
a
 = 
SEEPROM_I2C_ADDRESS
;

331 
a
 = 
SEEPROM_I2C_ADDRESS
 | (((
addr
 >> 8) & 0x07) << 1);

333 
t
:

334 i(
n
++ >
MAX_ITER
) {

337 
beg
:

350 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWSTA
| _BV(
TWEN
);

352 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0) {

353 
timeout
--;

354 i(
timeout
 == 0) {

358 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

359 
tw
) {

360 
TW_REP_START
:

362 
TW_START
:

364 
TW_MT_ARB_LOST
:

365 
beg
;

372 
TWDR
 = 
a
 | 
TW_WRITE
;

374 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWEN
);

376 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0);

377 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

378 
tw
) {

379 
TW_MT_SLA_ACK
:

381 
TW_MT_SLA_NACK
:

383 
t
;

384 
TW_MT_ARB_LOST
:

386 
beg
;

389 
r
;

391 #i
SEEPROM_WORD_ADDRESS_16BIT


393 
TWDR
 = (
addr
 >> 8);

395 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWEN
);

397 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0);

398 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

399 
tw
) {

400 
TW_MT_DATA_ACK
:

402 
TW_MT_DATA_NACK
:

403 
qu
;

404 
TW_MT_ARB_LOST
:

405 
beg
;

408 
r
;

412 
TWDR
 = 
addr
;

414 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWEN
);

416 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0) {

418 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

419 
tw
) {

420 
TW_MT_DATA_ACK
:

422 
TW_MT_DATA_NACK
:

423 
qu
;

424 
TW_MT_ARB_LOST
:

425 
beg
;

428 
r
;

430 ; 
n
 > 0;en--) {

431 
TWDR
 = *
buf
;

433 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWEN
);

435 (
TWCR
 & 
	`_BV
(
TWINT
)) == 0);

436 
tw
 = 
TWSR
 & 
TW_STATUS_MASK
;

437 
tw
) {

438 
TW_MT_DATA_NACK
:

440 
r
;

441 
TW_MT_DATA_ACK
:

442 
buf
++;

443 
rv
++;

446 
r
;

449 
qu
:

451 
TWCR
 = 
	`_BV
(
TWINT
| _BV(
TWSTO
| _BV(
TWEN
);

453  
rv
;

455 
r
:

456 
rv
 = -1;

457 
qu
;

458 
	}
}

474 
	$rom_bys_wre
(

475 
ut16_t
 
off
,

476 
ut8_t
 * 
buf
,

477 
n
)

479 
us
 = 0;

480 
rv
 = 0;

482 
n
) {

483 
us
 = 
	`rom_bys_wre_ge
(
off
, 
buf
, 
n
);

484 i(
us
 <= 0) {

485 i(
rv
 == 0) {

486 
rv
 = 
us
;

490 
buf
 +
us
;

491 
off
 +
us
;

492 
n
 -
us
;

493 
rv
 +
us
;

496  
rv
;

497 
	}
}

504 
	$rom_
(

508 
TWSR
 = 0;

509 
TWCR
 = 
	`_BV
(
TWEN
| _BV(
TWEA
);

513 
TWBR
 = (
F_CPU
 / 
SEEPROM_I2C_CLOCK
 - 16) / 2;

515 
TWAR
 = 0;

516 
	}
}

	@ports/bdk-atxx4-mstp/seeprom.h

24 #ide
SEEPROM_H


25 
	#SEEPROM_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

30 #ifde
__lulus


34 
rom_bys_ad
(

35 
ut16_t
 
_addss
,

36 
ut8_t
 * 
bufr
,

37 
nbys
);

38 
rom_bys_wre
(

39 
ut16_t
 
_addss
,

40 
ut8_t
 * 
bufr
,

41 
nbys
);

42 
rom_
(

45 #ifde
__lulus


	@ports/bdk-atxx4-mstp/serial.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~<dlib.h
>

27 
	~"hdwe.h
"

28 
	~"fifo.h
"

29 
	~"rl.h
"

32 
ut32_t
 
	gBaud_Re
 = 9600;

35 
ut8_t
 
	gReive_Bufr_Da
[128];

36 
FIFO_BUFFER
 
	gReive_Bufr
;

38 
	$rl_iv_ab
(

41 
UCSR1B
 = 
	`_BV
(
TXEN1
| _BV(
RXEN1
| _BV(
RXCIE1
);

42 
	}
}

44 
	$ISR
(
USART1_RX_ve
)

46 
ut8_t
 
da_by
;

48 i(
	`BIT_CHECK
(
UCSR1A
, 
RXC1
)) {

50 
da_by
 = 
UDR1
;

51 (
	`FIFO_Put
(&
Reive_Bufr
, 
da_by
);

53 
	}
}

55 
bo
 
	$rl_by_g
(

56 
ut8_t
 * 
da_gi
)

58 
bo
 
da_avaab
 = 
l
;

60 i(!
	`FIFO_Emy
(&
Reive_Bufr
)) {

61 *
da_gi
 = 
	`FIFO_G
(&
Reive_Bufr
);

62 
da_avaab
 = 
ue
;

65  
da_avaab
;

66 
	}
}

68 
bo
 
	$rl_by_ek
(

69 
ut8_t
 * 
da_gi
)

71 
bo
 
da_avaab
 = 
l
;

73 i(!
	`FIFO_Emy
(&
Reive_Bufr
)) {

74 *
da_gi
 = 
	`FIFO_Pk
(&
Reive_Bufr
);

75 
da_avaab
 = 
ue
;

78  
da_avaab
;

79 
	}
}

81 
	$rl_bys_nd
(

82 
ut8_t
 * 
bufr
,

83 
ut16_t
 
nbys
)

85 !
	`BIT_CHECK
(
UCSR1A
, 
UDRE1
)) {

88 
nbys
) {

90 
UDR1
 = *
bufr
;

91 !
	`BIT_CHECK
(
UCSR1A
, 
UDRE1
)) {

94 
bufr
++;

95 
nbys
--;

98 !
	`BIT_CHECK
(
UCSR1A
, 
TXC1
)) {

103 
	`BIT_SET
(
UCSR1A
, 
TXC1
);

106 
	}
}

108 
	$rl_by_nd
(

109 
ut8_t
 
ch
)

111 !
	`BIT_CHECK
(
UCSR1A
, 
UDRE1
)) {

115 
UDR1
 = 
ch
;

118 
	}
}

120 
	$rl_by_sm_come
(

124 !
	`BIT_CHECK
(
UCSR1A
, 
TXC1
)) {

129 
	`BIT_SET
(
UCSR1A
, 
TXC1
);

130 
	}
}

132 
ut32_t
 
	$rl_baud_
(

135  
Baud_Re
;

136 
	}
}

138 
bo
 
	$rl_baud__t
(

139 
ut32_t
 
baud
)

141 
bo
 
vid
 = 
ue
;

143 
baud
) {

150 
Baud_Re
 = 
baud
;

152 
	`BIT_SET
(
UCSR1A
, 
U2X1
);

154 
UBRR1
 = (
F_CPU
 / (8UL * 
Baud_Re
)) - 1;

158 
vid
 = 
l
;

162  
vid
;

163 
	}
}

165 
	$rl_u_
(

169 
	`BIT_CLEAR
(
DDRD
, 
DDD2
);

170 
	`BIT_SET
(
PORTD
, 
PD2
);

172 
UCSR1B
 = 
	`_BV
(
TXEN1
| _BV(
RXEN1
);

180 
UCSR1C
 = 
	`_BV
(
UCSZ11
| _BV(
UCSZ10
);

181 
	`pow_u1_ab
();

182 
	}
}

184 
	$rl_
(

187 
	`FIFO_In
(&
Reive_Bufr
, &
Reive_Bufr_Da
[0],

188 ((
Reive_Bufr_Da
));

189 
	`rl_u_
();

190 
	`rl_baud__t
(
Baud_Re
);

191 
	`rl_iv_ab
();

192 
	}
}

	@ports/bdk-atxx4-mstp/serial.h

24 #ide
SERIAL_H


25 
	#SERIAL_H


	)

27 
	~<dt.h
>

29 #ifde
__lulus


33 
bo
 
rl_by_g
(

34 
ut8_t
 * 
da_gi
);

35 
bo
 
rl_by_ek
(

36 
ut8_t
 * 
da_gi
);

38 
rl_bys_nd
(

39 
ut8_t
 * 
bufr
,

40 
ut16_t
 
nbys
);

43 
rl_by_nd
(

44 
ut8_t
 
ch
);

45 
rl_by_sm_come
(

48 
ut32_t
 
rl_baud_
(

50 
bo
 
rl_baud__t
(

51 
ut32_t
 
baud
);

53 
rl_
(

56 #ifde
__lulus


	@ports/bdk-atxx4-mstp/stack.c

25 
	~"hdwe.h
"

27 
	~"ack.h
"

29 #i
defed
(
__GNUC__
)

31 
ut8_t
 
_d
;

32 
ut8_t
 
__ack
;

34 
	#STACK_CANARY
 (0xC5)

	)

35 
	$ack_
(

36 
	`__ibu__
 ((
ked
)__ibu__ ((
	`i
(".init1")));

38 
	$ack_
(

42 
ut8_t
 *
p
 = &
_d
;

44 
p
 <&
__ack
) {

45 *
p
 = 
STACK_CANARY
;

46 
p
++;

49 
__asm
 volatile (

55 
	}
}

57 
	$ack_size
(

60  (&
__ack
- (&
_d
);

61 
	}
}

63 
ut8_t
 
	$ack_by
(

64 
offt
)

66  *(&
_d
 + 
offt
);

67 
	}
}

69 
	$ack_unud
(

72 
ut8_t
 *
p
 = &
_d
;

73 
cou
 = 0;

75 
p
 <&
__ack
) {

76 i((*
p
!
STACK_CANARY
) {

77 
cou
 = 
p
 - (&
_d
);

80 
p
++;

82  
cou
;

83 
	}
}

85 
	$ack_
(

89 
	}
}

91 
	$ack_size
(

95 
	}
}

97 
ut8_t
 
	$ack_by
(

98 
offt
)

101 
	}
}

103 
	$ack_unud
(

107 
	}
}

	@ports/bdk-atxx4-mstp/stack.h

25 #ide
STACK_H


26 
	#STACK_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

31 #ifde
__lulus


36 
ack_
(

39 
ack_size
(

42 
ut8_t
 
ack_by
(

43 
offt
);

45 
ack_unud
(

48 #ifde
__lulus


	@ports/bdk-atxx4-mstp/test.c

25 
	~<dt.h
>

26 
	~<dbo.h
>

27 
	~<rg.h
>

28 
	~"hdwe.h
"

29 
	~"tim.h
"

30 
	~"rl.h
"

31 
	~"put.h
"

32 
	~"bo.h
"

33 
	~"rs485.h
"

34 
	~"dlmp.h
"

35 
	~"rom.h
"

36 
	~"nvda.h
"

38 
	~".h
"

40 #ide
BDK_VERSION


41 
	#BDK_VERSION
 4

	)

45 
im
 
	gTe_Tim
;

47 
ut8_t
 
	gMSTP_MAC_Addss
;

49 
	$_
(

52 #ifde
MSTP_MONITOR


53 
	`rl_baud__t
(115200);

55 
	`rl_baud__t
(9600);

57 
	`tim_rv_t_cds
(&
Te_Tim
, 1);

59 #i(
BDK_VERSION
==4)

60 
	`BIT_SET
(
DDRD
, 
DDB5
);

62 
	`BIT_SET
(
DDRB
, 
DDB0
);

64 
	}
}

71 
le
 
	$_p_
(

74 #i(
BDK_VERSION
==4)

75 
	`BIT_SET
(
PORTD
, 
PD5
);

77 
	`BIT_SET
(
PORTB
, 
PB0
);

79 
	}
}

86 
le
 
	$_p_off
(

89 #i(
BDK_VERSION
==4)

90 
	`BIT_CLEAR
(
PORTD
, 
PD5
);

92 
	`BIT_CLEAR
(
PORTB
, 
PB0
);

94 
	}
}

101 
le
 
bo
 
	$_p_e
(

104 #i(
BDK_VERSION
==4)

105  (
	`BIT_CHECK
(
PIND
, 
PD5
));

107  (
	`BIT_CHECK
(
PINB
, 
PB0
));

109 
	}
}

116 
le
 
	$_p_togg
(

119 i(
	`_p_e
()) {

120 
	`_p_off
();

122 
	`_p_
();

124 
	}
}

126 #ifde
MSTP_MONITOR


127 
	$_sk
(

130 i(
	`tim_rv_exped
(&
Te_Tim
)) {

131 
	`tim_rv_t
(&
Te_Tim
);

132 
MSTP_MAC_Addss
 = MSTP_MAC_Address;

134 
	}
}

136 
	gSd_Bufr
[32];

138 
	$_sk
(

141 
ut8_t
 
da_gi
 = 0;

142 
ut16_t
 
id
 = 0;

144 i(
	`tim_rv_exped
(&
Te_Tim
)) {

145 
	`tim_rv_t
(&
Te_Tim
);

146 
	`rtf
(
Sd_Bufr
, "BACnet: 0000000\r\n");

147 
MSTP_MAC_Addss
 = 
	`put_addss
();

148 
Sd_Bufr
[8] = (
MSTP_MAC_Addss
 & 
BIT0
) ? '1' : '0';

149 
Sd_Bufr
[9] = (
MSTP_MAC_Addss
 & 
BIT1
) ? '1' : '0';

150 
Sd_Bufr
[10] = (
MSTP_MAC_Addss
 & 
BIT2
) ? '1' : '0';

151 
Sd_Bufr
[11] = (
MSTP_MAC_Addss
 & 
BIT3
) ? '1' : '0';

152 
Sd_Bufr
[12] = (
MSTP_MAC_Addss
 & 
BIT4
) ? '1' : '0';

153 
Sd_Bufr
[13] = (
MSTP_MAC_Addss
 & 
BIT5
) ? '1' : '0';

154 
Sd_Bufr
[14] = (
MSTP_MAC_Addss
 & 
BIT6
) ? '1' : '0';

155 
	`rl_bys_nd
((
ut8_t
 *
Sd_Bufr
, 17);

157 i(
	`rl_by_g
(&
da_gi
)) {

159 
	`rl_by_nd
(
da_gi
);

160 
da_gi
) {

162 
	`By_Ouut_P_Vue_S
(0, 
BINARY_INACTIVE
, 0);

163 
	`By_Ouut_P_Vue_S
(1, 
BINARY_INACTIVE
, 0);

166 
	`By_Ouut_P_Vue_S
(0, 
BINARY_ACTIVE
, 0);

167 
	`By_Ouut_P_Vue_S
(1, 
BINARY_ACTIVE
, 0);

170 
	`By_Ouut_P_Vue_S
(0, 
BINARY_NULL
, 0);

171 
	`By_Ouut_P_Vue_S
(1, 
BINARY_NULL
, 0);

174 
	`rs485_baud__t
(38400);

177 
	`rs485_baud__t
(57600);

180 
	`rs485_baud__t
(76800);

183 
	`rs485_baud__t
(9600);

186 
	`rom_bys_ad
(
NV_SEEPROM_TYPE_0
, (
ut8_t
 *& 
id
, 2);

187 
	`rtf
(
Sd_Bufr
, "\r\n%04X", 
id
);

188 
	`rl_bys_nd
((
ut8_t
 *
Sd_Bufr
,

189 
	`
(
Sd_Bufr
));

192 
	`rtf
(
Sd_Bufr
, "\r\n%lubps",

193 (
	`rs485_baud_
());

194 
	`rl_bys_nd
((
ut8_t
 *
Sd_Bufr
,

195 
	`
(
Sd_Bufr
));

198 
	`rtf
(
Sd_Bufr
, "\r\nMax:%u",

199 (
	`dlmp_max_ma
());

200 
	`rl_bys_nd
((
ut8_t
 *
Sd_Bufr
,

201 
	`
(
Sd_Bufr
));

206 
	`rl_by_nd
('\r');

207 
	`rl_by_nd
('\n');

208 
	`rl_by_sm_come
();

210 
	`_p_togg
();

211 
	}
}

	@ports/bdk-atxx4-mstp/test.h

24 #ide
TEST_H


25 
	#TEST_H


	)

27 
	~<dt.h
>

29 #ifde
__lulus


33 
_
(

35 
_sk
(

38 #ifde
__lulus


	@ports/bdk-atxx4-mstp/timer.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~"tim.h
"

37 
	$tim_d_t
(

38 
im
 *
t
)

40 
ut32_t
 
now
 = 
	`tim_mlicds
();

42 i(
t
) {

43 
t
->
t
 = 
now
;

45 
	}
}

52 
ut32_t
 
	$tim_d_time
(

53 
im
 *
t
)

55 
ut32_t
 
now
 = 
	`tim_mlicds
();

56 
ut32_t
 
d
 = 0;

58 i(
t
) {

59 
d
 = 
now
 - 
t
->
t
;

62  
d
;

63 
	}
}

70 
	$tim_d_t_offt
(

71 
im
 *
t
,

72 
ut32_t
 
offt
)

74 
ut32_t
 
now
 = 
	`tim_mlicds
();

76 i(
t
) {

77 
t
->
t
 = 
now
 + 
offt
;

79 
	}
}

86 
bo
 
	$tim_d_mlicds
(

87 
im
 *
t
,

88 
ut32_t
 
mlicds
)

90  (
	`tim_d_time
(
t
>
mlicds
);

91 
	}
}

98 
bo
 
	$tim_d_cds
(

99 
im
 * 
t
,

100 
ut32_t
 
cds
)

102 
ut32_t
 
mlicds
 = 
cds
;

104 
mlicds
 *= 1000L;

106  
	`tim_d_mlicds
(
t
, 
mlicds
);

107 
	}
}

114 
bo
 
	$tim_d_mus
(

115 
im
 * 
t
,

116 
ut32_t
 
mus
)

118 
ut32_t
 
mlicds
 = 
mus
;

120 
mlicds
 *= 1000L;

121 
mlicds
 *= 60L;

123  
	`tim_d_mlicds
(
t
, 
mlicds
);

124 
	}
}

131 
bo
 
	$tim_d_mlicds_sht
(

132 
im
 * 
t
,

133 
ut16_t
 
vue
)

135 
ut32_t
 
mlicds
;

137 
mlicds
 = 
vue
;

139  (
	`tim_d_time
(
t
>
mlicds
);

140 
	}
}

147 
bo
 
	$tim_d_cds_sht
(

148 
im
 * 
t
,

149 
ut16_t
 
vue
)

151  
	`tim_d_cds
(
t
, 
vue
);

152 
	}
}

159 
bo
 
	$tim_d_mus_sht
(

160 
im
 * 
t
,

161 
ut16_t
 
vue
)

163  
	`tim_d_mus
(
t
, 
vue
);

164 
	}
}

171 
	$tim_rv_t
(

172 
im
 *
t
,

173 
ut32_t
 
rv
)

175 i(
t
) {

176 
t
->
t
 = 
	`tim_mlicds
();

177 
t
->
rv
 = interval;

179 
	}
}

186 
	$tim_rv_t_cds
(

187 
im
 *
t
,

188 
ut32_t
 
cds
)

190 
ut32_t
 
rv
 = 
cds
;

192 
rv
 *= 1000L;

193 
	`tim_rv_t
(
t
, 
rv
);

194 
	}
}

201 
	$tim_rv_t_mus
(

202 
im
 *
t
,

203 
ut32_t
 
mus
)

205 
ut32_t
 
rv
 = 
mus
;

207 
rv
 *= 1000L;

208 
rv
 *= 60L;

209 
	`tim_rv_t
(
t
, 
rv
);

210 
	}
}

217 
ut32_t
 
	$tim_rv_d
(

218 
im
 *
t
)

220 
ut32_t
 
now
 = 
	`tim_mlicds
();

221 
ut32_t
 
d
 = 0;

223 i(
t
) {

224 
d
 = 
now
 - 
t
->
t
;

227  
d
;

228 
	}
}

235 
ut32_t
 
	$tim_rv
(

236 
im
 * 
t
)

238 
ut32_t
 
rv
 = 0;

240 i(
t
) {

241 
rv
 = 
t
->interval;

244  
rv
;

245 
	}
}

252 
bo
 
	$tim_rv_exped
(

253 
im
 * 
t
)

255 
bo
 
exped
 = 
l
;

257 i(
t
) {

258 i(
t
->
rv
) {

259 
exped
 = 
	`tim_rv_d
(
t
>t->
rv
;

263  
exped
;

264 
	}
}

271 
	$tim_rv_no_expe
(

272 
im
 *
t
)

274 i(
t
) {

275 
t
->
rv
 = 0;

277 
	}
}

285 
	$tim_rv_t
(

286 
im
 *
t
)

288 i(
t
) {

289 
t
->
t
 +t->
rv
;

291 
	}
}

298 
	$tim_rv_t
(

299 
im
 *
t
)

301 i(
t
) {

302 
t
->
t
 = 
	`tim_mlicds
();

304 
	}
}

311 
ut8_t
 
	$tim_mlicds_d
(

312 
ut8_t
 
t
)

314  (
	`tim_mlicds_by
(- 
t
);

315 
	}
}

322 
ut8_t
 
	$tim_mlicds_mk
(

325  
	`tim_mlicds_by
();

326 
	}
}

328 #ifde
TEST


329 
	~<as.h
>

330 
	~<rg.h
>

332 
	~"e.h
"

334 
ut32_t
 
	gMlicds
;

336 
ut32_t
 
	$tim_mlicds
(

339  
Mlicds
;

340 
	}
}

342 
ut32_t
 
	$tim_mlicds_t
(

343 
ut32_t
 
vue
)

345 
ut32_t
 
d_vue
 = 
Mlicds
;

347 
Mlicds
 = 
vue
;

349  
d_vue
;

350 
	}
}

352 
	$EpdTim
(

353 
Te
 * 
pTe
)

355 
im
 
t
;

356 
ut32_t
 
_time
 = 0;

358 
	`tim_mlicds_t
(
_time
);

359 
	`tim_d_t
(&
t
);

360 
	`_
(
pTe
, 
	`tim_d_time
(&
t
=
_time
);

361 
_time
 = 0xffff;

362 
	`tim_mlicds_t
(
_time
);

363 
	`_
(
pTe
, 
	`tim_d_time
(&
t
=
_time
);

364 
_time
 = 0xffffffff;

365 
	`tim_mlicds_t
(
_time
);

366 
	`_
(
pTe
, 
	`tim_d_time
(&
t
=
_time
);

367 
	}
}

369 
	$IvTim
(

370 
Te
 * 
pTe
)

372 
im
 
t
;

373 
ut32_t
 
rv
 = 0;

374 
ut32_t
 
_time
 = 0;

376 
	`tim_mlicds_t
(
_time
);

377 
	`tim_rv_t
(&
t
, 
rv
);

378 
_time
 = 0xffff;

379 
	`tim_mlicds_t
(
_time
);

380 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

381 
	`_
(
pTe
, 
	`tim_rv_d
(&
t
=
_time
);

382 
_time
 = 0xffffffff;

383 
	`tim_mlicds_t
(
_time
);

384 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

385 
	`_
(
pTe
, 
	`tim_rv_d
(&
t
=
_time
);

386 
_time
 = 0;

387 
	`tim_mlicds_t
(
_time
);

388 
rv
 = 0xffff;

389 
	`tim_rv_t
(&
t
, 
rv
);

390 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

391 
rv
 = 0xffffffff;

392 
	`tim_rv_t
(&
t
, 
rv
);

393 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

395 
rv
 = 0;

396 
	`tim_rv_t_cds
(&
t
, 
rv
);

397 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

398 
rv
 = 60L;

399 
	`tim_rv_t_cds
(&
t
, 
rv
);

400 
rv
 *= 1000L;

401 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

403 
	}
}

406 #ifde
TEST_TIMER


407 
	$ma
(

410 
Te
 *
pTe
;

411 
bo
 
rc
;

413 
pTe
 = 
	`_
("Tim", 
NULL
);

416 
rc
 = 
	`_addTeFuni
(
pTe
, 
EpdTim
);

417 
	`as
(
rc
);

418 
rc
 = 
	`_addTeFuni
(
pTe
, 
IvTim
);

419 
	`as
(
rc
);

422 
	`_tSm
(
pTe
, 
dout
);

423 
	`_run
(
pTe
);

424 (
	`_pt
(
pTe
);

426 
	`_deroy
(
pTe
);

429 
	}
}

	@ports/bdk-atxx4-mstp/timer.h

24 #ide
TIMER_H


25 
	#TIMER_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

33 
	sim
 {

34 
ut32_t
 
	mt
;

37 
	sim
 {

38 
ut32_t
 
	mt
;

39 
ut32_t
 
	mrv
;

42 #ifde
__lulus


47 
tim_
(

49 
ut32_t
 
tim_mlicds
(

51 
ut8_t
 
tim_mlicds_by
(

57 
tim_d_t
(

58 
im
 *
t
);

59 
tim_d_t_offt
(

60 
im
 *
t
,

61 
ut32_t
 
offt
);

62 
ut32_t
 
tim_d_time
(

63 
im
 *
t
);

64 
bo
 
tim_d_mlicds
(

65 
im
 *
t
,

66 
ut32_t
 
vue
);

67 
bo
 
tim_d_cds
(

68 
im
 *
t
,

69 
ut32_t
 
vue
);

70 
bo
 
tim_d_mus
(

71 
im
 *
t
,

72 
ut32_t
 
vue
);

73 
bo
 
tim_d_mlicds_sht
(

74 
im
 *
t
,

75 
ut16_t
 
vue
);

76 
bo
 
tim_d_cds_sht
(

77 
im
 *
t
,

78 
ut16_t
 
vue
);

79 
bo
 
tim_d_mus_sht
(

80 
im
 *
t
,

81 
ut16_t
 
vue
);

84 
tim_rv_t
(

85 
im
 *
t
,

86 
ut32_t
 
rv
);

87 
tim_rv_t_cds
(

88 
im
 *
t
,

89 
ut32_t
 
rv
);

90 
tim_rv_t_mus
(

91 
im
 *
t
,

92 
ut32_t
 
rv
);

93 
bo
 
tim_rv_exped
(

94 
im
 *
t
);

95 
ut32_t
 
tim_rv
(

96 
im
 *
t
);

97 
ut32_t
 
tim_rv_d
(

98 
im
 *
t
);

99 
tim_rv_no_expe
(

100 
im
 *
t
);

101 
tim_rv_t
(

102 
im
 *
t
);

103 
tim_rv_t
(

104 
im
 *
t
);

107 
ut8_t
 
tim_mlicds_d
(

108 
ut8_t
 
t
);

109 
ut8_t
 
tim_mlicds_mk
(

112 #ifde
__lulus


	@ports/bdk-atxx4-mstp/timer2.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~"hdwe.h
"

27 
	~"tim.h
"

29 #ide
F_CPU


33 
	#TIMER_MICROSECONDS
 1000UL

	)

34 
	#TIMER_TICKS
(
p
) \

35 (((((
F_CPU
)/(
p
))/1000UL) \

36 *(
TIMER_MICROSECONDS
))/1000UL)

	)

37 
	#TIMER_TICKS_MAX
 255UL

	)

39 #i(
TIMER_TICKS
(1<
TIMER_TICKS_MAX
)

40 
	#TIMER2_PRESCALER
 1

	)

41 #i(
TIMER_TICKS
(8<
TIMER_TICKS_MAX
)

42 
	#TIMER2_PRESCALER
 8

	)

43 #i(
TIMER_TICKS
(32<
TIMER_TICKS_MAX
)

44 
	#TIMER2_PRESCALER
 32

	)

45 #i(
TIMER_TICKS
(64<
TIMER_TICKS_MAX
)

46 
	#TIMER2_PRESCALER
 64

	)

47 #i(
TIMER_TICKS
(128<
TIMER_TICKS_MAX
)

48 
	#TIMER2_PRESCALER
 128

	)

49 #i(
TIMER_TICKS
(256<
TIMER_TICKS_MAX
)

50 
	#TIMER2_PRESCALER
 256

	)

51 #i(
TIMER_TICKS
(1024<
TIMER_TICKS_MAX
)

52 
	#TIMER2_PRESCALER
 1024

	)

56 
	#TIMER2_TICKS
 
	`TIMER_TICKS
(
TIMER2_PRESCALER
)

	)

58 
	#TIMER2_COUNT
 (
TIMER_TICKS_MAX
-
TIMER2_TICKS
)

	)

61 vީ
ut32_t
 
	gMlicd_Cou
;

62 vީ
ut8_t
 
	gMlicd_Cou_By
;

69 
le
 
	$tim_u_hdr
(

73 
TCNT2
 = 
TIMER2_COUNT
;

74 
Mlicd_Cou
++;

75 
Mlicd_Cou_By
++;

76 
	}
}

83 
	$ISR
(
TIMER2_OVF_ve
)

85 
	`tim_u_hdr
();

86 
	}
}

93 
ut32_t
 
	$tim_mlicds
(

96 
ut32_t
 
tim_vue
;

100 
	`BIT_CLEAR
(
TIMSK2
, 
TOIE2
);

101 
tim_vue
 = 
Mlicd_Cou
;

103 
	`BIT_SET
(
TIMSK2
, 
TOIE2
);

105  
tim_vue
;

106 
	}
}

113 
ut8_t
 
	$tim_mlicds_by
(

116  
Mlicd_Cou
;

117 
	}
}

124 
	$tim_
(

128 
TCCR2A
 = 0;

141 #i(
TIMER2_PRESCALER
==1)

142 
TCCR2B
 = 
	`_BV
(
CS20
);

143 #i(
TIMER2_PRESCALER
==8)

144 
TCCR2B
 = 
	`_BV
(
CS21
);

145 #i(
TIMER2_PRESCALER
==32)

146 
TCCR2B
 = 
	`_BV
(
CS21
| _BV(
CS20
);

147 #i(
TIMER2_PRESCALER
==64)

148 
TCCR2B
 = 
	`_BV
(
CS22
);

149 #i(
TIMER2_PRESCALER
==128)

150 
TCCR2B
 = 
	`_BV
(
CS22
| _BV(
CS20
);

151 #i(
TIMER2_PRESCALER
==256)

152 
TCCR2B
 = 
	`_BV
(
CS22
| _BV(
CS21
);

153 #i(
TIMER2_PRESCALER
==1024)

154 
TCCR2B
 = 
	`_BV
(
CS22
| _BV(
CS21
| _BV(
CS20
);

156 #r 
Tim2
 
Ps
: 
Invid
 
Vue


159 
	`BIT_SET
(
TIFR2
, 
TOV2
);

161 
TCNT2
 = 
TIMER2_COUNT
;

163 
	`BIT_SET
(
TIMSK2
, 
TOIE2
);

164 
	`pow_tim2_ab
();

165 
	}
}

	@ports/bdk-atxx4-mstp/watchdog.c

24 
	~"hdwe.h
"

25 
	~"wchdog.h
"

27 #i!
defed
(
__GNUC__
)

28 
le
 
	$wdt_ab
(

29 
vue
)

31 
	`__dib_u
();

32 
	`__wchdog_t
();

34 
WDTCSR
 |(1 << 
WDCE
| (1 << 
WDE
);

36 
WDTCSR
 = (1 << 
WDE
| (
vue
);

39 
	}
}

41 
le
 
	$wdt_dib
(

44 
	`__dib_u
();

45 
	`__wchdog_t
();

47 
MCUSR
 &~(1 << 
WDRF
);

50 
WDTCSR
 |(1 << 
WDCE
| (1 << 
WDE
);

52 
WDTCSR
 = 0x00;

53 
	`__ab_u
();

54 
	}
}

56 
le
 
	$wdt_t
(

59 
	`__wchdog_t
();

60 
	}
}

68 
	$wchdog_t
(

71 
	`wdt_t
();

72 
	}
}

79 
	$wchdog_
(

80 
mlicds
)

82 
vue
 = 
WDTO_15MS
;

83 i(
mlicds
) {

84 i(
mlicds
 <= 15) {

85 
vue
 = 
WDTO_15MS
;

86 } i(
mlicds
 <= 30) {

87 
vue
 = 
WDTO_30MS
;

88 } i(
mlicds
 <= 60) {

89 
vue
 = 
WDTO_60MS
;

90 } i(
mlicds
 <= 120) {

91 
vue
 = 
WDTO_120MS
;

92 } i(
mlicds
 <= 500) {

93 
vue
 = 
WDTO_500MS
;

94 } i(
mlicds
 <= 1000) {

95 
vue
 = 
WDTO_1S
;

97 
vue
 = 
WDTO_2S
;

99 
	`wdt_ab
(
vue
);

101 
	`wdt_dib
();

103 
	}
}

	@ports/bdk-atxx4-mstp/watchdog.h

24 #ide
WATCHDOG_H


25 
	#WATCHDOG_H


	)

27 #ifde
__lulus


31 
wchdog_t
(

33 
wchdog_
(

34 
mlicds
);

36 #ifde
__lulus


	@ports/bsd/bip-init.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~"bacdcode.h
"

38 
	~"b.h
"

39 
	~"t.h
"

40 
	~<iddrs.h
>

44 
bo
 
	gBIP_Debug
 = 
ue
;

46 *
	$g_addr_r
(

47 
sockaddr
 *
sockaddr_r
)

49 *
addr_r
;

50 i(
sockaddr_r
->
_my
 =
AF_INET
) {

51 
addr_r
 = &((
sockaddr_
 *
sockaddr_r
)->
s_addr
;

52 } i(
sockaddr_r
->
_my
 =
AF_INET6
) {

53 
addr_r
 = &((
sockaddr_6
 *
sockaddr_r
)->
s6_addr
;

55  
addr_r
;

56 
	}
}

63 
	$b_gaddrbyme
(

64 cڡ *
ho_me
)

66 
hot
 *
ho_t
;

68 i((
ho_t
 = 
	`ghobyme
(
ho_me
)=
NULL
)

71  *(*
ho_t
->
h_addr
;

72 
	}
}

82 
	$g_lol_addss
(

83 *
iame
,

84 
_addr
 *
addr
,

85 *
que
)

87 
us
 = -1;

88 
iddrs
 *
iddrs_r
 = 
NULL
;

89 
iddrs
 *
iddrs_xt
 = 
NULL
;

90 *
addr_r
 = 
NULL
;

92 
us
 = 
	`giddrs
(&
iddrs_r
);

93 i(
us
 == -1) {

94 
	`rtf
(
dr
, "E i'giddrs': %d (%s)\n", 
o
,

95 
	`
(
o
));

96  
us
;

98 
us
 = -1;

99 
iddrs_xt
 = 
iddrs_r
;

100 
iddrs_xt
) {

101 i((
iddrs_xt
->
i_addr
->
_my
 =
AF_INET
) &&

102 (
	`rcmp
(
iddrs_xt
->
i_me
, 
iame
) == 0)) {

103 i(!
iddrs_xt
->
i_addr
) {

106 
addr_r
 = 
NULL
;

107 i(
	`rcmp
(
que
, "addr") == 0) {

108 
addr_r
 = 
	`g_addr_r
(
iddrs_xt
->
i_addr
);

109 } i(
	`rcmp
(
que
, "broadaddr") == 0) {

110 
addr_r
 = 
	`g_addr_r
(
iddrs_xt
->
i_brdaddr
);

111 } i(
	`rcmp
(
que
, "netmask") == 0) {

112 
addr_r
 = 
	`g_addr_r
(
iddrs_xt
->
i_tmask
);

114 i(
addr_r
) {

115 
	`memy
(
addr
, 
addr_r
, (
_addr
));

116 
us
 = 0;

120 
iddrs_xt
 = iddrs_xt->
i_xt
;

122 
	`iddrs
(
iddrs_r
);

124  
us
;

125 
	}
}

133 
	$b_t_r
(

134 *
iame
)

136 
_addr
 
lol_addss
;

137 
_addr
 
brd_addss
;

138 
rv
 = 0;

141 *
que
 = "addr";

142 
rv
 = 
	`g_lol_addss
(
iame
, &
lol_addss
, 
que
);

143 i(
rv
 < 0) {

144 
lol_addss
.
s_addr
 = 0;

146 
	`b_t_addr
(
lol_addss
.
s_addr
);

147 i(
BIP_Debug
) {

148 
	`rtf
(
dr
, "I: %s\n", 
iame
);

149 
	`rtf
(
dr
, "IP Addss: %s\n", 
	`_
(
lol_addss
));

152 
que
 = "broadaddr";

153 
rv
 = 
	`g_lol_addss
(
iame
, &
brd_addss
, 
que
);

154 i(
rv
 < 0) {

155 
brd_addss
.
s_addr
 = ~0;

157 
	`b_t_brd_addr
(
brd_addss
.
s_addr
);

158 i(
BIP_Debug
) {

159 
	`rtf
(
dr
, "IP Broadcast Address: %s\n",

160 
	`_
(
brd_addss
));

161 
	`rtf
(
dr
, "UDP Pt: 0x%04X [%hu]\n", 
	`ohs
(
	`b_g_pt
()),

162 
	`ohs
(
	`b_g_pt
()));

164 
	}
}

183 
bo
 
	$b_
(

184 *
iame
)

186 
us
 = 0;

187 
sockaddr_
 
s
;

188 
sockt
 = 0;

189 
sock_fd
 = -1;

191 i(
iame
) {

192 
	`b_t_r
(
iame
);

193 
	`tf
("r %s", 
iame
);

195 
	`b_t_r
("en0");

198 
sock_fd
 = 
	`sock
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_UDP
);

199 
	`b_t_sock
(
sock_fd
);

200 i(
sock_fd
 < 0)

201  
l
;

204 
sockt
 = 1;

205 
us
 =

206 
	`tsockt
(
sock_fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
sockt
,

207 (
sockt
));

208 i(
us
 < 0) {

209 
	`o
(
sock_fd
);

210 
	`b_t_sock
(-1);

211  
us
;

214 
us
 =

215 
	`tsockt
(
sock_fd
, 
SOL_SOCKET
, 
SO_BROADCAST
, &
sockt
,

216 (
sockt
));

217 i(
us
 < 0) {

218 
	`o
(
sock_fd
);

219 
	`b_t_sock
(-1);

220  
l
;

223 
s
.
s_my
 = 
AF_INET
;

224 
s
.
s_addr
.
s_addr
 = 
	`htl
(
INADDR_ANY
);

225 
s
.
s_pt
 = 
	`b_g_pt
();

226 
	`memt
(&(
s
.
s_zo
), '\0', (sin.sin_zero));

227 
us
 =

228 
	`bd
(
sock_fd
, (cڡ 
sockaddr
 *&
s
, (sockaddr));

229 i(
us
 < 0) {

230 
	`o
(
sock_fd
);

231 
	`b_t_sock
(-1);

232  
l
;

235  
ue
;

236 
	}
}

241 
	$b_nup
(

244 
sock_fd
 = 0;

246 i(
	`b_vid
()) {

247 
sock_fd
 = 
	`b_sock
();

248 
	`o
(
sock_fd
);

250 
	`b_t_sock
(-1);

253 
	}
}

259 
	$b_g_lol_tmask
(

260 
_addr
 *
tmask
)

262 
rv
;

263 *
iame
 = 
	`gv
("BACNET_IFACE");

264 i(
iame
 =
NULL
)

265 
iame
 = "en0";

266 
	`tf
("iam%s", 
iame
);

267 *
que
 = "netmask";

268 
rv
 = 
	`g_lol_addss
(
iame
, 
tmask
, 
que
);

270  
rv
;

271 
	}
}

	@ports/bsd/main.c

25 
	~<ddef.h
>

26 
	~<dt.h
>

27 
	~<dio.h
>

28 
	~<dlib.h
>

29 
	~<sigl.h
>

30 
	~<time.h
>

31 
	~<dbo.h
>

32 
	~"cfig.h
"

33 
	~"addss.h
"

34 
	~"bacdef.h
"

35 
	~"hdrs.h
"

36 
	~".h
"

37 
	~"bacdcode.h
"

38 
	~"du.h
"

39 
	~"du.h
"

40 
	~"m.h
"

41 
	~"tsm.h
"

42 
	~"devi.h
"

43 
	~"bacfe.h
"

44 
	~"dk.h
"

45 
	~"t.h
"

46 
	~"txbuf.h
"

47 
	~"dnv.h
"

51 
bo
 
	gWho_Is_Reque
 = 
ue
;

54 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

56 
	$LolIAmHdr
(

57 
ut8_t
 * 
rvi_que
,

58 
ut16_t
 
rvi_n
,

59 
BACNET_ADDRESS
 * 
c
)

61 
n
 = 0;

62 
ut32_t
 
devi_id
 = 0;

63 
max_du
 = 0;

64 
gmti
 = 0;

65 
ut16_t
 
vd_id
 = 0;

67 (
c
;

68 (
rvi_n
;

69 
n
 =

70 
	`m_decode_rvi_que
(
rvi_que
, &
devi_id
, &
max_du
,

71 &
gmti
, &
vd_id
);

72 
	`rtf
(
dr
, "Received I-Am Request");

73 i(
n
 != -1) {

74 
	`rtf
(
dr
, " from %u!\n", 
devi_id
);

75 
	`addss_add
(
devi_id
, 
max_du
, 
c
);

77 
	`rtf
(
dr
, "!\n");

80 
	}
}

82 
	$Rd_Prݔts
(

85 
ut32_t
 
devi_id
 = 0;

86 
bo
 
us
 = 
l
;

87 
max_du
 = 0;

88 
BACNET_ADDRESS
 
c
;

89 
bo
 
xt_devi
 = 
l
;

90 
dex
 = 0;

91 
ݔty
 = 0;

96 cڡ 
obje_s
[] = {

97 
PROP_OBJECT_IDENTIFIER
,

98 
PROP_OBJECT_NAME
,

99 
PROP_OBJECT_TYPE
,

100 
PROP_SYSTEM_STATUS
,

101 
PROP_VENDOR_NAME
,

102 
PROP_VENDOR_IDENTIFIER
,

103 
PROP_MODEL_NAME
,

104 
PROP_FIRMWARE_REVISION
,

105 
PROP_APPLICATION_SOFTWARE_VERSION
,

106 
PROP_PROTOCOL_VERSION
,

107 
PROP_PROTOCOL_SERVICES_SUPPORTED
,

108 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

109 
PROP_MAX_APDU_LENGTH_ACCEPTED
,

110 
PROP_SEGMENTATION_SUPPORTED
,

111 
PROP_LOCAL_TIME
,

112 
PROP_LOCAL_DATE
,

113 
PROP_UTC_OFFSET
,

114 
PROP_DAYLIGHT_SAVINGS_STATUS
,

115 
PROP_APDU_SEGMENT_TIMEOUT
,

116 
PROP_APDU_TIMEOUT
,

117 
PROP_NUMBER_OF_APDU_RETRIES
,

118 
PROP_TIME_SYNCHRONIZATION_RECIPIENTS
,

119 
PROP_MAX_MASTER
,

120 
PROP_MAX_INFO_FRAMES
,

121 
PROP_DEVICE_ADDRESS_BINDING
,

134 i(
	`addss_cou
()) {

135 i(
	`addss_g_by_dex
(
dex
, &
devi_id
, &
max_du
, &
c
)) {

136 i(
obje_s
[
ݔty
] < 0)

137 
xt_devi
 = 
ue
;

143 
us
 = 
	`Sd_Rd_Prݔty_Reque
(
devi_id
,

144 
OBJECT_DEVICE
, 
devi_id
, 
obje_s
[
ݔty
],

145 
BACNET_ARRAY_ALL
);

146 i(
us
)

147 
ݔty
++;

150 
xt_devi
 = 
ue
;

151 i(
xt_devi
) {

152 
xt_devi
 = 
l
;

153 
dex
++;

154 i(
dex
 >
MAX_ADDRESS_CACHE
)

155 
dex
 = 0;

156 
ݔty
 = 0;

161 
	}
}

163 
	$In_Svi_Hdrs
(

166 
	`Devi_In
(
NULL
);

167 
	`hdr_ad_ݔty_obje_t
(
OBJECT_DEVICE
,

168 
Devi_Encode_Prݔty_APDU
, 
Devi_Vid_Obje_In_Numb
);

170 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

171 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
LolIAmHdr
);

175 
du_t_uecognized_rvi_hdr_hdr


176 (
hdr_uecognized_rvi
);

179 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

180 
hdr_ad_ݔty
);

182 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

183 
hdr_ad_ݔty_ack
);

184 
	}
}

186 
	$t_addss_che
(

189 
i
, 
j
;

190 
BACNET_ADDRESS
 
addss
;

191 
ut32_t
 
devi_id
 = 0;

192 
max_du
 = 0;

194 
	`rtf
(
dr
, "Device\tMAC\tMaxAPDU\tNet\n");

195 
i
 = 0; i < 
MAX_ADDRESS_CACHE
; i++) {

196 i(
	`addss_g_by_dex
(
i
, &
devi_id
, &
max_du
, &
addss
)) {

197 
	`rtf
(
dr
, "%u\t", 
devi_id
);

198 
j
 = 0; j < 
addss
.
mac_n
; j++) {

199 
	`rtf
(
dr
, "%02X", 
addss
.
mac
[
j
]);

201 
	`rtf
(
dr
, "\t");

202 
	`rtf
(
dr
, "%hu\t", 
max_du
);

203 
	`rtf
(
dr
, "%hu\n", 
addss
.
t
);

206 
	}
}

208 
	$t_tsm_s
(

211 
id
 = 0;

212 
tٮ
 = 0;

214 
id
 = 
	`tsm_i_id_cou
();

215 
tٮ
 = 
MAX_TSM_TRANSACTIONS
;

216 
	`rtf
(
dr
, "TSM: %d id o%dnis\n", 
id
, 
tٮ
);

217 
	}
}

219 
	$sig_hdr
(

220 
signo
)

222 
	`dk_nup
();

223 
	`t_addss_che
();

224 
	`t_tsm_s
();

226 
	`ex
(0);

227 
	}
}

229 
	$ma
(

230 
gc
,

231 *
gv
[])

233 
BACNET_ADDRESS
 
c
 = { 0 };

234 
ut16_t
 
pdu_n
 = 0;

235 
timeout
 = 100;

236 
cou
 = 0;

237 
time_t
 
t_time
;

238 
time_t
 
w_time
 = 0;

240 
t_time
 = 
	`time
(
NULL
);

242 
	`sigl
(
SIGINT
, 
sig_hdr
);

243 
	`sigl
(
SIGHUP
, 
sig_hdr
);

244 
	`sigl
(
SIGTERM
, 
sig_hdr
);

246 
	`Devi_S_Obje_In_Numb
(111);

247 
	`In_Svi_Hdrs
();

248 
	`dnv_
();

252 
w_time
 = 
	`time
(
NULL
);

254 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

257 i(
pdu_n
) {

258 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

260 i(
w_time
 > 
t_time
) {

261 
	`tsm_tim_mlicds
(
w_time
 - 
t_time
 * 1000);

262 
t_time
 = 
w_time
;

264 i(
I_Am_Reque
) {

265 
I_Am_Reque
 = 
l
;

266 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

267 } i(
Who_Is_Reque
) {

268 
Who_Is_Reque
 = 
l
;

269 
	`Sd_WhoIs
(-1, -1);

273 
cou
++;

274 
cou
) {

282 
cou
 = 0;

290 
	}
}

	@ports/bsd/net.h

26 #ide
NET_H


27 
	#NET_H


	)

30 
	~<sys/tys.h
>

31 
	~<sys/time.h
>

32 
	~<time.h
>

33 
	~<t/.h
>

34 
	~</.h
>

35 
	~<f.h
>

36 
	~<tdb.h
>

37 
	~<o.h
>

38 
	~<sigl.h
>

39 
	~<dio.h
>

40 
	~<dlib.h
>

41 
	~<rg.h
>

42 
	~<sys/.h
>

43 
	~<sys/uio.h
>

44 
	~<unid.h
>

45 
	~<sys/wa.h
>

46 
	~<sys/un.h
>

48 #ifdef 
HAVE_SYS_SELECT_H


49 
	~<sys/.h
>

52 #ifdef 
HAVE_POLL_H


53 
	~<pl.h
>

56 #ifdef 
HAVE_STRINGS_H


57 
	~<rgs.h
>

63 #ifdef 
HAVE_SYS_IOCTL_H


64 
	~<sys/iol.h
>

66 #ifdef 
HAVE_SYS_FILIO_H


67 
	~<sys/fio.h
>

69 #ifdef 
HAVE_SYS_SOCKIO_H


70 
	~<sys/sockio.h
>

73 
	~<had.h
>

74 
	~<mhe.h
>

76 
	#ENUMS


	)

77 
	~<sys/sock.h
>

78 
	~<t/rou.h
>

79 
	~<t/if.h
>

80 
	~<t/if_v.h
>

81 
	~<t/if_p.h
>

82 
	~<t/if_dl.h
>

83 
	~<iddrs.h
>

84 
	~<t/ht.h
>

85 
	~<t/.h
>

86 
	~<t/_v.h
>

87 
	~</.h
>

88 
	~<sys/un.h
>

89 
	~<sys/iol.h
>

90 
	~<tdb.h
>

95 
b_g_lol_tmask
(

96 
_addr
 *
tmask
);

	@ports/bsd/stdbool.h

1 #ide
STDBOOL_H


2 
	#STDBOOL_H


	)

6 #ide
__lulus


9 #ide
bo


10 
	#bo
 
_Bo


	)

12 #ide
ue


13 
	#ue
 1

	)

15 #ide
l


16 
	#l
 0

	)

18 
	#__bo_ue_l_e_defed
 1

	)

21 #ide
FALSE


22 
	#FALSE
 0

	)

25 #ide
TRUE


26 
	#TRUE
 1

	)

	@ports/bsd/timer.c

25 
	~<dio.h
>

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<time.h
>

29 
	~"tim.h
"

30 
	~<mach/ock.h
>

31 
	~<mach/mach.h
>

36 vީ
ut32_t
 
	gMlicd_Cou
[
MAX_MILLISECOND_TIMERS
];

39 
timeec
 
	gt
;

42 
ut32_t
 
	$timeGTime
(

45 
timeec
 
now
;

46 
ut32_t
 
ticks
;

49 
ock_rv_t
 
cock
;

50 
mach_timeec_t
 
mts
;

51 
	`ho_g_ock_rvi
(
	`mach_ho_lf
(), 
CALENDAR_CLOCK
, &
cock
);

52 
	`ock_g_time
(
cock
, &
mts
);

53 
	`mach_pt_do
(
	`mach_sk_lf
(), 
cock
);

54 
now
.
tv_c
 = 
mts
.tv_sec;

55 
now
.
tv_nc
 = 
mts
.tv_nsec;

57 
ticks
 =

58 (
now
.
tv_c
 - 
t
.tv_c* 1000 + (now.
tv_nc
 -

59 
t
.
tv_nc
) / 1000000;

61  
ticks
;

62 
	}
}

69 
ut32_t
 
	$tim_mlicds
(

70 
dex
)

72 
ut32_t
 
now
 = 
	`timeGTime
();

73 
ut32_t
 
d_time
 = 0;

75 i(
dex
 < 
MAX_MILLISECOND_TIMERS
) {

76 i(
Mlicd_Cou
[
dex
] <
now
) {

77 
d_time
 = 
now
 - 
Mlicd_Cou
[
dex
];

79 
d_time
 = (
UINT32_MAX
 - 
Mlicd_Cou
[
dex
]+ 
now
 + 1;

83  
d_time
;

84 
	}
}

91 
bo
 
	$tim_d_mlicds
(

92 
dex
,

93 
ut32_t
 
vue
)

95  (
	`tim_mlicds
(
dex
>
vue
);

96 
	}
}

103 
bo
 
	$tim_d_cds
(

104 
dex
,

105 
ut32_t
 
cds
)

107  ((
	`tim_mlicds
(
dex
/ 1000>
cds
);

108 
	}
}

115 
bo
 
	$tim_d_mus
(

116 
dex
,

117 
ut32_t
 
mus
)

119  ((
	`tim_mlicds
(
dex
/ (1000 * 60)>
mus
);

120 
	}
}

127 
ut32_t
 
	$tim_t
(

128 
dex
)

130 
ut32_t
 
tim_vue
 = 0;

132 i(
dex
 < 
MAX_MILLISECOND_TIMERS
) {

133 
tim_vue
 = 
	`tim_mlicds
(
dex
);

134 
Mlicd_Cou
[
dex
] = 
	`timeGTime
();

137  
tim_vue
;

138 
	}
}

145 
	$tim_
(

149 
ock_rv_t
 
cock
;

150 
mach_timeec_t
 
mts
;

151 
	`ho_g_ock_rvi
(
	`mach_ho_lf
(), 
CALENDAR_CLOCK
, &
cock
);

152 
	`ock_g_time
(
cock
, &
mts
);

153 
	`mach_pt_do
(
	`mach_sk_lf
(), 
cock
);

154 
t
.
tv_c
 = 
mts
.tv_sec;

155 
t
.
tv_nc
 = 
mts
.tv_nsec;

156 
	}
}

	@ports/bsd/timer.h

24 #ide
TIMER_H


25 
	#TIMER_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<sys/time.h
>

32 #ide
MAX_MILLISECOND_TIMERS


33 
	#TIMER_SILENCE
 0

	)

34 
	#MAX_MILLISECOND_TIMERS
 1

	)

37 #ifde
__lulus


40 
ut32_t
 
timeGTime
(

43 
tim_
(

45 
ut32_t
 
tim_mlicds
(

46 
dex
);

47 
bo
 
tim_d_mlicds
(

48 
dex
,

49 
ut32_t
 
vue
);

50 
bo
 
tim_d_cds
(

51 
dex
,

52 
ut32_t
 
vue
);

53 
bo
 
tim_d_mus
(

54 
dex
,

55 
ut32_t
 
cds
);

56 
ut32_t
 
tim_mlicds_t
(

57 
dex
,

58 
ut32_t
 
vue
);

59 
ut32_t
 
tim_t
(

60 
dex
);

62 #ifde
__lulus


	@ports/dos/dlmstp.c

35 
	~<dbo.h
>

36 
	~<dt.h
>

37 
	~<ddef.h
>

38 
	~<rg.h
>

39 
	~"bacdef.h
"

40 
	~"dlmp.h
"

41 
	~"rs485.h
"

42 
	~"c.h
"

43 
	~"du.h
"

44 
	~"bs.h
"

45 
	~"bys.h
"

46 
	~"baddr.h
"

52 
	~"tim.h
"

58 
	#MSTP_BROADCAST_ADDRESS
 255

	)

62 
	#FRAME_TYPE_TOKEN
 0

	)

63 
	#FRAME_TYPE_POLL_FOR_MASTER
 1

	)

64 
	#FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
 2

	)

65 
	#FRAME_TYPE_TEST_REQUEST
 3

	)

66 
	#FRAME_TYPE_TEST_RESPONSE
 4

	)

67 
	#FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
 5

	)

68 
	#FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
 6

	)

69 
	#FRAME_TYPE_REPLY_POSTPONED
 7

	)

76 
	#FRAME_TYPE_PROPRIETARY_MIN
 128

	)

77 
	#FRAME_TYPE_PROPRIETARY_MAX
 255

	)

81 
	mMSTP_RECEIVE_STATE_IDLE
 = 0,

82 
	mMSTP_RECEIVE_STATE_PREAMBLE
 = 1,

83 
	mMSTP_RECEIVE_STATE_HEADER
 = 2,

84 
	mMSTP_RECEIVE_STATE_DATA
 = 3

85 } 
	tMSTP_RECEIVE_STATE
;

89 
	mMSTP_MASTER_STATE_INITIALIZE
 = 0,

90 
	mMSTP_MASTER_STATE_IDLE
 = 1,

91 
	mMSTP_MASTER_STATE_USE_TOKEN
 = 2,

92 
	mMSTP_MASTER_STATE_WAIT_FOR_REPLY
 = 3,

93 
	mMSTP_MASTER_STATE_DONE_WITH_TOKEN
 = 4,

94 
	mMSTP_MASTER_STATE_PASS_TOKEN
 = 5,

95 
	mMSTP_MASTER_STATE_NO_TOKEN
 = 6,

96 
	mMSTP_MASTER_STATE_POLL_FOR_MASTER
 = 7,

97 
	mMSTP_MASTER_STATE_ANSWER_DATA_REQUEST
 = 8

98 } 
	tMSTP_MASTER_STATE
;

101 
MSTP_RECEIVE_STATE
 
	gReive_S
;

104 
MSTP_MASTER_STATE
 
	gMa_S
;

106 
	smp_ag_t
 {

110 
	mReivedInvidFme
:1;

114 
	mReivedVidFme
:1;

117 
	mSeMa
:1;

120 
	mTnsmPackPdg
:1;

123 
	mTnsmPackDER
:1;

126 
	mReivePackPdg
:1;

127 } 
	gMSTP_Fg
;

130 
ut16_t
 
	gDaLgth
;

132 
ut8_t
 
	gDeiAddss
;

136 
ut8_t
 
	gEvtCou
;

138 
ut8_t
 
	gFmeTy
;

145 
ut8_t
 *
	gIutBufr
;

146 
ut8_t
 
	gIutBufrSize
;

148 
ut8_t
 
	gSourAddss
;

153 
ut8_t
 
	gThis_Sti
;

161 
ut8_t
 
	gNmax_fo_ames
;

167 
ut8_t
 
	gNmax_ma
;

175 
ut8_t
 *
	gTnsmPack
;

176 
ut16_t
 
	gTnsmPackL
;

177 
ut8_t
 
	gTnsmPackDe
;

181 
	#Tno_tok
 500

	)

187 
	#Ty_timeout
 260

	)

193 
	#Tuge_timeout
 25

	)

197 
	#Npl
 50

	)

200 
	#Ny_tok
 1

	)

204 
	#Nm_os
 4

	)

212 
	#Tame_abt
 30

	)

216 
	#Tame_g
 20

	)

221 
	#Tpodrive
 15

	)

226 
	#Ty_day
 250

	)

230 
	#T
 10

	)

235 
	#Tuge_day
 15

	)

238 
	#INCREMENT_AND_LIMIT_UINT8
(
x
{i(x < 0xFFx++;}

	)

240 
bo
 
	$dlmp_
(

241 *
iame
)

243 (
iame
;

245 
	`RS485_Inlize
();

247  
ue
;

248 
	}
}

250 
	$dlmp_nup
(

254 
	}
}

256 
	$dlmp_fl_ba_addss
(

257 
BACNET_ADDRESS
 * 
c
,

258 
ut8_t
 
mp_addss
)

260 
i
 = 0;

262 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

264 
c
->
mac_n
 = 0;

265 
c
->
mac
[0] = 0;

267 
c
->
mac_n
 = 1;

268 
c
->
mac
[0] = 
mp_addss
;

271 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

272 
c
->
mac
[
i
] = 0;

274 
c
->
t
 = 0;

275 
c
->
n
 = 0;

276 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

277 
c
->
adr
[
i
] = 0;

279 
	}
}

281 
bo
 
	$dlmp_com_da_exg_y
(

282 
ut8_t
 * 
que_pdu
,

283 
ut16_t
 
que_pdu_n
,

284 
ut8_t
 
c_addss
,

285 
ut8_t
 * 
y_pdu
,

286 
ut16_t
 
y_pdu_n
,

287 
ut8_t
 
de_addss
)

289 
ut16_t
 
offt
;

293 
	sDER_com_t
 {

294 
BACNET_NPDU_DATA
 
du_da
;

295 
BACNET_ADDRESS
 
addss
;

296 
ut8_t
 
pdu_ty
;

297 
ut8_t
 
voke_id
;

298 
ut8_t
 
rvi_choi
;

300 
DER_com_t
 
que
;

301 
DER_com_t
 
y
;

304 
que
.
addss
.
mac
[0] = 
c_addss
;

305 
que
.
addss
.
mac_n
 = 1;

306 
offt
 =

307 
	`du_decode
(&
que_pdu
[0], 
NULL
, &
que
.
addss
,

308 &
que
.
du_da
);

309 i(
que
.
du_da
.
twk_y_mesge
) {

310  
l
;

312 
que
.
pdu_ty
 = 
que_pdu
[
offt
] & 0xF0;

313 i(
que
.
pdu_ty
 !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
) {

314  
l
;

316 
que
.
voke_id
 = 
que_pdu
[
offt
 + 2];

318 i(
que_pdu
[
offt
] & 
BIT3
)

319 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 5];

321 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 3];

323 
y
.
addss
.
mac
[0] = 
de_addss
;

324 
y
.
addss
.
mac_n
 = 1;

325 
offt
 =

326 
	`du_decode
(&
y_pdu
[0], &
y
.
addss
, 
NULL
, &y.
du_da
);

327 i(
y
.
du_da
.
twk_y_mesge
) {

328  
l
;

332 
y
.
pdu_ty
 = 
y_pdu
[
offt
] & 0xF0;

333 
y
.
pdu_ty
) {

334 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

335 
y
.
voke_id
 = 
y_pdu
[
offt
 + 2];

337 i(
y_pdu
[
offt
] & 
BIT3
)

338 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 5];

340 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 3];

342 
PDU_TYPE_SIMPLE_ACK
:

343 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

344 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

346 
PDU_TYPE_COMPLEX_ACK
:

347 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

349 i(
y_pdu
[
offt
] & 
BIT3
)

350 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 4];

352 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

354 
PDU_TYPE_ERROR
:

355 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

356 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

358 
PDU_TYPE_REJECT
:

359 
PDU_TYPE_ABORT
:

360 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

363  
l
;

365 i(
que
.
voke_id
 !
y
.invoke_id) {

366  
l
;

369 i((
y
.
pdu_ty
 !
PDU_TYPE_REJECT
) &&

370 (
y
.
pdu_ty
 !
PDU_TYPE_ABORT
)) {

371 i(
que
.
rvi_choi
 !
y
.service_choice) {

372  
l
;

375 i(
que
.
du_da
.
oc_vsi
 !
y
.npdu_data.protocol_version) {

376  
l
;

378 i(
que
.
du_da
.
iܙy
 !
y
.npdu_data.priority) {

379  
l
;

381 i(!
	`ba_addss_me
(&
que
.
addss
, &
y
.address)) {

382  
l
;

385  
ue
;

386 
	}
}

401 
	$MSTP_Sd_Fme
(

402 
ut8_t
 
ame_ty
,

403 
ut8_t
 
dei
,

404 
ut8_t
 
sour
,

405 
ut8_t
 * 
da
,

406 
ut16_t
 
da_n
)

408 
ut8_t
 
c8
 = 0xFF;

409 
ut16_t
 
c16
 = 0xFFFF;

410 
ut8_t
 
bufr
[8];

411 
ut16_t
 
i
 = 0;

414 
bufr
[0] = 0x55;

415 
bufr
[1] = 0xFF;

416 
bufr
[2] = 
ame_ty
;

417 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[2], crc8);

418 
bufr
[3] = 
dei
;

419 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[3], crc8);

420 
bufr
[4] = 
sour
;

421 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[4], crc8);

422 
bufr
[5] = 
	`HI_BYTE
(
da_n
);

423 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[5], crc8);

424 
bufr
[6] = 
	`LO_BYTE
(
da_n
);

425 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[6], crc8);

426 
bufr
[7] = ~
c8
;

427 
	`RS485_Tuound_Day
();

428 
	`RS485_Tnsmr_Eb
(
ue
);

429 
	`RS485_Sd_Da
(
bufr
, 8);

431 i(
da_n
) {

433 
i
 = 0; i < 
da_n
; i++) {

434 
c16
 = 
	`CRC_Cc_Da
(
da
[
i
], crc16);

436 
c16
 = ~crc16;

437 
bufr
[0] = (
c16
 & 0x00FF);

438 
bufr
[1] = ((
c16
 & 0xFF00) >> 8);

439 
	`RS485_Sd_Da
(
da
, 
da_n
);

440 
	`RS485_Sd_Da
(
bufr
, 2);

442 
	`RS485_Tnsmr_Eb
(
l
);

443 
	}
}

445 
	$MSTP_Reive_Fme_FSM
(

449 
ut8_t
 
DaRegi
 = 0;

451 
ut16_t
 
DaCRC
 = 0;

453 
ut8_t
 
HdCRC
 = 0;

456 
ut8_t
 
Index
 = 0;

458 
Reive_S
) {

459 
MSTP_RECEIVE_STATE_IDLE
:

461 i(
	`RS485_ReiveE
()) {

463 
	`Tim_S_Ret
();

464 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

465 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

466 
	`Tim_S_Ret
();

467 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

468 i(
DaRegi
 == 0x55) {

471 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

475 
MSTP_RECEIVE_STATE_PREAMBLE
:

478 i(
	`Tim_S
(> 
Tame_abt
) {

482 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

483 } i(
	`RS485_ReiveE
()) {

485 
	`Tim_S_Ret
();

486 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

488 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

489 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

490 
	`Tim_S_Ret
();

491 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

492 i(
DaRegi
 == 0xFF) {

494 
Index
 = 0;

495 
HdCRC
 = 0xFF;

497 
Reive_S
 = 
MSTP_RECEIVE_STATE_HEADER
;

498 } i(
DaRegi
 == 0x55) {

501 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

505 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

509 
MSTP_RECEIVE_STATE_HEADER
:

511 i(
	`Tim_S
(> 
Tame_abt
) {

514 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

516 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

517 } i(
	`RS485_ReiveE
()) {

519 
	`Tim_S_Ret
();

520 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

522 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

524 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

525 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

526 
	`Tim_S_Ret
();

527 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

528 i(
Index
 == 0) {

530 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

531 
FmeTy
 = 
DaRegi
;

532 
Index
 = 1;

533 } i(
Index
 == 1) {

535 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

536 
DeiAddss
 = 
DaRegi
;

537 
Index
 = 2;

538 } i(
Index
 == 2) {

540 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

541 
SourAddss
 = 
DaRegi
;

542 
Index
 = 3;

543 } i(
Index
 == 3) {

545 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

546 
DaLgth
 = 
DaRegi
 * 256;

547 
Index
 = 4;

548 } i(
Index
 == 4) {

550 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

551 
DaLgth
 +
DaRegi
;

552 
Index
 = 5;

553 } i(
Index
 == 5) {

555 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

558 i(
HdCRC
 != 0x55) {

562 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

564 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

570 i((
DaLgth
&& (DaLgth <
IutBufrSize
)) {

572 
Index
 = 0;

573 
DaCRC
 = 0xFFFF;

575 
Reive_S
 = 
MSTP_RECEIVE_STATE_DATA
;

577 i(
DaLgth
 == 0) {

579 i((
DeiAddss
 =
This_Sti
) ||

580 (
DeiAddss
 ==

581 
MSTP_BROADCAST_ADDRESS
)) {

585 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

593 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

596 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

602 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

604 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

608 
MSTP_RECEIVE_STATE_DATA
:

610 i(
	`Tim_S
(> 
Tame_abt
) {

613 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

615 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

616 } i(
	`RS485_ReiveE
()) {

618 
	`Tim_S_Ret
();

619 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

622 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

624 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

625 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

626 
	`Tim_S_Ret
();

627 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

628 i(
Index
 < 
DaLgth
) {

630 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

631 
IutBufr
[
Index
] = 
DaRegi
;

632 
Index
++;

633 } i(
Index
 =
DaLgth
) {

635 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

636 
Index
++;

637 } i(
Index
 =(
DaLgth
 + 1)) {

639 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

642 i(
DaCRC
 == 0xF0B8) {

643 i((
DeiAddss
 =
This_Sti
) ||

644 (
DeiAddss
 =
MSTP_BROADCAST_ADDRESS
)) {

648 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

651 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

653 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

659 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

664 
	}
}

667 
bo
 
	$MSTP_Ma_Node_FSM
(

673 
ut8_t
 
FmeCou
;

677 
ut8_t
 
Next_Sti
;

680 
ut8_t
 
Pl_Sti
;

683 
RryCou
;

688 
TokCou
;

690 
ut8_t
 
xt_pl_i
 = 0;

691 
ut8_t
 
xt_this_i
 = 0;

692 
ut8_t
 
xt_xt_i
 = 0;

694 
ut16_t
 
my_timeout
 = 10, 
ns_timeout
 = 0;

695 
bo
 
mched
;

697 
bo
 
si_now
 = 
l
;

700 
xt_pl_i
 = (
Pl_Sti
 + 1% (
Nmax_ma
 + 1);

701 
xt_this_i
 = (
This_Sti
 + 1% (
Nmax_ma
 + 1);

702 
xt_xt_i
 = (
Next_Sti
 + 1% (
Nmax_ma
 + 1);

703 
Ma_S
) {

704 
MSTP_MASTER_STATE_INITIALIZE
:

707 
Next_Sti
 = 
This_Sti
;

708 
Pl_Sti
 = 
This_Sti
;

711 
TokCou
 = 
Npl
;

712 
MSTP_Fg
.
SeMa
 = 
l
;

713 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

714 
si_now
 = 
ue
;

716 
MSTP_MASTER_STATE_IDLE
:

718 i(
	`Tim_S
(>
Tno_tok
) {

721 
EvtCou
 = 0;

722 
Ma_S
 = 
MSTP_MASTER_STATE_NO_TOKEN
;

723 
si_now
 = 
ue
;

724 } i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

727 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

729 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

730 
FmeTy
) {

731 
FRAME_TYPE_TOKEN
:

734 i(
DeiAddss
 =
MSTP_BROADCAST_ADDRESS
)

736 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

737 
FmeCou
 = 0;

738 
MSTP_Fg
.
SeMa
 = 
l
;

739 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

740 
si_now
 = 
ue
;

742 
FRAME_TYPE_POLL_FOR_MASTER
:

745 i(
DeiAddss
 =
This_Sti
) {

746 
	`MSTP_Sd_Fme
(
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

747 
SourAddss
, 
This_Sti
, 
NULL
, 0);

750 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

752 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

754 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

756 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

758 i(
DeiAddss
 !
MSTP_BROADCAST_ADDRESS
) {

759 
Ma_S
 =

760 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
;

763 
FRAME_TYPE_TEST_REQUEST
:

764 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TEST_RESPONSE
,

765 
SourAddss
, 
This_Sti
, &
IutBufr
[0],

766 
DaLgth
);

768 
FRAME_TYPE_TEST_RESPONSE
:

774 i(
Ma_S
 !
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
) {

775 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

782 
MSTP_MASTER_STATE_USE_TOKEN
:

784 i(!
MSTP_Fg
.
TnsmPackPdg
) {

786 
FmeCou
 = 
Nmax_fo_ames
;

787 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

788 
si_now
 = 
ue
;

790 
ut8_t
 
ame_ty
;

791 i(
MSTP_Fg
.
TnsmPackDER
) {

792 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

794 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

796 
	`MSTP_Sd_Fme
(
ame_ty
, 
TnsmPackDe
, 
This_Sti
,

797 (
ut8_t
 *& 
TnsmPack
[0], 
TnsmPackL
);

798 
MSTP_Fg
.
TnsmPackPdg
 = 
l
;

799 
FmeCou
++;

800 
ame_ty
) {

801 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

803 i(
TnsmPackDe
 =
MSTP_BROADCAST_ADDRESS
)

804 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

806 
Ma_S
 = 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

808 
FRAME_TYPE_TEST_REQUEST
:

809 
Ma_S
 = 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

811 
FRAME_TYPE_TEST_RESPONSE
:

812 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

815 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

820 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

823 i(
	`Tim_S
(>
Ty_timeout
) {

826 
FmeCou
 = 
Nmax_fo_ames
;

827 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

832 
si_now
 = 
ue
;

834 i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

837 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

838 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

839 
si_now
 = 
ue
;

840 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

841 i(
DeiAddss
 =
This_Sti
) {

843 
FmeTy
) {

844 
FRAME_TYPE_REPLY_POSTPONED
:

846 
Ma_S
 =

847 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

849 
FRAME_TYPE_TEST_RESPONSE
:

850 
Ma_S
 =

851 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

853 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

857 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

858 
Ma_S
 =

859 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

864 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

875 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

877 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

878 
si_now
 = 
ue
;

884 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
:

886 i(
FmeCou
 < 
Nmax_fo_ames
) {

889 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

890 
si_now
 = 
ue
;

891 } i((
MSTP_Fg
.
SeMa
 =
l
) &&

892 (
Next_Sti
 =
This_Sti
)) {

896 
Pl_Sti
 = 
xt_this_i
;

897 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

898 
This_Sti
, 
NULL
, 0);

899 
RryCou
 = 0;

900 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

903 i(
TokCou
 < (
Npl
 - 1)) {

904 i((
MSTP_Fg
.
SeMa
 =
ue
) &&

905 (
Next_Sti
 !
xt_this_i
)) {

909 
FmeCou
 = 0;

910 
TokCou
++;

911 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

912 
si_now
 = 
ue
;

919 
TokCou
++;

921 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

922 
This_Sti
, 
NULL
, 0);

923 
RryCou
 = 0;

924 
EvtCou
 = 0;

925 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

927 } i(
xt_pl_i
 =
Next_Sti
) {

928 i(
MSTP_Fg
.
SeMa
 =
ue
) {

930 
Pl_Sti
 = 
xt_xt_i
;

931 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

932 
This_Sti
, 
NULL
, 0);

934 
Next_Sti
 = 
This_Sti
;

935 
RryCou
 = 0;

936 
TokCou
 = 1;

939 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

942 
Pl_Sti
 = 
This_Sti
;

944 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

945 
This_Sti
, 
NULL
, 0);

946 
RryCou
 = 0;

947 
TokCou
 = 1;

948 
EvtCou
 = 0;

949 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

953 
Pl_Sti
 = 
xt_pl_i
;

954 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

955 
This_Sti
, 
NULL
, 0);

956 
RryCou
 = 0;

957 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

962 
MSTP_MASTER_STATE_PASS_TOKEN
:

963 i(
	`Tim_S
(<
Tuge_timeout
) {

964 i(
EvtCou
 > 
Nm_os
) {

968 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

969 
si_now
 = 
ue
;

972 i(
RryCou
 < 
Ny_tok
) {

974 
RryCou
++;

976 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

977 
This_Sti
, 
NULL
, 0);

978 
EvtCou
 = 0;

985 
Pl_Sti
 = 
xt_xt_i
;

987 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

988 
This_Sti
, 
NULL
, 0);

990 
Next_Sti
 = 
This_Sti
;

991 
RryCou
 = 0;

992 
TokCou
 = 0;

995 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1003 
MSTP_MASTER_STATE_NO_TOKEN
:

1004 
my_timeout
 = 
Tno_tok
 + (
T
 * 
This_Sti
);

1005 i(
	`Tim_S
(< 
my_timeout
) {

1006 i(
EvtCou
 > 
Nm_os
) {

1010 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1011 
si_now
 = 
ue
;

1014 
ns_timeout
 = 
Tno_tok
 + (
T
 * (
This_Sti
 + 1));

1015 i(
	`Tim_S
(< 
ns_timeout
) {

1019 
Pl_Sti
 = 
xt_this_i
;

1021 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

1022 
This_Sti
, 
NULL
, 0);

1024 
Next_Sti
 = 
This_Sti
;

1025 
RryCou
 = 0;

1026 
TokCou
 = 0;

1029 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1036 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

1037 i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

1038 i((
DeiAddss
 =
This_Sti
)

1039 && (
FmeTy
 =
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
)) {

1041 
MSTP_Fg
.
SeMa
 = 
l
;

1042 
Next_Sti
 = 
SourAddss
;

1043 
EvtCou
 = 0;

1045 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1046 
This_Sti
, 
NULL
, 0);

1047 
Pl_Sti
 = 
This_Sti
;

1048 
TokCou
 = 0;

1049 
RryCou
 = 0;

1050 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1057 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1058 
si_now
 = 
ue
;

1060 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1061 } i((
	`Tim_S
(> 
Tuge_timeout
) ||

1062 (
MSTP_Fg
.
ReivedInvidFme
 =
ue
)) {

1063 i(
MSTP_Fg
.
SeMa
 =
ue
) {

1067 
FmeCou
 = 0;

1069 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1070 
si_now
 = 
ue
;

1072 i(
Next_Sti
 !
This_Sti
) {

1076 
EvtCou
 = 0;

1078 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1079 
This_Sti
, 
NULL
, 0);

1080 
RryCou
 = 0;

1081 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1083 i(
xt_pl_i
 !
This_Sti
) {

1085 
Pl_Sti
 = 
xt_pl_i
;

1087 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
,

1088 
Pl_Sti
, 
This_Sti
, 
NULL
, 0);

1089 
RryCou
 = 0;

1094 
MSTP_Fg
.
SeMa
 = 
ue
;

1095 
FmeCou
 = 0;

1096 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1097 
si_now
 = 
ue
;

1101 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

1107 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
:

1109 i(
MSTP_Fg
.
TnsmPackPdg
) {

1110 
mched
 =

1111 
	`dlmp_com_da_exg_y
(&
IutBufr
[0],

1112 
DaLgth
, 
SourAddss
, &
TnsmPack
[0],

1113 
TnsmPackL
, 
TnsmPackDe
);

1115 i(
MSTP_Fg
.
TnsmPackPdg
 && 
mched
) {

1123 
ut8_t
 
ame_ty
;

1124 i(
MSTP_Fg
.
TnsmPackDER
) {

1125 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

1127 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

1129 
	`MSTP_Sd_Fme
(
ame_ty
, 
TnsmPackDe
, 
This_Sti
,

1130 (
ut8_t
 *& 
TnsmPack
[0], 
TnsmPackL
);

1131 
MSTP_Fg
.
TnsmPackPdg
 = 
l
;

1132 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1143 
	`MSTP_Sd_Fme
(
FRAME_TYPE_REPLY_POSTPONED
, 
SourAddss
,

1144 
This_Sti
, 
NULL
, 0);

1145 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1148 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1151 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1155  
si_now
;

1156 
	}
}

1159 
	$dlmp_nd_pdu
(

1160 
BACNET_ADDRESS
 * 
de
,

1161 
BACNET_NPDU_DATA
 * 
du_da
,

1162 
ut8_t
 * 
pdu
,

1163 
pdu_n
)

1165 
bys_
 = 0;

1167 i(
MSTP_Fg
.
TnsmPackPdg
 =
l
) {

1168 
MSTP_Fg
.
TnsmPackDER
 = 
du_da
->
da_exg_y
;

1169 
TnsmPack
 = 
pdu
;

1170 
TnsmPackL
 = 
pdu_n
;

1171 
bys_
 = 
pdu_n
;

1172 
TnsmPackDe
 = 
de
->
mac
[0];

1173 
MSTP_Fg
.
TnsmPackPdg
 = 
ue
;

1176  
bys_
;

1177 
	}
}

1180 
ut16_t
 
	$dlmp_ive
(

1181 
BACNET_ADDRESS
 * 
c
,

1182 
ut8_t
 * 
pdu
,

1183 
ut16_t
 
max_pdu
,

1184 
timeout
)

1186 
ut16_t
 
pdu_n
 = 0;

1189 i(!
IutBufr
) {

1190 
IutBufr
 = 
pdu
;

1191 
IutBufrSize
 = 
max_pdu
;

1194 i((
MSTP_Fg
.
ReivedVidFme
 =
l
) &&

1195 (
MSTP_Fg
.
ReivedInvidFme
 =
l
)) {

1197 
	`MSTP_Reive_Fme_FSM
();

1198 i(
MSTP_Fg
.
ReivedVidFme
 || MSTP_Fg.
ReivedInvidFme
)

1202 i(
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
)

1207 i(
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
) {

1208 
	`MSTP_Ma_Node_FSM
()) {

1213 i(
MSTP_Fg
.
ReivePackPdg
) {

1214 
MSTP_Fg
.
ReivePackPdg
 = 
l
;

1215 
pdu_n
 = 
DaLgth
;

1216 
c
->
mac_n
 = 1;

1217 
c
->
mac
[0] = 
SourAddss
;

1221  
pdu_n
;

1222 
	}
}

1224 
	$dlmp_t_mac_addss
(

1225 
ut8_t
 
mac_addss
)

1228 i(
mac_addss
 <= 127) {

1229 
This_Sti
 = 
mac_addss
;

1235 i(
mac_addss
 > 
Nmax_ma
)

1236 
	`dlmp_t_max_ma
(
mac_addss
);

1240 
	}
}

1242 
ut8_t
 
	$dlmp_mac_addss
(

1245  
This_Sti
;

1246 
	}
}

1255 
	$dlmp_t_max_fo_ames
(

1256 
ut8_t
 
max_fo_ames
)

1258 i(
max_fo_ames
 >= 1) {

1259 
Nmax_fo_ames
 = 
max_fo_ames
;

1268 
	}
}

1270 
ut8_t
 
	$dlmp_max_fo_ames
(

1273  
Nmax_fo_ames
;

1274 
	}
}

1281 
	$dlmp_t_max_ma
(

1282 
ut8_t
 
max_ma
)

1284 i(
max_ma
 <= 127) {

1285 i(
This_Sti
 <
max_ma
) {

1286 
Nmax_ma
 = 
max_ma
;

1296 
	}
}

1298 
ut8_t
 
	$dlmp_max_ma
(

1301  
Nmax_ma
;

1302 
	}
}

1304 
	$dlmp_g_my_addss
(

1305 
BACNET_ADDRESS
 * 
my_addss
)

1307 
i
 = 0;

1309 
my_addss
->
mac_n
 = 1;

1310 
my_addss
->
mac
[0] = 
This_Sti
;

1311 
my_addss
->
t
 = 0;

1312 
my_addss
->
n
 = 0;

1313 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1314 
my_addss
->
adr
[
i
] = 0;

1318 
	}
}

1320 
	$dlmp_g_brd_addss
(

1321 
BACNET_ADDRESS
 * 
de
)

1323 
i
 = 0;

1325 i(
de
) {

1326 
de
->
mac_n
 = 1;

1327 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

1328 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

1329 
de
->
n
 = 0;

1330 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1331 
de
->
adr
[
i
] = 0;

1336 
	}
}

	@ports/dos/extkword.h

25 #ide
EXTKWORD__H


26 
	#EXTKWORD__H


	)

28 
	~<lims.h
>

34 #i!
defed
(
__FLAT__
&& !defed(
__WATCOMC__
&& !defed(
_MSC_VER
)

35 #i
defed
(
__GNUC__
)

36 
	#__FLAT__
 1

	)

37 #i
defed
 (
_WIN32
|| defed(
WIN32
|| defed(
__NT__
)

38 
	#__FLAT__
 1

	)

39 #i
defed
(
__INTSIZE
)

40 #i(4 =
__INTSIZE
)

41 
	#__FLAT__
 1

	)

43 #i(
defed
(
__ZTC__
&& !defed(
__SC__
)|| defed(
__TURBOC__
)

44 #i((
INT_MAX
 !
SHRT_MAX
) && (SHRT_MAX == 32767))

45 
	#__FLAT__
 1

	)

54 #i
defed
(
__unix__
)

55 #i!
defed
(
FAR
)

56 
	#FAR


	)

58 #i!
defed
(
NEAR
)

59 
	#NEAR


	)

61 #i!
defed
(
HUGE
)

62 
	#HUGE


	)

64 #i!
defed
(
PASCAL
)

65 
	#PASCAL


	)

67 #i!
defed
(
CDECL
)

68 
	#CDECL


	)

70 #i!
defed
(
INTERRUPT
)

71 
	#INTERRUPT


	)

73 #i
defed
(
__OS2__
)

74 
	~<os2def.h
>

75 
	#INTERRUPT


	)

76 #ide
HUGE


77 
	#HUGE


	)

79 #i
defed
(
_WIN32
|| defed(
WIN32
|| defed(
__NT__
)

80 
	#WIN32_LEAN_AND_MEAN


	)

81 
	#NOGDI


	)

82 
	#NOSERVICE


	)

83 #unde
INC_OLE1


84 #unde
INC_OLE2


85 
	~<wdows.h
>

86 
	#INTERRUPT


	)

87 #ide
HUGE


88 
	#HUGE


	)

91 #i(
defed
(
__POWERC
|| (defed(
__TURBOC__
&& !defed(
__BORLANDC__
)) \

92 || (
defed
(
__ZTC__
&& !defed(
__SC__
))&& !
	$defed
(
__FLAT__
)

93 
	#FAR
 
r


	)

94 
	#NEAR
 
ì


	)

95 
	#PASCAL
 
sl


	)

96 
	#CDECL
 
cde


	)

97 #i(
	`defed
(
__ZTC__
&& !defed(
__SC__
)) || (defined(__SC__) && \

98 (
__SC__
 < 0x700))

99 #ide
HUGE


100 
	#HUGE
 
r


	)

102 
	#INTERRUPT


	)

104 #ide
HUGE


105 
	#HUGE
 
huge


	)

107 
	#INTERRUPT
 
u


	)

110 #i(
	`defed
(
__MSDOS__
|| defed(
MSDOS
)&& !defed(
__FLAT__
)

111 
	#FAR
 
_r


	)

112 
	#NEAR
 
_ì


	)

113 #ide
HUGE


114 
	#HUGE
 
_huge


	)

116 
	#PASCAL
 
_sl


	)

117 
	#CDECL
 
_cde


	)

118 
	#INTERRUPT
 
_u


	)

120 
	#FAR


	)

121 
	#NEAR


	)

122 #ide
HUGE


123 
	#HUGE


	)

125 
	#PASCAL


	)

126 
	#CDECL


	)

	@ports/dos/main.c

26 
	~"tim.h
"

28 
	~<dlib.h
>

29 
	~<rg.h
>

30 
	~<dbo.h
>

31 
	~<dt.h
>

33 
	~"rs485.h
"

34 
	~"dk.h
"

35 
	~"du.h
"

36 
	~"du.h
"

37 
	~"dcc.h
"

38 
	~"m.h
"

39 
	~"hdrs.h
"

40 
	~"devi.h
"

41 
	~"dcc.h
"

42 
	~"m.h
"

43 
	~"txbuf.h
"

45 
	gDCC_Tim
 = 1000;

47 
	$mlicd_tim
(

50 
Tim_Mlicds
) {

51 
Tim_Mlicds
--;

52 i(
DCC_Tim
) {

53 
DCC_Tim
--;

57 
	}
}

59 
	$ba_
(

62 #i
	`defed
(
BACDL_MSTP
)

63 
	`RS485_S_Baud_Re
(38400);

64 
	`dlmp_t_mac_addss
(57);

65 
	`dlmp_t_max_ma
(127);

66 
	`dlmp_t_max_fo_ames
(1);

67 
	`dlmp_
(
NULL
);

69 
	`Devi_S_Obje_In_Numb
(11111);

70 #ide
DLMSTP_TEST


72 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

75 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

76 
hdr_ad_ݔty
);

77 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

78 
hdr_lize_devi
);

79 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

80 
hdr_wre_ݔty
);

82 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

83 
hdr_devi_communiti_cڌ
);

85 
	}
}

87 
	$ma
(

90 
ut16_t
 
pdu_n
 = 0;

91 
BACNET_ADDRESS
 
c
;

92 
ut8_t
 
pdu
[
MAX_MPDU
];

94 
	`Tim_In
();

95 
	`ba_
();

97 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

99 
	`mlicd_tim
();

100 i(!
DCC_Tim
) {

101 
	`dcc_tim_cds
(1);

102 
DCC_Tim
 = 1000;

105 
pdu_n
 = 
	`dk_ive
(&
c
, &
pdu
[0], 
MAX_MPDU
, 0);

106 i(
pdu_n
) {

107 #ide
DLMSTP_TEST


108 
	`du_hdr
(&
c
, &
pdu
[0], 
pdu_n
);

112 
	}
}

	@ports/dos/mk_fp.h

7 #ide
MK_FP__H


8 
	#MK_FP__H


	)

10 
	~"extkwd.h
"

12 #i
defed
(
__WATCOMC__
)

13 
	~<i86.h
>

14 #i!
defed
(
__PACIFIC__
)

15 
	~<dos.h
>

18 #i!
defed
(
MK_FP
)

19 
	#MK_FP
(
g
,
off
) \

20 ((
FAR
 *)((()(
g
<< 16)|()(
off
)))

	)

	@ports/dos/pchwio.c

7 
	~"pchwio.h
"

8 
	~"mk_.h
"

10 #i
defed
(
__ZTC__
&& !defed(
__SC__
)

12 
FAR
 *
	$gve
(

13 
um
)

15 
g
, 
off
;

17 
	`t_gve
(
um
, &
off
, &
g
);

18  
	`MK_FP
(
g
, 
off
);

19 
	}
}

21 
tve
(

22 
um
,

23 (
INTERRUPT
 
FAR
 * 
hdr
) ())

25 
g
 = 
	`FP_SEG
(
hdr
), 
off
 = 
	`FP_OFF
(handler);

27 
	`t_tve
(
um
, 
off
, 
g
);

28 
	}
}

34 #i
defed
(
_MSC_VER
|| defed(
__WATCOMC__
) || \

35 
defed
(
__ZTC__
|| 
	$defed
(
__SC__
)

37 #i!
	`defed
(
MK_FP
)

38 
	#MK_FP
(
g
,
off
((
r
 *)((()(g<< 16)|()(off)))

	)

41 
	$Pkb
(

42 
g
,

43 
ofs
)

45 
FAR
 *
r
;

47 
r
 = 
	`MK_FP
(
g
, 
ofs
);

48  *
r
;

49 
	}
}

51 
	$Pkw
(

52 
g
,

53 
ofs
)

55 
FAR
 *
r
;

57 
r
 = 
	`MK_FP
(
g
, 
ofs
);

58  *
r
;

59 
	}
}

61 
	$Pokeb
(

62 
g
,

63 
ofs
,

64 
ch
)

66 
FAR
 *
r
;

68 
r
 = 
	`MK_FP
(
g
, 
ofs
);

69 *
r
 = 
ch
;

70 
	}
}

72 
	$Pokew
(

73 
g
,

74 
ofs
,

75 
num
)

77 
FAR
 *
r
;

79 
r
 = 
	`MK_FP
(
g
, 
ofs
);

80 *
r
 = 
num
;

81 
	}
}

	@ports/dos/pchwio.h

7 #ide
PCHWIO__H


8 
	#PCHWIO__H


	)

10 
	~<dos.h
>

11 
	~"extkwd.h
"

14 #i
defed
(
__TURBOC__
|| defed(
__POWERC
)

15 #ide
p


16 
	#p
 
ptb


	)

18 #ide
ou


19 
	#ou
 
outb


	)

21 #ide
pw


22 
	#pw
 
pt


	)

24 #ide
ouw


25 
	#ouw
 
out


	)

27 #i
defed
(
__ZTC__
)

28 
	~<t.h
>

29 
	#ab
 
t_


	)

30 
	#dib
 
t_off


	)

31 #i!
defed
(
__SC__
)

32 
FAR
 *
gve
(

33 
um
);

34 
tve
(

35 
um
,

36 (
INTERRUPT
 
FAR
 * 
hdr
) ());

38 
	#gve
 
_dos_gve


	)

39 
	#tve
 
_dos_tve


	)

42 
	~<cio.h
>

43 #i
defed
(
__WATCOMC__
)

44 
	~<i86.h
>

46 
	#ab
 
_ab


	)

47 
	#dib
 
_dib


	)

48 
	#gve
 
_dos_gve


	)

49 
	#tve
 
_dos_tve


	)

53 #i
defed
(
_MSC_VER
|| defed(
__WATCOMC__
) || \

54 
defed
(
__ZTC__
|| 
	$defed
(
__SC__
)

56 
	`Pkb
(

57 
g
,

58 
ofs
);

59 
	`Pkw
(

60 
g
,

61 
ofs
);

62 
	`Pokeb
(

63 
g
,

64 
ofs
,

65 
ch
);

66 
	`Pokew
(

67 
g
,

68 
ofs
,

69 
num
);

71 #i
	`defed
(
__TURBOC__
)

72 
	#Pkw
 
ek


	)

73 
	#Pokew
 
poke


	)

74 
	#Pkb
 
ekb


	)

75 
	#Pokeb
 
pokeb


	)

	@ports/dos/queue.c

19 
	~<dlib.h
>

21 
	~"queue.h
"

23 
QUEUE
 *
	$loc_queue
(

24 
size
)

26 
QUEUE
 *
tv
;

27 
tv
 = (
QUEUE
 *
	`mloc
((QUEUE+ (
size_t

size
);

28 i((
QUEUE
 *0 !
tv
) {

29 
tv
->
size
 = size;

30 
tv
->
hd
 = 0;

31 
tv
->

 = 0;

32 
tv
->
ava
 = 
size
;

33 
tv
->
bufr
 = ((*tv+ (
QUEUE
);

35  
tv
;

36 
	}
}

38 
	$_queue
(

39 
QUEUE
 * 
queue
,

40 
da
)

42 
tv
 = -1;

43 i(0 !
queue
->
ava
) {

44 *(
queue
->
bufr
 + queue->
hd

da
;

45 
queue
->
hd
 += 1;

46 i(
queue
->
hd
 =queue->
size
)

47 
queue
->
hd
 = 0;

48 
queue
->
ava
 -= 1;

49 
tv
 = 
queue
->
ava
;

51  
tv
;

52 
	}
}

54 
	$de_queue
(

55 
QUEUE
 * 
queue
)

57 
tv
 = -1;

58 i(
queue
->
ava
 !queue->
size
) {

59 
tv
 = *(
queue
->
bufr
 + queue->

);

60 
queue
->

 += 1;

61 i(
queue
->

 =queue->
size
)

62 
queue
->

 = 0;

63 
queue
->
ava
 += 1;

65  
tv
;

66 
	}
}

	@ports/dos/queue.h

19 #ide
QUEUE__H


20 
	#QUEUE__H


	)

25 
	msize
;

26 
	mhd
;

27 
	m
;

28 
	mava
;

29 *
	mbufr
;

30 } 
	tQUEUE
;

32 
	#queue_emy
(
queue
(queue)->
hd
 =(queue)->



	)

33 
	#queue_ava
(
queue
(queue)->
ava


	)

35 
QUEUE
 *
loc_queue
(

36 
size
);

37 
_queue
(

38 
QUEUE
 * 
queue_r
,

39 
da
);

40 
de_queue
(

41 
QUEUE
 * 
queue_r
);

	@ports/dos/rs485.c

30 
	~<ddef.h
>

31 
	~<dt.h
>

32 
	~<dbo.h
>

33 
	~<dlib.h
>

34 
	~<dio.h
>

35 
	~"tim.h
"

38 
	~<dos.h
>

39 
	~"rl.h
"

42 
	gRS485_Pt
 = '2';

44 
	gRS485_Baud
 = 38400;

55 
	#Ttuound
 (40UL)

	)

65 
	$RS485_Inlize
(

69 
	`OnComPt
(
RS485_Pt
);

71 
	`InComPt
("38400", '8', 'N', '1');

74 
	}
}

76 
	$RS485_C˪up
(

80 
	}
}

88 
ut32_t
 
	$RS485_G_Baud_Re
(

91  
RS485_Baud
;

92 
	}
}

100 
bo
 
	$RS485_S_Baud_Re
(

101 
ut32_t
 
baud
)

103 
bo
 
vid
 = 
ue
;

105 
baud
) {

112 
RS485_Baud
 = 
baud
;

116 
vid
 = 
l
;

120  
vid
;

121 
	}
}

129 
	$RS485_Tuound_Day
(

132 
ut16_t
 
tuound_time
;

137 
tuound_time
 = 1 + ((
Ttuound
 * 1000UL/ 
RS485_Baud
);

138 
	`Tim_S
(< 
tuound_time
) {

141 
	}
}

149 
	$RS485_Tnsmr_Eb
(

150 
bo
 
ab
)

152 (
ab
;

153 
	}
}

161 
	$RS485_Sd_Da
(

162 
ut8_t
 * 
bufr
,

163 
ut16_t
 
nbys
)

166 
	`ComSdDa
(
bufr
, 
nbys
);

167 !(
RS485_I
->
US_CSR
 & 
AT91C_US_TXRDY
)) {

171 
	`Tim_S_Ret
();

172 
	}
}

180 
bo
 
	$RS485_ReiveE
(

183 
bo
 
ReiveE
 = 
l
;

185 vީ
AT91PS_PIO
 
pPIO
 = 
AT91C_BASE_PIOA
;

188 i(
RS485_I
->
US_CSR
 & (
AT91C_US_OVRE
 | 
AT91C_US_FRAME
)) {

190 
RS485_I
->
US_CR
 = 
AT91C_US_RSTSTA
;

191 
ReiveE
 = 
ue
;

193 
pPIO
->
PIO_CODR
 = 
LED2
;

196  
ReiveE
;

197 
	}
}

205 
bo
 
	$RS485_DaAvaab
(

206 
ut8_t
 * 
DaRegi
)

208 
bo
 
DaAvaab
 = 
l
;

210 vީ
AT91PS_PIO
 
pPIO
 = 
AT91C_BASE_PIOA
;

212 i(
RS485_I
->
US_CSR
 & 
AT91C_US_RXRDY
) {

214 *
DaRegi
 = 
RS485_I
->
US_RHR
;

215 
DaAvaab
 = 
ue
;

217 
pPIO
->
PIO_CODR
 = 
LED2
;

220  
DaAvaab
;

221 
	}
}

223 #ifde
TEST_RS485


224 
	$ma
(

227 
i
 = 0;

228 
ut8_t
 
DaRegi
;

230 
	`RS485_S_Baud_Re
(38400);

231 
	`RS485_Inlize
();

234 i(
	`RS485_ReiveE
()) {

235 
	`rtf
(
dr
, "ERROR ");

236 } i(
	`RS485_DaAvaab
(&
DaRegi
)) {

237 
	`rtf
(
dr
, "%02X ", 
DaRegi
);

240 
	}
}

	@ports/dos/rs485.h

26 #ide
RS485_H


27 
	#RS485_H


	)

29 
	~<dt.h
>

31 #ifde
__lulus


35 
RS485_Inlize
(

38 
RS485_Tnsmr_Eb
(

39 
bo
 
ab
);

41 
RS485_Sd_Da
(

42 
ut8_t
 * 
bufr
,

43 
ut16_t
 
nbys
);

45 
bo
 
RS485_ReiveE
(

47 
bo
 
RS485_DaAvaab
(

48 
ut8_t
 * 
da
);

50 
RS485_Tuound_Day
(

52 
ut32_t
 
RS485_G_Baud_Re
(

54 
bo
 
RS485_S_Baud_Re
(

55 
ut32_t
 
baud
);

57 #ifde
__lulus


	@ports/dos/serial.c

28 
	~<dlib.h
>

29 
	~<dos.h
>

30 
	~<rg.h
>

31 
	~"rl.h
"

32 
	~"queue.h
"

34 
QUEUE
 *
	gSl_In_Queue
;

35 
QUEUE
 *
	gSl_Out_Queue
;

37 
OLD_COMM_PARAMS
 
	gd_comm_ms
;

38 
COMM_STATUS
 
	gcomm_us
;

41 
INTERRUPT
 
FAR
 * 
	gdve_rl
) (

45 
	gComBa
;

46 
	gIrqNum
;

48 
	$CloComPt
(

51 
us
;

55 
	`ou
(
ComBa
 + 
INT_EN
, () 0);

56 
	`ou
(
ComBa
 + 
MODEM_CNTRL
, (
d_comm_ms
.
modem
);

57 
us
 = 
	`p
(
ComBa
 + 
LINE_CNTRL
);

58 
	`ou
(
ComBa
 + 
LINE_CNTRL
, (
us
 | 0x80);

59 
	`ou
(
ComBa
 + 
BAUD_LSB
, (
d_comm_ms
.
baud_lsb
);

60 
	`ou
(
ComBa
 + 
BAUD_MSB
, (
d_comm_ms
.
baud_msb
);

61 
	`ou
(
ComBa
 + 
LINE_CNTRL
, (
d_comm_ms
.
le
);

62 
	`ou
(0x21, (
d_comm_ms
.
t_l
);

66 
	`tve
(
IrqNum
 + 8, 
dve_rl
);

70 
	`
(
Sl_In_Queue
);

71 
	`
(
Sl_Out_Queue
);

73 
	}
}

75 
	$OnComPt
(

76 
Pt
)

78 
us
;

79 
tv
 = -1;

83 
Sl_In_Queue
 = 
	`loc_queue
(
SInBufSize
);

84 i((
QUEUE
 *0 =
Sl_In_Queue
)

85  
tv
;

86 
Sl_Out_Queue
 = 
	`loc_queue
(
SOutBufSize
);

87 i((
QUEUE
 *0 =
Sl_Out_Queue
) {

88 
	`
(
Sl_In_Queue
);

89  
tv
;

91 
tv
 = 0;

95 
Pt
) {

97 
ComBa
 = 0x3F8;

98 
IrqNum
 = 4;

101 
ComBa
 = 0x2F8;

102 
IrqNum
 = 3;

105 
ComBa
 = 0x3E8;

106 
IrqNum
 = 4;

109 
ComBa
 = 0x2E8;

110 
IrqNum
 = 3;

113 
ComBa
 = 0x3F8;

114 
IrqNum
 = 4;

117 
d_comm_ms
.
t_ab
 = 
	`p
(
ComBa
 + 
INT_EN
);

118 
	`ou
(
ComBa
 + 
INT_EN
, 0);

122 
d_comm_ms
.
le
 = 
	`p
(
ComBa
 + 
LINE_CNTRL
);

123 
d_comm_ms
.
modem
 = 
	`p
(
ComBa
 + 
MODEM_CNTRL
);

124 
us
 = 
	`p
(
ComBa
 + 
LINE_CNTRL
);

125 
	`ou
(
ComBa
 + 
LINE_CNTRL
, (
us
 | 0x80);

126 
d_comm_ms
.
baud_lsb
 = 
	`p
(
ComBa
 + 
BAUD_LSB
);

127 
d_comm_ms
.
baud_msb
 = 
	`p
(
ComBa
 + 
BAUD_MSB
);

128 
us
 = 
	`p
(
ComBa
 + 
LINE_CNTRL
);

129 
	`ou
(
ComBa
 + 
LINE_CNTRL
, (
us
 | 0x7F);

130 
us
 = 
OUT2
 | 
DTR
;

131 
	`ou
(
ComBa
 + 
MODEM_CNTRL
, (
us
);

135 
dve_rl
 = ((
INTERRUPT
 
FAR
 *()
	`gve
(
IrqNum
 + 8);

139 
	`tve
(
IrqNum
 + 8, 
rl
);

143 
d_comm_ms
.
t_l
 = 
	`p
(0x21);

144 
us
 = (1 << 
IrqNum
);

145 
us
 = ~status;

149 
	`ou
(0x21,

150 (
d_comm_ms
.
t_l
 & (
us
);

152 
	`ex
(
CloComPt
);

154  
tv
;

155 
	}
}

157 
	$InComPt
(

158 
Baud
[],

159 
Dabs
,

160 
Py
,

161 
Stbs
)

163 
us
;

164 
divis
;

165 
baud
;

169 
us
 = 
	`p
(
ComBa
 + 
LINE_CNTRL
);

170 
	`ou
(
ComBa
 + 
LINE_CNTRL
, (
us
 | 0x80);

171 
baud
 = 
	`
(
Baud
);

172 i(
baud
 == 0)

173 
baud
 = 2400L;

174 
divis
 = ((115200L / 
baud
);

175 
	`ou
(
ComBa
 + 
BAUD_LSB
, ((
divis
 & 0x00FF));

176 
	`ou
(
ComBa
 + 
BAUD_MSB
, (((
divis
 >> 8) & 0x00FF));

177 
us
 = 0x00;

181 
Py
) {

184 
us
 = 0x08;

189 
us
 = 0x18;

194 
us
 = 0x28;

200 
us
 = 0x00;

205 
Dabs
) {

210 
us
 = status | 0x01;

214 
us
 = status | 0x02;

219 
us
 = status | 0x03;

224 
Stbs
) {

226 
us
 = status | 0x04;

233 
	`ou
(
ComBa
 + 
LINE_CNTRL
, (
us
);

234 
us
 = 
OUT2
 | 
DTR
;

235 
	`ou
(
ComBa
 + 
MODEM_CNTRL
, (
us
);

239 
	`ou
(
ComBa
 + 
INT_EN
, 
RX_INT
 | 
ERR_INT
 | 
RS_INT
);

241 
	}
}

243 
	$DrD
(

246 
us
;

248 
us
 = 
	`p
(
ComBa
 + 
MODEM_CNTRL
);

249 
us
 &= 0xFE;

250 
	`ou
(
ComBa
 + 
MODEM_CNTRL
, (
us
);

252 
	}
}

254 
	$RaiD
(

257 
us
;

259 
us
 = 
	`p
(
ComBa
 + 
MODEM_CNTRL
);

260 
us
 |= 0x01;

261 
	`ou
(
ComBa
 + 
MODEM_CNTRL
, (
us
);

263 
	}
}

265 
	$ComRecCh
(

268  
	`de_queue
(
Sl_In_Queue
);

269 
	}
}

271 
	$ComSdSg
(

272 *
rg
)

274 
tv
;

275 *
por
;

276 
por
 = 
rg
;

278 *
por
) {

279 
tv
 = 
	`_queue
(
Sl_Out_Queue
, *
por
);

280 
por
++;

282 i(0x0 =(
comm_us
.
modem
 & 0x40))

283 
	`RaiD
();

284 
	`ou
(
ComBa
 + 
INT_EN
, 
RX_INT
 | 
TBE_INT
 | 
ERR_INT
 | 
RS_INT
);

285  
tv
;

286 
	}
}

288 
	$ComSdDa
(

289 *
bufr
,

290 
bufr_ngth
)

292 
tv
;

293 *
por
;

294 
por
 = 
bufr
;

295 
i
;

297 
i
 = 0; i < 
bufr_ngth
; i++) {

298 
tv
 = 
	`_queue
(
Sl_Out_Queue
, *
por
);

299 
por
++;

301 i(0x0 =(
comm_us
.
modem
 & 0x40))

302 
	`RaiD
();

303 
	`ou
(
ComBa
 + 
INT_EN
, 
RX_INT
 | 
TBE_INT
 | 
ERR_INT
 | 
RS_INT
);

304  
tv
;

305 
	}
}

307 
	$ComSdCh
(

308 
cha
)

310 
tv
;

314 i(0x0 =(
comm_us
.
modem
 & 0x40))

315 
	`RaiD
();

316 
tv
 = 
	`_queue
(
Sl_Out_Queue
, 
cha
);

317 i(-1 !
tv
)

318 
	`ou
(
ComBa
 + 
INT_EN
, 
RX_INT
 | 
TBE_INT
 | 
ERR_INT
 | 
RS_INT
);

319  
tv
;

320 
	}
}

322 
	$ComStus
(

325 
us
;

326 
tv
;

328 
tv
 = 
	`p
(
ComBa
 + 
LINE_STATUS
);

329 
tv
 =etval << 8;

330 
us
 = 
	`p
(
ComBa
 + 
MODEM_STATUS
);

331 
tv
 =v | 
us
;

332 i(
	`queue_emy
(
Sl_In_Queue
))

333 
tv
 &= 0xFEFF;

335 
tv
 |= 0x0100;

336  (
tv
;

337 
	}
}

339 
INTERRUPT
 
FAR
 
	$rl
(

342 
mp
;

344 
	`dib
();

346 
comm_us
.
u
 = 
	`p
(
ComBa
 + 
INT_ID
);

347 
comm_us
.
u
 &= 0x0f;

348 
comm_us
.
u
) {

350 
comm_us
.
modem
 = 
	`p
(
ComBa
 + 
MODEM_STATUS
);

354 i(
	`queue_emy
(
Sl_Out_Queue
))

355 
	`ou
(
ComBa
 + 
INT_EN
, 
RX_INT
 | 
ERR_INT
 | 
RS_INT
);

357 
mp
 = 
	`de_queue
(
Sl_Out_Queue
);

358 i(-1 !
mp
)

359 
	`ou
(
ComBa
 + 
XMIT
, 
mp
);

364 
	`_queue
(
Sl_In_Queue
, (
	`p
(
ComBa
 + 
REC
));

368 
comm_us
.
le
 = 
	`p
(
ComBa
 + 
LINE_STATUS
);

369 (
	`p
(
ComBa
 + 
REC
);

370 
	`_queue
(
Sl_In_Queue
, '!');

374 
comm_us
.
modem
 = 
	`p
(
ComBa
 + 
MODEM_STATUS
);

375 
	`ou
(0x20, 0x20);

376 
	`ab
();

380 
	}
}

	@ports/dos/serial.h

21 #ide
SERIAL__H


22 
	#SERIAL__H


	)

24 
	~"extkwd.h
"

25 
	~"pchwio.h
"

27 
	#SInBufSize
 4096

	)

28 
	#SOutBufSize
 512

	)

32 
	#REC
 0

	)

33 
	#XMIT
 0

	)

34 
	#INT_EN
 1

	)

35 
	#INT_ID
 2

	)

36 
	#LINE_CNTRL
 3

	)

37 
	#MODEM_CNTRL
 4

	)

38 
	#LINE_STATUS
 5

	)

39 
	#MODEM_STATUS
 6

	)

40 
	#BAUD_LSB
 0

	)

41 
	#BAUD_MSB
 1

	)

43 
	#NONE
 0

	)

44 
	#HDW
 1

	)

45 
	#XON
 2

	)

49 
	#RX_INT
 0x01

	)

50 
	#TBE_INT
 0x02

	)

51 
	#ERR_INT
 0x04

	)

52 
	#RS_INT
 0x08

	)

56 
	#OUT2
 0x08

	)

57 
	#DTR
 0x01

	)

58 
	#RTS
 0x02

	)

59 
	#CTS
 0x10

	)

60 
	#DSR
 0x20

	)

61 
	#XMTRDY
 0x20

	)

62 
	#TXR
 0

	)

64 #i!
defed
 
TRUE


65 
	#FALSE
 0

	)

66 
	#TRUE
 !
FALSE


	)

70 
INTERRUPT
 
FAR
 * 
dve_rl
) (

73 
ComBa
;

74 
IrqNum
;

77 
t_ab
;

78 
le
;

79 
modem
;

80 
baud_lsb
;

81 
baud_msb
;

82 
t_l
;

83 } 
	tOLD_COMM_PARAMS
;

84 
OLD_COMM_PARAMS
 
d_comm_ms
;

87 
le
;

88 
modem
;

89 
u
;

90 
hdshake
;

91 } 
	tCOMM_STATUS
;

92 
COMM_STATUS
 
comm_us
;

94 
	`OnComPt
(

95 
Pt
);

96 
	`InComPt
(

97 
Baud
[],

98 
Dabs
,

99 
Py
,

100 
St
);

101 
	`CloComPt
(

103 
	`DrD
(

105 
	`RaiD
(

107 
	`ComRecCh
(

110 
	`ComSdCh
(

111 
cha
);

112 
	`ComSdSg
(

113 *
rg
);

114 
	`ComSdDa
(

115 *
bufr
,

116 
bufr_ngth
);

117 
	`ComStus
(

119 
INTERRUPT
 
FAR
 
	`rl
(

	@ports/dos/stdbool.h

1 #ide
_STDBOOL_H


2 
	#_STDBOOL_H


	)

6 #i!
defed
(
__lulus
)

8 #i!
defed
(
__GNUC__
)

10 um { 
	m_Bo_mu_ome_to_t
 = -1, 
	ml
 = 0, 
	mue
 = 1 } 
	t_Bo
;

13 
	#bo
 
_Bo


	)

14 
	#ue
 1

	)

15 
	#l
 0

	)

16 
	#__bo_ue_l_e_defed
 1

	)

	@ports/dos/stdint.h

4 #ide
_STDINT_H


5 
	#_STDINT_H


	)

7 
	~<ddef.h
>

9 
	tut8_t
;

10 sigd 
	tt8_t
;

11 
	tut16_t
;

12 sigd 
	tt16_t
;

14 
	tut32_t
;

15 sigd 
	tt32_t
;

19 
	#INT8_MIN
 (-128)

	)

20 
	#INT16_MIN
 (-32768)

	)

21 
	#INT32_MIN
 (-2147483647 - 1)

	)

23 
	#INT8_MAX
 127

	)

24 
	#INT16_MAX
 32767

	)

25 
	#INT32_MAX
 2147483647

	)

27 
	#UINT8_MAX
 0xf

	)

28 
	#UINT16_MAX
 0xfff

	)

29 
	#UINT32_MAX
 0xfffffff

	)

	@ports/dos/timer.c

25 
	~<dt.h
>

26 
	~<dio.h
>

27 
	~<dos.h
>

30 vީ
	gTim_Mlicds
;

32 vީ
	gSTime
;

34 vީ
	gTim_Mlicds
;

36 
	#RTC_CMD_ADDR
 0x70

	)

37 
	#RTC_DAT_ADDR
 0x71

	)

39 
ut8_t
 
	$RTC_RS_Cvt
(

40 
ut16_t
 
htz
)

42 
ut8_t
 
RS
 = 0;

66 
htz
) {

68 
RS
 = 3;

71 
RS
 = 4;

74 
RS
 = 5;

77 
RS
 = 6;

80 
RS
 = 7;

83 
RS
 = 8;

86 
RS
 = 9;

89 
RS
 = 10;

92 
RS
 = 11;

95 
RS
 = 12;

98 
RS
 = 13;

101 
RS
 = 14;

104 
RS
 = 15;

110  
RS
;

111 
	}
}

115 
	#INT_FREQ
 8192

	)

117 
u
 
	$Tim_Iru_Hdr
(

120 
ut16_t
 
Tim_Ticks
 = 0;

121 
ut16_t
 
Epd_Mlicds
 = 0;

122 
ut16_t
 
mlicds
 = 0;

123 
ut16_t
 
diff
 = 0;

124 
ut8_t
 
mp_g
;

126 
Tim_Ticks
++;

127 
mlicds
 = (
Tim_Ticks
 * 1000/ 
INT_FREQ
;

128 
diff
 = 
mlicds
 - 
Epd_Mlicds
;

129 i(
diff
 >= 1) {

130 
Epd_Mlicds
 = 
mlicds
;

131 
Tim_Mlicds
++;

132 i(
STime
 < 60000)

133 
STime
++;

136 i(
Tim_Ticks
 >
INT_FREQ
) {

137 
Tim_Ticks
 = 0;

138 
Epd_Mlicds
 = 0;

142 
	`outb
(
RTC_CMD_ADDR
, 0x0C);

143 
mp_g
 = 
	`ptb
(
RTC_DAT_ADDR
);

145 
	`outb
(0xA0, 0x20);

147 
	`outb
(0x20, 0x20);

148 
	}
}

151 
u
(

152 *
OldVe
) (

155 
	$Tim_C˪up
(

158 
	`tve
(0x70, 
OldVe
);

159 
	}
}

161 
	$Tim_In
(

164 
ut8_t
 
RC
 = 
	`RTC_RS_Cvt
(
INT_FREQ
);

167 
OldVe
 = 
	`gve
(0x70);

169 
	`dib
();

171 
	`tve
(0x70, 
Tim_Iru_Hdr
);

173 
	`outb
(
RTC_CMD_ADDR
, 0x0B);

174 
	`outb
(
RTC_DAT_ADDR
, 0x42);

176 
	`outb
(
RTC_CMD_ADDR
, 0x0A);

177 
	`outb
(
RTC_DAT_ADDR
, (0x20 | (
RC
 & 0x0F)));

179 
	`ab
();

180 
	`ex
(
Tim_C˪up
);

181 
	}
}

183 
	$Tim_S
(

186 
ut16_t
 
time_vue
;

188 
	`dib
();

189 
time_vue
 = 
STime
;

190 
	`ab
();

192  
time_vue
;

193 
	}
}

195 
	$Tim_S_Ret
(

198 
	`dib
();

199 
STime
 = 0;

200 
	`ab
();

201 
	}
}

	@ports/dos/timer.h

26 #ide
TIMER_H


27 
	#TIMER_H


	)

29 
	~<dt.h
>

31 vީ
Tim_Mlicds
;

33 #ifde
__lulus


37 
Tim_In
(

39 
Tim_S
(

41 
Tim_S_Ret
(

44 #ifde
__lulus


	@ports/linux/arcnet.c

35 
	~<dt.h
>

36 
	~"bacdef.h
"

37 
	~"du.h
"

38 
	~".h
"

39 
	~"t.h
"

44 
ut8_t
 
	gARCNET_MAC_Addss
 = 0;

46 
	gARCNET_Sock_FD
 = -1;

48 
sockaddr
 
	gARCNET_Sock_Addss
;

50 
	#ARCNET_BROADCAST
 0

	)

85 
bo
 
	$_vid
(

88  (
ARCNET_Sock_FD
 >= 0);

89 
	}
}

91 
	$_nup
(

94 i(
	`_vid
())

95 
	`o
(
ARCNET_Sock_FD
);

96 
ARCNET_Sock_FD
 = -1;

99 
	}
}

101 
	$_bd
(

102 *
r_me
)

104 
sock_fd
 = -1;

105 
ieq
 
i
;

106 
rv
;

107 
uid
 = 0;

110 
uid
 = 
	`guid
();

111 i(
uid
 != 0) {

112 
	`rtf
(
dr
,

115  
sock_fd
;

117 
	`rtf
(
dr
, ": ong \"%s\"\n", 
r_me
);

122 i((
sock_fd
 = 
	`sock
(
PF_PACKET
, 
SOCK_PACKET
, 
	`hts
(
ETH_P_ALL
))) < 0) {

124 
	`rtf
(
dr
, ": E ong sock: %s\n", 
	`
(
o
));

125 
	`rtf
(
dr
,

131 
	`ex
(-1);

134 i(
ARCNET_Sock_FD
 >= 0) {

136 
ARCNET_Sock_Addss
.
_my
 = 
ARPHRD_ARCNET
;

139 
	`memt
(
ARCNET_Sock_Addss
.
_da
, '\0',

140 (
ARCNET_Sock_Addss
.
_da
));

142 
	`y
(
ARCNET_Sock_Addss
.
_da
, 
r_me
,

143 (
ARCNET_Sock_Addss
.
_da
) - 1);

144 
	`rtf
(
dr
, "arcnet: binding \"%s\"\n",

145 
ARCNET_Sock_Addss
.
_da
);

146 i(
	`bd
(
sock_fd
, &
ARCNET_Sock_Addss
,

147 (
ARCNET_Sock_Addss
)) != 0) {

149 
	`rtf
(
dr
, "arcnet: Unableo bind socket : %s\n",

150 
	`
(
o
));

151 
	`rtf
(
dr
,

158 
	`o
(
sock_fd
);

159 
	`ex
(-1);

162 
	`y
(
i
.
i_me
, 
r_me
, (ifr.ifr_name));

163 
rv
 = 
	`iol
(
sock_fd
, 
SIOCGIFHWADDR
, &
i
);

164 i(
rv
 != -1)

165 
ARCNET_MAC_Addss
 = 
i
.
i_hwaddr
.
_da
[0];

167 
ARCNET_Sock_Addss
.
_my
 = 
ARPHRD_ARCNET
;

170 
	`memt
(
ARCNET_Sock_Addss
.
_da
, '\0',

171 (
ARCNET_Sock_Addss
.
_da
));

173 
	`y
(
ARCNET_Sock_Addss
.
_da
, 
r_me
,

174 (
ARCNET_Sock_Addss
.
_da
) - 1);

175 
	`rtf
(
dr
, ": MAC=%02Xh i=\"%s\"\n", 
ARCNET_MAC_Addss
,

176 
ARCNET_Sock_Addss
.
_da
);

178 
	`ex
(
_nup
);

180  
sock_fd
;

181 
	}
}

183 
bo
 
	$_
(

184 *
r_me
)

186 i(
r_me
)

187 
ARCNET_Sock_FD
 = 
	`_bd
(
r_me
);

189 
ARCNET_Sock_FD
 = 
	`_bd
("arc0");

191  
	`_vid
();

192 
	}
}

196 
	$_nd_pdu
(

197 
BACNET_ADDRESS
 * 
de
,

198 
BACNET_NPDU_DATA
 * 
du_da
,

199 
ut8_t
 * 
pdu
,

200 
pdu_n
)

202 
BACNET_ADDRESS
 
c
 = { 0 };

203 
bys
 = 0;

204 
ut8_t
 
mtu
[512] = { 0 };

205 
mtu_n
 = 0;

206 
chdr
 *
pkt
 = (chd*
mtu
;

208 (
du_da
;

209 
c
.
mac
[0] = 
ARCNET_MAC_Addss
;

210 
c
.
mac_n
 = 1;

213 i(
ARCNET_Sock_FD
 < 0) {

214 
	`rtf
(
dr
, "arcnet: socket is invalid!\n");

218 i(
de
->
mac_n
 == 1)

219 
pkt
->
hd
.
de
 = de->
mac
[0];

221 
	`rtf
(
dr
, "arcnet: invalid destination MACddress!\n");

224 i(
c
.
mac_n
 == 1)

225 
pkt
->
hd
.
sour
 = 
c
.
mac
[0];

227 
	`rtf
(
dr
, "arcnet: invalid source MACddress!\n");

231 
pkt
->
so
.
w
[0] = 0xCD;

232 
pkt
->
so
.
w
[1] = 0x82;

233 
pkt
->
so
.
w
[2] = 0x82;

234 
pkt
->
so
.
w
[3] = 0x03;

236 
mtu_n
 = 
ARC_HDR_SIZE
 + 4 + 
pdu_n
;

237 i(
mtu_n
 > 512) {

238 
	`rtf
(
dr
, "arcnet: PDU isoo bigo send!\n");

241 
	`memy
(&
pkt
->
so
.
w
[4], 
pdu
, 
pdu_n
);

243 
bys
 =

244 
	`ndto
(
ARCNET_Sock_FD
, &
mtu
, 
mtu_n
, 0,

245 (
sockaddr
 *&
ARCNET_Sock_Addss
,

246 (
ARCNET_Sock_Addss
));

248 i(
bys
 < 0)

249 
	`rtf
(
dr
, ": E sdgack: %s\n", 
	`
(
o
));

251  
bys
;

252 
	}
}

256 
ut16_t
 
	$_ive
(

257 
BACNET_ADDRESS
 * 
c
,

258 
ut8_t
 * 
pdu
,

259 
ut16_t
 
max_pdu
,

260 
timeout
)

262 
ived_bys
;

263 
ut8_t
 
buf
[512] = { 0 };

264 
ut16_t
 
pdu_n
 = 0;

265 
fd_t
 
ad_fds
;

266 
max
;

267 
timev
 
_timeout
;

268 
chdr
 *
pkt
 = (chd*
buf
;

271 i(
ARCNET_Sock_FD
 <= 0)

277 i(
timeout
 >= 1000) {

278 
_timeout
.
tv_c
 = 
timeout
 / 1000;

279 
_timeout
.
tv_uc
 =

280 1000 * (
timeout
 - 
_timeout
.
tv_c
 * 1000);

282 
_timeout
.
tv_c
 = 0;

283 
_timeout
.
tv_uc
 = 1000 * 
timeout
;

285 
	`FD_ZERO
(&
ad_fds
);

286 
	`FD_SET
(
ARCNET_Sock_FD
, &
ad_fds
);

287 
max
 = 
ARCNET_Sock_FD
;

289 i(
	`
(
max
 + 1, &
ad_fds
, 
NULL
, NULL, &
_timeout
) > 0)

290 
ived_bys
 = 
	`ad
(
ARCNET_Sock_FD
, &
buf
[0], (buf));

295 i(
ived_bys
 < 0) {

299 i(
o
 !
EAGAIN
)

300 
	`rtf
(
dr
, "ethernet: Readrror ineceivingacket: %s\n",

301 
	`
(
o
));

305 i(
ived_bys
 == 0)

314 i(
pkt
->
hd
.
sour
 =
ARCNET_MAC_Addss
) {

315 
	`rtf
(
dr
, "arcnet: self sentacket?\n");

318 i(
pkt
->
so
.
w
[0] != 0xCD) {

322 i((
pkt
->
hd
.
de
 !
ARCNET_MAC_Addss
) &&

323 (
pkt
->
hd
.
de
 !
ARCNET_BROADCAST
)) {

324 
	`rtf
(
dr
, "arcnet: Thisacket isot for us.\n");

327 i((
pkt
->
so
.
w
[1] != 0x82) ||

328 (
pkt
->
so
.
w
[2] != 0x82) ||

329 (
pkt
->
so
.
w
[3] != 0x03)) {

330 
	`rtf
(
dr
, "arcnet: BACnetacket has invalid LLC.\n");

334 i((
pkt
->
hd
.
de
 !
ARCNET_MAC_Addss
) &&

335 (
pkt
->
hd
.
de
 !
ARCNET_BROADCAST
)) {

336 
	`rtf
(
dr
, "arcnet: Thisacket isot for us.\n");

340 
c
->
mac_n
 = 1;

341 
c
->
mac
[0] = 
pkt
->
hd
.
sour
;

343 
pdu_n
 = 
ived_bys
 - 
ARC_HDR_SIZE
;

344 
pdu_n
 -= 4 ;

346 i(
pdu_n
 < 
max_pdu
)

347 
	`memmove
(&
pdu
[0], &
pkt
->
so
.
w
[4], 
pdu_n
);

350 
pdu_n
 = 0;

352  
pdu_n
;

353 
	}
}

355 
	$_g_my_addss
(

356 
BACNET_ADDRESS
 * 
my_addss
)

358 
i
 = 0;

360 
my_addss
->
mac_n
 = 1;

361 
my_addss
->
mac
[0] = 
ARCNET_MAC_Addss
;

362 
my_addss
->
t
 = 0;

363 
my_addss
->
n
 = 0;

364 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

365 
my_addss
->
adr
[
i
] = 0;

369 
	}
}

371 
	$_g_brd_addss
(

372 
BACNET_ADDRESS
 * 
de
)

374 
i
 = 0;

376 i(
de
) {

377 
de
->
mac
[0] = 
ARCNET_BROADCAST
;

378 
de
->
mac_n
 = 1;

379 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

380 
de
->
n
 = 0;

381 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

382 
de
->
adr
[
i
] = 0;

387 
	}
}

	@ports/linux/bip-init.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~"bacdcode.h
"

38 
	~"b.h
"

39 
	~"t.h
"

43 
bo
 
	gBIP_Debug
 = 
l
;

50 
	$b_gaddrbyme
(

51 cڡ *
ho_me
)

53 
hot
 *
ho_t
;

55 i((
ho_t
 = 
	`ghobyme
(
ho_me
)=
NULL
)

58  *(*
ho_t
->
h_addr
;

59 
	}
}

61 
	$g_lol_i_iol
(

62 *
iame
,

63 
ieq
 *
i
,

64 
que
)

66 
fd
;

67 
rv
;

69 
	`y
(
i
->
i_me
, 
iame
, (ifr->ifr_name));

70 
fd
 = 
	`sock
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_IP
);

71 i(
fd
 < 0) {

72 
rv
 = 
fd
;

74 
rv
 = 
	`iol
(
fd
, 
que
, 
i
);

75 
	`o
(
fd
);

78  
rv
;

79 
	}
}

82 
g_lol_addss_iol
(

83 *
iame
,

84 
_addr
 *
addr
,

85 
que
);

87 
	$g_lol_addss_iol
(

88 *
iame
,

89 
_addr
 *
addr
,

90 
que
)

92 
ieq
 
i
 = { {{0}} };

93 
sockaddr_
 *
t_addss
;

94 
rv
;

96 
rv
 = 
	`g_lol_i_iol
(
iame
, &
i
, 
que
);

97 i(
rv
 >= 0) {

98 
t_addss
 = (
sockaddr_
 *&
i
.
i_addr
;

99 
	`memy
(
addr
, &
t_addss
->
s_addr
, (
_addr
));

102  
rv
;

103 
	}
}

111 
	$b_t_r
(

112 *
iame
)

114 
_addr
 
lol_addss
;

115 
_addr
 
brd_addss
;

116 
_addr
 
tmask
;

117 
rv
 = 0;

120 
rv
 = 
	`g_lol_addss_iol
(
iame
, &
lol_addss
, 
SIOCGIFADDR
);

121 i(
rv
 < 0) {

122 
lol_addss
.
s_addr
 = 0;

124 
	`b_t_addr
(
lol_addss
.
s_addr
);

125 i(
BIP_Debug
) {

126 
	`rtf
(
dr
, "I: %s\n", 
iame
);

127 
	`rtf
(
dr
, "IP Addss: %s\n", 
	`_
(
lol_addss
));

130 
rv
 = 
	`g_lol_addss_iol
(
iame
, &
tmask
, 
SIOCGIFNETMASK
);

132 i(
rv
 < 0) {

133 
brd_addss
.
s_addr
 = ~0;

136 
brd_addss
 = 
lol_addss
;

137 
brd_addss
.
s_addr
 |(~
tmask
.s_addr);

139 
	`b_t_brd_addr
(
brd_addss
.
s_addr
);

140 i(
BIP_Debug
) {

141 
	`rtf
(
dr
, "IP Broadcast Address: %s\n",

142 
	`_
(
brd_addss
));

143 
	`rtf
(
dr
, "UDP Pt: 0x%04X [%hu]\n", 
	`ohs
(
	`b_g_pt
()),

144 
	`ohs
(
	`b_g_pt
()));

146 
	}
}

165 
bo
 
	$b_
(

166 *
iame
)

168 
us
 = 0;

169 
sockaddr_
 
s
;

170 
sockt
 = 0;

171 
sock_fd
 = -1;

173 i(
iame
)

174 
	`b_t_r
(
iame
);

176 
	`b_t_r
("eth0");

178 
sock_fd
 = 
	`sock
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_UDP
);

179 
	`b_t_sock
(
sock_fd
);

180 i(
sock_fd
 < 0)

181  
l
;

184 
sockt
 = 1;

185 
us
 =

186 
	`tsockt
(
sock_fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
sockt
,

187 (
sockt
));

188 i(
us
 < 0) {

189 
	`o
(
sock_fd
);

190 
	`b_t_sock
(-1);

191  
us
;

194 
us
 =

195 
	`tsockt
(
sock_fd
, 
SOL_SOCKET
, 
SO_BROADCAST
, &
sockt
,

196 (
sockt
));

197 i(
us
 < 0) {

198 
	`o
(
sock_fd
);

199 
	`b_t_sock
(-1);

200  
l
;

203 
s
.
s_my
 = 
AF_INET
;

204 
s
.
s_addr
.
s_addr
 = 
	`htl
(
INADDR_ANY
);

205 
s
.
s_pt
 = 
	`b_g_pt
();

206 
	`memt
(&(
s
.
s_zo
), '\0', (sin.sin_zero));

207 
us
 =

208 
	`bd
(
sock_fd
, (cڡ 
sockaddr
 *&
s
, (sockaddr));

209 i(
us
 < 0) {

210 
	`o
(
sock_fd
);

211 
	`b_t_sock
(-1);

212  
l
;

215  
ue
;

216 
	}
}

221 
	$b_nup
(

224 
sock_fd
 = 0;

226 i(
	`b_vid
()) {

227 
sock_fd
 = 
	`b_sock
();

228 
	`o
(
sock_fd
);

230 
	`b_t_sock
(-1);

233 
	}
}

239 
	$b_g_lol_tmask
(

240 
_addr
 *
tmask
)

242 
rv
;

243 *
iame
 = 
	`gv
("BACNET_IFACE");

244 i(
iame
 =
NULL
)

245 
iame
 = "eth0";

246 
rv
 = 
	`g_lol_addss_iol
(
iame
, 
tmask
, 
SIOCGIFNETMASK
);

247  
rv
;

248 
	}
}

	@ports/linux/bip6.c

35 
	~<dio.h
>

36 
	~<dlib.h
>

37 
	~<dt.h
>

38 
	~<dbo.h
>

39 
	~<iddrs.h
>

40 
	~"bacdcode.h
"

41 
	~"cfig.h
"

42 
	~"b6.h
"

43 
	~"debug.h
"

44 
	~"devi.h
"

45 
	~"t.h
"

47 
	$debug_t_v6
(cڡ *
r
, cڡ 
6_addr
 * 
addr
) {

48 
	`debug_tf
( "BIP6: %s %02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x\n",

49 
r
,

50 ()
addr
->
s6_addr
[0], ()addr->s6_addr[1],

51 ()
addr
->
s6_addr
[2], ()addr->s6_addr[3],

52 ()
addr
->
s6_addr
[4], ()addr->s6_addr[5],

53 ()
addr
->
s6_addr
[6], ()addr->s6_addr[7],

54 ()
addr
->
s6_addr
[8], ()addr->s6_addr[9],

55 ()
addr
->
s6_addr
[10], ()addr->s6_addr[11],

56 ()
addr
->
s6_addr
[12], ()addr->s6_addr[13],

57 ()
addr
->
s6_addr
[14], ()addr->s6_addr[15]);

58 
	}
}

63 
	gBIP6_Sock
 = -1;

65 
BACNET_IP6_ADDRESS
 
	gBIP6_Addr
;

66 
BACNET_IP6_ADDRESS
 
	gBIP6_Brd_Addr
;

73 
	$b6_t_r
(

74 *
iame
)

76 
iddrs
 *
i
, *
i_tmp
;

77 
sockaddr_6
 *
s
;

78 
bo
 
found
 = 
l
;

80 i(
	`giddrs
(&
i
) == -1) {

81 
	`
("BIP6: getifaddrs failed");

82 
	`ex
(1);

84 
i_tmp
 = 
i
;

85 
	`debug_tf
("BIP6: skg i: %s\n", 
iame
);

86 
i_tmp
) {

87 i((
i_tmp
->
i_addr
) &&

88 (
i_tmp
->
i_addr
->
_my
 =
AF_INET6
)) {

89 
	`debug_tf
("BIP6: found i: %s\n", 
i_tmp
->
i_me
);

91 i((
i_tmp
->
i_addr
) &&

92 (
i_tmp
->
i_addr
->
_my
 =
AF_INET6
) &&

93 (
	`rcmp
(
i_tmp
->
i_me
,
iame
) == 0)) {

94 
s
 = (
sockaddr_6
*
i_tmp
->
i_addr
;

95 
	`bvlc6_addss_t
(&
BIP6_Addr
,

96 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[0]),

97 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[1]),

98 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[2]),

99 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[3]),

100 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[4]),

101 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[5]),

102 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[6]),

103 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[7]));

104 
	`debug_t_v6
(
iame
, (&
s
->
s6_addr
));

105 
found
 = 
ue
;

108 
i_tmp
 = i_tmp->
i_xt
;

110 i(!
found
) {

111 
	`debug_tf
("BIP6: ubˁأr: %s\n", 
iame
);

112 
	`ex
(1);

114 
	}
}

121 
	$b6_t_pt
(

122 
ut16_t
 
pt
)

124 
BIP6_Addr
.
pt
 =ort;

125 
BIP6_Brd_Addr
.
pt
 =ort;

126 
	}
}

133 
ut16_t
 
	$b6_g_pt
(

136  
BIP6_Addr
.
pt
;

137 
	}
}

145 
	$b6_g_brd_addss
(

146 
BACNET_ADDRESS
 * 
addr
)

148 i(
addr
) {

149 
addr
->
t
 = 
BACNET_BROADCAST_NETWORK
;

150 
addr
->
mac_n
 = 0;

151 
addr
->
n
 = 0;

153 
	}
}

160 
	$b6_g_my_addss
(

161 
BACNET_ADDRESS
 * 
addr
)

163 
ut32_t
 
devi_id
 = 0;

165 i(
addr
) {

166 
devi_id
 = 
	`Devi_Obje_In_Numb
();

167 
	`bvlc6_vmac_addss_t
(
addr
, 
devi_id
);

169 
	}
}

176 
bo
 
	$b6_t_addr
(

177 
BACNET_IP6_ADDRESS
 *
addr
)

179  
	`bvlc6_addss_cy
(&
BIP6_Addr
, 
addr
);

180 
	}
}

189 
bo
 
	$b6_g_addr
(

190 
BACNET_IP6_ADDRESS
 *
addr
)

192  
	`bvlc6_addss_cy
(
addr
, &
BIP6_Addr
);

193 
	}
}

202 
bo
 
	$b6_addss_mch_lf
(

203 
BACNET_IP6_ADDRESS
 *
addr
)

205  !
	`bvlc6_addss_dif
(
addr
, &
BIP6_Addr
);

206 
	}
}

213 
bo
 
	$b6_t_brd_addr
(

214 
BACNET_IP6_ADDRESS
 *
addr
)

216  
	`bvlc6_addss_cy
(&
BIP6_Brd_Addr
, 
addr
);

217 
	}
}

224 
bo
 
	$b6_g_brd_addr
(

225 
BACNET_IP6_ADDRESS
 *
addr
)

227  
	`bvlc6_addss_cy
(
addr
, &
BIP6_Brd_Addr
);

228 
	}
}

241 
	$b6_nd_mpdu
(

242 
BACNET_IP6_ADDRESS
 *
de
,

243 
ut8_t
 * 
mtu
,

244 
ut16_t
 
mtu_n
)

246 
sockaddr_6
 
bvlc_de
 = { 0 };

247 
ut16_t
 
addr16
[8];

250 i(
BIP6_Sock
 < 0) {

254 
bvlc_de
.
s6_my
 = 
AF_INET6
;

255 
	`bvlc6_addss_g
(
de
, &
addr16
[0], &addr16[1], &addr16[2], &addr16[3],

256 &
addr16
[4], &addr16[5], &addr16[6], &addr16[7]);

257 
bvlc_de
.
s6_addr
.
s6_addr16
[0] = 
	`hts
(
addr16
[0]);

258 
bvlc_de
.
s6_addr
.
s6_addr16
[1] = 
	`hts
(
addr16
[1]);

259 
bvlc_de
.
s6_addr
.
s6_addr16
[2] = 
	`hts
(
addr16
[2]);

260 
bvlc_de
.
s6_addr
.
s6_addr16
[3] = 
	`hts
(
addr16
[3]);

261 
bvlc_de
.
s6_addr
.
s6_addr16
[4] = 
	`hts
(
addr16
[4]);

262 
bvlc_de
.
s6_addr
.
s6_addr16
[5] = 
	`hts
(
addr16
[5]);

263 
bvlc_de
.
s6_addr
.
s6_addr16
[6] = 
	`hts
(
addr16
[6]);

264 
bvlc_de
.
s6_addr
.
s6_addr16
[7] = 
	`hts
(
addr16
[7]);

265 
bvlc_de
.
s6_pt
 = 
	`hts
(
de
->
pt
);

266 
	`debug_t_v6
("Sdg MPDU->", &
bvlc_de
.
s6_addr
);

268  
	`ndto
(
BIP6_Sock
, (*
mtu
, 
mtu_n
, 0,

269 (
sockaddr
 *&
bvlc_de
, (bvlc_dest));

270 
	}
}

282 
ut16_t
 
	$b6_ive
(

283 
BACNET_ADDRESS
 * 
c
,

284 
ut8_t
 * 
du
,

285 
ut16_t
 
max_du
,

286 
timeout
)

288 
ut16_t
 
du_n
 = 0;

289 
fd_t
 
ad_fds
;

290 
max
 = 0;

291 
timev
 
_timeout
;

292 
sockaddr_6
 
s
 = { 0 };

293 
BACNET_IP6_ADDRESS
 
addr
 = {{ 0 }};

294 
sockn_t
 
s_n
 = (
s
);

295 
ived_bys
 = 0;

296 
offt
 = 0;

297 
ut16_t
 
i
 = 0;

300 i(
BIP6_Sock
 < 0) {

306 i(
timeout
 >= 1000) {

307 
_timeout
.
tv_c
 = 
timeout
 / 1000;

308 
_timeout
.
tv_uc
 =

309 1000 * (
timeout
 - 
_timeout
.
tv_c
 * 1000);

311 
_timeout
.
tv_c
 = 0;

312 
_timeout
.
tv_uc
 = 1000 * 
timeout
;

314 
	`FD_ZERO
(&
ad_fds
);

315 
	`FD_SET
(
BIP6_Sock
, &
ad_fds
);

316 
max
 = 
BIP6_Sock
;

318 i(
	`
(
max
 + 1, &
ad_fds
, 
NULL
, NULL, &
_timeout
) > 0) {

319 
ived_bys
 =

320 
	`cvom
(
BIP6_Sock
, (*&
du
[0], 
max_du
, 0,

321 (
sockaddr
 *&
s
, &
s_n
);

326 i(
ived_bys
 < 0) {

330 i(
ived_bys
 == 0) {

334 i(
du
[0] !
BVLL_TYPE_BACNET_IP6
) {

338 
	`debug_t_v6
("Reived MPDU->", &
s
.
s6_addr
);

339 
	`bvlc6_addss_t
(&
addr
,

340 
	`ohs
(
s
.
s6_addr
.
s6_addr16
[0]),

341 
	`ohs
(
s
.
s6_addr
.
s6_addr16
[1]),

342 
	`ohs
(
s
.
s6_addr
.
s6_addr16
[2]),

343 
	`ohs
(
s
.
s6_addr
.
s6_addr16
[3]),

344 
	`ohs
(
s
.
s6_addr
.
s6_addr16
[4]),

345 
	`ohs
(
s
.
s6_addr
.
s6_addr16
[5]),

346 
	`ohs
(
s
.
s6_addr
.
s6_addr16
[6]),

347 
	`ohs
(
s
.
s6_addr
.
s6_addr16
[7]));

348 
addr
.
pt
 = 
	`ohs
(
s
.
s6_pt
);

349 
offt
 = 
	`bvlc6_hdr
(&
addr
, 
c
, 
du
, 
ived_bys
);

350 i(
offt
 > 0) {

351 
du_n
 = 
ived_bys
 - 
offt
;

352 i(
du_n
 <
max_du
) {

354 
i
 = 0; i < 
du_n
; i++) {

355 
du
[
i
] =pdu[
offt
 + i];

358 
du_n
 = 0;

362  
du_n
;

363 
	}
}

368 
	$b6_nup
(

371 i(
BIP6_Sock
 != -1) {

372 
	`o
(
BIP6_Sock
);

374 
BIP6_Sock
 = -1;

377 
	}
}

396 
bo
 
	$b6_
(

397 *
iame
)

399 
us
 = 0;

400 
sockaddr_6
 
rv
 = {0};

401 
6_addr
 
brd_addss
;

402 
v6_mq
 
jo_que
;

403 
sockt
 = 0;

405 i(
iame
) {

406 
	`b6_t_r
(
iame
);

408 
	`b6_t_r
("eth0");

410 i(
BIP6_Addr
.
pt
 == 0) {

411 
	`b6_t_pt
(0xBAC0);

413 
	`debug_tf
("BIP6: IPv6 UDPt: 0x%04X\n", 
	`hts
(
BIP6_Addr
.
pt
));

414 i(
BIP6_Brd_Addr
.
addss
[0] == 0) {

415 
	`bvlc6_addss_t
(&
BIP6_Brd_Addr
,

416 
BIP6_MULTICAST_SITE_LOCAL
, 0, 0, 0, 0, 0, 0,

417 
BIP6_MULTICAST_GROUP_ID
);

420 
BIP6_Sock
 = 
	`sock
(
AF_INET6
, 
SOCK_DGRAM
, 
IPPROTO_UDP
);

421 i(
BIP6_Sock
 < 0)

422  
l
;

425 
sockt
 = 1;

426 
us
 =

427 
	`tsockt
(
BIP6_Sock
, 
SOL_SOCKET
, 
SO_REUSEADDR
, &
sockt
,

428 (
sockt
));

429 i(
us
 < 0) {

430 
	`o
(
BIP6_Sock
);

431 
BIP6_Sock
 = -1;

432  
us
;

435 
us
 =

436 
	`tsockt
(
BIP6_Sock
, 
SOL_SOCKET
, 
SO_BROADCAST
, &
sockt
,

437 (
sockt
));

438 i(
us
 < 0) {

439 
	`o
(
BIP6_Sock
);

440 
BIP6_Sock
 = -1;

441  
l
;

444 
	`memy
(&
brd_addss
.
s6_addr
[0], &
BIP6_Brd_Addr
.
addss
[0], 
IP6_ADDRESS_MAX
);

445 
	`memy
(&
jo_que
.
v6mr_muɟddr
, &
brd_addss
, (
6_addr
));

447 
jo_que
.
v6mr_r
 = 0;

448 
us
 = 
	`tsockt
(
BIP6_Sock
, 
IPPROTO_IPV6
, 
IPV6_JOIN_GROUP
,

449 &
jo_que
, (join_request));

450 i(
us
 < 0) {

451 
	`
("BIP: setsockopt(IPV6_JOIN_GROUP)");

455 
rv
.
s6_my
 = 
AF_INET6
;

456 
rv
.
s6_addr
 = 
6addr_y
;

457 
rv
.
s6_pt
 = 
	`hts
(
BIP6_Addr
.
pt
);

458 
us
 = 
	`bd
(
BIP6_Sock
, (cڡ *)&
rv
, (server));

459 i(
us
 < 0) {

460 
	`
("BIP: bind");

461 
	`o
(
BIP6_Sock
);

462 
BIP6_Sock
 = -1;

463  
l
;

465 
	`bvlc6_
();

467  
ue
;

468 
	}
}

	@ports/linux/dlmstp.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<ddef.h
>

29 
	~<dlib.h
>

30 
	~<rg.h
>

31 
	~<dio.h
>

32 
	~<sys/time.h
>

33 
	~"bacdef.h
"

34 
	~"baddr.h
"

35 
	~"mp.h
"

36 
	~"dlmp.h
"

37 
	~"rs485.h
"

38 
	~"du.h
"

39 
	~"bs.h
"

40 
	~"rgbuf.h
"

41 
	~"debug.h
"

43 
	~"t.h
"

48 
ut16_t
 
	gMSTP_Packs
 = 0;

51 
DLMSTP_PACKET
 
	gReive_Pack
;

57 
had_cd_t
 
	gReive_Pack_Fg
;

58 
had_mux_t
 
	gReive_Pack_Mux
;

65 
had_cd_t
 
	gReived_Fme_Fg
;

66 
had_mux_t
 
	gReived_Fme_Mux
;

67 
had_cd_t
 
	gMa_De_Fg
;

68 
had_mux_t
 
	gMa_De_Mux
;

72 vީ
mp_pt_ru_t
 
	gMSTP_Pt
;

74 
ut8_t
 
	gTxBufr
[
MAX_MPDU
];

75 
ut8_t
 
	gRxBufr
[
MAX_MPDU
];

77 
	smp_pdu_ck
 {

78 
bo
 
	mda_exg_y
;

79 
ut8_t
 
	mdei_mac
;

80 
ut16_t
 
	mngth
;

81 
ut8_t
 
	mbufr
[
MAX_MPDU
];

84 #ide
MSTP_PDU_PACKET_COUNT


85 
	#MSTP_PDU_PACKET_COUNT
 8

	)

87 
mp_pdu_ck
 
	gPDU_Bufr
[
MSTP_PDU_PACKET_COUNT
];

88 
RING_BUFFER
 
	gPDU_Queue
;

93 
ut16_t
 
	gTy_timeout
 = 300;

98 
ut8_t
 
	gTuge_timeout
 = 100;

101 
timev
 
	gt
;

103 
ut32_t
 
	$Tim_S
(

104 *
pArg
)

106 
timev
 
now
, 
tmp_diff
;

107 
t32_t
 
s
;

109 
	`gtimeofday
(&
now
, 
NULL
);

110 
	`timsub
(&
t
, &
now
, &
tmp_diff
);

111 
s
 = ((
tmp_diff
.
tv_c
* 1000 + (tmp_diff.
tv_uc
) / 1000);

113  (
s
 >= 0 ?es : -res);

114 
	}
}

116 
	$Tim_S_Ret
(

117 *
pArg
)

119 
	`gtimeofday
(&
t
, 
NULL
);

120 
	}
}

122 
	$g_abime
(

123 
timeec
 *
abime
,

124 
mlicds
)

126 
timev
 
now
, 
offt
, 
su
;

128 
	`gtimeofday
(&
now
, 
NULL
);

129 
offt
.
tv_c
 = 0;

130 
offt
.
tv_uc
 = 
mlicds
 * 1000;

131 
	`timadd
(&
now
, &
offt
, &
su
);

132 
abime
->
tv_c
 = 
su
.tv_sec;

133 
abime
->
tv_nc
 = 
su
.
tv_uc
 * 1000;

134 
	}
}

136 
	$dlmp_nup
(

139 
	`had_cd_deroy
(&
Reived_Fme_Fg
);

140 
	`had_cd_deroy
(&
Reive_Pack_Fg
);

141 
	`had_cd_deroy
(&
Ma_De_Fg
);

142 
	`had_mux_deroy
(&
Reived_Fme_Mux
);

143 
	`had_mux_deroy
(&
Reive_Pack_Mux
);

144 
	`had_mux_deroy
(&
Ma_De_Mux
);

145 
	}
}

148 
	$dlmp_nd_pdu
(

149 
BACNET_ADDRESS
 * 
de
,

150 
BACNET_NPDU_DATA
 * 
du_da
,

151 
ut8_t
 * 
pdu
,

152 
pdu_n
)

154 
bys_
 = 0;

155 
mp_pdu_ck
 *
pkt
;

156 
i
 = 0;

158 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Da_Pk
(&
PDU_Queue
);

159 i(
pkt
) {

160 
pkt
->
da_exg_y
 = 
du_da
->data_expecting_reply;

161 
i
 = 0; i < 
pdu_n
; i++) {

162 
pkt
->
bufr
[
i
] = 
pdu
[i];

164 
pkt
->
ngth
 = 
pdu_n
;

165 i(
de
 && de->
mac_n
) {

166 
pkt
->
dei_mac
 = 
de
->
mac
[0];

169 
pkt
->
dei_mac
 = 
MSTP_BROADCAST_ADDRESS
;

171 i(
	`Rgbuf_Da_Put
(&
PDU_Queue
, (
ut8_t
 *)
pkt
)) {

172 
bys_
 = 
pdu_n
;

176  
bys_
;

177 
	}
}

179 
ut16_t
 
	$dlmp_ive
(

180 
BACNET_ADDRESS
 * 
c
,

181 
ut8_t
 * 
pdu
,

182 
ut16_t
 
max_pdu
,

183 
timeout
)

185 
ut16_t
 
pdu_n
 = 0;

186 
timeec
 
abime
;

188 (
max_pdu
;

191 
	`had_mux_lock
(&
Reive_Pack_Mux
);

192 
	`g_abime
(&
abime
, 
timeout
);

193 
	`had_cd_timedwa
(&
Reive_Pack_Fg
, &
Reive_Pack_Mux
,

194 &
abime
);

195 i(
Reive_Pack
.
ady
) {

196 i(
Reive_Pack
.
pdu_n
) {

197 
MSTP_Packs
++;

198 i(
c
) {

199 
	`memmove
(
c
, &
Reive_Pack
.
addss
,

200 (
Reive_Pack
.
addss
));

202 i(
pdu
) {

203 
	`memmove
(
pdu
, &
Reive_Pack
.pdu,

204 (
Reive_Pack
.
pdu
));

206 
pdu_n
 = 
Reive_Pack
.pdu_len;

208 
Reive_Pack
.
ady
 = 
l
;

210 
	`had_mux_uock
(&
Reive_Pack_Mux
);

212  
pdu_n
;

213 
	}
}

215 *
	$dlmp_ma_fsm_sk
(

216 *
pArg
)

218 
ut32_t
 
s
 = 0;

219 
bo
 
run_ma
 = 
l
;

221 (
pArg
;

223 i(
MSTP_Pt
.
ReivedVidFme
 =
l
 &&

224 
MSTP_Pt
.
ReivedInvidFme
 =
l
) {

225 
	`RS485_Check_UART_Da
(&
MSTP_Pt
);

226 
	`MSTP_Reive_Fme_FSM
(&
MSTP_Pt
);

228 i(
MSTP_Pt
.
ReivedVidFme
 || MSTP_Pt.
ReivedInvidFme
) {

229 
run_ma
 = 
ue
;

231 
s
 = 
MSTP_Pt
.
	`STim
(
NULL
);

232 
MSTP_Pt
.
ma_e
) {

233 
MSTP_MASTER_STATE_IDLE
:

234 i(
s
 >
Tno_tok
)

235 
run_ma
 = 
ue
;

237 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

238 i(
s
 >
Ty_timeout
)

239 
run_ma
 = 
ue
;

241 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

242 i(
s
 >
Tuge_timeout
)

243 
run_ma
 = 
ue
;

246 
run_ma
 = 
ue
;

250 i(
run_ma
) {

251 i(
MSTP_Pt
.
This_Sti
 <= 127) {

252 
	`MSTP_Ma_Node_FSM
(&
MSTP_Pt
)) {

255 } i(
MSTP_Pt
.
This_Sti
 < 255) {

256 
	`MSTP_Sve_Node_FSM
(&
MSTP_Pt
);

261  
NULL
;

262 
	}
}

264 
	$dlmp_fl_ba_addss
(

265 
BACNET_ADDRESS
 * 
c
,

266 
ut8_t
 
mp_addss
)

268 
i
 = 0;

270 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

272 
c
->
mac_n
 = 0;

273 
c
->
mac
[0] = 0;

275 
c
->
mac_n
 = 1;

276 
c
->
mac
[0] = 
mp_addss
;

279 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

280 
c
->
mac
[
i
] = 0;

282 
c
->
t
 = 0;

283 
c
->
n
 = 0;

284 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

285 
c
->
adr
[
i
] = 0;

287 
	}
}

290 
ut16_t
 
	$MSTP_Put_Reive
(

291 vީ
mp_pt_ru_t
 *
mp_pt
)

293 
ut16_t
 
pdu_n
 = 0;

295 
	`had_mux_lock
(&
Reive_Pack_Mux
);

296 i(
Reive_Pack
.
ady
) {

297 
	`debug_tf
("MS/TP: Dropped! Not Ready.\n");

300 
pdu_n
 = 
mp_pt
->
DaLgth
;

301 i(
pdu_n
 > (
Reive_Pack
.
pdu
)) {

302 
pdu_n
 = (
Reive_Pack
.
pdu
);

304 i(
pdu_n
 == 0) {

305 
	`debug_tf
("MS/TP: PDU Length is 0!\n");

307 
	`memmove
((*&
Reive_Pack
.
pdu
[0],

308 (*&
mp_pt
->
IutBufr
[0], 
pdu_n
);

309 
	`dlmp_fl_ba_addss
(&
Reive_Pack
.
addss
,

310 
mp_pt
->
SourAddss
);

311 
Reive_Pack
.
pdu_n
 = 
mp_pt
->
DaLgth
;

312 
Reive_Pack
.
ady
 = 
ue
;

313 
	`had_cd_sigl
(&
Reive_Pack_Fg
);

315 
	`had_mux_uock
(&
Reive_Pack_Mux
);

317  
pdu_n
;

318 
	}
}

322 
ut16_t
 
	$MSTP_G_Sd
(

323 vީ
mp_pt_ru_t
 * 
mp_pt
,

324 
timeout
)

326 
ut16_t
 
pdu_n
 = 0;

327 
ut8_t
 
ame_ty
 = 0;

328 
mp_pdu_ck
 *
pkt
;

330 (
timeout
;

331 i(
	`Rgbuf_Emy
(&
PDU_Queue
)) {

334 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
PDU_Queue
);

335 i(
pkt
->
da_exg_y
) {

336 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

338 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

341 
pdu_n
 = 
	`MSTP_Ce_Fme
(&
mp_pt
->
OuutBufr
[0],

342 
mp_pt
->
OuutBufrSize
, 
ame_ty
, 
pkt
->
dei_mac
,

343 
mp_pt
->
This_Sti
, (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

344 (
	`Rgbuf_P
(&
PDU_Queue
, 
NULL
);

346  
pdu_n
;

347 
	}
}

349 
bo
 
	$dlmp_com_da_exg_y
(

350 
ut8_t
 * 
que_pdu
,

351 
ut16_t
 
que_pdu_n
,

352 
ut8_t
 
c_addss
,

353 
ut8_t
 * 
y_pdu
,

354 
ut16_t
 
y_pdu_n
,

355 
ut8_t
 
de_addss
)

357 
ut16_t
 
offt
;

361 
	sDER_com_t
 {

362 
BACNET_NPDU_DATA
 
du_da
;

363 
BACNET_ADDRESS
 
addss
;

364 
ut8_t
 
pdu_ty
;

365 
ut8_t
 
voke_id
;

366 
ut8_t
 
rvi_choi
;

368 
DER_com_t
 
que
;

369 
DER_com_t
 
y
;

372 
que_pdu_n
 =equest_pdu_len;

373 
y_pdu_n
 =eply_pdu_len;

375 
que
.
addss
.
mac
[0] = 
c_addss
;

376 
que
.
addss
.
mac_n
 = 1;

377 
offt
 =

378 
	`du_decode
(&
que_pdu
[0], 
NULL
, &
que
.
addss
,

379 &
que
.
du_da
);

380 i(
que
.
du_da
.
twk_y_mesge
) {

381 #i
PRINT_ENABLED


382 
	`rtf
(
dr
,

385  
l
;

387 
que
.
pdu_ty
 = 
que_pdu
[
offt
] & 0xF0;

388 i(
que
.
pdu_ty
 !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
) {

389 #i
PRINT_ENABLED


390 
	`rtf
(
dr
,

393  
l
;

395 
que
.
voke_id
 = 
que_pdu
[
offt
 + 2];

397 i(
que_pdu
[
offt
] & 
BIT3
) {

398 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 5];

400 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 3];

403 
y
.
addss
.
mac
[0] = 
de_addss
;

404 
y
.
addss
.
mac_n
 = 1;

405 
offt
 =

406 
	`du_decode
(&
y_pdu
[0], &
y
.
addss
, 
NULL
, &y.
du_da
);

407 i(
y
.
du_da
.
twk_y_mesge
) {

408 #i
PRINT_ENABLED


409 
	`rtf
(
dr
,

412  
l
;

416 
y
.
pdu_ty
 = 
y_pdu
[
offt
] & 0xF0;

417 
y
.
pdu_ty
) {

418 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

419 
y
.
voke_id
 = 
y_pdu
[
offt
 + 2];

421 i(
y_pdu
[
offt
] & 
BIT3
) {

422 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 5];

424 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 3];

427 
PDU_TYPE_SIMPLE_ACK
:

428 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

429 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

431 
PDU_TYPE_COMPLEX_ACK
:

432 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

434 i(
y_pdu
[
offt
] & 
BIT3
) {

435 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 4];

437 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

440 
PDU_TYPE_ERROR
:

441 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

442 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

444 
PDU_TYPE_REJECT
:

445 
PDU_TYPE_ABORT
:

446 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

449  
l
;

452 i((
y
.
pdu_ty
 =
PDU_TYPE_REJECT
) ||

453 (
y
.
pdu_ty
 =
PDU_TYPE_ABORT
)) {

454 i(
que
.
voke_id
 !
y
.invoke_id) {

455 #i
PRINT_ENABLED


456 
	`rtf
(
dr
,

459  
l
;

462 i(
que
.
voke_id
 !
y
.invoke_id) {

463 #i
PRINT_ENABLED


464 
	`rtf
(
dr
,

467  
l
;

469 i(
que
.
rvi_choi
 !
y
.service_choice) {

470 #i
PRINT_ENABLED


471 
	`rtf
(
dr
,

474  
l
;

477 i(
que
.
du_da
.
oc_vsi
 !
y
.npdu_data.protocol_version) {

478 #i
PRINT_ENABLED


479 
	`rtf
(
dr
,

483  
l
;

488 i(
que
.
du_da
.
iܙy
 !
y
.npdu_data.priority) {

489 #i
PRINT_ENABLED


490 
	`rtf
(
dr
,

493  
l
;

496 i(!
	`ba_addss_me
(&
que
.
addss
, &
y
.address)) {

497 #i
PRINT_ENABLED


498 
	`rtf
(
dr
,

501  
l
;

504  
ue
;

505 
	}
}

508 
ut16_t
 
	$MSTP_G_Rly
(

509 vީ
mp_pt_ru_t
 * 
mp_pt
,

510 
timeout
)

512 
ut16_t
 
pdu_n
 = 0;

513 
bo
 
mched
 = 
l
;

514 
ut8_t
 
ame_ty
 = 0;

515 
mp_pdu_ck
 *
pkt
;

517 (
timeout
;

518 i(
	`Rgbuf_Emy
(&
PDU_Queue
)) {

521 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
PDU_Queue
);

523 
mched
 =

524 
	`dlmp_com_da_exg_y
(&
mp_pt
->
IutBufr
[0],

525 
mp_pt
->
DaLgth
, mp_pt->
SourAddss
,

526 (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
,kt->
dei_mac
);

527 i(!
mched
) {

530 i(
pkt
->
da_exg_y
) {

531 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

533 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

536 
pdu_n
 = 
	`MSTP_Ce_Fme
(&
mp_pt
->
OuutBufr
[0],

537 
mp_pt
->
OuutBufrSize
, 
ame_ty
, 
pkt
->
dei_mac
,

538 
mp_pt
->
This_Sti
, (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

539 (
	`Rgbuf_P
(&
PDU_Queue
, 
NULL
);

541  
pdu_n
;

542 
	}
}

544 
	$dlmp_t_mac_addss
(

545 
ut8_t
 
mac_addss
)

548 i(
mac_addss
 <= 127) {

549 
MSTP_Pt
.
This_Sti
 = 
mac_addss
;

555 i(
mac_addss
 > 
MSTP_Pt
.
Nmax_ma
)

556 
	`dlmp_t_max_ma
(
mac_addss
);

560 
	}
}

562 
ut8_t
 
	$dlmp_mac_addss
(

565  
MSTP_Pt
.
This_Sti
;

566 
	}
}

575 
	$dlmp_t_max_fo_ames
(

576 
ut8_t
 
max_fo_ames
)

578 i(
max_fo_ames
 >= 1) {

579 
MSTP_Pt
.
Nmax_fo_ames
 = 
max_fo_ames
;

588 
	}
}

590 
ut8_t
 
	$dlmp_max_fo_ames
(

593  
MSTP_Pt
.
Nmax_fo_ames
;

594 
	}
}

601 
	$dlmp_t_max_ma
(

602 
ut8_t
 
max_ma
)

604 i(
max_ma
 <= 127) {

605 i(
MSTP_Pt
.
This_Sti
 <
max_ma
) {

606 
MSTP_Pt
.
Nmax_ma
 = 
max_ma
;

616 
	}
}

618 
ut8_t
 
	$dlmp_max_ma
(

621  
MSTP_Pt
.
Nmax_ma
;

622 
	}
}

625 
	$dlmp_t_baud_
(

626 
ut32_t
 
baud
)

628 
	`RS485_S_Baud_Re
(
baud
);

629 
	}
}

631 
ut32_t
 
	$dlmp_baud_
(

634  
	`RS485_G_Baud_Re
();

635 
	}
}

637 
	$dlmp_g_my_addss
(

638 
BACNET_ADDRESS
 * 
my_addss
)

640 
i
 = 0;

642 
my_addss
->
mac_n
 = 1;

643 
my_addss
->
mac
[0] = 
MSTP_Pt
.
This_Sti
;

644 
my_addss
->
t
 = 0;

645 
my_addss
->
n
 = 0;

646 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

647 
my_addss
->
adr
[
i
] = 0;

651 
	}
}

653 
	$dlmp_g_brd_addss
(

654 
BACNET_ADDRESS
 * 
de
)

656 
i
 = 0;

658 i(
de
) {

659 
de
->
mac_n
 = 1;

660 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

661 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

662 
de
->
n
 = 0;

663 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

664 
de
->
adr
[
i
] = 0;

669 
	}
}

671 
bo
 
	$dlmp_
(

672 *
iame
)

674 
hThad
 = 0;

675 
rv
 = 0;

678 
	`Rgbuf_In
(&
PDU_Queue
, (
ut8_t
 *& 
PDU_Bufr
,

679 (
mp_pdu_ck
), 
MSTP_PDU_PACKET_COUNT
);

681 
Reive_Pack
.
ady
 = 
l
;

682 
Reive_Pack
.
pdu_n
 = 0;

683 
rv
 = 
	`had_cd_
(&
Reive_Pack_Fg
, 
NULL
);

684 i(
rv
 != 0) {

685 
	`rtf
(
dr
,

687 
iame
);

688 
	`ex
(1);

690 
rv
 = 
	`had_mux_
(&
Reive_Pack_Mux
, 
NULL
);

691 i(
rv
 != 0) {

692 
	`rtf
(
dr
,

693 "MS/TP I: %s\هo PThad Mux.\n", 
iame
);

694 
	`ex
(1);

697 i(
iame
) {

698 
	`RS485_S_I
(
iame
);

699 #i
PRINT_ENABLED


700 
	`rtf
(
dr
, "MS/TP I: %s\n", 
iame
);

703 
	`RS485_Inlize
();

704 
MSTP_Pt
.
IutBufr
 = &
RxBufr
[0];

705 
MSTP_Pt
.
IutBufrSize
 = (
RxBufr
);

706 
MSTP_Pt
.
OuutBufr
 = &
TxBufr
[0];

707 
MSTP_Pt
.
OuutBufrSize
 = (
TxBufr
);

708 
	`gtimeofday
(&
t
, 
NULL
);

709 
MSTP_Pt
.
STim
 = 
Tim_S
;

710 
MSTP_Pt
.
STimRet
 = 
Tim_S_Ret
;

711 
	`MSTP_In
(&
MSTP_Pt
);

712 #i
PRINT_ENABLED


713 
	`rtf
(
dr
, "MS/TP MAC: %02X\n", 
MSTP_Pt
.
This_Sti
);

714 
	`rtf
(
dr
, "MS/TP Max_Ma: %02X\n", 
MSTP_Pt
.
Nmax_ma
);

715 
	`rtf
(
dr
, "MS/TP Max_Info_Fmes: %u\n", 
MSTP_Pt
.
Nmax_fo_ames
);

722 
rv
 = 
	`had_
(&
hThad
, 
NULL
, 
dlmp_ma_fsm_sk
, NULL);

723 i(
rv
 != 0) {

724 
	`rtf
(
dr
, "Failedo start Master Node FSMask\n");

727  
ue
;

728 
	}
}

730 #ifde
TEST_DLMSTP


731 
	~<dio.h
>

733 
	$du_hdr
(

734 
BACNET_ADDRESS
 * 
c
,

735 
ut8_t
 * 
du
,

736 
ut16_t
 
pdu_n
)

738 (
c
;

739 (
du
;

740 (
pdu_n
;

741 
	}
}

743 *
	gNwk_I
 = 
NULL
;

745 
	$ma
(

746 
gc
,

747 *
gv
[])

749 
ut16_t
 
pdu_n
 = 0;

752 i(
gc
 > 1) {

753 
Nwk_I
 = 
gv
[1];

755 
	`dlmp_t_baud_
(38400);

756 
	`dlmp_t_mac_addss
(0x05);

757 
	`dlmp_t_max_fo_ames
(
DEFAULT_MAX_INFO_FRAMES
);

758 
	`dlmp_t_max_ma
(
DEFAULT_MAX_MASTER
);

759 
	`dlmp_
(
Nwk_I
);

762 
pdu_n
 = 
	`dlmp_ive
(
NULL
, NULL, 0, 
UINT_MAX
);

763 
	`MSTP_Ce_And_Sd_Fme
(&
MSTP_Pt
, 
FRAME_TYPE_TEST_REQUEST
,

764 
MSTP_Pt
.
SourAddss
, MSTP_Pt.
This_Sti
, 
NULL
, 0);

768 
	}
}

	@ports/linux/dlmstp_linux.c

25 
	~<dbo.h
>

26 
	~<dt.h
>

27 
	~<ddef.h
>

28 
	~<dlib.h
>

29 
	~<rg.h
>

30 
	~<dio.h
>

31 
	~<time.h
>

32 
	~"bacdef.h
"

33 
	~"baddr.h
"

34 
	~"mp.h
"

36 
	~"dlmp_lux.h
"

37 
	~"rs485.h
"

38 
	~"du.h
"

39 
	~"bs.h
"

41 
	~"t.h
"

42 
	~"rgbuf.h
"

46 
	#BACNET_PDU_CONTROL_BYTE_OFFSET
 1

	)

47 
	#BACNET_DATA_EXPECTING_REPLY_BIT
 2

	)

48 
	#BACNET_DATA_EXPECTING_REPLY
(
cڌ
(cڌ & (1 << 
BACNET_DATA_EXPECTING_REPLY_BIT
> 0 )

	)

50 
	#INCREMENT_AND_LIMIT_UINT16
(
x
{i(x < 0xFFFFx++;}

	)

51 
ut32_t
 
	$Tim_S
(

52 *
poPt
)

54 
timev
 
now
, 
tmp_diff
;

55 
SHARED_MSTP_DATA
 *
poShedDa
;

56 
mp_pt_ru_t
 *
mp_pt
 =

57 (
mp_pt_ru_t
 *
poPt
;

58 i(!
mp_pt
) {

61 
poShedDa
 = (
SHARED_MSTP_DATA
 *
mp_pt
->
UrDa
;

62 i(!
poShedDa
) {

66 
t32_t
 
s
;

68 
	`gtimeofday
(&
now
, 
NULL
);

69 
	`timsub
(&
poShedDa
->
t
, &
now
, &
tmp_diff
);

70 
s
 = ((
tmp_diff
.
tv_c
* 1000 + (tmp_diff.
tv_uc
) / 1000);

72  (
s
 >= 0 ?es : -res);

73 
	}
}

75 
	$Tim_S_Ret
(

76 *
poPt
)

78 
SHARED_MSTP_DATA
 *
poShedDa
;

79 
mp_pt_ru_t
 *
mp_pt
 =

80 (
mp_pt_ru_t
 *
poPt
;

81 i(!
mp_pt
) {

84 
poShedDa
 = (
SHARED_MSTP_DATA
 *
mp_pt
->
UrDa
;

85 i(!
poShedDa
) {

89 
	`gtimeofday
(&
poShedDa
->
t
, 
NULL
);

90 
	}
}

92 
	$g_abime
(

93 
timeec
 *
abime
,

94 
mlicds
)

96 
timev
 
now
, 
offt
, 
su
;

98 
	`gtimeofday
(&
now
, 
NULL
);

99 
offt
.
tv_c
 = 0;

100 
offt
.
tv_uc
 = 
mlicds
 * 1000;

101 
	`timadd
(&
now
, &
offt
, &
su
);

102 
abime
->
tv_c
 = 
su
.tv_sec;

103 
abime
->
tv_nc
 = 
su
.
tv_uc
 * 1000;

104 
	}
}

106 
	$dlmp_nup
(

107 *
poPt
)

109 
SHARED_MSTP_DATA
 *
poShedDa
;

110 
mp_pt_ru_t
 *
mp_pt
 =

111 (
mp_pt_ru_t
 *
poPt
;

112 i(!
mp_pt
) {

115 
poShedDa
 = (
SHARED_MSTP_DATA
 *
mp_pt
->
UrDa
;

116 i(!
poShedDa
) {

121 
	`tcr
(
poShedDa
->
RS485_Hd
, 
TCSANOW
,

122 &
poShedDa
->
RS485_dtio
);

123 
	`o
(
poShedDa
->
RS485_Hd
);

125 
	`had_cd_deroy
(&
poShedDa
->
Reived_Fme_Fg
);

126 
	`m_deroy
(&
poShedDa
->
Reive_Pack_Fg
);

127 
	`had_cd_deroy
(&
poShedDa
->
Ma_De_Fg
);

128 
	`had_mux_deroy
(&
poShedDa
->
Reived_Fme_Mux
);

129 
	`had_mux_deroy
(&
poShedDa
->
Ma_De_Mux
);

130 
	}
}

133 
	$dlmp_nd_pdu
(

134 *
poPt
,

135 
BACNET_ADDRESS
 * 
de
,

136 
ut8_t
 * 
pdu
,

137 
pdu_n
)

139 
bys_
 = 0;

140 
mp_pdu_ck
 *
pkt
;

141 
i
 = 0;

142 
SHARED_MSTP_DATA
 *
poShedDa
;

143 
mp_pt_ru_t
 *
mp_pt
 =

144 (
mp_pt_ru_t
 *
poPt
;

145 i(!
mp_pt
) {

148 
poShedDa
 = (
SHARED_MSTP_DATA
 *
mp_pt
->
UrDa
;

149 i(!
poShedDa
) {

153 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Da_Pk
(&
poShedDa
->
PDU_Queue
);

154 i(
pkt
) {

155 
pkt
->
da_exg_y
 =

156 
	`BACNET_DATA_EXPECTING_REPLY
(
pdu
[
BACNET_PDU_CONTROL_BYTE_OFFSET
]);

157 
i
 = 0; i < 
pdu_n
; i++) {

158 
pkt
->
bufr
[
i
] = 
pdu
[i];

160 
pkt
->
ngth
 = 
pdu_n
;

161 
pkt
->
dei_mac
 = 
de
->
mac
[0];

162 i(
	`Rgbuf_Da_Put
(&
poShedDa
->
PDU_Queue
, (
ut8_t
 *)
pkt
)) {

163 
bys_
 = 
pdu_n
;

167  
bys_
;

168 
	}
}

170 
ut16_t
 
	$dlmp_ive
(

171 *
poPt
,

172 
BACNET_ADDRESS
 * 
c
,

173 
ut8_t
 * 
pdu
,

174 
ut16_t
 
max_pdu
,

175 
timeout
)

177 
ut16_t
 
pdu_n
 = 0;

178 
timeec
 
abime
;

179 
rv
 = 0;

180 
SHARED_MSTP_DATA
 *
poShedDa
;

181 
mp_pt_ru_t
 *
mp_pt
 =

182 (
mp_pt_ru_t
 *
poPt
;

183 i(!
mp_pt
) {

186 
poShedDa
 = (
SHARED_MSTP_DATA
 *
mp_pt
->
UrDa
;

187 i(!
poShedDa
) {

190 (
max_pdu
;

193 
	`g_abime
(&
abime
, 
timeout
);

194 
rv
 = 
	`m_timedwa
(&
poShedDa
->
Reive_Pack_Fg
, &
abime
);

195 i(
rv
 == 0) {

196 i(
poShedDa
->
Reive_Pack
.
ady
) {

197 i(
poShedDa
->
Reive_Pack
.
pdu_n
) {

198 
poShedDa
->
MSTP_Packs
++;

199 i(
c
) {

200 
	`memmove
(
c
, &
poShedDa
->
Reive_Pack
.
addss
,

201 (
poShedDa
->
Reive_Pack
.
addss
));

203 i(
pdu
) {

204 
	`memmove
(
pdu
, &
poShedDa
->
Reive_Pack
.pdu,

205 (
poShedDa
->
Reive_Pack
.
pdu
));

207 
pdu_n
 = 
poShedDa
->
Reive_Pack
.pdu_len;

209 
poShedDa
->
Reive_Pack
.
ady
 = 
l
;

213  
pdu_n
;

214 
	}
}

216 *
	$dlmp_ive_fsm_sk
(

217 *
pArg
)

219 
bo
 
ived_ame
;

220 
SHARED_MSTP_DATA
 *
poShedDa
;

221 
mp_pt_ru_t
 *
mp_pt
 = (mp_pt_ru_*
pArg
;

222 i(!
mp_pt
) {

223  
NULL
;

226 
poShedDa
 =

227 (
SHARED_MSTP_DATA
 *((
mp_pt_ru_t
 *
pArg
)->
UrDa
;

228 i(!
poShedDa
) {

229  
NULL
;

234 i((
mp_pt
->
ReivedVidFme
 =
l
) &&

235 (
mp_pt
->
ReivedInvidFme
 =
l
)) {

237 
	`RS485_Check_UART_Da
(
mp_pt
);

238 
	`MSTP_Reive_Fme_FSM
((vީ
mp_pt_ru_t
 *)

239 
pArg
);

240 
ived_ame
 = 
mp_pt
->
ReivedVidFme
 ||

241 
mp_pt
->
ReivedInvidFme
;

242 i(
ived_ame
) {

243 
	`had_cd_sigl
(&
poShedDa
->
Reived_Fme_Fg
);

246 } 
mp_pt
->
DaAvaab
);

250  
NULL
;

251 
	}
}

253 *
	$dlmp_ma_fsm_sk
(

254 *
pArg
)

256 
ut32_t
 
s
 = 0;

257 
bo
 
run_ma
 = 
l
;

258 
SHARED_MSTP_DATA
 *
poShedDa
;

259 
mp_pt_ru_t
 *
mp_pt
 = (mp_pt_ru_*
pArg
;

260 i(!
mp_pt
) {

261  
NULL
;

264 
poShedDa
 =

265 (
SHARED_MSTP_DATA
 *((
mp_pt_ru_t
 *
pArg
)->
UrDa
;

266 i(!
poShedDa
) {

267  
NULL
;

271 i(
mp_pt
->
ReivedVidFme
 =
l
 &&

272 
mp_pt
->
ReivedInvidFme
 =
l
) {

273 
	`RS485_Check_UART_Da
(
mp_pt
);

274 
	`MSTP_Reive_Fme_FSM
(
mp_pt
);

276 i(
mp_pt
->
ReivedVidFme
 || mp_pt->
ReivedInvidFme
) {

277 
run_ma
 = 
ue
;

279 
s
 = 
mp_pt
->
	`STim
(
NULL
);

280 
mp_pt
->
ma_e
) {

281 
MSTP_MASTER_STATE_IDLE
:

282 i(
s
 >
Tno_tok
)

283 
run_ma
 = 
ue
;

285 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

286 i(
s
 >
poShedDa
->
Ty_timeout
)

287 
run_ma
 = 
ue
;

289 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

290 i(
s
 >
poShedDa
->
Tuge_timeout
)

291 
run_ma
 = 
ue
;

294 
run_ma
 = 
ue
;

298 i(
run_ma
) {

299 i(
mp_pt
->
This_Sti
 <
DEFAULT_MAX_MASTER
) {

300 
	`MSTP_Ma_Node_FSM
(
mp_pt
)) {

303 } i(
mp_pt
->
This_Sti
 < 255) {

304 
	`MSTP_Sve_Node_FSM
(
mp_pt
);

309  
NULL
;

310 
	}
}

312 
	$dlmp_fl_ba_addss
(

313 
BACNET_ADDRESS
 * 
c
,

314 
ut8_t
 
mp_addss
)

316 
i
 = 0;

318 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

320 
c
->
mac_n
 = 0;

321 
c
->
mac
[0] = 0;

323 
c
->
mac_n
 = 1;

324 
c
->
mac
[0] = 
mp_addss
;

327 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

328 
c
->
mac
[
i
] = 0;

330 
c
->
t
 = 0;

331 
c
->
n
 = 0;

332 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

333 
c
->
adr
[
i
] = 0;

335 
	}
}

338 
ut16_t
 
	$MSTP_Put_Reive
(

339 vީ
mp_pt_ru_t
 *
mp_pt
)

341 
ut16_t
 
pdu_n
 = 0;

342 
SHARED_MSTP_DATA
 *
poShedDa
 = (SHARED_MSTP_DATA *
mp_pt
->
UrDa
;

344 i(!
poShedDa
) {

348 i(!
poShedDa
->
Reive_Pack
.
ady
) {

350 
pdu_n
 = 
mp_pt
->
DaLgth
;

351 i(
pdu_n
 > (
poShedDa
->
Reive_Pack
.
pdu
))

352 
pdu_n
 = (
poShedDa
->
Reive_Pack
.
pdu
);

353 
	`memmove
((*&
poShedDa
->
Reive_Pack
.
pdu
[0],

354 (*&
mp_pt
->
IutBufr
[0], 
pdu_n
);

355 
	`dlmp_fl_ba_addss
(&
poShedDa
->
Reive_Pack
.
addss
,

356 
mp_pt
->
SourAddss
);

357 
poShedDa
->
Reive_Pack
.
pdu_n
 = 
mp_pt
->
DaLgth
;

358 
poShedDa
->
Reive_Pack
.
ady
 = 
ue
;

359 
	`m_po
(&
poShedDa
->
Reive_Pack_Fg
);

362  
pdu_n
;

363 
	}
}

367 
ut16_t
 
	$MSTP_G_Sd
(

368 vީ
mp_pt_ru_t
 * 
mp_pt
,

369 
timeout
)

371 
ut16_t
 
pdu_n
 = 0;

372 
ut8_t
 
ame_ty
 = 0;

373 
mp_pdu_ck
 *
pkt
;

374 
SHARED_MSTP_DATA
 *
poShedDa
 = (SHARED_MSTP_DATA *
mp_pt
->
UrDa
;

376 i(!
poShedDa
) {

380 (
timeout
;

381 i(
	`Rgbuf_Emy
(&
poShedDa
->
PDU_Queue
)) {

384 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
poShedDa
->
PDU_Queue
);

385 i(
pkt
->
da_exg_y
) {

386 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

388 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

391 
pdu_n
 = 
	`MSTP_Ce_Fme
(&
mp_pt
->
OuutBufr
[0],

392 
mp_pt
->
OuutBufrSize
, 
ame_ty
, 
pkt
->
dei_mac
,

393 
mp_pt
->
This_Sti
, (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

394 (
	`Rgbuf_P
(&
poShedDa
->
PDU_Queue
, 
NULL
);

396  
pdu_n
;

397 
	}
}

399 
bo
 
	$dlmp_com_da_exg_y
(

400 
ut8_t
 * 
que_pdu
,

401 
ut16_t
 
que_pdu_n
,

402 
ut8_t
 
c_addss
,

403 
ut8_t
 * 
y_pdu
,

404 
ut16_t
 
y_pdu_n
,

405 
ut8_t
 
de_addss
)

407 
ut16_t
 
offt
;

411 
	sDER_com_t
 {

412 
BACNET_NPDU_DATA
 
du_da
;

413 
BACNET_ADDRESS
 
addss
;

414 
ut8_t
 
pdu_ty
;

415 
ut8_t
 
voke_id
;

416 
ut8_t
 
rvi_choi
;

418 
DER_com_t
 
que
;

419 
DER_com_t
 
y
;

422 
que_pdu_n
 =equest_pdu_len;

423 
y_pdu_n
 =eply_pdu_len;

425 
que
.
addss
.
mac
[0] = 
c_addss
;

426 
que
.
addss
.
mac_n
 = 1;

427 
offt
 =

428 
	`du_decode
(&
que_pdu
[0], 
NULL
, &
que
.
addss
,

429 &
que
.
du_da
);

430 i(
que
.
du_da
.
twk_y_mesge
) {

431 #i
PRINT_ENABLED


432 
	`rtf
(
dr
,

435  
l
;

437 
que
.
pdu_ty
 = 
que_pdu
[
offt
] & 0xF0;

438 i(
que
.
pdu_ty
 !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
) {

439 #i
PRINT_ENABLED


440 
	`rtf
(
dr
,

443  
l
;

445 
que
.
voke_id
 = 
que_pdu
[
offt
 + 2];

447 i(
que_pdu
[
offt
] & 
BIT3
) {

448 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 5];

450 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 3];

453 
y
.
addss
.
mac
[0] = 
de_addss
;

454 
y
.
addss
.
mac_n
 = 1;

455 
offt
 =

456 
	`du_decode
(&
y_pdu
[0], &
y
.
addss
, 
NULL
, &y.
du_da
);

457 i(
y
.
du_da
.
twk_y_mesge
) {

458 #i
PRINT_ENABLED


459 
	`rtf
(
dr
,

462  
l
;

466 
y
.
pdu_ty
 = 
y_pdu
[
offt
] & 0xF0;

467 
y
.
pdu_ty
) {

468 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

469 
y
.
voke_id
 = 
y_pdu
[
offt
 + 2];

471 i(
y_pdu
[
offt
] & 
BIT3
) {

472 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 5];

474 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 3];

477 
PDU_TYPE_SIMPLE_ACK
:

478 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

479 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

481 
PDU_TYPE_COMPLEX_ACK
:

482 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

484 i(
y_pdu
[
offt
] & 
BIT3
) {

485 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 4];

487 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

490 
PDU_TYPE_ERROR
:

491 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

492 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

494 
PDU_TYPE_REJECT
:

495 
PDU_TYPE_ABORT
:

496 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

499  
l
;

502 i((
y
.
pdu_ty
 =
PDU_TYPE_REJECT
) ||

503 (
y
.
pdu_ty
 =
PDU_TYPE_ABORT
)) {

504 i(
que
.
voke_id
 !
y
.invoke_id) {

505 #i
PRINT_ENABLED


506 
	`rtf
(
dr
,

509  
l
;

512 i(
que
.
voke_id
 !
y
.invoke_id) {

513 #i
PRINT_ENABLED


514 
	`rtf
(
dr
,

517  
l
;

519 i(
que
.
rvi_choi
 !
y
.service_choice) {

520 #i
PRINT_ENABLED


521 
	`rtf
(
dr
,

524  
l
;

527 i(
que
.
du_da
.
oc_vsi
 !
y
.npdu_data.protocol_version) {

528 #i
PRINT_ENABLED


529 
	`rtf
(
dr
,

533  
l
;

538 i(
que
.
du_da
.
iܙy
 !
y
.npdu_data.priority) {

539 #i
PRINT_ENABLED


540 
	`rtf
(
dr
,

543  
l
;

546 i(!
	`ba_addss_me
(&
que
.
addss
, &
y
.address)) {

547 #i
PRINT_ENABLED


548 
	`rtf
(
dr
,

551  
l
;

554  
ue
;

555 
	}
}

558 
ut16_t
 
	$MSTP_G_Rly
(

559 vީ
mp_pt_ru_t
 * 
mp_pt
,

560 
timeout
)

562 
ut16_t
 
pdu_n
 = 0;

563 
bo
 
mched
 = 
l
;

564 
ut8_t
 
ame_ty
 = 0;

565 
mp_pdu_ck
 *
pkt
;

566 
SHARED_MSTP_DATA
 *
poShedDa
 = (SHARED_MSTP_DATA *
mp_pt
->
UrDa
;

568 i(!
poShedDa
) {

572 i(
	`Rgbuf_Emy
(&
poShedDa
->
PDU_Queue
)) {

575 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
poShedDa
->
PDU_Queue
);

577 
mched
 =

578 
	`dlmp_com_da_exg_y
(&
mp_pt
->
IutBufr
[0],

579 
mp_pt
->
DaLgth
, mp_pt->
SourAddss
,

580 (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
,kt->
dei_mac
);

581 i(!
mched
) {

584 i(
pkt
->
da_exg_y
) {

585 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

587 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

590 
pdu_n
 = 
	`MSTP_Ce_Fme
(&
mp_pt
->
OuutBufr
[0],

591 
mp_pt
->
OuutBufrSize
, 
ame_ty
, 
pkt
->
dei_mac
,

592 
mp_pt
->
This_Sti
, (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

593 (
	`Rgbuf_P
(&
poShedDa
->
PDU_Queue
, 
NULL
);

595  
pdu_n
;

596 
	}
}

598 
	$dlmp_t_mac_addss
(

599 *
poPt
,

600 
ut8_t
 
mac_addss
)

603 
mp_pt_ru_t
 *
mp_pt
 =

604 (
mp_pt_ru_t
 *
poPt
;

605 i(!
mp_pt
) {

616 i(
mac_addss
 <= 127) {

617 
mp_pt
->
This_Sti
 = 
mac_addss
;

623 i(
mac_addss
 > 
mp_pt
->
Nmax_ma
)

624 
	`dlmp_t_max_ma
(
mp_pt
, 
mac_addss
);

628 
	}
}

630 
ut8_t
 
	$dlmp_mac_addss
(

631 *
poPt
)

634 
mp_pt_ru_t
 *
mp_pt
 =

635 (
mp_pt_ru_t
 *
poPt
;

636 i(!
mp_pt
) {

646  
mp_pt
->
This_Sti
;

647 
	}
}

656 
	$dlmp_t_max_fo_ames
(

657 *
poPt
,

658 
ut8_t
 
max_fo_ames
)

661 
mp_pt_ru_t
 *
mp_pt
 =

662 (
mp_pt_ru_t
 *
poPt
;

663 i(!
mp_pt
) {

673 i(
max_fo_ames
 >= 1) {

674 
mp_pt
->
Nmax_fo_ames
 = 
max_fo_ames
;

683 
	}
}

685 
ut8_t
 
	$dlmp_max_fo_ames
(

686 *
poPt
)

689 
mp_pt_ru_t
 *
mp_pt
 =

690 (
mp_pt_ru_t
 *
poPt
;

691 i(!
mp_pt
) {

701  
mp_pt
->
Nmax_fo_ames
;

702 
	}
}

709 
	$dlmp_t_max_ma
(

710 *
poPt
,

711 
ut8_t
 
max_ma
)

714 
mp_pt_ru_t
 *
mp_pt
 =

715 (
mp_pt_ru_t
 *
poPt
;

716 i(!
mp_pt
) {

726 i(
max_ma
 <= 127) {

727 i(
mp_pt
->
This_Sti
 <
max_ma
) {

728 
mp_pt
->
Nmax_ma
 = 
max_ma
;

738 
	}
}

740 
ut8_t
 
	$dlmp_max_ma
(

741 *
poPt
)

744 
mp_pt_ru_t
 *
mp_pt
 =

745 (
mp_pt_ru_t
 *
poPt
;

746 i(!
mp_pt
) {

756  
mp_pt
->
Nmax_ma
;

757 
	}
}

760 
	$dlmp_t_baud_
(

761 *
poPt
,

762 
ut32_t
 
baud
)

764 
SHARED_MSTP_DATA
 *
poShedDa
;

765 
mp_pt_ru_t
 *
mp_pt
 =

766 (
mp_pt_ru_t
 *
poPt
;

767 i(!
mp_pt
) {

770 
poShedDa
 = (
SHARED_MSTP_DATA
 *
mp_pt
->
UrDa
;

771 i(!
poShedDa
) {

775 
baud
) {

777 
poShedDa
->
RS485_Baud
 = 
B9600
;

780 
poShedDa
->
RS485_Baud
 = 
B19200
;

783 
poShedDa
->
RS485_Baud
 = 
B38400
;

786 
poShedDa
->
RS485_Baud
 = 
B57600
;

789 
poShedDa
->
RS485_Baud
 = 
B115200
;

794 
	}
}

796 
ut32_t
 
	$dlmp_baud_
(

797 *
poPt
)

799 
SHARED_MSTP_DATA
 *
poShedDa
;

800 
mp_pt_ru_t
 *
mp_pt
 =

801 (
mp_pt_ru_t
 *
poPt
;

802 i(!
mp_pt
) {

803  
l
;

805 
poShedDa
 = (
SHARED_MSTP_DATA
 *
mp_pt
->
UrDa
;

806 i(!
poShedDa
) {

807  
l
;

810 
poShedDa
->
RS485_Baud
) {

811 
B19200
:

813 
B38400
:

815 
B57600
:

817 
B115200
:

820 
B9600
:

823 
	}
}

825 
	$dlmp_g_my_addss
(

826 *
poPt
,

827 
BACNET_ADDRESS
 * 
my_addss
)

829 
i
 = 0;

830 
SHARED_MSTP_DATA
 *
poShedDa
;

831 
mp_pt_ru_t
 *
mp_pt
 =

832 (
mp_pt_ru_t
 *
poPt
;

833 i(!
mp_pt
) {

836 
poShedDa
 = (
SHARED_MSTP_DATA
 *
mp_pt
->
UrDa
;

837 i(!
poShedDa
) {

840 
my_addss
->
mac_n
 = 1;

841 
my_addss
->
mac
[0] = 
mp_pt
->
This_Sti
;

842 
my_addss
->
t
 = 0;

843 
my_addss
->
n
 = 0;

844 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

845 
my_addss
->
adr
[
i
] = 0;

849 
	}
}

851 
	$dlmp_g_brd_addss
(

852 
BACNET_ADDRESS
 * 
de
)

854 
i
 = 0;

856 i(
de
) {

857 
de
->
mac_n
 = 1;

858 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

859 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

860 
de
->
n
 = 0;

861 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

862 
de
->
adr
[
i
] = 0;

867 
	}
}

869 
bo
 
	$dlmp_
(

870 *
poPt
,

871 *
iame
)

873 
hThad
 = 0;

874 
rv
 = 0;

875 
SHARED_MSTP_DATA
 *
poShedDa
;

876 
mp_pt_ru_t
 *
mp_pt
 =

877 (
mp_pt_ru_t
 *
poPt
;

878 i(!
mp_pt
) {

879  
l
;

882 
poShedDa
 =

883 (
SHARED_MSTP_DATA
 *((
mp_pt_ru_t
 *
mp_pt
)->

884 
UrDa
;

885 i(!
poShedDa
) {

886  
l
;

889 
poShedDa
->
RS485_Pt_Name
 = 
iame
;

891 
	`Rgbuf_In
(&
poShedDa
->
PDU_Queue
,

892 (
ut8_t
 *& 
poShedDa
->
PDU_Bufr
, (
mp_pdu_ck
),

893 
MSTP_PDU_PACKET_COUNT
);

895 
poShedDa
->
Reive_Pack
.
ady
 = 
l
;

896 
poShedDa
->
Reive_Pack
.
pdu_n
 = 0;

897 
rv
 = 
	`m_
(&
poShedDa
->
Reive_Pack_Fg
, 0, 0);

898 i(
rv
 != 0) {

899 
	`rtf
(
dr
,

901 
iame
);

902 
	`ex
(1);

905 
rmios
 
wtio
;

906 
	`tf
("RS485: Inlizg %s", 
poShedDa
->
RS485_Pt_Name
);

911 
poShedDa
->
RS485_Hd
 =

912 
	`ݒ
(
poShedDa
->
RS485_Pt_Name
,

913 
O_RDWR
 | 
O_NOCTTY
 | 
O_NONBLOCK
 );

914 i(
poShedDa
->
RS485_Hd
 < 0) {

915 
	`
(
poShedDa
->
RS485_Pt_Name
);

916 
	`ex
(-1);

920 
	`f
(
poShedDa
->
RS485_Hd
, 
F_SETFL
, 
FNDELAY
);

923 
	`f
(
poShedDa
->
RS485_Hd
, 
F_SETFL
, 0);

926 
	`tcg
(
poShedDa
->
RS485_Hd
, &poShedDa->
RS485_dtio
);

928 
	`bzo
(&
wtio
, (newtio));

936 
wtio
.
c_cag
 =

937 
poShedDa
->
RS485_Baud
 |oShedDa->
RS485MOD
 | 
CLOCAL
 | 
CREAD
;

939 
wtio
.
c_iag
 = 0;

941 
wtio
.
c_oag
 = 0;

943 
wtio
.
c_lag
 = 0;

945 
	`tcr
(
poShedDa
->
RS485_Hd
, 
TCSAFLUSH
, &
wtio
);

947 
	`up
(200000);

948 
	`tcush
(
poShedDa
->
RS485_Hd
, 
TCIOFLUSH
);

950 
	`FIFO_In
(&
poShedDa
->
Rx_FIFO
,oShedDa->
Rx_Bufr
,

951 (
poShedDa
->
Rx_Bufr
));

952 
	`tf
("=success!\n");

953 
mp_pt
->
IutBufr
 = &
poShedDa
->
RxBufr
[0];

954 
mp_pt
->
IutBufrSize
 = (
poShedDa
->
RxBufr
);

955 
mp_pt
->
OuutBufr
 = &
poShedDa
->
TxBufr
[0];

956 
mp_pt
->
OuutBufrSize
 = (
poShedDa
->
TxBufr
);

957 
	`gtimeofday
(&
poShedDa
->
t
, 
NULL
);

958 
mp_pt
->
STim
 = 
Tim_S
;

959 
mp_pt
->
STimRet
 = 
Tim_S_Ret
;

960 
	`MSTP_In
(
mp_pt
);

961 #i
PRINT_ENABLED


962 
	`rtf
(
dr
, "MS/TP MAC: %02X\n", 
mp_pt
->
This_Sti
);

963 
	`rtf
(
dr
, "MS/TP Max_Ma: %02X\n", 
mp_pt
->
Nmax_ma
);

964 
	`rtf
(
dr
, "MS/TP Max_Info_Frames: %u\n",

965 
mp_pt
->
Nmax_fo_ames
);

968 
rv
 = 
	`had_
(&
hThad
, 
NULL
, 
dlmp_ma_fsm_sk
, 
mp_pt
);

969 i(
rv
 != 0) {

970 
	`rtf
(
dr
, "Failedo start Master Node FSMask\n");

973  
ue
;

974 
	}
}

	@ports/linux/dlmstp_linux.h

24 #ide
DLMSTP_LINUX_H


25 
	#DLMSTP_LINUX_H


	)

27 
	~"mp.h
"

29 
	~"bs/hadtys.h
"

30 
	~<mhe.h
>

32 
	~<dbo.h
>

33 
	~<dt.h
>

34 
	~<ddef.h
>

35 
	~"bacdef.h
"

36 
	~"du.h
"

37 
	~<rmios.h
>

38 
	~"fifo.h
"

39 
	~"rgbuf.h
"

42 
	#MAX_HEADER
 (2+1+1+1+2+1+2)

	)

43 
	#MAX_MPDU
 (
MAX_HEADER
+
MAX_PDU
)

	)

46 #ide
MSTP_PDU_PACKET_COUNT


47 
	#MSTP_PDU_PACKET_COUNT
 8

	)

50 
	sdlmp_ck
 {

51 
bo
 
	mady
;

52 
BACNET_ADDRESS
 
	maddss
;

53 
ut8_t
 
	mame_ty
;

54 
ut16_t
 
	mpdu_n
;

55 
ut8_t
 
	mpdu
[
MAX_MPDU
];

56 } 
	tDLMSTP_PACKET
;

59 
	smp_pdu_ck
 {

60 
bo
 
	mda_exg_y
;

61 
ut8_t
 
	mdei_mac
;

62 
ut16_t
 
	mngth
;

63 
ut8_t
 
	mbufr
[
MAX_MPDU
];

66 
	sshed_mp_da
 {

68 
ut16_t
 
	mMSTP_Packs
;

71 
DLMSTP_PACKET
 
	mReive_Pack
;

72 
DLMSTP_PACKET
 
	mTnsm_Pack
;

76 
m_t
 
	mReive_Pack_Fg
;

82 
had_cd_t
 
	mReived_Fme_Fg
;

83 
had_mux_t
 
	mReived_Fme_Mux
;

84 
had_cd_t
 
	mMa_De_Fg
;

85 
had_mux_t
 
	mMa_De_Mux
;

87 
ut8_t
 
	mTxBufr
[
MAX_MPDU
];

88 
ut8_t
 
	mRxBufr
[
MAX_MPDU
];

93 
ut16_t
 
	mTy_timeout
;

98 
ut8_t
 
	mTuge_timeout
;

100 
ut16_t
 
	mSTime
;

103 
	mRS485_Hd
;

106 
	mRS485_Baud
;

109 *
	mRS485_Pt_Name
;

111 
rmios
 
	mRS485_dtio
;

113 
tcag_t
 
	mRS485MOD
;

115 
FIFO_BUFFER
 
	mRx_FIFO
;

117 
ut8_t
 
	mRx_Bufr
[4096];

118 
timev
 
	mt
;

120 
RING_BUFFER
 
	mPDU_Queue
;

122 
mp_pdu_ck
 
	mPDU_Bufr
[
MSTP_PDU_PACKET_COUNT
];

124 } 
	tSHARED_MSTP_DATA
;

126 #ifde
__lulus


130 
bo
 
dlmp_
(

131 *
poShed
,

132 *
iame
);

133 
dlmp_t
(

134 *
poShed
);

135 
dlmp_nup
(

136 *
poShed
);

139 
dlmp_nd_pdu
(

140 *
poShed
,

141 
BACNET_ADDRESS
 * 
de
,

142 
ut8_t
 * 
pdu
,

143 
pdu_n
);

146 
ut16_t
 
dlmp_ive
(

147 *
poShed
,

148 
BACNET_ADDRESS
 * 
c
,

149 
ut8_t
 * 
pdu
,

150 
ut16_t
 
max_pdu
,

151 
timeout
);

160 
dlmp_t_max_fo_ames
(

161 *
poShed
,

162 
ut8_t
 
max_fo_ames
);

163 
ut8_t
 
dlmp_max_fo_ames
(

164 *
poShed
);

171 
dlmp_t_max_ma
(

172 *
poShed
,

173 
ut8_t
 
max_ma
);

174 
ut8_t
 
dlmp_max_ma
(

175 *
poShed
);

178 
dlmp_t_mac_addss
(

179 *
poShed
,

180 
ut8_t
 
my_addss
);

181 
ut8_t
 
dlmp_mac_addss
(

182 *
poShed
);

184 
dlmp_g_my_addss
(

185 *
poShed
,

186 
BACNET_ADDRESS
 * 
my_addss
);

187 
dlmp_g_brd_addss
(

188 
BACNET_ADDRESS
 * 
de
);

191 
dlmp_t_baud_
(

192 *
poShed
,

193 
ut32_t
 
baud
);

194 
ut32_t
 
dlmp_baud_
(

195 *
poShed
);

197 
dlmp_fl_ba_addss
(

198 
BACNET_ADDRESS
 * 
c
,

199 
ut8_t
 
mp_addss
);

201 
bo
 
dlmp_se_ma
(

204 #ifde
__lulus


	@ports/linux/ethernet.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

38 
	~"t.h
"

39 
	~"bacdef.h
"

40 
	~"ht.h
"

41 
	~"bact.h
"

46 
ut8_t
 
	gEtht_Brd
[
MAX_MAC_LEN
] =

49 
ut8_t
 
	gEtht_Emy_MAC
[
MAX_MAC_LEN
] = { 0, 0, 0, 0, 0, 0 };

52 
ut8_t
 
	gEtht_MAC_Addss
[
MAX_MAC_LEN
] = { 0 };

54 
	gh802_sockfd
 = -1;

55 
sockaddr
 
	gh_addr
 = { 0 };

57 
bo
 
	$ht_vid
(

60  (
h802_sockfd
 >= 0);

61 
	}
}

63 
	$ht_nup
(

66 i(
	`ht_vid
())

67 
	`o
(
h802_sockfd
);

68 
h802_sockfd
 = -1;

71 
	}
}

83 
	$tNblockg
(

84 
fd
)

86 
ags
;

88 i(-1 =(
ags
 = 
	`f
(
fd
, 
F_GETFL
, 0)))

89 
ags
 = 0;

90  
	`f
(
fd
, 
F_SETFL
, 
ags
 | 
O_NONBLOCK
);

91 
	}
}

95 
	$ht_bd
(

96 
sockaddr
 *
h_addr
,

97 *
r_me
)

99 
sock_fd
 = -1;

101 
sockt
 = 0;

103 
uid
 = 0;

105 
	`rtf
(
dr
, "ht: ong \"%s\"\n", 
r_me
);

107 
uid
 = 
	`guid
();

108 i(
uid
 != 0) {

109 
	`rtf
(
dr
,

112  
sock_fd
;

122 i((
sock_fd
 = 
	`sock
(
PF_INET
, 
SOCK_PACKET
, 
	`hts
(
ETH_P_802_2
))) < 0) {

124 
	`rtf
(
dr
, "ethernet: Error opening socket: %s\n",

125 
	`
(
o
));

126 
	`rtf
(
dr
,

132 
	`ex
(-1);

138 i(
	`tsockt
(
sock_fd
, 
IPPROTO_IP
, 
IP_HDRINCL
, &
sockt
,

139 (
sockt
)) < 0) {

140 
	`tf
("Warning: Cannot set HDRINCL!\n");

144 
h_addr
->
_my
 = 
PF_INET
;

146 
	`memt
(
h_addr
->
_da
, '\0', (eth_addr->sa_data));

148 
	`y
(
h_addr
->
_da
, 
r_me
, (eth_addr->sa_data) - 1);

149 
	`rtf
(
dr
, "ht: bdg \"%s\"\n", 
h_addr
->
_da
);

151 i(
	`bd
(
sock_fd
, 
h_addr
, (
sockaddr
)) != 0) {

153 
	`rtf
(
dr
, "ethernet: Unableo bind 802.2 socket : %s\n",

154 
	`
(
o
));

155 
	`rtf
(
dr
,

162 
	`o
(
sock_fd
);

163 
	`ex
(-1);

166 
	`ex
(
ht_nup
);

168  
sock_fd
;

169 
	}
}

172 
	$g_lol_hwaddr
(

173 cڡ *
iame
,

174 *
mac
)

176 
ieq
 
i
;

177 
fd
;

178 
rv
;

181 
	`ry
(
i
.
i_me
, 
iame
);

182 
fd
 = 
	`sock
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_IP
);

183 i(
fd
 < 0)

184 
rv
 = 
fd
;

186 
rv
 = 
	`iol
(
fd
, 
SIOCGIFHWADDR
, &
i
);

187 i(
rv
 >= 0)

188 
	`memy
(
mac
, 
i
.
i_hwaddr
.
_da
, 
IFHWADDRLEN
);

191  
rv
;

192 
	}
}

194 
bo
 
	$ht_
(

195 *
r_me
)

197 i(
r_me
) {

198 
	`g_lol_hwaddr
(
r_me
, 
Etht_MAC_Addss
);

199 
h802_sockfd
 = 
	`ht_bd
(&
h_addr
, 
r_me
);

201 
	`g_lol_hwaddr
("h0", 
Etht_MAC_Addss
);

202 
h802_sockfd
 = 
	`ht_bd
(&
h_addr
, "eth0");

205  
	`ht_vid
();

206 
	}
}

208 
	$ht_nd
(

209 
ut8_t
 * 
mtu
,

210 
mtu_n
)

212 
bys
 = 0;

215 
bys
 =

216 
	`ndto
(
h802_sockfd
, &
mtu
, 
mtu_n
, 0, (
sockaddr
 *&
h_addr
,

217 (
sockaddr
));

219 i(
bys
 < 0)

220 
	`rtf
(
dr
, "ethernet: Error sendingacket: %s\n",

221 
	`
(
o
));

223  
bys
;

225 
	}
}

229 
	$ht_nd_pdu
(

230 
BACNET_ADDRESS
 * 
de
,

231 
BACNET_NPDU_DATA
 * 
du_da
,

232 
ut8_t
 * 
pdu
,

233 
pdu_n
)

235 
i
 = 0;

236 
bys
 = 0;

237 
BACNET_ADDRESS
 
c
 = { 0 };

238 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

239 
mtu_n
 = 0;

241 (
du_da
;

243 
i
 = 0; i < 6; i++) {

244 
c
.
mac
[
i
] = 
Etht_MAC_Addss
[i];

245 
c
.
mac_n
++;

249 i(
h802_sockfd
 < 0) {

250 
	`rtf
(
dr
, "ethernet: 802.2 socket is invalid!\n");

254 i(
de
->
mac_n
 == 6) {

255 
i
 = 0; i < 6; i++) {

256 
mtu
[
i
] = 
de
->
mac
[i];

259 
	`rtf
(
dr
, "ethernet: invalid destination MACddress!\n");

264 i(
c
.
mac_n
 == 6) {

265 
i
 = 0; i < 6; i++) {

266 
mtu
[6 + 
i
] = 
c
.
mac
[i];

269 
	`rtf
(
dr
, "ethernet: invalid source MACddress!\n");

273 
mtu
[14] = 0x82;

274 
mtu
[15] = 0x82;

275 
mtu
[16] = 0x03;

276 
mtu_n
 = 17;

277 i((
mtu_n
 + 
pdu_n
> 
MAX_MPDU
) {

278 
	`rtf
(
dr
, "ethernet: PDU isoo bigo send!\n");

281 
	`memy
(&
mtu
[
mtu_n
], 
pdu
, 
pdu_n
);

282 
mtu_n
 +
pdu_n
;

284 
	`code_unsigd16
(&
mtu
[12], 3 + 
pdu_n
);

287 
bys
 =

288 
	`ndto
(
h802_sockfd
, &
mtu
, 
mtu_n
, 0, (
sockaddr
 *&
h_addr
,

289 (
sockaddr
));

291 i(
bys
 < 0)

292 
	`rtf
(
dr
, "ethernet: Error sendingacket: %s\n",

293 
	`
(
o
));

295  
bys
;

296 
	}
}

300 
ut16_t
 
	$ht_ive
(

301 
BACNET_ADDRESS
 * 
c
,

302 
ut8_t
 * 
pdu
,

303 
ut16_t
 
max_pdu
,

304 
timeout
)

306 
ived_bys
;

307 
ut8_t
 
buf
[
MAX_MPDU
] = { 0 };

308 
ut16_t
 
pdu_n
 = 0;

309 
fd_t
 
ad_fds
;

310 
max
;

311 
timev
 
_timeout
;

314 i(
h802_sockfd
 <= 0)

320 i(
timeout
 >= 1000) {

321 
_timeout
.
tv_c
 = 
timeout
 / 1000;

322 
_timeout
.
tv_uc
 =

323 1000 * (
timeout
 - 
_timeout
.
tv_c
 * 1000);

325 
_timeout
.
tv_c
 = 0;

326 
_timeout
.
tv_uc
 = 1000 * 
timeout
;

328 
	`FD_ZERO
(&
ad_fds
);

329 
	`FD_SET
(
h802_sockfd
, &
ad_fds
);

330 
max
 = 
h802_sockfd
;

332 i(
	`
(
max
 + 1, &
ad_fds
, 
NULL
, NULL, &
_timeout
) > 0)

333 
ived_bys
 = 
	`ad
(
h802_sockfd
, &
buf
[0], (buf));

338 i(
ived_bys
 < 0) {

342 i(
o
 !
EAGAIN
)

343 
	`rtf
(
dr
, "ethernet: Readrror ineceivingacket: %s\n",

344 
	`
(
o
));

348 i(
ived_bys
 == 0)

352 i((
buf
[14] != 0x82) && (buf[15] != 0x82)) {

357 
c
->
mac_n
 = 6;

358 
	`memmove
(
c
->
mac
, &
buf
[6], 6);

362 i((
	`memcmp
(&
buf
[0], 
Etht_MAC_Addss
, 6) != 0)

363 && (
	`memcmp
(&
buf
[0], 
Etht_Brd
, 6) != 0)) {

368 (
	`decode_unsigd16
(&
buf
[12], &
pdu_n
);

369 
pdu_n
 -= 3 ;

371 i(
pdu_n
 < 
max_pdu
)

372 
	`memmove
(&
pdu
[0], &
buf
[17], 
pdu_n
);

375 
pdu_n
 = 0;

378  
pdu_n
;

379 
	}
}

381 
	$ht_t_my_addss
(

382 
BACNET_ADDRESS
 * 
my_addss
)

384 
i
 = 0;

386 
i
 = 0; i < 6; i++) {

387 
Etht_MAC_Addss
[
i
] = 
my_addss
->
mac
[i];

391 
	}
}

393 
	$ht_g_my_addss
(

394 
BACNET_ADDRESS
 * 
my_addss
)

396 
i
 = 0;

398 
my_addss
->
mac_n
 = 0;

399 
i
 = 0; i < 6; i++) {

400 
my_addss
->
mac
[
i
] = 
Etht_MAC_Addss
[i];

401 
my_addss
->
mac_n
++;

403 
my_addss
->
t
 = 0;

404 
my_addss
->
n
 = 0;

405 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

406 
my_addss
->
adr
[
i
] = 0;

410 
	}
}

412 
	$ht_g_brd_addss
(

413 
BACNET_ADDRESS
 * 
de
)

415 
i
 = 0;

417 i(
de
) {

418 
i
 = 0; i < 6; i++) {

419 
de
->
mac
[
i
] = 
Etht_Brd
[i];

421 
de
->
mac_n
 = 6;

422 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

423 
de
->
n
 = 0;

424 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

425 
de
->
adr
[
i
] = 0;

430 
	}
}

432 
	$ht_debug_addss
(

433 cڡ *
fo
,

434 
BACNET_ADDRESS
 * 
de
)

436 
i
 = 0;

438 i(
fo
)

439 
	`rtf
(
dr
, "%s", 
fo
);

440 i(
de
) {

441 
	`rtf
(
dr
, "Address:\n");

442 
	`rtf
(
dr
, " MAC Lgth=%d\n", 
de
->
mac_n
);

443 
	`rtf
(
dr
, " MAC Address=");

444 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

445 
	`rtf
(
dr
, "%02X ", (
de
->
mac
[
i
]);

447 
	`rtf
(
dr
, "\n");

448 
	`rtf
(
dr
, " N=%hu\n", 
de
->
t
);

449 
	`rtf
(
dr
, " L=%d\n", 
de
->
n
);

450 
	`rtf
(
dr
, " Adr=");

451 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

452 
	`rtf
(
dr
, "%02X ", (
de
->
adr
[
i
]);

454 
	`rtf
(
dr
, "\n");

458 
	}
}

	@ports/linux/mstpsnap.c

35 
	~<ddef.h
>

36 
	~<dt.h
>

37 
	~<dio.h
>

38 
	~<dlib.h
>

39 
	~<rg.h
>

40 
	~<o.h
>

42 
	~"t.h
"

43 
	~"tim.h
"

45 
	~"bys.h
"

46 
	~"rs485.h
"

47 
	~"c.h
"

48 
	~"mp.h
"

49 
	~"dlmp.h
"

50 
	~"mext.h
"

51 
	~"bact.h
"

55 #ide
max


56 
	#max
(
a
,
b
(((b)? (a: (b))

	)

57 
	#m
(
a
,
b
((< (b)? (a: (b))

	)

61 vީ
mp_pt_ru_t
 
	gMSTP_Pt
;

63 
ut8_t
 
	gRxBufr
[
MAX_MPDU
];

64 
ut8_t
 
	gTxBufr
[
MAX_MPDU
];

65 
ut32_t
 
	$Tim_S
(

66 *
pArg
)

68 
ut32_t
 
d_time
 = 0;

70 
d_time
 = 
	`tim_mlicds
(
TIMER_SILENCE
);

71 i(
d_time
 > 0xFFFF) {

72 
d_time
 = 0xFFFF;

75  
d_time
;

76 
	}
}

78 
	$Tim_S_Ret
(

79 *
pArg
)

81 
	`tim_t
(
TIMER_SILENCE
);

82 
	}
}

85 
ut16_t
 
	$MSTP_Put_Reive
(

86 vީ
mp_pt_ru_t
 *
mp_pt
)

88 (
mp_pt
;

91 
	}
}

95 
ut16_t
 
	$MSTP_G_Sd
(

96 vީ
mp_pt_ru_t
 * 
mp_pt
,

97 
timeout
)

99 (
mp_pt
;

100 (
timeout
;

102 
	}
}

104 
ut16_t
 
	$MSTP_G_Rly
(

105 vީ
mp_pt_ru_t
 * 
mp_pt
,

106 
timeout
)

108 (
mp_pt
;

109 (
timeout
;

111 
	}
}

113 
	$twk_
(

114 cڡ *
me
,

115 
oc
)

118 i(
	`guid
() != 0) {

119 
	`rtf
(
dr
, "Requiresootriveleges.\n");

123 
sockfd
 = 
	`sock
(
PF_PACKET
, 
SOCK_RAW
, 
	`hts
(
oc
));

125 i(
sockfd
 == -1) {

126 
	`
("Unableo create socket");

127  
sockfd
;

130 
ieq
 
i
;

132 
	`memt
(&
i
, 0, (ifr));

133 
	`y
(
i
.
i_me
, 
me
, 
	`
(name));

135 i(
	`iol
(
sockfd
, 
SIOCGIFINDEX
, &
i
) == -1) {

136 
	`
("Unableo get interface index");

140 
sockaddr_
 
l
;

142 
	`memt
(&
l
, 0, (sll));

143 
l
.
l_my
 = 
AF_PACKET
;

144 
l
.
l_ifdex
 = 
i
.
i_ifdex
;

145 
l
.
l_oc
 = 
	`hts
(
oc
);

147 i(
	`bd
(
sockfd
, (
sockaddr
 *&
l
, (sll)) == -1) {

148 
	`
("Unableo bind socket");

152  
sockfd
;

153 
	}
}

155 
	$_ived_ck
(

156 vީ
mp_pt_ru_t
 *
mp_pt
,

157 
sockfd
)

159 
ut16_t
 
mtu_n
 = 0;

160 
i
 = 0;

161 
ut8_t
 
mtu
[1500] = { 0 };

162 
ut16_t
 
max_da
 = 0;

164 
mtu
[0] = 0;

165 
mtu
[1] = 0;

166 
mtu
[2] = 0;

167 
mtu
[3] = 0;

168 
mtu
[4] = 0;

169 
mtu
[5] = 
mp_pt
->
DeiAddss
;

170 
mtu
[6] = 0;

171 
mtu
[7] = 0;

172 
mtu
[8] = 0;

173 
mtu
[9] = 0;

174 
mtu
[10] = 0;

175 
mtu
[11] = 
mp_pt
->
SourAddss
;

177 
mtu
[14] = 0xaa;

178 
mtu
[15] = 0xaa;

179 
mtu
[16] = 0x03;

180 
mtu
[17] = 0x00;

181 
mtu
[18] = 0x10;

182 
mtu
[19] = 0x90;

183 
mtu
[20] = 0x00;

184 
mtu
[21] = 0x01;

185 
mtu
[22] = 0x00;

186 
mtu
[23] = 0x00;

187 
mtu
[24] = 0x80;

188 
mtu
[25] = 
mp_pt
->
FmeTy
;

189 
mtu
[26] = 
mp_pt
->
DeiAddss
;

190 
mtu
[27] = 
mp_pt
->
SourAddss
;

191 
mtu
[28] = 
	`HI_BYTE
(
mp_pt
->
DaLgth
);

192 
mtu
[29] = 
	`LO_BYTE
(
mp_pt
->
DaLgth
);

193 
mtu
[30] = 
mp_pt
->
HdCRCAu
;

194 
mtu_n
 = 31;

195 i(
mp_pt
->
DaLgth
) {

196 
max_da
 = 
	`m
(
mp_pt
->
IutBufrSize
, mp_pt->
DaLgth
);

197 
i
 = 0; i < 
max_da
; i++) {

198 
mtu
[31 + 
i
] = 
mp_pt
->
IutBufr
[i];

200 
mtu
[31 + 
max_da
] = 
mp_pt
->
DaCRCAuMSB
;

201 
mtu
[31 + 
max_da
 + 1] = 
mp_pt
->
DaCRCAuLSB
;

202 
mtu_n
 +(
max_da
 + 2);

205 
	`code_unsigd16
(&
mtu
[12], 
mtu_n
 - 14);

206 (
	`wre
(
sockfd
, &
mtu
[0], 
mtu_n
);

207 
	}
}

210 
	$nup
(

213 
	}
}

215 #i(!
defed
(
_WIN32
))

216 
	$sig_t
(

217 
signo
)

219 (
signo
;

221 
	`nup
();

222 
	`ex
(0);

223 
	}
}

225 
	$sigl_
(

228 
	`sigl
(
SIGINT
, 
sig_t
);

229 
	`sigl
(
SIGHUP
, 
sig_t
);

230 
	`sigl
(
SIGTERM
, 
sig_t
);

231 
	}
}

235 
	$ma
(

236 
gc
,

237 *
gv
[])

239 vީ
mp_pt_ru_t
 *
mp_pt
;

240 
my_baud
 = 38400;

241 
ut32_t
 
ck_cou
 = 0;

242 
sockfd
 = -1;

243 *
my_r
 = "eth0";

246 
mp_pt
 = &
MSTP_Pt
;

247 i((
gc
 > 1&& (
	`rcmp
(
gv
[1], "--help") == 0)) {

248 
	`tf
("mstsnap [serial] [baud] [network]\r\n"

260 i(
gc
 > 1) {

261 
	`RS485_S_I
(
gv
[1]);

263 i(
gc
 > 2) {

264 
my_baud
 = 
	`
(
gv
[2], 
NULL
, 0);

266 i(
gc
 > 3) {

267 
my_r
 = 
gv
[3];

269 
sockfd
 = 
	`twk_
(
my_r
, 
ETH_P_ALL
);

270 i(
sockfd
 == -1) {

273 
	`RS485_S_Baud_Re
(
my_baud
);

274 
	`RS485_Inlize
();

275 
MSTP_Pt
.
IutBufr
 = &
RxBufr
[0];

276 
MSTP_Pt
.
IutBufrSize
 = (
RxBufr
);

277 
MSTP_Pt
.
OuutBufr
 = &
TxBufr
[0];

278 
MSTP_Pt
.
OuutBufrSize
 = (
TxBufr
);

279 
MSTP_Pt
.
This_Sti
 = 127;

280 
MSTP_Pt
.
Nmax_fo_ames
 = 1;

281 
MSTP_Pt
.
Nmax_ma
 = 127;

282 
MSTP_Pt
.
STim
 = 
Tim_S
;

283 
MSTP_Pt
.
STimRet
 = 
Tim_S_Ret
;

284 
	`MSTP_In
(
mp_pt
);

285 
	`rtf
(
dout
, "mstpcap: Using %s for capturet %ld bps.\n",

286 
	`RS485_I
(), (
	`RS485_G_Baud_Re
());

287 
	`ex
(
nup
);

288 #i
	`defed
(
_WIN32
)

289 
	`SCseMode
(
	`GStdHd
(
STD_INPUT_HANDLE
), 
ENABLE_PROCESSED_INPUT
);

290 
	`SCseClHdr
((
PHANDLER_ROUTINE

ClCHdr
, 
TRUE
);

292 
	`sigl_
();

296 
	`RS485_Check_UART_Da
(
mp_pt
);

297 
	`MSTP_Reive_Fme_FSM
(
mp_pt
);

299 i(
mp_pt
->
ReivedVidFme
) {

300 
mp_pt
->
ReivedVidFme
 = 
l
;

301 
	`_ived_ck
(
mp_pt
, 
sockfd
);

302 
ck_cou
++;

303 } i(
mp_pt
->
ReivedInvidFme
) {

304 
mp_pt
->
ReivedInvidFme
 = 
l
;

305 
	`rtf
(
dr
, "ReceivedInvalidFrame\n");

306 
	`_ived_ck
(
mp_pt
, 
sockfd
);

307 
ck_cou
++;

309 i(!(
ck_cou
 % 100)) {

310 
	`rtf
(
dout
, "\r%huacks", 
ck_cou
);

315 
	}
}

	@ports/linux/net.h

26 #ide
NET_H


27 
	#NET_H


	)

30 
	~<sys/tys.h
>

31 
	~<sys/time.h
>

32 
	~<time.h
>

33 
	~<t/.h
>

34 
	~</.h
>

35 
	~<f.h
>

36 
	~<tdb.h
>

37 
	~<o.h
>

38 
	~<sigl.h
>

39 
	~<dio.h
>

40 
	~<dlib.h
>

41 
	~<rg.h
>

42 
	~<sys/.h
>

43 
	~<sys/uio.h
>

44 
	~<unid.h
>

45 
	~<sys/wa.h
>

46 
	~<sys/un.h
>

48 #ifdef 
HAVE_SYS_SELECT_H


49 
	~<sys/.h
>

52 #ifdef 
HAVE_POLL_H


53 
	~<pl.h
>

56 #ifdef 
HAVE_STRINGS_H


57 
	~<rgs.h
>

63 #ifdef 
HAVE_SYS_IOCTL_H


64 
	~<sys/iol.h
>

66 #ifdef 
HAVE_SYS_FILIO_H


67 
	~<sys/fio.h
>

69 #ifdef 
HAVE_SYS_SOCKIO_H


70 
	~<sys/sockio.h
>

73 
	~<had.h
>

74 
	~<mhe.h
>

76 
	#ENUMS


	)

77 
	~<sys/sock.h
>

78 
	~<t/rou.h
>

79 
	~<t/if.h
>

80 
	~<t/if_p.h
>

81 
	~<us.h
>

82 #i
__GLIBC__
 >2 && 
__GLIBC_MINOR
 >= 1

83 
	~<Íack/ck.h
>

84 
	~<t/ht.h
>

86 
	~<asm/tys.h
>

87 
	~<lux/if_ck.h
>

88 
	~<lux/if_.h
>

89 
	~<lux/if_h.h
>

91 
	~<t/.h
>

92 
	~</.h
>

93 
	~<sys/un.h
>

94 
	~<sys/iol.h
>

95 
	~<tdb.h
>

100 
b_g_lol_tmask
(

101 
_addr
 *
tmask
);

	@ports/linux/rs485.c

42 
	~<o.h
>

43 
	~<ddef.h
>

44 
	~<dt.h
>

45 
	~<dbo.h
>

46 
	~<dio.h
>

47 
	~<dlib.h
>

48 
	~<rg.h
>

51 
	~<sys/tys.h
>

52 
	~<sys/.h
>

53 
	~<f.h
>

54 
	~<rmios.h
>

55 
	~<unid.h
>

56 
	~<sched.h
>

57 
	~<lux/rl.h
>

58 
	~<mh.h
>

59 
	~<sys/iol.h
>

61 
	~<dt.h
>

63 
	~<libg.h
>

66 
	~"mp.h
"

67 
	~"rs485.h
"

68 
	~"fifo.h
"

70 
	~<sys/.h
>

71 
	~<sys/time.h
>

73 
	~"dlmp_lux.h
"

83 
	gRS485_Hd
 = -1;

86 
	gRS485_Baud
 = 
B38400
;

89 *
	gRS485_Pt_Name
 = "/dev/ttyUSB0";

91 #ide
RS485MOD


92 
	#RS485MOD
 0

	)

95 
rmios
 
	gRS485_dtio
;

97 
rl_ru
 
	gRS485_drl
;

99 
bo
 
	gRS485_ScBaud
 = 
l
;

102 
FIFO_BUFFER
 
	gRx_FIFO
;

104 
ut8_t
 
	gRx_Bufr
[4096];

106 
	#_POSIX_SOURCE
 1

	)

114 
	$RS485_S_I
(

115 *
iame
)

118 i(
iame
) {

119 
RS485_Pt_Name
 = 
iame
;

121 
	}
}

129 cڡ *
	$RS485_I
(

132  
RS485_Pt_Name
;

133 
	}
}

141 
ut32_t
 
	$RS485_G_Baud_Re
(

144 
ut32_t
 
baud
 = 0;

146 
RS485_Baud
) {

147 
B0
:

148 
baud
 = 0;

150 
B50
:

151 
baud
 = 50;

153 
B75
:

154 
baud
 = 75;

156 
B110
:

157 
baud
 = 110;

159 
B134
:

160 
baud
 = 134;

162 
B150
:

163 
baud
 = 150;

165 
B200
:

166 
baud
 = 200;

168 
B300
:

169 
baud
 = 300;

171 
B600
:

172 
baud
 = 600;

174 
B1200
:

175 
baud
 = 1200;

177 
B1800
:

178 
baud
 = 1800;

180 
B2400
:

181 
baud
 = 2400;

183 
B4800
:

184 
baud
 = 4800;

186 
B9600
:

187 
baud
 = 9600;

189 
B19200
:

190 
baud
 = 19200;

192 
B38400
:

193 i(!
RS485_ScBaud
) {

196 
baud
 = 38400;

198 
baud
 = 76800;

201 
B57600
:

202 
baud
 = 57600;

204 
B115200
:

205 
baud
 = 115200;

207 
B230400
:

208 
baud
 = 230400;

211 
baud
 = 9600;

214  
baud
;

215 
	}
}

223 
ut32_t
 
	$RS485_G_Pt_Baud_Re
(

224 vީ
mp_pt_ru_t
 * 
mp_pt
)

226 
ut32_t
 
baud
 = 0;

227 
SHARED_MSTP_DATA
 *
poShedDa
 = (SHARED_MSTP_DATA *
mp_pt
->
UrDa
;

228 i(!
poShedDa
) {

231 
poShedDa
->
RS485_Baud
) {

232 
B0
:

233 
baud
 = 0;

235 
B50
:

236 
baud
 = 50;

238 
B75
:

239 
baud
 = 75;

241 
B110
:

242 
baud
 = 110;

244 
B134
:

245 
baud
 = 134;

247 
B150
:

248 
baud
 = 150;

250 
B200
:

251 
baud
 = 200;

253 
B300
:

254 
baud
 = 300;

256 
B600
:

257 
baud
 = 600;

259 
B1200
:

260 
baud
 = 1200;

262 
B1800
:

263 
baud
 = 1800;

265 
B2400
:

266 
baud
 = 2400;

268 
B4800
:

269 
baud
 = 4800;

271 
B9600
:

272 
baud
 = 9600;

274 
B19200
:

275 
baud
 = 19200;

277 
B38400
:

278 
baud
 = 38400;

280 
B57600
:

281 
baud
 = 57600;

283 
B115200
:

284 
baud
 = 115200;

286 
B230400
:

287 
baud
 = 230400;

290 
baud
 = 9600;

294  
baud
;

295 
	}
}

303 
bo
 
	$RS485_S_Baud_Re
(

304 
ut32_t
 
baud
)

306 
bo
 
vid
 = 
ue
;

308 
RS485_ScBaud
 = 
l
;

309 
baud
) {

311 
RS485_Baud
 = 
B0
;

314 
RS485_Baud
 = 
B50
;

317 
RS485_Baud
 = 
B75
;

320 
RS485_Baud
 = 
B110
;

323 
RS485_Baud
 = 
B134
;

326 
RS485_Baud
 = 
B150
;

329 
RS485_Baud
 = 
B200
;

332 
RS485_Baud
 = 
B300
;

335 
RS485_Baud
 = 
B600
;

338 
RS485_Baud
 = 
B1200
;

341 
RS485_Baud
 = 
B1800
;

344 
RS485_Baud
 = 
B2400
;

347 
RS485_Baud
 = 
B4800
;

350 
RS485_Baud
 = 
B9600
;

353 
RS485_Baud
 = 
B19200
;

356 
RS485_Baud
 = 
B38400
;

359 
RS485_Baud
 = 
B57600
;

362 
RS485_Baud
 = 
B38400
;

363 
RS485_ScBaud
 = 
ue
;

366 
RS485_Baud
 = 
B115200
;

369 
RS485_Baud
 = 
B230400
;

372 
vid
 = 
l
;

376 i(
vid
) {

380  
vid
;

381 
	}
}

389 
	$RS485_Sd_Fme
(

390 vީ
mp_pt_ru_t
 *
mp_pt
,

391 
ut8_t
 * 
bufr
,

392 
ut16_t
 
nbys
)

394 
ut32_t
 
tuound_time
 = 
Ttuound
 * 1000;

395 
ut32_t
 
baud
;

396 
ssize_t
 
wrn
 = 0;

397 
gska
;

398 
SHARED_MSTP_DATA
 *
poShedDa
 = 
NULL
;

400 i(
mp_pt
) {

401 
poShedDa
 = (
SHARED_MSTP_DATA
 *
mp_pt
->
UrDa
;

403 i(!
poShedDa
) {

404 
baud
 = 
	`RS485_G_Baud_Re
();

407 
	`up
(
tuound_time
 / 
baud
);

415 
wrn
 = 
	`wre
(
RS485_Hd
, 
bufr
, 
nbys
);

416 
gska
 = 
o
;

417 i(
wrn
 <= 0) {

418 
	`tf
("wrr: %s\n", 
	`
(
gska
));

421 
	`tcd
(
RS485_Hd
);

425 i(
mp_pt
) {

426 
mp_pt
->
	`STimRet
((*) mstp_port);

429 
baud
 = 
	`RS485_G_Pt_Baud_Re
(
mp_pt
);

432 
	`up
(
tuound_time
 / 
baud
);

440 
wrn
 = 
	`wre
(
poShedDa
->
RS485_Hd
, 
bufr
, 
nbys
);

441 
gska
 = 
o
;

442 i(
wrn
 <= 0) {

443 
	`tf
("wrr: %s\n", 
	`
(
gska
));

446 
	`tcd
(
poShedDa
->
RS485_Hd
);

450 i(
mp_pt
) {

451 
mp_pt
->
	`STimRet
((*) mstp_port);

456 
	}
}

464 
	$RS485_Check_UART_Da
(

465 vީ
mp_pt_ru_t
 *
mp_pt
)

467 
fd_t
 
put
;

468 
timev
 
wa
;

469 
ut8_t
 
buf
[2048];

470 
n
;

472 
SHARED_MSTP_DATA
 *
poShedDa
 = (SHARED_MSTP_DATA *
mp_pt
->
UrDa
;

473 i(!
poShedDa
) {

474 i(
mp_pt
->
ReiveE
 =
ue
) {

477 
wa
.
tv_c
 = 0;

478 
wa
.
tv_uc
 = 5000;

479 } i(
mp_pt
->
DaAvaab
 =
l
) {

481 i(
	`FIFO_Cou
(&
Rx_FIFO
) > 0) {

483 
mp_pt
->
DaRegi
 = 
	`FIFO_G
(&
Rx_FIFO
);

484 
mp_pt
->
DaAvaab
 = 
ue
;

486 
wa
.
tv_c
 = 0;

487 
wa
.
tv_uc
 = 10;

490 
wa
.
tv_c
 = 0;

491 
wa
.
tv_uc
 = 5000;

495 
	`FD_ZERO
(&
put
);

496 
	`FD_SET
(
RS485_Hd
, &
put
);

497 
n
 = 
	`
(
RS485_Hd
 + 1, &
put
, 
NULL
, NULL, &
wa
);

498 i(
n
 < 0) {

501 i(
	`FD_ISSET
(
RS485_Hd
, &
put
)) {

502 
n
 = 
	`ad
(
RS485_Hd
, 
buf
, (buf));

503 
	`FIFO_Add
(&
Rx_FIFO
, &
buf
[0], 
n
);

506 i(
mp_pt
->
ReiveE
 =
ue
) {

509 
wa
.
tv_c
 = 0;

510 
wa
.
tv_uc
 = 5000;

511 } i(
mp_pt
->
DaAvaab
 =
l
) {

513 i(
	`FIFO_Cou
(&
poShedDa
->
Rx_FIFO
) > 0) {

515 
mp_pt
->
DaRegi
 = 
	`FIFO_G
(&
poShedDa
->
Rx_FIFO
);

516 
mp_pt
->
DaAvaab
 = 
ue
;

518 
wa
.
tv_c
 = 0;

519 
wa
.
tv_uc
 = 10;

522 
wa
.
tv_c
 = 0;

523 
wa
.
tv_uc
 = 5000;

527 
	`FD_ZERO
(&
put
);

528 
	`FD_SET
(
poShedDa
->
RS485_Hd
, &
put
);

529 
n
 = 
	`
(
poShedDa
->
RS485_Hd
 + 1, &
put
, 
NULL
, NULL,

530 &
wa
);

531 i(
n
 < 0) {

534 i(
	`FD_ISSET
(
poShedDa
->
RS485_Hd
, &
put
)) {

535 
n
 = 
	`ad
(
poShedDa
->
RS485_Hd
, 
buf
, (buf));

536 
	`FIFO_Add
(&
poShedDa
->
Rx_FIFO
, &
buf
[0], 
n
);

539 
	}
}

541 
	$RS485_C˪up
(

545 
	`tcr
(
RS485_Hd
, 
TCSANOW
, &
RS485_dtio
);

546 
	`iol
(
RS485_Hd
, 
TIOCSSERIAL
, &
RS485_drl
);

547 
	`o
(
RS485_Hd
);

548 
	}
}

551 
	$RS485_Inlize
(

554 
rmios
 
wtio
;

555 
rl_ru
 
wrl
;

556 
baud_r
 = 0.0;

558 
	`tf
("RS485: Inlizg %s", 
RS485_Pt_Name
);

563 
RS485_Hd
 = 
	`ݒ
(
RS485_Pt_Name
, 
O_RDWR
 | 
O_NOCTTY
 );

564 i(
RS485_Hd
 < 0) {

565 
	`
(
RS485_Pt_Name
);

566 
	`ex
(-1);

570 
	`f
(
RS485_Hd
, 
F_SETFL
, 
FNDELAY
);

573 
	`f
(
RS485_Hd
, 
F_SETFL
, 0);

576 
	`tcg
(
RS485_Hd
, &
RS485_dtio
);

578 
	`iol
(
RS485_Hd
, 
TIOCGSERIAL
, &
RS485_drl
);

580 
	`memy
(&
wrl
, &
RS485_drl
, (
rl_ru
));

582 
	`bzo
(&
wtio
, (newtio));

591 
wtio
.
c_cag
 = 
RS485_Baud
 | 
CS8
 | 
CLOCAL
 | 
CREAD
 | 
RS485MOD
;

593 
wtio
.
c_iag
 = 0;

595 
wtio
.
c_oag
 = 0;

597 
wtio
.
c_lag
 = 0;

599 
	`tcr
(
RS485_Hd
, 
TCSAFLUSH
, &
wtio
);

600 i(
RS485_ScBaud
) {

602 
wrl
.
ags
 |
ASYNC_SPD_CUST
;

603 
wrl
.
cuom_divis
 =

604 
	`round
(((
wrl
.
baud_ba
) / 76800);

607 
baud_r
 =

608 
	`bs
(1 -

609 ((
wrl
.
baud_ba
) /

610 ((
wrl
.
cuom_divis
) / 76800);

611 i((
wrl
.
cuom_divis
 =0|| (
baud_r
 > 0.02)) {

613 
	`rtf
(
dr
, "bad custom divisor %d, base baud %d\n",

614 
wrl
.
cuom_divis
,ewrl.
baud_ba
);

615 
	`ex
(
EXIT_FAILURE
);

618 
	`iol
(
RS485_Hd
, 
TIOCSSERIAL
, &
wrl
);

620 
	`tf
("Baud R%u", 
	`RS485_G_Baud_Re
());

622 
	`ex
(
RS485_C˪up
);

624 
	`up
(200000);

625 
	`tcush
(
RS485_Hd
, 
TCIOFLUSH
);

627 
	`FIFO_In
(&
Rx_FIFO
, 
Rx_Bufr
, (Rx_Buffer));

628 
	`tf
("=success!\n");

629 
	}
}

632 
	$RS485_Prt_Pts
()

634 
n
;

635 
dt
 **
mi
;

636 cڡ * 
sysd
 = "/sys/class/tty/";

637 

 

;

638 
bufr
[1024];

639 
devi_d
[1024];

640 *
driv_me
 = 
NULL
;

641 
fd
 = 0;

642 
bo
 
vid_pt
 = 
l
;

643 
rl_ru
 
rfo
;

646 
n
 = 
	`snd
(
sysd
, &
mi
, 
NULL
, NULL);

647 i(
n
 < 0) {

648 
	`
("RS485: scandir");

650 
n
--) {

651 i(
	`rcmp
(
mi
[
n
]->
d_me
,"..") &&

652 
	`rcmp
(
mi
[
n
]->
d_me
,".")) {

653 
	`tf
(
devi_d
, (device_dir),

655 
sysd
, 
mi
[
n
]->
d_me
);

657 i(
	`l
(
devi_d
, &

)==0 && 
	`S_ISLNK
(.
_mode
)) {

658 
	`memt
(
bufr
, 0, (buffer));

659 
	`tf
(
devi_d
, (device_dir),

661 
sysd
, 
mi
[
n
]->
d_me
);

662 i(
	`adlk
(
devi_d
, 
bufr
, (buffer)) > 0) {

663 
vid_pt
 = 
l
;

664 
driv_me
=
	`bame
(
bufr
);

665 i(
	`rcmp
(
driv_me
,"serial8250") == 0) {

667 
	`tf
(
devi_d
, (device_dir),

668 "/dev/%s", 
mi
[
n
]->
d_me
);

669 
fd
 = 
	`ݒ
(
devi_d
,

670 
O_RDWR
 | 
O_NONBLOCK
 | 
O_NOCTTY
);

671 i(
fd
 >= 0) {

673 i(
	`iol
(
fd
, 
TIOCGSERIAL
, &
rfo
)==0) {

676 i(
rfo
.
ty
 !
PORT_UNKNOWN
) {

677 
vid_pt
 = 
ue
;

680 
	`o
(
fd
);

683 
vid_pt
 = 
ue
;

685 i(
vid_pt
) {

687 
	`tf
("interface {value=/dev/%s}"

689 
mi
[
n
]->
d_me
,amelist[n]->d_name);

694 
	`
(
mi
[
n
]);

696 
	`
(
mi
);

698 
	}
}

700 #ifde
TEST_RS485


701 
	~<rg.h
>

702 
	$ma
(

703 
gc
,

704 *
gv
[])

706 vީ
mp_pt_ru_t
 
mp_pt
 = {0};

707 
ut8_t
 
tok_buf
[8] = {0x55, 0xFF, 0x00, 0x7E, 0x07, 0x00, 0x00, 0xFD};

708 
ut8_t
 
pfm_buf
[8] = {0x55, 0xFF, 0x01, 0x67, 0x07, 0x00, 0x00, 0x3E};

709 
baud
 = 38400;

710 
bo
 
wre_tok
 = 
l
;

711 
bo
 
wre_pfm
 = 
l
;

714 i(
gc
 > 1) {

715 
	`RS485_S_I
(
gv
[1]);

717 i(
gc
 > 2) {

718 
baud
 = 
	`
(
gv
[2], 
NULL
, 0);

720 i(
gc
 > 3) {

721 i(
	`rcmp
("tok", 
gv
[3]) == 0) {

722 
wre_tok
 = 
ue
;

724 i(
	`rcmp
("pfm", 
gv
[3]) == 0) {

725 
wre_pfm
 = 
ue
;

728 
	`RS485_S_Baud_Re
(
baud
);

729 
	`RS485_Inlize
();

731 i(
wre_tok
) {

732 
	`RS485_Sd_Fme
(
NULL
,
tok_buf
, (token_buf));

733 
	`up
(25000);

734 } i(
wre_pfm
) {

735 
	`RS485_Sd_Fme
(
NULL
,
pfm_buf
, (pfm_buf));

736 
	`up
(100000);

738 
	`RS485_Check_UART_Da
(&
mp_pt
);

739 i(
mp_pt
.
DaAvaab
) {

740 
	`rtf
(
dr
, "%02X ", 
mp_pt
.
DaRegi
);

741 
mp_pt
.
DaAvaab
 = 
l
;

747 
	}
}

	@ports/linux/rs485.h

36 #ide
RS485_H


37 
	#RS485_H


	)

39 
	~<dt.h
>

40 
	~"mp.h
"

42 #ifde
__lulus


46 
RS485_S_I
(

47 *
iame
);

48 cڡ *
RS485_I
(

51 
RS485_Inlize
(

54 
RS485_Sd_Fme
(

55 vީ
mp_pt_ru_t
 *
mp_pt
,

56 
ut8_t
 * 
bufr
,

57 
ut16_t
 
nbys
);

59 
RS485_Check_UART_Da
(

60 vީ
mp_pt_ru_t
 *
mp_pt
);

61 
ut32_t
 
RS485_G_Pt_Baud_Re
(

62 vީ
mp_pt_ru_t
 *
mp_pt
);

63 
ut32_t
 
RS485_G_Baud_Re
(

65 
bo
 
RS485_S_Baud_Re
(

66 
ut32_t
 
baud
);

68 
RS485_C˪up
(

70 
RS485_Prt_Pts
(

73 #ifde
__lulus


	@ports/linux/rx_fsm.c

36 
	~<ddef.h
>

37 
	~<dt.h
>

38 
	~<dio.h
>

39 
	~<dlib.h
>

40 
	~<rg.h
>

41 
	~<o.h
>

44 
	~<sys/time.h
>

45 
	~<time.h
>

46 
	~<unid.h
>

47 
	~<had.h
>

48 
	~<sigl.h
>

51 
	~"bys.h
"

52 
	~"rs485.h
"

53 
	~"c.h
"

54 
	~"mp.h
"

55 
	~"mext.h
"

59 #ide
max


60 
	#max
(
a
,
b
(((b)? (a: (b))

	)

61 
	#m
(
a
,
b
((< (b)? (a: (b))

	)

64 #ide
LOCAL_PRINT


65 
	#LOCAL_PRINT
 1

	)

69 vީ
mp_pt_ru_t
 
	gMSTP_Pt
;

71 
ut8_t
 
	gRxBufr
[
MAX_MPDU
];

72 
ut8_t
 
	gTxBufr
[
MAX_MPDU
];

73 
ut16_t
 
	gSTime
;

74 
	#INCREMENT_AND_LIMIT_UINT16
(
x
{i(x < 0xFFFFx++;}

	)

75 
ut16_t
 
	$Tim_S
(

78  
STime
;

79 
	}
}

81 
	$Tim_S_Ret
(

84 
STime
 = 0;

85 
	}
}

87 
	$dlmp_mlicd_tim
(

90 
	`INCREMENT_AND_LIMIT_UINT16
(
STime
);

91 
	}
}

93 *
	$mlicds_sk
(

94 *
pArg
)

96 
timeec
 
timeOut
, 
mas
;

98 
timeOut
.
tv_c
 = 0;

99 
timeOut
.
tv_nc
 = 10000000;

102 
	`nop
(&
timeOut
, &
mas
);

103 
	`dlmp_mlicd_tim
();

106  
NULL
;

107 
	}
}

110 
ut16_t
 
	$MSTP_Put_Reive
(

111 vީ
mp_pt_ru_t
 * 
mp_pt
)

113 (
mp_pt
;

116 
	}
}

120 
ut16_t
 
	$MSTP_G_Sd
(

121 vީ
mp_pt_ru_t
 * 
mp_pt
,

122 
timeout
)

124 (
mp_pt
;

125 (
timeout
;

127 
	}
}

129 
ut16_t
 
	$MSTP_G_Rly
(

130 vީ
mp_pt_ru_t
 * 
mp_pt
,

131 
timeout
)

133 (
mp_pt
;

134 (
timeout
;

136 
	}
}

139 
	$timeamp_ms
(

142 
timev
 
tv
;

143 
d_ticks
 = 0;

144 
ticks
 = 0;

145 
ϡ_ticks
 = 0;

146 
rv
 = 0;

148 
rv
 = 
	`gtimeofday
(&
tv
, 
NULL
);

149 i(
rv
 == -1)

150 
ticks
 = 0;

152 
ticks
 = (
tv
.
tv_c
 * 1000+ (tv.
tv_uc
 / 1000);

154 
d_ticks
 = 
ticks
 - 
ϡ_ticks
;

155 
ϡ_ticks
 = 
ticks
;

157  
d_ticks
;

158 
	}
}

160 cڡ *
	gCtu_Fame
 = "mstp.cap";

161 
FILE
 *
	gpFe
 = 
NULL
;

164 
	$wre_glob_hd
(

167 
ut32_t
 
magic_numb
 = 0xa1b2c3d4;

168 
ut16_t
 
vsi_maj
 = 2;

169 
ut16_t
 
vsi_m
 = 4;

170 
t32_t
 
thisze
 = 0;

171 
ut32_t
 
sigfigs
 = 0;

172 
ut32_t
 
n
 = 65535;

173 
ut32_t
 
twk
 = 165;

176 
pFe
 = 
	`fݒ
(
Ctu_Fame
, "wb");

177 i(
pFe
) {

178 
	`fwre
(&
magic_numb
, (magic_numb), 1, 
pFe
);

179 
	`fwre
(&
vsi_maj
, (vsi_maj), 1, 
pFe
);

180 
	`fwre
(&
vsi_m
, (vsi_m), 1, 
pFe
);

181 
	`fwre
(&
thisze
, hisze), 1, 
pFe
);

182 
	`fwre
(&
sigfigs
, (sigfigs), 1, 
pFe
);

183 
	`fwre
(&
n
, (n), 1, 
pFe
);

184 
	`fwre
(&
twk
, ґwk), 1, 
pFe
);

186 
	`rtf
(
dr
, "rx_fsm: faedݒ %s: %s\n", 
Ctu_Fame
,

187 
	`
(
o
));

189 
	}
}

191 
	$wre_ived_ck
(

192 vީ
mp_pt_ru_t
 *
mp_pt
)

194 
ut32_t
 
ts_c
;

195 
ut32_t
 
ts_uc
;

196 
ut32_t
 
_n
;

197 
ut32_t
 
ig_n
;

198 
ut8_t
 
hd
[8];

199 
timev
 
tv
;

200 
size_t
 
max_da
 = 0;

202 i(
pFe
) {

203 
	`gtimeofday
(&
tv
, 
NULL
);

204 
ts_c
 = 
tv
.
tv_c
;

205 
ts_uc
 = 
tv
.
tv_uc
;

206 
	`fwre
(&
ts_c
, s_c), 1, 
pFe
);

207 
	`fwre
(&
ts_uc
, s_uc), 1, 
pFe
);

208 i(
mp_pt
->
DaLgth
) {

209 
max_da
 = 
	`m
(
mp_pt
->
IutBufrSize
, mp_pt->
DaLgth
);

210 
_n
 = 
ig_n
 = 8 + 
max_da
 + 2;

212 
_n
 = 
ig_n
 = 8;

214 
	`fwre
(&
_n
, (_n), 1, 
pFe
);

215 
	`fwre
(&
ig_n
, (ig_n), 1, 
pFe
);

216 
hd
[0] = 0x55;

217 
hd
[1] = 0xFF;

218 
hd
[2] = 
mp_pt
->
FmeTy
;

219 
hd
[3] = 
mp_pt
->
DeiAddss
;

220 
hd
[4] = 
mp_pt
->
SourAddss
;

221 
hd
[5] = 
	`HI_BYTE
(
mp_pt
->
DaLgth
);

222 
hd
[6] = 
	`LO_BYTE
(
mp_pt
->
DaLgth
);

223 
hd
[7] = 
mp_pt
->
HdCRCAu
;

224 
	`fwre
(
hd
, (hd), 1, 
pFe
);

225 i(
mp_pt
->
DaLgth
) {

226 
	`fwre
(
mp_pt
->
IutBufr
, 
max_da
, 1, 
pFe
);

227 
	`fwre
((*&(
mp_pt
->
DaCRCAuMSB
), 1, 1, 
pFe
);

228 
	`fwre
((*&(
mp_pt
->
DaCRCAuLSB
), 1, 1, 
pFe
);

231 
	`rtf
(
dr
, "rx_fsm: faedݒ %s: %s\n", 
Ctu_Fame
,

232 
	`
(
o
));

234 
	}
}

236 
	$nup
(

239 i(
pFe
) {

240 
	`fush
(
pFe
);

241 
	`fo
(
pFe
);

243 
pFe
 = 
NULL
;

244 
	}
}

246 #i
LOCAL_PRINT


247 
	$t_ived_ck
(

248 vީ
mp_pt_ru_t
 *
mp_pt
)

250 
i
 = 0;

251 
timeamp
 = 0;

252 
size_t
 
max_da
 = 0;

254 
timeamp
 = 
	`timeamp_ms
();

255 
	`rtf
(
dr
, "%03d ", 
timeamp
);

266 
	`rtf
(
dr
, "55 FF %02X %02X %02X %02X %02X %02X ",

267 
mp_pt
->
FmeTy
, mp_pt->
DeiAddss
,

268 
mp_pt
->
SourAddss
, 
	`HI_BYTE
(mp_pt->
DaLgth
),

269 
	`LO_BYTE
(
mp_pt
->
DaLgth
), mp_pt->
HdCRCAu
);

270 i(
mp_pt
->
DaLgth
) {

271 
max_da
 = 
	`m
(
mp_pt
->
IutBufrSize
, mp_pt->
DaLgth
);

272 
i
 = 0; i < 
max_da
; i++) {

273 
	`rtf
(
dr
, "%02X ", 
mp_pt
->
IutBufr
[
i
]);

275 
	`rtf
(
dr
, "%02X %02X ", 
mp_pt
->
DaCRCAuMSB
,

276 
mp_pt
->
DaCRCAuLSB
);

278 
	`rtf
(
dr
, "%s", 
	`mext_ame_ty
(
mp_pt
->
FmeTy
));

279 
	`rtf
(
dr
, "\n");

280 
	}
}

283 
	$sig_t
(

284 
signo
)

286 (
signo
;

288 
	`nup
();

289 
	`ex
(0);

290 
	}
}

292 
	$sigl_
(

295 
	`sigl
(
SIGINT
, 
sig_t
);

296 
	`sigl
(
SIGHUP
, 
sig_t
);

297 
	`sigl
(
SIGTERM
, 
sig_t
);

298 
	}
}

301 
	$ma
(

302 
gc
,

303 *
gv
[])

305 vީ
mp_pt_ru_t
 *
mp_pt
;

306 
rc
 = 0;

307 
had_t
 
hThad
;

308 
my_mac
 = 127;

309 
my_baud
 = 38400;

312 
mp_pt
 = &
MSTP_Pt
;

314 i(
gc
 > 1) {

315 
	`RS485_S_I
(
gv
[1]);

317 i(
gc
 > 2) {

318 
my_baud
 = 
	`
(
gv
[2], 
NULL
, 0);

320 i(
gc
 > 3) {

321 
my_mac
 = 
	`
(
gv
[3], 
NULL
, 0);

322 i(
my_mac
 > 127)

323 
my_mac
 = 127;

325 
	`RS485_S_Baud_Re
(
my_baud
);

326 
	`RS485_Inlize
();

327 
MSTP_Pt
.
IutBufr
 = &
RxBufr
[0];

328 
MSTP_Pt
.
IutBufrSize
 = (
RxBufr
);

329 
MSTP_Pt
.
OuutBufr
 = &
TxBufr
[0];

330 
MSTP_Pt
.
OuutBufrSize
 = (
TxBufr
);

331 
MSTP_Pt
.
This_Sti
 = 
my_mac
;

332 
MSTP_Pt
.
Nmax_fo_ames
 = 1;

333 
MSTP_Pt
.
Nmax_ma
 = 127;

334 
MSTP_Pt
.
STim
 = 
Tim_S
;

335 
MSTP_Pt
.
STimRet
 = 
Tim_S_Ret
;

336 
	`MSTP_In
(
mp_pt
);

337 
mp_pt
->
Lurkg
 = 
ue
;

339 
rc
 = 
	`had_
(&
hThad
, 
NULL
, 
mlicds_sk
, NULL);

340 
	`ex
(
nup
);

341 
	`wre_glob_hd
();

342 
	`fush
(
pFe
);

345 
	`RS485_Check_UART_Da
(
mp_pt
);

346 
	`MSTP_Reive_Fme_FSM
(
mp_pt
);

348 i(
mp_pt
->
ReivedVidFme
) {

349 
mp_pt
->
ReivedVidFme
 = 
l
;

350 #i
LOCAL_PRINT


351 
	`t_ived_ck
(
mp_pt
);

353 
	`wre_ived_ck
(
mp_pt
);

354 
	`fush
(
pFe
);

355 } i(
mp_pt
->
ReivedInvidFme
) {

356 
mp_pt
->
ReivedInvidFme
 = 
l
;

357 
	`rtf
(
dr
, "ReceivedInvalidFrame\n");

358 #i
LOCAL_PRINT


359 
	`t_ived_ck
(
mp_pt
);

361 
	`wre_ived_ck
(
mp_pt
);

362 
	`fush
(
pFe
);

367 
	}
}

	@ports/linux/timer.c

25 
	~<dio.h
>

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<time.h
>

29 
	~"tim.h
"

34 vީ
ut32_t
 
	gMlicd_Cou
[
MAX_MILLISECOND_TIMERS
];

37 
timeec
 
	gt
;

40 
ut32_t
 
	$timeGTime
(

43 
timeec
 
now
;

44 
ut32_t
 
ticks
;

46 
	`ock_gtime
(
CLOCK_MONOTONIC
, &
now
);

48 
ticks
 =

49 (
now
.
tv_c
 - 
t
.tv_c* 1000 + (now.
tv_nc
 -

50 
t
.
tv_nc
) / 1000000;

52  
ticks
;

53 
	}
}

60 
ut32_t
 
	$tim_mlicds
(

61 
dex
)

63 
ut32_t
 
now
 = 
	`timeGTime
();

64 
ut32_t
 
d_time
 = 0;

66 i(
dex
 < 
MAX_MILLISECOND_TIMERS
) {

67 i(
Mlicd_Cou
[
dex
] <
now
) {

68 
d_time
 = 
now
 - 
Mlicd_Cou
[
dex
];

70 
d_time
 = (
UINT32_MAX
 - 
Mlicd_Cou
[
dex
]+ 
now
 + 1;

74  
d_time
;

75 
	}
}

82 
bo
 
	$tim_d_mlicds
(

83 
dex
,

84 
ut32_t
 
vue
)

86  (
	`tim_mlicds
(
dex
>
vue
);

87 
	}
}

94 
bo
 
	$tim_d_cds
(

95 
dex
,

96 
ut32_t
 
cds
)

98  ((
	`tim_mlicds
(
dex
/ 1000>
cds
);

99 
	}
}

106 
bo
 
	$tim_d_mus
(

107 
dex
,

108 
ut32_t
 
mus
)

110  ((
	`tim_mlicds
(
dex
/ (1000 * 60)>
mus
);

111 
	}
}

118 
ut32_t
 
	$tim_t
(

119 
dex
)

121 
ut32_t
 
tim_vue
 = 0;

123 i(
dex
 < 
MAX_MILLISECOND_TIMERS
) {

124 
tim_vue
 = 
	`tim_mlicds
(
dex
);

125 
Mlicd_Cou
[
dex
] = 
	`timeGTime
();

128  
tim_vue
;

129 
	}
}

136 
	$tim_
(

139 
	`ock_gtime
(
CLOCK_MONOTONIC
, &
t
);

140 
	}
}

	@ports/linux/timer.h

24 #ide
TIMER_H


25 
	#TIMER_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<sys/time.h
>

32 #ide
MAX_MILLISECOND_TIMERS


33 
	#TIMER_SILENCE
 0

	)

34 
	#MAX_MILLISECOND_TIMERS
 1

	)

37 #ifde
__lulus


40 
ut32_t
 
timeGTime
(

43 
tim_
(

45 
ut32_t
 
tim_mlicds
(

46 
dex
);

47 
bo
 
tim_d_mlicds
(

48 
dex
,

49 
ut32_t
 
vue
);

50 
bo
 
tim_d_cds
(

51 
dex
,

52 
ut32_t
 
vue
);

53 
bo
 
tim_d_mus
(

54 
dex
,

55 
ut32_t
 
cds
);

56 
ut32_t
 
tim_mlicds_t
(

57 
dex
,

58 
ut32_t
 
vue
);

59 
ut32_t
 
tim_t
(

60 
dex
);

62 #ifde
__lulus


	@ports/lwip/bip.c

34 
	~<dt.h
>

35 
	~<dbo.h
>

36 
	~"bacdef.h
"

37 
	~"bacdcode.h
"

38 
	~"bact.h
"

39 
	~"b.h
"

40 
	~"bvlc.h
"

41 
	~"hdrs.h
"

42 
	~"t.h
"

47 
ut16_t
 
	gBIP_Pt
 = 0xBAC0;

48 
bo
 
	gBIP_Pt_Chged
;

50 
_addr
 
	gBIP_Addss
;

52 
_addr
 
	gBIP_Brd_Addss
;

54 
udp_pcb
 *
	gSv_upcb
;

56 
	sba_s
 {

57 
ut32_t
 
	mxm
;

58 
ut32_t
 
	mcv
;

59 
ut32_t
 
	mdr
;

61 
ba_s
 
	gBIP_Sts
;

62 
	#BIP_STATS_INC
(
x
++
BIP_Sts
.
	)
x

64 
ut32_t
 
	$b_s_xm
()

66  
BIP_Sts
.
xm
;

67 
	}
}

69 
ut32_t
 
	$b_s_cv
()

71  
BIP_Sts
.
cv
;

72 
	}
}

74 
ut32_t
 
	$b_s_dr
()

76  
BIP_Sts
.
dr
;

77 
	}
}

79 
	$b_t_addr
(

80 
ut32_t
 
t_addss
)

82 
BIP_Addss
.
s_addr
 = 
t_addss
;

83 
	}
}

86 
ut32_t
 
	$b_g_addr
(

89  
BIP_Addss
.
s_addr
;

90 
	}
}

92 
	$b_t_brd_addr
(

93 
ut32_t
 
t_addss
)

95 
BIP_Brd_Addss
.
s_addr
 = 
t_addss
;

96 
	}
}

99 
ut32_t
 
	$b_g_brd_addr
(

102  
BIP_Brd_Addss
.
s_addr
;

103 
	}
}

105 
	$b_t_pt
(

106 
ut16_t
 
pt
)

108 i(
BIP_Pt
 !
pt
) {

109 
BIP_Pt_Chged
 = 
ue
;

110 
BIP_Pt
 = 
pt
;

112 
	}
}

114 
bo
 
	$b_pt_chged
()

116  
BIP_Pt_Chged
;

117 
	}
}

120 
ut16_t
 
	$b_g_pt
(

123  
BIP_Pt
;

124 
	}
}

126 
	$b_mac_to_addr
(

127 
_addr
 *
addss
,

128 
ut8_t
 * 
mac
)

130 i(
mac
 && 
addss
) {

131 
addss
->
addr
 = ((
u32_t
((((
ut32_t

mac
[0]) << 24) & 0xff000000));

132 
addss
->
addr
 |((
u32_t
((((
ut32_t

mac
[1]) << 16) & 0x00ff0000));

133 
addss
->
addr
 |((
u32_t
((((
ut32_t

mac
[2]) << 8) & 0x0000ff00));

134 
addss
->
addr
 |((
u32_t
(((
ut32_t

mac
[3]) & 0x000000ff));

136 
	}
}

138 
	$b_addr_to_mac
(

139 
ut8_t
 * 
mac
,

140 
_addr
 *
addss
)

142 i(
mac
 && 
addss
) {

143 
mac
[0] = (
ut8_t
(
addss
->
addr
 >> 24);

144 
mac
[1] = (
ut8_t
(
addss
->
addr
 >> 16);

145 
mac
[2] = (
ut8_t
(
addss
->
addr
 >> 8);

146 
mac
[3] = (
ut8_t
(
addss
->
addr
);

148 
	}
}

150 
	$b_decode_b_addss
(

151 
BACNET_ADDRESS
 * 
bac_addr
,

152 
_addr
 *
addss
,

153 
ut16_t
 * 
pt
)

155 
n
 = 0;

157 i(
bac_addr
) {

158 
	`b_mac_to_addr
(
addss
, &
bac_addr
->
mac
[0]);

159 
	`memy
(
pt
, &
bac_addr
->
mac
[4], 2);

160 
n
 = 6;

163  
n
;

164 
	}
}

175 
bo
 
	$b_nd_mpdu
(

176 
_addr
 *
d_
,

177 
ut16_t
 
pt
,

178 
pbuf
 *
pkt
)

180 
r_t
 
us
 = 
ERR_OK
;

183 
us
 = 
	`udp_ndto
(
Sv_upcb
, 
pkt
, 
d_
, 
pt
);

185 
	`pbuf_
(
pkt
);

186 i(
us
 =
ERR_OK
) {

187 
	`BIP_STATS_INC
(
xm
);

190  (
us
 =
ERR_OK
);

191 
	}
}

202 
	$b_nd_pdu
(

203 
BACNET_ADDRESS
 * 
de
,

204 
BACNET_NPDU_DATA
 * 
du_da
,

205 
ut8_t
 * 
pdu
,

206 
pdu_n
)

208 
pbuf
 *
pkt
 = 
NULL
, *
pkt0
 = NULL;

209 
ut8_t
 
mtu
[4] = {0};

210 
mtu_n
 = 0;

212 
_addr
 
d_
;

213 
ut16_t
 
pt
 = 0;

214 
r_t
 
us
 = 
ERR_OK
;

216 
pkt0
 = 
	`pbuf_loc
(
PBUF_TRANSPORT
, 4, 
PBUF_POOL
);

217 i(
pkt0
 =
NULL
) {

220 
pkt
 = 
	`pbuf_loc
(
PBUF_TRANSPORT
, 
pdu_n
, 
PBUF_POOL
);

221 i(
pkt
 =
NULL
) {

222 
	`pbuf_
(
pkt0
);

225 
mtu
[0] = 
BVLL_TYPE_BACNET_IP
;

226 i(
de
->
t
 =
BACNET_BROADCAST_NETWORK
) {

228 
d_
.
addr
 = 
BIP_Brd_Addss
.
s_addr
;

229 
pt
 = 
BIP_Pt
;

230 
mtu
[1] = 
BVLC_ORIGINAL_BROADCAST_NPDU
;

231 } i(
de
->
mac_n
 == 6) {

233 
	`b_decode_b_addss
(
de
, &
d_
, &
pt
);

234 
mtu
[1] = 
BVLC_ORIGINAL_UNICAST_NPDU
;

239 
mtu_n
 = 
pdu_n
 + 4 ;

240 
	`code_unsigd16
(&
mtu
[2], 
mtu_n
);

241 
	`pbuf_ke
(
pkt0
, 
mtu
, 4);

242 
	`pbuf_ke
(
pkt
, 
pdu
, 
pdu_n
);

243 
	`pbuf_t
(
pkt0
, 
pkt
);

244 
us
 = 
	`b_nd_mpdu
(&
d_
, 
pt
, 
pkt0
);

245 i(!
us
) {

246 
mtu_n
 = 0;

249  
mtu_n
;

250 
	}
}

259 
bo
 
	$bvlc_nd_su
(

260 
_addr
 *
addr
,

261 
ut16_t
 
su_code
)

263 
pbuf
 *
pkt
 = 
NULL
;

264 
ut8_t
 
mtu
[6] = { 0 };

265 
ut16_t
 
mtu_n
 = 6;

267 
pkt
 = 
	`pbuf_loc
(
PBUF_TRANSPORT
, 
mtu_n
, 
PBUF_POOL
);

268 i(
pkt
 =
NULL
) {

271 
mtu
[0] = 
BVLL_TYPE_BACNET_IP
;

272 
mtu
[1] = 
BVLC_RESULT
;

276 
	`code_unsigd16
(&
mtu
[2], 6);

277 
	`code_unsigd16
(&
mtu
[4], 
su_code
);

278 
	`pbuf_ke
(
pkt
, 
mtu
, 
mtu_n
);

280  
	`b_nd_mpdu
(
addr
, 
BIP_Pt
, 
pkt
);

281 
	}
}

283 
	$b_rv_back
(

284 *
g
,

285 
udp_pcb
 *
upcb
,

286 
pbuf
 *
pkt
,

287 
_addr
 *
addr
,

288 
u16_t
 
pt
)

290 
ut8_t
 
funi
 = 0;

291 
ut16_t
 
pdu_n
 = 0;

292 
ut16_t
 
pdu_offt
 = 0;

293 
BACNET_ADDRESS
 
c
 = {

296 
_addr
 
s_addr
;

297 
ut16_t
 
s_pt
 = 0;

298 
ut8_t
 *
pdu
 = (ut8_*
pkt
->
yld
;

301 i(
pdu
[0] !
BVLL_TYPE_BACNET_IP
) {

304 
funi
 = 
pdu
[1];

305 i((
funi
 =
BVLC_ORIGINAL_UNICAST_NPDU
) ||

306 (
funi
 =
BVLC_ORIGINAL_BROADCAST_NPDU
)) {

308 i((
addr
->add=
BIP_Addss
.
s_addr
&& (
pt
 =
BIP_Pt
)) {

309 
pdu_n
 = 0;

312 
c
.
mac_n
 = 6;

313 
	`b_addr_to_mac
(&
c
.
mac
[0], 
addr
);

314 
	`memy
(&
c
.
mac
[4], &
pt
, 2);

316 (
	`decode_unsigd16
(&
pdu
[2], &
pdu_n
);

318 
pdu_n
 -= 4;

319 
pdu_offt
 = 4;

321 } i(
funi
 =
BVLC_FORWARDED_NPDU
) {

322 
	`IP4_ADDR
(&
s_addr
,
pdu
[4],pdu[5],pdu[6],pdu[7]);

323 
	`decode_unsigd16
(&
pdu
[8], &
s_pt
);

324 i((
s_addr
.
addr
 =
BIP_Addss
.
s_addr
&& (
s_pt
 =
BIP_Pt
)) {

326 
pdu_n
 = 0;

329 
c
.
mac_n
 = 6;

330 
	`b_addr_to_mac
(&
c
.
mac
[0], &
s_addr
);

331 
	`memy
(&
c
.
mac
[4], &
s_pt
, 2);

333 (
	`decode_unsigd16
(&
pdu
[2], &
pdu_n
);

335 
pdu_n
 -= 10;

336 
pdu_offt
 = 10;

338 } i(
funi
 =
BVLC_WRITE_BROADCAST_DISTRIBUTION_TABLE
) {

339 
	`bvlc_nd_su
(
addr
,

340 
BVLC_RESULT_WRITE_BROADCAST_DISTRIBUTION_TABLE_NAK
);

341 } i(
funi
 =
BVLC_READ_BROADCAST_DIST_TABLE
) {

342 
	`bvlc_nd_su
(
addr
,

343 
BVLC_RESULT_READ_BROADCAST_DISTRIBUTION_TABLE_NAK
);

344 } i(
funi
 =
BVLC_REGISTER_FOREIGN_DEVICE
) {

345 
	`bvlc_nd_su
(
addr
,

346 
BVLC_RESULT_REGISTER_FOREIGN_DEVICE_NAK
);

347 } i(
funi
 =
BVLC_READ_FOREIGN_DEVICE_TABLE
) {

348 
	`bvlc_nd_su
(
addr
,

349 
BVLC_RESULT_READ_FOREIGN_DEVICE_TABLE_NAK
);

350 } i(
funi
 =
BVLC_DELETE_FOREIGN_DEVICE_TABLE_ENTRY
) {

351 
	`bvlc_nd_su
(
addr
,

352 
BVLC_RESULT_DELETE_FOREIGN_DEVICE_TABLE_ENTRY_NAK
);

353 } i(
funi
 =
BVLC_DISTRIBUTE_BROADCAST_TO_NETWORK
) {

354 
	`bvlc_nd_su
(
addr
,

355 
BVLC_RESULT_DISTRIBUTE_BROADCAST_TO_NETWORK_NAK
);

357 i(
pdu_n
) {

358 
	`BIP_STATS_INC
(
cv
);

359 
	`du_hdr
(&
c
, &
pdu
[
pdu_offt
], 
pdu_n
);

361 
	`BIP_STATS_INC
(
dr
);

366 
	`udp_disc
(
upcb
);

367 
	`udp_bd
(
upcb
, 
IP_ADDR_ANY
, 
BIP_Pt
);

369 
	`udp_cv
(
upcb
, 
b_rv_back
, 
NULL
);

372 
	`pbuf_
(
pkt
);

373 
	}
}

375 
	$b_g_my_addss
(

376 
BACNET_ADDRESS
 * 
my_addss
)

378 
i
 = 0;

380 i(
my_addss
) {

381 
my_addss
->
mac_n
 = 6;

382 
	`memy
(&
my_addss
->
mac
[0], &
BIP_Addss
.
s_addr
, 4);

383 
	`memy
(&
my_addss
->
mac
[4], &
BIP_Pt
, 2);

384 
my_addss
->
t
 = 0;

385 
my_addss
->
n
 = 0;

386 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

388 
my_addss
->
adr
[
i
] = 0;

393 
	}
}

395 
	$b_g_brd_addss
(

396 
BACNET_ADDRESS
 * 
de
)

398 
i
 = 0;

400 i(
de
) {

401 
de
->
mac_n
 = 6;

402 
	`memy
(&
de
->
mac
[0], &
BIP_Brd_Addss
.
s_addr
, 4);

403 
	`memy
(&
de
->
mac
[4], &
BIP_Pt
, 2);

404 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

405 
de
->
n
 = 0;

406 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

408 
de
->
adr
[
i
] = 0;

413 
	}
}

432 
bo
 
	$b_
(

433 *
iame
)

435 (
iame
;

437 
Sv_upcb
 = 
	`udp_w
();

438 i(
Sv_upcb
 =
NULL
) {

445 
	`udp_bd
(
Sv_upcb
, 
IP_ADDR_ANY
, 
BIP_Pt
);

447 
	`udp_cv
(
Sv_upcb
, 
b_rv_back
, 
NULL
);

449  
ue
;

450 
	}
}

	@ports/lwip/net.h

26 #ide
NET_H


27 
	#NET_H


	)

29 
	~<dt.h
>

30 
	~<dbo.h
>

31 
	~<rg.h
>

32 
	~"lw/def.h
"

33 
	~"lw/udp.h
"

34 
	~"lw/memp.h
"

35 
	~"tif/hp.h
"

36 
	~"lw/dh.h
"

37 
	~"htif.h
"

38 
	~"lw/.h
"

41 
	ssockaddr_
 {

42 
u8_t
 
	ms_n
;

43 
u8_t
 
	ms_my
;

44 
u16_t
 
	ms_pt
;

45 
_addr
 
	ms_addr
;

46 
	ms_zo
[8];

49 
	ssockaddr
 {

50 
u8_t
 
	m_n
;

51 
u8_t
 
	m_my
;

52 
	m_da
[14];

	@ports/pic18f6720/ai.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~<rg.h
>

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"banum.h
"

35 
	~"cfig.h
"

36 
	~"wp.h
"

37 
	~".h
"

38 
	~"ai.h
"

41 
	#MAX_ANALOG_INPUTS
 2

	)

43 
ut8_t
 
	gP_Vue
[
MAX_ANALOG_INPUTS
];

48 
bo
 
	$Alog_Iut_Vid_In
(

49 
ut32_t
 
obje_
)

51 i(
obje_
 < 
MAX_ANALOG_INPUTS
)

52  
ue
;

54  
l
;

55 
	}
}

58 
	$Alog_Iut_Cou
(

61  
MAX_ANALOG_INPUTS
;

62 
	}
}

65 
ut32_t
 
	$Alog_Iut_Index_To_In
(

66 
dex
)

68  
dex
;

69 
	}
}

71 *
	$Alog_Iut_Name
(

72 
ut32_t
 
obje_
)

74 
xt_rg
[16] = "";

76 i(
obje_
 < 
MAX_ANALOG_INPUTS
) {

77 
	`rtf
(&
xt_rg
[0], "AI-%lu", (
obje_
);

78  
xt_rg
;

81  
NULL
;

82 
	}
}

84 
	$Alog_Iut_P_Vue
(

85 
ut32_t
 
obje_
)

87 
vue
 = 0.0;

89 i(
obje_
 < 
MAX_ANALOG_INPUTS
)

90 
vue
 = 
P_Vue
[
obje_
];

92  
vue
;

93 
	}
}

95 
	$Alog_Iut_P_Vue_S
(

96 
ut32_t
 
obje_
,

97 
vue
)

99 i(
obje_
 < 
MAX_ANALOG_INPUTS
) {

100 
P_Vue
[
obje_
] = 
vue
;

102 
	}
}

106 
	$Alog_Iut_Rd_Prݔty
(

107 
BACNET_READ_PROPERTY_DATA
 * 
da
)

109 
du_n
 = 0;

110 
BACNET_BIT_STRING
 
b_rg
;

111 
BACNET_CHARACTER_STRING
 
ch_rg
;

112 
ut8_t
 *
du
 = 
NULL
;

114 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

115 (
da
->
iti_da_n
 == 0)) {

118 
du
 = 
da
->
iti_da
;

119 
da
->
obje_ݔty
) {

120 
PROP_OBJECT_IDENTIFIER
:

121 
du_n
 =

122 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_INPUT
,

123 
da
->
obje_
);

127 
PROP_OBJECT_NAME
:

128 
PROP_DESCRIPTION
:

129 
	`charg__si
(&
ch_rg
,

130 
	`Alog_Iut_Name
(
da
->
obje_
));

131 
du_n
 =

132 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

134 
PROP_OBJECT_TYPE
:

135 
du_n
 =

136 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_INPUT
);

138 
PROP_PRESENT_VALUE
:

139 
du_n
 =

140 
	`code_iti_
(&
du
[0],

141 
	`Alog_Iut_P_Vue
(
da
->
obje_
));

143 
PROP_STATUS_FLAGS
:

144 
	`brg_
(&
b_rg
);

145 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

146 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

147 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

148 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

149 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

151 
PROP_EVENT_STATE
:

152 
du_n
 =

153 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

155 
PROP_OUT_OF_SERVICE
:

156 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

158 
PROP_UNITS
:

159 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

162 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

163 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

164 
du_n
 = -1;

168 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

169 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

170 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

171 
du_n
 = -1;

174  
du_n
;

175 
	}
}

	@ports/pic18f6720/apdu.c

34 
	~<dbo.h
>

35 
	~<dt.h
>

36 
	~<ddef.h
>

37 
	~"bs.h
"

38 
	~"bacdef.h
"

39 
	~"bacdcode.h
"

40 
	~"banum.h
"

41 
	~"dcc.h
"

42 
	~"hdrs.h
"

44 
	~"du.h
"

46 
ut16_t
 
	$du_timeout
(

50 
	}
}

52 
ut8_t
 
	$du_s
(

56 
	}
}

58 
bo
 
	$du_rvi_su܋d
(

59 
BACNET_SERVICES_SUPPORTED
 
rvi_su܋d
)

61 
bo
 
us
 = 
l
;

63 
rvi_su܋d
) {

64 
SERVICE_SUPPORTED_READ_PROPERTY
:

65 
SERVICE_SUPPORTED_WHO_IS
:

66 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
:

67 
SERVICE_SUPPORTED_WRITE_PROPERTY
:

68 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
:

69 
us
 = 
ue
;

75  
us
;

76 
	}
}

78 
ut16_t
 
	$du_decode_cfmed_rvi_que
(

79 
ut8_t
 * 
du
,

80 
ut16_t
 
du_n
,

81 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
,

82 
ut8_t
 * 
rvi_choi
,

83 
ut8_t
 ** 
rvi_que
,

84 
ut16_t
 * 
rvi_que_n
)

86 
ut16_t
 
n
 = 0;

88 
rvi_da
->
gmd_mesge
 = (
du
[0] & 
BIT3
? 
ue
 : 
l
;

89 
rvi_da
->
me_flows
 = (
du
[0] & 
BIT2
? 
ue
 : 
l
;

90 
rvi_da
->
gmd_ڣ_aced
 =

91 (
du
[0] & 
BIT1
? 
ue
 : 
l
;

92 
rvi_da
->
max_gs
 = 
	`decode_max_gs
(
du
[1]);

93 
rvi_da
->
max_
 = 
	`decode_max_du
(
du
[1]);

94 
rvi_da
->
voke_id
 = 
du
[2];

95 
n
 = 3;

96 i(
rvi_da
->
gmd_mesge
) {

97 
rvi_da
->
qu_numb
 = 
du
[
n
++];

98 
rvi_da
->
od_wdow_numb
 = 
du
[
n
++];

100 *
rvi_choi
 = 
du
[
n
++];

101 *
rvi_que
 = &
du
[
n
];

102 *
rvi_que_n
 = 
du_n
 - 
n
;

104  
n
;

105 
	}
}

113 
bo
 
	$du_cfmed_dcc_dibd
(

114 
ut8_t
 
rvi_choi
)

116 
bo
 
us
 = 
l
;

118 i(
	`dcc_communiti_dibd
()) {

119 
rvi_choi
) {

120 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
:

121 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
:

124 
us
 = 
ue
;

129  
us
;

130 
	}
}

139 
bo
 
	$du_uncfmed_dcc_dibd
(

140 
ut8_t
 
rvi_choi
)

142 
bo
 
us
 = 
l
;

144 i(
	`dcc_communiti_dibd
()) {

147 
us
 = 
ue
;

148 } i(
	`dcc_communiti_ti_dibd
()) {

150 
rvi_choi
) {

151 
SERVICE_UNCONFIRMED_WHO_IS
:

154 
us
 = 
ue
;

159  
us
;

160 
	}
}

162 
	$du_hdr
(

163 
BACNET_ADDRESS
 * 
c
,

164 
ut8_t
 * 
du
,

165 
ut16_t
 
du_n
)

167 
BACNET_CONFIRMED_SERVICE_DATA
 
rvi_da
 = { 0 };

168 
ut8_t
 
rvi_choi
 = 0;

169 
ut8_t
 *
rvi_que
 = 
NULL
;

170 
ut16_t
 
rvi_que_n
 = 0;

171 
ut16_t
 
n
 = 0;

173 i(
du
) {

175 
du
[0] & 0xF0) {

176 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

177 
n
 = 
	`du_decode_cfmed_rvi_que
(&
du
[0],

178 
du_n
, &
rvi_da
, &
rvi_choi
, &
rvi_que
,

179 &
rvi_que_n
);

180 i(
	`du_cfmed_dcc_dibd
(
rvi_choi
)) {

186 i(
rvi_choi
 =
SERVICE_CONFIRMED_READ_PROPERTY
) {

187 
	`hdr_ad_ݔty
(
rvi_que
, 
rvi_que_n
,

188 
c
, &
rvi_da
);

189 } i(
rvi_choi
 =
SERVICE_CONFIRMED_WRITE_PROPERTY
) {

190 
	`hdr_wre_ݔty
(
rvi_que
,

191 
rvi_que_n
, 
c
, &
rvi_da
);

192 } i(
rvi_choi
 ==

193 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
) {

194 
	`hdr_lize_devi
(
rvi_que
,

195 
rvi_que_n
, 
c
, &
rvi_da
);

196 } i(
rvi_choi
 ==

197 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
) {

198 
	`hdr_devi_communiti_cڌ
(
rvi_que
,

199 
rvi_que_n
, 
c
, &
rvi_da
);

201 
	`hdr_uecognized_rvi
(
rvi_que
,

202 
rvi_que_n
, 
c
, &
rvi_da
);

205 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
:

206 
rvi_choi
 = 
du
[1];

207 
rvi_que
 = &
du
[2];

208 
rvi_que_n
 = 
du_n
 - 2;

209 i(
	`du_uncfmed_dcc_dibd
(
rvi_choi
)) {

217 i(
rvi_choi
 =
SERVICE_UNCONFIRMED_WHO_IS
) {

218 
	`hdr_who_is
(
rvi_que
, 
rvi_que_n
, 
c
);

221 
PDU_TYPE_SIMPLE_ACK
:

222 
PDU_TYPE_COMPLEX_ACK
:

223 
PDU_TYPE_SEGMENT_ACK
:

224 
PDU_TYPE_ERROR
:

225 
PDU_TYPE_REJECT
:

226 
PDU_TYPE_ABORT
:

232 
	}
}

	@ports/pic18f6720/av.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~<rg.h
>

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"banum.h
"

35 
	~"ba.h
"

36 
	~"cfig.h
"

37 
	~"wp.h
"

38 
	~".h
"

39 
	~"av.h
"

41 
	#MAX_ANALOG_VALUES
 4

	)

46 
	#ANALOG_LEVEL_NULL
 255

	)

49 
	#ANALOG_RELINQUISH_DEFAULT
 0

	)

53 
ut8_t
 
	gP_Vue
[
MAX_ANALOG_VALUES
];

56 
bo
 
	gAlog_Vue_Inlized
 = 
l
;

58 
	$Alog_Vue_In
(

61 
i
;

63 i(!
Alog_Vue_Inlized
) {

64 
Alog_Vue_Inlized
 = 
ue
;

67 
i
 = 0; i < 
MAX_ANALOG_VALUES
; i++) {

68 
P_Vue
[
i
] = 
ANALOG_LEVEL_NULL
;

73 
	}
}

78 
bo
 
	$Alog_Vue_Vid_In
(

79 
ut32_t
 
obje_
)

81 
	`Alog_Vue_In
();

82 i(
obje_
 < 
MAX_ANALOG_VALUES
)

83  
ue
;

85  
l
;

86 
	}
}

90 
	$Alog_Vue_Cou
(

93 
	`Alog_Vue_In
();

94  
MAX_ANALOG_VALUES
;

95 
	}
}

100 
ut32_t
 
	$Alog_Vue_Index_To_In
(

101 
dex
)

103 
	`Alog_Vue_In
();

104  
dex
;

105 
	}
}

110 
	$Alog_Vue_In_To_Index
(

111 
ut32_t
 
obje_
)

113 
dex
 = 
MAX_ANALOG_VALUES
;

115 
	`Alog_Vue_In
();

116 i(
obje_
 < 
MAX_ANALOG_VALUES
)

117 
dex
 = 
obje_
;

119  
dex
;

120 
	}
}

122 
	$Alog_Vue_P_Vue
(

123 
ut32_t
 
obje_
)

125 
vue
 = 
ANALOG_RELINQUISH_DEFAULT
;

126 
dex
 = 0;

127 
i
 = 0;

129 
	`Alog_Vue_In
();

130 
dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

131 i(
dex
 < 
MAX_ANALOG_VALUES
) {

132 
vue
 = 
P_Vue
[
dex
];

135  
vue
;

136 
	}
}

139 *
	$Alog_Vue_Name
(

140 
ut32_t
 
obje_
)

142 
xt_rg
[32] = "";

144 i(
obje_
 < 
MAX_ANALOG_VALUES
) {

145 
	`rtf
(
xt_rg
, "AV-%lu", (
obje_
);

146  
xt_rg
;

149  
NULL
;

150 
	}
}

153 
	$Alog_Vue_Rd_Prݔty
(

154 
BACNET_READ_PROPERTY_DATA
 * 
da
)

156 
n
 = 0;

157 
du_n
 = 0;

158 
BACNET_BIT_STRING
 
b_rg
;

159 
BACNET_CHARACTER_STRING
 
ch_rg
;

160 
_vue
 = () 1.414;

161 
obje_dex
 = 0;

162 
i
 = 0;

163 
bo
 
e
 = 
l
;

164 
ut8_t
 *
du
 = 
NULL
;

166 
	`Alog_Vue_In
();

167 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

168 (
da
->
iti_da_n
 == 0)) {

171 
du
 = 
da
->
iti_da
;

172 
da
->
obje_ݔty
) {

173 
PROP_OBJECT_IDENTIFIER
:

174 
du_n
 =

175 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_ANALOG_VALUE
,

176 
da
->
obje_
);

178 
PROP_OBJECT_NAME
:

179 
PROP_DESCRIPTION
:

180 
	`charg__si
(&
ch_rg
,

181 
	`Alog_Vue_Name
(
da
->
obje_
));

182 
du_n
 =

183 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

185 
PROP_OBJECT_TYPE
:

186 
du_n
 =

187 
	`code_iti_umed
(&
du
[0], 
OBJECT_ANALOG_VALUE
);

189 
PROP_PRESENT_VALUE
:

190 
_vue
 = 
	`Alog_Vue_P_Vue
(
da
->
obje_
);

191 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

193 
PROP_STATUS_FLAGS
:

194 
	`brg_
(&
b_rg
);

195 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

196 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

197 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

198 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

199 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

201 
PROP_EVENT_STATE
:

202 
du_n
 =

203 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

205 
PROP_OUT_OF_SERVICE
:

207 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

208 
e
 = 
Alog_Vue_Out_Of_Svi
[
obje_dex
];

210 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

212 
PROP_UNITS
:

213 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
UNITS_PERCENT
);

216 
PROP_PRIORITY_ARRAY
:

218 i(
y_dex
 == 0)

219 
du_n
 =

220 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

223 i(
y_dex
 =
BACNET_ARRAY_ALL
) {

224 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

225 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

227 i(
P_Vue
[
obje_dex
][
i
] =
ANALOG_LEVEL_NULL
)

228 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

230 
_vue
 = 
P_Vue
[
obje_dex
][
i
];

231 
n
 =

232 
	`code_iti_
(&
du
[
du_n
],

233 
_vue
);

236 i((
du_n
 + 
n
< 
MAX_APDU
)

237 
du_n
 +
n
;

239 
da
->
r_code
 =

240 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

241 
du_n
 = 
BACNET_STATUS_ABORT
;

246 
obje_dex
 = 
	`Alog_Vue_In_To_Index
(
obje_
);

247 i(
y_dex
 <
BACNET_MAX_PRIORITY
) {

248 i(
P_Vue
[
obje_dex
][
y_dex
 - 1] ==

249 
ANALOG_LEVEL_NULL
)

250 
du_n
 = 
	`code_iti_nu
(&
du
[0]);

252 
_vue
 =

253 
P_Vue
[
obje_dex
][
y_dex
 - 1];

254 
du_n
 =

255 
	`code_iti_
(&
du
[0], 
_vue
);

258 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

259 *
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

260 
du_n
 = -1;

265 
PROP_RELINQUISH_DEFAULT
:

266 
_vue
 = 
ANALOG_RELINQUISH_DEFAULT
;

267 
du_n
 = 
	`code_iti_
(&
du
[0], 
_vue
);

271 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

272 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

273 
du_n
 = -1;

277 i((
du_n
 >= 0) &&

279 (
ݔty
 !
PROP_PRIORITY_ARRAY
) &&

281 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

282 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

283 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

284 
du_n
 = -1;

287  
du_n
;

288 
	}
}

291 
bo
 
	$Alog_Vue_Wre_Prݔty
(

292 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

294 
bo
 
us
 = 
l
;

295 
obje_dex
 = 0;

296 
iܙy
 = 0;

297 
ut8_t
 
v
 = 
ANALOG_LEVEL_NULL
;

298 
n
 = 0;

299 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

301 
	`Alog_Vue_In
();

302 i(!
	`Alog_Vue_Vid_In
(
wp_da
->
obje_
)) {

303 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

304 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

305  
l
;

308 
n
 =

309 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

310 
wp_da
->
iti_da_n
, &
vue
);

312 i(
n
 < 0) {

314 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

315 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

316  
l
;

318 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

319 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

321 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

322 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

323  
l
;

325 
wp_da
->
obje_ݔty
) {

326 
PROP_PRESENT_VALUE
:

327 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_REAL
) {

328 
iܙy
 = 
wp_da
->priority;

332 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

333 (
iܙy
 != 6 ) &&

334 (
vue
.
ty
.
Rl
 >= 0.0) && (value.type.Real <= 100.0)) {

335 
v
 = (
ut8_t

vue
.
ty
.
Rl
;

336 
obje_dex
 =

337 
Alog_Vue_In_To_Index


338 (
wp_da
->
obje_
);

339 
iܙy
--;

340 
P_Vue
[
obje_dex
] = 
v
;

346 
us
 = 
ue
;

347 } i(
iܙy
 == 6) {

351 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

352 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

354 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

355 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

358 } i(
vue
.
g
 =
BACNET_APPLICATION_TAG_NULL
) {

359 
v
 = 
ANALOG_LEVEL_NULL
;

360 
obje_dex
 =

361 
	`Alog_Vue_In_To_Index
(
wp_da
->
obje_
);

362 
iܙy
 = 
wp_da
->priority;

363 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

364 
iܙy
--;

365 
P_Vue
[
obje_dex
][
iܙy
] = 
v
;

372 
us
 = 
ue
;

374 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

375 *
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

379 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

380 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

384 
PROP_OUT_OF_SERVICE
:

385 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_BOOLEAN
) {

386 
obje_dex
 =

387 
	`Alog_Vue_In_To_Index
(
wp_da
->
obje_
);

388 
Alog_Vue_Out_Of_Svi
[
obje_dex
] = 
vue
.
ty
.
Boޗn
;

389 
us
 = 
ue
;

391 *
r_ass
 = 
ERROR_CLASS_PROPERTY
;

392 *
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

396 
PROP_OBJECT_IDENTIFIER
:

397 
PROP_OBJECT_NAME
:

398 
PROP_OBJECT_TYPE
:

399 
PROP_STATUS_FLAGS
:

400 
PROP_EVENT_STATE
:

401 
PROP_OUT_OF_SERVICE
:

402 
PROP_DESCRIPTION
:

403 
PROP_PRIORITY_ARRAY
:

404 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

405 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

408 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

409 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

413  
us
;

414 
	}
}

	@ports/pic18f6720/bi.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~<rg.h
>

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"banum.h
"

35 
	~"cfig.h
"

36 
	~"wp.h
"

37 
	~".h
"

38 
	~"bi.h
"

40 
	#MAX_BINARY_INPUTS
 8

	)

42 
BACNET_BINARY_PV
 
	gP_Vue
[
MAX_BINARY_INPUTS
];

44 
	$By_Iut_Inlize
(

47 
bo
 
lized
 = 
l
;

48 
i
;

50 i(!
lized
) {

51 
lized
 = 
ue
;

52 
i
 = 0; i < 
MAX_BINARY_INPUTS
; i++) {

53 
P_Vue
[
i
] = 
BINARY_INACTIVE
;

56 
	}
}

59 
bo
 
	$By_Iut_Vid_In
(

60 
ut32_t
 
obje_
)

62 i(
obje_
 < 
MAX_BINARY_INPUTS
)

63  
ue
;

65  
l
;

66 
	}
}

69 
	$By_Iut_Cou
(

72  
MAX_BINARY_INPUTS
;

73 
	}
}

76 
ut32_t
 
	$By_Iut_Index_To_In
(

77 
dex
)

79  
dex
;

80 
	}
}

85 
	$By_Iut_In_To_Index
(

86 
ut32_t
 
obje_
)

88 
dex
 = 
MAX_BINARY_INPUTS
;

90 i(
obje_
 < 
MAX_BINARY_INPUTS
)

91 
dex
 = 
obje_
;

93  
dex
;

94 
	}
}

96 
BACNET_BINARY_PV
 
	$By_Iut_P_Vue
(

97 
ut32_t
 
obje_
)

99 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

100 
dex
 = 0;

102 
	`By_Iut_Inlize
();

103 
dex
 = 
	`By_Iut_In_To_Index
(
obje_
);

104 i(
dex
 < 
MAX_BINARY_INPUTS
) {

105 
vue
 = 
P_Vue
[
dex
];

108  
vue
;

109 
	}
}

111 *
	$By_Iut_Name
(

112 
ut32_t
 
obje_
)

114 
xt_rg
[16] = "";

116 i(
obje_
 < 
MAX_BINARY_INPUTS
) {

117 
	`rtf
(
xt_rg
, "BI-%lu", (
obje_
);

118  
xt_rg
;

121  
NULL
;

122 
	}
}

126 
	$By_Iut_Rd_Prݔty
(

127 
BACNET_READ_PROPERTY_DATA
 * 
da
)

129 
du_n
 = 0;

130 
BACNET_BIT_STRING
 
b_rg
;

131 
BACNET_CHARACTER_STRING
 
ch_rg
;

132 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

133 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

134 
ut8_t
 *
du
 = 
NULL
;

136 
	`By_Iut_Inlize
();

137 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

138 (
da
->
iti_da_n
 == 0)) {

141 
du
 = 
da
->
iti_da
;

142 
da
->
obje_ݔty
) {

143 
PROP_OBJECT_IDENTIFIER
:

144 
du_n
 =

145 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_BINARY_INPUT
,

146 
da
->
obje_
);

148 
PROP_OBJECT_NAME
:

149 
PROP_DESCRIPTION
:

151 
	`charg__si
(&
ch_rg
,

152 
	`By_Iut_Name
(
da
->
obje_
));

153 
du_n
 =

154 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

156 
PROP_OBJECT_TYPE
:

157 
du_n
 =

158 
	`code_iti_umed
(&
du
[0], 
OBJECT_BINARY_INPUT
);

160 
PROP_PRESENT_VALUE
:

161 
vue
 = 
	`By_Iut_P_Vue
(
da
->
obje_
);

162 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
vue
);

164 
PROP_STATUS_FLAGS
:

166 
	`brg_
(&
b_rg
);

167 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

168 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

169 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

170 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

171 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

173 
PROP_EVENT_STATE
:

175 
du_n
 =

176 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

178 
PROP_OUT_OF_SERVICE
:

179 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

181 
PROP_POLARITY
:

182 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
pެy
);

185 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

186 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

187 
du_n
 = -1;

191 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

192 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

193 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

194 
du_n
 = -1;

197  
du_n
;

198 
	}
}

	@ports/pic18f6720/bv.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~<rg.h
>

32 
	~"bacdef.h
"

33 
	~"bacdcode.h
"

34 
	~"banum.h
"

35 
	~"cfig.h
"

36 
	~"wp.h
"

37 
	~".h
"

38 
	~"bv.h
"

40 
	#MAX_BINARY_VALUES
 8

	)

42 
BACNET_BINARY_PV
 
	gP_Vue
[
MAX_BINARY_VALUES
];

44 
	$By_Vue_Inlize
(

47 
bo
 
lized
 = 
l
;

48 
i
;

50 i(!
lized
) {

51 
lized
 = 
ue
;

52 
i
 = 0; i < 
MAX_BINARY_VALUES
; i++) {

53 
P_Vue
[
i
] = 
BINARY_INACTIVE
;

56 
	}
}

59 
bo
 
	$By_Vue_Vid_In
(

60 
ut32_t
 
obje_
)

62 i(
obje_
 < 
MAX_BINARY_VALUES
)

63  
ue
;

65  
l
;

66 
	}
}

69 
	$By_Vue_Cou
(

72  
MAX_BINARY_VALUES
;

73 
	}
}

76 
ut32_t
 
	$By_Vue_Index_To_In
(

77 
dex
)

79  
dex
;

80 
	}
}

83 
	$By_Vue_In_To_Index
(

84 
ut32_t
 
obje_
)

86 
dex
 = 
MAX_BINARY_VALUES
;

88 i(
obje_
 < 
MAX_BINARY_VALUES
)

89 
dex
 = 
obje_
;

91  
dex
;

92 
	}
}

94 
BACNET_BINARY_PV
 
	$By_Vue_P_Vue
(

95 
ut32_t
 
obje_
)

97 
BACNET_BINARY_PV
 
vue
 = 
BINARY_INACTIVE
;

99 
	`By_Vue_Inlize
();

100 i(
obje_
 < 
MAX_BINARY_VALUES
) {

101 
vue
 = 
P_Vue
[
obje_
];

104  
vue
;

105 
	}
}

108 *
	$By_Vue_Name
(

109 
ut32_t
 
obje_
)

111 
xt_rg
[16] = "";

113 i(
obje_
 < 
MAX_BINARY_VALUES
) {

114 
	`rtf
(
xt_rg
, "BV-%lu", (
obje_
);

115  
xt_rg
;

118  
NULL
;

119 
	}
}

122 
	$By_Vue_Rd_Prݔty
(

123 
BACNET_READ_PROPERTY_DATA
 * 
da
)

125 
n
 = 0;

126 
du_n
 = 0;

127 
BACNET_BIT_STRING
 
b_rg
;

128 
BACNET_CHARACTER_STRING
 
ch_rg
;

129 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

130 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

131 
obje_dex
 = 0;

132 
i
 = 0;

133 
bo
 
e
 = 
l
;

134 
ut8_t
 *
du
 = 
NULL
;

136 
	`By_Vue_Inlize
();

137 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

138 (
da
->
iti_da_n
 == 0)) {

141 
du
 = 
da
->
iti_da
;

142 
da
->
obje_ݔty
) {

143 
PROP_OBJECT_IDENTIFIER
:

144 
du_n
 =

145 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_BINARY_VALUE
,

146 
da
->
obje_
);

150 
PROP_OBJECT_NAME
:

151 
PROP_DESCRIPTION
:

152 
	`charg__si
(&
ch_rg
,

153 
	`By_Vue_Name
(
da
->
obje_
));

154 
du_n
 =

155 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

157 
PROP_OBJECT_TYPE
:

158 
du_n
 =

159 
	`code_iti_umed
(&
du
[0], 
OBJECT_BINARY_VALUE
);

161 
PROP_PRESENT_VALUE
:

162 
e_vue
 =

163 
	`By_Vue_P_Vue
(
da
->
obje_
);

164 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

166 
PROP_STATUS_FLAGS
:

168 
	`brg_
(&
b_rg
);

169 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

170 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

171 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

172 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

173 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

175 
PROP_EVENT_STATE
:

177 
du_n
 =

178 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

180 
PROP_OUT_OF_SERVICE
:

181 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

183 
PROP_POLARITY
:

185 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
pެy
);

188 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

189 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

190 
du_n
 = -1;

194 i((
du_n
 >0&& (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

195 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

196 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

197 
du_n
 = -1;

200  
du_n
;

201 
	}
}

204 
bo
 
	$By_Vue_Wre_Prݔty
(

205 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

207 
bo
 
us
 = 
l
;

208 
obje_dex
 = 0;

209 
iܙy
 = 0;

210 
BACNET_BINARY_PV
 
v
 = 
BINARY_NULL
;

211 
n
 = 0;

212 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

214 i(!
	`By_Vue_Vid_In
(
wp_da
->
obje_
)) {

215 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

216 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

217  
l
;

220 
n
 =

221 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

222 
wp_da
->
iti_da_n
, &
vue
);

224 i(
n
 < 0) {

226 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

227 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

228  
l
;

230 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

231 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

233 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

234 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

235  
l
;

237 
wp_da
->
obje_ݔty
) {

238 
PROP_PRESENT_VALUE
:

239 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_ENUMERATED
) {

240 
iܙy
 = 
wp_da
->priority;

244 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

245 (
iܙy
 != 6 ) &&

246 (
vue
.
ty
.
Enumed
 >
MIN_BINARY_PV
) &&

247 (
vue
.
ty
.
Enumed
 <
MAX_BINARY_PV
)) {

248 
v
 = 
vue
.
ty
.
Enumed
;

249 
obje_dex
 =

250 
By_Vue_In_To_Index


251 (
wp_da
->
obje_
);

252 
iܙy
--;

254 
P_Vue
[
obje_dex
] = 
v
;

259 
us
 = 
ue
;

260 } i(
iܙy
 == 6) {

264 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

265 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

267 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

268 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

270 } i(
vue
.
g
 =
BACNET_APPLICATION_TAG_NULL
) {

273 
v
 = 
BINARY_NULL
;

274 
obje_dex
 =

275 
	`By_Vue_In_To_Index
(
wp_da
->
obje_
);

276 
iܙy
 = 
wp_da
->priority;

277 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

278 
iܙy
--;

279 
By_Vue_Lev
[
obje_dex
][
iܙy
] = 
v
;

286 
us
 = 
ue
;

288 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

289 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

292 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

293 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

296 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

297 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

300 
PROP_OUT_OF_SERVICE
:

302 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_BOOLEAN
) {

303 
obje_dex
 =

304 
	`By_Vue_In_To_Index
(
wp_da
->
obje_
);

305 
By_Vue_Out_Of_Svi
[
obje_dex
] = 
vue
.
ty
.
Boޗn
;

306 
us
 = 
ue
;

308 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

309 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

313 
PROP_OBJECT_IDENTIFIER
:

314 
PROP_OBJECT_NAME
:

315 
PROP_OBJECT_TYPE
:

316 
PROP_STATUS_FLAGS
:

317 
PROP_EVENT_STATE
:

318 
PROP_POLARITY
:

319 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

320 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

323 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

324 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

328  
us
;

329 
	}
}

	@ports/pic18f6720/device.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<rg.h
>

29 
	~"bacdef.h
"

30 
	~"bacdcode.h
"

31 
	~"bacr.h
"

32 
	~"banum.h
"

33 
	~"cfig.h
"

34 
	~"du.h
"

35 
	~"dlmp.h
"

36 
	~"rs485.h
"

37 
	~"ai.h
"

38 
	~"av.h
"

39 
	~"bi.h
"

40 
	~"bv.h
"

41 
	~".h
"

42 
	~"wp.h
"

43 
	~"dcc.h
"

44 
	~"vsi.h
"

45 
	~"devi.h
"

51 
ut32_t
 
	gObje_In_Numb
 = 12345;

52 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

53 
ut8_t
 
	gDaba_Revisi
;

54 
BACNET_REINITIALIZED_STATE
 
	gRelize_S
 = 
BACNET_REINIT_IDLE
;

55 
	gRe_Passwd
[16] = "filister";

57 
bo
 
	$Devi_Relize
(

58 
BACNET_REINITIALIZE_DEVICE_DATA
 * 
rd_da
)

60 
bo
 
us
 = 
l
;

63 i(
	`charg_si_me
(&
rd_da
->
sswd
, 
Re_Passwd
)) {

64 
rd_da
->
e
) {

65 
BACNET_REINIT_COLDSTART
:

66 
BACNET_REINIT_WARMSTART
:

67 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

71 
Relize_S
 = 
rd_da
->
e
;

72 
us
 = 
ue
;

74 
BACNET_REINIT_STARTBACKUP
:

75 
BACNET_REINIT_ENDBACKUP
:

76 
BACNET_REINIT_STARTRESTORE
:

77 
BACNET_REINIT_ENDRESTORE
:

78 
BACNET_REINIT_ABORTRESTORE
:

79 i(
	`dcc_communiti_dibd
()) {

80 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

81 
rd_da
->
r_code
 = 
ERROR_CODE_COMMUNICATION_DISABLED
;

83 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

84 
rd_da
->
r_code
 =

85 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

89 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

90 
rd_da
->
r_code
 = 
ERROR_CODE_PARAMETER_OUT_OF_RANGE
;

94 
rd_da
->
r_ass
 = 
ERROR_CLASS_SECURITY
;

95 
rd_da
->
r_code
 = 
ERROR_CODE_PASSWORD_FAILURE
;

98  
us
;

99 
	}
}

101 
BACNET_REINITIALIZED_STATE
 
	$Devi_Relized_S
(

104  
Relize_S
;

105 
	}
}

107 
	$Devi_In
(

108 
obje_funis_t
 * 
obje_b
)

110 (
obje_b
;

111 
Relize_S
 = 
BACNET_REINIT_IDLE
;

112 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

118 
	}
}

121 
ut32_t
 
	$Devi_Obje_In_Numb
(

124  
Obje_In_Numb
;

125 
	}
}

127 
bo
 
	$Devi_S_Obje_In_Numb
(

128 
ut32_t
 
obje_id
)

130 
bo
 
us
 = 
ue
;

132 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

133 
Obje_In_Numb
 = 
obje_id
;

134 
Daba_Revisi
++;

142 
us
 = 
l
;

144  
us
;

145 
	}
}

147 
bo
 
	$Devi_Vid_Obje_In_Numb
(

148 
ut32_t
 
obje_id
)

151  (
Obje_In_Numb
 =
obje_id
);

152 
	}
}

154 
BACNET_DEVICE_STATUS
 
	$Devi_Syem_Stus
(

157  
Syem_Stus
;

158 
	}
}

160 
	$Devi_S_Syem_Stus
(

161 
BACNET_DEVICE_STATUS
 
us
,

162 
bo
 
lol
)

164 i(
us
 < 
MAX_DEVICE_STATUS
) {

165 
Syem_Stus
 = 
us
;

167 
	}
}

169 
ut16_t
 
	$Devi_Vd_Idtifr
(

172  
BACNET_VENDOR_ID
;

173 
	}
}

175 
ut8_t
 
	$Devi_Proc_Vsi
(

178  
BACNET_PROTOCOL_VERSION
;

179 
	}
}

181 
ut8_t
 
	$Devi_Proc_Revisi
(

184  
BACNET_PROTOCOL_REVISION
;

185 
	}
}

187 
BACNET_SEGMENTATION
 
	$Devi_Segmti_Su܋d
(

190  
SEGMENTATION_NONE
;

191 
	}
}

193 
ut32_t
 
	$Devi_Daba_Revisi
(

196  
Daba_Revisi
;

197 
	}
}

201 
	$Devi_Obje_Li_Cou
(

204 
cou
 = 1;

207 
cou
 +
	`By_Vue_Cou
();

208 
cou
 +
	`Alog_Iut_Cou
();

209 
cou
 +
	`By_Iut_Cou
();

210 
cou
 +
	`Alog_Vue_Cou
();

212  
cou
;

213 
	}
}

217 
bo
 
	$Devi_Obje_Li_Idtifr
(

218 
ut32_t
 
y_dex
,

219 *
obje_ty
,

220 
ut32_t
 * 

)

222 
bo
 
us
 = 
l
;

223 
ut32_t
 
obje_dex
 = 0;

224 
ut32_t
 
obje_cou
 = 0;

227 i(
y_dex
 == 1) {

228 *
obje_ty
 = 
OBJECT_DEVICE
;

229 *

 = 
Obje_In_Numb
;

230 
us
 = 
ue
;

235 
obje_dex
 = 
y_dex
 - 1;

237 
obje_cou
 = 1;

240 i(!
us
) {

241 
obje_dex
 -
obje_cou
;

242 
obje_cou
 = 
	`By_Vue_Cou
();

244 i(
obje_dex
 < 
obje_cou
) {

245 *
obje_ty
 = 
OBJECT_BINARY_VALUE
;

246 *

 = 
	`By_Vue_Index_To_In
(
obje_dex
);

247 
us
 = 
ue
;

251 i(!
us
) {

253 
obje_dex
 -
obje_cou
;

254 
obje_cou
 = 
	`Alog_Vue_Cou
();

255 i(
obje_dex
 < 
obje_cou
) {

256 *
obje_ty
 = 
OBJECT_ANALOG_VALUE
;

257 *

 = 
	`Alog_Vue_Index_To_In
(
obje_dex
);

258 
us
 = 
ue
;

262 i(!
us
) {

264 
obje_dex
 -
obje_cou
;

265 
obje_cou
 = 
	`Alog_Iut_Cou
();

266 i(
obje_dex
 < 
obje_cou
) {

267 *
obje_ty
 = 
OBJECT_ANALOG_INPUT
;

268 *

 = 
	`Alog_Iut_Index_To_In
(
obje_dex
);

269 
us
 = 
ue
;

273 i(!
us
) {

276 
obje_dex
 -
obje_cou
;

277 
obje_cou
 = 
	`By_Iut_Cou
();

279 i(
obje_dex
 < 
obje_cou
) {

280 *
obje_ty
 = 
OBJECT_BINARY_INPUT
;

281 *

 = 
	`By_Iut_Index_To_In
(
obje_dex
);

282 
us
 = 
ue
;

286  
us
;

287 
	}
}

290 
	$Devi_Rd_Prݔty_Lol
(

291 
BACNET_READ_PROPERTY_DATA
 * 
da
)

293 
du_n
 = 0;

294 
n
 = 0;

295 
BACNET_BIT_STRING
 
b_rg
;

296 
BACNET_CHARACTER_STRING
 
ch_rg
;

297 
ut32_t
 
i
 = 0;

298 
obje_ty
 = 0;

299 
ut32_t
 

 = 0;

300 
ut32_t
 
cou
 = 0;

301 
BACNET_TIME
 
lol_time
;

302 
BACNET_DATE
 
lol_de
;

303 
ut8_t
 
yr
 = 0;

304 
rg_bufr
[28];

305 
t16_t
 
TimeZe
 = 0;

306 
ut8_t
 *
du
 = 
NULL
;

308 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

309 (
da
->
iti_da_n
 == 0)) {

312 
du
 = 
da
->
iti_da
;

314 
da
->
obje_ݔty
) {

315 
PROP_OBJECT_IDENTIFIER
:

316 
du_n
 =

317 
	`code_iti_obje_id
(&
du
[0], 
OBJECT_DEVICE
,

318 
Obje_In_Numb
);

320 
PROP_OBJECT_NAME
:

321 (
	`rypgm2m
(&
rg_bufr
[0], "PIC18F6720 Device");

322 
	`charg__si
(&
ch_rg
, 
rg_bufr
);

323 
du_n
 =

324 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

326 
PROP_OBJECT_TYPE
:

327 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
OBJECT_DEVICE
);

329 
PROP_DESCRIPTION
:

330 (
	`rypgm2m
(&
rg_bufr
[0], "BACnet Demo");

331 
	`charg__si
(&
ch_rg
, 
rg_bufr
);

332 
du_n
 =

333 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

335 
PROP_SYSTEM_STATUS
:

336 
du_n
 =

337 
	`code_iti_umed
(&
du
[0],

338 
	`Devi_Syem_Stus
());

340 
PROP_VENDOR_NAME
:

341 (
	`rypgm2m
(&
rg_bufr
[0], 
BACNET_VENDOR_NAME
);

342 
	`charg__si
(&
ch_rg
, 
rg_bufr
);

343 
du_n
 =

344 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

346 
PROP_VENDOR_IDENTIFIER
:

347 
du_n
 =

348 
	`code_iti_unsigd
(&
du
[0],

349 
	`Devi_Vd_Idtifr
());

351 
PROP_MODEL_NAME
:

352 (
	`rypgm2m
(&
rg_bufr
[0], "GNU Demo");

353 
	`charg__si
(&
ch_rg
, 
rg_bufr
);

354 
du_n
 =

355 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

357 
PROP_FIRMWARE_REVISION
:

358 (
	`rypgm2m
(&
rg_bufr
[0], 
BACNET_VERSION_TEXT
);

359 
	`charg__si
(&
ch_rg
, 
rg_bufr
);

360 
du_n
 =

361 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

363 
PROP_APPLICATION_SOFTWARE_VERSION
:

364 (
	`rypgm2m
(&
rg_bufr
[0], "1.0");

365 
	`charg__si
(&
ch_rg
, 
rg_bufr
);

366 
du_n
 =

367 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

369 
PROP_LOCATION
:

370 (
	`rypgm2m
(&
rg_bufr
[0], "USA");

371 
	`charg__si
(&
ch_rg
, 
rg_bufr
);

372 
du_n
 =

373 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

375 
PROP_PROTOCOL_VERSION
:

376 
du_n
 =

377 
	`code_iti_unsigd
(&
du
[0],

378 
	`Devi_Proc_Vsi
());

380 
PROP_PROTOCOL_REVISION
:

381 
du_n
 =

382 
	`code_iti_unsigd
(&
du
[0],

383 
	`Devi_Proc_Revisi
());

385 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

387 
	`brg_
(&
b_rg
);

388 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

390 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

391 
	`du_rvi_su܋d
(
i
));

393 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

395 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

398 
	`brg_
(&
b_rg
);

399 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

401 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

404 
	`brg_t_b
(&
b_rg
, 
OBJECT_DEVICE
, 
ue
);

405 
	`brg_t_b
(&
b_rg
, 
OBJECT_ANALOG_VALUE
, 
ue
);

406 
	`brg_t_b
(&
b_rg
, 
OBJECT_BINARY_VALUE
, 
ue
);

407 
	`brg_t_b
(&
b_rg
, 
OBJECT_ANALOG_INPUT
, 
ue
);

408 
	`brg_t_b
(&
b_rg
, 
OBJECT_BINARY_INPUT
, 
ue
);

409 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

411 
PROP_OBJECT_LIST
:

412 
cou
 = 
	`Devi_Obje_Li_Cou
();

414 i(
da
->
y_dex
 == 0)

415 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

420 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

421 
i
 = 1; i <
cou
; i++) {

422 i(
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
,

423 &

)) {

424 
n
 =

425 
	`code_iti_obje_id
(&
du
[
du_n
],

426 
obje_ty
, 

);

427 
du_n
 +
n
;

430 i((
du_n
 + 
n
>
MAX_APDU
) {

431 
da
->
r_code
 =

432 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

433 
du_n
 = 
BACNET_STATUS_ABORT
;

438 
da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

439 
da
->
r_code
 = 
ERROR_CODE_OTHER
;

440 
du_n
 = 
BACNET_STATUS_ERROR
;

445 i(
	`Devi_Obje_Li_Idtifr
(
da
->
y_dex
,

446 &
obje_ty
, &

))

447 
du_n
 =

448 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

449 

);

451 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

452 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

453 
du_n
 = 
BACNET_STATUS_ERROR
;

457 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

458 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

460 
PROP_SEGMENTATION_SUPPORTED
:

461 
du_n
 =

462 
	`code_iti_umed
(&
du
[0],

463 
	`Devi_Segmti_Su܋d
());

465 
PROP_APDU_TIMEOUT
:

466 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_timeout
());

468 
PROP_NUMBER_OF_APDU_RETRIES
:

469 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_s
());

471 
PROP_DEVICE_ADDRESS_BINDING
:

474 
PROP_DATABASE_REVISION
:

475 
du_n
 =

476 
	`code_iti_unsigd
(&
du
[0],

477 
	`Devi_Daba_Revisi
());

479 
PROP_MAX_INFO_FRAMES
:

480 
du_n
 =

481 
	`code_iti_unsigd
(&
du
[0],

482 
	`dlmp_max_fo_ames
());

484 
PROP_MAX_MASTER
:

485 
du_n
 =

486 
	`code_iti_unsigd
(&
du
[0], 
	`dlmp_max_ma
());

488 
PROP_LOCAL_TIME
:

490 
lol_time
.
hour
 = 0;

491 
lol_time
.
m
 = 0;

492 
lol_time
.
c
 = 0;

493 
lol_time
.
hunddths
 = 0;

494 
du_n
 = 
	`code_iti_time
(&
du
[0], &
lol_time
);

496 
PROP_UTC_OFFSET
:

499 
du_n
 = 
	`code_iti_sigd
(&
du
[0], 5 * 60 );

501 
PROP_LOCAL_DATE
:

503 
lol_de
.
yr
 = 2006;

504 
lol_de
.
mth
 = 4;

505 
lol_de
.
day
 = 11;

506 
lol_de
.
wday
 = 0;

507 
du_n
 = 
	`code_iti_de
(&
du
[0], &
lol_de
);

509 
PROP_DAYLIGHT_SAVINGS_STATUS
:

511 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
l
);

514 
du_n
 =

515 
	`code_iti_unsigd
(&
du
[0], 
	`RS485_G_Baud_Re
());

518 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

519 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

520 
du_n
 = -1;

524 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

525 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

526 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

527 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

528 
du_n
 = 
BACNET_STATUS_ERROR
;

531  
du_n
;

532 
	}
}

534 
	$Devi_Rd_Prݔty
(

535 
BACNET_READ_PROPERTY_DATA
 * 
da
)

537 
du_n
 = 
BACNET_STATUS_ERROR
;

540 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

541 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

542 
da
->
obje_ty
) {

543 
OBJECT_ANALOG_INPUT
:

544 i(
	`Alog_Iut_Vid_In
(
da
->
obje_
)) {

545 
du_n
 = 
	`Alog_Iut_Rd_Prݔty
(
da
);

548 
OBJECT_ANALOG_VALUE
:

549 i(
	`Alog_Vue_Vid_In
(
da
->
obje_
)) {

550 
du_n
 = 
	`Alog_Vue_Rd_Prݔty
(
da
);

553 
OBJECT_BINARY_INPUT
:

554 i(
	`By_Iut_Vid_In
(
da
->
obje_
)) {

555 
du_n
 = 
	`By_Iut_Rd_Prݔty
(
da
);

558 
OBJECT_BINARY_VALUE
:

559 i(
	`By_Vue_Vid_In
(
da
->
obje_
)) {

560 
du_n
 = 
	`By_Vue_Rd_Prݔty
(
da
);

563 
OBJECT_DEVICE
:

564 i(
	`Devi_Vid_Obje_In_Numb
(
da
->
obje_
)) {

565 
du_n
 = 
	`Devi_Rd_Prݔty_Lol
(
da
);

572  
du_n
;

573 
	}
}

575 
bo
 
	$Devi_Wre_Prݔty_Lol
(

576 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

578 
bo
 
us
 = 
l
;

579 
n
 = 0;

580 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

582 i(!
	`Devi_Vid_Obje_In_Numb
(
wp_da
->
obje_
)) {

583 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

584 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

585  
l
;

588 
n
 =

589 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

590 
wp_da
->
iti_da_n
, &
vue
);

592 i(
n
 < 0) {

594 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

595 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

596  
l
;

598 i((
wp_da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

599 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

601 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

602 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

603  
l
;

605 
wp_da
->
obje_ݔty
) {

606 
PROP_OBJECT_IDENTIFIER
:

607 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_OBJECT_ID
) {

608 i((
vue
.
ty
.
Obje_Id
.ty =
OBJECT_DEVICE
) &&

609 (
	`Devi_S_Obje_In_Numb
(
vue
.
ty
.

610 
Obje_Id
.

))) {

612 
us
 = 
ue
;

614 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

615 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

618 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

619 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

622 
PROP_MAX_INFO_FRAMES
:

623 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

624 i(
vue
.
ty
.
Unsigd_I
 <= 255) {

625 
	`dlmp_t_max_fo_ames
(
vue
.
ty
.
Unsigd_I
);

626 
us
 = 
ue
;

628 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

629 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

632 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

633 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

636 
PROP_MAX_MASTER
:

637 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

638 i((
vue
.
ty
.
Unsigd_I
 > 0) &&

639 (
vue
.
ty
.
Unsigd_I
 <= 127)) {

640 
	`dlmp_t_max_ma
(
vue
.
ty
.
Unsigd_I
);

641 
us
 = 
ue
;

643 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

644 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

647 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

648 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

651 
PROP_OBJECT_NAME
:

652 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

653 
ut8_t
 
codg
;

654 
size_t
 
n
;

656 
codg
 =

657 
	`charg_codg
(&
vue
.
ty
.
Cha_Sg
);

658 
n
 = 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
);

659 i(
codg
 =
CHARACTER_ANSI_X34
) {

660 i(
n
 <= 20) {

668 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

669 
wp_da
->
r_code
 =

670 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

673 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

674 
wp_da
->
r_code
 =

675 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

678 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

679 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

683 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

684 i(
vue
.
ty
.
Unsigd_I
 > 115200) {

685 
	`RS485_S_Baud_Re
(
vue
.
ty
.
Unsigd_I
);

686 
us
 = 
ue
;

688 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

689 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

692 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

693 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

696 
PROP_NUMBER_OF_APDU_RETRIES
:

697 
PROP_APDU_TIMEOUT
:

698 
PROP_VENDOR_IDENTIFIER
:

699 
PROP_SYSTEM_STATUS
:

700 
PROP_LOCATION
:

701 
PROP_DESCRIPTION
:

702 
PROP_MODEL_NAME
:

703 
PROP_VENDOR_NAME
:

704 
PROP_FIRMWARE_REVISION
:

705 
PROP_APPLICATION_SOFTWARE_VERSION
:

706 
PROP_LOCAL_TIME
:

707 
PROP_UTC_OFFSET
:

708 
PROP_LOCAL_DATE
:

709 
PROP_DAYLIGHT_SAVINGS_STATUS
:

710 
PROP_PROTOCOL_VERSION
:

711 
PROP_PROTOCOL_REVISION
:

712 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

713 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

714 
PROP_OBJECT_LIST
:

715 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

716 
PROP_SEGMENTATION_SUPPORTED
:

717 
PROP_DEVICE_ADDRESS_BINDING
:

718 
PROP_DATABASE_REVISION
:

719 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

720 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

721 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

724 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

725 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

729  
us
;

730 
	}
}

732 
bo
 
	$Devi_Wre_Prݔty
(

733 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

735 
bo
 
us
 = 
l
;

736 
obje_funis
 *
pObje
 = 
NULL
;

739 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

740 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

741 
wp_da
->
obje_ty
) {

742 
OBJECT_ANALOG_INPUT
:

743 i(
	`Alog_Iut_Vid_In
(
wp_da
->
obje_
)) {

744 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

745 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

748 
OBJECT_ANALOG_VALUE
:

749 i(
	`Alog_Vue_Vid_In
(
wp_da
->
obje_
)) {

750 
us
 = 
	`Alog_Vue_Wre_Prݔty
(
wp_da
);

753 
OBJECT_BINARY_INPUT
:

754 i(
	`By_Iut_Vid_In
(
wp_da
->
obje_
)) {

755 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

756 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

759 
OBJECT_BINARY_VALUE
:

760 i(
	`By_Vue_Vid_In
(
wp_da
->
obje_
)) {

761 
us
 = 
	`By_Vue_Wre_Prݔty
(
wp_da
);

764 
OBJECT_DEVICE
:

765 i(
	`Devi_Vid_Obje_In_Numb
(
wp_da
->
obje_
)) {

766 
us
 = 
	`Devi_Wre_Prݔty_Lol
(
wp_da
);

773  (
us
);

774 
	}
}

	@ports/pic18f6720/dlmstp.c

25 
	~<dbo.h
>

26 
	~<dt.h
>

27 
	~<ddef.h
>

28 
	~<rg.h
>

29 #i
PRINT_ENABLED


30 
	~<dio.h
>

32 
	~"bacdef.h
"

33 
	~"mp.h
"

34 
	~"dlmp.h
"

35 
	~"rs485.h
"

36 
	~"du.h
"

37 
	~"hdrs.h
"

40 
ut16_t
 
	gMSTP_Packs
 = 0;

43 #agm
uda
 
MSTP_RxDa


44 
DLMSTP_PACKET
 
	gReive_Bufr
;

47 #agm
uda
 
MSTP_PtDa


48 vީ
mp_pt_ru_t
 
	gMSTP_Pt
;

49 #agm
uda


51 
	#INCREMENT_AND_LIMIT_UINT16
(
x
{i(x < 0xFFFFx++;}

	)

53 
	$dlmp_mlicd_tim
(

56 
	`INCREMENT_AND_LIMIT_UINT16
(
MSTP_Pt
.
STim
);

57 
	}
}

59 
	$dlmp_
(

62 
	`RS485_Re
();

63 
	`dlmp_t_my_addss
(
DEFAULT_MAC_ADDRESS
);

64 
	`dlmp_t_max_fo_ames
(
DEFAULT_MAX_INFO_FRAMES
);

65 
	`dlmp_t_max_ma
(
DEFAULT_MAX_MASTER
);

66 
	}
}

68 
	$dlmp_
(

71 
ut8_t
 
da
;

74 
Reive_Bufr
.
ady
 = 
l
;

75 
Reive_Bufr
.
pdu_n
 = 0;

77 
	`RS485_Inlize
();

78 
MSTP_Pt
.
IutBufr
 = &
Reive_Bufr
.
pdu
[0];

79 
	`MSTP_In
(&
MSTP_Pt
);

80 
	}
}

82 
	$dlmp_nup
(

86 
	}
}

89 
	$dlmp_nd_pdu
(

90 
BACNET_ADDRESS
 * 
de
,

91 
BACNET_NPDU_DATA
 * 
du_da
,

92 
ut8_t
 * 
pdu
,

93 
pdu_n
)

95 
bys_
 = 0;

96 
du_n
 = 0;

97 
ut8_t
 
ame_ty
 = 0;

98 
BACNET_ADDRESS
 
c
;

99 
i
 = 0;

101 i(
MSTP_Pt
.
TxRdy
 =
l
) {

102 i(
du_da
->
da_exg_y
)

103 
MSTP_Pt
.
TxFmeTy
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

105 
MSTP_Pt
.
TxFmeTy
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

108 i(
de
 && de->
mac_n
) {

109 
MSTP_Pt
.
TxDei
 = 
de
->
mac
[0];

112 
MSTP_Pt
.
TxDei
 = 
MSTP_BROADCAST_ADDRESS
;

114 
	`dlmp_g_my_addss
(&
c
);

115 i((
MAX_HEADER
 + 
pdu_n
> 
MAX_MPDU
) {

118 
bys_
 =

119 
	`MSTP_Ce_Fme
((
ut8_t
 *& 
MSTP_Pt
.
TxBufr
[0],

120 (
MSTP_Pt
.
TxBufr
), MSTP_Pt.
TxFmeTy
,

121 
MSTP_Pt
.
TxDei
, MSTP_Pt.
This_Sti
, 
pdu
, 
pdu_n
);

122 
MSTP_Pt
.
TxLgth
 = 
bys_
;

123 
MSTP_Pt
.
TxRdy
 = 
ue
;

124 
MSTP_Packs
++;

127  
bys_
;

128 
	}
}

130 
	$dlmp_sk
(

133 
bo
 
bys_mag
;

134 
bo
 
ived_ame
;

137 i((
MSTP_Pt
.
ReivedVidFme
 =
l
) &&

138 (
MSTP_Pt
.
ReivedInvidFme
 =
l
)) {

140 
bys_mag
 = 
	`RS485_Check_UART_Da
(&
MSTP_Pt
);

141 
	`MSTP_Reive_Fme_FSM
(&
MSTP_Pt
);

142 
ived_ame
 = 
MSTP_Pt
.
ReivedVidFme
 ||

143 
MSTP_Pt
.
ReivedInvidFme
;

144 i(
ived_ame
)

146 } 
bys_mag
);

149 i(
MSTP_Pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
) {

150 i(
MSTP_Pt
.
This_Sti
 <
DEFAULT_MAX_MASTER
) {

151 
	`MSTP_Ma_Node_FSM
(&
MSTP_Pt
)) {

158 i(
Reive_Bufr
.
ady
 && !
MSTP_Pt
.
TxRdy
) {

159 i(
Reive_Bufr
.
pdu_n
) {

160 
MSTP_Packs
++;

161 
	`du_hdr
(&
Reive_Bufr
.
addss
, &Reive_Bufr.
pdu
[0],

162 
Reive_Bufr
.
pdu_n
);

164 
Reive_Bufr
.
ady
 = 
l
;

168 
	}
}

170 
	$dlmp_fl_ba_addss
(

171 
BACNET_ADDRESS
 * 
c
,

172 
ut8_t
 
mp_addss
)

174 
i
 = 0;

176 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

178 
c
->
mac_n
 = 0;

179 
c
->
mac
[0] = 0;

181 
c
->
mac_n
 = 1;

182 
c
->
mac
[0] = 
mp_addss
;

185 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

186 
c
->
mac
[
i
] = 0;

188 
c
->
t
 = 0;

189 
c
->
n
 = 0;

190 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

191 
c
->
adr
[
i
] = 0;

193 
	}
}

196 
ut16_t
 
	$dlmp_put_ive
(

197 
ut8_t
 
c
,

198 
ut8_t
 * 
pdu
,

199 
ut16_t
 
pdu_n
)

202 
	`dlmp_fl_ba_addss
(&
Reive_Bufr
.
addss
, 
c
);

203 
Reive_Bufr
.
pdu_n
 =du_len;

204 
Reive_Bufr
.
ady
 = 
ue
;

205 
	}
}

207 
	$dlmp_t_my_addss
(

208 
ut8_t
 
mac_addss
)

211 i(
mac_addss
 <= 127) {

212 
MSTP_Pt
.
This_Sti
 = 
mac_addss
;

218 i(
mac_addss
 > 
MSTP_Pt
.
Nmax_ma
)

219 
	`dlmp_t_max_ma
(
mac_addss
);

223 
	}
}

225 
ut8_t
 
	$dlmp_my_addss
(

228  
MSTP_Pt
.
This_Sti
;

229 
	}
}

238 
	$dlmp_t_max_fo_ames
(

239 
ut8_t
 
max_fo_ames
)

241 i(
max_fo_ames
 >= 1) {

242 
MSTP_Pt
.
Nmax_fo_ames
 = 
max_fo_ames
;

251 
	}
}

253 
	$dlmp_max_fo_ames
(

256  
MSTP_Pt
.
Nmax_fo_ames
;

257 
	}
}

264 
	$dlmp_t_max_ma
(

265 
ut8_t
 
max_ma
)

267 i(
max_ma
 <= 127) {

268 i(
MSTP_Pt
.
This_Sti
 <
max_ma
) {

269 
MSTP_Pt
.
Nmax_ma
 = 
max_ma
;

279 
	}
}

281 
ut8_t
 
	$dlmp_max_ma
(

284  
MSTP_Pt
.
Nmax_ma
;

285 
	}
}

287 
	$dlmp_g_my_addss
(

288 
BACNET_ADDRESS
 * 
my_addss
)

290 
i
 = 0;

292 
my_addss
->
mac_n
 = 1;

293 
my_addss
->
mac
[0] = 
MSTP_Pt
.
This_Sti
;

294 
my_addss
->
t
 = 0;

295 
my_addss
->
n
 = 0;

296 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

297 
my_addss
->
adr
[
i
] = 0;

301 
	}
}

303 
	$dlmp_g_brd_addss
(

304 
BACNET_ADDRESS
 * 
de
)

306 
i
 = 0;

308 i(
de
) {

309 
de
->
mac_n
 = 1;

310 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

311 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

312 
de
->
n
 = 0;

313 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

314 
de
->
adr
[
i
] = 0;

319 
	}
}

	@ports/pic18f6720/dlmstp.h

35 #ide
DLMSTP_H


36 
	#DLMSTP_H


	)

38 
	~<dbo.h
>

39 
	~<dt.h
>

40 
	~<ddef.h
>

41 
	~"bacdef.h
"

42 
	~"du.h
"

45 
	#MAX_HEADER
 (2+1+1+1+2+1)

	)

46 
	#MAX_MPDU
 (
MAX_HEADER
+
MAX_PDU
)

	)

48 
	sdlmp_ck
 {

49 
bo
 
	mady
;

50 
BACNET_ADDRESS
 
	maddss
;

51 
ut8_t
 
	mame_ty
;

52 
	mpdu_n
;

53 
ut8_t
 
	mpdu
[
MAX_MPDU
];

54 } 
	tDLMSTP_PACKET
;

57 
ut16_t
 
MSTP_Packs
;

59 #ifde
__lulus


63 
dlmp_
(

65 
dlmp_
(

67 
dlmp_nup
(

69 
dlmp_mlicd_tim
(

71 
dlmp_sk
(

75 
dlmp_nd_pdu
(

76 
BACNET_ADDRESS
 * 
de
,

77 
BACNET_NPDU_DATA
 * 
du_da
,

78 
ut8_t
 * 
pdu
,

79 
pdu_n
);

88 
dlmp_t_max_fo_ames
(

89 
ut8_t
 
max_fo_ames
);

90 
dlmp_max_fo_ames
(

98 
dlmp_t_max_ma
(

99 
ut8_t
 
max_ma
);

100 
ut8_t
 
dlmp_max_ma
(

104 
dlmp_t_my_addss
(

105 
ut8_t
 
my_addss
);

106 
ut8_t
 
dlmp_my_addss
(

110 
dlmp_g_my_addss
(

111 
BACNET_ADDRESS
 * 
my_addss
);

112 
dlmp_g_brd_addss
(

113 
BACNET_ADDRESS
 * 
de
);

116 
ut16_t
 
dlmp_put_ive
(

117 
ut8_t
 
c
,

118 
ut8_t
 * 
pdu
,

119 
ut16_t
 
pdu_n
);

122 #ifde
__lulus


	@ports/pic18f6720/hardware.h

25 #ide
HARDWARE_H


26 
	#HARDWARE_H


	)

28 
	~<p18f6720.h
>

29 
	~<dt.h
>

30 
	~<dbo.h
>

48 
	#LCD_BUSY
 
PORTDbs
.
RD7


	)

49 
	#LCD_E
 
PORTGbs
.
RG3


	)

50 
	#LCD_RW
 
PORTAbs
.
RA5


	)

51 
	#LCD_RS
 
PORTEbs
.
RE2


	)

52 
	#LCD_DATA
 
PORTD


	)

53 
	#LCD_TRIS
 
TRISD


	)

55 
	#PILOT_LATCH
 
PORTCbs
.
RC0


	)

56 
	#PILOT_ENABLE
 
PORTCbs
.
RC1


	)

57 
	#PILOT_PORT
 
PORTD


	)

58 
	#PILOT_PORT_TRIS
 
TRISD


	)

60 
	#PIEZO
 
PORTCbs
.
RC2


	)

61 
	#PIEZO_ON
(
TRISCbs
.
TRISC2
 = 0

	)

62 
	#PIEZO_OFF
(
TRISCbs
.
TRISC2
 = 1

	)

64 
	#RS232_ENABLE
 
PORTCbs
.
RC5


	)

66 
	#RS485_TX_ENABLE
 
PORTEbs
.
RE3


	)

67 
	#RS485_RX_DISABLE
 
PORTGbs
.
RG0


	)

69 
	#SWITCH_LOAD
 
PORTBbs
.
RB5


	)

70 
	#SWITCH_CLK
 
PORTEbs
.
RE5


	)

71 
	#SWITCH_COM
 
PORTEbs
.
RE6


	)

72 
	#SWITCH_DATA
 
PORTEbs
.
RE7


	)

74 
	#LEDPORT
 
PORTF


	)

75 
	#LEDTRIS
 
TRISF


	)

76 
	#LED_ROW1
 
PORTGbs
.
RG4


	)

77 
	#LED_ROW2
 
PORTFbs
.
RF1


	)

78 
	#LED_ROW3
 
PORTFbs
.
RF0


	)

79 
	#LED_ROW4
 
PORTAbs
.
RA3


	)

80 
	#LED_ROW5
 
PORTAbs
.
RA2


	)

81 
	#LED_ROW6
 
PORTAbs
.
RA1


	)

83 
	#RELAY_PORT
 
PORTD


	)

84 
	#RELAY_PORT_TRIS
 
TRISD


	)

85 
	#RELAY_LATCH
 
PORTEbs
.
RE4


	)

87 
	#KEYPAD_DATA
 
PORTD


	)

88 
	#KEYPAD_TRIS
 
TRISD


	)

89 
	#KEYPAD_COL_LATCH
 
PORTBbs
.
RB5


	)

90 
	#KEYPAD_ROW_ENABLE
 
PORTBbs
.
RB3


	)

91 
	#KEYPAD_ROW_LATCH
 
PORTBbs
.
RB4


	)

92 
	#KEYPAD_ROW1
 0 
b00000001


	)

93 
	#KEYPAD_ROW2
 0 
b00000010


	)

94 
	#KEYPAD_ROW3
 0 
b00000100


	)

95 
	#KEYPAD_ROW4
 0 
b00001000


	)

96 
	#KEYPAD_ROW5
 0 
b00010000


	)

97 
	#KEYPAD_ROW6
 0 
b00100000


	)

99 
	#USB_RD_EMPTY
 
PORTBbs
.
RB1


	)

100 
	#USB_WR_FULL
 
PORTBbs
.
RB2


	)

101 
	#USB_RD
 
PORTEbs
.
RE0


	)

102 
	#USB_WR
 
PORTEbs
.
RE1


	)

103 
	#USB_PORT
 
PORTD


	)

104 
	#USB_PORT_TRIS
 
TRISD


	)

106 
	#ZERO_CROSS
 
PORTBbs
.
RB0


	)

108 
	#PORT_A_TRIS_MASK
 0x11

	)

109 
	#PORT_B_TRIS_MASK
 0xC7

	)

110 
	#PORT_C_TRIS_MASK
 0x9C

	)

111 
	#PORT_D_TRIS_MASK
 0xFF

	)

112 
	#PORT_E_TRIS_MASK
 0x88

	)

113 
	#PORT_F_TRIS_MASK
 0x00

	)

114 
	#PORT_G_TRIS_MASK
 0x04

	)

116 
	#TURN_OFF_COMPARATORS
(
CMCON
 = 0x07

	)

118 
	#SHORT_BEEP
 50

	)

119 
	#LONG_BEEP
 250

	)

121 
	#CLICK
(
	`Hdwe_Sound_Pzo
(
SHORT_BEEP
);

	)

122 
	#BEEP
(
	`Hdwe_Sound_Pzo
(
LONG_BEEP
);

	)

126 
	mut8_t
:1;

127 
	mut8_t
:1;

128 
ut8_t
 
	mThursday
:1;

129 
ut8_t
 
	mWedsday
:1;

130 
ut8_t
 
	mTuesday
:1;

131 
ut8_t
 
	mMday
:1;

132 
ut8_t
 
	mProgm
:1;

133 
ut8_t
 
	mRun
:1;

135 
	mut8_t
:1;

136 
	mut8_t
:1;

137 
ut8_t
 
	mIut1
:1;

138 
ut8_t
 
	mIut2
:1;

139 
ut8_t
 
	mIut3
:1;

140 
ut8_t
 
	mIut4
:1;

141 
ut8_t
 
	mIut5
:1;

142 
ut8_t
 
	mIut6
:1;

144 
	mut8_t
:1;

145 
	mut8_t
:1;

146 
	mut8_t
:1;

147 
ut8_t
 
	mIut7
:1;

148 
	mut8_t
:1;

149 
	mut8_t
:1;

150 
ut8_t
 
	mIut8
:1;

151 
ut8_t
 
	mPho
:1;

153 
	mut8_t
:1;

154 
	mut8_t
:1;

155 
	mut8_t
:1;

156 
	mut8_t
:1;

157 
	mut8_t
:1;

158 
	mut8_t
:1;

159 
ut8_t
 
	mReme
:1;

160 
ut8_t
 
	mRay8
:1;

162 
	mut8_t
:1;

163 
	mut8_t
:1;

164 
	mut8_t
:1;

165 
ut8_t
 
	mRay7
:1;

166 
ut8_t
 
	mRay6
:1;

167 
ut8_t
 
	mRay5
:1;

168 
ut8_t
 
	mRay4
:1;

169 
ut8_t
 
	mRay3
:1;

171 
	mut8_t
:1;

172 
	mut8_t
:1;

173 
ut8_t
 
	mRay2
:1;

174 
ut8_t
 
	mRay1
:1;

175 
ut8_t
 
	mHiday
:1;

176 
ut8_t
 
	mSunday
:1;

177 
ut8_t
 
	mSurday
:1;

178 
ut8_t
 
	mFriday
:1;

181 
ut8_t
 
	mrow1
;

182 
ut8_t
 
	mrow2
;

183 
ut8_t
 
	mrow3
;

184 
ut8_t
 
	mrow4
;

185 
ut8_t
 
	mrow5
;

186 
ut8_t
 
	mrow6
;

188 } 
	tLED_REGS
;

190 
	uSWITCH_REGS
 {

192 
ut8_t
 
	mA_On
:1;

193 
ut8_t
 
	mA_Off
:1;

194 
ut8_t
 
	mAddr
:4;

195 
ut8_t
 
	mP_Fau
:1;

196 
ut8_t
 
	mMa
:1;

198 
ut8_t
 
	mSw_By
;

201 
	eINT_STATE
 { 
	mINT_DISABLED
, 
	mINT_ENABLED
, 
	mINT_RESTORE
 };

203 
	#RESTART_WDT
({ 
_asm
 
CLRWDT
 
_dasm
 }

	)

211 
	#ENABLE_HIGH_INT
(
INTCONbs
.
GIE
 = 1

	)

212 
	#DISABLE_HIGH_INT
(
INTCONbs
.
GIE
 = 0

	)

214 
	#ENABLE_LOW_INT
(
INTCONbs
.
PEIE
 = 1

	)

215 
	#DISABLE_LOW_INT
(
INTCONbs
.
PEIE
 = 0

	)

217 
	#ENABLE_TIMER0_INT
(
INTCONbs
.
TMR0IE
 = 1

	)

218 
	#DISABLE_TIMER0_INT
(
INTCONbs
.
TMR0IE
 = 0

	)

220 
	#ENABLE_TIMER2_INT
(
PIE1bs
.
TMR2IE
 = 1

	)

221 
	#DISABLE_TIMER2_INT
(
PIE1bs
.
TMR2IE
 = 0

	)

223 
	#ENABLE_TIMER4_INT
(
PIE3bs
.
TMR4IE
 = 1

	)

224 
	#DISABLE_TIMER4_INT
(
PIE3bs
.
TMR4IE
 = 0

	)

226 
	#ENABLE_CCP2_INT
(
PIE2bs
.
CCP2IE
 = 1

	)

227 
	#DISABLE_CCP2_INT
(
PIE2bs
.
CCP2IE
 = 0

	)

229 
	#ENABLE_CCP1_INT
(
PIE1bs
.
CCP1IE
 = 1

	)

230 
	#DISABLE_CCP1_INT
(
PIE1bs
.
CCP1IE
 = 0

	)

232 
	#ENABLE_ABUS_INT
(
PIE1bs
.
SSPIE
 = 1

	)

233 
	#DISABLE_ABUS_INT
(
PIE1bs
.
SSPIE
 = 0

	)

234 
	#CLEAR_ABUS_FLAG
(
PIR1bs
.
SSPIF
 = 0

	)

236 
	#SETUP_CCP1
(
x

CCP1CON
 = 
	)
x

237 
	#SETUP_CCP2
(
x

CCP2CON
 = 
	)
x

239 
	#DISABLE_RX_INT
(
PIE1bs
.
RCIE
 = 0

	)

240 
	#ENABLE_RX_INT
(
PIE1bs
.
RCIE
 = 1

	)

242 
	#DISABLE_TX_INT
(
PIE1bs
.
TXIE
 = 0

	)

243 
	#ENABLE_TX_INT
(
PIE1bs
.
TXIE
 = 1

	)

245 #i
CLOCKSPEED
 == 20

246 
	#DELAY_US
(
x
{ 
_asm
 \

247 
MOVLW
 
x
 \

248 
LOOP
: \

249 
NOP
 \

250 
NOP
 \

251 
DECFSZ
 
WREG
, 1, 0 \

252 
BRA
 
LOOP
 \

253 
_dasm
 }

	)

256 
	#tup_tim4
(
mode
, 
riod
, 
pos
) \

257 
T4CON
 = (
mode
 | (
pos
 - 1) << 3); \

258 
PR4
 = 
riod


	)

260 
	#tup_tim2
(
mode
, 
riod
, 
pos
) \

261 
T2CON
 = (
mode
 | (
pos
 - 1) << 3); \

262 
PR2
 = 
riod


	)

266 vީ
LED_REGS
 
LEDS
;

267 vީ
LED_REGS
 
Blk
;

268 
ut8_t
 
Pzo_Tim
;

269 vީ
bo
 
DaPtLocked
;

	@ports/pic18f6720/isr.c

25 
	~<p18f6720.h
>

26 
	~"dt.h
"

27 
	~"hdwe.h
"

28 
	~"rs485.h
"

29 
	~"dlmp.h
"

32 vީ
ut8_t
 
Mlicds
;

34 
IruHdrHigh
(

36 
IruHdrLow
(

38 
Iru_Tim2
(

40 
Iru_Tim3
(

42 
Iru_Tim4
(

44 
Iru_USART_Rx
(

46 
Iru_USART_Tx
(

48 
Iru_CCP2
(

50 
INT0_Iru
(

53 #agm
code
 
IruVeHigh
 = 0x08

54 
	$IruVeHigh
(

58 
_asm
 
IruHdrHigh
 
_dasm
}

59 #agm
code


60 #agm
code
 
IruVeLow
 = 0x18

61 
	$IruVeLow
(

65 
_asm
 
IruHdrLow
 
_dasm
}

66 #agm
code


67 #agm
u
 
IruHdrHigh


68 
	$IruHdrHigh
(

73 i((
PIR1bs
.
RCIF
&& (
PIE1bs
.
RCIE
)) {

74 i((
RCSTA1bs
.
FERR
|| (RCSTA1bs.
OERR
)) {

75 
Com
.
Rx_Bufrovrun
 = 
TRUE
;

76 
PIE1bs
.
RC1IE
 = 0;

77 } i(
Com
.
Rx_Bys
++ < 
RX_BUFFER_SIZE
 - 1) {

78 
Rx_Bufr
[
Com
.
RxHd
++] = 
RCREG1
;

82 
Rx_Bufr
[
Com
.
RxHd
] = 0;

84 
Com
.
Rx_Bufrovrun
 = 
TRUE
;

85 
PIE1bs
.
RC1IE
 = 0;

91 i((
INTCONbs
.
TMR0IF
&& (INTCONbs.
TMR0IE
)) {

92 
INTCONbs
.
TMR0IF
 = 0;

94 
	}
}

96 #agm
ulow
 
IruHdrLow
 
ve
 = 
PROD
, 
i
(".tmpda"), 
TABLAT
, 
TBLPTR
, section \

99 
	$IruHdrLow
(

103 i((
PIR1bs
.
TMR2IF
&& (
PIE1bs
.
TMR2IE
)) {

104 
PIR1bs
.
TMR2IF
 = 0;

105 
	`Iru_Tim2
();

109 i((
PIR2bs
.
TMR3IF
&& (
PIE2bs
.
TMR3IE
)) {

110 
PIR2bs
.
TMR3IF
 = 0;

111 
	`Iru_Tim3
();

115 i((
PIR3bs
.
TMR4IF
&& (
PIE3bs
.
TMR4IE
)) {

116 
PIR3bs
.
TMR4IF
 = 0;

117 
	`dlmp_mlicd_tim
();

118 
	`Iru_Tim4
();

122 i((
PIR2bs
.
CCP2IF
&& (
PIE2bs
.
CCP2IE
)) {

123 
PIR2bs
.
CCP2IF
 = 0;

124 
	`Iru_CCP2
();

128 i((
PIR3bs
.
TX2IF
&& (
PIE3bs
.
TX2IE
)) {

129 
	`RS485_Iru_Tx
();

133 i((
PIR3bs
.
RC2IF
&& (
PIE3bs
.
RC2IE
)) {

134 
	`RS485_Iru_Rx
();

182 
	}
}

184 
	$Iru_Tim2
(

187 
	}
}

189 
	$Iru_Tim3
(

192 
	}
}

195 
	$Iru_Tim4
(

199 i(
Mlicds
 < 0xFF)

200 ++
Mlicds
;

201 
	}
}

203 
	$Iru_CCP2
(

207 
	}
}

	@ports/pic18f6720/main.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<rg.h
>

29 
	~<p18f6720.h
>

30 
	~<dlib.h
>

31 
	~<rg.h
>

32 
	~"dt.h
"

33 
	~"hdwe.h
"

35 
	~"du.h
"

36 
	~"dk.h
"

37 
	~"dcc.h
"

38 
	~"hdrs.h
"

39 
	~".h
"

40 
	~"txbuf.h
"

41 
	~"rs485.h
"

48 #agm
cfig
 
OSC
 = 
HS
, 
OSCS
 = 
OFF


49 #agm
cfig
 
PWRT
 = 
ON


50 #agm
cfig
 
BOR
 = 
ON
, 
BORV
 = 27

51 #agm
cfig
 
CCP2MUX
 = 
ON


52 #agm
cfig
 
STVR
 = 
ON


53 #agm
cfig
 
LVP
 = 
OFF


54 #agm
cfig
 
CP0
 = 
OFF


55 #agm
cfig
 
CP1
 = 
OFF


56 #agm
cfig
 
CP2
 = 
OFF


57 #agm
cfig
 
CP3
 = 
OFF


58 #agm
cfig
 
CP4
 = 
OFF


59 #agm
cfig
 
CP5
 = 
OFF


60 #agm
cfig
 
CP6
 = 
OFF


61 #agm
cfig
 
CP7
 = 
OFF


62 #agm
cfig
 
CPB
 = 
OFF


63 #agm
cfig
 
CPD
 = 
OFF


64 #agm
cfig
 
WRT0
 = 
OFF


65 #agm
cfig
 
WRT1
 = 
OFF


66 #agm
cfig
 
WRT2
 = 
OFF


67 #agm
cfig
 
WRT3
 = 
OFF


68 #agm
cfig
 
WRT4
 = 
OFF


69 #agm
cfig
 
WRT5
 = 
OFF


70 #agm
cfig
 
WRT6
 = 
OFF


71 #agm
cfig
 
WRT7
 = 
OFF


72 #agm
cfig
 
WRTB
 = 
OFF


73 #agm
cfig
 
WRTC
 = 
OFF


74 #agm
cfig
 
WRTD
 = 
OFF


75 #agm
cfig
 
EBTR0
 = 
OFF


76 #agm
cfig
 
EBTR1
 = 
OFF


77 #agm
cfig
 
EBTR2
 = 
OFF


78 #agm
cfig
 
EBTR3
 = 
OFF


79 #agm
cfig
 
EBTR4
 = 
OFF


80 #agm
cfig
 
EBTR5
 = 
OFF


81 #agm
cfig
 
EBTR6
 = 
OFF


82 #agm
cfig
 
EBTR7
 = 
OFF


83 #agm
cfig
 
EBTRB
 = 
OFF


85 #ifde
USE_ICD


86 #agm
cfig
 
WDT
 = 
OFF
, 
WDTPS
 = 128

87 #agm
cfig
 
DEBUG
 = 
ON


89 #agm
cfig
 
WDT
 = 
ON
, 
WDTPS
 = 128

90 #agm
cfig
 
DEBUG
 = 
OFF


93 vީ
ut8_t
 
	gMlicds
 = 0;

94 vީ
ut8_t
 
	gZo_Cross_Timeout
 = 0;

96 
	$Relize
(

99 
ut8_t
 
i
;

100 
me
 = 0;

102 
_asm
 
t
 
_dasm
 ;

103 
	}
}

105 
	$Glob_I
(

106 
INT_STATE
 
e
)

108 
ut8_t
 
te
 = 0;

110 
e
) {

111 
INT_DISABLED
:

112 
te
 >>= 2;

113 
te
 |(
INTCON
 & 0xC0);

115 
INT_ENABLED
:

116 
INTCONbs
.
GIE
 = 1;

117 
INTCONbs
.
PEIE
 = 1;

118 
te
 <<= 2;

120 
INT_RESTORE
:

121 
INTCON
 |(
te
 & 0xC0);

122 
te
 <<= 2;

127 
	}
}

129 
	$Hdwe_Inlize
(

135 
TRISA
 = 0xD1;

142 
TRISB
 = 0xC7;

148 
TRISC
 = 0x9C;

153 
TRISD
 = 0xFF;

159 
TRISE
 = 0x83;

165 
TRISF
 = 0x00;

169 
TRISG
 = 0xE6;

172 
KEYPAD_ROW_ENABLE
 = 1;

173 
KEYPAD_ROW_LATCH
 = 0;

174 
KEYPAD_COL_LATCH
 = 1;

176 
RELAY_LATCH
 = 0;

179 
SWITCH_COM
 = 1;

182 
RS232_ENABLE
 = 0;

185 
LED_ROW1
 = 1;

186 
LED_ROW2
 = 1;

187 
LED_ROW3
 = 1;

188 
LED_ROW4
 = 1;

189 
LED_ROW5
 = 1;

190 
LED_ROW6
 = 1;

191 
LEDPORT
 = 0x03;

194 
LCD_E
 = 1;

195 
LCD_RW
 = 1;

196 
LCD_RS
 = 1;

200 
	`PIEZO_OFF
();

201 
CCPR1L
 = 0x4E;

202 
CCP1CON
 = 0x2F;

203 
	`tup_tim2
(6, 156, 2);

204 
PIE1bs
.
TMR2IE
 = 1;

208 
	`tup_tim4
(5, 250, 5);

211 
RCONbs
.
IPEN
 = 1;

212 
IPR1
 = 0;

213 
IPR2
 = 0;

214 
IPR3
 = 0;

217 
INTCON2
 = 0xFC;

218 
INTCON3
 = 0;

221 
IPR1bs
.
RC1IP
 = 1;

222 
IPR1bs
.
TX1IP
 = 1;

225 
	`Glob_I
(
INT_ENABLED
);

226 
	}
}

228 
	$Inlize_Vbs
(

232 
	`ENABLE_TIMER4_INT
();

234 
	`Glob_I
(
INT_ENABLED
);

236 
Mlicds
 = 0;

237 
	}
}

239 
	$MaTasks
(

242 
ut16_t
 
mlicd_cou
 = 0;

244 
Mlicds
) {

245 
mlicd_cou
++;

246 --
Mlicds
;

249 i(
mlicd_cou
 > 1000) {

250 
mlicd_cou
 -= 1000;

251 
	`dcc_tim_cds
(1);

253 
	}
}

255 
	$ma
(

258 
RCONbs
.
NOT_POR
 = 1;

259 
RCONbs
.
NOT_RI
 = 1;

260 
	`Hdwe_Inlize
();

261 
	`Inlize_Vbs
();

263 
	`dlmp_t_my_addss
(42);

264 
	`dlmp_t_max_fo_ames
(1);

265 
	`dlmp_t_max_ma
(127);

266 
	`RS485_S_Baud_Re
(38400);

267 
	`dlmp_
();

270 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

272 
TRUE
) {

273 
	`RESTART_WDT
();

274 
	`dlmp_sk
();

275 
	`MaTasks
();

276 
	`Glob_I
(
INT_ENABLED
);

277 
	`ENABLE_TIMER4_INT
();

279 
	}
}

	@ports/pic18f6720/mstp.c

47 
	~<ddef.h
>

48 
	~<dt.h
>

49 #i
PRINT_ENABLED


50 
	~<dio.h
>

52 
	~"mp.h
"

53 
	~"bys.h
"

54 
	~"bs.h
"

55 
	~"c.h
"

56 
	~"baddr.h
"

57 
	~"rs485.h
"

58 #i
PRINT_ENABLED


59 
	~"mext.h
"

63 #i
PRINT_ENABLED


64 
	#PRINT_ENABLED_RECEIVE
 0

	)

65 
	#PRINT_ENABLED_RECEIVE_DATA
 1

	)

66 
	#PRINT_ENABLED_MASTER
 0

	)

68 
	#PRINT_ENABLED_RECEIVE
 0

	)

69 
	#PRINT_ENABLED_RECEIVE_DATA
 0

	)

70 
	#PRINT_ENABLED_MASTER
 0

	)

89 
	#Npl
 50

	)

92 
	#Ny_tok
 1

	)

96 
	#Nm_os
 4

	)

104 
	#Tame_abt
 30

	)

108 
	#Tame_g
 20

	)

112 
	#Tno_tok
 500

	)

117 
	#Tpodrive
 15

	)

124 
	#Ty_day
 10

	)

130 
	#Ty_timeout
 255

	)

135 
	#Troff
 30

	)

139 
	#T
 10

	)

144 
	#Tuge_day
 15

	)

150 
	#Tuge_timeout
 20

	)

153 
	#INCREMENT_AND_LIMIT_UINT8
(
x
{i(x < 0xFFx++;}

	)

155 
bo
 
	$MSTP_Le_Aive
(

156 vީ
mp_pt_ru_t
 *
mp_pt
)

158  (
mp_pt
->
EvtCou
 > 
Nm_os
);

159 
	}
}

161 
	$MSTP_Ce_Fme
(

162 
ut8_t
 * 
bufr
,

163 
bufr_n
,

164 
ut8_t
 
ame_ty
,

165 
ut8_t
 
dei
,

166 
ut8_t
 
sour
,

167 
ut8_t
 * 
da
,

168 
da_n
)

170 
ut8_t
 
c8
 = 0xFF;

171 
ut16_t
 
c16
 = 0xFFFF;

172 
dex
 = 0;

175 i(
bufr_n
 < 8)

178 
bufr
[0] = 0x55;

179 
bufr
[1] = 0xFF;

180 
bufr
[2] = 
ame_ty
;

181 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[2], crc8);

182 
bufr
[3] = 
dei
;

183 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[3], crc8);

184 
bufr
[4] = 
sour
;

185 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[4], crc8);

186 
bufr
[5] = 
	`HI_BYTE
(
da_n
);

187 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[5], crc8);

188 
bufr
[6] = 
	`LO_BYTE
(
da_n
);

189 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[6], crc8);

190 
bufr
[7] = ~
c8
;

192 
dex
 = 8;

193 
da_n
 && 
da
 && (
dex
 < 
bufr_n
)) {

194 
bufr
[
dex
] = *
da
;

195 
c16
 = 
	`CRC_Cc_Da
(
bufr
[
dex
], crc16);

196 
da
++;

197 
dex
++;

198 
da_n
--;

201 i(
dex
 > 8) {

202 i((
dex
 + 2<
bufr_n
) {

203 
c16
 = ~crc16;

204 
bufr
[
dex
] = 
	`LO_BYTE
(
c16
);

205 
dex
++;

206 
bufr
[
dex
] = 
	`HI_BYTE
(
c16
);

207 
dex
++;

212  
dex
;

213 
	}
}

215 
	$MSTP_Ce_And_Sd_Fme
(

216 vީ
mp_pt_ru_t
 *
mp_pt
,

217 
ut8_t
 
ame_ty
,

218 
ut8_t
 
dei
,

219 
ut8_t
 
sour
,

220 
ut8_t
 * 
da
,

221 
da_n
)

223 
ut8_t
 
bufr
[
MAX_MPDU
] = { 0 };

224 
ut16_t
 
n
 = 0;

226 
n
 = (
ut16_t

	`MSTP_Ce_Fme
(&
bufr
[0],

227 (
bufr
),

228 
ame_ty
,

229 
dei
,

230 
sour
,

231 
da
,

232 
da_n
);

234 
	`RS485_Sd_Fme
(
mp_pt
, &
bufr
[0], 
n
);

236 
	}
}

238 
	$MSTP_Reive_Fme_FSM
(

239 vީ
mp_pt_ru_t
 *
mp_pt
)

241 #i
PRINT_ENABLED_RECEIVE_DATA


242 
MSTP_RECEIVE_STATE
 
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

244 #i
PRINT_ENABLED_RECEIVE


245 
	`rtf
(
dr
,

247 
	`mext_ive_e
(
mp_pt
->
ive_e
),

248 
mp_pt
->
DaRegi
, mp_pt->
HdCRC
, mp_pt->
Index
,

249 
mp_pt
->
EvtCou
, mp_pt->
DaLgth
, mp_pt->
STim
);

251 
mp_pt
->
ive_e
) {

253 
MSTP_RECEIVE_STATE_IDLE
:

255 i(
mp_pt
->
ReiveE
 =
ue
) {

256 
mp_pt
->
ReiveE
 = 
l
;

257 
mp_pt
->
STim
 = 0;

258 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

260 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

261 } i(
mp_pt
->
DaAvaab
 =
ue
) {

262 #i
PRINT_ENABLED_RECEIVE_DATA


263 
	`rtf
(
dr
, "MSTP Rx: %02X ", 
mp_pt
->
DaRegi
);

266 i(
mp_pt
->
DaRegi
 == 0x55) {

267 
mp_pt
->
DaAvaab
 = 
l
;

268 
mp_pt
->
STim
 = 0;

269 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

271 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

275 #i
PRINT_ENABLED_RECEIVE_DATA


276 
	`rtf
(
dr
, "\n");

278 
mp_pt
->
DaAvaab
 = 
l
;

279 
mp_pt
->
STim
 = 0;

280 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

282 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

287 
MSTP_RECEIVE_STATE_PREAMBLE
:

289 i(
mp_pt
->
STim
 > 
Tame_abt
) {

292 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

295 i(
mp_pt
->
ReiveE
 =
ue
) {

296 
mp_pt
->
ReiveE
 = 
l
;

297 
mp_pt
->
STim
 = 0;

298 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

300 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

301 } i(
mp_pt
->
DaAvaab
 =
ue
) {

302 #i
PRINT_ENABLED_RECEIVE_DATA


303 
	`rtf
(
dr
, "%02X ", 
mp_pt
->
DaRegi
);

306 i(
mp_pt
->
DaRegi
 == 0xFF) {

307 
mp_pt
->
DaAvaab
 = 
l
;

308 
mp_pt
->
STim
 = 0;

309 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

310 
mp_pt
->
Index
 = 0;

311 
mp_pt
->
HdCRC
 = 0xFF;

313 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

316 i(
mp_pt
->
DaRegi
 == 0x55) {

317 
mp_pt
->
DaAvaab
 = 
l
;

318 
mp_pt
->
STim
 = 0;

319 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

321 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

325 
mp_pt
->
DaAvaab
 = 
l
;

326 
mp_pt
->
STim
 = 0;

327 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

329 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

334 
MSTP_RECEIVE_STATE_HEADER
:

336 i(
mp_pt
->
STim
 > 
Tame_abt
) {

338 
mp_pt
->
ReivedInvidFme
 = 
ue
;

340 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

343 i(
mp_pt
->
ReiveE
 =
ue
) {

344 
mp_pt
->
ReiveE
 = 
l
;

345 
mp_pt
->
STim
 = 0;

346 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

348 
mp_pt
->
ReivedInvidFme
 = 
ue
;

350 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

351 } i(
mp_pt
->
DaAvaab
 =
ue
) {

352 #i
PRINT_ENABLED_RECEIVE_DATA


353 
	`rtf
(
dr
, "%02X ", 
mp_pt
->
DaRegi
);

356 i(
mp_pt
->
Index
 == 0) {

357 
mp_pt
->
STim
 = 0;

358 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

359 
mp_pt
->
HdCRC
 =

360 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

361 
mp_pt
->
HdCRC
);

362 
mp_pt
->
FmeTy
 = mp_pt->
DaRegi
;

363 
mp_pt
->
DaAvaab
 = 
l
;

364 
mp_pt
->
Index
 = 1;

365 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

368 i(
mp_pt
->
Index
 == 1) {

369 
mp_pt
->
STim
 = 0;

370 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

371 
mp_pt
->
HdCRC
 =

372 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

373 
mp_pt
->
HdCRC
);

374 
mp_pt
->
DeiAddss
 = mp_pt->
DaRegi
;

375 
mp_pt
->
DaAvaab
 = 
l
;

376 
mp_pt
->
Index
 = 2;

377 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

380 i(
mp_pt
->
Index
 == 2) {

381 
mp_pt
->
STim
 = 0;

382 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

383 
mp_pt
->
HdCRC
 =

384 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

385 
mp_pt
->
HdCRC
);

386 
mp_pt
->
SourAddss
 = mp_pt->
DaRegi
;

387 
mp_pt
->
DaAvaab
 = 
l
;

388 
mp_pt
->
Index
 = 3;

389 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

392 i(
mp_pt
->
Index
 == 3) {

393 
mp_pt
->
STim
 = 0;

394 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

395 
mp_pt
->
HdCRC
 =

396 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

397 
mp_pt
->
HdCRC
);

398 
mp_pt
->
DaLgth
 = mp_pt->
DaRegi
 * 256;

399 
mp_pt
->
DaAvaab
 = 
l
;

400 
mp_pt
->
Index
 = 4;

401 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

404 i(
mp_pt
->
Index
 == 4) {

405 
mp_pt
->
STim
 = 0;

406 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

407 
mp_pt
->
HdCRC
 =

408 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

409 
mp_pt
->
HdCRC
);

410 
mp_pt
->
DaLgth
 +mp_pt->
DaRegi
;

411 
mp_pt
->
DaAvaab
 = 
l
;

412 
mp_pt
->
Index
 = 5;

413 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

416 i(
mp_pt
->
Index
 == 5) {

417 
mp_pt
->
STim
 = 0;

418 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

419 
mp_pt
->
HdCRC
 =

420 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

421 
mp_pt
->
HdCRC
);

422 
mp_pt
->
DaAvaab
 = 
l
;

424 i(
mp_pt
->
HdCRC
 != 0x55) {

427 
mp_pt
->
ReivedInvidFme
 = 
ue
;

429 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

431 i((
mp_pt
->
DeiAddss
 ==

432 
mp_pt
->
This_Sti
)

433 || (
mp_pt
->
DeiAddss
 ==

434 
MSTP_BROADCAST_ADDRESS
)) {

436 i(
mp_pt
->
DaLgth
 > 
MAX_MPDU
) {

439 
mp_pt
->
ReivedInvidFme
 = 
ue
;

441 
mp_pt
->
ive_e
 =

442 
MSTP_RECEIVE_STATE_IDLE
;

445 i(
mp_pt
->
DaLgth
 == 0) {

447 
mp_pt
->
ReivedVidFme
 = 
ue
;

449 
mp_pt
->
ive_e
 =

450 
MSTP_RECEIVE_STATE_IDLE
;

454 
mp_pt
->
Index
 = 0;

455 
mp_pt
->
DaCRC
 = 0xFFFF;

457 
mp_pt
->
ive_e
 =

458 
MSTP_RECEIVE_STATE_DATA
;

464 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

472 
mp_pt
->
ReiveE
 = 
l
;

473 
mp_pt
->
STim
 = 0;

474 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

477 
mp_pt
->
ReivedInvidFme
 = 
ue
;

479 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

484 
MSTP_RECEIVE_STATE_DATA
:

486 i(
mp_pt
->
STim
 > 
Tame_abt
) {

488 
mp_pt
->
ReivedInvidFme
 = 
ue
;

490 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

493 i(
mp_pt
->
ReiveE
 =
ue
) {

494 
mp_pt
->
ReiveE
 = 
l
;

495 
mp_pt
->
STim
 = 0;

497 
mp_pt
->
ReivedInvidFme
 = 
ue
;

499 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

500 } i(
mp_pt
->
DaAvaab
 =
ue
) {

501 #i
PRINT_ENABLED_RECEIVE_DATA


502 
	`rtf
(
dr
, "%02X ", 
mp_pt
->
DaRegi
);

505 i(
mp_pt
->
Index
 < mp_pt->
DaLgth
) {

506 
mp_pt
->
DaCRC
 =

507 
	`CRC_Cc_Da
(
mp_pt
->
DaRegi
,

508 
mp_pt
->
DaCRC
);

509 
mp_pt
->
IutBufr
[mp_pt->
Index
] =

510 
mp_pt
->
DaRegi
;

511 
mp_pt
->
Index
++;

512 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_DATA
;

515 i(
mp_pt
->
Index
 =mp_pt->
DaLgth
) {

516 
mp_pt
->
DaCRC
 =

517 
	`CRC_Cc_Da
(
mp_pt
->
DaRegi
,

518 
mp_pt
->
DaCRC
);

519 
mp_pt
->
Index
++;

520 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_DATA
;

523 i(
mp_pt
->
Index
 =(mp_pt->
DaLgth
 + 1)) {

524 
mp_pt
->
DaCRC
 =

525 
	`CRC_Cc_Da
(
mp_pt
->
DaRegi
,

526 
mp_pt
->
DaCRC
);

529 i(
mp_pt
->
DaCRC
 == 0xF0B8)

530 
mp_pt
->
ReivedVidFme
 = 
ue
;

532 
mp_pt
->
ReivedInvidFme
 = 
ue
;

533 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

535 
mp_pt
->
DaAvaab
 = 
l
;

536 
mp_pt
->
STim
 = 0;

541 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

544 #i
PRINT_ENABLED_RECEIVE_DATA


545 i((
ive_e
 !
MSTP_RECEIVE_STATE_IDLE
) &&

546 (
mp_pt
->
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
)) {

547 
	`rtf
(
dr
, "\n");

548 
	`fush
(
dr
);

550 
ive_e
 = 
mp_pt
->receive_state;

554 
	}
}

556 
bo
 
	$mp_com_da_exg_y
(

557 
ut8_t
 * 
que_pdu
,

558 
ut16_t
 
que_pdu_n
,

559 
ut8_t
 
c_addss
,

560 
ut8_t
 * 
y_pdu
,

561 
ut16_t
 
y_pdu_n
,

562 
ut8_t
 
de_addss
)

564 
ut16_t
 
offt
;

568 
	sDER_com_t
 {

569 
BACNET_NPDU_DATA
 
du_da
;

570 
BACNET_ADDRESS
 
addss
;

571 
ut8_t
 
pdu_ty
;

572 
ut8_t
 
voke_id
;

573 
ut8_t
 
rvi_choi
;

575 
DER_com_t
 
que
;

576 
DER_com_t
 
y
;

579 
que
.
addss
.
mac
[0] = 
c_addss
;

580 
que
.
addss
.
mac_n
 = 1;

581 
offt
 =

582 
	`du_decode
(&
que_pdu
[0], 
NULL
, &
que
.
addss
,

583 &
que
.
du_da
);

584 i(
que
.
du_da
.
twk_y_mesge
) {

585  
l
;

587 
que
.
pdu_ty
 = 
que_pdu
[
offt
] & 0xF0;

588 i(
que
.
pdu_ty
 !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
) {

589  
l
;

591 
que
.
voke_id
 = 
que_pdu
[
offt
 + 2];

593 i(
que_pdu
[
offt
] & 
BIT3
)

594 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 5];

596 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 3];

598 
y
.
addss
.
mac
[0] = 
de_addss
;

599 
y
.
addss
.
mac_n
 = 1;

600 
offt
 =

601 
	`du_decode
(&
y_pdu
[0], &
y
.
addss
, 
NULL
, &y.
du_da
);

602 i(
y
.
du_da
.
twk_y_mesge
) {

603  
l
;

607 
y
.
pdu_ty
 = 
y_pdu
[
offt
] & 0xF0;

608 
y
.
pdu_ty
) {

609 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

610 
y
.
voke_id
 = 
y_pdu
[
offt
 + 2];

612 i(
y_pdu
[
offt
] & 
BIT3
)

613 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 5];

615 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 3];

617 
PDU_TYPE_SIMPLE_ACK
:

618 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

619 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

621 
PDU_TYPE_COMPLEX_ACK
:

622 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

624 i(
y_pdu
[
offt
] & 
BIT3
)

625 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 4];

627 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

629 
PDU_TYPE_ERROR
:

630 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

631 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

633 
PDU_TYPE_REJECT
:

634 
PDU_TYPE_ABORT
:

635 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

638  
l
;

640 i(
que
.
voke_id
 !
y
.invoke_id) {

641  
l
;

644 i((
y
.
pdu_ty
 !
PDU_TYPE_REJECT
) &&

645 (
y
.
pdu_ty
 !
PDU_TYPE_ABORT
)) {

646 i(
que
.
rvi_choi
 !
y
.service_choice) {

647  
l
;

650 i(
que
.
du_da
.
oc_vsi
 !
y
.npdu_data.protocol_version) {

651  
l
;

656 i(
que
.
du_da
.
iܙy
 !
y
.npdu_data.priority) {

657  
l
;

660 i(!
	`ba_addss_me
(&
que
.
addss
, &
y
.address)) {

661  
l
;

664  
ue
;

665 
	}
}

668 
bo
 
	$MSTP_Ma_Node_FSM
(

669 vީ
mp_pt_ru_t
 * 
mp_pt
)

671 
mtu_n
 = 0;

672 
ame_ty
 = 0;

673 
ut8_t
 
xt_pl_i
 = 0;

674 
ut8_t
 
xt_this_i
 = 0;

675 
ut8_t
 
xt_xt_i
 = 0;

676 
ut16_t
 
my_timeout
 = 10, 
ns_timeout
 = 0;

678 
bo
 
si_now
 = 
l
;

679 
bo
 
mched
 = 
l
;

680 #i
PRINT_ENABLED_MASTER


681 
MSTP_MASTER_STATE
 
ma_e
 = 
MSTP_MASTER_STATE_INITIALIZE
;

685 
xt_pl_i
 =

686 (
mp_pt
->
Pl_Sti
 + 1% (mp_pt->
Nmax_ma
 + 1);

687 
xt_this_i
 =

688 (
mp_pt
->
This_Sti
 + 1% (mp_pt->
Nmax_ma
 + 1);

689 
xt_xt_i
 =

690 (
mp_pt
->
Next_Sti
 + 1% (mp_pt->
Nmax_ma
 + 1);

691 #i
PRINT_ENABLED_MASTER


692 i(
mp_pt
->
ma_e
 != master_state) {

693 
ma_e
 = 
mp_pt
->master_state;

694 
	`rtf
(
dr
,

696 
mp_pt
->
This_Sti
, 
xt_this_i
,

697 
mp_pt
->
Next_Sti
, 
xt_xt_i
,

698 
mp_pt
->
Pl_Sti
, 
xt_pl_i
, mp_pt->
EvtCou
,

699 
mp_pt
->
TokCou
, mp_pt->
STim
,

700 
	`mext_ma_e
(
mp_pt
->
ma_e
));

704 
mp_pt
->
ma_e
) {

705 
MSTP_MASTER_STATE_INITIALIZE
:

708 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

709 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

712 
mp_pt
->
TokCou
 = 
Npl
;

713 
mp_pt
->
SeMa
 = 
l
;

714 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

715 
si_now
 = 
ue
;

718 
MSTP_MASTER_STATE_IDLE
:

720 i(
mp_pt
->
STim
 >
Tno_tok
) {

722 
mp_pt
->
EvtCou
 = 0;

723 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_NO_TOKEN
;

726 
mp_pt
->
ReivedInvidFme
 = 
l
;

727 
mp_pt
->
ReivedVidFme
 = 
l
;

728 
si_now
 = 
ue
;

731 i(
mp_pt
->
ReivedInvidFme
 =
ue
) {

733 
mp_pt
->
ReivedInvidFme
 = 
l
;

735 } i(
mp_pt
->
ReivedVidFme
 =
ue
) {

736 #i
PRINT_ENABLED_MASTER


737 
	`rtf
(
dr
,

739 
mp_pt
->
SourAddss
, mp_pt->
DeiAddss
,

740 
mp_pt
->
DaLgth
, mp_pt->
FmeCou
,

741 
mp_pt
->
STim
,

742 
	`mext_ame_ty
(
mp_pt
->
FmeTy
));

745 i((
mp_pt
->
DeiAddss
 =mp_pt->
This_Sti
)

746 || (
mp_pt
->
DeiAddss
 ==

747 
MSTP_BROADCAST_ADDRESS
)) {

748 
mp_pt
->
FmeTy
) {

750 
FRAME_TYPE_TOKEN
:

752 i(
mp_pt
->
DeiAddss
 ==

753 
MSTP_BROADCAST_ADDRESS
)

755 
mp_pt
->
ReivedVidFme
 = 
l
;

756 
mp_pt
->
FmeCou
 = 0;

757 
mp_pt
->
SeMa
 = 
l
;

758 
mp_pt
->
ma_e
 =

759 
MSTP_MASTER_STATE_USE_TOKEN
;

760 
si_now
 = 
ue
;

763 
FRAME_TYPE_POLL_FOR_MASTER
:

765 i(
mp_pt
->
DeiAddss
 ==

766 
mp_pt
->
This_Sti
) {

767 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

768 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

769 
mp_pt
->
SourAddss
,

770 
mp_pt
->
This_Sti
, 
NULL
, 0);

773 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

775 
	`dlmp_put_ive
(
mp_pt
->
SourAddss
,

776 (
ut8_t
 *& 
mp_pt
->
IutBufr
[0],

777 
mp_pt
->
DaLgth
);

779 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

782 
	`dlmp_put_ive
(
mp_pt
->
SourAddss
,

783 (
ut8_t
 *& 
mp_pt
->
IutBufr
[0],

784 
mp_pt
->
DaLgth
);

786 i(
mp_pt
->
DeiAddss
 !=

787 
MSTP_BROADCAST_ADDRESS
) {

788 
mp_pt
->
ma_e
 =

789 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
;

792 
FRAME_TYPE_TEST_REQUEST
:

793 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

794 
FRAME_TYPE_TEST_RESPONSE
,

795 
mp_pt
->
SourAddss
,

796 
mp_pt
->
This_Sti
,

797 (
ut8_t
 *& 
mp_pt
->
IutBufr
[0],

798 
mp_pt
->
DaLgth
);

800 
FRAME_TYPE_TEST_RESPONSE
:

805 
mp_pt
->
ReivedVidFme
 = 
l
;

811 
MSTP_MASTER_STATE_USE_TOKEN
:

812 i(!
mp_pt
->
TxRdy
) {

814 
mp_pt
->
FmeCou
 = mp_pt->
Nmax_fo_ames
;

815 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

816 
si_now
 = 
ue
;

818 
ut8_t
 
dei
 = 
mp_pt
->
TxBufr
[3];

819 
	`RS485_Sd_Fme
(
mp_pt
,

820 (
ut8_t
 *& 
mp_pt
->
TxBufr
[0], mp_pt->
TxLgth
);

821 
mp_pt
->
FmeCou
++;

822 
mp_pt
->
TxFmeTy
) {

823 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

825 i(
dei
 =
MSTP_BROADCAST_ADDRESS
)

826 
mp_pt
->
ma_e
 =

827 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

829 
mp_pt
->
ma_e
 =

830 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

832 
FRAME_TYPE_TEST_REQUEST
:

833 
mp_pt
->
ma_e
 =

834 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

836 
FRAME_TYPE_TEST_RESPONSE
:

837 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

840 
mp_pt
->
ma_e
 =

841 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

844 
mp_pt
->
TxRdy
 = 
l
;

849 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

850 i(
mp_pt
->
STim
 >
Ty_timeout
) {

853 
mp_pt
->
FmeCou
 = mp_pt->
Nmax_fo_ames
;

854 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

859 
si_now
 = 
ue
;

861 i(
mp_pt
->
ReivedInvidFme
 =
ue
) {

864 
mp_pt
->
ReivedInvidFme
 = 
l
;

865 
mp_pt
->
ma_e
 =

866 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

867 
si_now
 = 
ue
;

868 } i(
mp_pt
->
ReivedVidFme
 =
ue
) {

869 i(
mp_pt
->
DeiAddss
 ==

870 
mp_pt
->
This_Sti
) {

871 
mp_pt
->
FmeTy
) {

872 
FRAME_TYPE_REPLY_POSTPONED
:

874 
mp_pt
->
ma_e
 =

875 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

877 
FRAME_TYPE_TEST_RESPONSE
:

878 
mp_pt
->
ma_e
 =

879 
MSTP_MASTER_STATE_IDLE
;

881 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

885 
	`dlmp_put_ive
(
mp_pt
->
SourAddss
,

886 (
ut8_t
 *& 
mp_pt
->
IutBufr
[0],

887 
mp_pt
->
DaLgth
);

888 
mp_pt
->
ma_e
 =

889 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

894 
mp_pt
->
ma_e
 =

895 
MSTP_MASTER_STATE_IDLE
;

904 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

906 
mp_pt
->
ReivedVidFme
 = 
l
;

907 
si_now
 = 
ue
;

913 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
:

915 i(
mp_pt
->
FmeCou
 < mp_pt->
Nmax_fo_ames
) {

918 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

919 
si_now
 = 
ue
;

920 } i((
mp_pt
->
SeMa
 =
l
) &&

921 (
mp_pt
->
Next_Sti
 =mp_pt->
This_Sti
)) {

925 
mp_pt
->
Pl_Sti
 = 
xt_this_i
;

926 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

927 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

928 
mp_pt
->
This_Sti
, 
NULL
, 0);

929 
mp_pt
->
RryCou
 = 0;

930 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

933 i(
mp_pt
->
TokCou
 < (
Npl
 - 1)) {

934 i((
mp_pt
->
SeMa
 =
ue
) &&

935 (
mp_pt
->
Next_Sti
 !
xt_this_i
)) {

939 
mp_pt
->
FmeCou
 = 0;

940 
mp_pt
->
TokCou
++;

941 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

942 
si_now
 = 
ue
;

949 
mp_pt
->
TokCou
++;

951 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

952 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

954 
mp_pt
->
RryCou
 = 0;

955 
mp_pt
->
EvtCou
 = 0;

956 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

958 } i(
xt_pl_i
 =
mp_pt
->
Next_Sti
) {

959 i(
mp_pt
->
SeMa
 =
ue
) {

961 
mp_pt
->
Pl_Sti
 = 
xt_xt_i
;

962 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

963 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

964 
mp_pt
->
This_Sti
, 
NULL
, 0);

966 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

967 
mp_pt
->
RryCou
 = 0;

968 
mp_pt
->
TokCou
 = 1;

971 
mp_pt
->
ma_e
 =

972 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

975 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

977 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

978 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

980 
mp_pt
->
RryCou
 = 0;

981 
mp_pt
->
TokCou
 = 1;

982 
mp_pt
->
EvtCou
 = 0;

983 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

987 
mp_pt
->
Pl_Sti
 = 
xt_pl_i
;

988 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

989 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

990 
mp_pt
->
This_Sti
, 
NULL
, 0);

991 
mp_pt
->
RryCou
 = 0;

992 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

997 
MSTP_MASTER_STATE_PASS_TOKEN
:

998 i(
mp_pt
->
STim
 < 
Tuge_timeout
) {

999 i(
mp_pt
->
EvtCou
 > 
Nm_os
) {

1003 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1004 
si_now
 = 
ue
;

1007 i(
mp_pt
->
RryCou
 < 
Ny_tok
) {

1009 
mp_pt
->
RryCou
++;

1011 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

1012 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

1014 
mp_pt
->
EvtCou
 = 0;

1021 
mp_pt
->
Pl_Sti
 = 
xt_xt_i
;

1023 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1024 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

1025 
mp_pt
->
This_Sti
, 
NULL
, 0);

1027 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

1028 
mp_pt
->
RryCou
 = 0;

1029 
mp_pt
->
TokCou
 = 0;

1032 
mp_pt
->
ma_e
 =

1033 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1041 
MSTP_MASTER_STATE_NO_TOKEN
:

1042 
my_timeout
 = 
Tno_tok
 + (
T
 * 
mp_pt
->
This_Sti
);

1043 i(
mp_pt
->
STim
 < 
my_timeout
) {

1044 i(
mp_pt
->
EvtCou
 > 
Nm_os
) {

1048 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1049 
si_now
 = 
ue
;

1052 
ns_timeout
 =

1053 
Tno_tok
 + (
T
 * (
mp_pt
->
This_Sti
 + 1));

1054 i(
mp_pt
->
STim
 < 
ns_timeout
) {

1058 
mp_pt
->
Pl_Sti
 = 
xt_this_i
;

1060 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1061 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

1062 
mp_pt
->
This_Sti
, 
NULL
, 0);

1064 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

1065 
mp_pt
->
RryCou
 = 0;

1066 
mp_pt
->
TokCou
 = 0;

1069 
mp_pt
->
ma_e
 =

1070 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1077 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

1078 i(
mp_pt
->
ReivedVidFme
 =
ue
) {

1079 i((
mp_pt
->
DeiAddss
 =mp_pt->
This_Sti
)

1080 && (
mp_pt
->
FmeTy
 ==

1081 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
)) {

1083 
mp_pt
->
SeMa
 = 
l
;

1084 
mp_pt
->
Next_Sti
 = mp_pt->
SourAddss
;

1085 
mp_pt
->
EvtCou
 = 0;

1087 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

1088 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

1090 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

1091 
mp_pt
->
TokCou
 = 0;

1092 
mp_pt
->
RryCou
 = 0;

1093 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1100 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1101 
si_now
 = 
ue
;

1103 
mp_pt
->
ReivedVidFme
 = 
l
;

1104 } i((
mp_pt
->
STim
 >
Tuge_timeout
) ||

1105 (
mp_pt
->
ReivedInvidFme
 =
ue
)) {

1106 i(
mp_pt
->
SeMa
 =
ue
) {

1110 
mp_pt
->
FmeCou
 = 0;

1112 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1113 
si_now
 = 
ue
;

1115 i(
mp_pt
->
Next_Sti
 !mp_pt->
This_Sti
) {

1119 
mp_pt
->
EvtCou
 = 0;

1121 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

1122 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
,

1123 
NULL
, 0);

1124 
mp_pt
->
RryCou
 = 0;

1125 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1127 i(
xt_pl_i
 !
mp_pt
->
This_Sti
) {

1129 
mp_pt
->
Pl_Sti
 = 
xt_pl_i
;

1131 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1132 
FRAME_TYPE_POLL_FOR_MASTER
,

1133 
mp_pt
->
Pl_Sti
,

1134 
mp_pt
->
This_Sti
, 
NULL
, 0);

1135 
mp_pt
->
RryCou
 = 0;

1140 
mp_pt
->
SeMa
 = 
ue
;

1141 
mp_pt
->
FmeCou
 = 0;

1142 
mp_pt
->
ma_e
 =

1143 
MSTP_MASTER_STATE_USE_TOKEN
;

1144 
si_now
 = 
ue
;

1148 
mp_pt
->
ReivedInvidFme
 = 
l
;

1154 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
:

1155 i(
mp_pt
->
TxRdy
) {

1159 
mched
 =

1160 
	`mp_com_da_exg_y
(&
mp_pt
->
IutBufr


1161 [0], 
mp_pt
->
DaLgth
, mp_pt->
SourAddss
,

1162 &
mp_pt
->
TxBufr
[8], mp_pt->
TxLgth
,

1163 
mp_pt
->
TxDei
);

1165 i(
mched
 && 
mp_pt
->
TxRdy
) {

1173 
	`RS485_Sd_Fme
(
mp_pt
,

1174 (
ut8_t
 *& 
mp_pt
->
TxBufr
[0], mp_pt->
TxLgth
);

1175 
mp_pt
->
TxRdy
 = 
l
;

1176 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1177 } i(
mp_pt
->
STim
 > 
Ty_day
) {

1187 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1188 
FRAME_TYPE_REPLY_POSTPONED
, 
mp_pt
->
SourAddss
,

1189 
mp_pt
->
This_Sti
, 
NULL
, 0);

1190 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1194 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1198  
si_now
;

1199 
	}
}

1204 
	$MSTP_In
(

1205 vީ
mp_pt_ru_t
 *
mp_pt
)

1207 
i
;

1209 i(
mp_pt
) {

1210 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

1211 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_INITIALIZE
;

1212 
mp_pt
->
ReiveE
 = 
l
;

1213 
mp_pt
->
DaAvaab
 = 
l
;

1214 
mp_pt
->
DaRegi
 = 0;

1215 
mp_pt
->
DaCRC
 = 0;

1216 
mp_pt
->
DaCRC
 = 0;

1217 
mp_pt
->
DaLgth
 = 0;

1218 
mp_pt
->
DeiAddss
 = 0;

1219 
mp_pt
->
EvtCou
 = 0;

1220 
mp_pt
->
FmeTy
 = 
FRAME_TYPE_TOKEN
;

1221 
mp_pt
->
FmeCou
 = 0;

1222 
mp_pt
->
HdCRC
 = 0;

1223 
mp_pt
->
Index
 = 0;

1224 
mp_pt
->
Index
 = 0;

1225 
i
 = 0; i < (
mp_pt
->
IutBufr
); i++) {

1226 
mp_pt
->
IutBufr
[
i
] = 0;

1228 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

1229 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

1230 
mp_pt
->
ReivedInvidFme
 = 
l
;

1231 
mp_pt
->
ReivedVidFme
 = 
l
;

1232 
mp_pt
->
RryCou
 = 0;

1233 
mp_pt
->
STim
 = 0;

1235 
mp_pt
->
SeMa
 = 
l
;

1236 
mp_pt
->
SourAddss
 = 0;

1237 
mp_pt
->
TokCou
 = 0;

1240 
mp_pt
->
Nmax_fo_ames
 = 
DEFAULT_MAX_INFO_FRAMES
;

1241 
mp_pt
->
Nmax_ma
 = 
DEFAULT_MAX_MASTER
;

1246 
i
 = 0; i < (
mp_pt
->
TxBufr
); i++) {

1247 
mp_pt
->
TxBufr
[
i
] = 0;

1249 
mp_pt
->
TxLgth
 = 0;

1250 
mp_pt
->
TxRdy
 = 
l
;

1251 
mp_pt
->
TxFmeTy
 = 0;

1254 
	}
}

	@ports/pic18f6720/mstp.h

36 #ide
MSTP_H


37 
	#MSTP_H


	)

39 
	~<ddef.h
>

40 
	~<dt.h
>

41 
	~<dbo.h
>

42 
	~"bacdef.h
"

43 
	~"mpdef.h
"

44 
	~"dlmp.h
"

46 
	smp_pt_ru_t
 {

47 
MSTP_RECEIVE_STATE
 
	mive_e
;

50 
MSTP_MASTER_STATE
 
	mma_e
;

54 
	mReiveE
:1;

56 
	mDaAvaab
:1;

57 
	mReivedInvidFme
:1;

61 
	mReivedVidFme
:1;

64 
	mSeMa
:1;

66 
ut8_t
 
	mDaRegi
;

68 
ut16_t
 
	mDaCRC
;

70 
	mDaLgth
;

72 
ut8_t
 
	mDeiAddss
;

76 
ut8_t
 
	mEvtCou
;

78 
ut8_t
 
	mFmeTy
;

82 
	mFmeCou
;

84 
ut8_t
 
	mHdCRC
;

87 
	mIndex
;

91 
ut8_t
 *
	mIutBufr
;

95 
ut8_t
 
	mNext_Sti
;

98 
ut8_t
 
	mPl_Sti
;

101 
	mRryCou
;

109 
ut16_t
 
	mSTim
;

119 
ut8_t
 
	mSourAddss
;

125 
	mTokCou
;

131 
ut8_t
 
	mThis_Sti
;

140 
	mNmax_fo_ames
;

147 
	mNmax_ma
;

151 
ut8_t
 
	mTxBufr
[
MAX_MPDU
];

152 
	mTxLgth
;

153 
ut8_t
 
	mTxDei
;

154 
bo
 
	mTxRdy
;

155 
ut8_t
 
	mTxFmeTy
;

158 #ifde
__lulus


162 
MSTP_In
(

163 vީ
mp_pt_ru_t
 *
mp_pt
);

164 
MSTP_Reive_Fme_FSM
(

165 vީ
mp_pt_ru_t


166 *
mp_pt
);

167 
bo
 
MSTP_Ma_Node_FSM
(

168 vީ
mp_pt_ru_t


169 *
mp_pt
);

172 
bo
 
MSTP_Le_Aive
(

173 vީ
mp_pt_ru_t
 *
mp_pt
);

175 
MSTP_Ce_Fme
(

176 
ut8_t
 * 
bufr
,

177 
bufr_n
,

178 
ut8_t
 
ame_ty
,

179 
ut8_t
 
dei
,

180 
ut8_t
 
sour
,

181 
ut8_t
 * 
da
,

182 
da_n
);

185 #ifde
__lulus


	@ports/pic18f6720/rs485.c

29 
	~<ddef.h
>

30 
	~<dt.h
>

31 
	~<dbo.h
>

32 
	~<rg.h
>

33 
	~"hdwe.h
"

34 
	~"mp.h
"

35 
	~"rs485.h
"

36 
	~"fifo.h
"

39 vީ
mp_pt_ru_t
 
MSTP_Pt
;

42 
ut32_t
 
	gRS485_Baud_Re
 = 38400;

45 
FIFO_BUFFER
 
	gFIFO_Rx
;

46 
FIFO_BUFFER
 
	gFIFO_Tx
;

47 #agm
uda
 
MSTPPtDa


49 vީ
ut8_t
 
	gRS485_Rx_Bufr
[128];

51 vީ
ut8_t
 
	gRS485_Tx_Bufr
[128];

52 #agm
uda


60 
	$RS485_Sd_Fme
(

61 vީ
mp_pt_ru_t
 *
mp_pt
,

62 
ut8_t
 * 
bufr
,

63 
ut16_t
 
nbys
)

65 
ut16_t
 
i
 = 0;

66 
ut8_t
 
tuound_time
;

68 i(!
bufr
)

71 !
	`FIFO_Emy
(&
FIFO_Tx
)) {

76 i(
RS485_Baud_Re
 == 9600)

77 
tuound_time
 = 4;

78 i(
RS485_Baud_Re
 == 19200)

79 
tuound_time
 = 2;

81 
tuound_time
 = 2;

83 
mp_pt
->
STim
 < 
tuound_time
) {

87 i(
	`FIFO_Add
(&
FIFO_Tx
, 
bufr
, 
nbys
)) {

89 
PIE3bs
.
RC2IE
 = 0;

90 
RCSTA2bs
.
CREN
 = 0;

92 
RS485_TX_ENABLE
 = 1;

93 
RS485_RX_DISABLE
 = 1;

95 
TXSTA2bs
.
TXEN
 = 1;

96 
PIE3bs
.
TX2IE
 = 1;

98 
mp_pt
->
STim
 = 0;

102 
	}
}

110 
bo
 
	$RS485_Check_UART_Da
(

111 vީ
mp_pt_ru_t
 * 
mp_pt
)

114 i(!
	`FIFO_Emy
(&
FIFO_Rx
)) {

115 
mp_pt
->
DaRegi
 = 
	`FIFO_G
(&
FIFO_Rx
);

116 
mp_pt
->
DaAvaab
 = 
TRUE
;

119  (!
	`FIFO_Emy
(&
FIFO_Rx
));

120 
	}
}

131 
	$RS485_Iru_Rx
(

134 
ut8_t
 
da_by
;

136 i((
RCSTA2bs
.
FERR
|| (RCSTA2bs.
OERR
)) {

138 
RCSTA2bs
.
CREN
 = 0;

139 
RCSTA2bs
.
CREN
 = 1;

141 
da_by
 = 
RCREG2
;

143 
da_by
 = 
RCREG2
;

144 
	`FIFO_Put
(&
FIFO_Rx
, 
da_by
);

146 
	}
}

157 
	$RS485_Iru_Tx
(

160 i(!
	`FIFO_Emy
(&
FIFO_Tx
)) {

161 
TXREG2
 = 
	`FIFO_G
(&
FIFO_Tx
);

164 !
TXSTA2bs
.
TRMT
);

166 
PIE3bs
.
TX2IE
 = 0;

168 
RS485_TX_ENABLE
 = 0;

169 
RS485_RX_DISABLE
 = 0;

171 
PIE3bs
.
RC2IE
 = 1;

172 
RCSTA2bs
.
CREN
 = 1;

174 
	}
}

182 
ut32_t
 
	$RS485_G_Baud_Re
(

185  
RS485_Baud_Re
;

186 
	}
}

194 
bo
 
	$RS485_S_Baud_Re
(

195 
ut32_t
 
baud
)

197 
bo
 
vid
 = 
ue
;

199 
baud
) {

206 
RS485_Baud_Re
 = 
baud
;

209 
vid
 = 
l
;

213 i(
vid
) {

222  
vid
;

223 
	}
}

232 
	$RS485_Inlize_Pt
(

237 
TXSTA2
 = 0;

238 
RCSTA2
 = 0;

241 
RCSTA2bs
.
CREN
 = 1;

243 
PIE3bs
.
RC2IE
 = 1;

245 
TXSTA2bs
.
TXEN
 = 1;

246 
PIE3bs
.
TX2IE
 = 0;

262 
RS485_Baud_Re
) {

264 
SPBRG2
 = 64;

265 
TXSTA2bs
.
BRGH
 = 1;

268 
SPBRG2
 = 32;

269 
TXSTA2bs
.
BRGH
 = 1;

272 
SPBRG2
 = 21;

273 
TXSTA2bs
.
BRGH
 = 1;

276 
SPBRG2
 = 3;

277 
TXSTA2bs
.
BRGH
 = 0;

280 
SPBRG2
 = 10;

281 
TXSTA2bs
.
BRGH
 = 1;

284 
SPBRG2
 = 129;

285 
TXSTA2bs
.
BRGH
 = 1;

288 
SPBRG2
 = 129;

289 
TXSTA2bs
.
BRGH
 = 1;

290 
	`RS485_S_Baud_Re
(9600);

294 
TXSTA2bs
.
SYNC
 = 0;

296 
TXSTA2bs
.
TXEN
 = 1;

298 
RCSTA2bs
.
SPEN
 = 1;

302 
RS485_RX_DISABLE
 = 0;

303 
RS485_TX_ENABLE
 = 0;

304 
	}
}

312 
	$RS485_Dib_Pt
(

315 
RCSTA2
 &= 0x4F;

316 
TXSTA2bs
.
TXEN
 = 0;

317 
PIE3
 &= 0xCF;

318 
	}
}

326 
	$RS485_Re
(

329 
	`RS485_S_Baud_Re
(38400);

330 
	}
}

338 
	$RS485_Inlize
(

342 
	`FIFO_In
(&
FIFO_Rx
, 
RS485_Rx_Bufr
, (RS485_Rx_Buffer));

343 
	`FIFO_In
(&
FIFO_Tx
, 
RS485_Tx_Bufr
, (RS485_Tx_Buffer));

352 
	`RS485_Inlize_Pt
();

353 
	}
}

	@ports/pic18f6720/rs485.h

36 #ide
RS485_H


37 
	#RS485_H


	)

39 
	~<dt.h
>

40 
	~"mp.h
"

42 
ut32_t
 
RS485_Baud_Re
;

45 #ifde
__lulus


49 
RS485_Re
(

51 
RS485_Inlize
(

54 
RS485_Dib
(

57 
RS485_Sd_Fme
(

58 vީ
mp_pt_ru_t
 *
mp_pt
,

59 
ut8_t
 * 
bufr
,

60 
ut16_t
 
nbys
);

63 
bo
 
RS485_Check_UART_Da
(

64 vީ
mp_pt_ru_t
 *
mp_pt
);

66 
RS485_Iru_Rx
(

69 
RS485_Iru_Tx
(

72 
ut32_t
 
RS485_G_Baud_Re
(

74 
bo
 
RS485_S_Baud_Re
(

75 
ut32_t
 
baud
);

77 #ifde
__lulus


	@ports/pic18f6720/stdbool.h

1 #ide
STDBOOL_H


2 
	#STDBOOL_H


	)

6 #ide
__lulus


7 
	t_Bo
;

8 #ide
bo


9 
	#bo
 
_Bo


	)

11 #ide
ue


12 
	#ue
 1

	)

14 #ide
l


15 
	#l
 0

	)

17 
	#__bo_ue_l_e_defed
 1

	)

20 #ide
FALSE


21 
	#FALSE
 0

	)

24 #ide
TRUE


25 
	#TRUE
 1

	)

	@ports/pic18f6720/stdint.h

3 #ide
STDINT_H


4 
	#STDINT_H
 1

	)

6 
	~<ddef.h
>

8 
	tut8_t
;

9 sigd 
	tt8_t
;

10 
	tut16_t
;

11 sigd 
	tt16_t
;

13 
	tut32_t
;

14 sigd 
	tt32_t
;

	@ports/rtos32/bip-init.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~"bacdcode.h
"

38 
	~"b.h
"

40 
	gr
 = 
SOCKET_ERROR
;

43 
	$E
(

44 cڡ *
Msg
)

46 
Code
 = 
	`WSAGLaE
();

47 #ifde
HOST


48 
	`tf
("%s, code: %i\n", 
Msg
, 
Code
);

50 
	`tf
("%s, code: %s\n", 
Msg
, 
	`xn_gr_rg
(
Code
));

52 
	`ex
(1);

53 
	}
}

55 #ide
HOST


57 
	$IC˪up
(

60 i(
r
 !
SOCKET_ERROR
) {

61 
	`xn_r_o
(
r
);

62 
r
 = 
SOCKET_ERROR
;

63 #i
DEVICE_ID
 =
PRISM_PCMCIA_DEVICE


64 
	`RTPCShutDown
();

67 
	}
}

69 
	$NInlize
(

73 
Resu
;

75 #ide
HOST


76 i(!
	`RTKDebugVsi
())

77 
	`xn_backs
()->
cb_wr_sn_rg_c
 = 
NULL
;

79 #ifde
RTUSB_VER


80 
	`RTURegiClback
(
USBAX172
);

81 
	`RTURegiClback
(
USBAX772
);

82 
	`RTURegiClback
(
USBKeybrd
);

83 
	`FdUSBCڌrs
();

84 
	`S˕
(2000);

87 #ifde
DHCP


88 
	`XN_REGISTER_DHCP_CLI
()

90 
Resu
 = 
	`xn__
();

91 i(
Resu
 != 0)

92 
	`E
("xn_rtip_init failed");

94 
	`ex
(
IC˪up
);

95 
	`RTClDebugg
(
RT_DBG_CALLRESET
, (
DWORD

ex
, 0);

97 
Resu
 = 
	`BIND_DRIVER
(
MINOR_0
);

98 i(
Resu
 != 0)

99 
	`E
("driver initialization failed");

101 #i
DEVICE_ID
 =
PRISM_PCMCIA_DEVICE


103 i(
	`RTPCIn
(-1, 0, 2, 
NULL
) == 0)

104 
	`E
("No PCMCIA controller found");

108 
r
 =

109 
	`xn_r_ݒ_cfig
(
DEVICE_ID
, 
MINOR_0
, 
ED_IO_ADD
, 
ED_IRQ
,

110 
ED_MEM_ADD
);

111 i(
r
 =
SOCKET_ERROR
)

112 
	`E
("xn_interface_open_config failed");

114 
_i_fo
 
ii
;

115 #ifde
BACDL_ETHERNET


116 
BACNET_ADDRESS
 
my_addss
;

117 
i
;

119 
	`xn_r_fo
(
r
, &
ii
);

120 
tf


122 
ii
.
my_ht_addss
[0], ii.my_ethernet_address[1],

123 
ii
.
my_ht_addss
[2], ii.my_ethernet_address[3],

124 
ii
.
my_ht_addss
[4], ii.my_ethernet_address[5]);

125 #ifde
BACDL_ETHERNET


126 
i
 = 0; i < 6; i++) {

127 
my_addss
.
mac
[
i
] = 
ii
.
my_ht_addss
[i];

129 
	`ht_t_my_addss
(&
my_addss
);

133 #i
DEVICE_ID
 =
PRISM_PCMCIA_DEVICE
 || DEVICE_ID =
PRISM_DEVICE


134 
	`xn_wn_tup
(
r
,

141 
	`S˕
(1000);

144 #i
	`defed
(
AUTO_IP
)

145 
Resu
 = 
	`xn_auto
(
r
, 
MIP
, 
MaxIP
, 
NMask
, 
TgIP
);

146 i(
Resu
 =
SOCKET_ERROR
)

147 
	`E
("xn_autoip failed");

149 
	`tf
("Auto-assigd IPdds%i.%i.%i.%i\n", 
TgIP
[0],

150 
TgIP
[1], TargetIP[2], TargetIP[3]);

152 
	`xn__add
(
RT_DEFAULT
, 
_fddr
, 
DeuGeway
, 1, 
r
, 
RT_INF
);

153 
	`xn_t_rv_li
((
DWORD
 *
DNSSv
, 1);

155 #i
	`defed
(
DHCP
)

157 
DHCP_m
 
m
[] = { {
SUBNET_MASK
, 1}

158 , {
DNS_OP
, 1}

159 , {
ROUTER_OPTION
, 1}

161 
DHCP_ssi
 
DS
;

162 
DHCP_cf
 
DC
;

164 
	`xn__dh_cf
(&
DC
);

165 
DC
.
i
 = 
m
;

166 
DC
.
i_s
 = (
m
) / (param[0]);

167 
	`tf
("Contacting DHCP server,lease wait...\n");

168 
Resu
 = 
	`xn_dh
(
r
, &
DS
, &
DC
);

169 i(
Resu
 =
SOCKET_ERROR
)

170 
	`E
("xn_dhcp failed");

171 
	`memy
(
TgIP
, 
DS
.
_
, 4);

172 
	`tf
("My IPddsis: %i.%i.%i.%i\n", 
TgIP
[0], TargetIP[1],

173 
TgIP
[2], TargetIP[3]);

177 
	`tf
("Usg stiIPdds%i.%i.%i.%i\n", 
TgIP
[0], TargetIP[1],

178 
TgIP
[2], TargetIP[3]);

179 
Resu
 = 
	`xn_t_
(
r
, 
TgIP
, 
NMask
);

181 
	`xn__add
(
RT_DEFAULT
, 
_fddr
, 
DeuGeway
, 1, 
r
, 
RT_INF
);

182 
	`xn_t_rv_li
((
DWORD
 *
DNSSv
, 1);

187 
WSADATA
 
wd
;

188 
Resu
 = 
	`WSASup
(0x0101, &
wd
);

192 i(
Resu
 != 0)

193 
	`E
("TCP/IP stack initialization failed");

194 
	}
}

203 
	$RTIP_To_Nwk_Addss
(

204 
BYTE
 * 
o_addss
,

205 
_addr
 *
addr
)

207 
ut32_t
 
_addss
 = 0;

209 
	`decode_unsigd32
(
o_addss
, &
_addss
);

210 
addr
->
s_addr
 = 
	`htl
(
_addss
);

213 
	}
}

215 
	$t_brd_addss
(

216 
ut32_t
 
t_addss
)

218 
brd_addss
 = 0;

219 
mask
 = 0;

223 #i
USE_INADDR


224 (
t_addss
;

225 
	`b_t_brd_addr
(
INADDR_BROADCAST
);

227 i(
	`IN_CLASSA
(
	`ohl
(
t_addss
)))

228 
brd_addss
 =

229 (
	`ohl
(
t_addss
& ~
IN_CLASSA_HOST
) | IN_CLASSA_HOST;

230 i(
	`IN_CLASSB
(
	`ohl
(
t_addss
)))

231 
brd_addss
 =

232 (
	`ohl
(
t_addss
& ~
IN_CLASSB_HOST
) | IN_CLASSB_HOST;

233 i(
	`IN_CLASSC
(
	`ohl
(
t_addss
)))

234 
brd_addss
 =

235 (
	`ohl
(
t_addss
& ~
IN_CLASSC_HOST
) | IN_CLASSC_HOST;

236 i(
	`IN_CLASSD
(
	`ohl
(
t_addss
)))

237 
brd_addss
 =

238 (
	`ohl
(
t_addss
& ~
IN_CLASSD_HOST
) | IN_CLASSD_HOST;

240 
brd_addss
 = 
INADDR_BROADCAST
;

241 
	`b_t_brd_addr
(
	`htl
(
brd_addss
));

243 
	}
}

245 
bo
 
	$b_
(

246 *
iame
)

248 
rv
 = 0;

249 
sockaddr_
 
s
 = { -1 };

250 
vue
 = 1;

251 
sock_fd
 = -1;

252 
_addr
 
my_addr
;

254 (
iame
;

256 
	`NInlize
();

258 
	`RTIP_To_Nwk_Addss
(
TgIP
, &
my_addr
);

259 
	`b_t_addr
(
my_addr
.
s_addr
);

260 
	`t_brd_addss
(
my_addr
.
s_addr
);

261 
	`b_t_pt
(
	`hts
((0xBAC0));

263 
sock_fd
 = 
	`sock
(
AF_INET
, 
SOCK_DGRAM
, 
IPROTO_UDP
);

264 
	`b_t_sock
(
sock_fd
);

265 i(
sock_fd
 < 0)

266  
l
;

268 
s
.
s_my
 = 
AF_INET
; s.
s_addr
.
s_addr
 = 
	`htl
(
INADDR_ANY
);

269 
s
.
s_pt
 = 
	`b_g_pt
(); 
	`memt
(&(s.
s_zo
), '\0', 8);

270 
rv
 =

271 
	`bd
(
sock_fd
, (cڡ 
sockaddr
 *&
s
, (sockaddr));

272 i(
rv
 < 0) {

273 
	`o
(
sock_fd
); 
	`b_t_sock
(-1);  
l
;}

275  
ue
;
	}
}

	@ports/rtos32/dlmstp.c

25 
	~<dbo.h
>

26 
	~<dt.h
>

27 
	~<ddef.h
>

28 
	~<rg.h
>

29 #i
PRINT_ENABLED


30 
	~<dio.h
>

32 
	~"bacdef.h
"

33 
	~"mp.h
"

34 
	~"dlmp.h
"

35 
	~"rs485.h
"

36 
	~"du.h
"

39 
DLMSTP_PACKET
 
	gReive_Bufr
;

41 
ut8_t
 
	gPDU_Bufr
[
MAX_MPDU
];

43 vީ
mp_pt_ru_t
 
	gMSTP_Pt
;

45 
	$dlmp_
(

46 *
iame
)

48 (
iame
;

50 
Reive_Bufr
.
ady
 = 
l
;

51 
Reive_Bufr
.
pdu_n
 = 0;

53 
	`RS485_Inlize
();

54 
	`MSTP_In
(&
MSTP_Pt
, MSTP_Pt.
This_Sti
);

55 
	}
}

57 
	$dlmp_nup
(

61 
	}
}

64 
	$dlmp_nd_pdu
(

65 
BACNET_ADDRESS
 * 
de
,

66 
BACNET_NPDU_DATA
 * 
du_da
,

67 
ut8_t
 * 
pdu
,

68 
pdu_n
)

70 
bys_
 = 0;

71 
ut8_t
 
ame_ty
 = 0;

72 
ut8_t
 
dei
 = 0;

73 
BACNET_ADDRESS
 
c
;

74 
mtu_n
 = 0;

76 i(
MSTP_Pt
.
TxRdy
 =
l
) {

77 i(
du_da
->
cfmed_mesge
) {

78 
MSTP_Pt
.
TxFmeTy
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

80 
MSTP_Pt
.
TxFmeTy
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

83 i(
de
->
mac_n
) {

84 
dei
 = 
de
->
mac
[0];

87 
dei
 = 
MSTP_BROADCAST_ADDRESS
;

90 
mtu_n
 = 
MAX_HEADER
 - 2 ;

91 i((
MAX_HEADER
 + 
pdu_n
> 
MAX_MPDU
) {

92 #i
PRINT_ENABLED


93 
	`rtf
(
dr
, "mstp: PDU isoo bigo send!\n");

97 
	`memmove
(&
PDU_Bufr
[
mtu_n
], 
pdu
, 
pdu_n
);

98 
mtu_n
 +
pdu_n
;

99 
bys_
 =

100 
	`MSTP_Ce_Fme
((
ut8_t
 *& 
MSTP_Pt
.
TxBufr
[0],

101 (
MSTP_Pt
.
TxBufr
), MSTP_Pt.
TxFmeTy
, 
dei
,

102 
MSTP_Pt
.
This_Sti
, &
PDU_Bufr
[0], 
mtu_n
);

103 
MSTP_Pt
.
TxLgth
 = 
bys_
;

104 
MSTP_Pt
.
TxRdy
 = 
ue
;

107  
bys_
;

108 
	}
}

111 
	$dlmp_mlicd_tim
(

114 
	`MSTP_Mlicd_Tim
(&
MSTP_Pt
);

115 
	}
}

119 
ut16_t
 
	$dlmp_ive
(

120 
BACNET_ADDRESS
 * 
c
,

121 
ut8_t
 * 
pdu
,

122 
ut16_t
 
max_pdu
,

123 
timeout
)

125 
ut16_t
 
pdu_n
 = 0;

127 (
timeout
;

129 i((
MSTP_Pt
.
ReivedVidFme
 =
l
) &&

130 (
MSTP_Pt
.
ReivedInvidFme
 =
l
)) {

131 
	`RS485_Check_UART_Da
(&
MSTP_Pt
);

132 
	`MSTP_Reive_Fme_FSM
(&
MSTP_Pt
);

135 i(
MSTP_Pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
) {

136 i(
This_Sti
 <
DEFAULT_MAX_MASTER
) {

137 
	`MSTP_Ma_Node_FSM
(&
MSTP_Pt
)) {

142 i(
Reive_Bufr
.
ady
) {

143 
	`memmove
(
c
, &
Reive_Bufr
.
addss
, (Receive_Buffer.address));

144 
pdu_n
 = 
Reive_Bufr
.pdu_len;

145 
	`memmove
(&
pdu
[0], &
Reive_Bufr
.pdu[0], 
max_pdu
);

146 
Reive_Bufr
.
ady
 = 
l
;

149  
pdu_n
;

150 
	}
}

152 
	$dlmp_fl_ba_addss
(

153 
BACNET_ADDRESS
 * 
c
,

154 
ut8_t
 
mp_addss
)

156 
i
 = 0;

158 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

160 
c
->
mac_n
 = 0;

161 
c
->
mac
[0] = 0;

163 
c
->
mac_n
 = 1;

164 
c
->
mac
[0] = 
mp_addss
;

167 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

168 
c
->
mac
[
i
] = 0;

170 
c
->
t
 = 0;

171 
c
->
n
 = 0;

172 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

173 
c
->
adr
[
i
] = 0;

175 
	}
}

178 
ut16_t
 
	$dlmp_put_ive
(

179 
ut8_t
 
c
,

180 
ut8_t
 * 
pdu
,

181 
ut16_t
 
pdu_n
)

183 i(
Reive_Bufr
.
ady
) {

185 
pdu_n
 = 0;

186 } i(
pdu_n
 < (
Reive_Bufr
.
pdu
)) {

187 
	`dlmp_fl_ba_addss
(&
Reive_Bufr
.
addss
, 
c
);

188 
Reive_Bufr
.
pdu_n
 =du_len;

189 
	`memmove
(
Reive_Bufr
.
pdu
,du, 
pdu_n
);

190 
Reive_Bufr
.
ady
 = 
ue
;

193 
pdu_n
 = 0;

196  
pdu_n
;

197 
	}
}

199 
	$dlmp_t_my_addss
(

200 
ut8_t
 
mac_addss
)

203 
MSTP_Pt
.
This_Sti
 = 
mac_addss
;

206 
	}
}

215 
	$dlmp_t_max_fo_ames
(

216 
max_fo_ames
)

218 
MSTP_Pt
.
Nmax_fo_ames
 = 
max_fo_ames
;

221 
	}
}

223 
	$dlmp_max_fo_ames
(

226  
MSTP_Pt
.
Nmax_fo_ames
;

227 
	}
}

234 
	$dlmp_t_max_ma
(

235 
ut8_t
 
max_ma
)

237 
MSTP_Pt
.
Nmax_ma
 = 
max_ma
;

240 
	}
}

242 
ut8_t
 
	$dlmp_max_ma
(

245  
MSTP_Pt
.
Nmax_ma
;

246 
	}
}

248 
	$dlmp_g_my_addss
(

249 
BACNET_ADDRESS
 * 
my_addss
)

251 
i
 = 0;

253 
my_addss
->
mac_n
 = 1;

254 
my_addss
->
mac
[0] = 
MSTP_Pt
.
This_Sti
;

255 
my_addss
->
t
 = 0;

256 
my_addss
->
n
 = 0;

257 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

258 
my_addss
->
adr
[
i
] = 0;

262 
	}
}

264 
	$dlmp_g_brd_addss
(

265 
BACNET_ADDRESS
 * 
de
)

267 
i
 = 0;

269 i(
de
) {

270 
de
->
mac_n
 = 1;

271 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

272 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

273 
de
->
n
 = 0;

274 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

275 
de
->
adr
[
i
] = 0;

280 
	}
}

	@ports/rtos32/ethernet.c

26 
	~<dt.h
>

27 
	~<dbo.h
>

28 
	~<dio.h
>

29 
	~<dlib.h
>

30 
	~<rg.h
>

31 
	~<k32.h
>

32 
	~<ock.h
>

33 
	~<sock.h
>

34 
	~<wdows.h
>

35 
	~"ht.h
"

36 
	~"bacdcode.h
"

37 
	~"du.h
"

40 
ut8_t
 
	gEtht_Brd
[
MAX_MAC_LEN
] =

43 
ut8_t
 
	gEtht_Emy_MAC
[
MAX_MAC_LEN
] = { 0, 0, 0, 0, 0, 0 };

46 
ut8_t
 
	gEtht_MAC_Addss
[
MAX_MAC_LEN
] = { 0, 0, 0, 0, 0, 0 };

48 
SOCKET
 
	gEtht_Sock
 = -1;

50 
sockaddr
 
	gEtht_Addss
 = { 0 };

52 
bo
 
	$ht_vid
(

55  (
Etht_Sock
 != -1);

56 
	}
}

58 
	$ht_nup
(

61 i(
	`ht_vid
())

62 
	`osock
(
Etht_Sock
);

63 
Etht_Sock
 = -1;

66 
	}
}

68 
bo
 
	$ht_
(

69 *
r_me
)

71 
vue
 = 1;

73 (
r_me
;

75 
Etht_Sock
 = 
	`sock
(
AF_INET
, 
SOCK_RAW
, 0);

77 i(
Etht_Sock
 < 0)

78 
	`rtf
(
dr
, "ethernet: failedo bindo socket!\r\n");

79 
Etht_Addss
.
_my
 = 
AF_INET
;

80 
	`memt
(
Etht_Addss
.
_da
, 0, (Ethernet_Address.sa_data));

81 i(
	`bd
(
Etht_Sock
, &
Etht_Addss
,

82 (
Etht_Addss
)=
SOCKET_ERROR
)

83 
	`rtf
(
dr
, "ethernet: failedo bindo socket!\r\n");

86  
	`ht_vid
();

87 
	}
}

91 
	$ht_nd
(

92 
BACNET_ADDRESS
 * 
de
,

93 
BACNET_ADDRESS
 * 
c
,

94 
BACNET_NPDU_DATA
 * 
du_da
,

95 
ut8_t
 * 
pdu
,

96 
pdu_n
)

98 
bys
 = 0;

99 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

100 
mtu_n
 = 0;

101 
i
 = 0;

103 (
du_da
;

105 i(
Etht_Sock
 < 0) {

106 
	`rtf
(
dr
, "ethernet: 802.2 socket is invalid!\n");

110 i(
de
->
mac_n
 == 6) {

111 
i
 = 0; i < 6; i++) {

112 
mtu
[
mtu_n
] = 
de
->
mac
[
i
];

113 
mtu_n
++;

116 
	`rtf
(
dr
, "ethernet: invalid destination MACddress!\n");

121 i(
c
->
mac_n
 == 6) {

122 
i
 = 0; i < 6; i++) {

123 
mtu
[
mtu_n
] = 
c
->
mac
[
i
];

124 
mtu_n
++;

127 
	`rtf
(
dr
, "ethernet: invalid source MACddress!\n");

130 i((14 + 3 + 
pdu_n
> 
MAX_MPDU
) {

131 
	`rtf
(
dr
, "ethernet: PDU isoo bigo send!\n");

135 
mtu_n
 +
	`code_unsigd16
(&
mtu
[12], 3 + 
pdu_n
);

137 
mtu
[
mtu_n
++] = 0x82;

138 
mtu
[
mtu_n
++] = 0x82;

139 
mtu
[
mtu_n
++] = 0x03;

140 
mtu_n
 = 17;

141 i((
mtu_n
 + 
pdu_n
> 
MAX_MPDU
) {

142 
	`rtf
(
dr
, "ethernet: PDU isoo bigo send!\n");

145 
	`memy
(&
mtu
[
mtu_n
], 
pdu
, 
pdu_n
);

146 
mtu_n
 +
pdu_n
;

148 
	`code_unsigd16
(&
mtu
[12], 3 + 
pdu_n
);

151 
bys
 = 
	`nd
(
Etht_Sock
, (cڡ *&
mtu
, 
mtu_n
, 0);

153 i(
bys
 < 0)

154 
	`rtf
(
dr
, "ethernet: Error sendingacket: %s\n",

155 
	`
(
o
));

157  
bys
;

158 
	}
}

162 
	$ht_nd_pdu
(

163 
BACNET_ADDRESS
 * 
de
,

164 
BACNET_NPDU_DATA
 * 
du_da
,

165 
ut8_t
 * 
pdu
,

166 
pdu_n
)

168 
i
 = 0;

169 
BACNET_ADDRESS
 
c
 = { 0 };

171 
i
 = 0; i < 6; i++) {

172 
c
.
mac
[
i
] = 
Etht_MAC_Addss
[i];

173 
c
.
mac_n
++;

179  
	`ht_nd
(
de
,

180 &
c
,

181 
du_da
, 
pdu
,

182 
pdu_n
);

183 
	}
}

187 
ut16_t
 
	$ht_ive
(

188 
BACNET_ADDRESS
 * 
c
,

189 
ut8_t
 * 
pdu
,

190 
ut16_t
 
max_pdu
,

191 
timeout
)

193 
ived_bys
;

194 
ut8_t
 
buf
[
MAX_MPDU
] = { 0 };

195 
ut16_t
 
pdu_n
 = 0;

196 
fd_t
 
ad_fds
;

197 
max
;

198 
timev
 
_timeout
;

201 i(
Etht_Sock
 <= 0)

207 i(
timeout
 >= 1000) {

208 
_timeout
.
tv_c
 = 
timeout
 / 1000;

209 
_timeout
.
tv_uc
 =

210 1000 * (
timeout
 - 
_timeout
.
tv_c
 * 1000);

212 
_timeout
.
tv_c
 = 0;

213 
_timeout
.
tv_uc
 = 1000 * 
timeout
;

215 
	`FD_ZERO
(&
ad_fds
);

216 
	`FD_SET
(
Etht_Sock
, &
ad_fds
);

217 
max
 = 
Etht_Sock
;

219 i(
	`
(
max
 + 1, &
ad_fds
, 
NULL
, NULL, &
_timeout
) > 0)

220 
ived_bys
 = 
	`cv
(
Etht_Sock
, (*&
buf
[0], 
MAX_MPDU
, 0);

225 i(
ived_bys
 < 0) {

229 i(
o
 !
EAGAIN
)

230 
	`rtf
(
dr
, "ethernet: Readrror ineceivingacket: %s\n",

231 
	`
(
o
));

235 i(
ived_bys
 == 0)

239 i((
buf
[14] != 0x82) && (buf[15] != 0x82)) {

244 
c
->
mac_n
 = 6;

245 
	`memmove
(
c
->
mac
, &
buf
[6], 6);

249 i((
	`memcmp
(&
buf
[0], 
Etht_MAC_Addss
, 6) != 0)

250 && (
	`memcmp
(&
buf
[0], 
Etht_Brd
, 6) != 0)) {

255 (
	`decode_unsigd16
(&
buf
[12], &
pdu_n
);

256 
pdu_n
 -= 3 ;

258 i(
pdu_n
 < 
max_pdu
)

259 
	`memmove
(&
pdu
[0], &
buf
[17], 
pdu_n
);

263 
pdu_n
 = 0;

265  
pdu_n
;

266 
	}
}

268 
	$ht_g_my_addss
(

269 
BACNET_ADDRESS
 * 
my_addss
)

271 
i
 = 0;

273 
my_addss
->
mac_n
 = 0;

274 
i
 = 0; i < 6; i++) {

275 
my_addss
->
mac
[
i
] = 
Etht_MAC_Addss
[i];

276 
my_addss
->
mac_n
++;

278 
my_addss
->
t
 = 0;

279 
my_addss
->
n
 = 0;

280 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

281 
my_addss
->
adr
[
i
] = 0;

285 
	}
}

287 
	$ht_t_my_addss
(

288 
BACNET_ADDRESS
 * 
my_addss
)

290 
i
 = 0;

292 
i
 = 0; i < 6; i++) {

293 
Etht_MAC_Addss
[
i
] = 
my_addss
->
mac
[i];

297 
	}
}

299 
	$ht_g_brd_addss
(

300 
BACNET_ADDRESS
 * 
de
)

302 
i
 = 0;

304 i(
de
) {

305 
i
 = 0; i < 6; i++) {

306 
de
->
mac
[
i
] = 
Etht_Brd
[i];

308 
de
->
mac_n
 = 6;

309 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

310 
de
->
n
 = 0;

311 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

312 
de
->
adr
[
i
] = 0;

317 
	}
}

319 
	$ht_debug_addss
(

320 cڡ *
fo
,

321 
BACNET_ADDRESS
 * 
de
)

323 
i
 = 0;

325 i(
fo
)

326 
	`rtf
(
dr
, "%s", 
fo
);

327 i(
de
) {

328 
	`rtf
(
dr
, "Address:\n");

329 
	`rtf
(
dr
, " MAC Lgth=%d\n", 
de
->
mac_n
);

330 
	`rtf
(
dr
, " MAC Address=");

331 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

332 
	`rtf
(
dr
, "%02X ", (
de
->
mac
[
i
]);

334 
	`rtf
(
dr
, "\n");

335 
	`rtf
(
dr
, " N=%hu\n", 
de
->
t
);

336 
	`rtf
(
dr
, " L=%d\n", 
de
->
n
);

337 
	`rtf
(
dr
, " Adr=");

338 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

339 
	`rtf
(
dr
, "%02X ", (
de
->
adr
[
i
]);

341 
	`rtf
(
dr
, "\n");

345 
	}
}

	@ports/rtos32/init.c

26 
	~<rg.h
>

27 
	~<kl.h
>

28 
	~<wdows.h
>

30 
RTEmuIn
(

33 #ifde
_MSC_VER


34 
	#VOIDEXPORT
 
	`_deec
(
dexpt

__cde


	)

36 
	#VOIDEXPORT
 
__expt
 
__cde


	)

40 #ifde
DOC


41 
	~<fes.h
>

42 
	#RTF_MAX_FILES
 16

	)

43 
	#RTF_BUFFERS_IN_BSS


	)

44 
	~<fda.c
>

50 
RTFDrvFLPYDa
 
	gFLPYDriveADa
 = { 0 };

51 
RTFDrvDOCDa
 
	gDOCDriveDa
 = { 0 };

52 
RTFDrvIDEDa
 
	gIDEDriveDa
 = { 0 };

54 
RTFDevi
 
	gRTFDeviLi
[] = {

56 {
RTF_DEVICE_FLOPPY
, 0, 0, &
RTFDrvFlpy
, &
FLPYDriveADa
},

57 {
RTF_DEVICE_FDISK
, 0, 0, &
RTFDrvDOC
, &
DOCDriveDa
},

58 {
RTF_DEVICE_FDISK
, 0, 0, &
RTFDrvIDE
, &
IDEDriveDa
},

59 {0, 0, 0, 
NULL
, NULL}

66 
	#MAXHANDLES
 1024

	)

67 
	#MAXOBJECTS
 1024

	)

68 
	#MAXTYPES
 32

	)

70 
RTW32Hd
 
	gRTHdTab
[
MAXHANDLES
] = { {0} };

72 
	gRTHdCou
 = 
MAXHANDLES
;

74 
RTW32Obje
 
	gRTObjeTab
[
MAXOBJECTS
] = { {0} };

76 
	gRTObjeCou
 = 
MAXOBJECTS
;

78 
RTW32Tys
 
	gRTTyTab
[
MAXTYPES
] = { {0} };

80 
	gRTTyCou
 = 
MAXTYPES
;

91 
RTFeSyem
 
	gCse
 = { 
RT_FS_CONSOLE
, 0, 0, &
RTCseFeSyem
 };

93 
RTFeSyem
 
	gLPTFes
 = { 
RT_FS_LPT_DEVICE
, 0, 0, &
RTLPTFeSyem
 };

96 
RTFeSyem
 
	gRAMFes
 = { 
RT_FS_FILE
, 1 << ('Z' - 'A'), 0, &
RTRAMFeSyem
 };

99 
RTFeSyem
 
	gFATFes
 =

100 { 
RT_FS_FILE
 | 
RT_FS_IS_DEFAULT
, 0x0F, 0x03, &
RTFesFeSyem
 };

102 
RTFeSyem
 *
	gRTFeSyemLi
[] = {

103 &
Cse
,

104 &
LPTFes
,

105 &
RAMFes
,

106 &
FATFes
,

107 
NULL
,

112 
VOIDEXPORT
 
	$In
(

115 (
	`RTSFgs
(
RT_MM_VIRTUAL
, 1);

116 (
	`RTCMOSExndHp
();

117 
	`RTCMOSSSyemTime
();

118 
	`RTEmuIn
();

123 
RTKCfig
.
Fgs
 |
RF_PREEMPTIVE
;

124 
RTKCfig
.
Fgs
 |
RF_WIN32MUTEX_MUTEX
;

125 
RTKCfig
.
Fgs
 |
RF_FPCONTEXT
;

126 
RTKCfig
.
HookedIRQs
 |= 1 << 1;

127 
RTKCfig
.
DeuTaskSckSize
 = 1024 * 8;

128 
	}
}

	@ports/rtos32/main.c

28 
	~<ddef.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~<cio.h
>

32 
	~"cfig.h
"

33 
	~"bacdef.h
"

34 
	~"du.h
"

35 
	~"du.h
"

36 
	~"devi.h
"

37 
	~"hdrs.h
"

38 
	~"dk.h
"

39 
	~"m.h
"

40 
	~"txbuf.h
"

43 
	~"kl.h
"

44 #i
defed
(
RTK32_VER
)

45 
	#_USER32_


	)

46 
	#_KERNEL32_


	)

47 
	~<wdows.h
>

48 
	~<rg.h
>

49 
	~<fes.h
>

50 
	~<fsys.h
>

51 
	~<Rbios.h
>

53 
	~<com.h
>

54 
	~<im.h
>

55 
	~<keybrd.h
>

58 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

60 
	$In_Svi_Hdrs
(

64 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

67 
du_t_uecognized_rvi_hdr_hdr


68 (
hdr_uecognized_rvi
);

70 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

71 
hdr_ad_ݔty
);

72 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

73 
hdr_wre_ݔty
);

74 
	}
}

76 
	$mlicd_sk
(

79 
Time
 
ticks
 = 0;

80 
i
 = 0;

82 
ticks
 = 
	`RTKGTime
(+ 
	`MliSecsToTicks
(1);

83 
TRUE
) {

84 
	`RTKDayU
(
ticks
);

85 
	`dlmp_mlicd_tim
();

86 
ticks
 +
	`MliSecsToTicks
(1);

88 
	}
}

90 
	$RTOS_Inlize
(

94 (
	`kbh
();

95 
	`RTKlIn
(5);

96 
	`RTKeybrdIn
();

98 
	`RTComIn
();

99 
	`ITimIn
();

101 i(
	`RTClDebugg
(
RT_DBG_MONITOR
, 0, 0) != -1) {

105 
	`RTRaiCPUExi
(0);

106 
	`RTRaiCPUExi
(1);

107 
	`RTRaiCPUExi
(2);

108 
	`RTRaiCPUExi
(3);

109 
	`RTRaiCPUExi
(4);

110 
	`RTRaiCPUExi
(5);

111 
	`RTRaiCPUExi
(6);

113 
	`RTRaiCPUExi
(8);

114 
	`RTRaiCPUExi
(9);

115 
	`RTRaiCPUExi
(10);

116 
	`RTRaiCPUExi
(11);

117 
	`RTRaiCPUExi
(12);

118 
	`RTRaiCPUExi
(13);

119 
	`RTRaiCPUExi
(14);

120 
	`RTRaiCPUExi
(15);

121 
	`RTRaiCPUExi
(16);

124 
	`STimIV
(1000);

126 
	`RTKDay
(1);

127 
	`RTCMOSSSyemTime
();

130 
	`RTKCeTask
(
mlicd_sk
, 16, 1024 * 8, "millisecask");

131 
	}
}

133 
	$ma
(

134 
gc
,

135 *
gv
[])

137 
BACNET_ADDRESS
 
c
 = { 0 };

138 
ut16_t
 
pdu_n
 = 0;

139 
timeout
 = 100;

141 (
gc
;

142 (
gv
;

143 
	`Devi_S_Obje_In_Numb
(126);

144 
	`In_Svi_Hdrs
();

145 
	`RTOS_Inlize
();

147 #ifde
BACDL_MSTP


148 
	`dlmp_t_my_addss
(0x05);

150 
	`dk_
(
NULL
);

151 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

157 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

159 i(
pdu_n
) {

160 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

168 
	}
}

	@ports/rtos32/mstp.c

47 
	~<ddef.h
>

48 
	~<dt.h
>

49 #i
PRINT_ENABLED


50 
	~<dio.h
>

52 
	~"mp.h
"

53 
	~"bys.h
"

54 
	~"c.h
"

55 
	~"rs485.h
"

58 #i
PRINT_ENABLED


59 
	#PRINT_ENABLED_RECEIVE
 0

	)

60 
	#PRINT_ENABLED_RECEIVE_DATA
 1

	)

61 
	#PRINT_ENABLED_MASTER
 0

	)

63 
	#PRINT_ENABLED_RECEIVE
 0

	)

64 
	#PRINT_ENABLED_RECEIVE_DATA
 0

	)

65 
	#PRINT_ENABLED_MASTER
 0

	)

84 cڡ 
	gNpl
 = 50;

87 cڡ 
	gNy_tok
 = 1;

91 cڡ 
ut8_t
 
	gNm_os
 = 4;

99 cڡ 
ut16_t
 
	gTame_abt
 = 30;

103 cڡ 
	gTame_g
 = 20;

107 cڡ 
ut16_t
 
	gTno_tok
 = 500;

112 cڡ 
	gTpodrive
 = 15;

117 cڡ 
ut16_t
 
	gTy_day
 = 250;

123 cڡ 
ut16_t
 
	gTy_timeout
 = 255;

128 cڡ 
	gTroff
 = 30;

132 cڡ 
ut16_t
 
	gT
 = 10;

137 cڡ 
ut16_t
 
	gTuge_day
 = 15;

143 cڡ 
ut16_t
 
	gTuge_timeout
 = 30;

146 
	#INCREMENT_AND_LIMIT_UINT8
(
x
{i(x < 0xFFx++;}

	)

147 
	#INCREMENT_AND_LIMIT_UINT16
(
x
{i(x < 0xFFFFx++;}

	)

150 
bo
 
	$MSTP_Le_Aive
(

151 vީ
mp_pt_ru_t
 *
mp_pt
)

153  (
mp_pt
->
EvtCou
 > 
Nm_os
);

154 
	}
}

156 
	$MSTP_Ce_Fme
(

157 
ut8_t
 * 
bufr
,

158 
bufr_n
,

159 
ut8_t
 
ame_ty
,

160 
ut8_t
 
dei
,

161 
ut8_t
 
sour
,

162 
ut8_t
 * 
da
,

163 
da_n
)

165 
ut8_t
 
c8
 = 0xFF;

166 
ut16_t
 
c16
 = 0xFFFF;

167 
dex
 = 0;

170 i(
bufr_n
 < 8)

173 
bufr
[0] = 0x55;

174 
bufr
[1] = 0xFF;

175 
bufr
[2] = 
ame_ty
;

176 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[2], crc8);

177 
bufr
[3] = 
dei
;

178 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[3], crc8);

179 
bufr
[4] = 
sour
;

180 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[4], crc8);

181 
bufr
[5] = 
	`HI_BYTE
(
da_n
);

182 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[5], crc8);

183 
bufr
[6] = 
	`LO_BYTE
(
da_n
);

184 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[6], crc8);

185 
bufr
[7] = ~
c8
;

187 
dex
 = 8;

188 
da_n
 && 
da
 && (
dex
 < 
bufr_n
)) {

189 
bufr
[
dex
] = *
da
;

190 
c16
 = 
	`CRC_Cc_Da
(
bufr
[
dex
], crc16);

191 
da
++;

192 
dex
++;

193 
da_n
--;

196 i(
dex
 > 8) {

197 i((
dex
 + 2<
bufr_n
) {

198 
c16
 = ~crc16;

199 
bufr
[
dex
] = 
	`LO_BYTE
(
c16
);

200 
dex
++;

201 
bufr
[
dex
] = 
	`HI_BYTE
(
c16
);

202 
dex
++;

207  
dex
;

208 
	}
}

210 
	$MSTP_Ce_And_Sd_Fme
(

211 vީ
mp_pt_ru_t
 *
mp_pt
,

212 
ut8_t
 
ame_ty
,

213 
ut8_t
 
dei
,

214 
ut8_t
 
sour
,

215 
ut8_t
 * 
da
,

216 
da_n
)

218 
ut8_t
 
bufr
[
MAX_MPDU
] = { 0 };

219 
ut16_t
 
n
 = 0;

221 
n
 = (
ut16_t

	`MSTP_Ce_Fme
(&
bufr
[0],

222 (
bufr
),

223 
ame_ty
,

224 
dei
,

225 
sour
,

226 
da
,

227 
da_n
);

229 
	`RS485_Sd_Fme
(
mp_pt
, &
bufr
[0], 
n
);

231 
	}
}

234 
	$MSTP_Mlicd_Tim
(

235 vީ
mp_pt_ru_t
 *
mp_pt
)

237 
	`INCREMENT_AND_LIMIT_UINT16
(
mp_pt
->
STim
);

238 
	`INCREMENT_AND_LIMIT_UINT16
(
mp_pt
->
RlyPopedTim
);

240 
	}
}

242 #i
PRINT_ENABLED_RECEIVE


243 *
	$mp_ive_e_xt
(

244 
e
)

246 *
xt
 = "unknown";

248 
e
) {

249 
MSTP_RECEIVE_STATE_IDLE
:

250 
xt
 = "IDLE";

252 
MSTP_RECEIVE_STATE_PREAMBLE
:

253 
xt
 = "PREAMBLE";

255 
MSTP_RECEIVE_STATE_HEADER
:

256 
xt
 = "HEADER";

258 
MSTP_RECEIVE_STATE_DATA
:

259 
xt
 = "DATA";

265  
xt
;

266 
	}
}

269 
	$MSTP_Reive_Fme_FSM
(

270 vީ
mp_pt_ru_t
 *
mp_pt
)

272 #i
PRINT_ENABLED_RECEIVE_DATA


273 
MSTP_RECEIVE_STATE
 
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

275 #i
PRINT_ENABLED_RECEIVE


276 
	`rtf
(
dr
,

278 
	`mp_ive_e_xt
(
mp_pt
->
ive_e
),

279 
mp_pt
->
DaRegi
, mp_pt->
HdCRC
, mp_pt->
Index
,

280 
mp_pt
->
EvtCou
, mp_pt->
DaLgth
, mp_pt->
STim
);

282 
mp_pt
->
ive_e
) {

284 
MSTP_RECEIVE_STATE_IDLE
:

286 i(
mp_pt
->
ReiveE
 =
ue
) {

287 
mp_pt
->
ReiveE
 = 
l
;

288 
mp_pt
->
STim
 = 0;

289 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

291 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

292 } i(
mp_pt
->
DaAvaab
 =
ue
) {

293 #i
PRINT_ENABLED_RECEIVE_DATA


294 
	`rtf
(
dr
, "MSTP Rx: %02X ", 
mp_pt
->
DaRegi
);

297 i(
mp_pt
->
DaRegi
 == 0x55) {

298 
mp_pt
->
DaAvaab
 = 
l
;

299 
mp_pt
->
STim
 = 0;

300 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

302 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

306 #i
PRINT_ENABLED_RECEIVE_DATA


307 
	`rtf
(
dr
, "\n");

309 
mp_pt
->
DaAvaab
 = 
l
;

310 
mp_pt
->
STim
 = 0;

311 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

313 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

318 
MSTP_RECEIVE_STATE_PREAMBLE
:

320 i(
mp_pt
->
STim
 > 
Tame_abt
) {

323 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

326 i(
mp_pt
->
ReiveE
 =
ue
) {

327 
mp_pt
->
ReiveE
 = 
l
;

328 
mp_pt
->
STim
 = 0;

329 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

331 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

332 } i(
mp_pt
->
DaAvaab
 =
ue
) {

333 #i
PRINT_ENABLED_RECEIVE_DATA


334 
	`rtf
(
dr
, "%02X ", 
mp_pt
->
DaRegi
);

337 i(
mp_pt
->
DaRegi
 == 0xFF) {

338 
mp_pt
->
DaAvaab
 = 
l
;

339 
mp_pt
->
STim
 = 0;

340 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

341 
mp_pt
->
Index
 = 0;

342 
mp_pt
->
HdCRC
 = 0xFF;

344 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

347 i(
mp_pt
->
DaRegi
 == 0x55) {

348 
mp_pt
->
DaAvaab
 = 
l
;

349 
mp_pt
->
STim
 = 0;

350 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

352 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

356 
mp_pt
->
DaAvaab
 = 
l
;

357 
mp_pt
->
STim
 = 0;

358 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

360 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

365 
MSTP_RECEIVE_STATE_HEADER
:

367 i(
mp_pt
->
STim
 > 
Tame_abt
) {

369 
mp_pt
->
ReivedInvidFme
 = 
ue
;

371 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

374 i(
mp_pt
->
ReiveE
 =
ue
) {

375 
mp_pt
->
ReiveE
 = 
l
;

376 
mp_pt
->
STim
 = 0;

377 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

379 
mp_pt
->
ReivedInvidFme
 = 
ue
;

381 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

382 } i(
mp_pt
->
DaAvaab
 =
ue
) {

383 #i
PRINT_ENABLED_RECEIVE_DATA


384 
	`rtf
(
dr
, "%02X ", 
mp_pt
->
DaRegi
);

387 i(
mp_pt
->
Index
 == 0) {

388 
mp_pt
->
STim
 = 0;

389 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

390 
mp_pt
->
HdCRC
 =

391 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

392 
mp_pt
->
HdCRC
);

393 
mp_pt
->
FmeTy
 = mp_pt->
DaRegi
;

394 
mp_pt
->
DaAvaab
 = 
l
;

395 
mp_pt
->
Index
 = 1;

396 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

399 i(
mp_pt
->
Index
 == 1) {

400 
mp_pt
->
STim
 = 0;

401 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

402 
mp_pt
->
HdCRC
 =

403 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

404 
mp_pt
->
HdCRC
);

405 
mp_pt
->
DeiAddss
 = mp_pt->
DaRegi
;

406 
mp_pt
->
DaAvaab
 = 
l
;

407 
mp_pt
->
Index
 = 2;

408 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

411 i(
mp_pt
->
Index
 == 2) {

412 
mp_pt
->
STim
 = 0;

413 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

414 
mp_pt
->
HdCRC
 =

415 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

416 
mp_pt
->
HdCRC
);

417 
mp_pt
->
SourAddss
 = mp_pt->
DaRegi
;

418 
mp_pt
->
DaAvaab
 = 
l
;

419 
mp_pt
->
Index
 = 3;

420 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

423 i(
mp_pt
->
Index
 == 3) {

424 
mp_pt
->
STim
 = 0;

425 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

426 
mp_pt
->
HdCRC
 =

427 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

428 
mp_pt
->
HdCRC
);

429 
mp_pt
->
DaLgth
 = mp_pt->
DaRegi
 * 256;

430 
mp_pt
->
DaAvaab
 = 
l
;

431 
mp_pt
->
Index
 = 4;

432 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

435 i(
mp_pt
->
Index
 == 4) {

436 
mp_pt
->
STim
 = 0;

437 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

438 
mp_pt
->
HdCRC
 =

439 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

440 
mp_pt
->
HdCRC
);

441 
mp_pt
->
DaLgth
 +mp_pt->
DaRegi
;

442 
mp_pt
->
DaAvaab
 = 
l
;

443 
mp_pt
->
Index
 = 5;

444 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

447 i(
mp_pt
->
Index
 == 5) {

448 
mp_pt
->
STim
 = 0;

449 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

450 
mp_pt
->
HdCRC
 =

451 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

452 
mp_pt
->
HdCRC
);

453 
mp_pt
->
DaAvaab
 = 
l
;

455 i(
mp_pt
->
HdCRC
 != 0x55) {

458 
mp_pt
->
ReivedInvidFme
 = 
ue
;

460 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

462 i((
mp_pt
->
DeiAddss
 ==

463 
mp_pt
->
This_Sti
)

464 || (
mp_pt
->
DeiAddss
 ==

465 
MSTP_BROADCAST_ADDRESS
)) {

467 i(
mp_pt
->
DaLgth
 > 
MAX_MPDU
) {

470 
mp_pt
->
ReivedInvidFme
 = 
ue
;

472 
mp_pt
->
ive_e
 =

473 
MSTP_RECEIVE_STATE_IDLE
;

476 i(
mp_pt
->
DaLgth
 == 0) {

480 i((
mp_pt
->
FmeTy
 ==

481 
FRAME_TYPE_POLL_FOR_MASTER
)

482 && (
mp_pt
->
DeiAddss
 ==

483 
mp_pt
->
This_Sti
)

484 && (
mp_pt
->
ma_e
 ==

485 
MSTP_MASTER_STATE_IDLE
)) {

486 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

487 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

488 
mp_pt
->
SourAddss
,

489 
mp_pt
->
This_Sti
, 
NULL
, 0);

491 
mp_pt
->
ReivedInvidFme
 = 
l
;

492 
mp_pt
->
ReivedVidFme
 = 
l
;

495 
mp_pt
->
ReivedVidFme
 = 
ue
;

498 
mp_pt
->
ive_e
 =

499 
MSTP_RECEIVE_STATE_IDLE
;

503 
mp_pt
->
Index
 = 0;

504 
mp_pt
->
DaCRC
 = 0xFFFF;

506 
mp_pt
->
ive_e
 =

507 
MSTP_RECEIVE_STATE_DATA
;

513 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

521 
mp_pt
->
ReiveE
 = 
l
;

522 
mp_pt
->
STim
 = 0;

523 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

526 
mp_pt
->
ReivedInvidFme
 = 
ue
;

528 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

533 
MSTP_RECEIVE_STATE_DATA
:

535 i(
mp_pt
->
STim
 > 
Tame_abt
) {

537 
mp_pt
->
ReivedInvidFme
 = 
ue
;

539 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

542 i(
mp_pt
->
ReiveE
 =
ue
) {

543 
mp_pt
->
ReiveE
 = 
l
;

544 
mp_pt
->
STim
 = 0;

546 
mp_pt
->
ReivedInvidFme
 = 
ue
;

548 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

549 } i(
mp_pt
->
DaAvaab
 =
ue
) {

550 #i
PRINT_ENABLED_RECEIVE_DATA


551 
	`rtf
(
dr
, "%02X ", 
mp_pt
->
DaRegi
);

554 i(
mp_pt
->
Index
 < mp_pt->
DaLgth
) {

555 
mp_pt
->
DaCRC
 =

556 
	`CRC_Cc_Da
(
mp_pt
->
DaRegi
,

557 
mp_pt
->
DaCRC
);

558 
mp_pt
->
IutBufr
[mp_pt->
Index
] =

559 
mp_pt
->
DaRegi
;

560 
mp_pt
->
Index
++;

561 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_DATA
;

564 i(
mp_pt
->
Index
 =mp_pt->
DaLgth
) {

565 
mp_pt
->
DaCRC
 =

566 
	`CRC_Cc_Da
(
mp_pt
->
DaRegi
,

567 
mp_pt
->
DaCRC
);

568 
mp_pt
->
Index
++;

569 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_DATA
;

572 i(
mp_pt
->
Index
 =(mp_pt->
DaLgth
 + 1)) {

573 
mp_pt
->
DaCRC
 =

574 
	`CRC_Cc_Da
(
mp_pt
->
DaRegi
,

575 
mp_pt
->
DaCRC
);

578 i(
mp_pt
->
DaCRC
 == 0xF0B8)

579 
mp_pt
->
ReivedVidFme
 = 
ue
;

581 
mp_pt
->
ReivedInvidFme
 = 
ue
;

582 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

584 
mp_pt
->
DaAvaab
 = 
l
;

585 
mp_pt
->
STim
 = 0;

590 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

593 #i
PRINT_ENABLED_RECEIVE_DATA


594 i((
ive_e
 !
MSTP_RECEIVE_STATE_IDLE
) &&

595 (
mp_pt
->
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
)) {

596 
	`rtf
(
dr
, "\n");

597 
	`fush
(
dr
);

599 
ive_e
 = 
mp_pt
->receive_state;

603 
	}
}

605 #i
PRINT_ENABLED


606 *
	$mp_ma_e_xt
(

607 
e
)

609 *
xt
 = "unknown";

611 
e
) {

612 
MSTP_MASTER_STATE_INITIALIZE
:

613 
xt
 = "INITIALIZE";

615 
MSTP_MASTER_STATE_IDLE
:

616 
xt
 = "IDLE";

618 
MSTP_MASTER_STATE_USE_TOKEN
:

619 
xt
 = "USE_TOKEN";

621 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

622 
xt
 = "WAIT_FOR_REPLY";

624 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
:

625 
xt
 = "IDLE";

627 
MSTP_MASTER_STATE_PASS_TOKEN
:

628 
xt
 = "DONE_WITH_TOKEN";

630 
MSTP_MASTER_STATE_NO_TOKEN
:

631 
xt
 = "NO_TOKEN";

633 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

634 
xt
 = "POLL_FOR_MASTER";

636 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
:

637 
xt
 = "ANSWER_DATA_REQUEST";

643  
xt
;

644 
	}
}

647 #i
PRINT_ENABLED


648 *
	$mp_ame_ty_xt
(

649 
ty
)

651 *
xt
 = "unknown";

653 
ty
) {

654 
FRAME_TYPE_TOKEN
:

655 
xt
 = "TOKEN";

657 
FRAME_TYPE_POLL_FOR_MASTER
:

658 
xt
 = "POLL_FOR_MASTER";

660 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
:

661 
xt
 = "REPLY_TO_POLL_FOR_MASTER";

663 
FRAME_TYPE_TEST_REQUEST
:

664 
xt
 = "TEST_REQUEST";

666 
FRAME_TYPE_TEST_RESPONSE
:

667 
xt
 = "TEST_RESPONSE";

669 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

670 
xt
 = "BACNET_DATA_EXPECTING_REPLY";

672 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

673 
xt
 = "BACNET_DATA_NOT_EXPECTING_REPLY";

675 
FRAME_TYPE_REPLY_POSTPONED
:

676 
xt
 = "REPLY_POSTPONED";

679 i((
ty
 >
FRAME_TYPE_PROPRIETARY_MIN
) &&

680 (
ty
 <
FRAME_TYPE_PROPRIETARY_MAX
))

681 
xt
 = "PROPRIETARY";

685  
xt
;

686 
	}
}

690 
bo
 
	$MSTP_Ma_Node_FSM
(

691 vީ
mp_pt_ru_t
 * 
mp_pt
)

693 
mtu_n
 = 0;

694 
ame_ty
 = 0;

695 
ut8_t
 
xt_pl_i
 = 0;

696 
ut8_t
 
xt_this_i
 = 0;

697 
ut8_t
 
xt_xt_i
 = 0;

698 
ut16_t
 
my_timeout
 = 10, 
ns_timeout
 = 0;

700 
bo
 
si_now
 = 
l
;

701 #i
PRINT_ENABLED_MASTER


702 
MSTP_MASTER_STATE
 
ma_e
 = 
MSTP_MASTER_STATE_INITIALIZE
;

706 
xt_pl_i
 =

707 (
mp_pt
->
Pl_Sti
 + 1% (mp_pt->
Nmax_ma
 + 1);

708 
xt_this_i
 =

709 (
mp_pt
->
This_Sti
 + 1% (mp_pt->
Nmax_ma
 + 1);

710 
xt_xt_i
 =

711 (
mp_pt
->
Next_Sti
 + 1% (mp_pt->
Nmax_ma
 + 1);

712 #i
PRINT_ENABLED_MASTER


713 i(
mp_pt
->
ma_e
 != master_state) {

714 
ma_e
 = 
mp_pt
->master_state;

715 
	`rtf
(
dr
,

717 
mp_pt
->
This_Sti
, 
xt_this_i
,

718 
mp_pt
->
Next_Sti
, 
xt_xt_i
,

719 
mp_pt
->
Pl_Sti
, 
xt_pl_i
, mp_pt->
EvtCou
,

720 
mp_pt
->
TokCou
, mp_pt->
STim
,

721 
	`mp_ma_e_xt
(
mp_pt
->
ma_e
));

725 
mp_pt
->
ma_e
) {

726 
MSTP_MASTER_STATE_INITIALIZE
:

729 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

730 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

733 
mp_pt
->
TokCou
 = 
Npl
;

734 
mp_pt
->
SeMa
 = 
l
;

735 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

736 
si_now
 = 
ue
;

739 
MSTP_MASTER_STATE_IDLE
:

741 i(
mp_pt
->
STim
 >
Tno_tok
) {

743 
mp_pt
->
EvtCou
 = 0;

744 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_NO_TOKEN
;

747 
mp_pt
->
ReivedInvidFme
 = 
l
;

748 
mp_pt
->
ReivedVidFme
 = 
l
;

749 
si_now
 = 
ue
;

752 i(
mp_pt
->
ReivedInvidFme
 =
ue
) {

754 
mp_pt
->
ReivedInvidFme
 = 
l
;

756 } i(
mp_pt
->
ReivedVidFme
 =
ue
) {

757 #i
PRINT_ENABLED_MASTER


758 
	`rtf
(
dr
,

760 
mp_pt
->
SourAddss
, mp_pt->
DeiAddss
,

761 
mp_pt
->
DaLgth
, mp_pt->
FmeCou
,

762 
mp_pt
->
STim
,

763 
	`mp_ame_ty_xt
(
mp_pt
->
FmeTy
));

766 i((
mp_pt
->
DeiAddss
 =mp_pt->
This_Sti
)

767 || (
mp_pt
->
DeiAddss
 ==

768 
MSTP_BROADCAST_ADDRESS
)) {

769 
mp_pt
->
FmeTy
) {

771 
FRAME_TYPE_TOKEN
:

773 i(
mp_pt
->
DeiAddss
 ==

774 
MSTP_BROADCAST_ADDRESS
)

776 
mp_pt
->
ReivedVidFme
 = 
l
;

777 
mp_pt
->
FmeCou
 = 0;

778 
mp_pt
->
SeMa
 = 
l
;

779 
mp_pt
->
ma_e
 =

780 
MSTP_MASTER_STATE_USE_TOKEN
;

781 
si_now
 = 
ue
;

784 
FRAME_TYPE_POLL_FOR_MASTER
:

789 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

790 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

791 
mp_pt
->
SourAddss
,

792 
mp_pt
->
This_Sti
, 
NULL
, 0);

794 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

796 
	`dlmp_put_ive
(
mp_pt
->
SourAddss
,

797 (
ut8_t
 *& 
mp_pt
->
IutBufr
[0],

798 
mp_pt
->
DaLgth
);

800 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

801 
mp_pt
->
RlyPopedTim
 = 0;

803 
	`dlmp_put_ive
(
mp_pt
->
SourAddss
,

804 (
ut8_t
 *& 
mp_pt
->
IutBufr
[0],

805 
mp_pt
->
DaLgth
);

807 i(
mp_pt
->
DeiAddss
 !=

808 
MSTP_BROADCAST_ADDRESS
) {

809 
mp_pt
->
ma_e
 =

810 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
;

811 
si_now
 = 
ue
;

814 
FRAME_TYPE_TEST_REQUEST
:

815 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

816 
FRAME_TYPE_TEST_RESPONSE
,

817 
mp_pt
->
SourAddss
,

818 
mp_pt
->
This_Sti
,

819 (
ut8_t
 *& 
mp_pt
->
IutBufr
[0],

820 
mp_pt
->
DaLgth
);

822 
FRAME_TYPE_TEST_RESPONSE
:

827 
mp_pt
->
ReivedVidFme
 = 
l
;

833 
MSTP_MASTER_STATE_USE_TOKEN
:

834 i(!
mp_pt
->
TxRdy
) {

836 
mp_pt
->
FmeCou
 = mp_pt->
Nmax_fo_ames
;

837 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

839 
ut8_t
 
dei
 = 
mp_pt
->
TxBufr
[3];

840 
	`RS485_Sd_Fme
(
mp_pt
,

841 (
ut8_t
 *& 
mp_pt
->
TxBufr
[0], mp_pt->
TxLgth
);

842 
mp_pt
->
FmeCou
++;

843 
mp_pt
->
TxFmeTy
) {

844 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

846 i(
dei
 =
MSTP_BROADCAST_ADDRESS
)

847 
mp_pt
->
ma_e
 =

848 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

850 
mp_pt
->
ma_e
 =

851 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

853 
FRAME_TYPE_TEST_REQUEST
:

854 
mp_pt
->
ma_e
 =

855 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

857 
FRAME_TYPE_TEST_RESPONSE
:

858 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

861 
mp_pt
->
ma_e
 =

862 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

865 
mp_pt
->
TxRdy
 = 
l
;

867 
si_now
 = 
ue
;

871 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

872 i(
mp_pt
->
STim
 >
Ty_timeout
) {

875 
mp_pt
->
FmeCou
 = mp_pt->
Nmax_fo_ames
;

876 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

881 
si_now
 = 
ue
;

883 i(
mp_pt
->
ReivedInvidFme
 =
ue
) {

886 
mp_pt
->
ReivedInvidFme
 = 
l
;

887 
mp_pt
->
ma_e
 =

888 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

889 
si_now
 = 
ue
;

890 } i(
mp_pt
->
ReivedVidFme
 =
ue
) {

891 i(
mp_pt
->
DeiAddss
 ==

892 
mp_pt
->
This_Sti
) {

893 
mp_pt
->
TxFmeTy
) {

894 
FRAME_TYPE_REPLY_POSTPONED
:

896 
mp_pt
->
ma_e
 =

897 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

899 
FRAME_TYPE_TEST_RESPONSE
:

900 
mp_pt
->
ma_e
 =

901 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

903 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

907 
	`dlmp_put_ive
(
mp_pt
->
SourAddss
,

908 (
ut8_t
 *& 
mp_pt
->
IutBufr
[0],

909 
mp_pt
->
DaLgth
);

910 
mp_pt
->
ma_e
 =

911 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

916 
mp_pt
->
ma_e
 =

917 
MSTP_MASTER_STATE_IDLE
;

926 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

928 
mp_pt
->
ReivedVidFme
 = 
l
;

929 
si_now
 = 
ue
;

935 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
:

937 i(
mp_pt
->
FmeCou
 < mp_pt->
Nmax_fo_ames
) {

940 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

941 } i((
mp_pt
->
SeMa
 =
l
) &&

942 (
mp_pt
->
Next_Sti
 =mp_pt->
This_Sti
)) {

946 
mp_pt
->
Pl_Sti
 = 
xt_this_i
;

947 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

948 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

949 
mp_pt
->
This_Sti
, 
NULL
, 0);

950 
mp_pt
->
RryCou
 = 0;

951 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

954 i(
mp_pt
->
TokCou
 < (
Npl
 - 1)) {

955 i((
mp_pt
->
SeMa
 =
ue
) &&

956 (
mp_pt
->
Next_Sti
 !
xt_this_i
)) {

960 
mp_pt
->
FmeCou
 = 0;

961 
mp_pt
->
TokCou
++;

962 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

969 
mp_pt
->
TokCou
++;

971 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

972 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

974 
mp_pt
->
RryCou
 = 0;

975 
mp_pt
->
EvtCou
 = 0;

976 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

978 } i(
xt_pl_i
 =
mp_pt
->
Next_Sti
) {

979 i(
mp_pt
->
SeMa
 =
ue
) {

981 
mp_pt
->
Pl_Sti
 = 
xt_xt_i
;

982 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

983 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

984 
mp_pt
->
This_Sti
, 
NULL
, 0);

986 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

987 
mp_pt
->
RryCou
 = 0;

988 
mp_pt
->
TokCou
 = 1;

991 
mp_pt
->
ma_e
 =

992 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

995 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

997 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

998 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

1000 
mp_pt
->
RryCou
 = 0;

1001 
mp_pt
->
TokCou
 = 1;

1002 
mp_pt
->
EvtCou
 = 0;

1003 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1007 
mp_pt
->
Pl_Sti
 = 
xt_pl_i
;

1008 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1009 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

1010 
mp_pt
->
This_Sti
, 
NULL
, 0);

1011 
mp_pt
->
RryCou
 = 0;

1012 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1014 
si_now
 = 
ue
;

1018 
MSTP_MASTER_STATE_PASS_TOKEN
:

1019 i(
mp_pt
->
STim
 < 
Tuge_timeout
) {

1020 i(
mp_pt
->
EvtCou
 > 
Nm_os
) {

1024 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1025 
si_now
 = 
ue
;

1028 i(
mp_pt
->
RryCou
 < 
Ny_tok
) {

1030 
mp_pt
->
RryCou
++;

1032 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

1033 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

1035 
mp_pt
->
EvtCou
 = 0;

1042 
mp_pt
->
Pl_Sti
 = 
xt_xt_i
;

1044 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1045 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

1046 
mp_pt
->
This_Sti
, 
NULL
, 0);

1048 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

1049 
mp_pt
->
RryCou
 = 0;

1050 
mp_pt
->
TokCou
 = 0;

1053 
mp_pt
->
ma_e
 =

1054 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1055 
si_now
 = 
ue
;

1063 
MSTP_MASTER_STATE_NO_TOKEN
:

1064 
my_timeout
 = 
Tno_tok
 + (
T
 * 
mp_pt
->
This_Sti
);

1065 i(
mp_pt
->
STim
 < 
my_timeout
) {

1066 i(
mp_pt
->
EvtCou
 > 
Nm_os
) {

1070 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1071 
si_now
 = 
ue
;

1074 
ns_timeout
 =

1075 
Tno_tok
 + (
T
 * (
mp_pt
->
This_Sti
 + 1));

1076 i(
mp_pt
->
STim
 < 
ns_timeout
) {

1080 
mp_pt
->
Pl_Sti
 = 
xt_this_i
;

1082 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1083 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

1084 
mp_pt
->
This_Sti
, 
NULL
, 0);

1086 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

1087 
mp_pt
->
RryCou
 = 0;

1088 
mp_pt
->
TokCou
 = 0;

1091 
mp_pt
->
ma_e
 =

1092 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1093 
si_now
 = 
ue
;

1100 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

1101 i(
mp_pt
->
ReivedVidFme
 =
ue
) {

1102 i((
mp_pt
->
DeiAddss
 =mp_pt->
This_Sti
)

1103 && (
mp_pt
->
FmeTy
 ==

1104 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
)) {

1106 
mp_pt
->
SeMa
 = 
l
;

1107 
mp_pt
->
Next_Sti
 = mp_pt->
SourAddss
;

1108 
mp_pt
->
EvtCou
 = 0;

1110 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

1111 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

1113 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

1114 
mp_pt
->
TokCou
 = 0;

1115 
mp_pt
->
RryCou
 = 0;

1116 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1123 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1125 
mp_pt
->
ReivedVidFme
 = 
l
;

1126 
si_now
 = 
ue
;

1127 } i((
mp_pt
->
STim
 >
Tuge_timeout
) ||

1128 (
mp_pt
->
ReivedInvidFme
 =
ue
)) {

1129 i(
mp_pt
->
SeMa
 =
ue
) {

1133 
mp_pt
->
FmeCou
 = 0;

1135 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1137 i(
mp_pt
->
Next_Sti
 !mp_pt->
This_Sti
) {

1141 
mp_pt
->
EvtCou
 = 0;

1143 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

1144 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
,

1145 
NULL
, 0);

1146 
mp_pt
->
RryCou
 = 0;

1147 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1149 i(
xt_pl_i
 !
mp_pt
->
This_Sti
) {

1151 
mp_pt
->
Pl_Sti
 = 
xt_pl_i
;

1153 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1154 
FRAME_TYPE_POLL_FOR_MASTER
,

1155 
mp_pt
->
Pl_Sti
,

1156 
mp_pt
->
This_Sti
, 
NULL
, 0);

1157 
mp_pt
->
RryCou
 = 0;

1162 
mp_pt
->
SeMa
 = 
ue
;

1163 
mp_pt
->
FmeCou
 = 0;

1164 
mp_pt
->
ma_e
 =

1165 
MSTP_MASTER_STATE_USE_TOKEN
;

1169 
mp_pt
->
ReivedInvidFme
 = 
l
;

1170 
si_now
 = 
ue
;

1176 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
:

1178 i(
mp_pt
->
RlyPopedTim
 <
Ty_day
) {

1183 i((
mp_pt
->
FmeTy
 ==

1184 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
)

1185 && (
mp_pt
->
TxRdy
)) {

1193 
	`RS485_Sd_Fme
(
mp_pt
,

1194 (
ut8_t
 *& 
mp_pt
->
TxBufr
[0],

1195 
mp_pt
->
TxLgth
);

1196 
mp_pt
->
TxRdy
 = 
l
;

1197 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1198 
si_now
 = 
ue
;

1214 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1215 
FRAME_TYPE_REPLY_POSTPONED
, 
mp_pt
->
SourAddss
,

1216 
mp_pt
->
This_Sti
, 
NULL
, 0);

1217 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1218 
si_now
 = 
ue
;

1222 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1226  
si_now
;

1227 
	}
}

1229 
	$MSTP_In
(

1230 vީ
mp_pt_ru_t
 *
mp_pt
,

1231 
ut8_t
 
this_i_mac
)

1233 
i
;

1235 i(
mp_pt
) {

1236 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

1237 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_INITIALIZE
;

1238 
mp_pt
->
ReiveE
 = 
l
;

1239 
mp_pt
->
DaAvaab
 = 
l
;

1240 
mp_pt
->
DaRegi
 = 0;

1241 
mp_pt
->
DaCRC
 = 0;

1242 
mp_pt
->
DaCRC
 = 0;

1243 
mp_pt
->
DaLgth
 = 0;

1244 
mp_pt
->
DeiAddss
 = 0;

1245 
mp_pt
->
EvtCou
 = 0;

1246 
mp_pt
->
FmeTy
 = 
FRAME_TYPE_TOKEN
;

1247 
mp_pt
->
FmeCou
 = 0;

1248 
mp_pt
->
HdCRC
 = 0;

1249 
mp_pt
->
Index
 = 0;

1250 
mp_pt
->
Index
 = 0;

1251 
i
 = 0; i < (
mp_pt
->
IutBufr
); i++) {

1252 
mp_pt
->
IutBufr
[
i
] = 0;

1254 
mp_pt
->
Next_Sti
 = 
this_i_mac
;

1255 
mp_pt
->
Pl_Sti
 = 
this_i_mac
;

1256 
mp_pt
->
ReivedInvidFme
 = 
l
;

1257 
mp_pt
->
ReivedVidFme
 = 
l
;

1258 
mp_pt
->
RryCou
 = 0;

1259 
mp_pt
->
STim
 = 0;

1260 
mp_pt
->
RlyPopedTim
 = 0;

1261 
mp_pt
->
SeMa
 = 
l
;

1262 
mp_pt
->
SourAddss
 = 0;

1263 
mp_pt
->
TokCou
 = 0;

1264 
mp_pt
->
This_Sti
 = 
this_i_mac
;

1265 
mp_pt
->
Nmax_fo_ames
 = 
DEFAULT_MAX_INFO_FRAMES
;

1266 
mp_pt
->
Nmax_ma
 = 
DEFAULT_MAX_MASTER
;

1270 
i
 = 0; i < (
mp_pt
->
TxBufr
); i++) {

1271 
mp_pt
->
TxBufr
[
i
] = 0;

1273 
mp_pt
->
TxLgth
 = 0;

1274 
mp_pt
->
TxRdy
 = 
l
;

1275 
mp_pt
->
TxFmeTy
 = 0;

1278 
	}
}

	@ports/rtos32/mstp.h

36 #ide
MSTP_H


37 
	#MSTP_H


	)

39 
	~<ddef.h
>

40 
	~<dt.h
>

41 
	~<dbo.h
>

42 
	~"bacdef.h
"

43 
	~"mpdef.h
"

44 
	~"dlmp.h
"

46 
	smp_pt_ru_t
 {

47 
MSTP_RECEIVE_STATE
 
	mive_e
;

50 
MSTP_MASTER_STATE
 
	mma_e
;

54 
	mReiveE
:1;

56 
	mDaAvaab
:1;

57 
	mFmgE
:1;

58 
	mReivedInvidFme
:1;

62 
	mReivedVidFme
:1;

65 
	mSeMa
:1;

68 
	mTu_Around_Wag
:1;

70 
ut8_t
 
	mDaRegi
;

72 
ut16_t
 
	mDaCRC
;

74 
	mDaLgth
;

76 
ut8_t
 
	mDeiAddss
;

80 
ut8_t
 
	mEvtCou
;

82 
ut8_t
 
	mFmeTy
;

86 
	mFmeCou
;

88 
ut8_t
 
	mHdCRC
;

91 
	mIndex
;

95 
ut8_t
 
	mIutBufr
[
MAX_MPDU
];

99 
ut8_t
 
	mNext_Sti
;

102 
ut8_t
 
	mPl_Sti
;

105 
	mRryCou
;

113 
ut16_t
 
	mSTim
;

118 
ut16_t
 
	mRlyPopedTim
;

121 
ut8_t
 
	mSourAddss
;

127 
	mTokCou
;

133 
ut8_t
 
	mThis_Sti
;

142 
	mNmax_fo_ames
;

149 
	mNmax_ma
;

153 
ut8_t
 
	mTxBufr
[
MAX_MPDU
];

154 
	mTxLgth
;

155 
bo
 
	mTxRdy
;

156 
ut8_t
 
	mTxFmeTy
;

159 #ifde
__lulus


163 
MSTP_In
(

164 vީ
mp_pt_ru_t
 *
mp_pt
,

165 
ut8_t
 
this_i_mac
);

166 
MSTP_Mlicd_Tim
(

167 vީ
mp_pt_ru_t


168 *
mp_pt
);

169 
MSTP_Reive_Fme_FSM
(

170 vީ
mp_pt_ru_t


171 *
mp_pt
);

172 
bo
 
MSTP_Ma_Node_FSM
(

173 vީ
mp_pt_ru_t


174 *
mp_pt
);

177 
bo
 
MSTP_Le_Aive
(

178 vީ
mp_pt_ru_t
 *
mp_pt
);

180 
MSTP_Ce_Fme
(

181 
ut8_t
 * 
bufr
,

182 
bufr_n
,

183 
ut8_t
 
ame_ty
,

184 
ut8_t
 
dei
,

185 
ut8_t
 
sour
,

186 
ut8_t
 * 
da
,

187 
da_n
);

190 #ifde
__lulus


	@ports/rtos32/net.h

25 #ide
NET_H


26 
	#NET_H


	)

29 
	#WIN32_LEAN_AND_MEAN


	)

30 
	#STRICT


	)

32 
	~<wdows.h
>

33 
	~<dio.h
>

34 
	~<dlib.h
>

35 
	~<oss.h
>

37 
	~"b.h
"

38 #ide
HOST


39 
	~<i.h
>

40 
	~"tcfg.h
"

41 
	~<rg.h
>

42 
	~<k32.h
>

43 
	~<ock.h
>

44 
	~<sock.h
>

51 
	#IN_CLASSA
(
i
((()(i& 0x80000000=0)

	)

52 
	#IN_CLASSA_NET
 0xff000000

	)

53 
	#IN_CLASSA_NSHIFT
 24

	)

54 
	#IN_CLASSA_HOST
 0x00ffffff

	)

55 
	#IN_CLASSA_MAX
 128

	)

57 
	#IN_CLASSB
(
i
((()(i& 0xc0000000=0x80000000)

	)

58 
	#IN_CLASSB_NET
 0xffff0000

	)

59 
	#IN_CLASSB_NSHIFT
 16

	)

60 
	#IN_CLASSB_HOST
 0x0000ffff

	)

61 
	#IN_CLASSB_MAX
 65536

	)

63 
	#IN_CLASSC
(
i
((()(i& 0xe0000000=0xc0000000)

	)

64 
	#IN_CLASSC_NET
 0xffffff00

	)

65 
	#IN_CLASSC_NSHIFT
 8

	)

66 
	#IN_CLASSC_HOST
 0x000000ff

	)

68 
	#IN_CLASSD
(
i
((()(i& 0xf0000000=0xe0000000)

	)

69 
	#IN_CLASSD_NET
 0xf0000000

	)

70 
	#IN_CLASSD_NSHIFT
 28

	)

71 
	#IN_CLASSD_HOST
 0x0ffffff

	)

72 
	#IN_MULTICAST
(
i

	`IN_CLASSD
(i)

	)

75 
	~<wsock.h
>

77 
	#o
 
osock


	)

78 
size_t
 
	tsockn_t
;

	@ports/rtos32/netcfg.h

34 #i
defed
(
AUTO_IP
)

35 
BYTE
 
	gTgIP
[] = { 0, 0, 0, 0 };

36 
BYTE
 
	gNMask
[] = { 255, 255, 255, 0 };

37 
BYTE
 
	gMIP
[] = { 192, 168, 0, 128 };

38 
BYTE
 
	gMaxIP
[] = { 192, 168, 0, 255 };

39 
BYTE
 
	gDeuGeway
[] = { 192, 168, 0, 1 };

40 
BYTE
 
	gDNSSv
[] = { 192, 168, 0, 1 };

41 #i
defed
(
DHCP
)

42 
	~<dhpi.h
>

43 
BYTE
 
	gTgIP
[] = { 0, 0, 0, 0 };

45 
BYTE
 
	gTgIP
[] = { 192, 168, 0, 50 };

46 
BYTE
 
	gNMask
[] = { 255, 255, 255, 0 };

47 
BYTE
 
	gDeuGeway
[] = { 192, 168, 0, 1 };

48 
BYTE
 
	gDNSSv
[] = { 192, 168, 0, 1 };

51 
	#DEVICE_ID
 
DAVICOM_DEVICE


	)

53 #ide
DEVICE_ID


54 #r 
You
 
mu
 
defe
 
Etht
 
driv
/
sours
 
d
 
IP
 
addss
/
t
 
mask
 
he


61 
	#ED_IO_ADD
 0x300

	)

62 
	#ED_IRQ
 5

	)

63 
	#ED_MEM_ADD
 0

	)

67 #i
DEVICE_ID
 =
NE2000_DEVICE


68 
	#BIND_DRIVER
 
xn_bd_2000


	)

69 #i
DEVICE_ID
 =
N83815_DEVICE


70 
	#BIND_DRIVER
 
xn_bd_n83815


	)

71 #i
DEVICE_ID
 =
TC90X_DEVICE


72 
	#BIND_DRIVER
 
xn_bd_tc90x


	)

73 #i
DEVICE_ID
 =
SMC91C9X_DEVICE


74 
	#BIND_DRIVER
 
xn_bd_smc91c9x


	)

75 #i
DEVICE_ID
 =
LANCE_DEVICE


76 
	#BIND_DRIVER
 
xn_bd_n


	)

77 #i
DEVICE_ID
 =
LANCE_ISA_DEVICE


78 
	#BIND_DRIVER
 
xn_bd_n_i


	)

79 #i
DEVICE_ID
 =
LAN_CS89X0_DEVICE


80 
	#BIND_DRIVER
 
xn_bd_cs


	)

81 #i
DEVICE_ID
 =
I82559_DEVICE


82 
	#BIND_DRIVER
 
xn_bd_i82559


	)

83 #i
DEVICE_ID
 =
R8139_DEVICE


84 
	#BIND_DRIVER
 
xn_bd_r8139


	)

85 #i
DEVICE_ID
 =
DAVICOM_DEVICE


86 
	#BIND_DRIVER
 
xn_bd_davicom


	)

87 #i
DEVICE_ID
 =
RHINE_DEVICE


88 
	#BIND_DRIVER
 
xn_bd_rhe


	)

89 #i
DEVICE_ID
 =
AX172_DEVICE


90 
	~<usb.h
>

91 
	#BIND_DRIVER
 
xn_bd_ax172


	)

92 #i
DEVICE_ID
 =
AX772_DEVICE


93 
	~<usb.h
>

94 
	#BIND_DRIVER
 
xn_bd_ax772


	)

95 #i
DEVICE_ID
 =
PRISM_DEVICE


96 
	~<wpi.h
>

97 
	#BIND_DRIVER
 
xn_bd_ism


	)

98 #i
DEVICE_ID
 =
PRISM_PCMCIA_DEVICE


99 
	~<pcmc.h
>

100 
	~<wpi.h
>

101 
	#BIND_DRIVER
 
xn_bd_ism_pcmc


	)

103 #r 
Invid
 
DEVICE_ID
 
vue


	@ports/rtos32/rs485.c

25 #i
PRINT_ENABLED


26 
	#PRINT_ENABLED_RS485
 1

	)

28 
	#PRINT_ENABLED_RS485
 0

	)

31 
	~<dt.h
>

32 
	~<kl.h
>

33 
	~<com.h
>

34 
	~<im.h
>

35 #i
PRINT_ENABLED_RS485


36 
	~<dio.h
>

38 
	~"mp.h
"

42 
	#RS485_IO_ENABLE
(
p

	`ModemCڌ
,0,
DTR
);

	)

43 
	#RS485_TRANSMIT_ENABLE
(
p

	`ModemCڌ
,1,
RTS
);

	)

44 
	#RS485_RECEIVE_ENABLE
(
p

	`ModemCڌ
,0,
RTS
);

	)

47 
	gRS485_Pt
 = 
COM2
;

49 
	gRS485_Baud
 = 9600;

51 
	gRS485_Ba
 = 0;

53 
	gRS485_IRQ_Numb
 = 0;

55 #i
PRINT_ENABLED_RS485


56 
FeTime
 
	gRS485_Debug_Tnsm_Tim
;

59 #i
PRINT_ENABLED_RS485


60 
	$RS485_Prt_Fme
(

61 
pt
,

62 
FeTime
 
tim
,

63 
ut8_t
 * 
bufr
,

64 
ut16_t
 
nbys
)

66 
ut16_t
 
i
;

67 
duti
;

68 
cds
;

69 
mlicds
;

71 
duti
 = 
	`EpdMliSecs
(
tim
);

72 
cds
 = 
duti
 / 1000U;

73 
mlicds
 = 
duti
 - (
cds
 * 1000U);

74 
	`rtf
(
dr
, "%0lu.%03lu: COM%d:", 
cds
, 
mlicds
, 
pt
 + 1);

75 
i
 = 0; i < 
nbys
; i++) {

76 
vue
;

77 
vue
 = 
bufr
[
i
];

78 
	`rtf
(
dr
, " %02X", 
vue
);

80 
	`rtf
(
dr
, "\n");

81 
	`fush
(
dr
);

82 
	}
}

85 
	$RS485_Sndd_Pt_Stgs
(

86 
pt
,

87 *
pIRQ
,

88 *
pBa
)

90 
pt
) {

91 
COM1
:

92 *
pBa
 = () 0x3F8;

93 *
pIRQ
 = 4L;

95 
COM2
:

96 *
pBa
 = () 0x2F8;

97 *
pIRQ
 = 3L;

99 
COM3
:

100 *
pBa
 = () 0x3E8;

101 *
pIRQ
 = 4L;

103 
COM4
:

104 *
pBa
 = () 0x2E8;

105 *
pIRQ
 = 3L;

110 
	}
}

112 
	$TeCOMPt
(

113 
Ba
)

115 
i
;

117 
i
 = 0; i < 256; i++) {

118 
	`RTOut
(
Ba
 + 7, (
BYTE

i
);

119 
	`RTOut
(
Ba
 + 1, 
	`RTIn
(Base + 1));

120 i(
	`RTIn
(
Ba
 + 7!
i
)

121  
FALSE
;

123  
TRUE
;

124 
	}
}

126 
	$RS485_On_Pt
(

127 
pt
,

128 
baud
,

129 
ba
,

130 
q
)

132 i(!
	`TeCOMPt
(
ba
))

136 
	`SIOBa
(
pt
, 
ba
);

137 
	`SIRQ
(
pt
, 
q
);

139 i(
q
 < 8)

140 
	`RTKIRQTPriܙy
(
q
, 9);

142 
	`InPt
(
pt
, 
baud
, 
PARITY_NONE
, 1, 8);

144 i(
	`HasFIFO
(
pt
))

145 
	`EbFIFO
(
pt
, 8);

146 
	`EbCOMIru
(
pt
, 1024 * 4);

149 
	`RS485_IO_ENABLE
(
pt
);

150 
	`RS485_RECEIVE_ENABLE
(
pt
);

151 #i
PRINT_ENABLED_RS485


152 
	`rtf
(
dr
, "RS485: COM%d Ebd\r\n", 
pt
 + 1);

156 
	}
}

158 
	$RS485_Inlize
(

161 #i
PRINT_ENABLED_RS485


162 
	`MkTime
(&
RS485_Debug_Tnsm_Tim
);

164 
	`RS485_Sndd_Pt_Stgs
(
RS485_Pt
, &
RS485_IRQ_Numb
, &
RS485_Ba
);

165 
	`RS485_On_Pt
(
RS485_Pt
, 
RS485_Baud
, 
RS485_Ba
, 
RS485_IRQ_Numb
);

166 
	}
}

168 
	$RS485_Sd_Fme
(

169 vީ
mp_pt_ru_t
 *
mp_pt
,

170 
ut8_t
 * 
bufr
,

171 
ut16_t
 
nbys
)

173 
bo
 
us
 = 
ue
;

176 
	`RS485_TRANSMIT_ENABLE
(
RS485_Pt
);

177 
	`SdBlock
(
RS485_Pt
, (*
bufr
, 
nbys
);

179 (
	`WaSdBufrEmy
(
RS485_Pt
, 
	`MliSecsToTicks
(200));

180 !(
	`LeStus
(
RS485_Pt
& 
TX_SHIFT_EMPTY
))

181 
	`RTKSchedur
();

182 
	`RS485_RECEIVE_ENABLE
(
RS485_Pt
);

186 
mp_pt
->
STim
 = 0;

187 #i
PRINT_ENABLED_RS485


188 
	`RS485_Prt_Fme
(
RS485_Pt
, 
RS485_Debug_Tnsm_Tim
, 
bufr
,

189 
nbys
);

190 
	`MkTime
(&
RS485_Debug_Tnsm_Tim
);

194 
	}
}

196 
	$RS485_Check_UART_Da
(

197 vީ
mp_pt_ru_t
 *
mp_pt
)

199 
COMDa
 
com_da
 = 0;

200 
timeout
 = 1;

201 
Duti
 
ticks
 = 0;

203 i(
mp_pt
->
ReiveE
) {

205 
	`RTKSchedur
();

208 i(!
mp_pt
->
DaAvaab
) {

209 i(!
ticks
) {

210 
ticks
 = 
	`MliSecsToTicks
(
timeout
);

211 i(!
ticks
)

212 
ticks
 = 1;

215 i(
	`RTKGTimed
(
ReiveBufr
[
RS485_Pt
], &
com_da
, 
ticks
)) {

217 i(
com_da
 & (
COM_OVERRUN
 << 8))

218 
mp_pt
->
ReiveE
 = 
ue
;

219 i(
com_da
 & (
COM_FRAME
 << 8))

220 
mp_pt
->
ReiveE
 = 
ue
;

222 
mp_pt
->
DaRegi
 = 
com_da
 & 0x00FF;

223 
mp_pt
->
DaAvaab
 = 
ue
;

227 
	`RTKSchedur
();

228 
	}
}

	@ports/rtos32/rs485.h

36 #ide
RS485_H


37 
	#RS485_H


	)

39 
	~<dt.h
>

40 
	~"mp.h
"

42 #ifde
__lulus


46 
RS485_Inlize
(

49 
RS485_Sd_Fme
(

50 vީ
mp_pt_ru_t
 *
mp_pt
,

51 
ut8_t
 * 
bufr
,

52 
ut16_t
 
nbys
);

54 
RS485_Check_UART_Da
(

55 vީ
mp_pt_ru_t
 *
mp_pt
);

57 #ifde
__lulus


	@ports/rtos32/stdbool.h

1 #ide
STDBOOL_H


2 
	#STDBOOL_H


	)

6 #ide
__lulus


7 
	t_Bo
;

8 #ide
bo


9 
	#bo
 
_Bo


	)

11 #ide
ue


12 
	#ue
 1

	)

14 #ide
l


15 
	#l
 0

	)

17 
	#__bo_ue_l_e_defed
 1

	)

20 #ide
FALSE


21 
	#FALSE
 0

	)

24 #ide
TRUE


25 
	#TRUE
 1

	)

	@ports/rtos32/stdint.h

4 #ide
STDINT_H


5 
	#STDINT_H


	)

7 
	~<ddef.h
>

9 
	tut8_t
;

10 sigd 
	tt8_t
;

11 
	tut16_t
;

12 sigd 
	tt16_t
;

14 
	tut32_t
;

15 sigd 
	tt32_t
;

	@ports/rx62n/bacnet.c

25 
	~<dt.h
>

26 
	~<dbo.h
>

28 
	~"hdwe.h
"

29 
	~"tim.h
"

30 
	~"d.h
"

32 
	~"dk.h
"

33 
	~"du.h
"

34 
	~"hdrs.h
"

35 
	~".h
"

36 
	~"txbuf.h
"

37 
	~"dcc.h
"

38 
	~"m.h
"

39 
	~"devi.h
"

40 
	~"bo.h
"

42 
	~"ba.h
"

45 
im
 
	gDCC_Tim
;

46 
	#DCC_CYCLE_SECONDS
 1

	)

48 
	$ba_
(

52 
	`Devi_In
(
NULL
);

55 
du_t_uecognized_rvi_hdr_hdr


56 (
hdr_uecognized_rvi
);

58 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

59 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_HAS
, 
hdr_who_has
);

62 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

63 
hdr_ad_ݔty
);

64 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

65 
hdr_ad_ݔty_muɝ
);

66 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

67 
hdr_lize_devi
);

68 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

69 
hdr_wre_ݔty
);

71 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

72 
hdr_devi_communiti_cڌ
);

74 
	`tim_rv_t_cds
(&
DCC_Tim
, 
DCC_CYCLE_SECONDS
);

76 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

77 
	}
}

79 
ut8_t
 
	gPDUBufr
[
MAX_MPDU
];

80 
	$ba_sk
(

83 
ut16_t
 
pdu_n
;

84 
BACNET_ADDRESS
 
c
;

85 
ut8_t
 
i
;

86 
BACNET_BINARY_PV
 
by_vue
 = 
BINARY_INACTIVE
;

87 
BACNET_POLARITY
 
pެy
;

88 
bo
 
out_of_rvi
;

91 
i
 = 0; i < 
MAX_BINARY_OUTPUTS
; i++) {

92 
out_of_rvi
 = 
	`By_Ouut_Out_Of_Svi
(
i
);

93 i(!
out_of_rvi
) {

94 
by_vue
 = 
	`By_Ouut_P_Vue
(
i
);

95 
pެy
 = 
	`By_Ouut_Pެy
(
i
);

96 i(
pެy
 !
POLARITY_NORMAL
) {

97 i(
by_vue
 =
BINARY_ACTIVE
) {

98 
by_vue
 = 
BINARY_INACTIVE
;

100 
by_vue
 = 
BINARY_ACTIVE
;

103 i(
by_vue
 =
BINARY_ACTIVE
) {

104 
	`d_
(
i
);

106 
	`d_off
(
i
);

111 i(
	`tim_rv_exped
(&
DCC_Tim
)) {

112 
	`tim_rv_t
(&
DCC_Tim
);

113 
	`dcc_tim_cds
(
DCC_CYCLE_SECONDS
);

116 
pdu_n
 = 
	`dk_ive
(&
c
, &
PDUBufr
[0], (PDUBuffer), 0);

117 i(
pdu_n
) {

118 
	`du_hdr
(&
c
, &
PDUBufr
[0], 
pdu_n
);

120 
	}
}

	@ports/rx62n/bacnet.h

24 #ide
BACNET_H


25 
	#BACNET_H


	)

27 
	~<dt.h
>

29 #ifde
__lulus


33 
ba_
(

35 
ba_sk
(

38 #ifde
__lulus


	@ports/rx62n/bo.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

35 
	~"wp.h
"

36 
	~"hdwe.h
"

37 
	~"d.h
"

38 
	~"bo.h
"

39 
	~"hdrs.h
"

41 #ide
MAX_BINARY_OUTPUTS


42 
	#MAX_BINARY_OUTPUTS
 2

	)

47 
	#RELINQUISH_DEFAULT
 
BINARY_INACTIVE


	)

49 
ut8_t
 
	gBy_Ouut_Lev
[
MAX_BINARY_OUTPUTS
][
BACNET_MAX_PRIORITY
];

52 
ut8_t
 
	gOut_Of_Svi
[
MAX_BINARY_OUTPUTS
];

54 
ut8_t
 
	gPެy
[
MAX_BINARY_OUTPUTS
];

57 cڡ 
	gBy_Ouut_Prݔts_Requed
[] = {

58 
PROP_OBJECT_IDENTIFIER
,

59 
PROP_OBJECT_NAME
,

60 
PROP_OBJECT_TYPE
,

61 
PROP_PRESENT_VALUE
,

62 
PROP_STATUS_FLAGS
,

63 
PROP_EVENT_STATE
,

64 
PROP_OUT_OF_SERVICE
,

65 
PROP_POLARITY
,

66 
PROP_PRIORITY_ARRAY
,

67 
PROP_RELINQUISH_DEFAULT
,

71 cڡ 
	gBy_Ouut_Prݔts_Oiڮ
[] = {

72 
PROP_ACTIVE_TEXT
,

73 
PROP_INACTIVE_TEXT
,

77 cڡ 
	gBy_Ouut_Prݔts_Prrry
[] = {

81 
	$By_Ouut_Prݔty_Lis
(

82 cڡ **
pRequed
,

83 cڡ **
pOiڮ
,

84 cڡ **
pPrrry
)

86 i(
pRequed
)

87 *
pRequed
 = 
By_Ouut_Prݔts_Requed
;

88 i(
pOiڮ
)

89 *
pOiڮ
 = 
By_Ouut_Prݔts_Oiڮ
;

90 i(
pPrrry
)

91 *
pPrrry
 = 
By_Ouut_Prݔts_Prrry
;

94 
	}
}

97 
bo
 
	$By_Ouut_Vid_In
(

98 
ut32_t
 
obje_
)

100 i(
obje_
 < 
MAX_BINARY_OUTPUTS
)

101  
ue
;

103  
l
;

104 
	}
}

107 
	$By_Ouut_Cou
(

110  
MAX_BINARY_OUTPUTS
;

111 
	}
}

114 
ut32_t
 
	$By_Ouut_Index_To_In
(

115 
dex
)

117  
dex
;

118 
	}
}

121 
	$By_Ouut_In_To_Index
(

122 
ut32_t
 
obje_
)

124 
dex
 = 
MAX_BINARY_OUTPUTS
;

126 i(
obje_
 < 
MAX_BINARY_OUTPUTS
)

127 
dex
 = 
obje_
;

129  
dex
;

130 
	}
}

132 
BACNET_BINARY_PV
 
	$P_Vue
(

133 
dex
)

135 
BACNET_BINARY_PV
 
vue
 = 
RELINQUISH_DEFAULT
;

136 
BACNET_BINARY_PV
 
cut_vue
 = 
RELINQUISH_DEFAULT
;

137 
i
 = 0;

139 i(
dex
 < 
MAX_BINARY_OUTPUTS
) {

140 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

141 
cut_vue
 = (
BACNET_BINARY_PV

By_Ouut_Lev
[
dex
][
i
];

142 i(
cut_vue
 !
BINARY_NULL
) {

143 
vue
 = (
BACNET_BINARY_PV

By_Ouut_Lev
[
dex
][
i
];

149  
vue
;

150 
	}
}

152 
BACNET_BINARY_PV
 
	$By_Ouut_P_Vue
(

153 
ut32_t
 
obje_
)

155 
dex
 = 0;

157 
dex
 = 
	`By_Ouut_In_To_Index
(
obje_
);

159  
	`P_Vue
(
dex
);

160 
	}
}

162 
bo
 
	$By_Ouut_P_Vue_S
(

163 
ut32_t
 

,

164 
BACNET_BINARY_PV
 
by_vue
,

165 
iܙy
)

167 
bo
 
us
 = 
l
;

169 i(

 < 
MAX_BINARY_OUTPUTS
) {

170 i(
iܙy
 < 
BACNET_MAX_PRIORITY
) {

171 
By_Ouut_Lev
[

][
iܙy
] = (
ut8_t

by_vue
;

172 
us
 = 
ue
;

176  
us
;

177 
	}
}

179 
bo
 
	$By_Ouut_Pެy_S
(

180 
ut32_t
 

,

181 
BACNET_POLARITY
 
pެy
)

183 
bo
 
us
 = 
l
;

185 i(

 < 
MAX_BINARY_OUTPUTS
) {

186 i(
pެy
 < 
MAX_POLARITY
) {

187 
Pެy
[

] = 
pެy
;

188 
us
 = 
ue
;

192  
us
;

193 
	}
}

195 
BACNET_POLARITY
 
	$By_Ouut_Pެy
(

196 
ut32_t
 

)

198 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

200 i(

 < 
MAX_BINARY_OUTPUTS
) {

201 
pެy
 = (
BACNET_POLARITY

Pެy
[

];

204  
pެy
;

205 
	}
}

207 
	$By_Ouut_Out_Of_Svi_S
(

208 
ut32_t
 

,

209 
bo
 
ag
)

211 i(

 < 
MAX_BINARY_OUTPUTS
) {

212 
Out_Of_Svi
[

] = 
ag
;

214 
	}
}

216 
bo
 
	$By_Ouut_Out_Of_Svi
(

217 
ut32_t
 

)

219 
bo
 
ag
 = 
l
;

221 i(

 < 
MAX_BINARY_OUTPUTS
) {

222 
ag
 = 
Out_Of_Svi
[

];

225  
ag
;

226 
	}
}

229 *
	$By_Ouut_Name
(

230 
ut32_t
 
obje_
)

232 
xt_rg
[32];

234 i(
obje_
 < 
MAX_BINARY_OUTPUTS
) {

235 
	`rtf
(
xt_rg
, "BO-%lu", 
obje_
);

236  
xt_rg
;

239  
NULL
;

240 
	}
}

243 
	$By_Ouut_Rd_Prݔty
(

244 
BACNET_READ_PROPERTY_DATA
 * 
da
)

246 
n
 = 0;

247 
du_n
 = 0;

248 
BACNET_BIT_STRING
 
b_rg
;

249 
BACNET_CHARACTER_STRING
 
ch_rg
;

250 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

251 
obje_dex
 = 0;

252 
i
 = 0;

253 
bo
 
e
 = 
l
;

254 
ut8_t
 *
du
 = 
NULL
;

256 i((
da
->
iti_da
 =
NULL
) ||

257 (
da
->
iti_da_n
 == 0)) {

260 
du
 = 
da
->
iti_da
;

261 
da
->
obje_ݔty
) {

263 
PROP_PRESENT_VALUE
:

264 
e_vue
 =

265 
	`By_Ouut_P_Vue
(
da
->
obje_
);

266 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

268 
PROP_STATUS_FLAGS
:

270 
	`brg_
(&
b_rg
);

271 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

272 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

273 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

274 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

275 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

277 
PROP_EVENT_STATE
:

279 
du_n
 =

280 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

282 
PROP_OUT_OF_SERVICE
:

283 
obje_dex
 =

284 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

285 
e
 = 
Out_Of_Svi
[
obje_dex
];

286 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

288 
PROP_POLARITY
:

289 
obje_dex
 =

290 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

291 
du_n
 =

292 
	`code_iti_umed
(&
du
[0],

293 
Pެy
[
obje_dex
]);

295 
PROP_PRIORITY_ARRAY
:

297 i(
da
->
y_dex
 == 0)

298 
du_n
 =

299 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

302 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

303 
obje_dex
 =

304 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

305 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

307 
e_vue
 = (
BACNET_BINARY_PV
)

308 
By_Ouut_Lev
[
obje_dex
][
i
];

309 i(
e_vue
 =
BINARY_NULL
) {

310 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

312 
n
 =

313 
	`code_iti_umed
(&
du
[
du_n
],

314 
e_vue
);

317 i((
du_n
 + 
n
< 
MAX_APDU
)

318 
du_n
 +
n
;

320 
da
->
r_code
 =

321 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

322 
du_n
 = 
BACNET_STATUS_ABORT
;

327 
obje_dex
 =

328 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

329 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

330 
e_vue
 = (
BACNET_BINARY_PV
)

331 
By_Ouut_Lev
[
obje_dex
][
da
->
y_dex
 -

333 i(
e_vue
 =
BINARY_NULL
) {

334 
du_n
 = 
	`code_iti_nu
(&
du
[apdu_len]);

336 
du_n
 =

337 
	`code_iti_umed
(&
du
[
du_n
],

338 
e_vue
);

341 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

342 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

343 
du_n
 = 
BACNET_STATUS_ERROR
;

347 
PROP_RELINQUISH_DEFAULT
:

348 
e_vue
 = 
RELINQUISH_DEFAULT
;

349 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

351 
PROP_ACTIVE_TEXT
:

352 
	`charg__si
(&
ch_rg
, "on");

353 
du_n
 =

354 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

356 
PROP_INACTIVE_TEXT
:

357 
	`charg__si
(&
ch_rg
, "off");

358 
du_n
 =

359 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

362 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

363 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

364 
du_n
 = 
BACNET_STATUS_ERROR
;

368 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

369 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

370 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

371 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

372 
du_n
 = 
BACNET_STATUS_ERROR
;

375  
du_n
;

376 
	}
}

379 
bo
 
	$By_Ouut_Wre_Prݔty
(

380 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

382 
bo
 
us
 = 
l
;

383 
iܙy
 = 0;

384 
BACNET_BINARY_PV
 
v
 = 
BINARY_NULL
;

385 
n
 = 0;

386 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

389 
n
 =

390 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

391 
wp_da
->
iti_da_n
, &
vue
);

393 i(
n
 < 0) {

395 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

396 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

397  
l
;

399 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

400 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

402 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

403 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

404  
l
;

406 
wp_da
->
obje_ݔty
) {

407 
PROP_PRESENT_VALUE
:

408 
us
 =

409 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

410 &
wp_da
->
r_ass
, &wp_da->
r_code
);

411 i(
us
) {

412 
iܙy
 = 
wp_da
->priority;

416 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

417 (
iܙy
 != 6 ) &&

418 (
vue
.
ty
.
Enumed
 <
MAX_BINARY_PV
)) {

419 
v
 = (
BACNET_BINARY_PV

vue
.
ty
.
Enumed
;

420 
iܙy
--;

421 
	`By_Ouut_P_Vue_S
(
wp_da
->
obje_
,

422 
v
, 
iܙy
);

423 } i(
iܙy
 == 6) {

427 
us
 = 
l
;

428 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

429 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

431 
us
 = 
l
;

432 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

433 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

436 
us
 =

437 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_NULL
,

438 &
wp_da
->
r_ass
, &wp_da->
r_code
);

439 i(
us
) {

440 
v
 = 
BINARY_NULL
;

441 
iܙy
 = 
wp_da
->priority;

442 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

443 
iܙy
--;

444 
By_Ouut_P_Vue_S


445 (
wp_da
->
obje_
, 
v
, 
iܙy
);

446 } i(
iܙy
 == 6) {

447 
us
 = 
l
;

451 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

452 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

454 
us
 = 
l
;

455 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

456 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

461 
PROP_OUT_OF_SERVICE
:

462 
us
 =

463 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

464 &
wp_da
->
r_ass
, &wp_da->
r_code
);

465 i(
us
) {

466 
	`By_Ouut_Out_Of_Svi_S
(
wp_da
->
obje_
,

467 
vue
.
ty
.
Boޗn
);

470 
PROP_POLARITY
:

471 
us
 =

472 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

473 &
wp_da
->
r_ass
, &wp_da->
r_code
);

474 i(
us
) {

475 i(
vue
.
ty
.
Enumed
 < 
MAX_POLARITY
) {

476 
	`By_Ouut_Pެy_S
(
wp_da
->
obje_
,

477 (
BACNET_POLARITY

vue
.
ty
.
Enumed
);

479 
us
 = 
l
;

480 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

481 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

485 
PROP_OBJECT_IDENTIFIER
:

486 
PROP_OBJECT_NAME
:

487 
PROP_OBJECT_TYPE
:

488 
PROP_STATUS_FLAGS
:

489 
PROP_RELIABILITY
:

490 
PROP_EVENT_STATE
:

491 
PROP_POLARITY
:

492 
PROP_PRIORITY_ARRAY
:

493 
PROP_RELINQUISH_DEFAULT
:

494 
PROP_ACTIVE_TEXT
:

495 
PROP_INACTIVE_TEXT
:

496 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

497 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

500 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

501 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

505 
n
 =en;

507  
us
;

508 
	}
}

510 
	$By_Ouut_In
(

513 
i
, 
j
;

516 
i
 = 0; i < 
MAX_BINARY_OUTPUTS
; i++) {

517 
	`By_Ouut_Pެy_S
(
i
, 
POLARITY_NORMAL
);

518 
	`By_Ouut_Out_Of_Svi_S
(
i
, 
l
);

519 
j
 = 0; j < 
BACNET_MAX_PRIORITY
; j++) {

520 
	`By_Ouut_P_Vue_S
(
i
, 
BINARY_NULL
, 
j
);

525 
	}
}

	@ports/rx62n/device.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<rg.h
>

29 
	~"bacdef.h
"

30 
	~"bacdcode.h
"

31 
	~"bacr.h
"

32 
	~"banum.h
"

33 
	~"ba.h
"

34 
	~"cfig.h
"

35 
	~"du.h
"

36 
	~"wp.h
"

37 
	~".h
"

38 
	~"dcc.h
"

39 
	~"vsi.h
"

40 
	~"devi.h
"

41 
	~"hdrs.h
"

42 
	~"dk.h
"

43 
	~"addss.h
"

45 
	~"tim.h
"

47 
	~"devi.h
"

48 
	~"bo.h
"

51 
Devi_Rd_Prݔty_Lol
(

52 
BACNET_READ_PROPERTY_DATA
 * 
da
);

53 
bo
 
Devi_Wre_Prݔty_Lol
(

54 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

56 
	smy_obje_funis
 {

57 
BACNET_OBJECT_TYPE
 
	mObje_Ty
;

58 
obje__funi
 
	mObje_In
;

59 
obje_cou_funi
 
	mObje_Cou
;

60 
obje_dex_to__funi
 
	mObje_Index_To_In
;

61 
obje_vid__funi
 
	mObje_Vid_In
;

62 
obje_me_funi
 
	mObje_Name
;

63 
ad_ݔty_funi
 
	mObje_Rd_Prݔty
;

64 
wre_ݔty_funi
 
	mObje_Wre_Prݔty
;

65 
m_ݔty_lis_funi
 
	mObje_RPM_Li
;

66 } 
	gObje_Tab
[] = {

68 
OBJECT_DEVICE
, 
NULL
,

69 
Devi_Cou
, 
Devi_Index_To_In
,

70 
Devi_Vid_Obje_In_Numb
, 
Devi_Name
,

71 
Devi_Rd_Prݔty_Lol
, 
Devi_Wre_Prݔty_Lol
,

72 
Devi_Prݔty_Lis
}, {

73 
OBJECT_BINARY_OUTPUT
, 
By_Ouut_In
, 
By_Ouut_Cou
,

74 
By_Ouut_Index_To_In
, 
By_Ouut_Vid_In
,

75 
By_Ouut_Name
, 
By_Ouut_Rd_Prݔty
,

76 
By_Ouut_Wre_Prݔty
, 
By_Ouut_Prݔty_Lis
}, {

77 
MAX_BACNET_OBJECT_TYPE
, 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL}

84 
ut32_t
 
	gObje_In_Numb
 = 12345;

85 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

86 
BACNET_REINITIALIZED_STATE
 
	gRelize_S
 = 
BACNET_REINIT_IDLE
;

87 cڡ *
	gRe_Passwd
 = "filister";

88 
	gMy_Obje_Name
[
MAX_DEV_NAME_LEN
 + 1] = "SimpleServer";

89 
	gMod_Name
[
MAX_DEV_MOD_LEN
 + 1] = "RX62N";

90 
	gAliti_Sowe_Vsi
[
MAX_DEV_VER_LEN
 + 1] = "1.0";

91 
	gLoti
[
MAX_DEV_LOC_LEN
 + 1] = "USA";

92 
	gDesti
[
MAX_DEV_DESC_LEN
 + 1] = "Renesas Rulz!";

93 
ut32_t
 
	gDaba_Revisi
 = 0;

96 cڡ 
	gDevi_Prݔts_Requed
[] = {

97 
PROP_OBJECT_IDENTIFIER
,

98 
PROP_OBJECT_NAME
,

99 
PROP_OBJECT_TYPE
,

100 
PROP_SYSTEM_STATUS
,

101 
PROP_VENDOR_NAME
,

102 
PROP_VENDOR_IDENTIFIER
,

103 
PROP_MODEL_NAME
,

104 
PROP_FIRMWARE_REVISION
,

105 
PROP_APPLICATION_SOFTWARE_VERSION
,

106 
PROP_PROTOCOL_VERSION
,

107 
PROP_PROTOCOL_REVISION
,

108 
PROP_PROTOCOL_SERVICES_SUPPORTED
,

109 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

110 
PROP_OBJECT_LIST
,

111 
PROP_MAX_APDU_LENGTH_ACCEPTED
,

112 
PROP_SEGMENTATION_SUPPORTED
,

113 
PROP_APDU_TIMEOUT
,

114 
PROP_NUMBER_OF_APDU_RETRIES
,

115 
PROP_MAX_MASTER
,

116 
PROP_MAX_INFO_FRAMES
,

117 
PROP_DEVICE_ADDRESS_BINDING
,

118 
PROP_DATABASE_REVISION
,

122 cڡ 
	gDevi_Prݔts_Oiڮ
[] = {

123 
PROP_DESCRIPTION
,

127 cڡ 
	gDevi_Prݔts_Prrry
[] = {

131 
my_obje_funis
 *
	$Devi_Objes_Fd_Funis
(

132 
BACNET_OBJECT_TYPE
 
Obje_Ty
)

134 
my_obje_funis
 *
pObje
 = 
NULL
;

136 
pObje
 = &
Obje_Tab
[0];

137 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

139 i(
pObje
->
Obje_Ty
 == Object_Type) {

140  (
pObje
);

143 
pObje
++;

146  (
NULL
);

147 
	}
}

149 
	$Rd_Prݔty_Comm
(

150 
my_obje_funis
 *
pObje
,

151 
BACNET_READ_PROPERTY_DATA
 * 
da
)

153 
du_n
 = 
BACNET_STATUS_ERROR
;

154 
BACNET_CHARACTER_STRING
 
ch_rg
;

155 *
pSg
 = "";

156 
ut8_t
 *
du
 = 
NULL
;

158 i((
da
->
iti_da
 =
NULL
) ||

159 (
da
->
iti_da_n
 == 0)) {

162 
du
 = 
da
->
iti_da
;

163 
da
->
obje_ݔty
) {

164 
PROP_OBJECT_IDENTIFIER
:

167 i(
da
->
obje_ty
 =
OBJECT_DEVICE
) {

168 
da
->
obje_
 = 
Obje_In_Numb
;

170 
du_n
 =

171 
	`code_iti_obje_id
(&
du
[0], 
da
->
obje_ty
,

172 
da
->
obje_
);

174 
PROP_OBJECT_NAME
:

175 i(
pObje
->
Obje_Name
) {

176 
pSg
 = 
pObje
->
	`Obje_Name
(
da
->
obje_
);

178 
	`charg__si
(&
ch_rg
, 
pSg
);

179 
du_n
 =

180 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

182 
PROP_OBJECT_TYPE
:

183 
du_n
 =

184 
	`code_iti_umed
(&
du
[0], 
da
->
obje_ty
);

187 i(
pObje
->
Obje_Rd_Prݔty
) {

188 
du_n
 = 
pObje
->
	`Obje_Rd_Prݔty
(
da
);

193  
du_n
;

194 
	}
}

196 
	$ݔty_li_cou
(

197 cڡ *
pLi
)

199 
ݔty_cou
 = 0;

201 i(
pLi
) {

202 *
pLi
 != -1) {

203 
ݔty_cou
++;

204 
pLi
++;

208  
ݔty_cou
;

209 
	}
}

222 
	$Devi_Objes_Prݔty_Li
(

223 
BACNET_OBJECT_TYPE
 
obje_ty
,

224 
ecl_ݔty_li_t
 *
pPrݔtyLi
)

226 
my_obje_funis
 *
pObje
 = 
NULL
;

228 
pPrݔtyLi
->
Requed
.
pLi
 = 
NULL
;

229 
pPrݔtyLi
->
Oiڮ
.
pLi
 = 
NULL
;

230 
pPrݔtyLi
->
Prrry
.
pLi
 = 
NULL
;

237 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

238 i((
pObje
 !
NULL
&& (pObje->
Obje_RPM_Li
 != NULL)) {

239 
pObje
->
	`Obje_RPM_Li
(&
pPrݔtyLi
->
Requed
.
pLi
,

240 &
pPrݔtyLi
->
Oiڮ
.
pLi
, &pPrݔtyLi->
Prrry
.pList);

244 
pPrݔtyLi
->
Requed
.
cou
 =

245 
pPrݔtyLi
->
Requed
.
pLi
 ==

246 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Requed
.
pLi
);

248 
pPrݔtyLi
->
Oiڮ
.
cou
 =

249 
pPrݔtyLi
->
Oiڮ
.
pLi
 ==

250 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Oiڮ
.
pLi
);

252 
pPrݔtyLi
->
Prrry
.
cou
 =

253 
pPrݔtyLi
->
Prrry
.
pLi
 ==

254 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Prrry
.
pLi
);

257 
	}
}

259 
	$Devi_Prݔty_Lis
(

260 cڡ **
pRequed
,

261 cڡ **
pOiڮ
,

262 cڡ **
pPrrry
)

264 i(
pRequed
)

265 *
pRequed
 = 
Devi_Prݔts_Requed
;

266 i(
pOiڮ
)

267 *
pOiڮ
 = 
Devi_Prݔts_Oiڮ
;

268 i(
pPrrry
)

269 *
pPrrry
 = 
Devi_Prݔts_Prrry
;

272 
	}
}

274 
	$Devi_Cou
(

278 
	}
}

280 
ut32_t
 
	$Devi_Index_To_In
(

281 
dex
)

283 
dex
 = index;

284  
Obje_In_Numb
;

285 
	}
}

287 
bo
 
	$Devi_Relize
(

288 
BACNET_REINITIALIZE_DEVICE_DATA
 * 
rd_da
)

290 
bo
 
us
 = 
l
;

293 i(
	`charg_si_me
(&
rd_da
->
sswd
, 
Re_Passwd
)) {

294 
rd_da
->
e
) {

295 
BACNET_REINIT_COLDSTART
:

296 
BACNET_REINIT_WARMSTART
:

297 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

301 
Relize_S
 = 
rd_da
->
e
;

302 
us
 = 
ue
;

304 
BACNET_REINIT_STARTBACKUP
:

305 
BACNET_REINIT_ENDBACKUP
:

306 
BACNET_REINIT_STARTRESTORE
:

307 
BACNET_REINIT_ENDRESTORE
:

308 
BACNET_REINIT_ABORTRESTORE
:

309 i(
	`dcc_communiti_dibd
()) {

310 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

311 
rd_da
->
r_code
 = 
ERROR_CODE_COMMUNICATION_DISABLED
;

313 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

314 
rd_da
->
r_code
 =

315 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

319 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

320 
rd_da
->
r_code
 = 
ERROR_CODE_PARAMETER_OUT_OF_RANGE
;

324 
rd_da
->
r_ass
 = 
ERROR_CLASS_SECURITY
;

325 
rd_da
->
r_code
 = 
ERROR_CODE_PASSWORD_FAILURE
;

328  
us
;

329 
	}
}

331 
BACNET_REINITIALIZED_STATE
 
	$Devi_Relized_S
(

334  
Relize_S
;

335 
	}
}

338 
ut32_t
 
	$Devi_Obje_In_Numb
(

341  
Obje_In_Numb
;

342 
	}
}

344 
bo
 
	$Devi_S_Obje_In_Numb
(

345 
ut32_t
 
obje_id
)

347 
bo
 
us
 = 
ue
;

349 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

350 
Obje_In_Numb
 = 
obje_id
;

352 
us
 = 
l
;

354  
us
;

355 
	}
}

357 
bo
 
	$Devi_Vid_Obje_In_Numb
(

358 
ut32_t
 
obje_id
)

360  (
Obje_In_Numb
 =
obje_id
);

361 
	}
}

363 *
	$Devi_Name
(

364 
ut32_t
 
obje_
)

366 i(
obje_
 =
Obje_In_Numb
) {

367  
My_Obje_Name
;

370  
NULL
;

371 
	}
}

373 cڡ *
	$Devi_Obje_Name
(

376  
My_Obje_Name
;

377 
	}
}

379 
bo
 
	$Devi_S_Obje_Name
(

380 cڡ *
me
,

381 
size_t
 
ngth
)

383 
bo
 
us
 = 
l
;

388 i(
ngth
 < (
My_Obje_Name
)) {

390 
	`memmove
(
My_Obje_Name
, 
me
, 
ngth
);

391 
My_Obje_Name
[
ngth
] = 0;

392 
	`Devi_Inc_Daba_Revisi
();

393 
us
 = 
ue
;

396  
us
;

397 
	}
}

399 
BACNET_DEVICE_STATUS
 
	$Devi_Syem_Stus
(

402  
Syem_Stus
;

403 
	}
}

405 
	$Devi_S_Syem_Stus
(

406 
BACNET_DEVICE_STATUS
 
us
,

407 
bo
 
lol
)

410 
su
 = -1;

412 i(
us
 < 
MAX_DEVICE_STATUS
) {

413 
Syem_Stus
 = 
us
;

414 
su
 = 0;

417  
su
;

418 
	}
}

420 cڡ *
	$Devi_Desti
(

423  
Desti
;

424 
	}
}

426 
bo
 
	$Devi_S_Desti
(

427 cڡ *
me
,

428 
size_t
 
ngth
)

430 
bo
 
us
 = 
l
;

432 i(
ngth
 < (
Desti
)) {

433 
	`memmove
(
Desti
, 
me
, 
ngth
);

434 
Desti
[
ngth
] = 0;

435 
us
 = 
ue
;

438  
us
;

439 
	}
}

441 cڡ *
	$Devi_Loti
(

444  
Loti
;

445 
	}
}

447 
bo
 
	$Devi_S_Loti
(

448 cڡ *
me
,

449 
size_t
 
ngth
)

451 
bo
 
us
 = 
l
;

453 i(
ngth
 < (
Loti
)) {

454 
	`memmove
(
Loti
, 
me
, 
ngth
);

455 
Loti
[
ngth
] = 0;

456 
us
 = 
ue
;

459  
us
;

460 
	}
}

462 
ut8_t
 
	$Devi_Proc_Vsi
(

465  
BACNET_PROTOCOL_VERSION
;

466 
	}
}

468 
ut8_t
 
	$Devi_Proc_Revisi
(

471  
BACNET_PROTOCOL_REVISION
;

472 
	}
}

474 
ut16_t
 
	$Devi_Vd_Idtifr
(

477  
BACNET_VENDOR_ID
;

478 
	}
}

480 
BACNET_SEGMENTATION
 
	$Devi_Segmti_Su܋d
(

483  
SEGMENTATION_NONE
;

484 
	}
}

486 
ut32_t
 
	$Devi_Daba_Revisi
(

489  
Daba_Revisi
;

490 
	}
}

492 
	$Devi_Inc_Daba_Revisi
(

495 
Daba_Revisi
++;

496 
	}
}

500 
	$Devi_Obje_Li_Cou
(

503 
cou
 = 0;

504 
my_obje_funis
 *
pObje
 = 
NULL
;

507 
pObje
 = &
Obje_Tab
[0];

508 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

509 i(
pObje
->
Obje_Cou
) {

510 
cou
 +
pObje
->
	`Obje_Cou
();

512 
pObje
++;

515  
cou
;

516 
	}
}

518 
bo
 
	$Devi_Obje_Li_Idtifr
(

519 
ut32_t
 
y_dex
,

520 *
obje_ty
,

521 
ut32_t
 * 

)

523 
bo
 
us
 = 
l
;

524 
ut32_t
 
cou
 = 0;

525 
ut32_t
 
obje_dex
 = 0;

526 
my_obje_funis
 *
pObje
 = 
NULL
;

529 i(
y_dex
 == 0) {

530  
us
;

532 
obje_dex
 = 
y_dex
 - 1;

534 
pObje
 = &
Obje_Tab
[0];

535 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

536 i(
pObje
->
Obje_Cou
 &&Obje->
Obje_Index_To_In
) {

537 
obje_dex
 -
cou
;

538 
cou
 = 
pObje
->
	`Obje_Cou
();

539 i(
obje_dex
 < 
cou
) {

540 *
obje_ty
 = 
pObje
->
Obje_Ty
;

541 *

 = 
pObje
->
	`Obje_Index_To_In
(
obje_dex
);

542 
us
 = 
ue
;

546 
pObje
++;

549  
us
;

550 
	}
}

560 
bo
 
	$Devi_Vid_Obje_Name
(

561 cڡ *
obje_me
,

562 *
obje_ty
,

563 
ut32_t
 * 
obje_
)

565 
bo
 
found
 = 
l
;

566 
ty
 = 0;

567 
ut32_t
 

;

568 
ut32_t
 
max_objes
 = 0, 
i
 = 0;

569 
bo
 
check_id
 = 
l
;

570 *
me
 = 
NULL
;

572 
max_objes
 = 
	`Devi_Obje_Li_Cou
();

573 
i
 = 1; i <
max_objes
; i++) {

574 
check_id
 = 
	`Devi_Obje_Li_Idtifr
(
i
, &
ty
, &

);

575 i(
check_id
) {

576 
me
 = 
	`Devi_Vid_Obje_Id
(
ty
, 

);

577 i(
	`rcmp
(
me
, 
obje_me
) == 0) {

578 
found
 = 
ue
;

579 i(
obje_ty
) {

580 *
obje_ty
 = 
ty
;

582 i(
obje_
) {

583 *
obje_
 = 

;

590  
found
;

591 
	}
}

594 *
	$Devi_Vid_Obje_Id
(

595 
obje_ty
,

596 
ut32_t
 
obje_
)

598 *
me
 = 
NULL
;

599 
my_obje_funis
 *
pObje
 = 
NULL
;

601 
pObje
 = 
	`Devi_Objes_Fd_Funis
((
BACNET_OBJECT_TYPE

obje_ty
);

602 i((
pObje
&& (pObje->
Obje_Name
)) {

603 
me
 = 
pObje
->
	`Obje_Name
(
obje_
);

606  
me
;

607 
	}
}

610 
	$Devi_Rd_Prݔty_Lol
(

611 
BACNET_READ_PROPERTY_DATA
 * 
da
)

613 
du_n
 = 0;

614 
n
 = 0;

615 
BACNET_BIT_STRING
 
b_rg
;

616 
BACNET_CHARACTER_STRING
 
ch_rg
;

617 
ut32_t
 
i
 = 0;

618 
obje_ty
 = 0;

619 
ut32_t
 

 = 0;

620 
ut32_t
 
cou
 = 0;

621 
ut8_t
 *
du
 = 
NULL
;

622 
my_obje_funis
 *
pObje
 = 
NULL
;

623 
bo
 
found
 = 
l
;

625 i((
da
->
iti_da
 =
NULL
) ||

626 (
da
->
iti_da_n
 == 0)) {

629 
du
 = 
da
->
iti_da
;

630 
da
->
obje_ݔty
) {

631 
PROP_DESCRIPTION
:

632 
	`charg__si
(&
ch_rg
, 
Desti
);

633 
du_n
 =

634 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

636 
PROP_SYSTEM_STATUS
:

637 
du_n
 =

638 
	`code_iti_umed
(&
du
[0],

639 
	`Devi_Syem_Stus
());

641 
PROP_VENDOR_NAME
:

642 
	`charg__si
(&
ch_rg
, 
BACNET_VENDOR_NAME
);

643 
du_n
 =

644 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

646 
PROP_VENDOR_IDENTIFIER
:

647 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
BACNET_VENDOR_ID
);

649 
PROP_MODEL_NAME
:

650 
	`charg__si
(&
ch_rg
, 
Mod_Name
);

651 
du_n
 =

652 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

654 
PROP_FIRMWARE_REVISION
:

655 
	`charg__si
(&
ch_rg
, 
BACt_Vsi
);

656 
du_n
 =

657 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

659 
PROP_APPLICATION_SOFTWARE_VERSION
:

660 
	`charg__si
(&
ch_rg
,

661 
Aliti_Sowe_Vsi
);

662 
du_n
 =

663 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

665 
PROP_LOCATION
:

666 
	`charg__si
(&
ch_rg
, 
Loti
);

667 
du_n
 =

668 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

670 
PROP_PROTOCOL_VERSION
:

671 
du_n
 =

672 
	`code_iti_unsigd
(&
du
[0], 
BACNET_PROTOCOL_VERSION
);

674 
PROP_PROTOCOL_REVISION
:

675 
du_n
 =

676 
	`code_iti_unsigd
(&
du
[0],

677 
BACNET_PROTOCOL_REVISION
);

679 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

681 
	`brg_
(&
b_rg
);

682 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

684 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

685 
	`du_rvi_su܋d
((
BACNET_SERVICES_SUPPORTED

i
));

687 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

689 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

692 
	`brg_
(&
b_rg
);

693 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

696 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

699 
i
 = 0;

700 
pObje
 = &
Obje_Tab
[
i
];

701 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

702 i((
pObje
->
Obje_Cou
&& (pObje->
	`Obje_Cou
() > 0)) {

703 
	`brg_t_b
(&
b_rg
, 
pObje
->
Obje_Ty
, 
ue
);

705 
pObje
++;

707 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

709 
PROP_OBJECT_LIST
:

710 
cou
 = 
	`Devi_Obje_Li_Cou
();

712 i(
da
->
y_dex
 == 0)

713 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

718 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

719 
i
 = 1; i <
cou
; i++) {

720 i(
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
,

721 &

)) {

722 
n
 =

723 
	`code_iti_obje_id
(&
du
[
du_n
],

724 
obje_ty
, 

);

725 
du_n
 +
n
;

728 i((
du_n
 + 
n
>
MAX_APDU
) {

730 
da
->
r_code
 =

731 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

732 
du_n
 = 
BACNET_STATUS_ABORT
;

737 
da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

738 
da
->
r_code
 = 
ERROR_CODE_OTHER
;

739 
du_n
 = 
BACNET_STATUS_ERROR
;

744 
found
 =

745 
	`Devi_Obje_Li_Idtifr
(
da
->
y_dex
,

746 &
obje_ty
, &

);

747 i(
found
) {

748 
du_n
 =

749 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

750 

);

752 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

753 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

754 
du_n
 = 
BACNET_STATUS_ERROR
;

758 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

759 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

761 
PROP_SEGMENTATION_SUPPORTED
:

762 
du_n
 =

763 
	`code_iti_umed
(&
du
[0],

764 
	`Devi_Segmti_Su܋d
());

766 
PROP_APDU_TIMEOUT
:

767 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_timeout
());

769 
PROP_NUMBER_OF_APDU_RETRIES
:

770 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_s
());

772 
PROP_DEVICE_ADDRESS_BINDING
:

775 
PROP_DATABASE_REVISION
:

776 
du_n
 =

777 
	`code_iti_unsigd
(&
du
[0], 
Daba_Revisi
);

780 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

781 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

782 
du_n
 = 
BACNET_STATUS_ERROR
;

786 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

787 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

788 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

789 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

790 
du_n
 = 
BACNET_STATUS_ERROR
;

793  
du_n
;

794 
	}
}

804 
	$Devi_Rd_Prݔty
(

805 
BACNET_READ_PROPERTY_DATA
 * 
da
)

807 
du_n
 = 
BACNET_STATUS_ERROR
;

808 
my_obje_funis
 *
pObje
 = 
NULL
;

811 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

812 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

813 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
da
->
obje_ty
);

814 i(
pObje
) {

815 i(
pObje
->
Obje_Vid_In
 &&

816 
pObje
->
	`Obje_Vid_In
(
da
->
obje_
)) {

817 
du_n
 = 
	`Rd_Prݔty_Comm
(
pObje
, 
da
);

819 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

820 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

823 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

824 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

827  
du_n
;

828 
	}
}

831 
bo
 
	$Devi_Wre_Prݔty_Lol
(

832 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

834 
bo
 
us
 = 
l
;

835 
n
 = 0;

836 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

837 
mp
;

840 
n
 =

841 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

842 
wp_da
->
iti_da_n
, &
vue
);

844 i(
n
 < 0) {

846 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

847 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

848  
l
;

850 i((
wp_da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

851 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

853 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

854 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

855  
l
;

857 
wp_da
->
obje_ݔty
) {

858 
PROP_OBJECT_IDENTIFIER
:

859 
us
 =

860 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_OBJECT_ID
,

861 &
wp_da
->
r_ass
, &wp_da->
r_code
);

862 i(
us
) {

863 i((
vue
.
ty
.
Obje_Id
.ty =
OBJECT_DEVICE
) &&

864 (
	`Devi_S_Obje_In_Numb
(
vue
.
ty
.

865 
Obje_Id
.

))) {

867 
us
 = 
ue
;

869 
us
 = 
l
;

870 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

871 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

875 
PROP_SYSTEM_STATUS
:

876 
us
 =

877 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

878 &
wp_da
->
r_ass
, &wp_da->
r_code
);

879 i(
us
) {

880 
mp
 = 
	`Devi_S_Syem_Stus
((
BACNET_DEVICE_STATUS
)

881 
vue
.
ty
.
Enumed
, 
l
);

882 i(
mp
 != 0) {

883 
us
 = 
l
;

884 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

885 i(
mp
 == -1) {

886 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

888 
wp_da
->
r_code
 =

889 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

894 
PROP_OBJECT_NAME
:

895 
us
 =

896 
	`WPVideSg
(&
vue
, 
MAX_DEV_NAME_LEN
, 
l
,

897 &
wp_da
->
r_ass
, &wp_da->
r_code
);

898 i(
us
) {

899 
	`Devi_S_Obje_Name
(
	`charg_vue
(&
vue
.

900 
ty
.
Cha_Sg
),

901 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

904 
PROP_LOCATION
:

905 
us
 =

906 
	`WPVideSg
(&
vue
, 
MAX_DEV_LOC_LEN
, 
ue
,

907 &
wp_da
->
r_ass
, &wp_da->
r_code
);

908 i(
us
) {

909 
	`Devi_S_Loti
(
	`charg_vue
(&
vue
.

910 
ty
.
Cha_Sg
),

911 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

915 
PROP_DESCRIPTION
:

916 
us
 =

917 
	`WPVideSg
(&
vue
, 
MAX_DEV_DESC_LEN
, 
ue
,

918 &
wp_da
->
r_ass
, &wp_da->
r_code
);

919 i(
us
) {

920 
	`Devi_S_Desti
(
	`charg_vue
(&
vue
.

921 
ty
.
Cha_Sg
),

922 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
));

925 
PROP_OBJECT_TYPE
:

926 
PROP_VENDOR_NAME
:

927 
PROP_VENDOR_IDENTIFIER
:

928 
PROP_MODEL_NAME
:

929 
PROP_FIRMWARE_REVISION
:

930 
PROP_APPLICATION_SOFTWARE_VERSION
:

931 
PROP_PROTOCOL_VERSION
:

932 
PROP_PROTOCOL_REVISION
:

933 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

934 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

935 
PROP_OBJECT_LIST
:

936 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

937 
PROP_SEGMENTATION_SUPPORTED
:

938 
PROP_DEVICE_ADDRESS_BINDING
:

939 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

940 
PROP_DATABASE_REVISION
:

941 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

942 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

945 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

946 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

950 
n
 =en;

952  
us
;

953 
	}
}

964 
bo
 
	$Devi_Wre_Prݔty
(

965 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

967 
bo
 
us
 = 
l
;

968 
my_obje_funis
 *
pObje
 = 
NULL
;

971 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

972 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

973 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
wp_da
->
obje_ty
);

974 i(
pObje
 !
NULL
) {

975 i(
pObje
->
Obje_Vid_In
 &&

976 
pObje
->
	`Obje_Vid_In
(
wp_da
->
obje_
)) {

977 i(
pObje
->
Obje_Wre_Prݔty
) {

978 
us
 = 
pObje
->
	`Obje_Wre_Prݔty
(
wp_da
);

980 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

981 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

984 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

985 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

988 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

989 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

992  
us
;

993 
	}
}

998 
	$Devi_In
(

999 
obje_funis_t
 * 
obje_b
)

1001 
my_obje_funis
 *
pObje
 = 
NULL
;

1004 (
obje_b
;

1005 
pObje
 = &
Obje_Tab
[0];

1006 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

1007 i(
pObje
->
Obje_In
) {

1008 
pObje
->
	`Obje_In
();

1010 
pObje
++;

1012 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

1013 
	}
}

	@ports/rx62n/ethernet.c

25 
	~<dt.h
>

26 
	~<dbo.h
>

27 
	~"bacdef.h
"

28 
	~"ht.h
"

29 
	~"bact.h
"

30 
	~"hdwe.h
"

36 
ut8_t
 
	gEtht_Brd
[
MAX_MAC_LEN
] =

46 
ut8_t
 
	gEtht_MAC_Addss
[
MAX_MAC_LEN
] =

50 
t32_t
 
	gEtht_Stus
 = 
R_ETHER_ERROR
;

52 
bo
 
	$ht_vid
(

55 i(
Etht_Stus
 !
R_ETHER_OK
) {

56 
Etht_Stus
 = 
	`R_Eth_On
(0, 
Etht_MAC_Addss
);

59  (
Etht_Stus
 !
R_ETHER_ERROR
);

60 
	}
}

62 
	$ht_nup
(

65 
	`R_Eth_Clo
(0);

66 
Etht_Stus
 = 
R_ETHER_ERROR
;

69 
	}
}

71 
bo
 
	$ht_
(

72 *
r_me
)

74 
r_me
 = interface_name;

75 
Etht_Stus
 = 
	`R_Eth_On
(0, 
Etht_MAC_Addss
);

77  (
Etht_Stus
 =
R_ETHER_OK
);

78 
	}
}

80 
	$ht_nd
(

81 
ut8_t
 * 
mtu
,

82 
mtu_n
)

84 
bys
 = 0;

87 
bys
 = 
	`R_Eth_Wre
(0, 
mtu
, 
mtu_n
);

89  
bys
;

91 
	}
}

95 
	$ht_nd_pdu
(

96 
BACNET_ADDRESS
 * 
de
,

97 
BACNET_NPDU_DATA
 * 
du_da
,

98 
ut8_t
 * 
pdu
,

99 
pdu_n
)

101 
i
 = 0;

102 
bys
 = 0;

103 
BACNET_ADDRESS
 
c
 = { 0 };

104 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

105 
mtu_n
 = 0;

107 (
du_da
;

109 
i
 = 0; i < 6; i++) {

110 
c
.
mac
[
i
] = 
Etht_MAC_Addss
[i];

111 
c
.
mac_n
++;

115 i(!
	`ht_vid
()) {

119 i(
de
->
mac_n
 == 6) {

120 
i
 = 0; i < 6; i++) {

121 
mtu
[
i
] = 
de
->
mac
[i];

128 i(
c
.
mac_n
 == 6) {

129 
i
 = 0; i < 6; i++) {

130 
mtu
[6 + 
i
] = 
c
.
mac
[i];

136 
mtu
[14] = 0x82;

137 
mtu
[15] = 0x82;

138 
mtu
[16] = 0x03;

139 
mtu_n
 = 17;

140 i((
mtu_n
 + 
pdu_n
> 
MAX_MPDU
) {

143 
	`memy
(&
mtu
[
mtu_n
], 
pdu
, 
pdu_n
);

144 
mtu_n
 +
pdu_n
;

146 
	`code_unsigd16
(&
mtu
[12], 3 + 
pdu_n
);

149 
bys
 = 
	`R_Eth_Wre
(0, 
mtu
, 
mtu_n
);

151  
bys
;

152 
	}
}

156 
ut16_t
 
	$ht_ive
(

157 
BACNET_ADDRESS
 * 
c
,

158 
ut8_t
 * 
pdu
,

159 
ut16_t
 
max_pdu
,

160 
timeout
)

162 
ived_bys
;

163 
ut8_t
 
buf
[
MAX_MPDU
] = { 0 };

164 
ut16_t
 
pdu_n
 = 0;

167 i(!
	`ht_vid
())

170 
ived_bys
 = 
	`R_Eth_Rd
(0, (*
buf
);

172 i(
ived_bys
 == 0)

176 i((
buf
[14] != 0x82) && (buf[15] != 0x82)) {

180 
c
->
mac_n
 = 6;

181 
	`memmove
(
c
->
mac
, &
buf
[6], 6);

185 i((
	`memcmp
(&
buf
[0], 
Etht_MAC_Addss
, 6) != 0)

186 && (
	`memcmp
(&
buf
[0], 
Etht_Brd
, 6) != 0)) {

190 (
	`decode_unsigd16
(&
buf
[12], &
pdu_n
);

191 
pdu_n
 -= 3 ;

193 i(
pdu_n
 < 
max_pdu
)

194 
	`memmove
(&
pdu
[0], &
buf
[17], 
pdu_n
);

197 
pdu_n
 = 0;

200  
pdu_n
;

201 
	}
}

203 
	$ht_t_my_addss
(

204 
BACNET_ADDRESS
 * 
my_addss
)

206 
i
 = 0;

208 
i
 = 0; i < 6; i++) {

209 
Etht_MAC_Addss
[
i
] = 
my_addss
->
mac
[i];

213 
	}
}

215 
	$ht_g_my_addss
(

216 
BACNET_ADDRESS
 * 
my_addss
)

218 
i
 = 0;

220 
my_addss
->
mac_n
 = 0;

221 
i
 = 0; i < 6; i++) {

222 
my_addss
->
mac
[
i
] = 
Etht_MAC_Addss
[i];

223 
my_addss
->
mac_n
++;

225 
my_addss
->
t
 = 0;

226 
my_addss
->
n
 = 0;

227 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

228 
my_addss
->
adr
[
i
] = 0;

232 
	}
}

234 
	$ht_g_brd_addss
(

235 
BACNET_ADDRESS
 * 
de
)

237 
i
 = 0;

239 i(
de
) {

240 
i
 = 0; i < 6; i++) {

241 
de
->
mac
[
i
] = 
Etht_Brd
[i];

243 
de
->
mac_n
 = 6;

244 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

245 
de
->
n
 = 0;

246 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

247 
de
->
adr
[
i
] = 0;

252 
	}
}

	@ports/rx62n/hardware.h

25 #ide
HARDWARE_H


26 
	#HARDWARE_H


	)

29 
	~"r_pdl_io_pt.h
"

31 
	~"r_pdl_cmt.h
"

33 
	~"r_pdl_defis.h
"

35 
	~"YRDKRX62N.h
"

37 
	~"r_h.h
"

39 
	~"lcd.h
"

42 
	#MAX_LEDS
 16

	)

44 
	#MAX_BINARY_OUTPUTS
 16

	)

	@ports/rx62n/led.c

24 
	~<dt.h
>

25 
	~"hdwe.h
"

26 
	~"tim.h
"

27 
	~"d.h
"

29 
im
 
	gOff_Day_Tim
[
MAX_LEDS
];

30 
bo
 
	gLED_Stus
[
MAX_LEDS
];

32 
	#LED_OFF
 (0)

	)

40 
	$d_
(

41 
ut8_t
 
dex
)

43 
dex
) {

45 
	`R_IO_PORT_Wre
(
LED4
, 
LED_ON
);

48 
	`R_IO_PORT_Wre
(
LED5
, 
LED_ON
);

51 
	`R_IO_PORT_Wre
(
LED6
, 
LED_ON
);

54 
	`R_IO_PORT_Wre
(
LED7
, 
LED_ON
);

57 
	`R_IO_PORT_Wre
(
LED8
, 
LED_ON
);

60 
	`R_IO_PORT_Wre
(
LED9
, 
LED_ON
);

63 
	`R_IO_PORT_Wre
(
LED10
, 
LED_ON
);

66 
	`R_IO_PORT_Wre
(
LED11
, 
LED_ON
);

69 
	`R_IO_PORT_Wre
(
LED12
, 
LED_ON
);

72 
	`R_IO_PORT_Wre
(
LED13
, 
LED_ON
);

75 
	`R_IO_PORT_Wre
(
LED14
, 
LED_ON
);

78 
	`R_IO_PORT_Wre
(
LED15
, 
LED_ON
);

83 i(
dex
 < 
MAX_LEDS
) {

84 
LED_Stus
[
dex
] = 
LED_ON
;

85 
	`tim_rv_no_expe
(&
Off_Day_Tim
[
dex
]);

87 
	}
}

94 
	$d_off
(

95 
ut8_t
 
dex
)

97 
dex
) {

99 
	`R_IO_PORT_Wre
(
LED4
, 
LED_OFF
);

102 
	`R_IO_PORT_Wre
(
LED5
, 
LED_OFF
);

105 
	`R_IO_PORT_Wre
(
LED6
, 
LED_OFF
);

108 
	`R_IO_PORT_Wre
(
LED7
, 
LED_OFF
);

111 
	`R_IO_PORT_Wre
(
LED8
, 
LED_OFF
);

114 
	`R_IO_PORT_Wre
(
LED9
, 
LED_OFF
);

117 
	`R_IO_PORT_Wre
(
LED10
, 
LED_OFF
);

120 
	`R_IO_PORT_Wre
(
LED11
, 
LED_OFF
);

123 
	`R_IO_PORT_Wre
(
LED12
, 
LED_OFF
);

126 
	`R_IO_PORT_Wre
(
LED13
, 
LED_OFF
);

129 
	`R_IO_PORT_Wre
(
LED14
, 
LED_OFF
);

132 
	`R_IO_PORT_Wre
(
LED15
, 
LED_OFF
);

137 i(
dex
 < 
MAX_LEDS
) {

138 
LED_Stus
[
dex
] = 
LED_OFF
;

139 
	`tim_rv_no_expe
(&
Off_Day_Tim
[
dex
]);

141 
	}
}

148 
bo
 
	$d_e
(

149 
ut8_t
 
dex
)

151 
bo
 
e
 = 
l
;

153 i(
dex
 < 
MAX_LEDS
) {

154 
e
 = 
LED_Stus
[
dex
];

157  
e
;

158 
	}
}

165 
	$d_togg
(

166 
ut8_t
 
dex
)

168 i(
	`d_e
(
dex
)) {

169 
	`d_off
(
dex
);

171 
	`d_
(
dex
);

173 
	}
}

180 
	$d_off_day
(

181 
ut8_t
 
dex
,

182 
ut32_t
 
day_ms
)

184 i(
dex
 < 
MAX_LEDS
) {

185 
	`tim_rv_t
(&
Off_Day_Tim
[
dex
], 
day_ms
);

187 
	}
}

194 
	$d__rv
(

195 
ut8_t
 
dex
,

196 
ut16_t
 
rv_ms
)

198 i(
dex
 < 
MAX_LEDS
) {

199 
	`d_
(
dex
);

200 
	`tim_rv_t
(&
Off_Day_Tim
[
dex
], 
rv_ms
);

202 
	}
}

209 
	$d_sk
(

212 
ut8_t
 
i
;

214 
i
 = 0; i < 
MAX_LEDS
; i++) {

215 i(
	`tim_rv_exped
(&
Off_Day_Tim
[
i
])) {

216 
	`tim_rv_no_expe
(&
Off_Day_Tim
[
i
]);

217 
	`d_off
(
i
);

220 
	}
}

227 
	$d_
(

230 
i
 = 0;

232 
i
 = 0; i < 
MAX_LEDS
; i++) {

233 
	`d__rv
(
i
, 500);

235 
	}
}

	@ports/rx62n/led.h

24 #ide
LED_H


25 
	#LED_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

30 #ifde
__lulus


34 
d_
(

35 
ut8_t
 
dex
);

36 
d__rv
(

37 
ut8_t
 
dex
,

38 
ut16_t
 
rv_ms
);

39 
d_off
(

40 
ut8_t
 
dex
);

41 
d_off_day
(

42 
ut8_t
 
dex
,

43 
ut32_t
 
day_ms
);

44 
d_togg
(

45 
ut8_t
 
dex
);

46 
bo
 
d_e
(

47 
ut8_t
 
dex
);

48 
d_sk
(

50 
d_
(

53 #ifde
__lulus


	@ports/rx62n/main.c

25 
	~<dbo.h
>

26 
	~<dt.h
>

27 
	~"hdwe.h
"

28 
	~"ht.h
"

29 
	~"tim.h
"

30 
	~"d.h
"

33 
	$ma
(

36 
	`InliLCD
();

37 
	`CˬLCD
();

38 
	`DiyLCD
(
LCD_LINE1
, "BACnet Demo");

40 
	`tim_
();

41 
	`d_
();

42 
	`ht_
(
NULL
);

43 
	`ba_
();

45 
	`ba_sk
();

46 
	`d_sk
();

48 
	}
}

	@ports/rx62n/timer-hdw.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~"hdwe.h
"

27 
	~"tim.h
"

30 vީ
ut32_t
 
	gMlicd_Cou
;

31 vީ
ut8_t
 
	gMlicd_Cou_By
;

33 
t_cmt0_i
(

41 
	$tim_u_hdr
(

44 
Mlicd_Cou
++;

45 
Mlicd_Cou_By
++;

46 
	}
}

53 
	$t_cmt0_i
(

56 
	`tim_u_hdr
();

57 
	}
}

64 
ut32_t
 
	$tim_mlicds
(

67 
ut32_t
 
tim_vue
;

69 
tim_vue
 = 
Mlicd_Cou
;

71  
tim_vue
;

72 
	}
}

79 
ut8_t
 
	$tim_mlicds_by
(

82  
Mlicd_Cou
;

83 
	}
}

90 
	$tim_
(

94 
bo
 
r
 = 
ue
;

98 
r
 &
	`R_CMT_Ce
(3, 
PDL_CMT_PERIOD
, 1E-3, 
t_cmt0_i
, 3);

101 !
r
);

102 
	}
}

	@ports/rx62n/timer.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~"tim.h
"

37 
	$tim_d_t
(

38 
im
 *
t
)

40 
ut32_t
 
now
 = 
	`tim_mlicds
();

42 i(
t
) {

43 
t
->
t
 = 
now
;

45 
	}
}

52 
ut32_t
 
	$tim_d_time
(

53 
im
 *
t
)

55 
ut32_t
 
now
 = 
	`tim_mlicds
();

56 
ut32_t
 
d
 = 0;

58 i(
t
) {

59 
d
 = 
now
 - 
t
->
t
;

62  
d
;

63 
	}
}

70 
	$tim_d_t_offt
(

71 
im
 *
t
,

72 
ut32_t
 
offt
)

74 
ut32_t
 
now
 = 
	`tim_mlicds
();

76 i(
t
) {

77 
t
->
t
 = 
now
 + 
offt
;

79 
	}
}

86 
bo
 
	$tim_d_mlicds
(

87 
im
 *
t
,

88 
ut32_t
 
mlicds
)

90  (
	`tim_d_time
(
t
>
mlicds
);

91 
	}
}

98 
bo
 
	$tim_d_cds
(

99 
im
 * 
t
,

100 
ut32_t
 
cds
)

102 
ut32_t
 
mlicds
 = 
cds
;

104 
mlicds
 *= 1000L;

106  
	`tim_d_mlicds
(
t
, 
mlicds
);

107 
	}
}

114 
bo
 
	$tim_d_mus
(

115 
im
 * 
t
,

116 
ut32_t
 
mus
)

118 
ut32_t
 
mlicds
 = 
mus
;

120 
mlicds
 *= 1000L;

121 
mlicds
 *= 60L;

123  
	`tim_d_mlicds
(
t
, 
mlicds
);

124 
	}
}

131 
bo
 
	$tim_d_mlicds_sht
(

132 
im
 * 
t
,

133 
ut16_t
 
vue
)

135 
ut32_t
 
mlicds
;

137 
mlicds
 = 
vue
;

139  (
	`tim_d_time
(
t
>
mlicds
);

140 
	}
}

147 
bo
 
	$tim_d_cds_sht
(

148 
im
 * 
t
,

149 
ut16_t
 
vue
)

151  
	`tim_d_cds
(
t
, 
vue
);

152 
	}
}

159 
bo
 
	$tim_d_mus_sht
(

160 
im
 * 
t
,

161 
ut16_t
 
vue
)

163  
	`tim_d_mus
(
t
, 
vue
);

164 
	}
}

171 
	$tim_rv_t
(

172 
im
 *
t
,

173 
ut32_t
 
rv
)

175 i(
t
) {

176 
t
->
t
 = 
	`tim_mlicds
();

177 
t
->
rv
 = interval;

179 
	}
}

186 
	$tim_rv_t_cds
(

187 
im
 *
t
,

188 
ut32_t
 
cds
)

190 
ut32_t
 
rv
 = 
cds
;

192 
rv
 *= 1000L;

193 
	`tim_rv_t
(
t
, 
rv
);

194 
	}
}

201 
	$tim_rv_t_mus
(

202 
im
 *
t
,

203 
ut32_t
 
mus
)

205 
ut32_t
 
rv
 = 
mus
;

207 
rv
 *= 1000L;

208 
rv
 *= 60L;

209 
	`tim_rv_t
(
t
, 
rv
);

210 
	}
}

217 
ut32_t
 
	$tim_rv_d
(

218 
im
 *
t
)

220 
ut32_t
 
now
 = 
	`tim_mlicds
();

221 
ut32_t
 
d
 = 0;

223 i(
t
) {

224 
d
 = 
now
 - 
t
->
t
;

227  
d
;

228 
	}
}

235 
ut32_t
 
	$tim_rv
(

236 
im
 * 
t
)

238 
ut32_t
 
rv
 = 0;

240 i(
t
) {

241 
rv
 = 
t
->interval;

244  
rv
;

245 
	}
}

252 
bo
 
	$tim_rv_exped
(

253 
im
 * 
t
)

255 
bo
 
exped
 = 
l
;

257 i(
t
) {

258 i(
t
->
rv
) {

259 
exped
 = 
	`tim_rv_d
(
t
>t->
rv
;

263  
exped
;

264 
	}
}

271 
	$tim_rv_no_expe
(

272 
im
 *
t
)

274 i(
t
) {

275 
t
->
rv
 = 0;

277 
	}
}

285 
	$tim_rv_t
(

286 
im
 *
t
)

288 i(
t
) {

289 
t
->
t
 +t->
rv
;

291 
	}
}

298 
	$tim_rv_t
(

299 
im
 *
t
)

301 i(
t
) {

302 
t
->
t
 = 
	`tim_mlicds
();

304 
	}
}

311 
ut8_t
 
	$tim_mlicds_d
(

312 
ut8_t
 
t
)

314  (
	`tim_mlicds_by
(- 
t
);

315 
	}
}

322 
ut8_t
 
	$tim_mlicds_mk
(

325  
	`tim_mlicds_by
();

326 
	}
}

328 #ifde
TEST


329 
	~<as.h
>

330 
	~<rg.h
>

332 
	~"e.h
"

334 
ut32_t
 
	gMlicds
;

336 
ut32_t
 
	$tim_mlicds
(

339  
Mlicds
;

340 
	}
}

342 
ut32_t
 
	$tim_mlicds_t
(

343 
ut32_t
 
vue
)

345 
ut32_t
 
d_vue
 = 
Mlicds
;

347 
Mlicds
 = 
vue
;

349  
d_vue
;

350 
	}
}

352 
	$EpdTim
(

353 
Te
 * 
pTe
)

355 
im
 
t
;

356 
ut32_t
 
_time
 = 0;

358 
	`tim_mlicds_t
(
_time
);

359 
	`tim_d_t
(&
t
);

360 
	`_
(
pTe
, 
	`tim_d_time
(&
t
=
_time
);

361 
_time
 = 0xffff;

362 
	`tim_mlicds_t
(
_time
);

363 
	`_
(
pTe
, 
	`tim_d_time
(&
t
=
_time
);

364 
_time
 = 0xffffffff;

365 
	`tim_mlicds_t
(
_time
);

366 
	`_
(
pTe
, 
	`tim_d_time
(&
t
=
_time
);

367 
	}
}

369 
	$IvTim
(

370 
Te
 * 
pTe
)

372 
im
 
t
;

373 
ut32_t
 
rv
 = 0;

374 
ut32_t
 
_time
 = 0;

376 
	`tim_mlicds_t
(
_time
);

377 
	`tim_rv_t
(&
t
, 
rv
);

378 
_time
 = 0xffff;

379 
	`tim_mlicds_t
(
_time
);

380 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

381 
	`_
(
pTe
, 
	`tim_rv_d
(&
t
=
_time
);

382 
_time
 = 0xffffffff;

383 
	`tim_mlicds_t
(
_time
);

384 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

385 
	`_
(
pTe
, 
	`tim_rv_d
(&
t
=
_time
);

386 
_time
 = 0;

387 
	`tim_mlicds_t
(
_time
);

388 
rv
 = 0xffff;

389 
	`tim_rv_t
(&
t
, 
rv
);

390 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

391 
rv
 = 0xffffffff;

392 
	`tim_rv_t
(&
t
, 
rv
);

393 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

395 
rv
 = 0;

396 
	`tim_rv_t_cds
(&
t
, 
rv
);

397 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

398 
rv
 = 60L;

399 
	`tim_rv_t_cds
(&
t
, 
rv
);

400 
rv
 *= 1000L;

401 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

403 
	}
}

406 #ifde
TEST_TIMER


407 
	$ma
(

410 
Te
 *
pTe
;

411 
bo
 
rc
;

413 
pTe
 = 
	`_
("Tim", 
NULL
);

416 
rc
 = 
	`_addTeFuni
(
pTe
, 
EpdTim
);

417 
	`as
(
rc
);

418 
rc
 = 
	`_addTeFuni
(
pTe
, 
IvTim
);

419 
	`as
(
rc
);

422 
	`_tSm
(
pTe
, 
dout
);

423 
	`_run
(
pTe
);

424 (
	`_pt
(
pTe
);

426 
	`_deroy
(
pTe
);

429 
	}
}

	@ports/rx62n/timer.h

24 #ide
TIMER_H


25 
	#TIMER_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

33 
	sim
 {

34 
ut32_t
 
	mt
;

37 
	sim
 {

38 
ut32_t
 
	mt
;

39 
ut32_t
 
	mrv
;

42 #ifde
__lulus


47 
tim_
(

49 
ut32_t
 
tim_mlicds
(

51 
ut8_t
 
tim_mlicds_by
(

57 
tim_d_t
(

58 
im
 *
t
);

59 
tim_d_t_offt
(

60 
im
 *
t
,

61 
ut32_t
 
offt
);

62 
ut32_t
 
tim_d_time
(

63 
im
 *
t
);

64 
bo
 
tim_d_mlicds
(

65 
im
 *
t
,

66 
ut32_t
 
vue
);

67 
bo
 
tim_d_cds
(

68 
im
 *
t
,

69 
ut32_t
 
vue
);

70 
bo
 
tim_d_mus
(

71 
im
 *
t
,

72 
ut32_t
 
vue
);

73 
bo
 
tim_d_mlicds_sht
(

74 
im
 *
t
,

75 
ut16_t
 
vue
);

76 
bo
 
tim_d_cds_sht
(

77 
im
 *
t
,

78 
ut16_t
 
vue
);

79 
bo
 
tim_d_mus_sht
(

80 
im
 *
t
,

81 
ut16_t
 
vue
);

84 
tim_rv_t
(

85 
im
 *
t
,

86 
ut32_t
 
rv
);

87 
tim_rv_t_cds
(

88 
im
 *
t
,

89 
ut32_t
 
rv
);

90 
tim_rv_t_mus
(

91 
im
 *
t
,

92 
ut32_t
 
rv
);

93 
bo
 
tim_rv_exped
(

94 
im
 *
t
);

95 
ut32_t
 
tim_rv
(

96 
im
 *
t
);

97 
ut32_t
 
tim_rv_d
(

98 
im
 *
t
);

99 
tim_rv_no_expe
(

100 
im
 *
t
);

101 
tim_rv_t
(

102 
im
 *
t
);

103 
tim_rv_t
(

104 
im
 *
t
);

107 
ut8_t
 
tim_mlicds_d
(

108 
ut8_t
 
t
);

109 
ut8_t
 
tim_mlicds_mk
(

112 #ifde
__lulus


	@ports/stm32f10x/CMSIS/core_cm3.c

24 
	~<dt.h
>

27 #i
defed
 ( 
__CC_ARM
 )

28 
	#__ASM
 
__asm


	)

29 
	#__INLINE
 
__le


	)

31 #i
defed
 ( 
__ICCARM__
 )

32 
	#__ASM
 
__asm


	)

33 
	#__INLINE
 
le


	)

35 #i
defed
 ( 
__GNUC__
 )

36 
	#__ASM
 
__asm


	)

37 
	#__INLINE
 
le


	)

39 #i
defed
 ( 
__TASKING__
 )

40 
	#__ASM
 
__asm


	)

41 
	#__INLINE
 
le


	)

48 #i
defed
 ( 
__CC_ARM
 )

58 
__ASM
 
ut32_t
 
	$__g_PSP
()

60 
mrs
 
r0
, 
p


61 
bx
 



62 
	}
}

72 
__ASM
 
	$__t_PSP
(
ut32_t
 
tOfProcSck
)

74 
m
 
p
, 
r0


75 
bx
 



76 
	}
}

86 
__ASM
 
ut32_t
 
	$__g_MSP
()

88 
mrs
 
r0
, 
m


89 
bx
 



90 
	}
}

100 
__ASM
 
	$__t_MSP
(
ut32_t
 
maSckPor
)

102 
m
 
m
, 
r0


103 
bx
 



104 
	}
}

114 
__ASM
 
ut32_t
 
	$__REV16
(
ut16_t
 
vue
)

116 
v16
 
r0
,0

117 
bx
 



118 
	}
}

128 
__ASM
 
t32_t
 
	$__REVSH
(
t16_t
 
vue
)

130 
vsh
 
r0
,0

131 
bx
 



132 
	}
}

135 #i(
__ARMCC_VERSION
 < 400000)

142 
__ASM
 
	$__CLREX
()

144 
x


145 
	}
}

154 
__ASM
 
ut32_t
 
	$__g_BASEPRI
()

156 
mrs
 
r0
, 
bai


157 
bx
 



158 
	}
}

167 
__ASM
 
	$__t_BASEPRI
(
ut32_t
 
baPri
)

169 
m
 
bai
, 
r0


170 
bx
 



171 
	}
}

180 
__ASM
 
ut32_t
 
	$__g_PRIMASK
()

182 
mrs
 
r0
, 
imask


183 
bx
 



184 
	}
}

193 
__ASM
 
	$__t_PRIMASK
(
ut32_t
 
iMask
)

195 
m
 
imask
, 
r0


196 
bx
 



197 
	}
}

206 
__ASM
 
ut32_t
 
	$__g_FAULTMASK
()

208 
mrs
 
r0
, 
umask


209 
bx
 



210 
	}
}

219 
__ASM
 
	$__t_FAULTMASK
(
ut32_t
 
uMask
)

221 
m
 
umask
, 
r0


222 
bx
 



223 
	}
}

232 
__ASM
 
ut32_t
 
	$__g_CONTROL
()

234 
mrs
 
r0
, 
cڌ


235 
bx
 



236 
	}
}

245 
__ASM
 
	$__t_CONTROL
(
ut32_t
 
cڌ
)

247 
m
 
cڌ
, 
r0


248 
bx
 



249 
	}
}

255 #i(
defed
 (
__ICCARM__
))

257 #agm
dg_suss
=
Pe940


266 
ut32_t
 
	$__g_PSP
()

268 
	`__ASM
("mrs0,sp");

269 
	`__ASM
("bxr");

270 
	}
}

280 
	$__t_PSP
(
ut32_t
 
tOfProcSck
)

282 
	`__ASM
("msrsp,0");

283 
	`__ASM
("bxr");

284 
	}
}

294 
ut32_t
 
	$__g_MSP
()

296 
	`__ASM
("mrs0, msp");

297 
	`__ASM
("bxr");

298 
	}
}

308 
	$__t_MSP
(
ut32_t
 
tOfMaSck
)

310 
	`__ASM
("msr msp,0");

311 
	`__ASM
("bxr");

312 
	}
}

322 
ut32_t
 
	$__REV16
(
ut16_t
 
vue
)

324 
	`__ASM
("rev160,0");

325 
	`__ASM
("bxr");

326 
	}
}

336 
ut32_t
 
	$__RBIT
(
ut32_t
 
vue
)

338 
	`__ASM
("rbit0,0");

339 
	`__ASM
("bxr");

340 
	}
}

350 
ut8_t
 
	$__LDREXB
(
ut8_t
 *
addr
)

352 
	`__ASM
("ldrexb0, [r0]");

353 
	`__ASM
("bxr");

354 
	}
}

364 
ut16_t
 
	$__LDREXH
(
ut16_t
 *
addr
)

366 
	`__ASM
("ldrexh0, [r0]");

367 
	`__ASM
("bxr");

368 
	}
}

378 
ut32_t
 
	$__LDREXW
(
ut32_t
 *
addr
)

380 
	`__ASM
("ldrex0, [r0]");

381 
	`__ASM
("bxr");

382 
	}
}

393 
ut32_t
 
	$__STREXB
(
ut8_t
 
vue
, ut8_*
addr
)

395 
	`__ASM
("strexb0,0, [r1]");

396 
	`__ASM
("bxr");

397 
	}
}

408 
ut32_t
 
	$__STREXH
(
ut16_t
 
vue
, ut16_*
addr
)

410 
	`__ASM
("strexh0,0, [r1]");

411 
	`__ASM
("bxr");

412 
	}
}

423 
ut32_t
 
	$__STREXW
(
ut32_t
 
vue
, ut32_*
addr
)

425 
	`__ASM
("strex0,0, [r1]");

426 
	`__ASM
("bxr");

427 
	}
}

429 #agm
dg_deu
=
Pe940


432 #i(
defed
 (
__GNUC__
))

442 
ut32_t
 
	$__g_PSP
(
	`__ibu__

ked
 ) );

443 
ut32_t
 
	$__g_PSP
()

445 
ut32_t
 
su
=0;

447 
__ASM
 volatile ("MRS %0,sp\n\t"

449 "BX \n\t" : "" (
su
) );

450 (
su
);

451 
	}
}

461 
	$__t_PSP
(
ut32_t
 
tOfProcSck

	`__ibu__

ked
 ) );

462 
	$__t_PSP
(
ut32_t
 
tOfProcSck
)

464 
__ASM
 volatile ("MSRsp, %0\n\t"

465 "BX \n\t" : : "r" (
tOfProcSck
) );

466 
	}
}

476 
ut32_t
 
	$__g_MSP
(
	`__ibu__

ked
 ) );

477 
ut32_t
 
	$__g_MSP
()

479 
ut32_t
 
su
=0;

481 
__ASM
 volatile ("MRS %0, msp\n\t"

483 "BX \n\t" : "" (
su
) );

484 (
su
);

485 
	}
}

495 
	$__t_MSP
(
ut32_t
 
tOfMaSck

	`__ibu__

ked
 ) );

496 
	$__t_MSP
(
ut32_t
 
tOfMaSck
)

498 
__ASM
 volatile ("MSR msp, %0\n\t"

499 "BX \n\t" : : "r" (
tOfMaSck
) );

500 
	}
}

509 
ut32_t
 
	$__g_BASEPRI
()

511 
ut32_t
 
su
=0;

513 
__ASM
 vީ("MRS %0, bai_max" : "" (
su
) );

514 (
su
);

515 
	}
}

524 
	$__t_BASEPRI
(
ut32_t
 
vue
)

526 
__ASM
 vީ("MSR bai, %0" : : "r" (
vue
) );

527 
	}
}

536 
ut32_t
 
	$__g_PRIMASK
()

538 
ut32_t
 
su
=0;

540 
__ASM
 vީ("MRS %0,rimask" : "" (
su
) );

541 (
su
);

542 
	}
}

551 
	$__t_PRIMASK
(
ut32_t
 
iMask
)

553 
__ASM
 vީ("MSRrimask, %0" : : "r" (
iMask
) );

554 
	}
}

563 
ut32_t
 
	$__g_FAULTMASK
()

565 
ut32_t
 
su
=0;

567 
__ASM
 vީ("MRS %0, faumask" : "" (
su
) );

568 (
su
);

569 
	}
}

578 
	$__t_FAULTMASK
(
ut32_t
 
uMask
)

580 
__ASM
 vީ("MSR faumask, %0" : : "r" (
uMask
) );

581 
	}
}

590 
ut32_t
 
	$__g_CONTROL
()

592 
ut32_t
 
su
=0;

594 
__ASM
 vީ("MRS %0, cڌ" : "" (
su
) );

595 (
su
);

596 
	}
}

605 
	$__t_CONTROL
(
ut32_t
 
cڌ
)

607 
__ASM
 vީ("MSR cڌ, %0" : : "r" (
cڌ
) );

608 
	}
}

619 
ut32_t
 
	$__REV
(
ut32_t
 
vue
)

621 
ut32_t
 
su
=0;

623 
__ASM
 vީ("v %0, %1" : "" (
su
: "r" (
vue
) );

624 (
su
);

625 
	}
}

635 
ut32_t
 
	$__REV16
(
ut16_t
 
vue
)

637 
ut32_t
 
su
=0;

639 
__ASM
 vީ("v16 %0, %1" : "" (
su
: "r" (
vue
) );

640 (
su
);

641 
	}
}

651 
t32_t
 
	$__REVSH
(
t16_t
 
vue
)

653 
ut32_t
 
su
=0;

655 
__ASM
 vީ("vsh %0, %1" : "" (
su
: "r" (
vue
) );

656 (
su
);

657 
	}
}

667 
ut32_t
 
	$__RBIT
(
ut32_t
 
vue
)

669 
ut32_t
 
su
=0;

671 
__ASM
 vީ("rb %0, %1" : "" (
su
: "r" (
vue
) );

672 (
su
);

673 
	}
}

683 
ut8_t
 
	$__LDREXB
(
ut8_t
 *
addr
)

685 
ut8_t
 
su
=0;

687 
__ASM
 vީ("ldxb %0, [%1]" : "" (
su
: "r" (
addr
) );

688 (
su
);

689 
	}
}

699 
ut16_t
 
	$__LDREXH
(
ut16_t
 *
addr
)

701 
ut16_t
 
su
=0;

703 
__ASM
 vީ("ldxh %0, [%1]" : "" (
su
: "r" (
addr
) );

704 (
su
);

705 
	}
}

715 
ut32_t
 
	$__LDREXW
(
ut32_t
 *
addr
)

717 
ut32_t
 
su
=0;

719 
__ASM
 vީ("ldx %0, [%1]" : "" (
su
: "r" (
addr
) );

720 (
su
);

721 
	}
}

732 
ut32_t
 
	$__STREXB
(
ut8_t
 
vue
, ut8_*
addr
)

734 
ut32_t
 
su
=0;

736 
__ASM
 vީ("xb %0, %2, [%1]" : "" (
su
: "r" (
addr
), "r" (
vue
) );

737 (
su
);

738 
	}
}

749 
ut32_t
 
	$__STREXH
(
ut16_t
 
vue
, ut16_*
addr
)

751 
ut32_t
 
su
=0;

753 
__ASM
 vީ("xh %0, %2, [%1]" : "" (
su
: "r" (
addr
), "r" (
vue
) );

754 (
su
);

755 
	}
}

766 
ut32_t
 
	$__STREXW
(
ut32_t
 
vue
, ut32_*
addr
)

768 
ut32_t
 
su
=0;

770 
__ASM
 vީ("x %0, %2, [%1]" : "" (
su
: "r" (
addr
), "r" (
vue
) );

771 (
su
);

772 
	}
}

775 #i(
defed
 (
__TASKING__
))

	@ports/stm32f10x/CMSIS/core_cm3.h

24 #ide
__CM3_CORE_H__


25 
	#__CM3_CORE_H__


	)

80 #ifde
__lulus


84 
	#__CM3_CMSIS_VERSION_MAIN
 (0x01

	)

85 
	#__CM3_CMSIS_VERSION_SUB
 (0x30

	)

86 
	#__CM3_CMSIS_VERSION
 ((
__CM3_CMSIS_VERSION_MAIN
 << 16| 
__CM3_CMSIS_VERSION_SUB


	)

88 
	#__CORTEX_M
 (0x03

	)

90 
	~<dt.h
>

92 #i
defed
 (
__ICCARM__
)

93 
	~<sics.h
>

97 #ide
__NVIC_PRIO_BITS


98 
	#__NVIC_PRIO_BITS
 4

	)

110 #ifde
__lulus


111 
	#__I
 vީ

	)

113 
	#__I
 vީcڡ

	)

115 
	#__O
 vީ

	)

116 
	#__IO
 vީ

	)

134 
__IO
 
ut32_t
 
ISER
[8];

135 
ut32_t
 
RESERVED0
[24];

136 
__IO
 
ut32_t
 
ICER
[8];

137 
ut32_t
 
RSERVED1
[24];

138 
__IO
 
ut32_t
 
ISPR
[8];

139 
ut32_t
 
RESERVED2
[24];

140 
__IO
 
ut32_t
 
ICPR
[8];

141 
ut32_t
 
RESERVED3
[24];

142 
__IO
 
ut32_t
 
IABR
[8];

143 
ut32_t
 
RESERVED4
[56];

144 
__IO
 
ut8_t
 
IP
[240];

145 
ut32_t
 
RESERVED5
[644];

146 
__O
 
ut32_t
 
STIR
;

147 } 
	tNVIC_Ty
;

157 
__I
 
ut32_t
 
CPUID
;

158 
__IO
 
ut32_t
 
ICSR
;

159 
__IO
 
ut32_t
 
VTOR
;

160 
__IO
 
ut32_t
 
AIRCR
;

161 
__IO
 
ut32_t
 
SCR
;

162 
__IO
 
ut32_t
 
CCR
;

163 
__IO
 
ut8_t
 
SHP
[12];

164 
__IO
 
ut32_t
 
SHCSR
;

165 
__IO
 
ut32_t
 
CFSR
;

166 
__IO
 
ut32_t
 
HFSR
;

167 
__IO
 
ut32_t
 
DFSR
;

168 
__IO
 
ut32_t
 
MMFAR
;

169 
__IO
 
ut32_t
 
BFAR
;

170 
__IO
 
ut32_t
 
AFSR
;

171 
__I
 
ut32_t
 
PFR
[2];

172 
__I
 
ut32_t
 
DFR
;

173 
__I
 
ut32_t
 
ADR
;

174 
__I
 
ut32_t
 
MMFR
[4];

175 
__I
 
ut32_t
 
ISAR
[5];

176 } 
	tSCB_Ty
;

179 
	#SCB_CPUID_IMPLEMENTER_Pos
 24

	)

180 
	#SCB_CPUID_IMPLEMENTER_Msk
 (0xFFu<< 
SCB_CPUID_IMPLEMENTER_Pos


	)

182 
	#SCB_CPUID_VARIANT_Pos
 20

	)

183 
	#SCB_CPUID_VARIANT_Msk
 (0xFu<< 
SCB_CPUID_VARIANT_Pos


	)

185 
	#SCB_CPUID_PARTNO_Pos
 4

	)

186 
	#SCB_CPUID_PARTNO_Msk
 (0xFFFu<< 
SCB_CPUID_PARTNO_Pos


	)

188 
	#SCB_CPUID_REVISION_Pos
 0

	)

189 
	#SCB_CPUID_REVISION_Msk
 (0xFu<< 
SCB_CPUID_REVISION_Pos


	)

192 
	#SCB_ICSR_NMIPENDSET_Pos
 31

	)

193 
	#SCB_ICSR_NMIPENDSET_Msk
 (1u<< 
SCB_ICSR_NMIPENDSET_Pos


	)

195 
	#SCB_ICSR_PENDSVSET_Pos
 28

	)

196 
	#SCB_ICSR_PENDSVSET_Msk
 (1u<< 
SCB_ICSR_PENDSVSET_Pos


	)

198 
	#SCB_ICSR_PENDSVCLR_Pos
 27

	)

199 
	#SCB_ICSR_PENDSVCLR_Msk
 (1u<< 
SCB_ICSR_PENDSVCLR_Pos


	)

201 
	#SCB_ICSR_PENDSTSET_Pos
 26

	)

202 
	#SCB_ICSR_PENDSTSET_Msk
 (1u<< 
SCB_ICSR_PENDSTSET_Pos


	)

204 
	#SCB_ICSR_PENDSTCLR_Pos
 25

	)

205 
	#SCB_ICSR_PENDSTCLR_Msk
 (1u<< 
SCB_ICSR_PENDSTCLR_Pos


	)

207 
	#SCB_ICSR_ISRPREEMPT_Pos
 23

	)

208 
	#SCB_ICSR_ISRPREEMPT_Msk
 (1u<< 
SCB_ICSR_ISRPREEMPT_Pos


	)

210 
	#SCB_ICSR_ISRPENDING_Pos
 22

	)

211 
	#SCB_ICSR_ISRPENDING_Msk
 (1u<< 
SCB_ICSR_ISRPENDING_Pos


	)

213 
	#SCB_ICSR_VECTPENDING_Pos
 12

	)

214 
	#SCB_ICSR_VECTPENDING_Msk
 (0x1FFu<< 
SCB_ICSR_VECTPENDING_Pos


	)

216 
	#SCB_ICSR_RETTOBASE_Pos
 11

	)

217 
	#SCB_ICSR_RETTOBASE_Msk
 (1u<< 
SCB_ICSR_RETTOBASE_Pos


	)

219 
	#SCB_ICSR_VECTACTIVE_Pos
 0

	)

220 
	#SCB_ICSR_VECTACTIVE_Msk
 (0x1FFu<< 
SCB_ICSR_VECTACTIVE_Pos


	)

223 
	#SCB_VTOR_TBLBASE_Pos
 29

	)

224 
	#SCB_VTOR_TBLBASE_Msk
 (0x1FFu<< 
SCB_VTOR_TBLBASE_Pos


	)

226 
	#SCB_VTOR_TBLOFF_Pos
 7

	)

227 
	#SCB_VTOR_TBLOFF_Msk
 (0x3FFFFFu<< 
SCB_VTOR_TBLOFF_Pos


	)

230 
	#SCB_AIRCR_VECTKEY_Pos
 16

	)

231 
	#SCB_AIRCR_VECTKEY_Msk
 (0xFFFFu<< 
SCB_AIRCR_VECTKEY_Pos


	)

233 
	#SCB_AIRCR_VECTKEYSTAT_Pos
 16

	)

234 
	#SCB_AIRCR_VECTKEYSTAT_Msk
 (0xFFFFu<< 
SCB_AIRCR_VECTKEYSTAT_Pos


	)

236 
	#SCB_AIRCR_ENDIANESS_Pos
 15

	)

237 
	#SCB_AIRCR_ENDIANESS_Msk
 (1u<< 
SCB_AIRCR_ENDIANESS_Pos


	)

239 
	#SCB_AIRCR_PRIGROUP_Pos
 8

	)

240 
	#SCB_AIRCR_PRIGROUP_Msk
 (7u<< 
SCB_AIRCR_PRIGROUP_Pos


	)

242 
	#SCB_AIRCR_SYSRESETREQ_Pos
 2

	)

243 
	#SCB_AIRCR_SYSRESETREQ_Msk
 (1u<< 
SCB_AIRCR_SYSRESETREQ_Pos


	)

245 
	#SCB_AIRCR_VECTCLRACTIVE_Pos
 1

	)

246 
	#SCB_AIRCR_VECTCLRACTIVE_Msk
 (1u<< 
SCB_AIRCR_VECTCLRACTIVE_Pos


	)

248 
	#SCB_AIRCR_VECTRESET_Pos
 0

	)

249 
	#SCB_AIRCR_VECTRESET_Msk
 (1u<< 
SCB_AIRCR_VECTRESET_Pos


	)

252 
	#SCB_SCR_SEVONPEND_Pos
 4

	)

253 
	#SCB_SCR_SEVONPEND_Msk
 (1u<< 
SCB_SCR_SEVONPEND_Pos


	)

255 
	#SCB_SCR_SLEEPDEEP_Pos
 2

	)

256 
	#SCB_SCR_SLEEPDEEP_Msk
 (1u<< 
SCB_SCR_SLEEPDEEP_Pos


	)

258 
	#SCB_SCR_SLEEPONEXIT_Pos
 1

	)

259 
	#SCB_SCR_SLEEPONEXIT_Msk
 (1u<< 
SCB_SCR_SLEEPONEXIT_Pos


	)

262 
	#SCB_CCR_STKALIGN_Pos
 9

	)

263 
	#SCB_CCR_STKALIGN_Msk
 (1u<< 
SCB_CCR_STKALIGN_Pos


	)

265 
	#SCB_CCR_BFHFNMIGN_Pos
 8

	)

266 
	#SCB_CCR_BFHFNMIGN_Msk
 (1u<< 
SCB_CCR_BFHFNMIGN_Pos


	)

268 
	#SCB_CCR_DIV_0_TRP_Pos
 4

	)

269 
	#SCB_CCR_DIV_0_TRP_Msk
 (1u<< 
SCB_CCR_DIV_0_TRP_Pos


	)

271 
	#SCB_CCR_UNALIGN_TRP_Pos
 3

	)

272 
	#SCB_CCR_UNALIGN_TRP_Msk
 (1u<< 
SCB_CCR_UNALIGN_TRP_Pos


	)

274 
	#SCB_CCR_USERSETMPEND_Pos
 1

	)

275 
	#SCB_CCR_USERSETMPEND_Msk
 (1u<< 
SCB_CCR_USERSETMPEND_Pos


	)

277 
	#SCB_CCR_NONBASETHRDENA_Pos
 0

	)

278 
	#SCB_CCR_NONBASETHRDENA_Msk
 (1u<< 
SCB_CCR_NONBASETHRDENA_Pos


	)

281 
	#SCB_SHCSR_USGFAULTENA_Pos
 18

	)

282 
	#SCB_SHCSR_USGFAULTENA_Msk
 (1u<< 
SCB_SHCSR_USGFAULTENA_Pos


	)

284 
	#SCB_SHCSR_BUSFAULTENA_Pos
 17

	)

285 
	#SCB_SHCSR_BUSFAULTENA_Msk
 (1u<< 
SCB_SHCSR_BUSFAULTENA_Pos


	)

287 
	#SCB_SHCSR_MEMFAULTENA_Pos
 16

	)

288 
	#SCB_SHCSR_MEMFAULTENA_Msk
 (1u<< 
SCB_SHCSR_MEMFAULTENA_Pos


	)

290 
	#SCB_SHCSR_SVCALLPENDED_Pos
 15

	)

291 
	#SCB_SHCSR_SVCALLPENDED_Msk
 (1u<< 
SCB_SHCSR_SVCALLPENDED_Pos


	)

293 
	#SCB_SHCSR_BUSFAULTPENDED_Pos
 14

	)

294 
	#SCB_SHCSR_BUSFAULTPENDED_Msk
 (1u<< 
SCB_SHCSR_BUSFAULTPENDED_Pos


	)

296 
	#SCB_SHCSR_MEMFAULTPENDED_Pos
 13

	)

297 
	#SCB_SHCSR_MEMFAULTPENDED_Msk
 (1u<< 
SCB_SHCSR_MEMFAULTPENDED_Pos


	)

299 
	#SCB_SHCSR_USGFAULTPENDED_Pos
 12

	)

300 
	#SCB_SHCSR_USGFAULTPENDED_Msk
 (1u<< 
SCB_SHCSR_USGFAULTPENDED_Pos


	)

302 
	#SCB_SHCSR_SYSTICKACT_Pos
 11

	)

303 
	#SCB_SHCSR_SYSTICKACT_Msk
 (1u<< 
SCB_SHCSR_SYSTICKACT_Pos


	)

305 
	#SCB_SHCSR_PENDSVACT_Pos
 10

	)

306 
	#SCB_SHCSR_PENDSVACT_Msk
 (1u<< 
SCB_SHCSR_PENDSVACT_Pos


	)

308 
	#SCB_SHCSR_MONITORACT_Pos
 8

	)

309 
	#SCB_SHCSR_MONITORACT_Msk
 (1u<< 
SCB_SHCSR_MONITORACT_Pos


	)

311 
	#SCB_SHCSR_SVCALLACT_Pos
 7

	)

312 
	#SCB_SHCSR_SVCALLACT_Msk
 (1u<< 
SCB_SHCSR_SVCALLACT_Pos


	)

314 
	#SCB_SHCSR_USGFAULTACT_Pos
 3

	)

315 
	#SCB_SHCSR_USGFAULTACT_Msk
 (1u<< 
SCB_SHCSR_USGFAULTACT_Pos


	)

317 
	#SCB_SHCSR_BUSFAULTACT_Pos
 1

	)

318 
	#SCB_SHCSR_BUSFAULTACT_Msk
 (1u<< 
SCB_SHCSR_BUSFAULTACT_Pos


	)

320 
	#SCB_SHCSR_MEMFAULTACT_Pos
 0

	)

321 
	#SCB_SHCSR_MEMFAULTACT_Msk
 (1u<< 
SCB_SHCSR_MEMFAULTACT_Pos


	)

324 
	#SCB_CFSR_USGFAULTSR_Pos
 16

	)

325 
	#SCB_CFSR_USGFAULTSR_Msk
 (0xFFFFu<< 
SCB_CFSR_USGFAULTSR_Pos


	)

327 
	#SCB_CFSR_BUSFAULTSR_Pos
 8

	)

328 
	#SCB_CFSR_BUSFAULTSR_Msk
 (0xFFu<< 
SCB_CFSR_BUSFAULTSR_Pos


	)

330 
	#SCB_CFSR_MEMFAULTSR_Pos
 0

	)

331 
	#SCB_CFSR_MEMFAULTSR_Msk
 (0xFFu<< 
SCB_CFSR_MEMFAULTSR_Pos


	)

334 
	#SCB_HFSR_DEBUGEVT_Pos
 31

	)

335 
	#SCB_HFSR_DEBUGEVT_Msk
 (1u<< 
SCB_HFSR_DEBUGEVT_Pos


	)

337 
	#SCB_HFSR_FORCED_Pos
 30

	)

338 
	#SCB_HFSR_FORCED_Msk
 (1u<< 
SCB_HFSR_FORCED_Pos


	)

340 
	#SCB_HFSR_VECTTBL_Pos
 1

	)

341 
	#SCB_HFSR_VECTTBL_Msk
 (1u<< 
SCB_HFSR_VECTTBL_Pos


	)

344 
	#SCB_DFSR_EXTERNAL_Pos
 4

	)

345 
	#SCB_DFSR_EXTERNAL_Msk
 (1u<< 
SCB_DFSR_EXTERNAL_Pos


	)

347 
	#SCB_DFSR_VCATCH_Pos
 3

	)

348 
	#SCB_DFSR_VCATCH_Msk
 (1u<< 
SCB_DFSR_VCATCH_Pos


	)

350 
	#SCB_DFSR_DWTTRAP_Pos
 2

	)

351 
	#SCB_DFSR_DWTTRAP_Msk
 (1u<< 
SCB_DFSR_DWTTRAP_Pos


	)

353 
	#SCB_DFSR_BKPT_Pos
 1

	)

354 
	#SCB_DFSR_BKPT_Msk
 (1u<< 
SCB_DFSR_BKPT_Pos


	)

356 
	#SCB_DFSR_HALTED_Pos
 0

	)

357 
	#SCB_DFSR_HALTED_Msk
 (1u<< 
SCB_DFSR_HALTED_Pos


	)

367 
__IO
 
ut32_t
 
CTRL
;

368 
__IO
 
ut32_t
 
LOAD
;

369 
__IO
 
ut32_t
 
VAL
;

370 
__I
 
ut32_t
 
CALIB
;

371 } 
	tSysTick_Ty
;

374 
	#SysTick_CTRL_COUNTFLAG_Pos
 16

	)

375 
	#SysTick_CTRL_COUNTFLAG_Msk
 (1u<< 
SysTick_CTRL_COUNTFLAG_Pos


	)

377 
	#SysTick_CTRL_CLKSOURCE_Pos
 2

	)

378 
	#SysTick_CTRL_CLKSOURCE_Msk
 (1u<< 
SysTick_CTRL_CLKSOURCE_Pos


	)

380 
	#SysTick_CTRL_TICKINT_Pos
 1

	)

381 
	#SysTick_CTRL_TICKINT_Msk
 (1u<< 
SysTick_CTRL_TICKINT_Pos


	)

383 
	#SysTick_CTRL_ENABLE_Pos
 0

	)

384 
	#SysTick_CTRL_ENABLE_Msk
 (1u<< 
SysTick_CTRL_ENABLE_Pos


	)

387 
	#SysTick_LOAD_RELOAD_Pos
 0

	)

388 
	#SysTick_LOAD_RELOAD_Msk
 (0xFFFFFFu<< 
SysTick_LOAD_RELOAD_Pos


	)

391 
	#SysTick_VAL_CURRENT_Pos
 0

	)

392 
	#SysTick_VAL_CURRENT_Msk
 (0xFFFFFFu<< 
SysTick_VAL_CURRENT_Pos


	)

395 
	#SysTick_CALIB_NOREF_Pos
 31

	)

396 
	#SysTick_CALIB_NOREF_Msk
 (1u<< 
SysTick_CALIB_NOREF_Pos


	)

398 
	#SysTick_CALIB_SKEW_Pos
 30

	)

399 
	#SysTick_CALIB_SKEW_Msk
 (1u<< 
SysTick_CALIB_SKEW_Pos


	)

401 
	#SysTick_CALIB_TENMS_Pos
 0

	)

402 
	#SysTick_CALIB_TENMS_Msk
 (0xFFFFFFu<< 
SysTick_VAL_CURRENT_Pos


	)

412 
__O
 union

414 
__O
 
ut8_t
 
u8
;

415 
__O
 
ut16_t
 
u16
;

416 
__O
 
ut32_t
 
u32
;

417 } 
PORT
 [32];

418 
ut32_t
 
RESERVED0
[864];

419 
__IO
 
ut32_t
 
TER
;

420 
ut32_t
 
RESERVED1
[15];

421 
__IO
 
ut32_t
 
TPR
;

422 
ut32_t
 
RESERVED2
[15];

423 
__IO
 
ut32_t
 
TCR
;

424 
ut32_t
 
RESERVED3
[29];

425 
__IO
 
ut32_t
 
IWR
;

426 
__IO
 
ut32_t
 
IRR
;

427 
__IO
 
ut32_t
 
IMCR
;

428 
ut32_t
 
RESERVED4
[43];

429 
__IO
 
ut32_t
 
LAR
;

430 
__IO
 
ut32_t
 
LSR
;

431 
ut32_t
 
RESERVED5
[6];

432 
__I
 
ut32_t
 
PID4
;

433 
__I
 
ut32_t
 
PID5
;

434 
__I
 
ut32_t
 
PID6
;

435 
__I
 
ut32_t
 
PID7
;

436 
__I
 
ut32_t
 
PID0
;

437 
__I
 
ut32_t
 
PID1
;

438 
__I
 
ut32_t
 
PID2
;

439 
__I
 
ut32_t
 
PID3
;

440 
__I
 
ut32_t
 
CID0
;

441 
__I
 
ut32_t
 
CID1
;

442 
__I
 
ut32_t
 
CID2
;

443 
__I
 
ut32_t
 
CID3
;

444 } 
	tITM_Ty
;

447 
	#ITM_TPR_PRIVMASK_Pos
 0

	)

448 
	#ITM_TPR_PRIVMASK_Msk
 (0xFu<< 
ITM_TPR_PRIVMASK_Pos


	)

451 
	#ITM_TCR_BUSY_Pos
 23

	)

452 
	#ITM_TCR_BUSY_Msk
 (1u<< 
ITM_TCR_BUSY_Pos


	)

454 
	#ITM_TCR_ATBID_Pos
 16

	)

455 
	#ITM_TCR_ATBID_Msk
 (0x7Fu<< 
ITM_TCR_ATBID_Pos


	)

457 
	#ITM_TCR_TSPs_Pos
 8

	)

458 
	#ITM_TCR_TSPs_Msk
 (3u<< 
ITM_TCR_TSPs_Pos


	)

460 
	#ITM_TCR_SWOENA_Pos
 4

	)

461 
	#ITM_TCR_SWOENA_Msk
 (1u<< 
ITM_TCR_SWOENA_Pos


	)

463 
	#ITM_TCR_DWTENA_Pos
 3

	)

464 
	#ITM_TCR_DWTENA_Msk
 (1u<< 
ITM_TCR_DWTENA_Pos


	)

466 
	#ITM_TCR_SYNCENA_Pos
 2

	)

467 
	#ITM_TCR_SYNCENA_Msk
 (1u<< 
ITM_TCR_SYNCENA_Pos


	)

469 
	#ITM_TCR_TSENA_Pos
 1

	)

470 
	#ITM_TCR_TSENA_Msk
 (1u<< 
ITM_TCR_TSENA_Pos


	)

472 
	#ITM_TCR_ITMENA_Pos
 0

	)

473 
	#ITM_TCR_ITMENA_Msk
 (1u<< 
ITM_TCR_ITMENA_Pos


	)

476 
	#ITM_IWR_ATVALIDM_Pos
 0

	)

477 
	#ITM_IWR_ATVALIDM_Msk
 (1u<< 
ITM_IWR_ATVALIDM_Pos


	)

480 
	#ITM_IRR_ATREADYM_Pos
 0

	)

481 
	#ITM_IRR_ATREADYM_Msk
 (1u<< 
ITM_IRR_ATREADYM_Pos


	)

484 
	#ITM_IMCR_INTEGRATION_Pos
 0

	)

485 
	#ITM_IMCR_INTEGRATION_Msk
 (1u<< 
ITM_IMCR_INTEGRATION_Pos


	)

488 
	#ITM_LSR_ByAcc_Pos
 2

	)

489 
	#ITM_LSR_ByAcc_Msk
 (1u<< 
ITM_LSR_ByAcc_Pos


	)

491 
	#ITM_LSR_Acss_Pos
 1

	)

492 
	#ITM_LSR_Acss_Msk
 (1u<< 
ITM_LSR_Acss_Pos


	)

494 
	#ITM_LSR_P_Pos
 0

	)

495 
	#ITM_LSR_P_Msk
 (1u<< 
ITM_LSR_P_Pos


	)

505 
ut32_t
 
RESERVED0
;

506 
__I
 
ut32_t
 
ICTR
;

507 #i((
defed
 
__CM3_REV
) && (__CM3_REV >= 0x200))

508 
__IO
 
ut32_t
 
ACTLR
;

510 
ut32_t
 
RESERVED1
;

512 } 
	tIruTy_Ty
;

515 
	#IruTy_ICTR_INTLINESNUM_Pos
 0

	)

516 
	#IruTy_ICTR_INTLINESNUM_Msk
 (0x1Fu<< 
IruTy_ICTR_INTLINESNUM_Pos


	)

519 
	#IruTy_ACTLR_DISFOLD_Pos
 2

	)

520 
	#IruTy_ACTLR_DISFOLD_Msk
 (1u<< 
IruTy_ACTLR_DISFOLD_Pos


	)

522 
	#IruTy_ACTLR_DISDEFWBUF_Pos
 1

	)

523 
	#IruTy_ACTLR_DISDEFWBUF_Msk
 (1u<< 
IruTy_ACTLR_DISDEFWBUF_Pos


	)

525 
	#IruTy_ACTLR_DISMCYCINT_Pos
 0

	)

526 
	#IruTy_ACTLR_DISMCYCINT_Msk
 (1u<< 
IruTy_ACTLR_DISMCYCINT_Pos


	)

530 #i
defed
 (
__MPU_PRESENT
) && (__MPU_PRESENT == 1)

537 
__I
 
ut32_t
 
TYPE
;

538 
__IO
 
ut32_t
 
CTRL
;

539 
__IO
 
ut32_t
 
RNR
;

540 
__IO
 
ut32_t
 
RBAR
;

541 
__IO
 
ut32_t
 
RASR
;

542 
__IO
 
ut32_t
 
RBAR_A1
;

543 
__IO
 
ut32_t
 
RASR_A1
;

544 
__IO
 
ut32_t
 
RBAR_A2
;

545 
__IO
 
ut32_t
 
RASR_A2
;

546 
__IO
 
ut32_t
 
RBAR_A3
;

547 
__IO
 
ut32_t
 
RASR_A3
;

548 } 
	tMPU_Ty
;

551 
	#MPU_TYPE_IREGION_Pos
 16

	)

552 
	#MPU_TYPE_IREGION_Msk
 (0xFFu<< 
MPU_TYPE_IREGION_Pos


	)

554 
	#MPU_TYPE_DREGION_Pos
 8

	)

555 
	#MPU_TYPE_DREGION_Msk
 (0xFFu<< 
MPU_TYPE_DREGION_Pos


	)

557 
	#MPU_TYPE_SEPARATE_Pos
 0

	)

558 
	#MPU_TYPE_SEPARATE_Msk
 (1u<< 
MPU_TYPE_SEPARATE_Pos


	)

561 
	#MPU_CTRL_PRIVDEFENA_Pos
 2

	)

562 
	#MPU_CTRL_PRIVDEFENA_Msk
 (1u<< 
MPU_CTRL_PRIVDEFENA_Pos


	)

564 
	#MPU_CTRL_HFNMIENA_Pos
 1

	)

565 
	#MPU_CTRL_HFNMIENA_Msk
 (1u<< 
MPU_CTRL_HFNMIENA_Pos


	)

567 
	#MPU_CTRL_ENABLE_Pos
 0

	)

568 
	#MPU_CTRL_ENABLE_Msk
 (1u<< 
MPU_CTRL_ENABLE_Pos


	)

571 
	#MPU_RNR_REGION_Pos
 0

	)

572 
	#MPU_RNR_REGION_Msk
 (0xFFu<< 
MPU_RNR_REGION_Pos


	)

575 
	#MPU_RBAR_ADDR_Pos
 5

	)

576 
	#MPU_RBAR_ADDR_Msk
 (0x7FFFFFFu<< 
MPU_RBAR_ADDR_Pos


	)

578 
	#MPU_RBAR_VALID_Pos
 4

	)

579 
	#MPU_RBAR_VALID_Msk
 (1u<< 
MPU_RBAR_VALID_Pos


	)

581 
	#MPU_RBAR_REGION_Pos
 0

	)

582 
	#MPU_RBAR_REGION_Msk
 (0xFu<< 
MPU_RBAR_REGION_Pos


	)

585 
	#MPU_RASR_XN_Pos
 28

	)

586 
	#MPU_RASR_XN_Msk
 (1u<< 
MPU_RASR_XN_Pos


	)

588 
	#MPU_RASR_AP_Pos
 24

	)

589 
	#MPU_RASR_AP_Msk
 (7u<< 
MPU_RASR_AP_Pos


	)

591 
	#MPU_RASR_TEX_Pos
 19

	)

592 
	#MPU_RASR_TEX_Msk
 (7u<< 
MPU_RASR_TEX_Pos


	)

594 
	#MPU_RASR_S_Pos
 18

	)

595 
	#MPU_RASR_S_Msk
 (1u<< 
MPU_RASR_S_Pos


	)

597 
	#MPU_RASR_C_Pos
 17

	)

598 
	#MPU_RASR_C_Msk
 (1u<< 
MPU_RASR_C_Pos


	)

600 
	#MPU_RASR_B_Pos
 16

	)

601 
	#MPU_RASR_B_Msk
 (1u<< 
MPU_RASR_B_Pos


	)

603 
	#MPU_RASR_SRD_Pos
 8

	)

604 
	#MPU_RASR_SRD_Msk
 (0xFFu<< 
MPU_RASR_SRD_Pos


	)

606 
	#MPU_RASR_SIZE_Pos
 1

	)

607 
	#MPU_RASR_SIZE_Msk
 (0x1Fu<< 
MPU_RASR_SIZE_Pos


	)

609 
	#MPU_RASR_ENA_Pos
 0

	)

610 
	#MPU_RASR_ENA_Msk
 (0x1Fu<< 
MPU_RASR_ENA_Pos


	)

622 
__IO
 
ut32_t
 
DHCSR
;

623 
__O
 
ut32_t
 
DCRSR
;

624 
__IO
 
ut32_t
 
DCRDR
;

625 
__IO
 
ut32_t
 
DEMCR
;

626 } 
	tCeDebug_Ty
;

629 
	#CeDebug_DHCSR_DBGKEY_Pos
 16

	)

630 
	#CeDebug_DHCSR_DBGKEY_Msk
 (0xFFFFu<< 
CeDebug_DHCSR_DBGKEY_Pos


	)

632 
	#CeDebug_DHCSR_S_RESET_ST_Pos
 25

	)

633 
	#CeDebug_DHCSR_S_RESET_ST_Msk
 (1u<< 
CeDebug_DHCSR_S_RESET_ST_Pos


	)

635 
	#CeDebug_DHCSR_S_RETIRE_ST_Pos
 24

	)

636 
	#CeDebug_DHCSR_S_RETIRE_ST_Msk
 (1u<< 
CeDebug_DHCSR_S_RETIRE_ST_Pos


	)

638 
	#CeDebug_DHCSR_S_LOCKUP_Pos
 19

	)

639 
	#CeDebug_DHCSR_S_LOCKUP_Msk
 (1u<< 
CeDebug_DHCSR_S_LOCKUP_Pos


	)

641 
	#CeDebug_DHCSR_S_SLEEP_Pos
 18

	)

642 
	#CeDebug_DHCSR_S_SLEEP_Msk
 (1u<< 
CeDebug_DHCSR_S_SLEEP_Pos


	)

644 
	#CeDebug_DHCSR_S_HALT_Pos
 17

	)

645 
	#CeDebug_DHCSR_S_HALT_Msk
 (1u<< 
CeDebug_DHCSR_S_HALT_Pos


	)

647 
	#CeDebug_DHCSR_S_REGRDY_Pos
 16

	)

648 
	#CeDebug_DHCSR_S_REGRDY_Msk
 (1u<< 
CeDebug_DHCSR_S_REGRDY_Pos


	)

650 
	#CeDebug_DHCSR_C_SNAPSTALL_Pos
 5

	)

651 
	#CeDebug_DHCSR_C_SNAPSTALL_Msk
 (1u<< 
CeDebug_DHCSR_C_SNAPSTALL_Pos


	)

653 
	#CeDebug_DHCSR_C_MASKINTS_Pos
 3

	)

654 
	#CeDebug_DHCSR_C_MASKINTS_Msk
 (1u<< 
CeDebug_DHCSR_C_MASKINTS_Pos


	)

656 
	#CeDebug_DHCSR_C_STEP_Pos
 2

	)

657 
	#CeDebug_DHCSR_C_STEP_Msk
 (1u<< 
CeDebug_DHCSR_C_STEP_Pos


	)

659 
	#CeDebug_DHCSR_C_HALT_Pos
 1

	)

660 
	#CeDebug_DHCSR_C_HALT_Msk
 (1u<< 
CeDebug_DHCSR_C_HALT_Pos


	)

662 
	#CeDebug_DHCSR_C_DEBUGEN_Pos
 0

	)

663 
	#CeDebug_DHCSR_C_DEBUGEN_Msk
 (1u<< 
CeDebug_DHCSR_C_DEBUGEN_Pos


	)

666 
	#CeDebug_DCRSR_REGWnR_Pos
 16

	)

667 
	#CeDebug_DCRSR_REGWnR_Msk
 (1u<< 
CeDebug_DCRSR_REGWnR_Pos


	)

669 
	#CeDebug_DCRSR_REGSEL_Pos
 0

	)

670 
	#CeDebug_DCRSR_REGSEL_Msk
 (0x1Fu<< 
CeDebug_DCRSR_REGSEL_Pos


	)

673 
	#CeDebug_DEMCR_TRCENA_Pos
 24

	)

674 
	#CeDebug_DEMCR_TRCENA_Msk
 (1u<< 
CeDebug_DEMCR_TRCENA_Pos


	)

676 
	#CeDebug_DEMCR_MON_REQ_Pos
 19

	)

677 
	#CeDebug_DEMCR_MON_REQ_Msk
 (1u<< 
CeDebug_DEMCR_MON_REQ_Pos


	)

679 
	#CeDebug_DEMCR_MON_STEP_Pos
 18

	)

680 
	#CeDebug_DEMCR_MON_STEP_Msk
 (1u<< 
CeDebug_DEMCR_MON_STEP_Pos


	)

682 
	#CeDebug_DEMCR_MON_PEND_Pos
 17

	)

683 
	#CeDebug_DEMCR_MON_PEND_Msk
 (1u<< 
CeDebug_DEMCR_MON_PEND_Pos


	)

685 
	#CeDebug_DEMCR_MON_EN_Pos
 16

	)

686 
	#CeDebug_DEMCR_MON_EN_Msk
 (1u<< 
CeDebug_DEMCR_MON_EN_Pos


	)

688 
	#CeDebug_DEMCR_VC_HARDERR_Pos
 10

	)

689 
	#CeDebug_DEMCR_VC_HARDERR_Msk
 (1u<< 
CeDebug_DEMCR_VC_HARDERR_Pos


	)

691 
	#CeDebug_DEMCR_VC_INTERR_Pos
 9

	)

692 
	#CeDebug_DEMCR_VC_INTERR_Msk
 (1u<< 
CeDebug_DEMCR_VC_INTERR_Pos


	)

694 
	#CeDebug_DEMCR_VC_BUSERR_Pos
 8

	)

695 
	#CeDebug_DEMCR_VC_BUSERR_Msk
 (1u<< 
CeDebug_DEMCR_VC_BUSERR_Pos


	)

697 
	#CeDebug_DEMCR_VC_STATERR_Pos
 7

	)

698 
	#CeDebug_DEMCR_VC_STATERR_Msk
 (1u<< 
CeDebug_DEMCR_VC_STATERR_Pos


	)

700 
	#CeDebug_DEMCR_VC_CHKERR_Pos
 6

	)

701 
	#CeDebug_DEMCR_VC_CHKERR_Msk
 (1u<< 
CeDebug_DEMCR_VC_CHKERR_Pos


	)

703 
	#CeDebug_DEMCR_VC_NOCPERR_Pos
 5

	)

704 
	#CeDebug_DEMCR_VC_NOCPERR_Msk
 (1u<< 
CeDebug_DEMCR_VC_NOCPERR_Pos


	)

706 
	#CeDebug_DEMCR_VC_MMERR_Pos
 4

	)

707 
	#CeDebug_DEMCR_VC_MMERR_Msk
 (1u<< 
CeDebug_DEMCR_VC_MMERR_Pos


	)

709 
	#CeDebug_DEMCR_VC_CORERESET_Pos
 0

	)

710 
	#CeDebug_DEMCR_VC_CORERESET_Msk
 (1u<< 
CeDebug_DEMCR_VC_CORERESET_Pos


	)

715 
	#SCS_BASE
 (0xE000E000

	)

716 
	#ITM_BASE
 (0xE0000000

	)

717 
	#CeDebug_BASE
 (0xE000EDF0

	)

718 
	#SysTick_BASE
 (
SCS_BASE
 + 0x0010

	)

719 
	#NVIC_BASE
 (
SCS_BASE
 + 0x0100

	)

720 
	#SCB_BASE
 (
SCS_BASE
 + 0x0D00

	)

722 
	#IruTy
 ((
IruTy_Ty
 *
SCS_BASE


	)

723 
	#SCB
 ((
SCB_Ty
 *
SCB_BASE


	)

724 
	#SysTick
 ((
SysTick_Ty
 *
SysTick_BASE


	)

725 
	#NVIC
 ((
NVIC_Ty
 *
NVIC_BASE


	)

726 
	#ITM
 ((
ITM_Ty
 *
ITM_BASE


	)

727 
	#CeDebug
 ((
CeDebug_Ty
 *
CeDebug_BASE


	)

729 #i
defed
 (
__MPU_PRESENT
) && (__MPU_PRESENT == 1)

730 
	#MPU_BASE
 (
SCS_BASE
 + 0x0D90

	)

731 
	#MPU
 ((
MPU_Ty
*
MPU_BASE


	)

741 #i
defed
 ( 
__CC_ARM
 )

742 
	#__ASM
 
__asm


	)

743 
	#__INLINE
 
__le


	)

745 #i
defed
 ( 
__ICCARM__
 )

746 
	#__ASM
 
__asm


	)

747 
	#__INLINE
 
le


	)

749 #i
defed
 ( 
__GNUC__
 )

750 
	#__ASM
 
__asm


	)

751 
	#__INLINE
 
le


	)

753 #i
defed
 ( 
__TASKING__
 )

754 
	#__ASM
 
__asm


	)

755 
	#__INLINE
 
le


	)

762 #i
defed
 ( 
__CC_ARM
 )

765 
	#__ab_u_q
 
__ab_fiq


	)

766 
	#__dib_u_q
 
__dib_fiq


	)

768 
	#__NOP
 
__n


	)

769 
	#__WFI
 
__wfi


	)

770 
	#__WFE
 
__w


	)

771 
	#__SEV
 
__v


	)

772 
	#__ISB
(
	`__isb
(0)

	)

773 
	#__DSB
(
	`__dsb
(0)

	)

774 
	#__DMB
(
	`__dmb
(0)

	)

775 
	#__REV
 
__v


	)

776 
	#__RBIT
 
__rb


	)

777 
	#__LDREXB
(
r
((
	`__ldx
Ռ))

	)

778 
	#__LDREXH
(
r
((
	`__ldx
Ռ))

	)

779 
	#__LDREXW
(
r
((
	`__ldx
Ռ))

	)

780 
	#__STREXB
(
vue
, 
r

	`__x
(vue,)

	)

781 
	#__STREXH
(
vue
, 
r

	`__x
(vue,)

	)

782 
	#__STREXW
(
vue
, 
r

	`__x
(vue,)

	)

798 
ut32_t
 
__g_PSP
();

808 
__t_PSP
(
ut32_t
 
tOfProcSck
);

818 
ut32_t
 
__g_MSP
();

828 
__t_MSP
(
ut32_t
 
tOfMaSck
);

838 
ut32_t
 
__REV16
(
ut16_t
 
vue
);

848 
t32_t
 
__REVSH
(
t16_t
 
vue
);

851 #i(
__ARMCC_VERSION
 < 400000)

858 
__CLREX
();

867 
ut32_t
 
__g_BASEPRI
();

876 
__t_BASEPRI
(
ut32_t
 
baPri
);

885 
ut32_t
 
__g_PRIMASK
();

894 
__t_PRIMASK
(
ut32_t
 
iMask
);

903 
ut32_t
 
__g_FAULTMASK
();

912 
__t_FAULTMASK
(
ut32_t
 
uMask
);

921 
ut32_t
 
__g_CONTROL
();

930 
__t_CONTROL
(
ut32_t
 
cڌ
);

939 
	#__CLREX
 
__x


	)

948 
__INLINE
 
ut32_t
 
__g_BASEPRI
()

950 
ut32_t
 
__gBaPri
 
__ASM
("basepri");

951 (
	g__gBaPri
);

961 
__INLINE
 
__t_BASEPRI
(
ut32_t
 
baPri
)

963 
ut32_t
 
__gBaPri
 
__ASM
("basepri");

964 
	g__gBaPri
 = (
baPri
 & 0xff);

974 
__INLINE
 
ut32_t
 
__g_PRIMASK
()

976 
ut32_t
 
__gPriMask
 
__ASM
("primask");

977 (
	g__gPriMask
);

987 
__INLINE
 
__t_PRIMASK
(
ut32_t
 
iMask
)

989 
ut32_t
 
__gPriMask
 
__ASM
("primask");

990 
	g__gPriMask
 = (
iMask
);

1000 
__INLINE
 
ut32_t
 
__g_FAULTMASK
()

1002 
ut32_t
 
__gFauMask
 
__ASM
("faultmask");

1003 (
	g__gFauMask
);

1013 
__INLINE
 
__t_FAULTMASK
(
ut32_t
 
uMask
)

1015 
ut32_t
 
__gFauMask
 
__ASM
("faultmask");

1016 
	g__gFauMask
 = (
uMask
 & 1);

1026 
__INLINE
 
ut32_t
 
__g_CONTROL
()

1028 
ut32_t
 
__gCڌ
 
__ASM
("control");

1029 (
	g__gCڌ
);

1039 
__INLINE
 
__t_CONTROL
(
ut32_t
 
cڌ
)

1041 
ut32_t
 
__gCڌ
 
__ASM
("control");

1042 
	g__gCڌ
 = 
cڌ
;

1049 #i(
defed
 (
__ICCARM__
))

1052 
	#__ab_q
 
__ab_u


	)

1053 
	#__dib_q
 
__dib_u


	)

1055 
__INLINE
 
__ab_u_q
({ 
__ASM
 ("cpsie f"); }

1056 
__INLINE
 
__dib_u_q
({ 
__ASM
 ("cpsid f"); }

1058 
	#__NOP
 
__no_ݔi


	)

1059 
__INLINE
 
__WFI
({ 
__ASM
 ("wfi"); }

1060 
__INLINE
 
__WFE
({ 
__ASM
 ("wfe"); }

1061 
__INLINE
 
__SEV
({ 
__ASM
 ("sev"); }

1062 
__INLINE
 
__CLREX
({ 
__ASM
 ("clrex"); }

1076 #i
defed
 (
__IAR_SYSTEMS_ICC__
) && (__IAR_SYSTEMS_ICC__ > 6)

1079 
__ATTRIBUTES
 
__g_MSP
( );

1080 
__ATTRIBUTES
 
__t_MSP
( );

1081 
__ATTRIBUTES
 
__g_PSP
( );

1082 
__ATTRIBUTES
 
__t_PSP
( );

1084 
__ATTRIBUTES
 
__REV16
( );

1085 
__ATTRIBUTES
 
__RBIT
( );

1088 #i
defed
 (
__IAR_SYSTEMS_ICC__
) && (__IAR_SYSTEMS_ICC__ > 7)

1099 
ut8_t
 
__LDREXB
(ut8_*
addr
);

1109 
ut16_t
 
__LDREXH
(ut16_*
addr
);

1119 
ut32_t
 
__LDREXW
(ut32_*
addr
);

1133 
ut32_t
 
__STREXW
(ut32_
vue
, ut32_*
addr
);

1137 #i(
defed
 (
__GNUC__
))

1140 
__INLINE
 
__ab_q
({ 
__ASM
 volatile ("cpsie i"); }

1141 
__INLINE
 
__dib_q
({ 
__ASM
 volatile ("cpsid i"); }

1143 
__INLINE
 
__ab_u_q
({ 
__ASM
 volatile ("cpsie f"); }

1144 
__INLINE
 
__dib_u_q
({ 
__ASM
 volatile ("cpsid f"); }

1146 
__INLINE
 
__NOP
({ 
__ASM
 volatile ("nop"); }

1147 
__INLINE
 
__WFI
({ 
__ASM
 volatile ("wfi"); }

1148 
__INLINE
 
__WFE
({ 
__ASM
 volatile ("wfe"); }

1149 
__INLINE
 
__SEV
({ 
__ASM
 volatile ("sev"); }

1150 
__INLINE
 
__ISB
({ 
__ASM
 volatile ("isb"); }

1151 
__INLINE
 
__DSB
({ 
__ASM
 volatile ("dsb"); }

1152 
__INLINE
 
__DMB
({ 
__ASM
 volatile ("dmb"); }

1153 
__INLINE
 
__CLREX
({ 
__ASM
 volatile ("clrex"); }

1163 
ut32_t
 
__g_PSP
();

1173 
__t_PSP
(
ut32_t
 
tOfProcSck
);

1183 
ut32_t
 
__g_MSP
();

1193 
__t_MSP
(
ut32_t
 
tOfMaSck
);

1202 
ut32_t
 
__g_BASEPRI
();

1211 
__t_BASEPRI
(
ut32_t
 
baPri
);

1220 
ut32_t
 
__g_PRIMASK
();

1229 
__t_PRIMASK
(
ut32_t
 
iMask
);

1238 
ut32_t
 
__g_FAULTMASK
();

1247 
__t_FAULTMASK
(
ut32_t
 
uMask
);

1256 
ut32_t
 
__g_CONTROL
();

1265 
__t_CONTROL
(
ut32_t
 
cڌ
);

1275 
ut32_t
 
__REV
(ut32_
vue
);

1285 
ut32_t
 
__REV16
(
ut16_t
 
vue
);

1295 
t32_t
 
__REVSH
(
t16_t
 
vue
);

1305 
ut32_t
 
__RBIT
(ut32_
vue
);

1315 
ut8_t
 
__LDREXB
(ut8_*
addr
);

1325 
ut16_t
 
__LDREXH
(ut16_*
addr
);

1335 
ut32_t
 
__LDREXW
(ut32_*
addr
);

1346 
ut32_t
 
__STREXB
(
ut8_t
 
vue
, ut8_*
addr
);

1357 
ut32_t
 
__STREXH
(
ut16_t
 
vue
, ut16_*
addr
);

1368 
ut32_t
 
__STREXW
(ut32_
vue
, ut32_*
addr
);

1371 #i(
defed
 (
__TASKING__
))

1404 
__INLINE
 
NVIC_SPriܙyGroupg
(
ut32_t
 
PriܙyGroup
)

1406 
ut32_t
 
	gg_vue
;

1407 
ut32_t
 
	gPriܙyGroupTmp
 = (
PriܙyGroup
 & 0x07);

1409 
	gg_vue
 = 
SCB
->
AIRCR
;

1410 
	gg_vue
 &~(
SCB_AIRCR_VECTKEY_Msk
 | 
SCB_AIRCR_PRIGROUP_Msk
);

1411 
	gg_vue
 = (
g_vue
 |

1412 (0x5FA << 
SCB_AIRCR_VECTKEY_Pos
) |

1413 (
PriܙyGroupTmp
 << 8));

1414 
	gSCB
->
	gAIRCR
 = 
g_vue
;

1425 
__INLINE
 
ut32_t
 
NVIC_GPriܙyGroupg
()

1427  ((
	gSCB
->
	gAIRCR
 & 
	gSCB_AIRCR_PRIGROUP_Msk
>> 
	gSCB_AIRCR_PRIGROUP_Pos
);

1438 
__INLINE
 
NVIC_EbIRQ
(
IRQn_Ty
 
IRQn
)

1440 
	gNVIC
->
	gISER
[((
ut32_t
)(
IRQn
) >> 5)] = (1 << ((uint32_t)(IRQn) & 0x1F));

1451 
__INLINE
 
NVIC_DibIRQ
(
IRQn_Ty
 
IRQn
)

1453 
	gNVIC
->
	gICER
[((
ut32_t
)(
IRQn
) >> 5)] = (1 << ((uint32_t)(IRQn) & 0x1F));

1465 
__INLINE
 
ut32_t
 
NVIC_GPdgIRQ
(
IRQn_Ty
 
IRQn
)

1467 ((
	gut32_t
((
	gNVIC
->
	gISPR
[(
ut32_t
)(
IRQn
>> 5] & (1 << ((ut32_t)(
	gIRQn
) & 0x1F)))?1:0));

1478 
__INLINE
 
NVIC_SPdgIRQ
(
IRQn_Ty
 
IRQn
)

1480 
	gNVIC
->
	gISPR
[((
ut32_t
)(
IRQn
) >> 5)] = (1 << ((uint32_t)(IRQn) & 0x1F));

1491 
__INLINE
 
NVIC_CˬPdgIRQ
(
IRQn_Ty
 
IRQn
)

1493 
	gNVIC
->
	gICPR
[((
ut32_t
)(
IRQn
) >> 5)] = (1 << ((uint32_t)(IRQn) & 0x1F));

1505 
__INLINE
 
ut32_t
 
NVIC_GAive
(
IRQn_Ty
 
IRQn
)

1507 ((
	gut32_t
)((
	gNVIC
->
	gIABR
[(
ut32_t
)(
IRQn
>> 5] & (1 << ((ut32_t)(
	gIRQn
) & 0x1F)))?1:0));

1522 
__INLINE
 
NVIC_SPriܙy
(
IRQn_Ty
 
IRQn
, 
ut32_t
 
iܙy
)

1524 if(
	gIRQn
 < 0) {

1525 
	gSCB
->
	gSHP
[((
ut32_t
)(
IRQn
& 0xF)-4] = ((
iܙy
 << (8 - 
__NVIC_PRIO_BITS
)) & 0xff); }

1527 
	gNVIC
->
	gIP
[(
ut32_t
)(
IRQn
)] = ((
iܙy
 << (8 - 
__NVIC_PRIO_BITS
)) & 0xff); }

1545 #ide
__CSTAT__


1546 
__INLINE
 
ut32_t
 
NVIC_GPriܙy
(
IRQn_Ty
 
IRQn
)

1549 if(
	gIRQn
 < 0) {

1550 ((
	gut32_t
)(
	gSCB
->
	gSHP
[((
ut32_t
)(
IRQn
& 0xF)-4] >> (8 - 
	g__NVIC_PRIO_BITS
))); }

1552 ((
	gut32_t
)(
	gNVIC
->
	gIP
[(
ut32_t
)(
IRQn
)] >> (8 - 
	g__NVIC_PRIO_BITS
))); }

1571 
__INLINE
 
ut32_t
 
NVIC_EncodePriܙy
 (ut32_
PriܙyGroup
, ut32_
PemPriܙy
, ut32_
SubPriܙy
)

1573 
ut32_t
 
	gPriܙyGroupTmp
 = (
PriܙyGroup
 & 0x07);

1574 
ut32_t
 
	gPemPriܙyBs
;

1575 
ut32_t
 
	gSubPriܙyBs
;

1577 
	gPemPriܙyBs
 = ((7 - 
PriܙyGroupTmp
> 
__NVIC_PRIO_BITS
) ? __NVIC_PRIO_BITS : 7 - PriorityGroupTmp;

1578 
	gSubPriܙyBs
 = ((
PriܙyGroupTmp
 + 
__NVIC_PRIO_BITS
) < 7) ? 0 : PriorityGroupTmp - 7 + __NVIC_PRIO_BITS;

1581 ((
	gPemPriܙy
 & ((1 << (
	gPemPriܙyBs
)- 1)<< 
	gSubPriܙyBs
) |

1582 ((
	gSubPriܙy
 & ((1 << (
	gSubPriܙyBs
 )) - 1)))

1602 
__INLINE
 
NVIC_DecodePriܙy
 (
ut32_t
 
Priܙy
, ut32_
PriܙyGroup
, ut32_t* 
pPemPriܙy
, ut32_t* 
pSubPriܙy
)

1604 
ut32_t
 
	gPriܙyGroupTmp
 = (
PriܙyGroup
 & 0x07);

1605 
ut32_t
 
	gPemPriܙyBs
;

1606 
ut32_t
 
	gSubPriܙyBs
;

1608 
	gPemPriܙyBs
 = ((7 - 
PriܙyGroupTmp
> 
__NVIC_PRIO_BITS
) ? __NVIC_PRIO_BITS : 7 - PriorityGroupTmp;

1609 
	gSubPriܙyBs
 = ((
PriܙyGroupTmp
 + 
__NVIC_PRIO_BITS
) < 7) ? 0 : PriorityGroupTmp - 7 + __NVIC_PRIO_BITS;

1611 *
	gpPemPriܙy
 = (
Priܙy
 >> 
SubPriܙyBs
& ((1 << (
PemPriܙyBs
)) - 1);

1612 *
	gpSubPriܙy
 = (
Priܙy
 ) & ((1 << (
SubPriܙyBs
 )) - 1);

1619 #i(!
defed
 (
__Vd_SysTickCfig
)) || (__Vendor_SysTickConfig == 0)

1631 
__INLINE
 
ut32_t
 
SysTick_Cfig
(ut32_
ticks
)

1633 i(
	gticks
 > 
	gSysTick_LOAD_RELOAD_Msk
)  (1);

1635 
	gSysTick
->
	gLOAD
 = (
ticks
 & 
SysTick_LOAD_RELOAD_Msk
) - 1;

1636 
NVIC_SPriܙy
 (
SysTick_IRQn
, (1<<
__NVIC_PRIO_BITS
) - 1);

1637 
	gSysTick
->
	gVAL
 = 0;

1638 
	gSysTick
->
	gCTRL
 = 
SysTick_CTRL_CLKSOURCE_Msk
 |

1639 
SysTick_CTRL_TICKINT_Msk
 |

1640 
SysTick_CTRL_ENABLE_Msk
;

1656 
__INLINE
 
NVIC_SyemRet
()

1658 
	gSCB
->
	gAIRCR
 = ((0x5FA << 
SCB_AIRCR_VECTKEY_Pos
) |

1659 (
SCB
->
AIRCR
 & 
SCB_AIRCR_PRIGROUP_Msk
) |

1660 
SCB_AIRCR_SYSRESETREQ_Msk
);

1661 
__DSB
();

1679 vީ
ITM_RxBufr
;

1680 
	#ITM_RXBUFFER_EMPTY
 0x5AA55AA5

	)

1693 
__INLINE
 
ut32_t
 
ITM_SdCh
 (ut32_
ch
)

1695 i((
	gCeDebug
->
	gDEMCR
 & 
	gCeDebug_DEMCR_TRCENA_Msk
) &&

1696 (
	gITM
->
	gTCR
 & 
	gITM_TCR_ITMENA_Msk
) &&

1697 (
	gITM
->
	gTER
 & (1ul << 0) ) )

1699 
	gITM
->
	gPORT
[0].
	gu32
 == 0);

1700 
	gITM
->
	gPORT
[0].
	gu8
 = (
ut8_t

ch
;

1702  (
	gch
);

1715 
__INLINE
 
ITM_ReiveCh
 () {

1716 
	gch
 = -1;

1718 i(
	gITM_RxBufr
 !
ITM_RXBUFFER_EMPTY
) {

1719 
ch
 = 
ITM_RxBufr
;

1720 
	gITM_RxBufr
 = 
ITM_RXBUFFER_EMPTY
;

1723  (
	gch
);

1735 
__INLINE
 
ITM_CheckCh
 () {

1737 i(
	gITM_RxBufr
 =
ITM_RXBUFFER_EMPTY
) {

1747 #ifde
__lulus


	@ports/stm32f10x/CMSIS/stm32f10x.h

34 #ide
__STM32F10x_H


35 
	#__STM32F10x_H


	)

37 #ifde
__lulus


49 #i!
defed
 (
STM32F10X_LD
&& !defed (
STM32F10X_LD_VL
&& !defed (
STM32F10X_MD
&& !defed (
STM32F10X_MD_VL
&& !defed (
STM32F10X_HD
&& !defed (
STM32F10X_HD_VL
&& !defed (
STM32F10X_XL
&& !defed (
STM32F10X_CL
)

79 #i!
defed
 (
STM32F10X_LD
&& !defed (
STM32F10X_LD_VL
&& !defed (
STM32F10X_MD
&& !defed (
STM32F10X_MD_VL
&& !defed (
STM32F10X_HD
&& !defed (
STM32F10X_HD_VL
&& !defed (
STM32F10X_XL
&& !defed (
STM32F10X_CL
)

83 #i!
defed
 
USE_STDPERIPH_DRIVER


99 #i!
defed
 
HSE_VALUE


100 #ifde
STM32F10X_CL


101 
	#HSE_VALUE
 ((
ut32_t
)25000000

	)

103 
	#HSE_VALUE
 ((
ut32_t
)8000000

	)

112 
	#HSE_STARTUP_TIMEOUT
 ((
ut16_t
)0x0500

	)

114 
	#HSI_VALUE
 ((
ut32_t
)8000000

	)

119 
	#__STM32F10X_STDPERIPH_VERSION_MAIN
 (0x03

	)

120 
	#__STM32F10X_STDPERIPH_VERSION_SUB1
 (0x04

	)

121 
	#__STM32F10X_STDPERIPH_VERSION_SUB2
 (0x00

	)

122 
	#__STM32F10X_STDPERIPH_VERSION
 ((
__STM32F10X_STDPERIPH_VERSION_MAIN
 << 16)\

123 | (
__STM32F10X_STDPERIPH_VERSION_SUB1
 << 8)\

124 | 
__STM32F10X_STDPERIPH_VERSION_SUB2
)

	)

137 #ifde
STM32F10X_XL


138 
	#__MPU_PRESENT
 1

	)

140 
	#__MPU_PRESENT
 0

	)

142 
	#__NVIC_PRIO_BITS
 4

	)

143 
	#__Vd_SysTickCfig
 0

	)

149 
	eIRQn


152 
NMaskabI_IRQn
 = -14,

153 
MemyMagemt_IRQn
 = -12,

154 
BusFau_IRQn
 = -11,

155 
UgeFau_IRQn
 = -10,

156 
SVCl_IRQn
 = -5,

157 
DebugMڙ_IRQn
 = -4,

158 
PdSV_IRQn
 = -2,

159 
SysTick_IRQn
 = -1,

162 
WWDG_IRQn
 = 0,

163 
PVD_IRQn
 = 1,

164 
TAMPER_IRQn
 = 2,

165 
RTC_IRQn
 = 3,

166 
FLASH_IRQn
 = 4,

167 
RCC_IRQn
 = 5,

168 
EXTI0_IRQn
 = 6,

169 
EXTI1_IRQn
 = 7,

170 
EXTI2_IRQn
 = 8,

171 
EXTI3_IRQn
 = 9,

172 
EXTI4_IRQn
 = 10,

173 
DMA1_Chl1_IRQn
 = 11,

174 
DMA1_Chl2_IRQn
 = 12,

175 
DMA1_Chl3_IRQn
 = 13,

176 
DMA1_Chl4_IRQn
 = 14,

177 
DMA1_Chl5_IRQn
 = 15,

178 
DMA1_Chl6_IRQn
 = 16,

179 
DMA1_Chl7_IRQn
 = 17,

181 #ifde
STM32F10X_LD


182 
ADC1_2_IRQn
 = 18,

183 
USB_HP_CAN1_TX_IRQn
 = 19,

184 
USB_LP_CAN1_RX0_IRQn
 = 20,

185 
CAN1_RX1_IRQn
 = 21,

186 
CAN1_SCE_IRQn
 = 22,

187 
EXTI9_5_IRQn
 = 23,

188 
TIM1_BRK_IRQn
 = 24,

189 
TIM1_UP_IRQn
 = 25,

190 
TIM1_TRG_COM_IRQn
 = 26,

191 
TIM1_CC_IRQn
 = 27,

192 
TIM2_IRQn
 = 28,

193 
TIM3_IRQn
 = 29,

194 
I2C1_EV_IRQn
 = 31,

195 
I2C1_ER_IRQn
 = 32,

196 
SPI1_IRQn
 = 35,

197 
USART1_IRQn
 = 37,

198 
USART2_IRQn
 = 38,

199 
EXTI15_10_IRQn
 = 40,

200 
RTCArm_IRQn
 = 41,

201 
USBWakeUp_IRQn
 = 42

204 #ifde
STM32F10X_LD_VL


205 
ADC1_IRQn
 = 18,

206 
EXTI9_5_IRQn
 = 23,

207 
TIM1_BRK_TIM15_IRQn
 = 24,

208 
TIM1_UP_TIM16_IRQn
 = 25,

209 
TIM1_TRG_COM_TIM17_IRQn
 = 26,

210 
TIM1_CC_IRQn
 = 27,

211 
TIM2_IRQn
 = 28,

212 
TIM3_IRQn
 = 29,

213 
I2C1_EV_IRQn
 = 31,

214 
I2C1_ER_IRQn
 = 32,

215 
SPI1_IRQn
 = 35,

216 
USART1_IRQn
 = 37,

217 
USART2_IRQn
 = 38,

218 
EXTI15_10_IRQn
 = 40,

219 
RTCArm_IRQn
 = 41,

220 
CEC_IRQn
 = 42,

221 
TIM6_DAC_IRQn
 = 54,

222 
TIM7_IRQn
 = 55

225 #ifde
STM32F10X_MD


226 
ADC1_2_IRQn
 = 18,

227 
USB_HP_CAN1_TX_IRQn
 = 19,

228 
USB_LP_CAN1_RX0_IRQn
 = 20,

229 
CAN1_RX1_IRQn
 = 21,

230 
CAN1_SCE_IRQn
 = 22,

231 
EXTI9_5_IRQn
 = 23,

232 
TIM1_BRK_IRQn
 = 24,

233 
TIM1_UP_IRQn
 = 25,

234 
TIM1_TRG_COM_IRQn
 = 26,

235 
TIM1_CC_IRQn
 = 27,

236 
TIM2_IRQn
 = 28,

237 
TIM3_IRQn
 = 29,

238 
TIM4_IRQn
 = 30,

239 
I2C1_EV_IRQn
 = 31,

240 
I2C1_ER_IRQn
 = 32,

241 
I2C2_EV_IRQn
 = 33,

242 
I2C2_ER_IRQn
 = 34,

243 
SPI1_IRQn
 = 35,

244 
SPI2_IRQn
 = 36,

245 
USART1_IRQn
 = 37,

246 
USART2_IRQn
 = 38,

247 
USART3_IRQn
 = 39,

248 
EXTI15_10_IRQn
 = 40,

249 
RTCArm_IRQn
 = 41,

250 
USBWakeUp_IRQn
 = 42

253 #ifde
STM32F10X_MD_VL


254 
ADC1_IRQn
 = 18,

255 
EXTI9_5_IRQn
 = 23,

256 
TIM1_BRK_TIM15_IRQn
 = 24,

257 
TIM1_UP_TIM16_IRQn
 = 25,

258 
TIM1_TRG_COM_TIM17_IRQn
 = 26,

259 
TIM1_CC_IRQn
 = 27,

260 
TIM2_IRQn
 = 28,

261 
TIM3_IRQn
 = 29,

262 
TIM4_IRQn
 = 30,

263 
I2C1_EV_IRQn
 = 31,

264 
I2C1_ER_IRQn
 = 32,

265 
I2C2_EV_IRQn
 = 33,

266 
I2C2_ER_IRQn
 = 34,

267 
SPI1_IRQn
 = 35,

268 
SPI2_IRQn
 = 36,

269 
USART1_IRQn
 = 37,

270 
USART2_IRQn
 = 38,

271 
USART3_IRQn
 = 39,

272 
EXTI15_10_IRQn
 = 40,

273 
RTCArm_IRQn
 = 41,

274 
CEC_IRQn
 = 42,

275 
TIM6_DAC_IRQn
 = 54,

276 
TIM7_IRQn
 = 55

279 #ifde
STM32F10X_HD


280 
ADC1_2_IRQn
 = 18,

281 
USB_HP_CAN1_TX_IRQn
 = 19,

282 
USB_LP_CAN1_RX0_IRQn
 = 20,

283 
CAN1_RX1_IRQn
 = 21,

284 
CAN1_SCE_IRQn
 = 22,

285 
EXTI9_5_IRQn
 = 23,

286 
TIM1_BRK_IRQn
 = 24,

287 
TIM1_UP_IRQn
 = 25,

288 
TIM1_TRG_COM_IRQn
 = 26,

289 
TIM1_CC_IRQn
 = 27,

290 
TIM2_IRQn
 = 28,

291 
TIM3_IRQn
 = 29,

292 
TIM4_IRQn
 = 30,

293 
I2C1_EV_IRQn
 = 31,

294 
I2C1_ER_IRQn
 = 32,

295 
I2C2_EV_IRQn
 = 33,

296 
I2C2_ER_IRQn
 = 34,

297 
SPI1_IRQn
 = 35,

298 
SPI2_IRQn
 = 36,

299 
USART1_IRQn
 = 37,

300 
USART2_IRQn
 = 38,

301 
USART3_IRQn
 = 39,

302 
EXTI15_10_IRQn
 = 40,

303 
RTCArm_IRQn
 = 41,

304 
USBWakeUp_IRQn
 = 42,

305 
TIM8_BRK_IRQn
 = 43,

306 
TIM8_UP_IRQn
 = 44,

307 
TIM8_TRG_COM_IRQn
 = 45,

308 
TIM8_CC_IRQn
 = 46,

309 
ADC3_IRQn
 = 47,

310 
FSMC_IRQn
 = 48,

311 
SDIO_IRQn
 = 49,

312 
TIM5_IRQn
 = 50,

313 
SPI3_IRQn
 = 51,

314 
UART4_IRQn
 = 52,

315 
UART5_IRQn
 = 53,

316 
TIM6_IRQn
 = 54,

317 
TIM7_IRQn
 = 55,

318 
DMA2_Chl1_IRQn
 = 56,

319 
DMA2_Chl2_IRQn
 = 57,

320 
DMA2_Chl3_IRQn
 = 58,

321 
DMA2_Chl4_5_IRQn
 = 59

324 #ifde
STM32F10X_HD_VL


325 
ADC1_IRQn
 = 18,

326 
EXTI9_5_IRQn
 = 23,

327 
TIM1_BRK_TIM15_IRQn
 = 24,

328 
TIM1_UP_TIM16_IRQn
 = 25,

329 
TIM1_TRG_COM_TIM17_IRQn
 = 26,

330 
TIM1_CC_IRQn
 = 27,

331 
TIM2_IRQn
 = 28,

332 
TIM3_IRQn
 = 29,

333 
TIM4_IRQn
 = 30,

334 
I2C1_EV_IRQn
 = 31,

335 
I2C1_ER_IRQn
 = 32,

336 
I2C2_EV_IRQn
 = 33,

337 
I2C2_ER_IRQn
 = 34,

338 
SPI1_IRQn
 = 35,

339 
SPI2_IRQn
 = 36,

340 
USART1_IRQn
 = 37,

341 
USART2_IRQn
 = 38,

342 
USART3_IRQn
 = 39,

343 
EXTI15_10_IRQn
 = 40,

344 
RTCArm_IRQn
 = 41,

345 
CEC_IRQn
 = 42,

346 
TIM12_IRQn
 = 43,

347 
TIM13_IRQn
 = 44,

348 
TIM14_IRQn
 = 45,

349 
FSMC_IRQn
 = 48,

350 
TIM5_IRQn
 = 50,

351 
SPI3_IRQn
 = 51,

352 
UART4_IRQn
 = 52,

353 
UART5_IRQn
 = 53,

354 
TIM6_DAC_IRQn
 = 54,

355 
TIM7_IRQn
 = 55,

356 
DMA2_Chl1_IRQn
 = 56,

357 
DMA2_Chl2_IRQn
 = 57,

358 
DMA2_Chl3_IRQn
 = 58,

359 
DMA2_Chl4_5_IRQn
 = 59,

360 
DMA2_Chl5_IRQn
 = 60

365 #ifde
STM32F10X_XL


366 
ADC1_2_IRQn
 = 18,

367 
USB_HP_CAN1_TX_IRQn
 = 19,

368 
USB_LP_CAN1_RX0_IRQn
 = 20,

369 
CAN1_RX1_IRQn
 = 21,

370 
CAN1_SCE_IRQn
 = 22,

371 
EXTI9_5_IRQn
 = 23,

372 
TIM1_BRK_TIM9_IRQn
 = 24,

373 
TIM1_UP_TIM10_IRQn
 = 25,

374 
TIM1_TRG_COM_TIM11_IRQn
 = 26,

375 
TIM1_CC_IRQn
 = 27,

376 
TIM2_IRQn
 = 28,

377 
TIM3_IRQn
 = 29,

378 
TIM4_IRQn
 = 30,

379 
I2C1_EV_IRQn
 = 31,

380 
I2C1_ER_IRQn
 = 32,

381 
I2C2_EV_IRQn
 = 33,

382 
I2C2_ER_IRQn
 = 34,

383 
SPI1_IRQn
 = 35,

384 
SPI2_IRQn
 = 36,

385 
USART1_IRQn
 = 37,

386 
USART2_IRQn
 = 38,

387 
USART3_IRQn
 = 39,

388 
EXTI15_10_IRQn
 = 40,

389 
RTCArm_IRQn
 = 41,

390 
USBWakeUp_IRQn
 = 42,

391 
TIM8_BRK_TIM12_IRQn
 = 43,

392 
TIM8_UP_TIM13_IRQn
 = 44,

393 
TIM8_TRG_COM_TIM14_IRQn
 = 45,

394 
TIM8_CC_IRQn
 = 46,

395 
ADC3_IRQn
 = 47,

396 
FSMC_IRQn
 = 48,

397 
SDIO_IRQn
 = 49,

398 
TIM5_IRQn
 = 50,

399 
SPI3_IRQn
 = 51,

400 
UART4_IRQn
 = 52,

401 
UART5_IRQn
 = 53,

402 
TIM6_IRQn
 = 54,

403 
TIM7_IRQn
 = 55,

404 
DMA2_Chl1_IRQn
 = 56,

405 
DMA2_Chl2_IRQn
 = 57,

406 
DMA2_Chl3_IRQn
 = 58,

407 
DMA2_Chl4_5_IRQn
 = 59

410 #ifde
STM32F10X_CL


411 
ADC1_2_IRQn
 = 18,

412 
CAN1_TX_IRQn
 = 19,

413 
CAN1_RX0_IRQn
 = 20,

414 
CAN1_RX1_IRQn
 = 21,

415 
CAN1_SCE_IRQn
 = 22,

416 
EXTI9_5_IRQn
 = 23,

417 
TIM1_BRK_IRQn
 = 24,

418 
TIM1_UP_IRQn
 = 25,

419 
TIM1_TRG_COM_IRQn
 = 26,

420 
TIM1_CC_IRQn
 = 27,

421 
TIM2_IRQn
 = 28,

422 
TIM3_IRQn
 = 29,

423 
TIM4_IRQn
 = 30,

424 
I2C1_EV_IRQn
 = 31,

425 
I2C1_ER_IRQn
 = 32,

426 
I2C2_EV_IRQn
 = 33,

427 
I2C2_ER_IRQn
 = 34,

428 
SPI1_IRQn
 = 35,

429 
SPI2_IRQn
 = 36,

430 
USART1_IRQn
 = 37,

431 
USART2_IRQn
 = 38,

432 
USART3_IRQn
 = 39,

433 
EXTI15_10_IRQn
 = 40,

434 
RTCArm_IRQn
 = 41,

435 
OTG_FS_WKUP_IRQn
 = 42,

436 
TIM5_IRQn
 = 50,

437 
SPI3_IRQn
 = 51,

438 
UART4_IRQn
 = 52,

439 
UART5_IRQn
 = 53,

440 
TIM6_IRQn
 = 54,

441 
TIM7_IRQn
 = 55,

442 
DMA2_Chl1_IRQn
 = 56,

443 
DMA2_Chl2_IRQn
 = 57,

444 
DMA2_Chl3_IRQn
 = 58,

445 
DMA2_Chl4_IRQn
 = 59,

446 
DMA2_Chl5_IRQn
 = 60,

447 
ETH_IRQn
 = 61,

448 
ETH_WKUP_IRQn
 = 62,

449 
CAN2_TX_IRQn
 = 63,

450 
CAN2_RX0_IRQn
 = 64,

451 
CAN2_RX1_IRQn
 = 65,

452 
CAN2_SCE_IRQn
 = 66,

453 
OTG_FS_IRQn
 = 67

455 } 
	tIRQn_Ty
;

461 
	~"ce_cm3.h
"

462 
	~"syem_m32f10x.h
"

463 
	~<dt.h
>

470 
t32_t
 
	ts32
;

471 
t16_t
 
	ts16
;

472 
t8_t
 
	ts8
;

474 cڡ 
	tt32_t
 
	tsc32
;

475 cڡ 
	tt16_t
 
	tsc16
;

476 cڡ 
	tt8_t
 
	tsc8
;

478 
__IO
 
	tt32_t
 
	tvs32
;

479 
__IO
 
	tt16_t
 
	tvs16
;

480 
__IO
 
	tt8_t
 
	tvs8
;

482 
__I
 
	tt32_t
 
	tvsc32
;

483 
__I
 
	tt16_t
 
	tvsc16
;

484 
__I
 
	tt8_t
 
	tvsc8
;

486 
ut32_t
 
	tu32
;

487 
ut16_t
 
	tu16
;

488 
ut8_t
 
	tu8
;

490 cڡ 
	tut32_t
 
	tuc32
;

491 cڡ 
	tut16_t
 
	tuc16
;

492 cڡ 
	tut8_t
 
	tuc8
;

494 
__IO
 
	tut32_t
 
	tvu32
;

495 
__IO
 
	tut16_t
 
	tvu16
;

496 
__IO
 
	tut8_t
 
	tvu8
;

498 
__I
 
	tut32_t
 
	tvuc32
;

499 
__I
 
	tut16_t
 
	tvuc16
;

500 
__I
 
	tut8_t
 
	tvuc8
;

502 um {
RESET
 = 0, 
SET
 = !RESET} 
	tFgStus
, 
	tITStus
;

504 um {
DISABLE
 = 0, 
ENABLE
 = !DISABLE} 
	tFuniڮS
;

505 
	#IS_FUNCTIONAL_STATE
(
STATE
(((STATE=
DISABLE
|| ((STATE=
ENABLE
))

	)

507 um {
ERROR
 = 0, 
SUCCESS
 = !ERROR} 
	tEStus
;

510 
	#HSESUp_TimeOut
 
HSE_STARTUP_TIMEOUT


	)

511 
	#HSE_Vue
 
HSE_VALUE


	)

512 
	#HSI_Vue
 
HSI_VALUE


	)

527 
__IO
 
ut32_t
 
SR
;

528 
__IO
 
ut32_t
 
CR1
;

529 
__IO
 
ut32_t
 
CR2
;

530 
__IO
 
ut32_t
 
SMPR1
;

531 
__IO
 
ut32_t
 
SMPR2
;

532 
__IO
 
ut32_t
 
JOFR1
;

533 
__IO
 
ut32_t
 
JOFR2
;

534 
__IO
 
ut32_t
 
JOFR3
;

535 
__IO
 
ut32_t
 
JOFR4
;

536 
__IO
 
ut32_t
 
HTR
;

537 
__IO
 
ut32_t
 
LTR
;

538 
__IO
 
ut32_t
 
SQR1
;

539 
__IO
 
ut32_t
 
SQR2
;

540 
__IO
 
ut32_t
 
SQR3
;

541 
__IO
 
ut32_t
 
JSQR
;

542 
__IO
 
ut32_t
 
JDR1
;

543 
__IO
 
ut32_t
 
JDR2
;

544 
__IO
 
ut32_t
 
JDR3
;

545 
__IO
 
ut32_t
 
JDR4
;

546 
__IO
 
ut32_t
 
DR
;

547 } 
	tADC_TyDef
;

555 
ut32_t
 
RESERVED0
;

556 
__IO
 
ut16_t
 
DR1
;

557 
ut16_t
 
RESERVED1
;

558 
__IO
 
ut16_t
 
DR2
;

559 
ut16_t
 
RESERVED2
;

560 
__IO
 
ut16_t
 
DR3
;

561 
ut16_t
 
RESERVED3
;

562 
__IO
 
ut16_t
 
DR4
;

563 
ut16_t
 
RESERVED4
;

564 
__IO
 
ut16_t
 
DR5
;

565 
ut16_t
 
RESERVED5
;

566 
__IO
 
ut16_t
 
DR6
;

567 
ut16_t
 
RESERVED6
;

568 
__IO
 
ut16_t
 
DR7
;

569 
ut16_t
 
RESERVED7
;

570 
__IO
 
ut16_t
 
DR8
;

571 
ut16_t
 
RESERVED8
;

572 
__IO
 
ut16_t
 
DR9
;

573 
ut16_t
 
RESERVED9
;

574 
__IO
 
ut16_t
 
DR10
;

575 
ut16_t
 
RESERVED10
;

576 
__IO
 
ut16_t
 
RTCCR
;

577 
ut16_t
 
RESERVED11
;

578 
__IO
 
ut16_t
 
CR
;

579 
ut16_t
 
RESERVED12
;

580 
__IO
 
ut16_t
 
CSR
;

581 
ut16_t
 
RESERVED13
[5];

582 
__IO
 
ut16_t
 
DR11
;

583 
ut16_t
 
RESERVED14
;

584 
__IO
 
ut16_t
 
DR12
;

585 
ut16_t
 
RESERVED15
;

586 
__IO
 
ut16_t
 
DR13
;

587 
ut16_t
 
RESERVED16
;

588 
__IO
 
ut16_t
 
DR14
;

589 
ut16_t
 
RESERVED17
;

590 
__IO
 
ut16_t
 
DR15
;

591 
ut16_t
 
RESERVED18
;

592 
__IO
 
ut16_t
 
DR16
;

593 
ut16_t
 
RESERVED19
;

594 
__IO
 
ut16_t
 
DR17
;

595 
ut16_t
 
RESERVED20
;

596 
__IO
 
ut16_t
 
DR18
;

597 
ut16_t
 
RESERVED21
;

598 
__IO
 
ut16_t
 
DR19
;

599 
ut16_t
 
RESERVED22
;

600 
__IO
 
ut16_t
 
DR20
;

601 
ut16_t
 
RESERVED23
;

602 
__IO
 
ut16_t
 
DR21
;

603 
ut16_t
 
RESERVED24
;

604 
__IO
 
ut16_t
 
DR22
;

605 
ut16_t
 
RESERVED25
;

606 
__IO
 
ut16_t
 
DR23
;

607 
ut16_t
 
RESERVED26
;

608 
__IO
 
ut16_t
 
DR24
;

609 
ut16_t
 
RESERVED27
;

610 
__IO
 
ut16_t
 
DR25
;

611 
ut16_t
 
RESERVED28
;

612 
__IO
 
ut16_t
 
DR26
;

613 
ut16_t
 
RESERVED29
;

614 
__IO
 
ut16_t
 
DR27
;

615 
ut16_t
 
RESERVED30
;

616 
__IO
 
ut16_t
 
DR28
;

617 
ut16_t
 
RESERVED31
;

618 
__IO
 
ut16_t
 
DR29
;

619 
ut16_t
 
RESERVED32
;

620 
__IO
 
ut16_t
 
DR30
;

621 
ut16_t
 
RESERVED33
;

622 
__IO
 
ut16_t
 
DR31
;

623 
ut16_t
 
RESERVED34
;

624 
__IO
 
ut16_t
 
DR32
;

625 
ut16_t
 
RESERVED35
;

626 
__IO
 
ut16_t
 
DR33
;

627 
ut16_t
 
RESERVED36
;

628 
__IO
 
ut16_t
 
DR34
;

629 
ut16_t
 
RESERVED37
;

630 
__IO
 
ut16_t
 
DR35
;

631 
ut16_t
 
RESERVED38
;

632 
__IO
 
ut16_t
 
DR36
;

633 
ut16_t
 
RESERVED39
;

634 
__IO
 
ut16_t
 
DR37
;

635 
ut16_t
 
RESERVED40
;

636 
__IO
 
ut16_t
 
DR38
;

637 
ut16_t
 
RESERVED41
;

638 
__IO
 
ut16_t
 
DR39
;

639 
ut16_t
 
RESERVED42
;

640 
__IO
 
ut16_t
 
DR40
;

641 
ut16_t
 
RESERVED43
;

642 
__IO
 
ut16_t
 
DR41
;

643 
ut16_t
 
RESERVED44
;

644 
__IO
 
ut16_t
 
DR42
;

645 
ut16_t
 
RESERVED45
;

646 } 
	tBKP_TyDef
;

654 
__IO
 
ut32_t
 
TIR
;

655 
__IO
 
ut32_t
 
TDTR
;

656 
__IO
 
ut32_t
 
TDLR
;

657 
__IO
 
ut32_t
 
TDHR
;

658 } 
	tCAN_TxMaBox_TyDef
;

666 
__IO
 
ut32_t
 
RIR
;

667 
__IO
 
ut32_t
 
RDTR
;

668 
__IO
 
ut32_t
 
RDLR
;

669 
__IO
 
ut32_t
 
RDHR
;

670 } 
	tCAN_FIFOMaBox_TyDef
;

678 
__IO
 
ut32_t
 
FR1
;

679 
__IO
 
ut32_t
 
FR2
;

680 } 
	tCAN_FrRegi_TyDef
;

688 
__IO
 
ut32_t
 
MCR
;

689 
__IO
 
ut32_t
 
MSR
;

690 
__IO
 
ut32_t
 
TSR
;

691 
__IO
 
ut32_t
 
RF0R
;

692 
__IO
 
ut32_t
 
RF1R
;

693 
__IO
 
ut32_t
 
IER
;

694 
__IO
 
ut32_t
 
ESR
;

695 
__IO
 
ut32_t
 
BTR
;

696 
ut32_t
 
RESERVED0
[88];

697 
CAN_TxMaBox_TyDef
 
sTxMaBox
[3];

698 
CAN_FIFOMaBox_TyDef
 
sFIFOMaBox
[2];

699 
ut32_t
 
RESERVED1
[12];

700 
__IO
 
ut32_t
 
FMR
;

701 
__IO
 
ut32_t
 
FM1R
;

702 
ut32_t
 
RESERVED2
;

703 
__IO
 
ut32_t
 
FS1R
;

704 
ut32_t
 
RESERVED3
;

705 
__IO
 
ut32_t
 
FFA1R
;

706 
ut32_t
 
RESERVED4
;

707 
__IO
 
ut32_t
 
FA1R
;

708 
ut32_t
 
RESERVED5
[8];

709 #ide
STM32F10X_CL


710 
CAN_FrRegi_TyDef
 
sFrRegi
[14];

712 
CAN_FrRegi_TyDef
 
sFrRegi
[28];

714 } 
	tCAN_TyDef
;

721 
__IO
 
ut32_t
 
CFGR
;

722 
__IO
 
ut32_t
 
OAR
;

723 
__IO
 
ut32_t
 
PRES
;

724 
__IO
 
ut32_t
 
ESR
;

725 
__IO
 
ut32_t
 
CSR
;

726 
__IO
 
ut32_t
 
TXD
;

727 
__IO
 
ut32_t
 
RXD
;

728 } 
	tCEC_TyDef
;

736 
__IO
 
ut32_t
 
DR
;

737 
__IO
 
ut8_t
 
IDR
;

738 
ut8_t
 
RESERVED0
;

739 
ut16_t
 
RESERVED1
;

740 
__IO
 
ut32_t
 
CR
;

741 } 
	tCRC_TyDef
;

749 
__IO
 
ut32_t
 
CR
;

750 
__IO
 
ut32_t
 
SWTRIGR
;

751 
__IO
 
ut32_t
 
DHR12R1
;

752 
__IO
 
ut32_t
 
DHR12L1
;

753 
__IO
 
ut32_t
 
DHR8R1
;

754 
__IO
 
ut32_t
 
DHR12R2
;

755 
__IO
 
ut32_t
 
DHR12L2
;

756 
__IO
 
ut32_t
 
DHR8R2
;

757 
__IO
 
ut32_t
 
DHR12RD
;

758 
__IO
 
ut32_t
 
DHR12LD
;

759 
__IO
 
ut32_t
 
DHR8RD
;

760 
__IO
 
ut32_t
 
DOR1
;

761 
__IO
 
ut32_t
 
DOR2
;

762 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

763 
__IO
 
ut32_t
 
SR
;

765 } 
	tDAC_TyDef
;

773 
__IO
 
ut32_t
 
IDCODE
;

774 
__IO
 
ut32_t
 
CR
;

775 }
	tDBGMCU_TyDef
;

783 
__IO
 
ut32_t
 
CCR
;

784 
__IO
 
ut32_t
 
CNDTR
;

785 
__IO
 
ut32_t
 
CPAR
;

786 
__IO
 
ut32_t
 
CMAR
;

787 } 
	tDMA_Chl_TyDef
;

791 
__IO
 
ut32_t
 
ISR
;

792 
__IO
 
ut32_t
 
IFCR
;

793 } 
	tDMA_TyDef
;

801 
__IO
 
ut32_t
 
MACCR
;

802 
__IO
 
ut32_t
 
MACFFR
;

803 
__IO
 
ut32_t
 
MACHTHR
;

804 
__IO
 
ut32_t
 
MACHTLR
;

805 
__IO
 
ut32_t
 
MACMIIAR
;

806 
__IO
 
ut32_t
 
MACMIIDR
;

807 
__IO
 
ut32_t
 
MACFCR
;

808 
__IO
 
ut32_t
 
MACVLANTR
;

809 
ut32_t
 
RESERVED0
[2];

810 
__IO
 
ut32_t
 
MACRWUFFR
;

811 
__IO
 
ut32_t
 
MACPMTCSR
;

812 
ut32_t
 
RESERVED1
[2];

813 
__IO
 
ut32_t
 
MACSR
;

814 
__IO
 
ut32_t
 
MACIMR
;

815 
__IO
 
ut32_t
 
MACA0HR
;

816 
__IO
 
ut32_t
 
MACA0LR
;

817 
__IO
 
ut32_t
 
MACA1HR
;

818 
__IO
 
ut32_t
 
MACA1LR
;

819 
__IO
 
ut32_t
 
MACA2HR
;

820 
__IO
 
ut32_t
 
MACA2LR
;

821 
__IO
 
ut32_t
 
MACA3HR
;

822 
__IO
 
ut32_t
 
MACA3LR
;

823 
ut32_t
 
RESERVED2
[40];

824 
__IO
 
ut32_t
 
MMCCR
;

825 
__IO
 
ut32_t
 
MMCRIR
;

826 
__IO
 
ut32_t
 
MMCTIR
;

827 
__IO
 
ut32_t
 
MMCRIMR
;

828 
__IO
 
ut32_t
 
MMCTIMR
;

829 
ut32_t
 
RESERVED3
[14];

830 
__IO
 
ut32_t
 
MMCTGFSCCR
;

831 
__IO
 
ut32_t
 
MMCTGFMSCCR
;

832 
ut32_t
 
RESERVED4
[5];

833 
__IO
 
ut32_t
 
MMCTGFCR
;

834 
ut32_t
 
RESERVED5
[10];

835 
__IO
 
ut32_t
 
MMCRFCECR
;

836 
__IO
 
ut32_t
 
MMCRFAECR
;

837 
ut32_t
 
RESERVED6
[10];

838 
__IO
 
ut32_t
 
MMCRGUFCR
;

839 
ut32_t
 
RESERVED7
[334];

840 
__IO
 
ut32_t
 
PTPTSCR
;

841 
__IO
 
ut32_t
 
PTPSSIR
;

842 
__IO
 
ut32_t
 
PTPTSHR
;

843 
__IO
 
ut32_t
 
PTPTSLR
;

844 
__IO
 
ut32_t
 
PTPTSHUR
;

845 
__IO
 
ut32_t
 
PTPTSLUR
;

846 
__IO
 
ut32_t
 
PTPTSAR
;

847 
__IO
 
ut32_t
 
PTPTTHR
;

848 
__IO
 
ut32_t
 
PTPTTLR
;

849 
ut32_t
 
RESERVED8
[567];

850 
__IO
 
ut32_t
 
DMABMR
;

851 
__IO
 
ut32_t
 
DMATPDR
;

852 
__IO
 
ut32_t
 
DMARPDR
;

853 
__IO
 
ut32_t
 
DMARDLAR
;

854 
__IO
 
ut32_t
 
DMATDLAR
;

855 
__IO
 
ut32_t
 
DMASR
;

856 
__IO
 
ut32_t
 
DMAOMR
;

857 
__IO
 
ut32_t
 
DMAIER
;

858 
__IO
 
ut32_t
 
DMAMFBOCR
;

859 
ut32_t
 
RESERVED9
[9];

860 
__IO
 
ut32_t
 
DMACHTDR
;

861 
__IO
 
ut32_t
 
DMACHRDR
;

862 
__IO
 
ut32_t
 
DMACHTBAR
;

863 
__IO
 
ut32_t
 
DMACHRBAR
;

864 } 
	tETH_TyDef
;

872 
__IO
 
ut32_t
 
IMR
;

873 
__IO
 
ut32_t
 
EMR
;

874 
__IO
 
ut32_t
 
RTSR
;

875 
__IO
 
ut32_t
 
FTSR
;

876 
__IO
 
ut32_t
 
SWIER
;

877 
__IO
 
ut32_t
 
PR
;

878 } 
	tEXTI_TyDef
;

886 
__IO
 
ut32_t
 
ACR
;

887 
__IO
 
ut32_t
 
KEYR
;

888 
__IO
 
ut32_t
 
OPTKEYR
;

889 
__IO
 
ut32_t
 
SR
;

890 
__IO
 
ut32_t
 
CR
;

891 
__IO
 
ut32_t
 
AR
;

892 
__IO
 
ut32_t
 
RESERVED
;

893 
__IO
 
ut32_t
 
OBR
;

894 
__IO
 
ut32_t
 
WRPR
;

895 #ifde
STM32F10X_XL


896 
ut32_t
 
RESERVED1
[8];

897 
__IO
 
ut32_t
 
KEYR2
;

898 
ut32_t
 
RESERVED2
;

899 
__IO
 
ut32_t
 
SR2
;

900 
__IO
 
ut32_t
 
CR2
;

901 
__IO
 
ut32_t
 
AR2
;

903 } 
	tFLASH_TyDef
;

911 
__IO
 
ut16_t
 
RDP
;

912 
__IO
 
ut16_t
 
USER
;

913 
__IO
 
ut16_t
 
Da0
;

914 
__IO
 
ut16_t
 
Da1
;

915 
__IO
 
ut16_t
 
WRP0
;

916 
__IO
 
ut16_t
 
WRP1
;

917 
__IO
 
ut16_t
 
WRP2
;

918 
__IO
 
ut16_t
 
WRP3
;

919 } 
	tOB_TyDef
;

927 
__IO
 
ut32_t
 
BTCR
[8];

928 } 
	tFSMC_Bk1_TyDef
;

936 
__IO
 
ut32_t
 
BWTR
[7];

937 } 
	tFSMC_Bk1E_TyDef
;

945 
__IO
 
ut32_t
 
PCR2
;

946 
__IO
 
ut32_t
 
SR2
;

947 
__IO
 
ut32_t
 
PMEM2
;

948 
__IO
 
ut32_t
 
PATT2
;

949 
ut32_t
 
RESERVED0
;

950 
__IO
 
ut32_t
 
ECCR2
;

951 } 
	tFSMC_Bk2_TyDef
;

959 
__IO
 
ut32_t
 
PCR3
;

960 
__IO
 
ut32_t
 
SR3
;

961 
__IO
 
ut32_t
 
PMEM3
;

962 
__IO
 
ut32_t
 
PATT3
;

963 
ut32_t
 
RESERVED0
;

964 
__IO
 
ut32_t
 
ECCR3
;

965 } 
	tFSMC_Bk3_TyDef
;

973 
__IO
 
ut32_t
 
PCR4
;

974 
__IO
 
ut32_t
 
SR4
;

975 
__IO
 
ut32_t
 
PMEM4
;

976 
__IO
 
ut32_t
 
PATT4
;

977 
__IO
 
ut32_t
 
PIO4
;

978 } 
	tFSMC_Bk4_TyDef
;

986 
__IO
 
ut32_t
 
CRL
;

987 
__IO
 
ut32_t
 
CRH
;

988 
__IO
 
ut32_t
 
IDR
;

989 
__IO
 
ut32_t
 
ODR
;

990 
__IO
 
ut32_t
 
BSRR
;

991 
__IO
 
ut32_t
 
BRR
;

992 
__IO
 
ut32_t
 
LCKR
;

993 } 
	tGPIO_TyDef
;

1001 
__IO
 
ut32_t
 
EVCR
;

1002 
__IO
 
ut32_t
 
MAPR
;

1003 
__IO
 
ut32_t
 
EXTICR
[4];

1004 
ut32_t
 
RESERVED0
;

1005 
__IO
 
ut32_t
 
MAPR2
;

1006 } 
	tAFIO_TyDef
;

1013 
__IO
 
ut16_t
 
CR1
;

1014 
ut16_t
 
RESERVED0
;

1015 
__IO
 
ut16_t
 
CR2
;

1016 
ut16_t
 
RESERVED1
;

1017 
__IO
 
ut16_t
 
OAR1
;

1018 
ut16_t
 
RESERVED2
;

1019 
__IO
 
ut16_t
 
OAR2
;

1020 
ut16_t
 
RESERVED3
;

1021 
__IO
 
ut16_t
 
DR
;

1022 
ut16_t
 
RESERVED4
;

1023 
__IO
 
ut16_t
 
SR1
;

1024 
ut16_t
 
RESERVED5
;

1025 
__IO
 
ut16_t
 
SR2
;

1026 
ut16_t
 
RESERVED6
;

1027 
__IO
 
ut16_t
 
CCR
;

1028 
ut16_t
 
RESERVED7
;

1029 
__IO
 
ut16_t
 
TRISE
;

1030 
ut16_t
 
RESERVED8
;

1031 } 
	tI2C_TyDef
;

1039 
__IO
 
ut32_t
 
KR
;

1040 
__IO
 
ut32_t
 
PR
;

1041 
__IO
 
ut32_t
 
RLR
;

1042 
__IO
 
ut32_t
 
SR
;

1043 } 
	tIWDG_TyDef
;

1051 
__IO
 
ut32_t
 
CR
;

1052 
__IO
 
ut32_t
 
CSR
;

1053 } 
	tPWR_TyDef
;

1061 
__IO
 
ut32_t
 
CR
;

1062 
__IO
 
ut32_t
 
CFGR
;

1063 
__IO
 
ut32_t
 
CIR
;

1064 
__IO
 
ut32_t
 
APB2RSTR
;

1065 
__IO
 
ut32_t
 
APB1RSTR
;

1066 
__IO
 
ut32_t
 
AHBENR
;

1067 
__IO
 
ut32_t
 
APB2ENR
;

1068 
__IO
 
ut32_t
 
APB1ENR
;

1069 
__IO
 
ut32_t
 
BDCR
;

1070 
__IO
 
ut32_t
 
CSR
;

1072 #ifde
STM32F10X_CL


1073 
__IO
 
ut32_t
 
AHBRSTR
;

1074 
__IO
 
ut32_t
 
CFGR2
;

1077 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

1078 
ut32_t
 
RESERVED0
;

1079 
__IO
 
ut32_t
 
CFGR2
;

1081 } 
	tRCC_TyDef
;

1089 
__IO
 
ut16_t
 
CRH
;

1090 
ut16_t
 
RESERVED0
;

1091 
__IO
 
ut16_t
 
CRL
;

1092 
ut16_t
 
RESERVED1
;

1093 
__IO
 
ut16_t
 
PRLH
;

1094 
ut16_t
 
RESERVED2
;

1095 
__IO
 
ut16_t
 
PRLL
;

1096 
ut16_t
 
RESERVED3
;

1097 
__IO
 
ut16_t
 
DIVH
;

1098 
ut16_t
 
RESERVED4
;

1099 
__IO
 
ut16_t
 
DIVL
;

1100 
ut16_t
 
RESERVED5
;

1101 
__IO
 
ut16_t
 
CNTH
;

1102 
ut16_t
 
RESERVED6
;

1103 
__IO
 
ut16_t
 
CNTL
;

1104 
ut16_t
 
RESERVED7
;

1105 
__IO
 
ut16_t
 
ALRH
;

1106 
ut16_t
 
RESERVED8
;

1107 
__IO
 
ut16_t
 
ALRL
;

1108 
ut16_t
 
RESERVED9
;

1109 } 
	tRTC_TyDef
;

1117 
__IO
 
ut32_t
 
POWER
;

1118 
__IO
 
ut32_t
 
CLKCR
;

1119 
__IO
 
ut32_t
 
ARG
;

1120 
__IO
 
ut32_t
 
CMD
;

1121 
__I
 
ut32_t
 
RESPCMD
;

1122 
__I
 
ut32_t
 
RESP1
;

1123 
__I
 
ut32_t
 
RESP2
;

1124 
__I
 
ut32_t
 
RESP3
;

1125 
__I
 
ut32_t
 
RESP4
;

1126 
__IO
 
ut32_t
 
DTIMER
;

1127 
__IO
 
ut32_t
 
DLEN
;

1128 
__IO
 
ut32_t
 
DCTRL
;

1129 
__I
 
ut32_t
 
DCOUNT
;

1130 
__I
 
ut32_t
 
STA
;

1131 
__IO
 
ut32_t
 
ICR
;

1132 
__IO
 
ut32_t
 
MASK
;

1133 
ut32_t
 
RESERVED0
[2];

1134 
__I
 
ut32_t
 
FIFOCNT
;

1135 
ut32_t
 
RESERVED1
[13];

1136 
__IO
 
ut32_t
 
FIFO
;

1137 } 
	tSDIO_TyDef
;

1145 
__IO
 
ut16_t
 
CR1
;

1146 
ut16_t
 
RESERVED0
;

1147 
__IO
 
ut16_t
 
CR2
;

1148 
ut16_t
 
RESERVED1
;

1149 
__IO
 
ut16_t
 
SR
;

1150 
ut16_t
 
RESERVED2
;

1151 
__IO
 
ut16_t
 
DR
;

1152 
ut16_t
 
RESERVED3
;

1153 
__IO
 
ut16_t
 
CRCPR
;

1154 
ut16_t
 
RESERVED4
;

1155 
__IO
 
ut16_t
 
RXCRCR
;

1156 
ut16_t
 
RESERVED5
;

1157 
__IO
 
ut16_t
 
TXCRCR
;

1158 
ut16_t
 
RESERVED6
;

1159 
__IO
 
ut16_t
 
I2SCFGR
;

1160 
ut16_t
 
RESERVED7
;

1161 
__IO
 
ut16_t
 
I2SPR
;

1162 
ut16_t
 
RESERVED8
;

1163 } 
	tSPI_TyDef
;

1171 
__IO
 
ut16_t
 
CR1
;

1172 
ut16_t
 
RESERVED0
;

1173 
__IO
 
ut16_t
 
CR2
;

1174 
ut16_t
 
RESERVED1
;

1175 
__IO
 
ut16_t
 
SMCR
;

1176 
ut16_t
 
RESERVED2
;

1177 
__IO
 
ut16_t
 
DIER
;

1178 
ut16_t
 
RESERVED3
;

1179 
__IO
 
ut16_t
 
SR
;

1180 
ut16_t
 
RESERVED4
;

1181 
__IO
 
ut16_t
 
EGR
;

1182 
ut16_t
 
RESERVED5
;

1183 
__IO
 
ut16_t
 
CCMR1
;

1184 
ut16_t
 
RESERVED6
;

1185 
__IO
 
ut16_t
 
CCMR2
;

1186 
ut16_t
 
RESERVED7
;

1187 
__IO
 
ut16_t
 
CCER
;

1188 
ut16_t
 
RESERVED8
;

1189 
__IO
 
ut16_t
 
CNT
;

1190 
ut16_t
 
RESERVED9
;

1191 
__IO
 
ut16_t
 
PSC
;

1192 
ut16_t
 
RESERVED10
;

1193 
__IO
 
ut16_t
 
ARR
;

1194 
ut16_t
 
RESERVED11
;

1195 
__IO
 
ut16_t
 
RCR
;

1196 
ut16_t
 
RESERVED12
;

1197 
__IO
 
ut16_t
 
CCR1
;

1198 
ut16_t
 
RESERVED13
;

1199 
__IO
 
ut16_t
 
CCR2
;

1200 
ut16_t
 
RESERVED14
;

1201 
__IO
 
ut16_t
 
CCR3
;

1202 
ut16_t
 
RESERVED15
;

1203 
__IO
 
ut16_t
 
CCR4
;

1204 
ut16_t
 
RESERVED16
;

1205 
__IO
 
ut16_t
 
BDTR
;

1206 
ut16_t
 
RESERVED17
;

1207 
__IO
 
ut16_t
 
DCR
;

1208 
ut16_t
 
RESERVED18
;

1209 
__IO
 
ut16_t
 
DMAR
;

1210 
ut16_t
 
RESERVED19
;

1211 } 
	tTIM_TyDef
;

1219 
__IO
 
ut16_t
 
SR
;

1220 
ut16_t
 
RESERVED0
;

1221 
__IO
 
ut16_t
 
DR
;

1222 
ut16_t
 
RESERVED1
;

1223 
__IO
 
ut16_t
 
BRR
;

1224 
ut16_t
 
RESERVED2
;

1225 
__IO
 
ut16_t
 
CR1
;

1226 
ut16_t
 
RESERVED3
;

1227 
__IO
 
ut16_t
 
CR2
;

1228 
ut16_t
 
RESERVED4
;

1229 
__IO
 
ut16_t
 
CR3
;

1230 
ut16_t
 
RESERVED5
;

1231 
__IO
 
ut16_t
 
GTPR
;

1232 
ut16_t
 
RESERVED6
;

1233 } 
	tUSART_TyDef
;

1241 
__IO
 
ut32_t
 
CR
;

1242 
__IO
 
ut32_t
 
CFR
;

1243 
__IO
 
ut32_t
 
SR
;

1244 } 
	tWWDG_TyDef
;

1255 
	#FLASH_BASE
 ((
ut32_t
)0x08000000

	)

1256 
	#SRAM_BASE
 ((
ut32_t
)0x20000000

	)

1257 
	#PERIPH_BASE
 ((
ut32_t
)0x40000000

	)

1259 
	#SRAM_BB_BASE
 ((
ut32_t
)0x22000000

	)

1260 
	#PERIPH_BB_BASE
 ((
ut32_t
)0x42000000

	)

1262 
	#FSMC_R_BASE
 ((
ut32_t
)0xA0000000

	)

1265 
	#APB1PERIPH_BASE
 
PERIPH_BASE


	)

1266 
	#APB2PERIPH_BASE
 (
PERIPH_BASE
 + 0x10000)

	)

1267 
	#AHBPERIPH_BASE
 (
PERIPH_BASE
 + 0x20000)

	)

1269 
	#TIM2_BASE
 (
APB1PERIPH_BASE
 + 0x0000)

	)

1270 
	#TIM3_BASE
 (
APB1PERIPH_BASE
 + 0x0400)

	)

1271 
	#TIM4_BASE
 (
APB1PERIPH_BASE
 + 0x0800)

	)

1272 
	#TIM5_BASE
 (
APB1PERIPH_BASE
 + 0x0C00)

	)

1273 
	#TIM6_BASE
 (
APB1PERIPH_BASE
 + 0x1000)

	)

1274 
	#TIM7_BASE
 (
APB1PERIPH_BASE
 + 0x1400)

	)

1275 
	#TIM12_BASE
 (
APB1PERIPH_BASE
 + 0x1800)

	)

1276 
	#TIM13_BASE
 (
APB1PERIPH_BASE
 + 0x1C00)

	)

1277 
	#TIM14_BASE
 (
APB1PERIPH_BASE
 + 0x2000)

	)

1278 
	#RTC_BASE
 (
APB1PERIPH_BASE
 + 0x2800)

	)

1279 
	#WWDG_BASE
 (
APB1PERIPH_BASE
 + 0x2C00)

	)

1280 
	#IWDG_BASE
 (
APB1PERIPH_BASE
 + 0x3000)

	)

1281 
	#SPI2_BASE
 (
APB1PERIPH_BASE
 + 0x3800)

	)

1282 
	#SPI3_BASE
 (
APB1PERIPH_BASE
 + 0x3C00)

	)

1283 
	#USART2_BASE
 (
APB1PERIPH_BASE
 + 0x4400)

	)

1284 
	#USART3_BASE
 (
APB1PERIPH_BASE
 + 0x4800)

	)

1285 
	#UART4_BASE
 (
APB1PERIPH_BASE
 + 0x4C00)

	)

1286 
	#UART5_BASE
 (
APB1PERIPH_BASE
 + 0x5000)

	)

1287 
	#I2C1_BASE
 (
APB1PERIPH_BASE
 + 0x5400)

	)

1288 
	#I2C2_BASE
 (
APB1PERIPH_BASE
 + 0x5800)

	)

1289 
	#CAN1_BASE
 (
APB1PERIPH_BASE
 + 0x6400)

	)

1290 
	#CAN2_BASE
 (
APB1PERIPH_BASE
 + 0x6800)

	)

1291 
	#BKP_BASE
 (
APB1PERIPH_BASE
 + 0x6C00)

	)

1292 
	#PWR_BASE
 (
APB1PERIPH_BASE
 + 0x7000)

	)

1293 
	#DAC_BASE
 (
APB1PERIPH_BASE
 + 0x7400)

	)

1294 
	#CEC_BASE
 (
APB1PERIPH_BASE
 + 0x7800)

	)

1296 
	#AFIO_BASE
 (
APB2PERIPH_BASE
 + 0x0000)

	)

1297 
	#EXTI_BASE
 (
APB2PERIPH_BASE
 + 0x0400)

	)

1298 
	#GPIOA_BASE
 (
APB2PERIPH_BASE
 + 0x0800)

	)

1299 
	#GPIOB_BASE
 (
APB2PERIPH_BASE
 + 0x0C00)

	)

1300 
	#GPIOC_BASE
 (
APB2PERIPH_BASE
 + 0x1000)

	)

1301 
	#GPIOD_BASE
 (
APB2PERIPH_BASE
 + 0x1400)

	)

1302 
	#GPIOE_BASE
 (
APB2PERIPH_BASE
 + 0x1800)

	)

1303 
	#GPIOF_BASE
 (
APB2PERIPH_BASE
 + 0x1C00)

	)

1304 
	#GPIOG_BASE
 (
APB2PERIPH_BASE
 + 0x2000)

	)

1305 
	#ADC1_BASE
 (
APB2PERIPH_BASE
 + 0x2400)

	)

1306 
	#ADC2_BASE
 (
APB2PERIPH_BASE
 + 0x2800)

	)

1307 
	#TIM1_BASE
 (
APB2PERIPH_BASE
 + 0x2C00)

	)

1308 
	#SPI1_BASE
 (
APB2PERIPH_BASE
 + 0x3000)

	)

1309 
	#TIM8_BASE
 (
APB2PERIPH_BASE
 + 0x3400)

	)

1310 
	#USART1_BASE
 (
APB2PERIPH_BASE
 + 0x3800)

	)

1311 
	#ADC3_BASE
 (
APB2PERIPH_BASE
 + 0x3C00)

	)

1312 
	#TIM15_BASE
 (
APB2PERIPH_BASE
 + 0x4000)

	)

1313 
	#TIM16_BASE
 (
APB2PERIPH_BASE
 + 0x4400)

	)

1314 
	#TIM17_BASE
 (
APB2PERIPH_BASE
 + 0x4800)

	)

1315 
	#TIM9_BASE
 (
APB2PERIPH_BASE
 + 0x4C00)

	)

1316 
	#TIM10_BASE
 (
APB2PERIPH_BASE
 + 0x5000)

	)

1317 
	#TIM11_BASE
 (
APB2PERIPH_BASE
 + 0x5400)

	)

1319 
	#SDIO_BASE
 (
PERIPH_BASE
 + 0x18000)

	)

1321 
	#DMA1_BASE
 (
AHBPERIPH_BASE
 + 0x0000)

	)

1322 
	#DMA1_Chl1_BASE
 (
AHBPERIPH_BASE
 + 0x0008)

	)

1323 
	#DMA1_Chl2_BASE
 (
AHBPERIPH_BASE
 + 0x001C)

	)

1324 
	#DMA1_Chl3_BASE
 (
AHBPERIPH_BASE
 + 0x0030)

	)

1325 
	#DMA1_Chl4_BASE
 (
AHBPERIPH_BASE
 + 0x0044)

	)

1326 
	#DMA1_Chl5_BASE
 (
AHBPERIPH_BASE
 + 0x0058)

	)

1327 
	#DMA1_Chl6_BASE
 (
AHBPERIPH_BASE
 + 0x006C)

	)

1328 
	#DMA1_Chl7_BASE
 (
AHBPERIPH_BASE
 + 0x0080)

	)

1329 
	#DMA2_BASE
 (
AHBPERIPH_BASE
 + 0x0400)

	)

1330 
	#DMA2_Chl1_BASE
 (
AHBPERIPH_BASE
 + 0x0408)

	)

1331 
	#DMA2_Chl2_BASE
 (
AHBPERIPH_BASE
 + 0x041C)

	)

1332 
	#DMA2_Chl3_BASE
 (
AHBPERIPH_BASE
 + 0x0430)

	)

1333 
	#DMA2_Chl4_BASE
 (
AHBPERIPH_BASE
 + 0x0444)

	)

1334 
	#DMA2_Chl5_BASE
 (
AHBPERIPH_BASE
 + 0x0458)

	)

1335 
	#RCC_BASE
 (
AHBPERIPH_BASE
 + 0x1000)

	)

1336 
	#CRC_BASE
 (
AHBPERIPH_BASE
 + 0x3000)

	)

1338 
	#FLASH_R_BASE
 (
AHBPERIPH_BASE
 + 0x2000

	)

1339 
	#OB_BASE
 ((
ut32_t
)0x1FFFF800

	)

1341 
	#ETH_BASE
 (
AHBPERIPH_BASE
 + 0x8000)

	)

1342 
	#ETH_MAC_BASE
 (
ETH_BASE
)

	)

1343 
	#ETH_MMC_BASE
 (
ETH_BASE
 + 0x0100)

	)

1344 
	#ETH_PTP_BASE
 (
ETH_BASE
 + 0x0700)

	)

1345 
	#ETH_DMA_BASE
 (
ETH_BASE
 + 0x1000)

	)

1347 
	#FSMC_Bk1_R_BASE
 (
FSMC_R_BASE
 + 0x0000

	)

1348 
	#FSMC_Bk1E_R_BASE
 (
FSMC_R_BASE
 + 0x0104

	)

1349 
	#FSMC_Bk2_R_BASE
 (
FSMC_R_BASE
 + 0x0060

	)

1350 
	#FSMC_Bk3_R_BASE
 (
FSMC_R_BASE
 + 0x0080

	)

1351 
	#FSMC_Bk4_R_BASE
 (
FSMC_R_BASE
 + 0x00A0

	)

1353 
	#DBGMCU_BASE
 ((
ut32_t
)0xE0042000

	)

1363 
	#TIM2
 ((
TIM_TyDef
 *
TIM2_BASE
)

	)

1364 
	#TIM3
 ((
TIM_TyDef
 *
TIM3_BASE
)

	)

1365 
	#TIM4
 ((
TIM_TyDef
 *
TIM4_BASE
)

	)

1366 
	#TIM5
 ((
TIM_TyDef
 *
TIM5_BASE
)

	)

1367 
	#TIM6
 ((
TIM_TyDef
 *
TIM6_BASE
)

	)

1368 
	#TIM7
 ((
TIM_TyDef
 *
TIM7_BASE
)

	)

1369 
	#TIM12
 ((
TIM_TyDef
 *
TIM12_BASE
)

	)

1370 
	#TIM13
 ((
TIM_TyDef
 *
TIM13_BASE
)

	)

1371 
	#TIM14
 ((
TIM_TyDef
 *
TIM14_BASE
)

	)

1372 
	#RTC
 ((
RTC_TyDef
 *
RTC_BASE
)

	)

1373 
	#WWDG
 ((
WWDG_TyDef
 *
WWDG_BASE
)

	)

1374 
	#IWDG
 ((
IWDG_TyDef
 *
IWDG_BASE
)

	)

1375 
	#SPI2
 ((
SPI_TyDef
 *
SPI2_BASE
)

	)

1376 
	#SPI3
 ((
SPI_TyDef
 *
SPI3_BASE
)

	)

1377 
	#USART2
 ((
USART_TyDef
 *
USART2_BASE
)

	)

1378 
	#USART3
 ((
USART_TyDef
 *
USART3_BASE
)

	)

1379 
	#UART4
 ((
USART_TyDef
 *
UART4_BASE
)

	)

1380 
	#UART5
 ((
USART_TyDef
 *
UART5_BASE
)

	)

1381 
	#I2C1
 ((
I2C_TyDef
 *
I2C1_BASE
)

	)

1382 
	#I2C2
 ((
I2C_TyDef
 *
I2C2_BASE
)

	)

1383 
	#CAN1
 ((
CAN_TyDef
 *
CAN1_BASE
)

	)

1384 
	#CAN2
 ((
CAN_TyDef
 *
CAN2_BASE
)

	)

1385 
	#BKP
 ((
BKP_TyDef
 *
BKP_BASE
)

	)

1386 
	#PWR
 ((
PWR_TyDef
 *
PWR_BASE
)

	)

1387 
	#DAC
 ((
DAC_TyDef
 *
DAC_BASE
)

	)

1388 
	#CEC
 ((
CEC_TyDef
 *
CEC_BASE
)

	)

1389 
	#AFIO
 ((
AFIO_TyDef
 *
AFIO_BASE
)

	)

1390 
	#EXTI
 ((
EXTI_TyDef
 *
EXTI_BASE
)

	)

1391 
	#GPIOA
 ((
GPIO_TyDef
 *
GPIOA_BASE
)

	)

1392 
	#GPIOB
 ((
GPIO_TyDef
 *
GPIOB_BASE
)

	)

1393 
	#GPIOC
 ((
GPIO_TyDef
 *
GPIOC_BASE
)

	)

1394 
	#GPIOD
 ((
GPIO_TyDef
 *
GPIOD_BASE
)

	)

1395 
	#GPIOE
 ((
GPIO_TyDef
 *
GPIOE_BASE
)

	)

1396 
	#GPIOF
 ((
GPIO_TyDef
 *
GPIOF_BASE
)

	)

1397 
	#GPIOG
 ((
GPIO_TyDef
 *
GPIOG_BASE
)

	)

1398 
	#ADC1
 ((
ADC_TyDef
 *
ADC1_BASE
)

	)

1399 
	#ADC2
 ((
ADC_TyDef
 *
ADC2_BASE
)

	)

1400 
	#TIM1
 ((
TIM_TyDef
 *
TIM1_BASE
)

	)

1401 
	#SPI1
 ((
SPI_TyDef
 *
SPI1_BASE
)

	)

1402 
	#TIM8
 ((
TIM_TyDef
 *
TIM8_BASE
)

	)

1403 
	#USART1
 ((
USART_TyDef
 *
USART1_BASE
)

	)

1404 
	#ADC3
 ((
ADC_TyDef
 *
ADC3_BASE
)

	)

1405 
	#TIM15
 ((
TIM_TyDef
 *
TIM15_BASE
)

	)

1406 
	#TIM16
 ((
TIM_TyDef
 *
TIM16_BASE
)

	)

1407 
	#TIM17
 ((
TIM_TyDef
 *
TIM17_BASE
)

	)

1408 
	#TIM9
 ((
TIM_TyDef
 *
TIM9_BASE
)

	)

1409 
	#TIM10
 ((
TIM_TyDef
 *
TIM10_BASE
)

	)

1410 
	#TIM11
 ((
TIM_TyDef
 *
TIM11_BASE
)

	)

1411 
	#SDIO
 ((
SDIO_TyDef
 *
SDIO_BASE
)

	)

1412 
	#DMA1
 ((
DMA_TyDef
 *
DMA1_BASE
)

	)

1413 
	#DMA2
 ((
DMA_TyDef
 *
DMA2_BASE
)

	)

1414 
	#DMA1_Chl1
 ((
DMA_Chl_TyDef
 *
DMA1_Chl1_BASE
)

	)

1415 
	#DMA1_Chl2
 ((
DMA_Chl_TyDef
 *
DMA1_Chl2_BASE
)

	)

1416 
	#DMA1_Chl3
 ((
DMA_Chl_TyDef
 *
DMA1_Chl3_BASE
)

	)

1417 
	#DMA1_Chl4
 ((
DMA_Chl_TyDef
 *
DMA1_Chl4_BASE
)

	)

1418 
	#DMA1_Chl5
 ((
DMA_Chl_TyDef
 *
DMA1_Chl5_BASE
)

	)

1419 
	#DMA1_Chl6
 ((
DMA_Chl_TyDef
 *
DMA1_Chl6_BASE
)

	)

1420 
	#DMA1_Chl7
 ((
DMA_Chl_TyDef
 *
DMA1_Chl7_BASE
)

	)

1421 
	#DMA2_Chl1
 ((
DMA_Chl_TyDef
 *
DMA2_Chl1_BASE
)

	)

1422 
	#DMA2_Chl2
 ((
DMA_Chl_TyDef
 *
DMA2_Chl2_BASE
)

	)

1423 
	#DMA2_Chl3
 ((
DMA_Chl_TyDef
 *
DMA2_Chl3_BASE
)

	)

1424 
	#DMA2_Chl4
 ((
DMA_Chl_TyDef
 *
DMA2_Chl4_BASE
)

	)

1425 
	#DMA2_Chl5
 ((
DMA_Chl_TyDef
 *
DMA2_Chl5_BASE
)

	)

1426 
	#RCC
 ((
RCC_TyDef
 *
RCC_BASE
)

	)

1427 
	#CRC
 ((
CRC_TyDef
 *
CRC_BASE
)

	)

1428 
	#FLASH
 ((
FLASH_TyDef
 *
FLASH_R_BASE
)

	)

1429 
	#OB
 ((
OB_TyDef
 *
OB_BASE
)

	)

1430 
	#ETH
 ((
ETH_TyDef
 *
ETH_BASE
)

	)

1431 
	#FSMC_Bk1
 ((
FSMC_Bk1_TyDef
 *
FSMC_Bk1_R_BASE
)

	)

1432 
	#FSMC_Bk1E
 ((
FSMC_Bk1E_TyDef
 *
FSMC_Bk1E_R_BASE
)

	)

1433 
	#FSMC_Bk2
 ((
FSMC_Bk2_TyDef
 *
FSMC_Bk2_R_BASE
)

	)

1434 
	#FSMC_Bk3
 ((
FSMC_Bk3_TyDef
 *
FSMC_Bk3_R_BASE
)

	)

1435 
	#FSMC_Bk4
 ((
FSMC_Bk4_TyDef
 *
FSMC_Bk4_R_BASE
)

	)

1436 
	#DBGMCU
 ((
DBGMCU_TyDef
 *
DBGMCU_BASE
)

	)

1461 
	#CRC_DR_DR
 ((
ut32_t
)0xFFFFFFFF

	)

1465 
	#CRC_IDR_IDR
 ((
ut8_t
)0xFF

	)

1469 
	#CRC_CR_RESET
 ((
ut8_t
)0x01

	)

1478 
	#PWR_CR_LPDS
 ((
ut16_t
)0x0001

	)

1479 
	#PWR_CR_PDDS
 ((
ut16_t
)0x0002

	)

1480 
	#PWR_CR_CWUF
 ((
ut16_t
)0x0004

	)

1481 
	#PWR_CR_CSBF
 ((
ut16_t
)0x0008

	)

1482 
	#PWR_CR_PVDE
 ((
ut16_t
)0x0010

	)

1484 
	#PWR_CR_PLS
 ((
ut16_t
)0x00E0

	)

1485 
	#PWR_CR_PLS_0
 ((
ut16_t
)0x0020

	)

1486 
	#PWR_CR_PLS_1
 ((
ut16_t
)0x0040

	)

1487 
	#PWR_CR_PLS_2
 ((
ut16_t
)0x0080

	)

1490 
	#PWR_CR_PLS_2V2
 ((
ut16_t
)0x0000

	)

1491 
	#PWR_CR_PLS_2V3
 ((
ut16_t
)0x0020

	)

1492 
	#PWR_CR_PLS_2V4
 ((
ut16_t
)0x0040

	)

1493 
	#PWR_CR_PLS_2V5
 ((
ut16_t
)0x0060

	)

1494 
	#PWR_CR_PLS_2V6
 ((
ut16_t
)0x0080

	)

1495 
	#PWR_CR_PLS_2V7
 ((
ut16_t
)0x00A0

	)

1496 
	#PWR_CR_PLS_2V8
 ((
ut16_t
)0x00C0

	)

1497 
	#PWR_CR_PLS_2V9
 ((
ut16_t
)0x00E0

	)

1499 
	#PWR_CR_DBP
 ((
ut16_t
)0x0100

	)

1503 
	#PWR_CSR_WUF
 ((
ut16_t
)0x0001

	)

1504 
	#PWR_CSR_SBF
 ((
ut16_t
)0x0002

	)

1505 
	#PWR_CSR_PVDO
 ((
ut16_t
)0x0004

	)

1506 
	#PWR_CSR_EWUP
 ((
ut16_t
)0x0100

	)

1515 
	#BKP_DR1_D
 ((
ut16_t
)0xFFFF

	)

1518 
	#BKP_DR2_D
 ((
ut16_t
)0xFFFF

	)

1521 
	#BKP_DR3_D
 ((
ut16_t
)0xFFFF

	)

1524 
	#BKP_DR4_D
 ((
ut16_t
)0xFFFF

	)

1527 
	#BKP_DR5_D
 ((
ut16_t
)0xFFFF

	)

1530 
	#BKP_DR6_D
 ((
ut16_t
)0xFFFF

	)

1533 
	#BKP_DR7_D
 ((
ut16_t
)0xFFFF

	)

1536 
	#BKP_DR8_D
 ((
ut16_t
)0xFFFF

	)

1539 
	#BKP_DR9_D
 ((
ut16_t
)0xFFFF

	)

1542 
	#BKP_DR10_D
 ((
ut16_t
)0xFFFF

	)

1545 
	#BKP_DR11_D
 ((
ut16_t
)0xFFFF

	)

1548 
	#BKP_DR12_D
 ((
ut16_t
)0xFFFF

	)

1551 
	#BKP_DR13_D
 ((
ut16_t
)0xFFFF

	)

1554 
	#BKP_DR14_D
 ((
ut16_t
)0xFFFF

	)

1557 
	#BKP_DR15_D
 ((
ut16_t
)0xFFFF

	)

1560 
	#BKP_DR16_D
 ((
ut16_t
)0xFFFF

	)

1563 
	#BKP_DR17_D
 ((
ut16_t
)0xFFFF

	)

1566 
	#BKP_DR18_D
 ((
ut16_t
)0xFFFF

	)

1569 
	#BKP_DR19_D
 ((
ut16_t
)0xFFFF

	)

1572 
	#BKP_DR20_D
 ((
ut16_t
)0xFFFF

	)

1575 
	#BKP_DR21_D
 ((
ut16_t
)0xFFFF

	)

1578 
	#BKP_DR22_D
 ((
ut16_t
)0xFFFF

	)

1581 
	#BKP_DR23_D
 ((
ut16_t
)0xFFFF

	)

1584 
	#BKP_DR24_D
 ((
ut16_t
)0xFFFF

	)

1587 
	#BKP_DR25_D
 ((
ut16_t
)0xFFFF

	)

1590 
	#BKP_DR26_D
 ((
ut16_t
)0xFFFF

	)

1593 
	#BKP_DR27_D
 ((
ut16_t
)0xFFFF

	)

1596 
	#BKP_DR28_D
 ((
ut16_t
)0xFFFF

	)

1599 
	#BKP_DR29_D
 ((
ut16_t
)0xFFFF

	)

1602 
	#BKP_DR30_D
 ((
ut16_t
)0xFFFF

	)

1605 
	#BKP_DR31_D
 ((
ut16_t
)0xFFFF

	)

1608 
	#BKP_DR32_D
 ((
ut16_t
)0xFFFF

	)

1611 
	#BKP_DR33_D
 ((
ut16_t
)0xFFFF

	)

1614 
	#BKP_DR34_D
 ((
ut16_t
)0xFFFF

	)

1617 
	#BKP_DR35_D
 ((
ut16_t
)0xFFFF

	)

1620 
	#BKP_DR36_D
 ((
ut16_t
)0xFFFF

	)

1623 
	#BKP_DR37_D
 ((
ut16_t
)0xFFFF

	)

1626 
	#BKP_DR38_D
 ((
ut16_t
)0xFFFF

	)

1629 
	#BKP_DR39_D
 ((
ut16_t
)0xFFFF

	)

1632 
	#BKP_DR40_D
 ((
ut16_t
)0xFFFF

	)

1635 
	#BKP_DR41_D
 ((
ut16_t
)0xFFFF

	)

1638 
	#BKP_DR42_D
 ((
ut16_t
)0xFFFF

	)

1641 
	#BKP_RTCCR_CAL
 ((
ut16_t
)0x007F

	)

1642 
	#BKP_RTCCR_CCO
 ((
ut16_t
)0x0080

	)

1643 
	#BKP_RTCCR_ASOE
 ((
ut16_t
)0x0100

	)

1644 
	#BKP_RTCCR_ASOS
 ((
ut16_t
)0x0200

	)

1647 
	#BKP_CR_TPE
 ((
ut8_t
)0x01

	)

1648 
	#BKP_CR_TPAL
 ((
ut8_t
)0x02

	)

1651 
	#BKP_CSR_CTE
 ((
ut16_t
)0x0001

	)

1652 
	#BKP_CSR_CTI
 ((
ut16_t
)0x0002

	)

1653 
	#BKP_CSR_TPIE
 ((
ut16_t
)0x0004

	)

1654 
	#BKP_CSR_TEF
 ((
ut16_t
)0x0100

	)

1655 
	#BKP_CSR_TIF
 ((
ut16_t
)0x0200

	)

1664 
	#RCC_CR_HSION
 ((
ut32_t
)0x00000001

	)

1665 
	#RCC_CR_HSIRDY
 ((
ut32_t
)0x00000002

	)

1666 
	#RCC_CR_HSITRIM
 ((
ut32_t
)0x000000F8

	)

1667 
	#RCC_CR_HSICAL
 ((
ut32_t
)0x0000FF00

	)

1668 
	#RCC_CR_HSEON
 ((
ut32_t
)0x00010000

	)

1669 
	#RCC_CR_HSERDY
 ((
ut32_t
)0x00020000

	)

1670 
	#RCC_CR_HSEBYP
 ((
ut32_t
)0x00040000

	)

1671 
	#RCC_CR_CSSON
 ((
ut32_t
)0x00080000

	)

1672 
	#RCC_CR_PLLON
 ((
ut32_t
)0x01000000

	)

1673 
	#RCC_CR_PLLRDY
 ((
ut32_t
)0x02000000

	)

1675 #ifde
STM32F10X_CL


1676 
	#RCC_CR_PLL2ON
 ((
ut32_t
)0x04000000

	)

1677 
	#RCC_CR_PLL2RDY
 ((
ut32_t
)0x08000000

	)

1678 
	#RCC_CR_PLL3ON
 ((
ut32_t
)0x10000000

	)

1679 
	#RCC_CR_PLL3RDY
 ((
ut32_t
)0x20000000

	)

1684 
	#RCC_CFGR_SW
 ((
ut32_t
)0x00000003

	)

1685 
	#RCC_CFGR_SW_0
 ((
ut32_t
)0x00000001

	)

1686 
	#RCC_CFGR_SW_1
 ((
ut32_t
)0x00000002

	)

1688 
	#RCC_CFGR_SW_HSI
 ((
ut32_t
)0x00000000

	)

1689 
	#RCC_CFGR_SW_HSE
 ((
ut32_t
)0x00000001

	)

1690 
	#RCC_CFGR_SW_PLL
 ((
ut32_t
)0x00000002

	)

1693 
	#RCC_CFGR_SWS
 ((
ut32_t
)0x0000000C

	)

1694 
	#RCC_CFGR_SWS_0
 ((
ut32_t
)0x00000004

	)

1695 
	#RCC_CFGR_SWS_1
 ((
ut32_t
)0x00000008

	)

1697 
	#RCC_CFGR_SWS_HSI
 ((
ut32_t
)0x00000000

	)

1698 
	#RCC_CFGR_SWS_HSE
 ((
ut32_t
)0x00000004

	)

1699 
	#RCC_CFGR_SWS_PLL
 ((
ut32_t
)0x00000008

	)

1702 
	#RCC_CFGR_HPRE
 ((
ut32_t
)0x000000F0

	)

1703 
	#RCC_CFGR_HPRE_0
 ((
ut32_t
)0x00000010

	)

1704 
	#RCC_CFGR_HPRE_1
 ((
ut32_t
)0x00000020

	)

1705 
	#RCC_CFGR_HPRE_2
 ((
ut32_t
)0x00000040

	)

1706 
	#RCC_CFGR_HPRE_3
 ((
ut32_t
)0x00000080

	)

1708 
	#RCC_CFGR_HPRE_DIV1
 ((
ut32_t
)0x00000000

	)

1709 
	#RCC_CFGR_HPRE_DIV2
 ((
ut32_t
)0x00000080

	)

1710 
	#RCC_CFGR_HPRE_DIV4
 ((
ut32_t
)0x00000090

	)

1711 
	#RCC_CFGR_HPRE_DIV8
 ((
ut32_t
)0x000000A0

	)

1712 
	#RCC_CFGR_HPRE_DIV16
 ((
ut32_t
)0x000000B0

	)

1713 
	#RCC_CFGR_HPRE_DIV64
 ((
ut32_t
)0x000000C0

	)

1714 
	#RCC_CFGR_HPRE_DIV128
 ((
ut32_t
)0x000000D0

	)

1715 
	#RCC_CFGR_HPRE_DIV256
 ((
ut32_t
)0x000000E0

	)

1716 
	#RCC_CFGR_HPRE_DIV512
 ((
ut32_t
)0x000000F0

	)

1719 
	#RCC_CFGR_PPRE1
 ((
ut32_t
)0x00000700

	)

1720 
	#RCC_CFGR_PPRE1_0
 ((
ut32_t
)0x00000100

	)

1721 
	#RCC_CFGR_PPRE1_1
 ((
ut32_t
)0x00000200

	)

1722 
	#RCC_CFGR_PPRE1_2
 ((
ut32_t
)0x00000400

	)

1724 
	#RCC_CFGR_PPRE1_DIV1
 ((
ut32_t
)0x00000000

	)

1725 
	#RCC_CFGR_PPRE1_DIV2
 ((
ut32_t
)0x00000400

	)

1726 
	#RCC_CFGR_PPRE1_DIV4
 ((
ut32_t
)0x00000500

	)

1727 
	#RCC_CFGR_PPRE1_DIV8
 ((
ut32_t
)0x00000600

	)

1728 
	#RCC_CFGR_PPRE1_DIV16
 ((
ut32_t
)0x00000700

	)

1731 
	#RCC_CFGR_PPRE2
 ((
ut32_t
)0x00003800

	)

1732 
	#RCC_CFGR_PPRE2_0
 ((
ut32_t
)0x00000800

	)

1733 
	#RCC_CFGR_PPRE2_1
 ((
ut32_t
)0x00001000

	)

1734 
	#RCC_CFGR_PPRE2_2
 ((
ut32_t
)0x00002000

	)

1736 
	#RCC_CFGR_PPRE2_DIV1
 ((
ut32_t
)0x00000000

	)

1737 
	#RCC_CFGR_PPRE2_DIV2
 ((
ut32_t
)0x00002000

	)

1738 
	#RCC_CFGR_PPRE2_DIV4
 ((
ut32_t
)0x00002800

	)

1739 
	#RCC_CFGR_PPRE2_DIV8
 ((
ut32_t
)0x00003000

	)

1740 
	#RCC_CFGR_PPRE2_DIV16
 ((
ut32_t
)0x00003800

	)

1743 
	#RCC_CFGR_ADCPRE
 ((
ut32_t
)0x0000C000

	)

1744 
	#RCC_CFGR_ADCPRE_0
 ((
ut32_t
)0x00004000

	)

1745 
	#RCC_CFGR_ADCPRE_1
 ((
ut32_t
)0x00008000

	)

1747 
	#RCC_CFGR_ADCPRE_DIV2
 ((
ut32_t
)0x00000000

	)

1748 
	#RCC_CFGR_ADCPRE_DIV4
 ((
ut32_t
)0x00004000

	)

1749 
	#RCC_CFGR_ADCPRE_DIV6
 ((
ut32_t
)0x00008000

	)

1750 
	#RCC_CFGR_ADCPRE_DIV8
 ((
ut32_t
)0x0000C000

	)

1752 
	#RCC_CFGR_PLLSRC
 ((
ut32_t
)0x00010000

	)

1754 
	#RCC_CFGR_PLLXTPRE
 ((
ut32_t
)0x00020000

	)

1757 
	#RCC_CFGR_PLLMULL
 ((
ut32_t
)0x003C0000

	)

1758 
	#RCC_CFGR_PLLMULL_0
 ((
ut32_t
)0x00040000

	)

1759 
	#RCC_CFGR_PLLMULL_1
 ((
ut32_t
)0x00080000

	)

1760 
	#RCC_CFGR_PLLMULL_2
 ((
ut32_t
)0x00100000

	)

1761 
	#RCC_CFGR_PLLMULL_3
 ((
ut32_t
)0x00200000

	)

1763 #ifde
STM32F10X_CL


1764 
	#RCC_CFGR_PLLSRC_HSI_Div2
 ((
ut32_t
)0x00000000

	)

1765 
	#RCC_CFGR_PLLSRC_PREDIV1
 ((
ut32_t
)0x00010000

	)

1767 
	#RCC_CFGR_PLLXTPRE_PREDIV1
 ((
ut32_t
)0x00000000

	)

1768 
	#RCC_CFGR_PLLXTPRE_PREDIV1_Div2
 ((
ut32_t
)0x00020000

	)

1770 
	#RCC_CFGR_PLLMULL4
 ((
ut32_t
)0x00080000

	)

1771 
	#RCC_CFGR_PLLMULL5
 ((
ut32_t
)0x000C0000

	)

1772 
	#RCC_CFGR_PLLMULL6
 ((
ut32_t
)0x00100000

	)

1773 
	#RCC_CFGR_PLLMULL7
 ((
ut32_t
)0x00140000

	)

1774 
	#RCC_CFGR_PLLMULL8
 ((
ut32_t
)0x00180000

	)

1775 
	#RCC_CFGR_PLLMULL9
 ((
ut32_t
)0x001C0000

	)

1776 
	#RCC_CFGR_PLLMULL6_5
 ((
ut32_t
)0x00340000

	)

1778 
	#RCC_CFGR_OTGFSPRE
 ((
ut32_t
)0x00400000

	)

1781 
	#RCC_CFGR_MCO
 ((
ut32_t
)0x0F000000

	)

1782 
	#RCC_CFGR_MCO_0
 ((
ut32_t
)0x01000000

	)

1783 
	#RCC_CFGR_MCO_1
 ((
ut32_t
)0x02000000

	)

1784 
	#RCC_CFGR_MCO_2
 ((
ut32_t
)0x04000000

	)

1785 
	#RCC_CFGR_MCO_3
 ((
ut32_t
)0x08000000

	)

1787 
	#RCC_CFGR_MCO_NOCLOCK
 ((
ut32_t
)0x00000000

	)

1788 
	#RCC_CFGR_MCO_SYSCLK
 ((
ut32_t
)0x04000000

	)

1789 
	#RCC_CFGR_MCO_HSI
 ((
ut32_t
)0x05000000

	)

1790 
	#RCC_CFGR_MCO_HSE
 ((
ut32_t
)0x06000000

	)

1791 
	#RCC_CFGR_MCO_PLLCLK_Div2
 ((
ut32_t
)0x07000000

	)

1792 
	#RCC_CFGR_MCO_PLL2CLK
 ((
ut32_t
)0x08000000

	)

1793 
	#RCC_CFGR_MCO_PLL3CLK_Div2
 ((
ut32_t
)0x09000000

	)

1794 
	#RCC_CFGR_MCO_Ext_HSE
 ((
ut32_t
)0x0A000000

	)

1795 
	#RCC_CFGR_MCO_PLL3CLK
 ((
ut32_t
)0x0B000000

	)

1796 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

1797 
	#RCC_CFGR_PLLSRC_HSI_Div2
 ((
ut32_t
)0x00000000

	)

1798 
	#RCC_CFGR_PLLSRC_PREDIV1
 ((
ut32_t
)0x00010000

	)

1800 
	#RCC_CFGR_PLLXTPRE_PREDIV1
 ((
ut32_t
)0x00000000

	)

1801 
	#RCC_CFGR_PLLXTPRE_PREDIV1_Div2
 ((
ut32_t
)0x00020000

	)

1803 
	#RCC_CFGR_PLLMULL2
 ((
ut32_t
)0x00000000

	)

1804 
	#RCC_CFGR_PLLMULL3
 ((
ut32_t
)0x00040000

	)

1805 
	#RCC_CFGR_PLLMULL4
 ((
ut32_t
)0x00080000

	)

1806 
	#RCC_CFGR_PLLMULL5
 ((
ut32_t
)0x000C0000

	)

1807 
	#RCC_CFGR_PLLMULL6
 ((
ut32_t
)0x00100000

	)

1808 
	#RCC_CFGR_PLLMULL7
 ((
ut32_t
)0x00140000

	)

1809 
	#RCC_CFGR_PLLMULL8
 ((
ut32_t
)0x00180000

	)

1810 
	#RCC_CFGR_PLLMULL9
 ((
ut32_t
)0x001C0000

	)

1811 
	#RCC_CFGR_PLLMULL10
 ((
ut32_t
)0x00200000

	)

1812 
	#RCC_CFGR_PLLMULL11
 ((
ut32_t
)0x00240000

	)

1813 
	#RCC_CFGR_PLLMULL12
 ((
ut32_t
)0x00280000

	)

1814 
	#RCC_CFGR_PLLMULL13
 ((
ut32_t
)0x002C0000

	)

1815 
	#RCC_CFGR_PLLMULL14
 ((
ut32_t
)0x00300000

	)

1816 
	#RCC_CFGR_PLLMULL15
 ((
ut32_t
)0x00340000

	)

1817 
	#RCC_CFGR_PLLMULL16
 ((
ut32_t
)0x00380000

	)

1820 
	#RCC_CFGR_MCO
 ((
ut32_t
)0x07000000

	)

1821 
	#RCC_CFGR_MCO_0
 ((
ut32_t
)0x01000000

	)

1822 
	#RCC_CFGR_MCO_1
 ((
ut32_t
)0x02000000

	)

1823 
	#RCC_CFGR_MCO_2
 ((
ut32_t
)0x04000000

	)

1825 
	#RCC_CFGR_MCO_NOCLOCK
 ((
ut32_t
)0x00000000

	)

1826 
	#RCC_CFGR_MCO_SYSCLK
 ((
ut32_t
)0x04000000

	)

1827 
	#RCC_CFGR_MCO_HSI
 ((
ut32_t
)0x05000000

	)

1828 
	#RCC_CFGR_MCO_HSE
 ((
ut32_t
)0x06000000

	)

1829 
	#RCC_CFGR_MCO_PLL
 ((
ut32_t
)0x07000000

	)

1831 
	#RCC_CFGR_PLLSRC_HSI_Div2
 ((
ut32_t
)0x00000000

	)

1832 
	#RCC_CFGR_PLLSRC_HSE
 ((
ut32_t
)0x00010000

	)

1834 
	#RCC_CFGR_PLLXTPRE_HSE
 ((
ut32_t
)0x00000000

	)

1835 
	#RCC_CFGR_PLLXTPRE_HSE_Div2
 ((
ut32_t
)0x00020000

	)

1837 
	#RCC_CFGR_PLLMULL2
 ((
ut32_t
)0x00000000

	)

1838 
	#RCC_CFGR_PLLMULL3
 ((
ut32_t
)0x00040000

	)

1839 
	#RCC_CFGR_PLLMULL4
 ((
ut32_t
)0x00080000

	)

1840 
	#RCC_CFGR_PLLMULL5
 ((
ut32_t
)0x000C0000

	)

1841 
	#RCC_CFGR_PLLMULL6
 ((
ut32_t
)0x00100000

	)

1842 
	#RCC_CFGR_PLLMULL7
 ((
ut32_t
)0x00140000

	)

1843 
	#RCC_CFGR_PLLMULL8
 ((
ut32_t
)0x00180000

	)

1844 
	#RCC_CFGR_PLLMULL9
 ((
ut32_t
)0x001C0000

	)

1845 
	#RCC_CFGR_PLLMULL10
 ((
ut32_t
)0x00200000

	)

1846 
	#RCC_CFGR_PLLMULL11
 ((
ut32_t
)0x00240000

	)

1847 
	#RCC_CFGR_PLLMULL12
 ((
ut32_t
)0x00280000

	)

1848 
	#RCC_CFGR_PLLMULL13
 ((
ut32_t
)0x002C0000

	)

1849 
	#RCC_CFGR_PLLMULL14
 ((
ut32_t
)0x00300000

	)

1850 
	#RCC_CFGR_PLLMULL15
 ((
ut32_t
)0x00340000

	)

1851 
	#RCC_CFGR_PLLMULL16
 ((
ut32_t
)0x00380000

	)

1852 
	#RCC_CFGR_USBPRE
 ((
ut32_t
)0x00400000

	)

1855 
	#RCC_CFGR_MCO
 ((
ut32_t
)0x07000000

	)

1856 
	#RCC_CFGR_MCO_0
 ((
ut32_t
)0x01000000

	)

1857 
	#RCC_CFGR_MCO_1
 ((
ut32_t
)0x02000000

	)

1858 
	#RCC_CFGR_MCO_2
 ((
ut32_t
)0x04000000

	)

1860 
	#RCC_CFGR_MCO_NOCLOCK
 ((
ut32_t
)0x00000000

	)

1861 
	#RCC_CFGR_MCO_SYSCLK
 ((
ut32_t
)0x04000000

	)

1862 
	#RCC_CFGR_MCO_HSI
 ((
ut32_t
)0x05000000

	)

1863 
	#RCC_CFGR_MCO_HSE
 ((
ut32_t
)0x06000000

	)

1864 
	#RCC_CFGR_MCO_PLL
 ((
ut32_t
)0x07000000

	)

1868 
	#RCC_CIR_LSIRDYF
 ((
ut32_t
)0x00000001

	)

1869 
	#RCC_CIR_LSERDYF
 ((
ut32_t
)0x00000002

	)

1870 
	#RCC_CIR_HSIRDYF
 ((
ut32_t
)0x00000004

	)

1871 
	#RCC_CIR_HSERDYF
 ((
ut32_t
)0x00000008

	)

1872 
	#RCC_CIR_PLLRDYF
 ((
ut32_t
)0x00000010

	)

1873 
	#RCC_CIR_CSSF
 ((
ut32_t
)0x00000080

	)

1874 
	#RCC_CIR_LSIRDYIE
 ((
ut32_t
)0x00000100

	)

1875 
	#RCC_CIR_LSERDYIE
 ((
ut32_t
)0x00000200

	)

1876 
	#RCC_CIR_HSIRDYIE
 ((
ut32_t
)0x00000400

	)

1877 
	#RCC_CIR_HSERDYIE
 ((
ut32_t
)0x00000800

	)

1878 
	#RCC_CIR_PLLRDYIE
 ((
ut32_t
)0x00001000

	)

1879 
	#RCC_CIR_LSIRDYC
 ((
ut32_t
)0x00010000

	)

1880 
	#RCC_CIR_LSERDYC
 ((
ut32_t
)0x00020000

	)

1881 
	#RCC_CIR_HSIRDYC
 ((
ut32_t
)0x00040000

	)

1882 
	#RCC_CIR_HSERDYC
 ((
ut32_t
)0x00080000

	)

1883 
	#RCC_CIR_PLLRDYC
 ((
ut32_t
)0x00100000

	)

1884 
	#RCC_CIR_CSSC
 ((
ut32_t
)0x00800000

	)

1886 #ifde
STM32F10X_CL


1887 
	#RCC_CIR_PLL2RDYF
 ((
ut32_t
)0x00000020

	)

1888 
	#RCC_CIR_PLL3RDYF
 ((
ut32_t
)0x00000040

	)

1889 
	#RCC_CIR_PLL2RDYIE
 ((
ut32_t
)0x00002000

	)

1890 
	#RCC_CIR_PLL3RDYIE
 ((
ut32_t
)0x00004000

	)

1891 
	#RCC_CIR_PLL2RDYC
 ((
ut32_t
)0x00200000

	)

1892 
	#RCC_CIR_PLL3RDYC
 ((
ut32_t
)0x00400000

	)

1896 
	#RCC_APB2RSTR_AFIORST
 ((
ut32_t
)0x00000001

	)

1897 
	#RCC_APB2RSTR_IOPARST
 ((
ut32_t
)0x00000004

	)

1898 
	#RCC_APB2RSTR_IOPBRST
 ((
ut32_t
)0x00000008

	)

1899 
	#RCC_APB2RSTR_IOPCRST
 ((
ut32_t
)0x00000010

	)

1900 
	#RCC_APB2RSTR_IOPDRST
 ((
ut32_t
)0x00000020

	)

1901 
	#RCC_APB2RSTR_ADC1RST
 ((
ut32_t
)0x00000200

	)

1903 #i!
defed
 (
STM32F10X_LD_VL
&& !defed (
STM32F10X_MD_VL
&& !defed (
STM32F10X_HD_VL
)

1904 
	#RCC_APB2RSTR_ADC2RST
 ((
ut32_t
)0x00000400

	)

1907 
	#RCC_APB2RSTR_TIM1RST
 ((
ut32_t
)0x00000800

	)

1908 
	#RCC_APB2RSTR_SPI1RST
 ((
ut32_t
)0x00001000

	)

1909 
	#RCC_APB2RSTR_USART1RST
 ((
ut32_t
)0x00004000

	)

1911 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

1912 
	#RCC_APB2RSTR_TIM15RST
 ((
ut32_t
)0x00010000

	)

1913 
	#RCC_APB2RSTR_TIM16RST
 ((
ut32_t
)0x00020000

	)

1914 
	#RCC_APB2RSTR_TIM17RST
 ((
ut32_t
)0x00040000

	)

1917 #i!
defed
 (
STM32F10X_LD
&& !defed (
STM32F10X_LD_VL
)

1918 
	#RCC_APB2RSTR_IOPERST
 ((
ut32_t
)0x00000040

	)

1921 #i
defed
 (
STM32F10X_HD
|| defed (
STM32F10X_XL
)

1922 
	#RCC_APB2RSTR_IOPFRST
 ((
ut32_t
)0x00000080

	)

1923 
	#RCC_APB2RSTR_IOPGRST
 ((
ut32_t
)0x00000100

	)

1924 
	#RCC_APB2RSTR_TIM8RST
 ((
ut32_t
)0x00002000

	)

1925 
	#RCC_APB2RSTR_ADC3RST
 ((
ut32_t
)0x00008000

	)

1928 #i
defed
 (
STM32F10X_HD_VL
)

1929 
	#RCC_APB2RSTR_IOPFRST
 ((
ut32_t
)0x00000080

	)

1930 
	#RCC_APB2RSTR_IOPGRST
 ((
ut32_t
)0x00000100

	)

1933 #ifde
STM32F10X_XL


1934 
	#RCC_APB2RSTR_TIM9RST
 ((
ut32_t
)0x00080000

	)

1935 
	#RCC_APB2RSTR_TIM10RST
 ((
ut32_t
)0x00100000

	)

1936 
	#RCC_APB2RSTR_TIM11RST
 ((
ut32_t
)0x00200000

	)

1940 
	#RCC_APB1RSTR_TIM2RST
 ((
ut32_t
)0x00000001

	)

1941 
	#RCC_APB1RSTR_TIM3RST
 ((
ut32_t
)0x00000002

	)

1942 
	#RCC_APB1RSTR_WWDGRST
 ((
ut32_t
)0x00000800

	)

1943 
	#RCC_APB1RSTR_USART2RST
 ((
ut32_t
)0x00020000

	)

1944 
	#RCC_APB1RSTR_I2C1RST
 ((
ut32_t
)0x00200000

	)

1946 #i!
defed
 (
STM32F10X_LD_VL
&& !defed (
STM32F10X_MD_VL
&& !defed (
STM32F10X_HD_VL
)

1947 
	#RCC_APB1RSTR_CAN1RST
 ((
ut32_t
)0x02000000

	)

1950 
	#RCC_APB1RSTR_BKPRST
 ((
ut32_t
)0x08000000

	)

1951 
	#RCC_APB1RSTR_PWRRST
 ((
ut32_t
)0x10000000

	)

1953 #i!
defed
 (
STM32F10X_LD
&& !defed (
STM32F10X_LD_VL
)

1954 
	#RCC_APB1RSTR_TIM4RST
 ((
ut32_t
)0x00000004

	)

1955 
	#RCC_APB1RSTR_SPI2RST
 ((
ut32_t
)0x00004000

	)

1956 
	#RCC_APB1RSTR_USART3RST
 ((
ut32_t
)0x00040000

	)

1957 
	#RCC_APB1RSTR_I2C2RST
 ((
ut32_t
)0x00400000

	)

1960 #i
defed
 (
STM32F10X_HD
|| defed (
STM32F10X_MD
|| defed (
STM32F10X_LD
|| defed (
STM32F10X_XL
)

1961 
	#RCC_APB1RSTR_USBRST
 ((
ut32_t
)0x00800000

	)

1964 #i
defed
 (
STM32F10X_HD
|| defed (
STM32F10X_CL
|| defed (
STM32F10X_XL
)

1965 
	#RCC_APB1RSTR_TIM5RST
 ((
ut32_t
)0x00000008

	)

1966 
	#RCC_APB1RSTR_TIM6RST
 ((
ut32_t
)0x00000010

	)

1967 
	#RCC_APB1RSTR_TIM7RST
 ((
ut32_t
)0x00000020

	)

1968 
	#RCC_APB1RSTR_SPI3RST
 ((
ut32_t
)0x00008000

	)

1969 
	#RCC_APB1RSTR_UART4RST
 ((
ut32_t
)0x00080000

	)

1970 
	#RCC_APB1RSTR_UART5RST
 ((
ut32_t
)0x00100000

	)

1971 
	#RCC_APB1RSTR_DACRST
 ((
ut32_t
)0x20000000

	)

1974 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

1975 
	#RCC_APB1RSTR_TIM6RST
 ((
ut32_t
)0x00000010

	)

1976 
	#RCC_APB1RSTR_TIM7RST
 ((
ut32_t
)0x00000020

	)

1977 
	#RCC_APB1RSTR_DACRST
 ((
ut32_t
)0x20000000

	)

1978 
	#RCC_APB1RSTR_CECRST
 ((
ut32_t
)0x40000000

	)

1981 #i
defed
 (
STM32F10X_HD_VL
)

1982 
	#RCC_APB1RSTR_TIM5RST
 ((
ut32_t
)0x00000008

	)

1983 
	#RCC_APB1RSTR_TIM12RST
 ((
ut32_t
)0x00000040

	)

1984 
	#RCC_APB1RSTR_TIM13RST
 ((
ut32_t
)0x00000080

	)

1985 
	#RCC_APB1RSTR_TIM14RST
 ((
ut32_t
)0x00000100

	)

1986 
	#RCC_APB1RSTR_SPI3RST
 ((
ut32_t
)0x00008000

	)

1987 
	#RCC_APB1RSTR_UART4RST
 ((
ut32_t
)0x00080000

	)

1988 
	#RCC_APB1RSTR_UART5RST
 ((
ut32_t
)0x00100000

	)

1991 #ifde
STM32F10X_CL


1992 
	#RCC_APB1RSTR_CAN2RST
 ((
ut32_t
)0x04000000

	)

1995 #ifde
STM32F10X_XL


1996 
	#RCC_APB1RSTR_TIM12RST
 ((
ut32_t
)0x00000040

	)

1997 
	#RCC_APB1RSTR_TIM13RST
 ((
ut32_t
)0x00000080

	)

1998 
	#RCC_APB1RSTR_TIM14RST
 ((
ut32_t
)0x00000100

	)

2002 
	#RCC_AHBENR_DMA1EN
 ((
ut16_t
)0x0001

	)

2003 
	#RCC_AHBENR_SRAMEN
 ((
ut16_t
)0x0004

	)

2004 
	#RCC_AHBENR_FLITFEN
 ((
ut16_t
)0x0010

	)

2005 
	#RCC_AHBENR_CRCEN
 ((
ut16_t
)0x0040

	)

2007 #i
defed
 (
STM32F10X_HD
|| defed (
STM32F10X_CL
|| defed (
STM32F10X_HD_VL
)

2008 
	#RCC_AHBENR_DMA2EN
 ((
ut16_t
)0x0002

	)

2011 #i
defed
 (
STM32F10X_HD
|| defed (
STM32F10X_XL
)

2012 
	#RCC_AHBENR_FSMCEN
 ((
ut16_t
)0x0100

	)

2013 
	#RCC_AHBENR_SDIOEN
 ((
ut16_t
)0x0400

	)

2016 #i
defed
 (
STM32F10X_HD_VL
)

2017 
	#RCC_AHBENR_FSMCEN
 ((
ut16_t
)0x0100

	)

2020 #ifde
STM32F10X_CL


2021 
	#RCC_AHBENR_OTGFSEN
 ((
ut32_t
)0x00001000

	)

2022 
	#RCC_AHBENR_ETHMACEN
 ((
ut32_t
)0x00004000

	)

2023 
	#RCC_AHBENR_ETHMACTXEN
 ((
ut32_t
)0x00008000

	)

2024 
	#RCC_AHBENR_ETHMACRXEN
 ((
ut32_t
)0x00010000

	)

2028 
	#RCC_APB2ENR_AFIOEN
 ((
ut32_t
)0x00000001

	)

2029 
	#RCC_APB2ENR_IOPAEN
 ((
ut32_t
)0x00000004

	)

2030 
	#RCC_APB2ENR_IOPBEN
 ((
ut32_t
)0x00000008

	)

2031 
	#RCC_APB2ENR_IOPCEN
 ((
ut32_t
)0x00000010

	)

2032 
	#RCC_APB2ENR_IOPDEN
 ((
ut32_t
)0x00000020

	)

2033 
	#RCC_APB2ENR_ADC1EN
 ((
ut32_t
)0x00000200

	)

2035 #i!
defed
 (
STM32F10X_LD_VL
&& !defed (
STM32F10X_MD_VL
&& !defed (
STM32F10X_HD_VL
)

2036 
	#RCC_APB2ENR_ADC2EN
 ((
ut32_t
)0x00000400

	)

2039 
	#RCC_APB2ENR_TIM1EN
 ((
ut32_t
)0x00000800

	)

2040 
	#RCC_APB2ENR_SPI1EN
 ((
ut32_t
)0x00001000

	)

2041 
	#RCC_APB2ENR_USART1EN
 ((
ut32_t
)0x00004000

	)

2043 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

2044 
	#RCC_APB2ENR_TIM15EN
 ((
ut32_t
)0x00010000

	)

2045 
	#RCC_APB2ENR_TIM16EN
 ((
ut32_t
)0x00020000

	)

2046 
	#RCC_APB2ENR_TIM17EN
 ((
ut32_t
)0x00040000

	)

2049 #i!
defed
 (
STM32F10X_LD
&& !defed (
STM32F10X_LD_VL
)

2050 
	#RCC_APB2ENR_IOPEEN
 ((
ut32_t
)0x00000040

	)

2053 #i
defed
 (
STM32F10X_HD
|| defed (
STM32F10X_XL
)

2054 
	#RCC_APB2ENR_IOPFEN
 ((
ut32_t
)0x00000080

	)

2055 
	#RCC_APB2ENR_IOPGEN
 ((
ut32_t
)0x00000100

	)

2056 
	#RCC_APB2ENR_TIM8EN
 ((
ut32_t
)0x00002000

	)

2057 
	#RCC_APB2ENR_ADC3EN
 ((
ut32_t
)0x00008000

	)

2060 #i
defed
 (
STM32F10X_HD_VL
)

2061 
	#RCC_APB2ENR_IOPFEN
 ((
ut32_t
)0x00000080

	)

2062 
	#RCC_APB2ENR_IOPGEN
 ((
ut32_t
)0x00000100

	)

2065 #ifde
STM32F10X_XL


2066 
	#RCC_APB2ENR_TIM9EN
 ((
ut32_t
)0x00080000

	)

2067 
	#RCC_APB2ENR_TIM10EN
 ((
ut32_t
)0x00100000

	)

2068 
	#RCC_APB2ENR_TIM11EN
 ((
ut32_t
)0x00200000

	)

2072 
	#RCC_APB1ENR_TIM2EN
 ((
ut32_t
)0x00000001

	)

2073 
	#RCC_APB1ENR_TIM3EN
 ((
ut32_t
)0x00000002

	)

2074 
	#RCC_APB1ENR_WWDGEN
 ((
ut32_t
)0x00000800

	)

2075 
	#RCC_APB1ENR_USART2EN
 ((
ut32_t
)0x00020000

	)

2076 
	#RCC_APB1ENR_I2C1EN
 ((
ut32_t
)0x00200000

	)

2078 #i!
defed
 (
STM32F10X_LD_VL
&& !defed (
STM32F10X_MD_VL
&& !defed (
STM32F10X_HD_VL
)

2079 
	#RCC_APB1ENR_CAN1EN
 ((
ut32_t
)0x02000000

	)

2082 
	#RCC_APB1ENR_BKPEN
 ((
ut32_t
)0x08000000

	)

2083 
	#RCC_APB1ENR_PWREN
 ((
ut32_t
)0x10000000

	)

2085 #i!
defed
 (
STM32F10X_LD
&& !defed (
STM32F10X_LD_VL
)

2086 
	#RCC_APB1ENR_TIM4EN
 ((
ut32_t
)0x00000004

	)

2087 
	#RCC_APB1ENR_SPI2EN
 ((
ut32_t
)0x00004000

	)

2088 
	#RCC_APB1ENR_USART3EN
 ((
ut32_t
)0x00040000

	)

2089 
	#RCC_APB1ENR_I2C2EN
 ((
ut32_t
)0x00400000

	)

2092 #i
defed
 (
STM32F10X_HD
|| defed (
STM32F10X_MD
|| defed (
STM32F10X_LD
)

2093 
	#RCC_APB1ENR_USBEN
 ((
ut32_t
)0x00800000

	)

2096 #i
defed
 (
STM32F10X_HD
|| defed (
STM32F10X_CL
)

2097 
	#RCC_APB1ENR_TIM5EN
 ((
ut32_t
)0x00000008

	)

2098 
	#RCC_APB1ENR_TIM6EN
 ((
ut32_t
)0x00000010

	)

2099 
	#RCC_APB1ENR_TIM7EN
 ((
ut32_t
)0x00000020

	)

2100 
	#RCC_APB1ENR_SPI3EN
 ((
ut32_t
)0x00008000

	)

2101 
	#RCC_APB1ENR_UART4EN
 ((
ut32_t
)0x00080000

	)

2102 
	#RCC_APB1ENR_UART5EN
 ((
ut32_t
)0x00100000

	)

2103 
	#RCC_APB1ENR_DACEN
 ((
ut32_t
)0x20000000

	)

2106 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

2107 
	#RCC_APB1ENR_TIM6EN
 ((
ut32_t
)0x00000010

	)

2108 
	#RCC_APB1ENR_TIM7EN
 ((
ut32_t
)0x00000020

	)

2109 
	#RCC_APB1ENR_DACEN
 ((
ut32_t
)0x20000000

	)

2110 
	#RCC_APB1ENR_CECEN
 ((
ut32_t
)0x40000000

	)

2113 #ifde
STM32F10X_HD_VL


2114 
	#RCC_APB1ENR_TIM5EN
 ((
ut32_t
)0x00000008

	)

2115 
	#RCC_APB1ENR_TIM12EN
 ((
ut32_t
)0x00000040

	)

2116 
	#RCC_APB1ENR_TIM13EN
 ((
ut32_t
)0x00000080

	)

2117 
	#RCC_APB1ENR_TIM14EN
 ((
ut32_t
)0x00000100

	)

2118 
	#RCC_APB1ENR_SPI3EN
 ((
ut32_t
)0x00008000

	)

2119 
	#RCC_APB1ENR_UART4EN
 ((
ut32_t
)0x00080000

	)

2120 
	#RCC_APB1ENR_UART5EN
 ((
ut32_t
)0x00100000

	)

2123 #ifde
STM32F10X_CL


2124 
	#RCC_APB1ENR_CAN2EN
 ((
ut32_t
)0x04000000

	)

2127 #ifde
STM32F10X_XL


2128 
	#RCC_APB1ENR_TIM12EN
 ((
ut32_t
)0x00000040

	)

2129 
	#RCC_APB1ENR_TIM13EN
 ((
ut32_t
)0x00000080

	)

2130 
	#RCC_APB1ENR_TIM14EN
 ((
ut32_t
)0x00000100

	)

2134 
	#RCC_BDCR_LSEON
 ((
ut32_t
)0x00000001

	)

2135 
	#RCC_BDCR_LSERDY
 ((
ut32_t
)0x00000002

	)

2136 
	#RCC_BDCR_LSEBYP
 ((
ut32_t
)0x00000004

	)

2138 
	#RCC_BDCR_RTCSEL
 ((
ut32_t
)0x00000300

	)

2139 
	#RCC_BDCR_RTCSEL_0
 ((
ut32_t
)0x00000100

	)

2140 
	#RCC_BDCR_RTCSEL_1
 ((
ut32_t
)0x00000200

	)

2143 
	#RCC_BDCR_RTCSEL_NOCLOCK
 ((
ut32_t
)0x00000000

	)

2144 
	#RCC_BDCR_RTCSEL_LSE
 ((
ut32_t
)0x00000100

	)

2145 
	#RCC_BDCR_RTCSEL_LSI
 ((
ut32_t
)0x00000200

	)

2146 
	#RCC_BDCR_RTCSEL_HSE
 ((
ut32_t
)0x00000300

	)

2148 
	#RCC_BDCR_RTCEN
 ((
ut32_t
)0x00008000

	)

2149 
	#RCC_BDCR_BDRST
 ((
ut32_t
)0x00010000

	)

2152 
	#RCC_CSR_LSION
 ((
ut32_t
)0x00000001

	)

2153 
	#RCC_CSR_LSIRDY
 ((
ut32_t
)0x00000002

	)

2154 
	#RCC_CSR_RMVF
 ((
ut32_t
)0x01000000

	)

2155 
	#RCC_CSR_PINRSTF
 ((
ut32_t
)0x04000000

	)

2156 
	#RCC_CSR_PORRSTF
 ((
ut32_t
)0x08000000

	)

2157 
	#RCC_CSR_SFTRSTF
 ((
ut32_t
)0x10000000

	)

2158 
	#RCC_CSR_IWDGRSTF
 ((
ut32_t
)0x20000000

	)

2159 
	#RCC_CSR_WWDGRSTF
 ((
ut32_t
)0x40000000

	)

2160 
	#RCC_CSR_LPWRRSTF
 ((
ut32_t
)0x80000000

	)

2162 #ifde
STM32F10X_CL


2164 
	#RCC_AHBRSTR_OTGFSRST
 ((
ut32_t
)0x00001000

	)

2165 
	#RCC_AHBRSTR_ETHMACRST
 ((
ut32_t
)0x00004000

	)

2169 
	#RCC_CFGR2_PREDIV1
 ((
ut32_t
)0x0000000F

	)

2170 
	#RCC_CFGR2_PREDIV1_0
 ((
ut32_t
)0x00000001

	)

2171 
	#RCC_CFGR2_PREDIV1_1
 ((
ut32_t
)0x00000002

	)

2172 
	#RCC_CFGR2_PREDIV1_2
 ((
ut32_t
)0x00000004

	)

2173 
	#RCC_CFGR2_PREDIV1_3
 ((
ut32_t
)0x00000008

	)

2175 
	#RCC_CFGR2_PREDIV1_DIV1
 ((
ut32_t
)0x00000000

	)

2176 
	#RCC_CFGR2_PREDIV1_DIV2
 ((
ut32_t
)0x00000001

	)

2177 
	#RCC_CFGR2_PREDIV1_DIV3
 ((
ut32_t
)0x00000002

	)

2178 
	#RCC_CFGR2_PREDIV1_DIV4
 ((
ut32_t
)0x00000003

	)

2179 
	#RCC_CFGR2_PREDIV1_DIV5
 ((
ut32_t
)0x00000004

	)

2180 
	#RCC_CFGR2_PREDIV1_DIV6
 ((
ut32_t
)0x00000005

	)

2181 
	#RCC_CFGR2_PREDIV1_DIV7
 ((
ut32_t
)0x00000006

	)

2182 
	#RCC_CFGR2_PREDIV1_DIV8
 ((
ut32_t
)0x00000007

	)

2183 
	#RCC_CFGR2_PREDIV1_DIV9
 ((
ut32_t
)0x00000008

	)

2184 
	#RCC_CFGR2_PREDIV1_DIV10
 ((
ut32_t
)0x00000009

	)

2185 
	#RCC_CFGR2_PREDIV1_DIV11
 ((
ut32_t
)0x0000000A

	)

2186 
	#RCC_CFGR2_PREDIV1_DIV12
 ((
ut32_t
)0x0000000B

	)

2187 
	#RCC_CFGR2_PREDIV1_DIV13
 ((
ut32_t
)0x0000000C

	)

2188 
	#RCC_CFGR2_PREDIV1_DIV14
 ((
ut32_t
)0x0000000D

	)

2189 
	#RCC_CFGR2_PREDIV1_DIV15
 ((
ut32_t
)0x0000000E

	)

2190 
	#RCC_CFGR2_PREDIV1_DIV16
 ((
ut32_t
)0x0000000F

	)

2193 
	#RCC_CFGR2_PREDIV2
 ((
ut32_t
)0x000000F0

	)

2194 
	#RCC_CFGR2_PREDIV2_0
 ((
ut32_t
)0x00000010

	)

2195 
	#RCC_CFGR2_PREDIV2_1
 ((
ut32_t
)0x00000020

	)

2196 
	#RCC_CFGR2_PREDIV2_2
 ((
ut32_t
)0x00000040

	)

2197 
	#RCC_CFGR2_PREDIV2_3
 ((
ut32_t
)0x00000080

	)

2199 
	#RCC_CFGR2_PREDIV2_DIV1
 ((
ut32_t
)0x00000000

	)

2200 
	#RCC_CFGR2_PREDIV2_DIV2
 ((
ut32_t
)0x00000010

	)

2201 
	#RCC_CFGR2_PREDIV2_DIV3
 ((
ut32_t
)0x00000020

	)

2202 
	#RCC_CFGR2_PREDIV2_DIV4
 ((
ut32_t
)0x00000030

	)

2203 
	#RCC_CFGR2_PREDIV2_DIV5
 ((
ut32_t
)0x00000040

	)

2204 
	#RCC_CFGR2_PREDIV2_DIV6
 ((
ut32_t
)0x00000050

	)

2205 
	#RCC_CFGR2_PREDIV2_DIV7
 ((
ut32_t
)0x00000060

	)

2206 
	#RCC_CFGR2_PREDIV2_DIV8
 ((
ut32_t
)0x00000070

	)

2207 
	#RCC_CFGR2_PREDIV2_DIV9
 ((
ut32_t
)0x00000080

	)

2208 
	#RCC_CFGR2_PREDIV2_DIV10
 ((
ut32_t
)0x00000090

	)

2209 
	#RCC_CFGR2_PREDIV2_DIV11
 ((
ut32_t
)0x000000A0

	)

2210 
	#RCC_CFGR2_PREDIV2_DIV12
 ((
ut32_t
)0x000000B0

	)

2211 
	#RCC_CFGR2_PREDIV2_DIV13
 ((
ut32_t
)0x000000C0

	)

2212 
	#RCC_CFGR2_PREDIV2_DIV14
 ((
ut32_t
)0x000000D0

	)

2213 
	#RCC_CFGR2_PREDIV2_DIV15
 ((
ut32_t
)0x000000E0

	)

2214 
	#RCC_CFGR2_PREDIV2_DIV16
 ((
ut32_t
)0x000000F0

	)

2217 
	#RCC_CFGR2_PLL2MUL
 ((
ut32_t
)0x00000F00

	)

2218 
	#RCC_CFGR2_PLL2MUL_0
 ((
ut32_t
)0x00000100

	)

2219 
	#RCC_CFGR2_PLL2MUL_1
 ((
ut32_t
)0x00000200

	)

2220 
	#RCC_CFGR2_PLL2MUL_2
 ((
ut32_t
)0x00000400

	)

2221 
	#RCC_CFGR2_PLL2MUL_3
 ((
ut32_t
)0x00000800

	)

2223 
	#RCC_CFGR2_PLL2MUL8
 ((
ut32_t
)0x00000600

	)

2224 
	#RCC_CFGR2_PLL2MUL9
 ((
ut32_t
)0x00000700

	)

2225 
	#RCC_CFGR2_PLL2MUL10
 ((
ut32_t
)0x00000800

	)

2226 
	#RCC_CFGR2_PLL2MUL11
 ((
ut32_t
)0x00000900

	)

2227 
	#RCC_CFGR2_PLL2MUL12
 ((
ut32_t
)0x00000A00

	)

2228 
	#RCC_CFGR2_PLL2MUL13
 ((
ut32_t
)0x00000B00

	)

2229 
	#RCC_CFGR2_PLL2MUL14
 ((
ut32_t
)0x00000C00

	)

2230 
	#RCC_CFGR2_PLL2MUL16
 ((
ut32_t
)0x00000E00

	)

2231 
	#RCC_CFGR2_PLL2MUL20
 ((
ut32_t
)0x00000F00

	)

2234 
	#RCC_CFGR2_PLL3MUL
 ((
ut32_t
)0x0000F000

	)

2235 
	#RCC_CFGR2_PLL3MUL_0
 ((
ut32_t
)0x00001000

	)

2236 
	#RCC_CFGR2_PLL3MUL_1
 ((
ut32_t
)0x00002000

	)

2237 
	#RCC_CFGR2_PLL3MUL_2
 ((
ut32_t
)0x00004000

	)

2238 
	#RCC_CFGR2_PLL3MUL_3
 ((
ut32_t
)0x00008000

	)

2240 
	#RCC_CFGR2_PLL3MUL8
 ((
ut32_t
)0x00006000

	)

2241 
	#RCC_CFGR2_PLL3MUL9
 ((
ut32_t
)0x00007000

	)

2242 
	#RCC_CFGR2_PLL3MUL10
 ((
ut32_t
)0x00008000

	)

2243 
	#RCC_CFGR2_PLL3MUL11
 ((
ut32_t
)0x00009000

	)

2244 
	#RCC_CFGR2_PLL3MUL12
 ((
ut32_t
)0x0000A000

	)

2245 
	#RCC_CFGR2_PLL3MUL13
 ((
ut32_t
)0x0000B000

	)

2246 
	#RCC_CFGR2_PLL3MUL14
 ((
ut32_t
)0x0000C000

	)

2247 
	#RCC_CFGR2_PLL3MUL16
 ((
ut32_t
)0x0000E000

	)

2248 
	#RCC_CFGR2_PLL3MUL20
 ((
ut32_t
)0x0000F000

	)

2250 
	#RCC_CFGR2_PREDIV1SRC
 ((
ut32_t
)0x00010000

	)

2251 
	#RCC_CFGR2_PREDIV1SRC_PLL2
 ((
ut32_t
)0x00010000

	)

2252 
	#RCC_CFGR2_PREDIV1SRC_HSE
 ((
ut32_t
)0x00000000

	)

2253 
	#RCC_CFGR2_I2S2SRC
 ((
ut32_t
)0x00020000

	)

2254 
	#RCC_CFGR2_I2S3SRC
 ((
ut32_t
)0x00040000

	)

2257 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

2260 
	#RCC_CFGR2_PREDIV1
 ((
ut32_t
)0x0000000F

	)

2261 
	#RCC_CFGR2_PREDIV1_0
 ((
ut32_t
)0x00000001

	)

2262 
	#RCC_CFGR2_PREDIV1_1
 ((
ut32_t
)0x00000002

	)

2263 
	#RCC_CFGR2_PREDIV1_2
 ((
ut32_t
)0x00000004

	)

2264 
	#RCC_CFGR2_PREDIV1_3
 ((
ut32_t
)0x00000008

	)

2266 
	#RCC_CFGR2_PREDIV1_DIV1
 ((
ut32_t
)0x00000000

	)

2267 
	#RCC_CFGR2_PREDIV1_DIV2
 ((
ut32_t
)0x00000001

	)

2268 
	#RCC_CFGR2_PREDIV1_DIV3
 ((
ut32_t
)0x00000002

	)

2269 
	#RCC_CFGR2_PREDIV1_DIV4
 ((
ut32_t
)0x00000003

	)

2270 
	#RCC_CFGR2_PREDIV1_DIV5
 ((
ut32_t
)0x00000004

	)

2271 
	#RCC_CFGR2_PREDIV1_DIV6
 ((
ut32_t
)0x00000005

	)

2272 
	#RCC_CFGR2_PREDIV1_DIV7
 ((
ut32_t
)0x00000006

	)

2273 
	#RCC_CFGR2_PREDIV1_DIV8
 ((
ut32_t
)0x00000007

	)

2274 
	#RCC_CFGR2_PREDIV1_DIV9
 ((
ut32_t
)0x00000008

	)

2275 
	#RCC_CFGR2_PREDIV1_DIV10
 ((
ut32_t
)0x00000009

	)

2276 
	#RCC_CFGR2_PREDIV1_DIV11
 ((
ut32_t
)0x0000000A

	)

2277 
	#RCC_CFGR2_PREDIV1_DIV12
 ((
ut32_t
)0x0000000B

	)

2278 
	#RCC_CFGR2_PREDIV1_DIV13
 ((
ut32_t
)0x0000000C

	)

2279 
	#RCC_CFGR2_PREDIV1_DIV14
 ((
ut32_t
)0x0000000D

	)

2280 
	#RCC_CFGR2_PREDIV1_DIV15
 ((
ut32_t
)0x0000000E

	)

2281 
	#RCC_CFGR2_PREDIV1_DIV16
 ((
ut32_t
)0x0000000F

	)

2291 
	#GPIO_CRL_MODE
 ((
ut32_t
)0x33333333

	)

2293 
	#GPIO_CRL_MODE0
 ((
ut32_t
)0x00000003

	)

2294 
	#GPIO_CRL_MODE0_0
 ((
ut32_t
)0x00000001

	)

2295 
	#GPIO_CRL_MODE0_1
 ((
ut32_t
)0x00000002

	)

2297 
	#GPIO_CRL_MODE1
 ((
ut32_t
)0x00000030

	)

2298 
	#GPIO_CRL_MODE1_0
 ((
ut32_t
)0x00000010

	)

2299 
	#GPIO_CRL_MODE1_1
 ((
ut32_t
)0x00000020

	)

2301 
	#GPIO_CRL_MODE2
 ((
ut32_t
)0x00000300

	)

2302 
	#GPIO_CRL_MODE2_0
 ((
ut32_t
)0x00000100

	)

2303 
	#GPIO_CRL_MODE2_1
 ((
ut32_t
)0x00000200

	)

2305 
	#GPIO_CRL_MODE3
 ((
ut32_t
)0x00003000

	)

2306 
	#GPIO_CRL_MODE3_0
 ((
ut32_t
)0x00001000

	)

2307 
	#GPIO_CRL_MODE3_1
 ((
ut32_t
)0x00002000

	)

2309 
	#GPIO_CRL_MODE4
 ((
ut32_t
)0x00030000

	)

2310 
	#GPIO_CRL_MODE4_0
 ((
ut32_t
)0x00010000

	)

2311 
	#GPIO_CRL_MODE4_1
 ((
ut32_t
)0x00020000

	)

2313 
	#GPIO_CRL_MODE5
 ((
ut32_t
)0x00300000

	)

2314 
	#GPIO_CRL_MODE5_0
 ((
ut32_t
)0x00100000

	)

2315 
	#GPIO_CRL_MODE5_1
 ((
ut32_t
)0x00200000

	)

2317 
	#GPIO_CRL_MODE6
 ((
ut32_t
)0x03000000

	)

2318 
	#GPIO_CRL_MODE6_0
 ((
ut32_t
)0x01000000

	)

2319 
	#GPIO_CRL_MODE6_1
 ((
ut32_t
)0x02000000

	)

2321 
	#GPIO_CRL_MODE7
 ((
ut32_t
)0x30000000

	)

2322 
	#GPIO_CRL_MODE7_0
 ((
ut32_t
)0x10000000

	)

2323 
	#GPIO_CRL_MODE7_1
 ((
ut32_t
)0x20000000

	)

2325 
	#GPIO_CRL_CNF
 ((
ut32_t
)0xCCCCCCCC

	)

2327 
	#GPIO_CRL_CNF0
 ((
ut32_t
)0x0000000C

	)

2328 
	#GPIO_CRL_CNF0_0
 ((
ut32_t
)0x00000004

	)

2329 
	#GPIO_CRL_CNF0_1
 ((
ut32_t
)0x00000008

	)

2331 
	#GPIO_CRL_CNF1
 ((
ut32_t
)0x000000C0

	)

2332 
	#GPIO_CRL_CNF1_0
 ((
ut32_t
)0x00000040

	)

2333 
	#GPIO_CRL_CNF1_1
 ((
ut32_t
)0x00000080

	)

2335 
	#GPIO_CRL_CNF2
 ((
ut32_t
)0x00000C00

	)

2336 
	#GPIO_CRL_CNF2_0
 ((
ut32_t
)0x00000400

	)

2337 
	#GPIO_CRL_CNF2_1
 ((
ut32_t
)0x00000800

	)

2339 
	#GPIO_CRL_CNF3
 ((
ut32_t
)0x0000C000

	)

2340 
	#GPIO_CRL_CNF3_0
 ((
ut32_t
)0x00004000

	)

2341 
	#GPIO_CRL_CNF3_1
 ((
ut32_t
)0x00008000

	)

2343 
	#GPIO_CRL_CNF4
 ((
ut32_t
)0x000C0000

	)

2344 
	#GPIO_CRL_CNF4_0
 ((
ut32_t
)0x00040000

	)

2345 
	#GPIO_CRL_CNF4_1
 ((
ut32_t
)0x00080000

	)

2347 
	#GPIO_CRL_CNF5
 ((
ut32_t
)0x00C00000

	)

2348 
	#GPIO_CRL_CNF5_0
 ((
ut32_t
)0x00400000

	)

2349 
	#GPIO_CRL_CNF5_1
 ((
ut32_t
)0x00800000

	)

2351 
	#GPIO_CRL_CNF6
 ((
ut32_t
)0x0C000000

	)

2352 
	#GPIO_CRL_CNF6_0
 ((
ut32_t
)0x04000000

	)

2353 
	#GPIO_CRL_CNF6_1
 ((
ut32_t
)0x08000000

	)

2355 
	#GPIO_CRL_CNF7
 ((
ut32_t
)0xC0000000

	)

2356 
	#GPIO_CRL_CNF7_0
 ((
ut32_t
)0x40000000

	)

2357 
	#GPIO_CRL_CNF7_1
 ((
ut32_t
)0x80000000

	)

2360 
	#GPIO_CRH_MODE
 ((
ut32_t
)0x33333333

	)

2362 
	#GPIO_CRH_MODE8
 ((
ut32_t
)0x00000003

	)

2363 
	#GPIO_CRH_MODE8_0
 ((
ut32_t
)0x00000001

	)

2364 
	#GPIO_CRH_MODE8_1
 ((
ut32_t
)0x00000002

	)

2366 
	#GPIO_CRH_MODE9
 ((
ut32_t
)0x00000030

	)

2367 
	#GPIO_CRH_MODE9_0
 ((
ut32_t
)0x00000010

	)

2368 
	#GPIO_CRH_MODE9_1
 ((
ut32_t
)0x00000020

	)

2370 
	#GPIO_CRH_MODE10
 ((
ut32_t
)0x00000300

	)

2371 
	#GPIO_CRH_MODE10_0
 ((
ut32_t
)0x00000100

	)

2372 
	#GPIO_CRH_MODE10_1
 ((
ut32_t
)0x00000200

	)

2374 
	#GPIO_CRH_MODE11
 ((
ut32_t
)0x00003000

	)

2375 
	#GPIO_CRH_MODE11_0
 ((
ut32_t
)0x00001000

	)

2376 
	#GPIO_CRH_MODE11_1
 ((
ut32_t
)0x00002000

	)

2378 
	#GPIO_CRH_MODE12
 ((
ut32_t
)0x00030000

	)

2379 
	#GPIO_CRH_MODE12_0
 ((
ut32_t
)0x00010000

	)

2380 
	#GPIO_CRH_MODE12_1
 ((
ut32_t
)0x00020000

	)

2382 
	#GPIO_CRH_MODE13
 ((
ut32_t
)0x00300000

	)

2383 
	#GPIO_CRH_MODE13_0
 ((
ut32_t
)0x00100000

	)

2384 
	#GPIO_CRH_MODE13_1
 ((
ut32_t
)0x00200000

	)

2386 
	#GPIO_CRH_MODE14
 ((
ut32_t
)0x03000000

	)

2387 
	#GPIO_CRH_MODE14_0
 ((
ut32_t
)0x01000000

	)

2388 
	#GPIO_CRH_MODE14_1
 ((
ut32_t
)0x02000000

	)

2390 
	#GPIO_CRH_MODE15
 ((
ut32_t
)0x30000000

	)

2391 
	#GPIO_CRH_MODE15_0
 ((
ut32_t
)0x10000000

	)

2392 
	#GPIO_CRH_MODE15_1
 ((
ut32_t
)0x20000000

	)

2394 
	#GPIO_CRH_CNF
 ((
ut32_t
)0xCCCCCCCC

	)

2396 
	#GPIO_CRH_CNF8
 ((
ut32_t
)0x0000000C

	)

2397 
	#GPIO_CRH_CNF8_0
 ((
ut32_t
)0x00000004

	)

2398 
	#GPIO_CRH_CNF8_1
 ((
ut32_t
)0x00000008

	)

2400 
	#GPIO_CRH_CNF9
 ((
ut32_t
)0x000000C0

	)

2401 
	#GPIO_CRH_CNF9_0
 ((
ut32_t
)0x00000040

	)

2402 
	#GPIO_CRH_CNF9_1
 ((
ut32_t
)0x00000080

	)

2404 
	#GPIO_CRH_CNF10
 ((
ut32_t
)0x00000C00

	)

2405 
	#GPIO_CRH_CNF10_0
 ((
ut32_t
)0x00000400

	)

2406 
	#GPIO_CRH_CNF10_1
 ((
ut32_t
)0x00000800

	)

2408 
	#GPIO_CRH_CNF11
 ((
ut32_t
)0x0000C000

	)

2409 
	#GPIO_CRH_CNF11_0
 ((
ut32_t
)0x00004000

	)

2410 
	#GPIO_CRH_CNF11_1
 ((
ut32_t
)0x00008000

	)

2412 
	#GPIO_CRH_CNF12
 ((
ut32_t
)0x000C0000

	)

2413 
	#GPIO_CRH_CNF12_0
 ((
ut32_t
)0x00040000

	)

2414 
	#GPIO_CRH_CNF12_1
 ((
ut32_t
)0x00080000

	)

2416 
	#GPIO_CRH_CNF13
 ((
ut32_t
)0x00C00000

	)

2417 
	#GPIO_CRH_CNF13_0
 ((
ut32_t
)0x00400000

	)

2418 
	#GPIO_CRH_CNF13_1
 ((
ut32_t
)0x00800000

	)

2420 
	#GPIO_CRH_CNF14
 ((
ut32_t
)0x0C000000

	)

2421 
	#GPIO_CRH_CNF14_0
 ((
ut32_t
)0x04000000

	)

2422 
	#GPIO_CRH_CNF14_1
 ((
ut32_t
)0x08000000

	)

2424 
	#GPIO_CRH_CNF15
 ((
ut32_t
)0xC0000000

	)

2425 
	#GPIO_CRH_CNF15_0
 ((
ut32_t
)0x40000000

	)

2426 
	#GPIO_CRH_CNF15_1
 ((
ut32_t
)0x80000000

	)

2429 
	#GPIO_IDR_IDR0
 ((
ut16_t
)0x0001

	)

2430 
	#GPIO_IDR_IDR1
 ((
ut16_t
)0x0002

	)

2431 
	#GPIO_IDR_IDR2
 ((
ut16_t
)0x0004

	)

2432 
	#GPIO_IDR_IDR3
 ((
ut16_t
)0x0008

	)

2433 
	#GPIO_IDR_IDR4
 ((
ut16_t
)0x0010

	)

2434 
	#GPIO_IDR_IDR5
 ((
ut16_t
)0x0020

	)

2435 
	#GPIO_IDR_IDR6
 ((
ut16_t
)0x0040

	)

2436 
	#GPIO_IDR_IDR7
 ((
ut16_t
)0x0080

	)

2437 
	#GPIO_IDR_IDR8
 ((
ut16_t
)0x0100

	)

2438 
	#GPIO_IDR_IDR9
 ((
ut16_t
)0x0200

	)

2439 
	#GPIO_IDR_IDR10
 ((
ut16_t
)0x0400

	)

2440 
	#GPIO_IDR_IDR11
 ((
ut16_t
)0x0800

	)

2441 
	#GPIO_IDR_IDR12
 ((
ut16_t
)0x1000

	)

2442 
	#GPIO_IDR_IDR13
 ((
ut16_t
)0x2000

	)

2443 
	#GPIO_IDR_IDR14
 ((
ut16_t
)0x4000

	)

2444 
	#GPIO_IDR_IDR15
 ((
ut16_t
)0x8000

	)

2447 
	#GPIO_ODR_ODR0
 ((
ut16_t
)0x0001

	)

2448 
	#GPIO_ODR_ODR1
 ((
ut16_t
)0x0002

	)

2449 
	#GPIO_ODR_ODR2
 ((
ut16_t
)0x0004

	)

2450 
	#GPIO_ODR_ODR3
 ((
ut16_t
)0x0008

	)

2451 
	#GPIO_ODR_ODR4
 ((
ut16_t
)0x0010

	)

2452 
	#GPIO_ODR_ODR5
 ((
ut16_t
)0x0020

	)

2453 
	#GPIO_ODR_ODR6
 ((
ut16_t
)0x0040

	)

2454 
	#GPIO_ODR_ODR7
 ((
ut16_t
)0x0080

	)

2455 
	#GPIO_ODR_ODR8
 ((
ut16_t
)0x0100

	)

2456 
	#GPIO_ODR_ODR9
 ((
ut16_t
)0x0200

	)

2457 
	#GPIO_ODR_ODR10
 ((
ut16_t
)0x0400

	)

2458 
	#GPIO_ODR_ODR11
 ((
ut16_t
)0x0800

	)

2459 
	#GPIO_ODR_ODR12
 ((
ut16_t
)0x1000

	)

2460 
	#GPIO_ODR_ODR13
 ((
ut16_t
)0x2000

	)

2461 
	#GPIO_ODR_ODR14
 ((
ut16_t
)0x4000

	)

2462 
	#GPIO_ODR_ODR15
 ((
ut16_t
)0x8000

	)

2465 
	#GPIO_BSRR_BS0
 ((
ut32_t
)0x00000001

	)

2466 
	#GPIO_BSRR_BS1
 ((
ut32_t
)0x00000002

	)

2467 
	#GPIO_BSRR_BS2
 ((
ut32_t
)0x00000004

	)

2468 
	#GPIO_BSRR_BS3
 ((
ut32_t
)0x00000008

	)

2469 
	#GPIO_BSRR_BS4
 ((
ut32_t
)0x00000010

	)

2470 
	#GPIO_BSRR_BS5
 ((
ut32_t
)0x00000020

	)

2471 
	#GPIO_BSRR_BS6
 ((
ut32_t
)0x00000040

	)

2472 
	#GPIO_BSRR_BS7
 ((
ut32_t
)0x00000080

	)

2473 
	#GPIO_BSRR_BS8
 ((
ut32_t
)0x00000100

	)

2474 
	#GPIO_BSRR_BS9
 ((
ut32_t
)0x00000200

	)

2475 
	#GPIO_BSRR_BS10
 ((
ut32_t
)0x00000400

	)

2476 
	#GPIO_BSRR_BS11
 ((
ut32_t
)0x00000800

	)

2477 
	#GPIO_BSRR_BS12
 ((
ut32_t
)0x00001000

	)

2478 
	#GPIO_BSRR_BS13
 ((
ut32_t
)0x00002000

	)

2479 
	#GPIO_BSRR_BS14
 ((
ut32_t
)0x00004000

	)

2480 
	#GPIO_BSRR_BS15
 ((
ut32_t
)0x00008000

	)

2482 
	#GPIO_BSRR_BR0
 ((
ut32_t
)0x00010000

	)

2483 
	#GPIO_BSRR_BR1
 ((
ut32_t
)0x00020000

	)

2484 
	#GPIO_BSRR_BR2
 ((
ut32_t
)0x00040000

	)

2485 
	#GPIO_BSRR_BR3
 ((
ut32_t
)0x00080000

	)

2486 
	#GPIO_BSRR_BR4
 ((
ut32_t
)0x00100000

	)

2487 
	#GPIO_BSRR_BR5
 ((
ut32_t
)0x00200000

	)

2488 
	#GPIO_BSRR_BR6
 ((
ut32_t
)0x00400000

	)

2489 
	#GPIO_BSRR_BR7
 ((
ut32_t
)0x00800000

	)

2490 
	#GPIO_BSRR_BR8
 ((
ut32_t
)0x01000000

	)

2491 
	#GPIO_BSRR_BR9
 ((
ut32_t
)0x02000000

	)

2492 
	#GPIO_BSRR_BR10
 ((
ut32_t
)0x04000000

	)

2493 
	#GPIO_BSRR_BR11
 ((
ut32_t
)0x08000000

	)

2494 
	#GPIO_BSRR_BR12
 ((
ut32_t
)0x10000000

	)

2495 
	#GPIO_BSRR_BR13
 ((
ut32_t
)0x20000000

	)

2496 
	#GPIO_BSRR_BR14
 ((
ut32_t
)0x40000000

	)

2497 
	#GPIO_BSRR_BR15
 ((
ut32_t
)0x80000000

	)

2500 
	#GPIO_BRR_BR0
 ((
ut16_t
)0x0001

	)

2501 
	#GPIO_BRR_BR1
 ((
ut16_t
)0x0002

	)

2502 
	#GPIO_BRR_BR2
 ((
ut16_t
)0x0004

	)

2503 
	#GPIO_BRR_BR3
 ((
ut16_t
)0x0008

	)

2504 
	#GPIO_BRR_BR4
 ((
ut16_t
)0x0010

	)

2505 
	#GPIO_BRR_BR5
 ((
ut16_t
)0x0020

	)

2506 
	#GPIO_BRR_BR6
 ((
ut16_t
)0x0040

	)

2507 
	#GPIO_BRR_BR7
 ((
ut16_t
)0x0080

	)

2508 
	#GPIO_BRR_BR8
 ((
ut16_t
)0x0100

	)

2509 
	#GPIO_BRR_BR9
 ((
ut16_t
)0x0200

	)

2510 
	#GPIO_BRR_BR10
 ((
ut16_t
)0x0400

	)

2511 
	#GPIO_BRR_BR11
 ((
ut16_t
)0x0800

	)

2512 
	#GPIO_BRR_BR12
 ((
ut16_t
)0x1000

	)

2513 
	#GPIO_BRR_BR13
 ((
ut16_t
)0x2000

	)

2514 
	#GPIO_BRR_BR14
 ((
ut16_t
)0x4000

	)

2515 
	#GPIO_BRR_BR15
 ((
ut16_t
)0x8000

	)

2518 
	#GPIO_LCKR_LCK0
 ((
ut32_t
)0x00000001

	)

2519 
	#GPIO_LCKR_LCK1
 ((
ut32_t
)0x00000002

	)

2520 
	#GPIO_LCKR_LCK2
 ((
ut32_t
)0x00000004

	)

2521 
	#GPIO_LCKR_LCK3
 ((
ut32_t
)0x00000008

	)

2522 
	#GPIO_LCKR_LCK4
 ((
ut32_t
)0x00000010

	)

2523 
	#GPIO_LCKR_LCK5
 ((
ut32_t
)0x00000020

	)

2524 
	#GPIO_LCKR_LCK6
 ((
ut32_t
)0x00000040

	)

2525 
	#GPIO_LCKR_LCK7
 ((
ut32_t
)0x00000080

	)

2526 
	#GPIO_LCKR_LCK8
 ((
ut32_t
)0x00000100

	)

2527 
	#GPIO_LCKR_LCK9
 ((
ut32_t
)0x00000200

	)

2528 
	#GPIO_LCKR_LCK10
 ((
ut32_t
)0x00000400

	)

2529 
	#GPIO_LCKR_LCK11
 ((
ut32_t
)0x00000800

	)

2530 
	#GPIO_LCKR_LCK12
 ((
ut32_t
)0x00001000

	)

2531 
	#GPIO_LCKR_LCK13
 ((
ut32_t
)0x00002000

	)

2532 
	#GPIO_LCKR_LCK14
 ((
ut32_t
)0x00004000

	)

2533 
	#GPIO_LCKR_LCK15
 ((
ut32_t
)0x00008000

	)

2534 
	#GPIO_LCKR_LCKK
 ((
ut32_t
)0x00010000

	)

2539 
	#AFIO_EVCR_PIN
 ((
ut8_t
)0x0F

	)

2540 
	#AFIO_EVCR_PIN_0
 ((
ut8_t
)0x01

	)

2541 
	#AFIO_EVCR_PIN_1
 ((
ut8_t
)0x02

	)

2542 
	#AFIO_EVCR_PIN_2
 ((
ut8_t
)0x04

	)

2543 
	#AFIO_EVCR_PIN_3
 ((
ut8_t
)0x08

	)

2546 
	#AFIO_EVCR_PIN_PX0
 ((
ut8_t
)0x00

	)

2547 
	#AFIO_EVCR_PIN_PX1
 ((
ut8_t
)0x01

	)

2548 
	#AFIO_EVCR_PIN_PX2
 ((
ut8_t
)0x02

	)

2549 
	#AFIO_EVCR_PIN_PX3
 ((
ut8_t
)0x03

	)

2550 
	#AFIO_EVCR_PIN_PX4
 ((
ut8_t
)0x04

	)

2551 
	#AFIO_EVCR_PIN_PX5
 ((
ut8_t
)0x05

	)

2552 
	#AFIO_EVCR_PIN_PX6
 ((
ut8_t
)0x06

	)

2553 
	#AFIO_EVCR_PIN_PX7
 ((
ut8_t
)0x07

	)

2554 
	#AFIO_EVCR_PIN_PX8
 ((
ut8_t
)0x08

	)

2555 
	#AFIO_EVCR_PIN_PX9
 ((
ut8_t
)0x09

	)

2556 
	#AFIO_EVCR_PIN_PX10
 ((
ut8_t
)0x0A

	)

2557 
	#AFIO_EVCR_PIN_PX11
 ((
ut8_t
)0x0B

	)

2558 
	#AFIO_EVCR_PIN_PX12
 ((
ut8_t
)0x0C

	)

2559 
	#AFIO_EVCR_PIN_PX13
 ((
ut8_t
)0x0D

	)

2560 
	#AFIO_EVCR_PIN_PX14
 ((
ut8_t
)0x0E

	)

2561 
	#AFIO_EVCR_PIN_PX15
 ((
ut8_t
)0x0F

	)

2563 
	#AFIO_EVCR_PORT
 ((
ut8_t
)0x70

	)

2564 
	#AFIO_EVCR_PORT_0
 ((
ut8_t
)0x10

	)

2565 
	#AFIO_EVCR_PORT_1
 ((
ut8_t
)0x20

	)

2566 
	#AFIO_EVCR_PORT_2
 ((
ut8_t
)0x40

	)

2569 
	#AFIO_EVCR_PORT_PA
 ((
ut8_t
)0x00

	)

2570 
	#AFIO_EVCR_PORT_PB
 ((
ut8_t
)0x10

	)

2571 
	#AFIO_EVCR_PORT_PC
 ((
ut8_t
)0x20

	)

2572 
	#AFIO_EVCR_PORT_PD
 ((
ut8_t
)0x30

	)

2573 
	#AFIO_EVCR_PORT_PE
 ((
ut8_t
)0x40

	)

2575 
	#AFIO_EVCR_EVOE
 ((
ut8_t
)0x80

	)

2578 
	#AFIO_MAPR_SPI1_REMAP
 ((
ut32_t
)0x00000001

	)

2579 
	#AFIO_MAPR_I2C1_REMAP
 ((
ut32_t
)0x00000002

	)

2580 
	#AFIO_MAPR_USART1_REMAP
 ((
ut32_t
)0x00000004

	)

2581 
	#AFIO_MAPR_USART2_REMAP
 ((
ut32_t
)0x00000008

	)

2583 
	#AFIO_MAPR_USART3_REMAP
 ((
ut32_t
)0x00000030

	)

2584 
	#AFIO_MAPR_USART3_REMAP_0
 ((
ut32_t
)0x00000010

	)

2585 
	#AFIO_MAPR_USART3_REMAP_1
 ((
ut32_t
)0x00000020

	)

2588 
	#AFIO_MAPR_USART3_REMAP_NOREMAP
 ((
ut32_t
)0x00000000

	)

2589 
	#AFIO_MAPR_USART3_REMAP_PARTIALREMAP
 ((
ut32_t
)0x00000010

	)

2590 
	#AFIO_MAPR_USART3_REMAP_FULLREMAP
 ((
ut32_t
)0x00000030

	)

2592 
	#AFIO_MAPR_TIM1_REMAP
 ((
ut32_t
)0x000000C0

	)

2593 
	#AFIO_MAPR_TIM1_REMAP_0
 ((
ut32_t
)0x00000040

	)

2594 
	#AFIO_MAPR_TIM1_REMAP_1
 ((
ut32_t
)0x00000080

	)

2597 
	#AFIO_MAPR_TIM1_REMAP_NOREMAP
 ((
ut32_t
)0x00000000

	)

2598 
	#AFIO_MAPR_TIM1_REMAP_PARTIALREMAP
 ((
ut32_t
)0x00000040

	)

2599 
	#AFIO_MAPR_TIM1_REMAP_FULLREMAP
 ((
ut32_t
)0x000000C0

	)

2601 
	#AFIO_MAPR_TIM2_REMAP
 ((
ut32_t
)0x00000300

	)

2602 
	#AFIO_MAPR_TIM2_REMAP_0
 ((
ut32_t
)0x00000100

	)

2603 
	#AFIO_MAPR_TIM2_REMAP_1
 ((
ut32_t
)0x00000200

	)

2606 
	#AFIO_MAPR_TIM2_REMAP_NOREMAP
 ((
ut32_t
)0x00000000

	)

2607 
	#AFIO_MAPR_TIM2_REMAP_PARTIALREMAP1
 ((
ut32_t
)0x00000100

	)

2608 
	#AFIO_MAPR_TIM2_REMAP_PARTIALREMAP2
 ((
ut32_t
)0x00000200

	)

2609 
	#AFIO_MAPR_TIM2_REMAP_FULLREMAP
 ((
ut32_t
)0x00000300

	)

2611 
	#AFIO_MAPR_TIM3_REMAP
 ((
ut32_t
)0x00000C00

	)

2612 
	#AFIO_MAPR_TIM3_REMAP_0
 ((
ut32_t
)0x00000400

	)

2613 
	#AFIO_MAPR_TIM3_REMAP_1
 ((
ut32_t
)0x00000800

	)

2616 
	#AFIO_MAPR_TIM3_REMAP_NOREMAP
 ((
ut32_t
)0x00000000

	)

2617 
	#AFIO_MAPR_TIM3_REMAP_PARTIALREMAP
 ((
ut32_t
)0x00000800

	)

2618 
	#AFIO_MAPR_TIM3_REMAP_FULLREMAP
 ((
ut32_t
)0x00000C00

	)

2620 
	#AFIO_MAPR_TIM4_REMAP
 ((
ut32_t
)0x00001000

	)

2622 
	#AFIO_MAPR_CAN_REMAP
 ((
ut32_t
)0x00006000

	)

2623 
	#AFIO_MAPR_CAN_REMAP_0
 ((
ut32_t
)0x00002000

	)

2624 
	#AFIO_MAPR_CAN_REMAP_1
 ((
ut32_t
)0x00004000

	)

2627 
	#AFIO_MAPR_CAN_REMAP_REMAP1
 ((
ut32_t
)0x00000000

	)

2628 
	#AFIO_MAPR_CAN_REMAP_REMAP2
 ((
ut32_t
)0x00004000

	)

2629 
	#AFIO_MAPR_CAN_REMAP_REMAP3
 ((
ut32_t
)0x00006000

	)

2631 
	#AFIO_MAPR_PD01_REMAP
 ((
ut32_t
)0x00008000

	)

2632 
	#AFIO_MAPR_TIM5CH4_IREMAP
 ((
ut32_t
)0x00010000

	)

2633 
	#AFIO_MAPR_ADC1_ETRGINJ_REMAP
 ((
ut32_t
)0x00020000

	)

2634 
	#AFIO_MAPR_ADC1_ETRGREG_REMAP
 ((
ut32_t
)0x00040000

	)

2635 
	#AFIO_MAPR_ADC2_ETRGINJ_REMAP
 ((
ut32_t
)0x00080000

	)

2636 
	#AFIO_MAPR_ADC2_ETRGREG_REMAP
 ((
ut32_t
)0x00100000

	)

2639 
	#AFIO_MAPR_SWJ_CFG
 ((
ut32_t
)0x07000000

	)

2640 
	#AFIO_MAPR_SWJ_CFG_0
 ((
ut32_t
)0x01000000

	)

2641 
	#AFIO_MAPR_SWJ_CFG_1
 ((
ut32_t
)0x02000000

	)

2642 
	#AFIO_MAPR_SWJ_CFG_2
 ((
ut32_t
)0x04000000

	)

2644 
	#AFIO_MAPR_SWJ_CFG_RESET
 ((
ut32_t
)0x00000000

	)

2645 
	#AFIO_MAPR_SWJ_CFG_NOJNTRST
 ((
ut32_t
)0x01000000

	)

2646 
	#AFIO_MAPR_SWJ_CFG_JTAGDISABLE
 ((
ut32_t
)0x02000000

	)

2647 
	#AFIO_MAPR_SWJ_CFG_DISABLE
 ((
ut32_t
)0x04000000

	)

2649 #ifde
STM32F10X_CL


2651 
	#AFIO_MAPR_ETH_REMAP
 ((
ut32_t
)0x00200000

	)

2654 
	#AFIO_MAPR_CAN2_REMAP
 ((
ut32_t
)0x00400000

	)

2657 
	#AFIO_MAPR_MII_RMII_SEL
 ((
ut32_t
)0x00800000

	)

2660 
	#AFIO_MAPR_SPI3_REMAP
 ((
ut32_t
)0x10000000

	)

2663 
	#AFIO_MAPR_TIM2ITR1_IREMAP
 ((
ut32_t
)0x20000000

	)

2666 
	#AFIO_MAPR_PTP_PPS_REMAP
 ((
ut32_t
)0x20000000

	)

2670 
	#AFIO_EXTICR1_EXTI0
 ((
ut16_t
)0x000F

	)

2671 
	#AFIO_EXTICR1_EXTI1
 ((
ut16_t
)0x00F0

	)

2672 
	#AFIO_EXTICR1_EXTI2
 ((
ut16_t
)0x0F00

	)

2673 
	#AFIO_EXTICR1_EXTI3
 ((
ut16_t
)0xF000

	)

2676 
	#AFIO_EXTICR1_EXTI0_PA
 ((
ut16_t
)0x0000

	)

2677 
	#AFIO_EXTICR1_EXTI0_PB
 ((
ut16_t
)0x0001

	)

2678 
	#AFIO_EXTICR1_EXTI0_PC
 ((
ut16_t
)0x0002

	)

2679 
	#AFIO_EXTICR1_EXTI0_PD
 ((
ut16_t
)0x0003

	)

2680 
	#AFIO_EXTICR1_EXTI0_PE
 ((
ut16_t
)0x0004

	)

2681 
	#AFIO_EXTICR1_EXTI0_PF
 ((
ut16_t
)0x0005

	)

2682 
	#AFIO_EXTICR1_EXTI0_PG
 ((
ut16_t
)0x0006

	)

2685 
	#AFIO_EXTICR1_EXTI1_PA
 ((
ut16_t
)0x0000

	)

2686 
	#AFIO_EXTICR1_EXTI1_PB
 ((
ut16_t
)0x0010

	)

2687 
	#AFIO_EXTICR1_EXTI1_PC
 ((
ut16_t
)0x0020

	)

2688 
	#AFIO_EXTICR1_EXTI1_PD
 ((
ut16_t
)0x0030

	)

2689 
	#AFIO_EXTICR1_EXTI1_PE
 ((
ut16_t
)0x0040

	)

2690 
	#AFIO_EXTICR1_EXTI1_PF
 ((
ut16_t
)0x0050

	)

2691 
	#AFIO_EXTICR1_EXTI1_PG
 ((
ut16_t
)0x0060

	)

2694 
	#AFIO_EXTICR1_EXTI2_PA
 ((
ut16_t
)0x0000

	)

2695 
	#AFIO_EXTICR1_EXTI2_PB
 ((
ut16_t
)0x0100

	)

2696 
	#AFIO_EXTICR1_EXTI2_PC
 ((
ut16_t
)0x0200

	)

2697 
	#AFIO_EXTICR1_EXTI2_PD
 ((
ut16_t
)0x0300

	)

2698 
	#AFIO_EXTICR1_EXTI2_PE
 ((
ut16_t
)0x0400

	)

2699 
	#AFIO_EXTICR1_EXTI2_PF
 ((
ut16_t
)0x0500

	)

2700 
	#AFIO_EXTICR1_EXTI2_PG
 ((
ut16_t
)0x0600

	)

2703 
	#AFIO_EXTICR1_EXTI3_PA
 ((
ut16_t
)0x0000

	)

2704 
	#AFIO_EXTICR1_EXTI3_PB
 ((
ut16_t
)0x1000

	)

2705 
	#AFIO_EXTICR1_EXTI3_PC
 ((
ut16_t
)0x2000

	)

2706 
	#AFIO_EXTICR1_EXTI3_PD
 ((
ut16_t
)0x3000

	)

2707 
	#AFIO_EXTICR1_EXTI3_PE
 ((
ut16_t
)0x4000

	)

2708 
	#AFIO_EXTICR1_EXTI3_PF
 ((
ut16_t
)0x5000

	)

2709 
	#AFIO_EXTICR1_EXTI3_PG
 ((
ut16_t
)0x6000

	)

2712 
	#AFIO_EXTICR2_EXTI4
 ((
ut16_t
)0x000F

	)

2713 
	#AFIO_EXTICR2_EXTI5
 ((
ut16_t
)0x00F0

	)

2714 
	#AFIO_EXTICR2_EXTI6
 ((
ut16_t
)0x0F00

	)

2715 
	#AFIO_EXTICR2_EXTI7
 ((
ut16_t
)0xF000

	)

2718 
	#AFIO_EXTICR2_EXTI4_PA
 ((
ut16_t
)0x0000

	)

2719 
	#AFIO_EXTICR2_EXTI4_PB
 ((
ut16_t
)0x0001

	)

2720 
	#AFIO_EXTICR2_EXTI4_PC
 ((
ut16_t
)0x0002

	)

2721 
	#AFIO_EXTICR2_EXTI4_PD
 ((
ut16_t
)0x0003

	)

2722 
	#AFIO_EXTICR2_EXTI4_PE
 ((
ut16_t
)0x0004

	)

2723 
	#AFIO_EXTICR2_EXTI4_PF
 ((
ut16_t
)0x0005

	)

2724 
	#AFIO_EXTICR2_EXTI4_PG
 ((
ut16_t
)0x0006

	)

2727 
	#AFIO_EXTICR2_EXTI5_PA
 ((
ut16_t
)0x0000

	)

2728 
	#AFIO_EXTICR2_EXTI5_PB
 ((
ut16_t
)0x0010

	)

2729 
	#AFIO_EXTICR2_EXTI5_PC
 ((
ut16_t
)0x0020

	)

2730 
	#AFIO_EXTICR2_EXTI5_PD
 ((
ut16_t
)0x0030

	)

2731 
	#AFIO_EXTICR2_EXTI5_PE
 ((
ut16_t
)0x0040

	)

2732 
	#AFIO_EXTICR2_EXTI5_PF
 ((
ut16_t
)0x0050

	)

2733 
	#AFIO_EXTICR2_EXTI5_PG
 ((
ut16_t
)0x0060

	)

2736 
	#AFIO_EXTICR2_EXTI6_PA
 ((
ut16_t
)0x0000

	)

2737 
	#AFIO_EXTICR2_EXTI6_PB
 ((
ut16_t
)0x0100

	)

2738 
	#AFIO_EXTICR2_EXTI6_PC
 ((
ut16_t
)0x0200

	)

2739 
	#AFIO_EXTICR2_EXTI6_PD
 ((
ut16_t
)0x0300

	)

2740 
	#AFIO_EXTICR2_EXTI6_PE
 ((
ut16_t
)0x0400

	)

2741 
	#AFIO_EXTICR2_EXTI6_PF
 ((
ut16_t
)0x0500

	)

2742 
	#AFIO_EXTICR2_EXTI6_PG
 ((
ut16_t
)0x0600

	)

2745 
	#AFIO_EXTICR2_EXTI7_PA
 ((
ut16_t
)0x0000

	)

2746 
	#AFIO_EXTICR2_EXTI7_PB
 ((
ut16_t
)0x1000

	)

2747 
	#AFIO_EXTICR2_EXTI7_PC
 ((
ut16_t
)0x2000

	)

2748 
	#AFIO_EXTICR2_EXTI7_PD
 ((
ut16_t
)0x3000

	)

2749 
	#AFIO_EXTICR2_EXTI7_PE
 ((
ut16_t
)0x4000

	)

2750 
	#AFIO_EXTICR2_EXTI7_PF
 ((
ut16_t
)0x5000

	)

2751 
	#AFIO_EXTICR2_EXTI7_PG
 ((
ut16_t
)0x6000

	)

2754 
	#AFIO_EXTICR3_EXTI8
 ((
ut16_t
)0x000F

	)

2755 
	#AFIO_EXTICR3_EXTI9
 ((
ut16_t
)0x00F0

	)

2756 
	#AFIO_EXTICR3_EXTI10
 ((
ut16_t
)0x0F00

	)

2757 
	#AFIO_EXTICR3_EXTI11
 ((
ut16_t
)0xF000

	)

2760 
	#AFIO_EXTICR3_EXTI8_PA
 ((
ut16_t
)0x0000

	)

2761 
	#AFIO_EXTICR3_EXTI8_PB
 ((
ut16_t
)0x0001

	)

2762 
	#AFIO_EXTICR3_EXTI8_PC
 ((
ut16_t
)0x0002

	)

2763 
	#AFIO_EXTICR3_EXTI8_PD
 ((
ut16_t
)0x0003

	)

2764 
	#AFIO_EXTICR3_EXTI8_PE
 ((
ut16_t
)0x0004

	)

2765 
	#AFIO_EXTICR3_EXTI8_PF
 ((
ut16_t
)0x0005

	)

2766 
	#AFIO_EXTICR3_EXTI8_PG
 ((
ut16_t
)0x0006

	)

2769 
	#AFIO_EXTICR3_EXTI9_PA
 ((
ut16_t
)0x0000

	)

2770 
	#AFIO_EXTICR3_EXTI9_PB
 ((
ut16_t
)0x0010

	)

2771 
	#AFIO_EXTICR3_EXTI9_PC
 ((
ut16_t
)0x0020

	)

2772 
	#AFIO_EXTICR3_EXTI9_PD
 ((
ut16_t
)0x0030

	)

2773 
	#AFIO_EXTICR3_EXTI9_PE
 ((
ut16_t
)0x0040

	)

2774 
	#AFIO_EXTICR3_EXTI9_PF
 ((
ut16_t
)0x0050

	)

2775 
	#AFIO_EXTICR3_EXTI9_PG
 ((
ut16_t
)0x0060

	)

2778 
	#AFIO_EXTICR3_EXTI10_PA
 ((
ut16_t
)0x0000

	)

2779 
	#AFIO_EXTICR3_EXTI10_PB
 ((
ut16_t
)0x0100

	)

2780 
	#AFIO_EXTICR3_EXTI10_PC
 ((
ut16_t
)0x0200

	)

2781 
	#AFIO_EXTICR3_EXTI10_PD
 ((
ut16_t
)0x0300

	)

2782 
	#AFIO_EXTICR3_EXTI10_PE
 ((
ut16_t
)0x0400

	)

2783 
	#AFIO_EXTICR3_EXTI10_PF
 ((
ut16_t
)0x0500

	)

2784 
	#AFIO_EXTICR3_EXTI10_PG
 ((
ut16_t
)0x0600

	)

2787 
	#AFIO_EXTICR3_EXTI11_PA
 ((
ut16_t
)0x0000

	)

2788 
	#AFIO_EXTICR3_EXTI11_PB
 ((
ut16_t
)0x1000

	)

2789 
	#AFIO_EXTICR3_EXTI11_PC
 ((
ut16_t
)0x2000

	)

2790 
	#AFIO_EXTICR3_EXTI11_PD
 ((
ut16_t
)0x3000

	)

2791 
	#AFIO_EXTICR3_EXTI11_PE
 ((
ut16_t
)0x4000

	)

2792 
	#AFIO_EXTICR3_EXTI11_PF
 ((
ut16_t
)0x5000

	)

2793 
	#AFIO_EXTICR3_EXTI11_PG
 ((
ut16_t
)0x6000

	)

2796 
	#AFIO_EXTICR4_EXTI12
 ((
ut16_t
)0x000F

	)

2797 
	#AFIO_EXTICR4_EXTI13
 ((
ut16_t
)0x00F0

	)

2798 
	#AFIO_EXTICR4_EXTI14
 ((
ut16_t
)0x0F00

	)

2799 
	#AFIO_EXTICR4_EXTI15
 ((
ut16_t
)0xF000

	)

2802 
	#AFIO_EXTICR4_EXTI12_PA
 ((
ut16_t
)0x0000

	)

2803 
	#AFIO_EXTICR4_EXTI12_PB
 ((
ut16_t
)0x0001

	)

2804 
	#AFIO_EXTICR4_EXTI12_PC
 ((
ut16_t
)0x0002

	)

2805 
	#AFIO_EXTICR4_EXTI12_PD
 ((
ut16_t
)0x0003

	)

2806 
	#AFIO_EXTICR4_EXTI12_PE
 ((
ut16_t
)0x0004

	)

2807 
	#AFIO_EXTICR4_EXTI12_PF
 ((
ut16_t
)0x0005

	)

2808 
	#AFIO_EXTICR4_EXTI12_PG
 ((
ut16_t
)0x0006

	)

2811 
	#AFIO_EXTICR4_EXTI13_PA
 ((
ut16_t
)0x0000

	)

2812 
	#AFIO_EXTICR4_EXTI13_PB
 ((
ut16_t
)0x0010

	)

2813 
	#AFIO_EXTICR4_EXTI13_PC
 ((
ut16_t
)0x0020

	)

2814 
	#AFIO_EXTICR4_EXTI13_PD
 ((
ut16_t
)0x0030

	)

2815 
	#AFIO_EXTICR4_EXTI13_PE
 ((
ut16_t
)0x0040

	)

2816 
	#AFIO_EXTICR4_EXTI13_PF
 ((
ut16_t
)0x0050

	)

2817 
	#AFIO_EXTICR4_EXTI13_PG
 ((
ut16_t
)0x0060

	)

2820 
	#AFIO_EXTICR4_EXTI14_PA
 ((
ut16_t
)0x0000

	)

2821 
	#AFIO_EXTICR4_EXTI14_PB
 ((
ut16_t
)0x0100

	)

2822 
	#AFIO_EXTICR4_EXTI14_PC
 ((
ut16_t
)0x0200

	)

2823 
	#AFIO_EXTICR4_EXTI14_PD
 ((
ut16_t
)0x0300

	)

2824 
	#AFIO_EXTICR4_EXTI14_PE
 ((
ut16_t
)0x0400

	)

2825 
	#AFIO_EXTICR4_EXTI14_PF
 ((
ut16_t
)0x0500

	)

2826 
	#AFIO_EXTICR4_EXTI14_PG
 ((
ut16_t
)0x0600

	)

2829 
	#AFIO_EXTICR4_EXTI15_PA
 ((
ut16_t
)0x0000

	)

2830 
	#AFIO_EXTICR4_EXTI15_PB
 ((
ut16_t
)0x1000

	)

2831 
	#AFIO_EXTICR4_EXTI15_PC
 ((
ut16_t
)0x2000

	)

2832 
	#AFIO_EXTICR4_EXTI15_PD
 ((
ut16_t
)0x3000

	)

2833 
	#AFIO_EXTICR4_EXTI15_PE
 ((
ut16_t
)0x4000

	)

2834 
	#AFIO_EXTICR4_EXTI15_PF
 ((
ut16_t
)0x5000

	)

2835 
	#AFIO_EXTICR4_EXTI15_PG
 ((
ut16_t
)0x6000

	)

2837 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

2839 
	#AFIO_MAPR2_TIM15_REMAP
 ((
ut32_t
)0x00000001

	)

2840 
	#AFIO_MAPR2_TIM16_REMAP
 ((
ut32_t
)0x00000002

	)

2841 
	#AFIO_MAPR2_TIM17_REMAP
 ((
ut32_t
)0x00000004

	)

2842 
	#AFIO_MAPR2_CEC_REMAP
 ((
ut32_t
)0x00000008

	)

2843 
	#AFIO_MAPR2_TIM1_DMA_REMAP
 ((
ut32_t
)0x00000010

	)

2846 #ifde
STM32F10X_HD_VL


2847 
	#AFIO_MAPR2_TIM13_REMAP
 ((
ut32_t
)0x00000100

	)

2848 
	#AFIO_MAPR2_TIM14_REMAP
 ((
ut32_t
)0x00000200

	)

2849 
	#AFIO_MAPR2_FSMC_NADV_REMAP
 ((
ut32_t
)0x00000400

	)

2850 
	#AFIO_MAPR2_TIM67_DAC_DMA_REMAP
 ((
ut32_t
)0x00000800

	)

2851 
	#AFIO_MAPR2_TIM12_REMAP
 ((
ut32_t
)0x00001000

	)

2852 
	#AFIO_MAPR2_MISC_REMAP
 ((
ut32_t
)0x00002000

	)

2855 #ifde
STM32F10X_XL


2857 
	#AFIO_MAPR2_TIM9_REMAP
 ((
ut32_t
)0x00000020

	)

2858 
	#AFIO_MAPR2_TIM10_REMAP
 ((
ut32_t
)0x00000040

	)

2859 
	#AFIO_MAPR2_TIM11_REMAP
 ((
ut32_t
)0x00000080

	)

2860 
	#AFIO_MAPR2_TIM13_REMAP
 ((
ut32_t
)0x00000100

	)

2861 
	#AFIO_MAPR2_TIM14_REMAP
 ((
ut32_t
)0x00000200

	)

2862 
	#AFIO_MAPR2_FSMC_NADV_REMAP
 ((
ut32_t
)0x00000400

	)

2872 
	#SysTick_CTRL_ENABLE
 ((
ut32_t
)0x00000001

	)

2873 
	#SysTick_CTRL_TICKINT
 ((
ut32_t
)0x00000002

	)

2874 
	#SysTick_CTRL_CLKSOURCE
 ((
ut32_t
)0x00000004

	)

2875 
	#SysTick_CTRL_COUNTFLAG
 ((
ut32_t
)0x00010000

	)

2878 
	#SysTick_LOAD_RELOAD
 ((
ut32_t
)0x00FFFFFF

	)

2881 
	#SysTick_VAL_CURRENT
 ((
ut32_t
)0x00FFFFFF

	)

2884 
	#SysTick_CALIB_TENMS
 ((
ut32_t
)0x00FFFFFF

	)

2885 
	#SysTick_CALIB_SKEW
 ((
ut32_t
)0x40000000

	)

2886 
	#SysTick_CALIB_NOREF
 ((
ut32_t
)0x80000000

	)

2895 
	#NVIC_ISER_SETENA
 ((
ut32_t
)0xFFFFFFFF

	)

2896 
	#NVIC_ISER_SETENA_0
 ((
ut32_t
)0x00000001

	)

2897 
	#NVIC_ISER_SETENA_1
 ((
ut32_t
)0x00000002

	)

2898 
	#NVIC_ISER_SETENA_2
 ((
ut32_t
)0x00000004

	)

2899 
	#NVIC_ISER_SETENA_3
 ((
ut32_t
)0x00000008

	)

2900 
	#NVIC_ISER_SETENA_4
 ((
ut32_t
)0x00000010

	)

2901 
	#NVIC_ISER_SETENA_5
 ((
ut32_t
)0x00000020

	)

2902 
	#NVIC_ISER_SETENA_6
 ((
ut32_t
)0x00000040

	)

2903 
	#NVIC_ISER_SETENA_7
 ((
ut32_t
)0x00000080

	)

2904 
	#NVIC_ISER_SETENA_8
 ((
ut32_t
)0x00000100

	)

2905 
	#NVIC_ISER_SETENA_9
 ((
ut32_t
)0x00000200

	)

2906 
	#NVIC_ISER_SETENA_10
 ((
ut32_t
)0x00000400

	)

2907 
	#NVIC_ISER_SETENA_11
 ((
ut32_t
)0x00000800

	)

2908 
	#NVIC_ISER_SETENA_12
 ((
ut32_t
)0x00001000

	)

2909 
	#NVIC_ISER_SETENA_13
 ((
ut32_t
)0x00002000

	)

2910 
	#NVIC_ISER_SETENA_14
 ((
ut32_t
)0x00004000

	)

2911 
	#NVIC_ISER_SETENA_15
 ((
ut32_t
)0x00008000

	)

2912 
	#NVIC_ISER_SETENA_16
 ((
ut32_t
)0x00010000

	)

2913 
	#NVIC_ISER_SETENA_17
 ((
ut32_t
)0x00020000

	)

2914 
	#NVIC_ISER_SETENA_18
 ((
ut32_t
)0x00040000

	)

2915 
	#NVIC_ISER_SETENA_19
 ((
ut32_t
)0x00080000

	)

2916 
	#NVIC_ISER_SETENA_20
 ((
ut32_t
)0x00100000

	)

2917 
	#NVIC_ISER_SETENA_21
 ((
ut32_t
)0x00200000

	)

2918 
	#NVIC_ISER_SETENA_22
 ((
ut32_t
)0x00400000

	)

2919 
	#NVIC_ISER_SETENA_23
 ((
ut32_t
)0x00800000

	)

2920 
	#NVIC_ISER_SETENA_24
 ((
ut32_t
)0x01000000

	)

2921 
	#NVIC_ISER_SETENA_25
 ((
ut32_t
)0x02000000

	)

2922 
	#NVIC_ISER_SETENA_26
 ((
ut32_t
)0x04000000

	)

2923 
	#NVIC_ISER_SETENA_27
 ((
ut32_t
)0x08000000

	)

2924 
	#NVIC_ISER_SETENA_28
 ((
ut32_t
)0x10000000

	)

2925 
	#NVIC_ISER_SETENA_29
 ((
ut32_t
)0x20000000

	)

2926 
	#NVIC_ISER_SETENA_30
 ((
ut32_t
)0x40000000

	)

2927 
	#NVIC_ISER_SETENA_31
 ((
ut32_t
)0x80000000

	)

2930 
	#NVIC_ICER_CLRENA
 ((
ut32_t
)0xFFFFFFFF

	)

2931 
	#NVIC_ICER_CLRENA_0
 ((
ut32_t
)0x00000001

	)

2932 
	#NVIC_ICER_CLRENA_1
 ((
ut32_t
)0x00000002

	)

2933 
	#NVIC_ICER_CLRENA_2
 ((
ut32_t
)0x00000004

	)

2934 
	#NVIC_ICER_CLRENA_3
 ((
ut32_t
)0x00000008

	)

2935 
	#NVIC_ICER_CLRENA_4
 ((
ut32_t
)0x00000010

	)

2936 
	#NVIC_ICER_CLRENA_5
 ((
ut32_t
)0x00000020

	)

2937 
	#NVIC_ICER_CLRENA_6
 ((
ut32_t
)0x00000040

	)

2938 
	#NVIC_ICER_CLRENA_7
 ((
ut32_t
)0x00000080

	)

2939 
	#NVIC_ICER_CLRENA_8
 ((
ut32_t
)0x00000100

	)

2940 
	#NVIC_ICER_CLRENA_9
 ((
ut32_t
)0x00000200

	)

2941 
	#NVIC_ICER_CLRENA_10
 ((
ut32_t
)0x00000400

	)

2942 
	#NVIC_ICER_CLRENA_11
 ((
ut32_t
)0x00000800

	)

2943 
	#NVIC_ICER_CLRENA_12
 ((
ut32_t
)0x00001000

	)

2944 
	#NVIC_ICER_CLRENA_13
 ((
ut32_t
)0x00002000

	)

2945 
	#NVIC_ICER_CLRENA_14
 ((
ut32_t
)0x00004000

	)

2946 
	#NVIC_ICER_CLRENA_15
 ((
ut32_t
)0x00008000

	)

2947 
	#NVIC_ICER_CLRENA_16
 ((
ut32_t
)0x00010000

	)

2948 
	#NVIC_ICER_CLRENA_17
 ((
ut32_t
)0x00020000

	)

2949 
	#NVIC_ICER_CLRENA_18
 ((
ut32_t
)0x00040000

	)

2950 
	#NVIC_ICER_CLRENA_19
 ((
ut32_t
)0x00080000

	)

2951 
	#NVIC_ICER_CLRENA_20
 ((
ut32_t
)0x00100000

	)

2952 
	#NVIC_ICER_CLRENA_21
 ((
ut32_t
)0x00200000

	)

2953 
	#NVIC_ICER_CLRENA_22
 ((
ut32_t
)0x00400000

	)

2954 
	#NVIC_ICER_CLRENA_23
 ((
ut32_t
)0x00800000

	)

2955 
	#NVIC_ICER_CLRENA_24
 ((
ut32_t
)0x01000000

	)

2956 
	#NVIC_ICER_CLRENA_25
 ((
ut32_t
)0x02000000

	)

2957 
	#NVIC_ICER_CLRENA_26
 ((
ut32_t
)0x04000000

	)

2958 
	#NVIC_ICER_CLRENA_27
 ((
ut32_t
)0x08000000

	)

2959 
	#NVIC_ICER_CLRENA_28
 ((
ut32_t
)0x10000000

	)

2960 
	#NVIC_ICER_CLRENA_29
 ((
ut32_t
)0x20000000

	)

2961 
	#NVIC_ICER_CLRENA_30
 ((
ut32_t
)0x40000000

	)

2962 
	#NVIC_ICER_CLRENA_31
 ((
ut32_t
)0x80000000

	)

2965 
	#NVIC_ISPR_SETPEND
 ((
ut32_t
)0xFFFFFFFF

	)

2966 
	#NVIC_ISPR_SETPEND_0
 ((
ut32_t
)0x00000001

	)

2967 
	#NVIC_ISPR_SETPEND_1
 ((
ut32_t
)0x00000002

	)

2968 
	#NVIC_ISPR_SETPEND_2
 ((
ut32_t
)0x00000004

	)

2969 
	#NVIC_ISPR_SETPEND_3
 ((
ut32_t
)0x00000008

	)

2970 
	#NVIC_ISPR_SETPEND_4
 ((
ut32_t
)0x00000010

	)

2971 
	#NVIC_ISPR_SETPEND_5
 ((
ut32_t
)0x00000020

	)

2972 
	#NVIC_ISPR_SETPEND_6
 ((
ut32_t
)0x00000040

	)

2973 
	#NVIC_ISPR_SETPEND_7
 ((
ut32_t
)0x00000080

	)

2974 
	#NVIC_ISPR_SETPEND_8
 ((
ut32_t
)0x00000100

	)

2975 
	#NVIC_ISPR_SETPEND_9
 ((
ut32_t
)0x00000200

	)

2976 
	#NVIC_ISPR_SETPEND_10
 ((
ut32_t
)0x00000400

	)

2977 
	#NVIC_ISPR_SETPEND_11
 ((
ut32_t
)0x00000800

	)

2978 
	#NVIC_ISPR_SETPEND_12
 ((
ut32_t
)0x00001000

	)

2979 
	#NVIC_ISPR_SETPEND_13
 ((
ut32_t
)0x00002000

	)

2980 
	#NVIC_ISPR_SETPEND_14
 ((
ut32_t
)0x00004000

	)

2981 
	#NVIC_ISPR_SETPEND_15
 ((
ut32_t
)0x00008000

	)

2982 
	#NVIC_ISPR_SETPEND_16
 ((
ut32_t
)0x00010000

	)

2983 
	#NVIC_ISPR_SETPEND_17
 ((
ut32_t
)0x00020000

	)

2984 
	#NVIC_ISPR_SETPEND_18
 ((
ut32_t
)0x00040000

	)

2985 
	#NVIC_ISPR_SETPEND_19
 ((
ut32_t
)0x00080000

	)

2986 
	#NVIC_ISPR_SETPEND_20
 ((
ut32_t
)0x00100000

	)

2987 
	#NVIC_ISPR_SETPEND_21
 ((
ut32_t
)0x00200000

	)

2988 
	#NVIC_ISPR_SETPEND_22
 ((
ut32_t
)0x00400000

	)

2989 
	#NVIC_ISPR_SETPEND_23
 ((
ut32_t
)0x00800000

	)

2990 
	#NVIC_ISPR_SETPEND_24
 ((
ut32_t
)0x01000000

	)

2991 
	#NVIC_ISPR_SETPEND_25
 ((
ut32_t
)0x02000000

	)

2992 
	#NVIC_ISPR_SETPEND_26
 ((
ut32_t
)0x04000000

	)

2993 
	#NVIC_ISPR_SETPEND_27
 ((
ut32_t
)0x08000000

	)

2994 
	#NVIC_ISPR_SETPEND_28
 ((
ut32_t
)0x10000000

	)

2995 
	#NVIC_ISPR_SETPEND_29
 ((
ut32_t
)0x20000000

	)

2996 
	#NVIC_ISPR_SETPEND_30
 ((
ut32_t
)0x40000000

	)

2997 
	#NVIC_ISPR_SETPEND_31
 ((
ut32_t
)0x80000000

	)

3000 
	#NVIC_ICPR_CLRPEND
 ((
ut32_t
)0xFFFFFFFF

	)

3001 
	#NVIC_ICPR_CLRPEND_0
 ((
ut32_t
)0x00000001

	)

3002 
	#NVIC_ICPR_CLRPEND_1
 ((
ut32_t
)0x00000002

	)

3003 
	#NVIC_ICPR_CLRPEND_2
 ((
ut32_t
)0x00000004

	)

3004 
	#NVIC_ICPR_CLRPEND_3
 ((
ut32_t
)0x00000008

	)

3005 
	#NVIC_ICPR_CLRPEND_4
 ((
ut32_t
)0x00000010

	)

3006 
	#NVIC_ICPR_CLRPEND_5
 ((
ut32_t
)0x00000020

	)

3007 
	#NVIC_ICPR_CLRPEND_6
 ((
ut32_t
)0x00000040

	)

3008 
	#NVIC_ICPR_CLRPEND_7
 ((
ut32_t
)0x00000080

	)

3009 
	#NVIC_ICPR_CLRPEND_8
 ((
ut32_t
)0x00000100

	)

3010 
	#NVIC_ICPR_CLRPEND_9
 ((
ut32_t
)0x00000200

	)

3011 
	#NVIC_ICPR_CLRPEND_10
 ((
ut32_t
)0x00000400

	)

3012 
	#NVIC_ICPR_CLRPEND_11
 ((
ut32_t
)0x00000800

	)

3013 
	#NVIC_ICPR_CLRPEND_12
 ((
ut32_t
)0x00001000

	)

3014 
	#NVIC_ICPR_CLRPEND_13
 ((
ut32_t
)0x00002000

	)

3015 
	#NVIC_ICPR_CLRPEND_14
 ((
ut32_t
)0x00004000

	)

3016 
	#NVIC_ICPR_CLRPEND_15
 ((
ut32_t
)0x00008000

	)

3017 
	#NVIC_ICPR_CLRPEND_16
 ((
ut32_t
)0x00010000

	)

3018 
	#NVIC_ICPR_CLRPEND_17
 ((
ut32_t
)0x00020000

	)

3019 
	#NVIC_ICPR_CLRPEND_18
 ((
ut32_t
)0x00040000

	)

3020 
	#NVIC_ICPR_CLRPEND_19
 ((
ut32_t
)0x00080000

	)

3021 
	#NVIC_ICPR_CLRPEND_20
 ((
ut32_t
)0x00100000

	)

3022 
	#NVIC_ICPR_CLRPEND_21
 ((
ut32_t
)0x00200000

	)

3023 
	#NVIC_ICPR_CLRPEND_22
 ((
ut32_t
)0x00400000

	)

3024 
	#NVIC_ICPR_CLRPEND_23
 ((
ut32_t
)0x00800000

	)

3025 
	#NVIC_ICPR_CLRPEND_24
 ((
ut32_t
)0x01000000

	)

3026 
	#NVIC_ICPR_CLRPEND_25
 ((
ut32_t
)0x02000000

	)

3027 
	#NVIC_ICPR_CLRPEND_26
 ((
ut32_t
)0x04000000

	)

3028 
	#NVIC_ICPR_CLRPEND_27
 ((
ut32_t
)0x08000000

	)

3029 
	#NVIC_ICPR_CLRPEND_28
 ((
ut32_t
)0x10000000

	)

3030 
	#NVIC_ICPR_CLRPEND_29
 ((
ut32_t
)0x20000000

	)

3031 
	#NVIC_ICPR_CLRPEND_30
 ((
ut32_t
)0x40000000

	)

3032 
	#NVIC_ICPR_CLRPEND_31
 ((
ut32_t
)0x80000000

	)

3035 
	#NVIC_IABR_ACTIVE
 ((
ut32_t
)0xFFFFFFFF

	)

3036 
	#NVIC_IABR_ACTIVE_0
 ((
ut32_t
)0x00000001

	)

3037 
	#NVIC_IABR_ACTIVE_1
 ((
ut32_t
)0x00000002

	)

3038 
	#NVIC_IABR_ACTIVE_2
 ((
ut32_t
)0x00000004

	)

3039 
	#NVIC_IABR_ACTIVE_3
 ((
ut32_t
)0x00000008

	)

3040 
	#NVIC_IABR_ACTIVE_4
 ((
ut32_t
)0x00000010

	)

3041 
	#NVIC_IABR_ACTIVE_5
 ((
ut32_t
)0x00000020

	)

3042 
	#NVIC_IABR_ACTIVE_6
 ((
ut32_t
)0x00000040

	)

3043 
	#NVIC_IABR_ACTIVE_7
 ((
ut32_t
)0x00000080

	)

3044 
	#NVIC_IABR_ACTIVE_8
 ((
ut32_t
)0x00000100

	)

3045 
	#NVIC_IABR_ACTIVE_9
 ((
ut32_t
)0x00000200

	)

3046 
	#NVIC_IABR_ACTIVE_10
 ((
ut32_t
)0x00000400

	)

3047 
	#NVIC_IABR_ACTIVE_11
 ((
ut32_t
)0x00000800

	)

3048 
	#NVIC_IABR_ACTIVE_12
 ((
ut32_t
)0x00001000

	)

3049 
	#NVIC_IABR_ACTIVE_13
 ((
ut32_t
)0x00002000

	)

3050 
	#NVIC_IABR_ACTIVE_14
 ((
ut32_t
)0x00004000

	)

3051 
	#NVIC_IABR_ACTIVE_15
 ((
ut32_t
)0x00008000

	)

3052 
	#NVIC_IABR_ACTIVE_16
 ((
ut32_t
)0x00010000

	)

3053 
	#NVIC_IABR_ACTIVE_17
 ((
ut32_t
)0x00020000

	)

3054 
	#NVIC_IABR_ACTIVE_18
 ((
ut32_t
)0x00040000

	)

3055 
	#NVIC_IABR_ACTIVE_19
 ((
ut32_t
)0x00080000

	)

3056 
	#NVIC_IABR_ACTIVE_20
 ((
ut32_t
)0x00100000

	)

3057 
	#NVIC_IABR_ACTIVE_21
 ((
ut32_t
)0x00200000

	)

3058 
	#NVIC_IABR_ACTIVE_22
 ((
ut32_t
)0x00400000

	)

3059 
	#NVIC_IABR_ACTIVE_23
 ((
ut32_t
)0x00800000

	)

3060 
	#NVIC_IABR_ACTIVE_24
 ((
ut32_t
)0x01000000

	)

3061 
	#NVIC_IABR_ACTIVE_25
 ((
ut32_t
)0x02000000

	)

3062 
	#NVIC_IABR_ACTIVE_26
 ((
ut32_t
)0x04000000

	)

3063 
	#NVIC_IABR_ACTIVE_27
 ((
ut32_t
)0x08000000

	)

3064 
	#NVIC_IABR_ACTIVE_28
 ((
ut32_t
)0x10000000

	)

3065 
	#NVIC_IABR_ACTIVE_29
 ((
ut32_t
)0x20000000

	)

3066 
	#NVIC_IABR_ACTIVE_30
 ((
ut32_t
)0x40000000

	)

3067 
	#NVIC_IABR_ACTIVE_31
 ((
ut32_t
)0x80000000

	)

3070 
	#NVIC_IPR0_PRI_0
 ((
ut32_t
)0x000000FF

	)

3071 
	#NVIC_IPR0_PRI_1
 ((
ut32_t
)0x0000FF00

	)

3072 
	#NVIC_IPR0_PRI_2
 ((
ut32_t
)0x00FF0000

	)

3073 
	#NVIC_IPR0_PRI_3
 ((
ut32_t
)0xFF000000

	)

3076 
	#NVIC_IPR1_PRI_4
 ((
ut32_t
)0x000000FF

	)

3077 
	#NVIC_IPR1_PRI_5
 ((
ut32_t
)0x0000FF00

	)

3078 
	#NVIC_IPR1_PRI_6
 ((
ut32_t
)0x00FF0000

	)

3079 
	#NVIC_IPR1_PRI_7
 ((
ut32_t
)0xFF000000

	)

3082 
	#NVIC_IPR2_PRI_8
 ((
ut32_t
)0x000000FF

	)

3083 
	#NVIC_IPR2_PRI_9
 ((
ut32_t
)0x0000FF00

	)

3084 
	#NVIC_IPR2_PRI_10
 ((
ut32_t
)0x00FF0000

	)

3085 
	#NVIC_IPR2_PRI_11
 ((
ut32_t
)0xFF000000

	)

3088 
	#NVIC_IPR3_PRI_12
 ((
ut32_t
)0x000000FF

	)

3089 
	#NVIC_IPR3_PRI_13
 ((
ut32_t
)0x0000FF00

	)

3090 
	#NVIC_IPR3_PRI_14
 ((
ut32_t
)0x00FF0000

	)

3091 
	#NVIC_IPR3_PRI_15
 ((
ut32_t
)0xFF000000

	)

3094 
	#NVIC_IPR4_PRI_16
 ((
ut32_t
)0x000000FF

	)

3095 
	#NVIC_IPR4_PRI_17
 ((
ut32_t
)0x0000FF00

	)

3096 
	#NVIC_IPR4_PRI_18
 ((
ut32_t
)0x00FF0000

	)

3097 
	#NVIC_IPR4_PRI_19
 ((
ut32_t
)0xFF000000

	)

3100 
	#NVIC_IPR5_PRI_20
 ((
ut32_t
)0x000000FF

	)

3101 
	#NVIC_IPR5_PRI_21
 ((
ut32_t
)0x0000FF00

	)

3102 
	#NVIC_IPR5_PRI_22
 ((
ut32_t
)0x00FF0000

	)

3103 
	#NVIC_IPR5_PRI_23
 ((
ut32_t
)0xFF000000

	)

3106 
	#NVIC_IPR6_PRI_24
 ((
ut32_t
)0x000000FF

	)

3107 
	#NVIC_IPR6_PRI_25
 ((
ut32_t
)0x0000FF00

	)

3108 
	#NVIC_IPR6_PRI_26
 ((
ut32_t
)0x00FF0000

	)

3109 
	#NVIC_IPR6_PRI_27
 ((
ut32_t
)0xFF000000

	)

3112 
	#NVIC_IPR7_PRI_28
 ((
ut32_t
)0x000000FF

	)

3113 
	#NVIC_IPR7_PRI_29
 ((
ut32_t
)0x0000FF00

	)

3114 
	#NVIC_IPR7_PRI_30
 ((
ut32_t
)0x00FF0000

	)

3115 
	#NVIC_IPR7_PRI_31
 ((
ut32_t
)0xFF000000

	)

3118 
	#SCB_CPUID_REVISION
 ((
ut32_t
)0x0000000F

	)

3119 
	#SCB_CPUID_PARTNO
 ((
ut32_t
)0x0000FFF0

	)

3120 
	#SCB_CPUID_Cڡt
 ((
ut32_t
)0x000F0000

	)

3121 
	#SCB_CPUID_VARIANT
 ((
ut32_t
)0x00F00000

	)

3122 
	#SCB_CPUID_IMPLEMENTER
 ((
ut32_t
)0xFF000000

	)

3125 
	#SCB_ICSR_VECTACTIVE
 ((
ut32_t
)0x000001FF

	)

3126 
	#SCB_ICSR_RETTOBASE
 ((
ut32_t
)0x00000800

	)

3127 
	#SCB_ICSR_VECTPENDING
 ((
ut32_t
)0x003FF000

	)

3128 
	#SCB_ICSR_ISRPENDING
 ((
ut32_t
)0x00400000

	)

3129 
	#SCB_ICSR_ISRPREEMPT
 ((
ut32_t
)0x00800000

	)

3130 
	#SCB_ICSR_PENDSTCLR
 ((
ut32_t
)0x02000000

	)

3131 
	#SCB_ICSR_PENDSTSET
 ((
ut32_t
)0x04000000

	)

3132 
	#SCB_ICSR_PENDSVCLR
 ((
ut32_t
)0x08000000

	)

3133 
	#SCB_ICSR_PENDSVSET
 ((
ut32_t
)0x10000000

	)

3134 
	#SCB_ICSR_NMIPENDSET
 ((
ut32_t
)0x80000000

	)

3137 
	#SCB_VTOR_TBLOFF
 ((
ut32_t
)0x1FFFFF80

	)

3138 
	#SCB_VTOR_TBLBASE
 ((
ut32_t
)0x20000000

	)

3141 
	#SCB_AIRCR_VECTRESET
 ((
ut32_t
)0x00000001

	)

3142 
	#SCB_AIRCR_VECTCLRACTIVE
 ((
ut32_t
)0x00000002

	)

3143 
	#SCB_AIRCR_SYSRESETREQ
 ((
ut32_t
)0x00000004

	)

3145 
	#SCB_AIRCR_PRIGROUP
 ((
ut32_t
)0x00000700

	)

3146 
	#SCB_AIRCR_PRIGROUP_0
 ((
ut32_t
)0x00000100

	)

3147 
	#SCB_AIRCR_PRIGROUP_1
 ((
ut32_t
)0x00000200

	)

3148 
	#SCB_AIRCR_PRIGROUP_2
 ((
ut32_t
)0x00000400

	)

3151 
	#SCB_AIRCR_PRIGROUP0
 ((
ut32_t
)0x00000000

	)

3152 
	#SCB_AIRCR_PRIGROUP1
 ((
ut32_t
)0x00000100

	)

3153 
	#SCB_AIRCR_PRIGROUP2
 ((
ut32_t
)0x00000200

	)

3154 
	#SCB_AIRCR_PRIGROUP3
 ((
ut32_t
)0x00000300

	)

3155 
	#SCB_AIRCR_PRIGROUP4
 ((
ut32_t
)0x00000400

	)

3156 
	#SCB_AIRCR_PRIGROUP5
 ((
ut32_t
)0x00000500

	)

3157 
	#SCB_AIRCR_PRIGROUP6
 ((
ut32_t
)0x00000600

	)

3158 
	#SCB_AIRCR_PRIGROUP7
 ((
ut32_t
)0x00000700

	)

3160 
	#SCB_AIRCR_ENDIANESS
 ((
ut32_t
)0x00008000

	)

3161 
	#SCB_AIRCR_VECTKEY
 ((
ut32_t
)0xFFFF0000

	)

3164 
	#SCB_SCR_SLEEPONEXIT
 ((
ut8_t
)0x02

	)

3165 
	#SCB_SCR_SLEEPDEEP
 ((
ut8_t
)0x04

	)

3166 
	#SCB_SCR_SEVONPEND
 ((
ut8_t
)0x10

	)

3169 
	#SCB_CCR_NONBASETHRDENA
 ((
ut16_t
)0x0001

	)

3170 
	#SCB_CCR_USERSETMPEND
 ((
ut16_t
)0x0002

	)

3171 
	#SCB_CCR_UNALIGN_TRP
 ((
ut16_t
)0x0008

	)

3172 
	#SCB_CCR_DIV_0_TRP
 ((
ut16_t
)0x0010

	)

3173 
	#SCB_CCR_BFHFNMIGN
 ((
ut16_t
)0x0100

	)

3174 
	#SCB_CCR_STKALIGN
 ((
ut16_t
)0x0200

	)

3177 
	#SCB_SHPR_PRI_N
 ((
ut32_t
)0x000000FF

	)

3178 
	#SCB_SHPR_PRI_N1
 ((
ut32_t
)0x0000FF00

	)

3179 
	#SCB_SHPR_PRI_N2
 ((
ut32_t
)0x00FF0000

	)

3180 
	#SCB_SHPR_PRI_N3
 ((
ut32_t
)0xFF000000

	)

3183 
	#SCB_SHCSR_MEMFAULTACT
 ((
ut32_t
)0x00000001

	)

3184 
	#SCB_SHCSR_BUSFAULTACT
 ((
ut32_t
)0x00000002

	)

3185 
	#SCB_SHCSR_USGFAULTACT
 ((
ut32_t
)0x00000008

	)

3186 
	#SCB_SHCSR_SVCALLACT
 ((
ut32_t
)0x00000080

	)

3187 
	#SCB_SHCSR_MONITORACT
 ((
ut32_t
)0x00000100

	)

3188 
	#SCB_SHCSR_PENDSVACT
 ((
ut32_t
)0x00000400

	)

3189 
	#SCB_SHCSR_SYSTICKACT
 ((
ut32_t
)0x00000800

	)

3190 
	#SCB_SHCSR_USGFAULTPENDED
 ((
ut32_t
)0x00001000

	)

3191 
	#SCB_SHCSR_MEMFAULTPENDED
 ((
ut32_t
)0x00002000

	)

3192 
	#SCB_SHCSR_BUSFAULTPENDED
 ((
ut32_t
)0x00004000

	)

3193 
	#SCB_SHCSR_SVCALLPENDED
 ((
ut32_t
)0x00008000

	)

3194 
	#SCB_SHCSR_MEMFAULTENA
 ((
ut32_t
)0x00010000

	)

3195 
	#SCB_SHCSR_BUSFAULTENA
 ((
ut32_t
)0x00020000

	)

3196 
	#SCB_SHCSR_USGFAULTENA
 ((
ut32_t
)0x00040000

	)

3200 
	#SCB_CFSR_IACCVIOL
 ((
ut32_t
)0x00000001

	)

3201 
	#SCB_CFSR_DACCVIOL
 ((
ut32_t
)0x00000002

	)

3202 
	#SCB_CFSR_MUNSTKERR
 ((
ut32_t
)0x00000008

	)

3203 
	#SCB_CFSR_MSTKERR
 ((
ut32_t
)0x00000010

	)

3204 
	#SCB_CFSR_MMARVALID
 ((
ut32_t
)0x00000080

	)

3206 
	#SCB_CFSR_IBUSERR
 ((
ut32_t
)0x00000100

	)

3207 
	#SCB_CFSR_PRECISERR
 ((
ut32_t
)0x00000200

	)

3208 
	#SCB_CFSR_IMPRECISERR
 ((
ut32_t
)0x00000400

	)

3209 
	#SCB_CFSR_UNSTKERR
 ((
ut32_t
)0x00000800

	)

3210 
	#SCB_CFSR_STKERR
 ((
ut32_t
)0x00001000

	)

3211 
	#SCB_CFSR_BFARVALID
 ((
ut32_t
)0x00008000

	)

3213 
	#SCB_CFSR_UNDEFINSTR
 ((
ut32_t
)0x00010000

	)

3214 
	#SCB_CFSR_INVSTATE
 ((
ut32_t
)0x00020000

	)

3215 
	#SCB_CFSR_INVPC
 ((
ut32_t
)0x00040000

	)

3216 
	#SCB_CFSR_NOCP
 ((
ut32_t
)0x00080000

	)

3217 
	#SCB_CFSR_UNALIGNED
 ((
ut32_t
)0x01000000

	)

3218 
	#SCB_CFSR_DIVBYZERO
 ((
ut32_t
)0x02000000

	)

3221 
	#SCB_HFSR_VECTTBL
 ((
ut32_t
)0x00000002

	)

3222 
	#SCB_HFSR_FORCED
 ((
ut32_t
)0x40000000

	)

3223 
	#SCB_HFSR_DEBUGEVT
 ((
ut32_t
)0x80000000

	)

3226 
	#SCB_DFSR_HALTED
 ((
ut8_t
)0x01

	)

3227 
	#SCB_DFSR_BKPT
 ((
ut8_t
)0x02

	)

3228 
	#SCB_DFSR_DWTTRAP
 ((
ut8_t
)0x04

	)

3229 
	#SCB_DFSR_VCATCH
 ((
ut8_t
)0x08

	)

3230 
	#SCB_DFSR_EXTERNAL
 ((
ut8_t
)0x10

	)

3233 
	#SCB_MMFAR_ADDRESS
 ((
ut32_t
)0xFFFFFFFF

	)

3236 
	#SCB_BFAR_ADDRESS
 ((
ut32_t
)0xFFFFFFFF

	)

3239 
	#SCB_AFSR_IMPDEF
 ((
ut32_t
)0xFFFFFFFF

	)

3248 
	#EXTI_IMR_MR0
 ((
ut32_t
)0x00000001

	)

3249 
	#EXTI_IMR_MR1
 ((
ut32_t
)0x00000002

	)

3250 
	#EXTI_IMR_MR2
 ((
ut32_t
)0x00000004

	)

3251 
	#EXTI_IMR_MR3
 ((
ut32_t
)0x00000008

	)

3252 
	#EXTI_IMR_MR4
 ((
ut32_t
)0x00000010

	)

3253 
	#EXTI_IMR_MR5
 ((
ut32_t
)0x00000020

	)

3254 
	#EXTI_IMR_MR6
 ((
ut32_t
)0x00000040

	)

3255 
	#EXTI_IMR_MR7
 ((
ut32_t
)0x00000080

	)

3256 
	#EXTI_IMR_MR8
 ((
ut32_t
)0x00000100

	)

3257 
	#EXTI_IMR_MR9
 ((
ut32_t
)0x00000200

	)

3258 
	#EXTI_IMR_MR10
 ((
ut32_t
)0x00000400

	)

3259 
	#EXTI_IMR_MR11
 ((
ut32_t
)0x00000800

	)

3260 
	#EXTI_IMR_MR12
 ((
ut32_t
)0x00001000

	)

3261 
	#EXTI_IMR_MR13
 ((
ut32_t
)0x00002000

	)

3262 
	#EXTI_IMR_MR14
 ((
ut32_t
)0x00004000

	)

3263 
	#EXTI_IMR_MR15
 ((
ut32_t
)0x00008000

	)

3264 
	#EXTI_IMR_MR16
 ((
ut32_t
)0x00010000

	)

3265 
	#EXTI_IMR_MR17
 ((
ut32_t
)0x00020000

	)

3266 
	#EXTI_IMR_MR18
 ((
ut32_t
)0x00040000

	)

3267 
	#EXTI_IMR_MR19
 ((
ut32_t
)0x00080000

	)

3270 
	#EXTI_EMR_MR0
 ((
ut32_t
)0x00000001

	)

3271 
	#EXTI_EMR_MR1
 ((
ut32_t
)0x00000002

	)

3272 
	#EXTI_EMR_MR2
 ((
ut32_t
)0x00000004

	)

3273 
	#EXTI_EMR_MR3
 ((
ut32_t
)0x00000008

	)

3274 
	#EXTI_EMR_MR4
 ((
ut32_t
)0x00000010

	)

3275 
	#EXTI_EMR_MR5
 ((
ut32_t
)0x00000020

	)

3276 
	#EXTI_EMR_MR6
 ((
ut32_t
)0x00000040

	)

3277 
	#EXTI_EMR_MR7
 ((
ut32_t
)0x00000080

	)

3278 
	#EXTI_EMR_MR8
 ((
ut32_t
)0x00000100

	)

3279 
	#EXTI_EMR_MR9
 ((
ut32_t
)0x00000200

	)

3280 
	#EXTI_EMR_MR10
 ((
ut32_t
)0x00000400

	)

3281 
	#EXTI_EMR_MR11
 ((
ut32_t
)0x00000800

	)

3282 
	#EXTI_EMR_MR12
 ((
ut32_t
)0x00001000

	)

3283 
	#EXTI_EMR_MR13
 ((
ut32_t
)0x00002000

	)

3284 
	#EXTI_EMR_MR14
 ((
ut32_t
)0x00004000

	)

3285 
	#EXTI_EMR_MR15
 ((
ut32_t
)0x00008000

	)

3286 
	#EXTI_EMR_MR16
 ((
ut32_t
)0x00010000

	)

3287 
	#EXTI_EMR_MR17
 ((
ut32_t
)0x00020000

	)

3288 
	#EXTI_EMR_MR18
 ((
ut32_t
)0x00040000

	)

3289 
	#EXTI_EMR_MR19
 ((
ut32_t
)0x00080000

	)

3292 
	#EXTI_RTSR_TR0
 ((
ut32_t
)0x00000001

	)

3293 
	#EXTI_RTSR_TR1
 ((
ut32_t
)0x00000002

	)

3294 
	#EXTI_RTSR_TR2
 ((
ut32_t
)0x00000004

	)

3295 
	#EXTI_RTSR_TR3
 ((
ut32_t
)0x00000008

	)

3296 
	#EXTI_RTSR_TR4
 ((
ut32_t
)0x00000010

	)

3297 
	#EXTI_RTSR_TR5
 ((
ut32_t
)0x00000020

	)

3298 
	#EXTI_RTSR_TR6
 ((
ut32_t
)0x00000040

	)

3299 
	#EXTI_RTSR_TR7
 ((
ut32_t
)0x00000080

	)

3300 
	#EXTI_RTSR_TR8
 ((
ut32_t
)0x00000100

	)

3301 
	#EXTI_RTSR_TR9
 ((
ut32_t
)0x00000200

	)

3302 
	#EXTI_RTSR_TR10
 ((
ut32_t
)0x00000400

	)

3303 
	#EXTI_RTSR_TR11
 ((
ut32_t
)0x00000800

	)

3304 
	#EXTI_RTSR_TR12
 ((
ut32_t
)0x00001000

	)

3305 
	#EXTI_RTSR_TR13
 ((
ut32_t
)0x00002000

	)

3306 
	#EXTI_RTSR_TR14
 ((
ut32_t
)0x00004000

	)

3307 
	#EXTI_RTSR_TR15
 ((
ut32_t
)0x00008000

	)

3308 
	#EXTI_RTSR_TR16
 ((
ut32_t
)0x00010000

	)

3309 
	#EXTI_RTSR_TR17
 ((
ut32_t
)0x00020000

	)

3310 
	#EXTI_RTSR_TR18
 ((
ut32_t
)0x00040000

	)

3311 
	#EXTI_RTSR_TR19
 ((
ut32_t
)0x00080000

	)

3314 
	#EXTI_FTSR_TR0
 ((
ut32_t
)0x00000001

	)

3315 
	#EXTI_FTSR_TR1
 ((
ut32_t
)0x00000002

	)

3316 
	#EXTI_FTSR_TR2
 ((
ut32_t
)0x00000004

	)

3317 
	#EXTI_FTSR_TR3
 ((
ut32_t
)0x00000008

	)

3318 
	#EXTI_FTSR_TR4
 ((
ut32_t
)0x00000010

	)

3319 
	#EXTI_FTSR_TR5
 ((
ut32_t
)0x00000020

	)

3320 
	#EXTI_FTSR_TR6
 ((
ut32_t
)0x00000040

	)

3321 
	#EXTI_FTSR_TR7
 ((
ut32_t
)0x00000080

	)

3322 
	#EXTI_FTSR_TR8
 ((
ut32_t
)0x00000100

	)

3323 
	#EXTI_FTSR_TR9
 ((
ut32_t
)0x00000200

	)

3324 
	#EXTI_FTSR_TR10
 ((
ut32_t
)0x00000400

	)

3325 
	#EXTI_FTSR_TR11
 ((
ut32_t
)0x00000800

	)

3326 
	#EXTI_FTSR_TR12
 ((
ut32_t
)0x00001000

	)

3327 
	#EXTI_FTSR_TR13
 ((
ut32_t
)0x00002000

	)

3328 
	#EXTI_FTSR_TR14
 ((
ut32_t
)0x00004000

	)

3329 
	#EXTI_FTSR_TR15
 ((
ut32_t
)0x00008000

	)

3330 
	#EXTI_FTSR_TR16
 ((
ut32_t
)0x00010000

	)

3331 
	#EXTI_FTSR_TR17
 ((
ut32_t
)0x00020000

	)

3332 
	#EXTI_FTSR_TR18
 ((
ut32_t
)0x00040000

	)

3333 
	#EXTI_FTSR_TR19
 ((
ut32_t
)0x00080000

	)

3336 
	#EXTI_SWIER_SWIER0
 ((
ut32_t
)0x00000001

	)

3337 
	#EXTI_SWIER_SWIER1
 ((
ut32_t
)0x00000002

	)

3338 
	#EXTI_SWIER_SWIER2
 ((
ut32_t
)0x00000004

	)

3339 
	#EXTI_SWIER_SWIER3
 ((
ut32_t
)0x00000008

	)

3340 
	#EXTI_SWIER_SWIER4
 ((
ut32_t
)0x00000010

	)

3341 
	#EXTI_SWIER_SWIER5
 ((
ut32_t
)0x00000020

	)

3342 
	#EXTI_SWIER_SWIER6
 ((
ut32_t
)0x00000040

	)

3343 
	#EXTI_SWIER_SWIER7
 ((
ut32_t
)0x00000080

	)

3344 
	#EXTI_SWIER_SWIER8
 ((
ut32_t
)0x00000100

	)

3345 
	#EXTI_SWIER_SWIER9
 ((
ut32_t
)0x00000200

	)

3346 
	#EXTI_SWIER_SWIER10
 ((
ut32_t
)0x00000400

	)

3347 
	#EXTI_SWIER_SWIER11
 ((
ut32_t
)0x00000800

	)

3348 
	#EXTI_SWIER_SWIER12
 ((
ut32_t
)0x00001000

	)

3349 
	#EXTI_SWIER_SWIER13
 ((
ut32_t
)0x00002000

	)

3350 
	#EXTI_SWIER_SWIER14
 ((
ut32_t
)0x00004000

	)

3351 
	#EXTI_SWIER_SWIER15
 ((
ut32_t
)0x00008000

	)

3352 
	#EXTI_SWIER_SWIER16
 ((
ut32_t
)0x00010000

	)

3353 
	#EXTI_SWIER_SWIER17
 ((
ut32_t
)0x00020000

	)

3354 
	#EXTI_SWIER_SWIER18
 ((
ut32_t
)0x00040000

	)

3355 
	#EXTI_SWIER_SWIER19
 ((
ut32_t
)0x00080000

	)

3358 
	#EXTI_PR_PR0
 ((
ut32_t
)0x00000001

	)

3359 
	#EXTI_PR_PR1
 ((
ut32_t
)0x00000002

	)

3360 
	#EXTI_PR_PR2
 ((
ut32_t
)0x00000004

	)

3361 
	#EXTI_PR_PR3
 ((
ut32_t
)0x00000008

	)

3362 
	#EXTI_PR_PR4
 ((
ut32_t
)0x00000010

	)

3363 
	#EXTI_PR_PR5
 ((
ut32_t
)0x00000020

	)

3364 
	#EXTI_PR_PR6
 ((
ut32_t
)0x00000040

	)

3365 
	#EXTI_PR_PR7
 ((
ut32_t
)0x00000080

	)

3366 
	#EXTI_PR_PR8
 ((
ut32_t
)0x00000100

	)

3367 
	#EXTI_PR_PR9
 ((
ut32_t
)0x00000200

	)

3368 
	#EXTI_PR_PR10
 ((
ut32_t
)0x00000400

	)

3369 
	#EXTI_PR_PR11
 ((
ut32_t
)0x00000800

	)

3370 
	#EXTI_PR_PR12
 ((
ut32_t
)0x00001000

	)

3371 
	#EXTI_PR_PR13
 ((
ut32_t
)0x00002000

	)

3372 
	#EXTI_PR_PR14
 ((
ut32_t
)0x00004000

	)

3373 
	#EXTI_PR_PR15
 ((
ut32_t
)0x00008000

	)

3374 
	#EXTI_PR_PR16
 ((
ut32_t
)0x00010000

	)

3375 
	#EXTI_PR_PR17
 ((
ut32_t
)0x00020000

	)

3376 
	#EXTI_PR_PR18
 ((
ut32_t
)0x00040000

	)

3377 
	#EXTI_PR_PR19
 ((
ut32_t
)0x00080000

	)

3386 
	#DMA_ISR_GIF1
 ((
ut32_t
)0x00000001

	)

3387 
	#DMA_ISR_TCIF1
 ((
ut32_t
)0x00000002

	)

3388 
	#DMA_ISR_HTIF1
 ((
ut32_t
)0x00000004

	)

3389 
	#DMA_ISR_TEIF1
 ((
ut32_t
)0x00000008

	)

3390 
	#DMA_ISR_GIF2
 ((
ut32_t
)0x00000010

	)

3391 
	#DMA_ISR_TCIF2
 ((
ut32_t
)0x00000020

	)

3392 
	#DMA_ISR_HTIF2
 ((
ut32_t
)0x00000040

	)

3393 
	#DMA_ISR_TEIF2
 ((
ut32_t
)0x00000080

	)

3394 
	#DMA_ISR_GIF3
 ((
ut32_t
)0x00000100

	)

3395 
	#DMA_ISR_TCIF3
 ((
ut32_t
)0x00000200

	)

3396 
	#DMA_ISR_HTIF3
 ((
ut32_t
)0x00000400

	)

3397 
	#DMA_ISR_TEIF3
 ((
ut32_t
)0x00000800

	)

3398 
	#DMA_ISR_GIF4
 ((
ut32_t
)0x00001000

	)

3399 
	#DMA_ISR_TCIF4
 ((
ut32_t
)0x00002000

	)

3400 
	#DMA_ISR_HTIF4
 ((
ut32_t
)0x00004000

	)

3401 
	#DMA_ISR_TEIF4
 ((
ut32_t
)0x00008000

	)

3402 
	#DMA_ISR_GIF5
 ((
ut32_t
)0x00010000

	)

3403 
	#DMA_ISR_TCIF5
 ((
ut32_t
)0x00020000

	)

3404 
	#DMA_ISR_HTIF5
 ((
ut32_t
)0x00040000

	)

3405 
	#DMA_ISR_TEIF5
 ((
ut32_t
)0x00080000

	)

3406 
	#DMA_ISR_GIF6
 ((
ut32_t
)0x00100000

	)

3407 
	#DMA_ISR_TCIF6
 ((
ut32_t
)0x00200000

	)

3408 
	#DMA_ISR_HTIF6
 ((
ut32_t
)0x00400000

	)

3409 
	#DMA_ISR_TEIF6
 ((
ut32_t
)0x00800000

	)

3410 
	#DMA_ISR_GIF7
 ((
ut32_t
)0x01000000

	)

3411 
	#DMA_ISR_TCIF7
 ((
ut32_t
)0x02000000

	)

3412 
	#DMA_ISR_HTIF7
 ((
ut32_t
)0x04000000

	)

3413 
	#DMA_ISR_TEIF7
 ((
ut32_t
)0x08000000

	)

3416 
	#DMA_IFCR_CGIF1
 ((
ut32_t
)0x00000001

	)

3417 
	#DMA_IFCR_CTCIF1
 ((
ut32_t
)0x00000002

	)

3418 
	#DMA_IFCR_CHTIF1
 ((
ut32_t
)0x00000004

	)

3419 
	#DMA_IFCR_CTEIF1
 ((
ut32_t
)0x00000008

	)

3420 
	#DMA_IFCR_CGIF2
 ((
ut32_t
)0x00000010

	)

3421 
	#DMA_IFCR_CTCIF2
 ((
ut32_t
)0x00000020

	)

3422 
	#DMA_IFCR_CHTIF2
 ((
ut32_t
)0x00000040

	)

3423 
	#DMA_IFCR_CTEIF2
 ((
ut32_t
)0x00000080

	)

3424 
	#DMA_IFCR_CGIF3
 ((
ut32_t
)0x00000100

	)

3425 
	#DMA_IFCR_CTCIF3
 ((
ut32_t
)0x00000200

	)

3426 
	#DMA_IFCR_CHTIF3
 ((
ut32_t
)0x00000400

	)

3427 
	#DMA_IFCR_CTEIF3
 ((
ut32_t
)0x00000800

	)

3428 
	#DMA_IFCR_CGIF4
 ((
ut32_t
)0x00001000

	)

3429 
	#DMA_IFCR_CTCIF4
 ((
ut32_t
)0x00002000

	)

3430 
	#DMA_IFCR_CHTIF4
 ((
ut32_t
)0x00004000

	)

3431 
	#DMA_IFCR_CTEIF4
 ((
ut32_t
)0x00008000

	)

3432 
	#DMA_IFCR_CGIF5
 ((
ut32_t
)0x00010000

	)

3433 
	#DMA_IFCR_CTCIF5
 ((
ut32_t
)0x00020000

	)

3434 
	#DMA_IFCR_CHTIF5
 ((
ut32_t
)0x00040000

	)

3435 
	#DMA_IFCR_CTEIF5
 ((
ut32_t
)0x00080000

	)

3436 
	#DMA_IFCR_CGIF6
 ((
ut32_t
)0x00100000

	)

3437 
	#DMA_IFCR_CTCIF6
 ((
ut32_t
)0x00200000

	)

3438 
	#DMA_IFCR_CHTIF6
 ((
ut32_t
)0x00400000

	)

3439 
	#DMA_IFCR_CTEIF6
 ((
ut32_t
)0x00800000

	)

3440 
	#DMA_IFCR_CGIF7
 ((
ut32_t
)0x01000000

	)

3441 
	#DMA_IFCR_CTCIF7
 ((
ut32_t
)0x02000000

	)

3442 
	#DMA_IFCR_CHTIF7
 ((
ut32_t
)0x04000000

	)

3443 
	#DMA_IFCR_CTEIF7
 ((
ut32_t
)0x08000000

	)

3446 
	#DMA_CCR1_EN
 ((
ut16_t
)0x0001

	)

3447 
	#DMA_CCR1_TCIE
 ((
ut16_t
)0x0002

	)

3448 
	#DMA_CCR1_HTIE
 ((
ut16_t
)0x0004

	)

3449 
	#DMA_CCR1_TEIE
 ((
ut16_t
)0x0008

	)

3450 
	#DMA_CCR1_DIR
 ((
ut16_t
)0x0010

	)

3451 
	#DMA_CCR1_CIRC
 ((
ut16_t
)0x0020

	)

3452 
	#DMA_CCR1_PINC
 ((
ut16_t
)0x0040

	)

3453 
	#DMA_CCR1_MINC
 ((
ut16_t
)0x0080

	)

3455 
	#DMA_CCR1_PSIZE
 ((
ut16_t
)0x0300

	)

3456 
	#DMA_CCR1_PSIZE_0
 ((
ut16_t
)0x0100

	)

3457 
	#DMA_CCR1_PSIZE_1
 ((
ut16_t
)0x0200

	)

3459 
	#DMA_CCR1_MSIZE
 ((
ut16_t
)0x0C00

	)

3460 
	#DMA_CCR1_MSIZE_0
 ((
ut16_t
)0x0400

	)

3461 
	#DMA_CCR1_MSIZE_1
 ((
ut16_t
)0x0800

	)

3463 
	#DMA_CCR1_PL
 ((
ut16_t
)0x3000

	)

3464 
	#DMA_CCR1_PL_0
 ((
ut16_t
)0x1000

	)

3465 
	#DMA_CCR1_PL_1
 ((
ut16_t
)0x2000

	)

3467 
	#DMA_CCR1_MEM2MEM
 ((
ut16_t
)0x4000

	)

3470 
	#DMA_CCR2_EN
 ((
ut16_t
)0x0001

	)

3471 
	#DMA_CCR2_TCIE
 ((
ut16_t
)0x0002

	)

3472 
	#DMA_CCR2_HTIE
 ((
ut16_t
)0x0004

	)

3473 
	#DMA_CCR2_TEIE
 ((
ut16_t
)0x0008

	)

3474 
	#DMA_CCR2_DIR
 ((
ut16_t
)0x0010

	)

3475 
	#DMA_CCR2_CIRC
 ((
ut16_t
)0x0020

	)

3476 
	#DMA_CCR2_PINC
 ((
ut16_t
)0x0040

	)

3477 
	#DMA_CCR2_MINC
 ((
ut16_t
)0x0080

	)

3479 
	#DMA_CCR2_PSIZE
 ((
ut16_t
)0x0300

	)

3480 
	#DMA_CCR2_PSIZE_0
 ((
ut16_t
)0x0100

	)

3481 
	#DMA_CCR2_PSIZE_1
 ((
ut16_t
)0x0200

	)

3483 
	#DMA_CCR2_MSIZE
 ((
ut16_t
)0x0C00

	)

3484 
	#DMA_CCR2_MSIZE_0
 ((
ut16_t
)0x0400

	)

3485 
	#DMA_CCR2_MSIZE_1
 ((
ut16_t
)0x0800

	)

3487 
	#DMA_CCR2_PL
 ((
ut16_t
)0x3000

	)

3488 
	#DMA_CCR2_PL_0
 ((
ut16_t
)0x1000

	)

3489 
	#DMA_CCR2_PL_1
 ((
ut16_t
)0x2000

	)

3491 
	#DMA_CCR2_MEM2MEM
 ((
ut16_t
)0x4000

	)

3494 
	#DMA_CCR3_EN
 ((
ut16_t
)0x0001

	)

3495 
	#DMA_CCR3_TCIE
 ((
ut16_t
)0x0002

	)

3496 
	#DMA_CCR3_HTIE
 ((
ut16_t
)0x0004

	)

3497 
	#DMA_CCR3_TEIE
 ((
ut16_t
)0x0008

	)

3498 
	#DMA_CCR3_DIR
 ((
ut16_t
)0x0010

	)

3499 
	#DMA_CCR3_CIRC
 ((
ut16_t
)0x0020

	)

3500 
	#DMA_CCR3_PINC
 ((
ut16_t
)0x0040

	)

3501 
	#DMA_CCR3_MINC
 ((
ut16_t
)0x0080

	)

3503 
	#DMA_CCR3_PSIZE
 ((
ut16_t
)0x0300

	)

3504 
	#DMA_CCR3_PSIZE_0
 ((
ut16_t
)0x0100

	)

3505 
	#DMA_CCR3_PSIZE_1
 ((
ut16_t
)0x0200

	)

3507 
	#DMA_CCR3_MSIZE
 ((
ut16_t
)0x0C00

	)

3508 
	#DMA_CCR3_MSIZE_0
 ((
ut16_t
)0x0400

	)

3509 
	#DMA_CCR3_MSIZE_1
 ((
ut16_t
)0x0800

	)

3511 
	#DMA_CCR3_PL
 ((
ut16_t
)0x3000

	)

3512 
	#DMA_CCR3_PL_0
 ((
ut16_t
)0x1000

	)

3513 
	#DMA_CCR3_PL_1
 ((
ut16_t
)0x2000

	)

3515 
	#DMA_CCR3_MEM2MEM
 ((
ut16_t
)0x4000

	)

3518 
	#DMA_CCR4_EN
 ((
ut16_t
)0x0001

	)

3519 
	#DMA_CCR4_TCIE
 ((
ut16_t
)0x0002

	)

3520 
	#DMA_CCR4_HTIE
 ((
ut16_t
)0x0004

	)

3521 
	#DMA_CCR4_TEIE
 ((
ut16_t
)0x0008

	)

3522 
	#DMA_CCR4_DIR
 ((
ut16_t
)0x0010

	)

3523 
	#DMA_CCR4_CIRC
 ((
ut16_t
)0x0020

	)

3524 
	#DMA_CCR4_PINC
 ((
ut16_t
)0x0040

	)

3525 
	#DMA_CCR4_MINC
 ((
ut16_t
)0x0080

	)

3527 
	#DMA_CCR4_PSIZE
 ((
ut16_t
)0x0300

	)

3528 
	#DMA_CCR4_PSIZE_0
 ((
ut16_t
)0x0100

	)

3529 
	#DMA_CCR4_PSIZE_1
 ((
ut16_t
)0x0200

	)

3531 
	#DMA_CCR4_MSIZE
 ((
ut16_t
)0x0C00

	)

3532 
	#DMA_CCR4_MSIZE_0
 ((
ut16_t
)0x0400

	)

3533 
	#DMA_CCR4_MSIZE_1
 ((
ut16_t
)0x0800

	)

3535 
	#DMA_CCR4_PL
 ((
ut16_t
)0x3000

	)

3536 
	#DMA_CCR4_PL_0
 ((
ut16_t
)0x1000

	)

3537 
	#DMA_CCR4_PL_1
 ((
ut16_t
)0x2000

	)

3539 
	#DMA_CCR4_MEM2MEM
 ((
ut16_t
)0x4000

	)

3542 
	#DMA_CCR5_EN
 ((
ut16_t
)0x0001

	)

3543 
	#DMA_CCR5_TCIE
 ((
ut16_t
)0x0002

	)

3544 
	#DMA_CCR5_HTIE
 ((
ut16_t
)0x0004

	)

3545 
	#DMA_CCR5_TEIE
 ((
ut16_t
)0x0008

	)

3546 
	#DMA_CCR5_DIR
 ((
ut16_t
)0x0010

	)

3547 
	#DMA_CCR5_CIRC
 ((
ut16_t
)0x0020

	)

3548 
	#DMA_CCR5_PINC
 ((
ut16_t
)0x0040

	)

3549 
	#DMA_CCR5_MINC
 ((
ut16_t
)0x0080

	)

3551 
	#DMA_CCR5_PSIZE
 ((
ut16_t
)0x0300

	)

3552 
	#DMA_CCR5_PSIZE_0
 ((
ut16_t
)0x0100

	)

3553 
	#DMA_CCR5_PSIZE_1
 ((
ut16_t
)0x0200

	)

3555 
	#DMA_CCR5_MSIZE
 ((
ut16_t
)0x0C00

	)

3556 
	#DMA_CCR5_MSIZE_0
 ((
ut16_t
)0x0400

	)

3557 
	#DMA_CCR5_MSIZE_1
 ((
ut16_t
)0x0800

	)

3559 
	#DMA_CCR5_PL
 ((
ut16_t
)0x3000

	)

3560 
	#DMA_CCR5_PL_0
 ((
ut16_t
)0x1000

	)

3561 
	#DMA_CCR5_PL_1
 ((
ut16_t
)0x2000

	)

3563 
	#DMA_CCR5_MEM2MEM
 ((
ut16_t
)0x4000

	)

3566 
	#DMA_CCR6_EN
 ((
ut16_t
)0x0001

	)

3567 
	#DMA_CCR6_TCIE
 ((
ut16_t
)0x0002

	)

3568 
	#DMA_CCR6_HTIE
 ((
ut16_t
)0x0004

	)

3569 
	#DMA_CCR6_TEIE
 ((
ut16_t
)0x0008

	)

3570 
	#DMA_CCR6_DIR
 ((
ut16_t
)0x0010

	)

3571 
	#DMA_CCR6_CIRC
 ((
ut16_t
)0x0020

	)

3572 
	#DMA_CCR6_PINC
 ((
ut16_t
)0x0040

	)

3573 
	#DMA_CCR6_MINC
 ((
ut16_t
)0x0080

	)

3575 
	#DMA_CCR6_PSIZE
 ((
ut16_t
)0x0300

	)

3576 
	#DMA_CCR6_PSIZE_0
 ((
ut16_t
)0x0100

	)

3577 
	#DMA_CCR6_PSIZE_1
 ((
ut16_t
)0x0200

	)

3579 
	#DMA_CCR6_MSIZE
 ((
ut16_t
)0x0C00

	)

3580 
	#DMA_CCR6_MSIZE_0
 ((
ut16_t
)0x0400

	)

3581 
	#DMA_CCR6_MSIZE_1
 ((
ut16_t
)0x0800

	)

3583 
	#DMA_CCR6_PL
 ((
ut16_t
)0x3000

	)

3584 
	#DMA_CCR6_PL_0
 ((
ut16_t
)0x1000

	)

3585 
	#DMA_CCR6_PL_1
 ((
ut16_t
)0x2000

	)

3587 
	#DMA_CCR6_MEM2MEM
 ((
ut16_t
)0x4000

	)

3590 
	#DMA_CCR7_EN
 ((
ut16_t
)0x0001

	)

3591 
	#DMA_CCR7_TCIE
 ((
ut16_t
)0x0002

	)

3592 
	#DMA_CCR7_HTIE
 ((
ut16_t
)0x0004

	)

3593 
	#DMA_CCR7_TEIE
 ((
ut16_t
)0x0008

	)

3594 
	#DMA_CCR7_DIR
 ((
ut16_t
)0x0010

	)

3595 
	#DMA_CCR7_CIRC
 ((
ut16_t
)0x0020

	)

3596 
	#DMA_CCR7_PINC
 ((
ut16_t
)0x0040

	)

3597 
	#DMA_CCR7_MINC
 ((
ut16_t
)0x0080

	)

3599 
	#DMA_CCR7_PSIZE
 , ((
ut16_t
)0x0300

	)

3600 
	#DMA_CCR7_PSIZE_0
 ((
ut16_t
)0x0100

	)

3601 
	#DMA_CCR7_PSIZE_1
 ((
ut16_t
)0x0200

	)

3603 
	#DMA_CCR7_MSIZE
 ((
ut16_t
)0x0C00

	)

3604 
	#DMA_CCR7_MSIZE_0
 ((
ut16_t
)0x0400

	)

3605 
	#DMA_CCR7_MSIZE_1
 ((
ut16_t
)0x0800

	)

3607 
	#DMA_CCR7_PL
 ((
ut16_t
)0x3000

	)

3608 
	#DMA_CCR7_PL_0
 ((
ut16_t
)0x1000

	)

3609 
	#DMA_CCR7_PL_1
 ((
ut16_t
)0x2000

	)

3611 
	#DMA_CCR7_MEM2MEM
 ((
ut16_t
)0x4000

	)

3614 
	#DMA_CNDTR1_NDT
 ((
ut16_t
)0xFFFF

	)

3617 
	#DMA_CNDTR2_NDT
 ((
ut16_t
)0xFFFF

	)

3620 
	#DMA_CNDTR3_NDT
 ((
ut16_t
)0xFFFF

	)

3623 
	#DMA_CNDTR4_NDT
 ((
ut16_t
)0xFFFF

	)

3626 
	#DMA_CNDTR5_NDT
 ((
ut16_t
)0xFFFF

	)

3629 
	#DMA_CNDTR6_NDT
 ((
ut16_t
)0xFFFF

	)

3632 
	#DMA_CNDTR7_NDT
 ((
ut16_t
)0xFFFF

	)

3635 
	#DMA_CPAR1_PA
 ((
ut32_t
)0xFFFFFFFF

	)

3638 
	#DMA_CPAR2_PA
 ((
ut32_t
)0xFFFFFFFF

	)

3641 
	#DMA_CPAR3_PA
 ((
ut32_t
)0xFFFFFFFF

	)

3645 
	#DMA_CPAR4_PA
 ((
ut32_t
)0xFFFFFFFF

	)

3648 
	#DMA_CPAR5_PA
 ((
ut32_t
)0xFFFFFFFF

	)

3651 
	#DMA_CPAR6_PA
 ((
ut32_t
)0xFFFFFFFF

	)

3655 
	#DMA_CPAR7_PA
 ((
ut32_t
)0xFFFFFFFF

	)

3658 
	#DMA_CMAR1_MA
 ((
ut32_t
)0xFFFFFFFF

	)

3661 
	#DMA_CMAR2_MA
 ((
ut32_t
)0xFFFFFFFF

	)

3664 
	#DMA_CMAR3_MA
 ((
ut32_t
)0xFFFFFFFF

	)

3668 
	#DMA_CMAR4_MA
 ((
ut32_t
)0xFFFFFFFF

	)

3671 
	#DMA_CMAR5_MA
 ((
ut32_t
)0xFFFFFFFF

	)

3674 
	#DMA_CMAR6_MA
 ((
ut32_t
)0xFFFFFFFF

	)

3677 
	#DMA_CMAR7_MA
 ((
ut32_t
)0xFFFFFFFF

	)

3686 
	#ADC_SR_AWD
 ((
ut8_t
)0x01

	)

3687 
	#ADC_SR_EOC
 ((
ut8_t
)0x02

	)

3688 
	#ADC_SR_JEOC
 ((
ut8_t
)0x04

	)

3689 
	#ADC_SR_JSTRT
 ((
ut8_t
)0x08

	)

3690 
	#ADC_SR_STRT
 ((
ut8_t
)0x10

	)

3693 
	#ADC_CR1_AWDCH
 ((
ut32_t
)0x0000001F

	)

3694 
	#ADC_CR1_AWDCH_0
 ((
ut32_t
)0x00000001

	)

3695 
	#ADC_CR1_AWDCH_1
 ((
ut32_t
)0x00000002

	)

3696 
	#ADC_CR1_AWDCH_2
 ((
ut32_t
)0x00000004

	)

3697 
	#ADC_CR1_AWDCH_3
 ((
ut32_t
)0x00000008

	)

3698 
	#ADC_CR1_AWDCH_4
 ((
ut32_t
)0x00000010

	)

3700 
	#ADC_CR1_EOCIE
 ((
ut32_t
)0x00000020

	)

3701 
	#ADC_CR1_AWDIE
 ((
ut32_t
)0x00000040

	)

3702 
	#ADC_CR1_JEOCIE
 ((
ut32_t
)0x00000080

	)

3703 
	#ADC_CR1_SCAN
 ((
ut32_t
)0x00000100

	)

3704 
	#ADC_CR1_AWDSGL
 ((
ut32_t
)0x00000200

	)

3705 
	#ADC_CR1_JAUTO
 ((
ut32_t
)0x00000400

	)

3706 
	#ADC_CR1_DISCEN
 ((
ut32_t
)0x00000800

	)

3707 
	#ADC_CR1_JDISCEN
 ((
ut32_t
)0x00001000

	)

3709 
	#ADC_CR1_DISCNUM
 ((
ut32_t
)0x0000E000

	)

3710 
	#ADC_CR1_DISCNUM_0
 ((
ut32_t
)0x00002000

	)

3711 
	#ADC_CR1_DISCNUM_1
 ((
ut32_t
)0x00004000

	)

3712 
	#ADC_CR1_DISCNUM_2
 ((
ut32_t
)0x00008000

	)

3714 
	#ADC_CR1_DUALMOD
 ((
ut32_t
)0x000F0000

	)

3715 
	#ADC_CR1_DUALMOD_0
 ((
ut32_t
)0x00010000

	)

3716 
	#ADC_CR1_DUALMOD_1
 ((
ut32_t
)0x00020000

	)

3717 
	#ADC_CR1_DUALMOD_2
 ((
ut32_t
)0x00040000

	)

3718 
	#ADC_CR1_DUALMOD_3
 ((
ut32_t
)0x00080000

	)

3720 
	#ADC_CR1_JAWDEN
 ((
ut32_t
)0x00400000

	)

3721 
	#ADC_CR1_AWDEN
 ((
ut32_t
)0x00800000

	)

3725 
	#ADC_CR2_ADON
 ((
ut32_t
)0x00000001

	)

3726 
	#ADC_CR2_CONT
 ((
ut32_t
)0x00000002

	)

3727 
	#ADC_CR2_CAL
 ((
ut32_t
)0x00000004

	)

3728 
	#ADC_CR2_RSTCAL
 ((
ut32_t
)0x00000008

	)

3729 
	#ADC_CR2_DMA
 ((
ut32_t
)0x00000100

	)

3730 
	#ADC_CR2_ALIGN
 ((
ut32_t
)0x00000800

	)

3732 
	#ADC_CR2_JEXTSEL
 ((
ut32_t
)0x00007000

	)

3733 
	#ADC_CR2_JEXTSEL_0
 ((
ut32_t
)0x00001000

	)

3734 
	#ADC_CR2_JEXTSEL_1
 ((
ut32_t
)0x00002000

	)

3735 
	#ADC_CR2_JEXTSEL_2
 ((
ut32_t
)0x00004000

	)

3737 
	#ADC_CR2_JEXTTRIG
 ((
ut32_t
)0x00008000

	)

3739 
	#ADC_CR2_EXTSEL
 ((
ut32_t
)0x000E0000

	)

3740 
	#ADC_CR2_EXTSEL_0
 ((
ut32_t
)0x00020000

	)

3741 
	#ADC_CR2_EXTSEL_1
 ((
ut32_t
)0x00040000

	)

3742 
	#ADC_CR2_EXTSEL_2
 ((
ut32_t
)0x00080000

	)

3744 
	#ADC_CR2_EXTTRIG
 ((
ut32_t
)0x00100000

	)

3745 
	#ADC_CR2_JSWSTART
 ((
ut32_t
)0x00200000

	)

3746 
	#ADC_CR2_SWSTART
 ((
ut32_t
)0x00400000

	)

3747 
	#ADC_CR2_TSVREFE
 ((
ut32_t
)0x00800000

	)

3750 
	#ADC_SMPR1_SMP10
 ((
ut32_t
)0x00000007

	)

3751 
	#ADC_SMPR1_SMP10_0
 ((
ut32_t
)0x00000001

	)

3752 
	#ADC_SMPR1_SMP10_1
 ((
ut32_t
)0x00000002

	)

3753 
	#ADC_SMPR1_SMP10_2
 ((
ut32_t
)0x00000004

	)

3755 
	#ADC_SMPR1_SMP11
 ((
ut32_t
)0x00000038

	)

3756 
	#ADC_SMPR1_SMP11_0
 ((
ut32_t
)0x00000008

	)

3757 
	#ADC_SMPR1_SMP11_1
 ((
ut32_t
)0x00000010

	)

3758 
	#ADC_SMPR1_SMP11_2
 ((
ut32_t
)0x00000020

	)

3760 
	#ADC_SMPR1_SMP12
 ((
ut32_t
)0x000001C0

	)

3761 
	#ADC_SMPR1_SMP12_0
 ((
ut32_t
)0x00000040

	)

3762 
	#ADC_SMPR1_SMP12_1
 ((
ut32_t
)0x00000080

	)

3763 
	#ADC_SMPR1_SMP12_2
 ((
ut32_t
)0x00000100

	)

3765 
	#ADC_SMPR1_SMP13
 ((
ut32_t
)0x00000E00

	)

3766 
	#ADC_SMPR1_SMP13_0
 ((
ut32_t
)0x00000200

	)

3767 
	#ADC_SMPR1_SMP13_1
 ((
ut32_t
)0x00000400

	)

3768 
	#ADC_SMPR1_SMP13_2
 ((
ut32_t
)0x00000800

	)

3770 
	#ADC_SMPR1_SMP14
 ((
ut32_t
)0x00007000

	)

3771 
	#ADC_SMPR1_SMP14_0
 ((
ut32_t
)0x00001000

	)

3772 
	#ADC_SMPR1_SMP14_1
 ((
ut32_t
)0x00002000

	)

3773 
	#ADC_SMPR1_SMP14_2
 ((
ut32_t
)0x00004000

	)

3775 
	#ADC_SMPR1_SMP15
 ((
ut32_t
)0x00038000

	)

3776 
	#ADC_SMPR1_SMP15_0
 ((
ut32_t
)0x00008000

	)

3777 
	#ADC_SMPR1_SMP15_1
 ((
ut32_t
)0x00010000

	)

3778 
	#ADC_SMPR1_SMP15_2
 ((
ut32_t
)0x00020000

	)

3780 
	#ADC_SMPR1_SMP16
 ((
ut32_t
)0x001C0000

	)

3781 
	#ADC_SMPR1_SMP16_0
 ((
ut32_t
)0x00040000

	)

3782 
	#ADC_SMPR1_SMP16_1
 ((
ut32_t
)0x00080000

	)

3783 
	#ADC_SMPR1_SMP16_2
 ((
ut32_t
)0x00100000

	)

3785 
	#ADC_SMPR1_SMP17
 ((
ut32_t
)0x00E00000

	)

3786 
	#ADC_SMPR1_SMP17_0
 ((
ut32_t
)0x00200000

	)

3787 
	#ADC_SMPR1_SMP17_1
 ((
ut32_t
)0x00400000

	)

3788 
	#ADC_SMPR1_SMP17_2
 ((
ut32_t
)0x00800000

	)

3791 
	#ADC_SMPR2_SMP0
 ((
ut32_t
)0x00000007

	)

3792 
	#ADC_SMPR2_SMP0_0
 ((
ut32_t
)0x00000001

	)

3793 
	#ADC_SMPR2_SMP0_1
 ((
ut32_t
)0x00000002

	)

3794 
	#ADC_SMPR2_SMP0_2
 ((
ut32_t
)0x00000004

	)

3796 
	#ADC_SMPR2_SMP1
 ((
ut32_t
)0x00000038

	)

3797 
	#ADC_SMPR2_SMP1_0
 ((
ut32_t
)0x00000008

	)

3798 
	#ADC_SMPR2_SMP1_1
 ((
ut32_t
)0x00000010

	)

3799 
	#ADC_SMPR2_SMP1_2
 ((
ut32_t
)0x00000020

	)

3801 
	#ADC_SMPR2_SMP2
 ((
ut32_t
)0x000001C0

	)

3802 
	#ADC_SMPR2_SMP2_0
 ((
ut32_t
)0x00000040

	)

3803 
	#ADC_SMPR2_SMP2_1
 ((
ut32_t
)0x00000080

	)

3804 
	#ADC_SMPR2_SMP2_2
 ((
ut32_t
)0x00000100

	)

3806 
	#ADC_SMPR2_SMP3
 ((
ut32_t
)0x00000E00

	)

3807 
	#ADC_SMPR2_SMP3_0
 ((
ut32_t
)0x00000200

	)

3808 
	#ADC_SMPR2_SMP3_1
 ((
ut32_t
)0x00000400

	)

3809 
	#ADC_SMPR2_SMP3_2
 ((
ut32_t
)0x00000800

	)

3811 
	#ADC_SMPR2_SMP4
 ((
ut32_t
)0x00007000

	)

3812 
	#ADC_SMPR2_SMP4_0
 ((
ut32_t
)0x00001000

	)

3813 
	#ADC_SMPR2_SMP4_1
 ((
ut32_t
)0x00002000

	)

3814 
	#ADC_SMPR2_SMP4_2
 ((
ut32_t
)0x00004000

	)

3816 
	#ADC_SMPR2_SMP5
 ((
ut32_t
)0x00038000

	)

3817 
	#ADC_SMPR2_SMP5_0
 ((
ut32_t
)0x00008000

	)

3818 
	#ADC_SMPR2_SMP5_1
 ((
ut32_t
)0x00010000

	)

3819 
	#ADC_SMPR2_SMP5_2
 ((
ut32_t
)0x00020000

	)

3821 
	#ADC_SMPR2_SMP6
 ((
ut32_t
)0x001C0000

	)

3822 
	#ADC_SMPR2_SMP6_0
 ((
ut32_t
)0x00040000

	)

3823 
	#ADC_SMPR2_SMP6_1
 ((
ut32_t
)0x00080000

	)

3824 
	#ADC_SMPR2_SMP6_2
 ((
ut32_t
)0x00100000

	)

3826 
	#ADC_SMPR2_SMP7
 ((
ut32_t
)0x00E00000

	)

3827 
	#ADC_SMPR2_SMP7_0
 ((
ut32_t
)0x00200000

	)

3828 
	#ADC_SMPR2_SMP7_1
 ((
ut32_t
)0x00400000

	)

3829 
	#ADC_SMPR2_SMP7_2
 ((
ut32_t
)0x00800000

	)

3831 
	#ADC_SMPR2_SMP8
 ((
ut32_t
)0x07000000

	)

3832 
	#ADC_SMPR2_SMP8_0
 ((
ut32_t
)0x01000000

	)

3833 
	#ADC_SMPR2_SMP8_1
 ((
ut32_t
)0x02000000

	)

3834 
	#ADC_SMPR2_SMP8_2
 ((
ut32_t
)0x04000000

	)

3836 
	#ADC_SMPR2_SMP9
 ((
ut32_t
)0x38000000

	)

3837 
	#ADC_SMPR2_SMP9_0
 ((
ut32_t
)0x08000000

	)

3838 
	#ADC_SMPR2_SMP9_1
 ((
ut32_t
)0x10000000

	)

3839 
	#ADC_SMPR2_SMP9_2
 ((
ut32_t
)0x20000000

	)

3842 
	#ADC_JOFR1_JOFFSET1
 ((
ut16_t
)0x0FFF

	)

3845 
	#ADC_JOFR2_JOFFSET2
 ((
ut16_t
)0x0FFF

	)

3848 
	#ADC_JOFR3_JOFFSET3
 ((
ut16_t
)0x0FFF

	)

3851 
	#ADC_JOFR4_JOFFSET4
 ((
ut16_t
)0x0FFF

	)

3854 
	#ADC_HTR_HT
 ((
ut16_t
)0x0FFF

	)

3857 
	#ADC_LTR_LT
 ((
ut16_t
)0x0FFF

	)

3860 
	#ADC_SQR1_SQ13
 ((
ut32_t
)0x0000001F

	)

3861 
	#ADC_SQR1_SQ13_0
 ((
ut32_t
)0x00000001

	)

3862 
	#ADC_SQR1_SQ13_1
 ((
ut32_t
)0x00000002

	)

3863 
	#ADC_SQR1_SQ13_2
 ((
ut32_t
)0x00000004

	)

3864 
	#ADC_SQR1_SQ13_3
 ((
ut32_t
)0x00000008

	)

3865 
	#ADC_SQR1_SQ13_4
 ((
ut32_t
)0x00000010

	)

3867 
	#ADC_SQR1_SQ14
 ((
ut32_t
)0x000003E0

	)

3868 
	#ADC_SQR1_SQ14_0
 ((
ut32_t
)0x00000020

	)

3869 
	#ADC_SQR1_SQ14_1
 ((
ut32_t
)0x00000040

	)

3870 
	#ADC_SQR1_SQ14_2
 ((
ut32_t
)0x00000080

	)

3871 
	#ADC_SQR1_SQ14_3
 ((
ut32_t
)0x00000100

	)

3872 
	#ADC_SQR1_SQ14_4
 ((
ut32_t
)0x00000200

	)

3874 
	#ADC_SQR1_SQ15
 ((
ut32_t
)0x00007C00

	)

3875 
	#ADC_SQR1_SQ15_0
 ((
ut32_t
)0x00000400

	)

3876 
	#ADC_SQR1_SQ15_1
 ((
ut32_t
)0x00000800

	)

3877 
	#ADC_SQR1_SQ15_2
 ((
ut32_t
)0x00001000

	)

3878 
	#ADC_SQR1_SQ15_3
 ((
ut32_t
)0x00002000

	)

3879 
	#ADC_SQR1_SQ15_4
 ((
ut32_t
)0x00004000

	)

3881 
	#ADC_SQR1_SQ16
 ((
ut32_t
)0x000F8000

	)

3882 
	#ADC_SQR1_SQ16_0
 ((
ut32_t
)0x00008000

	)

3883 
	#ADC_SQR1_SQ16_1
 ((
ut32_t
)0x00010000

	)

3884 
	#ADC_SQR1_SQ16_2
 ((
ut32_t
)0x00020000

	)

3885 
	#ADC_SQR1_SQ16_3
 ((
ut32_t
)0x00040000

	)

3886 
	#ADC_SQR1_SQ16_4
 ((
ut32_t
)0x00080000

	)

3888 
	#ADC_SQR1_L
 ((
ut32_t
)0x00F00000

	)

3889 
	#ADC_SQR1_L_0
 ((
ut32_t
)0x00100000

	)

3890 
	#ADC_SQR1_L_1
 ((
ut32_t
)0x00200000

	)

3891 
	#ADC_SQR1_L_2
 ((
ut32_t
)0x00400000

	)

3892 
	#ADC_SQR1_L_3
 ((
ut32_t
)0x00800000

	)

3895 
	#ADC_SQR2_SQ7
 ((
ut32_t
)0x0000001F

	)

3896 
	#ADC_SQR2_SQ7_0
 ((
ut32_t
)0x00000001

	)

3897 
	#ADC_SQR2_SQ7_1
 ((
ut32_t
)0x00000002

	)

3898 
	#ADC_SQR2_SQ7_2
 ((
ut32_t
)0x00000004

	)

3899 
	#ADC_SQR2_SQ7_3
 ((
ut32_t
)0x00000008

	)

3900 
	#ADC_SQR2_SQ7_4
 ((
ut32_t
)0x00000010

	)

3902 
	#ADC_SQR2_SQ8
 ((
ut32_t
)0x000003E0

	)

3903 
	#ADC_SQR2_SQ8_0
 ((
ut32_t
)0x00000020

	)

3904 
	#ADC_SQR2_SQ8_1
 ((
ut32_t
)0x00000040

	)

3905 
	#ADC_SQR2_SQ8_2
 ((
ut32_t
)0x00000080

	)

3906 
	#ADC_SQR2_SQ8_3
 ((
ut32_t
)0x00000100

	)

3907 
	#ADC_SQR2_SQ8_4
 ((
ut32_t
)0x00000200

	)

3909 
	#ADC_SQR2_SQ9
 ((
ut32_t
)0x00007C00

	)

3910 
	#ADC_SQR2_SQ9_0
 ((
ut32_t
)0x00000400

	)

3911 
	#ADC_SQR2_SQ9_1
 ((
ut32_t
)0x00000800

	)

3912 
	#ADC_SQR2_SQ9_2
 ((
ut32_t
)0x00001000

	)

3913 
	#ADC_SQR2_SQ9_3
 ((
ut32_t
)0x00002000

	)

3914 
	#ADC_SQR2_SQ9_4
 ((
ut32_t
)0x00004000

	)

3916 
	#ADC_SQR2_SQ10
 ((
ut32_t
)0x000F8000

	)

3917 
	#ADC_SQR2_SQ10_0
 ((
ut32_t
)0x00008000

	)

3918 
	#ADC_SQR2_SQ10_1
 ((
ut32_t
)0x00010000

	)

3919 
	#ADC_SQR2_SQ10_2
 ((
ut32_t
)0x00020000

	)

3920 
	#ADC_SQR2_SQ10_3
 ((
ut32_t
)0x00040000

	)

3921 
	#ADC_SQR2_SQ10_4
 ((
ut32_t
)0x00080000

	)

3923 
	#ADC_SQR2_SQ11
 ((
ut32_t
)0x01F00000

	)

3924 
	#ADC_SQR2_SQ11_0
 ((
ut32_t
)0x00100000

	)

3925 
	#ADC_SQR2_SQ11_1
 ((
ut32_t
)0x00200000

	)

3926 
	#ADC_SQR2_SQ11_2
 ((
ut32_t
)0x00400000

	)

3927 
	#ADC_SQR2_SQ11_3
 ((
ut32_t
)0x00800000

	)

3928 
	#ADC_SQR2_SQ11_4
 ((
ut32_t
)0x01000000

	)

3930 
	#ADC_SQR2_SQ12
 ((
ut32_t
)0x3E000000

	)

3931 
	#ADC_SQR2_SQ12_0
 ((
ut32_t
)0x02000000

	)

3932 
	#ADC_SQR2_SQ12_1
 ((
ut32_t
)0x04000000

	)

3933 
	#ADC_SQR2_SQ12_2
 ((
ut32_t
)0x08000000

	)

3934 
	#ADC_SQR2_SQ12_3
 ((
ut32_t
)0x10000000

	)

3935 
	#ADC_SQR2_SQ12_4
 ((
ut32_t
)0x20000000

	)

3938 
	#ADC_SQR3_SQ1
 ((
ut32_t
)0x0000001F

	)

3939 
	#ADC_SQR3_SQ1_0
 ((
ut32_t
)0x00000001

	)

3940 
	#ADC_SQR3_SQ1_1
 ((
ut32_t
)0x00000002

	)

3941 
	#ADC_SQR3_SQ1_2
 ((
ut32_t
)0x00000004

	)

3942 
	#ADC_SQR3_SQ1_3
 ((
ut32_t
)0x00000008

	)

3943 
	#ADC_SQR3_SQ1_4
 ((
ut32_t
)0x00000010

	)

3945 
	#ADC_SQR3_SQ2
 ((
ut32_t
)0x000003E0

	)

3946 
	#ADC_SQR3_SQ2_0
 ((
ut32_t
)0x00000020

	)

3947 
	#ADC_SQR3_SQ2_1
 ((
ut32_t
)0x00000040

	)

3948 
	#ADC_SQR3_SQ2_2
 ((
ut32_t
)0x00000080

	)

3949 
	#ADC_SQR3_SQ2_3
 ((
ut32_t
)0x00000100

	)

3950 
	#ADC_SQR3_SQ2_4
 ((
ut32_t
)0x00000200

	)

3952 
	#ADC_SQR3_SQ3
 ((
ut32_t
)0x00007C00

	)

3953 
	#ADC_SQR3_SQ3_0
 ((
ut32_t
)0x00000400

	)

3954 
	#ADC_SQR3_SQ3_1
 ((
ut32_t
)0x00000800

	)

3955 
	#ADC_SQR3_SQ3_2
 ((
ut32_t
)0x00001000

	)

3956 
	#ADC_SQR3_SQ3_3
 ((
ut32_t
)0x00002000

	)

3957 
	#ADC_SQR3_SQ3_4
 ((
ut32_t
)0x00004000

	)

3959 
	#ADC_SQR3_SQ4
 ((
ut32_t
)0x000F8000

	)

3960 
	#ADC_SQR3_SQ4_0
 ((
ut32_t
)0x00008000

	)

3961 
	#ADC_SQR3_SQ4_1
 ((
ut32_t
)0x00010000

	)

3962 
	#ADC_SQR3_SQ4_2
 ((
ut32_t
)0x00020000

	)

3963 
	#ADC_SQR3_SQ4_3
 ((
ut32_t
)0x00040000

	)

3964 
	#ADC_SQR3_SQ4_4
 ((
ut32_t
)0x00080000

	)

3966 
	#ADC_SQR3_SQ5
 ((
ut32_t
)0x01F00000

	)

3967 
	#ADC_SQR3_SQ5_0
 ((
ut32_t
)0x00100000

	)

3968 
	#ADC_SQR3_SQ5_1
 ((
ut32_t
)0x00200000

	)

3969 
	#ADC_SQR3_SQ5_2
 ((
ut32_t
)0x00400000

	)

3970 
	#ADC_SQR3_SQ5_3
 ((
ut32_t
)0x00800000

	)

3971 
	#ADC_SQR3_SQ5_4
 ((
ut32_t
)0x01000000

	)

3973 
	#ADC_SQR3_SQ6
 ((
ut32_t
)0x3E000000

	)

3974 
	#ADC_SQR3_SQ6_0
 ((
ut32_t
)0x02000000

	)

3975 
	#ADC_SQR3_SQ6_1
 ((
ut32_t
)0x04000000

	)

3976 
	#ADC_SQR3_SQ6_2
 ((
ut32_t
)0x08000000

	)

3977 
	#ADC_SQR3_SQ6_3
 ((
ut32_t
)0x10000000

	)

3978 
	#ADC_SQR3_SQ6_4
 ((
ut32_t
)0x20000000

	)

3981 
	#ADC_JSQR_JSQ1
 ((
ut32_t
)0x0000001F

	)

3982 
	#ADC_JSQR_JSQ1_0
 ((
ut32_t
)0x00000001

	)

3983 
	#ADC_JSQR_JSQ1_1
 ((
ut32_t
)0x00000002

	)

3984 
	#ADC_JSQR_JSQ1_2
 ((
ut32_t
)0x00000004

	)

3985 
	#ADC_JSQR_JSQ1_3
 ((
ut32_t
)0x00000008

	)

3986 
	#ADC_JSQR_JSQ1_4
 ((
ut32_t
)0x00000010

	)

3988 
	#ADC_JSQR_JSQ2
 ((
ut32_t
)0x000003E0

	)

3989 
	#ADC_JSQR_JSQ2_0
 ((
ut32_t
)0x00000020

	)

3990 
	#ADC_JSQR_JSQ2_1
 ((
ut32_t
)0x00000040

	)

3991 
	#ADC_JSQR_JSQ2_2
 ((
ut32_t
)0x00000080

	)

3992 
	#ADC_JSQR_JSQ2_3
 ((
ut32_t
)0x00000100

	)

3993 
	#ADC_JSQR_JSQ2_4
 ((
ut32_t
)0x00000200

	)

3995 
	#ADC_JSQR_JSQ3
 ((
ut32_t
)0x00007C00

	)

3996 
	#ADC_JSQR_JSQ3_0
 ((
ut32_t
)0x00000400

	)

3997 
	#ADC_JSQR_JSQ3_1
 ((
ut32_t
)0x00000800

	)

3998 
	#ADC_JSQR_JSQ3_2
 ((
ut32_t
)0x00001000

	)

3999 
	#ADC_JSQR_JSQ3_3
 ((
ut32_t
)0x00002000

	)

4000 
	#ADC_JSQR_JSQ3_4
 ((
ut32_t
)0x00004000

	)

4002 
	#ADC_JSQR_JSQ4
 ((
ut32_t
)0x000F8000

	)

4003 
	#ADC_JSQR_JSQ4_0
 ((
ut32_t
)0x00008000

	)

4004 
	#ADC_JSQR_JSQ4_1
 ((
ut32_t
)0x00010000

	)

4005 
	#ADC_JSQR_JSQ4_2
 ((
ut32_t
)0x00020000

	)

4006 
	#ADC_JSQR_JSQ4_3
 ((
ut32_t
)0x00040000

	)

4007 
	#ADC_JSQR_JSQ4_4
 ((
ut32_t
)0x00080000

	)

4009 
	#ADC_JSQR_JL
 ((
ut32_t
)0x00300000

	)

4010 
	#ADC_JSQR_JL_0
 ((
ut32_t
)0x00100000

	)

4011 
	#ADC_JSQR_JL_1
 ((
ut32_t
)0x00200000

	)

4014 
	#ADC_JDR1_JDATA
 ((
ut16_t
)0xFFFF

	)

4017 
	#ADC_JDR2_JDATA
 ((
ut16_t
)0xFFFF

	)

4020 
	#ADC_JDR3_JDATA
 ((
ut16_t
)0xFFFF

	)

4023 
	#ADC_JDR4_JDATA
 ((
ut16_t
)0xFFFF

	)

4026 
	#ADC_DR_DATA
 ((
ut32_t
)0x0000FFFF

	)

4027 
	#ADC_DR_ADC2DATA
 ((
ut32_t
)0xFFFF0000

	)

4036 
	#DAC_CR_EN1
 ((
ut32_t
)0x00000001

	)

4037 
	#DAC_CR_BOFF1
 ((
ut32_t
)0x00000002

	)

4038 
	#DAC_CR_TEN1
 ((
ut32_t
)0x00000004

	)

4040 
	#DAC_CR_TSEL1
 ((
ut32_t
)0x00000038

	)

4041 
	#DAC_CR_TSEL1_0
 ((
ut32_t
)0x00000008

	)

4042 
	#DAC_CR_TSEL1_1
 ((
ut32_t
)0x00000010

	)

4043 
	#DAC_CR_TSEL1_2
 ((
ut32_t
)0x00000020

	)

4045 
	#DAC_CR_WAVE1
 ((
ut32_t
)0x000000C0

	)

4046 
	#DAC_CR_WAVE1_0
 ((
ut32_t
)0x00000040

	)

4047 
	#DAC_CR_WAVE1_1
 ((
ut32_t
)0x00000080

	)

4049 
	#DAC_CR_MAMP1
 ((
ut32_t
)0x00000F00

	)

4050 
	#DAC_CR_MAMP1_0
 ((
ut32_t
)0x00000100

	)

4051 
	#DAC_CR_MAMP1_1
 ((
ut32_t
)0x00000200

	)

4052 
	#DAC_CR_MAMP1_2
 ((
ut32_t
)0x00000400

	)

4053 
	#DAC_CR_MAMP1_3
 ((
ut32_t
)0x00000800

	)

4055 
	#DAC_CR_DMAEN1
 ((
ut32_t
)0x00001000

	)

4056 
	#DAC_CR_EN2
 ((
ut32_t
)0x00010000

	)

4057 
	#DAC_CR_BOFF2
 ((
ut32_t
)0x00020000

	)

4058 
	#DAC_CR_TEN2
 ((
ut32_t
)0x00040000

	)

4060 
	#DAC_CR_TSEL2
 ((
ut32_t
)0x00380000

	)

4061 
	#DAC_CR_TSEL2_0
 ((
ut32_t
)0x00080000

	)

4062 
	#DAC_CR_TSEL2_1
 ((
ut32_t
)0x00100000

	)

4063 
	#DAC_CR_TSEL2_2
 ((
ut32_t
)0x00200000

	)

4065 
	#DAC_CR_WAVE2
 ((
ut32_t
)0x00C00000

	)

4066 
	#DAC_CR_WAVE2_0
 ((
ut32_t
)0x00400000

	)

4067 
	#DAC_CR_WAVE2_1
 ((
ut32_t
)0x00800000

	)

4069 
	#DAC_CR_MAMP2
 ((
ut32_t
)0x0F000000

	)

4070 
	#DAC_CR_MAMP2_0
 ((
ut32_t
)0x01000000

	)

4071 
	#DAC_CR_MAMP2_1
 ((
ut32_t
)0x02000000

	)

4072 
	#DAC_CR_MAMP2_2
 ((
ut32_t
)0x04000000

	)

4073 
	#DAC_CR_MAMP2_3
 ((
ut32_t
)0x08000000

	)

4075 
	#DAC_CR_DMAEN2
 ((
ut32_t
)0x10000000

	)

4078 
	#DAC_SWTRIGR_SWTRIG1
 ((
ut8_t
)0x01

	)

4079 
	#DAC_SWTRIGR_SWTRIG2
 ((
ut8_t
)0x02

	)

4082 
	#DAC_DHR12R1_DACC1DHR
 ((
ut16_t
)0x0FFF

	)

4085 
	#DAC_DHR12L1_DACC1DHR
 ((
ut16_t
)0xFFF0

	)

4088 
	#DAC_DHR8R1_DACC1DHR
 ((
ut8_t
)0xFF

	)

4091 
	#DAC_DHR12R2_DACC2DHR
 ((
ut16_t
)0x0FFF

	)

4094 
	#DAC_DHR12L2_DACC2DHR
 ((
ut16_t
)0xFFF0

	)

4097 
	#DAC_DHR8R2_DACC2DHR
 ((
ut8_t
)0xFF

	)

4100 
	#DAC_DHR12RD_DACC1DHR
 ((
ut32_t
)0x00000FFF

	)

4101 
	#DAC_DHR12RD_DACC2DHR
 ((
ut32_t
)0x0FFF0000

	)

4104 
	#DAC_DHR12LD_DACC1DHR
 ((
ut32_t
)0x0000FFF0

	)

4105 
	#DAC_DHR12LD_DACC2DHR
 ((
ut32_t
)0xFFF00000

	)

4108 
	#DAC_DHR8RD_DACC1DHR
 ((
ut16_t
)0x00FF

	)

4109 
	#DAC_DHR8RD_DACC2DHR
 ((
ut16_t
)0xFF00

	)

4112 
	#DAC_DOR1_DACC1DOR
 ((
ut16_t
)0x0FFF

	)

4115 
	#DAC_DOR2_DACC2DOR
 ((
ut16_t
)0x0FFF

	)

4118 
	#DAC_SR_DMAUDR1
 ((
ut32_t
)0x00002000

	)

4119 
	#DAC_SR_DMAUDR2
 ((
ut32_t
)0x20000000

	)

4127 
	#CEC_CFGR_PE
 ((
ut16_t
)0x0001

	)

4128 
	#CEC_CFGR_IE
 ((
ut16_t
)0x0002

	)

4129 
	#CEC_CFGR_BTEM
 ((
ut16_t
)0x0004

	)

4130 
	#CEC_CFGR_BPEM
 ((
ut16_t
)0x0008

	)

4133 
	#CEC_OAR_OA
 ((
ut16_t
)0x000F

	)

4134 
	#CEC_OAR_OA_0
 ((
ut16_t
)0x0001

	)

4135 
	#CEC_OAR_OA_1
 ((
ut16_t
)0x0002

	)

4136 
	#CEC_OAR_OA_2
 ((
ut16_t
)0x0004

	)

4137 
	#CEC_OAR_OA_3
 ((
ut16_t
)0x0008

	)

4140 
	#CEC_PRES_PRES
 ((
ut16_t
)0x3FFF

	)

4143 
	#CEC_ESR_BTE
 ((
ut16_t
)0x0001

	)

4144 
	#CEC_ESR_BPE
 ((
ut16_t
)0x0002

	)

4145 
	#CEC_ESR_RBTFE
 ((
ut16_t
)0x0004

	)

4146 
	#CEC_ESR_SBE
 ((
ut16_t
)0x0008

	)

4147 
	#CEC_ESR_ACKE
 ((
ut16_t
)0x0010

	)

4148 
	#CEC_ESR_LINE
 ((
ut16_t
)0x0020

	)

4149 
	#CEC_ESR_TBTFE
 ((
ut16_t
)0x0040

	)

4152 
	#CEC_CSR_TSOM
 ((
ut16_t
)0x0001

	)

4153 
	#CEC_CSR_TEOM
 ((
ut16_t
)0x0002

	)

4154 
	#CEC_CSR_TERR
 ((
ut16_t
)0x0004

	)

4155 
	#CEC_CSR_TBTRF
 ((
ut16_t
)0x0008

	)

4156 
	#CEC_CSR_RSOM
 ((
ut16_t
)0x0010

	)

4157 
	#CEC_CSR_REOM
 ((
ut16_t
)0x0020

	)

4158 
	#CEC_CSR_RERR
 ((
ut16_t
)0x0040

	)

4159 
	#CEC_CSR_RBTF
 ((
ut16_t
)0x0080

	)

4162 
	#CEC_TXD_TXD
 ((
ut16_t
)0x00FF

	)

4165 
	#CEC_RXD_RXD
 ((
ut16_t
)0x00FF

	)

4174 
	#TIM_CR1_CEN
 ((
ut16_t
)0x0001

	)

4175 
	#TIM_CR1_UDIS
 ((
ut16_t
)0x0002

	)

4176 
	#TIM_CR1_URS
 ((
ut16_t
)0x0004

	)

4177 
	#TIM_CR1_OPM
 ((
ut16_t
)0x0008

	)

4178 
	#TIM_CR1_DIR
 ((
ut16_t
)0x0010

	)

4180 
	#TIM_CR1_CMS
 ((
ut16_t
)0x0060

	)

4181 
	#TIM_CR1_CMS_0
 ((
ut16_t
)0x0020

	)

4182 
	#TIM_CR1_CMS_1
 ((
ut16_t
)0x0040

	)

4184 
	#TIM_CR1_ARPE
 ((
ut16_t
)0x0080

	)

4186 
	#TIM_CR1_CKD
 ((
ut16_t
)0x0300

	)

4187 
	#TIM_CR1_CKD_0
 ((
ut16_t
)0x0100

	)

4188 
	#TIM_CR1_CKD_1
 ((
ut16_t
)0x0200

	)

4191 
	#TIM_CR2_CCPC
 ((
ut16_t
)0x0001

	)

4192 
	#TIM_CR2_CCUS
 ((
ut16_t
)0x0004

	)

4193 
	#TIM_CR2_CCDS
 ((
ut16_t
)0x0008

	)

4195 
	#TIM_CR2_MMS
 ((
ut16_t
)0x0070

	)

4196 
	#TIM_CR2_MMS_0
 ((
ut16_t
)0x0010

	)

4197 
	#TIM_CR2_MMS_1
 ((
ut16_t
)0x0020

	)

4198 
	#TIM_CR2_MMS_2
 ((
ut16_t
)0x0040

	)

4200 
	#TIM_CR2_TI1S
 ((
ut16_t
)0x0080

	)

4201 
	#TIM_CR2_OIS1
 ((
ut16_t
)0x0100

	)

4202 
	#TIM_CR2_OIS1N
 ((
ut16_t
)0x0200

	)

4203 
	#TIM_CR2_OIS2
 ((
ut16_t
)0x0400

	)

4204 
	#TIM_CR2_OIS2N
 ((
ut16_t
)0x0800

	)

4205 
	#TIM_CR2_OIS3
 ((
ut16_t
)0x1000

	)

4206 
	#TIM_CR2_OIS3N
 ((
ut16_t
)0x2000

	)

4207 
	#TIM_CR2_OIS4
 ((
ut16_t
)0x4000

	)

4210 
	#TIM_SMCR_SMS
 ((
ut16_t
)0x0007

	)

4211 
	#TIM_SMCR_SMS_0
 ((
ut16_t
)0x0001

	)

4212 
	#TIM_SMCR_SMS_1
 ((
ut16_t
)0x0002

	)

4213 
	#TIM_SMCR_SMS_2
 ((
ut16_t
)0x0004

	)

4215 
	#TIM_SMCR_TS
 ((
ut16_t
)0x0070

	)

4216 
	#TIM_SMCR_TS_0
 ((
ut16_t
)0x0010

	)

4217 
	#TIM_SMCR_TS_1
 ((
ut16_t
)0x0020

	)

4218 
	#TIM_SMCR_TS_2
 ((
ut16_t
)0x0040

	)

4220 
	#TIM_SMCR_MSM
 ((
ut16_t
)0x0080

	)

4222 
	#TIM_SMCR_ETF
 ((
ut16_t
)0x0F00

	)

4223 
	#TIM_SMCR_ETF_0
 ((
ut16_t
)0x0100

	)

4224 
	#TIM_SMCR_ETF_1
 ((
ut16_t
)0x0200

	)

4225 
	#TIM_SMCR_ETF_2
 ((
ut16_t
)0x0400

	)

4226 
	#TIM_SMCR_ETF_3
 ((
ut16_t
)0x0800

	)

4228 
	#TIM_SMCR_ETPS
 ((
ut16_t
)0x3000

	)

4229 
	#TIM_SMCR_ETPS_0
 ((
ut16_t
)0x1000

	)

4230 
	#TIM_SMCR_ETPS_1
 ((
ut16_t
)0x2000

	)

4232 
	#TIM_SMCR_ECE
 ((
ut16_t
)0x4000

	)

4233 
	#TIM_SMCR_ETP
 ((
ut16_t
)0x8000

	)

4236 
	#TIM_DIER_UIE
 ((
ut16_t
)0x0001

	)

4237 
	#TIM_DIER_CC1IE
 ((
ut16_t
)0x0002

	)

4238 
	#TIM_DIER_CC2IE
 ((
ut16_t
)0x0004

	)

4239 
	#TIM_DIER_CC3IE
 ((
ut16_t
)0x0008

	)

4240 
	#TIM_DIER_CC4IE
 ((
ut16_t
)0x0010

	)

4241 
	#TIM_DIER_COMIE
 ((
ut16_t
)0x0020

	)

4242 
	#TIM_DIER_TIE
 ((
ut16_t
)0x0040

	)

4243 
	#TIM_DIER_BIE
 ((
ut16_t
)0x0080

	)

4244 
	#TIM_DIER_UDE
 ((
ut16_t
)0x0100

	)

4245 
	#TIM_DIER_CC1DE
 ((
ut16_t
)0x0200

	)

4246 
	#TIM_DIER_CC2DE
 ((
ut16_t
)0x0400

	)

4247 
	#TIM_DIER_CC3DE
 ((
ut16_t
)0x0800

	)

4248 
	#TIM_DIER_CC4DE
 ((
ut16_t
)0x1000

	)

4249 
	#TIM_DIER_COMDE
 ((
ut16_t
)0x2000

	)

4250 
	#TIM_DIER_TDE
 ((
ut16_t
)0x4000

	)

4253 
	#TIM_SR_UIF
 ((
ut16_t
)0x0001

	)

4254 
	#TIM_SR_CC1IF
 ((
ut16_t
)0x0002

	)

4255 
	#TIM_SR_CC2IF
 ((
ut16_t
)0x0004

	)

4256 
	#TIM_SR_CC3IF
 ((
ut16_t
)0x0008

	)

4257 
	#TIM_SR_CC4IF
 ((
ut16_t
)0x0010

	)

4258 
	#TIM_SR_COMIF
 ((
ut16_t
)0x0020

	)

4259 
	#TIM_SR_TIF
 ((
ut16_t
)0x0040

	)

4260 
	#TIM_SR_BIF
 ((
ut16_t
)0x0080

	)

4261 
	#TIM_SR_CC1OF
 ((
ut16_t
)0x0200

	)

4262 
	#TIM_SR_CC2OF
 ((
ut16_t
)0x0400

	)

4263 
	#TIM_SR_CC3OF
 ((
ut16_t
)0x0800

	)

4264 
	#TIM_SR_CC4OF
 ((
ut16_t
)0x1000

	)

4267 
	#TIM_EGR_UG
 ((
ut8_t
)0x01

	)

4268 
	#TIM_EGR_CC1G
 ((
ut8_t
)0x02

	)

4269 
	#TIM_EGR_CC2G
 ((
ut8_t
)0x04

	)

4270 
	#TIM_EGR_CC3G
 ((
ut8_t
)0x08

	)

4271 
	#TIM_EGR_CC4G
 ((
ut8_t
)0x10

	)

4272 
	#TIM_EGR_COMG
 ((
ut8_t
)0x20

	)

4273 
	#TIM_EGR_TG
 ((
ut8_t
)0x40

	)

4274 
	#TIM_EGR_BG
 ((
ut8_t
)0x80

	)

4277 
	#TIM_CCMR1_CC1S
 ((
ut16_t
)0x0003

	)

4278 
	#TIM_CCMR1_CC1S_0
 ((
ut16_t
)0x0001

	)

4279 
	#TIM_CCMR1_CC1S_1
 ((
ut16_t
)0x0002

	)

4281 
	#TIM_CCMR1_OC1FE
 ((
ut16_t
)0x0004

	)

4282 
	#TIM_CCMR1_OC1PE
 ((
ut16_t
)0x0008

	)

4284 
	#TIM_CCMR1_OC1M
 ((
ut16_t
)0x0070

	)

4285 
	#TIM_CCMR1_OC1M_0
 ((
ut16_t
)0x0010

	)

4286 
	#TIM_CCMR1_OC1M_1
 ((
ut16_t
)0x0020

	)

4287 
	#TIM_CCMR1_OC1M_2
 ((
ut16_t
)0x0040

	)

4289 
	#TIM_CCMR1_OC1CE
 ((
ut16_t
)0x0080

	)

4291 
	#TIM_CCMR1_CC2S
 ((
ut16_t
)0x0300

	)

4292 
	#TIM_CCMR1_CC2S_0
 ((
ut16_t
)0x0100

	)

4293 
	#TIM_CCMR1_CC2S_1
 ((
ut16_t
)0x0200

	)

4295 
	#TIM_CCMR1_OC2FE
 ((
ut16_t
)0x0400

	)

4296 
	#TIM_CCMR1_OC2PE
 ((
ut16_t
)0x0800

	)

4298 
	#TIM_CCMR1_OC2M
 ((
ut16_t
)0x7000

	)

4299 
	#TIM_CCMR1_OC2M_0
 ((
ut16_t
)0x1000

	)

4300 
	#TIM_CCMR1_OC2M_1
 ((
ut16_t
)0x2000

	)

4301 
	#TIM_CCMR1_OC2M_2
 ((
ut16_t
)0x4000

	)

4303 
	#TIM_CCMR1_OC2CE
 ((
ut16_t
)0x8000

	)

4307 
	#TIM_CCMR1_IC1PSC
 ((
ut16_t
)0x000C

	)

4308 
	#TIM_CCMR1_IC1PSC_0
 ((
ut16_t
)0x0004

	)

4309 
	#TIM_CCMR1_IC1PSC_1
 ((
ut16_t
)0x0008

	)

4311 
	#TIM_CCMR1_IC1F
 ((
ut16_t
)0x00F0

	)

4312 
	#TIM_CCMR1_IC1F_0
 ((
ut16_t
)0x0010

	)

4313 
	#TIM_CCMR1_IC1F_1
 ((
ut16_t
)0x0020

	)

4314 
	#TIM_CCMR1_IC1F_2
 ((
ut16_t
)0x0040

	)

4315 
	#TIM_CCMR1_IC1F_3
 ((
ut16_t
)0x0080

	)

4317 
	#TIM_CCMR1_IC2PSC
 ((
ut16_t
)0x0C00

	)

4318 
	#TIM_CCMR1_IC2PSC_0
 ((
ut16_t
)0x0400

	)

4319 
	#TIM_CCMR1_IC2PSC_1
 ((
ut16_t
)0x0800

	)

4321 
	#TIM_CCMR1_IC2F
 ((
ut16_t
)0xF000

	)

4322 
	#TIM_CCMR1_IC2F_0
 ((
ut16_t
)0x1000

	)

4323 
	#TIM_CCMR1_IC2F_1
 ((
ut16_t
)0x2000

	)

4324 
	#TIM_CCMR1_IC2F_2
 ((
ut16_t
)0x4000

	)

4325 
	#TIM_CCMR1_IC2F_3
 ((
ut16_t
)0x8000

	)

4328 
	#TIM_CCMR2_CC3S
 ((
ut16_t
)0x0003

	)

4329 
	#TIM_CCMR2_CC3S_0
 ((
ut16_t
)0x0001

	)

4330 
	#TIM_CCMR2_CC3S_1
 ((
ut16_t
)0x0002

	)

4332 
	#TIM_CCMR2_OC3FE
 ((
ut16_t
)0x0004

	)

4333 
	#TIM_CCMR2_OC3PE
 ((
ut16_t
)0x0008

	)

4335 
	#TIM_CCMR2_OC3M
 ((
ut16_t
)0x0070

	)

4336 
	#TIM_CCMR2_OC3M_0
 ((
ut16_t
)0x0010

	)

4337 
	#TIM_CCMR2_OC3M_1
 ((
ut16_t
)0x0020

	)

4338 
	#TIM_CCMR2_OC3M_2
 ((
ut16_t
)0x0040

	)

4340 
	#TIM_CCMR2_OC3CE
 ((
ut16_t
)0x0080

	)

4342 
	#TIM_CCMR2_CC4S
 ((
ut16_t
)0x0300

	)

4343 
	#TIM_CCMR2_CC4S_0
 ((
ut16_t
)0x0100

	)

4344 
	#TIM_CCMR2_CC4S_1
 ((
ut16_t
)0x0200

	)

4346 
	#TIM_CCMR2_OC4FE
 ((
ut16_t
)0x0400

	)

4347 
	#TIM_CCMR2_OC4PE
 ((
ut16_t
)0x0800

	)

4349 
	#TIM_CCMR2_OC4M
 ((
ut16_t
)0x7000

	)

4350 
	#TIM_CCMR2_OC4M_0
 ((
ut16_t
)0x1000

	)

4351 
	#TIM_CCMR2_OC4M_1
 ((
ut16_t
)0x2000

	)

4352 
	#TIM_CCMR2_OC4M_2
 ((
ut16_t
)0x4000

	)

4354 
	#TIM_CCMR2_OC4CE
 ((
ut16_t
)0x8000

	)

4358 
	#TIM_CCMR2_IC3PSC
 ((
ut16_t
)0x000C

	)

4359 
	#TIM_CCMR2_IC3PSC_0
 ((
ut16_t
)0x0004

	)

4360 
	#TIM_CCMR2_IC3PSC_1
 ((
ut16_t
)0x0008

	)

4362 
	#TIM_CCMR2_IC3F
 ((
ut16_t
)0x00F0

	)

4363 
	#TIM_CCMR2_IC3F_0
 ((
ut16_t
)0x0010

	)

4364 
	#TIM_CCMR2_IC3F_1
 ((
ut16_t
)0x0020

	)

4365 
	#TIM_CCMR2_IC3F_2
 ((
ut16_t
)0x0040

	)

4366 
	#TIM_CCMR2_IC3F_3
 ((
ut16_t
)0x0080

	)

4368 
	#TIM_CCMR2_IC4PSC
 ((
ut16_t
)0x0C00

	)

4369 
	#TIM_CCMR2_IC4PSC_0
 ((
ut16_t
)0x0400

	)

4370 
	#TIM_CCMR2_IC4PSC_1
 ((
ut16_t
)0x0800

	)

4372 
	#TIM_CCMR2_IC4F
 ((
ut16_t
)0xF000

	)

4373 
	#TIM_CCMR2_IC4F_0
 ((
ut16_t
)0x1000

	)

4374 
	#TIM_CCMR2_IC4F_1
 ((
ut16_t
)0x2000

	)

4375 
	#TIM_CCMR2_IC4F_2
 ((
ut16_t
)0x4000

	)

4376 
	#TIM_CCMR2_IC4F_3
 ((
ut16_t
)0x8000

	)

4379 
	#TIM_CCER_CC1E
 ((
ut16_t
)0x0001

	)

4380 
	#TIM_CCER_CC1P
 ((
ut16_t
)0x0002

	)

4381 
	#TIM_CCER_CC1NE
 ((
ut16_t
)0x0004

	)

4382 
	#TIM_CCER_CC1NP
 ((
ut16_t
)0x0008

	)

4383 
	#TIM_CCER_CC2E
 ((
ut16_t
)0x0010

	)

4384 
	#TIM_CCER_CC2P
 ((
ut16_t
)0x0020

	)

4385 
	#TIM_CCER_CC2NE
 ((
ut16_t
)0x0040

	)

4386 
	#TIM_CCER_CC2NP
 ((
ut16_t
)0x0080

	)

4387 
	#TIM_CCER_CC3E
 ((
ut16_t
)0x0100

	)

4388 
	#TIM_CCER_CC3P
 ((
ut16_t
)0x0200

	)

4389 
	#TIM_CCER_CC3NE
 ((
ut16_t
)0x0400

	)

4390 
	#TIM_CCER_CC3NP
 ((
ut16_t
)0x0800

	)

4391 
	#TIM_CCER_CC4E
 ((
ut16_t
)0x1000

	)

4392 
	#TIM_CCER_CC4P
 ((
ut16_t
)0x2000

	)

4393 
	#TIM_CCER_CC4NP
 ((
ut16_t
)0x8000

	)

4396 
	#TIM_CNT_CNT
 ((
ut16_t
)0xFFFF

	)

4399 
	#TIM_PSC_PSC
 ((
ut16_t
)0xFFFF

	)

4402 
	#TIM_ARR_ARR
 ((
ut16_t
)0xFFFF

	)

4405 
	#TIM_RCR_REP
 ((
ut8_t
)0xFF

	)

4408 
	#TIM_CCR1_CCR1
 ((
ut16_t
)0xFFFF

	)

4411 
	#TIM_CCR2_CCR2
 ((
ut16_t
)0xFFFF

	)

4414 
	#TIM_CCR3_CCR3
 ((
ut16_t
)0xFFFF

	)

4417 
	#TIM_CCR4_CCR4
 ((
ut16_t
)0xFFFF

	)

4420 
	#TIM_BDTR_DTG
 ((
ut16_t
)0x00FF

	)

4421 
	#TIM_BDTR_DTG_0
 ((
ut16_t
)0x0001

	)

4422 
	#TIM_BDTR_DTG_1
 ((
ut16_t
)0x0002

	)

4423 
	#TIM_BDTR_DTG_2
 ((
ut16_t
)0x0004

	)

4424 
	#TIM_BDTR_DTG_3
 ((
ut16_t
)0x0008

	)

4425 
	#TIM_BDTR_DTG_4
 ((
ut16_t
)0x0010

	)

4426 
	#TIM_BDTR_DTG_5
 ((
ut16_t
)0x0020

	)

4427 
	#TIM_BDTR_DTG_6
 ((
ut16_t
)0x0040

	)

4428 
	#TIM_BDTR_DTG_7
 ((
ut16_t
)0x0080

	)

4430 
	#TIM_BDTR_LOCK
 ((
ut16_t
)0x0300

	)

4431 
	#TIM_BDTR_LOCK_0
 ((
ut16_t
)0x0100

	)

4432 
	#TIM_BDTR_LOCK_1
 ((
ut16_t
)0x0200

	)

4434 
	#TIM_BDTR_OSSI
 ((
ut16_t
)0x0400

	)

4435 
	#TIM_BDTR_OSSR
 ((
ut16_t
)0x0800

	)

4436 
	#TIM_BDTR_BKE
 ((
ut16_t
)0x1000

	)

4437 
	#TIM_BDTR_BKP
 ((
ut16_t
)0x2000

	)

4438 
	#TIM_BDTR_AOE
 ((
ut16_t
)0x4000

	)

4439 
	#TIM_BDTR_MOE
 ((
ut16_t
)0x8000

	)

4442 
	#TIM_DCR_DBA
 ((
ut16_t
)0x001F

	)

4443 
	#TIM_DCR_DBA_0
 ((
ut16_t
)0x0001

	)

4444 
	#TIM_DCR_DBA_1
 ((
ut16_t
)0x0002

	)

4445 
	#TIM_DCR_DBA_2
 ((
ut16_t
)0x0004

	)

4446 
	#TIM_DCR_DBA_3
 ((
ut16_t
)0x0008

	)

4447 
	#TIM_DCR_DBA_4
 ((
ut16_t
)0x0010

	)

4449 
	#TIM_DCR_DBL
 ((
ut16_t
)0x1F00

	)

4450 
	#TIM_DCR_DBL_0
 ((
ut16_t
)0x0100

	)

4451 
	#TIM_DCR_DBL_1
 ((
ut16_t
)0x0200

	)

4452 
	#TIM_DCR_DBL_2
 ((
ut16_t
)0x0400

	)

4453 
	#TIM_DCR_DBL_3
 ((
ut16_t
)0x0800

	)

4454 
	#TIM_DCR_DBL_4
 ((
ut16_t
)0x1000

	)

4457 
	#TIM_DMAR_DMAB
 ((
ut16_t
)0xFFFF

	)

4466 
	#RTC_CRH_SECIE
 ((
ut8_t
)0x01

	)

4467 
	#RTC_CRH_ALRIE
 ((
ut8_t
)0x02

	)

4468 
	#RTC_CRH_OWIE
 ((
ut8_t
)0x04

	)

4471 
	#RTC_CRL_SECF
 ((
ut8_t
)0x01

	)

4472 
	#RTC_CRL_ALRF
 ((
ut8_t
)0x02

	)

4473 
	#RTC_CRL_OWF
 ((
ut8_t
)0x04

	)

4474 
	#RTC_CRL_RSF
 ((
ut8_t
)0x08

	)

4475 
	#RTC_CRL_CNF
 ((
ut8_t
)0x10

	)

4476 
	#RTC_CRL_RTOFF
 ((
ut8_t
)0x20

	)

4479 
	#RTC_PRLH_PRL
 ((
ut16_t
)0x000F

	)

4482 
	#RTC_PRLL_PRL
 ((
ut16_t
)0xFFFF

	)

4485 
	#RTC_DIVH_RTC_DIV
 ((
ut16_t
)0x000F

	)

4488 
	#RTC_DIVL_RTC_DIV
 ((
ut16_t
)0xFFFF

	)

4491 
	#RTC_CNTH_RTC_CNT
 ((
ut16_t
)0xFFFF

	)

4494 
	#RTC_CNTL_RTC_CNT
 ((
ut16_t
)0xFFFF

	)

4497 
	#RTC_ALRH_RTC_ALR
 ((
ut16_t
)0xFFFF

	)

4500 
	#RTC_ALRL_RTC_ALR
 ((
ut16_t
)0xFFFF

	)

4509 
	#IWDG_KR_KEY
 ((
ut16_t
)0xFFFF

	)

4512 
	#IWDG_PR_PR
 ((
ut8_t
)0x07

	)

4513 
	#IWDG_PR_PR_0
 ((
ut8_t
)0x01

	)

4514 
	#IWDG_PR_PR_1
 ((
ut8_t
)0x02

	)

4515 
	#IWDG_PR_PR_2
 ((
ut8_t
)0x04

	)

4518 
	#IWDG_RLR_RL
 ((
ut16_t
)0x0FFF

	)

4521 
	#IWDG_SR_PVU
 ((
ut8_t
)0x01

	)

4522 
	#IWDG_SR_RVU
 ((
ut8_t
)0x02

	)

4531 
	#WWDG_CR_T
 ((
ut8_t
)0x7F

	)

4532 
	#WWDG_CR_T0
 ((
ut8_t
)0x01

	)

4533 
	#WWDG_CR_T1
 ((
ut8_t
)0x02

	)

4534 
	#WWDG_CR_T2
 ((
ut8_t
)0x04

	)

4535 
	#WWDG_CR_T3
 ((
ut8_t
)0x08

	)

4536 
	#WWDG_CR_T4
 ((
ut8_t
)0x10

	)

4537 
	#WWDG_CR_T5
 ((
ut8_t
)0x20

	)

4538 
	#WWDG_CR_T6
 ((
ut8_t
)0x40

	)

4540 
	#WWDG_CR_WDGA
 ((
ut8_t
)0x80

	)

4543 
	#WWDG_CFR_W
 ((
ut16_t
)0x007F

	)

4544 
	#WWDG_CFR_W0
 ((
ut16_t
)0x0001

	)

4545 
	#WWDG_CFR_W1
 ((
ut16_t
)0x0002

	)

4546 
	#WWDG_CFR_W2
 ((
ut16_t
)0x0004

	)

4547 
	#WWDG_CFR_W3
 ((
ut16_t
)0x0008

	)

4548 
	#WWDG_CFR_W4
 ((
ut16_t
)0x0010

	)

4549 
	#WWDG_CFR_W5
 ((
ut16_t
)0x0020

	)

4550 
	#WWDG_CFR_W6
 ((
ut16_t
)0x0040

	)

4552 
	#WWDG_CFR_WDGTB
 ((
ut16_t
)0x0180

	)

4553 
	#WWDG_CFR_WDGTB0
 ((
ut16_t
)0x0080

	)

4554 
	#WWDG_CFR_WDGTB1
 ((
ut16_t
)0x0100

	)

4556 
	#WWDG_CFR_EWI
 ((
ut16_t
)0x0200

	)

4559 
	#WWDG_SR_EWIF
 ((
ut8_t
)0x01

	)

4568 
	#FSMC_BCR1_MBKEN
 ((
ut32_t
)0x00000001

	)

4569 
	#FSMC_BCR1_MUXEN
 ((
ut32_t
)0x00000002

	)

4571 
	#FSMC_BCR1_MTYP
 ((
ut32_t
)0x0000000C

	)

4572 
	#FSMC_BCR1_MTYP_0
 ((
ut32_t
)0x00000004

	)

4573 
	#FSMC_BCR1_MTYP_1
 ((
ut32_t
)0x00000008

	)

4575 
	#FSMC_BCR1_MWID
 ((
ut32_t
)0x00000030

	)

4576 
	#FSMC_BCR1_MWID_0
 ((
ut32_t
)0x00000010

	)

4577 
	#FSMC_BCR1_MWID_1
 ((
ut32_t
)0x00000020

	)

4579 
	#FSMC_BCR1_FACCEN
 ((
ut32_t
)0x00000040

	)

4580 
	#FSMC_BCR1_BURSTEN
 ((
ut32_t
)0x00000100

	)

4581 
	#FSMC_BCR1_WAITPOL
 ((
ut32_t
)0x00000200

	)

4582 
	#FSMC_BCR1_WRAPMOD
 ((
ut32_t
)0x00000400

	)

4583 
	#FSMC_BCR1_WAITCFG
 ((
ut32_t
)0x00000800

	)

4584 
	#FSMC_BCR1_WREN
 ((
ut32_t
)0x00001000

	)

4585 
	#FSMC_BCR1_WAITEN
 ((
ut32_t
)0x00002000

	)

4586 
	#FSMC_BCR1_EXTMOD
 ((
ut32_t
)0x00004000

	)

4587 
	#FSMC_BCR1_ASYNCWAIT
 ((
ut32_t
)0x00008000

	)

4588 
	#FSMC_BCR1_CBURSTRW
 ((
ut32_t
)0x00080000

	)

4591 
	#FSMC_BCR2_MBKEN
 ((
ut32_t
)0x00000001

	)

4592 
	#FSMC_BCR2_MUXEN
 ((
ut32_t
)0x00000002

	)

4594 
	#FSMC_BCR2_MTYP
 ((
ut32_t
)0x0000000C

	)

4595 
	#FSMC_BCR2_MTYP_0
 ((
ut32_t
)0x00000004

	)

4596 
	#FSMC_BCR2_MTYP_1
 ((
ut32_t
)0x00000008

	)

4598 
	#FSMC_BCR2_MWID
 ((
ut32_t
)0x00000030

	)

4599 
	#FSMC_BCR2_MWID_0
 ((
ut32_t
)0x00000010

	)

4600 
	#FSMC_BCR2_MWID_1
 ((
ut32_t
)0x00000020

	)

4602 
	#FSMC_BCR2_FACCEN
 ((
ut32_t
)0x00000040

	)

4603 
	#FSMC_BCR2_BURSTEN
 ((
ut32_t
)0x00000100

	)

4604 
	#FSMC_BCR2_WAITPOL
 ((
ut32_t
)0x00000200

	)

4605 
	#FSMC_BCR2_WRAPMOD
 ((
ut32_t
)0x00000400

	)

4606 
	#FSMC_BCR2_WAITCFG
 ((
ut32_t
)0x00000800

	)

4607 
	#FSMC_BCR2_WREN
 ((
ut32_t
)0x00001000

	)

4608 
	#FSMC_BCR2_WAITEN
 ((
ut32_t
)0x00002000

	)

4609 
	#FSMC_BCR2_EXTMOD
 ((
ut32_t
)0x00004000

	)

4610 
	#FSMC_BCR2_ASYNCWAIT
 ((
ut32_t
)0x00008000

	)

4611 
	#FSMC_BCR2_CBURSTRW
 ((
ut32_t
)0x00080000

	)

4614 
	#FSMC_BCR3_MBKEN
 ((
ut32_t
)0x00000001

	)

4615 
	#FSMC_BCR3_MUXEN
 ((
ut32_t
)0x00000002

	)

4617 
	#FSMC_BCR3_MTYP
 ((
ut32_t
)0x0000000C

	)

4618 
	#FSMC_BCR3_MTYP_0
 ((
ut32_t
)0x00000004

	)

4619 
	#FSMC_BCR3_MTYP_1
 ((
ut32_t
)0x00000008

	)

4621 
	#FSMC_BCR3_MWID
 ((
ut32_t
)0x00000030

	)

4622 
	#FSMC_BCR3_MWID_0
 ((
ut32_t
)0x00000010

	)

4623 
	#FSMC_BCR3_MWID_1
 ((
ut32_t
)0x00000020

	)

4625 
	#FSMC_BCR3_FACCEN
 ((
ut32_t
)0x00000040

	)

4626 
	#FSMC_BCR3_BURSTEN
 ((
ut32_t
)0x00000100

	)

4627 
	#FSMC_BCR3_WAITPOL
 ((
ut32_t
)0x00000200

	)

4628 
	#FSMC_BCR3_WRAPMOD
 ((
ut32_t
)0x00000400

	)

4629 
	#FSMC_BCR3_WAITCFG
 ((
ut32_t
)0x00000800

	)

4630 
	#FSMC_BCR3_WREN
 ((
ut32_t
)0x00001000

	)

4631 
	#FSMC_BCR3_WAITEN
 ((
ut32_t
)0x00002000

	)

4632 
	#FSMC_BCR3_EXTMOD
 ((
ut32_t
)0x00004000

	)

4633 
	#FSMC_BCR3_ASYNCWAIT
 ((
ut32_t
)0x00008000

	)

4634 
	#FSMC_BCR3_CBURSTRW
 ((
ut32_t
)0x00080000

	)

4637 
	#FSMC_BCR4_MBKEN
 ((
ut32_t
)0x00000001

	)

4638 
	#FSMC_BCR4_MUXEN
 ((
ut32_t
)0x00000002

	)

4640 
	#FSMC_BCR4_MTYP
 ((
ut32_t
)0x0000000C

	)

4641 
	#FSMC_BCR4_MTYP_0
 ((
ut32_t
)0x00000004

	)

4642 
	#FSMC_BCR4_MTYP_1
 ((
ut32_t
)0x00000008

	)

4644 
	#FSMC_BCR4_MWID
 ((
ut32_t
)0x00000030

	)

4645 
	#FSMC_BCR4_MWID_0
 ((
ut32_t
)0x00000010

	)

4646 
	#FSMC_BCR4_MWID_1
 ((
ut32_t
)0x00000020

	)

4648 
	#FSMC_BCR4_FACCEN
 ((
ut32_t
)0x00000040

	)

4649 
	#FSMC_BCR4_BURSTEN
 ((
ut32_t
)0x00000100

	)

4650 
	#FSMC_BCR4_WAITPOL
 ((
ut32_t
)0x00000200

	)

4651 
	#FSMC_BCR4_WRAPMOD
 ((
ut32_t
)0x00000400

	)

4652 
	#FSMC_BCR4_WAITCFG
 ((
ut32_t
)0x00000800

	)

4653 
	#FSMC_BCR4_WREN
 ((
ut32_t
)0x00001000

	)

4654 
	#FSMC_BCR4_WAITEN
 ((
ut32_t
)0x00002000

	)

4655 
	#FSMC_BCR4_EXTMOD
 ((
ut32_t
)0x00004000

	)

4656 
	#FSMC_BCR4_ASYNCWAIT
 ((
ut32_t
)0x00008000

	)

4657 
	#FSMC_BCR4_CBURSTRW
 ((
ut32_t
)0x00080000

	)

4660 
	#FSMC_BTR1_ADDSET
 ((
ut32_t
)0x0000000F

	)

4661 
	#FSMC_BTR1_ADDSET_0
 ((
ut32_t
)0x00000001

	)

4662 
	#FSMC_BTR1_ADDSET_1
 ((
ut32_t
)0x00000002

	)

4663 
	#FSMC_BTR1_ADDSET_2
 ((
ut32_t
)0x00000004

	)

4664 
	#FSMC_BTR1_ADDSET_3
 ((
ut32_t
)0x00000008

	)

4666 
	#FSMC_BTR1_ADDHLD
 ((
ut32_t
)0x000000F0

	)

4667 
	#FSMC_BTR1_ADDHLD_0
 ((
ut32_t
)0x00000010

	)

4668 
	#FSMC_BTR1_ADDHLD_1
 ((
ut32_t
)0x00000020

	)

4669 
	#FSMC_BTR1_ADDHLD_2
 ((
ut32_t
)0x00000040

	)

4670 
	#FSMC_BTR1_ADDHLD_3
 ((
ut32_t
)0x00000080

	)

4672 
	#FSMC_BTR1_DATAST
 ((
ut32_t
)0x0000FF00

	)

4673 
	#FSMC_BTR1_DATAST_0
 ((
ut32_t
)0x00000100

	)

4674 
	#FSMC_BTR1_DATAST_1
 ((
ut32_t
)0x00000200

	)

4675 
	#FSMC_BTR1_DATAST_2
 ((
ut32_t
)0x00000400

	)

4676 
	#FSMC_BTR1_DATAST_3
 ((
ut32_t
)0x00000800

	)

4678 
	#FSMC_BTR1_BUSTURN
 ((
ut32_t
)0x000F0000

	)

4679 
	#FSMC_BTR1_BUSTURN_0
 ((
ut32_t
)0x00010000

	)

4680 
	#FSMC_BTR1_BUSTURN_1
 ((
ut32_t
)0x00020000

	)

4681 
	#FSMC_BTR1_BUSTURN_2
 ((
ut32_t
)0x00040000

	)

4682 
	#FSMC_BTR1_BUSTURN_3
 ((
ut32_t
)0x00080000

	)

4684 
	#FSMC_BTR1_CLKDIV
 ((
ut32_t
)0x00F00000

	)

4685 
	#FSMC_BTR1_CLKDIV_0
 ((
ut32_t
)0x00100000

	)

4686 
	#FSMC_BTR1_CLKDIV_1
 ((
ut32_t
)0x00200000

	)

4687 
	#FSMC_BTR1_CLKDIV_2
 ((
ut32_t
)0x00400000

	)

4688 
	#FSMC_BTR1_CLKDIV_3
 ((
ut32_t
)0x00800000

	)

4690 
	#FSMC_BTR1_DATLAT
 ((
ut32_t
)0x0F000000

	)

4691 
	#FSMC_BTR1_DATLAT_0
 ((
ut32_t
)0x01000000

	)

4692 
	#FSMC_BTR1_DATLAT_1
 ((
ut32_t
)0x02000000

	)

4693 
	#FSMC_BTR1_DATLAT_2
 ((
ut32_t
)0x04000000

	)

4694 
	#FSMC_BTR1_DATLAT_3
 ((
ut32_t
)0x08000000

	)

4696 
	#FSMC_BTR1_ACCMOD
 ((
ut32_t
)0x30000000

	)

4697 
	#FSMC_BTR1_ACCMOD_0
 ((
ut32_t
)0x10000000

	)

4698 
	#FSMC_BTR1_ACCMOD_1
 ((
ut32_t
)0x20000000

	)

4701 
	#FSMC_BTR2_ADDSET
 ((
ut32_t
)0x0000000F

	)

4702 
	#FSMC_BTR2_ADDSET_0
 ((
ut32_t
)0x00000001

	)

4703 
	#FSMC_BTR2_ADDSET_1
 ((
ut32_t
)0x00000002

	)

4704 
	#FSMC_BTR2_ADDSET_2
 ((
ut32_t
)0x00000004

	)

4705 
	#FSMC_BTR2_ADDSET_3
 ((
ut32_t
)0x00000008

	)

4707 
	#FSMC_BTR2_ADDHLD
 ((
ut32_t
)0x000000F0

	)

4708 
	#FSMC_BTR2_ADDHLD_0
 ((
ut32_t
)0x00000010

	)

4709 
	#FSMC_BTR2_ADDHLD_1
 ((
ut32_t
)0x00000020

	)

4710 
	#FSMC_BTR2_ADDHLD_2
 ((
ut32_t
)0x00000040

	)

4711 
	#FSMC_BTR2_ADDHLD_3
 ((
ut32_t
)0x00000080

	)

4713 
	#FSMC_BTR2_DATAST
 ((
ut32_t
)0x0000FF00

	)

4714 
	#FSMC_BTR2_DATAST_0
 ((
ut32_t
)0x00000100

	)

4715 
	#FSMC_BTR2_DATAST_1
 ((
ut32_t
)0x00000200

	)

4716 
	#FSMC_BTR2_DATAST_2
 ((
ut32_t
)0x00000400

	)

4717 
	#FSMC_BTR2_DATAST_3
 ((
ut32_t
)0x00000800

	)

4719 
	#FSMC_BTR2_BUSTURN
 ((
ut32_t
)0x000F0000

	)

4720 
	#FSMC_BTR2_BUSTURN_0
 ((
ut32_t
)0x00010000

	)

4721 
	#FSMC_BTR2_BUSTURN_1
 ((
ut32_t
)0x00020000

	)

4722 
	#FSMC_BTR2_BUSTURN_2
 ((
ut32_t
)0x00040000

	)

4723 
	#FSMC_BTR2_BUSTURN_3
 ((
ut32_t
)0x00080000

	)

4725 
	#FSMC_BTR2_CLKDIV
 ((
ut32_t
)0x00F00000

	)

4726 
	#FSMC_BTR2_CLKDIV_0
 ((
ut32_t
)0x00100000

	)

4727 
	#FSMC_BTR2_CLKDIV_1
 ((
ut32_t
)0x00200000

	)

4728 
	#FSMC_BTR2_CLKDIV_2
 ((
ut32_t
)0x00400000

	)

4729 
	#FSMC_BTR2_CLKDIV_3
 ((
ut32_t
)0x00800000

	)

4731 
	#FSMC_BTR2_DATLAT
 ((
ut32_t
)0x0F000000

	)

4732 
	#FSMC_BTR2_DATLAT_0
 ((
ut32_t
)0x01000000

	)

4733 
	#FSMC_BTR2_DATLAT_1
 ((
ut32_t
)0x02000000

	)

4734 
	#FSMC_BTR2_DATLAT_2
 ((
ut32_t
)0x04000000

	)

4735 
	#FSMC_BTR2_DATLAT_3
 ((
ut32_t
)0x08000000

	)

4737 
	#FSMC_BTR2_ACCMOD
 ((
ut32_t
)0x30000000

	)

4738 
	#FSMC_BTR2_ACCMOD_0
 ((
ut32_t
)0x10000000

	)

4739 
	#FSMC_BTR2_ACCMOD_1
 ((
ut32_t
)0x20000000

	)

4742 
	#FSMC_BTR3_ADDSET
 ((
ut32_t
)0x0000000F

	)

4743 
	#FSMC_BTR3_ADDSET_0
 ((
ut32_t
)0x00000001

	)

4744 
	#FSMC_BTR3_ADDSET_1
 ((
ut32_t
)0x00000002

	)

4745 
	#FSMC_BTR3_ADDSET_2
 ((
ut32_t
)0x00000004

	)

4746 
	#FSMC_BTR3_ADDSET_3
 ((
ut32_t
)0x00000008

	)

4748 
	#FSMC_BTR3_ADDHLD
 ((
ut32_t
)0x000000F0

	)

4749 
	#FSMC_BTR3_ADDHLD_0
 ((
ut32_t
)0x00000010

	)

4750 
	#FSMC_BTR3_ADDHLD_1
 ((
ut32_t
)0x00000020

	)

4751 
	#FSMC_BTR3_ADDHLD_2
 ((
ut32_t
)0x00000040

	)

4752 
	#FSMC_BTR3_ADDHLD_3
 ((
ut32_t
)0x00000080

	)

4754 
	#FSMC_BTR3_DATAST
 ((
ut32_t
)0x0000FF00

	)

4755 
	#FSMC_BTR3_DATAST_0
 ((
ut32_t
)0x00000100

	)

4756 
	#FSMC_BTR3_DATAST_1
 ((
ut32_t
)0x00000200

	)

4757 
	#FSMC_BTR3_DATAST_2
 ((
ut32_t
)0x00000400

	)

4758 
	#FSMC_BTR3_DATAST_3
 ((
ut32_t
)0x00000800

	)

4760 
	#FSMC_BTR3_BUSTURN
 ((
ut32_t
)0x000F0000

	)

4761 
	#FSMC_BTR3_BUSTURN_0
 ((
ut32_t
)0x00010000

	)

4762 
	#FSMC_BTR3_BUSTURN_1
 ((
ut32_t
)0x00020000

	)

4763 
	#FSMC_BTR3_BUSTURN_2
 ((
ut32_t
)0x00040000

	)

4764 
	#FSMC_BTR3_BUSTURN_3
 ((
ut32_t
)0x00080000

	)

4766 
	#FSMC_BTR3_CLKDIV
 ((
ut32_t
)0x00F00000

	)

4767 
	#FSMC_BTR3_CLKDIV_0
 ((
ut32_t
)0x00100000

	)

4768 
	#FSMC_BTR3_CLKDIV_1
 ((
ut32_t
)0x00200000

	)

4769 
	#FSMC_BTR3_CLKDIV_2
 ((
ut32_t
)0x00400000

	)

4770 
	#FSMC_BTR3_CLKDIV_3
 ((
ut32_t
)0x00800000

	)

4772 
	#FSMC_BTR3_DATLAT
 ((
ut32_t
)0x0F000000

	)

4773 
	#FSMC_BTR3_DATLAT_0
 ((
ut32_t
)0x01000000

	)

4774 
	#FSMC_BTR3_DATLAT_1
 ((
ut32_t
)0x02000000

	)

4775 
	#FSMC_BTR3_DATLAT_2
 ((
ut32_t
)0x04000000

	)

4776 
	#FSMC_BTR3_DATLAT_3
 ((
ut32_t
)0x08000000

	)

4778 
	#FSMC_BTR3_ACCMOD
 ((
ut32_t
)0x30000000

	)

4779 
	#FSMC_BTR3_ACCMOD_0
 ((
ut32_t
)0x10000000

	)

4780 
	#FSMC_BTR3_ACCMOD_1
 ((
ut32_t
)0x20000000

	)

4783 
	#FSMC_BTR4_ADDSET
 ((
ut32_t
)0x0000000F

	)

4784 
	#FSMC_BTR4_ADDSET_0
 ((
ut32_t
)0x00000001

	)

4785 
	#FSMC_BTR4_ADDSET_1
 ((
ut32_t
)0x00000002

	)

4786 
	#FSMC_BTR4_ADDSET_2
 ((
ut32_t
)0x00000004

	)

4787 
	#FSMC_BTR4_ADDSET_3
 ((
ut32_t
)0x00000008

	)

4789 
	#FSMC_BTR4_ADDHLD
 ((
ut32_t
)0x000000F0

	)

4790 
	#FSMC_BTR4_ADDHLD_0
 ((
ut32_t
)0x00000010

	)

4791 
	#FSMC_BTR4_ADDHLD_1
 ((
ut32_t
)0x00000020

	)

4792 
	#FSMC_BTR4_ADDHLD_2
 ((
ut32_t
)0x00000040

	)

4793 
	#FSMC_BTR4_ADDHLD_3
 ((
ut32_t
)0x00000080

	)

4795 
	#FSMC_BTR4_DATAST
 ((
ut32_t
)0x0000FF00

	)

4796 
	#FSMC_BTR4_DATAST_0
 ((
ut32_t
)0x00000100

	)

4797 
	#FSMC_BTR4_DATAST_1
 ((
ut32_t
)0x00000200

	)

4798 
	#FSMC_BTR4_DATAST_2
 ((
ut32_t
)0x00000400

	)

4799 
	#FSMC_BTR4_DATAST_3
 ((
ut32_t
)0x00000800

	)

4801 
	#FSMC_BTR4_BUSTURN
 ((
ut32_t
)0x000F0000

	)

4802 
	#FSMC_BTR4_BUSTURN_0
 ((
ut32_t
)0x00010000

	)

4803 
	#FSMC_BTR4_BUSTURN_1
 ((
ut32_t
)0x00020000

	)

4804 
	#FSMC_BTR4_BUSTURN_2
 ((
ut32_t
)0x00040000

	)

4805 
	#FSMC_BTR4_BUSTURN_3
 ((
ut32_t
)0x00080000

	)

4807 
	#FSMC_BTR4_CLKDIV
 ((
ut32_t
)0x00F00000

	)

4808 
	#FSMC_BTR4_CLKDIV_0
 ((
ut32_t
)0x00100000

	)

4809 
	#FSMC_BTR4_CLKDIV_1
 ((
ut32_t
)0x00200000

	)

4810 
	#FSMC_BTR4_CLKDIV_2
 ((
ut32_t
)0x00400000

	)

4811 
	#FSMC_BTR4_CLKDIV_3
 ((
ut32_t
)0x00800000

	)

4813 
	#FSMC_BTR4_DATLAT
 ((
ut32_t
)0x0F000000

	)

4814 
	#FSMC_BTR4_DATLAT_0
 ((
ut32_t
)0x01000000

	)

4815 
	#FSMC_BTR4_DATLAT_1
 ((
ut32_t
)0x02000000

	)

4816 
	#FSMC_BTR4_DATLAT_2
 ((
ut32_t
)0x04000000

	)

4817 
	#FSMC_BTR4_DATLAT_3
 ((
ut32_t
)0x08000000

	)

4819 
	#FSMC_BTR4_ACCMOD
 ((
ut32_t
)0x30000000

	)

4820 
	#FSMC_BTR4_ACCMOD_0
 ((
ut32_t
)0x10000000

	)

4821 
	#FSMC_BTR4_ACCMOD_1
 ((
ut32_t
)0x20000000

	)

4824 
	#FSMC_BWTR1_ADDSET
 ((
ut32_t
)0x0000000F

	)

4825 
	#FSMC_BWTR1_ADDSET_0
 ((
ut32_t
)0x00000001

	)

4826 
	#FSMC_BWTR1_ADDSET_1
 ((
ut32_t
)0x00000002

	)

4827 
	#FSMC_BWTR1_ADDSET_2
 ((
ut32_t
)0x00000004

	)

4828 
	#FSMC_BWTR1_ADDSET_3
 ((
ut32_t
)0x00000008

	)

4830 
	#FSMC_BWTR1_ADDHLD
 ((
ut32_t
)0x000000F0

	)

4831 
	#FSMC_BWTR1_ADDHLD_0
 ((
ut32_t
)0x00000010

	)

4832 
	#FSMC_BWTR1_ADDHLD_1
 ((
ut32_t
)0x00000020

	)

4833 
	#FSMC_BWTR1_ADDHLD_2
 ((
ut32_t
)0x00000040

	)

4834 
	#FSMC_BWTR1_ADDHLD_3
 ((
ut32_t
)0x00000080

	)

4836 
	#FSMC_BWTR1_DATAST
 ((
ut32_t
)0x0000FF00

	)

4837 
	#FSMC_BWTR1_DATAST_0
 ((
ut32_t
)0x00000100

	)

4838 
	#FSMC_BWTR1_DATAST_1
 ((
ut32_t
)0x00000200

	)

4839 
	#FSMC_BWTR1_DATAST_2
 ((
ut32_t
)0x00000400

	)

4840 
	#FSMC_BWTR1_DATAST_3
 ((
ut32_t
)0x00000800

	)

4842 
	#FSMC_BWTR1_CLKDIV
 ((
ut32_t
)0x00F00000

	)

4843 
	#FSMC_BWTR1_CLKDIV_0
 ((
ut32_t
)0x00100000

	)

4844 
	#FSMC_BWTR1_CLKDIV_1
 ((
ut32_t
)0x00200000

	)

4845 
	#FSMC_BWTR1_CLKDIV_2
 ((
ut32_t
)0x00400000

	)

4846 
	#FSMC_BWTR1_CLKDIV_3
 ((
ut32_t
)0x00800000

	)

4848 
	#FSMC_BWTR1_DATLAT
 ((
ut32_t
)0x0F000000

	)

4849 
	#FSMC_BWTR1_DATLAT_0
 ((
ut32_t
)0x01000000

	)

4850 
	#FSMC_BWTR1_DATLAT_1
 ((
ut32_t
)0x02000000

	)

4851 
	#FSMC_BWTR1_DATLAT_2
 ((
ut32_t
)0x04000000

	)

4852 
	#FSMC_BWTR1_DATLAT_3
 ((
ut32_t
)0x08000000

	)

4854 
	#FSMC_BWTR1_ACCMOD
 ((
ut32_t
)0x30000000

	)

4855 
	#FSMC_BWTR1_ACCMOD_0
 ((
ut32_t
)0x10000000

	)

4856 
	#FSMC_BWTR1_ACCMOD_1
 ((
ut32_t
)0x20000000

	)

4859 
	#FSMC_BWTR2_ADDSET
 ((
ut32_t
)0x0000000F

	)

4860 
	#FSMC_BWTR2_ADDSET_0
 ((
ut32_t
)0x00000001

	)

4861 
	#FSMC_BWTR2_ADDSET_1
 ((
ut32_t
)0x00000002

	)

4862 
	#FSMC_BWTR2_ADDSET_2
 ((
ut32_t
)0x00000004

	)

4863 
	#FSMC_BWTR2_ADDSET_3
 ((
ut32_t
)0x00000008

	)

4865 
	#FSMC_BWTR2_ADDHLD
 ((
ut32_t
)0x000000F0

	)

4866 
	#FSMC_BWTR2_ADDHLD_0
 ((
ut32_t
)0x00000010

	)

4867 
	#FSMC_BWTR2_ADDHLD_1
 ((
ut32_t
)0x00000020

	)

4868 
	#FSMC_BWTR2_ADDHLD_2
 ((
ut32_t
)0x00000040

	)

4869 
	#FSMC_BWTR2_ADDHLD_3
 ((
ut32_t
)0x00000080

	)

4871 
	#FSMC_BWTR2_DATAST
 ((
ut32_t
)0x0000FF00

	)

4872 
	#FSMC_BWTR2_DATAST_0
 ((
ut32_t
)0x00000100

	)

4873 
	#FSMC_BWTR2_DATAST_1
 ((
ut32_t
)0x00000200

	)

4874 
	#FSMC_BWTR2_DATAST_2
 ((
ut32_t
)0x00000400

	)

4875 
	#FSMC_BWTR2_DATAST_3
 ((
ut32_t
)0x00000800

	)

4877 
	#FSMC_BWTR2_CLKDIV
 ((
ut32_t
)0x00F00000

	)

4878 
	#FSMC_BWTR2_CLKDIV_0
 ((
ut32_t
)0x00100000

	)

4879 
	#FSMC_BWTR2_CLKDIV_1
 ((
ut32_t
)0x00200000

	)

4880 
	#FSMC_BWTR2_CLKDIV_2
 ((
ut32_t
)0x00400000

	)

4881 
	#FSMC_BWTR2_CLKDIV_3
 ((
ut32_t
)0x00800000

	)

4883 
	#FSMC_BWTR2_DATLAT
 ((
ut32_t
)0x0F000000

	)

4884 
	#FSMC_BWTR2_DATLAT_0
 ((
ut32_t
)0x01000000

	)

4885 
	#FSMC_BWTR2_DATLAT_1
 ((
ut32_t
)0x02000000

	)

4886 
	#FSMC_BWTR2_DATLAT_2
 ((
ut32_t
)0x04000000

	)

4887 
	#FSMC_BWTR2_DATLAT_3
 ((
ut32_t
)0x08000000

	)

4889 
	#FSMC_BWTR2_ACCMOD
 ((
ut32_t
)0x30000000

	)

4890 
	#FSMC_BWTR2_ACCMOD_0
 ((
ut32_t
)0x10000000

	)

4891 
	#FSMC_BWTR2_ACCMOD_1
 ((
ut32_t
)0x20000000

	)

4894 
	#FSMC_BWTR3_ADDSET
 ((
ut32_t
)0x0000000F

	)

4895 
	#FSMC_BWTR3_ADDSET_0
 ((
ut32_t
)0x00000001

	)

4896 
	#FSMC_BWTR3_ADDSET_1
 ((
ut32_t
)0x00000002

	)

4897 
	#FSMC_BWTR3_ADDSET_2
 ((
ut32_t
)0x00000004

	)

4898 
	#FSMC_BWTR3_ADDSET_3
 ((
ut32_t
)0x00000008

	)

4900 
	#FSMC_BWTR3_ADDHLD
 ((
ut32_t
)0x000000F0

	)

4901 
	#FSMC_BWTR3_ADDHLD_0
 ((
ut32_t
)0x00000010

	)

4902 
	#FSMC_BWTR3_ADDHLD_1
 ((
ut32_t
)0x00000020

	)

4903 
	#FSMC_BWTR3_ADDHLD_2
 ((
ut32_t
)0x00000040

	)

4904 
	#FSMC_BWTR3_ADDHLD_3
 ((
ut32_t
)0x00000080

	)

4906 
	#FSMC_BWTR3_DATAST
 ((
ut32_t
)0x0000FF00

	)

4907 
	#FSMC_BWTR3_DATAST_0
 ((
ut32_t
)0x00000100

	)

4908 
	#FSMC_BWTR3_DATAST_1
 ((
ut32_t
)0x00000200

	)

4909 
	#FSMC_BWTR3_DATAST_2
 ((
ut32_t
)0x00000400

	)

4910 
	#FSMC_BWTR3_DATAST_3
 ((
ut32_t
)0x00000800

	)

4912 
	#FSMC_BWTR3_CLKDIV
 ((
ut32_t
)0x00F00000

	)

4913 
	#FSMC_BWTR3_CLKDIV_0
 ((
ut32_t
)0x00100000

	)

4914 
	#FSMC_BWTR3_CLKDIV_1
 ((
ut32_t
)0x00200000

	)

4915 
	#FSMC_BWTR3_CLKDIV_2
 ((
ut32_t
)0x00400000

	)

4916 
	#FSMC_BWTR3_CLKDIV_3
 ((
ut32_t
)0x00800000

	)

4918 
	#FSMC_BWTR3_DATLAT
 ((
ut32_t
)0x0F000000

	)

4919 
	#FSMC_BWTR3_DATLAT_0
 ((
ut32_t
)0x01000000

	)

4920 
	#FSMC_BWTR3_DATLAT_1
 ((
ut32_t
)0x02000000

	)

4921 
	#FSMC_BWTR3_DATLAT_2
 ((
ut32_t
)0x04000000

	)

4922 
	#FSMC_BWTR3_DATLAT_3
 ((
ut32_t
)0x08000000

	)

4924 
	#FSMC_BWTR3_ACCMOD
 ((
ut32_t
)0x30000000

	)

4925 
	#FSMC_BWTR3_ACCMOD_0
 ((
ut32_t
)0x10000000

	)

4926 
	#FSMC_BWTR3_ACCMOD_1
 ((
ut32_t
)0x20000000

	)

4929 
	#FSMC_BWTR4_ADDSET
 ((
ut32_t
)0x0000000F

	)

4930 
	#FSMC_BWTR4_ADDSET_0
 ((
ut32_t
)0x00000001

	)

4931 
	#FSMC_BWTR4_ADDSET_1
 ((
ut32_t
)0x00000002

	)

4932 
	#FSMC_BWTR4_ADDSET_2
 ((
ut32_t
)0x00000004

	)

4933 
	#FSMC_BWTR4_ADDSET_3
 ((
ut32_t
)0x00000008

	)

4935 
	#FSMC_BWTR4_ADDHLD
 ((
ut32_t
)0x000000F0

	)

4936 
	#FSMC_BWTR4_ADDHLD_0
 ((
ut32_t
)0x00000010

	)

4937 
	#FSMC_BWTR4_ADDHLD_1
 ((
ut32_t
)0x00000020

	)

4938 
	#FSMC_BWTR4_ADDHLD_2
 ((
ut32_t
)0x00000040

	)

4939 
	#FSMC_BWTR4_ADDHLD_3
 ((
ut32_t
)0x00000080

	)

4941 
	#FSMC_BWTR4_DATAST
 ((
ut32_t
)0x0000FF00

	)

4942 
	#FSMC_BWTR4_DATAST_0
 ((
ut32_t
)0x00000100

	)

4943 
	#FSMC_BWTR4_DATAST_1
 ((
ut32_t
)0x00000200

	)

4944 
	#FSMC_BWTR4_DATAST_2
 ((
ut32_t
)0x00000400

	)

4945 
	#FSMC_BWTR4_DATAST_3
 ((
ut32_t
)0x00000800

	)

4947 
	#FSMC_BWTR4_CLKDIV
 ((
ut32_t
)0x00F00000

	)

4948 
	#FSMC_BWTR4_CLKDIV_0
 ((
ut32_t
)0x00100000

	)

4949 
	#FSMC_BWTR4_CLKDIV_1
 ((
ut32_t
)0x00200000

	)

4950 
	#FSMC_BWTR4_CLKDIV_2
 ((
ut32_t
)0x00400000

	)

4951 
	#FSMC_BWTR4_CLKDIV_3
 ((
ut32_t
)0x00800000

	)

4953 
	#FSMC_BWTR4_DATLAT
 ((
ut32_t
)0x0F000000

	)

4954 
	#FSMC_BWTR4_DATLAT_0
 ((
ut32_t
)0x01000000

	)

4955 
	#FSMC_BWTR4_DATLAT_1
 ((
ut32_t
)0x02000000

	)

4956 
	#FSMC_BWTR4_DATLAT_2
 ((
ut32_t
)0x04000000

	)

4957 
	#FSMC_BWTR4_DATLAT_3
 ((
ut32_t
)0x08000000

	)

4959 
	#FSMC_BWTR4_ACCMOD
 ((
ut32_t
)0x30000000

	)

4960 
	#FSMC_BWTR4_ACCMOD_0
 ((
ut32_t
)0x10000000

	)

4961 
	#FSMC_BWTR4_ACCMOD_1
 ((
ut32_t
)0x20000000

	)

4964 
	#FSMC_PCR2_PWAITEN
 ((
ut32_t
)0x00000002

	)

4965 
	#FSMC_PCR2_PBKEN
 ((
ut32_t
)0x00000004

	)

4966 
	#FSMC_PCR2_PTYP
 ((
ut32_t
)0x00000008

	)

4968 
	#FSMC_PCR2_PWID
 ((
ut32_t
)0x00000030

	)

4969 
	#FSMC_PCR2_PWID_0
 ((
ut32_t
)0x00000010

	)

4970 
	#FSMC_PCR2_PWID_1
 ((
ut32_t
)0x00000020

	)

4972 
	#FSMC_PCR2_ECCEN
 ((
ut32_t
)0x00000040

	)

4974 
	#FSMC_PCR2_TCLR
 ((
ut32_t
)0x00001E00

	)

4975 
	#FSMC_PCR2_TCLR_0
 ((
ut32_t
)0x00000200

	)

4976 
	#FSMC_PCR2_TCLR_1
 ((
ut32_t
)0x00000400

	)

4977 
	#FSMC_PCR2_TCLR_2
 ((
ut32_t
)0x00000800

	)

4978 
	#FSMC_PCR2_TCLR_3
 ((
ut32_t
)0x00001000

	)

4980 
	#FSMC_PCR2_TAR
 ((
ut32_t
)0x0001E000

	)

4981 
	#FSMC_PCR2_TAR_0
 ((
ut32_t
)0x00002000

	)

4982 
	#FSMC_PCR2_TAR_1
 ((
ut32_t
)0x00004000

	)

4983 
	#FSMC_PCR2_TAR_2
 ((
ut32_t
)0x00008000

	)

4984 
	#FSMC_PCR2_TAR_3
 ((
ut32_t
)0x00010000

	)

4986 
	#FSMC_PCR2_ECCPS
 ((
ut32_t
)0x000E0000

	)

4987 
	#FSMC_PCR2_ECCPS_0
 ((
ut32_t
)0x00020000

	)

4988 
	#FSMC_PCR2_ECCPS_1
 ((
ut32_t
)0x00040000

	)

4989 
	#FSMC_PCR2_ECCPS_2
 ((
ut32_t
)0x00080000

	)

4992 
	#FSMC_PCR3_PWAITEN
 ((
ut32_t
)0x00000002

	)

4993 
	#FSMC_PCR3_PBKEN
 ((
ut32_t
)0x00000004

	)

4994 
	#FSMC_PCR3_PTYP
 ((
ut32_t
)0x00000008

	)

4996 
	#FSMC_PCR3_PWID
 ((
ut32_t
)0x00000030

	)

4997 
	#FSMC_PCR3_PWID_0
 ((
ut32_t
)0x00000010

	)

4998 
	#FSMC_PCR3_PWID_1
 ((
ut32_t
)0x00000020

	)

5000 
	#FSMC_PCR3_ECCEN
 ((
ut32_t
)0x00000040

	)

5002 
	#FSMC_PCR3_TCLR
 ((
ut32_t
)0x00001E00

	)

5003 
	#FSMC_PCR3_TCLR_0
 ((
ut32_t
)0x00000200

	)

5004 
	#FSMC_PCR3_TCLR_1
 ((
ut32_t
)0x00000400

	)

5005 
	#FSMC_PCR3_TCLR_2
 ((
ut32_t
)0x00000800

	)

5006 
	#FSMC_PCR3_TCLR_3
 ((
ut32_t
)0x00001000

	)

5008 
	#FSMC_PCR3_TAR
 ((
ut32_t
)0x0001E000

	)

5009 
	#FSMC_PCR3_TAR_0
 ((
ut32_t
)0x00002000

	)

5010 
	#FSMC_PCR3_TAR_1
 ((
ut32_t
)0x00004000

	)

5011 
	#FSMC_PCR3_TAR_2
 ((
ut32_t
)0x00008000

	)

5012 
	#FSMC_PCR3_TAR_3
 ((
ut32_t
)0x00010000

	)

5014 
	#FSMC_PCR3_ECCPS
 ((
ut32_t
)0x000E0000

	)

5015 
	#FSMC_PCR3_ECCPS_0
 ((
ut32_t
)0x00020000

	)

5016 
	#FSMC_PCR3_ECCPS_1
 ((
ut32_t
)0x00040000

	)

5017 
	#FSMC_PCR3_ECCPS_2
 ((
ut32_t
)0x00080000

	)

5020 
	#FSMC_PCR4_PWAITEN
 ((
ut32_t
)0x00000002

	)

5021 
	#FSMC_PCR4_PBKEN
 ((
ut32_t
)0x00000004

	)

5022 
	#FSMC_PCR4_PTYP
 ((
ut32_t
)0x00000008

	)

5024 
	#FSMC_PCR4_PWID
 ((
ut32_t
)0x00000030

	)

5025 
	#FSMC_PCR4_PWID_0
 ((
ut32_t
)0x00000010

	)

5026 
	#FSMC_PCR4_PWID_1
 ((
ut32_t
)0x00000020

	)

5028 
	#FSMC_PCR4_ECCEN
 ((
ut32_t
)0x00000040

	)

5030 
	#FSMC_PCR4_TCLR
 ((
ut32_t
)0x00001E00

	)

5031 
	#FSMC_PCR4_TCLR_0
 ((
ut32_t
)0x00000200

	)

5032 
	#FSMC_PCR4_TCLR_1
 ((
ut32_t
)0x00000400

	)

5033 
	#FSMC_PCR4_TCLR_2
 ((
ut32_t
)0x00000800

	)

5034 
	#FSMC_PCR4_TCLR_3
 ((
ut32_t
)0x00001000

	)

5036 
	#FSMC_PCR4_TAR
 ((
ut32_t
)0x0001E000

	)

5037 
	#FSMC_PCR4_TAR_0
 ((
ut32_t
)0x00002000

	)

5038 
	#FSMC_PCR4_TAR_1
 ((
ut32_t
)0x00004000

	)

5039 
	#FSMC_PCR4_TAR_2
 ((
ut32_t
)0x00008000

	)

5040 
	#FSMC_PCR4_TAR_3
 ((
ut32_t
)0x00010000

	)

5042 
	#FSMC_PCR4_ECCPS
 ((
ut32_t
)0x000E0000

	)

5043 
	#FSMC_PCR4_ECCPS_0
 ((
ut32_t
)0x00020000

	)

5044 
	#FSMC_PCR4_ECCPS_1
 ((
ut32_t
)0x00040000

	)

5045 
	#FSMC_PCR4_ECCPS_2
 ((
ut32_t
)0x00080000

	)

5048 
	#FSMC_SR2_IRS
 ((
ut8_t
)0x01

	)

5049 
	#FSMC_SR2_ILS
 ((
ut8_t
)0x02

	)

5050 
	#FSMC_SR2_IFS
 ((
ut8_t
)0x04

	)

5051 
	#FSMC_SR2_IREN
 ((
ut8_t
)0x08

	)

5052 
	#FSMC_SR2_ILEN
 ((
ut8_t
)0x10

	)

5053 
	#FSMC_SR2_IFEN
 ((
ut8_t
)0x20

	)

5054 
	#FSMC_SR2_FEMPT
 ((
ut8_t
)0x40

	)

5057 
	#FSMC_SR3_IRS
 ((
ut8_t
)0x01

	)

5058 
	#FSMC_SR3_ILS
 ((
ut8_t
)0x02

	)

5059 
	#FSMC_SR3_IFS
 ((
ut8_t
)0x04

	)

5060 
	#FSMC_SR3_IREN
 ((
ut8_t
)0x08

	)

5061 
	#FSMC_SR3_ILEN
 ((
ut8_t
)0x10

	)

5062 
	#FSMC_SR3_IFEN
 ((
ut8_t
)0x20

	)

5063 
	#FSMC_SR3_FEMPT
 ((
ut8_t
)0x40

	)

5066 
	#FSMC_SR4_IRS
 ((
ut8_t
)0x01

	)

5067 
	#FSMC_SR4_ILS
 ((
ut8_t
)0x02

	)

5068 
	#FSMC_SR4_IFS
 ((
ut8_t
)0x04

	)

5069 
	#FSMC_SR4_IREN
 ((
ut8_t
)0x08

	)

5070 
	#FSMC_SR4_ILEN
 ((
ut8_t
)0x10

	)

5071 
	#FSMC_SR4_IFEN
 ((
ut8_t
)0x20

	)

5072 
	#FSMC_SR4_FEMPT
 ((
ut8_t
)0x40

	)

5075 
	#FSMC_PMEM2_MEMSET2
 ((
ut32_t
)0x000000FF

	)

5076 
	#FSMC_PMEM2_MEMSET2_0
 ((
ut32_t
)0x00000001

	)

5077 
	#FSMC_PMEM2_MEMSET2_1
 ((
ut32_t
)0x00000002

	)

5078 
	#FSMC_PMEM2_MEMSET2_2
 ((
ut32_t
)0x00000004

	)

5079 
	#FSMC_PMEM2_MEMSET2_3
 ((
ut32_t
)0x00000008

	)

5080 
	#FSMC_PMEM2_MEMSET2_4
 ((
ut32_t
)0x00000010

	)

5081 
	#FSMC_PMEM2_MEMSET2_5
 ((
ut32_t
)0x00000020

	)

5082 
	#FSMC_PMEM2_MEMSET2_6
 ((
ut32_t
)0x00000040

	)

5083 
	#FSMC_PMEM2_MEMSET2_7
 ((
ut32_t
)0x00000080

	)

5085 
	#FSMC_PMEM2_MEMWAIT2
 ((
ut32_t
)0x0000FF00

	)

5086 
	#FSMC_PMEM2_MEMWAIT2_0
 ((
ut32_t
)0x00000100

	)

5087 
	#FSMC_PMEM2_MEMWAIT2_1
 ((
ut32_t
)0x00000200

	)

5088 
	#FSMC_PMEM2_MEMWAIT2_2
 ((
ut32_t
)0x00000400

	)

5089 
	#FSMC_PMEM2_MEMWAIT2_3
 ((
ut32_t
)0x00000800

	)

5090 
	#FSMC_PMEM2_MEMWAIT2_4
 ((
ut32_t
)0x00001000

	)

5091 
	#FSMC_PMEM2_MEMWAIT2_5
 ((
ut32_t
)0x00002000

	)

5092 
	#FSMC_PMEM2_MEMWAIT2_6
 ((
ut32_t
)0x00004000

	)

5093 
	#FSMC_PMEM2_MEMWAIT2_7
 ((
ut32_t
)0x00008000

	)

5095 
	#FSMC_PMEM2_MEMHOLD2
 ((
ut32_t
)0x00FF0000

	)

5096 
	#FSMC_PMEM2_MEMHOLD2_0
 ((
ut32_t
)0x00010000

	)

5097 
	#FSMC_PMEM2_MEMHOLD2_1
 ((
ut32_t
)0x00020000

	)

5098 
	#FSMC_PMEM2_MEMHOLD2_2
 ((
ut32_t
)0x00040000

	)

5099 
	#FSMC_PMEM2_MEMHOLD2_3
 ((
ut32_t
)0x00080000

	)

5100 
	#FSMC_PMEM2_MEMHOLD2_4
 ((
ut32_t
)0x00100000

	)

5101 
	#FSMC_PMEM2_MEMHOLD2_5
 ((
ut32_t
)0x00200000

	)

5102 
	#FSMC_PMEM2_MEMHOLD2_6
 ((
ut32_t
)0x00400000

	)

5103 
	#FSMC_PMEM2_MEMHOLD2_7
 ((
ut32_t
)0x00800000

	)

5105 
	#FSMC_PMEM2_MEMHIZ2
 ((
ut32_t
)0xFF000000

	)

5106 
	#FSMC_PMEM2_MEMHIZ2_0
 ((
ut32_t
)0x01000000

	)

5107 
	#FSMC_PMEM2_MEMHIZ2_1
 ((
ut32_t
)0x02000000

	)

5108 
	#FSMC_PMEM2_MEMHIZ2_2
 ((
ut32_t
)0x04000000

	)

5109 
	#FSMC_PMEM2_MEMHIZ2_3
 ((
ut32_t
)0x08000000

	)

5110 
	#FSMC_PMEM2_MEMHIZ2_4
 ((
ut32_t
)0x10000000

	)

5111 
	#FSMC_PMEM2_MEMHIZ2_5
 ((
ut32_t
)0x20000000

	)

5112 
	#FSMC_PMEM2_MEMHIZ2_6
 ((
ut32_t
)0x40000000

	)

5113 
	#FSMC_PMEM2_MEMHIZ2_7
 ((
ut32_t
)0x80000000

	)

5116 
	#FSMC_PMEM3_MEMSET3
 ((
ut32_t
)0x000000FF

	)

5117 
	#FSMC_PMEM3_MEMSET3_0
 ((
ut32_t
)0x00000001

	)

5118 
	#FSMC_PMEM3_MEMSET3_1
 ((
ut32_t
)0x00000002

	)

5119 
	#FSMC_PMEM3_MEMSET3_2
 ((
ut32_t
)0x00000004

	)

5120 
	#FSMC_PMEM3_MEMSET3_3
 ((
ut32_t
)0x00000008

	)

5121 
	#FSMC_PMEM3_MEMSET3_4
 ((
ut32_t
)0x00000010

	)

5122 
	#FSMC_PMEM3_MEMSET3_5
 ((
ut32_t
)0x00000020

	)

5123 
	#FSMC_PMEM3_MEMSET3_6
 ((
ut32_t
)0x00000040

	)

5124 
	#FSMC_PMEM3_MEMSET3_7
 ((
ut32_t
)0x00000080

	)

5126 
	#FSMC_PMEM3_MEMWAIT3
 ((
ut32_t
)0x0000FF00

	)

5127 
	#FSMC_PMEM3_MEMWAIT3_0
 ((
ut32_t
)0x00000100

	)

5128 
	#FSMC_PMEM3_MEMWAIT3_1
 ((
ut32_t
)0x00000200

	)

5129 
	#FSMC_PMEM3_MEMWAIT3_2
 ((
ut32_t
)0x00000400

	)

5130 
	#FSMC_PMEM3_MEMWAIT3_3
 ((
ut32_t
)0x00000800

	)

5131 
	#FSMC_PMEM3_MEMWAIT3_4
 ((
ut32_t
)0x00001000

	)

5132 
	#FSMC_PMEM3_MEMWAIT3_5
 ((
ut32_t
)0x00002000

	)

5133 
	#FSMC_PMEM3_MEMWAIT3_6
 ((
ut32_t
)0x00004000

	)

5134 
	#FSMC_PMEM3_MEMWAIT3_7
 ((
ut32_t
)0x00008000

	)

5136 
	#FSMC_PMEM3_MEMHOLD3
 ((
ut32_t
)0x00FF0000

	)

5137 
	#FSMC_PMEM3_MEMHOLD3_0
 ((
ut32_t
)0x00010000

	)

5138 
	#FSMC_PMEM3_MEMHOLD3_1
 ((
ut32_t
)0x00020000

	)

5139 
	#FSMC_PMEM3_MEMHOLD3_2
 ((
ut32_t
)0x00040000

	)

5140 
	#FSMC_PMEM3_MEMHOLD3_3
 ((
ut32_t
)0x00080000

	)

5141 
	#FSMC_PMEM3_MEMHOLD3_4
 ((
ut32_t
)0x00100000

	)

5142 
	#FSMC_PMEM3_MEMHOLD3_5
 ((
ut32_t
)0x00200000

	)

5143 
	#FSMC_PMEM3_MEMHOLD3_6
 ((
ut32_t
)0x00400000

	)

5144 
	#FSMC_PMEM3_MEMHOLD3_7
 ((
ut32_t
)0x00800000

	)

5146 
	#FSMC_PMEM3_MEMHIZ3
 ((
ut32_t
)0xFF000000

	)

5147 
	#FSMC_PMEM3_MEMHIZ3_0
 ((
ut32_t
)0x01000000

	)

5148 
	#FSMC_PMEM3_MEMHIZ3_1
 ((
ut32_t
)0x02000000

	)

5149 
	#FSMC_PMEM3_MEMHIZ3_2
 ((
ut32_t
)0x04000000

	)

5150 
	#FSMC_PMEM3_MEMHIZ3_3
 ((
ut32_t
)0x08000000

	)

5151 
	#FSMC_PMEM3_MEMHIZ3_4
 ((
ut32_t
)0x10000000

	)

5152 
	#FSMC_PMEM3_MEMHIZ3_5
 ((
ut32_t
)0x20000000

	)

5153 
	#FSMC_PMEM3_MEMHIZ3_6
 ((
ut32_t
)0x40000000

	)

5154 
	#FSMC_PMEM3_MEMHIZ3_7
 ((
ut32_t
)0x80000000

	)

5157 
	#FSMC_PMEM4_MEMSET4
 ((
ut32_t
)0x000000FF

	)

5158 
	#FSMC_PMEM4_MEMSET4_0
 ((
ut32_t
)0x00000001

	)

5159 
	#FSMC_PMEM4_MEMSET4_1
 ((
ut32_t
)0x00000002

	)

5160 
	#FSMC_PMEM4_MEMSET4_2
 ((
ut32_t
)0x00000004

	)

5161 
	#FSMC_PMEM4_MEMSET4_3
 ((
ut32_t
)0x00000008

	)

5162 
	#FSMC_PMEM4_MEMSET4_4
 ((
ut32_t
)0x00000010

	)

5163 
	#FSMC_PMEM4_MEMSET4_5
 ((
ut32_t
)0x00000020

	)

5164 
	#FSMC_PMEM4_MEMSET4_6
 ((
ut32_t
)0x00000040

	)

5165 
	#FSMC_PMEM4_MEMSET4_7
 ((
ut32_t
)0x00000080

	)

5167 
	#FSMC_PMEM4_MEMWAIT4
 ((
ut32_t
)0x0000FF00

	)

5168 
	#FSMC_PMEM4_MEMWAIT4_0
 ((
ut32_t
)0x00000100

	)

5169 
	#FSMC_PMEM4_MEMWAIT4_1
 ((
ut32_t
)0x00000200

	)

5170 
	#FSMC_PMEM4_MEMWAIT4_2
 ((
ut32_t
)0x00000400

	)

5171 
	#FSMC_PMEM4_MEMWAIT4_3
 ((
ut32_t
)0x00000800

	)

5172 
	#FSMC_PMEM4_MEMWAIT4_4
 ((
ut32_t
)0x00001000

	)

5173 
	#FSMC_PMEM4_MEMWAIT4_5
 ((
ut32_t
)0x00002000

	)

5174 
	#FSMC_PMEM4_MEMWAIT4_6
 ((
ut32_t
)0x00004000

	)

5175 
	#FSMC_PMEM4_MEMWAIT4_7
 ((
ut32_t
)0x00008000

	)

5177 
	#FSMC_PMEM4_MEMHOLD4
 ((
ut32_t
)0x00FF0000

	)

5178 
	#FSMC_PMEM4_MEMHOLD4_0
 ((
ut32_t
)0x00010000

	)

5179 
	#FSMC_PMEM4_MEMHOLD4_1
 ((
ut32_t
)0x00020000

	)

5180 
	#FSMC_PMEM4_MEMHOLD4_2
 ((
ut32_t
)0x00040000

	)

5181 
	#FSMC_PMEM4_MEMHOLD4_3
 ((
ut32_t
)0x00080000

	)

5182 
	#FSMC_PMEM4_MEMHOLD4_4
 ((
ut32_t
)0x00100000

	)

5183 
	#FSMC_PMEM4_MEMHOLD4_5
 ((
ut32_t
)0x00200000

	)

5184 
	#FSMC_PMEM4_MEMHOLD4_6
 ((
ut32_t
)0x00400000

	)

5185 
	#FSMC_PMEM4_MEMHOLD4_7
 ((
ut32_t
)0x00800000

	)

5187 
	#FSMC_PMEM4_MEMHIZ4
 ((
ut32_t
)0xFF000000

	)

5188 
	#FSMC_PMEM4_MEMHIZ4_0
 ((
ut32_t
)0x01000000

	)

5189 
	#FSMC_PMEM4_MEMHIZ4_1
 ((
ut32_t
)0x02000000

	)

5190 
	#FSMC_PMEM4_MEMHIZ4_2
 ((
ut32_t
)0x04000000

	)

5191 
	#FSMC_PMEM4_MEMHIZ4_3
 ((
ut32_t
)0x08000000

	)

5192 
	#FSMC_PMEM4_MEMHIZ4_4
 ((
ut32_t
)0x10000000

	)

5193 
	#FSMC_PMEM4_MEMHIZ4_5
 ((
ut32_t
)0x20000000

	)

5194 
	#FSMC_PMEM4_MEMHIZ4_6
 ((
ut32_t
)0x40000000

	)

5195 
	#FSMC_PMEM4_MEMHIZ4_7
 ((
ut32_t
)0x80000000

	)

5198 
	#FSMC_PATT2_ATTSET2
 ((
ut32_t
)0x000000FF

	)

5199 
	#FSMC_PATT2_ATTSET2_0
 ((
ut32_t
)0x00000001

	)

5200 
	#FSMC_PATT2_ATTSET2_1
 ((
ut32_t
)0x00000002

	)

5201 
	#FSMC_PATT2_ATTSET2_2
 ((
ut32_t
)0x00000004

	)

5202 
	#FSMC_PATT2_ATTSET2_3
 ((
ut32_t
)0x00000008

	)

5203 
	#FSMC_PATT2_ATTSET2_4
 ((
ut32_t
)0x00000010

	)

5204 
	#FSMC_PATT2_ATTSET2_5
 ((
ut32_t
)0x00000020

	)

5205 
	#FSMC_PATT2_ATTSET2_6
 ((
ut32_t
)0x00000040

	)

5206 
	#FSMC_PATT2_ATTSET2_7
 ((
ut32_t
)0x00000080

	)

5208 
	#FSMC_PATT2_ATTWAIT2
 ((
ut32_t
)0x0000FF00

	)

5209 
	#FSMC_PATT2_ATTWAIT2_0
 ((
ut32_t
)0x00000100

	)

5210 
	#FSMC_PATT2_ATTWAIT2_1
 ((
ut32_t
)0x00000200

	)

5211 
	#FSMC_PATT2_ATTWAIT2_2
 ((
ut32_t
)0x00000400

	)

5212 
	#FSMC_PATT2_ATTWAIT2_3
 ((
ut32_t
)0x00000800

	)

5213 
	#FSMC_PATT2_ATTWAIT2_4
 ((
ut32_t
)0x00001000

	)

5214 
	#FSMC_PATT2_ATTWAIT2_5
 ((
ut32_t
)0x00002000

	)

5215 
	#FSMC_PATT2_ATTWAIT2_6
 ((
ut32_t
)0x00004000

	)

5216 
	#FSMC_PATT2_ATTWAIT2_7
 ((
ut32_t
)0x00008000

	)

5218 
	#FSMC_PATT2_ATTHOLD2
 ((
ut32_t
)0x00FF0000

	)

5219 
	#FSMC_PATT2_ATTHOLD2_0
 ((
ut32_t
)0x00010000

	)

5220 
	#FSMC_PATT2_ATTHOLD2_1
 ((
ut32_t
)0x00020000

	)

5221 
	#FSMC_PATT2_ATTHOLD2_2
 ((
ut32_t
)0x00040000

	)

5222 
	#FSMC_PATT2_ATTHOLD2_3
 ((
ut32_t
)0x00080000

	)

5223 
	#FSMC_PATT2_ATTHOLD2_4
 ((
ut32_t
)0x00100000

	)

5224 
	#FSMC_PATT2_ATTHOLD2_5
 ((
ut32_t
)0x00200000

	)

5225 
	#FSMC_PATT2_ATTHOLD2_6
 ((
ut32_t
)0x00400000

	)

5226 
	#FSMC_PATT2_ATTHOLD2_7
 ((
ut32_t
)0x00800000

	)

5228 
	#FSMC_PATT2_ATTHIZ2
 ((
ut32_t
)0xFF000000

	)

5229 
	#FSMC_PATT2_ATTHIZ2_0
 ((
ut32_t
)0x01000000

	)

5230 
	#FSMC_PATT2_ATTHIZ2_1
 ((
ut32_t
)0x02000000

	)

5231 
	#FSMC_PATT2_ATTHIZ2_2
 ((
ut32_t
)0x04000000

	)

5232 
	#FSMC_PATT2_ATTHIZ2_3
 ((
ut32_t
)0x08000000

	)

5233 
	#FSMC_PATT2_ATTHIZ2_4
 ((
ut32_t
)0x10000000

	)

5234 
	#FSMC_PATT2_ATTHIZ2_5
 ((
ut32_t
)0x20000000

	)

5235 
	#FSMC_PATT2_ATTHIZ2_6
 ((
ut32_t
)0x40000000

	)

5236 
	#FSMC_PATT2_ATTHIZ2_7
 ((
ut32_t
)0x80000000

	)

5239 
	#FSMC_PATT3_ATTSET3
 ((
ut32_t
)0x000000FF

	)

5240 
	#FSMC_PATT3_ATTSET3_0
 ((
ut32_t
)0x00000001

	)

5241 
	#FSMC_PATT3_ATTSET3_1
 ((
ut32_t
)0x00000002

	)

5242 
	#FSMC_PATT3_ATTSET3_2
 ((
ut32_t
)0x00000004

	)

5243 
	#FSMC_PATT3_ATTSET3_3
 ((
ut32_t
)0x00000008

	)

5244 
	#FSMC_PATT3_ATTSET3_4
 ((
ut32_t
)0x00000010

	)

5245 
	#FSMC_PATT3_ATTSET3_5
 ((
ut32_t
)0x00000020

	)

5246 
	#FSMC_PATT3_ATTSET3_6
 ((
ut32_t
)0x00000040

	)

5247 
	#FSMC_PATT3_ATTSET3_7
 ((
ut32_t
)0x00000080

	)

5249 
	#FSMC_PATT3_ATTWAIT3
 ((
ut32_t
)0x0000FF00

	)

5250 
	#FSMC_PATT3_ATTWAIT3_0
 ((
ut32_t
)0x00000100

	)

5251 
	#FSMC_PATT3_ATTWAIT3_1
 ((
ut32_t
)0x00000200

	)

5252 
	#FSMC_PATT3_ATTWAIT3_2
 ((
ut32_t
)0x00000400

	)

5253 
	#FSMC_PATT3_ATTWAIT3_3
 ((
ut32_t
)0x00000800

	)

5254 
	#FSMC_PATT3_ATTWAIT3_4
 ((
ut32_t
)0x00001000

	)

5255 
	#FSMC_PATT3_ATTWAIT3_5
 ((
ut32_t
)0x00002000

	)

5256 
	#FSMC_PATT3_ATTWAIT3_6
 ((
ut32_t
)0x00004000

	)

5257 
	#FSMC_PATT3_ATTWAIT3_7
 ((
ut32_t
)0x00008000

	)

5259 
	#FSMC_PATT3_ATTHOLD3
 ((
ut32_t
)0x00FF0000

	)

5260 
	#FSMC_PATT3_ATTHOLD3_0
 ((
ut32_t
)0x00010000

	)

5261 
	#FSMC_PATT3_ATTHOLD3_1
 ((
ut32_t
)0x00020000

	)

5262 
	#FSMC_PATT3_ATTHOLD3_2
 ((
ut32_t
)0x00040000

	)

5263 
	#FSMC_PATT3_ATTHOLD3_3
 ((
ut32_t
)0x00080000

	)

5264 
	#FSMC_PATT3_ATTHOLD3_4
 ((
ut32_t
)0x00100000

	)

5265 
	#FSMC_PATT3_ATTHOLD3_5
 ((
ut32_t
)0x00200000

	)

5266 
	#FSMC_PATT3_ATTHOLD3_6
 ((
ut32_t
)0x00400000

	)

5267 
	#FSMC_PATT3_ATTHOLD3_7
 ((
ut32_t
)0x00800000

	)

5269 
	#FSMC_PATT3_ATTHIZ3
 ((
ut32_t
)0xFF000000

	)

5270 
	#FSMC_PATT3_ATTHIZ3_0
 ((
ut32_t
)0x01000000

	)

5271 
	#FSMC_PATT3_ATTHIZ3_1
 ((
ut32_t
)0x02000000

	)

5272 
	#FSMC_PATT3_ATTHIZ3_2
 ((
ut32_t
)0x04000000

	)

5273 
	#FSMC_PATT3_ATTHIZ3_3
 ((
ut32_t
)0x08000000

	)

5274 
	#FSMC_PATT3_ATTHIZ3_4
 ((
ut32_t
)0x10000000

	)

5275 
	#FSMC_PATT3_ATTHIZ3_5
 ((
ut32_t
)0x20000000

	)

5276 
	#FSMC_PATT3_ATTHIZ3_6
 ((
ut32_t
)0x40000000

	)

5277 
	#FSMC_PATT3_ATTHIZ3_7
 ((
ut32_t
)0x80000000

	)

5280 
	#FSMC_PATT4_ATTSET4
 ((
ut32_t
)0x000000FF

	)

5281 
	#FSMC_PATT4_ATTSET4_0
 ((
ut32_t
)0x00000001

	)

5282 
	#FSMC_PATT4_ATTSET4_1
 ((
ut32_t
)0x00000002

	)

5283 
	#FSMC_PATT4_ATTSET4_2
 ((
ut32_t
)0x00000004

	)

5284 
	#FSMC_PATT4_ATTSET4_3
 ((
ut32_t
)0x00000008

	)

5285 
	#FSMC_PATT4_ATTSET4_4
 ((
ut32_t
)0x00000010

	)

5286 
	#FSMC_PATT4_ATTSET4_5
 ((
ut32_t
)0x00000020

	)

5287 
	#FSMC_PATT4_ATTSET4_6
 ((
ut32_t
)0x00000040

	)

5288 
	#FSMC_PATT4_ATTSET4_7
 ((
ut32_t
)0x00000080

	)

5290 
	#FSMC_PATT4_ATTWAIT4
 ((
ut32_t
)0x0000FF00

	)

5291 
	#FSMC_PATT4_ATTWAIT4_0
 ((
ut32_t
)0x00000100

	)

5292 
	#FSMC_PATT4_ATTWAIT4_1
 ((
ut32_t
)0x00000200

	)

5293 
	#FSMC_PATT4_ATTWAIT4_2
 ((
ut32_t
)0x00000400

	)

5294 
	#FSMC_PATT4_ATTWAIT4_3
 ((
ut32_t
)0x00000800

	)

5295 
	#FSMC_PATT4_ATTWAIT4_4
 ((
ut32_t
)0x00001000

	)

5296 
	#FSMC_PATT4_ATTWAIT4_5
 ((
ut32_t
)0x00002000

	)

5297 
	#FSMC_PATT4_ATTWAIT4_6
 ((
ut32_t
)0x00004000

	)

5298 
	#FSMC_PATT4_ATTWAIT4_7
 ((
ut32_t
)0x00008000

	)

5300 
	#FSMC_PATT4_ATTHOLD4
 ((
ut32_t
)0x00FF0000

	)

5301 
	#FSMC_PATT4_ATTHOLD4_0
 ((
ut32_t
)0x00010000

	)

5302 
	#FSMC_PATT4_ATTHOLD4_1
 ((
ut32_t
)0x00020000

	)

5303 
	#FSMC_PATT4_ATTHOLD4_2
 ((
ut32_t
)0x00040000

	)

5304 
	#FSMC_PATT4_ATTHOLD4_3
 ((
ut32_t
)0x00080000

	)

5305 
	#FSMC_PATT4_ATTHOLD4_4
 ((
ut32_t
)0x00100000

	)

5306 
	#FSMC_PATT4_ATTHOLD4_5
 ((
ut32_t
)0x00200000

	)

5307 
	#FSMC_PATT4_ATTHOLD4_6
 ((
ut32_t
)0x00400000

	)

5308 
	#FSMC_PATT4_ATTHOLD4_7
 ((
ut32_t
)0x00800000

	)

5310 
	#FSMC_PATT4_ATTHIZ4
 ((
ut32_t
)0xFF000000

	)

5311 
	#FSMC_PATT4_ATTHIZ4_0
 ((
ut32_t
)0x01000000

	)

5312 
	#FSMC_PATT4_ATTHIZ4_1
 ((
ut32_t
)0x02000000

	)

5313 
	#FSMC_PATT4_ATTHIZ4_2
 ((
ut32_t
)0x04000000

	)

5314 
	#FSMC_PATT4_ATTHIZ4_3
 ((
ut32_t
)0x08000000

	)

5315 
	#FSMC_PATT4_ATTHIZ4_4
 ((
ut32_t
)0x10000000

	)

5316 
	#FSMC_PATT4_ATTHIZ4_5
 ((
ut32_t
)0x20000000

	)

5317 
	#FSMC_PATT4_ATTHIZ4_6
 ((
ut32_t
)0x40000000

	)

5318 
	#FSMC_PATT4_ATTHIZ4_7
 ((
ut32_t
)0x80000000

	)

5321 
	#FSMC_PIO4_IOSET4
 ((
ut32_t
)0x000000FF

	)

5322 
	#FSMC_PIO4_IOSET4_0
 ((
ut32_t
)0x00000001

	)

5323 
	#FSMC_PIO4_IOSET4_1
 ((
ut32_t
)0x00000002

	)

5324 
	#FSMC_PIO4_IOSET4_2
 ((
ut32_t
)0x00000004

	)

5325 
	#FSMC_PIO4_IOSET4_3
 ((
ut32_t
)0x00000008

	)

5326 
	#FSMC_PIO4_IOSET4_4
 ((
ut32_t
)0x00000010

	)

5327 
	#FSMC_PIO4_IOSET4_5
 ((
ut32_t
)0x00000020

	)

5328 
	#FSMC_PIO4_IOSET4_6
 ((
ut32_t
)0x00000040

	)

5329 
	#FSMC_PIO4_IOSET4_7
 ((
ut32_t
)0x00000080

	)

5331 
	#FSMC_PIO4_IOWAIT4
 ((
ut32_t
)0x0000FF00

	)

5332 
	#FSMC_PIO4_IOWAIT4_0
 ((
ut32_t
)0x00000100

	)

5333 
	#FSMC_PIO4_IOWAIT4_1
 ((
ut32_t
)0x00000200

	)

5334 
	#FSMC_PIO4_IOWAIT4_2
 ((
ut32_t
)0x00000400

	)

5335 
	#FSMC_PIO4_IOWAIT4_3
 ((
ut32_t
)0x00000800

	)

5336 
	#FSMC_PIO4_IOWAIT4_4
 ((
ut32_t
)0x00001000

	)

5337 
	#FSMC_PIO4_IOWAIT4_5
 ((
ut32_t
)0x00002000

	)

5338 
	#FSMC_PIO4_IOWAIT4_6
 ((
ut32_t
)0x00004000

	)

5339 
	#FSMC_PIO4_IOWAIT4_7
 ((
ut32_t
)0x00008000

	)

5341 
	#FSMC_PIO4_IOHOLD4
 ((
ut32_t
)0x00FF0000

	)

5342 
	#FSMC_PIO4_IOHOLD4_0
 ((
ut32_t
)0x00010000

	)

5343 
	#FSMC_PIO4_IOHOLD4_1
 ((
ut32_t
)0x00020000

	)

5344 
	#FSMC_PIO4_IOHOLD4_2
 ((
ut32_t
)0x00040000

	)

5345 
	#FSMC_PIO4_IOHOLD4_3
 ((
ut32_t
)0x00080000

	)

5346 
	#FSMC_PIO4_IOHOLD4_4
 ((
ut32_t
)0x00100000

	)

5347 
	#FSMC_PIO4_IOHOLD4_5
 ((
ut32_t
)0x00200000

	)

5348 
	#FSMC_PIO4_IOHOLD4_6
 ((
ut32_t
)0x00400000

	)

5349 
	#FSMC_PIO4_IOHOLD4_7
 ((
ut32_t
)0x00800000

	)

5351 
	#FSMC_PIO4_IOHIZ4
 ((
ut32_t
)0xFF000000

	)

5352 
	#FSMC_PIO4_IOHIZ4_0
 ((
ut32_t
)0x01000000

	)

5353 
	#FSMC_PIO4_IOHIZ4_1
 ((
ut32_t
)0x02000000

	)

5354 
	#FSMC_PIO4_IOHIZ4_2
 ((
ut32_t
)0x04000000

	)

5355 
	#FSMC_PIO4_IOHIZ4_3
 ((
ut32_t
)0x08000000

	)

5356 
	#FSMC_PIO4_IOHIZ4_4
 ((
ut32_t
)0x10000000

	)

5357 
	#FSMC_PIO4_IOHIZ4_5
 ((
ut32_t
)0x20000000

	)

5358 
	#FSMC_PIO4_IOHIZ4_6
 ((
ut32_t
)0x40000000

	)

5359 
	#FSMC_PIO4_IOHIZ4_7
 ((
ut32_t
)0x80000000

	)

5362 
	#FSMC_ECCR2_ECC2
 ((
ut32_t
)0xFFFFFFFF

	)

5365 
	#FSMC_ECCR3_ECC3
 ((
ut32_t
)0xFFFFFFFF

	)

5374 
	#SDIO_POWER_PWRCTRL
 ((
ut8_t
)0x03

	)

5375 
	#SDIO_POWER_PWRCTRL_0
 ((
ut8_t
)0x01

	)

5376 
	#SDIO_POWER_PWRCTRL_1
 ((
ut8_t
)0x02

	)

5379 
	#SDIO_CLKCR_CLKDIV
 ((
ut16_t
)0x00FF

	)

5380 
	#SDIO_CLKCR_CLKEN
 ((
ut16_t
)0x0100

	)

5381 
	#SDIO_CLKCR_PWRSAV
 ((
ut16_t
)0x0200

	)

5382 
	#SDIO_CLKCR_BYPASS
 ((
ut16_t
)0x0400

	)

5384 
	#SDIO_CLKCR_WIDBUS
 ((
ut16_t
)0x1800

	)

5385 
	#SDIO_CLKCR_WIDBUS_0
 ((
ut16_t
)0x0800

	)

5386 
	#SDIO_CLKCR_WIDBUS_1
 ((
ut16_t
)0x1000

	)

5388 
	#SDIO_CLKCR_NEGEDGE
 ((
ut16_t
)0x2000

	)

5389 
	#SDIO_CLKCR_HWFC_EN
 ((
ut16_t
)0x4000

	)

5392 
	#SDIO_ARG_CMDARG
 ((
ut32_t
)0xFFFFFFFF

	)

5395 
	#SDIO_CMD_CMDINDEX
 ((
ut16_t
)0x003F

	)

5397 
	#SDIO_CMD_WAITRESP
 ((
ut16_t
)0x00C0

	)

5398 
	#SDIO_CMD_WAITRESP_0
 ((
ut16_t
)0x0040

	)

5399 
	#SDIO_CMD_WAITRESP_1
 ((
ut16_t
)0x0080

	)

5401 
	#SDIO_CMD_WAITINT
 ((
ut16_t
)0x0100

	)

5402 
	#SDIO_CMD_WAITPEND
 ((
ut16_t
)0x0200

	)

5403 
	#SDIO_CMD_CPSMEN
 ((
ut16_t
)0x0400

	)

5404 
	#SDIO_CMD_SDIOSUSPEND
 ((
ut16_t
)0x0800

	)

5405 
	#SDIO_CMD_ENCMDCOMPL
 ((
ut16_t
)0x1000

	)

5406 
	#SDIO_CMD_NIEN
 ((
ut16_t
)0x2000

	)

5407 
	#SDIO_CMD_CEATACMD
 ((
ut16_t
)0x4000

	)

5410 
	#SDIO_RESPCMD_RESPCMD
 ((
ut8_t
)0x3F

	)

5413 
	#SDIO_RESP0_CARDSTATUS0
 ((
ut32_t
)0xFFFFFFFF

	)

5416 
	#SDIO_RESP1_CARDSTATUS1
 ((
ut32_t
)0xFFFFFFFF

	)

5419 
	#SDIO_RESP2_CARDSTATUS2
 ((
ut32_t
)0xFFFFFFFF

	)

5422 
	#SDIO_RESP3_CARDSTATUS3
 ((
ut32_t
)0xFFFFFFFF

	)

5425 
	#SDIO_RESP4_CARDSTATUS4
 ((
ut32_t
)0xFFFFFFFF

	)

5428 
	#SDIO_DTIMER_DATATIME
 ((
ut32_t
)0xFFFFFFFF

	)

5431 
	#SDIO_DLEN_DATALENGTH
 ((
ut32_t
)0x01FFFFFF

	)

5434 
	#SDIO_DCTRL_DTEN
 ((
ut16_t
)0x0001

	)

5435 
	#SDIO_DCTRL_DTDIR
 ((
ut16_t
)0x0002

	)

5436 
	#SDIO_DCTRL_DTMODE
 ((
ut16_t
)0x0004

	)

5437 
	#SDIO_DCTRL_DMAEN
 ((
ut16_t
)0x0008

	)

5439 
	#SDIO_DCTRL_DBLOCKSIZE
 ((
ut16_t
)0x00F0

	)

5440 
	#SDIO_DCTRL_DBLOCKSIZE_0
 ((
ut16_t
)0x0010

	)

5441 
	#SDIO_DCTRL_DBLOCKSIZE_1
 ((
ut16_t
)0x0020

	)

5442 
	#SDIO_DCTRL_DBLOCKSIZE_2
 ((
ut16_t
)0x0040

	)

5443 
	#SDIO_DCTRL_DBLOCKSIZE_3
 ((
ut16_t
)0x0080

	)

5445 
	#SDIO_DCTRL_RWSTART
 ((
ut16_t
)0x0100

	)

5446 
	#SDIO_DCTRL_RWSTOP
 ((
ut16_t
)0x0200

	)

5447 
	#SDIO_DCTRL_RWMOD
 ((
ut16_t
)0x0400

	)

5448 
	#SDIO_DCTRL_SDIOEN
 ((
ut16_t
)0x0800

	)

5451 
	#SDIO_DCOUNT_DATACOUNT
 ((
ut32_t
)0x01FFFFFF

	)

5454 
	#SDIO_STA_CCRCFAIL
 ((
ut32_t
)0x00000001

	)

5455 
	#SDIO_STA_DCRCFAIL
 ((
ut32_t
)0x00000002

	)

5456 
	#SDIO_STA_CTIMEOUT
 ((
ut32_t
)0x00000004

	)

5457 
	#SDIO_STA_DTIMEOUT
 ((
ut32_t
)0x00000008

	)

5458 
	#SDIO_STA_TXUNDERR
 ((
ut32_t
)0x00000010

	)

5459 
	#SDIO_STA_RXOVERR
 ((
ut32_t
)0x00000020

	)

5460 
	#SDIO_STA_CMDREND
 ((
ut32_t
)0x00000040

	)

5461 
	#SDIO_STA_CMDSENT
 ((
ut32_t
)0x00000080

	)

5462 
	#SDIO_STA_DATAEND
 ((
ut32_t
)0x00000100

	)

5463 
	#SDIO_STA_STBITERR
 ((
ut32_t
)0x00000200

	)

5464 
	#SDIO_STA_DBCKEND
 ((
ut32_t
)0x00000400

	)

5465 
	#SDIO_STA_CMDACT
 ((
ut32_t
)0x00000800

	)

5466 
	#SDIO_STA_TXACT
 ((
ut32_t
)0x00001000

	)

5467 
	#SDIO_STA_RXACT
 ((
ut32_t
)0x00002000

	)

5468 
	#SDIO_STA_TXFIFOHE
 ((
ut32_t
)0x00004000

	)

5469 
	#SDIO_STA_RXFIFOHF
 ((
ut32_t
)0x00008000

	)

5470 
	#SDIO_STA_TXFIFOF
 ((
ut32_t
)0x00010000

	)

5471 
	#SDIO_STA_RXFIFOF
 ((
ut32_t
)0x00020000

	)

5472 
	#SDIO_STA_TXFIFOE
 ((
ut32_t
)0x00040000

	)

5473 
	#SDIO_STA_RXFIFOE
 ((
ut32_t
)0x00080000

	)

5474 
	#SDIO_STA_TXDAVL
 ((
ut32_t
)0x00100000

	)

5475 
	#SDIO_STA_RXDAVL
 ((
ut32_t
)0x00200000

	)

5476 
	#SDIO_STA_SDIOIT
 ((
ut32_t
)0x00400000

	)

5477 
	#SDIO_STA_CEATAEND
 ((
ut32_t
)0x00800000

	)

5480 
	#SDIO_ICR_CCRCFAILC
 ((
ut32_t
)0x00000001

	)

5481 
	#SDIO_ICR_DCRCFAILC
 ((
ut32_t
)0x00000002

	)

5482 
	#SDIO_ICR_CTIMEOUTC
 ((
ut32_t
)0x00000004

	)

5483 
	#SDIO_ICR_DTIMEOUTC
 ((
ut32_t
)0x00000008

	)

5484 
	#SDIO_ICR_TXUNDERRC
 ((
ut32_t
)0x00000010

	)

5485 
	#SDIO_ICR_RXOVERRC
 ((
ut32_t
)0x00000020

	)

5486 
	#SDIO_ICR_CMDRENDC
 ((
ut32_t
)0x00000040

	)

5487 
	#SDIO_ICR_CMDSENTC
 ((
ut32_t
)0x00000080

	)

5488 
	#SDIO_ICR_DATAENDC
 ((
ut32_t
)0x00000100

	)

5489 
	#SDIO_ICR_STBITERRC
 ((
ut32_t
)0x00000200

	)

5490 
	#SDIO_ICR_DBCKENDC
 ((
ut32_t
)0x00000400

	)

5491 
	#SDIO_ICR_SDIOITC
 ((
ut32_t
)0x00400000

	)

5492 
	#SDIO_ICR_CEATAENDC
 ((
ut32_t
)0x00800000

	)

5495 
	#SDIO_MASK_CCRCFAILIE
 ((
ut32_t
)0x00000001

	)

5496 
	#SDIO_MASK_DCRCFAILIE
 ((
ut32_t
)0x00000002

	)

5497 
	#SDIO_MASK_CTIMEOUTIE
 ((
ut32_t
)0x00000004

	)

5498 
	#SDIO_MASK_DTIMEOUTIE
 ((
ut32_t
)0x00000008

	)

5499 
	#SDIO_MASK_TXUNDERRIE
 ((
ut32_t
)0x00000010

	)

5500 
	#SDIO_MASK_RXOVERRIE
 ((
ut32_t
)0x00000020

	)

5501 
	#SDIO_MASK_CMDRENDIE
 ((
ut32_t
)0x00000040

	)

5502 
	#SDIO_MASK_CMDSENTIE
 ((
ut32_t
)0x00000080

	)

5503 
	#SDIO_MASK_DATAENDIE
 ((
ut32_t
)0x00000100

	)

5504 
	#SDIO_MASK_STBITERRIE
 ((
ut32_t
)0x00000200

	)

5505 
	#SDIO_MASK_DBCKENDIE
 ((
ut32_t
)0x00000400

	)

5506 
	#SDIO_MASK_CMDACTIE
 ((
ut32_t
)0x00000800

	)

5507 
	#SDIO_MASK_TXACTIE
 ((
ut32_t
)0x00001000

	)

5508 
	#SDIO_MASK_RXACTIE
 ((
ut32_t
)0x00002000

	)

5509 
	#SDIO_MASK_TXFIFOHEIE
 ((
ut32_t
)0x00004000

	)

5510 
	#SDIO_MASK_RXFIFOHFIE
 ((
ut32_t
)0x00008000

	)

5511 
	#SDIO_MASK_TXFIFOFIE
 ((
ut32_t
)0x00010000

	)

5512 
	#SDIO_MASK_RXFIFOFIE
 ((
ut32_t
)0x00020000

	)

5513 
	#SDIO_MASK_TXFIFOEIE
 ((
ut32_t
)0x00040000

	)

5514 
	#SDIO_MASK_RXFIFOEIE
 ((
ut32_t
)0x00080000

	)

5515 
	#SDIO_MASK_TXDAVLIE
 ((
ut32_t
)0x00100000

	)

5516 
	#SDIO_MASK_RXDAVLIE
 ((
ut32_t
)0x00200000

	)

5517 
	#SDIO_MASK_SDIOITIE
 ((
ut32_t
)0x00400000

	)

5518 
	#SDIO_MASK_CEATAENDIE
 ((
ut32_t
)0x00800000

	)

5521 
	#SDIO_FIFOCNT_FIFOCOUNT
 ((
ut32_t
)0x00FFFFFF

	)

5524 
	#SDIO_FIFO_FIFODATA
 ((
ut32_t
)0xFFFFFFFF

	)

5534 
	#USB_EP0R_EA
 ((
ut16_t
)0x000F

	)

5536 
	#USB_EP0R_STAT_TX
 ((
ut16_t
)0x0030

	)

5537 
	#USB_EP0R_STAT_TX_0
 ((
ut16_t
)0x0010

	)

5538 
	#USB_EP0R_STAT_TX_1
 ((
ut16_t
)0x0020

	)

5540 
	#USB_EP0R_DTOG_TX
 ((
ut16_t
)0x0040

	)

5541 
	#USB_EP0R_CTR_TX
 ((
ut16_t
)0x0080

	)

5542 
	#USB_EP0R_EP_KIND
 ((
ut16_t
)0x0100

	)

5544 
	#USB_EP0R_EP_TYPE
 ((
ut16_t
)0x0600

	)

5545 
	#USB_EP0R_EP_TYPE_0
 ((
ut16_t
)0x0200

	)

5546 
	#USB_EP0R_EP_TYPE_1
 ((
ut16_t
)0x0400

	)

5548 
	#USB_EP0R_SETUP
 ((
ut16_t
)0x0800

	)

5550 
	#USB_EP0R_STAT_RX
 ((
ut16_t
)0x3000

	)

5551 
	#USB_EP0R_STAT_RX_0
 ((
ut16_t
)0x1000

	)

5552 
	#USB_EP0R_STAT_RX_1
 ((
ut16_t
)0x2000

	)

5554 
	#USB_EP0R_DTOG_RX
 ((
ut16_t
)0x4000

	)

5555 
	#USB_EP0R_CTR_RX
 ((
ut16_t
)0x8000

	)

5558 
	#USB_EP1R_EA
 ((
ut16_t
)0x000F

	)

5560 
	#USB_EP1R_STAT_TX
 ((
ut16_t
)0x0030

	)

5561 
	#USB_EP1R_STAT_TX_0
 ((
ut16_t
)0x0010

	)

5562 
	#USB_EP1R_STAT_TX_1
 ((
ut16_t
)0x0020

	)

5564 
	#USB_EP1R_DTOG_TX
 ((
ut16_t
)0x0040

	)

5565 
	#USB_EP1R_CTR_TX
 ((
ut16_t
)0x0080

	)

5566 
	#USB_EP1R_EP_KIND
 ((
ut16_t
)0x0100

	)

5568 
	#USB_EP1R_EP_TYPE
 ((
ut16_t
)0x0600

	)

5569 
	#USB_EP1R_EP_TYPE_0
 ((
ut16_t
)0x0200

	)

5570 
	#USB_EP1R_EP_TYPE_1
 ((
ut16_t
)0x0400

	)

5572 
	#USB_EP1R_SETUP
 ((
ut16_t
)0x0800

	)

5574 
	#USB_EP1R_STAT_RX
 ((
ut16_t
)0x3000

	)

5575 
	#USB_EP1R_STAT_RX_0
 ((
ut16_t
)0x1000

	)

5576 
	#USB_EP1R_STAT_RX_1
 ((
ut16_t
)0x2000

	)

5578 
	#USB_EP1R_DTOG_RX
 ((
ut16_t
)0x4000

	)

5579 
	#USB_EP1R_CTR_RX
 ((
ut16_t
)0x8000

	)

5582 
	#USB_EP2R_EA
 ((
ut16_t
)0x000F

	)

5584 
	#USB_EP2R_STAT_TX
 ((
ut16_t
)0x0030

	)

5585 
	#USB_EP2R_STAT_TX_0
 ((
ut16_t
)0x0010

	)

5586 
	#USB_EP2R_STAT_TX_1
 ((
ut16_t
)0x0020

	)

5588 
	#USB_EP2R_DTOG_TX
 ((
ut16_t
)0x0040

	)

5589 
	#USB_EP2R_CTR_TX
 ((
ut16_t
)0x0080

	)

5590 
	#USB_EP2R_EP_KIND
 ((
ut16_t
)0x0100

	)

5592 
	#USB_EP2R_EP_TYPE
 ((
ut16_t
)0x0600

	)

5593 
	#USB_EP2R_EP_TYPE_0
 ((
ut16_t
)0x0200

	)

5594 
	#USB_EP2R_EP_TYPE_1
 ((
ut16_t
)0x0400

	)

5596 
	#USB_EP2R_SETUP
 ((
ut16_t
)0x0800

	)

5598 
	#USB_EP2R_STAT_RX
 ((
ut16_t
)0x3000

	)

5599 
	#USB_EP2R_STAT_RX_0
 ((
ut16_t
)0x1000

	)

5600 
	#USB_EP2R_STAT_RX_1
 ((
ut16_t
)0x2000

	)

5602 
	#USB_EP2R_DTOG_RX
 ((
ut16_t
)0x4000

	)

5603 
	#USB_EP2R_CTR_RX
 ((
ut16_t
)0x8000

	)

5606 
	#USB_EP3R_EA
 ((
ut16_t
)0x000F

	)

5608 
	#USB_EP3R_STAT_TX
 ((
ut16_t
)0x0030

	)

5609 
	#USB_EP3R_STAT_TX_0
 ((
ut16_t
)0x0010

	)

5610 
	#USB_EP3R_STAT_TX_1
 ((
ut16_t
)0x0020

	)

5612 
	#USB_EP3R_DTOG_TX
 ((
ut16_t
)0x0040

	)

5613 
	#USB_EP3R_CTR_TX
 ((
ut16_t
)0x0080

	)

5614 
	#USB_EP3R_EP_KIND
 ((
ut16_t
)0x0100

	)

5616 
	#USB_EP3R_EP_TYPE
 ((
ut16_t
)0x0600

	)

5617 
	#USB_EP3R_EP_TYPE_0
 ((
ut16_t
)0x0200

	)

5618 
	#USB_EP3R_EP_TYPE_1
 ((
ut16_t
)0x0400

	)

5620 
	#USB_EP3R_SETUP
 ((
ut16_t
)0x0800

	)

5622 
	#USB_EP3R_STAT_RX
 ((
ut16_t
)0x3000

	)

5623 
	#USB_EP3R_STAT_RX_0
 ((
ut16_t
)0x1000

	)

5624 
	#USB_EP3R_STAT_RX_1
 ((
ut16_t
)0x2000

	)

5626 
	#USB_EP3R_DTOG_RX
 ((
ut16_t
)0x4000

	)

5627 
	#USB_EP3R_CTR_RX
 ((
ut16_t
)0x8000

	)

5630 
	#USB_EP4R_EA
 ((
ut16_t
)0x000F

	)

5632 
	#USB_EP4R_STAT_TX
 ((
ut16_t
)0x0030

	)

5633 
	#USB_EP4R_STAT_TX_0
 ((
ut16_t
)0x0010

	)

5634 
	#USB_EP4R_STAT_TX_1
 ((
ut16_t
)0x0020

	)

5636 
	#USB_EP4R_DTOG_TX
 ((
ut16_t
)0x0040

	)

5637 
	#USB_EP4R_CTR_TX
 ((
ut16_t
)0x0080

	)

5638 
	#USB_EP4R_EP_KIND
 ((
ut16_t
)0x0100

	)

5640 
	#USB_EP4R_EP_TYPE
 ((
ut16_t
)0x0600

	)

5641 
	#USB_EP4R_EP_TYPE_0
 ((
ut16_t
)0x0200

	)

5642 
	#USB_EP4R_EP_TYPE_1
 ((
ut16_t
)0x0400

	)

5644 
	#USB_EP4R_SETUP
 ((
ut16_t
)0x0800

	)

5646 
	#USB_EP4R_STAT_RX
 ((
ut16_t
)0x3000

	)

5647 
	#USB_EP4R_STAT_RX_0
 ((
ut16_t
)0x1000

	)

5648 
	#USB_EP4R_STAT_RX_1
 ((
ut16_t
)0x2000

	)

5650 
	#USB_EP4R_DTOG_RX
 ((
ut16_t
)0x4000

	)

5651 
	#USB_EP4R_CTR_RX
 ((
ut16_t
)0x8000

	)

5654 
	#USB_EP5R_EA
 ((
ut16_t
)0x000F

	)

5656 
	#USB_EP5R_STAT_TX
 ((
ut16_t
)0x0030

	)

5657 
	#USB_EP5R_STAT_TX_0
 ((
ut16_t
)0x0010

	)

5658 
	#USB_EP5R_STAT_TX_1
 ((
ut16_t
)0x0020

	)

5660 
	#USB_EP5R_DTOG_TX
 ((
ut16_t
)0x0040

	)

5661 
	#USB_EP5R_CTR_TX
 ((
ut16_t
)0x0080

	)

5662 
	#USB_EP5R_EP_KIND
 ((
ut16_t
)0x0100

	)

5664 
	#USB_EP5R_EP_TYPE
 ((
ut16_t
)0x0600

	)

5665 
	#USB_EP5R_EP_TYPE_0
 ((
ut16_t
)0x0200

	)

5666 
	#USB_EP5R_EP_TYPE_1
 ((
ut16_t
)0x0400

	)

5668 
	#USB_EP5R_SETUP
 ((
ut16_t
)0x0800

	)

5670 
	#USB_EP5R_STAT_RX
 ((
ut16_t
)0x3000

	)

5671 
	#USB_EP5R_STAT_RX_0
 ((
ut16_t
)0x1000

	)

5672 
	#USB_EP5R_STAT_RX_1
 ((
ut16_t
)0x2000

	)

5674 
	#USB_EP5R_DTOG_RX
 ((
ut16_t
)0x4000

	)

5675 
	#USB_EP5R_CTR_RX
 ((
ut16_t
)0x8000

	)

5678 
	#USB_EP6R_EA
 ((
ut16_t
)0x000F

	)

5680 
	#USB_EP6R_STAT_TX
 ((
ut16_t
)0x0030

	)

5681 
	#USB_EP6R_STAT_TX_0
 ((
ut16_t
)0x0010

	)

5682 
	#USB_EP6R_STAT_TX_1
 ((
ut16_t
)0x0020

	)

5684 
	#USB_EP6R_DTOG_TX
 ((
ut16_t
)0x0040

	)

5685 
	#USB_EP6R_CTR_TX
 ((
ut16_t
)0x0080

	)

5686 
	#USB_EP6R_EP_KIND
 ((
ut16_t
)0x0100

	)

5688 
	#USB_EP6R_EP_TYPE
 ((
ut16_t
)0x0600

	)

5689 
	#USB_EP6R_EP_TYPE_0
 ((
ut16_t
)0x0200

	)

5690 
	#USB_EP6R_EP_TYPE_1
 ((
ut16_t
)0x0400

	)

5692 
	#USB_EP6R_SETUP
 ((
ut16_t
)0x0800

	)

5694 
	#USB_EP6R_STAT_RX
 ((
ut16_t
)0x3000

	)

5695 
	#USB_EP6R_STAT_RX_0
 ((
ut16_t
)0x1000

	)

5696 
	#USB_EP6R_STAT_RX_1
 ((
ut16_t
)0x2000

	)

5698 
	#USB_EP6R_DTOG_RX
 ((
ut16_t
)0x4000

	)

5699 
	#USB_EP6R_CTR_RX
 ((
ut16_t
)0x8000

	)

5702 
	#USB_EP7R_EA
 ((
ut16_t
)0x000F

	)

5704 
	#USB_EP7R_STAT_TX
 ((
ut16_t
)0x0030

	)

5705 
	#USB_EP7R_STAT_TX_0
 ((
ut16_t
)0x0010

	)

5706 
	#USB_EP7R_STAT_TX_1
 ((
ut16_t
)0x0020

	)

5708 
	#USB_EP7R_DTOG_TX
 ((
ut16_t
)0x0040

	)

5709 
	#USB_EP7R_CTR_TX
 ((
ut16_t
)0x0080

	)

5710 
	#USB_EP7R_EP_KIND
 ((
ut16_t
)0x0100

	)

5712 
	#USB_EP7R_EP_TYPE
 ((
ut16_t
)0x0600

	)

5713 
	#USB_EP7R_EP_TYPE_0
 ((
ut16_t
)0x0200

	)

5714 
	#USB_EP7R_EP_TYPE_1
 ((
ut16_t
)0x0400

	)

5716 
	#USB_EP7R_SETUP
 ((
ut16_t
)0x0800

	)

5718 
	#USB_EP7R_STAT_RX
 ((
ut16_t
)0x3000

	)

5719 
	#USB_EP7R_STAT_RX_0
 ((
ut16_t
)0x1000

	)

5720 
	#USB_EP7R_STAT_RX_1
 ((
ut16_t
)0x2000

	)

5722 
	#USB_EP7R_DTOG_RX
 ((
ut16_t
)0x4000

	)

5723 
	#USB_EP7R_CTR_RX
 ((
ut16_t
)0x8000

	)

5727 
	#USB_CNTR_FRES
 ((
ut16_t
)0x0001

	)

5728 
	#USB_CNTR_PDWN
 ((
ut16_t
)0x0002

	)

5729 
	#USB_CNTR_LP_MODE
 ((
ut16_t
)0x0004

	)

5730 
	#USB_CNTR_FSUSP
 ((
ut16_t
)0x0008

	)

5731 
	#USB_CNTR_RESUME
 ((
ut16_t
)0x0010

	)

5732 
	#USB_CNTR_ESOFM
 ((
ut16_t
)0x0100

	)

5733 
	#USB_CNTR_SOFM
 ((
ut16_t
)0x0200

	)

5734 
	#USB_CNTR_RESETM
 ((
ut16_t
)0x0400

	)

5735 
	#USB_CNTR_SUSPM
 ((
ut16_t
)0x0800

	)

5736 
	#USB_CNTR_WKUPM
 ((
ut16_t
)0x1000

	)

5737 
	#USB_CNTR_ERRM
 ((
ut16_t
)0x2000

	)

5738 
	#USB_CNTR_PMAOVRM
 ((
ut16_t
)0x4000

	)

5739 
	#USB_CNTR_CTRM
 ((
ut16_t
)0x8000

	)

5742 
	#USB_ISTR_EP_ID
 ((
ut16_t
)0x000F

	)

5743 
	#USB_ISTR_DIR
 ((
ut16_t
)0x0010

	)

5744 
	#USB_ISTR_ESOF
 ((
ut16_t
)0x0100

	)

5745 
	#USB_ISTR_SOF
 ((
ut16_t
)0x0200

	)

5746 
	#USB_ISTR_RESET
 ((
ut16_t
)0x0400

	)

5747 
	#USB_ISTR_SUSP
 ((
ut16_t
)0x0800

	)

5748 
	#USB_ISTR_WKUP
 ((
ut16_t
)0x1000

	)

5749 
	#USB_ISTR_ERR
 ((
ut16_t
)0x2000

	)

5750 
	#USB_ISTR_PMAOVR
 ((
ut16_t
)0x4000

	)

5751 
	#USB_ISTR_CTR
 ((
ut16_t
)0x8000

	)

5754 
	#USB_FNR_FN
 ((
ut16_t
)0x07FF

	)

5755 
	#USB_FNR_LSOF
 ((
ut16_t
)0x1800

	)

5756 
	#USB_FNR_LCK
 ((
ut16_t
)0x2000

	)

5757 
	#USB_FNR_RXDM
 ((
ut16_t
)0x4000

	)

5758 
	#USB_FNR_RXDP
 ((
ut16_t
)0x8000

	)

5761 
	#USB_DADDR_ADD
 ((
ut8_t
)0x7F

	)

5762 
	#USB_DADDR_ADD0
 ((
ut8_t
)0x01

	)

5763 
	#USB_DADDR_ADD1
 ((
ut8_t
)0x02

	)

5764 
	#USB_DADDR_ADD2
 ((
ut8_t
)0x04

	)

5765 
	#USB_DADDR_ADD3
 ((
ut8_t
)0x08

	)

5766 
	#USB_DADDR_ADD4
 ((
ut8_t
)0x10

	)

5767 
	#USB_DADDR_ADD5
 ((
ut8_t
)0x20

	)

5768 
	#USB_DADDR_ADD6
 ((
ut8_t
)0x40

	)

5770 
	#USB_DADDR_EF
 ((
ut8_t
)0x80

	)

5773 
	#USB_BTABLE_BTABLE
 ((
ut16_t
)0xFFF8

	)

5777 
	#USB_ADDR0_TX_ADDR0_TX
 ((
ut16_t
)0xFFFE

	)

5780 
	#USB_ADDR1_TX_ADDR1_TX
 ((
ut16_t
)0xFFFE

	)

5783 
	#USB_ADDR2_TX_ADDR2_TX
 ((
ut16_t
)0xFFFE

	)

5786 
	#USB_ADDR3_TX_ADDR3_TX
 ((
ut16_t
)0xFFFE

	)

5789 
	#USB_ADDR4_TX_ADDR4_TX
 ((
ut16_t
)0xFFFE

	)

5792 
	#USB_ADDR5_TX_ADDR5_TX
 ((
ut16_t
)0xFFFE

	)

5795 
	#USB_ADDR6_TX_ADDR6_TX
 ((
ut16_t
)0xFFFE

	)

5798 
	#USB_ADDR7_TX_ADDR7_TX
 ((
ut16_t
)0xFFFE

	)

5803 
	#USB_COUNT0_TX_COUNT0_TX
 ((
ut16_t
)0x03FF

	)

5806 
	#USB_COUNT1_TX_COUNT1_TX
 ((
ut16_t
)0x03FF

	)

5809 
	#USB_COUNT2_TX_COUNT2_TX
 ((
ut16_t
)0x03FF

	)

5812 
	#USB_COUNT3_TX_COUNT3_TX
 ((
ut16_t
)0x03FF

	)

5815 
	#USB_COUNT4_TX_COUNT4_TX
 ((
ut16_t
)0x03FF

	)

5818 
	#USB_COUNT5_TX_COUNT5_TX
 ((
ut16_t
)0x03FF

	)

5821 
	#USB_COUNT6_TX_COUNT6_TX
 ((
ut16_t
)0x03FF

	)

5824 
	#USB_COUNT7_TX_COUNT7_TX
 ((
ut16_t
)0x03FF

	)

5829 
	#USB_COUNT0_TX_0_COUNT0_TX_0
 ((
ut32_t
)0x000003FF

	)

5832 
	#USB_COUNT0_TX_1_COUNT0_TX_1
 ((
ut32_t
)0x03FF0000

	)

5835 
	#USB_COUNT1_TX_0_COUNT1_TX_0
 ((
ut32_t
)0x000003FF

	)

5838 
	#USB_COUNT1_TX_1_COUNT1_TX_1
 ((
ut32_t
)0x03FF0000

	)

5841 
	#USB_COUNT2_TX_0_COUNT2_TX_0
 ((
ut32_t
)0x000003FF

	)

5844 
	#USB_COUNT2_TX_1_COUNT2_TX_1
 ((
ut32_t
)0x03FF0000

	)

5847 
	#USB_COUNT3_TX_0_COUNT3_TX_0
 ((
ut16_t
)0x000003FF

	)

5850 
	#USB_COUNT3_TX_1_COUNT3_TX_1
 ((
ut16_t
)0x03FF0000

	)

5853 
	#USB_COUNT4_TX_0_COUNT4_TX_0
 ((
ut32_t
)0x000003FF

	)

5856 
	#USB_COUNT4_TX_1_COUNT4_TX_1
 ((
ut32_t
)0x03FF0000

	)

5859 
	#USB_COUNT5_TX_0_COUNT5_TX_0
 ((
ut32_t
)0x000003FF

	)

5862 
	#USB_COUNT5_TX_1_COUNT5_TX_1
 ((
ut32_t
)0x03FF0000

	)

5865 
	#USB_COUNT6_TX_0_COUNT6_TX_0
 ((
ut32_t
)0x000003FF

	)

5868 
	#USB_COUNT6_TX_1_COUNT6_TX_1
 ((
ut32_t
)0x03FF0000

	)

5871 
	#USB_COUNT7_TX_0_COUNT7_TX_0
 ((
ut32_t
)0x000003FF

	)

5874 
	#USB_COUNT7_TX_1_COUNT7_TX_1
 ((
ut32_t
)0x03FF0000

	)

5879 
	#USB_ADDR0_RX_ADDR0_RX
 ((
ut16_t
)0xFFFE

	)

5882 
	#USB_ADDR1_RX_ADDR1_RX
 ((
ut16_t
)0xFFFE

	)

5885 
	#USB_ADDR2_RX_ADDR2_RX
 ((
ut16_t
)0xFFFE

	)

5888 
	#USB_ADDR3_RX_ADDR3_RX
 ((
ut16_t
)0xFFFE

	)

5891 
	#USB_ADDR4_RX_ADDR4_RX
 ((
ut16_t
)0xFFFE

	)

5894 
	#USB_ADDR5_RX_ADDR5_RX
 ((
ut16_t
)0xFFFE

	)

5897 
	#USB_ADDR6_RX_ADDR6_RX
 ((
ut16_t
)0xFFFE

	)

5900 
	#USB_ADDR7_RX_ADDR7_RX
 ((
ut16_t
)0xFFFE

	)

5905 
	#USB_COUNT0_RX_COUNT0_RX
 ((
ut16_t
)0x03FF

	)

5907 
	#USB_COUNT0_RX_NUM_BLOCK
 ((
ut16_t
)0x7C00

	)

5908 
	#USB_COUNT0_RX_NUM_BLOCK_0
 ((
ut16_t
)0x0400

	)

5909 
	#USB_COUNT0_RX_NUM_BLOCK_1
 ((
ut16_t
)0x0800

	)

5910 
	#USB_COUNT0_RX_NUM_BLOCK_2
 ((
ut16_t
)0x1000

	)

5911 
	#USB_COUNT0_RX_NUM_BLOCK_3
 ((
ut16_t
)0x2000

	)

5912 
	#USB_COUNT0_RX_NUM_BLOCK_4
 ((
ut16_t
)0x4000

	)

5914 
	#USB_COUNT0_RX_BLSIZE
 ((
ut16_t
)0x8000

	)

5917 
	#USB_COUNT1_RX_COUNT1_RX
 ((
ut16_t
)0x03FF

	)

5919 
	#USB_COUNT1_RX_NUM_BLOCK
 ((
ut16_t
)0x7C00

	)

5920 
	#USB_COUNT1_RX_NUM_BLOCK_0
 ((
ut16_t
)0x0400

	)

5921 
	#USB_COUNT1_RX_NUM_BLOCK_1
 ((
ut16_t
)0x0800

	)

5922 
	#USB_COUNT1_RX_NUM_BLOCK_2
 ((
ut16_t
)0x1000

	)

5923 
	#USB_COUNT1_RX_NUM_BLOCK_3
 ((
ut16_t
)0x2000

	)

5924 
	#USB_COUNT1_RX_NUM_BLOCK_4
 ((
ut16_t
)0x4000

	)

5926 
	#USB_COUNT1_RX_BLSIZE
 ((
ut16_t
)0x8000

	)

5929 
	#USB_COUNT2_RX_COUNT2_RX
 ((
ut16_t
)0x03FF

	)

5931 
	#USB_COUNT2_RX_NUM_BLOCK
 ((
ut16_t
)0x7C00

	)

5932 
	#USB_COUNT2_RX_NUM_BLOCK_0
 ((
ut16_t
)0x0400

	)

5933 
	#USB_COUNT2_RX_NUM_BLOCK_1
 ((
ut16_t
)0x0800

	)

5934 
	#USB_COUNT2_RX_NUM_BLOCK_2
 ((
ut16_t
)0x1000

	)

5935 
	#USB_COUNT2_RX_NUM_BLOCK_3
 ((
ut16_t
)0x2000

	)

5936 
	#USB_COUNT2_RX_NUM_BLOCK_4
 ((
ut16_t
)0x4000

	)

5938 
	#USB_COUNT2_RX_BLSIZE
 ((
ut16_t
)0x8000

	)

5941 
	#USB_COUNT3_RX_COUNT3_RX
 ((
ut16_t
)0x03FF

	)

5943 
	#USB_COUNT3_RX_NUM_BLOCK
 ((
ut16_t
)0x7C00

	)

5944 
	#USB_COUNT3_RX_NUM_BLOCK_0
 ((
ut16_t
)0x0400

	)

5945 
	#USB_COUNT3_RX_NUM_BLOCK_1
 ((
ut16_t
)0x0800

	)

5946 
	#USB_COUNT3_RX_NUM_BLOCK_2
 ((
ut16_t
)0x1000

	)

5947 
	#USB_COUNT3_RX_NUM_BLOCK_3
 ((
ut16_t
)0x2000

	)

5948 
	#USB_COUNT3_RX_NUM_BLOCK_4
 ((
ut16_t
)0x4000

	)

5950 
	#USB_COUNT3_RX_BLSIZE
 ((
ut16_t
)0x8000

	)

5953 
	#USB_COUNT4_RX_COUNT4_RX
 ((
ut16_t
)0x03FF

	)

5955 
	#USB_COUNT4_RX_NUM_BLOCK
 ((
ut16_t
)0x7C00

	)

5956 
	#USB_COUNT4_RX_NUM_BLOCK_0
 ((
ut16_t
)0x0400

	)

5957 
	#USB_COUNT4_RX_NUM_BLOCK_1
 ((
ut16_t
)0x0800

	)

5958 
	#USB_COUNT4_RX_NUM_BLOCK_2
 ((
ut16_t
)0x1000

	)

5959 
	#USB_COUNT4_RX_NUM_BLOCK_3
 ((
ut16_t
)0x2000

	)

5960 
	#USB_COUNT4_RX_NUM_BLOCK_4
 ((
ut16_t
)0x4000

	)

5962 
	#USB_COUNT4_RX_BLSIZE
 ((
ut16_t
)0x8000

	)

5965 
	#USB_COUNT5_RX_COUNT5_RX
 ((
ut16_t
)0x03FF

	)

5967 
	#USB_COUNT5_RX_NUM_BLOCK
 ((
ut16_t
)0x7C00

	)

5968 
	#USB_COUNT5_RX_NUM_BLOCK_0
 ((
ut16_t
)0x0400

	)

5969 
	#USB_COUNT5_RX_NUM_BLOCK_1
 ((
ut16_t
)0x0800

	)

5970 
	#USB_COUNT5_RX_NUM_BLOCK_2
 ((
ut16_t
)0x1000

	)

5971 
	#USB_COUNT5_RX_NUM_BLOCK_3
 ((
ut16_t
)0x2000

	)

5972 
	#USB_COUNT5_RX_NUM_BLOCK_4
 ((
ut16_t
)0x4000

	)

5974 
	#USB_COUNT5_RX_BLSIZE
 ((
ut16_t
)0x8000

	)

5977 
	#USB_COUNT6_RX_COUNT6_RX
 ((
ut16_t
)0x03FF

	)

5979 
	#USB_COUNT6_RX_NUM_BLOCK
 ((
ut16_t
)0x7C00

	)

5980 
	#USB_COUNT6_RX_NUM_BLOCK_0
 ((
ut16_t
)0x0400

	)

5981 
	#USB_COUNT6_RX_NUM_BLOCK_1
 ((
ut16_t
)0x0800

	)

5982 
	#USB_COUNT6_RX_NUM_BLOCK_2
 ((
ut16_t
)0x1000

	)

5983 
	#USB_COUNT6_RX_NUM_BLOCK_3
 ((
ut16_t
)0x2000

	)

5984 
	#USB_COUNT6_RX_NUM_BLOCK_4
 ((
ut16_t
)0x4000

	)

5986 
	#USB_COUNT6_RX_BLSIZE
 ((
ut16_t
)0x8000

	)

5989 
	#USB_COUNT7_RX_COUNT7_RX
 ((
ut16_t
)0x03FF

	)

5991 
	#USB_COUNT7_RX_NUM_BLOCK
 ((
ut16_t
)0x7C00

	)

5992 
	#USB_COUNT7_RX_NUM_BLOCK_0
 ((
ut16_t
)0x0400

	)

5993 
	#USB_COUNT7_RX_NUM_BLOCK_1
 ((
ut16_t
)0x0800

	)

5994 
	#USB_COUNT7_RX_NUM_BLOCK_2
 ((
ut16_t
)0x1000

	)

5995 
	#USB_COUNT7_RX_NUM_BLOCK_3
 ((
ut16_t
)0x2000

	)

5996 
	#USB_COUNT7_RX_NUM_BLOCK_4
 ((
ut16_t
)0x4000

	)

5998 
	#USB_COUNT7_RX_BLSIZE
 ((
ut16_t
)0x8000

	)

6003 
	#USB_COUNT0_RX_0_COUNT0_RX_0
 ((
ut32_t
)0x000003FF

	)

6005 
	#USB_COUNT0_RX_0_NUM_BLOCK_0
 ((
ut32_t
)0x00007C00

	)

6006 
	#USB_COUNT0_RX_0_NUM_BLOCK_0_0
 ((
ut32_t
)0x00000400

	)

6007 
	#USB_COUNT0_RX_0_NUM_BLOCK_0_1
 ((
ut32_t
)0x00000800

	)

6008 
	#USB_COUNT0_RX_0_NUM_BLOCK_0_2
 ((
ut32_t
)0x00001000

	)

6009 
	#USB_COUNT0_RX_0_NUM_BLOCK_0_3
 ((
ut32_t
)0x00002000

	)

6010 
	#USB_COUNT0_RX_0_NUM_BLOCK_0_4
 ((
ut32_t
)0x00004000

	)

6012 
	#USB_COUNT0_RX_0_BLSIZE_0
 ((
ut32_t
)0x00008000

	)

6015 
	#USB_COUNT0_RX_1_COUNT0_RX_1
 ((
ut32_t
)0x03FF0000

	)

6017 
	#USB_COUNT0_RX_1_NUM_BLOCK_1
 ((
ut32_t
)0x7C000000

	)

6018 
	#USB_COUNT0_RX_1_NUM_BLOCK_1_0
 ((
ut32_t
)0x04000000

	)

6019 
	#USB_COUNT0_RX_1_NUM_BLOCK_1_1
 ((
ut32_t
)0x08000000

	)

6020 
	#USB_COUNT0_RX_1_NUM_BLOCK_1_2
 ((
ut32_t
)0x10000000

	)

6021 
	#USB_COUNT0_RX_1_NUM_BLOCK_1_3
 ((
ut32_t
)0x20000000

	)

6022 
	#USB_COUNT0_RX_1_NUM_BLOCK_1_4
 ((
ut32_t
)0x40000000

	)

6024 
	#USB_COUNT0_RX_1_BLSIZE_1
 ((
ut32_t
)0x80000000

	)

6027 
	#USB_COUNT1_RX_0_COUNT1_RX_0
 ((
ut32_t
)0x000003FF

	)

6029 
	#USB_COUNT1_RX_0_NUM_BLOCK_0
 ((
ut32_t
)0x00007C00

	)

6030 
	#USB_COUNT1_RX_0_NUM_BLOCK_0_0
 ((
ut32_t
)0x00000400

	)

6031 
	#USB_COUNT1_RX_0_NUM_BLOCK_0_1
 ((
ut32_t
)0x00000800

	)

6032 
	#USB_COUNT1_RX_0_NUM_BLOCK_0_2
 ((
ut32_t
)0x00001000

	)

6033 
	#USB_COUNT1_RX_0_NUM_BLOCK_0_3
 ((
ut32_t
)0x00002000

	)

6034 
	#USB_COUNT1_RX_0_NUM_BLOCK_0_4
 ((
ut32_t
)0x00004000

	)

6036 
	#USB_COUNT1_RX_0_BLSIZE_0
 ((
ut32_t
)0x00008000

	)

6039 
	#USB_COUNT1_RX_1_COUNT1_RX_1
 ((
ut32_t
)0x03FF0000

	)

6041 
	#USB_COUNT1_RX_1_NUM_BLOCK_1
 ((
ut32_t
)0x7C000000

	)

6042 
	#USB_COUNT1_RX_1_NUM_BLOCK_1_0
 ((
ut32_t
)0x04000000

	)

6043 
	#USB_COUNT1_RX_1_NUM_BLOCK_1_1
 ((
ut32_t
)0x08000000

	)

6044 
	#USB_COUNT1_RX_1_NUM_BLOCK_1_2
 ((
ut32_t
)0x10000000

	)

6045 
	#USB_COUNT1_RX_1_NUM_BLOCK_1_3
 ((
ut32_t
)0x20000000

	)

6046 
	#USB_COUNT1_RX_1_NUM_BLOCK_1_4
 ((
ut32_t
)0x40000000

	)

6048 
	#USB_COUNT1_RX_1_BLSIZE_1
 ((
ut32_t
)0x80000000

	)

6051 
	#USB_COUNT2_RX_0_COUNT2_RX_0
 ((
ut32_t
)0x000003FF

	)

6053 
	#USB_COUNT2_RX_0_NUM_BLOCK_0
 ((
ut32_t
)0x00007C00

	)

6054 
	#USB_COUNT2_RX_0_NUM_BLOCK_0_0
 ((
ut32_t
)0x00000400

	)

6055 
	#USB_COUNT2_RX_0_NUM_BLOCK_0_1
 ((
ut32_t
)0x00000800

	)

6056 
	#USB_COUNT2_RX_0_NUM_BLOCK_0_2
 ((
ut32_t
)0x00001000

	)

6057 
	#USB_COUNT2_RX_0_NUM_BLOCK_0_3
 ((
ut32_t
)0x00002000

	)

6058 
	#USB_COUNT2_RX_0_NUM_BLOCK_0_4
 ((
ut32_t
)0x00004000

	)

6060 
	#USB_COUNT2_RX_0_BLSIZE_0
 ((
ut32_t
)0x00008000

	)

6063 
	#USB_COUNT2_RX_1_COUNT2_RX_1
 ((
ut32_t
)0x03FF0000

	)

6065 
	#USB_COUNT2_RX_1_NUM_BLOCK_1
 ((
ut32_t
)0x7C000000

	)

6066 
	#USB_COUNT2_RX_1_NUM_BLOCK_1_0
 ((
ut32_t
)0x04000000

	)

6067 
	#USB_COUNT2_RX_1_NUM_BLOCK_1_1
 ((
ut32_t
)0x08000000

	)

6068 
	#USB_COUNT2_RX_1_NUM_BLOCK_1_2
 ((
ut32_t
)0x10000000

	)

6069 
	#USB_COUNT2_RX_1_NUM_BLOCK_1_3
 ((
ut32_t
)0x20000000

	)

6070 
	#USB_COUNT2_RX_1_NUM_BLOCK_1_4
 ((
ut32_t
)0x40000000

	)

6072 
	#USB_COUNT2_RX_1_BLSIZE_1
 ((
ut32_t
)0x80000000

	)

6075 
	#USB_COUNT3_RX_0_COUNT3_RX_0
 ((
ut32_t
)0x000003FF

	)

6077 
	#USB_COUNT3_RX_0_NUM_BLOCK_0
 ((
ut32_t
)0x00007C00

	)

6078 
	#USB_COUNT3_RX_0_NUM_BLOCK_0_0
 ((
ut32_t
)0x00000400

	)

6079 
	#USB_COUNT3_RX_0_NUM_BLOCK_0_1
 ((
ut32_t
)0x00000800

	)

6080 
	#USB_COUNT3_RX_0_NUM_BLOCK_0_2
 ((
ut32_t
)0x00001000

	)

6081 
	#USB_COUNT3_RX_0_NUM_BLOCK_0_3
 ((
ut32_t
)0x00002000

	)

6082 
	#USB_COUNT3_RX_0_NUM_BLOCK_0_4
 ((
ut32_t
)0x00004000

	)

6084 
	#USB_COUNT3_RX_0_BLSIZE_0
 ((
ut32_t
)0x00008000

	)

6087 
	#USB_COUNT3_RX_1_COUNT3_RX_1
 ((
ut32_t
)0x03FF0000

	)

6089 
	#USB_COUNT3_RX_1_NUM_BLOCK_1
 ((
ut32_t
)0x7C000000

	)

6090 
	#USB_COUNT3_RX_1_NUM_BLOCK_1_0
 ((
ut32_t
)0x04000000

	)

6091 
	#USB_COUNT3_RX_1_NUM_BLOCK_1_1
 ((
ut32_t
)0x08000000

	)

6092 
	#USB_COUNT3_RX_1_NUM_BLOCK_1_2
 ((
ut32_t
)0x10000000

	)

6093 
	#USB_COUNT3_RX_1_NUM_BLOCK_1_3
 ((
ut32_t
)0x20000000

	)

6094 
	#USB_COUNT3_RX_1_NUM_BLOCK_1_4
 ((
ut32_t
)0x40000000

	)

6096 
	#USB_COUNT3_RX_1_BLSIZE_1
 ((
ut32_t
)0x80000000

	)

6099 
	#USB_COUNT4_RX_0_COUNT4_RX_0
 ((
ut32_t
)0x000003FF

	)

6101 
	#USB_COUNT4_RX_0_NUM_BLOCK_0
 ((
ut32_t
)0x00007C00

	)

6102 
	#USB_COUNT4_RX_0_NUM_BLOCK_0_0
 ((
ut32_t
)0x00000400

	)

6103 
	#USB_COUNT4_RX_0_NUM_BLOCK_0_1
 ((
ut32_t
)0x00000800

	)

6104 
	#USB_COUNT4_RX_0_NUM_BLOCK_0_2
 ((
ut32_t
)0x00001000

	)

6105 
	#USB_COUNT4_RX_0_NUM_BLOCK_0_3
 ((
ut32_t
)0x00002000

	)

6106 
	#USB_COUNT4_RX_0_NUM_BLOCK_0_4
 ((
ut32_t
)0x00004000

	)

6108 
	#USB_COUNT4_RX_0_BLSIZE_0
 ((
ut32_t
)0x00008000

	)

6111 
	#USB_COUNT4_RX_1_COUNT4_RX_1
 ((
ut32_t
)0x03FF0000

	)

6113 
	#USB_COUNT4_RX_1_NUM_BLOCK_1
 ((
ut32_t
)0x7C000000

	)

6114 
	#USB_COUNT4_RX_1_NUM_BLOCK_1_0
 ((
ut32_t
)0x04000000

	)

6115 
	#USB_COUNT4_RX_1_NUM_BLOCK_1_1
 ((
ut32_t
)0x08000000

	)

6116 
	#USB_COUNT4_RX_1_NUM_BLOCK_1_2
 ((
ut32_t
)0x10000000

	)

6117 
	#USB_COUNT4_RX_1_NUM_BLOCK_1_3
 ((
ut32_t
)0x20000000

	)

6118 
	#USB_COUNT4_RX_1_NUM_BLOCK_1_4
 ((
ut32_t
)0x40000000

	)

6120 
	#USB_COUNT4_RX_1_BLSIZE_1
 ((
ut32_t
)0x80000000

	)

6123 
	#USB_COUNT5_RX_0_COUNT5_RX_0
 ((
ut32_t
)0x000003FF

	)

6125 
	#USB_COUNT5_RX_0_NUM_BLOCK_0
 ((
ut32_t
)0x00007C00

	)

6126 
	#USB_COUNT5_RX_0_NUM_BLOCK_0_0
 ((
ut32_t
)0x00000400

	)

6127 
	#USB_COUNT5_RX_0_NUM_BLOCK_0_1
 ((
ut32_t
)0x00000800

	)

6128 
	#USB_COUNT5_RX_0_NUM_BLOCK_0_2
 ((
ut32_t
)0x00001000

	)

6129 
	#USB_COUNT5_RX_0_NUM_BLOCK_0_3
 ((
ut32_t
)0x00002000

	)

6130 
	#USB_COUNT5_RX_0_NUM_BLOCK_0_4
 ((
ut32_t
)0x00004000

	)

6132 
	#USB_COUNT5_RX_0_BLSIZE_0
 ((
ut32_t
)0x00008000

	)

6135 
	#USB_COUNT5_RX_1_COUNT5_RX_1
 ((
ut32_t
)0x03FF0000

	)

6137 
	#USB_COUNT5_RX_1_NUM_BLOCK_1
 ((
ut32_t
)0x7C000000

	)

6138 
	#USB_COUNT5_RX_1_NUM_BLOCK_1_0
 ((
ut32_t
)0x04000000

	)

6139 
	#USB_COUNT5_RX_1_NUM_BLOCK_1_1
 ((
ut32_t
)0x08000000

	)

6140 
	#USB_COUNT5_RX_1_NUM_BLOCK_1_2
 ((
ut32_t
)0x10000000

	)

6141 
	#USB_COUNT5_RX_1_NUM_BLOCK_1_3
 ((
ut32_t
)0x20000000

	)

6142 
	#USB_COUNT5_RX_1_NUM_BLOCK_1_4
 ((
ut32_t
)0x40000000

	)

6144 
	#USB_COUNT5_RX_1_BLSIZE_1
 ((
ut32_t
)0x80000000

	)

6147 
	#USB_COUNT6_RX_0_COUNT6_RX_0
 ((
ut32_t
)0x000003FF

	)

6149 
	#USB_COUNT6_RX_0_NUM_BLOCK_0
 ((
ut32_t
)0x00007C00

	)

6150 
	#USB_COUNT6_RX_0_NUM_BLOCK_0_0
 ((
ut32_t
)0x00000400

	)

6151 
	#USB_COUNT6_RX_0_NUM_BLOCK_0_1
 ((
ut32_t
)0x00000800

	)

6152 
	#USB_COUNT6_RX_0_NUM_BLOCK_0_2
 ((
ut32_t
)0x00001000

	)

6153 
	#USB_COUNT6_RX_0_NUM_BLOCK_0_3
 ((
ut32_t
)0x00002000

	)

6154 
	#USB_COUNT6_RX_0_NUM_BLOCK_0_4
 ((
ut32_t
)0x00004000

	)

6156 
	#USB_COUNT6_RX_0_BLSIZE_0
 ((
ut32_t
)0x00008000

	)

6159 
	#USB_COUNT6_RX_1_COUNT6_RX_1
 ((
ut32_t
)0x03FF0000

	)

6161 
	#USB_COUNT6_RX_1_NUM_BLOCK_1
 ((
ut32_t
)0x7C000000

	)

6162 
	#USB_COUNT6_RX_1_NUM_BLOCK_1_0
 ((
ut32_t
)0x04000000

	)

6163 
	#USB_COUNT6_RX_1_NUM_BLOCK_1_1
 ((
ut32_t
)0x08000000

	)

6164 
	#USB_COUNT6_RX_1_NUM_BLOCK_1_2
 ((
ut32_t
)0x10000000

	)

6165 
	#USB_COUNT6_RX_1_NUM_BLOCK_1_3
 ((
ut32_t
)0x20000000

	)

6166 
	#USB_COUNT6_RX_1_NUM_BLOCK_1_4
 ((
ut32_t
)0x40000000

	)

6168 
	#USB_COUNT6_RX_1_BLSIZE_1
 ((
ut32_t
)0x80000000

	)

6171 
	#USB_COUNT7_RX_0_COUNT7_RX_0
 ((
ut32_t
)0x000003FF

	)

6173 
	#USB_COUNT7_RX_0_NUM_BLOCK_0
 ((
ut32_t
)0x00007C00

	)

6174 
	#USB_COUNT7_RX_0_NUM_BLOCK_0_0
 ((
ut32_t
)0x00000400

	)

6175 
	#USB_COUNT7_RX_0_NUM_BLOCK_0_1
 ((
ut32_t
)0x00000800

	)

6176 
	#USB_COUNT7_RX_0_NUM_BLOCK_0_2
 ((
ut32_t
)0x00001000

	)

6177 
	#USB_COUNT7_RX_0_NUM_BLOCK_0_3
 ((
ut32_t
)0x00002000

	)

6178 
	#USB_COUNT7_RX_0_NUM_BLOCK_0_4
 ((
ut32_t
)0x00004000

	)

6180 
	#USB_COUNT7_RX_0_BLSIZE_0
 ((
ut32_t
)0x00008000

	)

6183 
	#USB_COUNT7_RX_1_COUNT7_RX_1
 ((
ut32_t
)0x03FF0000

	)

6185 
	#USB_COUNT7_RX_1_NUM_BLOCK_1
 ((
ut32_t
)0x7C000000

	)

6186 
	#USB_COUNT7_RX_1_NUM_BLOCK_1_0
 ((
ut32_t
)0x04000000

	)

6187 
	#USB_COUNT7_RX_1_NUM_BLOCK_1_1
 ((
ut32_t
)0x08000000

	)

6188 
	#USB_COUNT7_RX_1_NUM_BLOCK_1_2
 ((
ut32_t
)0x10000000

	)

6189 
	#USB_COUNT7_RX_1_NUM_BLOCK_1_3
 ((
ut32_t
)0x20000000

	)

6190 
	#USB_COUNT7_RX_1_NUM_BLOCK_1_4
 ((
ut32_t
)0x40000000

	)

6192 
	#USB_COUNT7_RX_1_BLSIZE_1
 ((
ut32_t
)0x80000000

	)

6202 
	#CAN_MCR_INRQ
 ((
ut16_t
)0x0001

	)

6203 
	#CAN_MCR_SLEEP
 ((
ut16_t
)0x0002

	)

6204 
	#CAN_MCR_TXFP
 ((
ut16_t
)0x0004

	)

6205 
	#CAN_MCR_RFLM
 ((
ut16_t
)0x0008

	)

6206 
	#CAN_MCR_NART
 ((
ut16_t
)0x0010

	)

6207 
	#CAN_MCR_AWUM
 ((
ut16_t
)0x0020

	)

6208 
	#CAN_MCR_ABOM
 ((
ut16_t
)0x0040

	)

6209 
	#CAN_MCR_TTCM
 ((
ut16_t
)0x0080

	)

6210 
	#CAN_MCR_RESET
 ((
ut16_t
)0x8000

	)

6213 
	#CAN_MSR_INAK
 ((
ut16_t
)0x0001

	)

6214 
	#CAN_MSR_SLAK
 ((
ut16_t
)0x0002

	)

6215 
	#CAN_MSR_ERRI
 ((
ut16_t
)0x0004

	)

6216 
	#CAN_MSR_WKUI
 ((
ut16_t
)0x0008

	)

6217 
	#CAN_MSR_SLAKI
 ((
ut16_t
)0x0010

	)

6218 
	#CAN_MSR_TXM
 ((
ut16_t
)0x0100

	)

6219 
	#CAN_MSR_RXM
 ((
ut16_t
)0x0200

	)

6220 
	#CAN_MSR_SAMP
 ((
ut16_t
)0x0400

	)

6221 
	#CAN_MSR_RX
 ((
ut16_t
)0x0800

	)

6224 
	#CAN_TSR_RQCP0
 ((
ut32_t
)0x00000001

	)

6225 
	#CAN_TSR_TXOK0
 ((
ut32_t
)0x00000002

	)

6226 
	#CAN_TSR_ALST0
 ((
ut32_t
)0x00000004

	)

6227 
	#CAN_TSR_TERR0
 ((
ut32_t
)0x00000008

	)

6228 
	#CAN_TSR_ABRQ0
 ((
ut32_t
)0x00000080

	)

6229 
	#CAN_TSR_RQCP1
 ((
ut32_t
)0x00000100

	)

6230 
	#CAN_TSR_TXOK1
 ((
ut32_t
)0x00000200

	)

6231 
	#CAN_TSR_ALST1
 ((
ut32_t
)0x00000400

	)

6232 
	#CAN_TSR_TERR1
 ((
ut32_t
)0x00000800

	)

6233 
	#CAN_TSR_ABRQ1
 ((
ut32_t
)0x00008000

	)

6234 
	#CAN_TSR_RQCP2
 ((
ut32_t
)0x00010000

	)

6235 
	#CAN_TSR_TXOK2
 ((
ut32_t
)0x00020000

	)

6236 
	#CAN_TSR_ALST2
 ((
ut32_t
)0x00040000

	)

6237 
	#CAN_TSR_TERR2
 ((
ut32_t
)0x00080000

	)

6238 
	#CAN_TSR_ABRQ2
 ((
ut32_t
)0x00800000

	)

6239 
	#CAN_TSR_CODE
 ((
ut32_t
)0x03000000

	)

6241 
	#CAN_TSR_TME
 ((
ut32_t
)0x1C000000

	)

6242 
	#CAN_TSR_TME0
 ((
ut32_t
)0x04000000

	)

6243 
	#CAN_TSR_TME1
 ((
ut32_t
)0x08000000

	)

6244 
	#CAN_TSR_TME2
 ((
ut32_t
)0x10000000

	)

6246 
	#CAN_TSR_LOW
 ((
ut32_t
)0xE0000000

	)

6247 
	#CAN_TSR_LOW0
 ((
ut32_t
)0x20000000

	)

6248 
	#CAN_TSR_LOW1
 ((
ut32_t
)0x40000000

	)

6249 
	#CAN_TSR_LOW2
 ((
ut32_t
)0x80000000

	)

6252 
	#CAN_RF0R_FMP0
 ((
ut8_t
)0x03

	)

6253 
	#CAN_RF0R_FULL0
 ((
ut8_t
)0x08

	)

6254 
	#CAN_RF0R_FOVR0
 ((
ut8_t
)0x10

	)

6255 
	#CAN_RF0R_RFOM0
 ((
ut8_t
)0x20

	)

6258 
	#CAN_RF1R_FMP1
 ((
ut8_t
)0x03

	)

6259 
	#CAN_RF1R_FULL1
 ((
ut8_t
)0x08

	)

6260 
	#CAN_RF1R_FOVR1
 ((
ut8_t
)0x10

	)

6261 
	#CAN_RF1R_RFOM1
 ((
ut8_t
)0x20

	)

6264 
	#CAN_IER_TMEIE
 ((
ut32_t
)0x00000001

	)

6265 
	#CAN_IER_FMPIE0
 ((
ut32_t
)0x00000002

	)

6266 
	#CAN_IER_FFIE0
 ((
ut32_t
)0x00000004

	)

6267 
	#CAN_IER_FOVIE0
 ((
ut32_t
)0x00000008

	)

6268 
	#CAN_IER_FMPIE1
 ((
ut32_t
)0x00000010

	)

6269 
	#CAN_IER_FFIE1
 ((
ut32_t
)0x00000020

	)

6270 
	#CAN_IER_FOVIE1
 ((
ut32_t
)0x00000040

	)

6271 
	#CAN_IER_EWGIE
 ((
ut32_t
)0x00000100

	)

6272 
	#CAN_IER_EPVIE
 ((
ut32_t
)0x00000200

	)

6273 
	#CAN_IER_BOFIE
 ((
ut32_t
)0x00000400

	)

6274 
	#CAN_IER_LECIE
 ((
ut32_t
)0x00000800

	)

6275 
	#CAN_IER_ERRIE
 ((
ut32_t
)0x00008000

	)

6276 
	#CAN_IER_WKUIE
 ((
ut32_t
)0x00010000

	)

6277 
	#CAN_IER_SLKIE
 ((
ut32_t
)0x00020000

	)

6280 
	#CAN_ESR_EWGF
 ((
ut32_t
)0x00000001

	)

6281 
	#CAN_ESR_EPVF
 ((
ut32_t
)0x00000002

	)

6282 
	#CAN_ESR_BOFF
 ((
ut32_t
)0x00000004

	)

6284 
	#CAN_ESR_LEC
 ((
ut32_t
)0x00000070

	)

6285 
	#CAN_ESR_LEC_0
 ((
ut32_t
)0x00000010

	)

6286 
	#CAN_ESR_LEC_1
 ((
ut32_t
)0x00000020

	)

6287 
	#CAN_ESR_LEC_2
 ((
ut32_t
)0x00000040

	)

6289 
	#CAN_ESR_TEC
 ((
ut32_t
)0x00FF0000

	)

6290 
	#CAN_ESR_REC
 ((
ut32_t
)0xFF000000

	)

6293 
	#CAN_BTR_BRP
 ((
ut32_t
)0x000003FF

	)

6294 
	#CAN_BTR_TS1
 ((
ut32_t
)0x000F0000

	)

6295 
	#CAN_BTR_TS2
 ((
ut32_t
)0x00700000

	)

6296 
	#CAN_BTR_SJW
 ((
ut32_t
)0x03000000

	)

6297 
	#CAN_BTR_LBKM
 ((
ut32_t
)0x40000000

	)

6298 
	#CAN_BTR_SILM
 ((
ut32_t
)0x80000000

	)

6302 
	#CAN_TI0R_TXRQ
 ((
ut32_t
)0x00000001

	)

6303 
	#CAN_TI0R_RTR
 ((
ut32_t
)0x00000002

	)

6304 
	#CAN_TI0R_IDE
 ((
ut32_t
)0x00000004

	)

6305 
	#CAN_TI0R_EXID
 ((
ut32_t
)0x001FFFF8

	)

6306 
	#CAN_TI0R_STID
 ((
ut32_t
)0xFFE00000

	)

6309 
	#CAN_TDT0R_DLC
 ((
ut32_t
)0x0000000F

	)

6310 
	#CAN_TDT0R_TGT
 ((
ut32_t
)0x00000100

	)

6311 
	#CAN_TDT0R_TIME
 ((
ut32_t
)0xFFFF0000

	)

6314 
	#CAN_TDL0R_DATA0
 ((
ut32_t
)0x000000FF

	)

6315 
	#CAN_TDL0R_DATA1
 ((
ut32_t
)0x0000FF00

	)

6316 
	#CAN_TDL0R_DATA2
 ((
ut32_t
)0x00FF0000

	)

6317 
	#CAN_TDL0R_DATA3
 ((
ut32_t
)0xFF000000

	)

6320 
	#CAN_TDH0R_DATA4
 ((
ut32_t
)0x000000FF

	)

6321 
	#CAN_TDH0R_DATA5
 ((
ut32_t
)0x0000FF00

	)

6322 
	#CAN_TDH0R_DATA6
 ((
ut32_t
)0x00FF0000

	)

6323 
	#CAN_TDH0R_DATA7
 ((
ut32_t
)0xFF000000

	)

6326 
	#CAN_TI1R_TXRQ
 ((
ut32_t
)0x00000001

	)

6327 
	#CAN_TI1R_RTR
 ((
ut32_t
)0x00000002

	)

6328 
	#CAN_TI1R_IDE
 ((
ut32_t
)0x00000004

	)

6329 
	#CAN_TI1R_EXID
 ((
ut32_t
)0x001FFFF8

	)

6330 
	#CAN_TI1R_STID
 ((
ut32_t
)0xFFE00000

	)

6333 
	#CAN_TDT1R_DLC
 ((
ut32_t
)0x0000000F

	)

6334 
	#CAN_TDT1R_TGT
 ((
ut32_t
)0x00000100

	)

6335 
	#CAN_TDT1R_TIME
 ((
ut32_t
)0xFFFF0000

	)

6338 
	#CAN_TDL1R_DATA0
 ((
ut32_t
)0x000000FF

	)

6339 
	#CAN_TDL1R_DATA1
 ((
ut32_t
)0x0000FF00

	)

6340 
	#CAN_TDL1R_DATA2
 ((
ut32_t
)0x00FF0000

	)

6341 
	#CAN_TDL1R_DATA3
 ((
ut32_t
)0xFF000000

	)

6344 
	#CAN_TDH1R_DATA4
 ((
ut32_t
)0x000000FF

	)

6345 
	#CAN_TDH1R_DATA5
 ((
ut32_t
)0x0000FF00

	)

6346 
	#CAN_TDH1R_DATA6
 ((
ut32_t
)0x00FF0000

	)

6347 
	#CAN_TDH1R_DATA7
 ((
ut32_t
)0xFF000000

	)

6350 
	#CAN_TI2R_TXRQ
 ((
ut32_t
)0x00000001

	)

6351 
	#CAN_TI2R_RTR
 ((
ut32_t
)0x00000002

	)

6352 
	#CAN_TI2R_IDE
 ((
ut32_t
)0x00000004

	)

6353 
	#CAN_TI2R_EXID
 ((
ut32_t
)0x001FFFF8

	)

6354 
	#CAN_TI2R_STID
 ((
ut32_t
)0xFFE00000

	)

6357 
	#CAN_TDT2R_DLC
 ((
ut32_t
)0x0000000F

	)

6358 
	#CAN_TDT2R_TGT
 ((
ut32_t
)0x00000100

	)

6359 
	#CAN_TDT2R_TIME
 ((
ut32_t
)0xFFFF0000

	)

6362 
	#CAN_TDL2R_DATA0
 ((
ut32_t
)0x000000FF

	)

6363 
	#CAN_TDL2R_DATA1
 ((
ut32_t
)0x0000FF00

	)

6364 
	#CAN_TDL2R_DATA2
 ((
ut32_t
)0x00FF0000

	)

6365 
	#CAN_TDL2R_DATA3
 ((
ut32_t
)0xFF000000

	)

6368 
	#CAN_TDH2R_DATA4
 ((
ut32_t
)0x000000FF

	)

6369 
	#CAN_TDH2R_DATA5
 ((
ut32_t
)0x0000FF00

	)

6370 
	#CAN_TDH2R_DATA6
 ((
ut32_t
)0x00FF0000

	)

6371 
	#CAN_TDH2R_DATA7
 ((
ut32_t
)0xFF000000

	)

6374 
	#CAN_RI0R_RTR
 ((
ut32_t
)0x00000002

	)

6375 
	#CAN_RI0R_IDE
 ((
ut32_t
)0x00000004

	)

6376 
	#CAN_RI0R_EXID
 ((
ut32_t
)0x001FFFF8

	)

6377 
	#CAN_RI0R_STID
 ((
ut32_t
)0xFFE00000

	)

6380 
	#CAN_RDT0R_DLC
 ((
ut32_t
)0x0000000F

	)

6381 
	#CAN_RDT0R_FMI
 ((
ut32_t
)0x0000FF00

	)

6382 
	#CAN_RDT0R_TIME
 ((
ut32_t
)0xFFFF0000

	)

6385 
	#CAN_RDL0R_DATA0
 ((
ut32_t
)0x000000FF

	)

6386 
	#CAN_RDL0R_DATA1
 ((
ut32_t
)0x0000FF00

	)

6387 
	#CAN_RDL0R_DATA2
 ((
ut32_t
)0x00FF0000

	)

6388 
	#CAN_RDL0R_DATA3
 ((
ut32_t
)0xFF000000

	)

6391 
	#CAN_RDH0R_DATA4
 ((
ut32_t
)0x000000FF

	)

6392 
	#CAN_RDH0R_DATA5
 ((
ut32_t
)0x0000FF00

	)

6393 
	#CAN_RDH0R_DATA6
 ((
ut32_t
)0x00FF0000

	)

6394 
	#CAN_RDH0R_DATA7
 ((
ut32_t
)0xFF000000

	)

6397 
	#CAN_RI1R_RTR
 ((
ut32_t
)0x00000002

	)

6398 
	#CAN_RI1R_IDE
 ((
ut32_t
)0x00000004

	)

6399 
	#CAN_RI1R_EXID
 ((
ut32_t
)0x001FFFF8

	)

6400 
	#CAN_RI1R_STID
 ((
ut32_t
)0xFFE00000

	)

6403 
	#CAN_RDT1R_DLC
 ((
ut32_t
)0x0000000F

	)

6404 
	#CAN_RDT1R_FMI
 ((
ut32_t
)0x0000FF00

	)

6405 
	#CAN_RDT1R_TIME
 ((
ut32_t
)0xFFFF0000

	)

6408 
	#CAN_RDL1R_DATA0
 ((
ut32_t
)0x000000FF

	)

6409 
	#CAN_RDL1R_DATA1
 ((
ut32_t
)0x0000FF00

	)

6410 
	#CAN_RDL1R_DATA2
 ((
ut32_t
)0x00FF0000

	)

6411 
	#CAN_RDL1R_DATA3
 ((
ut32_t
)0xFF000000

	)

6414 
	#CAN_RDH1R_DATA4
 ((
ut32_t
)0x000000FF

	)

6415 
	#CAN_RDH1R_DATA5
 ((
ut32_t
)0x0000FF00

	)

6416 
	#CAN_RDH1R_DATA6
 ((
ut32_t
)0x00FF0000

	)

6417 
	#CAN_RDH1R_DATA7
 ((
ut32_t
)0xFF000000

	)

6421 
	#CAN_FMR_FINIT
 ((
ut8_t
)0x01

	)

6424 
	#CAN_FM1R_FBM
 ((
ut16_t
)0x3FFF

	)

6425 
	#CAN_FM1R_FBM0
 ((
ut16_t
)0x0001

	)

6426 
	#CAN_FM1R_FBM1
 ((
ut16_t
)0x0002

	)

6427 
	#CAN_FM1R_FBM2
 ((
ut16_t
)0x0004

	)

6428 
	#CAN_FM1R_FBM3
 ((
ut16_t
)0x0008

	)

6429 
	#CAN_FM1R_FBM4
 ((
ut16_t
)0x0010

	)

6430 
	#CAN_FM1R_FBM5
 ((
ut16_t
)0x0020

	)

6431 
	#CAN_FM1R_FBM6
 ((
ut16_t
)0x0040

	)

6432 
	#CAN_FM1R_FBM7
 ((
ut16_t
)0x0080

	)

6433 
	#CAN_FM1R_FBM8
 ((
ut16_t
)0x0100

	)

6434 
	#CAN_FM1R_FBM9
 ((
ut16_t
)0x0200

	)

6435 
	#CAN_FM1R_FBM10
 ((
ut16_t
)0x0400

	)

6436 
	#CAN_FM1R_FBM11
 ((
ut16_t
)0x0800

	)

6437 
	#CAN_FM1R_FBM12
 ((
ut16_t
)0x1000

	)

6438 
	#CAN_FM1R_FBM13
 ((
ut16_t
)0x2000

	)

6441 
	#CAN_FS1R_FSC
 ((
ut16_t
)0x3FFF

	)

6442 
	#CAN_FS1R_FSC0
 ((
ut16_t
)0x0001

	)

6443 
	#CAN_FS1R_FSC1
 ((
ut16_t
)0x0002

	)

6444 
	#CAN_FS1R_FSC2
 ((
ut16_t
)0x0004

	)

6445 
	#CAN_FS1R_FSC3
 ((
ut16_t
)0x0008

	)

6446 
	#CAN_FS1R_FSC4
 ((
ut16_t
)0x0010

	)

6447 
	#CAN_FS1R_FSC5
 ((
ut16_t
)0x0020

	)

6448 
	#CAN_FS1R_FSC6
 ((
ut16_t
)0x0040

	)

6449 
	#CAN_FS1R_FSC7
 ((
ut16_t
)0x0080

	)

6450 
	#CAN_FS1R_FSC8
 ((
ut16_t
)0x0100

	)

6451 
	#CAN_FS1R_FSC9
 ((
ut16_t
)0x0200

	)

6452 
	#CAN_FS1R_FSC10
 ((
ut16_t
)0x0400

	)

6453 
	#CAN_FS1R_FSC11
 ((
ut16_t
)0x0800

	)

6454 
	#CAN_FS1R_FSC12
 ((
ut16_t
)0x1000

	)

6455 
	#CAN_FS1R_FSC13
 ((
ut16_t
)0x2000

	)

6458 
	#CAN_FFA1R_FFA
 ((
ut16_t
)0x3FFF

	)

6459 
	#CAN_FFA1R_FFA0
 ((
ut16_t
)0x0001

	)

6460 
	#CAN_FFA1R_FFA1
 ((
ut16_t
)0x0002

	)

6461 
	#CAN_FFA1R_FFA2
 ((
ut16_t
)0x0004

	)

6462 
	#CAN_FFA1R_FFA3
 ((
ut16_t
)0x0008

	)

6463 
	#CAN_FFA1R_FFA4
 ((
ut16_t
)0x0010

	)

6464 
	#CAN_FFA1R_FFA5
 ((
ut16_t
)0x0020

	)

6465 
	#CAN_FFA1R_FFA6
 ((
ut16_t
)0x0040

	)

6466 
	#CAN_FFA1R_FFA7
 ((
ut16_t
)0x0080

	)

6467 
	#CAN_FFA1R_FFA8
 ((
ut16_t
)0x0100

	)

6468 
	#CAN_FFA1R_FFA9
 ((
ut16_t
)0x0200

	)

6469 
	#CAN_FFA1R_FFA10
 ((
ut16_t
)0x0400

	)

6470 
	#CAN_FFA1R_FFA11
 ((
ut16_t
)0x0800

	)

6471 
	#CAN_FFA1R_FFA12
 ((
ut16_t
)0x1000

	)

6472 
	#CAN_FFA1R_FFA13
 ((
ut16_t
)0x2000

	)

6475 
	#CAN_FA1R_FACT
 ((
ut16_t
)0x3FFF

	)

6476 
	#CAN_FA1R_FACT0
 ((
ut16_t
)0x0001

	)

6477 
	#CAN_FA1R_FACT1
 ((
ut16_t
)0x0002

	)

6478 
	#CAN_FA1R_FACT2
 ((
ut16_t
)0x0004

	)

6479 
	#CAN_FA1R_FACT3
 ((
ut16_t
)0x0008

	)

6480 
	#CAN_FA1R_FACT4
 ((
ut16_t
)0x0010

	)

6481 
	#CAN_FA1R_FACT5
 ((
ut16_t
)0x0020

	)

6482 
	#CAN_FA1R_FACT6
 ((
ut16_t
)0x0040

	)

6483 
	#CAN_FA1R_FACT7
 ((
ut16_t
)0x0080

	)

6484 
	#CAN_FA1R_FACT8
 ((
ut16_t
)0x0100

	)

6485 
	#CAN_FA1R_FACT9
 ((
ut16_t
)0x0200

	)

6486 
	#CAN_FA1R_FACT10
 ((
ut16_t
)0x0400

	)

6487 
	#CAN_FA1R_FACT11
 ((
ut16_t
)0x0800

	)

6488 
	#CAN_FA1R_FACT12
 ((
ut16_t
)0x1000

	)

6489 
	#CAN_FA1R_FACT13
 ((
ut16_t
)0x2000

	)

6492 
	#CAN_F0R1_FB0
 ((
ut32_t
)0x00000001

	)

6493 
	#CAN_F0R1_FB1
 ((
ut32_t
)0x00000002

	)

6494 
	#CAN_F0R1_FB2
 ((
ut32_t
)0x00000004

	)

6495 
	#CAN_F0R1_FB3
 ((
ut32_t
)0x00000008

	)

6496 
	#CAN_F0R1_FB4
 ((
ut32_t
)0x00000010

	)

6497 
	#CAN_F0R1_FB5
 ((
ut32_t
)0x00000020

	)

6498 
	#CAN_F0R1_FB6
 ((
ut32_t
)0x00000040

	)

6499 
	#CAN_F0R1_FB7
 ((
ut32_t
)0x00000080

	)

6500 
	#CAN_F0R1_FB8
 ((
ut32_t
)0x00000100

	)

6501 
	#CAN_F0R1_FB9
 ((
ut32_t
)0x00000200

	)

6502 
	#CAN_F0R1_FB10
 ((
ut32_t
)0x00000400

	)

6503 
	#CAN_F0R1_FB11
 ((
ut32_t
)0x00000800

	)

6504 
	#CAN_F0R1_FB12
 ((
ut32_t
)0x00001000

	)

6505 
	#CAN_F0R1_FB13
 ((
ut32_t
)0x00002000

	)

6506 
	#CAN_F0R1_FB14
 ((
ut32_t
)0x00004000

	)

6507 
	#CAN_F0R1_FB15
 ((
ut32_t
)0x00008000

	)

6508 
	#CAN_F0R1_FB16
 ((
ut32_t
)0x00010000

	)

6509 
	#CAN_F0R1_FB17
 ((
ut32_t
)0x00020000

	)

6510 
	#CAN_F0R1_FB18
 ((
ut32_t
)0x00040000

	)

6511 
	#CAN_F0R1_FB19
 ((
ut32_t
)0x00080000

	)

6512 
	#CAN_F0R1_FB20
 ((
ut32_t
)0x00100000

	)

6513 
	#CAN_F0R1_FB21
 ((
ut32_t
)0x00200000

	)

6514 
	#CAN_F0R1_FB22
 ((
ut32_t
)0x00400000

	)

6515 
	#CAN_F0R1_FB23
 ((
ut32_t
)0x00800000

	)

6516 
	#CAN_F0R1_FB24
 ((
ut32_t
)0x01000000

	)

6517 
	#CAN_F0R1_FB25
 ((
ut32_t
)0x02000000

	)

6518 
	#CAN_F0R1_FB26
 ((
ut32_t
)0x04000000

	)

6519 
	#CAN_F0R1_FB27
 ((
ut32_t
)0x08000000

	)

6520 
	#CAN_F0R1_FB28
 ((
ut32_t
)0x10000000

	)

6521 
	#CAN_F0R1_FB29
 ((
ut32_t
)0x20000000

	)

6522 
	#CAN_F0R1_FB30
 ((
ut32_t
)0x40000000

	)

6523 
	#CAN_F0R1_FB31
 ((
ut32_t
)0x80000000

	)

6526 
	#CAN_F1R1_FB0
 ((
ut32_t
)0x00000001

	)

6527 
	#CAN_F1R1_FB1
 ((
ut32_t
)0x00000002

	)

6528 
	#CAN_F1R1_FB2
 ((
ut32_t
)0x00000004

	)

6529 
	#CAN_F1R1_FB3
 ((
ut32_t
)0x00000008

	)

6530 
	#CAN_F1R1_FB4
 ((
ut32_t
)0x00000010

	)

6531 
	#CAN_F1R1_FB5
 ((
ut32_t
)0x00000020

	)

6532 
	#CAN_F1R1_FB6
 ((
ut32_t
)0x00000040

	)

6533 
	#CAN_F1R1_FB7
 ((
ut32_t
)0x00000080

	)

6534 
	#CAN_F1R1_FB8
 ((
ut32_t
)0x00000100

	)

6535 
	#CAN_F1R1_FB9
 ((
ut32_t
)0x00000200

	)

6536 
	#CAN_F1R1_FB10
 ((
ut32_t
)0x00000400

	)

6537 
	#CAN_F1R1_FB11
 ((
ut32_t
)0x00000800

	)

6538 
	#CAN_F1R1_FB12
 ((
ut32_t
)0x00001000

	)

6539 
	#CAN_F1R1_FB13
 ((
ut32_t
)0x00002000

	)

6540 
	#CAN_F1R1_FB14
 ((
ut32_t
)0x00004000

	)

6541 
	#CAN_F1R1_FB15
 ((
ut32_t
)0x00008000

	)

6542 
	#CAN_F1R1_FB16
 ((
ut32_t
)0x00010000

	)

6543 
	#CAN_F1R1_FB17
 ((
ut32_t
)0x00020000

	)

6544 
	#CAN_F1R1_FB18
 ((
ut32_t
)0x00040000

	)

6545 
	#CAN_F1R1_FB19
 ((
ut32_t
)0x00080000

	)

6546 
	#CAN_F1R1_FB20
 ((
ut32_t
)0x00100000

	)

6547 
	#CAN_F1R1_FB21
 ((
ut32_t
)0x00200000

	)

6548 
	#CAN_F1R1_FB22
 ((
ut32_t
)0x00400000

	)

6549 
	#CAN_F1R1_FB23
 ((
ut32_t
)0x00800000

	)

6550 
	#CAN_F1R1_FB24
 ((
ut32_t
)0x01000000

	)

6551 
	#CAN_F1R1_FB25
 ((
ut32_t
)0x02000000

	)

6552 
	#CAN_F1R1_FB26
 ((
ut32_t
)0x04000000

	)

6553 
	#CAN_F1R1_FB27
 ((
ut32_t
)0x08000000

	)

6554 
	#CAN_F1R1_FB28
 ((
ut32_t
)0x10000000

	)

6555 
	#CAN_F1R1_FB29
 ((
ut32_t
)0x20000000

	)

6556 
	#CAN_F1R1_FB30
 ((
ut32_t
)0x40000000

	)

6557 
	#CAN_F1R1_FB31
 ((
ut32_t
)0x80000000

	)

6560 
	#CAN_F2R1_FB0
 ((
ut32_t
)0x00000001

	)

6561 
	#CAN_F2R1_FB1
 ((
ut32_t
)0x00000002

	)

6562 
	#CAN_F2R1_FB2
 ((
ut32_t
)0x00000004

	)

6563 
	#CAN_F2R1_FB3
 ((
ut32_t
)0x00000008

	)

6564 
	#CAN_F2R1_FB4
 ((
ut32_t
)0x00000010

	)

6565 
	#CAN_F2R1_FB5
 ((
ut32_t
)0x00000020

	)

6566 
	#CAN_F2R1_FB6
 ((
ut32_t
)0x00000040

	)

6567 
	#CAN_F2R1_FB7
 ((
ut32_t
)0x00000080

	)

6568 
	#CAN_F2R1_FB8
 ((
ut32_t
)0x00000100

	)

6569 
	#CAN_F2R1_FB9
 ((
ut32_t
)0x00000200

	)

6570 
	#CAN_F2R1_FB10
 ((
ut32_t
)0x00000400

	)

6571 
	#CAN_F2R1_FB11
 ((
ut32_t
)0x00000800

	)

6572 
	#CAN_F2R1_FB12
 ((
ut32_t
)0x00001000

	)

6573 
	#CAN_F2R1_FB13
 ((
ut32_t
)0x00002000

	)

6574 
	#CAN_F2R1_FB14
 ((
ut32_t
)0x00004000

	)

6575 
	#CAN_F2R1_FB15
 ((
ut32_t
)0x00008000

	)

6576 
	#CAN_F2R1_FB16
 ((
ut32_t
)0x00010000

	)

6577 
	#CAN_F2R1_FB17
 ((
ut32_t
)0x00020000

	)

6578 
	#CAN_F2R1_FB18
 ((
ut32_t
)0x00040000

	)

6579 
	#CAN_F2R1_FB19
 ((
ut32_t
)0x00080000

	)

6580 
	#CAN_F2R1_FB20
 ((
ut32_t
)0x00100000

	)

6581 
	#CAN_F2R1_FB21
 ((
ut32_t
)0x00200000

	)

6582 
	#CAN_F2R1_FB22
 ((
ut32_t
)0x00400000

	)

6583 
	#CAN_F2R1_FB23
 ((
ut32_t
)0x00800000

	)

6584 
	#CAN_F2R1_FB24
 ((
ut32_t
)0x01000000

	)

6585 
	#CAN_F2R1_FB25
 ((
ut32_t
)0x02000000

	)

6586 
	#CAN_F2R1_FB26
 ((
ut32_t
)0x04000000

	)

6587 
	#CAN_F2R1_FB27
 ((
ut32_t
)0x08000000

	)

6588 
	#CAN_F2R1_FB28
 ((
ut32_t
)0x10000000

	)

6589 
	#CAN_F2R1_FB29
 ((
ut32_t
)0x20000000

	)

6590 
	#CAN_F2R1_FB30
 ((
ut32_t
)0x40000000

	)

6591 
	#CAN_F2R1_FB31
 ((
ut32_t
)0x80000000

	)

6594 
	#CAN_F3R1_FB0
 ((
ut32_t
)0x00000001

	)

6595 
	#CAN_F3R1_FB1
 ((
ut32_t
)0x00000002

	)

6596 
	#CAN_F3R1_FB2
 ((
ut32_t
)0x00000004

	)

6597 
	#CAN_F3R1_FB3
 ((
ut32_t
)0x00000008

	)

6598 
	#CAN_F3R1_FB4
 ((
ut32_t
)0x00000010

	)

6599 
	#CAN_F3R1_FB5
 ((
ut32_t
)0x00000020

	)

6600 
	#CAN_F3R1_FB6
 ((
ut32_t
)0x00000040

	)

6601 
	#CAN_F3R1_FB7
 ((
ut32_t
)0x00000080

	)

6602 
	#CAN_F3R1_FB8
 ((
ut32_t
)0x00000100

	)

6603 
	#CAN_F3R1_FB9
 ((
ut32_t
)0x00000200

	)

6604 
	#CAN_F3R1_FB10
 ((
ut32_t
)0x00000400

	)

6605 
	#CAN_F3R1_FB11
 ((
ut32_t
)0x00000800

	)

6606 
	#CAN_F3R1_FB12
 ((
ut32_t
)0x00001000

	)

6607 
	#CAN_F3R1_FB13
 ((
ut32_t
)0x00002000

	)

6608 
	#CAN_F3R1_FB14
 ((
ut32_t
)0x00004000

	)

6609 
	#CAN_F3R1_FB15
 ((
ut32_t
)0x00008000

	)

6610 
	#CAN_F3R1_FB16
 ((
ut32_t
)0x00010000

	)

6611 
	#CAN_F3R1_FB17
 ((
ut32_t
)0x00020000

	)

6612 
	#CAN_F3R1_FB18
 ((
ut32_t
)0x00040000

	)

6613 
	#CAN_F3R1_FB19
 ((
ut32_t
)0x00080000

	)

6614 
	#CAN_F3R1_FB20
 ((
ut32_t
)0x00100000

	)

6615 
	#CAN_F3R1_FB21
 ((
ut32_t
)0x00200000

	)

6616 
	#CAN_F3R1_FB22
 ((
ut32_t
)0x00400000

	)

6617 
	#CAN_F3R1_FB23
 ((
ut32_t
)0x00800000

	)

6618 
	#CAN_F3R1_FB24
 ((
ut32_t
)0x01000000

	)

6619 
	#CAN_F3R1_FB25
 ((
ut32_t
)0x02000000

	)

6620 
	#CAN_F3R1_FB26
 ((
ut32_t
)0x04000000

	)

6621 
	#CAN_F3R1_FB27
 ((
ut32_t
)0x08000000

	)

6622 
	#CAN_F3R1_FB28
 ((
ut32_t
)0x10000000

	)

6623 
	#CAN_F3R1_FB29
 ((
ut32_t
)0x20000000

	)

6624 
	#CAN_F3R1_FB30
 ((
ut32_t
)0x40000000

	)

6625 
	#CAN_F3R1_FB31
 ((
ut32_t
)0x80000000

	)

6628 
	#CAN_F4R1_FB0
 ((
ut32_t
)0x00000001

	)

6629 
	#CAN_F4R1_FB1
 ((
ut32_t
)0x00000002

	)

6630 
	#CAN_F4R1_FB2
 ((
ut32_t
)0x00000004

	)

6631 
	#CAN_F4R1_FB3
 ((
ut32_t
)0x00000008

	)

6632 
	#CAN_F4R1_FB4
 ((
ut32_t
)0x00000010

	)

6633 
	#CAN_F4R1_FB5
 ((
ut32_t
)0x00000020

	)

6634 
	#CAN_F4R1_FB6
 ((
ut32_t
)0x00000040

	)

6635 
	#CAN_F4R1_FB7
 ((
ut32_t
)0x00000080

	)

6636 
	#CAN_F4R1_FB8
 ((
ut32_t
)0x00000100

	)

6637 
	#CAN_F4R1_FB9
 ((
ut32_t
)0x00000200

	)

6638 
	#CAN_F4R1_FB10
 ((
ut32_t
)0x00000400

	)

6639 
	#CAN_F4R1_FB11
 ((
ut32_t
)0x00000800

	)

6640 
	#CAN_F4R1_FB12
 ((
ut32_t
)0x00001000

	)

6641 
	#CAN_F4R1_FB13
 ((
ut32_t
)0x00002000

	)

6642 
	#CAN_F4R1_FB14
 ((
ut32_t
)0x00004000

	)

6643 
	#CAN_F4R1_FB15
 ((
ut32_t
)0x00008000

	)

6644 
	#CAN_F4R1_FB16
 ((
ut32_t
)0x00010000

	)

6645 
	#CAN_F4R1_FB17
 ((
ut32_t
)0x00020000

	)

6646 
	#CAN_F4R1_FB18
 ((
ut32_t
)0x00040000

	)

6647 
	#CAN_F4R1_FB19
 ((
ut32_t
)0x00080000

	)

6648 
	#CAN_F4R1_FB20
 ((
ut32_t
)0x00100000

	)

6649 
	#CAN_F4R1_FB21
 ((
ut32_t
)0x00200000

	)

6650 
	#CAN_F4R1_FB22
 ((
ut32_t
)0x00400000

	)

6651 
	#CAN_F4R1_FB23
 ((
ut32_t
)0x00800000

	)

6652 
	#CAN_F4R1_FB24
 ((
ut32_t
)0x01000000

	)

6653 
	#CAN_F4R1_FB25
 ((
ut32_t
)0x02000000

	)

6654 
	#CAN_F4R1_FB26
 ((
ut32_t
)0x04000000

	)

6655 
	#CAN_F4R1_FB27
 ((
ut32_t
)0x08000000

	)

6656 
	#CAN_F4R1_FB28
 ((
ut32_t
)0x10000000

	)

6657 
	#CAN_F4R1_FB29
 ((
ut32_t
)0x20000000

	)

6658 
	#CAN_F4R1_FB30
 ((
ut32_t
)0x40000000

	)

6659 
	#CAN_F4R1_FB31
 ((
ut32_t
)0x80000000

	)

6662 
	#CAN_F5R1_FB0
 ((
ut32_t
)0x00000001

	)

6663 
	#CAN_F5R1_FB1
 ((
ut32_t
)0x00000002

	)

6664 
	#CAN_F5R1_FB2
 ((
ut32_t
)0x00000004

	)

6665 
	#CAN_F5R1_FB3
 ((
ut32_t
)0x00000008

	)

6666 
	#CAN_F5R1_FB4
 ((
ut32_t
)0x00000010

	)

6667 
	#CAN_F5R1_FB5
 ((
ut32_t
)0x00000020

	)

6668 
	#CAN_F5R1_FB6
 ((
ut32_t
)0x00000040

	)

6669 
	#CAN_F5R1_FB7
 ((
ut32_t
)0x00000080

	)

6670 
	#CAN_F5R1_FB8
 ((
ut32_t
)0x00000100

	)

6671 
	#CAN_F5R1_FB9
 ((
ut32_t
)0x00000200

	)

6672 
	#CAN_F5R1_FB10
 ((
ut32_t
)0x00000400

	)

6673 
	#CAN_F5R1_FB11
 ((
ut32_t
)0x00000800

	)

6674 
	#CAN_F5R1_FB12
 ((
ut32_t
)0x00001000

	)

6675 
	#CAN_F5R1_FB13
 ((
ut32_t
)0x00002000

	)

6676 
	#CAN_F5R1_FB14
 ((
ut32_t
)0x00004000

	)

6677 
	#CAN_F5R1_FB15
 ((
ut32_t
)0x00008000

	)

6678 
	#CAN_F5R1_FB16
 ((
ut32_t
)0x00010000

	)

6679 
	#CAN_F5R1_FB17
 ((
ut32_t
)0x00020000

	)

6680 
	#CAN_F5R1_FB18
 ((
ut32_t
)0x00040000

	)

6681 
	#CAN_F5R1_FB19
 ((
ut32_t
)0x00080000

	)

6682 
	#CAN_F5R1_FB20
 ((
ut32_t
)0x00100000

	)

6683 
	#CAN_F5R1_FB21
 ((
ut32_t
)0x00200000

	)

6684 
	#CAN_F5R1_FB22
 ((
ut32_t
)0x00400000

	)

6685 
	#CAN_F5R1_FB23
 ((
ut32_t
)0x00800000

	)

6686 
	#CAN_F5R1_FB24
 ((
ut32_t
)0x01000000

	)

6687 
	#CAN_F5R1_FB25
 ((
ut32_t
)0x02000000

	)

6688 
	#CAN_F5R1_FB26
 ((
ut32_t
)0x04000000

	)

6689 
	#CAN_F5R1_FB27
 ((
ut32_t
)0x08000000

	)

6690 
	#CAN_F5R1_FB28
 ((
ut32_t
)0x10000000

	)

6691 
	#CAN_F5R1_FB29
 ((
ut32_t
)0x20000000

	)

6692 
	#CAN_F5R1_FB30
 ((
ut32_t
)0x40000000

	)

6693 
	#CAN_F5R1_FB31
 ((
ut32_t
)0x80000000

	)

6696 
	#CAN_F6R1_FB0
 ((
ut32_t
)0x00000001

	)

6697 
	#CAN_F6R1_FB1
 ((
ut32_t
)0x00000002

	)

6698 
	#CAN_F6R1_FB2
 ((
ut32_t
)0x00000004

	)

6699 
	#CAN_F6R1_FB3
 ((
ut32_t
)0x00000008

	)

6700 
	#CAN_F6R1_FB4
 ((
ut32_t
)0x00000010

	)

6701 
	#CAN_F6R1_FB5
 ((
ut32_t
)0x00000020

	)

6702 
	#CAN_F6R1_FB6
 ((
ut32_t
)0x00000040

	)

6703 
	#CAN_F6R1_FB7
 ((
ut32_t
)0x00000080

	)

6704 
	#CAN_F6R1_FB8
 ((
ut32_t
)0x00000100

	)

6705 
	#CAN_F6R1_FB9
 ((
ut32_t
)0x00000200

	)

6706 
	#CAN_F6R1_FB10
 ((
ut32_t
)0x00000400

	)

6707 
	#CAN_F6R1_FB11
 ((
ut32_t
)0x00000800

	)

6708 
	#CAN_F6R1_FB12
 ((
ut32_t
)0x00001000

	)

6709 
	#CAN_F6R1_FB13
 ((
ut32_t
)0x00002000

	)

6710 
	#CAN_F6R1_FB14
 ((
ut32_t
)0x00004000

	)

6711 
	#CAN_F6R1_FB15
 ((
ut32_t
)0x00008000

	)

6712 
	#CAN_F6R1_FB16
 ((
ut32_t
)0x00010000

	)

6713 
	#CAN_F6R1_FB17
 ((
ut32_t
)0x00020000

	)

6714 
	#CAN_F6R1_FB18
 ((
ut32_t
)0x00040000

	)

6715 
	#CAN_F6R1_FB19
 ((
ut32_t
)0x00080000

	)

6716 
	#CAN_F6R1_FB20
 ((
ut32_t
)0x00100000

	)

6717 
	#CAN_F6R1_FB21
 ((
ut32_t
)0x00200000

	)

6718 
	#CAN_F6R1_FB22
 ((
ut32_t
)0x00400000

	)

6719 
	#CAN_F6R1_FB23
 ((
ut32_t
)0x00800000

	)

6720 
	#CAN_F6R1_FB24
 ((
ut32_t
)0x01000000

	)

6721 
	#CAN_F6R1_FB25
 ((
ut32_t
)0x02000000

	)

6722 
	#CAN_F6R1_FB26
 ((
ut32_t
)0x04000000

	)

6723 
	#CAN_F6R1_FB27
 ((
ut32_t
)0x08000000

	)

6724 
	#CAN_F6R1_FB28
 ((
ut32_t
)0x10000000

	)

6725 
	#CAN_F6R1_FB29
 ((
ut32_t
)0x20000000

	)

6726 
	#CAN_F6R1_FB30
 ((
ut32_t
)0x40000000

	)

6727 
	#CAN_F6R1_FB31
 ((
ut32_t
)0x80000000

	)

6730 
	#CAN_F7R1_FB0
 ((
ut32_t
)0x00000001

	)

6731 
	#CAN_F7R1_FB1
 ((
ut32_t
)0x00000002

	)

6732 
	#CAN_F7R1_FB2
 ((
ut32_t
)0x00000004

	)

6733 
	#CAN_F7R1_FB3
 ((
ut32_t
)0x00000008

	)

6734 
	#CAN_F7R1_FB4
 ((
ut32_t
)0x00000010

	)

6735 
	#CAN_F7R1_FB5
 ((
ut32_t
)0x00000020

	)

6736 
	#CAN_F7R1_FB6
 ((
ut32_t
)0x00000040

	)

6737 
	#CAN_F7R1_FB7
 ((
ut32_t
)0x00000080

	)

6738 
	#CAN_F7R1_FB8
 ((
ut32_t
)0x00000100

	)

6739 
	#CAN_F7R1_FB9
 ((
ut32_t
)0x00000200

	)

6740 
	#CAN_F7R1_FB10
 ((
ut32_t
)0x00000400

	)

6741 
	#CAN_F7R1_FB11
 ((
ut32_t
)0x00000800

	)

6742 
	#CAN_F7R1_FB12
 ((
ut32_t
)0x00001000

	)

6743 
	#CAN_F7R1_FB13
 ((
ut32_t
)0x00002000

	)

6744 
	#CAN_F7R1_FB14
 ((
ut32_t
)0x00004000

	)

6745 
	#CAN_F7R1_FB15
 ((
ut32_t
)0x00008000

	)

6746 
	#CAN_F7R1_FB16
 ((
ut32_t
)0x00010000

	)

6747 
	#CAN_F7R1_FB17
 ((
ut32_t
)0x00020000

	)

6748 
	#CAN_F7R1_FB18
 ((
ut32_t
)0x00040000

	)

6749 
	#CAN_F7R1_FB19
 ((
ut32_t
)0x00080000

	)

6750 
	#CAN_F7R1_FB20
 ((
ut32_t
)0x00100000

	)

6751 
	#CAN_F7R1_FB21
 ((
ut32_t
)0x00200000

	)

6752 
	#CAN_F7R1_FB22
 ((
ut32_t
)0x00400000

	)

6753 
	#CAN_F7R1_FB23
 ((
ut32_t
)0x00800000

	)

6754 
	#CAN_F7R1_FB24
 ((
ut32_t
)0x01000000

	)

6755 
	#CAN_F7R1_FB25
 ((
ut32_t
)0x02000000

	)

6756 
	#CAN_F7R1_FB26
 ((
ut32_t
)0x04000000

	)

6757 
	#CAN_F7R1_FB27
 ((
ut32_t
)0x08000000

	)

6758 
	#CAN_F7R1_FB28
 ((
ut32_t
)0x10000000

	)

6759 
	#CAN_F7R1_FB29
 ((
ut32_t
)0x20000000

	)

6760 
	#CAN_F7R1_FB30
 ((
ut32_t
)0x40000000

	)

6761 
	#CAN_F7R1_FB31
 ((
ut32_t
)0x80000000

	)

6764 
	#CAN_F8R1_FB0
 ((
ut32_t
)0x00000001

	)

6765 
	#CAN_F8R1_FB1
 ((
ut32_t
)0x00000002

	)

6766 
	#CAN_F8R1_FB2
 ((
ut32_t
)0x00000004

	)

6767 
	#CAN_F8R1_FB3
 ((
ut32_t
)0x00000008

	)

6768 
	#CAN_F8R1_FB4
 ((
ut32_t
)0x00000010

	)

6769 
	#CAN_F8R1_FB5
 ((
ut32_t
)0x00000020

	)

6770 
	#CAN_F8R1_FB6
 ((
ut32_t
)0x00000040

	)

6771 
	#CAN_F8R1_FB7
 ((
ut32_t
)0x00000080

	)

6772 
	#CAN_F8R1_FB8
 ((
ut32_t
)0x00000100

	)

6773 
	#CAN_F8R1_FB9
 ((
ut32_t
)0x00000200

	)

6774 
	#CAN_F8R1_FB10
 ((
ut32_t
)0x00000400

	)

6775 
	#CAN_F8R1_FB11
 ((
ut32_t
)0x00000800

	)

6776 
	#CAN_F8R1_FB12
 ((
ut32_t
)0x00001000

	)

6777 
	#CAN_F8R1_FB13
 ((
ut32_t
)0x00002000

	)

6778 
	#CAN_F8R1_FB14
 ((
ut32_t
)0x00004000

	)

6779 
	#CAN_F8R1_FB15
 ((
ut32_t
)0x00008000

	)

6780 
	#CAN_F8R1_FB16
 ((
ut32_t
)0x00010000

	)

6781 
	#CAN_F8R1_FB17
 ((
ut32_t
)0x00020000

	)

6782 
	#CAN_F8R1_FB18
 ((
ut32_t
)0x00040000

	)

6783 
	#CAN_F8R1_FB19
 ((
ut32_t
)0x00080000

	)

6784 
	#CAN_F8R1_FB20
 ((
ut32_t
)0x00100000

	)

6785 
	#CAN_F8R1_FB21
 ((
ut32_t
)0x00200000

	)

6786 
	#CAN_F8R1_FB22
 ((
ut32_t
)0x00400000

	)

6787 
	#CAN_F8R1_FB23
 ((
ut32_t
)0x00800000

	)

6788 
	#CAN_F8R1_FB24
 ((
ut32_t
)0x01000000

	)

6789 
	#CAN_F8R1_FB25
 ((
ut32_t
)0x02000000

	)

6790 
	#CAN_F8R1_FB26
 ((
ut32_t
)0x04000000

	)

6791 
	#CAN_F8R1_FB27
 ((
ut32_t
)0x08000000

	)

6792 
	#CAN_F8R1_FB28
 ((
ut32_t
)0x10000000

	)

6793 
	#CAN_F8R1_FB29
 ((
ut32_t
)0x20000000

	)

6794 
	#CAN_F8R1_FB30
 ((
ut32_t
)0x40000000

	)

6795 
	#CAN_F8R1_FB31
 ((
ut32_t
)0x80000000

	)

6798 
	#CAN_F9R1_FB0
 ((
ut32_t
)0x00000001

	)

6799 
	#CAN_F9R1_FB1
 ((
ut32_t
)0x00000002

	)

6800 
	#CAN_F9R1_FB2
 ((
ut32_t
)0x00000004

	)

6801 
	#CAN_F9R1_FB3
 ((
ut32_t
)0x00000008

	)

6802 
	#CAN_F9R1_FB4
 ((
ut32_t
)0x00000010

	)

6803 
	#CAN_F9R1_FB5
 ((
ut32_t
)0x00000020

	)

6804 
	#CAN_F9R1_FB6
 ((
ut32_t
)0x00000040

	)

6805 
	#CAN_F9R1_FB7
 ((
ut32_t
)0x00000080

	)

6806 
	#CAN_F9R1_FB8
 ((
ut32_t
)0x00000100

	)

6807 
	#CAN_F9R1_FB9
 ((
ut32_t
)0x00000200

	)

6808 
	#CAN_F9R1_FB10
 ((
ut32_t
)0x00000400

	)

6809 
	#CAN_F9R1_FB11
 ((
ut32_t
)0x00000800

	)

6810 
	#CAN_F9R1_FB12
 ((
ut32_t
)0x00001000

	)

6811 
	#CAN_F9R1_FB13
 ((
ut32_t
)0x00002000

	)

6812 
	#CAN_F9R1_FB14
 ((
ut32_t
)0x00004000

	)

6813 
	#CAN_F9R1_FB15
 ((
ut32_t
)0x00008000

	)

6814 
	#CAN_F9R1_FB16
 ((
ut32_t
)0x00010000

	)

6815 
	#CAN_F9R1_FB17
 ((
ut32_t
)0x00020000

	)

6816 
	#CAN_F9R1_FB18
 ((
ut32_t
)0x00040000

	)

6817 
	#CAN_F9R1_FB19
 ((
ut32_t
)0x00080000

	)

6818 
	#CAN_F9R1_FB20
 ((
ut32_t
)0x00100000

	)

6819 
	#CAN_F9R1_FB21
 ((
ut32_t
)0x00200000

	)

6820 
	#CAN_F9R1_FB22
 ((
ut32_t
)0x00400000

	)

6821 
	#CAN_F9R1_FB23
 ((
ut32_t
)0x00800000

	)

6822 
	#CAN_F9R1_FB24
 ((
ut32_t
)0x01000000

	)

6823 
	#CAN_F9R1_FB25
 ((
ut32_t
)0x02000000

	)

6824 
	#CAN_F9R1_FB26
 ((
ut32_t
)0x04000000

	)

6825 
	#CAN_F9R1_FB27
 ((
ut32_t
)0x08000000

	)

6826 
	#CAN_F9R1_FB28
 ((
ut32_t
)0x10000000

	)

6827 
	#CAN_F9R1_FB29
 ((
ut32_t
)0x20000000

	)

6828 
	#CAN_F9R1_FB30
 ((
ut32_t
)0x40000000

	)

6829 
	#CAN_F9R1_FB31
 ((
ut32_t
)0x80000000

	)

6832 
	#CAN_F10R1_FB0
 ((
ut32_t
)0x00000001

	)

6833 
	#CAN_F10R1_FB1
 ((
ut32_t
)0x00000002

	)

6834 
	#CAN_F10R1_FB2
 ((
ut32_t
)0x00000004

	)

6835 
	#CAN_F10R1_FB3
 ((
ut32_t
)0x00000008

	)

6836 
	#CAN_F10R1_FB4
 ((
ut32_t
)0x00000010

	)

6837 
	#CAN_F10R1_FB5
 ((
ut32_t
)0x00000020

	)

6838 
	#CAN_F10R1_FB6
 ((
ut32_t
)0x00000040

	)

6839 
	#CAN_F10R1_FB7
 ((
ut32_t
)0x00000080

	)

6840 
	#CAN_F10R1_FB8
 ((
ut32_t
)0x00000100

	)

6841 
	#CAN_F10R1_FB9
 ((
ut32_t
)0x00000200

	)

6842 
	#CAN_F10R1_FB10
 ((
ut32_t
)0x00000400

	)

6843 
	#CAN_F10R1_FB11
 ((
ut32_t
)0x00000800

	)

6844 
	#CAN_F10R1_FB12
 ((
ut32_t
)0x00001000

	)

6845 
	#CAN_F10R1_FB13
 ((
ut32_t
)0x00002000

	)

6846 
	#CAN_F10R1_FB14
 ((
ut32_t
)0x00004000

	)

6847 
	#CAN_F10R1_FB15
 ((
ut32_t
)0x00008000

	)

6848 
	#CAN_F10R1_FB16
 ((
ut32_t
)0x00010000

	)

6849 
	#CAN_F10R1_FB17
 ((
ut32_t
)0x00020000

	)

6850 
	#CAN_F10R1_FB18
 ((
ut32_t
)0x00040000

	)

6851 
	#CAN_F10R1_FB19
 ((
ut32_t
)0x00080000

	)

6852 
	#CAN_F10R1_FB20
 ((
ut32_t
)0x00100000

	)

6853 
	#CAN_F10R1_FB21
 ((
ut32_t
)0x00200000

	)

6854 
	#CAN_F10R1_FB22
 ((
ut32_t
)0x00400000

	)

6855 
	#CAN_F10R1_FB23
 ((
ut32_t
)0x00800000

	)

6856 
	#CAN_F10R1_FB24
 ((
ut32_t
)0x01000000

	)

6857 
	#CAN_F10R1_FB25
 ((
ut32_t
)0x02000000

	)

6858 
	#CAN_F10R1_FB26
 ((
ut32_t
)0x04000000

	)

6859 
	#CAN_F10R1_FB27
 ((
ut32_t
)0x08000000

	)

6860 
	#CAN_F10R1_FB28
 ((
ut32_t
)0x10000000

	)

6861 
	#CAN_F10R1_FB29
 ((
ut32_t
)0x20000000

	)

6862 
	#CAN_F10R1_FB30
 ((
ut32_t
)0x40000000

	)

6863 
	#CAN_F10R1_FB31
 ((
ut32_t
)0x80000000

	)

6866 
	#CAN_F11R1_FB0
 ((
ut32_t
)0x00000001

	)

6867 
	#CAN_F11R1_FB1
 ((
ut32_t
)0x00000002

	)

6868 
	#CAN_F11R1_FB2
 ((
ut32_t
)0x00000004

	)

6869 
	#CAN_F11R1_FB3
 ((
ut32_t
)0x00000008

	)

6870 
	#CAN_F11R1_FB4
 ((
ut32_t
)0x00000010

	)

6871 
	#CAN_F11R1_FB5
 ((
ut32_t
)0x00000020

	)

6872 
	#CAN_F11R1_FB6
 ((
ut32_t
)0x00000040

	)

6873 
	#CAN_F11R1_FB7
 ((
ut32_t
)0x00000080

	)

6874 
	#CAN_F11R1_FB8
 ((
ut32_t
)0x00000100

	)

6875 
	#CAN_F11R1_FB9
 ((
ut32_t
)0x00000200

	)

6876 
	#CAN_F11R1_FB10
 ((
ut32_t
)0x00000400

	)

6877 
	#CAN_F11R1_FB11
 ((
ut32_t
)0x00000800

	)

6878 
	#CAN_F11R1_FB12
 ((
ut32_t
)0x00001000

	)

6879 
	#CAN_F11R1_FB13
 ((
ut32_t
)0x00002000

	)

6880 
	#CAN_F11R1_FB14
 ((
ut32_t
)0x00004000

	)

6881 
	#CAN_F11R1_FB15
 ((
ut32_t
)0x00008000

	)

6882 
	#CAN_F11R1_FB16
 ((
ut32_t
)0x00010000

	)

6883 
	#CAN_F11R1_FB17
 ((
ut32_t
)0x00020000

	)

6884 
	#CAN_F11R1_FB18
 ((
ut32_t
)0x00040000

	)

6885 
	#CAN_F11R1_FB19
 ((
ut32_t
)0x00080000

	)

6886 
	#CAN_F11R1_FB20
 ((
ut32_t
)0x00100000

	)

6887 
	#CAN_F11R1_FB21
 ((
ut32_t
)0x00200000

	)

6888 
	#CAN_F11R1_FB22
 ((
ut32_t
)0x00400000

	)

6889 
	#CAN_F11R1_FB23
 ((
ut32_t
)0x00800000

	)

6890 
	#CAN_F11R1_FB24
 ((
ut32_t
)0x01000000

	)

6891 
	#CAN_F11R1_FB25
 ((
ut32_t
)0x02000000

	)

6892 
	#CAN_F11R1_FB26
 ((
ut32_t
)0x04000000

	)

6893 
	#CAN_F11R1_FB27
 ((
ut32_t
)0x08000000

	)

6894 
	#CAN_F11R1_FB28
 ((
ut32_t
)0x10000000

	)

6895 
	#CAN_F11R1_FB29
 ((
ut32_t
)0x20000000

	)

6896 
	#CAN_F11R1_FB30
 ((
ut32_t
)0x40000000

	)

6897 
	#CAN_F11R1_FB31
 ((
ut32_t
)0x80000000

	)

6900 
	#CAN_F12R1_FB0
 ((
ut32_t
)0x00000001

	)

6901 
	#CAN_F12R1_FB1
 ((
ut32_t
)0x00000002

	)

6902 
	#CAN_F12R1_FB2
 ((
ut32_t
)0x00000004

	)

6903 
	#CAN_F12R1_FB3
 ((
ut32_t
)0x00000008

	)

6904 
	#CAN_F12R1_FB4
 ((
ut32_t
)0x00000010

	)

6905 
	#CAN_F12R1_FB5
 ((
ut32_t
)0x00000020

	)

6906 
	#CAN_F12R1_FB6
 ((
ut32_t
)0x00000040

	)

6907 
	#CAN_F12R1_FB7
 ((
ut32_t
)0x00000080

	)

6908 
	#CAN_F12R1_FB8
 ((
ut32_t
)0x00000100

	)

6909 
	#CAN_F12R1_FB9
 ((
ut32_t
)0x00000200

	)

6910 
	#CAN_F12R1_FB10
 ((
ut32_t
)0x00000400

	)

6911 
	#CAN_F12R1_FB11
 ((
ut32_t
)0x00000800

	)

6912 
	#CAN_F12R1_FB12
 ((
ut32_t
)0x00001000

	)

6913 
	#CAN_F12R1_FB13
 ((
ut32_t
)0x00002000

	)

6914 
	#CAN_F12R1_FB14
 ((
ut32_t
)0x00004000

	)

6915 
	#CAN_F12R1_FB15
 ((
ut32_t
)0x00008000

	)

6916 
	#CAN_F12R1_FB16
 ((
ut32_t
)0x00010000

	)

6917 
	#CAN_F12R1_FB17
 ((
ut32_t
)0x00020000

	)

6918 
	#CAN_F12R1_FB18
 ((
ut32_t
)0x00040000

	)

6919 
	#CAN_F12R1_FB19
 ((
ut32_t
)0x00080000

	)

6920 
	#CAN_F12R1_FB20
 ((
ut32_t
)0x00100000

	)

6921 
	#CAN_F12R1_FB21
 ((
ut32_t
)0x00200000

	)

6922 
	#CAN_F12R1_FB22
 ((
ut32_t
)0x00400000

	)

6923 
	#CAN_F12R1_FB23
 ((
ut32_t
)0x00800000

	)

6924 
	#CAN_F12R1_FB24
 ((
ut32_t
)0x01000000

	)

6925 
	#CAN_F12R1_FB25
 ((
ut32_t
)0x02000000

	)

6926 
	#CAN_F12R1_FB26
 ((
ut32_t
)0x04000000

	)

6927 
	#CAN_F12R1_FB27
 ((
ut32_t
)0x08000000

	)

6928 
	#CAN_F12R1_FB28
 ((
ut32_t
)0x10000000

	)

6929 
	#CAN_F12R1_FB29
 ((
ut32_t
)0x20000000

	)

6930 
	#CAN_F12R1_FB30
 ((
ut32_t
)0x40000000

	)

6931 
	#CAN_F12R1_FB31
 ((
ut32_t
)0x80000000

	)

6934 
	#CAN_F13R1_FB0
 ((
ut32_t
)0x00000001

	)

6935 
	#CAN_F13R1_FB1
 ((
ut32_t
)0x00000002

	)

6936 
	#CAN_F13R1_FB2
 ((
ut32_t
)0x00000004

	)

6937 
	#CAN_F13R1_FB3
 ((
ut32_t
)0x00000008

	)

6938 
	#CAN_F13R1_FB4
 ((
ut32_t
)0x00000010

	)

6939 
	#CAN_F13R1_FB5
 ((
ut32_t
)0x00000020

	)

6940 
	#CAN_F13R1_FB6
 ((
ut32_t
)0x00000040

	)

6941 
	#CAN_F13R1_FB7
 ((
ut32_t
)0x00000080

	)

6942 
	#CAN_F13R1_FB8
 ((
ut32_t
)0x00000100

	)

6943 
	#CAN_F13R1_FB9
 ((
ut32_t
)0x00000200

	)

6944 
	#CAN_F13R1_FB10
 ((
ut32_t
)0x00000400

	)

6945 
	#CAN_F13R1_FB11
 ((
ut32_t
)0x00000800

	)

6946 
	#CAN_F13R1_FB12
 ((
ut32_t
)0x00001000

	)

6947 
	#CAN_F13R1_FB13
 ((
ut32_t
)0x00002000

	)

6948 
	#CAN_F13R1_FB14
 ((
ut32_t
)0x00004000

	)

6949 
	#CAN_F13R1_FB15
 ((
ut32_t
)0x00008000

	)

6950 
	#CAN_F13R1_FB16
 ((
ut32_t
)0x00010000

	)

6951 
	#CAN_F13R1_FB17
 ((
ut32_t
)0x00020000

	)

6952 
	#CAN_F13R1_FB18
 ((
ut32_t
)0x00040000

	)

6953 
	#CAN_F13R1_FB19
 ((
ut32_t
)0x00080000

	)

6954 
	#CAN_F13R1_FB20
 ((
ut32_t
)0x00100000

	)

6955 
	#CAN_F13R1_FB21
 ((
ut32_t
)0x00200000

	)

6956 
	#CAN_F13R1_FB22
 ((
ut32_t
)0x00400000

	)

6957 
	#CAN_F13R1_FB23
 ((
ut32_t
)0x00800000

	)

6958 
	#CAN_F13R1_FB24
 ((
ut32_t
)0x01000000

	)

6959 
	#CAN_F13R1_FB25
 ((
ut32_t
)0x02000000

	)

6960 
	#CAN_F13R1_FB26
 ((
ut32_t
)0x04000000

	)

6961 
	#CAN_F13R1_FB27
 ((
ut32_t
)0x08000000

	)

6962 
	#CAN_F13R1_FB28
 ((
ut32_t
)0x10000000

	)

6963 
	#CAN_F13R1_FB29
 ((
ut32_t
)0x20000000

	)

6964 
	#CAN_F13R1_FB30
 ((
ut32_t
)0x40000000

	)

6965 
	#CAN_F13R1_FB31
 ((
ut32_t
)0x80000000

	)

6968 
	#CAN_F0R2_FB0
 ((
ut32_t
)0x00000001

	)

6969 
	#CAN_F0R2_FB1
 ((
ut32_t
)0x00000002

	)

6970 
	#CAN_F0R2_FB2
 ((
ut32_t
)0x00000004

	)

6971 
	#CAN_F0R2_FB3
 ((
ut32_t
)0x00000008

	)

6972 
	#CAN_F0R2_FB4
 ((
ut32_t
)0x00000010

	)

6973 
	#CAN_F0R2_FB5
 ((
ut32_t
)0x00000020

	)

6974 
	#CAN_F0R2_FB6
 ((
ut32_t
)0x00000040

	)

6975 
	#CAN_F0R2_FB7
 ((
ut32_t
)0x00000080

	)

6976 
	#CAN_F0R2_FB8
 ((
ut32_t
)0x00000100

	)

6977 
	#CAN_F0R2_FB9
 ((
ut32_t
)0x00000200

	)

6978 
	#CAN_F0R2_FB10
 ((
ut32_t
)0x00000400

	)

6979 
	#CAN_F0R2_FB11
 ((
ut32_t
)0x00000800

	)

6980 
	#CAN_F0R2_FB12
 ((
ut32_t
)0x00001000

	)

6981 
	#CAN_F0R2_FB13
 ((
ut32_t
)0x00002000

	)

6982 
	#CAN_F0R2_FB14
 ((
ut32_t
)0x00004000

	)

6983 
	#CAN_F0R2_FB15
 ((
ut32_t
)0x00008000

	)

6984 
	#CAN_F0R2_FB16
 ((
ut32_t
)0x00010000

	)

6985 
	#CAN_F0R2_FB17
 ((
ut32_t
)0x00020000

	)

6986 
	#CAN_F0R2_FB18
 ((
ut32_t
)0x00040000

	)

6987 
	#CAN_F0R2_FB19
 ((
ut32_t
)0x00080000

	)

6988 
	#CAN_F0R2_FB20
 ((
ut32_t
)0x00100000

	)

6989 
	#CAN_F0R2_FB21
 ((
ut32_t
)0x00200000

	)

6990 
	#CAN_F0R2_FB22
 ((
ut32_t
)0x00400000

	)

6991 
	#CAN_F0R2_FB23
 ((
ut32_t
)0x00800000

	)

6992 
	#CAN_F0R2_FB24
 ((
ut32_t
)0x01000000

	)

6993 
	#CAN_F0R2_FB25
 ((
ut32_t
)0x02000000

	)

6994 
	#CAN_F0R2_FB26
 ((
ut32_t
)0x04000000

	)

6995 
	#CAN_F0R2_FB27
 ((
ut32_t
)0x08000000

	)

6996 
	#CAN_F0R2_FB28
 ((
ut32_t
)0x10000000

	)

6997 
	#CAN_F0R2_FB29
 ((
ut32_t
)0x20000000

	)

6998 
	#CAN_F0R2_FB30
 ((
ut32_t
)0x40000000

	)

6999 
	#CAN_F0R2_FB31
 ((
ut32_t
)0x80000000

	)

7002 
	#CAN_F1R2_FB0
 ((
ut32_t
)0x00000001

	)

7003 
	#CAN_F1R2_FB1
 ((
ut32_t
)0x00000002

	)

7004 
	#CAN_F1R2_FB2
 ((
ut32_t
)0x00000004

	)

7005 
	#CAN_F1R2_FB3
 ((
ut32_t
)0x00000008

	)

7006 
	#CAN_F1R2_FB4
 ((
ut32_t
)0x00000010

	)

7007 
	#CAN_F1R2_FB5
 ((
ut32_t
)0x00000020

	)

7008 
	#CAN_F1R2_FB6
 ((
ut32_t
)0x00000040

	)

7009 
	#CAN_F1R2_FB7
 ((
ut32_t
)0x00000080

	)

7010 
	#CAN_F1R2_FB8
 ((
ut32_t
)0x00000100

	)

7011 
	#CAN_F1R2_FB9
 ((
ut32_t
)0x00000200

	)

7012 
	#CAN_F1R2_FB10
 ((
ut32_t
)0x00000400

	)

7013 
	#CAN_F1R2_FB11
 ((
ut32_t
)0x00000800

	)

7014 
	#CAN_F1R2_FB12
 ((
ut32_t
)0x00001000

	)

7015 
	#CAN_F1R2_FB13
 ((
ut32_t
)0x00002000

	)

7016 
	#CAN_F1R2_FB14
 ((
ut32_t
)0x00004000

	)

7017 
	#CAN_F1R2_FB15
 ((
ut32_t
)0x00008000

	)

7018 
	#CAN_F1R2_FB16
 ((
ut32_t
)0x00010000

	)

7019 
	#CAN_F1R2_FB17
 ((
ut32_t
)0x00020000

	)

7020 
	#CAN_F1R2_FB18
 ((
ut32_t
)0x00040000

	)

7021 
	#CAN_F1R2_FB19
 ((
ut32_t
)0x00080000

	)

7022 
	#CAN_F1R2_FB20
 ((
ut32_t
)0x00100000

	)

7023 
	#CAN_F1R2_FB21
 ((
ut32_t
)0x00200000

	)

7024 
	#CAN_F1R2_FB22
 ((
ut32_t
)0x00400000

	)

7025 
	#CAN_F1R2_FB23
 ((
ut32_t
)0x00800000

	)

7026 
	#CAN_F1R2_FB24
 ((
ut32_t
)0x01000000

	)

7027 
	#CAN_F1R2_FB25
 ((
ut32_t
)0x02000000

	)

7028 
	#CAN_F1R2_FB26
 ((
ut32_t
)0x04000000

	)

7029 
	#CAN_F1R2_FB27
 ((
ut32_t
)0x08000000

	)

7030 
	#CAN_F1R2_FB28
 ((
ut32_t
)0x10000000

	)

7031 
	#CAN_F1R2_FB29
 ((
ut32_t
)0x20000000

	)

7032 
	#CAN_F1R2_FB30
 ((
ut32_t
)0x40000000

	)

7033 
	#CAN_F1R2_FB31
 ((
ut32_t
)0x80000000

	)

7036 
	#CAN_F2R2_FB0
 ((
ut32_t
)0x00000001

	)

7037 
	#CAN_F2R2_FB1
 ((
ut32_t
)0x00000002

	)

7038 
	#CAN_F2R2_FB2
 ((
ut32_t
)0x00000004

	)

7039 
	#CAN_F2R2_FB3
 ((
ut32_t
)0x00000008

	)

7040 
	#CAN_F2R2_FB4
 ((
ut32_t
)0x00000010

	)

7041 
	#CAN_F2R2_FB5
 ((
ut32_t
)0x00000020

	)

7042 
	#CAN_F2R2_FB6
 ((
ut32_t
)0x00000040

	)

7043 
	#CAN_F2R2_FB7
 ((
ut32_t
)0x00000080

	)

7044 
	#CAN_F2R2_FB8
 ((
ut32_t
)0x00000100

	)

7045 
	#CAN_F2R2_FB9
 ((
ut32_t
)0x00000200

	)

7046 
	#CAN_F2R2_FB10
 ((
ut32_t
)0x00000400

	)

7047 
	#CAN_F2R2_FB11
 ((
ut32_t
)0x00000800

	)

7048 
	#CAN_F2R2_FB12
 ((
ut32_t
)0x00001000

	)

7049 
	#CAN_F2R2_FB13
 ((
ut32_t
)0x00002000

	)

7050 
	#CAN_F2R2_FB14
 ((
ut32_t
)0x00004000

	)

7051 
	#CAN_F2R2_FB15
 ((
ut32_t
)0x00008000

	)

7052 
	#CAN_F2R2_FB16
 ((
ut32_t
)0x00010000

	)

7053 
	#CAN_F2R2_FB17
 ((
ut32_t
)0x00020000

	)

7054 
	#CAN_F2R2_FB18
 ((
ut32_t
)0x00040000

	)

7055 
	#CAN_F2R2_FB19
 ((
ut32_t
)0x00080000

	)

7056 
	#CAN_F2R2_FB20
 ((
ut32_t
)0x00100000

	)

7057 
	#CAN_F2R2_FB21
 ((
ut32_t
)0x00200000

	)

7058 
	#CAN_F2R2_FB22
 ((
ut32_t
)0x00400000

	)

7059 
	#CAN_F2R2_FB23
 ((
ut32_t
)0x00800000

	)

7060 
	#CAN_F2R2_FB24
 ((
ut32_t
)0x01000000

	)

7061 
	#CAN_F2R2_FB25
 ((
ut32_t
)0x02000000

	)

7062 
	#CAN_F2R2_FB26
 ((
ut32_t
)0x04000000

	)

7063 
	#CAN_F2R2_FB27
 ((
ut32_t
)0x08000000

	)

7064 
	#CAN_F2R2_FB28
 ((
ut32_t
)0x10000000

	)

7065 
	#CAN_F2R2_FB29
 ((
ut32_t
)0x20000000

	)

7066 
	#CAN_F2R2_FB30
 ((
ut32_t
)0x40000000

	)

7067 
	#CAN_F2R2_FB31
 ((
ut32_t
)0x80000000

	)

7070 
	#CAN_F3R2_FB0
 ((
ut32_t
)0x00000001

	)

7071 
	#CAN_F3R2_FB1
 ((
ut32_t
)0x00000002

	)

7072 
	#CAN_F3R2_FB2
 ((
ut32_t
)0x00000004

	)

7073 
	#CAN_F3R2_FB3
 ((
ut32_t
)0x00000008

	)

7074 
	#CAN_F3R2_FB4
 ((
ut32_t
)0x00000010

	)

7075 
	#CAN_F3R2_FB5
 ((
ut32_t
)0x00000020

	)

7076 
	#CAN_F3R2_FB6
 ((
ut32_t
)0x00000040

	)

7077 
	#CAN_F3R2_FB7
 ((
ut32_t
)0x00000080

	)

7078 
	#CAN_F3R2_FB8
 ((
ut32_t
)0x00000100

	)

7079 
	#CAN_F3R2_FB9
 ((
ut32_t
)0x00000200

	)

7080 
	#CAN_F3R2_FB10
 ((
ut32_t
)0x00000400

	)

7081 
	#CAN_F3R2_FB11
 ((
ut32_t
)0x00000800

	)

7082 
	#CAN_F3R2_FB12
 ((
ut32_t
)0x00001000

	)

7083 
	#CAN_F3R2_FB13
 ((
ut32_t
)0x00002000

	)

7084 
	#CAN_F3R2_FB14
 ((
ut32_t
)0x00004000

	)

7085 
	#CAN_F3R2_FB15
 ((
ut32_t
)0x00008000

	)

7086 
	#CAN_F3R2_FB16
 ((
ut32_t
)0x00010000

	)

7087 
	#CAN_F3R2_FB17
 ((
ut32_t
)0x00020000

	)

7088 
	#CAN_F3R2_FB18
 ((
ut32_t
)0x00040000

	)

7089 
	#CAN_F3R2_FB19
 ((
ut32_t
)0x00080000

	)

7090 
	#CAN_F3R2_FB20
 ((
ut32_t
)0x00100000

	)

7091 
	#CAN_F3R2_FB21
 ((
ut32_t
)0x00200000

	)

7092 
	#CAN_F3R2_FB22
 ((
ut32_t
)0x00400000

	)

7093 
	#CAN_F3R2_FB23
 ((
ut32_t
)0x00800000

	)

7094 
	#CAN_F3R2_FB24
 ((
ut32_t
)0x01000000

	)

7095 
	#CAN_F3R2_FB25
 ((
ut32_t
)0x02000000

	)

7096 
	#CAN_F3R2_FB26
 ((
ut32_t
)0x04000000

	)

7097 
	#CAN_F3R2_FB27
 ((
ut32_t
)0x08000000

	)

7098 
	#CAN_F3R2_FB28
 ((
ut32_t
)0x10000000

	)

7099 
	#CAN_F3R2_FB29
 ((
ut32_t
)0x20000000

	)

7100 
	#CAN_F3R2_FB30
 ((
ut32_t
)0x40000000

	)

7101 
	#CAN_F3R2_FB31
 ((
ut32_t
)0x80000000

	)

7104 
	#CAN_F4R2_FB0
 ((
ut32_t
)0x00000001

	)

7105 
	#CAN_F4R2_FB1
 ((
ut32_t
)0x00000002

	)

7106 
	#CAN_F4R2_FB2
 ((
ut32_t
)0x00000004

	)

7107 
	#CAN_F4R2_FB3
 ((
ut32_t
)0x00000008

	)

7108 
	#CAN_F4R2_FB4
 ((
ut32_t
)0x00000010

	)

7109 
	#CAN_F4R2_FB5
 ((
ut32_t
)0x00000020

	)

7110 
	#CAN_F4R2_FB6
 ((
ut32_t
)0x00000040

	)

7111 
	#CAN_F4R2_FB7
 ((
ut32_t
)0x00000080

	)

7112 
	#CAN_F4R2_FB8
 ((
ut32_t
)0x00000100

	)

7113 
	#CAN_F4R2_FB9
 ((
ut32_t
)0x00000200

	)

7114 
	#CAN_F4R2_FB10
 ((
ut32_t
)0x00000400

	)

7115 
	#CAN_F4R2_FB11
 ((
ut32_t
)0x00000800

	)

7116 
	#CAN_F4R2_FB12
 ((
ut32_t
)0x00001000

	)

7117 
	#CAN_F4R2_FB13
 ((
ut32_t
)0x00002000

	)

7118 
	#CAN_F4R2_FB14
 ((
ut32_t
)0x00004000

	)

7119 
	#CAN_F4R2_FB15
 ((
ut32_t
)0x00008000

	)

7120 
	#CAN_F4R2_FB16
 ((
ut32_t
)0x00010000

	)

7121 
	#CAN_F4R2_FB17
 ((
ut32_t
)0x00020000

	)

7122 
	#CAN_F4R2_FB18
 ((
ut32_t
)0x00040000

	)

7123 
	#CAN_F4R2_FB19
 ((
ut32_t
)0x00080000

	)

7124 
	#CAN_F4R2_FB20
 ((
ut32_t
)0x00100000

	)

7125 
	#CAN_F4R2_FB21
 ((
ut32_t
)0x00200000

	)

7126 
	#CAN_F4R2_FB22
 ((
ut32_t
)0x00400000

	)

7127 
	#CAN_F4R2_FB23
 ((
ut32_t
)0x00800000

	)

7128 
	#CAN_F4R2_FB24
 ((
ut32_t
)0x01000000

	)

7129 
	#CAN_F4R2_FB25
 ((
ut32_t
)0x02000000

	)

7130 
	#CAN_F4R2_FB26
 ((
ut32_t
)0x04000000

	)

7131 
	#CAN_F4R2_FB27
 ((
ut32_t
)0x08000000

	)

7132 
	#CAN_F4R2_FB28
 ((
ut32_t
)0x10000000

	)

7133 
	#CAN_F4R2_FB29
 ((
ut32_t
)0x20000000

	)

7134 
	#CAN_F4R2_FB30
 ((
ut32_t
)0x40000000

	)

7135 
	#CAN_F4R2_FB31
 ((
ut32_t
)0x80000000

	)

7138 
	#CAN_F5R2_FB0
 ((
ut32_t
)0x00000001

	)

7139 
	#CAN_F5R2_FB1
 ((
ut32_t
)0x00000002

	)

7140 
	#CAN_F5R2_FB2
 ((
ut32_t
)0x00000004

	)

7141 
	#CAN_F5R2_FB3
 ((
ut32_t
)0x00000008

	)

7142 
	#CAN_F5R2_FB4
 ((
ut32_t
)0x00000010

	)

7143 
	#CAN_F5R2_FB5
 ((
ut32_t
)0x00000020

	)

7144 
	#CAN_F5R2_FB6
 ((
ut32_t
)0x00000040

	)

7145 
	#CAN_F5R2_FB7
 ((
ut32_t
)0x00000080

	)

7146 
	#CAN_F5R2_FB8
 ((
ut32_t
)0x00000100

	)

7147 
	#CAN_F5R2_FB9
 ((
ut32_t
)0x00000200

	)

7148 
	#CAN_F5R2_FB10
 ((
ut32_t
)0x00000400

	)

7149 
	#CAN_F5R2_FB11
 ((
ut32_t
)0x00000800

	)

7150 
	#CAN_F5R2_FB12
 ((
ut32_t
)0x00001000

	)

7151 
	#CAN_F5R2_FB13
 ((
ut32_t
)0x00002000

	)

7152 
	#CAN_F5R2_FB14
 ((
ut32_t
)0x00004000

	)

7153 
	#CAN_F5R2_FB15
 ((
ut32_t
)0x00008000

	)

7154 
	#CAN_F5R2_FB16
 ((
ut32_t
)0x00010000

	)

7155 
	#CAN_F5R2_FB17
 ((
ut32_t
)0x00020000

	)

7156 
	#CAN_F5R2_FB18
 ((
ut32_t
)0x00040000

	)

7157 
	#CAN_F5R2_FB19
 ((
ut32_t
)0x00080000

	)

7158 
	#CAN_F5R2_FB20
 ((
ut32_t
)0x00100000

	)

7159 
	#CAN_F5R2_FB21
 ((
ut32_t
)0x00200000

	)

7160 
	#CAN_F5R2_FB22
 ((
ut32_t
)0x00400000

	)

7161 
	#CAN_F5R2_FB23
 ((
ut32_t
)0x00800000

	)

7162 
	#CAN_F5R2_FB24
 ((
ut32_t
)0x01000000

	)

7163 
	#CAN_F5R2_FB25
 ((
ut32_t
)0x02000000

	)

7164 
	#CAN_F5R2_FB26
 ((
ut32_t
)0x04000000

	)

7165 
	#CAN_F5R2_FB27
 ((
ut32_t
)0x08000000

	)

7166 
	#CAN_F5R2_FB28
 ((
ut32_t
)0x10000000

	)

7167 
	#CAN_F5R2_FB29
 ((
ut32_t
)0x20000000

	)

7168 
	#CAN_F5R2_FB30
 ((
ut32_t
)0x40000000

	)

7169 
	#CAN_F5R2_FB31
 ((
ut32_t
)0x80000000

	)

7172 
	#CAN_F6R2_FB0
 ((
ut32_t
)0x00000001

	)

7173 
	#CAN_F6R2_FB1
 ((
ut32_t
)0x00000002

	)

7174 
	#CAN_F6R2_FB2
 ((
ut32_t
)0x00000004

	)

7175 
	#CAN_F6R2_FB3
 ((
ut32_t
)0x00000008

	)

7176 
	#CAN_F6R2_FB4
 ((
ut32_t
)0x00000010

	)

7177 
	#CAN_F6R2_FB5
 ((
ut32_t
)0x00000020

	)

7178 
	#CAN_F6R2_FB6
 ((
ut32_t
)0x00000040

	)

7179 
	#CAN_F6R2_FB7
 ((
ut32_t
)0x00000080

	)

7180 
	#CAN_F6R2_FB8
 ((
ut32_t
)0x00000100

	)

7181 
	#CAN_F6R2_FB9
 ((
ut32_t
)0x00000200

	)

7182 
	#CAN_F6R2_FB10
 ((
ut32_t
)0x00000400

	)

7183 
	#CAN_F6R2_FB11
 ((
ut32_t
)0x00000800

	)

7184 
	#CAN_F6R2_FB12
 ((
ut32_t
)0x00001000

	)

7185 
	#CAN_F6R2_FB13
 ((
ut32_t
)0x00002000

	)

7186 
	#CAN_F6R2_FB14
 ((
ut32_t
)0x00004000

	)

7187 
	#CAN_F6R2_FB15
 ((
ut32_t
)0x00008000

	)

7188 
	#CAN_F6R2_FB16
 ((
ut32_t
)0x00010000

	)

7189 
	#CAN_F6R2_FB17
 ((
ut32_t
)0x00020000

	)

7190 
	#CAN_F6R2_FB18
 ((
ut32_t
)0x00040000

	)

7191 
	#CAN_F6R2_FB19
 ((
ut32_t
)0x00080000

	)

7192 
	#CAN_F6R2_FB20
 ((
ut32_t
)0x00100000

	)

7193 
	#CAN_F6R2_FB21
 ((
ut32_t
)0x00200000

	)

7194 
	#CAN_F6R2_FB22
 ((
ut32_t
)0x00400000

	)

7195 
	#CAN_F6R2_FB23
 ((
ut32_t
)0x00800000

	)

7196 
	#CAN_F6R2_FB24
 ((
ut32_t
)0x01000000

	)

7197 
	#CAN_F6R2_FB25
 ((
ut32_t
)0x02000000

	)

7198 
	#CAN_F6R2_FB26
 ((
ut32_t
)0x04000000

	)

7199 
	#CAN_F6R2_FB27
 ((
ut32_t
)0x08000000

	)

7200 
	#CAN_F6R2_FB28
 ((
ut32_t
)0x10000000

	)

7201 
	#CAN_F6R2_FB29
 ((
ut32_t
)0x20000000

	)

7202 
	#CAN_F6R2_FB30
 ((
ut32_t
)0x40000000

	)

7203 
	#CAN_F6R2_FB31
 ((
ut32_t
)0x80000000

	)

7206 
	#CAN_F7R2_FB0
 ((
ut32_t
)0x00000001

	)

7207 
	#CAN_F7R2_FB1
 ((
ut32_t
)0x00000002

	)

7208 
	#CAN_F7R2_FB2
 ((
ut32_t
)0x00000004

	)

7209 
	#CAN_F7R2_FB3
 ((
ut32_t
)0x00000008

	)

7210 
	#CAN_F7R2_FB4
 ((
ut32_t
)0x00000010

	)

7211 
	#CAN_F7R2_FB5
 ((
ut32_t
)0x00000020

	)

7212 
	#CAN_F7R2_FB6
 ((
ut32_t
)0x00000040

	)

7213 
	#CAN_F7R2_FB7
 ((
ut32_t
)0x00000080

	)

7214 
	#CAN_F7R2_FB8
 ((
ut32_t
)0x00000100

	)

7215 
	#CAN_F7R2_FB9
 ((
ut32_t
)0x00000200

	)

7216 
	#CAN_F7R2_FB10
 ((
ut32_t
)0x00000400

	)

7217 
	#CAN_F7R2_FB11
 ((
ut32_t
)0x00000800

	)

7218 
	#CAN_F7R2_FB12
 ((
ut32_t
)0x00001000

	)

7219 
	#CAN_F7R2_FB13
 ((
ut32_t
)0x00002000

	)

7220 
	#CAN_F7R2_FB14
 ((
ut32_t
)0x00004000

	)

7221 
	#CAN_F7R2_FB15
 ((
ut32_t
)0x00008000

	)

7222 
	#CAN_F7R2_FB16
 ((
ut32_t
)0x00010000

	)

7223 
	#CAN_F7R2_FB17
 ((
ut32_t
)0x00020000

	)

7224 
	#CAN_F7R2_FB18
 ((
ut32_t
)0x00040000

	)

7225 
	#CAN_F7R2_FB19
 ((
ut32_t
)0x00080000

	)

7226 
	#CAN_F7R2_FB20
 ((
ut32_t
)0x00100000

	)

7227 
	#CAN_F7R2_FB21
 ((
ut32_t
)0x00200000

	)

7228 
	#CAN_F7R2_FB22
 ((
ut32_t
)0x00400000

	)

7229 
	#CAN_F7R2_FB23
 ((
ut32_t
)0x00800000

	)

7230 
	#CAN_F7R2_FB24
 ((
ut32_t
)0x01000000

	)

7231 
	#CAN_F7R2_FB25
 ((
ut32_t
)0x02000000

	)

7232 
	#CAN_F7R2_FB26
 ((
ut32_t
)0x04000000

	)

7233 
	#CAN_F7R2_FB27
 ((
ut32_t
)0x08000000

	)

7234 
	#CAN_F7R2_FB28
 ((
ut32_t
)0x10000000

	)

7235 
	#CAN_F7R2_FB29
 ((
ut32_t
)0x20000000

	)

7236 
	#CAN_F7R2_FB30
 ((
ut32_t
)0x40000000

	)

7237 
	#CAN_F7R2_FB31
 ((
ut32_t
)0x80000000

	)

7240 
	#CAN_F8R2_FB0
 ((
ut32_t
)0x00000001

	)

7241 
	#CAN_F8R2_FB1
 ((
ut32_t
)0x00000002

	)

7242 
	#CAN_F8R2_FB2
 ((
ut32_t
)0x00000004

	)

7243 
	#CAN_F8R2_FB3
 ((
ut32_t
)0x00000008

	)

7244 
	#CAN_F8R2_FB4
 ((
ut32_t
)0x00000010

	)

7245 
	#CAN_F8R2_FB5
 ((
ut32_t
)0x00000020

	)

7246 
	#CAN_F8R2_FB6
 ((
ut32_t
)0x00000040

	)

7247 
	#CAN_F8R2_FB7
 ((
ut32_t
)0x00000080

	)

7248 
	#CAN_F8R2_FB8
 ((
ut32_t
)0x00000100

	)

7249 
	#CAN_F8R2_FB9
 ((
ut32_t
)0x00000200

	)

7250 
	#CAN_F8R2_FB10
 ((
ut32_t
)0x00000400

	)

7251 
	#CAN_F8R2_FB11
 ((
ut32_t
)0x00000800

	)

7252 
	#CAN_F8R2_FB12
 ((
ut32_t
)0x00001000

	)

7253 
	#CAN_F8R2_FB13
 ((
ut32_t
)0x00002000

	)

7254 
	#CAN_F8R2_FB14
 ((
ut32_t
)0x00004000

	)

7255 
	#CAN_F8R2_FB15
 ((
ut32_t
)0x00008000

	)

7256 
	#CAN_F8R2_FB16
 ((
ut32_t
)0x00010000

	)

7257 
	#CAN_F8R2_FB17
 ((
ut32_t
)0x00020000

	)

7258 
	#CAN_F8R2_FB18
 ((
ut32_t
)0x00040000

	)

7259 
	#CAN_F8R2_FB19
 ((
ut32_t
)0x00080000

	)

7260 
	#CAN_F8R2_FB20
 ((
ut32_t
)0x00100000

	)

7261 
	#CAN_F8R2_FB21
 ((
ut32_t
)0x00200000

	)

7262 
	#CAN_F8R2_FB22
 ((
ut32_t
)0x00400000

	)

7263 
	#CAN_F8R2_FB23
 ((
ut32_t
)0x00800000

	)

7264 
	#CAN_F8R2_FB24
 ((
ut32_t
)0x01000000

	)

7265 
	#CAN_F8R2_FB25
 ((
ut32_t
)0x02000000

	)

7266 
	#CAN_F8R2_FB26
 ((
ut32_t
)0x04000000

	)

7267 
	#CAN_F8R2_FB27
 ((
ut32_t
)0x08000000

	)

7268 
	#CAN_F8R2_FB28
 ((
ut32_t
)0x10000000

	)

7269 
	#CAN_F8R2_FB29
 ((
ut32_t
)0x20000000

	)

7270 
	#CAN_F8R2_FB30
 ((
ut32_t
)0x40000000

	)

7271 
	#CAN_F8R2_FB31
 ((
ut32_t
)0x80000000

	)

7274 
	#CAN_F9R2_FB0
 ((
ut32_t
)0x00000001

	)

7275 
	#CAN_F9R2_FB1
 ((
ut32_t
)0x00000002

	)

7276 
	#CAN_F9R2_FB2
 ((
ut32_t
)0x00000004

	)

7277 
	#CAN_F9R2_FB3
 ((
ut32_t
)0x00000008

	)

7278 
	#CAN_F9R2_FB4
 ((
ut32_t
)0x00000010

	)

7279 
	#CAN_F9R2_FB5
 ((
ut32_t
)0x00000020

	)

7280 
	#CAN_F9R2_FB6
 ((
ut32_t
)0x00000040

	)

7281 
	#CAN_F9R2_FB7
 ((
ut32_t
)0x00000080

	)

7282 
	#CAN_F9R2_FB8
 ((
ut32_t
)0x00000100

	)

7283 
	#CAN_F9R2_FB9
 ((
ut32_t
)0x00000200

	)

7284 
	#CAN_F9R2_FB10
 ((
ut32_t
)0x00000400

	)

7285 
	#CAN_F9R2_FB11
 ((
ut32_t
)0x00000800

	)

7286 
	#CAN_F9R2_FB12
 ((
ut32_t
)0x00001000

	)

7287 
	#CAN_F9R2_FB13
 ((
ut32_t
)0x00002000

	)

7288 
	#CAN_F9R2_FB14
 ((
ut32_t
)0x00004000

	)

7289 
	#CAN_F9R2_FB15
 ((
ut32_t
)0x00008000

	)

7290 
	#CAN_F9R2_FB16
 ((
ut32_t
)0x00010000

	)

7291 
	#CAN_F9R2_FB17
 ((
ut32_t
)0x00020000

	)

7292 
	#CAN_F9R2_FB18
 ((
ut32_t
)0x00040000

	)

7293 
	#CAN_F9R2_FB19
 ((
ut32_t
)0x00080000

	)

7294 
	#CAN_F9R2_FB20
 ((
ut32_t
)0x00100000

	)

7295 
	#CAN_F9R2_FB21
 ((
ut32_t
)0x00200000

	)

7296 
	#CAN_F9R2_FB22
 ((
ut32_t
)0x00400000

	)

7297 
	#CAN_F9R2_FB23
 ((
ut32_t
)0x00800000

	)

7298 
	#CAN_F9R2_FB24
 ((
ut32_t
)0x01000000

	)

7299 
	#CAN_F9R2_FB25
 ((
ut32_t
)0x02000000

	)

7300 
	#CAN_F9R2_FB26
 ((
ut32_t
)0x04000000

	)

7301 
	#CAN_F9R2_FB27
 ((
ut32_t
)0x08000000

	)

7302 
	#CAN_F9R2_FB28
 ((
ut32_t
)0x10000000

	)

7303 
	#CAN_F9R2_FB29
 ((
ut32_t
)0x20000000

	)

7304 
	#CAN_F9R2_FB30
 ((
ut32_t
)0x40000000

	)

7305 
	#CAN_F9R2_FB31
 ((
ut32_t
)0x80000000

	)

7308 
	#CAN_F10R2_FB0
 ((
ut32_t
)0x00000001

	)

7309 
	#CAN_F10R2_FB1
 ((
ut32_t
)0x00000002

	)

7310 
	#CAN_F10R2_FB2
 ((
ut32_t
)0x00000004

	)

7311 
	#CAN_F10R2_FB3
 ((
ut32_t
)0x00000008

	)

7312 
	#CAN_F10R2_FB4
 ((
ut32_t
)0x00000010

	)

7313 
	#CAN_F10R2_FB5
 ((
ut32_t
)0x00000020

	)

7314 
	#CAN_F10R2_FB6
 ((
ut32_t
)0x00000040

	)

7315 
	#CAN_F10R2_FB7
 ((
ut32_t
)0x00000080

	)

7316 
	#CAN_F10R2_FB8
 ((
ut32_t
)0x00000100

	)

7317 
	#CAN_F10R2_FB9
 ((
ut32_t
)0x00000200

	)

7318 
	#CAN_F10R2_FB10
 ((
ut32_t
)0x00000400

	)

7319 
	#CAN_F10R2_FB11
 ((
ut32_t
)0x00000800

	)

7320 
	#CAN_F10R2_FB12
 ((
ut32_t
)0x00001000

	)

7321 
	#CAN_F10R2_FB13
 ((
ut32_t
)0x00002000

	)

7322 
	#CAN_F10R2_FB14
 ((
ut32_t
)0x00004000

	)

7323 
	#CAN_F10R2_FB15
 ((
ut32_t
)0x00008000

	)

7324 
	#CAN_F10R2_FB16
 ((
ut32_t
)0x00010000

	)

7325 
	#CAN_F10R2_FB17
 ((
ut32_t
)0x00020000

	)

7326 
	#CAN_F10R2_FB18
 ((
ut32_t
)0x00040000

	)

7327 
	#CAN_F10R2_FB19
 ((
ut32_t
)0x00080000

	)

7328 
	#CAN_F10R2_FB20
 ((
ut32_t
)0x00100000

	)

7329 
	#CAN_F10R2_FB21
 ((
ut32_t
)0x00200000

	)

7330 
	#CAN_F10R2_FB22
 ((
ut32_t
)0x00400000

	)

7331 
	#CAN_F10R2_FB23
 ((
ut32_t
)0x00800000

	)

7332 
	#CAN_F10R2_FB24
 ((
ut32_t
)0x01000000

	)

7333 
	#CAN_F10R2_FB25
 ((
ut32_t
)0x02000000

	)

7334 
	#CAN_F10R2_FB26
 ((
ut32_t
)0x04000000

	)

7335 
	#CAN_F10R2_FB27
 ((
ut32_t
)0x08000000

	)

7336 
	#CAN_F10R2_FB28
 ((
ut32_t
)0x10000000

	)

7337 
	#CAN_F10R2_FB29
 ((
ut32_t
)0x20000000

	)

7338 
	#CAN_F10R2_FB30
 ((
ut32_t
)0x40000000

	)

7339 
	#CAN_F10R2_FB31
 ((
ut32_t
)0x80000000

	)

7342 
	#CAN_F11R2_FB0
 ((
ut32_t
)0x00000001

	)

7343 
	#CAN_F11R2_FB1
 ((
ut32_t
)0x00000002

	)

7344 
	#CAN_F11R2_FB2
 ((
ut32_t
)0x00000004

	)

7345 
	#CAN_F11R2_FB3
 ((
ut32_t
)0x00000008

	)

7346 
	#CAN_F11R2_FB4
 ((
ut32_t
)0x00000010

	)

7347 
	#CAN_F11R2_FB5
 ((
ut32_t
)0x00000020

	)

7348 
	#CAN_F11R2_FB6
 ((
ut32_t
)0x00000040

	)

7349 
	#CAN_F11R2_FB7
 ((
ut32_t
)0x00000080

	)

7350 
	#CAN_F11R2_FB8
 ((
ut32_t
)0x00000100

	)

7351 
	#CAN_F11R2_FB9
 ((
ut32_t
)0x00000200

	)

7352 
	#CAN_F11R2_FB10
 ((
ut32_t
)0x00000400

	)

7353 
	#CAN_F11R2_FB11
 ((
ut32_t
)0x00000800

	)

7354 
	#CAN_F11R2_FB12
 ((
ut32_t
)0x00001000

	)

7355 
	#CAN_F11R2_FB13
 ((
ut32_t
)0x00002000

	)

7356 
	#CAN_F11R2_FB14
 ((
ut32_t
)0x00004000

	)

7357 
	#CAN_F11R2_FB15
 ((
ut32_t
)0x00008000

	)

7358 
	#CAN_F11R2_FB16
 ((
ut32_t
)0x00010000

	)

7359 
	#CAN_F11R2_FB17
 ((
ut32_t
)0x00020000

	)

7360 
	#CAN_F11R2_FB18
 ((
ut32_t
)0x00040000

	)

7361 
	#CAN_F11R2_FB19
 ((
ut32_t
)0x00080000

	)

7362 
	#CAN_F11R2_FB20
 ((
ut32_t
)0x00100000

	)

7363 
	#CAN_F11R2_FB21
 ((
ut32_t
)0x00200000

	)

7364 
	#CAN_F11R2_FB22
 ((
ut32_t
)0x00400000

	)

7365 
	#CAN_F11R2_FB23
 ((
ut32_t
)0x00800000

	)

7366 
	#CAN_F11R2_FB24
 ((
ut32_t
)0x01000000

	)

7367 
	#CAN_F11R2_FB25
 ((
ut32_t
)0x02000000

	)

7368 
	#CAN_F11R2_FB26
 ((
ut32_t
)0x04000000

	)

7369 
	#CAN_F11R2_FB27
 ((
ut32_t
)0x08000000

	)

7370 
	#CAN_F11R2_FB28
 ((
ut32_t
)0x10000000

	)

7371 
	#CAN_F11R2_FB29
 ((
ut32_t
)0x20000000

	)

7372 
	#CAN_F11R2_FB30
 ((
ut32_t
)0x40000000

	)

7373 
	#CAN_F11R2_FB31
 ((
ut32_t
)0x80000000

	)

7376 
	#CAN_F12R2_FB0
 ((
ut32_t
)0x00000001

	)

7377 
	#CAN_F12R2_FB1
 ((
ut32_t
)0x00000002

	)

7378 
	#CAN_F12R2_FB2
 ((
ut32_t
)0x00000004

	)

7379 
	#CAN_F12R2_FB3
 ((
ut32_t
)0x00000008

	)

7380 
	#CAN_F12R2_FB4
 ((
ut32_t
)0x00000010

	)

7381 
	#CAN_F12R2_FB5
 ((
ut32_t
)0x00000020

	)

7382 
	#CAN_F12R2_FB6
 ((
ut32_t
)0x00000040

	)

7383 
	#CAN_F12R2_FB7
 ((
ut32_t
)0x00000080

	)

7384 
	#CAN_F12R2_FB8
 ((
ut32_t
)0x00000100

	)

7385 
	#CAN_F12R2_FB9
 ((
ut32_t
)0x00000200

	)

7386 
	#CAN_F12R2_FB10
 ((
ut32_t
)0x00000400

	)

7387 
	#CAN_F12R2_FB11
 ((
ut32_t
)0x00000800

	)

7388 
	#CAN_F12R2_FB12
 ((
ut32_t
)0x00001000

	)

7389 
	#CAN_F12R2_FB13
 ((
ut32_t
)0x00002000

	)

7390 
	#CAN_F12R2_FB14
 ((
ut32_t
)0x00004000

	)

7391 
	#CAN_F12R2_FB15
 ((
ut32_t
)0x00008000

	)

7392 
	#CAN_F12R2_FB16
 ((
ut32_t
)0x00010000

	)

7393 
	#CAN_F12R2_FB17
 ((
ut32_t
)0x00020000

	)

7394 
	#CAN_F12R2_FB18
 ((
ut32_t
)0x00040000

	)

7395 
	#CAN_F12R2_FB19
 ((
ut32_t
)0x00080000

	)

7396 
	#CAN_F12R2_FB20
 ((
ut32_t
)0x00100000

	)

7397 
	#CAN_F12R2_FB21
 ((
ut32_t
)0x00200000

	)

7398 
	#CAN_F12R2_FB22
 ((
ut32_t
)0x00400000

	)

7399 
	#CAN_F12R2_FB23
 ((
ut32_t
)0x00800000

	)

7400 
	#CAN_F12R2_FB24
 ((
ut32_t
)0x01000000

	)

7401 
	#CAN_F12R2_FB25
 ((
ut32_t
)0x02000000

	)

7402 
	#CAN_F12R2_FB26
 ((
ut32_t
)0x04000000

	)

7403 
	#CAN_F12R2_FB27
 ((
ut32_t
)0x08000000

	)

7404 
	#CAN_F12R2_FB28
 ((
ut32_t
)0x10000000

	)

7405 
	#CAN_F12R2_FB29
 ((
ut32_t
)0x20000000

	)

7406 
	#CAN_F12R2_FB30
 ((
ut32_t
)0x40000000

	)

7407 
	#CAN_F12R2_FB31
 ((
ut32_t
)0x80000000

	)

7410 
	#CAN_F13R2_FB0
 ((
ut32_t
)0x00000001

	)

7411 
	#CAN_F13R2_FB1
 ((
ut32_t
)0x00000002

	)

7412 
	#CAN_F13R2_FB2
 ((
ut32_t
)0x00000004

	)

7413 
	#CAN_F13R2_FB3
 ((
ut32_t
)0x00000008

	)

7414 
	#CAN_F13R2_FB4
 ((
ut32_t
)0x00000010

	)

7415 
	#CAN_F13R2_FB5
 ((
ut32_t
)0x00000020

	)

7416 
	#CAN_F13R2_FB6
 ((
ut32_t
)0x00000040

	)

7417 
	#CAN_F13R2_FB7
 ((
ut32_t
)0x00000080

	)

7418 
	#CAN_F13R2_FB8
 ((
ut32_t
)0x00000100

	)

7419 
	#CAN_F13R2_FB9
 ((
ut32_t
)0x00000200

	)

7420 
	#CAN_F13R2_FB10
 ((
ut32_t
)0x00000400

	)

7421 
	#CAN_F13R2_FB11
 ((
ut32_t
)0x00000800

	)

7422 
	#CAN_F13R2_FB12
 ((
ut32_t
)0x00001000

	)

7423 
	#CAN_F13R2_FB13
 ((
ut32_t
)0x00002000

	)

7424 
	#CAN_F13R2_FB14
 ((
ut32_t
)0x00004000

	)

7425 
	#CAN_F13R2_FB15
 ((
ut32_t
)0x00008000

	)

7426 
	#CAN_F13R2_FB16
 ((
ut32_t
)0x00010000

	)

7427 
	#CAN_F13R2_FB17
 ((
ut32_t
)0x00020000

	)

7428 
	#CAN_F13R2_FB18
 ((
ut32_t
)0x00040000

	)

7429 
	#CAN_F13R2_FB19
 ((
ut32_t
)0x00080000

	)

7430 
	#CAN_F13R2_FB20
 ((
ut32_t
)0x00100000

	)

7431 
	#CAN_F13R2_FB21
 ((
ut32_t
)0x00200000

	)

7432 
	#CAN_F13R2_FB22
 ((
ut32_t
)0x00400000

	)

7433 
	#CAN_F13R2_FB23
 ((
ut32_t
)0x00800000

	)

7434 
	#CAN_F13R2_FB24
 ((
ut32_t
)0x01000000

	)

7435 
	#CAN_F13R2_FB25
 ((
ut32_t
)0x02000000

	)

7436 
	#CAN_F13R2_FB26
 ((
ut32_t
)0x04000000

	)

7437 
	#CAN_F13R2_FB27
 ((
ut32_t
)0x08000000

	)

7438 
	#CAN_F13R2_FB28
 ((
ut32_t
)0x10000000

	)

7439 
	#CAN_F13R2_FB29
 ((
ut32_t
)0x20000000

	)

7440 
	#CAN_F13R2_FB30
 ((
ut32_t
)0x40000000

	)

7441 
	#CAN_F13R2_FB31
 ((
ut32_t
)0x80000000

	)

7450 
	#SPI_CR1_CPHA
 ((
ut16_t
)0x0001

	)

7451 
	#SPI_CR1_CPOL
 ((
ut16_t
)0x0002

	)

7452 
	#SPI_CR1_MSTR
 ((
ut16_t
)0x0004

	)

7454 
	#SPI_CR1_BR
 ((
ut16_t
)0x0038

	)

7455 
	#SPI_CR1_BR_0
 ((
ut16_t
)0x0008

	)

7456 
	#SPI_CR1_BR_1
 ((
ut16_t
)0x0010

	)

7457 
	#SPI_CR1_BR_2
 ((
ut16_t
)0x0020

	)

7459 
	#SPI_CR1_SPE
 ((
ut16_t
)0x0040

	)

7460 
	#SPI_CR1_LSBFIRST
 ((
ut16_t
)0x0080

	)

7461 
	#SPI_CR1_SSI
 ((
ut16_t
)0x0100

	)

7462 
	#SPI_CR1_SSM
 ((
ut16_t
)0x0200

	)

7463 
	#SPI_CR1_RXONLY
 ((
ut16_t
)0x0400

	)

7464 
	#SPI_CR1_DFF
 ((
ut16_t
)0x0800

	)

7465 
	#SPI_CR1_CRCNEXT
 ((
ut16_t
)0x1000

	)

7466 
	#SPI_CR1_CRCEN
 ((
ut16_t
)0x2000

	)

7467 
	#SPI_CR1_BIDIOE
 ((
ut16_t
)0x4000

	)

7468 
	#SPI_CR1_BIDIMODE
 ((
ut16_t
)0x8000

	)

7471 
	#SPI_CR2_RXDMAEN
 ((
ut8_t
)0x01

	)

7472 
	#SPI_CR2_TXDMAEN
 ((
ut8_t
)0x02

	)

7473 
	#SPI_CR2_SSOE
 ((
ut8_t
)0x04

	)

7474 
	#SPI_CR2_ERRIE
 ((
ut8_t
)0x20

	)

7475 
	#SPI_CR2_RXNEIE
 ((
ut8_t
)0x40

	)

7476 
	#SPI_CR2_TXEIE
 ((
ut8_t
)0x80

	)

7479 
	#SPI_SR_RXNE
 ((
ut8_t
)0x01

	)

7480 
	#SPI_SR_TXE
 ((
ut8_t
)0x02

	)

7481 
	#SPI_SR_CHSIDE
 ((
ut8_t
)0x04

	)

7482 
	#SPI_SR_UDR
 ((
ut8_t
)0x08

	)

7483 
	#SPI_SR_CRCERR
 ((
ut8_t
)0x10

	)

7484 
	#SPI_SR_MODF
 ((
ut8_t
)0x20

	)

7485 
	#SPI_SR_OVR
 ((
ut8_t
)0x40

	)

7486 
	#SPI_SR_BSY
 ((
ut8_t
)0x80

	)

7489 
	#SPI_DR_DR
 ((
ut16_t
)0xFFFF

	)

7492 
	#SPI_CRCPR_CRCPOLY
 ((
ut16_t
)0xFFFF

	)

7495 
	#SPI_RXCRCR_RXCRC
 ((
ut16_t
)0xFFFF

	)

7498 
	#SPI_TXCRCR_TXCRC
 ((
ut16_t
)0xFFFF

	)

7501 
	#SPI_I2SCFGR_CHLEN
 ((
ut16_t
)0x0001

	)

7503 
	#SPI_I2SCFGR_DATLEN
 ((
ut16_t
)0x0006

	)

7504 
	#SPI_I2SCFGR_DATLEN_0
 ((
ut16_t
)0x0002

	)

7505 
	#SPI_I2SCFGR_DATLEN_1
 ((
ut16_t
)0x0004

	)

7507 
	#SPI_I2SCFGR_CKPOL
 ((
ut16_t
)0x0008

	)

7509 
	#SPI_I2SCFGR_I2SSTD
 ((
ut16_t
)0x0030

	)

7510 
	#SPI_I2SCFGR_I2SSTD_0
 ((
ut16_t
)0x0010

	)

7511 
	#SPI_I2SCFGR_I2SSTD_1
 ((
ut16_t
)0x0020

	)

7513 
	#SPI_I2SCFGR_PCMSYNC
 ((
ut16_t
)0x0080

	)

7515 
	#SPI_I2SCFGR_I2SCFG
 ((
ut16_t
)0x0300

	)

7516 
	#SPI_I2SCFGR_I2SCFG_0
 ((
ut16_t
)0x0100

	)

7517 
	#SPI_I2SCFGR_I2SCFG_1
 ((
ut16_t
)0x0200

	)

7519 
	#SPI_I2SCFGR_I2SE
 ((
ut16_t
)0x0400

	)

7520 
	#SPI_I2SCFGR_I2SMOD
 ((
ut16_t
)0x0800

	)

7523 
	#SPI_I2SPR_I2SDIV
 ((
ut16_t
)0x00FF

	)

7524 
	#SPI_I2SPR_ODD
 ((
ut16_t
)0x0100

	)

7525 
	#SPI_I2SPR_MCKOE
 ((
ut16_t
)0x0200

	)

7534 
	#I2C_CR1_PE
 ((
ut16_t
)0x0001

	)

7535 
	#I2C_CR1_SMBUS
 ((
ut16_t
)0x0002

	)

7536 
	#I2C_CR1_SMBTYPE
 ((
ut16_t
)0x0008

	)

7537 
	#I2C_CR1_ENARP
 ((
ut16_t
)0x0010

	)

7538 
	#I2C_CR1_ENPEC
 ((
ut16_t
)0x0020

	)

7539 
	#I2C_CR1_ENGC
 ((
ut16_t
)0x0040

	)

7540 
	#I2C_CR1_NOSTRETCH
 ((
ut16_t
)0x0080

	)

7541 
	#I2C_CR1_START
 ((
ut16_t
)0x0100

	)

7542 
	#I2C_CR1_STOP
 ((
ut16_t
)0x0200

	)

7543 
	#I2C_CR1_ACK
 ((
ut16_t
)0x0400

	)

7544 
	#I2C_CR1_POS
 ((
ut16_t
)0x0800

	)

7545 
	#I2C_CR1_PEC
 ((
ut16_t
)0x1000

	)

7546 
	#I2C_CR1_ALERT
 ((
ut16_t
)0x2000

	)

7547 
	#I2C_CR1_SWRST
 ((
ut16_t
)0x8000

	)

7550 
	#I2C_CR2_FREQ
 ((
ut16_t
)0x003F

	)

7551 
	#I2C_CR2_FREQ_0
 ((
ut16_t
)0x0001

	)

7552 
	#I2C_CR2_FREQ_1
 ((
ut16_t
)0x0002

	)

7553 
	#I2C_CR2_FREQ_2
 ((
ut16_t
)0x0004

	)

7554 
	#I2C_CR2_FREQ_3
 ((
ut16_t
)0x0008

	)

7555 
	#I2C_CR2_FREQ_4
 ((
ut16_t
)0x0010

	)

7556 
	#I2C_CR2_FREQ_5
 ((
ut16_t
)0x0020

	)

7558 
	#I2C_CR2_ITERREN
 ((
ut16_t
)0x0100

	)

7559 
	#I2C_CR2_ITEVTEN
 ((
ut16_t
)0x0200

	)

7560 
	#I2C_CR2_ITBUFEN
 ((
ut16_t
)0x0400

	)

7561 
	#I2C_CR2_DMAEN
 ((
ut16_t
)0x0800

	)

7562 
	#I2C_CR2_LAST
 ((
ut16_t
)0x1000

	)

7565 
	#I2C_OAR1_ADD1_7
 ((
ut16_t
)0x00FE

	)

7566 
	#I2C_OAR1_ADD8_9
 ((
ut16_t
)0x0300

	)

7568 
	#I2C_OAR1_ADD0
 ((
ut16_t
)0x0001

	)

7569 
	#I2C_OAR1_ADD1
 ((
ut16_t
)0x0002

	)

7570 
	#I2C_OAR1_ADD2
 ((
ut16_t
)0x0004

	)

7571 
	#I2C_OAR1_ADD3
 ((
ut16_t
)0x0008

	)

7572 
	#I2C_OAR1_ADD4
 ((
ut16_t
)0x0010

	)

7573 
	#I2C_OAR1_ADD5
 ((
ut16_t
)0x0020

	)

7574 
	#I2C_OAR1_ADD6
 ((
ut16_t
)0x0040

	)

7575 
	#I2C_OAR1_ADD7
 ((
ut16_t
)0x0080

	)

7576 
	#I2C_OAR1_ADD8
 ((
ut16_t
)0x0100

	)

7577 
	#I2C_OAR1_ADD9
 ((
ut16_t
)0x0200

	)

7579 
	#I2C_OAR1_ADDMODE
 ((
ut16_t
)0x8000

	)

7582 
	#I2C_OAR2_ENDUAL
 ((
ut8_t
)0x01

	)

7583 
	#I2C_OAR2_ADD2
 ((
ut8_t
)0xFE

	)

7586 
	#I2C_DR_DR
 ((
ut8_t
)0xFF

	)

7589 
	#I2C_SR1_SB
 ((
ut16_t
)0x0001

	)

7590 
	#I2C_SR1_ADDR
 ((
ut16_t
)0x0002

	)

7591 
	#I2C_SR1_BTF
 ((
ut16_t
)0x0004

	)

7592 
	#I2C_SR1_ADD10
 ((
ut16_t
)0x0008

	)

7593 
	#I2C_SR1_STOPF
 ((
ut16_t
)0x0010

	)

7594 
	#I2C_SR1_RXNE
 ((
ut16_t
)0x0040

	)

7595 
	#I2C_SR1_TXE
 ((
ut16_t
)0x0080

	)

7596 
	#I2C_SR1_BERR
 ((
ut16_t
)0x0100

	)

7597 
	#I2C_SR1_ARLO
 ((
ut16_t
)0x0200

	)

7598 
	#I2C_SR1_AF
 ((
ut16_t
)0x0400

	)

7599 
	#I2C_SR1_OVR
 ((
ut16_t
)0x0800

	)

7600 
	#I2C_SR1_PECERR
 ((
ut16_t
)0x1000

	)

7601 
	#I2C_SR1_TIMEOUT
 ((
ut16_t
)0x4000

	)

7602 
	#I2C_SR1_SMBALERT
 ((
ut16_t
)0x8000

	)

7605 
	#I2C_SR2_MSL
 ((
ut16_t
)0x0001

	)

7606 
	#I2C_SR2_BUSY
 ((
ut16_t
)0x0002

	)

7607 
	#I2C_SR2_TRA
 ((
ut16_t
)0x0004

	)

7608 
	#I2C_SR2_GENCALL
 ((
ut16_t
)0x0010

	)

7609 
	#I2C_SR2_SMBDEFAULT
 ((
ut16_t
)0x0020

	)

7610 
	#I2C_SR2_SMBHOST
 ((
ut16_t
)0x0040

	)

7611 
	#I2C_SR2_DUALF
 ((
ut16_t
)0x0080

	)

7612 
	#I2C_SR2_PEC
 ((
ut16_t
)0xFF00

	)

7615 
	#I2C_CCR_CCR
 ((
ut16_t
)0x0FFF

	)

7616 
	#I2C_CCR_DUTY
 ((
ut16_t
)0x4000

	)

7617 
	#I2C_CCR_FS
 ((
ut16_t
)0x8000

	)

7620 
	#I2C_TRISE_TRISE
 ((
ut8_t
)0x3F

	)

7629 
	#USART_SR_PE
 ((
ut16_t
)0x0001

	)

7630 
	#USART_SR_FE
 ((
ut16_t
)0x0002

	)

7631 
	#USART_SR_NE
 ((
ut16_t
)0x0004

	)

7632 
	#USART_SR_ORE
 ((
ut16_t
)0x0008

	)

7633 
	#USART_SR_IDLE
 ((
ut16_t
)0x0010

	)

7634 
	#USART_SR_RXNE
 ((
ut16_t
)0x0020

	)

7635 
	#USART_SR_TC
 ((
ut16_t
)0x0040

	)

7636 
	#USART_SR_TXE
 ((
ut16_t
)0x0080

	)

7637 
	#USART_SR_LBD
 ((
ut16_t
)0x0100

	)

7638 
	#USART_SR_CTS
 ((
ut16_t
)0x0200

	)

7641 
	#USART_DR_DR
 ((
ut16_t
)0x01FF

	)

7644 
	#USART_BRR_DIV_Fi
 ((
ut16_t
)0x000F

	)

7645 
	#USART_BRR_DIV_Mtis
 ((
ut16_t
)0xFFF0

	)

7648 
	#USART_CR1_SBK
 ((
ut16_t
)0x0001

	)

7649 
	#USART_CR1_RWU
 ((
ut16_t
)0x0002

	)

7650 
	#USART_CR1_RE
 ((
ut16_t
)0x0004

	)

7651 
	#USART_CR1_TE
 ((
ut16_t
)0x0008

	)

7652 
	#USART_CR1_IDLEIE
 ((
ut16_t
)0x0010

	)

7653 
	#USART_CR1_RXNEIE
 ((
ut16_t
)0x0020

	)

7654 
	#USART_CR1_TCIE
 ((
ut16_t
)0x0040

	)

7655 
	#USART_CR1_TXEIE
 ((
ut16_t
)0x0080

	)

7656 
	#USART_CR1_PEIE
 ((
ut16_t
)0x0100

	)

7657 
	#USART_CR1_PS
 ((
ut16_t
)0x0200

	)

7658 
	#USART_CR1_PCE
 ((
ut16_t
)0x0400

	)

7659 
	#USART_CR1_WAKE
 ((
ut16_t
)0x0800

	)

7660 
	#USART_CR1_M
 ((
ut16_t
)0x1000

	)

7661 
	#USART_CR1_UE
 ((
ut16_t
)0x2000

	)

7662 
	#USART_CR1_OVER8
 ((
ut16_t
)0x8000

	)

7665 
	#USART_CR2_ADD
 ((
ut16_t
)0x000F

	)

7666 
	#USART_CR2_LBDL
 ((
ut16_t
)0x0020

	)

7667 
	#USART_CR2_LBDIE
 ((
ut16_t
)0x0040

	)

7668 
	#USART_CR2_LBCL
 ((
ut16_t
)0x0100

	)

7669 
	#USART_CR2_CPHA
 ((
ut16_t
)0x0200

	)

7670 
	#USART_CR2_CPOL
 ((
ut16_t
)0x0400

	)

7671 
	#USART_CR2_CLKEN
 ((
ut16_t
)0x0800

	)

7673 
	#USART_CR2_STOP
 ((
ut16_t
)0x3000

	)

7674 
	#USART_CR2_STOP_0
 ((
ut16_t
)0x1000

	)

7675 
	#USART_CR2_STOP_1
 ((
ut16_t
)0x2000

	)

7677 
	#USART_CR2_LINEN
 ((
ut16_t
)0x4000

	)

7680 
	#USART_CR3_EIE
 ((
ut16_t
)0x0001

	)

7681 
	#USART_CR3_IREN
 ((
ut16_t
)0x0002

	)

7682 
	#USART_CR3_IRLP
 ((
ut16_t
)0x0004

	)

7683 
	#USART_CR3_HDSEL
 ((
ut16_t
)0x0008

	)

7684 
	#USART_CR3_NACK
 ((
ut16_t
)0x0010

	)

7685 
	#USART_CR3_SCEN
 ((
ut16_t
)0x0020

	)

7686 
	#USART_CR3_DMAR
 ((
ut16_t
)0x0040

	)

7687 
	#USART_CR3_DMAT
 ((
ut16_t
)0x0080

	)

7688 
	#USART_CR3_RTSE
 ((
ut16_t
)0x0100

	)

7689 
	#USART_CR3_CTSE
 ((
ut16_t
)0x0200

	)

7690 
	#USART_CR3_CTSIE
 ((
ut16_t
)0x0400

	)

7691 
	#USART_CR3_ONEBIT
 ((
ut16_t
)0x0800

	)

7694 
	#USART_GTPR_PSC
 ((
ut16_t
)0x00FF

	)

7695 
	#USART_GTPR_PSC_0
 ((
ut16_t
)0x0001

	)

7696 
	#USART_GTPR_PSC_1
 ((
ut16_t
)0x0002

	)

7697 
	#USART_GTPR_PSC_2
 ((
ut16_t
)0x0004

	)

7698 
	#USART_GTPR_PSC_3
 ((
ut16_t
)0x0008

	)

7699 
	#USART_GTPR_PSC_4
 ((
ut16_t
)0x0010

	)

7700 
	#USART_GTPR_PSC_5
 ((
ut16_t
)0x0020

	)

7701 
	#USART_GTPR_PSC_6
 ((
ut16_t
)0x0040

	)

7702 
	#USART_GTPR_PSC_7
 ((
ut16_t
)0x0080

	)

7704 
	#USART_GTPR_GT
 ((
ut16_t
)0xFF00

	)

7713 
	#DBGMCU_IDCODE_DEV_ID
 ((
ut32_t
)0x00000FFF

	)

7715 
	#DBGMCU_IDCODE_REV_ID
 ((
ut32_t
)0xFFFF0000

	)

7716 
	#DBGMCU_IDCODE_REV_ID_0
 ((
ut32_t
)0x00010000

	)

7717 
	#DBGMCU_IDCODE_REV_ID_1
 ((
ut32_t
)0x00020000

	)

7718 
	#DBGMCU_IDCODE_REV_ID_2
 ((
ut32_t
)0x00040000

	)

7719 
	#DBGMCU_IDCODE_REV_ID_3
 ((
ut32_t
)0x00080000

	)

7720 
	#DBGMCU_IDCODE_REV_ID_4
 ((
ut32_t
)0x00100000

	)

7721 
	#DBGMCU_IDCODE_REV_ID_5
 ((
ut32_t
)0x00200000

	)

7722 
	#DBGMCU_IDCODE_REV_ID_6
 ((
ut32_t
)0x00400000

	)

7723 
	#DBGMCU_IDCODE_REV_ID_7
 ((
ut32_t
)0x00800000

	)

7724 
	#DBGMCU_IDCODE_REV_ID_8
 ((
ut32_t
)0x01000000

	)

7725 
	#DBGMCU_IDCODE_REV_ID_9
 ((
ut32_t
)0x02000000

	)

7726 
	#DBGMCU_IDCODE_REV_ID_10
 ((
ut32_t
)0x04000000

	)

7727 
	#DBGMCU_IDCODE_REV_ID_11
 ((
ut32_t
)0x08000000

	)

7728 
	#DBGMCU_IDCODE_REV_ID_12
 ((
ut32_t
)0x10000000

	)

7729 
	#DBGMCU_IDCODE_REV_ID_13
 ((
ut32_t
)0x20000000

	)

7730 
	#DBGMCU_IDCODE_REV_ID_14
 ((
ut32_t
)0x40000000

	)

7731 
	#DBGMCU_IDCODE_REV_ID_15
 ((
ut32_t
)0x80000000

	)

7734 
	#DBGMCU_CR_DBG_SLEEP
 ((
ut32_t
)0x00000001

	)

7735 
	#DBGMCU_CR_DBG_STOP
 ((
ut32_t
)0x00000002

	)

7736 
	#DBGMCU_CR_DBG_STANDBY
 ((
ut32_t
)0x00000004

	)

7737 
	#DBGMCU_CR_TRACE_IOEN
 ((
ut32_t
)0x00000020

	)

7739 
	#DBGMCU_CR_TRACE_MODE
 ((
ut32_t
)0x000000C0

	)

7740 
	#DBGMCU_CR_TRACE_MODE_0
 ((
ut32_t
)0x00000040

	)

7741 
	#DBGMCU_CR_TRACE_MODE_1
 ((
ut32_t
)0x00000080

	)

7743 
	#DBGMCU_CR_DBG_IWDG_STOP
 ((
ut32_t
)0x00000100

	)

7744 
	#DBGMCU_CR_DBG_WWDG_STOP
 ((
ut32_t
)0x00000200

	)

7745 
	#DBGMCU_CR_DBG_TIM1_STOP
 ((
ut32_t
)0x00000400

	)

7746 
	#DBGMCU_CR_DBG_TIM2_STOP
 ((
ut32_t
)0x00000800

	)

7747 
	#DBGMCU_CR_DBG_TIM3_STOP
 ((
ut32_t
)0x00001000

	)

7748 
	#DBGMCU_CR_DBG_TIM4_STOP
 ((
ut32_t
)0x00002000

	)

7749 
	#DBGMCU_CR_DBG_CAN1_STOP
 ((
ut32_t
)0x00004000

	)

7750 
	#DBGMCU_CR_DBG_I2C1_SMBUS_TIMEOUT
 ((
ut32_t
)0x00008000

	)

7751 
	#DBGMCU_CR_DBG_I2C2_SMBUS_TIMEOUT
 ((
ut32_t
)0x00010000

	)

7752 
	#DBGMCU_CR_DBG_TIM8_STOP
 ((
ut32_t
)0x00020000

	)

7753 
	#DBGMCU_CR_DBG_TIM5_STOP
 ((
ut32_t
)0x00040000

	)

7754 
	#DBGMCU_CR_DBG_TIM6_STOP
 ((
ut32_t
)0x00080000

	)

7755 
	#DBGMCU_CR_DBG_TIM7_STOP
 ((
ut32_t
)0x00100000

	)

7756 
	#DBGMCU_CR_DBG_CAN2_STOP
 ((
ut32_t
)0x00200000

	)

7757 
	#DBGMCU_CR_DBG_TIM15_STOP
 ((
ut32_t
)0x00400000

	)

7758 
	#DBGMCU_CR_DBG_TIM16_STOP
 ((
ut32_t
)0x00800000

	)

7759 
	#DBGMCU_CR_DBG_TIM17_STOP
 ((
ut32_t
)0x01000000

	)

7760 
	#DBGMCU_CR_DBG_TIM12_STOP
 ((
ut32_t
)0x02000000

	)

7761 
	#DBGMCU_CR_DBG_TIM13_STOP
 ((
ut32_t
)0x04000000

	)

7762 
	#DBGMCU_CR_DBG_TIM14_STOP
 ((
ut32_t
)0x08000000

	)

7763 
	#DBGMCU_CR_DBG_TIM9_STOP
 ((
ut32_t
)0x10000000

	)

7764 
	#DBGMCU_CR_DBG_TIM10_STOP
 ((
ut32_t
)0x20000000

	)

7765 
	#DBGMCU_CR_DBG_TIM11_STOP
 ((
ut32_t
)0x40000000

	)

7774 
	#FLASH_ACR_LATENCY
 ((
ut8_t
)0x03

	)

7775 
	#FLASH_ACR_LATENCY_0
 ((
ut8_t
)0x00

	)

7776 
	#FLASH_ACR_LATENCY_1
 ((
ut8_t
)0x01

	)

7777 
	#FLASH_ACR_LATENCY_2
 ((
ut8_t
)0x02

	)

7779 
	#FLASH_ACR_HLFCYA
 ((
ut8_t
)0x08

	)

7780 
	#FLASH_ACR_PRFTBE
 ((
ut8_t
)0x10

	)

7781 
	#FLASH_ACR_PRFTBS
 ((
ut8_t
)0x20

	)

7784 
	#FLASH_KEYR_FKEYR
 ((
ut32_t
)0xFFFFFFFF

	)

7787 
	#FLASH_OPTKEYR_OPTKEYR
 ((
ut32_t
)0xFFFFFFFF

	)

7790 
	#FLASH_SR_BSY
 ((
ut8_t
)0x01

	)

7791 
	#FLASH_SR_PGERR
 ((
ut8_t
)0x04

	)

7792 
	#FLASH_SR_WRPRTERR
 ((
ut8_t
)0x10

	)

7793 
	#FLASH_SR_EOP
 ((
ut8_t
)0x20

	)

7796 
	#FLASH_CR_PG
 ((
ut16_t
)0x0001

	)

7797 
	#FLASH_CR_PER
 ((
ut16_t
)0x0002

	)

7798 
	#FLASH_CR_MER
 ((
ut16_t
)0x0004

	)

7799 
	#FLASH_CR_OPTPG
 ((
ut16_t
)0x0010

	)

7800 
	#FLASH_CR_OPTER
 ((
ut16_t
)0x0020

	)

7801 
	#FLASH_CR_STRT
 ((
ut16_t
)0x0040

	)

7802 
	#FLASH_CR_LOCK
 ((
ut16_t
)0x0080

	)

7803 
	#FLASH_CR_OPTWRE
 ((
ut16_t
)0x0200

	)

7804 
	#FLASH_CR_ERRIE
 ((
ut16_t
)0x0400

	)

7805 
	#FLASH_CR_EOPIE
 ((
ut16_t
)0x1000

	)

7808 
	#FLASH_AR_FAR
 ((
ut32_t
)0xFFFFFFFF

	)

7811 
	#FLASH_OBR_OPTERR
 ((
ut16_t
)0x0001

	)

7812 
	#FLASH_OBR_RDPRT
 ((
ut16_t
)0x0002

	)

7814 
	#FLASH_OBR_USER
 ((
ut16_t
)0x03FC

	)

7815 
	#FLASH_OBR_WDG_SW
 ((
ut16_t
)0x0004

	)

7816 
	#FLASH_OBR_nRST_STOP
 ((
ut16_t
)0x0008

	)

7817 
	#FLASH_OBR_nRST_STDBY
 ((
ut16_t
)0x0010

	)

7818 
	#FLASH_OBR_BFB2
 ((
ut16_t
)0x0020

	)

7821 
	#FLASH_WRPR_WRP
 ((
ut32_t
)0xFFFFFFFF

	)

7826 
	#FLASH_RDP_RDP
 ((
ut32_t
)0x000000FF

	)

7827 
	#FLASH_RDP_nRDP
 ((
ut32_t
)0x0000FF00

	)

7830 
	#FLASH_USER_USER
 ((
ut32_t
)0x00FF0000

	)

7831 
	#FLASH_USER_nUSER
 ((
ut32_t
)0xFF000000

	)

7834 
	#FLASH_Da0_Da0
 ((
ut32_t
)0x000000FF

	)

7835 
	#FLASH_Da0_nDa0
 ((
ut32_t
)0x0000FF00

	)

7838 
	#FLASH_Da1_Da1
 ((
ut32_t
)0x00FF0000

	)

7839 
	#FLASH_Da1_nDa1
 ((
ut32_t
)0xFF000000

	)

7842 
	#FLASH_WRP0_WRP0
 ((
ut32_t
)0x000000FF

	)

7843 
	#FLASH_WRP0_nWRP0
 ((
ut32_t
)0x0000FF00

	)

7846 
	#FLASH_WRP1_WRP1
 ((
ut32_t
)0x00FF0000

	)

7847 
	#FLASH_WRP1_nWRP1
 ((
ut32_t
)0xFF000000

	)

7850 
	#FLASH_WRP2_WRP2
 ((
ut32_t
)0x000000FF

	)

7851 
	#FLASH_WRP2_nWRP2
 ((
ut32_t
)0x0000FF00

	)

7854 
	#FLASH_WRP3_WRP3
 ((
ut32_t
)0x00FF0000

	)

7855 
	#FLASH_WRP3_nWRP3
 ((
ut32_t
)0xFF000000

	)

7857 #ifde
STM32F10X_CL


7862 
	#ETH_MACCR_WD
 ((
ut32_t
)0x00800000

	)

7863 
	#ETH_MACCR_JD
 ((
ut32_t
)0x00400000

	)

7864 
	#ETH_MACCR_IFG
 ((
ut32_t
)0x000E0000

	)

7865 
	#ETH_MACCR_IFG_96B
 ((
ut32_t
)0x00000000

	)

7866 
	#ETH_MACCR_IFG_88B
 ((
ut32_t
)0x00020000

	)

7867 
	#ETH_MACCR_IFG_80B
 ((
ut32_t
)0x00040000

	)

7868 
	#ETH_MACCR_IFG_72B
 ((
ut32_t
)0x00060000

	)

7869 
	#ETH_MACCR_IFG_64B
 ((
ut32_t
)0x00080000

	)

7870 
	#ETH_MACCR_IFG_56B
 ((
ut32_t
)0x000A0000

	)

7871 
	#ETH_MACCR_IFG_48B
 ((
ut32_t
)0x000C0000

	)

7872 
	#ETH_MACCR_IFG_40B
 ((
ut32_t
)0x000E0000

	)

7873 
	#ETH_MACCR_CSD
 ((
ut32_t
)0x00010000

	)

7874 
	#ETH_MACCR_FES
 ((
ut32_t
)0x00004000

	)

7875 
	#ETH_MACCR_ROD
 ((
ut32_t
)0x00002000

	)

7876 
	#ETH_MACCR_LM
 ((
ut32_t
)0x00001000

	)

7877 
	#ETH_MACCR_DM
 ((
ut32_t
)0x00000800

	)

7878 
	#ETH_MACCR_IPCO
 ((
ut32_t
)0x00000400

	)

7879 
	#ETH_MACCR_RD
 ((
ut32_t
)0x00000200

	)

7880 
	#ETH_MACCR_APCS
 ((
ut32_t
)0x00000080

	)

7881 
	#ETH_MACCR_BL
 ((
ut32_t
)0x00000060

	)

7883 
	#ETH_MACCR_BL_10
 ((
ut32_t
)0x00000000

	)

7884 
	#ETH_MACCR_BL_8
 ((
ut32_t
)0x00000020

	)

7885 
	#ETH_MACCR_BL_4
 ((
ut32_t
)0x00000040

	)

7886 
	#ETH_MACCR_BL_1
 ((
ut32_t
)0x00000060

	)

7887 
	#ETH_MACCR_DC
 ((
ut32_t
)0x00000010

	)

7888 
	#ETH_MACCR_TE
 ((
ut32_t
)0x00000008

	)

7889 
	#ETH_MACCR_RE
 ((
ut32_t
)0x00000004

	)

7892 
	#ETH_MACFFR_RA
 ((
ut32_t
)0x80000000

	)

7893 
	#ETH_MACFFR_HPF
 ((
ut32_t
)0x00000400

	)

7894 
	#ETH_MACFFR_SAF
 ((
ut32_t
)0x00000200

	)

7895 
	#ETH_MACFFR_SAIF
 ((
ut32_t
)0x00000100

	)

7896 
	#ETH_MACFFR_PCF
 ((
ut32_t
)0x000000C0

	)

7897 
	#ETH_MACFFR_PCF_BlockA
 ((
ut32_t
)0x00000040

	)

7898 
	#ETH_MACFFR_PCF_FwdA
 ((
ut32_t
)0x00000080

	)

7899 
	#ETH_MACFFR_PCF_FwdPasdAddrFr
 ((
ut32_t
)0x000000C0

	)

7900 
	#ETH_MACFFR_BFD
 ((
ut32_t
)0x00000020

	)

7901 
	#ETH_MACFFR_PAM
 ((
ut32_t
)0x00000010

	)

7902 
	#ETH_MACFFR_DAIF
 ((
ut32_t
)0x00000008

	)

7903 
	#ETH_MACFFR_HM
 ((
ut32_t
)0x00000004

	)

7904 
	#ETH_MACFFR_HU
 ((
ut32_t
)0x00000002

	)

7905 
	#ETH_MACFFR_PM
 ((
ut32_t
)0x00000001

	)

7908 
	#ETH_MACHTHR_HTH
 ((
ut32_t
)0xFFFFFFFF

	)

7911 
	#ETH_MACHTLR_HTL
 ((
ut32_t
)0xFFFFFFFF

	)

7914 
	#ETH_MACMIIAR_PA
 ((
ut32_t
)0x0000F800

	)

7915 
	#ETH_MACMIIAR_MR
 ((
ut32_t
)0x000007C0

	)

7916 
	#ETH_MACMIIAR_CR
 ((
ut32_t
)0x0000001C

	)

7917 
	#ETH_MACMIIAR_CR_Div42
 ((
ut32_t
)0x00000000

	)

7918 
	#ETH_MACMIIAR_CR_Div16
 ((
ut32_t
)0x00000008

	)

7919 
	#ETH_MACMIIAR_CR_Div26
 ((
ut32_t
)0x0000000C

	)

7920 
	#ETH_MACMIIAR_MW
 ((
ut32_t
)0x00000002

	)

7921 
	#ETH_MACMIIAR_MB
 ((
ut32_t
)0x00000001

	)

7924 
	#ETH_MACMIIDR_MD
 ((
ut32_t
)0x0000FFFF

	)

7927 
	#ETH_MACFCR_PT
 ((
ut32_t
)0xFFFF0000

	)

7928 
	#ETH_MACFCR_ZQPD
 ((
ut32_t
)0x00000080

	)

7929 
	#ETH_MACFCR_PLT
 ((
ut32_t
)0x00000030

	)

7930 
	#ETH_MACFCR_PLT_Mus4
 ((
ut32_t
)0x00000000

	)

7931 
	#ETH_MACFCR_PLT_Mus28
 ((
ut32_t
)0x00000010

	)

7932 
	#ETH_MACFCR_PLT_Mus144
 ((
ut32_t
)0x00000020

	)

7933 
	#ETH_MACFCR_PLT_Mus256
 ((
ut32_t
)0x00000030

	)

7934 
	#ETH_MACFCR_UPFD
 ((
ut32_t
)0x00000008

	)

7935 
	#ETH_MACFCR_RFCE
 ((
ut32_t
)0x00000004

	)

7936 
	#ETH_MACFCR_TFCE
 ((
ut32_t
)0x00000002

	)

7937 
	#ETH_MACFCR_FCBBPA
 ((
ut32_t
)0x00000001

	)

7940 
	#ETH_MACVLANTR_VLANTC
 ((
ut32_t
)0x00010000

	)

7941 
	#ETH_MACVLANTR_VLANTI
 ((
ut32_t
)0x0000FFFF

	)

7944 
	#ETH_MACRWUFFR_D
 ((
ut32_t
)0xFFFFFFFF

	)

7958 
	#ETH_MACPMTCSR_WFFRPR
 ((
ut32_t
)0x80000000

	)

7959 
	#ETH_MACPMTCSR_GU
 ((
ut32_t
)0x00000200

	)

7960 
	#ETH_MACPMTCSR_WFR
 ((
ut32_t
)0x00000040

	)

7961 
	#ETH_MACPMTCSR_MPR
 ((
ut32_t
)0x00000020

	)

7962 
	#ETH_MACPMTCSR_WFE
 ((
ut32_t
)0x00000004

	)

7963 
	#ETH_MACPMTCSR_MPE
 ((
ut32_t
)0x00000002

	)

7964 
	#ETH_MACPMTCSR_PD
 ((
ut32_t
)0x00000001

	)

7967 
	#ETH_MACSR_TSTS
 ((
ut32_t
)0x00000200

	)

7968 
	#ETH_MACSR_MMCTS
 ((
ut32_t
)0x00000040

	)

7969 
	#ETH_MACSR_MMMCRS
 ((
ut32_t
)0x00000020

	)

7970 
	#ETH_MACSR_MMCS
 ((
ut32_t
)0x00000010

	)

7971 
	#ETH_MACSR_PMTS
 ((
ut32_t
)0x00000008

	)

7974 
	#ETH_MACIMR_TSTIM
 ((
ut32_t
)0x00000200

	)

7975 
	#ETH_MACIMR_PMTIM
 ((
ut32_t
)0x00000008

	)

7978 
	#ETH_MACA0HR_MACA0H
 ((
ut32_t
)0x0000FFFF

	)

7981 
	#ETH_MACA0LR_MACA0L
 ((
ut32_t
)0xFFFFFFFF

	)

7984 
	#ETH_MACA1HR_AE
 ((
ut32_t
)0x80000000

	)

7985 
	#ETH_MACA1HR_SA
 ((
ut32_t
)0x40000000

	)

7986 
	#ETH_MACA1HR_MBC
 ((
ut32_t
)0x3F000000

	)

7987 
	#ETH_MACA1HR_MBC_HBs15_8
 ((
ut32_t
)0x20000000

	)

7988 
	#ETH_MACA1HR_MBC_HBs7_0
 ((
ut32_t
)0x10000000

	)

7989 
	#ETH_MACA1HR_MBC_LBs31_24
 ((
ut32_t
)0x08000000

	)

7990 
	#ETH_MACA1HR_MBC_LBs23_16
 ((
ut32_t
)0x04000000

	)

7991 
	#ETH_MACA1HR_MBC_LBs15_8
 ((
ut32_t
)0x02000000

	)

7992 
	#ETH_MACA1HR_MBC_LBs7_0
 ((
ut32_t
)0x01000000

	)

7993 
	#ETH_MACA1HR_MACA1H
 ((
ut32_t
)0x0000FFFF

	)

7996 
	#ETH_MACA1LR_MACA1L
 ((
ut32_t
)0xFFFFFFFF

	)

7999 
	#ETH_MACA2HR_AE
 ((
ut32_t
)0x80000000

	)

8000 
	#ETH_MACA2HR_SA
 ((
ut32_t
)0x40000000

	)

8001 
	#ETH_MACA2HR_MBC
 ((
ut32_t
)0x3F000000

	)

8002 
	#ETH_MACA2HR_MBC_HBs15_8
 ((
ut32_t
)0x20000000

	)

8003 
	#ETH_MACA2HR_MBC_HBs7_0
 ((
ut32_t
)0x10000000

	)

8004 
	#ETH_MACA2HR_MBC_LBs31_24
 ((
ut32_t
)0x08000000

	)

8005 
	#ETH_MACA2HR_MBC_LBs23_16
 ((
ut32_t
)0x04000000

	)

8006 
	#ETH_MACA2HR_MBC_LBs15_8
 ((
ut32_t
)0x02000000

	)

8007 
	#ETH_MACA2HR_MBC_LBs7_0
 ((
ut32_t
)0x01000000

	)

8008 
	#ETH_MACA2HR_MACA2H
 ((
ut32_t
)0x0000FFFF

	)

8011 
	#ETH_MACA2LR_MACA2L
 ((
ut32_t
)0xFFFFFFFF

	)

8014 
	#ETH_MACA3HR_AE
 ((
ut32_t
)0x80000000

	)

8015 
	#ETH_MACA3HR_SA
 ((
ut32_t
)0x40000000

	)

8016 
	#ETH_MACA3HR_MBC
 ((
ut32_t
)0x3F000000

	)

8017 
	#ETH_MACA3HR_MBC_HBs15_8
 ((
ut32_t
)0x20000000

	)

8018 
	#ETH_MACA3HR_MBC_HBs7_0
 ((
ut32_t
)0x10000000

	)

8019 
	#ETH_MACA3HR_MBC_LBs31_24
 ((
ut32_t
)0x08000000

	)

8020 
	#ETH_MACA3HR_MBC_LBs23_16
 ((
ut32_t
)0x04000000

	)

8021 
	#ETH_MACA3HR_MBC_LBs15_8
 ((
ut32_t
)0x02000000

	)

8022 
	#ETH_MACA3HR_MBC_LBs7_0
 ((
ut32_t
)0x01000000

	)

8023 
	#ETH_MACA3HR_MACA3H
 ((
ut32_t
)0x0000FFFF

	)

8026 
	#ETH_MACA3LR_MACA3L
 ((
ut32_t
)0xFFFFFFFF

	)

8033 
	#ETH_MMCCR_MCF
 ((
ut32_t
)0x00000008

	)

8034 
	#ETH_MMCCR_ROR
 ((
ut32_t
)0x00000004

	)

8035 
	#ETH_MMCCR_CSR
 ((
ut32_t
)0x00000002

	)

8036 
	#ETH_MMCCR_CR
 ((
ut32_t
)0x00000001

	)

8039 
	#ETH_MMCRIR_RGUFS
 ((
ut32_t
)0x00020000

	)

8040 
	#ETH_MMCRIR_RFAES
 ((
ut32_t
)0x00000040

	)

8041 
	#ETH_MMCRIR_RFCES
 ((
ut32_t
)0x00000020

	)

8044 
	#ETH_MMCTIR_TGFS
 ((
ut32_t
)0x00200000

	)

8045 
	#ETH_MMCTIR_TGFMSCS
 ((
ut32_t
)0x00008000

	)

8046 
	#ETH_MMCTIR_TGFSCS
 ((
ut32_t
)0x00004000

	)

8049 
	#ETH_MMCRIMR_RGUFM
 ((
ut32_t
)0x00020000

	)

8050 
	#ETH_MMCRIMR_RFAEM
 ((
ut32_t
)0x00000040

	)

8051 
	#ETH_MMCRIMR_RFCEM
 ((
ut32_t
)0x00000020

	)

8054 
	#ETH_MMCTIMR_TGFM
 ((
ut32_t
)0x00200000

	)

8055 
	#ETH_MMCTIMR_TGFMSCM
 ((
ut32_t
)0x00008000

	)

8056 
	#ETH_MMCTIMR_TGFSCM
 ((
ut32_t
)0x00004000

	)

8059 
	#ETH_MMCTGFSCCR_TGFSCC
 ((
ut32_t
)0xFFFFFFFF

	)

8062 
	#ETH_MMCTGFMSCCR_TGFMSCC
 ((
ut32_t
)0xFFFFFFFF

	)

8065 
	#ETH_MMCTGFCR_TGFC
 ((
ut32_t
)0xFFFFFFFF

	)

8068 
	#ETH_MMCRFCECR_RFCEC
 ((
ut32_t
)0xFFFFFFFF

	)

8071 
	#ETH_MMCRFAECR_RFAEC
 ((
ut32_t
)0xFFFFFFFF

	)

8074 
	#ETH_MMCRGUFCR_RGUFC
 ((
ut32_t
)0xFFFFFFFF

	)

8081 
	#ETH_PTPTSCR_TSARU
 ((
ut32_t
)0x00000020

	)

8082 
	#ETH_PTPTSCR_TSITE
 ((
ut32_t
)0x00000010

	)

8083 
	#ETH_PTPTSCR_TSSTU
 ((
ut32_t
)0x00000008

	)

8084 
	#ETH_PTPTSCR_TSSTI
 ((
ut32_t
)0x00000004

	)

8085 
	#ETH_PTPTSCR_TSFCU
 ((
ut32_t
)0x00000002

	)

8086 
	#ETH_PTPTSCR_TSE
 ((
ut32_t
)0x00000001

	)

8089 
	#ETH_PTPSSIR_STSSI
 ((
ut32_t
)0x000000FF

	)

8092 
	#ETH_PTPTSHR_STS
 ((
ut32_t
)0xFFFFFFFF

	)

8095 
	#ETH_PTPTSLR_STPNS
 ((
ut32_t
)0x80000000

	)

8096 
	#ETH_PTPTSLR_STSS
 ((
ut32_t
)0x7FFFFFFF

	)

8099 
	#ETH_PTPTSHUR_TSUS
 ((
ut32_t
)0xFFFFFFFF

	)

8102 
	#ETH_PTPTSLUR_TSUPNS
 ((
ut32_t
)0x80000000

	)

8103 
	#ETH_PTPTSLUR_TSUSS
 ((
ut32_t
)0x7FFFFFFF

	)

8106 
	#ETH_PTPTSAR_TSA
 ((
ut32_t
)0xFFFFFFFF

	)

8109 
	#ETH_PTPTTHR_TTSH
 ((
ut32_t
)0xFFFFFFFF

	)

8112 
	#ETH_PTPTTLR_TTSL
 ((
ut32_t
)0xFFFFFFFF

	)

8119 
	#ETH_DMABMR_AAB
 ((
ut32_t
)0x02000000

	)

8120 
	#ETH_DMABMR_FPM
 ((
ut32_t
)0x01000000

	)

8121 
	#ETH_DMABMR_USP
 ((
ut32_t
)0x00800000

	)

8122 
	#ETH_DMABMR_RDP
 ((
ut32_t
)0x007E0000

	)

8123 
	#ETH_DMABMR_RDP_1Bt
 ((
ut32_t
)0x00020000

	)

8124 
	#ETH_DMABMR_RDP_2Bt
 ((
ut32_t
)0x00040000

	)

8125 
	#ETH_DMABMR_RDP_4Bt
 ((
ut32_t
)0x00080000

	)

8126 
	#ETH_DMABMR_RDP_8Bt
 ((
ut32_t
)0x00100000

	)

8127 
	#ETH_DMABMR_RDP_16Bt
 ((
ut32_t
)0x00200000

	)

8128 
	#ETH_DMABMR_RDP_32Bt
 ((
ut32_t
)0x00400000

	)

8129 
	#ETH_DMABMR_RDP_4xPBL_4Bt
 ((
ut32_t
)0x01020000

	)

8130 
	#ETH_DMABMR_RDP_4xPBL_8Bt
 ((
ut32_t
)0x01040000

	)

8131 
	#ETH_DMABMR_RDP_4xPBL_16Bt
 ((
ut32_t
)0x01080000

	)

8132 
	#ETH_DMABMR_RDP_4xPBL_32Bt
 ((
ut32_t
)0x01100000

	)

8133 
	#ETH_DMABMR_RDP_4xPBL_64Bt
 ((
ut32_t
)0x01200000

	)

8134 
	#ETH_DMABMR_RDP_4xPBL_128Bt
 ((
ut32_t
)0x01400000

	)

8135 
	#ETH_DMABMR_FB
 ((
ut32_t
)0x00010000

	)

8136 
	#ETH_DMABMR_RTPR
 ((
ut32_t
)0x0000C000

	)

8137 
	#ETH_DMABMR_RTPR_1_1
 ((
ut32_t
)0x00000000

	)

8138 
	#ETH_DMABMR_RTPR_2_1
 ((
ut32_t
)0x00004000

	)

8139 
	#ETH_DMABMR_RTPR_3_1
 ((
ut32_t
)0x00008000

	)

8140 
	#ETH_DMABMR_RTPR_4_1
 ((
ut32_t
)0x0000C000

	)

8141 
	#ETH_DMABMR_PBL
 ((
ut32_t
)0x00003F00

	)

8142 
	#ETH_DMABMR_PBL_1Bt
 ((
ut32_t
)0x00000100

	)

8143 
	#ETH_DMABMR_PBL_2Bt
 ((
ut32_t
)0x00000200

	)

8144 
	#ETH_DMABMR_PBL_4Bt
 ((
ut32_t
)0x00000400

	)

8145 
	#ETH_DMABMR_PBL_8Bt
 ((
ut32_t
)0x00000800

	)

8146 
	#ETH_DMABMR_PBL_16Bt
 ((
ut32_t
)0x00001000

	)

8147 
	#ETH_DMABMR_PBL_32Bt
 ((
ut32_t
)0x00002000

	)

8148 
	#ETH_DMABMR_PBL_4xPBL_4Bt
 ((
ut32_t
)0x01000100

	)

8149 
	#ETH_DMABMR_PBL_4xPBL_8Bt
 ((
ut32_t
)0x01000200

	)

8150 
	#ETH_DMABMR_PBL_4xPBL_16Bt
 ((
ut32_t
)0x01000400

	)

8151 
	#ETH_DMABMR_PBL_4xPBL_32Bt
 ((
ut32_t
)0x01000800

	)

8152 
	#ETH_DMABMR_PBL_4xPBL_64Bt
 ((
ut32_t
)0x01001000

	)

8153 
	#ETH_DMABMR_PBL_4xPBL_128Bt
 ((
ut32_t
)0x01002000

	)

8154 
	#ETH_DMABMR_DSL
 ((
ut32_t
)0x0000007C

	)

8155 
	#ETH_DMABMR_DA
 ((
ut32_t
)0x00000002

	)

8156 
	#ETH_DMABMR_SR
 ((
ut32_t
)0x00000001

	)

8159 
	#ETH_DMATPDR_TPD
 ((
ut32_t
)0xFFFFFFFF

	)

8162 
	#ETH_DMARPDR_RPD
 ((
ut32_t
)0xFFFFFFFF

	)

8165 
	#ETH_DMARDLAR_SRL
 ((
ut32_t
)0xFFFFFFFF

	)

8168 
	#ETH_DMATDLAR_STL
 ((
ut32_t
)0xFFFFFFFF

	)

8171 
	#ETH_DMASR_TSTS
 ((
ut32_t
)0x20000000

	)

8172 
	#ETH_DMASR_PMTS
 ((
ut32_t
)0x10000000

	)

8173 
	#ETH_DMASR_MMCS
 ((
ut32_t
)0x08000000

	)

8174 
	#ETH_DMASR_EBS
 ((
ut32_t
)0x03800000

	)

8176 
	#ETH_DMASR_EBS_DescAcss
 ((
ut32_t
)0x02000000

	)

8177 
	#ETH_DMASR_EBS_RdTnsf
 ((
ut32_t
)0x01000000

	)

8178 
	#ETH_DMASR_EBS_DaTnsfTx
 ((
ut32_t
)0x00800000

	)

8179 
	#ETH_DMASR_TPS
 ((
ut32_t
)0x00700000

	)

8180 
	#ETH_DMASR_TPS_Stݳd
 ((
ut32_t
)0x00000000

	)

8181 
	#ETH_DMASR_TPS_Fchg
 ((
ut32_t
)0x00100000

	)

8182 
	#ETH_DMASR_TPS_Wag
 ((
ut32_t
)0x00200000

	)

8183 
	#ETH_DMASR_TPS_Rdg
 ((
ut32_t
)0x00300000

	)

8184 
	#ETH_DMASR_TPS_Suded
 ((
ut32_t
)0x00600000

	)

8185 
	#ETH_DMASR_TPS_Closg
 ((
ut32_t
)0x00700000

	)

8186 
	#ETH_DMASR_RPS
 ((
ut32_t
)0x000E0000

	)

8187 
	#ETH_DMASR_RPS_Stݳd
 ((
ut32_t
)0x00000000

	)

8188 
	#ETH_DMASR_RPS_Fchg
 ((
ut32_t
)0x00020000

	)

8189 
	#ETH_DMASR_RPS_Wag
 ((
ut32_t
)0x00060000

	)

8190 
	#ETH_DMASR_RPS_Suded
 ((
ut32_t
)0x00080000

	)

8191 
	#ETH_DMASR_RPS_Closg
 ((
ut32_t
)0x000A0000

	)

8192 
	#ETH_DMASR_RPS_Queug
 ((
ut32_t
)0x000E0000

	)

8193 
	#ETH_DMASR_NIS
 ((
ut32_t
)0x00010000

	)

8194 
	#ETH_DMASR_AIS
 ((
ut32_t
)0x00008000

	)

8195 
	#ETH_DMASR_ERS
 ((
ut32_t
)0x00004000

	)

8196 
	#ETH_DMASR_FBES
 ((
ut32_t
)0x00002000

	)

8197 
	#ETH_DMASR_ETS
 ((
ut32_t
)0x00000400

	)

8198 
	#ETH_DMASR_RWTS
 ((
ut32_t
)0x00000200

	)

8199 
	#ETH_DMASR_RPSS
 ((
ut32_t
)0x00000100

	)

8200 
	#ETH_DMASR_RBUS
 ((
ut32_t
)0x00000080

	)

8201 
	#ETH_DMASR_RS
 ((
ut32_t
)0x00000040

	)

8202 
	#ETH_DMASR_TUS
 ((
ut32_t
)0x00000020

	)

8203 
	#ETH_DMASR_ROS
 ((
ut32_t
)0x00000010

	)

8204 
	#ETH_DMASR_TJTS
 ((
ut32_t
)0x00000008

	)

8205 
	#ETH_DMASR_TBUS
 ((
ut32_t
)0x00000004

	)

8206 
	#ETH_DMASR_TPSS
 ((
ut32_t
)0x00000002

	)

8207 
	#ETH_DMASR_TS
 ((
ut32_t
)0x00000001

	)

8210 
	#ETH_DMAOMR_DTCEFD
 ((
ut32_t
)0x04000000

	)

8211 
	#ETH_DMAOMR_RSF
 ((
ut32_t
)0x02000000

	)

8212 
	#ETH_DMAOMR_DFRF
 ((
ut32_t
)0x01000000

	)

8213 
	#ETH_DMAOMR_TSF
 ((
ut32_t
)0x00200000

	)

8214 
	#ETH_DMAOMR_FTF
 ((
ut32_t
)0x00100000

	)

8215 
	#ETH_DMAOMR_TTC
 ((
ut32_t
)0x0001C000

	)

8216 
	#ETH_DMAOMR_TTC_64Bys
 ((
ut32_t
)0x00000000

	)

8217 
	#ETH_DMAOMR_TTC_128Bys
 ((
ut32_t
)0x00004000

	)

8218 
	#ETH_DMAOMR_TTC_192Bys
 ((
ut32_t
)0x00008000

	)

8219 
	#ETH_DMAOMR_TTC_256Bys
 ((
ut32_t
)0x0000C000

	)

8220 
	#ETH_DMAOMR_TTC_40Bys
 ((
ut32_t
)0x00010000

	)

8221 
	#ETH_DMAOMR_TTC_32Bys
 ((
ut32_t
)0x00014000

	)

8222 
	#ETH_DMAOMR_TTC_24Bys
 ((
ut32_t
)0x00018000

	)

8223 
	#ETH_DMAOMR_TTC_16Bys
 ((
ut32_t
)0x0001C000

	)

8224 
	#ETH_DMAOMR_ST
 ((
ut32_t
)0x00002000

	)

8225 
	#ETH_DMAOMR_FEF
 ((
ut32_t
)0x00000080

	)

8226 
	#ETH_DMAOMR_FUGF
 ((
ut32_t
)0x00000040

	)

8227 
	#ETH_DMAOMR_RTC
 ((
ut32_t
)0x00000018

	)

8228 
	#ETH_DMAOMR_RTC_64Bys
 ((
ut32_t
)0x00000000

	)

8229 
	#ETH_DMAOMR_RTC_32Bys
 ((
ut32_t
)0x00000008

	)

8230 
	#ETH_DMAOMR_RTC_96Bys
 ((
ut32_t
)0x00000010

	)

8231 
	#ETH_DMAOMR_RTC_128Bys
 ((
ut32_t
)0x00000018

	)

8232 
	#ETH_DMAOMR_OSF
 ((
ut32_t
)0x00000004

	)

8233 
	#ETH_DMAOMR_SR
 ((
ut32_t
)0x00000002

	)

8236 
	#ETH_DMAIER_NISE
 ((
ut32_t
)0x00010000

	)

8237 
	#ETH_DMAIER_AISE
 ((
ut32_t
)0x00008000

	)

8238 
	#ETH_DMAIER_ERIE
 ((
ut32_t
)0x00004000

	)

8239 
	#ETH_DMAIER_FBEIE
 ((
ut32_t
)0x00002000

	)

8240 
	#ETH_DMAIER_ETIE
 ((
ut32_t
)0x00000400

	)

8241 
	#ETH_DMAIER_RWTIE
 ((
ut32_t
)0x00000200

	)

8242 
	#ETH_DMAIER_RPSIE
 ((
ut32_t
)0x00000100

	)

8243 
	#ETH_DMAIER_RBUIE
 ((
ut32_t
)0x00000080

	)

8244 
	#ETH_DMAIER_RIE
 ((
ut32_t
)0x00000040

	)

8245 
	#ETH_DMAIER_TUIE
 ((
ut32_t
)0x00000020

	)

8246 
	#ETH_DMAIER_ROIE
 ((
ut32_t
)0x00000010

	)

8247 
	#ETH_DMAIER_TJTIE
 ((
ut32_t
)0x00000008

	)

8248 
	#ETH_DMAIER_TBUIE
 ((
ut32_t
)0x00000004

	)

8249 
	#ETH_DMAIER_TPSIE
 ((
ut32_t
)0x00000002

	)

8250 
	#ETH_DMAIER_TIE
 ((
ut32_t
)0x00000001

	)

8253 
	#ETH_DMAMFBOCR_OFOC
 ((
ut32_t
)0x10000000

	)

8254 
	#ETH_DMAMFBOCR_MFA
 ((
ut32_t
)0x0FFE0000

	)

8255 
	#ETH_DMAMFBOCR_OMFC
 ((
ut32_t
)0x00010000

	)

8256 
	#ETH_DMAMFBOCR_MFC
 ((
ut32_t
)0x0000FFFF

	)

8259 
	#ETH_DMACHTDR_HTDAP
 ((
ut32_t
)0xFFFFFFFF

	)

8262 
	#ETH_DMACHRDR_HRDAP
 ((
ut32_t
)0xFFFFFFFF

	)

8265 
	#ETH_DMACHTBAR_HTBAP
 ((
ut32_t
)0xFFFFFFFF

	)

8268 
	#ETH_DMACHRBAR_HRBAP
 ((
ut32_t
)0xFFFFFFFF

	)

8279 #ifde
USE_STDPERIPH_DRIVER


8280 
	~"m32f10x_cf.h
"

8287 
	#SET_BIT
(
REG
, 
BIT
((REG|(BIT))

	)

8289 
	#CLEAR_BIT
(
REG
, 
BIT
((REG&~(BIT))

	)

8291 
	#READ_BIT
(
REG
, 
BIT
((REG& (BIT))

	)

8293 
	#CLEAR_REG
(
REG
((REG(0x0))

	)

8295 
	#WRITE_REG
(
REG
, 
VAL
((REG(VAL))

	)

8297 
	#READ_REG
(
REG
((REG))

	)

8299 
	#MODIFY_REG
(
REG
, 
CLEARMASK
, 
SETMASK

	`WRITE_REG
((REG), (((
	`READ_REG
(REG)& (~(CLEARMASK))| (SETMASK)))

	)

8305 #ifde
__lulus


	@ports/stm32f10x/CMSIS/system_stm32f10x.h

32 #ide
__SYSTEM_STM32F10X_H


33 
	#__SYSTEM_STM32F10X_H


	)

35 #ifde
__lulus


52 
ut32_t
 
SyemCeClock
;

78 
SyemIn
();

79 
SyemCeClockUpde
();

84 #ifde
__lulus


	@ports/stm32f10x/automac.c

25 
	~<dbo.h
>

26 
	~<dt.h
>

27 
	~<dlib.h
>

28 
	~"bacdef.h
"

29 
	~"bacdcode.h
"

30 
	~"banum.h
"

31 
	~"cfig.h
"

32 
	~"mpdef.h
"

33 
	~"automac.h
"

40 
bo
 
	mpfm
:1;

42 
bo
 
	memr
:1;

45 
bo
 
	mtok
:1;

47 
bo
 
	mrved
:1;

48 } 
	tAUTO_MAC_DATA
;

50 
	#MAC_SLOTS_OFFSET
 32

	)

52 
	#MAC_SLOTS_MAX
 128

	)

53 
AUTO_MAC_DATA
 
	gAuto_MAC_Da
[
MAC_SLOTS_MAX
];

55 
ut8_t
 
	gMy_MAC_Addss
;

57 
ut16_t
 
	gMy_Time_Sl
;

59 
bo
 
	gPFM_Cye_Come
;

61 
bo
 
	gAuto_Mode_Ebd
;

68 
bo
 
	$automac_abd
(

71  
Auto_Mode_Ebd
;

72 
	}
}

79 
	$automac_abd_t
(

80 
bo
 
us
)

82 
Auto_Mode_Ebd
 = 
us
;

83 
	}
}

90 
bo
 
	$automac_pfm_cye_come
(

93  
PFM_Cye_Come
;

94 
	}
}

101 
bo
 
	$automac_addss_ud
(

102 
ut8_t
 
mac
)

104 
bo
 
us
 = 
l
;

106 i(
mac
 < 
MAC_SLOTS_MAX
) {

107 i((
Auto_MAC_Da
[
mac
].
emr
|| (Auto_MAC_Da[mac].
rved
) ||

108 (
Auto_MAC_Da
[
mac
].
tok
)) {

109 
us
 = 
ue
;

113  
us
;

114 
	}
}

121 
bo
 
	$automac__addss_vid
(

122 
ut8_t
 
mac
)

124 
bo
 
us
 = 
l
;

126 i(
mac
 < 
MAC_SLOTS_MAX
) {

127 i((
Auto_MAC_Da
[
mac
].
pfm
&& (!
	`automac_addss_ud
(mac))) {

128 
us
 = 
ue
;

132  
us
;

133 
	}
}

140 
ut8_t
 
	$automac_xt_i
(

141 
ut8_t
 
mac
)

143 
ut8_t
 
i
 = 0;

144 
ut8_t
 
xt_i
 = 255;

145 
ut8_t
 
_i
 = 0;

147 
_i
 = (
mac
 + 1) % 128;

148 
i
 = 0; i < 
MAC_SLOTS_MAX
; i++) {

149 i(
Auto_MAC_Da
[
_i
].
tok
) {

150 
xt_i
 = 
_i
;

153 
_i
 = (_i + 1% 
MAC_SLOTS_MAX
;

156  
xt_i
;

157 
	}
}

164 
ut8_t
 
	$automac__addss_cou
(

167 
ut8_t
 
i
 = 0;

168 
ut8_t
 
s
 = 0;

170 
i
 = 0; i < 
MAC_SLOTS_MAX
; i++) {

171 i(
	`automac__addss_vid
(
i
)) {

172 
s
++;

176  
s
;

177 
	}
}

184 
ut8_t
 
	$automac__addss_mac
(

185 
ut8_t
 
cou
)

187 
ut8_t
 
i
 = 0;

188 
ut8_t
 
s
 = 0;

189 
ut8_t
 
mac
 = 255;

191 
i
 = 0; i < 
MAC_SLOTS_MAX
; i++) {

192 i(
	`automac__addss_vid
(
i
)) {

193 i(
s
 =
cou
) {

194 
mac
 = 
i
;

197 
s
++;

201  
mac
;

202 
	}
}

209 
ut8_t
 
	$automac__addss_ndom
(

212 
ut8_t
 
cou
 = 0;

213 
ut8_t
 
ndom_cou
 = 0;

214 
ut8_t
 
mac
 = 255;

216 
cou
 = 
	`automac__addss_cou
();

217 i(
cou
) {

218 
ndom_cou
 =(
ut8_t
)(
	`nd
(% 
cou
);

219 
mac
 = 
	`automac__addss_mac
(
ndom_cou
);

222  
mac
;

223 
	}
}

230 
ut8_t
 
	$automac_addss
(

233  
My_MAC_Addss
;

234 
	}
}

241 
	$automac_addss_t
(

242 
ut8_t
 
mac
)

244 
My_MAC_Addss
 = 
mac
;

245 
	}
}

252 
ut16_t
 
	$automac_time_
(

255  
My_Time_Sl
;

256 
	}
}

263 
	$automac_addss_
(

266 
My_MAC_Addss
 =

267 
MAC_SLOTS_OFFSET
 + 
	`nd
(% (
MAC_SLOTS_MAX
 - MAC_SLOTS_OFFSET);

269 
My_Time_Sl
 = 
Tno_tok
 + (
MAC_SLOTS_MAX
 * 
T
);

270 
My_Time_Sl
 +(
ut16_t

My_MAC_Addss
 *
T
;

271 
	}
}

278 
	$automac_pfm_t
(

279 
ut8_t
 
mac
)

281 i(
mac
 < 
MAC_SLOTS_MAX
) {

282 i(
Auto_MAC_Da
[
mac
].
pfm
) {

284 i(
	`automac__addss_cou
() > 0) {

285 
PFM_Cye_Come
 = 
ue
;

288 
Auto_MAC_Da
[
mac
].
pfm
 = 
ue
;

290 
	}
}

297 
	$automac_tok_t
(

298 
ut8_t
 
mac
)

300 i(
mac
 < 
MAC_SLOTS_MAX
) {

301 
Auto_MAC_Da
[
mac
].
tok
 = 
ue
;

303 
	}
}

310 
	$automac_emr_t
(

311 
ut8_t
 
mac
)

313 i(
mac
 < 
MAC_SLOTS_MAX
) {

314 
Auto_MAC_Da
[
mac
].
emr
 = 
ue
;

316 
	}
}

323 
	$automac_
(

326 
ut8_t
 
i
 = 0;

328 
i
 = 0; i < 
MAC_SLOTS_MAX
; i++) {

329 
Auto_MAC_Da
[
i
].
tok
 = 
l
;

330 
Auto_MAC_Da
[
i
].
emr
 = 
l
;

331 
Auto_MAC_Da
[
i
].
pfm
 = 
l
;

332 i(
i
 < 
MAC_SLOTS_OFFSET
) {

333 
Auto_MAC_Da
[
i
].
rved
 = 
ue
;

335 
Auto_MAC_Da
[
i
].
rved
 = 
l
;

338 
	`automac_addss_
();

339 
PFM_Cye_Come
 = 
l
;

340 
	}
}

342 #ifde
TEST


343 
	~<as.h
>

344 
	~<rg.h
>

345 
	~<dio.h
>

346 
	~"e.h
"

349 
	$_Auto_MAC
(

350 
Te
 * 
pTe
)

352 
ut8_t
 
mac
 = 255;

354 
	`automac_
();

355 
	`_
(
pTe
, 
	`automac__addss_cou
() == 0);

356 
mac
 = 
	`automac__addss_mac
(0);

357 
	`_
(
pTe
, 
mac
 == 255);

358 
	`automac_pfm_t
(
MAC_SLOTS_OFFSET
);

359 
mac
 = 
	`automac__addss_mac
(0);

360 
	`_
(
pTe
, 
mac
 =
MAC_SLOTS_OFFSET
);

361 
	`_
(
pTe
, 
	`automac__addss_cou
() == 1);

362 
	`automac_tok_t
(
MAC_SLOTS_OFFSET
);

363 
mac
 = 
	`automac__addss_mac
(0);

364 
	`_
(
pTe
, 
mac
 == 255);

365 
	`_
(
pTe
, 
	`automac__addss_cou
() == 0);

366 
	`automac_pfm_t
(127);

367 
mac
 = 
	`automac__addss_mac
(0);

368 
	`_
(
pTe
, 
mac
 == 127);

369 
	`_
(
pTe
, 
	`automac__addss_cou
() == 1);

370 
	`automac_tok_t
(127);

371 
mac
 = 
	`automac__addss_mac
(0);

372 
	`_
(
pTe
, 
mac
 == 255);

373 
	`_
(
pTe
, 
	`automac__addss_cou
() == 0);

375 
	`d
(42);

376 
mac
 = 
	`automac__addss_ndom
();

377 
	`_
(
pTe
, 
mac
 == 255);

378 
	`automac_pfm_t
(
MAC_SLOTS_OFFSET
 + 1);

379 
mac
 = 
	`automac__addss_mac
(0);

380 
	`_
(
pTe
, 
mac
 =(
MAC_SLOTS_OFFSET
 + 1));

381 
mac
 = 
	`automac__addss_ndom
();

382 
	`_
(
pTe
, 
mac
 =(
MAC_SLOTS_OFFSET
 + 1));

384 
	`automac_pfm_t
(
MAC_SLOTS_OFFSET
 + 2);

385 
mac
 = 
	`automac__addss_mac
(0);

386 
	`_
(
pTe
, 
mac
 =(
MAC_SLOTS_OFFSET
 + 1));

387 
mac
 = 
	`automac__addss_mac
(1);

388 
	`_
(
pTe
, 
mac
 =(
MAC_SLOTS_OFFSET
 + 2));

389 
mac
 = 
	`automac__addss_ndom
();

390 
	`_
(
pTe
, (
mac
 =(
MAC_SLOTS_OFFSET
 + 1)) ||

391 (
mac
 =(
MAC_SLOTS_OFFSET
 + 2)));

393 
	`automac_pfm_t
(126);

394 
mac
 = 
	`automac__addss_mac
(0);

395 
	`_
(
pTe
, 
mac
 =(
MAC_SLOTS_OFFSET
 + 1));

396 
mac
 = 
	`automac__addss_mac
(1);

397 
	`_
(
pTe
, 
mac
 =(
MAC_SLOTS_OFFSET
 + 2));

398 
mac
 = 
	`automac__addss_mac
(2);

399 
	`_
(
pTe
, 
mac
 == 126);

400 
mac
 = 
	`automac__addss_ndom
();

401 
	`_
(
pTe
, (
mac
 =(
MAC_SLOTS_OFFSET
 + 1)) ||

402 (
mac
 =(
MAC_SLOTS_OFFSET
 + 2)) || (mac == 126));

404 
mac
 = 
	`automac_addss
();

405 
	`_
(
pTe
, 
mac
 < 
MAC_SLOTS_MAX
);

406 
	`automac_addss_t
(
MAC_SLOTS_OFFSET
);

407 
mac
 = 
	`automac_addss
();

408 
	`_
(
pTe
, 
mac
 =
MAC_SLOTS_OFFSET
);

410 
	`automac_
();

411 
	`automac_tok_t
(0x6B);

412 
mac
 = 
	`automac_xt_i
(0x25);

413 
	`_
(
pTe
, 
mac
 == 0x6B);

414 
	}
}

416 #ifde
TEST_AUTOMAC


417 
	$ma
(

420 
Te
 *
pTe
;

421 
bo
 
rc
;

423 
pTe
 = 
	`_
("AutMAC", 
NULL
);

426 
rc
 = 
	`_addTeFuni
(
pTe
, 
_Auto_MAC
);

427 
	`as
(
rc
);

429 
	`_tSm
(
pTe
, 
dout
);

430 
	`_run
(
pTe
);

431 (
	`_pt
(
pTe
);

433 
	`_deroy
(
pTe
);

436 
	}
}

	@ports/stm32f10x/automac.h

25 #ide
AUTOMAC_H


26 
	#AUTOMAC_H


	)

28 
	~<dbo.h
>

29 
	~<dt.h
>

33 #ifde
__lulus


37 
automac_
(

40 
bo
 
automac__addss_vid
(

41 
ut8_t
 
mac
);

42 
ut8_t
 
automac__addss_cou
(

44 
ut8_t
 
automac__addss_mac
(

45 
ut8_t
 
cou
);

46 
ut8_t
 
automac__addss_ndom
(

48 
automac_pfm_t
(

49 
ut8_t
 
mac
);

50 
automac_tok_t
(

51 
ut8_t
 
mac
);

52 
automac_emr_t
(

53 
ut8_t
 
mac
);

54 
ut8_t
 
automac_xt_i
(

55 
ut8_t
 
mac
);

56 
ut8_t
 
automac_addss
(

58 
automac_addss_t
(

59 
ut8_t
 
mac
);

60 
automac_addss_
(

62 
ut16_t
 
automac_time_
(

64 
bo
 
automac_pfm_cye_come
(

66 
bo
 
automac_abd
(

68 
automac_abd_t
(

69 
bo
 
us
);

71 #ifde
__lulus


	@ports/stm32f10x/bacnet.c

25 
	~<dt.h
>

26 
	~<dbo.h
>

28 
	~"hdwe.h
"

29 
	~"tim.h
"

30 
	~"rs485.h
"

32 
	~"dk.h
"

33 
	~"du.h
"

34 
	~"hdrs.h
"

35 
	~".h
"

36 
	~"txbuf.h
"

37 
	~"dcc.h
"

38 
	~"m.h
"

40 
	~"devi.h
"

41 
	~"bo.h
"

43 
	~"ba.h
"

46 
im
 
	gDCC_Tim
;

47 
	#DCC_CYCLE_SECONDS
 1

	)

49 
	$ba_
(

52 
	`dlmp_t_mac_addss
(255);

53 
	`dlmp_t_max_ma
(127);

55 
	`dlmp_
(
NULL
);

57 
	`Devi_In
(
NULL
);

60 
du_t_uecognized_rvi_hdr_hdr


61 (
hdr_uecognized_rvi
);

63 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

64 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_HAS
, 
hdr_who_has
);

67 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

68 
hdr_ad_ݔty
);

69 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

70 
hdr_ad_ݔty_muɝ
);

71 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

72 
hdr_lize_devi
);

73 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_WRITE_PROPERTY
,

74 
hdr_wre_ݔty
);

76 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

77 
hdr_devi_communiti_cڌ
);

79 
	`tim_rv_t_cds
(&
DCC_Tim
, 
DCC_CYCLE_SECONDS
);

81 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

82 
	}
}

84 
ut8_t
 
	gPDUBufr
[
MAX_MPDU
];

85 
	$ba_sk
(

88 
ut16_t
 
pdu_n
;

89 
BACNET_ADDRESS
 
c
;

90 
ut8_t
 
i
;

91 
BACNET_BINARY_PV
 
by_vue
 = 
BINARY_INACTIVE
;

92 
BACNET_POLARITY
 
pެy
;

93 
bo
 
out_of_rvi
;

96 
i
 = 0; i < 
MAX_BINARY_OUTPUTS
; i++) {

97 
out_of_rvi
 = 
	`By_Ouut_Out_Of_Svi
(
i
);

98 i(!
out_of_rvi
) {

99 
by_vue
 = 
	`By_Ouut_P_Vue
(
i
);

100 
pެy
 = 
	`By_Ouut_Pެy
(
i
);

101 i(
pެy
 !
POLARITY_NORMAL
) {

102 i(
by_vue
 =
BINARY_ACTIVE
) {

103 
by_vue
 = 
BINARY_INACTIVE
;

105 
by_vue
 = 
BINARY_ACTIVE
;

108 i(
by_vue
 =
BINARY_ACTIVE
) {

109 i(
i
 == 0) {

115 i(
i
 == 0) {

124 i(
	`tim_rv_exped
(&
DCC_Tim
)) {

125 
	`tim_rv_t
(&
DCC_Tim
);

126 
	`dcc_tim_cds
(
DCC_CYCLE_SECONDS
);

129 
pdu_n
 = 
	`dk_ive
(&
c
, &
PDUBufr
[0], (PDUBuffer), 0);

130 i(
pdu_n
) {

131 
	`du_hdr
(&
c
, &
PDUBufr
[0], 
pdu_n
);

133 
	}
}

	@ports/stm32f10x/bacnet.h

24 #ide
BACNET_H


25 
	#BACNET_H


	)

27 
	~<dt.h
>

29 #ifde
__lulus


33 
ba_
(

35 
ba_sk
(

38 #ifde
__lulus


	@ports/stm32f10x/bo.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~<dio.h
>

31 
	~"bacdef.h
"

32 
	~"bacdcode.h
"

33 
	~"banum.h
"

34 
	~"cfig.h
"

35 
	~"wp.h
"

36 
	~"hdwe.h
"

37 
	~"hdrs.h
"

38 
	~"bo.h
"

40 #ide
MAX_BINARY_OUTPUTS


41 #r 
Pa
 
defe
 
MAX_BINARY_OUTPUTS


46 
	#RELINQUISH_DEFAULT
 
BINARY_INACTIVE


	)

48 
ut8_t
 
	gBy_Ouut_Lev
[
MAX_BINARY_OUTPUTS
][
BACNET_MAX_PRIORITY
];

51 
ut8_t
 
	gOut_Of_Svi
[
MAX_BINARY_OUTPUTS
];

53 
ut8_t
 
	gPެy
[
MAX_BINARY_OUTPUTS
];

56 cڡ 
	gBy_Ouut_Prݔts_Requed
[] = {

57 
PROP_OBJECT_IDENTIFIER
,

58 
PROP_OBJECT_NAME
,

59 
PROP_OBJECT_TYPE
,

60 
PROP_PRESENT_VALUE
,

61 
PROP_STATUS_FLAGS
,

62 
PROP_EVENT_STATE
,

63 
PROP_OUT_OF_SERVICE
,

64 
PROP_POLARITY
,

65 
PROP_PRIORITY_ARRAY
,

66 
PROP_RELINQUISH_DEFAULT
,

70 cڡ 
	gBy_Ouut_Prݔts_Oiڮ
[] = {

71 
PROP_ACTIVE_TEXT
,

72 
PROP_INACTIVE_TEXT
,

76 cڡ 
	gBy_Ouut_Prݔts_Prrry
[] = {

80 
	$By_Ouut_Prݔty_Lis
(

81 cڡ **
pRequed
,

82 cڡ **
pOiڮ
,

83 cڡ **
pPrrry
)

85 i(
pRequed
)

86 *
pRequed
 = 
By_Ouut_Prݔts_Requed
;

87 i(
pOiڮ
)

88 *
pOiڮ
 = 
By_Ouut_Prݔts_Oiڮ
;

89 i(
pPrrry
)

90 *
pPrrry
 = 
By_Ouut_Prݔts_Prrry
;

93 
	}
}

96 
bo
 
	$By_Ouut_Vid_In
(

97 
ut32_t
 
obje_
)

99 i(
obje_
 < 
MAX_BINARY_OUTPUTS
)

100  
ue
;

102  
l
;

103 
	}
}

106 
	$By_Ouut_Cou
(

109  
MAX_BINARY_OUTPUTS
;

110 
	}
}

113 
ut32_t
 
	$By_Ouut_Index_To_In
(

114 
dex
)

116  
dex
;

117 
	}
}

120 
	$By_Ouut_In_To_Index
(

121 
ut32_t
 
obje_
)

123 
dex
 = 
MAX_BINARY_OUTPUTS
;

125 i(
obje_
 < 
MAX_BINARY_OUTPUTS
)

126 
dex
 = 
obje_
;

128  
dex
;

129 
	}
}

131 
BACNET_BINARY_PV
 
	$P_Vue
(

132 
dex
)

134 
BACNET_BINARY_PV
 
vue
 = 
RELINQUISH_DEFAULT
;

135 
BACNET_BINARY_PV
 
cut_vue
 = 
RELINQUISH_DEFAULT
;

136 
i
 = 0;

138 i(
dex
 < 
MAX_BINARY_OUTPUTS
) {

139 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

140 
cut_vue
 = (
BACNET_BINARY_PV

By_Ouut_Lev
[
dex
][
i
];

141 i(
cut_vue
 !
BINARY_NULL
) {

142 
vue
 = (
BACNET_BINARY_PV

By_Ouut_Lev
[
dex
][
i
];

148  
vue
;

149 
	}
}

151 
BACNET_BINARY_PV
 
	$By_Ouut_P_Vue
(

152 
ut32_t
 
obje_
)

154 
dex
 = 0;

156 
dex
 = 
	`By_Ouut_In_To_Index
(
obje_
);

158  
	`P_Vue
(
dex
);

159 
	}
}

161 
bo
 
	$By_Ouut_P_Vue_S
(

162 
ut32_t
 

,

163 
BACNET_BINARY_PV
 
by_vue
,

164 
iܙy
)

166 
bo
 
us
 = 
l
;

168 i(

 < 
MAX_BINARY_OUTPUTS
) {

169 i(
iܙy
 < 
BACNET_MAX_PRIORITY
) {

170 
By_Ouut_Lev
[

][
iܙy
] = (
ut8_t

by_vue
;

171 
us
 = 
ue
;

175  
us
;

176 
	}
}

178 
bo
 
	$By_Ouut_Pެy_S
(

179 
ut32_t
 

,

180 
BACNET_POLARITY
 
pެy
)

182 
bo
 
us
 = 
l
;

184 i(

 < 
MAX_BINARY_OUTPUTS
) {

185 i(
pެy
 < 
MAX_POLARITY
) {

186 
Pެy
[

] = 
pެy
;

187 
us
 = 
ue
;

191  
us
;

192 
	}
}

194 
BACNET_POLARITY
 
	$By_Ouut_Pެy
(

195 
ut32_t
 

)

197 
BACNET_POLARITY
 
pެy
 = 
POLARITY_NORMAL
;

199 i(

 < 
MAX_BINARY_OUTPUTS
) {

200 
pެy
 = (
BACNET_POLARITY

Pެy
[

];

203  
pެy
;

204 
	}
}

206 
	$By_Ouut_Out_Of_Svi_S
(

207 
ut32_t
 

,

208 
bo
 
ag
)

210 i(

 < 
MAX_BINARY_OUTPUTS
) {

211 
Out_Of_Svi
[

] = 
ag
;

213 
	}
}

215 
bo
 
	$By_Ouut_Out_Of_Svi
(

216 
ut32_t
 

)

218 
bo
 
ag
 = 
l
;

220 i(

 < 
MAX_BINARY_OUTPUTS
) {

221 
ag
 = 
Out_Of_Svi
[

];

224  
ag
;

225 
	}
}

228 
bo
 
	$By_Ouut_Obje_Name
(

229 
ut32_t
 
obje_
,

230 
BACNET_CHARACTER_STRING
 * 
obje_me
)

232 
xt_rg
[16] = "BO-0";

233 
bo
 
us
 = 
l
;

235 i(
obje_
 < 
MAX_BINARY_OUTPUTS
) {

236 
xt_rg
[3] = '0' + (
ut8_t

obje_
;

237 
us
 = 
	`charg__si
(
obje_me
, 
xt_rg
);

240  
us
;

241 
	}
}

244 
	$By_Ouut_Rd_Prݔty
(

245 
BACNET_READ_PROPERTY_DATA
 * 
da
)

247 
n
 = 0;

248 
du_n
 = 0;

249 
BACNET_BIT_STRING
 
b_rg
;

250 
BACNET_CHARACTER_STRING
 
ch_rg
;

251 
BACNET_BINARY_PV
 
e_vue
 = 
BINARY_INACTIVE
;

252 
obje_dex
 = 0;

253 
i
 = 0;

254 
bo
 
e
 = 
l
;

255 
ut8_t
 *
du
 = 
NULL
;

257 i((
da
->
iti_da
 =
NULL
) ||

258 (
da
->
iti_da_n
 == 0)) {

261 
du
 = 
da
->
iti_da
;

262 
da
->
obje_ݔty
) {

264 
PROP_PRESENT_VALUE
:

265 
e_vue
 =

266 
	`By_Ouut_P_Vue
(
da
->
obje_
);

267 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

269 
PROP_STATUS_FLAGS
:

271 
	`brg_
(&
b_rg
);

272 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_IN_ALARM
, 
l
);

273 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_FAULT
, 
l
);

274 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OVERRIDDEN
, 
l
);

275 
	`brg_t_b
(&
b_rg
, 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

276 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

278 
PROP_EVENT_STATE
:

280 
du_n
 =

281 
	`code_iti_umed
(&
du
[0], 
EVENT_STATE_NORMAL
);

283 
PROP_OUT_OF_SERVICE
:

284 
obje_dex
 =

285 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

286 
e
 = 
Out_Of_Svi
[
obje_dex
];

287 
du_n
 = 
	`code_iti_boޗn
(&
du
[0], 
e
);

289 
PROP_POLARITY
:

290 
obje_dex
 =

291 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

292 
du_n
 =

293 
	`code_iti_umed
(&
du
[0],

294 
Pެy
[
obje_dex
]);

296 
PROP_PRIORITY_ARRAY
:

298 i(
da
->
y_dex
 == 0)

299 
du_n
 =

300 
	`code_iti_unsigd
(&
du
[0], 
BACNET_MAX_PRIORITY
);

303 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

304 
obje_dex
 =

305 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

306 
i
 = 0; i < 
BACNET_MAX_PRIORITY
; i++) {

308 
e_vue
 = (
BACNET_BINARY_PV
)

309 
By_Ouut_Lev
[
obje_dex
][
i
];

310 i(
e_vue
 =
BINARY_NULL
) {

311 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

313 
n
 =

314 
	`code_iti_umed
(&
du
[
du_n
],

315 
e_vue
);

318 i((
du_n
 + 
n
< 
MAX_APDU
)

319 
du_n
 +
n
;

321 
da
->
r_code
 =

322 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

323 
du_n
 = 
BACNET_STATUS_ABORT
;

328 
obje_dex
 =

329 
	`By_Ouut_In_To_Index
(
da
->
obje_
);

330 i(
da
->
y_dex
 <
BACNET_MAX_PRIORITY
) {

331 
e_vue
 = (
BACNET_BINARY_PV
)

332 
By_Ouut_Lev
[
obje_dex
][
da
->
y_dex
 -

334 i(
e_vue
 =
BINARY_NULL
) {

335 
du_n
 = 
	`code_iti_nu
(&
du
[apdu_len]);

337 
du_n
 =

338 
	`code_iti_umed
(&
du
[
du_n
],

339 
e_vue
);

342 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

343 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

344 
du_n
 = 
BACNET_STATUS_ERROR
;

348 
PROP_RELINQUISH_DEFAULT
:

349 
e_vue
 = 
RELINQUISH_DEFAULT
;

350 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
e_vue
);

352 
PROP_ACTIVE_TEXT
:

353 
	`charg__si
(&
ch_rg
, "on");

354 
du_n
 =

355 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

357 
PROP_INACTIVE_TEXT
:

358 
	`charg__si
(&
ch_rg
, "off");

359 
du_n
 =

360 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

363 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

364 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

365 
du_n
 = 
BACNET_STATUS_ERROR
;

369 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

370 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

371 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

372 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

373 
du_n
 = 
BACNET_STATUS_ERROR
;

376  
du_n
;

377 
	}
}

380 
bo
 
	$By_Ouut_Wre_Prݔty
(

381 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

383 
bo
 
us
 = 
l
;

384 
iܙy
 = 0;

385 
BACNET_BINARY_PV
 
v
 = 
BINARY_NULL
;

386 
n
 = 0;

387 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

390 
n
 =

391 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

392 
wp_da
->
iti_da_n
, &
vue
);

394 i(
n
 < 0) {

396 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

397 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

398  
l
;

400 i((
wp_da
->
obje_ݔty
 !
PROP_PRIORITY_ARRAY
) &&

401 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

403 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

404 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

405  
l
;

407 
wp_da
->
obje_ݔty
) {

408 
PROP_PRESENT_VALUE
:

409 
us
 =

410 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

411 &
wp_da
->
r_ass
, &wp_da->
r_code
);

412 i(
us
) {

413 
iܙy
 = 
wp_da
->priority;

417 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
) &&

418 (
iܙy
 != 6 ) &&

419 (
vue
.
ty
.
Enumed
 <
MAX_BINARY_PV
)) {

420 
v
 = (
BACNET_BINARY_PV

vue
.
ty
.
Enumed
;

421 
iܙy
--;

422 
	`By_Ouut_P_Vue_S
(
wp_da
->
obje_
,

423 
v
, 
iܙy
);

424 } i(
iܙy
 == 6) {

428 
us
 = 
l
;

429 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

430 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

432 
us
 = 
l
;

433 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

434 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

437 
us
 =

438 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_NULL
,

439 &
wp_da
->
r_ass
, &wp_da->
r_code
);

440 i(
us
) {

441 
v
 = 
BINARY_NULL
;

442 
iܙy
 = 
wp_da
->priority;

443 i(
iܙy
 && (iܙy <
BACNET_MAX_PRIORITY
)) {

444 
iܙy
--;

445 
By_Ouut_P_Vue_S


446 (
wp_da
->
obje_
, 
v
, 
iܙy
);

447 } i(
iܙy
 == 6) {

448 
us
 = 
l
;

452 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

453 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

455 
us
 = 
l
;

456 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

457 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

462 
PROP_OUT_OF_SERVICE
:

463 
us
 =

464 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_BOOLEAN
,

465 &
wp_da
->
r_ass
, &wp_da->
r_code
);

466 i(
us
) {

467 
	`By_Ouut_Out_Of_Svi_S
(
wp_da
->
obje_
,

468 
vue
.
ty
.
Boޗn
);

471 
PROP_POLARITY
:

472 
us
 =

473 
	`WPVideArgTy
(&
vue
, 
BACNET_APPLICATION_TAG_ENUMERATED
,

474 &
wp_da
->
r_ass
, &wp_da->
r_code
);

475 i(
us
) {

476 i(
vue
.
ty
.
Enumed
 < 
MAX_POLARITY
) {

477 
	`By_Ouut_Pެy_S
(
wp_da
->
obje_
,

478 (
BACNET_POLARITY

vue
.
ty
.
Enumed
);

480 
us
 = 
l
;

481 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

482 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

486 
PROP_OBJECT_IDENTIFIER
:

487 
PROP_OBJECT_NAME
:

488 
PROP_OBJECT_TYPE
:

489 
PROP_STATUS_FLAGS
:

490 
PROP_RELIABILITY
:

491 
PROP_EVENT_STATE
:

492 
PROP_PRIORITY_ARRAY
:

493 
PROP_RELINQUISH_DEFAULT
:

494 
PROP_ACTIVE_TEXT
:

495 
PROP_INACTIVE_TEXT
:

496 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

497 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

500 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

501 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

505 
n
 =en;

507  
us
;

508 
	}
}

510 
	$By_Ouut_In
(

513 
i
, 
j
;

516 
i
 = 0; i < 
MAX_BINARY_OUTPUTS
; i++) {

517 
	`By_Ouut_Pެy_S
(
i
, 
POLARITY_NORMAL
);

518 
	`By_Ouut_Out_Of_Svi_S
(
i
, 
l
);

519 
j
 = 0; j < 
BACNET_MAX_PRIORITY
; j++) {

520 
By_Ouut_Lev
[
i
][
j
] = 
BINARY_NULL
;

525 
	}
}

	@ports/stm32f10x/device.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<dlib.h
>

29 
	~<rg.h
>

30 
	~"bacdef.h
"

31 
	~"bacdcode.h
"

32 
	~"bacr.h
"

33 
	~"banum.h
"

34 
	~"du.h
"

35 
	~"dcc.h
"

36 
	~"dk.h
"

37 
	~"rs485.h
"

38 
	~"vsi.h
"

39 
	~"hdrs.h
"

41 
	~"devi.h
"

42 
	~"bo.h
"

45 
Devi_Rd_Prݔty_Lol
(

46 
BACNET_READ_PROPERTY_DATA
 * 
da
);

47 
bo
 
Devi_Wre_Prݔty_Lol
(

48 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
);

50 
	smy_obje_funis
 {

51 
BACNET_OBJECT_TYPE
 
	mObje_Ty
;

52 
obje__funi
 
	mObje_In
;

53 
obje_cou_funi
 
	mObje_Cou
;

54 
obje_dex_to__funi
 
	mObje_Index_To_In
;

55 
obje_vid__funi
 
	mObje_Vid_In
;

56 
obje_me_funi
 
	mObje_Name
;

57 
ad_ݔty_funi
 
	mObje_Rd_Prݔty
;

58 
wre_ݔty_funi
 
	mObje_Wre_Prݔty
;

59 
m_ݔty_lis_funi
 
	mObje_RPM_Li
;

60 } 
	gObje_Tab
[] = {

62 
OBJECT_DEVICE
, 
NULL
,

63 
Devi_Cou
, 
Devi_Index_To_In
,

64 
Devi_Vid_Obje_In_Numb
, 
Devi_Obje_Name
,

65 
Devi_Rd_Prݔty_Lol
, 
Devi_Wre_Prݔty_Lol
,

66 
Devi_Prݔty_Lis
}, {

67 
OBJECT_BINARY_OUTPUT
, 
By_Ouut_In
, 
By_Ouut_Cou
,

68 
By_Ouut_Index_To_In
, 
By_Ouut_Vid_In
,

69 
By_Ouut_Obje_Name
, 
By_Ouut_Rd_Prݔty
,

70 
By_Ouut_Wre_Prݔty
, 
By_Ouut_Prݔty_Lis
}, {

71 
MAX_BACNET_OBJECT_TYPE
, 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL}

78 
ut32_t
 
	gObje_In_Numb
 = 103;

79 
BACNET_DEVICE_STATUS
 
	gSyem_Stus
 = 
STATUS_OPERATIONAL
;

80 
BACNET_CHARACTER_STRING
 
	gMy_Obje_Name
;

81 
ut32_t
 
	gDaba_Revisi
;

82 
BACNET_REINITIALIZED_STATE
 
	gRelize_S
 = 
BACNET_REINIT_IDLE
;

83 cڡ *
	gRe_Passwd
 = "stm32-challenge";

86 cڡ 
	gDevi_Prݔts_Requed
[] = {

87 
PROP_OBJECT_IDENTIFIER
,

88 
PROP_OBJECT_NAME
,

89 
PROP_OBJECT_TYPE
,

90 
PROP_SYSTEM_STATUS
,

91 
PROP_VENDOR_NAME
,

92 
PROP_VENDOR_IDENTIFIER
,

93 
PROP_MODEL_NAME
,

94 
PROP_FIRMWARE_REVISION
,

95 
PROP_APPLICATION_SOFTWARE_VERSION
,

96 
PROP_PROTOCOL_VERSION
,

97 
PROP_PROTOCOL_REVISION
,

98 
PROP_PROTOCOL_SERVICES_SUPPORTED
,

99 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

100 
PROP_OBJECT_LIST
,

101 
PROP_MAX_APDU_LENGTH_ACCEPTED
,

102 
PROP_SEGMENTATION_SUPPORTED
,

103 
PROP_APDU_TIMEOUT
,

104 
PROP_NUMBER_OF_APDU_RETRIES
,

105 
PROP_DEVICE_ADDRESS_BINDING
,

106 
PROP_DATABASE_REVISION
,

110 cڡ 
	gDevi_Prݔts_Oiڮ
[] = {

111 
PROP_DESCRIPTION
,

112 
PROP_LOCATION
,

113 
PROP_MAX_MASTER
,

114 
PROP_MAX_INFO_FRAMES
,

118 cڡ 
	gDevi_Prݔts_Prrry
[] = {

123 
my_obje_funis
 *
	$Devi_Objes_Fd_Funis
(

124 
BACNET_OBJECT_TYPE
 
Obje_Ty
)

126 
my_obje_funis
 *
pObje
 = 
NULL
;

128 
pObje
 = &
Obje_Tab
[0];

129 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

131 i(
pObje
->
Obje_Ty
 == Object_Type) {

132  (
pObje
);

135 
pObje
++;

138  (
NULL
);

139 
	}
}

141 
	$Rd_Prݔty_Comm
(

142 
my_obje_funis
 *
pObje
,

143 
BACNET_READ_PROPERTY_DATA
 * 
da
)

145 
du_n
 = 
BACNET_STATUS_ERROR
;

146 
BACNET_CHARACTER_STRING
 
ch_rg
;

147 
ut8_t
 *
du
 = 
NULL
;

149 i((
da
->
iti_da
 =
NULL
) ||

150 (
da
->
iti_da_n
 == 0)) {

153 
du
 = 
da
->
iti_da
;

154 
da
->
obje_ݔty
) {

155 
PROP_OBJECT_IDENTIFIER
:

157 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

158 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

159 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

160 
du_n
 = 
BACNET_STATUS_ERROR
;

164 i(
da
->
obje_ty
 =
OBJECT_DEVICE
) {

165 
da
->
obje_
 = 
Obje_In_Numb
;

167 
du_n
 =

168 
	`code_iti_obje_id
(&
du
[0], 
da
->
obje_ty
,

169 
da
->
obje_
);

172 
PROP_OBJECT_NAME
:

174 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

175 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

176 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

177 
du_n
 = 
BACNET_STATUS_ERROR
;

179 
	`charg__si
(&
ch_rg
, "");

180 i(
pObje
->
Obje_Name
) {

181 (
pObje
->
	`Obje_Name
(
da
->
obje_
,

182 &
ch_rg
);

184 
du_n
 =

185 
	`code_iti_cha_rg
(&
du
[0],

186 &
ch_rg
);

189 
PROP_OBJECT_TYPE
:

191 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

192 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

193 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

194 
du_n
 = 
BACNET_STATUS_ERROR
;

196 
du_n
 =

197 
	`code_iti_umed
(&
du
[0],

198 
da
->
obje_ty
);

202 i(
pObje
->
Obje_Rd_Prݔty
) {

203 
du_n
 = 
pObje
->
	`Obje_Rd_Prݔty
(
da
);

208  
du_n
;

209 
	}
}

213 
	$Devi_Rd_Prݔty
(

214 
BACNET_READ_PROPERTY_DATA
 * 
da
)

216 
du_n
 = 
BACNET_STATUS_ERROR
;

217 
my_obje_funis
 *
pObje
 = 
NULL
;

220 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
da
->
obje_ty
);

221 i(
pObje
) {

222 i(
pObje
->
Obje_Vid_In
 &&

223 
pObje
->
	`Obje_Vid_In
(
da
->
obje_
)) {

224 
du_n
 = 
	`Rd_Prݔty_Comm
(
pObje
, 
da
);

226 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

227 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

230 
da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

231 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

234  
du_n
;

235 
	}
}

237 
bo
 
	$Devi_Wre_Prݔty
(

238 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

240 
bo
 
us
 = 
l
;

241 
my_obje_funis
 *
pObje
 = 
NULL
;

244 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
wp_da
->
obje_ty
);

245 i(
pObje
) {

246 i(
pObje
->
Obje_Vid_In
 &&

247 
pObje
->
	`Obje_Vid_In
(
wp_da
->
obje_
)) {

248 i(
pObje
->
Obje_Wre_Prݔty
) {

249 
us
 = 
pObje
->
	`Obje_Wre_Prݔty
(
wp_da
);

251 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

252 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

255 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

256 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

259 
wp_da
->
r_ass
 = 
ERROR_CLASS_OBJECT
;

260 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_OBJECT
;

263  
us
;

264 
	}
}

268 
	$Devi_Objes_Prݔty_Li
(

269 
BACNET_OBJECT_TYPE
 
obje_ty
,

270 
ecl_ݔty_li_t
 *
pPrݔtyLi
)

272 
my_obje_funis
 *
pObje
 = 
NULL
;

274 
pPrݔtyLi
->
Requed
.
pLi
 = 
NULL
;

275 
pPrݔtyLi
->
Oiڮ
.
pLi
 = 
NULL
;

276 
pPrݔtyLi
->
Prrry
.
pLi
 = 
NULL
;

283 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

284 i((
pObje
 !
NULL
&& (pObje->
Obje_RPM_Li
 != NULL)) {

285 
pObje
->
	`Obje_RPM_Li
(&
pPrݔtyLi
->
Requed
.
pLi
,

286 &
pPrݔtyLi
->
Oiڮ
.
pLi
, &pPrݔtyLi->
Prrry
.pList);

290 
pPrݔtyLi
->
Requed
.
cou
 =

291 
pPrݔtyLi
->
Requed
.
pLi
 ==

292 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Requed
.
pLi
);

294 
pPrݔtyLi
->
Oiڮ
.
cou
 =

295 
pPrݔtyLi
->
Oiڮ
.
pLi
 ==

296 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Oiڮ
.
pLi
);

298 
pPrݔtyLi
->
Prrry
.
cou
 =

299 
pPrݔtyLi
->
Prrry
.
pLi
 ==

300 
NULL
 ? 0 : 
	`ݔty_li_cou
(
pPrݔtyLi
->
Prrry
.
pLi
);

303 
	}
}

305 
	$Devi_Prݔty_Lis
(

306 cڡ **
pRequed
,

307 cڡ **
pOiڮ
,

308 cڡ **
pPrrry
)

310 i(
pRequed
)

311 *
pRequed
 = 
Devi_Prݔts_Requed
;

312 i(
pOiڮ
)

313 *
pOiڮ
 = 
Devi_Prݔts_Oiڮ
;

314 i(
pPrrry
)

315 *
pPrrry
 = 
Devi_Prݔts_Prrry
;

318 
	}
}

320 
	$Devi_Cou
(

324 
	}
}

326 
ut32_t
 
	$Devi_Index_To_In
(

327 
dex
)

329 ()
dex
;

330  
Obje_In_Numb
;

331 
	}
}

333 
bo
 
	$Devi_Obje_Name
(

334 
ut32_t
 
obje_
,

335 
BACNET_CHARACTER_STRING
 * 
obje_me
)

337 
bo
 
us
 = 
l
;

339 i(
obje_
 =
Obje_In_Numb
) {

340 
us
 = 
	`charg_cy
(
obje_me
, &
My_Obje_Name
);

343  
us
;

344 
	}
}

346 
bo
 
	$Devi_S_Obje_Name
(

347 
BACNET_CHARACTER_STRING
 * 
obje_me
)

349 
bo
 
us
 = 
l
;

351 i(!
	`charg_me
(&
My_Obje_Name
, 
obje_me
)) {

353 
us
 = 
	`charg_cy
(&
My_Obje_Name
, 
obje_me
);

354 
	`Devi_Inc_Daba_Revisi
();

357  
us
;

358 
	}
}

360 
bo
 
	$Devi_Relize
(

361 
BACNET_REINITIALIZE_DEVICE_DATA
 * 
rd_da
)

363 
bo
 
us
 = 
l
;

366 i(
	`charg_si_me
(&
rd_da
->
sswd
, 
Re_Passwd
)) {

367 
rd_da
->
e
) {

368 
BACNET_REINIT_COLDSTART
:

369 
BACNET_REINIT_WARMSTART
:

370 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

374 
Relize_S
 = 
rd_da
->
e
;

375 
us
 = 
ue
;

377 
BACNET_REINIT_STARTBACKUP
:

378 
BACNET_REINIT_ENDBACKUP
:

379 
BACNET_REINIT_STARTRESTORE
:

380 
BACNET_REINIT_ENDRESTORE
:

381 
BACNET_REINIT_ABORTRESTORE
:

382 i(
	`dcc_communiti_dibd
()) {

383 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

384 
rd_da
->
r_code
 = 
ERROR_CODE_COMMUNICATION_DISABLED
;

386 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

387 
rd_da
->
r_code
 =

388 
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
;

392 
rd_da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

393 
rd_da
->
r_code
 = 
ERROR_CODE_PARAMETER_OUT_OF_RANGE
;

397 
rd_da
->
r_ass
 = 
ERROR_CLASS_SECURITY
;

398 
rd_da
->
r_code
 = 
ERROR_CODE_PASSWORD_FAILURE
;

401  
us
;

402 
	}
}

404 
BACNET_REINITIALIZED_STATE
 
	$Devi_Relized_S
(

407  
Relize_S
;

408 
	}
}

410 
	$Devi_In
(

411 
obje_funis_t
 * 
obje_b
)

413 
my_obje_funis
 *
pObje
 = 
NULL
;

417 (
obje_b
;

419 
pObje
 = &
Obje_Tab
[0];

420 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

421 i(
pObje
->
Obje_In
) {

422 
pObje
->
	`Obje_In
();

424 
pObje
++;

426 
	`dcc_t_us_duti
(
COMMUNICATION_ENABLE
, 0);

427 i(
Obje_In_Numb
 >
BACNET_MAX_INSTANCE
) {

428 
Obje_In_Numb
 = 103;

429 
	`d
(
Obje_In_Numb
);

431 
	`charg__si
(&
My_Obje_Name
, "stm32-design-challenge-103");

432 
	}
}

435 
ut32_t
 
	$Devi_Obje_In_Numb
(

438  
Obje_In_Numb
;

439 
	}
}

441 
bo
 
	$Devi_S_Obje_In_Numb
(

442 
ut32_t
 
obje_id
)

444 
bo
 
us
 = 
ue
;

446 i(
obje_id
 <
BACNET_MAX_INSTANCE
) {

447 
Obje_In_Numb
 = 
obje_id
;

449 
us
 = 
l
;

451  
us
;

452 
	}
}

454 
bo
 
	$Devi_Vid_Obje_In_Numb
(

455 
ut32_t
 
obje_id
)

457  (
Obje_In_Numb
 =
obje_id
);

458 
	}
}

460 
BACNET_DEVICE_STATUS
 
	$Devi_Syem_Stus
(

463  
Syem_Stus
;

464 
	}
}

466 
	$Devi_S_Syem_Stus
(

467 
BACNET_DEVICE_STATUS
 
us
,

468 
bo
 
lol
)

471 
su
 = -1;

473 i(
us
 < 
MAX_DEVICE_STATUS
) {

474 
Syem_Stus
 = 
us
;

475 
su
 = 0;

478  
su
;

479 
	}
}

481 
ut16_t
 
	$Devi_Vd_Idtifr
(

484  
BACNET_VENDOR_ID
;

485 
	}
}

487 
BACNET_SEGMENTATION
 
	$Devi_Segmti_Su܋d
(

490  
SEGMENTATION_NONE
;

491 
	}
}

493 
ut32_t
 
	$Devi_Daba_Revisi
(

496  
Daba_Revisi
;

497 
	}
}

499 
	$Devi_Inc_Daba_Revisi
(

502 
Daba_Revisi
++;

503 
	}
}

507 
	$Devi_Obje_Li_Cou
(

510 
cou
 = 0;

511 
my_obje_funis
 *
pObje
 = 
NULL
;

514 
pObje
 = &
Obje_Tab
[0];

515 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

516 i(
pObje
->
Obje_Cou
) {

517 
cou
 +
pObje
->
	`Obje_Cou
();

519 
pObje
++;

522  
cou
;

523 
	}
}

525 
bo
 
	$Devi_Obje_Li_Idtifr
(

526 
ut32_t
 
y_dex
,

527 *
obje_ty
,

528 
ut32_t
 * 

)

530 
bo
 
us
 = 
l
;

531 
ut32_t
 
cou
 = 0;

532 
ut32_t
 
obje_dex
 = 0;

533 
my_obje_funis
 *
pObje
 = 
NULL
;

536 i(
y_dex
 == 0) {

537  
us
;

539 
obje_dex
 = 
y_dex
 - 1;

541 
pObje
 = &
Obje_Tab
[0];

542 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

543 i(
pObje
->
Obje_Cou
 &&Obje->
Obje_Index_To_In
) {

544 
obje_dex
 -
cou
;

545 
cou
 = 
pObje
->
	`Obje_Cou
();

546 i(
obje_dex
 < 
cou
) {

547 *
obje_ty
 = 
pObje
->
Obje_Ty
;

548 *

 = 
pObje
->
	`Obje_Index_To_In
(
obje_dex
);

549 
us
 = 
ue
;

553 
pObje
++;

556  
us
;

557 
	}
}

559 
bo
 
	$Devi_Vid_Obje_Name
(

560 
BACNET_CHARACTER_STRING
 * 
obje_me1
,

561 *
obje_ty
,

562 
ut32_t
 * 
obje_
)

564 
bo
 
found
 = 
l
;

565 
ty
 = 0;

566 
ut32_t
 

;

567 
ut32_t
 
max_objes
 = 0, 
i
 = 0;

568 
bo
 
check_id
 = 
l
;

569 
BACNET_CHARACTER_STRING
 
obje_me2
;

570 
my_obje_funis
 *
pObje
 = 
NULL
;

572 
max_objes
 = 
	`Devi_Obje_Li_Cou
();

573 
i
 = 1; i <
max_objes
; i++) {

574 
check_id
 = 
	`Devi_Obje_Li_Idtifr
(
i
, &
ty
, &

);

575 i(
check_id
) {

576 
pObje
 = 
	`Devi_Objes_Fd_Funis
((
BACNET_OBJECT_TYPE

ty
);

577 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL) &&

578 (
pObje
->
	`Obje_Name
(

, &
obje_me2
) &&

579 
	`charg_me
(
obje_me1
, &
obje_me2
))) {

580 
found
 = 
ue
;

581 i(
obje_ty
) {

582 *
obje_ty
 = 
ty
;

584 i(
obje_
) {

585 *
obje_
 = 

;

592  
found
;

593 
	}
}

595 
bo
 
	$Devi_Vid_Obje_Id
(

596 
obje_ty
,

597 
ut32_t
 
obje_
)

599 
bo
 
us
 = 
l
;

600 
my_obje_funis
 *
pObje
 = 
NULL
;

602 
pObje
 = 
	`Devi_Objes_Fd_Funis
((
BACNET_OBJECT_TYPE

obje_ty
);

603 i((
pObje
 !
NULL
&& (pObje->
Obje_Vid_In
 != NULL)) {

604 
us
 = 
pObje
->
	`Obje_Vid_In
(
obje_
);

607  
us
;

608 
	}
}

610 
bo
 
	$Devi_Obje_Name_Cy
(

611 
BACNET_OBJECT_TYPE
 
obje_ty
,

612 
ut32_t
 
obje_
,

613 
BACNET_CHARACTER_STRING
 * 
obje_me
)

615 
my_obje_funis
 *
pObje
 = 
NULL
;

616 
bo
 
found
 = 
l
;

618 
pObje
 = 
	`Devi_Objes_Fd_Funis
(
obje_ty
);

619 i((
pObje
 !
NULL
&& (pObje->
Obje_Name
 != NULL)) {

620 
found
 = 
pObje
->
	`Obje_Name
(
obje_
, 
obje_me
);

623  
found
;

624 
	}
}

627 
	$Devi_Rd_Prݔty_Lol
(

628 
BACNET_READ_PROPERTY_DATA
 * 
da
)

630 
du_n
 = 0;

631 
n
 = 0;

632 
BACNET_BIT_STRING
 
b_rg
;

633 
BACNET_CHARACTER_STRING
 
ch_rg
;

634 
ut32_t
 
i
 = 0;

635 
obje_ty
 = 0;

636 
ut32_t
 

 = 0;

637 
ut32_t
 
cou
 = 0;

638 
ut8_t
 *
du
 = 
NULL
;

639 
my_obje_funis
 *
pObje
 = 
NULL
;

641 i((
da
->
iti_da
 =
NULL
) ||

642 (
da
->
iti_da_n
 == 0)) {

645 
du
 = 
da
->
iti_da
;

646 ()
da
->
obje_ݔty
) {

647 
PROP_DESCRIPTION
:

648 
	`charg__si
(&
ch_rg
, "BACnet Development Kit");

649 
du_n
 =

650 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

652 
PROP_LOCATION
:

653 
	`charg__si
(&
ch_rg
, "USA");

654 
du_n
 =

655 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

657 
PROP_SYSTEM_STATUS
:

658 
du_n
 =

659 
	`code_iti_umed
(&
du
[0],

660 
	`Devi_Syem_Stus
());

662 
PROP_VENDOR_NAME
:

663 
	`charg__si
(&
ch_rg
, 
BACNET_VENDOR_NAME
);

664 
du_n
 =

665 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

667 
PROP_VENDOR_IDENTIFIER
:

668 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
BACNET_VENDOR_ID
);

670 
PROP_MODEL_NAME
:

671 
	`charg__si
(&
ch_rg
, "bdk-stm32-mstp");

672 
du_n
 =

673 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

675 
PROP_FIRMWARE_REVISION
:

676 
	`charg__si
(&
ch_rg
, 
BACt_Vsi
);

677 
du_n
 =

678 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

680 
PROP_APPLICATION_SOFTWARE_VERSION
:

681 
	`charg__si
(&
ch_rg
, "1.0");

682 
du_n
 =

683 
	`code_iti_cha_rg
(&
du
[0], &
ch_rg
);

685 
PROP_PROTOCOL_VERSION
:

686 
du_n
 =

687 
	`code_iti_unsigd
(&
du
[0], 
BACNET_PROTOCOL_VERSION
);

689 
PROP_PROTOCOL_REVISION
:

690 
du_n
 =

691 
	`code_iti_unsigd
(&
du
[0],

692 
BACNET_PROTOCOL_REVISION
);

694 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

696 
	`brg_
(&
b_rg
);

697 
i
 = 0; i < 
MAX_BACNET_SERVICES_SUPPORTED
; i++) {

699 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
,

700 
	`du_rvi_su܋d
((
BACNET_SERVICES_SUPPORTED

i
));

702 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

704 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

707 
	`brg_
(&
b_rg
);

708 
i
 = 0; i < 
MAX_ASHRAE_OBJECT_TYPE
; i++) {

710 
	`brg_t_b
(&
b_rg
, (
ut8_t

i
, 
l
);

713 
i
 = 0;

714 
pObje
 = &
Obje_Tab
[
i
];

715 
pObje
->
Obje_Ty
 < 
MAX_BACNET_OBJECT_TYPE
) {

716 i((
pObje
->
Obje_Cou
&& (pObje->
	`Obje_Cou
() > 0)) {

717 
	`brg_t_b
(&
b_rg
, 
pObje
->
Obje_Ty
, 
ue
);

719 
pObje
++;

721 
du_n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

723 
PROP_OBJECT_LIST
:

724 
cou
 = 
	`Devi_Obje_Li_Cou
();

726 i(
da
->
y_dex
 == 0)

727 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
cou
);

732 i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

733 
i
 = 1; i <
cou
; i++) {

734 i(
	`Devi_Obje_Li_Idtifr
(
i
, &
obje_ty
,

735 &

)) {

736 
n
 =

737 
	`code_iti_obje_id
(&
du
[
du_n
],

738 
obje_ty
, 

);

739 
du_n
 +
n
;

742 i((
du_n
 + 
n
>
MAX_APDU
) {

744 
da
->
r_code
 =

745 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

746 
du_n
 = 
BACNET_STATUS_ABORT
;

751 
da
->
r_ass
 = 
ERROR_CLASS_SERVICES
;

752 
da
->
r_code
 = 
ERROR_CODE_OTHER
;

753 
du_n
 = 
BACNET_STATUS_ERROR
;

758 i(
	`Devi_Obje_Li_Idtifr
(
da
->
y_dex
,

759 &
obje_ty
, &

))

760 
du_n
 =

761 
	`code_iti_obje_id
(&
du
[0], 
obje_ty
,

762 

);

764 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

765 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

766 
du_n
 = 
BACNET_STATUS_ERROR
;

770 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

771 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
MAX_APDU
);

773 
PROP_SEGMENTATION_SUPPORTED
:

774 
du_n
 =

775 
	`code_iti_umed
(&
du
[0],

776 
	`Devi_Segmti_Su܋d
());

778 
PROP_APDU_TIMEOUT
:

779 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_timeout
());

781 
PROP_NUMBER_OF_APDU_RETRIES
:

782 
du_n
 = 
	`code_iti_unsigd
(&
du
[0], 
	`du_s
());

784 
PROP_DEVICE_ADDRESS_BINDING
:

787 
PROP_DATABASE_REVISION
:

788 
du_n
 =

789 
	`code_iti_unsigd
(&
du
[0],

790 
	`Devi_Daba_Revisi
());

792 
PROP_MAX_INFO_FRAMES
:

793 
du_n
 =

794 
	`code_iti_unsigd
(&
du
[0],

795 
	`dlmp_max_fo_ames
());

797 
PROP_MAX_MASTER
:

798 
du_n
 =

799 
	`code_iti_unsigd
(&
du
[0], 
	`dlmp_max_ma
());

802 
du_n
 =

803 
	`code_iti_unsigd
(&
du
[0], 
	`rs485_baud_
());

806 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

807 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

808 
du_n
 = 
BACNET_STATUS_ERROR
;

812 i((
du_n
 >0&& (
da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

813 (
da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

814 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

815 
da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

816 
du_n
 = 
BACNET_STATUS_ERROR
;

819  
du_n
;

820 
	}
}

822 
bo
 
	$Devi_Wre_Prݔty_Lol
(

823 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

825 
bo
 
us
 = 
l
;

826 
n
 = 0;

827 
ut8_t
 
codg
 = 0;

828 
size_t
 
ngth
 = 0;

829 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

832 
n
 =

833 
	`ba_decode_iti_da
(
wp_da
->
iti_da
,

834 
wp_da
->
iti_da_n
, &
vue
);

836 i(
n
 < 0) {

838 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

839 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

840  
l
;

842 i((
wp_da
->
obje_ݔty
 !
PROP_OBJECT_LIST
) &&

843 (
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)) {

845 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

846 
wp_da
->
r_code
 = 
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
;

847  
l
;

849 ()
wp_da
->
obje_ݔty
) {

850 
PROP_OBJECT_IDENTIFIER
:

851 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_OBJECT_ID
) {

852 i((
vue
.
ty
.
Obje_Id
.ty =
OBJECT_DEVICE
) &&

853 (
	`Devi_S_Obje_In_Numb
(
vue
.
ty
.

854 
Obje_Id
.

))) {

856 
us
 = 
ue
;

858 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

859 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

862 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

863 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

866 
PROP_MAX_INFO_FRAMES
:

867 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

868 i(
vue
.
ty
.
Unsigd_I
 <= 255) {

869 
	`dlmp_t_max_fo_ames
(
vue
.
ty
.
Unsigd_I
);

870 
us
 = 
ue
;

872 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

873 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

876 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

877 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

880 
PROP_MAX_MASTER
:

881 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

882 i((
vue
.
ty
.
Unsigd_I
 > 0) &&

883 (
vue
.
ty
.
Unsigd_I
 <= 127)) {

884 
	`dlmp_t_max_ma
(
vue
.
ty
.
Unsigd_I
);

885 
us
 = 
ue
;

887 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

888 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

891 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

892 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

895 
PROP_OBJECT_NAME
:

896 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

897 
ngth
 = 
	`charg_ngth
(&
vue
.
ty
.
Cha_Sg
);

898 i(
ngth
 < 1) {

899 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

900 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

901 } i(
ngth
 < 
	`charg_cy
(&
My_Obje_Name
)) {

902 
codg
 =

903 
	`charg_codg
(&
vue
.
ty
.
Cha_Sg
);

904 i(
codg
 < 
MAX_CHARACTER_STRING_ENCODING
) {

906 i(
	`Devi_Vid_Obje_Name
(&
vue
.
ty
.

907 
Cha_Sg
, 
NULL
, NULL)) {

908 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

909 
wp_da
->
r_code
 = 
ERROR_CODE_DUPLICATE_NAME
;

911 
	`Devi_S_Obje_Name
(&
vue
.
ty
.

912 
Cha_Sg
);

913 
us
 = 
ue
;

916 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

917 
wp_da
->
r_code
 =

918 
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
;

921 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

922 
wp_da
->
r_code
 =

923 
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
;

926 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

927 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

931 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

932 i((
vue
.
ty
.
Unsigd_I
 <= 115200) &&

933 (
	`rs485_baud__t
(
vue
.
ty
.
Unsigd_I
))) {

934 
us
 = 
ue
;

936 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

937 
wp_da
->
r_code
 = 
ERROR_CODE_VALUE_OUT_OF_RANGE
;

940 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

941 
wp_da
->
r_code
 = 
ERROR_CODE_INVALID_DATA_TYPE
;

944 
PROP_OBJECT_TYPE
:

945 
PROP_VENDOR_NAME
:

946 
PROP_VENDOR_IDENTIFIER
:

947 
PROP_MODEL_NAME
:

948 
PROP_FIRMWARE_REVISION
:

949 
PROP_APPLICATION_SOFTWARE_VERSION
:

950 
PROP_PROTOCOL_VERSION
:

951 
PROP_PROTOCOL_REVISION
:

952 
PROP_PROTOCOL_SERVICES_SUPPORTED
:

953 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
:

954 
PROP_OBJECT_LIST
:

955 
PROP_MAX_APDU_LENGTH_ACCEPTED
:

956 
PROP_SEGMENTATION_SUPPORTED
:

957 
PROP_DEVICE_ADDRESS_BINDING
:

958 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

959 
PROP_DATABASE_REVISION
:

960 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

961 
wp_da
->
r_code
 = 
ERROR_CODE_WRITE_ACCESS_DENIED
;

964 
wp_da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

965 
wp_da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

969 ()
n
;

971  
us
;

972 
	}
}

	@ports/stm32f10x/dlmstp.c

35 
	~<dbo.h
>

36 
	~<dt.h
>

37 
	~<ddef.h
>

38 
	~<rg.h
>

39 
	~"bacdef.h
"

40 
	~"dlmp.h
"

41 
	~"rs485.h
"

42 
	~"c.h
"

43 
	~"du.h
"

44 
	~"bs.h
"

45 
	~"baddr.h
"

46 
	~"tim.h
"

47 
	~"rgbuf.h
"

48 
	~"mpdef.h
"

49 
	~"automac.h
"

50 
	~"devi.h
"

58 
MSTP_RECEIVE_STATE
 
	gReive_S
;

61 
MSTP_MASTER_STATE
 
	gMa_S
;

63 
	smp_ag_t
 {

67 
	mReivedInvidFme
:1;

71 
	mReivedVidFme
:1;

73 
	mReivedVidFmeNFUs
:1;

76 
	mSeMa
:1;

79 
	mReivePackPdg
:1;

80 } 
	gMSTP_Fg
;

83 
ut32_t
 
	gDaLgth
;

85 
ut8_t
 
	gDeiAddss
;

89 
ut8_t
 
	gEvtCou
;

91 
ut8_t
 
	gFmeTy
;

98 
ut8_t
 *
	gIutBufr
;

99 
ut16_t
 
	gIutBufrSize
;

101 
ut8_t
 
	gSourAddss
;

105 
ut8_t
 
	gThis_Sti
 = 255;

111 
ut8_t
 
	gNmax_ma
 = 127;

115 
	#Tno_tok
 500

	)

121 
	#Ty_timeout
 260

	)

127 
	#Tuge_timeout
 60

	)

131 
	#Nm_os
 4

	)

141 
	#Tame_abt
 30

	)

146 
	#Ty_day
 (250-50)

	)

150 
	#T
 10

	)

155 
	#Tuge_day
 15

	)

158 
	#INCREMENT_AND_LIMIT_UINT8
(
x
{i(x < 0xFFx++;}

	)

161 
	smp_tx_ck
 {

162 
ut16_t
 
	mngth
;

163 
ut16_t
 
	mdex
;

164 
ut8_t
 
	mbufr
[
MAX_MPDU
];

167 #ide
MSTP_TRANSMIT_PACKET_COUNT


168 
	#MSTP_TRANSMIT_PACKET_COUNT
 1

	)

170 
mp_tx_ck
 
	gTnsm_Bufr
[
MSTP_TRANSMIT_PACKET_COUNT
];

171 
RING_BUFFER
 
	gTnsm_Queue
;

174 
	smp_pdu_ck
 {

175 
bo
 
	mda_exg_y
;

176 
ut8_t
 
	mdei_mac
;

177 
ut16_t
 
	mngth
;

178 
ut8_t
 
	mbufr
[
MAX_MPDU
];

181 #ide
MSTP_PDU_PACKET_COUNT


182 
	#MSTP_PDU_PACKET_COUNT
 2

	)

184 
mp_pdu_ck
 
	gPDU_Bufr
[
MSTP_PDU_PACKET_COUNT
];

185 
RING_BUFFER
 
	gPDU_Queue
;

193 
ut8_t
 
	gNmax_fo_ames
 = 
MSTP_PDU_PACKET_COUNT
;

195 
dlmp_automac_hd
(

198 
bo
 
	$dlmp_
(

199 *
iame
)

201 ()
iame
;

202 
	`Rgbuf_In
(&
Tnsm_Queue
, (
ut8_t
 *
Tnsm_Bufr
,

203 (
mp_tx_ck
), 
MSTP_TRANSMIT_PACKET_COUNT
);

204 
	`Rgbuf_In
(&
PDU_Queue
, (
ut8_t
 *& 
PDU_Bufr
,

205 (
mp_pdu_ck
), 
MSTP_PDU_PACKET_COUNT
);

206 
	`rs485_
();

207 
	`automac_
();

209  
ue
;

210 
	}
}

212 
	$dlmp_nup
(

216 
	}
}

218 
	$dlmp_fl_ba_addss
(

219 
BACNET_ADDRESS
 * 
c
,

220 
ut8_t
 
mp_addss
)

222 
i
 = 0;

224 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

226 
c
->
mac_n
 = 0;

227 
c
->
mac
[0] = 0;

229 
c
->
mac_n
 = 1;

230 
c
->
mac
[0] = 
mp_addss
;

233 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

234 
c
->
mac
[
i
] = 0;

236 
c
->
t
 = 0;

237 
c
->
n
 = 0;

238 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

239 
c
->
adr
[
i
] = 0;

241 
	}
}

243 
bo
 
	$dlmp_com_da_exg_y
(

244 
ut8_t
 * 
que_pdu
,

245 
ut16_t
 
que_pdu_n
,

246 
ut8_t
 
c_addss
,

247 
ut8_t
 * 
y_pdu
,

248 
ut16_t
 
y_pdu_n
,

249 
ut8_t
 
de_addss
)

251 
ut16_t
 
offt
;

255 
	sDER_com_t
 {

256 
BACNET_NPDU_DATA
 
du_da
;

257 
BACNET_ADDRESS
 
addss
;

258 
ut8_t
 
pdu_ty
;

259 
ut8_t
 
voke_id
;

260 
ut8_t
 
rvi_choi
;

262 
DER_com_t
 
que
;

263 
DER_com_t
 
y
;

266 
que
.
addss
.
mac
[0] = 
c_addss
;

267 
que
.
addss
.
mac_n
 = 1;

268 
offt
 =

269 
	`du_decode
(&
que_pdu
[0], 
NULL
, &
que
.
addss
,

270 &
que
.
du_da
);

271 i(
que
.
du_da
.
twk_y_mesge
) {

272  
l
;

274 
que
.
pdu_ty
 = 
que_pdu
[
offt
] & 0xF0;

275 i(
que
.
pdu_ty
 !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
) {

276  
l
;

278 
que
.
voke_id
 = 
que_pdu
[
offt
 + 2];

280 i(
que_pdu
[
offt
] & 
BIT3
)

281 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 5];

283 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 3];

285 
y
.
addss
.
mac
[0] = 
de_addss
;

286 
y
.
addss
.
mac_n
 = 1;

287 
offt
 =

288 
	`du_decode
(&
y_pdu
[0], &
y
.
addss
, 
NULL
, &y.
du_da
);

289 i(
y
.
du_da
.
twk_y_mesge
) {

290  
l
;

294 
y
.
pdu_ty
 = 
y_pdu
[
offt
] & 0xF0;

295 
y
.
pdu_ty
) {

296 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

297 
y
.
voke_id
 = 
y_pdu
[
offt
 + 2];

299 i(
y_pdu
[
offt
] & 
BIT3
)

300 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 5];

302 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 3];

304 
PDU_TYPE_SIMPLE_ACK
:

305 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

306 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

308 
PDU_TYPE_COMPLEX_ACK
:

309 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

311 i(
y_pdu
[
offt
] & 
BIT3
)

312 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 4];

314 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

316 
PDU_TYPE_ERROR
:

317 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

318 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

320 
PDU_TYPE_REJECT
:

321 
PDU_TYPE_ABORT
:

322 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

325  
l
;

327 i(
que
.
voke_id
 !
y
.invoke_id) {

328  
l
;

331 i((
y
.
pdu_ty
 !
PDU_TYPE_REJECT
) &&

332 (
y
.
pdu_ty
 !
PDU_TYPE_ABORT
)) {

333 i(
que
.
rvi_choi
 !
y
.service_choice) {

334  
l
;

337 i(
que
.
du_da
.
oc_vsi
 !
y
.npdu_data.protocol_version) {

338  
l
;

343 i(
que
.
du_da
.
iܙy
 !
y
.npdu_data.priority) {

344  
l
;

347 i(!
	`ba_addss_me
(&
que
.
addss
, &
y
.address)) {

348  
l
;

351  
ue
;

352 
	}
}

355 
	mMSTP_TX_STATE_IDLE
,

356 
	mMSTP_TX_STATE_SILENCE_WAIT
,

357 
	mMSTP_TX_STATE_SEND_WAIT
,

358 
	mMSTP_TX_STATE_STOP


359 } 
	tMSTP_TX_STATE
;

360 
bo
 
	$MSTP_Tnsm_FSM
(

363 
MSTP_TX_STATE
 
e
 = 
MSTP_TX_STATE_IDLE
;

364 
mp_tx_ck
 *
pkt
;

366 
MSTP_TX_START
:

367 
e
) {

368 
MSTP_TX_STATE_IDLE
:

369 i(!
	`Rgbuf_Emy
(&
Tnsm_Queue
)) {

371 
pkt
 = (
mp_tx_ck
 *)

372 
	`Rgbuf_Pk
(&
Tnsm_Queue
);

373 
e
 = 
MSTP_TX_STATE_SILENCE_WAIT
;

376 
MSTP_TX_STATE_SILENCE_WAIT
:

377 i(
	`rs485_tuound_d
()) {

378 
	`rs485_s_ab
(
ue
);

379 
pkt
->
dex
 = 0;

380 
	`rs485_by_nd
(
pkt
->
bufr
[pkt->
dex
]);

381 
e
 = 
MSTP_TX_STATE_SEND_WAIT
;

383 
MSTP_TX_START
;

386 
MSTP_TX_STATE_SEND_WAIT
:

387 i(
	`rs485_by_
()) {

388 
pkt
->
dex
++;

389 i(
pkt
->
dex
 <kt->
ngth
) {

391 
	`rs485_by_nd
(
pkt
->
bufr
[pkt->
dex
]);

393 
MSTP_TX_START
;

395 
e
 = 
MSTP_TX_STATE_STOP
;

399 
MSTP_TX_STATE_STOP
:

400 i(
	`rs485_by_
(&& 
	`rs485_ame_
()) {

401 
	`rs485_s_ab
(
l
);

403 (
	`Rgbuf_P
(&
Tnsm_Queue
, 
NULL
);

404 
e
 = 
MSTP_TX_STATE_IDLE
;

408 
e
 = 
MSTP_TX_STATE_IDLE
;

412  (
e
 !
MSTP_TX_STATE_IDLE
);

413 
	}
}

428 
	$MSTP_Sd_Fme
(

429 
ut8_t
 
ame_ty
,

430 
ut8_t
 
dei
,

431 
ut8_t
 
sour
,

432 
ut8_t
 * 
da
,

433 
ut16_t
 
da_n
)

435 
ut8_t
 
c8
 = 0xFF;

436 
ut16_t
 
c16
 = 0xFFFF;

437 
mp_tx_ck
 *
pkt
;

438 
ut16_t
 
i
 = 0;

440 
pkt
 = (
mp_tx_ck
 *
	`Rgbuf_Da_Pk
(&
Tnsm_Queue
);

441 i(
pkt
) {

443 
pkt
->
bufr
[0] = 0x55;

444 
pkt
->
bufr
[1] = 0xFF;

445 
pkt
->
bufr
[2] = 
ame_ty
;

446 
c8
 = 
	`CRC_Cc_Hd
(
pkt
->
bufr
[2], crc8);

447 
pkt
->
bufr
[3] = 
dei
;

448 
c8
 = 
	`CRC_Cc_Hd
(
pkt
->
bufr
[3], crc8);

449 
pkt
->
bufr
[4] = 
sour
;

450 
c8
 = 
	`CRC_Cc_Hd
(
pkt
->
bufr
[4], crc8);

451 
pkt
->
bufr
[5] = 
da_n
 / 256;

452 
c8
 = 
	`CRC_Cc_Hd
(
pkt
->
bufr
[5], crc8);

453 
pkt
->
bufr
[6] = 
da_n
 % 256;

454 
c8
 = 
	`CRC_Cc_Hd
(
pkt
->
bufr
[6], crc8);

455 
pkt
->
bufr
[7] = (
ut8_t
)(~
c8
);

456 
pkt
->
ngth
 = 8;

457 i(
da_n
) {

459 
i
 = 0; i < 
da_n
; i++) {

460 
c16
 = 
	`CRC_Cc_Da
(
da
[
i
], crc16);

461 
pkt
->
bufr
[8 + 
i
] = 
da
[i];

463 
c16
 = ~crc16;

464 
pkt
->
bufr
[8 + 
da_n
] = (
c16
 & 0x00FF);

465 
pkt
->
bufr
[8 + 
da_n
 + 1] = ((
c16
 & 0xFF00) >> 8);

466 
pkt
->
ngth
 +
da_n
;

467 
pkt
->
ngth
 += 2;

469 
	`Rgbuf_Da_Put
(&
Tnsm_Queue
, (
ut8_t
 *)
pkt
);

471 
pkt
 = 
NULL
;

473 
	}
}

475 
	$MSTP_Reive_Fme_FSM
(

479 
ut8_t
 
DaRegi
 = 0;

481 
ut16_t
 
DaCRC
 = 0;

483 
ut8_t
 
HdCRC
 = 0;

486 
ut16_t
 
Index
 = 0;

488 
Reive_S
) {

489 
MSTP_RECEIVE_STATE_IDLE
:

492 i(
	`rs485_ive_r
()) {

494 
	`rs485_s_t
();

495 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

496 } i(
	`rs485_by_avaab
(&
DaRegi
)) {

497 
	`rs485_s_t
();

498 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

499 i(
DaRegi
 == 0x55) {

502 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

506 
MSTP_RECEIVE_STATE_PREAMBLE
:

509 i(
	`rs485_s_d
(
Tame_abt
)) {

513 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

514 } i(
	`rs485_ive_r
()) {

516 
	`rs485_s_t
();

517 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

519 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

520 } i(
	`rs485_by_avaab
(&
DaRegi
)) {

521 
	`rs485_s_t
();

522 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

523 i(
DaRegi
 == 0xFF) {

525 
Index
 = 0;

526 
HdCRC
 = 0xFF;

528 
Reive_S
 = 
MSTP_RECEIVE_STATE_HEADER
;

529 } i(
DaRegi
 == 0x55) {

532 
Reive_S
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

536 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

540 
MSTP_RECEIVE_STATE_HEADER
:

543 i(
	`rs485_s_d
(
Tame_abt
)) {

547 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

549 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

550 } i(
	`rs485_ive_r
()) {

552 
	`rs485_s_t
();

553 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

556 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

558 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

559 } i(
	`rs485_by_avaab
(&
DaRegi
)) {

560 
	`rs485_s_t
();

561 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

562 i(
Index
 == 0) {

564 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

565 
FmeTy
 = 
DaRegi
;

566 
Index
 = 1;

567 } i(
Index
 == 1) {

569 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

570 
DeiAddss
 = 
DaRegi
;

571 
Index
 = 2;

572 } i(
Index
 == 2) {

574 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

575 
SourAddss
 = 
DaRegi
;

576 
Index
 = 3;

577 } i(
Index
 == 3) {

579 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

580 
DaLgth
 = 
DaRegi
 * 256;

581 
Index
 = 4;

582 } i(
Index
 == 4) {

584 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

585 
DaLgth
 +
DaRegi
;

586 
Index
 = 5;

587 } i(
Index
 == 5) {

589 
HdCRC
 = 
	`CRC_Cc_Hd
(
DaRegi
, HeaderCRC);

592 i(
HdCRC
 != 0x55) {

596 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

598 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

600 i(
DaLgth
 == 0) {

602 i((
DeiAddss
 =
This_Sti
) ||

603 (
DeiAddss
 ==

604 
MSTP_BROADCAST_ADDRESS
)) {

608 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

611 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
ue
;

614 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

617 i((
DeiAddss
 =
This_Sti
) ||

618 (
DeiAddss
 ==

619 
MSTP_BROADCAST_ADDRESS
)) {

620 i(
DaLgth
 <
IutBufrSize
) {

622 
Reive_S
 = 
MSTP_RECEIVE_STATE_DATA
;

625 
Reive_S
 =

626 
MSTP_RECEIVE_STATE_SKIP_DATA
;

630 
Reive_S
 = 
MSTP_RECEIVE_STATE_SKIP_DATA
;

632 
Index
 = 0;

633 
DaCRC
 = 0xFFFF;

639 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

641 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

645 
MSTP_RECEIVE_STATE_DATA
:

646 
MSTP_RECEIVE_STATE_SKIP_DATA
:

649 i(
	`rs485_s_d
(
Tame_abt
)) {

653 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

655 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

656 } i(
	`rs485_ive_r
()) {

658 
	`rs485_s_t
();

659 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

662 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

664 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

665 } i(
	`rs485_by_avaab
(&
DaRegi
)) {

666 
	`rs485_s_t
();

667 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

668 i(
Index
 < 
DaLgth
) {

670 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

671 i(
Index
 < 
IutBufrSize
) {

672 
IutBufr
[
Index
] = 
DaRegi
;

674 
Index
++;

675 } i(
Index
 =
DaLgth
) {

677 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

678 
Index
++;

679 } i(
Index
 =(
DaLgth
 + 1)) {

681 
DaCRC
 = 
	`CRC_Cc_Da
(
DaRegi
, DataCRC);

684 i(
DaCRC
 == 0xF0B8) {

685 i(
Reive_S
 =
MSTP_RECEIVE_STATE_DATA
) {

687 
MSTP_Fg
.
ReivedVidFme
 = 
ue
;

690 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
ue
;

693 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

695 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

697 
MSTP_Fg
.
ReivedInvidFme
 = 
ue
;

698 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

704 
Reive_S
 = 
MSTP_RECEIVE_STATE_IDLE
;

709 
	}
}

712 
bo
 
	$MSTP_Ma_Node_FSM
(

718 
ut8_t
 
FmeCou
;

722 
ut8_t
 
Next_Sti
;

725 
ut8_t
 
Pl_Sti
;

728 
RryCou
;

733 
TokCou
;

735 
ut8_t
 
xt_pl_i
 = 0;

736 
ut8_t
 
xt_this_i
 = 0;

737 
ut8_t
 
xt_xt_i
 = 0;

739 
ut16_t
 
my_timeout
 = 10, 
ns_timeout
 = 0;

740 
bo
 
mched
 = 
l
;

742 
bo
 
si_now
 = 
l
;

744 
mp_pdu_ck
 *
pkt
;

747 i(
This_Sti
 == 255) {

748 
Ma_S
 = 
MSTP_MASTER_STATE_INITIALIZE
;

751 
xt_pl_i
 = (
Pl_Sti
 + 1% (
Nmax_ma
 + 1);

752 
xt_this_i
 = (
This_Sti
 + 1% (
Nmax_ma
 + 1);

753 
xt_xt_i
 = (
Next_Sti
 + 1% (
Nmax_ma
 + 1);

754 
Ma_S
) {

755 
MSTP_MASTER_STATE_INITIALIZE
:

756 i(
This_Sti
 == 255) {

757 
	`dlmp_automac_hd
();

758 i(
This_Sti
 != 255) {

759 
Next_Sti
 = 
	`automac_xt_i
(
This_Sti
);

760 i(
Next_Sti
 == 255) {

762 
Next_Sti
 = 
This_Sti
;

763 
Pl_Sti
 = 
This_Sti
;

764 
TokCou
 = 
Npl
;

765 
EvtCou
 = 0;

766 
MSTP_Fg
.
SeMa
 = 
ue
;

767 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

769 
Pl_Sti
 = 
This_Sti
;

770 
TokCou
 = 1;

771 
EvtCou
 = 0;

772 
RryCou
 = 0;

773 
MSTP_Fg
.
SeMa
 = 
l
;

774 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

780 
Next_Sti
 = 
This_Sti
;

781 
Pl_Sti
 = 
This_Sti
;

784 
TokCou
 = 
Npl
;

785 
MSTP_Fg
.
SeMa
 = 
l
;

786 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

787 
si_now
 = 
ue
;

790 
MSTP_MASTER_STATE_IDLE
:

792 i(
	`rs485_s_d
(
Tno_tok
)) {

795 
EvtCou
 = 0;

798 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

799 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

800 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

801 
Ma_S
 = 
MSTP_MASTER_STATE_NO_TOKEN
;

802 
si_now
 = 
ue
;

803 } i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

806 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

808 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

809 
FmeTy
) {

810 
FRAME_TYPE_TOKEN
:

813 i(
DeiAddss
 =
MSTP_BROADCAST_ADDRESS
)

815 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

816 
FmeCou
 = 0;

817 
MSTP_Fg
.
SeMa
 = 
l
;

818 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

819 
si_now
 = 
ue
;

821 
FRAME_TYPE_POLL_FOR_MASTER
:

824 i(
DeiAddss
 =
This_Sti
) {

825 
	`MSTP_Sd_Fme
(
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

826 
SourAddss
, 
This_Sti
, 
NULL
, 0);

829 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

831 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

833 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

835 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

837 i(
DeiAddss
 !
MSTP_BROADCAST_ADDRESS
) {

838 
Ma_S
 =

839 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
;

842 
FRAME_TYPE_TEST_REQUEST
:

843 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TEST_RESPONSE
,

844 
SourAddss
, 
This_Sti
, &
IutBufr
[0],

845 
DaLgth
);

847 
FRAME_TYPE_TEST_RESPONSE
:

853 i(
Ma_S
 !
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
) {

854 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

861 
MSTP_MASTER_STATE_USE_TOKEN
:

863 i(
	`Rgbuf_Emy
(&
PDU_Queue
)) {

865 
FmeCou
 = 
Nmax_fo_ames
;

866 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

867 
si_now
 = 
ue
;

869 
ut8_t
 
ame_ty
;

870 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
PDU_Queue
);

871 i(
pkt
->
da_exg_y
) {

872 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

874 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

876 
	`MSTP_Sd_Fme
(
ame_ty
, 
pkt
->
dei_mac
, 
This_Sti
,

877 (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

878 
FmeCou
++;

879 
ame_ty
) {

880 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

882 i(
pkt
->
dei_mac
 =
MSTP_BROADCAST_ADDRESS
)

883 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

885 
Ma_S
 = 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

887 
FRAME_TYPE_TEST_REQUEST
:

888 
Ma_S
 = 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

890 
FRAME_TYPE_TEST_RESPONSE
:

891 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

894 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

897 (
	`Rgbuf_P
(&
PDU_Queue
, 
NULL
);

900 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

903 i(
	`rs485_s_d
(
Ty_timeout
)) {

906 
FmeCou
 = 
Nmax_fo_ames
;

907 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

914 
si_now
 = 
ue
;

916 i(
MSTP_Fg
.
ReivedInvidFme
 =
ue
) {

919 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

920 
Ma_S
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

921 
si_now
 = 
ue
;

922 } i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

923 i(
DeiAddss
 =
This_Sti
) {

925 
FmeTy
) {

926 
FRAME_TYPE_REPLY_POSTPONED
:

928 
Ma_S
 =

929 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

931 
FRAME_TYPE_TEST_RESPONSE
:

932 
Ma_S
 =

933 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

935 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

941 
MSTP_Fg
.
ReivePackPdg
 = 
ue
;

942 
Ma_S
 =

943 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

948 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

959 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

961 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

962 
si_now
 = 
ue
;

968 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
:

970 i(
FmeCou
 < 
Nmax_fo_ames
) {

973 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

974 
si_now
 = 
ue
;

975 } i((
MSTP_Fg
.
SeMa
 =
l
) &&

976 (
Next_Sti
 =
This_Sti
)) {

980 
Pl_Sti
 = 
xt_this_i
;

981 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

982 
This_Sti
, 
NULL
, 0);

983 
RryCou
 = 0;

984 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

987 i(
TokCou
 < (
Npl
 - 1)) {

988 i((
MSTP_Fg
.
SeMa
 =
ue
) &&

989 (
Next_Sti
 !
xt_this_i
)) {

994 
FmeCou
 = 0;

995 
TokCou
++;

996 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

997 
si_now
 = 
ue
;

1007 
TokCou
++;

1009 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1010 
This_Sti
, 
NULL
, 0);

1011 
RryCou
 = 0;

1012 
EvtCou
 = 0;

1013 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1015 } i(
xt_pl_i
 =
Next_Sti
) {

1016 i(
MSTP_Fg
.
SeMa
 =
ue
) {

1018 
Pl_Sti
 = 
xt_xt_i
;

1019 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

1020 
This_Sti
, 
NULL
, 0);

1022 
Next_Sti
 = 
This_Sti
;

1023 
RryCou
 = 0;

1024 
TokCou
 = 1;

1027 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1030 
Pl_Sti
 = 
This_Sti
;

1032 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1033 
This_Sti
, 
NULL
, 0);

1034 
RryCou
 = 0;

1035 
TokCou
 = 1;

1036 
EvtCou
 = 0;

1037 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1041 
Pl_Sti
 = 
xt_pl_i
;

1042 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

1043 
This_Sti
, 
NULL
, 0);

1044 
RryCou
 = 0;

1045 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1050 
MSTP_MASTER_STATE_PASS_TOKEN
:

1051 i(
	`rs485_s_d
(
Tuge_timeout
)) {

1052 i(
RryCou
 < 
Ny_tok
) {

1054 
RryCou
++;

1056 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1057 
This_Sti
, 
NULL
, 0);

1058 
EvtCou
 = 0;

1065 
Pl_Sti
 = 
xt_xt_i
;

1067 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

1068 
This_Sti
, 
NULL
, 0);

1070 
Next_Sti
 = 
This_Sti
;

1071 
RryCou
 = 0;

1072 
TokCou
 = 0;

1075 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1078 i(
EvtCou
 > 
Nm_os
) {

1083 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1084 
si_now
 = 
ue
;

1093 
MSTP_MASTER_STATE_NO_TOKEN
:

1094 
my_timeout
 = 
Tno_tok
 + (
T
 * 
This_Sti
);

1095 i(
	`rs485_s_d
(
my_timeout
)) {

1096 
ns_timeout
 = 
Tno_tok
 + (
T
 * (
This_Sti
 + 1));

1097 i(
	`rs485_s_d
(
ns_timeout
)) {

1099 
	`rs485_s_t
();

1100 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1105 
Pl_Sti
 = 
xt_this_i
;

1107 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
, 
Pl_Sti
,

1108 
This_Sti
, 
NULL
, 0);

1110 
Next_Sti
 = 
This_Sti
;

1111 
RryCou
 = 0;

1112 
TokCou
 = 0;

1116 
Ma_S
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

1119 i(
EvtCou
 > 
Nm_os
) {

1124 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1125 
si_now
 = 
ue
;

1132 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

1133 i(
MSTP_Fg
.
ReivedVidFme
 =
ue
) {

1134 i((
DeiAddss
 =
This_Sti
)

1135 && (
FmeTy
 =
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
)) {

1137 
MSTP_Fg
.
SeMa
 = 
l
;

1138 
Next_Sti
 = 
SourAddss
;

1139 
EvtCou
 = 0;

1141 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1142 
This_Sti
, 
NULL
, 0);

1143 
Pl_Sti
 = 
This_Sti
;

1144 
TokCou
 = 0;

1145 
RryCou
 = 0;

1146 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1153 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1154 
si_now
 = 
ue
;

1156 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1157 } i((
	`rs485_s_d
(
Tuge_timeout
)) ||

1158 (
MSTP_Fg
.
ReivedInvidFme
 =
ue
)) {

1159 i(
MSTP_Fg
.
SeMa
 =
ue
) {

1163 
FmeCou
 = 0;

1165 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1166 
si_now
 = 
ue
;

1168 i(
Next_Sti
 !
This_Sti
) {

1172 
EvtCou
 = 0;

1174 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
Next_Sti
,

1175 
This_Sti
, 
NULL
, 0);

1176 
RryCou
 = 0;

1177 
Ma_S
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1179 i(
xt_pl_i
 !
This_Sti
) {

1181 
Pl_Sti
 = 
xt_pl_i
;

1183 
	`MSTP_Sd_Fme
(
FRAME_TYPE_POLL_FOR_MASTER
,

1184 
Pl_Sti
, 
This_Sti
, 
NULL
, 0);

1185 
RryCou
 = 0;

1191 
MSTP_Fg
.
SeMa
 = 
ue
;

1192 
FmeCou
 = 0;

1193 
Ma_S
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1194 
si_now
 = 
ue
;

1198 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

1204 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
:

1205 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Pk
(&
PDU_Queue
);

1206 i(
pkt
 !
NULL
) {

1207 
mched
 =

1208 
	`dlmp_com_da_exg_y
(&
IutBufr
[0],

1209 
DaLgth
, 
SourAddss
, &
pkt
->
bufr
[0],kt->
ngth
,

1210 
pkt
->
dei_mac
);

1212 
mched
 = 
l
;

1214 i(
mched
) {

1222 
ut8_t
 
ame_ty
;

1223 i(
pkt
->
da_exg_y
) {

1224 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

1226 
ame_ty
 = 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

1228 
	`MSTP_Sd_Fme
(
ame_ty
, 
pkt
->
dei_mac
, 
This_Sti
,

1229 (
ut8_t
 *& 
pkt
->
bufr
[0],kt->
ngth
);

1230 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1232 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1234 (
	`Rgbuf_P
(&
PDU_Queue
, 
NULL
);

1235 } i(
	`rs485_s_d
(
Ty_day
|| (
pkt
 !
NULL
)) {

1245 
	`MSTP_Sd_Fme
(
FRAME_TYPE_REPLY_POSTPONED
, 
SourAddss
,

1246 
This_Sti
, 
NULL
, 0);

1247 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1249 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1253 
Ma_S
 = 
MSTP_MASTER_STATE_IDLE
;

1257  
si_now
;

1258 
	}
}

1261 
	$dlmp_nd_pdu
(

1262 
BACNET_ADDRESS
 * 
de
,

1263 
BACNET_NPDU_DATA
 * 
du_da
,

1264 
ut8_t
 * 
pdu
,

1265 
pdu_n
)

1267 
bys_
 = 0;

1268 
mp_pdu_ck
 *
pkt
;

1269 
ut16_t
 
i
 = 0;

1271 
pkt
 = (
mp_pdu_ck
 *
	`Rgbuf_Da_Pk
(&
PDU_Queue
);

1272 i(
pkt
) {

1273 
pkt
->
da_exg_y
 = 
du_da
->data_expecting_reply;

1274 
i
 = 0; i < 
pdu_n
; i++) {

1275 
pkt
->
bufr
[
i
] = 
pdu
[i];

1277 
pkt
->
ngth
 = 
pdu_n
;

1278 i(
de
 && de->
mac_n
) {

1279 
pkt
->
dei_mac
 = 
de
->
mac
[0];

1281 
pkt
->
dei_mac
 = 
MSTP_BROADCAST_ADDRESS
;

1283 i(
	`Rgbuf_Da_Put
(&
PDU_Queue
, (
ut8_t
 *)
pkt
)) {

1284 
bys_
 = 
pdu_n
;

1288  
bys_
;

1289 
	}
}

1292 
bo
 
	$dlmp_nd_pdu_queue_emy
()

1294  
	`Rgbuf_Emy
(&
PDU_Queue
);

1295 
	}
}

1298 
bo
 
	$dlmp_nd_pdu_queue_fu
()

1300  
	`Rgbuf_Fu
(&
PDU_Queue
);

1301 
	}
}

1305 
	mAUTOMAC_STATE_IDLE
 = 0,

1306 
	mAUTOMAC_STATE_PFM
 = 1,

1307 
	mAUTOMAC_STATE_TOKEN
 = 2,

1308 
	mAUTOMAC_STATE_TESTING
 = 3,

1309 
	mAUTOMAC_STATE_CONFIRM
 = 4

1310 } 
	tAUTOMAC_STATE
;

1312 
ut8_t
 
	gAutoMAC_Te_Bufr
[50];

1313 
	$dlmp_automac_hd
(

1316 
AUTOMAC_STATE
 
e
 = 
AUTOMAC_STATE_IDLE
;

1317 
ut8_t
 
mac
 = 0;

1318 
ut32_t
 
rl_numb
 = 0;

1319 
ut16_t
 
vd_id
 = 0;

1320 
bo
 
ke_addss
 = 
l
;

1321 
bo
 
t_ov
 = 
l
;

1323 
e
) {

1324 
AUTOMAC_STATE_IDLE
:

1325 i((
MSTP_Fg
.
ReivedVidFme
) ||

1326 (
MSTP_Fg
.
ReivedVidFmeNFUs
)) {

1327 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1328 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

1330 
	`automac_emr_t
(
SourAddss
);

1331 
FmeTy
) {

1332 
FRAME_TYPE_TOKEN
:

1333 
	`automac_tok_t
(
SourAddss
);

1335 
FRAME_TYPE_POLL_FOR_MASTER
:

1336 
	`automac_pfm_t
(
DeiAddss
);

1341 } i(
MSTP_Fg
.
ReivedInvidFme
) {

1342 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

1343 } i(
	`automac_pfm_cye_come
()) {

1344 
mac
 = 
	`automac__addss_ndom
();

1345 i(
	`automac__addss_vid
(
mac
)) {

1346 
	`automac_addss_t
(
mac
);

1347 
e
 = 
AUTOMAC_STATE_PFM
;

1350 
	`automac_
();

1351 
e
 = 
AUTOMAC_STATE_IDLE
;

1353 } i(
	`rs485_s_d
(
	`automac_time_
())) {

1356 
SourAddss
 = 
	`automac_addss
();

1357 
e
 = 
AUTOMAC_STATE_TESTING
;

1360 
AUTOMAC_STATE_PFM
:

1361 i((
MSTP_Fg
.
ReivedVidFme
) ||

1362 (
MSTP_Fg
.
ReivedVidFmeNFUs
)) {

1363 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1364 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

1366 
FmeTy
) {

1367 
FRAME_TYPE_POLL_FOR_MASTER
:

1368 
mac
 = 
	`automac_addss
();

1369 i(
mac
 =
SourAddss
) {

1371 
	`automac_
();

1372 
e
 = 
AUTOMAC_STATE_IDLE
;

1373 } i(
mac
 =
DeiAddss
) {

1374 
MSTP_Sd_Fme


1375 (
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

1376 
SourAddss
, 
mac
, 
NULL
, 0);

1377 
e
 = 
AUTOMAC_STATE_TOKEN
;

1380 
FRAME_TYPE_TEST_REQUEST
:

1381 
mac
 = 
	`automac_addss
();

1382 i((
mac
 =
DeiAddss
) ||

1383 (
mac
 =
SourAddss
)) {

1385 
	`automac_
();

1386 
e
 = 
AUTOMAC_STATE_IDLE
;

1389 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

1390 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

1391 
FRAME_TYPE_TEST_RESPONSE
:

1392 
FRAME_TYPE_TOKEN
:

1393 
mac
 = 
	`automac_addss
();

1394 i(
mac
 =
SourAddss
) {

1396 
	`automac_
();

1397 
e
 = 
AUTOMAC_STATE_IDLE
;

1403 } i(
MSTP_Fg
.
ReivedInvidFme
) {

1404 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

1405 } i(
	`rs485_s_d
(
	`automac_time_
())) {

1407 
	`automac_
();

1408 
e
 = 
AUTOMAC_STATE_IDLE
;

1411 
AUTOMAC_STATE_TOKEN
:

1412 i((
MSTP_Fg
.
ReivedVidFme
) ||

1413 (
MSTP_Fg
.
ReivedVidFmeNFUs
)) {

1414 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1415 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

1416 
FmeTy
) {

1417 
FRAME_TYPE_TOKEN
:

1418 
mac
 = 
	`automac_addss
();

1419 i(
mac
 =
SourAddss
) {

1421 
	`automac_
();

1422 
e
 = 
AUTOMAC_STATE_IDLE
;

1423 } i(
mac
 =
DeiAddss
) {

1424 
e
 = 
AUTOMAC_STATE_TESTING
;

1429 
	`automac_
();

1430 
e
 = 
AUTOMAC_STATE_IDLE
;

1433 } i(
MSTP_Fg
.
ReivedInvidFme
) {

1434 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

1435 } i(
	`rs485_s_d
(
	`automac_time_
())) {

1437 
	`automac_
();

1438 
e
 = 
AUTOMAC_STATE_IDLE
;

1441 
AUTOMAC_STATE_TESTING
:

1443 
mac
 = 
	`automac_addss
();

1444 
vd_id
 = 
	`Devi_Vd_Idtifr
();

1445 
	`code_unsigd16
(&
AutoMAC_Te_Bufr
[0], 
vd_id
);

1446 
rl_numb
 = 
	`Devi_Obje_In_Numb
();

1447 
	`code_unsigd32
(&
AutoMAC_Te_Bufr
[2], 
rl_numb
);

1448 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TEST_REQUEST
, 
SourAddss
, 
mac
,

1449 &
AutoMAC_Te_Bufr
[0], 6);

1450 
e
 = 
AUTOMAC_STATE_CONFIRM
;

1452 
AUTOMAC_STATE_CONFIRM
:

1454 i(
MSTP_Fg
.
ReivedInvidFme
) {

1455 
MSTP_Fg
.
ReivedInvidFme
 = 
l
;

1456 
t_ov
 = 
ue
;

1457 } i((
MSTP_Fg
.
ReivedVidFme
) ||

1458 (
MSTP_Fg
.
ReivedVidFmeNFUs
)) {

1459 
MSTP_Fg
.
ReivedVidFme
 = 
l
;

1460 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

1461 
mac
 = 
	`automac_addss
();

1462 i((
mac
 =
DeiAddss
&& (
DaLgth
 >= 6)) {

1463 
	`decode_unsigd16
(&
IutBufr
[0], &
vd_id
);

1464 
	`decode_unsigd32
(&
IutBufr
[2], &
rl_numb
);

1465 i((
vd_id
 =
	`Devi_Vd_Idtifr
()) &&

1466 (
rl_numb
 =
	`Devi_Obje_In_Numb
())) {

1467 
ke_addss
 = 
ue
;

1469 
t_ov
 = 
ue
;

1472 
t_ov
 = 
ue
;

1474 } i(
	`rs485_s_d
(300)) {

1478 
ke_addss
 = 
ue
;

1480 i(
ke_addss
) {

1482 
This_Sti
 = 
	`automac_addss
();

1483 
DeiAddss
 = 
	`automac_xt_i
(
This_Sti
);

1484 i(
DeiAddss
 < 128) {

1485 
	`MSTP_Sd_Fme
(
FRAME_TYPE_TOKEN
, 
DeiAddss
,

1486 
This_Sti
, 
NULL
, 0);

1488 
e
 = 
AUTOMAC_STATE_IDLE
;

1489 } i(
t_ov
) {

1491 
	`automac_
();

1492 
e
 = 
AUTOMAC_STATE_IDLE
;

1498 
	}
}

1501 
ut16_t
 
	$dlmp_ive
(

1502 
BACNET_ADDRESS
 * 
c
,

1503 
ut8_t
 * 
pdu
,

1504 
ut16_t
 
max_pdu
,

1505 
timeout
)

1507 
ut16_t
 
pdu_n
 = 0;

1508 
bo
 
smtg
 = 
l
;

1511 i(!
IutBufr
) {

1512 
IutBufr
 = 
pdu
;

1513 
IutBufrSize
 = 
max_pdu
;

1515 i(
This_Sti
 == 255) {

1516 
	`automac_abd_t
(
ue
);

1518 i(
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
) {

1519 
smtg
 = 
	`MSTP_Tnsm_FSM
();

1521 i(
smtg
 =
l
) {

1522 (
MSTP_Fg
.
ReivedVidFme
 =
l
) &&

1523 (
MSTP_Fg
.
ReivedVidFmeNFUs
 =
l
) &&

1524 (
MSTP_Fg
.
ReivedInvidFme
 =
l
)) {

1526 
	`MSTP_Reive_Fme_FSM
();

1528 i(!
	`rs485_by_avaab
(
NULL
)) {

1534 i((
Reive_S
 =
MSTP_RECEIVE_STATE_IDLE
&& (
smtg
 =
l
)) {

1535 i((
This_Sti
 !255&& (
MSTP_Fg
.
ReivedVidFmeNFUs
)) {

1536 
MSTP_Fg
.
ReivedVidFmeNFUs
 = 
l
;

1537 i((
SourAddss
 =
This_Sti
&& 
	`automac_abd
()) {

1539 
	`automac_
();

1540 
This_Sti
 = 255;

1543 
	`MSTP_Ma_Node_FSM
()) {

1548 i(
This_Sti
 != 255) {

1550 i(
MSTP_Fg
.
ReivePackPdg
) {

1551 
MSTP_Fg
.
ReivePackPdg
 = 
l
;

1552 
pdu_n
 = 
DaLgth
;

1553 
c
->
mac_n
 = 1;

1554 
c
->
mac
[0] = 
SourAddss
;

1559  
pdu_n
;

1560 
	}
}

1562 
	$dlmp_t_mac_addss
(

1563 
ut8_t
 
mac_addss
)

1566 i(
mac_addss
 <= 127) {

1567 
This_Sti
 = 
mac_addss
;

1568 i(
mac_addss
 > 
Nmax_ma
) {

1569 
	`dlmp_t_max_ma
(127);

1571 } i(
mac_addss
 == 255) {

1573 
This_Sti
 = 
mac_addss
;

1577 
	}
}

1579 
ut8_t
 
	$dlmp_mac_addss
(

1582  
This_Sti
;

1583 
	}
}

1592 
	$dlmp_t_max_fo_ames
(

1593 
ut8_t
 
max_fo_ames
)

1595 i(
max_fo_ames
 >
MSTP_PDU_PACKET_COUNT
) {

1596 
Nmax_fo_ames
 = 
max_fo_ames
;

1600 
	}
}

1602 
ut8_t
 
	$dlmp_max_fo_ames
(

1605  
Nmax_fo_ames
;

1606 
	}
}

1613 
	$dlmp_t_max_ma
(

1614 
ut8_t
 
max_ma
)

1616 i(
max_ma
 <= 127) {

1617 i((
This_Sti
 =255|| (This_Sti <
max_ma
)) {

1618 
Nmax_ma
 = 
max_ma
;

1623 
	}
}

1625 
ut8_t
 
	$dlmp_max_ma
(

1628  
Nmax_ma
;

1629 
	}
}

1631 
	$dlmp_g_my_addss
(

1632 
BACNET_ADDRESS
 * 
my_addss
)

1634 
i
 = 0;

1636 
my_addss
->
mac_n
 = 1;

1637 
my_addss
->
mac
[0] = 
This_Sti
;

1638 
my_addss
->
t
 = 0;

1639 
my_addss
->
n
 = 0;

1640 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1641 
my_addss
->
adr
[
i
] = 0;

1645 
	}
}

1647 
	$dlmp_g_brd_addss
(

1648 
BACNET_ADDRESS
 * 
de
)

1650 
i
 = 0;

1652 i(
de
) {

1653 
de
->
mac_n
 = 1;

1654 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

1655 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

1656 
de
->
n
 = 0;

1657 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

1658 
de
->
adr
[
i
] = 0;

1663 
	}
}

1665 
bo
 
	$dlmp_se_ma
(

1668 i(
MSTP_Fg
.
SeMa
) {

1669  
ue
;

1672  
l
;

1673 
	}
}

	@ports/stm32f10x/drivers/inc/stm32f10x_adc.h

23 #ide
__STM32F10x_ADC_H


24 
	#__STM32F10x_ADC_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
ut32_t
 
ADC_Mode
;

55 
FuniڮS
 
ADC_SnCvMode
;

59 
FuniڮS
 
ADC_CtuousCvMode
;

63 
ut32_t
 
ADC_ExTrigCv
;

67 
ut32_t
 
ADC_DaAlign
;

70 
ut8_t
 
ADC_NbrOfChl
;

73 }
	tADC_InTyDef
;

82 
	#IS_ADC_ALL_PERIPH
(
PERIPH
(((PERIPH=
ADC1
) || \

83 ((
PERIPH
=
ADC2
) || \

84 ((
PERIPH
=
ADC3
))

	)

86 
	#IS_ADC_DMA_PERIPH
(
PERIPH
(((PERIPH=
ADC1
) || \

87 ((
PERIPH
=
ADC3
))

	)

93 
	#ADC_Mode_Inddt
 ((
ut32_t
)0x00000000)

	)

94 
	#ADC_Mode_RegInjecSimu
 ((
ut32_t
)0x00010000)

	)

95 
	#ADC_Mode_RegSimu_AɔTrig
 ((
ut32_t
)0x00020000)

	)

96 
	#ADC_Mode_InjecSimu_FaIl
 ((
ut32_t
)0x00030000)

	)

97 
	#ADC_Mode_InjecSimu_SlowIl
 ((
ut32_t
)0x00040000)

	)

98 
	#ADC_Mode_InjecSimu
 ((
ut32_t
)0x00050000)

	)

99 
	#ADC_Mode_RegSimu
 ((
ut32_t
)0x00060000)

	)

100 
	#ADC_Mode_FaIl
 ((
ut32_t
)0x00070000)

	)

101 
	#ADC_Mode_SlowIl
 ((
ut32_t
)0x00080000)

	)

102 
	#ADC_Mode_AɔTrig
 ((
ut32_t
)0x00090000)

	)

104 
	#IS_ADC_MODE
(
MODE
(((MODE=
ADC_Mode_Inddt
) || \

105 ((
MODE
=
ADC_Mode_RegInjecSimu
) || \

106 ((
MODE
=
ADC_Mode_RegSimu_AɔTrig
) || \

107 ((
MODE
=
ADC_Mode_InjecSimu_FaIl
) || \

108 ((
MODE
=
ADC_Mode_InjecSimu_SlowIl
) || \

109 ((
MODE
=
ADC_Mode_InjecSimu
) || \

110 ((
MODE
=
ADC_Mode_RegSimu
) || \

111 ((
MODE
=
ADC_Mode_FaIl
) || \

112 ((
MODE
=
ADC_Mode_SlowIl
) || \

113 ((
MODE
=
ADC_Mode_AɔTrig
))

	)

122 
	#ADC_ExTrigCv_T1_CC1
 ((
ut32_t
)0x00000000

	)

123 
	#ADC_ExTrigCv_T1_CC2
 ((
ut32_t
)0x00020000

	)

124 
	#ADC_ExTrigCv_T2_CC2
 ((
ut32_t
)0x00060000

	)

125 
	#ADC_ExTrigCv_T3_TRGO
 ((
ut32_t
)0x00080000

	)

126 
	#ADC_ExTrigCv_T4_CC4
 ((
ut32_t
)0x000A0000

	)

127 
	#ADC_ExTrigCv_Ext_IT11_TIM8_TRGO
 ((
ut32_t
)0x000C0000

	)

129 
	#ADC_ExTrigCv_T1_CC3
 ((
ut32_t
)0x00040000

	)

130 
	#ADC_ExTrigCv_Ne
 ((
ut32_t
)0x000E0000

	)

132 
	#ADC_ExTrigCv_T3_CC1
 ((
ut32_t
)0x00000000

	)

133 
	#ADC_ExTrigCv_T2_CC3
 ((
ut32_t
)0x00020000

	)

134 
	#ADC_ExTrigCv_T8_CC1
 ((
ut32_t
)0x00060000

	)

135 
	#ADC_ExTrigCv_T8_TRGO
 ((
ut32_t
)0x00080000

	)

136 
	#ADC_ExTrigCv_T5_CC1
 ((
ut32_t
)0x000A0000

	)

137 
	#ADC_ExTrigCv_T5_CC3
 ((
ut32_t
)0x000C0000

	)

139 
	#IS_ADC_EXT_TRIG
(
REGTRIG
(((REGTRIG=
ADC_ExTrigCv_T1_CC1
) || \

140 ((
REGTRIG
=
ADC_ExTrigCv_T1_CC2
) || \

141 ((
REGTRIG
=
ADC_ExTrigCv_T1_CC3
) || \

142 ((
REGTRIG
=
ADC_ExTrigCv_T2_CC2
) || \

143 ((
REGTRIG
=
ADC_ExTrigCv_T3_TRGO
) || \

144 ((
REGTRIG
=
ADC_ExTrigCv_T4_CC4
) || \

145 ((
REGTRIG
=
ADC_ExTrigCv_Ext_IT11_TIM8_TRGO
) || \

146 ((
REGTRIG
=
ADC_ExTrigCv_Ne
) || \

147 ((
REGTRIG
=
ADC_ExTrigCv_T3_CC1
) || \

148 ((
REGTRIG
=
ADC_ExTrigCv_T2_CC3
) || \

149 ((
REGTRIG
=
ADC_ExTrigCv_T8_CC1
) || \

150 ((
REGTRIG
=
ADC_ExTrigCv_T8_TRGO
) || \

151 ((
REGTRIG
=
ADC_ExTrigCv_T5_CC1
) || \

152 ((
REGTRIG
=
ADC_ExTrigCv_T5_CC3
))

	)

161 
	#ADC_DaAlign_Right
 ((
ut32_t
)0x00000000)

	)

162 
	#ADC_DaAlign_Le
 ((
ut32_t
)0x00000800)

	)

163 
	#IS_ADC_DATA_ALIGN
(
ALIGN
(((ALIGN=
ADC_DaAlign_Right
) || \

164 ((
ALIGN
=
ADC_DaAlign_Le
))

	)

173 
	#ADC_Chl_0
 ((
ut8_t
)0x00)

	)

174 
	#ADC_Chl_1
 ((
ut8_t
)0x01)

	)

175 
	#ADC_Chl_2
 ((
ut8_t
)0x02)

	)

176 
	#ADC_Chl_3
 ((
ut8_t
)0x03)

	)

177 
	#ADC_Chl_4
 ((
ut8_t
)0x04)

	)

178 
	#ADC_Chl_5
 ((
ut8_t
)0x05)

	)

179 
	#ADC_Chl_6
 ((
ut8_t
)0x06)

	)

180 
	#ADC_Chl_7
 ((
ut8_t
)0x07)

	)

181 
	#ADC_Chl_8
 ((
ut8_t
)0x08)

	)

182 
	#ADC_Chl_9
 ((
ut8_t
)0x09)

	)

183 
	#ADC_Chl_10
 ((
ut8_t
)0x0A)

	)

184 
	#ADC_Chl_11
 ((
ut8_t
)0x0B)

	)

185 
	#ADC_Chl_12
 ((
ut8_t
)0x0C)

	)

186 
	#ADC_Chl_13
 ((
ut8_t
)0x0D)

	)

187 
	#ADC_Chl_14
 ((
ut8_t
)0x0E)

	)

188 
	#ADC_Chl_15
 ((
ut8_t
)0x0F)

	)

189 
	#ADC_Chl_16
 ((
ut8_t
)0x10)

	)

190 
	#ADC_Chl_17
 ((
ut8_t
)0x11)

	)

192 
	#ADC_Chl_TempSs
 ((
ut8_t
)
ADC_Chl_16
)

	)

193 
	#ADC_Chl_Vft
 ((
ut8_t
)
ADC_Chl_17
)

	)

195 
	#IS_ADC_CHANNEL
(
CHANNEL
(((CHANNEL=
ADC_Chl_0
|| ((CHANNEL=
ADC_Chl_1
) || \

196 ((
CHANNEL
=
ADC_Chl_2
|| ((CHANNEL=
ADC_Chl_3
) || \

197 ((
CHANNEL
=
ADC_Chl_4
|| ((CHANNEL=
ADC_Chl_5
) || \

198 ((
CHANNEL
=
ADC_Chl_6
|| ((CHANNEL=
ADC_Chl_7
) || \

199 ((
CHANNEL
=
ADC_Chl_8
|| ((CHANNEL=
ADC_Chl_9
) || \

200 ((
CHANNEL
=
ADC_Chl_10
|| ((CHANNEL=
ADC_Chl_11
) || \

201 ((
CHANNEL
=
ADC_Chl_12
|| ((CHANNEL=
ADC_Chl_13
) || \

202 ((
CHANNEL
=
ADC_Chl_14
|| ((CHANNEL=
ADC_Chl_15
) || \

203 ((
CHANNEL
=
ADC_Chl_16
|| ((CHANNEL=
ADC_Chl_17
))

	)

212 
	#ADC_SameTime_1Cyes5
 ((
ut8_t
)0x00)

	)

213 
	#ADC_SameTime_7Cyes5
 ((
ut8_t
)0x01)

	)

214 
	#ADC_SameTime_13Cyes5
 ((
ut8_t
)0x02)

	)

215 
	#ADC_SameTime_28Cyes5
 ((
ut8_t
)0x03)

	)

216 
	#ADC_SameTime_41Cyes5
 ((
ut8_t
)0x04)

	)

217 
	#ADC_SameTime_55Cyes5
 ((
ut8_t
)0x05)

	)

218 
	#ADC_SameTime_71Cyes5
 ((
ut8_t
)0x06)

	)

219 
	#ADC_SameTime_239Cyes5
 ((
ut8_t
)0x07)

	)

220 
	#IS_ADC_SAMPLE_TIME
(
TIME
(((TIME=
ADC_SameTime_1Cyes5
) || \

221 ((
TIME
=
ADC_SameTime_7Cyes5
) || \

222 ((
TIME
=
ADC_SameTime_13Cyes5
) || \

223 ((
TIME
=
ADC_SameTime_28Cyes5
) || \

224 ((
TIME
=
ADC_SameTime_41Cyes5
) || \

225 ((
TIME
=
ADC_SameTime_55Cyes5
) || \

226 ((
TIME
=
ADC_SameTime_71Cyes5
) || \

227 ((
TIME
=
ADC_SameTime_239Cyes5
))

	)

236 
	#ADC_ExTrigInjecCv_T2_TRGO
 ((
ut32_t
)0x00002000

	)

237 
	#ADC_ExTrigInjecCv_T2_CC1
 ((
ut32_t
)0x00003000

	)

238 
	#ADC_ExTrigInjecCv_T3_CC4
 ((
ut32_t
)0x00004000

	)

239 
	#ADC_ExTrigInjecCv_T4_TRGO
 ((
ut32_t
)0x00005000

	)

240 
	#ADC_ExTrigInjecCv_Ext_IT15_TIM8_CC4
 ((
ut32_t
)0x00006000

	)

242 
	#ADC_ExTrigInjecCv_T1_TRGO
 ((
ut32_t
)0x00000000

	)

243 
	#ADC_ExTrigInjecCv_T1_CC4
 ((
ut32_t
)0x00001000

	)

244 
	#ADC_ExTrigInjecCv_Ne
 ((
ut32_t
)0x00007000

	)

246 
	#ADC_ExTrigInjecCv_T4_CC3
 ((
ut32_t
)0x00002000

	)

247 
	#ADC_ExTrigInjecCv_T8_CC2
 ((
ut32_t
)0x00003000

	)

248 
	#ADC_ExTrigInjecCv_T8_CC4
 ((
ut32_t
)0x00004000

	)

249 
	#ADC_ExTrigInjecCv_T5_TRGO
 ((
ut32_t
)0x00005000

	)

250 
	#ADC_ExTrigInjecCv_T5_CC4
 ((
ut32_t
)0x00006000

	)

252 
	#IS_ADC_EXT_INJEC_TRIG
(
INJTRIG
(((INJTRIG=
ADC_ExTrigInjecCv_T1_TRGO
) || \

253 ((
INJTRIG
=
ADC_ExTrigInjecCv_T1_CC4
) || \

254 ((
INJTRIG
=
ADC_ExTrigInjecCv_T2_TRGO
) || \

255 ((
INJTRIG
=
ADC_ExTrigInjecCv_T2_CC1
) || \

256 ((
INJTRIG
=
ADC_ExTrigInjecCv_T3_CC4
) || \

257 ((
INJTRIG
=
ADC_ExTrigInjecCv_T4_TRGO
) || \

258 ((
INJTRIG
=
ADC_ExTrigInjecCv_Ext_IT15_TIM8_CC4
) || \

259 ((
INJTRIG
=
ADC_ExTrigInjecCv_Ne
) || \

260 ((
INJTRIG
=
ADC_ExTrigInjecCv_T4_CC3
) || \

261 ((
INJTRIG
=
ADC_ExTrigInjecCv_T8_CC2
) || \

262 ((
INJTRIG
=
ADC_ExTrigInjecCv_T8_CC4
) || \

263 ((
INJTRIG
=
ADC_ExTrigInjecCv_T5_TRGO
) || \

264 ((
INJTRIG
=
ADC_ExTrigInjecCv_T5_CC4
))

	)

273 
	#ADC_InjeedChl_1
 ((
ut8_t
)0x14)

	)

274 
	#ADC_InjeedChl_2
 ((
ut8_t
)0x18)

	)

275 
	#ADC_InjeedChl_3
 ((
ut8_t
)0x1C)

	)

276 
	#ADC_InjeedChl_4
 ((
ut8_t
)0x20)

	)

277 
	#IS_ADC_INJECTED_CHANNEL
(
CHANNEL
(((CHANNEL=
ADC_InjeedChl_1
) || \

278 ((
CHANNEL
=
ADC_InjeedChl_2
) || \

279 ((
CHANNEL
=
ADC_InjeedChl_3
) || \

280 ((
CHANNEL
=
ADC_InjeedChl_4
))

	)

289 
	#ADC_AlogWchdog_SgRegEb
 ((
ut32_t
)0x00800200)

	)

290 
	#ADC_AlogWchdog_SgInjecEb
 ((
ut32_t
)0x00400200)

	)

291 
	#ADC_AlogWchdog_SgRegOrInjecEb
 ((
ut32_t
)0x00C00200)

	)

292 
	#ADC_AlogWchdog_ARegEb
 ((
ut32_t
)0x00800000)

	)

293 
	#ADC_AlogWchdog_AInjecEb
 ((
ut32_t
)0x00400000)

	)

294 
	#ADC_AlogWchdog_ARegAInjecEb
 ((
ut32_t
)0x00C00000)

	)

295 
	#ADC_AlogWchdog_Ne
 ((
ut32_t
)0x00000000)

	)

297 
	#IS_ADC_ANALOG_WATCHDOG
(
WATCHDOG
(((WATCHDOG=
ADC_AlogWchdog_SgRegEb
) || \

298 ((
WATCHDOG
=
ADC_AlogWchdog_SgInjecEb
) || \

299 ((
WATCHDOG
=
ADC_AlogWchdog_SgRegOrInjecEb
) || \

300 ((
WATCHDOG
=
ADC_AlogWchdog_ARegEb
) || \

301 ((
WATCHDOG
=
ADC_AlogWchdog_AInjecEb
) || \

302 ((
WATCHDOG
=
ADC_AlogWchdog_ARegAInjecEb
) || \

303 ((
WATCHDOG
=
ADC_AlogWchdog_Ne
))

	)

312 
	#ADC_IT_EOC
 ((
ut16_t
)0x0220)

	)

313 
	#ADC_IT_AWD
 ((
ut16_t
)0x0140)

	)

314 
	#ADC_IT_JEOC
 ((
ut16_t
)0x0480)

	)

316 
	#IS_ADC_IT
(
IT
((((IT& (
ut16_t
)0xF81F=0x00&& ((IT!0x00))

	)

318 
	#IS_ADC_GET_IT
(
IT
(((IT=
ADC_IT_EOC
|| ((IT=
ADC_IT_AWD
) || \

319 ((
IT
=
ADC_IT_JEOC
))

	)

328 
	#ADC_FLAG_AWD
 ((
ut8_t
)0x01)

	)

329 
	#ADC_FLAG_EOC
 ((
ut8_t
)0x02)

	)

330 
	#ADC_FLAG_JEOC
 ((
ut8_t
)0x04)

	)

331 
	#ADC_FLAG_JSTRT
 ((
ut8_t
)0x08)

	)

332 
	#ADC_FLAG_STRT
 ((
ut8_t
)0x10)

	)

333 
	#IS_ADC_CLEAR_FLAG
(
FLAG
((((FLAG& (
ut8_t
)0xE0=0x00&& ((FLAG!0x00))

	)

334 
	#IS_ADC_GET_FLAG
(
FLAG
(((FLAG=
ADC_FLAG_AWD
|| ((FLAG=
ADC_FLAG_EOC
) || \

335 ((
FLAG
=
ADC_FLAG_JEOC
|| ((FLAG)=
ADC_FLAG_JSTRT
) || \

336 ((
FLAG
=
ADC_FLAG_STRT
))

	)

345 
	#IS_ADC_THRESHOLD
(
THRESHOLD
((THRESHOLD<0xFFF)

	)

355 
	#IS_ADC_OFFSET
(
OFFSET
((OFFSET<0xFFF)

	)

365 
	#IS_ADC_INJECTED_LENGTH
(
LENGTH
(((LENGTH>0x1&& ((LENGTH<0x4))

	)

375 
	#IS_ADC_INJECTED_RANK
(
RANK
(((RANK>0x1&& ((RANK<0x4))

	)

386 
	#IS_ADC_REGULAR_LENGTH
(
LENGTH
(((LENGTH>0x1&& ((LENGTH<0x10))

	)

395 
	#IS_ADC_REGULAR_RANK
(
RANK
(((RANK>0x1&& ((RANK<0x10))

	)

405 
	#IS_ADC_REGULAR_DISC_NUMBER
(
NUMBER
(((NUMBER>0x1&& ((NUMBER<0x8))

	)

427 
ADC_DeIn
(
ADC_TyDef
* 
ADCx
);

428 
ADC_In
(
ADC_TyDef
* 
ADCx
, 
ADC_InTyDef
* 
ADC_InSu
);

429 
ADC_SuIn
(
ADC_InTyDef
* 
ADC_InSu
);

430 
ADC_Cmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
);

431 
ADC_DMACmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
);

432 
ADC_ITCfig
(
ADC_TyDef
* 
ADCx
, 
ut16_t
 
ADC_IT
, 
FuniڮS
 
NewS
);

433 
ADC_RetCibti
(
ADC_TyDef
* 
ADCx
);

434 
FgStus
 
ADC_GRetCibtiStus
(
ADC_TyDef
* 
ADCx
);

435 
ADC_SCibti
(
ADC_TyDef
* 
ADCx
);

436 
FgStus
 
ADC_GCibtiStus
(
ADC_TyDef
* 
ADCx
);

437 
ADC_SoweSCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
);

438 
FgStus
 
ADC_GSoweSCvStus
(
ADC_TyDef
* 
ADCx
);

439 
ADC_DiscModeChlCouCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
Numb
);

440 
ADC_DiscModeCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
);

441 
ADC_RegurChlCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_Chl
, ut8_
Rk
, ut8_
ADC_SameTime
);

442 
ADC_ExTrigCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
);

443 
ut16_t
 
ADC_GCvsiVue
(
ADC_TyDef
* 
ADCx
);

444 
ut32_t
 
ADC_GDuModeCvsiVue
();

445 
ADC_AutoInjeedCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
);

446 
ADC_InjeedDiscModeCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
);

447 
ADC_ExTrigInjeedCvCfig
(
ADC_TyDef
* 
ADCx
, 
ut32_t
 
ADC_ExTrigInjecCv
);

448 
ADC_ExTrigInjeedCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
);

449 
ADC_SoweSInjeedCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
);

450 
FgStus
 
ADC_GSoweSInjeedCvCmdStus
(
ADC_TyDef
* 
ADCx
);

451 
ADC_InjeedChlCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_Chl
, ut8_
Rk
, ut8_
ADC_SameTime
);

452 
ADC_InjeedSequrLgthCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
Lgth
);

453 
ADC_SInjeedOfft
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_InjeedChl
, 
ut16_t
 
Offt
);

454 
ut16_t
 
ADC_GInjeedCvsiVue
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_InjeedChl
);

455 
ADC_AlogWchdogCmd
(
ADC_TyDef
* 
ADCx
, 
ut32_t
 
ADC_AlogWchdog
);

456 
ADC_AlogWchdogThshdsCfig
(
ADC_TyDef
* 
ADCx
, 
ut16_t
 
HighThshd
, ut16_
LowThshd
);

457 
ADC_AlogWchdogSgChlCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_Chl
);

458 
ADC_TempSsVftCmd
(
FuniڮS
 
NewS
);

459 
FgStus
 
ADC_GFgStus
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_FLAG
);

460 
ADC_CˬFg
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_FLAG
);

461 
ITStus
 
ADC_GITStus
(
ADC_TyDef
* 
ADCx
, 
ut16_t
 
ADC_IT
);

462 
ADC_CˬITPdgB
(
ADC_TyDef
* 
ADCx
, 
ut16_t
 
ADC_IT
);

464 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_bkp.h

23 #ide
__STM32F10x_BKP_H


24 
	#__STM32F10x_BKP_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

57 
	#BKP_TamrPLev_High
 ((
ut16_t
)0x0000)

	)

58 
	#BKP_TamrPLev_Low
 ((
ut16_t
)0x0001)

	)

59 
	#IS_BKP_TAMPER_PIN_LEVEL
(
LEVEL
(((LEVEL=
BKP_TamrPLev_High
) || \

60 ((
LEVEL
=
BKP_TamrPLev_Low
))

	)

69 
	#BKP_RTCOuutSour_Ne
 ((
ut16_t
)0x0000)

	)

70 
	#BKP_RTCOuutSour_CibClock
 ((
ut16_t
)0x0080)

	)

71 
	#BKP_RTCOuutSour_Arm
 ((
ut16_t
)0x0100)

	)

72 
	#BKP_RTCOuutSour_Secd
 ((
ut16_t
)0x0300)

	)

73 
	#IS_BKP_RTC_OUTPUT_SOURCE
(
SOURCE
(((SOURCE=
BKP_RTCOuutSour_Ne
) || \

74 ((
SOURCE
=
BKP_RTCOuutSour_CibClock
) || \

75 ((
SOURCE
=
BKP_RTCOuutSour_Arm
) || \

76 ((
SOURCE
=
BKP_RTCOuutSour_Secd
))

	)

85 
	#BKP_DR1
 ((
ut16_t
)0x0004)

	)

86 
	#BKP_DR2
 ((
ut16_t
)0x0008)

	)

87 
	#BKP_DR3
 ((
ut16_t
)0x000C)

	)

88 
	#BKP_DR4
 ((
ut16_t
)0x0010)

	)

89 
	#BKP_DR5
 ((
ut16_t
)0x0014)

	)

90 
	#BKP_DR6
 ((
ut16_t
)0x0018)

	)

91 
	#BKP_DR7
 ((
ut16_t
)0x001C)

	)

92 
	#BKP_DR8
 ((
ut16_t
)0x0020)

	)

93 
	#BKP_DR9
 ((
ut16_t
)0x0024)

	)

94 
	#BKP_DR10
 ((
ut16_t
)0x0028)

	)

95 
	#BKP_DR11
 ((
ut16_t
)0x0040)

	)

96 
	#BKP_DR12
 ((
ut16_t
)0x0044)

	)

97 
	#BKP_DR13
 ((
ut16_t
)0x0048)

	)

98 
	#BKP_DR14
 ((
ut16_t
)0x004C)

	)

99 
	#BKP_DR15
 ((
ut16_t
)0x0050)

	)

100 
	#BKP_DR16
 ((
ut16_t
)0x0054)

	)

101 
	#BKP_DR17
 ((
ut16_t
)0x0058)

	)

102 
	#BKP_DR18
 ((
ut16_t
)0x005C)

	)

103 
	#BKP_DR19
 ((
ut16_t
)0x0060)

	)

104 
	#BKP_DR20
 ((
ut16_t
)0x0064)

	)

105 
	#BKP_DR21
 ((
ut16_t
)0x0068)

	)

106 
	#BKP_DR22
 ((
ut16_t
)0x006C)

	)

107 
	#BKP_DR23
 ((
ut16_t
)0x0070)

	)

108 
	#BKP_DR24
 ((
ut16_t
)0x0074)

	)

109 
	#BKP_DR25
 ((
ut16_t
)0x0078)

	)

110 
	#BKP_DR26
 ((
ut16_t
)0x007C)

	)

111 
	#BKP_DR27
 ((
ut16_t
)0x0080)

	)

112 
	#BKP_DR28
 ((
ut16_t
)0x0084)

	)

113 
	#BKP_DR29
 ((
ut16_t
)0x0088)

	)

114 
	#BKP_DR30
 ((
ut16_t
)0x008C)

	)

115 
	#BKP_DR31
 ((
ut16_t
)0x0090)

	)

116 
	#BKP_DR32
 ((
ut16_t
)0x0094)

	)

117 
	#BKP_DR33
 ((
ut16_t
)0x0098)

	)

118 
	#BKP_DR34
 ((
ut16_t
)0x009C)

	)

119 
	#BKP_DR35
 ((
ut16_t
)0x00A0)

	)

120 
	#BKP_DR36
 ((
ut16_t
)0x00A4)

	)

121 
	#BKP_DR37
 ((
ut16_t
)0x00A8)

	)

122 
	#BKP_DR38
 ((
ut16_t
)0x00AC)

	)

123 
	#BKP_DR39
 ((
ut16_t
)0x00B0)

	)

124 
	#BKP_DR40
 ((
ut16_t
)0x00B4)

	)

125 
	#BKP_DR41
 ((
ut16_t
)0x00B8)

	)

126 
	#BKP_DR42
 ((
ut16_t
)0x00BC)

	)

128 
	#IS_BKP_DR
(
DR
(((DR=
BKP_DR1
|| ((DR=
BKP_DR2
|| ((DR=
BKP_DR3
) || \

129 ((
DR
=
BKP_DR4
|| ((DR=
BKP_DR5
|| ((DR=
BKP_DR6
) || \

130 ((
DR
=
BKP_DR7
|| ((DR=
BKP_DR8
|| ((DR=
BKP_DR9
) || \

131 ((
DR
=
BKP_DR10
|| ((DR=
BKP_DR11
|| ((DR=
BKP_DR12
) || \

132 ((
DR
=
BKP_DR13
|| ((DR=
BKP_DR14
|| ((DR=
BKP_DR15
) || \

133 ((
DR
=
BKP_DR16
|| ((DR=
BKP_DR17
|| ((DR=
BKP_DR18
) || \

134 ((
DR
=
BKP_DR19
|| ((DR=
BKP_DR20
|| ((DR=
BKP_DR21
) || \

135 ((
DR
=
BKP_DR22
|| ((DR=
BKP_DR23
|| ((DR=
BKP_DR24
) || \

136 ((
DR
=
BKP_DR25
|| ((DR=
BKP_DR26
|| ((DR=
BKP_DR27
) || \

137 ((
DR
=
BKP_DR28
|| ((DR=
BKP_DR29
|| ((DR=
BKP_DR30
) || \

138 ((
DR
=
BKP_DR31
|| ((DR=
BKP_DR32
|| ((DR=
BKP_DR33
) || \

139 ((
DR
=
BKP_DR34
|| ((DR=
BKP_DR35
|| ((DR=
BKP_DR36
) || \

140 ((
DR
=
BKP_DR37
|| ((DR=
BKP_DR38
|| ((DR=
BKP_DR39
) || \

141 ((
DR
=
BKP_DR40
|| ((DR=
BKP_DR41
|| ((DR=
BKP_DR42
))

	)

143 
	#IS_BKP_CALIBRATION_VALUE
(
VALUE
((VALUE<0x7F)

	)

164 
BKP_DeIn
();

165 
BKP_TamrPLevCfig
(
ut16_t
 
BKP_TamrPLev
);

166 
BKP_TamrPCmd
(
FuniڮS
 
NewS
);

167 
BKP_ITCfig
(
FuniڮS
 
NewS
);

168 
BKP_RTCOuutCfig
(
ut16_t
 
BKP_RTCOuutSour
);

169 
BKP_SRTCCibtiVue
(
ut8_t
 
CibtiVue
);

170 
BKP_WreBackupRegi
(
ut16_t
 
BKP_DR
, ut16_
Da
);

171 
ut16_t
 
BKP_RdBackupRegi
(ut16_
BKP_DR
);

172 
FgStus
 
BKP_GFgStus
();

173 
BKP_CˬFg
();

174 
ITStus
 
BKP_GITStus
();

175 
BKP_CˬITPdgB
();

177 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_can.h

23 #ide
__STM32F10x_CAN_H


24 
	#__STM32F10x_CAN_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

45 
	#IS_CAN_ALL_PERIPH
(
PERIPH
(((PERIPH=
CAN1
) || \

46 ((
PERIPH
=
CAN2
))

	)

54 
ut16_t
 
CAN_Psr
;

56 
ut8_t
 
CAN_Mode
;

59 
ut8_t
 
CAN_SJW
;

63 
ut8_t
 
CAN_BS1
;

66 
ut8_t
 
CAN_BS2
;

69 
FuniڮS
 
CAN_TTCM
;

72 
FuniڮS
 
CAN_ABOM
;

75 
FuniڮS
 
CAN_AWUM
;

78 
FuniڮS
 
CAN_NART
;

81 
FuniڮS
 
CAN_RFLM
;

84 
FuniڮS
 
CAN_TXFP
;

86 } 
	tCAN_InTyDef
;

94 
ut16_t
 
CAN_FrIdHigh
;

98 
ut16_t
 
CAN_FrIdLow
;

102 
ut16_t
 
CAN_FrMaskIdHigh
;

107 
ut16_t
 
CAN_FrMaskIdLow
;

112 
ut16_t
 
CAN_FrFIFOAssignmt
;

115 
ut8_t
 
CAN_FrNumb
;

117 
ut8_t
 
CAN_FrMode
;

120 
ut8_t
 
CAN_FrS
;

123 
FuniڮS
 
CAN_FrAivi
;

125 } 
	tCAN_FrInTyDef
;

133 
ut32_t
 
StdId
;

136 
ut32_t
 
ExtId
;

139 
ut8_t
 
IDE
;

142 
ut8_t
 
RTR
;

145 
ut8_t
 
DLC
;

148 
ut8_t
 
Da
[8];

149 } 
	tCTxMsg
;

157 
ut32_t
 
StdId
;

160 
ut32_t
 
ExtId
;

163 
ut8_t
 
IDE
;

166 
ut8_t
 
RTR
;

169 
ut8_t
 
DLC
;

172 
ut8_t
 
Da
[8];

174 
ut8_t
 
FMI
;

176 } 
	tCRxMsg
;

190 
	#CANINITFAILED
 ((
ut8_t
)0x00

	)

191 
	#CANINITOK
 ((
ut8_t
)0x01

	)

201 
	#CAN_Mode_Nm
 ((
ut8_t
)0x00

	)

202 
	#CAN_Mode_LoBack
 ((
ut8_t
)0x01

	)

203 
	#CAN_Mode_St
 ((
ut8_t
)0x02

	)

204 
	#CAN_Mode_St_LoBack
 ((
ut8_t
)0x03

	)

206 
	#IS_CAN_MODE
(
MODE
(((MODE=
CAN_Mode_Nm
|| ((MODE=
CAN_Mode_LoBack
)|| \

207 ((
MODE
=
CAN_Mode_St
|| ((MODE=
CAN_Mode_St_LoBack
))

	)

216 
	#CAN_SJW_1tq
 ((
ut8_t
)0x00

	)

217 
	#CAN_SJW_2tq
 ((
ut8_t
)0x01

	)

218 
	#CAN_SJW_3tq
 ((
ut8_t
)0x02

	)

219 
	#CAN_SJW_4tq
 ((
ut8_t
)0x03

	)

221 
	#IS_CAN_SJW
(
SJW
(((SJW=
CAN_SJW_1tq
|| ((SJW=
CAN_SJW_2tq
)|| \

222 ((
SJW
=
CAN_SJW_3tq
|| ((SJW=
CAN_SJW_4tq
))

	)

231 
	#CAN_BS1_1tq
 ((
ut8_t
)0x00

	)

232 
	#CAN_BS1_2tq
 ((
ut8_t
)0x01

	)

233 
	#CAN_BS1_3tq
 ((
ut8_t
)0x02

	)

234 
	#CAN_BS1_4tq
 ((
ut8_t
)0x03

	)

235 
	#CAN_BS1_5tq
 ((
ut8_t
)0x04

	)

236 
	#CAN_BS1_6tq
 ((
ut8_t
)0x05

	)

237 
	#CAN_BS1_7tq
 ((
ut8_t
)0x06

	)

238 
	#CAN_BS1_8tq
 ((
ut8_t
)0x07

	)

239 
	#CAN_BS1_9tq
 ((
ut8_t
)0x08

	)

240 
	#CAN_BS1_10tq
 ((
ut8_t
)0x09

	)

241 
	#CAN_BS1_11tq
 ((
ut8_t
)0x0A

	)

242 
	#CAN_BS1_12tq
 ((
ut8_t
)0x0B

	)

243 
	#CAN_BS1_13tq
 ((
ut8_t
)0x0C

	)

244 
	#CAN_BS1_14tq
 ((
ut8_t
)0x0D

	)

245 
	#CAN_BS1_15tq
 ((
ut8_t
)0x0E

	)

246 
	#CAN_BS1_16tq
 ((
ut8_t
)0x0F

	)

248 
	#IS_CAN_BS1
(
BS1
((BS1<
CAN_BS1_16tq
)

	)

257 
	#CAN_BS2_1tq
 ((
ut8_t
)0x00

	)

258 
	#CAN_BS2_2tq
 ((
ut8_t
)0x01

	)

259 
	#CAN_BS2_3tq
 ((
ut8_t
)0x02

	)

260 
	#CAN_BS2_4tq
 ((
ut8_t
)0x03

	)

261 
	#CAN_BS2_5tq
 ((
ut8_t
)0x04

	)

262 
	#CAN_BS2_6tq
 ((
ut8_t
)0x05

	)

263 
	#CAN_BS2_7tq
 ((
ut8_t
)0x06

	)

264 
	#CAN_BS2_8tq
 ((
ut8_t
)0x07

	)

266 
	#IS_CAN_BS2
(
BS2
((BS2<
CAN_BS2_8tq
)

	)

276 
	#IS_CAN_PRESCALER
(
PRESCALER
(((PRESCALER>1&& ((PRESCALER<1024))

	)

285 #ide
STM32F10X_CL


286 
	#IS_CAN_FILTER_NUMBER
(
NUMBER
((NUMBER<13)

	)

288 
	#IS_CAN_FILTER_NUMBER
(
NUMBER
((NUMBER<27)

	)

298 
	#CAN_FrMode_IdMask
 ((
ut8_t
)0x00

	)

299 
	#CAN_FrMode_IdLi
 ((
ut8_t
)0x01

	)

301 
	#IS_CAN_FILTER_MODE
(
MODE
(((MODE=
CAN_FrMode_IdMask
) || \

302 ((
MODE
=
CAN_FrMode_IdLi
))

	)

311 
	#CAN_FrS_16b
 ((
ut8_t
)0x00

	)

312 
	#CAN_FrS_32b
 ((
ut8_t
)0x01

	)

314 
	#IS_CAN_FILTER_SCALE
(
SCALE
(((SCALE=
CAN_FrS_16b
) || \

315 ((
SCALE
=
CAN_FrS_32b
))

	)

325 
	#CAN_FrFIFO0
 ((
ut8_t
)0x00

	)

326 
	#CAN_FrFIFO1
 ((
ut8_t
)0x01

	)

327 
	#IS_CAN_FILTER_FIFO
(
FIFO
(((FIFO=
CAN_FrFIFO0
) || \

328 ((
FIFO
=
CAN_FrFIFO1
))

	)

337 
	#IS_CAN_BANKNUMBER
(
BANKNUMBER
(((BANKNUMBER>1&& ((BANKNUMBER<27))

	)

346 
	#IS_CAN_TRANSMITMAILBOX
(
TRANSMITMAILBOX
((TRANSMITMAILBOX<((
ut8_t
)0x02))

	)

347 
	#IS_CAN_STDID
(
STDID
((STDID<((
ut32_t
)0x7FF))

	)

348 
	#IS_CAN_EXTID
(
EXTID
((EXTID<((
ut32_t
)0x1FFFFFFF))

	)

349 
	#IS_CAN_DLC
(
DLC
((DLC<((
ut8_t
)0x08))

	)

359 
	#CAN_ID_STD
 ((
ut32_t
)0x00000000

	)

360 
	#CAN_ID_EXT
 ((
ut32_t
)0x00000004

	)

361 
	#IS_CAN_IDTYPE
(
IDTYPE
(((IDTYPE=
CAN_ID_STD
|| ((IDTYPE=
CAN_ID_EXT
))

	)

371 
	#CAN_RTR_DATA
 ((
ut32_t
)0x00000000

	)

372 
	#CAN_RTR_REMOTE
 ((
ut32_t
)0x00000002

	)

373 
	#IS_CAN_RTR
(
RTR
(((RTR=
CAN_RTR_DATA
|| ((RTR=
CAN_RTR_REMOTE
))

	)

383 
	#CANTXFAILED
 ((
ut8_t
)0x00

	)

384 
	#CANTXOK
 ((
ut8_t
)0x01

	)

385 
	#CANTXPENDING
 ((
ut8_t
)0x02

	)

386 
	#CAN_NO_MB
 ((
ut8_t
)0x04

	)

396 
	#CAN_FIFO0
 ((
ut8_t
)0x00

	)

397 
	#CAN_FIFO1
 ((
ut8_t
)0x01

	)

399 
	#IS_CAN_FIFO
(
FIFO
(((FIFO=
CAN_FIFO0
|| ((FIFO=
CAN_FIFO1
))

	)

409 
	#CANSLEEPFAILED
 ((
ut8_t
)0x00

	)

410 
	#CANSLEEPOK
 ((
ut8_t
)0x01

	)

420 
	#CANWAKEUPFAILED
 ((
ut8_t
)0x00

	)

421 
	#CANWAKEUPOK
 ((
ut8_t
)0x01

	)

435 
	#CAN_FLAG_RQCP0
 ((
ut32_t
)0x38000001

	)

436 
	#CAN_FLAG_RQCP1
 ((
ut32_t
)0x38000100

	)

437 
	#CAN_FLAG_RQCP2
 ((
ut32_t
)0x38010000

	)

440 
	#CAN_FLAG_FMP0
 ((
ut32_t
)0x12000003

	)

441 
	#CAN_FLAG_FF0
 ((
ut32_t
)0x32000008

	)

442 
	#CAN_FLAG_FOV0
 ((
ut32_t
)0x32000010

	)

443 
	#CAN_FLAG_FMP1
 ((
ut32_t
)0x14000003

	)

444 
	#CAN_FLAG_FF1
 ((
ut32_t
)0x34000008

	)

445 
	#CAN_FLAG_FOV1
 ((
ut32_t
)0x34000010

	)

448 
	#CAN_FLAG_WKU
 ((
ut32_t
)0x31000008

	)

449 
	#CAN_FLAG_SLAK
 ((
ut32_t
)0x31000012

	)

454 
	#CAN_FLAG_EWG
 ((
ut32_t
)0x10F00001

	)

455 
	#CAN_FLAG_EPV
 ((
ut32_t
)0x10F00002

	)

456 
	#CAN_FLAG_BOF
 ((
ut32_t
)0x10F00004

	)

457 
	#CAN_FLAG_LEC
 ((
ut32_t
)0x30F00070

	)

459 
	#IS_CAN_GET_FLAG
(
FLAG
(((FLAG=
CAN_FLAG_LEC
|| ((FLAG=
CAN_FLAG_BOF
) || \

460 ((
FLAG
=
CAN_FLAG_EPV
|| ((FLAG=
CAN_FLAG_EWG
) || \

461 ((
FLAG
=
CAN_FLAG_WKU
|| ((FLAG=
CAN_FLAG_FOV0
) || \

462 ((
FLAG
=
CAN_FLAG_FF0
|| ((FLAG=
CAN_FLAG_FMP0
) || \

463 ((
FLAG
=
CAN_FLAG_FOV1
|| ((FLAG=
CAN_FLAG_FF1
) || \

464 ((
FLAG
=
CAN_FLAG_FMP1
|| ((FLAG=
CAN_FLAG_RQCP2
) || \

465 ((
FLAG
=
CAN_FLAG_RQCP1
)|| ((FLAG=
CAN_FLAG_RQCP0
) || \

466 ((
FLAG
=
CAN_FLAG_SLAK
 ))

	)

468 
	#IS_CAN_CLEAR_FLAG
(
FLAG
)(((FLAG=
CAN_FLAG_LEC
|| ((FLAG=
CAN_FLAG_RQCP2
) || \

469 ((
FLAG
=
CAN_FLAG_RQCP1
|| ((FLAG=
CAN_FLAG_RQCP0
) || \

470 ((
FLAG
=
CAN_FLAG_FF0
|| ((FLAG=
CAN_FLAG_FOV0
) ||\

471 ((
FLAG
=
CAN_FLAG_FF1
|| ((FLAG=
CAN_FLAG_FOV1
) || \

472 ((
FLAG
=
CAN_FLAG_WKU
|| ((FLAG=
CAN_FLAG_SLAK
))

	)

484 
	#CAN_IT_TME
 ((
ut32_t
)0x00000001

	)

487 
	#CAN_IT_FMP0
 ((
ut32_t
)0x00000002

	)

488 
	#CAN_IT_FF0
 ((
ut32_t
)0x00000004

	)

489 
	#CAN_IT_FOV0
 ((
ut32_t
)0x00000008

	)

490 
	#CAN_IT_FMP1
 ((
ut32_t
)0x00000010

	)

491 
	#CAN_IT_FF1
 ((
ut32_t
)0x00000020

	)

492 
	#CAN_IT_FOV1
 ((
ut32_t
)0x00000040

	)

495 
	#CAN_IT_WKU
 ((
ut32_t
)0x00010000

	)

496 
	#CAN_IT_SLK
 ((
ut32_t
)0x00020000

	)

499 
	#CAN_IT_EWG
 ((
ut32_t
)0x00000100

	)

500 
	#CAN_IT_EPV
 ((
ut32_t
)0x00000200

	)

501 
	#CAN_IT_BOF
 ((
ut32_t
)0x00000400

	)

502 
	#CAN_IT_LEC
 ((
ut32_t
)0x00000800

	)

503 
	#CAN_IT_ERR
 ((
ut32_t
)0x00008000

	)

506 
	#CAN_IT_RQCP0
 
CAN_IT_TME


	)

507 
	#CAN_IT_RQCP1
 
CAN_IT_TME


	)

508 
	#CAN_IT_RQCP2
 
CAN_IT_TME


	)

511 
	#IS_CAN_IT
(
IT
(((IT=
CAN_IT_TME
|| ((IT=
CAN_IT_FMP0
) ||\

512 ((
IT
=
CAN_IT_FF0
|| ((IT=
CAN_IT_FOV0
) ||\

513 ((
IT
=
CAN_IT_FMP1
|| ((IT=
CAN_IT_FF1
) ||\

514 ((
IT
=
CAN_IT_FOV1
|| ((IT=
CAN_IT_EWG
) ||\

515 ((
IT
=
CAN_IT_EPV
|| ((IT=
CAN_IT_BOF
) ||\

516 ((
IT
=
CAN_IT_LEC
|| ((IT=
CAN_IT_ERR
) ||\

517 ((
IT
=
CAN_IT_WKU
|| ((IT=
CAN_IT_SLK
))

	)

519 
	#IS_CAN_CLEAR_IT
(
IT
(((IT=
CAN_IT_TME
|| ((IT=
CAN_IT_FF0
) ||\

520 ((
IT
=
CAN_IT_FOV0
|| ((IT=
CAN_IT_FF1
) ||\

521 ((
IT
=
CAN_IT_FOV1
|| ((IT=
CAN_IT_EWG
) ||\

522 ((
IT
=
CAN_IT_EPV
|| ((IT=
CAN_IT_BOF
) ||\

523 ((
IT
=
CAN_IT_LEC
|| ((IT=
CAN_IT_ERR
) ||\

524 ((
IT
=
CAN_IT_WKU
|| ((IT=
CAN_IT_SLK
))

	)

546 
CAN_DeIn
(
CAN_TyDef
* 
CANx
);

547 
ut8_t
 
CAN_In
(
CAN_TyDef
* 
CANx
, 
CAN_InTyDef
* 
CAN_InSu
);

548 
CAN_FrIn
(
CAN_FrInTyDef
* 
CAN_FrInSu
);

549 
CAN_SuIn
(
CAN_InTyDef
* 
CAN_InSu
);

550 
CAN_SveSBk
(
ut8_t
 
CAN_BkNumb
);

551 
CAN_ITCfig
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_IT
, 
FuniڮS
 
NewS
);

552 
ut8_t
 
CAN_Tnsm
(
CAN_TyDef
* 
CANx
, 
CTxMsg
* 
TxMesge
);

553 
ut8_t
 
CAN_TnsmStus
(
CAN_TyDef
* 
CANx
, ut8_
TnsmMabox
);

554 
CAN_ClTnsm
(
CAN_TyDef
* 
CANx
, 
ut8_t
 
Mabox
);

555 
CAN_FIFOR
(
CAN_TyDef
* 
CANx
, 
ut8_t
 
FIFONumb
);

556 
ut8_t
 
CAN_MesgePdg
(
CAN_TyDef
* 
CANx
, ut8_
FIFONumb
);

557 
CAN_Reive
(
CAN_TyDef
* 
CANx
, 
ut8_t
 
FIFONumb
, 
CRxMsg
* 
RxMesge
);

558 
CAN_DBGFeze
(
CAN_TyDef
* 
CANx
, 
FuniڮS
 
NewS
);

559 
ut8_t
 
CAN_S˕
(
CAN_TyDef
* 
CANx
);

560 
ut8_t
 
CAN_WakeUp
(
CAN_TyDef
* 
CANx
);

561 
FgStus
 
CAN_GFgStus
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_FLAG
);

562 
CAN_CˬFg
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_FLAG
);

563 
ITStus
 
CAN_GITStus
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_IT
);

564 
CAN_CˬITPdgB
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_IT
);

566 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_cec.h

23 #ide
__STM32F10x_CEC_H


24 
	#__STM32F10x_CEC_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
ut16_t
 
CEC_BTimgMode
;

53 
ut16_t
 
CEC_BPiodMode
;

55 }
	tCEC_InTyDef
;

68 
	#CEC_BTimgStdMode
 ((
ut16_t
)0x00

	)

69 
	#CEC_BTimgEFeMode
 
CEC_CFGR_BTEM


	)

71 
	#IS_CEC_BIT_TIMING_ERROR_MODE
(
MODE
(((MODE=
CEC_BTimgStdMode
) || \

72 ((
MODE
=
CEC_BTimgEFeMode
))

	)

80 
	#CEC_BPiodStdMode
 ((
ut16_t
)0x00

	)

81 
	#CEC_BPiodFxibMode
 
CEC_CFGR_BPEM


	)

83 
	#IS_CEC_BIT_PERIOD_ERROR_MODE
(
MODE
(((MODE=
CEC_BPiodStdMode
) || \

84 ((
MODE
=
CEC_BPiodFxibMode
))

	)

93 
	#CEC_IT_TERR
 
CEC_CSR_TERR


	)

94 
	#CEC_IT_TBTRF
 
CEC_CSR_TBTRF


	)

95 
	#CEC_IT_RERR
 
CEC_CSR_RERR


	)

96 
	#CEC_IT_RBTF
 
CEC_CSR_RBTF


	)

97 
	#IS_CEC_GET_IT
(
IT
(((IT=
CEC_IT_TERR
|| ((IT=
CEC_IT_TBTRF
) || \

98 ((
IT
=
CEC_IT_RERR
|| ((IT=
CEC_IT_RBTF
))

	)

107 
	#IS_CEC_ADDRESS
(
ADDRESS
((ADDRESS< 0x10)

	)

115 
	#IS_CEC_PRESCALER
(
PRESCALER
((PRESCALER<0x3FFF)

	)

128 
	#CEC_FLAG_BTE
 ((
ut32_t
)0x10010000)

	)

129 
	#CEC_FLAG_BPE
 ((
ut32_t
)0x10020000)

	)

130 
	#CEC_FLAG_RBTFE
 ((
ut32_t
)0x10040000)

	)

131 
	#CEC_FLAG_SBE
 ((
ut32_t
)0x10080000)

	)

132 
	#CEC_FLAG_ACKE
 ((
ut32_t
)0x10100000)

	)

133 
	#CEC_FLAG_LINE
 ((
ut32_t
)0x10200000)

	)

134 
	#CEC_FLAG_TBTFE
 ((
ut32_t
)0x10400000)

	)

139 
	#CEC_FLAG_TEOM
 ((
ut32_t
)0x00000002)

	)

140 
	#CEC_FLAG_TERR
 ((
ut32_t
)0x00000004)

	)

141 
	#CEC_FLAG_TBTRF
 ((
ut32_t
)0x00000008)

	)

142 
	#CEC_FLAG_RSOM
 ((
ut32_t
)0x00000010)

	)

143 
	#CEC_FLAG_REOM
 ((
ut32_t
)0x00000020)

	)

144 
	#CEC_FLAG_RERR
 ((
ut32_t
)0x00000040)

	)

145 
	#CEC_FLAG_RBTF
 ((
ut32_t
)0x00000080)

	)

147 
	#IS_CEC_CLEAR_FLAG
(
FLAG
((((FLAG& (
ut32_t
)0xFFFFFF03=0x00&& ((FLAG!0x00))

	)

149 
	#IS_CEC_GET_FLAG
(
FLAG
(((FLAG=
CEC_FLAG_BTE
|| ((FLAG=
CEC_FLAG_BPE
) || \

150 ((
FLAG
=
CEC_FLAG_RBTFE
|| ((FLAG)=
CEC_FLAG_SBE
) || \

151 ((
FLAG
=
CEC_FLAG_ACKE
|| ((FLAG=
CEC_FLAG_LINE
) || \

152 ((
FLAG
=
CEC_FLAG_TBTFE
|| ((FLAG=
CEC_FLAG_TEOM
) || \

153 ((
FLAG
=
CEC_FLAG_TERR
|| ((FLAG=
CEC_FLAG_TBTRF
) || \

154 ((
FLAG
=
CEC_FLAG_RSOM
|| ((FLAG=
CEC_FLAG_REOM
) || \

155 ((
FLAG
=
CEC_FLAG_RERR
|| ((FLAG=
CEC_FLAG_RBTF
))

	)

176 
CEC_DeIn
();

177 
CEC_In
(
CEC_InTyDef
* 
CEC_InSu
);

178 
CEC_Cmd
(
FuniڮS
 
NewS
);

179 
CEC_ITCfig
(
FuniڮS
 
NewS
);

180 
CEC_OwnAddssCfig
(
ut8_t
 
CEC_OwnAddss
);

181 
CEC_SPsr
(
ut16_t
 
CEC_Psr
);

182 
CEC_SdDaBy
(
ut8_t
 
Da
);

183 
ut8_t
 
CEC_ReiveDaBy
();

184 
CEC_SOfMesge
();

185 
CEC_EndOfMesgeCmd
(
FuniڮS
 
NewS
);

186 
FgStus
 
CEC_GFgStus
(
ut32_t
 
CEC_FLAG
);

187 
CEC_CˬFg
(
ut32_t
 
CEC_FLAG
);

188 
ITStus
 
CEC_GITStus
(
ut8_t
 
CEC_IT
);

189 
CEC_CˬITPdgB
(
ut16_t
 
CEC_IT
);

191 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_crc.h

23 #ide
__STM32F10x_CRC_H


24 
	#__STM32F10x_CRC_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

69 
CRC_RetDR
();

70 
ut32_t
 
CRC_CcCRC
(ut32_
Da
);

71 
ut32_t
 
CRC_CcBlockCRC
(ut32_
pBufr
[], ut32_
BufrLgth
);

72 
ut32_t
 
CRC_GCRC
();

73 
CRC_SIDRegi
(
ut8_t
 
IDVue
);

74 
ut8_t
 
CRC_GIDRegi
();

76 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_dac.h

23 #ide
__STM32F10x_DAC_H


24 
	#__STM32F10x_DAC_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
ut32_t
 
DAC_Trigg
;

54 
ut32_t
 
DAC_WaveGi
;

58 
ut32_t
 
DAC_LFSRUnmask_TrngAmude
;

62 
ut32_t
 
DAC_OuutBufr
;

64 }
	tDAC_InTyDef
;

78 
	#DAC_Trigg_Ne
 ((
ut32_t
)0x00000000

	)

80 
	#DAC_Trigg_T6_TRGO
 ((
ut32_t
)0x00000004

	)

81 
	#DAC_Trigg_T8_TRGO
 ((
ut32_t
)0x0000000C

	)

83 
	#DAC_Trigg_T3_TRGO
 ((
ut32_t
)0x0000000C

	)

85 
	#DAC_Trigg_T7_TRGO
 ((
ut32_t
)0x00000014

	)

86 
	#DAC_Trigg_T5_TRGO
 ((
ut32_t
)0x0000001C

	)

87 
	#DAC_Trigg_T15_TRGO
 ((
ut32_t
)0x0000001C

	)

89 
	#DAC_Trigg_T2_TRGO
 ((
ut32_t
)0x00000024

	)

90 
	#DAC_Trigg_T4_TRGO
 ((
ut32_t
)0x0000002C

	)

91 
	#DAC_Trigg_Ext_IT9
 ((
ut32_t
)0x00000034

	)

92 
	#DAC_Trigg_Sowe
 ((
ut32_t
)0x0000003C

	)

94 
	#IS_DAC_TRIGGER
(
TRIGGER
(((TRIGGER=
DAC_Trigg_Ne
) || \

95 ((
TRIGGER
=
DAC_Trigg_T6_TRGO
) || \

96 ((
TRIGGER
=
DAC_Trigg_T8_TRGO
) || \

97 ((
TRIGGER
=
DAC_Trigg_T7_TRGO
) || \

98 ((
TRIGGER
=
DAC_Trigg_T5_TRGO
) || \

99 ((
TRIGGER
=
DAC_Trigg_T2_TRGO
) || \

100 ((
TRIGGER
=
DAC_Trigg_T4_TRGO
) || \

101 ((
TRIGGER
=
DAC_Trigg_Ext_IT9
) || \

102 ((
TRIGGER
=
DAC_Trigg_Sowe
))

	)

112 
	#DAC_WaveGi_Ne
 ((
ut32_t
)0x00000000)

	)

113 
	#DAC_WaveGi_Noi
 ((
ut32_t
)0x00000040)

	)

114 
	#DAC_WaveGi_Trng
 ((
ut32_t
)0x00000080)

	)

115 
	#IS_DAC_GENERATE_WAVE
(
WAVE
(((WAVE=
DAC_WaveGi_Ne
) || \

116 ((
WAVE
=
DAC_WaveGi_Noi
) || \

117 ((
WAVE
=
DAC_WaveGi_Trng
))

	)

126 
	#DAC_LFSRUnmask_B0
 ((
ut32_t
)0x00000000

	)

127 
	#DAC_LFSRUnmask_Bs1_0
 ((
ut32_t
)0x00000100

	)

128 
	#DAC_LFSRUnmask_Bs2_0
 ((
ut32_t
)0x00000200

	)

129 
	#DAC_LFSRUnmask_Bs3_0
 ((
ut32_t
)0x00000300

	)

130 
	#DAC_LFSRUnmask_Bs4_0
 ((
ut32_t
)0x00000400

	)

131 
	#DAC_LFSRUnmask_Bs5_0
 ((
ut32_t
)0x00000500

	)

132 
	#DAC_LFSRUnmask_Bs6_0
 ((
ut32_t
)0x00000600

	)

133 
	#DAC_LFSRUnmask_Bs7_0
 ((
ut32_t
)0x00000700

	)

134 
	#DAC_LFSRUnmask_Bs8_0
 ((
ut32_t
)0x00000800

	)

135 
	#DAC_LFSRUnmask_Bs9_0
 ((
ut32_t
)0x00000900

	)

136 
	#DAC_LFSRUnmask_Bs10_0
 ((
ut32_t
)0x00000A00

	)

137 
	#DAC_LFSRUnmask_Bs11_0
 ((
ut32_t
)0x00000B00

	)

138 
	#DAC_TrngAmude_1
 ((
ut32_t
)0x00000000

	)

139 
	#DAC_TrngAmude_3
 ((
ut32_t
)0x00000100

	)

140 
	#DAC_TrngAmude_7
 ((
ut32_t
)0x00000200

	)

141 
	#DAC_TrngAmude_15
 ((
ut32_t
)0x00000300

	)

142 
	#DAC_TrngAmude_31
 ((
ut32_t
)0x00000400

	)

143 
	#DAC_TrngAmude_63
 ((
ut32_t
)0x00000500

	)

144 
	#DAC_TrngAmude_127
 ((
ut32_t
)0x00000600

	)

145 
	#DAC_TrngAmude_255
 ((
ut32_t
)0x00000700

	)

146 
	#DAC_TrngAmude_511
 ((
ut32_t
)0x00000800

	)

147 
	#DAC_TrngAmude_1023
 ((
ut32_t
)0x00000900

	)

148 
	#DAC_TrngAmude_2047
 ((
ut32_t
)0x00000A00

	)

149 
	#DAC_TrngAmude_4095
 ((
ut32_t
)0x00000B00

	)

151 
	#IS_DAC_LFSR_UNMASK_TRIANGLE_AMPLITUDE
(
VALUE
(((VALUE=
DAC_LFSRUnmask_B0
) || \

152 ((
VALUE
=
DAC_LFSRUnmask_Bs1_0
) || \

153 ((
VALUE
=
DAC_LFSRUnmask_Bs2_0
) || \

154 ((
VALUE
=
DAC_LFSRUnmask_Bs3_0
) || \

155 ((
VALUE
=
DAC_LFSRUnmask_Bs4_0
) || \

156 ((
VALUE
=
DAC_LFSRUnmask_Bs5_0
) || \

157 ((
VALUE
=
DAC_LFSRUnmask_Bs6_0
) || \

158 ((
VALUE
=
DAC_LFSRUnmask_Bs7_0
) || \

159 ((
VALUE
=
DAC_LFSRUnmask_Bs8_0
) || \

160 ((
VALUE
=
DAC_LFSRUnmask_Bs9_0
) || \

161 ((
VALUE
=
DAC_LFSRUnmask_Bs10_0
) || \

162 ((
VALUE
=
DAC_LFSRUnmask_Bs11_0
) || \

163 ((
VALUE
=
DAC_TrngAmude_1
) || \

164 ((
VALUE
=
DAC_TrngAmude_3
) || \

165 ((
VALUE
=
DAC_TrngAmude_7
) || \

166 ((
VALUE
=
DAC_TrngAmude_15
) || \

167 ((
VALUE
=
DAC_TrngAmude_31
) || \

168 ((
VALUE
=
DAC_TrngAmude_63
) || \

169 ((
VALUE
=
DAC_TrngAmude_127
) || \

170 ((
VALUE
=
DAC_TrngAmude_255
) || \

171 ((
VALUE
=
DAC_TrngAmude_511
) || \

172 ((
VALUE
=
DAC_TrngAmude_1023
) || \

173 ((
VALUE
=
DAC_TrngAmude_2047
) || \

174 ((
VALUE
=
DAC_TrngAmude_4095
))

	)

183 
	#DAC_OuutBufr_Eb
 ((
ut32_t
)0x00000000)

	)

184 
	#DAC_OuutBufr_Dib
 ((
ut32_t
)0x00000002)

	)

185 
	#IS_DAC_OUTPUT_BUFFER_STATE
(
STATE
(((STATE=
DAC_OuutBufr_Eb
) || \

186 ((
STATE
=
DAC_OuutBufr_Dib
))

	)

195 
	#DAC_Chl_1
 ((
ut32_t
)0x00000000)

	)

196 
	#DAC_Chl_2
 ((
ut32_t
)0x00000010)

	)

197 
	#IS_DAC_CHANNEL
(
CHANNEL
(((CHANNEL=
DAC_Chl_1
) || \

198 ((
CHANNEL
=
DAC_Chl_2
))

	)

207 
	#DAC_Align_12b_R
 ((
ut32_t
)0x00000000)

	)

208 
	#DAC_Align_12b_L
 ((
ut32_t
)0x00000004)

	)

209 
	#DAC_Align_8b_R
 ((
ut32_t
)0x00000008)

	)

210 
	#IS_DAC_ALIGN
(
ALIGN
(((ALIGN=
DAC_Align_12b_R
) || \

211 ((
ALIGN
=
DAC_Align_12b_L
) || \

212 ((
ALIGN
=
DAC_Align_8b_R
))

	)

221 
	#DAC_Wave_Noi
 ((
ut32_t
)0x00000040)

	)

222 
	#DAC_Wave_Trng
 ((
ut32_t
)0x00000080)

	)

223 
	#IS_DAC_WAVE
(
WAVE
(((WAVE=
DAC_Wave_Noi
) || \

224 ((
WAVE
=
DAC_Wave_Trng
))

	)

233 
	#IS_DAC_DATA
(
DATA
((DATA<0xFFF0)

	)

237 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

242 
	#DAC_IT_DMAUDR
 ((
ut32_t
)0x00002000)

	)

243 
	#IS_DAC_IT
(
IT
(((IT=
DAC_IT_DMAUDR
))

	)

253 
	#DAC_FLAG_DMAUDR
 ((
ut32_t
)0x00002000)

	)

254 
	#IS_DAC_FLAG
(
FLAG
(((FLAG=
DAC_FLAG_DMAUDR
))

	)

277 
DAC_DeIn
();

278 
DAC_In
(
ut32_t
 
DAC_Chl
, 
DAC_InTyDef
* 
DAC_InSu
);

279 
DAC_SuIn
(
DAC_InTyDef
* 
DAC_InSu
);

280 
DAC_Cmd
(
ut32_t
 
DAC_Chl
, 
FuniڮS
 
NewS
);

281 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

282 
DAC_ITCfig
(
ut32_t
 
DAC_Chl
, ut32_
DAC_IT
, 
FuniڮS
 
NewS
);

284 
DAC_DMACmd
(
ut32_t
 
DAC_Chl
, 
FuniڮS
 
NewS
);

285 
DAC_SoweTriggCmd
(
ut32_t
 
DAC_Chl
, 
FuniڮS
 
NewS
);

286 
DAC_DuSoweTriggCmd
(
FuniڮS
 
NewS
);

287 
DAC_WaveGiCmd
(
ut32_t
 
DAC_Chl
, ut32_
DAC_Wave
, 
FuniڮS
 
NewS
);

288 
DAC_SChl1Da
(
ut32_t
 
DAC_Align
, 
ut16_t
 
Da
);

289 
DAC_SChl2Da
(
ut32_t
 
DAC_Align
, 
ut16_t
 
Da
);

290 
DAC_SDuChlDa
(
ut32_t
 
DAC_Align
, 
ut16_t
 
Da2
, ut16_
Da1
);

291 
ut16_t
 
DAC_GDaOuutVue
(
ut32_t
 
DAC_Chl
);

292 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

293 
FgStus
 
DAC_GFgStus
(
ut32_t
 
DAC_Chl
, ut32_
DAC_FLAG
);

294 
DAC_CˬFg
(
ut32_t
 
DAC_Chl
, ut32_
DAC_FLAG
);

295 
ITStus
 
DAC_GITStus
(
ut32_t
 
DAC_Chl
, ut32_
DAC_IT
);

296 
DAC_CˬITPdgB
(
ut32_t
 
DAC_Chl
, ut32_
DAC_IT
);

299 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_dbgmcu.h

23 #ide
__STM32F10x_DBGMCU_H


24 
	#__STM32F10x_DBGMCU_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

53 
	#DBGMCU_SLEEP
 ((
ut32_t
)0x00000001)

	)

54 
	#DBGMCU_STOP
 ((
ut32_t
)0x00000002)

	)

55 
	#DBGMCU_STANDBY
 ((
ut32_t
)0x00000004)

	)

56 
	#DBGMCU_IWDG_STOP
 ((
ut32_t
)0x00000100)

	)

57 
	#DBGMCU_WWDG_STOP
 ((
ut32_t
)0x00000200)

	)

58 
	#DBGMCU_TIM1_STOP
 ((
ut32_t
)0x00000400)

	)

59 
	#DBGMCU_TIM2_STOP
 ((
ut32_t
)0x00000800)

	)

60 
	#DBGMCU_TIM3_STOP
 ((
ut32_t
)0x00001000)

	)

61 
	#DBGMCU_TIM4_STOP
 ((
ut32_t
)0x00002000)

	)

62 
	#DBGMCU_CAN1_STOP
 ((
ut32_t
)0x00004000)

	)

63 
	#DBGMCU_I2C1_SMBUS_TIMEOUT
 ((
ut32_t
)0x00008000)

	)

64 
	#DBGMCU_I2C2_SMBUS_TIMEOUT
 ((
ut32_t
)0x00010000)

	)

65 
	#DBGMCU_TIM8_STOP
 ((
ut32_t
)0x00020000)

	)

66 
	#DBGMCU_TIM5_STOP
 ((
ut32_t
)0x00040000)

	)

67 
	#DBGMCU_TIM6_STOP
 ((
ut32_t
)0x00080000)

	)

68 
	#DBGMCU_TIM7_STOP
 ((
ut32_t
)0x00100000)

	)

69 
	#DBGMCU_CAN2_STOP
 ((
ut32_t
)0x00200000)

	)

70 
	#DBGMCU_TIM15_STOP
 ((
ut32_t
)0x00400000)

	)

71 
	#DBGMCU_TIM16_STOP
 ((
ut32_t
)0x00800000)

	)

72 
	#DBGMCU_TIM17_STOP
 ((
ut32_t
)0x01000000)

	)

73 
	#DBGMCU_TIM12_STOP
 ((
ut32_t
)0x02000000)

	)

74 
	#DBGMCU_TIM13_STOP
 ((
ut32_t
)0x04000000)

	)

75 
	#DBGMCU_TIM14_STOP
 ((
ut32_t
)0x08000000)

	)

76 
	#DBGMCU_TIM9_STOP
 ((
ut32_t
)0x10000000)

	)

77 
	#DBGMCU_TIM10_STOP
 ((
ut32_t
)0x20000000)

	)

78 
	#DBGMCU_TIM11_STOP
 ((
ut32_t
)0x40000000)

	)

80 
	#IS_DBGMCU_PERIPH
(
PERIPH
((((PERIPH& 0x800000F8=0x00&& ((PERIPH!0x00))

	)

97 
ut32_t
 
DBGMCU_GREVID
();

98 
ut32_t
 
DBGMCU_GDEVID
();

99 
DBGMCU_Cfig
(
ut32_t
 
DBGMCU_Ph
, 
FuniڮS
 
NewS
);

101 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_dma.h

23 #ide
__STM32F10x_DMA_H


24 
	#__STM32F10x_DMA_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
ut32_t
 
DMA_PhBaAddr
;

53 
ut32_t
 
DMA_MemyBaAddr
;

55 
ut32_t
 
DMA_DIR
;

58 
ut32_t
 
DMA_BufrSize
;

62 
ut32_t
 
DMA_PhInc
;

65 
ut32_t
 
DMA_MemyInc
;

68 
ut32_t
 
DMA_PhDaSize
;

71 
ut32_t
 
DMA_MemyDaSize
;

74 
ut32_t
 
DMA_Mode
;

79 
ut32_t
 
DMA_Priܙy
;

82 
ut32_t
 
DMA_M2M
;

84 }
	tDMA_InTyDef
;

94 
	#IS_DMA_ALL_PERIPH
(
PERIPH
(((PERIPH=
DMA1_Chl1
) || \

95 ((
PERIPH
=
DMA1_Chl2
) || \

96 ((
PERIPH
=
DMA1_Chl3
) || \

97 ((
PERIPH
=
DMA1_Chl4
) || \

98 ((
PERIPH
=
DMA1_Chl5
) || \

99 ((
PERIPH
=
DMA1_Chl6
) || \

100 ((
PERIPH
=
DMA1_Chl7
) || \

101 ((
PERIPH
=
DMA2_Chl1
) || \

102 ((
PERIPH
=
DMA2_Chl2
) || \

103 ((
PERIPH
=
DMA2_Chl3
) || \

104 ((
PERIPH
=
DMA2_Chl4
) || \

105 ((
PERIPH
=
DMA2_Chl5
))

	)

111 
	#DMA_DIR_PhDST
 ((
ut32_t
)0x00000010)

	)

112 
	#DMA_DIR_PhSRC
 ((
ut32_t
)0x00000000)

	)

113 
	#IS_DMA_DIR
(
DIR
(((DIR=
DMA_DIR_PhDST
) || \

114 ((
DIR
=
DMA_DIR_PhSRC
))

	)

123 
	#DMA_PhInc_Eb
 ((
ut32_t
)0x00000040)

	)

124 
	#DMA_PhInc_Dib
 ((
ut32_t
)0x00000000)

	)

125 
	#IS_DMA_PERIPHERAL_INC_STATE
(
STATE
(((STATE=
DMA_PhInc_Eb
) || \

126 ((
STATE
=
DMA_PhInc_Dib
))

	)

135 
	#DMA_MemyInc_Eb
 ((
ut32_t
)0x00000080)

	)

136 
	#DMA_MemyInc_Dib
 ((
ut32_t
)0x00000000)

	)

137 
	#IS_DMA_MEMORY_INC_STATE
(
STATE
(((STATE=
DMA_MemyInc_Eb
) || \

138 ((
STATE
=
DMA_MemyInc_Dib
))

	)

147 
	#DMA_PhDaSize_By
 ((
ut32_t
)0x00000000)

	)

148 
	#DMA_PhDaSize_HfWd
 ((
ut32_t
)0x00000100)

	)

149 
	#DMA_PhDaSize_Wd
 ((
ut32_t
)0x00000200)

	)

150 
	#IS_DMA_PERIPHERAL_DATA_SIZE
(
SIZE
(((SIZE=
DMA_PhDaSize_By
) || \

151 ((
SIZE
=
DMA_PhDaSize_HfWd
) || \

152 ((
SIZE
=
DMA_PhDaSize_Wd
))

	)

161 
	#DMA_MemyDaSize_By
 ((
ut32_t
)0x00000000)

	)

162 
	#DMA_MemyDaSize_HfWd
 ((
ut32_t
)0x00000400)

	)

163 
	#DMA_MemyDaSize_Wd
 ((
ut32_t
)0x00000800)

	)

164 
	#IS_DMA_MEMORY_DATA_SIZE
(
SIZE
(((SIZE=
DMA_MemyDaSize_By
) || \

165 ((
SIZE
=
DMA_MemyDaSize_HfWd
) || \

166 ((
SIZE
=
DMA_MemyDaSize_Wd
))

	)

175 
	#DMA_Mode_Ccur
 ((
ut32_t
)0x00000020)

	)

176 
	#DMA_Mode_Nm
 ((
ut32_t
)0x00000000)

	)

177 
	#IS_DMA_MODE
(
MODE
(((MODE=
DMA_Mode_Ccur
|| ((MODE=
DMA_Mode_Nm
))

	)

186 
	#DMA_Priܙy_VyHigh
 ((
ut32_t
)0x00003000)

	)

187 
	#DMA_Priܙy_High
 ((
ut32_t
)0x00002000)

	)

188 
	#DMA_Priܙy_Medium
 ((
ut32_t
)0x00001000)

	)

189 
	#DMA_Priܙy_Low
 ((
ut32_t
)0x00000000)

	)

190 
	#IS_DMA_PRIORITY
(
PRIORITY
(((PRIORITY=
DMA_Priܙy_VyHigh
) || \

191 ((
PRIORITY
=
DMA_Priܙy_High
) || \

192 ((
PRIORITY
=
DMA_Priܙy_Medium
) || \

193 ((
PRIORITY
=
DMA_Priܙy_Low
))

	)

202 
	#DMA_M2M_Eb
 ((
ut32_t
)0x00004000)

	)

203 
	#DMA_M2M_Dib
 ((
ut32_t
)0x00000000)

	)

204 
	#IS_DMA_M2M_STATE
(
STATE
(((STATE=
DMA_M2M_Eb
|| ((STATE=
DMA_M2M_Dib
))

	)

214 
	#DMA_IT_TC
 ((
ut32_t
)0x00000002)

	)

215 
	#DMA_IT_HT
 ((
ut32_t
)0x00000004)

	)

216 
	#DMA_IT_TE
 ((
ut32_t
)0x00000008)

	)

217 
	#IS_DMA_CONFIG_IT
(
IT
((((IT& 0xFFFFFFF1=0x00&& ((IT!0x00))

	)

219 
	#DMA1_IT_GL1
 ((
ut32_t
)0x00000001)

	)

220 
	#DMA1_IT_TC1
 ((
ut32_t
)0x00000002)

	)

221 
	#DMA1_IT_HT1
 ((
ut32_t
)0x00000004)

	)

222 
	#DMA1_IT_TE1
 ((
ut32_t
)0x00000008)

	)

223 
	#DMA1_IT_GL2
 ((
ut32_t
)0x00000010)

	)

224 
	#DMA1_IT_TC2
 ((
ut32_t
)0x00000020)

	)

225 
	#DMA1_IT_HT2
 ((
ut32_t
)0x00000040)

	)

226 
	#DMA1_IT_TE2
 ((
ut32_t
)0x00000080)

	)

227 
	#DMA1_IT_GL3
 ((
ut32_t
)0x00000100)

	)

228 
	#DMA1_IT_TC3
 ((
ut32_t
)0x00000200)

	)

229 
	#DMA1_IT_HT3
 ((
ut32_t
)0x00000400)

	)

230 
	#DMA1_IT_TE3
 ((
ut32_t
)0x00000800)

	)

231 
	#DMA1_IT_GL4
 ((
ut32_t
)0x00001000)

	)

232 
	#DMA1_IT_TC4
 ((
ut32_t
)0x00002000)

	)

233 
	#DMA1_IT_HT4
 ((
ut32_t
)0x00004000)

	)

234 
	#DMA1_IT_TE4
 ((
ut32_t
)0x00008000)

	)

235 
	#DMA1_IT_GL5
 ((
ut32_t
)0x00010000)

	)

236 
	#DMA1_IT_TC5
 ((
ut32_t
)0x00020000)

	)

237 
	#DMA1_IT_HT5
 ((
ut32_t
)0x00040000)

	)

238 
	#DMA1_IT_TE5
 ((
ut32_t
)0x00080000)

	)

239 
	#DMA1_IT_GL6
 ((
ut32_t
)0x00100000)

	)

240 
	#DMA1_IT_TC6
 ((
ut32_t
)0x00200000)

	)

241 
	#DMA1_IT_HT6
 ((
ut32_t
)0x00400000)

	)

242 
	#DMA1_IT_TE6
 ((
ut32_t
)0x00800000)

	)

243 
	#DMA1_IT_GL7
 ((
ut32_t
)0x01000000)

	)

244 
	#DMA1_IT_TC7
 ((
ut32_t
)0x02000000)

	)

245 
	#DMA1_IT_HT7
 ((
ut32_t
)0x04000000)

	)

246 
	#DMA1_IT_TE7
 ((
ut32_t
)0x08000000)

	)

248 
	#DMA2_IT_GL1
 ((
ut32_t
)0x10000001)

	)

249 
	#DMA2_IT_TC1
 ((
ut32_t
)0x10000002)

	)

250 
	#DMA2_IT_HT1
 ((
ut32_t
)0x10000004)

	)

251 
	#DMA2_IT_TE1
 ((
ut32_t
)0x10000008)

	)

252 
	#DMA2_IT_GL2
 ((
ut32_t
)0x10000010)

	)

253 
	#DMA2_IT_TC2
 ((
ut32_t
)0x10000020)

	)

254 
	#DMA2_IT_HT2
 ((
ut32_t
)0x10000040)

	)

255 
	#DMA2_IT_TE2
 ((
ut32_t
)0x10000080)

	)

256 
	#DMA2_IT_GL3
 ((
ut32_t
)0x10000100)

	)

257 
	#DMA2_IT_TC3
 ((
ut32_t
)0x10000200)

	)

258 
	#DMA2_IT_HT3
 ((
ut32_t
)0x10000400)

	)

259 
	#DMA2_IT_TE3
 ((
ut32_t
)0x10000800)

	)

260 
	#DMA2_IT_GL4
 ((
ut32_t
)0x10001000)

	)

261 
	#DMA2_IT_TC4
 ((
ut32_t
)0x10002000)

	)

262 
	#DMA2_IT_HT4
 ((
ut32_t
)0x10004000)

	)

263 
	#DMA2_IT_TE4
 ((
ut32_t
)0x10008000)

	)

264 
	#DMA2_IT_GL5
 ((
ut32_t
)0x10010000)

	)

265 
	#DMA2_IT_TC5
 ((
ut32_t
)0x10020000)

	)

266 
	#DMA2_IT_HT5
 ((
ut32_t
)0x10040000)

	)

267 
	#DMA2_IT_TE5
 ((
ut32_t
)0x10080000)

	)

269 
	#IS_DMA_CLEAR_IT
(
IT
(((((IT& 0xF0000000=0x00|| (((IT& 0xEFF00000=0x00)&& ((IT!0x00))

	)

271 
	#IS_DMA_GET_IT
(
IT
(((IT=
DMA1_IT_GL1
|| ((IT=
DMA1_IT_TC1
) || \

272 ((
IT
=
DMA1_IT_HT1
|| ((IT=
DMA1_IT_TE1
) || \

273 ((
IT
=
DMA1_IT_GL2
|| ((IT=
DMA1_IT_TC2
) || \

274 ((
IT
=
DMA1_IT_HT2
|| ((IT=
DMA1_IT_TE2
) || \

275 ((
IT
=
DMA1_IT_GL3
|| ((IT=
DMA1_IT_TC3
) || \

276 ((
IT
=
DMA1_IT_HT3
|| ((IT=
DMA1_IT_TE3
) || \

277 ((
IT
=
DMA1_IT_GL4
|| ((IT=
DMA1_IT_TC4
) || \

278 ((
IT
=
DMA1_IT_HT4
|| ((IT=
DMA1_IT_TE4
) || \

279 ((
IT
=
DMA1_IT_GL5
|| ((IT=
DMA1_IT_TC5
) || \

280 ((
IT
=
DMA1_IT_HT5
|| ((IT=
DMA1_IT_TE5
) || \

281 ((
IT
=
DMA1_IT_GL6
|| ((IT=
DMA1_IT_TC6
) || \

282 ((
IT
=
DMA1_IT_HT6
|| ((IT=
DMA1_IT_TE6
) || \

283 ((
IT
=
DMA1_IT_GL7
|| ((IT=
DMA1_IT_TC7
) || \

284 ((
IT
=
DMA1_IT_HT7
|| ((IT=
DMA1_IT_TE7
) || \

285 ((
IT
=
DMA2_IT_GL1
|| ((IT=
DMA2_IT_TC1
) || \

286 ((
IT
=
DMA2_IT_HT1
|| ((IT=
DMA2_IT_TE1
) || \

287 ((
IT
=
DMA2_IT_GL2
|| ((IT=
DMA2_IT_TC2
) || \

288 ((
IT
=
DMA2_IT_HT2
|| ((IT=
DMA2_IT_TE2
) || \

289 ((
IT
=
DMA2_IT_GL3
|| ((IT=
DMA2_IT_TC3
) || \

290 ((
IT
=
DMA2_IT_HT3
|| ((IT=
DMA2_IT_TE3
) || \

291 ((
IT
=
DMA2_IT_GL4
|| ((IT=
DMA2_IT_TC4
) || \

292 ((
IT
=
DMA2_IT_HT4
|| ((IT=
DMA2_IT_TE4
) || \

293 ((
IT
=
DMA2_IT_GL5
|| ((IT=
DMA2_IT_TC5
) || \

294 ((
IT
=
DMA2_IT_HT5
|| ((IT=
DMA2_IT_TE5
))

	)

303 
	#DMA1_FLAG_GL1
 ((
ut32_t
)0x00000001)

	)

304 
	#DMA1_FLAG_TC1
 ((
ut32_t
)0x00000002)

	)

305 
	#DMA1_FLAG_HT1
 ((
ut32_t
)0x00000004)

	)

306 
	#DMA1_FLAG_TE1
 ((
ut32_t
)0x00000008)

	)

307 
	#DMA1_FLAG_GL2
 ((
ut32_t
)0x00000010)

	)

308 
	#DMA1_FLAG_TC2
 ((
ut32_t
)0x00000020)

	)

309 
	#DMA1_FLAG_HT2
 ((
ut32_t
)0x00000040)

	)

310 
	#DMA1_FLAG_TE2
 ((
ut32_t
)0x00000080)

	)

311 
	#DMA1_FLAG_GL3
 ((
ut32_t
)0x00000100)

	)

312 
	#DMA1_FLAG_TC3
 ((
ut32_t
)0x00000200)

	)

313 
	#DMA1_FLAG_HT3
 ((
ut32_t
)0x00000400)

	)

314 
	#DMA1_FLAG_TE3
 ((
ut32_t
)0x00000800)

	)

315 
	#DMA1_FLAG_GL4
 ((
ut32_t
)0x00001000)

	)

316 
	#DMA1_FLAG_TC4
 ((
ut32_t
)0x00002000)

	)

317 
	#DMA1_FLAG_HT4
 ((
ut32_t
)0x00004000)

	)

318 
	#DMA1_FLAG_TE4
 ((
ut32_t
)0x00008000)

	)

319 
	#DMA1_FLAG_GL5
 ((
ut32_t
)0x00010000)

	)

320 
	#DMA1_FLAG_TC5
 ((
ut32_t
)0x00020000)

	)

321 
	#DMA1_FLAG_HT5
 ((
ut32_t
)0x00040000)

	)

322 
	#DMA1_FLAG_TE5
 ((
ut32_t
)0x00080000)

	)

323 
	#DMA1_FLAG_GL6
 ((
ut32_t
)0x00100000)

	)

324 
	#DMA1_FLAG_TC6
 ((
ut32_t
)0x00200000)

	)

325 
	#DMA1_FLAG_HT6
 ((
ut32_t
)0x00400000)

	)

326 
	#DMA1_FLAG_TE6
 ((
ut32_t
)0x00800000)

	)

327 
	#DMA1_FLAG_GL7
 ((
ut32_t
)0x01000000)

	)

328 
	#DMA1_FLAG_TC7
 ((
ut32_t
)0x02000000)

	)

329 
	#DMA1_FLAG_HT7
 ((
ut32_t
)0x04000000)

	)

330 
	#DMA1_FLAG_TE7
 ((
ut32_t
)0x08000000)

	)

332 
	#DMA2_FLAG_GL1
 ((
ut32_t
)0x10000001)

	)

333 
	#DMA2_FLAG_TC1
 ((
ut32_t
)0x10000002)

	)

334 
	#DMA2_FLAG_HT1
 ((
ut32_t
)0x10000004)

	)

335 
	#DMA2_FLAG_TE1
 ((
ut32_t
)0x10000008)

	)

336 
	#DMA2_FLAG_GL2
 ((
ut32_t
)0x10000010)

	)

337 
	#DMA2_FLAG_TC2
 ((
ut32_t
)0x10000020)

	)

338 
	#DMA2_FLAG_HT2
 ((
ut32_t
)0x10000040)

	)

339 
	#DMA2_FLAG_TE2
 ((
ut32_t
)0x10000080)

	)

340 
	#DMA2_FLAG_GL3
 ((
ut32_t
)0x10000100)

	)

341 
	#DMA2_FLAG_TC3
 ((
ut32_t
)0x10000200)

	)

342 
	#DMA2_FLAG_HT3
 ((
ut32_t
)0x10000400)

	)

343 
	#DMA2_FLAG_TE3
 ((
ut32_t
)0x10000800)

	)

344 
	#DMA2_FLAG_GL4
 ((
ut32_t
)0x10001000)

	)

345 
	#DMA2_FLAG_TC4
 ((
ut32_t
)0x10002000)

	)

346 
	#DMA2_FLAG_HT4
 ((
ut32_t
)0x10004000)

	)

347 
	#DMA2_FLAG_TE4
 ((
ut32_t
)0x10008000)

	)

348 
	#DMA2_FLAG_GL5
 ((
ut32_t
)0x10010000)

	)

349 
	#DMA2_FLAG_TC5
 ((
ut32_t
)0x10020000)

	)

350 
	#DMA2_FLAG_HT5
 ((
ut32_t
)0x10040000)

	)

351 
	#DMA2_FLAG_TE5
 ((
ut32_t
)0x10080000)

	)

353 
	#IS_DMA_CLEAR_FLAG
(
FLAG
(((((FLAG& 0xF0000000=0x00|| (((FLAG& 0xEFF00000=0x00)&& ((FLAG!0x00))

	)

355 
	#IS_DMA_GET_FLAG
(
FLAG
(((FLAG=
DMA1_FLAG_GL1
|| ((FLAG=
DMA1_FLAG_TC1
) || \

356 ((
FLAG
=
DMA1_FLAG_HT1
|| ((FLAG=
DMA1_FLAG_TE1
) || \

357 ((
FLAG
=
DMA1_FLAG_GL2
|| ((FLAG=
DMA1_FLAG_TC2
) || \

358 ((
FLAG
=
DMA1_FLAG_HT2
|| ((FLAG=
DMA1_FLAG_TE2
) || \

359 ((
FLAG
=
DMA1_FLAG_GL3
|| ((FLAG=
DMA1_FLAG_TC3
) || \

360 ((
FLAG
=
DMA1_FLAG_HT3
|| ((FLAG=
DMA1_FLAG_TE3
) || \

361 ((
FLAG
=
DMA1_FLAG_GL4
|| ((FLAG=
DMA1_FLAG_TC4
) || \

362 ((
FLAG
=
DMA1_FLAG_HT4
|| ((FLAG=
DMA1_FLAG_TE4
) || \

363 ((
FLAG
=
DMA1_FLAG_GL5
|| ((FLAG=
DMA1_FLAG_TC5
) || \

364 ((
FLAG
=
DMA1_FLAG_HT5
|| ((FLAG=
DMA1_FLAG_TE5
) || \

365 ((
FLAG
=
DMA1_FLAG_GL6
|| ((FLAG=
DMA1_FLAG_TC6
) || \

366 ((
FLAG
=
DMA1_FLAG_HT6
|| ((FLAG=
DMA1_FLAG_TE6
) || \

367 ((
FLAG
=
DMA1_FLAG_GL7
|| ((FLAG=
DMA1_FLAG_TC7
) || \

368 ((
FLAG
=
DMA1_FLAG_HT7
|| ((FLAG=
DMA1_FLAG_TE7
) || \

369 ((
FLAG
=
DMA2_FLAG_GL1
|| ((FLAG=
DMA2_FLAG_TC1
) || \

370 ((
FLAG
=
DMA2_FLAG_HT1
|| ((FLAG=
DMA2_FLAG_TE1
) || \

371 ((
FLAG
=
DMA2_FLAG_GL2
|| ((FLAG=
DMA2_FLAG_TC2
) || \

372 ((
FLAG
=
DMA2_FLAG_HT2
|| ((FLAG=
DMA2_FLAG_TE2
) || \

373 ((
FLAG
=
DMA2_FLAG_GL3
|| ((FLAG=
DMA2_FLAG_TC3
) || \

374 ((
FLAG
=
DMA2_FLAG_HT3
|| ((FLAG=
DMA2_FLAG_TE3
) || \

375 ((
FLAG
=
DMA2_FLAG_GL4
|| ((FLAG=
DMA2_FLAG_TC4
) || \

376 ((
FLAG
=
DMA2_FLAG_HT4
|| ((FLAG=
DMA2_FLAG_TE4
) || \

377 ((
FLAG
=
DMA2_FLAG_GL5
|| ((FLAG=
DMA2_FLAG_TC5
) || \

378 ((
FLAG
=
DMA2_FLAG_HT5
|| ((FLAG=
DMA2_FLAG_TE5
))

	)

387 
	#IS_DMA_BUFFER_SIZE
(
SIZE
(((SIZE>0x1&& ((SIZE< 0x10000))

	)

409 
DMA_DeIn
(
DMA_Chl_TyDef
* 
DMAy_Chlx
);

410 
DMA_In
(
DMA_Chl_TyDef
* 
DMAy_Chlx
, 
DMA_InTyDef
* 
DMA_InSu
);

411 
DMA_SuIn
(
DMA_InTyDef
* 
DMA_InSu
);

412 
DMA_Cmd
(
DMA_Chl_TyDef
* 
DMAy_Chlx
, 
FuniڮS
 
NewS
);

413 
DMA_ITCfig
(
DMA_Chl_TyDef
* 
DMAy_Chlx
, 
ut32_t
 
DMA_IT
, 
FuniڮS
 
NewS
);

414 
DMA_SCuDaCou
(
DMA_Chl_TyDef
* 
DMAy_Chlx
, 
ut16_t
 
DaNumb
);

415 
ut16_t
 
DMA_GCuDaCou
(
DMA_Chl_TyDef
* 
DMAy_Chlx
);

416 
FgStus
 
DMA_GFgStus
(
ut32_t
 
DMA_FLAG
);

417 
DMA_CˬFg
(
ut32_t
 
DMA_FLAG
);

418 
ITStus
 
DMA_GITStus
(
ut32_t
 
DMA_IT
);

419 
DMA_CˬITPdgB
(
ut32_t
 
DMA_IT
);

421 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_exti.h

23 #ide
__STM32F10x_EXTI_H


24 
	#__STM32F10x_EXTI_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
EXTI_Mode_Iru
 = 0x00,

52 
EXTI_Mode_Evt
 = 0x04

53 }
	tEXTIMode_TyDef
;

55 
	#IS_EXTI_MODE
(
MODE
(((MODE=
EXTI_Mode_Iru
|| ((MODE=
EXTI_Mode_Evt
))

	)

63 
EXTI_Trigg_Risg
 = 0x08,

64 
EXTI_Trigg_Flg
 = 0x0C,

65 
EXTI_Trigg_Risg_Flg
 = 0x10

66 }
	tEXTITrigg_TyDef
;

68 
	#IS_EXTI_TRIGGER
(
TRIGGER
(((TRIGGER=
EXTI_Trigg_Risg
) || \

69 ((
TRIGGER
=
EXTI_Trigg_Flg
) || \

70 ((
TRIGGER
=
EXTI_Trigg_Risg_Flg
))

	)

77 
ut32_t
 
EXTI_Le
;

80 
EXTIMode_TyDef
 
EXTI_Mode
;

83 
EXTITrigg_TyDef
 
EXTI_Trigg
;

86 
FuniڮS
 
EXTI_LeCmd
;

88 }
	tEXTI_InTyDef
;

102 
	#EXTI_Le0
 ((
ut32_t
)0x00001

	)

103 
	#EXTI_Le1
 ((
ut32_t
)0x00002

	)

104 
	#EXTI_Le2
 ((
ut32_t
)0x00004

	)

105 
	#EXTI_Le3
 ((
ut32_t
)0x00008

	)

106 
	#EXTI_Le4
 ((
ut32_t
)0x00010

	)

107 
	#EXTI_Le5
 ((
ut32_t
)0x00020

	)

108 
	#EXTI_Le6
 ((
ut32_t
)0x00040

	)

109 
	#EXTI_Le7
 ((
ut32_t
)0x00080

	)

110 
	#EXTI_Le8
 ((
ut32_t
)0x00100

	)

111 
	#EXTI_Le9
 ((
ut32_t
)0x00200

	)

112 
	#EXTI_Le10
 ((
ut32_t
)0x00400

	)

113 
	#EXTI_Le11
 ((
ut32_t
)0x00800

	)

114 
	#EXTI_Le12
 ((
ut32_t
)0x01000

	)

115 
	#EXTI_Le13
 ((
ut32_t
)0x02000

	)

116 
	#EXTI_Le14
 ((
ut32_t
)0x04000

	)

117 
	#EXTI_Le15
 ((
ut32_t
)0x08000

	)

118 
	#EXTI_Le16
 ((
ut32_t
)0x10000

	)

119 
	#EXTI_Le17
 ((
ut32_t
)0x20000

	)

120 
	#EXTI_Le18
 ((
ut32_t
)0x40000

	)

122 
	#EXTI_Le19
 ((
ut32_t
)0x80000

	)

124 
	#IS_EXTI_LINE
(
LINE
((((LINE& (
ut32_t
)0xFFF00000=0x00&& ((LINE!(
ut16_t
)0x00))

	)

125 
	#IS_GET_EXTI_LINE
(
LINE
(((LINE=
EXTI_Le0
|| ((LINE=
EXTI_Le1
) || \

126 ((
LINE
=
EXTI_Le2
|| ((LINE=
EXTI_Le3
) || \

127 ((
LINE
=
EXTI_Le4
|| ((LINE=
EXTI_Le5
) || \

128 ((
LINE
=
EXTI_Le6
|| ((LINE=
EXTI_Le7
) || \

129 ((
LINE
=
EXTI_Le8
|| ((LINE=
EXTI_Le9
) || \

130 ((
LINE
=
EXTI_Le10
|| ((LINE=
EXTI_Le11
) || \

131 ((
LINE
=
EXTI_Le12
|| ((LINE=
EXTI_Le13
) || \

132 ((
LINE
=
EXTI_Le14
|| ((LINE=
EXTI_Le15
) || \

133 ((
LINE
=
EXTI_Le16
|| ((LINE=
EXTI_Le17
) || \

134 ((
LINE
=
EXTI_Le18
|| ((LINE=
EXTI_Le19
))

	)

157 
EXTI_DeIn
();

158 
EXTI_In
(
EXTI_InTyDef
* 
EXTI_InSu
);

159 
EXTI_SuIn
(
EXTI_InTyDef
* 
EXTI_InSu
);

160 
EXTI_GeSWIru
(
ut32_t
 
EXTI_Le
);

161 
FgStus
 
EXTI_GFgStus
(
ut32_t
 
EXTI_Le
);

162 
EXTI_CˬFg
(
ut32_t
 
EXTI_Le
);

163 
ITStus
 
EXTI_GITStus
(
ut32_t
 
EXTI_Le
);

164 
EXTI_CˬITPdgB
(
ut32_t
 
EXTI_Le
);

166 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_flash.h

23 #ide
__STM32F10x_FLASH_H


24 
	#__STM32F10x_FLASH_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
FLASH_BUSY
 = 1,

52 
FLASH_ERROR_PG
,

53 
FLASH_ERROR_WRP
,

54 
FLASH_COMPLETE
,

55 
FLASH_TIMEOUT


56 }
	tFLASH_Stus
;

70 
	#FLASH_Lcy_0
 ((
ut32_t
)0x00000000

	)

71 
	#FLASH_Lcy_1
 ((
ut32_t
)0x00000001

	)

72 
	#FLASH_Lcy_2
 ((
ut32_t
)0x00000002

	)

73 
	#IS_FLASH_LATENCY
(
LATENCY
(((LATENCY=
FLASH_Lcy_0
) || \

74 ((
LATENCY
=
FLASH_Lcy_1
) || \

75 ((
LATENCY
=
FLASH_Lcy_2
))

	)

84 
	#FLASH_HfCyeAcss_Eb
 ((
ut32_t
)0x00000008

	)

85 
	#FLASH_HfCyeAcss_Dib
 ((
ut32_t
)0x00000000

	)

86 
	#IS_FLASH_HALFCYCLEACCESS_STATE
(
STATE
(((STATE=
FLASH_HfCyeAcss_Eb
) || \

87 ((
STATE
=
FLASH_HfCyeAcss_Dib
))

	)

96 
	#FLASH_PtchBufr_Eb
 ((
ut32_t
)0x00000010

	)

97 
	#FLASH_PtchBufr_Dib
 ((
ut32_t
)0x00000000

	)

98 
	#IS_FLASH_PREFETCHBUFFER_STATE
(
STATE
(((STATE=
FLASH_PtchBufr_Eb
) || \

99 ((
STATE
=
FLASH_PtchBufr_Dib
))

	)

109 
	#FLASH_WRPr_Pages0to3
 ((
ut32_t
)0x00000001

	)

110 
	#FLASH_WRPr_Pages4to7
 ((
ut32_t
)0x00000002

	)

111 
	#FLASH_WRPr_Pages8to11
 ((
ut32_t
)0x00000004

	)

112 
	#FLASH_WRPr_Pages12to15
 ((
ut32_t
)0x00000008

	)

113 
	#FLASH_WRPr_Pages16to19
 ((
ut32_t
)0x00000010

	)

114 
	#FLASH_WRPr_Pages20to23
 ((
ut32_t
)0x00000020

	)

115 
	#FLASH_WRPr_Pages24to27
 ((
ut32_t
)0x00000040

	)

116 
	#FLASH_WRPr_Pages28to31
 ((
ut32_t
)0x00000080

	)

119 
	#FLASH_WRPr_Pages32to35
 ((
ut32_t
)0x00000100

	)

120 
	#FLASH_WRPr_Pages36to39
 ((
ut32_t
)0x00000200

	)

121 
	#FLASH_WRPr_Pages40to43
 ((
ut32_t
)0x00000400

	)

122 
	#FLASH_WRPr_Pages44to47
 ((
ut32_t
)0x00000800

	)

123 
	#FLASH_WRPr_Pages48to51
 ((
ut32_t
)0x00001000

	)

124 
	#FLASH_WRPr_Pages52to55
 ((
ut32_t
)0x00002000

	)

125 
	#FLASH_WRPr_Pages56to59
 ((
ut32_t
)0x00004000

	)

126 
	#FLASH_WRPr_Pages60to63
 ((
ut32_t
)0x00008000

	)

127 
	#FLASH_WRPr_Pages64to67
 ((
ut32_t
)0x00010000

	)

128 
	#FLASH_WRPr_Pages68to71
 ((
ut32_t
)0x00020000

	)

129 
	#FLASH_WRPr_Pages72to75
 ((
ut32_t
)0x00040000

	)

130 
	#FLASH_WRPr_Pages76to79
 ((
ut32_t
)0x00080000

	)

131 
	#FLASH_WRPr_Pages80to83
 ((
ut32_t
)0x00100000

	)

132 
	#FLASH_WRPr_Pages84to87
 ((
ut32_t
)0x00200000

	)

133 
	#FLASH_WRPr_Pages88to91
 ((
ut32_t
)0x00400000

	)

134 
	#FLASH_WRPr_Pages92to95
 ((
ut32_t
)0x00800000

	)

135 
	#FLASH_WRPr_Pages96to99
 ((
ut32_t
)0x01000000

	)

136 
	#FLASH_WRPr_Pages100to103
 ((
ut32_t
)0x02000000

	)

137 
	#FLASH_WRPr_Pages104to107
 ((
ut32_t
)0x04000000

	)

138 
	#FLASH_WRPr_Pages108to111
 ((
ut32_t
)0x08000000

	)

139 
	#FLASH_WRPr_Pages112to115
 ((
ut32_t
)0x10000000

	)

140 
	#FLASH_WRPr_Pages116to119
 ((
ut32_t
)0x20000000

	)

141 
	#FLASH_WRPr_Pages120to123
 ((
ut32_t
)0x40000000

	)

142 
	#FLASH_WRPr_Pages124to127
 ((
ut32_t
)0x80000000

	)

145 
	#FLASH_WRPr_Pages0to1
 ((
ut32_t
)0x00000001

	)

147 
	#FLASH_WRPr_Pages2to3
 ((
ut32_t
)0x00000002

	)

149 
	#FLASH_WRPr_Pages4to5
 ((
ut32_t
)0x00000004

	)

151 
	#FLASH_WRPr_Pages6to7
 ((
ut32_t
)0x00000008

	)

153 
	#FLASH_WRPr_Pages8to9
 ((
ut32_t
)0x00000010

	)

155 
	#FLASH_WRPr_Pages10to11
 ((
ut32_t
)0x00000020

	)

157 
	#FLASH_WRPr_Pages12to13
 ((
ut32_t
)0x00000040

	)

159 
	#FLASH_WRPr_Pages14to15
 ((
ut32_t
)0x00000080

	)

161 
	#FLASH_WRPr_Pages16to17
 ((
ut32_t
)0x00000100

	)

163 
	#FLASH_WRPr_Pages18to19
 ((
ut32_t
)0x00000200

	)

165 
	#FLASH_WRPr_Pages20to21
 ((
ut32_t
)0x00000400

	)

167 
	#FLASH_WRPr_Pages22to23
 ((
ut32_t
)0x00000800

	)

169 
	#FLASH_WRPr_Pages24to25
 ((
ut32_t
)0x00001000

	)

171 
	#FLASH_WRPr_Pages26to27
 ((
ut32_t
)0x00002000

	)

173 
	#FLASH_WRPr_Pages28to29
 ((
ut32_t
)0x00004000

	)

175 
	#FLASH_WRPr_Pages30to31
 ((
ut32_t
)0x00008000

	)

177 
	#FLASH_WRPr_Pages32to33
 ((
ut32_t
)0x00010000

	)

179 
	#FLASH_WRPr_Pages34to35
 ((
ut32_t
)0x00020000

	)

181 
	#FLASH_WRPr_Pages36to37
 ((
ut32_t
)0x00040000

	)

183 
	#FLASH_WRPr_Pages38to39
 ((
ut32_t
)0x00080000

	)

185 
	#FLASH_WRPr_Pages40to41
 ((
ut32_t
)0x00100000

	)

187 
	#FLASH_WRPr_Pages42to43
 ((
ut32_t
)0x00200000

	)

189 
	#FLASH_WRPr_Pages44to45
 ((
ut32_t
)0x00400000

	)

191 
	#FLASH_WRPr_Pages46to47
 ((
ut32_t
)0x00800000

	)

193 
	#FLASH_WRPr_Pages48to49
 ((
ut32_t
)0x01000000

	)

195 
	#FLASH_WRPr_Pages50to51
 ((
ut32_t
)0x02000000

	)

197 
	#FLASH_WRPr_Pages52to53
 ((
ut32_t
)0x04000000

	)

199 
	#FLASH_WRPr_Pages54to55
 ((
ut32_t
)0x08000000

	)

201 
	#FLASH_WRPr_Pages56to57
 ((
ut32_t
)0x10000000

	)

203 
	#FLASH_WRPr_Pages58to59
 ((
ut32_t
)0x20000000

	)

205 
	#FLASH_WRPr_Pages60to61
 ((
ut32_t
)0x40000000

	)

207 
	#FLASH_WRPr_Pages62to127
 ((
ut32_t
)0x80000000

	)

208 
	#FLASH_WRPr_Pages62to255
 ((
ut32_t
)0x80000000

	)

209 
	#FLASH_WRPr_Pages62to511
 ((
ut32_t
)0x80000000

	)

211 
	#FLASH_WRPr_APages
 ((
ut32_t
)0xFFFFFFFF

	)

213 
	#IS_FLASH_WRPROT_PAGE
(
PAGE
(((PAGE!0x00000000))

	)

215 
	#IS_FLASH_ADDRESS
(
ADDRESS
(((ADDRESS>0x08000000&& ((ADDRESS< 0x080FFFFF))

	)

217 
	#IS_OB_DATA_ADDRESS
(
ADDRESS
(((ADDRESS=0x1FFFF804|| ((ADDRESS=0x1FFFF806))

	)

227 
	#OB_IWDG_SW
 ((
ut16_t
)0x0001

	)

228 
	#OB_IWDG_HW
 ((
ut16_t
)0x0000

	)

229 
	#IS_OB_IWDG_SOURCE
(
SOURCE
(((SOURCE=
OB_IWDG_SW
|| ((SOURCE=
OB_IWDG_HW
))

	)

239 
	#OB_STOP_NoRST
 ((
ut16_t
)0x0002

	)

240 
	#OB_STOP_RST
 ((
ut16_t
)0x0000

	)

241 
	#IS_OB_STOP_SOURCE
(
SOURCE
(((SOURCE=
OB_STOP_NoRST
|| ((SOURCE=
OB_STOP_RST
))

	)

251 
	#OB_STDBY_NoRST
 ((
ut16_t
)0x0004

	)

252 
	#OB_STDBY_RST
 ((
ut16_t
)0x0000

	)

253 
	#IS_OB_STDBY_SOURCE
(
SOURCE
(((SOURCE=
OB_STDBY_NoRST
|| ((SOURCE=
OB_STDBY_RST
))

	)

255 #ifde
STM32F10X_XL


262 
	#FLASH_BOOT_Bk1
 ((
ut16_t
)0x0000

	)

264 
	#FLASH_BOOT_Bk2
 ((
ut16_t
)0x0001

	)

267 
	#IS_FLASH_BOOT
(
BOOT
(((BOOT=
FLASH_BOOT_Bk1
|| ((BOOT=
FLASH_BOOT_Bk2
))

	)

275 #ifde
STM32F10X_XL


276 
	#FLASH_IT_BANK2_ERROR
 ((
ut32_t
)0x80000400

	)

277 
	#FLASH_IT_BANK2_EOP
 ((
ut32_t
)0x80001000

	)

279 
	#FLASH_IT_BANK1_ERROR
 
FLASH_IT_ERROR


	)

280 
	#FLASH_IT_BANK1_EOP
 
FLASH_IT_EOP


	)

282 
	#FLASH_IT_ERROR
 ((
ut32_t
)0x00000400

	)

283 
	#FLASH_IT_EOP
 ((
ut32_t
)0x00001000

	)

284 
	#IS_FLASH_IT
(
IT
((((IT& (
ut32_t
)0x7FFFEBFF=0x00000000&& (((IT!0x00000000)))

	)

286 
	#FLASH_IT_ERROR
 ((
ut32_t
)0x00000400

	)

287 
	#FLASH_IT_EOP
 ((
ut32_t
)0x00001000

	)

288 
	#FLASH_IT_BANK1_ERROR
 
FLASH_IT_ERROR


	)

289 
	#FLASH_IT_BANK1_EOP
 
FLASH_IT_EOP


	)

291 
	#IS_FLASH_IT
(
IT
((((IT& (
ut32_t
)0xFFFFEBFF=0x00000000&& (((IT!0x00000000)))

	)

301 #ifde
STM32F10X_XL


302 
	#FLASH_FLAG_BANK2_BSY
 ((
ut32_t
)0x80000001

	)

303 
	#FLASH_FLAG_BANK2_EOP
 ((
ut32_t
)0x80000020

	)

304 
	#FLASH_FLAG_BANK2_PGERR
 ((
ut32_t
)0x80000004

	)

305 
	#FLASH_FLAG_BANK2_WRPRTERR
 ((
ut32_t
)0x80000010

	)

307 
	#FLASH_FLAG_BANK1_BSY
 
FLASH_FLAG_BSY


	)

308 
	#FLASH_FLAG_BANK1_EOP
 
FLASH_FLAG_EOP


	)

309 
	#FLASH_FLAG_BANK1_PGERR
 
FLASH_FLAG_PGERR


	)

310 
	#FLASH_FLAG_BANK1_WRPRTERR
 
FLASH_FLAG_WRPRTERR


	)

312 
	#FLASH_FLAG_BSY
 ((
ut32_t
)0x00000001

	)

313 
	#FLASH_FLAG_EOP
 ((
ut32_t
)0x00000020

	)

314 
	#FLASH_FLAG_PGERR
 ((
ut32_t
)0x00000004

	)

315 
	#FLASH_FLAG_WRPRTERR
 ((
ut32_t
)0x00000010

	)

316 
	#FLASH_FLAG_OPTERR
 ((
ut32_t
)0x00000001

	)

318 
	#IS_FLASH_CLEAR_FLAG
(
FLAG
((((FLAG& (
ut32_t
)0x7FFFFFCA=0x00000000&& ((FLAG!0x00000000))

	)

319 
	#IS_FLASH_GET_FLAG
(
FLAG
(((FLAG=
FLASH_FLAG_BSY
|| ((FLAG=
FLASH_FLAG_EOP
) || \

320 ((
FLAG
=
FLASH_FLAG_PGERR
|| ((FLAG=
FLASH_FLAG_WRPRTERR
) || \

321 ((
FLAG
=
FLASH_FLAG_OPTERR
)|| \

322 ((
FLAG
=
FLASH_FLAG_BANK1_BSY
|| ((FLAG=
FLASH_FLAG_BANK1_EOP
) || \

323 ((
FLAG
=
FLASH_FLAG_BANK1_PGERR
|| ((FLAG=
FLASH_FLAG_BANK1_WRPRTERR
) || \

324 ((
FLAG
=
FLASH_FLAG_BANK2_BSY
|| ((FLAG=
FLASH_FLAG_BANK2_EOP
) || \

325 ((
FLAG
=
FLASH_FLAG_BANK2_PGERR
|| ((FLAG=
FLASH_FLAG_BANK2_WRPRTERR
))

	)

327 
	#FLASH_FLAG_BSY
 ((
ut32_t
)0x00000001

	)

328 
	#FLASH_FLAG_EOP
 ((
ut32_t
)0x00000020

	)

329 
	#FLASH_FLAG_PGERR
 ((
ut32_t
)0x00000004

	)

330 
	#FLASH_FLAG_WRPRTERR
 ((
ut32_t
)0x00000010

	)

331 
	#FLASH_FLAG_OPTERR
 ((
ut32_t
)0x00000001

	)

333 
	#FLASH_FLAG_BANK1_BSY
 
FLASH_FLAG_BSY


	)

334 
	#FLASH_FLAG_BANK1_EOP
 
FLASH_FLAG_EOP


	)

335 
	#FLASH_FLAG_BANK1_PGERR
 
FLASH_FLAG_PGERR


	)

336 
	#FLASH_FLAG_BANK1_WRPRTERR
 
FLASH_FLAG_WRPRTERR


	)

338 
	#IS_FLASH_CLEAR_FLAG
(
FLAG
((((FLAG& (
ut32_t
)0xFFFFFFCA=0x00000000&& ((FLAG!0x00000000))

	)

339 
	#IS_FLASH_GET_FLAG
(
FLAG
(((FLAG=
FLASH_FLAG_BSY
|| ((FLAG=
FLASH_FLAG_EOP
) || \

340 ((
FLAG
=
FLASH_FLAG_PGERR
|| ((FLAG=
FLASH_FLAG_WRPRTERR
) || \

341 ((
FLAG
=
FLASH_FLAG_BANK1_BSY
|| ((FLAG=
FLASH_FLAG_BANK1_EOP
) || \

342 ((
FLAG
=
FLASH_FLAG_BANK1_PGERR
|| ((FLAG=
FLASH_FLAG_BANK1_WRPRTERR
) || \

343 ((
FLAG
=
FLASH_FLAG_OPTERR
))

	)

367 
FLASH_SLcy
(
ut32_t
 
FLASH_Lcy
);

368 
FLASH_HfCyeAcssCmd
(
ut32_t
 
FLASH_HfCyeAcss
);

369 
FLASH_PtchBufrCmd
(
ut32_t
 
FLASH_PtchBufr
);

370 
FLASH_Uock
();

371 
FLASH_Lock
();

372 
FLASH_Stus
 
FLASH_EPage
(
ut32_t
 
Page_Addss
);

373 
FLASH_Stus
 
FLASH_EAPages
();

374 
FLASH_Stus
 
FLASH_EOiBys
();

375 
FLASH_Stus
 
FLASH_ProgmWd
(
ut32_t
 
Addss
, ut32_
Da
);

376 
FLASH_Stus
 
FLASH_ProgmHfWd
(
ut32_t
 
Addss
, 
ut16_t
 
Da
);

377 
FLASH_Stus
 
FLASH_ProgmOiByDa
(
ut32_t
 
Addss
, 
ut8_t
 
Da
);

378 
FLASH_Stus
 
FLASH_EbWrePrei
(
ut32_t
 
FLASH_Pages
);

379 
FLASH_Stus
 
FLASH_RdOutPrei
(
FuniڮS
 
NewS
);

380 
FLASH_Stus
 
FLASH_UrOiByCfig
(
ut16_t
 
OB_IWDG
, ut16_
OB_STOP
, ut16_
OB_STDBY
);

381 
ut32_t
 
FLASH_GUrOiBy
();

382 
ut32_t
 
FLASH_GWrePreiOiBy
();

383 
FgStus
 
FLASH_GRdOutPreiStus
();

384 
FgStus
 
FLASH_GPtchBufrStus
();

385 
FLASH_ITCfig
(
ut32_t
 
FLASH_IT
, 
FuniڮS
 
NewS
);

386 
FgStus
 
FLASH_GFgStus
(
ut32_t
 
FLASH_FLAG
);

387 
FLASH_CˬFg
(
ut32_t
 
FLASH_FLAG
);

388 
FLASH_Stus
 
FLASH_GStus
();

389 
FLASH_Stus
 
FLASH_WaFLaOti
(
ut32_t
 
Timeout
);

392 
FLASH_UockBk1
();

393 
FLASH_LockBk1
();

394 
FLASH_Stus
 
FLASH_EABk1Pages
();

395 
FLASH_Stus
 
FLASH_GBk1Stus
();

396 
FLASH_Stus
 
FLASH_WaFLaBk1Oti
(
ut32_t
 
Timeout
);

398 #ifde
STM32F10X_XL


400 
FLASH_UockBk2
();

401 
FLASH_LockBk2
();

402 
FLASH_Stus
 
FLASH_EABk2Pages
();

403 
FLASH_Stus
 
FLASH_GBk2Stus
();

404 
FLASH_Stus
 
FLASH_WaFLaBk2Oti
(
ut32_t
 
Timeout
);

405 
FLASH_Stus
 
FLASH_BoCfig
(
ut16_t
 
FLASH_BOOT
);

408 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_fsmc.h

23 #ide
__STM32F10x_FSMC_H


24 
	#__STM32F10x_FSMC_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
ut32_t
 
FSMC_AddssSupTime
;

56 
ut32_t
 
FSMC_AddssHdTime
;

61 
ut32_t
 
FSMC_DaSupTime
;

66 
ut32_t
 
FSMC_BusTuAroundDuti
;

71 
ut32_t
 
FSMC_CLKDivisi
;

75 
ut32_t
 
FSMC_DaLcy
;

83 
ut32_t
 
FSMC_AcssMode
;

85 }
	tFSMC_NORSRAMTimgInTyDef
;

93 
ut32_t
 
FSMC_Bk
;

96 
ut32_t
 
FSMC_DaAddssMux
;

100 
ut32_t
 
FSMC_MemyTy
;

104 
ut32_t
 
FSMC_MemyDaWidth
;

107 
ut32_t
 
FSMC_BurAcssMode
;

111 
ut32_t
 
FSMC_AsynchrousWa
;

115 
ut32_t
 
FSMC_WaSiglPެy
;

119 
ut32_t
 
FSMC_WpMode
;

123 
ut32_t
 
FSMC_WaSiglAive
;

128 
ut32_t
 
FSMC_WreOti
;

131 
ut32_t
 
FSMC_WaSigl
;

135 
ut32_t
 
FSMC_ExndedMode
;

138 
ut32_t
 
FSMC_WreBur
;

141 
FSMC_NORSRAMTimgInTyDef
* 
FSMC_RdWreTimgSu
;

143 
FSMC_NORSRAMTimgInTyDef
* 
FSMC_WreTimgSu
;

144 }
	tFSMC_NORSRAMInTyDef
;

152 
ut32_t
 
FSMC_SupTime
;

158 
ut32_t
 
FSMC_WaSupTime
;

164 
ut32_t
 
FSMC_HdSupTime
;

171 
ut32_t
 
FSMC_HiZSupTime
;

176 }
	tFSMC_NAND_PCCARDTimgInTyDef
;

184 
ut32_t
 
FSMC_Bk
;

187 
ut32_t
 
FSMC_Wau
;

190 
ut32_t
 
FSMC_MemyDaWidth
;

193 
ut32_t
 
FSMC_ECC
;

196 
ut32_t
 
FSMC_ECCPageSize
;

199 
ut32_t
 
FSMC_TCLRSupTime
;

203 
ut32_t
 
FSMC_TARSupTime
;

207 
FSMC_NAND_PCCARDTimgInTyDef
* 
FSMC_CommSTimgSu
;

209 
FSMC_NAND_PCCARDTimgInTyDef
* 
FSMC_AribuSTimgSu
;

210 }
	tFSMC_NANDInTyDef
;

218 
ut32_t
 
FSMC_Wau
;

221 
ut32_t
 
FSMC_TCLRSupTime
;

225 
ut32_t
 
FSMC_TARSupTime
;

230 
FSMC_NAND_PCCARDTimgInTyDef
* 
FSMC_CommSTimgSu
;

232 
FSMC_NAND_PCCARDTimgInTyDef
* 
FSMC_AribuSTimgSu
;

234 
FSMC_NAND_PCCARDTimgInTyDef
* 
FSMC_IOSTimgSu
;

235 }
	tFSMC_PCCARDInTyDef
;

248 
	#FSMC_Bk1_NORSRAM1
 ((
ut32_t
)0x00000000)

	)

249 
	#FSMC_Bk1_NORSRAM2
 ((
ut32_t
)0x00000002)

	)

250 
	#FSMC_Bk1_NORSRAM3
 ((
ut32_t
)0x00000004)

	)

251 
	#FSMC_Bk1_NORSRAM4
 ((
ut32_t
)0x00000006)

	)

259 
	#FSMC_Bk2_NAND
 ((
ut32_t
)0x00000010)

	)

260 
	#FSMC_Bk3_NAND
 ((
ut32_t
)0x00000100)

	)

268 
	#FSMC_Bk4_PCCARD
 ((
ut32_t
)0x00001000)

	)

273 
	#IS_FSMC_NORSRAM_BANK
(
BANK
(((BANK=
FSMC_Bk1_NORSRAM1
) || \

274 ((
BANK
=
FSMC_Bk1_NORSRAM2
) || \

275 ((
BANK
=
FSMC_Bk1_NORSRAM3
) || \

276 ((
BANK
=
FSMC_Bk1_NORSRAM4
))

	)

278 
	#IS_FSMC_NAND_BANK
(
BANK
(((BANK=
FSMC_Bk2_NAND
) || \

279 ((
BANK
=
FSMC_Bk3_NAND
))

	)

281 
	#IS_FSMC_GETFLAG_BANK
(
BANK
(((BANK=
FSMC_Bk2_NAND
) || \

282 ((
BANK
=
FSMC_Bk3_NAND
) || \

283 ((
BANK
=
FSMC_Bk4_PCCARD
))

	)

285 
	#IS_FSMC_IT_BANK
(
BANK
(((BANK=
FSMC_Bk2_NAND
) || \

286 ((
BANK
=
FSMC_Bk3_NAND
) || \

287 ((
BANK
=
FSMC_Bk4_PCCARD
))

	)

297 
	#FSMC_DaAddssMux_Dib
 ((
ut32_t
)0x00000000)

	)

298 
	#FSMC_DaAddssMux_Eb
 ((
ut32_t
)0x00000002)

	)

299 
	#IS_FSMC_MUX
(
MUX
(((MUX=
FSMC_DaAddssMux_Dib
) || \

300 ((
MUX
=
FSMC_DaAddssMux_Eb
))

	)

310 
	#FSMC_MemyTy_SRAM
 ((
ut32_t
)0x00000000)

	)

311 
	#FSMC_MemyTy_PSRAM
 ((
ut32_t
)0x00000004)

	)

312 
	#FSMC_MemyTy_NOR
 ((
ut32_t
)0x00000008)

	)

313 
	#IS_FSMC_MEMORY
(
MEMORY
(((MEMORY=
FSMC_MemyTy_SRAM
) || \

314 ((
MEMORY
=
FSMC_MemyTy_PSRAM
)|| \

315 ((
MEMORY
=
FSMC_MemyTy_NOR
))

	)

325 
	#FSMC_MemyDaWidth_8b
 ((
ut32_t
)0x00000000)

	)

326 
	#FSMC_MemyDaWidth_16b
 ((
ut32_t
)0x00000010)

	)

327 
	#IS_FSMC_MEMORY_WIDTH
(
WIDTH
(((WIDTH=
FSMC_MemyDaWidth_8b
) || \

328 ((
WIDTH
=
FSMC_MemyDaWidth_16b
))

	)

338 
	#FSMC_BurAcssMode_Dib
 ((
ut32_t
)0x00000000)

	)

339 
	#FSMC_BurAcssMode_Eb
 ((
ut32_t
)0x00000100)

	)

340 
	#IS_FSMC_BURSTMODE
(
STATE
(((STATE=
FSMC_BurAcssMode_Dib
) || \

341 ((
STATE
=
FSMC_BurAcssMode_Eb
))

	)

349 
	#FSMC_AsynchrousWa_Dib
 ((
ut32_t
)0x00000000)

	)

350 
	#FSMC_AsynchrousWa_Eb
 ((
ut32_t
)0x00008000)

	)

351 
	#IS_FSMC_ASYNWAIT
(
STATE
(((STATE=
FSMC_AsynchrousWa_Dib
) || \

352 ((
STATE
=
FSMC_AsynchrousWa_Eb
))

	)

362 
	#FSMC_WaSiglPެy_Low
 ((
ut32_t
)0x00000000)

	)

363 
	#FSMC_WaSiglPެy_High
 ((
ut32_t
)0x00000200)

	)

364 
	#IS_FSMC_WAIT_POLARITY
(
POLARITY
(((POLARITY=
FSMC_WaSiglPެy_Low
) || \

365 ((
POLARITY
=
FSMC_WaSiglPެy_High
))

	)

375 
	#FSMC_WpMode_Dib
 ((
ut32_t
)0x00000000)

	)

376 
	#FSMC_WpMode_Eb
 ((
ut32_t
)0x00000400)

	)

377 
	#IS_FSMC_WRAP_MODE
(
MODE
(((MODE=
FSMC_WpMode_Dib
) || \

378 ((
MODE
=
FSMC_WpMode_Eb
))

	)

388 
	#FSMC_WaSiglAive_BefeWaS
 ((
ut32_t
)0x00000000)

	)

389 
	#FSMC_WaSiglAive_DurgWaS
 ((
ut32_t
)0x00000800)

	)

390 
	#IS_FSMC_WAIT_SIGNAL_ACTIVE
(
ACTIVE
(((ACTIVE=
FSMC_WaSiglAive_BefeWaS
) || \

391 ((
ACTIVE
=
FSMC_WaSiglAive_DurgWaS
))

	)

401 
	#FSMC_WreOti_Dib
 ((
ut32_t
)0x00000000)

	)

402 
	#FSMC_WreOti_Eb
 ((
ut32_t
)0x00001000)

	)

403 
	#IS_FSMC_WRITE_OPERATION
(
OPERATION
(((OPERATION=
FSMC_WreOti_Dib
) || \

404 ((
OPERATION
=
FSMC_WreOti_Eb
))

	)

414 
	#FSMC_WaSigl_Dib
 ((
ut32_t
)0x00000000)

	)

415 
	#FSMC_WaSigl_Eb
 ((
ut32_t
)0x00002000)

	)

416 
	#IS_FSMC_WAITE_SIGNAL
(
SIGNAL
(((SIGNAL=
FSMC_WaSigl_Dib
) || \

417 ((
SIGNAL
=
FSMC_WaSigl_Eb
))

	)

426 
	#FSMC_ExndedMode_Dib
 ((
ut32_t
)0x00000000)

	)

427 
	#FSMC_ExndedMode_Eb
 ((
ut32_t
)0x00004000)

	)

429 
	#IS_FSMC_EXTENDED_MODE
(
MODE
(((MODE=
FSMC_ExndedMode_Dib
) || \

430 ((
MODE
=
FSMC_ExndedMode_Eb
))

	)

440 
	#FSMC_WreBur_Dib
 ((
ut32_t
)0x00000000)

	)

441 
	#FSMC_WreBur_Eb
 ((
ut32_t
)0x00080000)

	)

442 
	#IS_FSMC_WRITE_BURST
(
BURST
(((BURST=
FSMC_WreBur_Dib
) || \

443 ((
BURST
=
FSMC_WreBur_Eb
))

	)

452 
	#IS_FSMC_ADDRESS_SETUP_TIME
(
TIME
((TIME<0xF)

	)

462 
	#IS_FSMC_ADDRESS_HOLD_TIME
(
TIME
((TIME<0xF)

	)

472 
	#IS_FSMC_DATASETUP_TIME
(
TIME
(((TIME> 0&& ((TIME<0xFF))

	)

482 
	#IS_FSMC_TURNAROUND_TIME
(
TIME
((TIME<0xF)

	)

492 
	#IS_FSMC_CLK_DIV
(
DIV
((DIV<0xF)

	)

502 
	#IS_FSMC_DATA_LATENCY
(
LATENCY
((LATENCY<0xF)

	)

512 
	#FSMC_AcssMode_A
 ((
ut32_t
)0x00000000)

	)

513 
	#FSMC_AcssMode_B
 ((
ut32_t
)0x10000000)

	)

514 
	#FSMC_AcssMode_C
 ((
ut32_t
)0x20000000)

	)

515 
	#FSMC_AcssMode_D
 ((
ut32_t
)0x30000000)

	)

516 
	#IS_FSMC_ACCESS_MODE
(
MODE
(((MODE=
FSMC_AcssMode_A
) || \

517 ((
MODE
=
FSMC_AcssMode_B
) || \

518 ((
MODE
=
FSMC_AcssMode_C
) || \

519 ((
MODE
=
FSMC_AcssMode_D
))

	)

537 
	#FSMC_Wau_Dib
 ((
ut32_t
)0x00000000)

	)

538 
	#FSMC_Wau_Eb
 ((
ut32_t
)0x00000002)

	)

539 
	#IS_FSMC_WAIT_FEATURE
(
FEATURE
(((FEATURE=
FSMC_Wau_Dib
) || \

540 ((
FEATURE
=
FSMC_Wau_Eb
))

	)

551 
	#FSMC_ECC_Dib
 ((
ut32_t
)0x00000000)

	)

552 
	#FSMC_ECC_Eb
 ((
ut32_t
)0x00000040)

	)

553 
	#IS_FSMC_ECC_STATE
(
STATE
(((STATE=
FSMC_ECC_Dib
) || \

554 ((
STATE
=
FSMC_ECC_Eb
))

	)

564 
	#FSMC_ECCPageSize_256Bys
 ((
ut32_t
)0x00000000)

	)

565 
	#FSMC_ECCPageSize_512Bys
 ((
ut32_t
)0x00020000)

	)

566 
	#FSMC_ECCPageSize_1024Bys
 ((
ut32_t
)0x00040000)

	)

567 
	#FSMC_ECCPageSize_2048Bys
 ((
ut32_t
)0x00060000)

	)

568 
	#FSMC_ECCPageSize_4096Bys
 ((
ut32_t
)0x00080000)

	)

569 
	#FSMC_ECCPageSize_8192Bys
 ((
ut32_t
)0x000A0000)

	)

570 
	#IS_FSMC_ECCPAGE_SIZE
(
SIZE
(((SIZE=
FSMC_ECCPageSize_256Bys
) || \

571 ((
SIZE
=
FSMC_ECCPageSize_512Bys
) || \

572 ((
SIZE
=
FSMC_ECCPageSize_1024Bys
) || \

573 ((
SIZE
=
FSMC_ECCPageSize_2048Bys
) || \

574 ((
SIZE
=
FSMC_ECCPageSize_4096Bys
) || \

575 ((
SIZE
=
FSMC_ECCPageSize_8192Bys
))

	)

585 
	#IS_FSMC_TCLR_TIME
(
TIME
((TIME<0xFF)

	)

595 
	#IS_FSMC_TAR_TIME
(
TIME
((TIME<0xFF)

	)

605 
	#IS_FSMC_SETUP_TIME
(
TIME
((TIME<0xFF)

	)

615 
	#IS_FSMC_WAIT_TIME
(
TIME
((TIME<0xFF)

	)

625 
	#IS_FSMC_HOLD_TIME
(
TIME
((TIME<0xFF)

	)

635 
	#IS_FSMC_HIZ_TIME
(
TIME
((TIME<0xFF)

	)

645 
	#FSMC_IT_RisgEdge
 ((
ut32_t
)0x00000008)

	)

646 
	#FSMC_IT_Lev
 ((
ut32_t
)0x00000010)

	)

647 
	#FSMC_IT_FlgEdge
 ((
ut32_t
)0x00000020)

	)

648 
	#IS_FSMC_IT
(
IT
((((IT& (
ut32_t
)0xFFFFFFC7=0x00000000&& ((IT!0x00000000))

	)

649 
	#IS_FSMC_GET_IT
(
IT
(((IT=
FSMC_IT_RisgEdge
) || \

650 ((
IT
=
FSMC_IT_Lev
) || \

651 ((
IT
=
FSMC_IT_FlgEdge
))

	)

660 
	#FSMC_FLAG_RisgEdge
 ((
ut32_t
)0x00000001)

	)

661 
	#FSMC_FLAG_Lev
 ((
ut32_t
)0x00000002)

	)

662 
	#FSMC_FLAG_FlgEdge
 ((
ut32_t
)0x00000004)

	)

663 
	#FSMC_FLAG_FEMPT
 ((
ut32_t
)0x00000040)

	)

664 
	#IS_FSMC_GET_FLAG
(
FLAG
(((FLAG=
FSMC_FLAG_RisgEdge
) || \

665 ((
FLAG
=
FSMC_FLAG_Lev
) || \

666 ((
FLAG
=
FSMC_FLAG_FlgEdge
) || \

667 ((
FLAG
=
FSMC_FLAG_FEMPT
))

	)

669 
	#IS_FSMC_CLEAR_FLAG
(
FLAG
((((FLAG& (
ut32_t
)0xFFFFFFF8=0x00000000&& ((FLAG!0x00000000))

	)

695 
FSMC_NORSRAMDeIn
(
ut32_t
 
FSMC_Bk
);

696 
FSMC_NANDDeIn
(
ut32_t
 
FSMC_Bk
);

697 
FSMC_PCCARDDeIn
();

698 
FSMC_NORSRAMIn
(
FSMC_NORSRAMInTyDef
* 
FSMC_NORSRAMInSu
);

699 
FSMC_NANDIn
(
FSMC_NANDInTyDef
* 
FSMC_NANDInSu
);

700 
FSMC_PCCARDIn
(
FSMC_PCCARDInTyDef
* 
FSMC_PCCARDInSu
);

701 
FSMC_NORSRAMSuIn
(
FSMC_NORSRAMInTyDef
* 
FSMC_NORSRAMInSu
);

702 
FSMC_NANDSuIn
(
FSMC_NANDInTyDef
* 
FSMC_NANDInSu
);

703 
FSMC_PCCARDSuIn
(
FSMC_PCCARDInTyDef
* 
FSMC_PCCARDInSu
);

704 
FSMC_NORSRAMCmd
(
ut32_t
 
FSMC_Bk
, 
FuniڮS
 
NewS
);

705 
FSMC_NANDCmd
(
ut32_t
 
FSMC_Bk
, 
FuniڮS
 
NewS
);

706 
FSMC_PCCARDCmd
(
FuniڮS
 
NewS
);

707 
FSMC_NANDECCCmd
(
ut32_t
 
FSMC_Bk
, 
FuniڮS
 
NewS
);

708 
ut32_t
 
FSMC_GECC
(ut32_
FSMC_Bk
);

709 
FSMC_ITCfig
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_IT
, 
FuniڮS
 
NewS
);

710 
FgStus
 
FSMC_GFgStus
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_FLAG
);

711 
FSMC_CˬFg
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_FLAG
);

712 
ITStus
 
FSMC_GITStus
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_IT
);

713 
FSMC_CˬITPdgB
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_IT
);

715 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_gpio.h

23 #ide
__STM32F10x_GPIO_H


24 
	#__STM32F10x_GPIO_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

45 
	#IS_GPIO_ALL_PERIPH
(
PERIPH
(((PERIPH=
GPIOA
) || \

46 ((
PERIPH
=
GPIOB
) || \

47 ((
PERIPH
=
GPIOC
) || \

48 ((
PERIPH
=
GPIOD
) || \

49 ((
PERIPH
=
GPIOE
) || \

50 ((
PERIPH
=
GPIOF
) || \

51 ((
PERIPH
=
GPIOG
))

	)

59 
GPIO_Sed_10MHz
 = 1,

60 
GPIO_Sed_2MHz
,

61 
GPIO_Sed_50MHz


62 }
	tGPIOSed_TyDef
;

63 
	#IS_GPIO_SPEED
(
SPEED
(((SPEED=
GPIO_Sed_10MHz
|| ((SPEED=
GPIO_Sed_2MHz
) || \

64 ((
SPEED
=
GPIO_Sed_50MHz
))

	)

71 { 
GPIO_Mode_AIN
 = 0x0,

72 
GPIO_Mode_IN_FLOATING
 = 0x04,

73 
GPIO_Mode_IPD
 = 0x28,

74 
GPIO_Mode_IPU
 = 0x48,

75 
GPIO_Mode_Out_OD
 = 0x14,

76 
GPIO_Mode_Out_PP
 = 0x10,

77 
GPIO_Mode_AF_OD
 = 0x1C,

78 
GPIO_Mode_AF_PP
 = 0x18

79 }
	tGPIOMode_TyDef
;

81 
	#IS_GPIO_MODE
(
MODE
(((MODE=
GPIO_Mode_AIN
|| ((MODE=
GPIO_Mode_IN_FLOATING
) || \

82 ((
MODE
=
GPIO_Mode_IPD
|| ((MODE=
GPIO_Mode_IPU
) || \

83 ((
MODE
=
GPIO_Mode_Out_OD
|| ((MODE=
GPIO_Mode_Out_PP
) || \

84 ((
MODE
=
GPIO_Mode_AF_OD
|| ((MODE=
GPIO_Mode_AF_PP
))

	)

92 
ut16_t
 
GPIO_P
;

95 
GPIOSed_TyDef
 
GPIO_Sed
;

98 
GPIOMode_TyDef
 
GPIO_Mode
;

100 }
	tGPIO_InTyDef
;

108 { 
B_RESET
 = 0,

109 
B_SET


110 }
	tBAi
;

112 
	#IS_GPIO_BIT_ACTION
(
ACTION
(((ACTION=
B_RESET
|| ((ACTION=
B_SET
))

	)

126 
	#GPIO_P_0
 ((
ut16_t
)0x0001

	)

127 
	#GPIO_P_1
 ((
ut16_t
)0x0002

	)

128 
	#GPIO_P_2
 ((
ut16_t
)0x0004

	)

129 
	#GPIO_P_3
 ((
ut16_t
)0x0008

	)

130 
	#GPIO_P_4
 ((
ut16_t
)0x0010

	)

131 
	#GPIO_P_5
 ((
ut16_t
)0x0020

	)

132 
	#GPIO_P_6
 ((
ut16_t
)0x0040

	)

133 
	#GPIO_P_7
 ((
ut16_t
)0x0080

	)

134 
	#GPIO_P_8
 ((
ut16_t
)0x0100

	)

135 
	#GPIO_P_9
 ((
ut16_t
)0x0200

	)

136 
	#GPIO_P_10
 ((
ut16_t
)0x0400

	)

137 
	#GPIO_P_11
 ((
ut16_t
)0x0800

	)

138 
	#GPIO_P_12
 ((
ut16_t
)0x1000

	)

139 
	#GPIO_P_13
 ((
ut16_t
)0x2000

	)

140 
	#GPIO_P_14
 ((
ut16_t
)0x4000

	)

141 
	#GPIO_P_15
 ((
ut16_t
)0x8000

	)

142 
	#GPIO_P_A
 ((
ut16_t
)0xFFFF

	)

144 
	#IS_GPIO_PIN
(
PIN
((((PIN& (
ut16_t
)0x00=0x00&& ((PIN!(ut16_t)0x00))

	)

146 
	#IS_GET_GPIO_PIN
(
PIN
(((PIN=
GPIO_P_0
) || \

147 ((
PIN
=
GPIO_P_1
) || \

148 ((
PIN
=
GPIO_P_2
) || \

149 ((
PIN
=
GPIO_P_3
) || \

150 ((
PIN
=
GPIO_P_4
) || \

151 ((
PIN
=
GPIO_P_5
) || \

152 ((
PIN
=
GPIO_P_6
) || \

153 ((
PIN
=
GPIO_P_7
) || \

154 ((
PIN
=
GPIO_P_8
) || \

155 ((
PIN
=
GPIO_P_9
) || \

156 ((
PIN
=
GPIO_P_10
) || \

157 ((
PIN
=
GPIO_P_11
) || \

158 ((
PIN
=
GPIO_P_12
) || \

159 ((
PIN
=
GPIO_P_13
) || \

160 ((
PIN
=
GPIO_P_14
) || \

161 ((
PIN
=
GPIO_P_15
))

	)

171 
	#GPIO_Rem_SPI1
 ((
ut32_t
)0x00000001

	)

172 
	#GPIO_Rem_I2C1
 ((
ut32_t
)0x00000002

	)

173 
	#GPIO_Rem_USART1
 ((
ut32_t
)0x00000004

	)

174 
	#GPIO_Rem_USART2
 ((
ut32_t
)0x00000008

	)

175 
	#GPIO_PtlRem_USART3
 ((
ut32_t
)0x00140010

	)

176 
	#GPIO_FuRem_USART3
 ((
ut32_t
)0x00140030

	)

177 
	#GPIO_PtlRem_TIM1
 ((
ut32_t
)0x00160040

	)

178 
	#GPIO_FuRem_TIM1
 ((
ut32_t
)0x001600C0

	)

179 
	#GPIO_PtlRem1_TIM2
 ((
ut32_t
)0x00180100

	)

180 
	#GPIO_PtlRem2_TIM2
 ((
ut32_t
)0x00180200

	)

181 
	#GPIO_FuRem_TIM2
 ((
ut32_t
)0x00180300

	)

182 
	#GPIO_PtlRem_TIM3
 ((
ut32_t
)0x001A0800

	)

183 
	#GPIO_FuRem_TIM3
 ((
ut32_t
)0x001A0C00

	)

184 
	#GPIO_Rem_TIM4
 ((
ut32_t
)0x00001000

	)

185 
	#GPIO_Rem1_CAN1
 ((
ut32_t
)0x001D4000

	)

186 
	#GPIO_Rem2_CAN1
 ((
ut32_t
)0x001D6000

	)

187 
	#GPIO_Rem_PD01
 ((
ut32_t
)0x00008000

	)

188 
	#GPIO_Rem_TIM5CH4_LSI
 ((
ut32_t
)0x00200001

	)

189 
	#GPIO_Rem_ADC1_ETRGINJ
 ((
ut32_t
)0x00200002

	)

190 
	#GPIO_Rem_ADC1_ETRGREG
 ((
ut32_t
)0x00200004

	)

191 
	#GPIO_Rem_ADC2_ETRGINJ
 ((
ut32_t
)0x00200008

	)

192 
	#GPIO_Rem_ADC2_ETRGREG
 ((
ut32_t
)0x00200010

	)

193 
	#GPIO_Rem_ETH
 ((
ut32_t
)0x00200020

	)

194 
	#GPIO_Rem_CAN2
 ((
ut32_t
)0x00200040

	)

195 
	#GPIO_Rem_SWJ_NoJTRST
 ((
ut32_t
)0x00300100

	)

196 
	#GPIO_Rem_SWJ_JTAGDib
 ((
ut32_t
)0x00300200

	)

197 
	#GPIO_Rem_SWJ_Dib
 ((
ut32_t
)0x00300400

	)

198 
	#GPIO_Rem_SPI3
 ((
ut32_t
)0x00201000

	)

199 
	#GPIO_Rem_TIM2ITR1_PTP_SOF
 ((
ut32_t
)0x00202000

	)

202 
	#GPIO_Rem_PTP_PPS
 ((
ut32_t
)0x00204000

	)

204 
	#GPIO_Rem_TIM15
 ((
ut32_t
)0x80000001

	)

205 
	#GPIO_Rem_TIM16
 ((
ut32_t
)0x80000002

	)

206 
	#GPIO_Rem_TIM17
 ((
ut32_t
)0x80000004

	)

207 
	#GPIO_Rem_CEC
 ((
ut32_t
)0x80000008

	)

208 
	#GPIO_Rem_TIM1_DMA
 ((
ut32_t
)0x80000010

	)

210 
	#GPIO_Rem_TIM9
 ((
ut32_t
)0x80000020

	)

211 
	#GPIO_Rem_TIM10
 ((
ut32_t
)0x80000040

	)

212 
	#GPIO_Rem_TIM11
 ((
ut32_t
)0x80000080

	)

213 
	#GPIO_Rem_TIM13
 ((
ut32_t
)0x80000100

	)

214 
	#GPIO_Rem_TIM14
 ((
ut32_t
)0x80000200

	)

215 
	#GPIO_Rem_FSMC_NADV
 ((
ut32_t
)0x80000400

	)

217 
	#GPIO_Rem_TIM67_DAC_DMA
 ((
ut32_t
)0x80000800

	)

218 
	#GPIO_Rem_TIM12
 ((
ut32_t
)0x80001000

	)

219 
	#GPIO_Rem_MISC
 ((
ut32_t
)0x80002000

	)

222 
	#IS_GPIO_REMAP
(
REMAP
(((REMAP=
GPIO_Rem_SPI1
|| ((REMAP=
GPIO_Rem_I2C1
) || \

223 ((
REMAP
=
GPIO_Rem_USART1
|| ((REMAP=
GPIO_Rem_USART2
) || \

224 ((
REMAP
=
GPIO_PtlRem_USART3
|| ((REMAP=
GPIO_FuRem_USART3
) || \

225 ((
REMAP
=
GPIO_PtlRem_TIM1
|| ((REMAP=
GPIO_FuRem_TIM1
) || \

226 ((
REMAP
=
GPIO_PtlRem1_TIM2
|| ((REMAP=
GPIO_PtlRem2_TIM2
) || \

227 ((
REMAP
=
GPIO_FuRem_TIM2
|| ((REMAP=
GPIO_PtlRem_TIM3
) || \

228 ((
REMAP
=
GPIO_FuRem_TIM3
|| ((REMAP=
GPIO_Rem_TIM4
) || \

229 ((
REMAP
=
GPIO_Rem1_CAN1
|| ((REMAP=
GPIO_Rem2_CAN1
) || \

230 ((
REMAP
=
GPIO_Rem_PD01
|| ((REMAP=
GPIO_Rem_TIM5CH4_LSI
) || \

231 ((
REMAP
=
GPIO_Rem_ADC1_ETRGINJ
||((REMAP=
GPIO_Rem_ADC1_ETRGREG
) || \

232 ((
REMAP
=
GPIO_Rem_ADC2_ETRGINJ
||((REMAP=
GPIO_Rem_ADC2_ETRGREG
) || \

233 ((
REMAP
=
GPIO_Rem_ETH
||((REMAP=
GPIO_Rem_CAN2
) || \

234 ((
REMAP
=
GPIO_Rem_SWJ_NoJTRST
|| ((REMAP=
GPIO_Rem_SWJ_JTAGDib
) || \

235 ((
REMAP
=
GPIO_Rem_SWJ_Dib
)|| ((REMAP=
GPIO_Rem_SPI3
) || \

236 ((
REMAP
=
GPIO_Rem_TIM2ITR1_PTP_SOF
|| ((REMAP=
GPIO_Rem_PTP_PPS
) || \

237 ((
REMAP
=
GPIO_Rem_TIM15
|| ((REMAP=
GPIO_Rem_TIM16
) || \

238 ((
REMAP
=
GPIO_Rem_TIM17
|| ((REMAP=
GPIO_Rem_CEC
) || \

239 ((
REMAP
=
GPIO_Rem_TIM1_DMA
|| ((REMAP=
GPIO_Rem_TIM9
) || \

240 ((
REMAP
=
GPIO_Rem_TIM10
|| ((REMAP=
GPIO_Rem_TIM11
) || \

241 ((
REMAP
=
GPIO_Rem_TIM13
|| ((REMAP=
GPIO_Rem_TIM14
) || \

242 ((
REMAP
=
GPIO_Rem_FSMC_NADV
|| ((REMAP=
GPIO_Rem_TIM67_DAC_DMA
) || \

243 ((
REMAP
=
GPIO_Rem_TIM12
|| ((REMAP=
GPIO_Rem_MISC
))

	)

253 
	#GPIO_PtSourGPIOA
 ((
ut8_t
)0x00)

	)

254 
	#GPIO_PtSourGPIOB
 ((
ut8_t
)0x01)

	)

255 
	#GPIO_PtSourGPIOC
 ((
ut8_t
)0x02)

	)

256 
	#GPIO_PtSourGPIOD
 ((
ut8_t
)0x03)

	)

257 
	#GPIO_PtSourGPIOE
 ((
ut8_t
)0x04)

	)

258 
	#GPIO_PtSourGPIOF
 ((
ut8_t
)0x05)

	)

259 
	#GPIO_PtSourGPIOG
 ((
ut8_t
)0x06)

	)

260 
	#IS_GPIO_EVENTOUT_PORT_SOURCE
(
PORTSOURCE
(((PORTSOURCE=
GPIO_PtSourGPIOA
) || \

261 ((
PORTSOURCE
=
GPIO_PtSourGPIOB
) || \

262 ((
PORTSOURCE
=
GPIO_PtSourGPIOC
) || \

263 ((
PORTSOURCE
=
GPIO_PtSourGPIOD
) || \

264 ((
PORTSOURCE
=
GPIO_PtSourGPIOE
))

	)

266 
	#IS_GPIO_EXTI_PORT_SOURCE
(
PORTSOURCE
(((PORTSOURCE=
GPIO_PtSourGPIOA
) || \

267 ((
PORTSOURCE
=
GPIO_PtSourGPIOB
) || \

268 ((
PORTSOURCE
=
GPIO_PtSourGPIOC
) || \

269 ((
PORTSOURCE
=
GPIO_PtSourGPIOD
) || \

270 ((
PORTSOURCE
=
GPIO_PtSourGPIOE
) || \

271 ((
PORTSOURCE
=
GPIO_PtSourGPIOF
) || \

272 ((
PORTSOURCE
=
GPIO_PtSourGPIOG
))

	)

282 
	#GPIO_PSour0
 ((
ut8_t
)0x00)

	)

283 
	#GPIO_PSour1
 ((
ut8_t
)0x01)

	)

284 
	#GPIO_PSour2
 ((
ut8_t
)0x02)

	)

285 
	#GPIO_PSour3
 ((
ut8_t
)0x03)

	)

286 
	#GPIO_PSour4
 ((
ut8_t
)0x04)

	)

287 
	#GPIO_PSour5
 ((
ut8_t
)0x05)

	)

288 
	#GPIO_PSour6
 ((
ut8_t
)0x06)

	)

289 
	#GPIO_PSour7
 ((
ut8_t
)0x07)

	)

290 
	#GPIO_PSour8
 ((
ut8_t
)0x08)

	)

291 
	#GPIO_PSour9
 ((
ut8_t
)0x09)

	)

292 
	#GPIO_PSour10
 ((
ut8_t
)0x0A)

	)

293 
	#GPIO_PSour11
 ((
ut8_t
)0x0B)

	)

294 
	#GPIO_PSour12
 ((
ut8_t
)0x0C)

	)

295 
	#GPIO_PSour13
 ((
ut8_t
)0x0D)

	)

296 
	#GPIO_PSour14
 ((
ut8_t
)0x0E)

	)

297 
	#GPIO_PSour15
 ((
ut8_t
)0x0F)

	)

299 
	#IS_GPIO_PIN_SOURCE
(
PINSOURCE
(((PINSOURCE=
GPIO_PSour0
) || \

300 ((
PINSOURCE
=
GPIO_PSour1
) || \

301 ((
PINSOURCE
=
GPIO_PSour2
) || \

302 ((
PINSOURCE
=
GPIO_PSour3
) || \

303 ((
PINSOURCE
=
GPIO_PSour4
) || \

304 ((
PINSOURCE
=
GPIO_PSour5
) || \

305 ((
PINSOURCE
=
GPIO_PSour6
) || \

306 ((
PINSOURCE
=
GPIO_PSour7
) || \

307 ((
PINSOURCE
=
GPIO_PSour8
) || \

308 ((
PINSOURCE
=
GPIO_PSour9
) || \

309 ((
PINSOURCE
=
GPIO_PSour10
) || \

310 ((
PINSOURCE
=
GPIO_PSour11
) || \

311 ((
PINSOURCE
=
GPIO_PSour12
) || \

312 ((
PINSOURCE
=
GPIO_PSour13
) || \

313 ((
PINSOURCE
=
GPIO_PSour14
) || \

314 ((
PINSOURCE
=
GPIO_PSour15
))

	)

323 
	#GPIO_ETH_MedI_MII
 ((
u32
)0x00000000)

	)

324 
	#GPIO_ETH_MedI_RMII
 ((
u32
)0x00000001)

	)

326 
	#IS_GPIO_ETH_MEDIA_INTERFACE
(
INTERFACE
(((INTERFACE=
GPIO_ETH_MedI_MII
) || \

327 ((
INTERFACE
=
GPIO_ETH_MedI_RMII
))

	)

348 
GPIO_DeIn
(
GPIO_TyDef
* 
GPIOx
);

349 
GPIO_AFIODeIn
();

350 
GPIO_In
(
GPIO_TyDef
* 
GPIOx
, 
GPIO_InTyDef
* 
GPIO_InSu
);

351 
GPIO_SuIn
(
GPIO_InTyDef
* 
GPIO_InSu
);

352 
ut8_t
 
GPIO_RdIutDaB
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
);

353 
ut16_t
 
GPIO_RdIutDa
(
GPIO_TyDef
* 
GPIOx
);

354 
ut8_t
 
GPIO_RdOuutDaB
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
);

355 
ut16_t
 
GPIO_RdOuutDa
(
GPIO_TyDef
* 
GPIOx
);

356 
GPIO_SBs
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
);

357 
GPIO_RetBs
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
);

358 
GPIO_WreB
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
, 
BAi
 
BV
);

359 
GPIO_Wre
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
PtV
);

360 
GPIO_PLockCfig
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
);

361 
GPIO_EvtOuutCfig
(
ut8_t
 
GPIO_PtSour
, ut8_
GPIO_PSour
);

362 
GPIO_EvtOuutCmd
(
FuniڮS
 
NewS
);

363 
GPIO_PRemCfig
(
ut32_t
 
GPIO_Rem
, 
FuniڮS
 
NewS
);

364 
GPIO_EXTILeCfig
(
ut8_t
 
GPIO_PtSour
, ut8_
GPIO_PSour
);

365 
GPIO_ETH_MedICfig
(
ut32_t
 
GPIO_ETH_MedI
);

367 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_i2c.h

23 #ide
__STM32F10x_I2C_H


24 
	#__STM32F10x_I2C_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
ut32_t
 
I2C_ClockSed
;

54 
ut16_t
 
I2C_Mode
;

57 
ut16_t
 
I2C_DutyCye
;

60 
ut16_t
 
I2C_OwnAddss1
;

63 
ut16_t
 
I2C_Ack
;

66 
ut16_t
 
I2C_AcknowdgedAddss
;

68 }
	tI2C_InTyDef
;

79 
	#IS_I2C_ALL_PERIPH
(
PERIPH
(((PERIPH=
I2C1
) || \

80 ((
PERIPH
=
I2C2
))

	)

85 
	#I2C_Mode_I2C
 ((
ut16_t
)0x0000)

	)

86 
	#I2C_Mode_SMBusDevi
 ((
ut16_t
)0x0002)

	)

87 
	#I2C_Mode_SMBusHo
 ((
ut16_t
)0x000A)

	)

88 
	#IS_I2C_MODE
(
MODE
(((MODE=
I2C_Mode_I2C
) || \

89 ((
MODE
=
I2C_Mode_SMBusDevi
) || \

90 ((
MODE
=
I2C_Mode_SMBusHo
))

	)

99 
	#I2C_DutyCye_16_9
 ((
ut16_t
)0x4000

	)

100 
	#I2C_DutyCye_2
 ((
ut16_t
)0xBFFF

	)

101 
	#IS_I2C_DUTY_CYCLE
(
CYCLE
(((CYCLE=
I2C_DutyCye_16_9
) || \

102 ((
CYCLE
=
I2C_DutyCye_2
))

	)

111 
	#I2C_Ack_Eb
 ((
ut16_t
)0x0400)

	)

112 
	#I2C_Ack_Dib
 ((
ut16_t
)0x0000)

	)

113 
	#IS_I2C_ACK_STATE
(
STATE
(((STATE=
I2C_Ack_Eb
) || \

114 ((
STATE
=
I2C_Ack_Dib
))

	)

123 
	#I2C_Dei_Tnsmr
 ((
ut8_t
)0x00)

	)

124 
	#I2C_Dei_Reiv
 ((
ut8_t
)0x01)

	)

125 
	#IS_I2C_DIRECTION
(
DIRECTION
(((DIRECTION=
I2C_Dei_Tnsmr
) || \

126 ((
DIRECTION
=
I2C_Dei_Reiv
))

	)

135 
	#I2C_AcknowdgedAddss_7b
 ((
ut16_t
)0x4000)

	)

136 
	#I2C_AcknowdgedAddss_10b
 ((
ut16_t
)0xC000)

	)

137 
	#IS_I2C_ACKNOWLEDGE_ADDRESS
(
ADDRESS
(((ADDRESS=
I2C_AcknowdgedAddss_7b
) || \

138 ((
ADDRESS
=
I2C_AcknowdgedAddss_10b
))

	)

147 
	#I2C_Regi_CR1
 ((
ut8_t
)0x00)

	)

148 
	#I2C_Regi_CR2
 ((
ut8_t
)0x04)

	)

149 
	#I2C_Regi_OAR1
 ((
ut8_t
)0x08)

	)

150 
	#I2C_Regi_OAR2
 ((
ut8_t
)0x0C)

	)

151 
	#I2C_Regi_DR
 ((
ut8_t
)0x10)

	)

152 
	#I2C_Regi_SR1
 ((
ut8_t
)0x14)

	)

153 
	#I2C_Regi_SR2
 ((
ut8_t
)0x18)

	)

154 
	#I2C_Regi_CCR
 ((
ut8_t
)0x1C)

	)

155 
	#I2C_Regi_TRISE
 ((
ut8_t
)0x20)

	)

156 
	#IS_I2C_REGISTER
(
REGISTER
(((REGISTER=
I2C_Regi_CR1
) || \

157 ((
REGISTER
=
I2C_Regi_CR2
) || \

158 ((
REGISTER
=
I2C_Regi_OAR1
) || \

159 ((
REGISTER
=
I2C_Regi_OAR2
) || \

160 ((
REGISTER
=
I2C_Regi_DR
) || \

161 ((
REGISTER
=
I2C_Regi_SR1
) || \

162 ((
REGISTER
=
I2C_Regi_SR2
) || \

163 ((
REGISTER
=
I2C_Regi_CCR
) || \

164 ((
REGISTER
=
I2C_Regi_TRISE
))

	)

173 
	#I2C_SMBusA˹_Low
 ((
ut16_t
)0x2000)

	)

174 
	#I2C_SMBusA˹_High
 ((
ut16_t
)0xDFFF)

	)

175 
	#IS_I2C_SMBUS_ALERT
(
ALERT
(((ALERT=
I2C_SMBusA˹_Low
) || \

176 ((
ALERT
=
I2C_SMBusA˹_High
))

	)

185 
	#I2C_PECPosi_Next
 ((
ut16_t
)0x0800)

	)

186 
	#I2C_PECPosi_Cut
 ((
ut16_t
)0xF7FF)

	)

187 
	#IS_I2C_PEC_POSITION
(
POSITION
(((POSITION=
I2C_PECPosi_Next
) || \

188 ((
POSITION
=
I2C_PECPosi_Cut
))

	)

197 
	#I2C_IT_BUF
 ((
ut16_t
)0x0400)

	)

198 
	#I2C_IT_EVT
 ((
ut16_t
)0x0200)

	)

199 
	#I2C_IT_ERR
 ((
ut16_t
)0x0100)

	)

200 
	#IS_I2C_CONFIG_IT
(
IT
((((IT& (
ut16_t
)0xF8FF=0x00&& ((IT!0x00))

	)

209 
	#I2C_IT_SMBALERT
 ((
ut32_t
)0x01008000)

	)

210 
	#I2C_IT_TIMEOUT
 ((
ut32_t
)0x01004000)

	)

211 
	#I2C_IT_PECERR
 ((
ut32_t
)0x01001000)

	)

212 
	#I2C_IT_OVR
 ((
ut32_t
)0x01000800)

	)

213 
	#I2C_IT_AF
 ((
ut32_t
)0x01000400)

	)

214 
	#I2C_IT_ARLO
 ((
ut32_t
)0x01000200)

	)

215 
	#I2C_IT_BERR
 ((
ut32_t
)0x01000100)

	)

216 
	#I2C_IT_TXE
 ((
ut32_t
)0x06000080)

	)

217 
	#I2C_IT_RXNE
 ((
ut32_t
)0x06000040)

	)

218 
	#I2C_IT_STOPF
 ((
ut32_t
)0x02000010)

	)

219 
	#I2C_IT_ADD10
 ((
ut32_t
)0x02000008)

	)

220 
	#I2C_IT_BTF
 ((
ut32_t
)0x02000004)

	)

221 
	#I2C_IT_ADDR
 ((
ut32_t
)0x02000002)

	)

222 
	#I2C_IT_SB
 ((
ut32_t
)0x02000001)

	)

224 
	#IS_I2C_CLEAR_IT
(
IT
((((IT& (
ut16_t
)0x20FF=0x00&& ((IT!(ut16_t)0x00))

	)

226 
	#IS_I2C_GET_IT
(
IT
(((IT=
I2C_IT_SMBALERT
|| ((IT=
I2C_IT_TIMEOUT
) || \

227 ((
IT
=
I2C_IT_PECERR
|| ((IT=
I2C_IT_OVR
) || \

228 ((
IT
=
I2C_IT_AF
|| ((IT=
I2C_IT_ARLO
) || \

229 ((
IT
=
I2C_IT_BERR
|| ((IT=
I2C_IT_TXE
) || \

230 ((
IT
=
I2C_IT_RXNE
|| ((IT=
I2C_IT_STOPF
) || \

231 ((
IT
=
I2C_IT_ADD10
|| ((IT=
I2C_IT_BTF
) || \

232 ((
IT
=
I2C_IT_ADDR
|| ((IT=
I2C_IT_SB
))

	)

245 
	#I2C_FLAG_DUALF
 ((
ut32_t
)0x00800000)

	)

246 
	#I2C_FLAG_SMBHOST
 ((
ut32_t
)0x00400000)

	)

247 
	#I2C_FLAG_SMBDEFAULT
 ((
ut32_t
)0x00200000)

	)

248 
	#I2C_FLAG_GENCALL
 ((
ut32_t
)0x00100000)

	)

249 
	#I2C_FLAG_TRA
 ((
ut32_t
)0x00040000)

	)

250 
	#I2C_FLAG_BUSY
 ((
ut32_t
)0x00020000)

	)

251 
	#I2C_FLAG_MSL
 ((
ut32_t
)0x00010000)

	)

257 
	#I2C_FLAG_SMBALERT
 ((
ut32_t
)0x10008000)

	)

258 
	#I2C_FLAG_TIMEOUT
 ((
ut32_t
)0x10004000)

	)

259 
	#I2C_FLAG_PECERR
 ((
ut32_t
)0x10001000)

	)

260 
	#I2C_FLAG_OVR
 ((
ut32_t
)0x10000800)

	)

261 
	#I2C_FLAG_AF
 ((
ut32_t
)0x10000400)

	)

262 
	#I2C_FLAG_ARLO
 ((
ut32_t
)0x10000200)

	)

263 
	#I2C_FLAG_BERR
 ((
ut32_t
)0x10000100)

	)

264 
	#I2C_FLAG_TXE
 ((
ut32_t
)0x10000080)

	)

265 
	#I2C_FLAG_RXNE
 ((
ut32_t
)0x10000040)

	)

266 
	#I2C_FLAG_STOPF
 ((
ut32_t
)0x10000010)

	)

267 
	#I2C_FLAG_ADD10
 ((
ut32_t
)0x10000008)

	)

268 
	#I2C_FLAG_BTF
 ((
ut32_t
)0x10000004)

	)

269 
	#I2C_FLAG_ADDR
 ((
ut32_t
)0x10000002)

	)

270 
	#I2C_FLAG_SB
 ((
ut32_t
)0x10000001)

	)

272 
	#IS_I2C_CLEAR_FLAG
(
FLAG
((((FLAG& (
ut16_t
)0x20FF=0x00&& ((FLAG!(ut16_t)0x00))

	)

274 
	#IS_I2C_GET_FLAG
(
FLAG
(((FLAG=
I2C_FLAG_DUALF
|| ((FLAG=
I2C_FLAG_SMBHOST
) || \

275 ((
FLAG
=
I2C_FLAG_SMBDEFAULT
|| ((FLAG=
I2C_FLAG_GENCALL
) || \

276 ((
FLAG
=
I2C_FLAG_TRA
|| ((FLAG=
I2C_FLAG_BUSY
) || \

277 ((
FLAG
=
I2C_FLAG_MSL
|| ((FLAG=
I2C_FLAG_SMBALERT
) || \

278 ((
FLAG
=
I2C_FLAG_TIMEOUT
|| ((FLAG=
I2C_FLAG_PECERR
) || \

279 ((
FLAG
=
I2C_FLAG_OVR
|| ((FLAG=
I2C_FLAG_AF
) || \

280 ((
FLAG
=
I2C_FLAG_ARLO
|| ((FLAG=
I2C_FLAG_BERR
) || \

281 ((
FLAG
=
I2C_FLAG_TXE
|| ((FLAG=
I2C_FLAG_RXNE
) || \

282 ((
FLAG
=
I2C_FLAG_STOPF
|| ((FLAG=
I2C_FLAG_ADD10
) || \

283 ((
FLAG
=
I2C_FLAG_BTF
|| ((FLAG=
I2C_FLAG_ADDR
) || \

284 ((
FLAG
=
I2C_FLAG_SB
))

	)

306 
	#I2C_EVENT_MASTER_MODE_SELECT
 ((
ut32_t
)0x00030001

	)

334 
	#I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED
 ((
ut32_t
)0x00070082

	)

335 
	#I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED
 ((
ut32_t
)0x00030002

	)

337 
	#I2C_EVENT_MASTER_MODE_ADDRESS10
 ((
ut32_t
)0x00030008

	)

370 
	#I2C_EVENT_MASTER_BYTE_RECEIVED
 ((
ut32_t
)0x00030040

	)

374 
	#I2C_EVENT_MASTER_BYTE_TRANSMITTING
 ((
ut32_t
)0x00070080

	)

376 
	#I2C_EVENT_MASTER_BYTE_TRANSMITTED
 ((
ut32_t
)0x00070084

	)

411 
	#I2C_EVENT_SLAVE_RECEIVER_ADDRESS_MATCHED
 ((
ut32_t
)0x00020002

	)

412 
	#I2C_EVENT_SLAVE_TRANSMITTER_ADDRESS_MATCHED
 ((
ut32_t
)0x00060082

	)

415 
	#I2C_EVENT_SLAVE_RECEIVER_SECONDADDRESS_MATCHED
 ((
ut32_t
)0x00820000

	)

416 
	#I2C_EVENT_SLAVE_TRANSMITTER_SECONDADDRESS_MATCHED
 ((
ut32_t
)0x00860080

	)

419 
	#I2C_EVENT_SLAVE_GENERALCALLADDRESS_MATCHED
 ((
ut32_t
)0x00120000

	)

450 
	#I2C_EVENT_SLAVE_BYTE_RECEIVED
 ((
ut32_t
)0x00020040

	)

452 
	#I2C_EVENT_SLAVE_STOP_DETECTED
 ((
ut32_t
)0x00000010

	)

456 
	#I2C_EVENT_SLAVE_BYTE_TRANSMITTED
 ((
ut32_t
)0x00060084

	)

457 
	#I2C_EVENT_SLAVE_BYTE_TRANSMITTING
 ((
ut32_t
)0x00060080

	)

459 
	#I2C_EVENT_SLAVE_ACK_FAILURE
 ((
ut32_t
)0x00000400

	)

463 
	#IS_I2C_EVENT
(
EVENT
(((EVENT=
I2C_EVENT_SLAVE_TRANSMITTER_ADDRESS_MATCHED
) || \

464 ((
EVENT
=
I2C_EVENT_SLAVE_RECEIVER_ADDRESS_MATCHED
) || \

465 ((
EVENT
=
I2C_EVENT_SLAVE_TRANSMITTER_SECONDADDRESS_MATCHED
) || \

466 ((
EVENT
=
I2C_EVENT_SLAVE_RECEIVER_SECONDADDRESS_MATCHED
) || \

467 ((
EVENT
=
I2C_EVENT_SLAVE_GENERALCALLADDRESS_MATCHED
) || \

468 ((
EVENT
=
I2C_EVENT_SLAVE_BYTE_RECEIVED
) || \

469 ((
EVENT
=(
I2C_EVENT_SLAVE_BYTE_RECEIVED
 | 
I2C_FLAG_DUALF
)) || \

470 ((
EVENT
=(
I2C_EVENT_SLAVE_BYTE_RECEIVED
 | 
I2C_FLAG_GENCALL
)) || \

471 ((
EVENT
=
I2C_EVENT_SLAVE_BYTE_TRANSMITTED
) || \

472 ((
EVENT
=(
I2C_EVENT_SLAVE_BYTE_TRANSMITTED
 | 
I2C_FLAG_DUALF
)) || \

473 ((
EVENT
=(
I2C_EVENT_SLAVE_BYTE_TRANSMITTED
 | 
I2C_FLAG_GENCALL
)) || \

474 ((
EVENT
=
I2C_EVENT_SLAVE_STOP_DETECTED
) || \

475 ((
EVENT
=
I2C_EVENT_MASTER_MODE_SELECT
) || \

476 ((
EVENT
=
I2C_EVENT_MASTER_TRANSMITTER_MODE_SELECTED
) || \

477 ((
EVENT
=
I2C_EVENT_MASTER_RECEIVER_MODE_SELECTED
) || \

478 ((
EVENT
=
I2C_EVENT_MASTER_BYTE_RECEIVED
) || \

479 ((
EVENT
=
I2C_EVENT_MASTER_BYTE_TRANSMITTED
) || \

480 ((
EVENT
=
I2C_EVENT_MASTER_BYTE_TRANSMITTING
) || \

481 ((
EVENT
=
I2C_EVENT_MASTER_MODE_ADDRESS10
) || \

482 ((
EVENT
=
I2C_EVENT_SLAVE_ACK_FAILURE
))

	)

491 
	#IS_I2C_OWN_ADDRESS1
(
ADDRESS1
((ADDRESS1<0x3FF)

	)

500 
	#IS_I2C_CLOCK_SPEED
(
SPEED
(((SPEED>0x1&& ((SPEED<400000))

	)

521 
I2C_DeIn
(
I2C_TyDef
* 
I2Cx
);

522 
I2C_In
(
I2C_TyDef
* 
I2Cx
, 
I2C_InTyDef
* 
I2C_InSu
);

523 
I2C_SuIn
(
I2C_InTyDef
* 
I2C_InSu
);

524 
I2C_Cmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

525 
I2C_DMACmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

526 
I2C_DMALaTnsrCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

527 
I2C_GeSTART
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

528 
I2C_GeSTOP
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

529 
I2C_AcknowdgeCfig
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

530 
I2C_OwnAddss2Cfig
(
I2C_TyDef
* 
I2Cx
, 
ut8_t
 
Addss
);

531 
I2C_DuAddssCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

532 
I2C_GClCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

533 
I2C_ITCfig
(
I2C_TyDef
* 
I2Cx
, 
ut16_t
 
I2C_IT
, 
FuniڮS
 
NewS
);

534 
I2C_SdDa
(
I2C_TyDef
* 
I2Cx
, 
ut8_t
 
Da
);

535 
ut8_t
 
I2C_ReiveDa
(
I2C_TyDef
* 
I2Cx
);

536 
I2C_Sd7bAddss
(
I2C_TyDef
* 
I2Cx
, 
ut8_t
 
Addss
, ut8_
I2C_Dei
);

537 
ut16_t
 
I2C_RdRegi
(
I2C_TyDef
* 
I2Cx
, 
ut8_t
 
I2C_Regi
);

538 
I2C_SoweRetCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

539 
I2C_SMBusA˹Cfig
(
I2C_TyDef
* 
I2Cx
, 
ut16_t
 
I2C_SMBusA˹
);

540 
I2C_TnsmPEC
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

541 
I2C_PECPosiCfig
(
I2C_TyDef
* 
I2Cx
, 
ut16_t
 
I2C_PECPosi
);

542 
I2C_CcuϋPEC
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

543 
ut8_t
 
I2C_GPEC
(
I2C_TyDef
* 
I2Cx
);

544 
I2C_ARPCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

545 
I2C_SchClockCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
);

546 
I2C_FaModeDutyCyeCfig
(
I2C_TyDef
* 
I2Cx
, 
ut16_t
 
I2C_DutyCye
);

631 
EStus
 
I2C_CheckEvt
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_EVENT
);

637 
ut32_t
 
I2C_GLaEvt
(
I2C_TyDef
* 
I2Cx
);

643 
FgStus
 
I2C_GFgStus
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_FLAG
);

649 
I2C_CˬFg
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_FLAG
);

650 
ITStus
 
I2C_GITStus
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_IT
);

651 
I2C_CˬITPdgB
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_IT
);

653 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_iwdg.h

23 #ide
__STM32F10x_IWDG_H


24 
	#__STM32F10x_IWDG_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

57 
	#IWDG_WreAcss_Eb
 ((
ut16_t
)0x5555)

	)

58 
	#IWDG_WreAcss_Dib
 ((
ut16_t
)0x0000)

	)

59 
	#IS_IWDG_WRITE_ACCESS
(
ACCESS
(((ACCESS=
IWDG_WreAcss_Eb
) || \

60 ((
ACCESS
=
IWDG_WreAcss_Dib
))

	)

69 
	#IWDG_Psr_4
 ((
ut8_t
)0x00)

	)

70 
	#IWDG_Psr_8
 ((
ut8_t
)0x01)

	)

71 
	#IWDG_Psr_16
 ((
ut8_t
)0x02)

	)

72 
	#IWDG_Psr_32
 ((
ut8_t
)0x03)

	)

73 
	#IWDG_Psr_64
 ((
ut8_t
)0x04)

	)

74 
	#IWDG_Psr_128
 ((
ut8_t
)0x05)

	)

75 
	#IWDG_Psr_256
 ((
ut8_t
)0x06)

	)

76 
	#IS_IWDG_PRESCALER
(
PRESCALER
(((PRESCALER=
IWDG_Psr_4
) || \

77 ((
PRESCALER
=
IWDG_Psr_8
) || \

78 ((
PRESCALER
=
IWDG_Psr_16
) || \

79 ((
PRESCALER
=
IWDG_Psr_32
) || \

80 ((
PRESCALER
=
IWDG_Psr_64
) || \

81 ((
PRESCALER
=
IWDG_Psr_128
)|| \

82 ((
PRESCALER
=
IWDG_Psr_256
))

	)

91 
	#IWDG_FLAG_PVU
 ((
ut16_t
)0x0001)

	)

92 
	#IWDG_FLAG_RVU
 ((
ut16_t
)0x0002)

	)

93 
	#IS_IWDG_FLAG
(
FLAG
(((FLAG=
IWDG_FLAG_PVU
|| ((FLAG=
IWDG_FLAG_RVU
))

	)

94 
	#IS_IWDG_RELOAD
(
RELOAD
((RELOAD<0xFFF)

	)

115 
IWDG_WreAcssCmd
(
ut16_t
 
IWDG_WreAcss
);

116 
IWDG_SPsr
(
ut8_t
 
IWDG_Psr
);

117 
IWDG_SRd
(
ut16_t
 
Rd
);

118 
IWDG_RdCou
();

119 
IWDG_Eb
();

120 
FgStus
 
IWDG_GFgStus
(
ut16_t
 
IWDG_FLAG
);

122 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_misc.h

23 #ide
__STM32F10x_MISC_H


24 
	#__STM32F10x_MISC_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
ut8_t
 
NVIC_IRQChl
;

56 
ut8_t
 
NVIC_IRQChlPemiPriܙy
;

60 
ut8_t
 
NVIC_IRQChlSubPriܙy
;

64 
FuniڮS
 
NVIC_IRQChlCmd
;

67 } 
	tNVIC_InTyDef
;

114 
	#NVIC_VeTab_RAM
 ((
ut32_t
)0x20000000)

	)

115 
	#NVIC_VeTab_FLASH
 ((
ut32_t
)0x08000000)

	)

116 
	#IS_NVIC_VECTTAB
(
VECTTAB
(((VECTTAB=
NVIC_VeTab_RAM
) || \

117 ((
VECTTAB
=
NVIC_VeTab_FLASH
))

	)

126 
	#NVIC_LP_SEVONPEND
 ((
ut8_t
)0x10)

	)

127 
	#NVIC_LP_SLEEPDEEP
 ((
ut8_t
)0x04)

	)

128 
	#NVIC_LP_SLEEPONEXIT
 ((
ut8_t
)0x02)

	)

129 
	#IS_NVIC_LP
(
LP
(((LP=
NVIC_LP_SEVONPEND
) || \

130 ((
LP
=
NVIC_LP_SLEEPDEEP
) || \

131 ((
LP
=
NVIC_LP_SLEEPONEXIT
))

	)

140 
	#NVIC_PriܙyGroup_0
 ((
ut32_t
)0x700

	)

142 
	#NVIC_PriܙyGroup_1
 ((
ut32_t
)0x600

	)

144 
	#NVIC_PriܙyGroup_2
 ((
ut32_t
)0x500

	)

146 
	#NVIC_PriܙyGroup_3
 ((
ut32_t
)0x400

	)

148 
	#NVIC_PriܙyGroup_4
 ((
ut32_t
)0x300

	)

151 
	#IS_NVIC_PRIORITY_GROUP
(
GROUP
(((GROUP=
NVIC_PriܙyGroup_0
) || \

152 ((
GROUP
=
NVIC_PriܙyGroup_1
) || \

153 ((
GROUP
=
NVIC_PriܙyGroup_2
) || \

154 ((
GROUP
=
NVIC_PriܙyGroup_3
) || \

155 ((
GROUP
=
NVIC_PriܙyGroup_4
))

	)

157 
	#IS_NVIC_PREEMPTION_PRIORITY
(
PRIORITY
((PRIORITY< 0x10)

	)

159 
	#IS_NVIC_SUB_PRIORITY
(
PRIORITY
((PRIORITY< 0x10)

	)

161 
	#IS_NVIC_OFFSET
(
OFFSET
((OFFSET< 0x000FFFFF)

	)

171 
	#SysTick_CLKSour_HCLK_Div8
 ((
ut32_t
)0xFFFFFFFB)

	)

172 
	#SysTick_CLKSour_HCLK
 ((
ut32_t
)0x00000004)

	)

173 
	#IS_SYSTICK_CLK_SOURCE
(
SOURCE
(((SOURCE=
SysTick_CLKSour_HCLK
) || \

174 ((
SOURCE
=
SysTick_CLKSour_HCLK_Div8
))

	)

195 
NVIC_PriܙyGroupCfig
(
ut32_t
 
NVIC_PriܙyGroup
);

196 
NVIC_In
(
NVIC_InTyDef
* 
NVIC_InSu
);

197 
NVIC_SVeTab
(
ut32_t
 
NVIC_VeTab
, ut32_
Offt
);

198 
NVIC_SyemLPCfig
(
ut8_t
 
LowPowMode
, 
FuniڮS
 
NewS
);

199 
SysTick_CLKSourCfig
(
ut32_t
 
SysTick_CLKSour
);

201 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_pwr.h

23 #ide
__STM32F10x_PWR_H


24 
	#__STM32F10x_PWR_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

57 
	#PWR_PVDLev_2V2
 ((
ut32_t
)0x00000000)

	)

58 
	#PWR_PVDLev_2V3
 ((
ut32_t
)0x00000020)

	)

59 
	#PWR_PVDLev_2V4
 ((
ut32_t
)0x00000040)

	)

60 
	#PWR_PVDLev_2V5
 ((
ut32_t
)0x00000060)

	)

61 
	#PWR_PVDLev_2V6
 ((
ut32_t
)0x00000080)

	)

62 
	#PWR_PVDLev_2V7
 ((
ut32_t
)0x000000A0)

	)

63 
	#PWR_PVDLev_2V8
 ((
ut32_t
)0x000000C0)

	)

64 
	#PWR_PVDLev_2V9
 ((
ut32_t
)0x000000E0)

	)

65 
	#IS_PWR_PVD_LEVEL
(
LEVEL
(((LEVEL=
PWR_PVDLev_2V2
|| ((LEVEL=
PWR_PVDLev_2V3
)|| \

66 ((
LEVEL
=
PWR_PVDLev_2V4
|| ((LEVEL=
PWR_PVDLev_2V5
)|| \

67 ((
LEVEL
=
PWR_PVDLev_2V6
|| ((LEVEL=
PWR_PVDLev_2V7
)|| \

68 ((
LEVEL
=
PWR_PVDLev_2V8
|| ((LEVEL=
PWR_PVDLev_2V9
))

	)

77 
	#PWR_Regut_ON
 ((
ut32_t
)0x00000000)

	)

78 
	#PWR_Regut_LowPow
 ((
ut32_t
)0x00000001)

	)

79 
	#IS_PWR_REGULATOR
(
REGULATOR
(((REGULATOR=
PWR_Regut_ON
) || \

80 ((
REGULATOR
=
PWR_Regut_LowPow
))

	)

89 
	#PWR_STOPEry_WFI
 ((
ut8_t
)0x01)

	)

90 
	#PWR_STOPEry_WFE
 ((
ut8_t
)0x02)

	)

91 
	#IS_PWR_STOP_ENTRY
(
ENTRY
(((ENTRY=
PWR_STOPEry_WFI
|| ((ENTRY=
PWR_STOPEry_WFE
))

	)

101 
	#PWR_FLAG_WU
 ((
ut32_t
)0x00000001)

	)

102 
	#PWR_FLAG_SB
 ((
ut32_t
)0x00000002)

	)

103 
	#PWR_FLAG_PVDO
 ((
ut32_t
)0x00000004)

	)

104 
	#IS_PWR_GET_FLAG
(
FLAG
(((FLAG=
PWR_FLAG_WU
|| ((FLAG=
PWR_FLAG_SB
) || \

105 ((
FLAG
=
PWR_FLAG_PVDO
))

	)

107 
	#IS_PWR_CLEAR_FLAG
(
FLAG
(((FLAG=
PWR_FLAG_WU
|| ((FLAG=
PWR_FLAG_SB
))

	)

128 
PWR_DeIn
();

129 
PWR_BackupAcssCmd
(
FuniڮS
 
NewS
);

130 
PWR_PVDCmd
(
FuniڮS
 
NewS
);

131 
PWR_PVDLevCfig
(
ut32_t
 
PWR_PVDLev
);

132 
PWR_WakeUpPCmd
(
FuniڮS
 
NewS
);

133 
PWR_ESTOPMode
(
ut32_t
 
PWR_Regut
, 
ut8_t
 
PWR_STOPEry
);

134 
PWR_ESTANDBYMode
();

135 
FgStus
 
PWR_GFgStus
(
ut32_t
 
PWR_FLAG
);

136 
PWR_CˬFg
(
ut32_t
 
PWR_FLAG
);

138 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_rcc.h

23 #ide
__STM32F10x_RCC_H


24 
	#__STM32F10x_RCC_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

47 
ut32_t
 
SYSCLK_Fqucy
;

48 
ut32_t
 
HCLK_Fqucy
;

49 
ut32_t
 
PCLK1_Fqucy
;

50 
ut32_t
 
PCLK2_Fqucy
;

51 
ut32_t
 
ADCCLK_Fqucy
;

52 }
	tRCC_ClocksTyDef
;

66 
	#RCC_HSE_OFF
 ((
ut32_t
)0x00000000)

	)

67 
	#RCC_HSE_ON
 ((
ut32_t
)0x00010000)

	)

68 
	#RCC_HSE_Byss
 ((
ut32_t
)0x00040000)

	)

69 
	#IS_RCC_HSE
(
HSE
(((HSE=
RCC_HSE_OFF
|| ((HSE=
RCC_HSE_ON
) || \

70 ((
HSE
=
RCC_HSE_Byss
))

	)

80 
	#RCC_PLLSour_HSI_Div2
 ((
ut32_t
)0x00000000)

	)

82 #i!
defed
 (
STM32F10X_LD_VL
&& !defed (
STM32F10X_MD_VL
&& !defed (
STM32F10X_HD_VL
&& !defed (
STM32F10X_CL
)

83 
	#RCC_PLLSour_HSE_Div1
 ((
ut32_t
)0x00010000)

	)

84 
	#RCC_PLLSour_HSE_Div2
 ((
ut32_t
)0x00030000)

	)

85 
	#IS_RCC_PLL_SOURCE
(
SOURCE
(((SOURCE=
RCC_PLLSour_HSI_Div2
) || \

86 ((
SOURCE
=
RCC_PLLSour_HSE_Div1
) || \

87 ((
SOURCE
=
RCC_PLLSour_HSE_Div2
))

	)

89 
	#RCC_PLLSour_PREDIV1
 ((
ut32_t
)0x00010000)

	)

90 
	#IS_RCC_PLL_SOURCE
(
SOURCE
(((SOURCE=
RCC_PLLSour_HSI_Div2
) || \

91 ((
SOURCE
=
RCC_PLLSour_PREDIV1
))

	)

101 #ide
STM32F10X_CL


102 
	#RCC_PLLMul_2
 ((
ut32_t
)0x00000000)

	)

103 
	#RCC_PLLMul_3
 ((
ut32_t
)0x00040000)

	)

104 
	#RCC_PLLMul_4
 ((
ut32_t
)0x00080000)

	)

105 
	#RCC_PLLMul_5
 ((
ut32_t
)0x000C0000)

	)

106 
	#RCC_PLLMul_6
 ((
ut32_t
)0x00100000)

	)

107 
	#RCC_PLLMul_7
 ((
ut32_t
)0x00140000)

	)

108 
	#RCC_PLLMul_8
 ((
ut32_t
)0x00180000)

	)

109 
	#RCC_PLLMul_9
 ((
ut32_t
)0x001C0000)

	)

110 
	#RCC_PLLMul_10
 ((
ut32_t
)0x00200000)

	)

111 
	#RCC_PLLMul_11
 ((
ut32_t
)0x00240000)

	)

112 
	#RCC_PLLMul_12
 ((
ut32_t
)0x00280000)

	)

113 
	#RCC_PLLMul_13
 ((
ut32_t
)0x002C0000)

	)

114 
	#RCC_PLLMul_14
 ((
ut32_t
)0x00300000)

	)

115 
	#RCC_PLLMul_15
 ((
ut32_t
)0x00340000)

	)

116 
	#RCC_PLLMul_16
 ((
ut32_t
)0x00380000)

	)

117 
	#IS_RCC_PLL_MUL
(
MUL
(((MUL=
RCC_PLLMul_2
|| ((MUL=
RCC_PLLMul_3
) || \

118 ((
MUL
=
RCC_PLLMul_4
|| ((MUL=
RCC_PLLMul_5
) || \

119 ((
MUL
=
RCC_PLLMul_6
|| ((MUL=
RCC_PLLMul_7
) || \

120 ((
MUL
=
RCC_PLLMul_8
|| ((MUL=
RCC_PLLMul_9
) || \

121 ((
MUL
=
RCC_PLLMul_10
|| ((MUL=
RCC_PLLMul_11
) || \

122 ((
MUL
=
RCC_PLLMul_12
|| ((MUL=
RCC_PLLMul_13
) || \

123 ((
MUL
=
RCC_PLLMul_14
|| ((MUL=
RCC_PLLMul_15
) || \

124 ((
MUL
=
RCC_PLLMul_16
))

	)

127 
	#RCC_PLLMul_4
 ((
ut32_t
)0x00080000)

	)

128 
	#RCC_PLLMul_5
 ((
ut32_t
)0x000C0000)

	)

129 
	#RCC_PLLMul_6
 ((
ut32_t
)0x00100000)

	)

130 
	#RCC_PLLMul_7
 ((
ut32_t
)0x00140000)

	)

131 
	#RCC_PLLMul_8
 ((
ut32_t
)0x00180000)

	)

132 
	#RCC_PLLMul_9
 ((
ut32_t
)0x001C0000)

	)

133 
	#RCC_PLLMul_6_5
 ((
ut32_t
)0x00340000)

	)

135 
	#IS_RCC_PLL_MUL
(
MUL
(((MUL=
RCC_PLLMul_4
|| ((MUL=
RCC_PLLMul_5
) || \

136 ((
MUL
=
RCC_PLLMul_6
|| ((MUL=
RCC_PLLMul_7
) || \

137 ((
MUL
=
RCC_PLLMul_8
|| ((MUL=
RCC_PLLMul_9
) || \

138 ((
MUL
=
RCC_PLLMul_6_5
))

	)

147 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
|| defed (
STM32F10X_CL
)

148 
	#RCC_PREDIV1_Div1
 ((
ut32_t
)0x00000000)

	)

149 
	#RCC_PREDIV1_Div2
 ((
ut32_t
)0x00000001)

	)

150 
	#RCC_PREDIV1_Div3
 ((
ut32_t
)0x00000002)

	)

151 
	#RCC_PREDIV1_Div4
 ((
ut32_t
)0x00000003)

	)

152 
	#RCC_PREDIV1_Div5
 ((
ut32_t
)0x00000004)

	)

153 
	#RCC_PREDIV1_Div6
 ((
ut32_t
)0x00000005)

	)

154 
	#RCC_PREDIV1_Div7
 ((
ut32_t
)0x00000006)

	)

155 
	#RCC_PREDIV1_Div8
 ((
ut32_t
)0x00000007)

	)

156 
	#RCC_PREDIV1_Div9
 ((
ut32_t
)0x00000008)

	)

157 
	#RCC_PREDIV1_Div10
 ((
ut32_t
)0x00000009)

	)

158 
	#RCC_PREDIV1_Div11
 ((
ut32_t
)0x0000000A)

	)

159 
	#RCC_PREDIV1_Div12
 ((
ut32_t
)0x0000000B)

	)

160 
	#RCC_PREDIV1_Div13
 ((
ut32_t
)0x0000000C)

	)

161 
	#RCC_PREDIV1_Div14
 ((
ut32_t
)0x0000000D)

	)

162 
	#RCC_PREDIV1_Div15
 ((
ut32_t
)0x0000000E)

	)

163 
	#RCC_PREDIV1_Div16
 ((
ut32_t
)0x0000000F)

	)

165 
	#IS_RCC_PREDIV1
(
PREDIV1
(((PREDIV1=
RCC_PREDIV1_Div1
|| ((PREDIV1=
RCC_PREDIV1_Div2
) || \

166 ((
PREDIV1
=
RCC_PREDIV1_Div3
|| ((PREDIV1=
RCC_PREDIV1_Div4
) || \

167 ((
PREDIV1
=
RCC_PREDIV1_Div5
|| ((PREDIV1=
RCC_PREDIV1_Div6
) || \

168 ((
PREDIV1
=
RCC_PREDIV1_Div7
|| ((PREDIV1=
RCC_PREDIV1_Div8
) || \

169 ((
PREDIV1
=
RCC_PREDIV1_Div9
|| ((PREDIV1=
RCC_PREDIV1_Div10
) || \

170 ((
PREDIV1
=
RCC_PREDIV1_Div11
|| ((PREDIV1=
RCC_PREDIV1_Div12
) || \

171 ((
PREDIV1
=
RCC_PREDIV1_Div13
|| ((PREDIV1=
RCC_PREDIV1_Div14
) || \

172 ((
PREDIV1
=
RCC_PREDIV1_Div15
|| ((PREDIV1=
RCC_PREDIV1_Div16
))

	)

182 #ifde
STM32F10X_CL


184 
	#RCC_PREDIV1_Sour_HSE
 ((
ut32_t
)0x00000000)

	)

185 
	#RCC_PREDIV1_Sour_PLL2
 ((
ut32_t
)0x00010000)

	)

187 
	#IS_RCC_PREDIV1_SOURCE
(
SOURCE
(((SOURCE=
RCC_PREDIV1_Sour_HSE
) || \

188 ((
SOURCE
=
RCC_PREDIV1_Sour_PLL2
))

	)

189 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

191 
	#RCC_PREDIV1_Sour_HSE
 ((
ut32_t
)0x00000000)

	)

193 
	#IS_RCC_PREDIV1_SOURCE
(
SOURCE
(((SOURCE=
RCC_PREDIV1_Sour_HSE
))

	)

199 #ifde
STM32F10X_CL


204 
	#RCC_PREDIV2_Div1
 ((
ut32_t
)0x00000000)

	)

205 
	#RCC_PREDIV2_Div2
 ((
ut32_t
)0x00000010)

	)

206 
	#RCC_PREDIV2_Div3
 ((
ut32_t
)0x00000020)

	)

207 
	#RCC_PREDIV2_Div4
 ((
ut32_t
)0x00000030)

	)

208 
	#RCC_PREDIV2_Div5
 ((
ut32_t
)0x00000040)

	)

209 
	#RCC_PREDIV2_Div6
 ((
ut32_t
)0x00000050)

	)

210 
	#RCC_PREDIV2_Div7
 ((
ut32_t
)0x00000060)

	)

211 
	#RCC_PREDIV2_Div8
 ((
ut32_t
)0x00000070)

	)

212 
	#RCC_PREDIV2_Div9
 ((
ut32_t
)0x00000080)

	)

213 
	#RCC_PREDIV2_Div10
 ((
ut32_t
)0x00000090)

	)

214 
	#RCC_PREDIV2_Div11
 ((
ut32_t
)0x000000A0)

	)

215 
	#RCC_PREDIV2_Div12
 ((
ut32_t
)0x000000B0)

	)

216 
	#RCC_PREDIV2_Div13
 ((
ut32_t
)0x000000C0)

	)

217 
	#RCC_PREDIV2_Div14
 ((
ut32_t
)0x000000D0)

	)

218 
	#RCC_PREDIV2_Div15
 ((
ut32_t
)0x000000E0)

	)

219 
	#RCC_PREDIV2_Div16
 ((
ut32_t
)0x000000F0)

	)

221 
	#IS_RCC_PREDIV2
(
PREDIV2
(((PREDIV2=
RCC_PREDIV2_Div1
|| ((PREDIV2=
RCC_PREDIV2_Div2
) || \

222 ((
PREDIV2
=
RCC_PREDIV2_Div3
|| ((PREDIV2=
RCC_PREDIV2_Div4
) || \

223 ((
PREDIV2
=
RCC_PREDIV2_Div5
|| ((PREDIV2=
RCC_PREDIV2_Div6
) || \

224 ((
PREDIV2
=
RCC_PREDIV2_Div7
|| ((PREDIV2=
RCC_PREDIV2_Div8
) || \

225 ((
PREDIV2
=
RCC_PREDIV2_Div9
|| ((PREDIV2=
RCC_PREDIV2_Div10
) || \

226 ((
PREDIV2
=
RCC_PREDIV2_Div11
|| ((PREDIV2=
RCC_PREDIV2_Div12
) || \

227 ((
PREDIV2
=
RCC_PREDIV2_Div13
|| ((PREDIV2=
RCC_PREDIV2_Div14
) || \

228 ((
PREDIV2
=
RCC_PREDIV2_Div15
|| ((PREDIV2=
RCC_PREDIV2_Div16
))

	)

238 
	#RCC_PLL2Mul_8
 ((
ut32_t
)0x00000600)

	)

239 
	#RCC_PLL2Mul_9
 ((
ut32_t
)0x00000700)

	)

240 
	#RCC_PLL2Mul_10
 ((
ut32_t
)0x00000800)

	)

241 
	#RCC_PLL2Mul_11
 ((
ut32_t
)0x00000900)

	)

242 
	#RCC_PLL2Mul_12
 ((
ut32_t
)0x00000A00)

	)

243 
	#RCC_PLL2Mul_13
 ((
ut32_t
)0x00000B00)

	)

244 
	#RCC_PLL2Mul_14
 ((
ut32_t
)0x00000C00)

	)

245 
	#RCC_PLL2Mul_16
 ((
ut32_t
)0x00000E00)

	)

246 
	#RCC_PLL2Mul_20
 ((
ut32_t
)0x00000F00)

	)

248 
	#IS_RCC_PLL2_MUL
(
MUL
(((MUL=
RCC_PLL2Mul_8
|| ((MUL=
RCC_PLL2Mul_9
) || \

249 ((
MUL
=
RCC_PLL2Mul_10
|| ((MUL=
RCC_PLL2Mul_11
) || \

250 ((
MUL
=
RCC_PLL2Mul_12
|| ((MUL=
RCC_PLL2Mul_13
) || \

251 ((
MUL
=
RCC_PLL2Mul_14
|| ((MUL=
RCC_PLL2Mul_16
) || \

252 ((
MUL
=
RCC_PLL2Mul_20
))

	)

262 
	#RCC_PLL3Mul_8
 ((
ut32_t
)0x00006000)

	)

263 
	#RCC_PLL3Mul_9
 ((
ut32_t
)0x00007000)

	)

264 
	#RCC_PLL3Mul_10
 ((
ut32_t
)0x00008000)

	)

265 
	#RCC_PLL3Mul_11
 ((
ut32_t
)0x00009000)

	)

266 
	#RCC_PLL3Mul_12
 ((
ut32_t
)0x0000A000)

	)

267 
	#RCC_PLL3Mul_13
 ((
ut32_t
)0x0000B000)

	)

268 
	#RCC_PLL3Mul_14
 ((
ut32_t
)0x0000C000)

	)

269 
	#RCC_PLL3Mul_16
 ((
ut32_t
)0x0000E000)

	)

270 
	#RCC_PLL3Mul_20
 ((
ut32_t
)0x0000F000)

	)

272 
	#IS_RCC_PLL3_MUL
(
MUL
(((MUL=
RCC_PLL3Mul_8
|| ((MUL=
RCC_PLL3Mul_9
) || \

273 ((
MUL
=
RCC_PLL3Mul_10
|| ((MUL=
RCC_PLL3Mul_11
) || \

274 ((
MUL
=
RCC_PLL3Mul_12
|| ((MUL=
RCC_PLL3Mul_13
) || \

275 ((
MUL
=
RCC_PLL3Mul_14
|| ((MUL=
RCC_PLL3Mul_16
) || \

276 ((
MUL
=
RCC_PLL3Mul_20
))

	)

288 
	#RCC_SYSCLKSour_HSI
 ((
ut32_t
)0x00000000)

	)

289 
	#RCC_SYSCLKSour_HSE
 ((
ut32_t
)0x00000001)

	)

290 
	#RCC_SYSCLKSour_PLLCLK
 ((
ut32_t
)0x00000002)

	)

291 
	#IS_RCC_SYSCLK_SOURCE
(
SOURCE
(((SOURCE=
RCC_SYSCLKSour_HSI
) || \

292 ((
SOURCE
=
RCC_SYSCLKSour_HSE
) || \

293 ((
SOURCE
=
RCC_SYSCLKSour_PLLCLK
))

	)

302 
	#RCC_SYSCLK_Div1
 ((
ut32_t
)0x00000000)

	)

303 
	#RCC_SYSCLK_Div2
 ((
ut32_t
)0x00000080)

	)

304 
	#RCC_SYSCLK_Div4
 ((
ut32_t
)0x00000090)

	)

305 
	#RCC_SYSCLK_Div8
 ((
ut32_t
)0x000000A0)

	)

306 
	#RCC_SYSCLK_Div16
 ((
ut32_t
)0x000000B0)

	)

307 
	#RCC_SYSCLK_Div64
 ((
ut32_t
)0x000000C0)

	)

308 
	#RCC_SYSCLK_Div128
 ((
ut32_t
)0x000000D0)

	)

309 
	#RCC_SYSCLK_Div256
 ((
ut32_t
)0x000000E0)

	)

310 
	#RCC_SYSCLK_Div512
 ((
ut32_t
)0x000000F0)

	)

311 
	#IS_RCC_HCLK
(
HCLK
(((HCLK=
RCC_SYSCLK_Div1
|| ((HCLK=
RCC_SYSCLK_Div2
) || \

312 ((
HCLK
=
RCC_SYSCLK_Div4
|| ((HCLK=
RCC_SYSCLK_Div8
) || \

313 ((
HCLK
=
RCC_SYSCLK_Div16
|| ((HCLK=
RCC_SYSCLK_Div64
) || \

314 ((
HCLK
=
RCC_SYSCLK_Div128
|| ((HCLK=
RCC_SYSCLK_Div256
) || \

315 ((
HCLK
=
RCC_SYSCLK_Div512
))

	)

324 
	#RCC_HCLK_Div1
 ((
ut32_t
)0x00000000)

	)

325 
	#RCC_HCLK_Div2
 ((
ut32_t
)0x00000400)

	)

326 
	#RCC_HCLK_Div4
 ((
ut32_t
)0x00000500)

	)

327 
	#RCC_HCLK_Div8
 ((
ut32_t
)0x00000600)

	)

328 
	#RCC_HCLK_Div16
 ((
ut32_t
)0x00000700)

	)

329 
	#IS_RCC_PCLK
(
PCLK
(((PCLK=
RCC_HCLK_Div1
|| ((PCLK=
RCC_HCLK_Div2
) || \

330 ((
PCLK
=
RCC_HCLK_Div4
|| ((PCLK=
RCC_HCLK_Div8
) || \

331 ((
PCLK
=
RCC_HCLK_Div16
))

	)

340 
	#RCC_IT_LSIRDY
 ((
ut8_t
)0x01)

	)

341 
	#RCC_IT_LSERDY
 ((
ut8_t
)0x02)

	)

342 
	#RCC_IT_HSIRDY
 ((
ut8_t
)0x04)

	)

343 
	#RCC_IT_HSERDY
 ((
ut8_t
)0x08)

	)

344 
	#RCC_IT_PLLRDY
 ((
ut8_t
)0x10)

	)

345 
	#RCC_IT_CSS
 ((
ut8_t
)0x80)

	)

347 #ide
STM32F10X_CL


348 
	#IS_RCC_IT
(
IT
((((IT& (
ut8_t
)0xE0=0x00&& ((IT!0x00))

	)

349 
	#IS_RCC_GET_IT
(
IT
(((IT=
RCC_IT_LSIRDY
|| ((IT=
RCC_IT_LSERDY
) || \

350 ((
IT
=
RCC_IT_HSIRDY
|| ((IT=
RCC_IT_HSERDY
) || \

351 ((
IT
=
RCC_IT_PLLRDY
|| ((IT=
RCC_IT_CSS
))

	)

352 
	#IS_RCC_CLEAR_IT
(
IT
((((IT& (
ut8_t
)0x60=0x00&& ((IT!0x00))

	)

354 
	#RCC_IT_PLL2RDY
 ((
ut8_t
)0x20)

	)

355 
	#RCC_IT_PLL3RDY
 ((
ut8_t
)0x40)

	)

356 
	#IS_RCC_IT
(
IT
((((IT& (
ut8_t
)0x80=0x00&& ((IT!0x00))

	)

357 
	#IS_RCC_GET_IT
(
IT
(((IT=
RCC_IT_LSIRDY
|| ((IT=
RCC_IT_LSERDY
) || \

358 ((
IT
=
RCC_IT_HSIRDY
|| ((IT=
RCC_IT_HSERDY
) || \

359 ((
IT
=
RCC_IT_PLLRDY
|| ((IT=
RCC_IT_CSS
) || \

360 ((
IT
=
RCC_IT_PLL2RDY
|| ((IT=
RCC_IT_PLL3RDY
))

	)

361 
	#IS_RCC_CLEAR_IT
(
IT
((IT!0x00)

	)

369 #ide
STM32F10X_CL


374 
	#RCC_USBCLKSour_PLLCLK_1Div5
 ((
ut8_t
)0x00)

	)

375 
	#RCC_USBCLKSour_PLLCLK_Div1
 ((
ut8_t
)0x01)

	)

377 
	#IS_RCC_USBCLK_SOURCE
(
SOURCE
(((SOURCE=
RCC_USBCLKSour_PLLCLK_1Div5
) || \

378 ((
SOURCE
=
RCC_USBCLKSour_PLLCLK_Div1
))

	)

386 
	#RCC_OTGFSCLKSour_PLLVCO_Div3
 ((
ut8_t
)0x00)

	)

387 
	#RCC_OTGFSCLKSour_PLLVCO_Div2
 ((
ut8_t
)0x01)

	)

389 
	#IS_RCC_OTGFSCLK_SOURCE
(
SOURCE
(((SOURCE=
RCC_OTGFSCLKSour_PLLVCO_Div3
) || \

390 ((
SOURCE
=
RCC_OTGFSCLKSour_PLLVCO_Div2
))

	)

397 #ifde
STM32F10X_CL


401 
	#RCC_I2S2CLKSour_SYSCLK
 ((
ut8_t
)0x00)

	)

402 
	#RCC_I2S2CLKSour_PLL3_VCO
 ((
ut8_t
)0x01)

	)

404 
	#IS_RCC_I2S2CLK_SOURCE
(
SOURCE
(((SOURCE=
RCC_I2S2CLKSour_SYSCLK
) || \

405 ((
SOURCE
=
RCC_I2S2CLKSour_PLL3_VCO
))

	)

413 
	#RCC_I2S3CLKSour_SYSCLK
 ((
ut8_t
)0x00)

	)

414 
	#RCC_I2S3CLKSour_PLL3_VCO
 ((
ut8_t
)0x01)

	)

416 
	#IS_RCC_I2S3CLK_SOURCE
(
SOURCE
(((SOURCE=
RCC_I2S3CLKSour_SYSCLK
) || \

417 ((
SOURCE
=
RCC_I2S3CLKSour_PLL3_VCO
))

	)

428 
	#RCC_PCLK2_Div2
 ((
ut32_t
)0x00000000)

	)

429 
	#RCC_PCLK2_Div4
 ((
ut32_t
)0x00004000)

	)

430 
	#RCC_PCLK2_Div6
 ((
ut32_t
)0x00008000)

	)

431 
	#RCC_PCLK2_Div8
 ((
ut32_t
)0x0000C000)

	)

432 
	#IS_RCC_ADCCLK
(
ADCCLK
(((ADCCLK=
RCC_PCLK2_Div2
|| ((ADCCLK=
RCC_PCLK2_Div4
) || \

433 ((
ADCCLK
=
RCC_PCLK2_Div6
|| ((ADCCLK=
RCC_PCLK2_Div8
))

	)

442 
	#RCC_LSE_OFF
 ((
ut8_t
)0x00)

	)

443 
	#RCC_LSE_ON
 ((
ut8_t
)0x01)

	)

444 
	#RCC_LSE_Byss
 ((
ut8_t
)0x04)

	)

445 
	#IS_RCC_LSE
(
LSE
(((LSE=
RCC_LSE_OFF
|| ((LSE=
RCC_LSE_ON
) || \

446 ((
LSE
=
RCC_LSE_Byss
))

	)

455 
	#RCC_RTCCLKSour_LSE
 ((
ut32_t
)0x00000100)

	)

456 
	#RCC_RTCCLKSour_LSI
 ((
ut32_t
)0x00000200)

	)

457 
	#RCC_RTCCLKSour_HSE_Div128
 ((
ut32_t
)0x00000300)

	)

458 
	#IS_RCC_RTCCLK_SOURCE
(
SOURCE
(((SOURCE=
RCC_RTCCLKSour_LSE
) || \

459 ((
SOURCE
=
RCC_RTCCLKSour_LSI
) || \

460 ((
SOURCE
=
RCC_RTCCLKSour_HSE_Div128
))

	)

469 
	#RCC_AHBPh_DMA1
 ((
ut32_t
)0x00000001)

	)

470 
	#RCC_AHBPh_DMA2
 ((
ut32_t
)0x00000002)

	)

471 
	#RCC_AHBPh_SRAM
 ((
ut32_t
)0x00000004)

	)

472 
	#RCC_AHBPh_FLITF
 ((
ut32_t
)0x00000010)

	)

473 
	#RCC_AHBPh_CRC
 ((
ut32_t
)0x00000040)

	)

475 #ide
STM32F10X_CL


476 
	#RCC_AHBPh_FSMC
 ((
ut32_t
)0x00000100)

	)

477 
	#RCC_AHBPh_SDIO
 ((
ut32_t
)0x00000400)

	)

478 
	#IS_RCC_AHB_PERIPH
(
PERIPH
((((PERIPH& 0xFFFFFAA8=0x00&& ((PERIPH!0x00))

	)

480 
	#RCC_AHBPh_OTG_FS
 ((
ut32_t
)0x00001000)

	)

481 
	#RCC_AHBPh_ETH_MAC
 ((
ut32_t
)0x00004000)

	)

482 
	#RCC_AHBPh_ETH_MAC_Tx
 ((
ut32_t
)0x00008000)

	)

483 
	#RCC_AHBPh_ETH_MAC_Rx
 ((
ut32_t
)0x00010000)

	)

485 
	#IS_RCC_AHB_PERIPH
(
PERIPH
((((PERIPH& 0xFFFE2FA8=0x00&& ((PERIPH!0x00))

	)

486 
	#IS_RCC_AHB_PERIPH_RESET
(
PERIPH
((((PERIPH& 0xFFFFAFFF=0x00&& ((PERIPH!0x00))

	)

496 
	#RCC_APB2Ph_AFIO
 ((
ut32_t
)0x00000001)

	)

497 
	#RCC_APB2Ph_GPIOA
 ((
ut32_t
)0x00000004)

	)

498 
	#RCC_APB2Ph_GPIOB
 ((
ut32_t
)0x00000008)

	)

499 
	#RCC_APB2Ph_GPIOC
 ((
ut32_t
)0x00000010)

	)

500 
	#RCC_APB2Ph_GPIOD
 ((
ut32_t
)0x00000020)

	)

501 
	#RCC_APB2Ph_GPIOE
 ((
ut32_t
)0x00000040)

	)

502 
	#RCC_APB2Ph_GPIOF
 ((
ut32_t
)0x00000080)

	)

503 
	#RCC_APB2Ph_GPIOG
 ((
ut32_t
)0x00000100)

	)

504 
	#RCC_APB2Ph_ADC1
 ((
ut32_t
)0x00000200)

	)

505 
	#RCC_APB2Ph_ADC2
 ((
ut32_t
)0x00000400)

	)

506 
	#RCC_APB2Ph_TIM1
 ((
ut32_t
)0x00000800)

	)

507 
	#RCC_APB2Ph_SPI1
 ((
ut32_t
)0x00001000)

	)

508 
	#RCC_APB2Ph_TIM8
 ((
ut32_t
)0x00002000)

	)

509 
	#RCC_APB2Ph_USART1
 ((
ut32_t
)0x00004000)

	)

510 
	#RCC_APB2Ph_ADC3
 ((
ut32_t
)0x00008000)

	)

511 
	#RCC_APB2Ph_TIM15
 ((
ut32_t
)0x00010000)

	)

512 
	#RCC_APB2Ph_TIM16
 ((
ut32_t
)0x00020000)

	)

513 
	#RCC_APB2Ph_TIM17
 ((
ut32_t
)0x00040000)

	)

514 
	#RCC_APB2Ph_TIM9
 ((
ut32_t
)0x00080000)

	)

515 
	#RCC_APB2Ph_TIM10
 ((
ut32_t
)0x00100000)

	)

516 
	#RCC_APB2Ph_TIM11
 ((
ut32_t
)0x00200000)

	)

518 
	#IS_RCC_APB2_PERIPH
(
PERIPH
((((PERIPH& 0xFFC00002=0x00&& ((PERIPH!0x00))

	)

527 
	#RCC_APB1Ph_TIM2
 ((
ut32_t
)0x00000001)

	)

528 
	#RCC_APB1Ph_TIM3
 ((
ut32_t
)0x00000002)

	)

529 
	#RCC_APB1Ph_TIM4
 ((
ut32_t
)0x00000004)

	)

530 
	#RCC_APB1Ph_TIM5
 ((
ut32_t
)0x00000008)

	)

531 
	#RCC_APB1Ph_TIM6
 ((
ut32_t
)0x00000010)

	)

532 
	#RCC_APB1Ph_TIM7
 ((
ut32_t
)0x00000020)

	)

533 
	#RCC_APB1Ph_TIM12
 ((
ut32_t
)0x00000040)

	)

534 
	#RCC_APB1Ph_TIM13
 ((
ut32_t
)0x00000080)

	)

535 
	#RCC_APB1Ph_TIM14
 ((
ut32_t
)0x00000100)

	)

536 
	#RCC_APB1Ph_WWDG
 ((
ut32_t
)0x00000800)

	)

537 
	#RCC_APB1Ph_SPI2
 ((
ut32_t
)0x00004000)

	)

538 
	#RCC_APB1Ph_SPI3
 ((
ut32_t
)0x00008000)

	)

539 
	#RCC_APB1Ph_USART2
 ((
ut32_t
)0x00020000)

	)

540 
	#RCC_APB1Ph_USART3
 ((
ut32_t
)0x00040000)

	)

541 
	#RCC_APB1Ph_UART4
 ((
ut32_t
)0x00080000)

	)

542 
	#RCC_APB1Ph_UART5
 ((
ut32_t
)0x00100000)

	)

543 
	#RCC_APB1Ph_I2C1
 ((
ut32_t
)0x00200000)

	)

544 
	#RCC_APB1Ph_I2C2
 ((
ut32_t
)0x00400000)

	)

545 
	#RCC_APB1Ph_USB
 ((
ut32_t
)0x00800000)

	)

546 
	#RCC_APB1Ph_CAN1
 ((
ut32_t
)0x02000000)

	)

547 
	#RCC_APB1Ph_CAN2
 ((
ut32_t
)0x04000000)

	)

548 
	#RCC_APB1Ph_BKP
 ((
ut32_t
)0x08000000)

	)

549 
	#RCC_APB1Ph_PWR
 ((
ut32_t
)0x10000000)

	)

550 
	#RCC_APB1Ph_DAC
 ((
ut32_t
)0x20000000)

	)

551 
	#RCC_APB1Ph_CEC
 ((
ut32_t
)0x40000000)

	)

553 
	#IS_RCC_APB1_PERIPH
(
PERIPH
((((PERIPH& 0x81013600=0x00&& ((PERIPH!0x00))

	)

563 
	#RCC_MCO_NoClock
 ((
ut8_t
)0x00)

	)

564 
	#RCC_MCO_SYSCLK
 ((
ut8_t
)0x04)

	)

565 
	#RCC_MCO_HSI
 ((
ut8_t
)0x05)

	)

566 
	#RCC_MCO_HSE
 ((
ut8_t
)0x06)

	)

567 
	#RCC_MCO_PLLCLK_Div2
 ((
ut8_t
)0x07)

	)

569 #ide
STM32F10X_CL


570 
	#IS_RCC_MCO
(
MCO
(((MCO=
RCC_MCO_NoClock
|| ((MCO=
RCC_MCO_HSI
) || \

571 ((
MCO
=
RCC_MCO_SYSCLK
|| ((MCO=
RCC_MCO_HSE
) || \

572 ((
MCO
=
RCC_MCO_PLLCLK_Div2
))

	)

574 
	#RCC_MCO_PLL2CLK
 ((
ut8_t
)0x08)

	)

575 
	#RCC_MCO_PLL3CLK_Div2
 ((
ut8_t
)0x09)

	)

576 
	#RCC_MCO_XT1
 ((
ut8_t
)0x0A)

	)

577 
	#RCC_MCO_PLL3CLK
 ((
ut8_t
)0x0B)

	)

579 
	#IS_RCC_MCO
(
MCO
(((MCO=
RCC_MCO_NoClock
|| ((MCO=
RCC_MCO_HSI
) || \

580 ((
MCO
=
RCC_MCO_SYSCLK
|| ((MCO=
RCC_MCO_HSE
) || \

581 ((
MCO
=
RCC_MCO_PLLCLK_Div2
|| ((MCO=
RCC_MCO_PLL2CLK
) || \

582 ((
MCO
=
RCC_MCO_PLL3CLK_Div2
|| ((MCO=
RCC_MCO_XT1
) || \

583 ((
MCO
=
RCC_MCO_PLL3CLK
))

	)

594 
	#RCC_FLAG_HSIRDY
 ((
ut8_t
)0x21)

	)

595 
	#RCC_FLAG_HSERDY
 ((
ut8_t
)0x31)

	)

596 
	#RCC_FLAG_PLLRDY
 ((
ut8_t
)0x39)

	)

597 
	#RCC_FLAG_LSERDY
 ((
ut8_t
)0x41)

	)

598 
	#RCC_FLAG_LSIRDY
 ((
ut8_t
)0x61)

	)

599 
	#RCC_FLAG_PINRST
 ((
ut8_t
)0x7A)

	)

600 
	#RCC_FLAG_PORRST
 ((
ut8_t
)0x7B)

	)

601 
	#RCC_FLAG_SFTRST
 ((
ut8_t
)0x7C)

	)

602 
	#RCC_FLAG_IWDGRST
 ((
ut8_t
)0x7D)

	)

603 
	#RCC_FLAG_WWDGRST
 ((
ut8_t
)0x7E)

	)

604 
	#RCC_FLAG_LPWRRST
 ((
ut8_t
)0x7F)

	)

606 #ide
STM32F10X_CL


607 
	#IS_RCC_FLAG
(
FLAG
(((FLAG=
RCC_FLAG_HSIRDY
|| ((FLAG=
RCC_FLAG_HSERDY
) || \

608 ((
FLAG
=
RCC_FLAG_PLLRDY
|| ((FLAG=
RCC_FLAG_LSERDY
) || \

609 ((
FLAG
=
RCC_FLAG_LSIRDY
|| ((FLAG=
RCC_FLAG_PINRST
) || \

610 ((
FLAG
=
RCC_FLAG_PORRST
|| ((FLAG=
RCC_FLAG_SFTRST
) || \

611 ((
FLAG
=
RCC_FLAG_IWDGRST
)|| ((FLAG=
RCC_FLAG_WWDGRST
)|| \

612 ((
FLAG
=
RCC_FLAG_LPWRRST
))

	)

614 
	#RCC_FLAG_PLL2RDY
 ((
ut8_t
)0x3B)

	)

615 
	#RCC_FLAG_PLL3RDY
 ((
ut8_t
)0x3D)

	)

616 
	#IS_RCC_FLAG
(
FLAG
(((FLAG=
RCC_FLAG_HSIRDY
|| ((FLAG=
RCC_FLAG_HSERDY
) || \

617 ((
FLAG
=
RCC_FLAG_PLLRDY
|| ((FLAG=
RCC_FLAG_LSERDY
) || \

618 ((
FLAG
=
RCC_FLAG_PLL2RDY
|| ((FLAG=
RCC_FLAG_PLL3RDY
) || \

619 ((
FLAG
=
RCC_FLAG_LSIRDY
|| ((FLAG=
RCC_FLAG_PINRST
) || \

620 ((
FLAG
=
RCC_FLAG_PORRST
|| ((FLAG=
RCC_FLAG_SFTRST
) || \

621 ((
FLAG
=
RCC_FLAG_IWDGRST
)|| ((FLAG=
RCC_FLAG_WWDGRST
)|| \

622 ((
FLAG
=
RCC_FLAG_LPWRRST
))

	)

625 
	#IS_RCC_CALIBRATION_VALUE
(
VALUE
((VALUE<0x1F)

	)

646 
RCC_DeIn
();

647 
RCC_HSECfig
(
ut32_t
 
RCC_HSE
);

648 
EStus
 
RCC_WaFHSESUp
();

649 
RCC_AdjuHSICibtiVue
(
ut8_t
 
HSICibtiVue
);

650 
RCC_HSICmd
(
FuniڮS
 
NewS
);

651 
RCC_PLLCfig
(
ut32_t
 
RCC_PLLSour
, ut32_
RCC_PLLMul
);

652 
RCC_PLLCmd
(
FuniڮS
 
NewS
);

654 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
|| defed (
STM32F10X_CL
)

655 
RCC_PREDIV1Cfig
(
ut32_t
 
RCC_PREDIV1_Sour
, ut32_
RCC_PREDIV1_Div
);

658 #ifde 
STM32F10X_CL


659 
RCC_PREDIV2Cfig
(
ut32_t
 
RCC_PREDIV2_Div
);

660 
RCC_PLL2Cfig
(
ut32_t
 
RCC_PLL2Mul
);

661 
RCC_PLL2Cmd
(
FuniڮS
 
NewS
);

662 
RCC_PLL3Cfig
(
ut32_t
 
RCC_PLL3Mul
);

663 
RCC_PLL3Cmd
(
FuniڮS
 
NewS
);

666 
RCC_SYSCLKCfig
(
ut32_t
 
RCC_SYSCLKSour
);

667 
ut8_t
 
RCC_GSYSCLKSour
();

668 
RCC_HCLKCfig
(
ut32_t
 
RCC_SYSCLK
);

669 
RCC_PCLK1Cfig
(
ut32_t
 
RCC_HCLK
);

670 
RCC_PCLK2Cfig
(
ut32_t
 
RCC_HCLK
);

671 
RCC_ITCfig
(
ut8_t
 
RCC_IT
, 
FuniڮS
 
NewS
);

673 #ide
STM32F10X_CL


674 
RCC_USBCLKCfig
(
ut32_t
 
RCC_USBCLKSour
);

676 
RCC_OTGFSCLKCfig
(
ut32_t
 
RCC_OTGFSCLKSour
);

679 
RCC_ADCCLKCfig
(
ut32_t
 
RCC_PCLK2
);

681 #ifde
STM32F10X_CL


682 
RCC_I2S2CLKCfig
(
ut32_t
 
RCC_I2S2CLKSour
);

683 
RCC_I2S3CLKCfig
(
ut32_t
 
RCC_I2S3CLKSour
);

686 
RCC_LSECfig
(
ut8_t
 
RCC_LSE
);

687 
RCC_LSICmd
(
FuniڮS
 
NewS
);

688 
RCC_RTCCLKCfig
(
ut32_t
 
RCC_RTCCLKSour
);

689 
RCC_RTCCLKCmd
(
FuniڮS
 
NewS
);

690 
RCC_GClocksFq
(
RCC_ClocksTyDef
* 
RCC_Clocks
);

691 
RCC_AHBPhClockCmd
(
ut32_t
 
RCC_AHBPh
, 
FuniڮS
 
NewS
);

692 
RCC_APB2PhClockCmd
(
ut32_t
 
RCC_APB2Ph
, 
FuniڮS
 
NewS
);

693 
RCC_APB1PhClockCmd
(
ut32_t
 
RCC_APB1Ph
, 
FuniڮS
 
NewS
);

695 #ifde
STM32F10X_CL


696 
RCC_AHBPhRetCmd
(
ut32_t
 
RCC_AHBPh
, 
FuniڮS
 
NewS
);

699 
RCC_APB2PhRetCmd
(
ut32_t
 
RCC_APB2Ph
, 
FuniڮS
 
NewS
);

700 
RCC_APB1PhRetCmd
(
ut32_t
 
RCC_APB1Ph
, 
FuniڮS
 
NewS
);

701 
RCC_BackupRetCmd
(
FuniڮS
 
NewS
);

702 
RCC_ClockSecurySyemCmd
(
FuniڮS
 
NewS
);

703 
RCC_MCOCfig
(
ut8_t
 
RCC_MCO
);

704 
FgStus
 
RCC_GFgStus
(
ut8_t
 
RCC_FLAG
);

705 
RCC_CˬFg
();

706 
ITStus
 
RCC_GITStus
(
ut8_t
 
RCC_IT
);

707 
RCC_CˬITPdgB
(
ut8_t
 
RCC_IT
);

709 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_rtc.h

23 #ide
__STM32F10x_RTC_H


24 
	#__STM32F10x_RTC_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

57 
	#RTC_IT_OW
 ((
ut16_t
)0x0004

	)

58 
	#RTC_IT_ALR
 ((
ut16_t
)0x0002

	)

59 
	#RTC_IT_SEC
 ((
ut16_t
)0x0001

	)

60 
	#IS_RTC_IT
(
IT
((((IT& (
ut16_t
)0xFFF8=0x00&& ((IT!0x00))

	)

61 
	#IS_RTC_GET_IT
(
IT
(((IT=
RTC_IT_OW
|| ((IT=
RTC_IT_ALR
) || \

62 ((
IT
=
RTC_IT_SEC
))

	)

71 
	#RTC_FLAG_RTOFF
 ((
ut16_t
)0x0020

	)

72 
	#RTC_FLAG_RSF
 ((
ut16_t
)0x0008

	)

73 
	#RTC_FLAG_OW
 ((
ut16_t
)0x0004

	)

74 
	#RTC_FLAG_ALR
 ((
ut16_t
)0x0002

	)

75 
	#RTC_FLAG_SEC
 ((
ut16_t
)0x0001

	)

76 
	#IS_RTC_CLEAR_FLAG
(
FLAG
((((FLAG& (
ut16_t
)0xFFF0=0x00&& ((FLAG!0x00))

	)

77 
	#IS_RTC_GET_FLAG
(
FLAG
(((FLAG=
RTC_FLAG_RTOFF
|| ((FLAG=
RTC_FLAG_RSF
) || \

78 ((
FLAG
=
RTC_FLAG_OW
|| ((FLAG=
RTC_FLAG_ALR
) || \

79 ((
FLAG
=
RTC_FLAG_SEC
))

	)

80 
	#IS_RTC_PRESCALER
(
PRESCALER
((PRESCALER<0xFFFFF)

	)

102 
RTC_ITCfig
(
ut16_t
 
RTC_IT
, 
FuniڮS
 
NewS
);

103 
RTC_ECfigMode
();

104 
RTC_ExCfigMode
();

105 
ut32_t
 
RTC_GCou
();

106 
RTC_SCou
(
ut32_t
 
CouVue
);

107 
RTC_SPsr
(
ut32_t
 
PsrVue
);

108 
RTC_SArm
(
ut32_t
 
ArmVue
);

109 
ut32_t
 
RTC_GDivid
();

110 
RTC_WaFLaTask
();

111 
RTC_WaFSynchro
();

112 
FgStus
 
RTC_GFgStus
(
ut16_t
 
RTC_FLAG
);

113 
RTC_CˬFg
(
ut16_t
 
RTC_FLAG
);

114 
ITStus
 
RTC_GITStus
(
ut16_t
 
RTC_IT
);

115 
RTC_CˬITPdgB
(
ut16_t
 
RTC_IT
);

117 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_sdio.h

23 #ide
__STM32F10x_SDIO_H


24 
	#__STM32F10x_SDIO_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

47 
ut32_t
 
SDIO_ClockEdge
;

50 
ut32_t
 
SDIO_ClockByss
;

54 
ut32_t
 
SDIO_ClockPowSave
;

58 
ut32_t
 
SDIO_BusWide
;

61 
ut32_t
 
SDIO_HdweFlowCڌ
;

64 
ut8_t
 
SDIO_ClockDiv
;

67 } 
	tSDIO_InTyDef
;

71 
ut32_t
 
SDIO_Argumt
;

76 
ut32_t
 
SDIO_CmdIndex
;

78 
ut32_t
 
SDIO_Reڣ
;

81 
ut32_t
 
SDIO_Wa
;

84 
ut32_t
 
SDIO_CPSM
;

87 } 
	tSDIO_CmdInTyDef
;

91 
ut32_t
 
SDIO_DaTimeOut
;

93 
ut32_t
 
SDIO_DaLgth
;

95 
ut32_t
 
SDIO_DaBlockSize
;

98 
ut32_t
 
SDIO_TnsrD
;

102 
ut32_t
 
SDIO_TnsrMode
;

105 
ut32_t
 
SDIO_DPSM
;

108 } 
	tSDIO_DaInTyDef
;

122 
	#SDIO_ClockEdge_Risg
 ((
ut32_t
)0x00000000)

	)

123 
	#SDIO_ClockEdge_Flg
 ((
ut32_t
)0x00002000)

	)

124 
	#IS_SDIO_CLOCK_EDGE
(
EDGE
(((EDGE=
SDIO_ClockEdge_Risg
) || \

125 ((
EDGE
=
SDIO_ClockEdge_Flg
))

	)

134 
	#SDIO_ClockByss_Dib
 ((
ut32_t
)0x00000000)

	)

135 
	#SDIO_ClockByss_Eb
 ((
ut32_t
)0x00000400)

	)

136 
	#IS_SDIO_CLOCK_BYPASS
(
BYPASS
(((BYPASS=
SDIO_ClockByss_Dib
) || \

137 ((
BYPASS
=
SDIO_ClockByss_Eb
))

	)

146 
	#SDIO_ClockPowSave_Dib
 ((
ut32_t
)0x00000000)

	)

147 
	#SDIO_ClockPowSave_Eb
 ((
ut32_t
)0x00000200)

	)

148 
	#IS_SDIO_CLOCK_POWER_SAVE
(
SAVE
(((SAVE=
SDIO_ClockPowSave_Dib
) || \

149 ((
SAVE
=
SDIO_ClockPowSave_Eb
))

	)

158 
	#SDIO_BusWide_1b
 ((
ut32_t
)0x00000000)

	)

159 
	#SDIO_BusWide_4b
 ((
ut32_t
)0x00000800)

	)

160 
	#SDIO_BusWide_8b
 ((
ut32_t
)0x00001000)

	)

161 
	#IS_SDIO_BUS_WIDE
(
WIDE
(((WIDE=
SDIO_BusWide_1b
|| ((WIDE=
SDIO_BusWide_4b
) || \

162 ((
WIDE
=
SDIO_BusWide_8b
))

	)

172 
	#SDIO_HdweFlowCڌ_Dib
 ((
ut32_t
)0x00000000)

	)

173 
	#SDIO_HdweFlowCڌ_Eb
 ((
ut32_t
)0x00004000)

	)

174 
	#IS_SDIO_HARDWARE_FLOW_CONTROL
(
CONTROL
(((CONTROL=
SDIO_HdweFlowCڌ_Dib
) || \

175 ((
CONTROL
=
SDIO_HdweFlowCڌ_Eb
))

	)

184 
	#SDIO_PowS_OFF
 ((
ut32_t
)0x00000000)

	)

185 
	#SDIO_PowS_ON
 ((
ut32_t
)0x00000003)

	)

186 
	#IS_SDIO_POWER_STATE
(
STATE
(((STATE=
SDIO_PowS_OFF
|| ((STATE=
SDIO_PowS_ON
))

	)

196 
	#SDIO_IT_CCRCFAIL
 ((
ut32_t
)0x00000001)

	)

197 
	#SDIO_IT_DCRCFAIL
 ((
ut32_t
)0x00000002)

	)

198 
	#SDIO_IT_CTIMEOUT
 ((
ut32_t
)0x00000004)

	)

199 
	#SDIO_IT_DTIMEOUT
 ((
ut32_t
)0x00000008)

	)

200 
	#SDIO_IT_TXUNDERR
 ((
ut32_t
)0x00000010)

	)

201 
	#SDIO_IT_RXOVERR
 ((
ut32_t
)0x00000020)

	)

202 
	#SDIO_IT_CMDREND
 ((
ut32_t
)0x00000040)

	)

203 
	#SDIO_IT_CMDSENT
 ((
ut32_t
)0x00000080)

	)

204 
	#SDIO_IT_DATAEND
 ((
ut32_t
)0x00000100)

	)

205 
	#SDIO_IT_STBITERR
 ((
ut32_t
)0x00000200)

	)

206 
	#SDIO_IT_DBCKEND
 ((
ut32_t
)0x00000400)

	)

207 
	#SDIO_IT_CMDACT
 ((
ut32_t
)0x00000800)

	)

208 
	#SDIO_IT_TXACT
 ((
ut32_t
)0x00001000)

	)

209 
	#SDIO_IT_RXACT
 ((
ut32_t
)0x00002000)

	)

210 
	#SDIO_IT_TXFIFOHE
 ((
ut32_t
)0x00004000)

	)

211 
	#SDIO_IT_RXFIFOHF
 ((
ut32_t
)0x00008000)

	)

212 
	#SDIO_IT_TXFIFOF
 ((
ut32_t
)0x00010000)

	)

213 
	#SDIO_IT_RXFIFOF
 ((
ut32_t
)0x00020000)

	)

214 
	#SDIO_IT_TXFIFOE
 ((
ut32_t
)0x00040000)

	)

215 
	#SDIO_IT_RXFIFOE
 ((
ut32_t
)0x00080000)

	)

216 
	#SDIO_IT_TXDAVL
 ((
ut32_t
)0x00100000)

	)

217 
	#SDIO_IT_RXDAVL
 ((
ut32_t
)0x00200000)

	)

218 
	#SDIO_IT_SDIOIT
 ((
ut32_t
)0x00400000)

	)

219 
	#SDIO_IT_CEATAEND
 ((
ut32_t
)0x00800000)

	)

220 
	#IS_SDIO_IT
(
IT
((((IT& (
ut32_t
)0xFF000000=0x00&& ((IT!(ut32_t)0x00))

	)

229 
	#IS_SDIO_CMD_INDEX
(
INDEX
((INDEX< 0x40)

	)

238 
	#SDIO_Reڣ_No
 ((
ut32_t
)0x00000000)

	)

239 
	#SDIO_Reڣ_Sht
 ((
ut32_t
)0x00000040)

	)

240 
	#SDIO_Reڣ_Lg
 ((
ut32_t
)0x000000C0)

	)

241 
	#IS_SDIO_RESPONSE
(
RESPONSE
(((RESPONSE=
SDIO_Reڣ_No
) || \

242 ((
RESPONSE
=
SDIO_Reڣ_Sht
) || \

243 ((
RESPONSE
=
SDIO_Reڣ_Lg
))

	)

252 
	#SDIO_Wa_No
 ((
ut32_t
)0x00000000

	)

253 
	#SDIO_Wa_IT
 ((
ut32_t
)0x00000100

	)

254 
	#SDIO_Wa_Pd
 ((
ut32_t
)0x00000200

	)

255 
	#IS_SDIO_WAIT
(
WAIT
(((WAIT=
SDIO_Wa_No
|| ((WAIT=
SDIO_Wa_IT
) || \

256 ((
WAIT
=
SDIO_Wa_Pd
))

	)

265 
	#SDIO_CPSM_Dib
 ((
ut32_t
)0x00000000)

	)

266 
	#SDIO_CPSM_Eb
 ((
ut32_t
)0x00000400)

	)

267 
	#IS_SDIO_CPSM
(
CPSM
(((CPSM=
SDIO_CPSM_Eb
|| ((CPSM=
SDIO_CPSM_Dib
))

	)

276 
	#SDIO_RESP1
 ((
ut32_t
)0x00000000)

	)

277 
	#SDIO_RESP2
 ((
ut32_t
)0x00000004)

	)

278 
	#SDIO_RESP3
 ((
ut32_t
)0x00000008)

	)

279 
	#SDIO_RESP4
 ((
ut32_t
)0x0000000C)

	)

280 
	#IS_SDIO_RESP
(
RESP
(((RESP=
SDIO_RESP1
|| ((RESP=
SDIO_RESP2
) || \

281 ((
RESP
=
SDIO_RESP3
|| ((RESP=
SDIO_RESP4
))

	)

290 
	#IS_SDIO_DATA_LENGTH
(
LENGTH
((LENGTH<0x01FFFFFF)

	)

299 
	#SDIO_DaBlockSize_1b
 ((
ut32_t
)0x00000000)

	)

300 
	#SDIO_DaBlockSize_2b
 ((
ut32_t
)0x00000010)

	)

301 
	#SDIO_DaBlockSize_4b
 ((
ut32_t
)0x00000020)

	)

302 
	#SDIO_DaBlockSize_8b
 ((
ut32_t
)0x00000030)

	)

303 
	#SDIO_DaBlockSize_16b
 ((
ut32_t
)0x00000040)

	)

304 
	#SDIO_DaBlockSize_32b
 ((
ut32_t
)0x00000050)

	)

305 
	#SDIO_DaBlockSize_64b
 ((
ut32_t
)0x00000060)

	)

306 
	#SDIO_DaBlockSize_128b
 ((
ut32_t
)0x00000070)

	)

307 
	#SDIO_DaBlockSize_256b
 ((
ut32_t
)0x00000080)

	)

308 
	#SDIO_DaBlockSize_512b
 ((
ut32_t
)0x00000090)

	)

309 
	#SDIO_DaBlockSize_1024b
 ((
ut32_t
)0x000000A0)

	)

310 
	#SDIO_DaBlockSize_2048b
 ((
ut32_t
)0x000000B0)

	)

311 
	#SDIO_DaBlockSize_4096b
 ((
ut32_t
)0x000000C0)

	)

312 
	#SDIO_DaBlockSize_8192b
 ((
ut32_t
)0x000000D0)

	)

313 
	#SDIO_DaBlockSize_16384b
 ((
ut32_t
)0x000000E0)

	)

314 
	#IS_SDIO_BLOCK_SIZE
(
SIZE
(((SIZE=
SDIO_DaBlockSize_1b
) || \

315 ((
SIZE
=
SDIO_DaBlockSize_2b
) || \

316 ((
SIZE
=
SDIO_DaBlockSize_4b
) || \

317 ((
SIZE
=
SDIO_DaBlockSize_8b
) || \

318 ((
SIZE
=
SDIO_DaBlockSize_16b
) || \

319 ((
SIZE
=
SDIO_DaBlockSize_32b
) || \

320 ((
SIZE
=
SDIO_DaBlockSize_64b
) || \

321 ((
SIZE
=
SDIO_DaBlockSize_128b
) || \

322 ((
SIZE
=
SDIO_DaBlockSize_256b
) || \

323 ((
SIZE
=
SDIO_DaBlockSize_512b
) || \

324 ((
SIZE
=
SDIO_DaBlockSize_1024b
) || \

325 ((
SIZE
=
SDIO_DaBlockSize_2048b
) || \

326 ((
SIZE
=
SDIO_DaBlockSize_4096b
) || \

327 ((
SIZE
=
SDIO_DaBlockSize_8192b
) || \

328 ((
SIZE
=
SDIO_DaBlockSize_16384b
))

	)

337 
	#SDIO_TnsrD_ToCd
 ((
ut32_t
)0x00000000)

	)

338 
	#SDIO_TnsrD_ToSDIO
 ((
ut32_t
)0x00000002)

	)

339 
	#IS_SDIO_TRANSFER_DIR
(
DIR
(((DIR=
SDIO_TnsrD_ToCd
) || \

340 ((
DIR
=
SDIO_TnsrD_ToSDIO
))

	)

349 
	#SDIO_TnsrMode_Block
 ((
ut32_t
)0x00000000)

	)

350 
	#SDIO_TnsrMode_Sm
 ((
ut32_t
)0x00000004)

	)

351 
	#IS_SDIO_TRANSFER_MODE
(
MODE
(((MODE=
SDIO_TnsrMode_Sm
) || \

352 ((
MODE
=
SDIO_TnsrMode_Block
))

	)

361 
	#SDIO_DPSM_Dib
 ((
ut32_t
)0x00000000)

	)

362 
	#SDIO_DPSM_Eb
 ((
ut32_t
)0x00000001)

	)

363 
	#IS_SDIO_DPSM
(
DPSM
(((DPSM=
SDIO_DPSM_Eb
|| ((DPSM=
SDIO_DPSM_Dib
))

	)

372 
	#SDIO_FLAG_CCRCFAIL
 ((
ut32_t
)0x00000001)

	)

373 
	#SDIO_FLAG_DCRCFAIL
 ((
ut32_t
)0x00000002)

	)

374 
	#SDIO_FLAG_CTIMEOUT
 ((
ut32_t
)0x00000004)

	)

375 
	#SDIO_FLAG_DTIMEOUT
 ((
ut32_t
)0x00000008)

	)

376 
	#SDIO_FLAG_TXUNDERR
 ((
ut32_t
)0x00000010)

	)

377 
	#SDIO_FLAG_RXOVERR
 ((
ut32_t
)0x00000020)

	)

378 
	#SDIO_FLAG_CMDREND
 ((
ut32_t
)0x00000040)

	)

379 
	#SDIO_FLAG_CMDSENT
 ((
ut32_t
)0x00000080)

	)

380 
	#SDIO_FLAG_DATAEND
 ((
ut32_t
)0x00000100)

	)

381 
	#SDIO_FLAG_STBITERR
 ((
ut32_t
)0x00000200)

	)

382 
	#SDIO_FLAG_DBCKEND
 ((
ut32_t
)0x00000400)

	)

383 
	#SDIO_FLAG_CMDACT
 ((
ut32_t
)0x00000800)

	)

384 
	#SDIO_FLAG_TXACT
 ((
ut32_t
)0x00001000)

	)

385 
	#SDIO_FLAG_RXACT
 ((
ut32_t
)0x00002000)

	)

386 
	#SDIO_FLAG_TXFIFOHE
 ((
ut32_t
)0x00004000)

	)

387 
	#SDIO_FLAG_RXFIFOHF
 ((
ut32_t
)0x00008000)

	)

388 
	#SDIO_FLAG_TXFIFOF
 ((
ut32_t
)0x00010000)

	)

389 
	#SDIO_FLAG_RXFIFOF
 ((
ut32_t
)0x00020000)

	)

390 
	#SDIO_FLAG_TXFIFOE
 ((
ut32_t
)0x00040000)

	)

391 
	#SDIO_FLAG_RXFIFOE
 ((
ut32_t
)0x00080000)

	)

392 
	#SDIO_FLAG_TXDAVL
 ((
ut32_t
)0x00100000)

	)

393 
	#SDIO_FLAG_RXDAVL
 ((
ut32_t
)0x00200000)

	)

394 
	#SDIO_FLAG_SDIOIT
 ((
ut32_t
)0x00400000)

	)

395 
	#SDIO_FLAG_CEATAEND
 ((
ut32_t
)0x00800000)

	)

396 
	#IS_SDIO_FLAG
(
FLAG
(((FLAG=
SDIO_FLAG_CCRCFAIL
) || \

397 ((
FLAG
=
SDIO_FLAG_DCRCFAIL
) || \

398 ((
FLAG
=
SDIO_FLAG_CTIMEOUT
) || \

399 ((
FLAG
=
SDIO_FLAG_DTIMEOUT
) || \

400 ((
FLAG
=
SDIO_FLAG_TXUNDERR
) || \

401 ((
FLAG
=
SDIO_FLAG_RXOVERR
) || \

402 ((
FLAG
=
SDIO_FLAG_CMDREND
) || \

403 ((
FLAG
=
SDIO_FLAG_CMDSENT
) || \

404 ((
FLAG
=
SDIO_FLAG_DATAEND
) || \

405 ((
FLAG
=
SDIO_FLAG_STBITERR
) || \

406 ((
FLAG
=
SDIO_FLAG_DBCKEND
) || \

407 ((
FLAG
=
SDIO_FLAG_CMDACT
) || \

408 ((
FLAG
=
SDIO_FLAG_TXACT
) || \

409 ((
FLAG
=
SDIO_FLAG_RXACT
) || \

410 ((
FLAG
=
SDIO_FLAG_TXFIFOHE
) || \

411 ((
FLAG
=
SDIO_FLAG_RXFIFOHF
) || \

412 ((
FLAG
=
SDIO_FLAG_TXFIFOF
) || \

413 ((
FLAG
=
SDIO_FLAG_RXFIFOF
) || \

414 ((
FLAG
=
SDIO_FLAG_TXFIFOE
) || \

415 ((
FLAG
=
SDIO_FLAG_RXFIFOE
) || \

416 ((
FLAG
=
SDIO_FLAG_TXDAVL
) || \

417 ((
FLAG
=
SDIO_FLAG_RXDAVL
) || \

418 ((
FLAG
=
SDIO_FLAG_SDIOIT
) || \

419 ((
FLAG
=
SDIO_FLAG_CEATAEND
))

	)

421 
	#IS_SDIO_CLEAR_FLAG
(
FLAG
((((FLAG& (
ut32_t
)0xFF3FF800=0x00&& ((FLAG!(ut32_t)0x00))

	)

423 
	#IS_SDIO_GET_IT
(
IT
(((IT=
SDIO_IT_CCRCFAIL
) || \

424 ((
IT
=
SDIO_IT_DCRCFAIL
) || \

425 ((
IT
=
SDIO_IT_CTIMEOUT
) || \

426 ((
IT
=
SDIO_IT_DTIMEOUT
) || \

427 ((
IT
=
SDIO_IT_TXUNDERR
) || \

428 ((
IT
=
SDIO_IT_RXOVERR
) || \

429 ((
IT
=
SDIO_IT_CMDREND
) || \

430 ((
IT
=
SDIO_IT_CMDSENT
) || \

431 ((
IT
=
SDIO_IT_DATAEND
) || \

432 ((
IT
=
SDIO_IT_STBITERR
) || \

433 ((
IT
=
SDIO_IT_DBCKEND
) || \

434 ((
IT
=
SDIO_IT_CMDACT
) || \

435 ((
IT
=
SDIO_IT_TXACT
) || \

436 ((
IT
=
SDIO_IT_RXACT
) || \

437 ((
IT
=
SDIO_IT_TXFIFOHE
) || \

438 ((
IT
=
SDIO_IT_RXFIFOHF
) || \

439 ((
IT
=
SDIO_IT_TXFIFOF
) || \

440 ((
IT
=
SDIO_IT_RXFIFOF
) || \

441 ((
IT
=
SDIO_IT_TXFIFOE
) || \

442 ((
IT
=
SDIO_IT_RXFIFOE
) || \

443 ((
IT
=
SDIO_IT_TXDAVL
) || \

444 ((
IT
=
SDIO_IT_RXDAVL
) || \

445 ((
IT
=
SDIO_IT_SDIOIT
) || \

446 ((
IT
=
SDIO_IT_CEATAEND
))

	)

448 
	#IS_SDIO_CLEAR_IT
(
IT
((((IT& (
ut32_t
)0xFF3FF800=0x00&& ((IT!(ut32_t)0x00))

	)

458 
	#SDIO_RdWaMode_CLK
 ((
ut32_t
)0x00000001)

	)

459 
	#SDIO_RdWaMode_DATA2
 ((
ut32_t
)0x00000000)

	)

460 
	#IS_SDIO_READWAIT_MODE
(
MODE
(((MODE=
SDIO_RdWaMode_CLK
) || \

461 ((
MODE
=
SDIO_RdWaMode_DATA2
))

	)

482 
SDIO_DeIn
();

483 
SDIO_In
(
SDIO_InTyDef
* 
SDIO_InSu
);

484 
SDIO_SuIn
(
SDIO_InTyDef
* 
SDIO_InSu
);

485 
SDIO_ClockCmd
(
FuniڮS
 
NewS
);

486 
SDIO_SPowS
(
ut32_t
 
SDIO_PowS
);

487 
ut32_t
 
SDIO_GPowS
();

488 
SDIO_ITCfig
(
ut32_t
 
SDIO_IT
, 
FuniڮS
 
NewS
);

489 
SDIO_DMACmd
(
FuniڮS
 
NewS
);

490 
SDIO_SdCommd
(
SDIO_CmdInTyDef
 *
SDIO_CmdInSu
);

491 
SDIO_CmdSuIn
(
SDIO_CmdInTyDef
* 
SDIO_CmdInSu
);

492 
ut8_t
 
SDIO_GCommdReڣ
();

493 
ut32_t
 
SDIO_GReڣ
(ut32_
SDIO_RESP
);

494 
SDIO_DaCfig
(
SDIO_DaInTyDef
* 
SDIO_DaInSu
);

495 
SDIO_DaSuIn
(
SDIO_DaInTyDef
* 
SDIO_DaInSu
);

496 
ut32_t
 
SDIO_GDaCou
();

497 
ut32_t
 
SDIO_RdDa
();

498 
SDIO_WreDa
(
ut32_t
 
Da
);

499 
ut32_t
 
SDIO_GFIFOCou
();

500 
SDIO_SSDIORdWa
(
FuniڮS
 
NewS
);

501 
SDIO_StSDIORdWa
(
FuniڮS
 
NewS
);

502 
SDIO_SSDIORdWaMode
(
ut32_t
 
SDIO_RdWaMode
);

503 
SDIO_SSDIOOti
(
FuniڮS
 
NewS
);

504 
SDIO_SdSDIOSudCmd
(
FuniڮS
 
NewS
);

505 
SDIO_CommdComiCmd
(
FuniڮS
 
NewS
);

506 
SDIO_CEATAITCmd
(
FuniڮS
 
NewS
);

507 
SDIO_SdCEATACmd
(
FuniڮS
 
NewS
);

508 
FgStus
 
SDIO_GFgStus
(
ut32_t
 
SDIO_FLAG
);

509 
SDIO_CˬFg
(
ut32_t
 
SDIO_FLAG
);

510 
ITStus
 
SDIO_GITStus
(
ut32_t
 
SDIO_IT
);

511 
SDIO_CˬITPdgB
(
ut32_t
 
SDIO_IT
);

513 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_spi.h

23 #ide
__STM32F10x_SPI_H


24 
	#__STM32F10x_SPI_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
ut16_t
 
SPI_Dei
;

54 
ut16_t
 
SPI_Mode
;

57 
ut16_t
 
SPI_DaSize
;

60 
ut16_t
 
SPI_CPOL
;

63 
ut16_t
 
SPI_CPHA
;

66 
ut16_t
 
SPI_NSS
;

70 
ut16_t
 
SPI_BaudRePsr
;

76 
ut16_t
 
SPI_FB
;

79 
ut16_t
 
SPI_CRCPynoml
;

80 }
	tSPI_InTyDef
;

89 
ut16_t
 
I2S_Mode
;

92 
ut16_t
 
I2S_Sndd
;

95 
ut16_t
 
I2S_DaFm
;

98 
ut16_t
 
I2S_MCLKOuut
;

101 
ut32_t
 
I2S_AudioFq
;

104 
ut16_t
 
I2S_CPOL
;

106 }
	tI2S_InTyDef
;

116 
	#IS_SPI_ALL_PERIPH
(
PERIPH
(((PERIPH=
SPI1
) || \

117 ((
PERIPH
=
SPI2
) || \

118 ((
PERIPH
=
SPI3
))

	)

120 
	#IS_SPI_23_PERIPH
(
PERIPH
(((PERIPH=
SPI2
) || \

121 ((
PERIPH
=
SPI3
))

	)

127 
	#SPI_Dei_2Les_FuDuex
 ((
ut16_t
)0x0000)

	)

128 
	#SPI_Dei_2Les_RxOy
 ((
ut16_t
)0x0400)

	)

129 
	#SPI_Dei_1Le_Rx
 ((
ut16_t
)0x8000)

	)

130 
	#SPI_Dei_1Le_Tx
 ((
ut16_t
)0xC000)

	)

131 
	#IS_SPI_DIRECTION_MODE
(
MODE
(((MODE=
SPI_Dei_2Les_FuDuex
) || \

132 ((
MODE
=
SPI_Dei_2Les_RxOy
) || \

133 ((
MODE
=
SPI_Dei_1Le_Rx
) || \

134 ((
MODE
=
SPI_Dei_1Le_Tx
))

	)

143 
	#SPI_Mode_Ma
 ((
ut16_t
)0x0104)

	)

144 
	#SPI_Mode_Sve
 ((
ut16_t
)0x0000)

	)

145 
	#IS_SPI_MODE
(
MODE
(((MODE=
SPI_Mode_Ma
) || \

146 ((
MODE
=
SPI_Mode_Sve
))

	)

155 
	#SPI_DaSize_16b
 ((
ut16_t
)0x0800)

	)

156 
	#SPI_DaSize_8b
 ((
ut16_t
)0x0000)

	)

157 
	#IS_SPI_DATASIZE
(
DATASIZE
(((DATASIZE=
SPI_DaSize_16b
) || \

158 ((
DATASIZE
=
SPI_DaSize_8b
))

	)

167 
	#SPI_CPOL_Low
 ((
ut16_t
)0x0000)

	)

168 
	#SPI_CPOL_High
 ((
ut16_t
)0x0002)

	)

169 
	#IS_SPI_CPOL
(
CPOL
(((CPOL=
SPI_CPOL_Low
) || \

170 ((
CPOL
=
SPI_CPOL_High
))

	)

179 
	#SPI_CPHA_1Edge
 ((
ut16_t
)0x0000)

	)

180 
	#SPI_CPHA_2Edge
 ((
ut16_t
)0x0001)

	)

181 
	#IS_SPI_CPHA
(
CPHA
(((CPHA=
SPI_CPHA_1Edge
) || \

182 ((
CPHA
=
SPI_CPHA_2Edge
))

	)

191 
	#SPI_NSS_So
 ((
ut16_t
)0x0200)

	)

192 
	#SPI_NSS_Hd
 ((
ut16_t
)0x0000)

	)

193 
	#IS_SPI_NSS
(
NSS
(((NSS=
SPI_NSS_So
) || \

194 ((
NSS
=
SPI_NSS_Hd
))

	)

203 
	#SPI_BaudRePsr_2
 ((
ut16_t
)0x0000)

	)

204 
	#SPI_BaudRePsr_4
 ((
ut16_t
)0x0008)

	)

205 
	#SPI_BaudRePsr_8
 ((
ut16_t
)0x0010)

	)

206 
	#SPI_BaudRePsr_16
 ((
ut16_t
)0x0018)

	)

207 
	#SPI_BaudRePsr_32
 ((
ut16_t
)0x0020)

	)

208 
	#SPI_BaudRePsr_64
 ((
ut16_t
)0x0028)

	)

209 
	#SPI_BaudRePsr_128
 ((
ut16_t
)0x0030)

	)

210 
	#SPI_BaudRePsr_256
 ((
ut16_t
)0x0038)

	)

211 
	#IS_SPI_BAUDRATE_PRESCALER
(
PRESCALER
(((PRESCALER=
SPI_BaudRePsr_2
) || \

212 ((
PRESCALER
=
SPI_BaudRePsr_4
) || \

213 ((
PRESCALER
=
SPI_BaudRePsr_8
) || \

214 ((
PRESCALER
=
SPI_BaudRePsr_16
) || \

215 ((
PRESCALER
=
SPI_BaudRePsr_32
) || \

216 ((
PRESCALER
=
SPI_BaudRePsr_64
) || \

217 ((
PRESCALER
=
SPI_BaudRePsr_128
) || \

218 ((
PRESCALER
=
SPI_BaudRePsr_256
))

	)

227 
	#SPI_FB_MSB
 ((
ut16_t
)0x0000)

	)

228 
	#SPI_FB_LSB
 ((
ut16_t
)0x0080)

	)

229 
	#IS_SPI_FIRST_BIT
(
BIT
(((BIT=
SPI_FB_MSB
) || \

230 ((
BIT
=
SPI_FB_LSB
))

	)

239 
	#I2S_Mode_SveTx
 ((
ut16_t
)0x0000)

	)

240 
	#I2S_Mode_SveRx
 ((
ut16_t
)0x0100)

	)

241 
	#I2S_Mode_MaTx
 ((
ut16_t
)0x0200)

	)

242 
	#I2S_Mode_MaRx
 ((
ut16_t
)0x0300)

	)

243 
	#IS_I2S_MODE
(
MODE
(((MODE=
I2S_Mode_SveTx
) || \

244 ((
MODE
=
I2S_Mode_SveRx
) || \

245 ((
MODE
=
I2S_Mode_MaTx
) || \

246 ((
MODE
=
I2S_Mode_MaRx
)

	)

255 
	#I2S_Sndd_Phls
 ((
ut16_t
)0x0000)

	)

256 
	#I2S_Sndd_MSB
 ((
ut16_t
)0x0010)

	)

257 
	#I2S_Sndd_LSB
 ((
ut16_t
)0x0020)

	)

258 
	#I2S_Sndd_PCMSht
 ((
ut16_t
)0x0030)

	)

259 
	#I2S_Sndd_PCMLg
 ((
ut16_t
)0x00B0)

	)

260 
	#IS_I2S_STANDARD
(
STANDARD
(((STANDARD=
I2S_Sndd_Phls
) || \

261 ((
STANDARD
=
I2S_Sndd_MSB
) || \

262 ((
STANDARD
=
I2S_Sndd_LSB
) || \

263 ((
STANDARD
=
I2S_Sndd_PCMSht
) || \

264 ((
STANDARD
=
I2S_Sndd_PCMLg
))

	)

273 
	#I2S_DaFm_16b
 ((
ut16_t
)0x0000)

	)

274 
	#I2S_DaFm_16bexnded
 ((
ut16_t
)0x0001)

	)

275 
	#I2S_DaFm_24b
 ((
ut16_t
)0x0003)

	)

276 
	#I2S_DaFm_32b
 ((
ut16_t
)0x0005)

	)

277 
	#IS_I2S_DATA_FORMAT
(
FORMAT
(((FORMAT=
I2S_DaFm_16b
) || \

278 ((
FORMAT
=
I2S_DaFm_16bexnded
) || \

279 ((
FORMAT
=
I2S_DaFm_24b
) || \

280 ((
FORMAT
=
I2S_DaFm_32b
))

	)

289 
	#I2S_MCLKOuut_Eb
 ((
ut16_t
)0x0200)

	)

290 
	#I2S_MCLKOuut_Dib
 ((
ut16_t
)0x0000)

	)

291 
	#IS_I2S_MCLK_OUTPUT
(
OUTPUT
(((OUTPUT=
I2S_MCLKOuut_Eb
) || \

292 ((
OUTPUT
=
I2S_MCLKOuut_Dib
))

	)

301 
	#I2S_AudioFq_192k
 ((
ut32_t
)192000)

	)

302 
	#I2S_AudioFq_96k
 ((
ut32_t
)96000)

	)

303 
	#I2S_AudioFq_48k
 ((
ut32_t
)48000)

	)

304 
	#I2S_AudioFq_44k
 ((
ut32_t
)44100)

	)

305 
	#I2S_AudioFq_32k
 ((
ut32_t
)32000)

	)

306 
	#I2S_AudioFq_22k
 ((
ut32_t
)22050)

	)

307 
	#I2S_AudioFq_16k
 ((
ut32_t
)16000)

	)

308 
	#I2S_AudioFq_11k
 ((
ut32_t
)11025)

	)

309 
	#I2S_AudioFq_8k
 ((
ut32_t
)8000)

	)

310 
	#I2S_AudioFq_Deu
 ((
ut32_t
)2)

	)

312 
	#IS_I2S_AUDIO_FREQ
(
FREQ
((((FREQ>
I2S_AudioFq_8k
) && \

313 ((
FREQ
<
I2S_AudioFq_192k
)) || \

314 ((
FREQ
=
I2S_AudioFq_Deu
))

	)

323 
	#I2S_CPOL_Low
 ((
ut16_t
)0x0000)

	)

324 
	#I2S_CPOL_High
 ((
ut16_t
)0x0008)

	)

325 
	#IS_I2S_CPOL
(
CPOL
(((CPOL=
I2S_CPOL_Low
) || \

326 ((
CPOL
=
I2S_CPOL_High
))

	)

335 
	#SPI_I2S_DMAReq_Tx
 ((
ut16_t
)0x0002)

	)

336 
	#SPI_I2S_DMAReq_Rx
 ((
ut16_t
)0x0001)

	)

337 
	#IS_SPI_I2S_DMAREQ
(
DMAREQ
((((DMAREQ& (
ut16_t
)0xFFFC=0x00&& ((DMAREQ!0x00))

	)

346 
	#SPI_NSSIlSo_S
 ((
ut16_t
)0x0100)

	)

347 
	#SPI_NSSIlSo_Ret
 ((
ut16_t
)0xFEFF)

	)

348 
	#IS_SPI_NSS_INTERNAL
(
INTERNAL
(((INTERNAL=
SPI_NSSIlSo_S
) || \

349 ((
INTERNAL
=
SPI_NSSIlSo_Ret
))

	)

358 
	#SPI_CRC_Tx
 ((
ut8_t
)0x00)

	)

359 
	#SPI_CRC_Rx
 ((
ut8_t
)0x01)

	)

360 
	#IS_SPI_CRC
(
CRC
(((CRC=
SPI_CRC_Tx
|| ((CRC=
SPI_CRC_Rx
))

	)

369 
	#SPI_Dei_Rx
 ((
ut16_t
)0xBFFF)

	)

370 
	#SPI_Dei_Tx
 ((
ut16_t
)0x4000)

	)

371 
	#IS_SPI_DIRECTION
(
DIRECTION
(((DIRECTION=
SPI_Dei_Rx
) || \

372 ((
DIRECTION
=
SPI_Dei_Tx
))

	)

381 
	#SPI_I2S_IT_TXE
 ((
ut8_t
)0x71)

	)

382 
	#SPI_I2S_IT_RXNE
 ((
ut8_t
)0x60)

	)

383 
	#SPI_I2S_IT_ERR
 ((
ut8_t
)0x50)

	)

384 
	#IS_SPI_I2S_CONFIG_IT
(
IT
(((IT=
SPI_I2S_IT_TXE
) || \

385 ((
IT
=
SPI_I2S_IT_RXNE
) || \

386 ((
IT
=
SPI_I2S_IT_ERR
))

	)

387 
	#SPI_I2S_IT_OVR
 ((
ut8_t
)0x56)

	)

388 
	#SPI_IT_MODF
 ((
ut8_t
)0x55)

	)

389 
	#SPI_IT_CRCERR
 ((
ut8_t
)0x54)

	)

390 
	#I2S_IT_UDR
 ((
ut8_t
)0x53)

	)

391 
	#IS_SPI_I2S_CLEAR_IT
(
IT
(((IT=
SPI_IT_CRCERR
))

	)

392 
	#IS_SPI_I2S_GET_IT
(
IT
(((IT=
SPI_I2S_IT_RXNE
|| ((IT=
SPI_I2S_IT_TXE
) || \

393 ((
IT
=
I2S_IT_UDR
|| ((IT=
SPI_IT_CRCERR
) || \

394 ((
IT
=
SPI_IT_MODF
|| ((IT=
SPI_I2S_IT_OVR
))

	)

403 
	#SPI_I2S_FLAG_RXNE
 ((
ut16_t
)0x0001)

	)

404 
	#SPI_I2S_FLAG_TXE
 ((
ut16_t
)0x0002)

	)

405 
	#I2S_FLAG_CHSIDE
 ((
ut16_t
)0x0004)

	)

406 
	#I2S_FLAG_UDR
 ((
ut16_t
)0x0008)

	)

407 
	#SPI_FLAG_CRCERR
 ((
ut16_t
)0x0010)

	)

408 
	#SPI_FLAG_MODF
 ((
ut16_t
)0x0020)

	)

409 
	#SPI_I2S_FLAG_OVR
 ((
ut16_t
)0x0040)

	)

410 
	#SPI_I2S_FLAG_BSY
 ((
ut16_t
)0x0080)

	)

411 
	#IS_SPI_I2S_CLEAR_FLAG
(
FLAG
(((FLAG=
SPI_FLAG_CRCERR
))

	)

412 
	#IS_SPI_I2S_GET_FLAG
(
FLAG
(((FLAG=
SPI_I2S_FLAG_BSY
|| ((FLAG=
SPI_I2S_FLAG_OVR
) || \

413 ((
FLAG
=
SPI_FLAG_MODF
|| ((FLAG=
SPI_FLAG_CRCERR
) || \

414 ((
FLAG
=
I2S_FLAG_UDR
|| ((FLAG=
I2S_FLAG_CHSIDE
) || \

415 ((
FLAG
=
SPI_I2S_FLAG_TXE
|| ((FLAG=
SPI_I2S_FLAG_RXNE
))

	)

424 
	#IS_SPI_CRC_POLYNOMIAL
(
POLYNOMIAL
((POLYNOMIAL>0x1)

	)

445 
SPI_I2S_DeIn
(
SPI_TyDef
* 
SPIx
);

446 
SPI_In
(
SPI_TyDef
* 
SPIx
, 
SPI_InTyDef
* 
SPI_InSu
);

447 
I2S_In
(
SPI_TyDef
* 
SPIx
, 
I2S_InTyDef
* 
I2S_InSu
);

448 
SPI_SuIn
(
SPI_InTyDef
* 
SPI_InSu
);

449 
I2S_SuIn
(
I2S_InTyDef
* 
I2S_InSu
);

450 
SPI_Cmd
(
SPI_TyDef
* 
SPIx
, 
FuniڮS
 
NewS
);

451 
I2S_Cmd
(
SPI_TyDef
* 
SPIx
, 
FuniڮS
 
NewS
);

452 
SPI_I2S_ITCfig
(
SPI_TyDef
* 
SPIx
, 
ut8_t
 
SPI_I2S_IT
, 
FuniڮS
 
NewS
);

453 
SPI_I2S_DMACmd
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_I2S_DMAReq
, 
FuniڮS
 
NewS
);

454 
SPI_I2S_SdDa
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
Da
);

455 
ut16_t
 
SPI_I2S_ReiveDa
(
SPI_TyDef
* 
SPIx
);

456 
SPI_NSSIlSoweCfig
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_NSSIlSo
);

457 
SPI_SSOuutCmd
(
SPI_TyDef
* 
SPIx
, 
FuniڮS
 
NewS
);

458 
SPI_DaSizeCfig
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_DaSize
);

459 
SPI_TnsmCRC
(
SPI_TyDef
* 
SPIx
);

460 
SPI_CcuϋCRC
(
SPI_TyDef
* 
SPIx
, 
FuniڮS
 
NewS
);

461 
ut16_t
 
SPI_GCRC
(
SPI_TyDef
* 
SPIx
, 
ut8_t
 
SPI_CRC
);

462 
ut16_t
 
SPI_GCRCPynoml
(
SPI_TyDef
* 
SPIx
);

463 
SPI_BiDeiڮLeCfig
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_Dei
);

464 
FgStus
 
SPI_I2S_GFgStus
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_I2S_FLAG
);

465 
SPI_I2S_CˬFg
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_I2S_FLAG
);

466 
ITStus
 
SPI_I2S_GITStus
(
SPI_TyDef
* 
SPIx
, 
ut8_t
 
SPI_I2S_IT
);

467 
SPI_I2S_CˬITPdgB
(
SPI_TyDef
* 
SPIx
, 
ut8_t
 
SPI_I2S_IT
);

469 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_tim.h

23 #ide
__STM32F10x_TIM_H


24 
	#__STM32F10x_TIM_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

52 
ut16_t
 
TIM_Psr
;

55 
ut16_t
 
TIM_CouMode
;

58 
ut16_t
 
TIM_Piod
;

62 
ut16_t
 
TIM_ClockDivisi
;

65 
ut8_t
 
TIM_RiCou
;

73 } 
	tTIM_TimeBaInTyDef
;

81 
ut16_t
 
TIM_OCMode
;

84 
ut16_t
 
TIM_OuutS
;

87 
ut16_t
 
TIM_OuutNS
;

91 
ut16_t
 
TIM_Pul
;

94 
ut16_t
 
TIM_OCPެy
;

97 
ut16_t
 
TIM_OCNPެy
;

101 
ut16_t
 
TIM_OCIdS
;

105 
ut16_t
 
TIM_OCNIdS
;

108 } 
	tTIM_OCInTyDef
;

117 
ut16_t
 
TIM_Chl
;

120 
ut16_t
 
TIM_ICPެy
;

123 
ut16_t
 
TIM_ICSei
;

126 
ut16_t
 
TIM_ICPsr
;

129 
ut16_t
 
TIM_ICFr
;

131 } 
	tTIM_ICInTyDef
;

141 
ut16_t
 
TIM_OSSRS
;

144 
ut16_t
 
TIM_OSSIS
;

147 
ut16_t
 
TIM_LOCKLev
;

150 
ut16_t
 
TIM_DdTime
;

154 
ut16_t
 
TIM_Bak
;

157 
ut16_t
 
TIM_BakPެy
;

160 
ut16_t
 
TIM_AutomicOuut
;

162 } 
	tTIM_BDTRInTyDef
;

168 
	#IS_TIM_ALL_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

169 ((
PERIPH
=
TIM2
) || \

170 ((
PERIPH
=
TIM3
) || \

171 ((
PERIPH
=
TIM4
) || \

172 ((
PERIPH
=
TIM5
) || \

173 ((
PERIPH
=
TIM6
) || \

174 ((
PERIPH
=
TIM7
) || \

175 ((
PERIPH
=
TIM8
) || \

176 ((
PERIPH
=
TIM9
) || \

177 ((
PERIPH
=
TIM10
)|| \

178 ((
PERIPH
=
TIM11
)|| \

179 ((
PERIPH
=
TIM12
)|| \

180 ((
PERIPH
=
TIM13
)|| \

181 ((
PERIPH
=
TIM14
)|| \

182 ((
PERIPH
=
TIM15
)|| \

183 ((
PERIPH
=
TIM16
)|| \

184 ((
PERIPH
=
TIM17
))

	)

187 
	#IS_TIM_LIST1_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

188 ((
PERIPH
=
TIM8
))

	)

191 
	#IS_TIM_LIST2_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

192 ((
PERIPH
=
TIM8
) || \

193 ((
PERIPH
=
TIM15
)|| \

194 ((
PERIPH
=
TIM16
)|| \

195 ((
PERIPH
=
TIM17
))

	)

198 
	#IS_TIM_LIST3_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

199 ((
PERIPH
=
TIM2
) || \

200 ((
PERIPH
=
TIM3
) || \

201 ((
PERIPH
=
TIM4
) || \

202 ((
PERIPH
=
TIM5
) || \

203 ((
PERIPH
=
TIM8
))

	)

206 
	#IS_TIM_LIST4_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

207 ((
PERIPH
=
TIM2
) || \

208 ((
PERIPH
=
TIM3
) || \

209 ((
PERIPH
=
TIM4
) || \

210 ((
PERIPH
=
TIM5
) || \

211 ((
PERIPH
=
TIM8
) || \

212 ((
PERIPH
=
TIM15
)|| \

213 ((
PERIPH
=
TIM16
)|| \

214 ((
PERIPH
=
TIM17
))

	)

217 
	#IS_TIM_LIST5_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

218 ((
PERIPH
=
TIM2
) || \

219 ((
PERIPH
=
TIM3
) || \

220 ((
PERIPH
=
TIM4
) || \

221 ((
PERIPH
=
TIM5
) || \

222 ((
PERIPH
=
TIM8
) || \

223 ((
PERIPH
=
TIM15
))

	)

226 
	#IS_TIM_LIST6_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

227 ((
PERIPH
=
TIM2
) || \

228 ((
PERIPH
=
TIM3
) || \

229 ((
PERIPH
=
TIM4
) || \

230 ((
PERIPH
=
TIM5
) || \

231 ((
PERIPH
=
TIM8
) || \

232 ((
PERIPH
=
TIM9
) || \

233 ((
PERIPH
=
TIM12
)|| \

234 ((
PERIPH
=
TIM15
))

	)

237 
	#IS_TIM_LIST7_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

238 ((
PERIPH
=
TIM2
) || \

239 ((
PERIPH
=
TIM3
) || \

240 ((
PERIPH
=
TIM4
) || \

241 ((
PERIPH
=
TIM5
) || \

242 ((
PERIPH
=
TIM6
) || \

243 ((
PERIPH
=
TIM7
) || \

244 ((
PERIPH
=
TIM8
) || \

245 ((
PERIPH
=
TIM9
) || \

246 ((
PERIPH
=
TIM12
)|| \

247 ((
PERIPH
=
TIM15
))

	)

250 
	#IS_TIM_LIST8_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

251 ((
PERIPH
=
TIM2
) || \

252 ((
PERIPH
=
TIM3
) || \

253 ((
PERIPH
=
TIM4
) || \

254 ((
PERIPH
=
TIM5
) || \

255 ((
PERIPH
=
TIM8
) || \

256 ((
PERIPH
=
TIM9
) || \

257 ((
PERIPH
=
TIM10
)|| \

258 ((
PERIPH
=
TIM11
)|| \

259 ((
PERIPH
=
TIM12
)|| \

260 ((
PERIPH
=
TIM13
)|| \

261 ((
PERIPH
=
TIM14
)|| \

262 ((
PERIPH
=
TIM15
)|| \

263 ((
PERIPH
=
TIM16
)|| \

264 ((
PERIPH
=
TIM17
))

	)

267 
	#IS_TIM_LIST9_PERIPH
(
PERIPH
(((PERIPH=
TIM1
) || \

268 ((
PERIPH
=
TIM2
) || \

269 ((
PERIPH
=
TIM3
) || \

270 ((
PERIPH
=
TIM4
) || \

271 ((
PERIPH
=
TIM5
) || \

272 ((
PERIPH
=
TIM6
) || \

273 ((
PERIPH
=
TIM7
) || \

274 ((
PERIPH
=
TIM8
) || \

275 ((
PERIPH
=
TIM15
)|| \

276 ((
PERIPH
=
TIM16
)|| \

277 ((
PERIPH
=
TIM17
))

	)

287 
	#TIM_OCMode_Timg
 ((
ut16_t
)0x0000)

	)

288 
	#TIM_OCMode_Aive
 ((
ut16_t
)0x0010)

	)

289 
	#TIM_OCMode_Iive
 ((
ut16_t
)0x0020)

	)

290 
	#TIM_OCMode_Togg
 ((
ut16_t
)0x0030)

	)

291 
	#TIM_OCMode_PWM1
 ((
ut16_t
)0x0060)

	)

292 
	#TIM_OCMode_PWM2
 ((
ut16_t
)0x0070)

	)

293 
	#IS_TIM_OC_MODE
(
MODE
(((MODE=
TIM_OCMode_Timg
) || \

294 ((
MODE
=
TIM_OCMode_Aive
) || \

295 ((
MODE
=
TIM_OCMode_Iive
) || \

296 ((
MODE
=
TIM_OCMode_Togg
)|| \

297 ((
MODE
=
TIM_OCMode_PWM1
) || \

298 ((
MODE
=
TIM_OCMode_PWM2
))

	)

299 
	#IS_TIM_OCM
(
MODE
(((MODE=
TIM_OCMode_Timg
) || \

300 ((
MODE
=
TIM_OCMode_Aive
) || \

301 ((
MODE
=
TIM_OCMode_Iive
) || \

302 ((
MODE
=
TIM_OCMode_Togg
)|| \

303 ((
MODE
=
TIM_OCMode_PWM1
) || \

304 ((
MODE
=
TIM_OCMode_PWM2
) || \

305 ((
MODE
=
TIM_FdAi_Aive
) || \

306 ((
MODE
=
TIM_FdAi_InAive
))

	)

315 
	#TIM_OPMode_Sg
 ((
ut16_t
)0x0008)

	)

316 
	#TIM_OPMode_Rive
 ((
ut16_t
)0x0000)

	)

317 
	#IS_TIM_OPM_MODE
(
MODE
(((MODE=
TIM_OPMode_Sg
) || \

318 ((
MODE
=
TIM_OPMode_Rive
))

	)

327 
	#TIM_Chl_1
 ((
ut16_t
)0x0000)

	)

328 
	#TIM_Chl_2
 ((
ut16_t
)0x0004)

	)

329 
	#TIM_Chl_3
 ((
ut16_t
)0x0008)

	)

330 
	#TIM_Chl_4
 ((
ut16_t
)0x000C)

	)

331 
	#IS_TIM_CHANNEL
(
CHANNEL
(((CHANNEL=
TIM_Chl_1
) || \

332 ((
CHANNEL
=
TIM_Chl_2
) || \

333 ((
CHANNEL
=
TIM_Chl_3
) || \

334 ((
CHANNEL
=
TIM_Chl_4
))

	)

335 
	#IS_TIM_PWMI_CHANNEL
(
CHANNEL
(((CHANNEL=
TIM_Chl_1
) || \

336 ((
CHANNEL
=
TIM_Chl_2
))

	)

337 
	#IS_TIM_COMPLEMENTARY_CHANNEL
(
CHANNEL
(((CHANNEL=
TIM_Chl_1
) || \

338 ((
CHANNEL
=
TIM_Chl_2
) || \

339 ((
CHANNEL
=
TIM_Chl_3
))

	)

348 
	#TIM_CKD_DIV1
 ((
ut16_t
)0x0000)

	)

349 
	#TIM_CKD_DIV2
 ((
ut16_t
)0x0100)

	)

350 
	#TIM_CKD_DIV4
 ((
ut16_t
)0x0200)

	)

351 
	#IS_TIM_CKD_DIV
(
DIV
(((DIV=
TIM_CKD_DIV1
) || \

352 ((
DIV
=
TIM_CKD_DIV2
) || \

353 ((
DIV
=
TIM_CKD_DIV4
))

	)

362 
	#TIM_CouMode_Up
 ((
ut16_t
)0x0000)

	)

363 
	#TIM_CouMode_Down
 ((
ut16_t
)0x0010)

	)

364 
	#TIM_CouMode_CrAligd1
 ((
ut16_t
)0x0020)

	)

365 
	#TIM_CouMode_CrAligd2
 ((
ut16_t
)0x0040)

	)

366 
	#TIM_CouMode_CrAligd3
 ((
ut16_t
)0x0060)

	)

367 
	#IS_TIM_COUNTER_MODE
(
MODE
(((MODE=
TIM_CouMode_Up
) || \

368 ((
MODE
=
TIM_CouMode_Down
) || \

369 ((
MODE
=
TIM_CouMode_CrAligd1
) || \

370 ((
MODE
=
TIM_CouMode_CrAligd2
) || \

371 ((
MODE
=
TIM_CouMode_CrAligd3
))

	)

380 
	#TIM_OCPެy_High
 ((
ut16_t
)0x0000)

	)

381 
	#TIM_OCPެy_Low
 ((
ut16_t
)0x0002)

	)

382 
	#IS_TIM_OC_POLARITY
(
POLARITY
(((POLARITY=
TIM_OCPެy_High
) || \

383 ((
POLARITY
=
TIM_OCPެy_Low
))

	)

392 
	#TIM_OCNPެy_High
 ((
ut16_t
)0x0000)

	)

393 
	#TIM_OCNPެy_Low
 ((
ut16_t
)0x0008)

	)

394 
	#IS_TIM_OCN_POLARITY
(
POLARITY
(((POLARITY=
TIM_OCNPެy_High
) || \

395 ((
POLARITY
=
TIM_OCNPެy_Low
))

	)

404 
	#TIM_OuutS_Dib
 ((
ut16_t
)0x0000)

	)

405 
	#TIM_OuutS_Eb
 ((
ut16_t
)0x0001)

	)

406 
	#IS_TIM_OUTPUT_STATE
(
STATE
(((STATE=
TIM_OuutS_Dib
) || \

407 ((
STATE
=
TIM_OuutS_Eb
))

	)

416 
	#TIM_OuutNS_Dib
 ((
ut16_t
)0x0000)

	)

417 
	#TIM_OuutNS_Eb
 ((
ut16_t
)0x0004)

	)

418 
	#IS_TIM_OUTPUTN_STATE
(
STATE
(((STATE=
TIM_OuutNS_Dib
) || \

419 ((
STATE
=
TIM_OuutNS_Eb
))

	)

428 
	#TIM_CCx_Eb
 ((
ut16_t
)0x0001)

	)

429 
	#TIM_CCx_Dib
 ((
ut16_t
)0x0000)

	)

430 
	#IS_TIM_CCX
(
CCX
(((CCX=
TIM_CCx_Eb
) || \

431 ((
CCX
=
TIM_CCx_Dib
))

	)

440 
	#TIM_CCxN_Eb
 ((
ut16_t
)0x0004)

	)

441 
	#TIM_CCxN_Dib
 ((
ut16_t
)0x0000)

	)

442 
	#IS_TIM_CCXN
(
CCXN
(((CCXN=
TIM_CCxN_Eb
) || \

443 ((
CCXN
=
TIM_CCxN_Dib
))

	)

452 
	#TIM_Bak_Eb
 ((
ut16_t
)0x1000)

	)

453 
	#TIM_Bak_Dib
 ((
ut16_t
)0x0000)

	)

454 
	#IS_TIM_BREAK_STATE
(
STATE
(((STATE=
TIM_Bak_Eb
) || \

455 ((
STATE
=
TIM_Bak_Dib
))

	)

464 
	#TIM_BakPެy_Low
 ((
ut16_t
)0x0000)

	)

465 
	#TIM_BakPެy_High
 ((
ut16_t
)0x2000)

	)

466 
	#IS_TIM_BREAK_POLARITY
(
POLARITY
(((POLARITY=
TIM_BakPެy_Low
) || \

467 ((
POLARITY
=
TIM_BakPެy_High
))

	)

476 
	#TIM_AutomicOuut_Eb
 ((
ut16_t
)0x4000)

	)

477 
	#TIM_AutomicOuut_Dib
 ((
ut16_t
)0x0000)

	)

478 
	#IS_TIM_AUTOMATIC_OUTPUT_STATE
(
STATE
(((STATE=
TIM_AutomicOuut_Eb
) || \

479 ((
STATE
=
TIM_AutomicOuut_Dib
))

	)

488 
	#TIM_LOCKLev_OFF
 ((
ut16_t
)0x0000)

	)

489 
	#TIM_LOCKLev_1
 ((
ut16_t
)0x0100)

	)

490 
	#TIM_LOCKLev_2
 ((
ut16_t
)0x0200)

	)

491 
	#TIM_LOCKLev_3
 ((
ut16_t
)0x0300)

	)

492 
	#IS_TIM_LOCK_LEVEL
(
LEVEL
(((LEVEL=
TIM_LOCKLev_OFF
) || \

493 ((
LEVEL
=
TIM_LOCKLev_1
) || \

494 ((
LEVEL
=
TIM_LOCKLev_2
) || \

495 ((
LEVEL
=
TIM_LOCKLev_3
))

	)

504 
	#TIM_OSSIS_Eb
 ((
ut16_t
)0x0400)

	)

505 
	#TIM_OSSIS_Dib
 ((
ut16_t
)0x0000)

	)

506 
	#IS_TIM_OSSI_STATE
(
STATE
(((STATE=
TIM_OSSIS_Eb
) || \

507 ((
STATE
=
TIM_OSSIS_Dib
))

	)

516 
	#TIM_OSSRS_Eb
 ((
ut16_t
)0x0800)

	)

517 
	#TIM_OSSRS_Dib
 ((
ut16_t
)0x0000)

	)

518 
	#IS_TIM_OSSR_STATE
(
STATE
(((STATE=
TIM_OSSRS_Eb
) || \

519 ((
STATE
=
TIM_OSSRS_Dib
))

	)

528 
	#TIM_OCIdS_S
 ((
ut16_t
)0x0100)

	)

529 
	#TIM_OCIdS_Ret
 ((
ut16_t
)0x0000)

	)

530 
	#IS_TIM_OCIDLE_STATE
(
STATE
(((STATE=
TIM_OCIdS_S
) || \

531 ((
STATE
=
TIM_OCIdS_Ret
))

	)

540 
	#TIM_OCNIdS_S
 ((
ut16_t
)0x0200)

	)

541 
	#TIM_OCNIdS_Ret
 ((
ut16_t
)0x0000)

	)

542 
	#IS_TIM_OCNIDLE_STATE
(
STATE
(((STATE=
TIM_OCNIdS_S
) || \

543 ((
STATE
=
TIM_OCNIdS_Ret
))

	)

552 
	#TIM_ICPެy_Risg
 ((
ut16_t
)0x0000)

	)

553 
	#TIM_ICPެy_Flg
 ((
ut16_t
)0x0002)

	)

554 
	#TIM_ICPެy_BhEdge
 ((
ut16_t
)0x000A)

	)

555 
	#IS_TIM_IC_POLARITY
(
POLARITY
(((POLARITY=
TIM_ICPެy_Risg
) || \

556 ((
POLARITY
=
TIM_ICPެy_Flg
))

	)

557 
	#IS_TIM_IC_POLARITY_LITE
(
POLARITY
(((POLARITY=
TIM_ICPެy_Risg
) || \

558 ((
POLARITY
=
TIM_ICPެy_Flg
)|| \

559 ((
POLARITY
=
TIM_ICPެy_BhEdge
))

	)

568 
	#TIM_ICSei_DeTI
 ((
ut16_t
)0x0001

	)

570 
	#TIM_ICSei_IndeTI
 ((
ut16_t
)0x0002

	)

572 
	#TIM_ICSei_TRC
 ((
ut16_t
)0x0003

	)

573 
	#IS_TIM_IC_SELECTION
(
SELECTION
(((SELECTION=
TIM_ICSei_DeTI
) || \

574 ((
SELECTION
=
TIM_ICSei_IndeTI
) || \

575 ((
SELECTION
=
TIM_ICSei_TRC
))

	)

584 
	#TIM_ICPSC_DIV1
 ((
ut16_t
)0x0000

	)

585 
	#TIM_ICPSC_DIV2
 ((
ut16_t
)0x0004

	)

586 
	#TIM_ICPSC_DIV4
 ((
ut16_t
)0x0008

	)

587 
	#TIM_ICPSC_DIV8
 ((
ut16_t
)0x000C

	)

588 
	#IS_TIM_IC_PRESCALER
(
PRESCALER
(((PRESCALER=
TIM_ICPSC_DIV1
) || \

589 ((
PRESCALER
=
TIM_ICPSC_DIV2
) || \

590 ((
PRESCALER
=
TIM_ICPSC_DIV4
) || \

591 ((
PRESCALER
=
TIM_ICPSC_DIV8
))

	)

600 
	#TIM_IT_Upde
 ((
ut16_t
)0x0001)

	)

601 
	#TIM_IT_CC1
 ((
ut16_t
)0x0002)

	)

602 
	#TIM_IT_CC2
 ((
ut16_t
)0x0004)

	)

603 
	#TIM_IT_CC3
 ((
ut16_t
)0x0008)

	)

604 
	#TIM_IT_CC4
 ((
ut16_t
)0x0010)

	)

605 
	#TIM_IT_COM
 ((
ut16_t
)0x0020)

	)

606 
	#TIM_IT_Trigg
 ((
ut16_t
)0x0040)

	)

607 
	#TIM_IT_Bak
 ((
ut16_t
)0x0080)

	)

608 
	#IS_TIM_IT
(
IT
((((IT& (
ut16_t
)0xFF00=0x0000&& ((IT!0x0000))

	)

610 
	#IS_TIM_GET_IT
(
IT
(((IT=
TIM_IT_Upde
) || \

611 ((
IT
=
TIM_IT_CC1
) || \

612 ((
IT
=
TIM_IT_CC2
) || \

613 ((
IT
=
TIM_IT_CC3
) || \

614 ((
IT
=
TIM_IT_CC4
) || \

615 ((
IT
=
TIM_IT_COM
) || \

616 ((
IT
=
TIM_IT_Trigg
) || \

617 ((
IT
=
TIM_IT_Bak
))

	)

626 
	#TIM_DMABa_CR1
 ((
ut16_t
)0x0000)

	)

627 
	#TIM_DMABa_CR2
 ((
ut16_t
)0x0001)

	)

628 
	#TIM_DMABa_SMCR
 ((
ut16_t
)0x0002)

	)

629 
	#TIM_DMABa_DIER
 ((
ut16_t
)0x0003)

	)

630 
	#TIM_DMABa_SR
 ((
ut16_t
)0x0004)

	)

631 
	#TIM_DMABa_EGR
 ((
ut16_t
)0x0005)

	)

632 
	#TIM_DMABa_CCMR1
 ((
ut16_t
)0x0006)

	)

633 
	#TIM_DMABa_CCMR2
 ((
ut16_t
)0x0007)

	)

634 
	#TIM_DMABa_CCER
 ((
ut16_t
)0x0008)

	)

635 
	#TIM_DMABa_CNT
 ((
ut16_t
)0x0009)

	)

636 
	#TIM_DMABa_PSC
 ((
ut16_t
)0x000A)

	)

637 
	#TIM_DMABa_ARR
 ((
ut16_t
)0x000B)

	)

638 
	#TIM_DMABa_RCR
 ((
ut16_t
)0x000C)

	)

639 
	#TIM_DMABa_CCR1
 ((
ut16_t
)0x000D)

	)

640 
	#TIM_DMABa_CCR2
 ((
ut16_t
)0x000E)

	)

641 
	#TIM_DMABa_CCR3
 ((
ut16_t
)0x000F)

	)

642 
	#TIM_DMABa_CCR4
 ((
ut16_t
)0x0010)

	)

643 
	#TIM_DMABa_BDTR
 ((
ut16_t
)0x0011)

	)

644 
	#TIM_DMABa_DCR
 ((
ut16_t
)0x0012)

	)

645 
	#IS_TIM_DMA_BASE
(
BASE
(((BASE=
TIM_DMABa_CR1
) || \

646 ((
BASE
=
TIM_DMABa_CR2
) || \

647 ((
BASE
=
TIM_DMABa_SMCR
) || \

648 ((
BASE
=
TIM_DMABa_DIER
) || \

649 ((
BASE
=
TIM_DMABa_SR
) || \

650 ((
BASE
=
TIM_DMABa_EGR
) || \

651 ((
BASE
=
TIM_DMABa_CCMR1
) || \

652 ((
BASE
=
TIM_DMABa_CCMR2
) || \

653 ((
BASE
=
TIM_DMABa_CCER
) || \

654 ((
BASE
=
TIM_DMABa_CNT
) || \

655 ((
BASE
=
TIM_DMABa_PSC
) || \

656 ((
BASE
=
TIM_DMABa_ARR
) || \

657 ((
BASE
=
TIM_DMABa_RCR
) || \

658 ((
BASE
=
TIM_DMABa_CCR1
) || \

659 ((
BASE
=
TIM_DMABa_CCR2
) || \

660 ((
BASE
=
TIM_DMABa_CCR3
) || \

661 ((
BASE
=
TIM_DMABa_CCR4
) || \

662 ((
BASE
=
TIM_DMABa_BDTR
) || \

663 ((
BASE
=
TIM_DMABa_DCR
))

	)

672 
	#TIM_DMABurLgth_1By
 ((
ut16_t
)0x0000)

	)

673 
	#TIM_DMABurLgth_2Bys
 ((
ut16_t
)0x0100)

	)

674 
	#TIM_DMABurLgth_3Bys
 ((
ut16_t
)0x0200)

	)

675 
	#TIM_DMABurLgth_4Bys
 ((
ut16_t
)0x0300)

	)

676 
	#TIM_DMABurLgth_5Bys
 ((
ut16_t
)0x0400)

	)

677 
	#TIM_DMABurLgth_6Bys
 ((
ut16_t
)0x0500)

	)

678 
	#TIM_DMABurLgth_7Bys
 ((
ut16_t
)0x0600)

	)

679 
	#TIM_DMABurLgth_8Bys
 ((
ut16_t
)0x0700)

	)

680 
	#TIM_DMABurLgth_9Bys
 ((
ut16_t
)0x0800)

	)

681 
	#TIM_DMABurLgth_10Bys
 ((
ut16_t
)0x0900)

	)

682 
	#TIM_DMABurLgth_11Bys
 ((
ut16_t
)0x0A00)

	)

683 
	#TIM_DMABurLgth_12Bys
 ((
ut16_t
)0x0B00)

	)

684 
	#TIM_DMABurLgth_13Bys
 ((
ut16_t
)0x0C00)

	)

685 
	#TIM_DMABurLgth_14Bys
 ((
ut16_t
)0x0D00)

	)

686 
	#TIM_DMABurLgth_15Bys
 ((
ut16_t
)0x0E00)

	)

687 
	#TIM_DMABurLgth_16Bys
 ((
ut16_t
)0x0F00)

	)

688 
	#TIM_DMABurLgth_17Bys
 ((
ut16_t
)0x1000)

	)

689 
	#TIM_DMABurLgth_18Bys
 ((
ut16_t
)0x1100)

	)

690 
	#IS_TIM_DMA_LENGTH
(
LENGTH
(((LENGTH=
TIM_DMABurLgth_1By
) || \

691 ((
LENGTH
=
TIM_DMABurLgth_2Bys
) || \

692 ((
LENGTH
=
TIM_DMABurLgth_3Bys
) || \

693 ((
LENGTH
=
TIM_DMABurLgth_4Bys
) || \

694 ((
LENGTH
=
TIM_DMABurLgth_5Bys
) || \

695 ((
LENGTH
=
TIM_DMABurLgth_6Bys
) || \

696 ((
LENGTH
=
TIM_DMABurLgth_7Bys
) || \

697 ((
LENGTH
=
TIM_DMABurLgth_8Bys
) || \

698 ((
LENGTH
=
TIM_DMABurLgth_9Bys
) || \

699 ((
LENGTH
=
TIM_DMABurLgth_10Bys
) || \

700 ((
LENGTH
=
TIM_DMABurLgth_11Bys
) || \

701 ((
LENGTH
=
TIM_DMABurLgth_12Bys
) || \

702 ((
LENGTH
=
TIM_DMABurLgth_13Bys
) || \

703 ((
LENGTH
=
TIM_DMABurLgth_14Bys
) || \

704 ((
LENGTH
=
TIM_DMABurLgth_15Bys
) || \

705 ((
LENGTH
=
TIM_DMABurLgth_16Bys
) || \

706 ((
LENGTH
=
TIM_DMABurLgth_17Bys
) || \

707 ((
LENGTH
=
TIM_DMABurLgth_18Bys
))

	)

716 
	#TIM_DMA_Upde
 ((
ut16_t
)0x0100)

	)

717 
	#TIM_DMA_CC1
 ((
ut16_t
)0x0200)

	)

718 
	#TIM_DMA_CC2
 ((
ut16_t
)0x0400)

	)

719 
	#TIM_DMA_CC3
 ((
ut16_t
)0x0800)

	)

720 
	#TIM_DMA_CC4
 ((
ut16_t
)0x1000)

	)

721 
	#TIM_DMA_COM
 ((
ut16_t
)0x2000)

	)

722 
	#TIM_DMA_Trigg
 ((
ut16_t
)0x4000)

	)

723 
	#IS_TIM_DMA_SOURCE
(
SOURCE
((((SOURCE& (
ut16_t
)0x80FF=0x0000&& ((SOURCE!0x0000))

	)

733 
	#TIM_ExtTRGPSC_OFF
 ((
ut16_t
)0x0000)

	)

734 
	#TIM_ExtTRGPSC_DIV2
 ((
ut16_t
)0x1000)

	)

735 
	#TIM_ExtTRGPSC_DIV4
 ((
ut16_t
)0x2000)

	)

736 
	#TIM_ExtTRGPSC_DIV8
 ((
ut16_t
)0x3000)

	)

737 
	#IS_TIM_EXT_PRESCALER
(
PRESCALER
(((PRESCALER=
TIM_ExtTRGPSC_OFF
) || \

738 ((
PRESCALER
=
TIM_ExtTRGPSC_DIV2
) || \

739 ((
PRESCALER
=
TIM_ExtTRGPSC_DIV4
) || \

740 ((
PRESCALER
=
TIM_ExtTRGPSC_DIV8
))

	)

749 
	#TIM_TS_ITR0
 ((
ut16_t
)0x0000)

	)

750 
	#TIM_TS_ITR1
 ((
ut16_t
)0x0010)

	)

751 
	#TIM_TS_ITR2
 ((
ut16_t
)0x0020)

	)

752 
	#TIM_TS_ITR3
 ((
ut16_t
)0x0030)

	)

753 
	#TIM_TS_TI1F_ED
 ((
ut16_t
)0x0040)

	)

754 
	#TIM_TS_TI1FP1
 ((
ut16_t
)0x0050)

	)

755 
	#TIM_TS_TI2FP2
 ((
ut16_t
)0x0060)

	)

756 
	#TIM_TS_ETRF
 ((
ut16_t
)0x0070)

	)

757 
	#IS_TIM_TRIGGER_SELECTION
(
SELECTION
(((SELECTION=
TIM_TS_ITR0
) || \

758 ((
SELECTION
=
TIM_TS_ITR1
) || \

759 ((
SELECTION
=
TIM_TS_ITR2
) || \

760 ((
SELECTION
=
TIM_TS_ITR3
) || \

761 ((
SELECTION
=
TIM_TS_TI1F_ED
) || \

762 ((
SELECTION
=
TIM_TS_TI1FP1
) || \

763 ((
SELECTION
=
TIM_TS_TI2FP2
) || \

764 ((
SELECTION
=
TIM_TS_ETRF
))

	)

765 
	#IS_TIM_INTERNAL_TRIGGER_SELECTION
(
SELECTION
(((SELECTION=
TIM_TS_ITR0
) || \

766 ((
SELECTION
=
TIM_TS_ITR1
) || \

767 ((
SELECTION
=
TIM_TS_ITR2
) || \

768 ((
SELECTION
=
TIM_TS_ITR3
))

	)

777 
	#TIM_TIxExCLK1Sour_TI1
 ((
ut16_t
)0x0050)

	)

778 
	#TIM_TIxExCLK1Sour_TI2
 ((
ut16_t
)0x0060)

	)

779 
	#TIM_TIxExCLK1Sour_TI1ED
 ((
ut16_t
)0x0040)

	)

780 
	#IS_TIM_TIXCLK_SOURCE
(
SOURCE
(((SOURCE=
TIM_TIxExCLK1Sour_TI1
) || \

781 ((
SOURCE
=
TIM_TIxExCLK1Sour_TI2
) || \

782 ((
SOURCE
=
TIM_TIxExCLK1Sour_TI1ED
))

	)

790 
	#TIM_ExtTRGPެy_Invd
 ((
ut16_t
)0x8000)

	)

791 
	#TIM_ExtTRGPެy_NInvd
 ((
ut16_t
)0x0000)

	)

792 
	#IS_TIM_EXT_POLARITY
(
POLARITY
(((POLARITY=
TIM_ExtTRGPެy_Invd
) || \

793 ((
POLARITY
=
TIM_ExtTRGPެy_NInvd
))

	)

802 
	#TIM_PSCRdMode_Upde
 ((
ut16_t
)0x0000)

	)

803 
	#TIM_PSCRdMode_Immed
 ((
ut16_t
)0x0001)

	)

804 
	#IS_TIM_PRESCALER_RELOAD
(
RELOAD
(((RELOAD=
TIM_PSCRdMode_Upde
) || \

805 ((
RELOAD
=
TIM_PSCRdMode_Immed
))

	)

814 
	#TIM_FdAi_Aive
 ((
ut16_t
)0x0050)

	)

815 
	#TIM_FdAi_InAive
 ((
ut16_t
)0x0040)

	)

816 
	#IS_TIM_FORCED_ACTION
(
ACTION
(((ACTION=
TIM_FdAi_Aive
) || \

817 ((
ACTION
=
TIM_FdAi_InAive
))

	)

826 
	#TIM_EncodMode_TI1
 ((
ut16_t
)0x0001)

	)

827 
	#TIM_EncodMode_TI2
 ((
ut16_t
)0x0002)

	)

828 
	#TIM_EncodMode_TI12
 ((
ut16_t
)0x0003)

	)

829 
	#IS_TIM_ENCODER_MODE
(
MODE
(((MODE=
TIM_EncodMode_TI1
) || \

830 ((
MODE
=
TIM_EncodMode_TI2
) || \

831 ((
MODE
=
TIM_EncodMode_TI12
))

	)

841 
	#TIM_EvtSour_Upde
 ((
ut16_t
)0x0001)

	)

842 
	#TIM_EvtSour_CC1
 ((
ut16_t
)0x0002)

	)

843 
	#TIM_EvtSour_CC2
 ((
ut16_t
)0x0004)

	)

844 
	#TIM_EvtSour_CC3
 ((
ut16_t
)0x0008)

	)

845 
	#TIM_EvtSour_CC4
 ((
ut16_t
)0x0010)

	)

846 
	#TIM_EvtSour_COM
 ((
ut16_t
)0x0020)

	)

847 
	#TIM_EvtSour_Trigg
 ((
ut16_t
)0x0040)

	)

848 
	#TIM_EvtSour_Bak
 ((
ut16_t
)0x0080)

	)

849 
	#IS_TIM_EVENT_SOURCE
(
SOURCE
((((SOURCE& (
ut16_t
)0xFF00=0x0000&& ((SOURCE!0x0000))

	)

859 
	#TIM_UpdeSour_Glob
 ((
ut16_t
)0x0000

	)

862 
	#TIM_UpdeSour_Regur
 ((
ut16_t
)0x0001

	)

863 
	#IS_TIM_UPDATE_SOURCE
(
SOURCE
(((SOURCE=
TIM_UpdeSour_Glob
) || \

864 ((
SOURCE
=
TIM_UpdeSour_Regur
))

	)

873 
	#TIM_OCPld_Eb
 ((
ut16_t
)0x0008)

	)

874 
	#TIM_OCPld_Dib
 ((
ut16_t
)0x0000)

	)

875 
	#IS_TIM_OCPRELOAD_STATE
(
STATE
(((STATE=
TIM_OCPld_Eb
) || \

876 ((
STATE
=
TIM_OCPld_Dib
))

	)

885 
	#TIM_OCFa_Eb
 ((
ut16_t
)0x0004)

	)

886 
	#TIM_OCFa_Dib
 ((
ut16_t
)0x0000)

	)

887 
	#IS_TIM_OCFAST_STATE
(
STATE
(((STATE=
TIM_OCFa_Eb
) || \

888 ((
STATE
=
TIM_OCFa_Dib
))

	)

898 
	#TIM_OCCˬ_Eb
 ((
ut16_t
)0x0080)

	)

899 
	#TIM_OCCˬ_Dib
 ((
ut16_t
)0x0000)

	)

900 
	#IS_TIM_OCCLEAR_STATE
(
STATE
(((STATE=
TIM_OCCˬ_Eb
) || \

901 ((
STATE
=
TIM_OCCˬ_Dib
))

	)

910 
	#TIM_TRGOSour_Ret
 ((
ut16_t
)0x0000)

	)

911 
	#TIM_TRGOSour_Eb
 ((
ut16_t
)0x0010)

	)

912 
	#TIM_TRGOSour_Upde
 ((
ut16_t
)0x0020)

	)

913 
	#TIM_TRGOSour_OC1
 ((
ut16_t
)0x0030)

	)

914 
	#TIM_TRGOSour_OC1Ref
 ((
ut16_t
)0x0040)

	)

915 
	#TIM_TRGOSour_OC2Ref
 ((
ut16_t
)0x0050)

	)

916 
	#TIM_TRGOSour_OC3Ref
 ((
ut16_t
)0x0060)

	)

917 
	#TIM_TRGOSour_OC4Ref
 ((
ut16_t
)0x0070)

	)

918 
	#IS_TIM_TRGO_SOURCE
(
SOURCE
(((SOURCE=
TIM_TRGOSour_Ret
) || \

919 ((
SOURCE
=
TIM_TRGOSour_Eb
) || \

920 ((
SOURCE
=
TIM_TRGOSour_Upde
) || \

921 ((
SOURCE
=
TIM_TRGOSour_OC1
) || \

922 ((
SOURCE
=
TIM_TRGOSour_OC1Ref
) || \

923 ((
SOURCE
=
TIM_TRGOSour_OC2Ref
) || \

924 ((
SOURCE
=
TIM_TRGOSour_OC3Ref
) || \

925 ((
SOURCE
=
TIM_TRGOSour_OC4Ref
))

	)

934 
	#TIM_SveMode_Ret
 ((
ut16_t
)0x0004)

	)

935 
	#TIM_SveMode_Ged
 ((
ut16_t
)0x0005)

	)

936 
	#TIM_SveMode_Trigg
 ((
ut16_t
)0x0006)

	)

937 
	#TIM_SveMode_Ex1
 ((
ut16_t
)0x0007)

	)

938 
	#IS_TIM_SLAVE_MODE
(
MODE
(((MODE=
TIM_SveMode_Ret
) || \

939 ((
MODE
=
TIM_SveMode_Ged
) || \

940 ((
MODE
=
TIM_SveMode_Trigg
) || \

941 ((
MODE
=
TIM_SveMode_Ex1
))

	)

950 
	#TIM_MaSveMode_Eb
 ((
ut16_t
)0x0080)

	)

951 
	#TIM_MaSveMode_Dib
 ((
ut16_t
)0x0000)

	)

952 
	#IS_TIM_MSM_STATE
(
STATE
(((STATE=
TIM_MaSveMode_Eb
) || \

953 ((
STATE
=
TIM_MaSveMode_Dib
))

	)

962 
	#TIM_FLAG_Upde
 ((
ut16_t
)0x0001)

	)

963 
	#TIM_FLAG_CC1
 ((
ut16_t
)0x0002)

	)

964 
	#TIM_FLAG_CC2
 ((
ut16_t
)0x0004)

	)

965 
	#TIM_FLAG_CC3
 ((
ut16_t
)0x0008)

	)

966 
	#TIM_FLAG_CC4
 ((
ut16_t
)0x0010)

	)

967 
	#TIM_FLAG_COM
 ((
ut16_t
)0x0020)

	)

968 
	#TIM_FLAG_Trigg
 ((
ut16_t
)0x0040)

	)

969 
	#TIM_FLAG_Bak
 ((
ut16_t
)0x0080)

	)

970 
	#TIM_FLAG_CC1OF
 ((
ut16_t
)0x0200)

	)

971 
	#TIM_FLAG_CC2OF
 ((
ut16_t
)0x0400)

	)

972 
	#TIM_FLAG_CC3OF
 ((
ut16_t
)0x0800)

	)

973 
	#TIM_FLAG_CC4OF
 ((
ut16_t
)0x1000)

	)

974 
	#IS_TIM_GET_FLAG
(
FLAG
(((FLAG=
TIM_FLAG_Upde
) || \

975 ((
FLAG
=
TIM_FLAG_CC1
) || \

976 ((
FLAG
=
TIM_FLAG_CC2
) || \

977 ((
FLAG
=
TIM_FLAG_CC3
) || \

978 ((
FLAG
=
TIM_FLAG_CC4
) || \

979 ((
FLAG
=
TIM_FLAG_COM
) || \

980 ((
FLAG
=
TIM_FLAG_Trigg
) || \

981 ((
FLAG
=
TIM_FLAG_Bak
) || \

982 ((
FLAG
=
TIM_FLAG_CC1OF
) || \

983 ((
FLAG
=
TIM_FLAG_CC2OF
) || \

984 ((
FLAG
=
TIM_FLAG_CC3OF
) || \

985 ((
FLAG
=
TIM_FLAG_CC4OF
))

	)

988 
	#IS_TIM_CLEAR_FLAG
(
TIM_FLAG
((((TIM_FLAG& (
ut16_t
)0xE100=0x0000&& ((TIM_FLAG!0x0000))

	)

997 
	#IS_TIM_IC_FILTER
(
ICFILTER
((ICFILTER<0xF)

	)

1006 
	#IS_TIM_EXT_FILTER
(
EXTFILTER
((EXTFILTER<0xF)

	)

1027 
TIM_DeIn
(
TIM_TyDef
* 
TIMx
);

1028 
TIM_TimeBaIn
(
TIM_TyDef
* 
TIMx
, 
TIM_TimeBaInTyDef
* 
TIM_TimeBaInSu
);

1029 
TIM_OC1In
(
TIM_TyDef
* 
TIMx
, 
TIM_OCInTyDef
* 
TIM_OCInSu
);

1030 
TIM_OC2In
(
TIM_TyDef
* 
TIMx
, 
TIM_OCInTyDef
* 
TIM_OCInSu
);

1031 
TIM_OC3In
(
TIM_TyDef
* 
TIMx
, 
TIM_OCInTyDef
* 
TIM_OCInSu
);

1032 
TIM_OC4In
(
TIM_TyDef
* 
TIMx
, 
TIM_OCInTyDef
* 
TIM_OCInSu
);

1033 
TIM_ICIn
(
TIM_TyDef
* 
TIMx
, 
TIM_ICInTyDef
* 
TIM_ICInSu
);

1034 
TIM_PWMICfig
(
TIM_TyDef
* 
TIMx
, 
TIM_ICInTyDef
* 
TIM_ICInSu
);

1035 
TIM_BDTRCfig
(
TIM_TyDef
* 
TIMx
, 
TIM_BDTRInTyDef
 *
TIM_BDTRInSu
);

1036 
TIM_TimeBaSuIn
(
TIM_TimeBaInTyDef
* 
TIM_TimeBaInSu
);

1037 
TIM_OCSuIn
(
TIM_OCInTyDef
* 
TIM_OCInSu
);

1038 
TIM_ICSuIn
(
TIM_ICInTyDef
* 
TIM_ICInSu
);

1039 
TIM_BDTRSuIn
(
TIM_BDTRInTyDef
* 
TIM_BDTRInSu
);

1040 
TIM_Cmd
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
);

1041 
TIM_ClPWMOuuts
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
);

1042 
TIM_ITCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IT
, 
FuniڮS
 
NewS
);

1043 
TIM_GeEvt
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_EvtSour
);

1044 
TIM_DMACfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_DMABa
, ut16_
TIM_DMABurLgth
);

1045 
TIM_DMACmd
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_DMASour
, 
FuniڮS
 
NewS
);

1046 
TIM_IlClockCfig
(
TIM_TyDef
* 
TIMx
);

1047 
TIM_ITRxExClockCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IutTriggSour
);

1048 
TIM_TIxExClockCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_TIxExCLKSour
,

1049 
ut16_t
 
TIM_ICPެy
, ut16_
ICFr
);

1050 
TIM_ETRClockMode1Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ExtTRGPsr
, ut16_
TIM_ExtTRGPެy
,

1051 
ut16_t
 
ExtTRGFr
);

1052 
TIM_ETRClockMode2Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ExtTRGPsr
,

1053 
ut16_t
 
TIM_ExtTRGPެy
, ut16_
ExtTRGFr
);

1054 
TIM_ETRCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ExtTRGPsr
, ut16_
TIM_ExtTRGPެy
,

1055 
ut16_t
 
ExtTRGFr
);

1056 
TIM_PsrCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Psr
, ut16_
TIM_PSCRdMode
);

1057 
TIM_CouModeCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_CouMode
);

1058 
TIM_SeIutTrigg
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IutTriggSour
);

1059 
TIM_EncodICfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_EncodMode
,

1060 
ut16_t
 
TIM_IC1Pެy
, ut16_
TIM_IC2Pެy
);

1061 
TIM_FdOC1Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FdAi
);

1062 
TIM_FdOC2Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FdAi
);

1063 
TIM_FdOC3Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FdAi
);

1064 
TIM_FdOC4Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FdAi
);

1065 
TIM_ARRPldCfig
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
);

1066 
TIM_SeCOM
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
);

1067 
TIM_SeCCDMA
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
);

1068 
TIM_CCPldCڌ
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
);

1069 
TIM_OC1PldCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPld
);

1070 
TIM_OC2PldCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPld
);

1071 
TIM_OC3PldCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPld
);

1072 
TIM_OC4PldCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPld
);

1073 
TIM_OC1FaCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCFa
);

1074 
TIM_OC2FaCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCFa
);

1075 
TIM_OC3FaCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCFa
);

1076 
TIM_OC4FaCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCFa
);

1077 
TIM_CˬOC1Ref
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCCˬ
);

1078 
TIM_CˬOC2Ref
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCCˬ
);

1079 
TIM_CˬOC3Ref
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCCˬ
);

1080 
TIM_CˬOC4Ref
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCCˬ
);

1081 
TIM_OC1PެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPެy
);

1082 
TIM_OC1NPެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCNPެy
);

1083 
TIM_OC2PެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPެy
);

1084 
TIM_OC2NPެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCNPެy
);

1085 
TIM_OC3PެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPެy
);

1086 
TIM_OC3NPެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCNPެy
);

1087 
TIM_OC4PެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPެy
);

1088 
TIM_CCxCmd
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_Chl
, ut16_
TIM_CCx
);

1089 
TIM_CCxNCmd
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_Chl
, ut16_
TIM_CCxN
);

1090 
TIM_SeOCxM
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_Chl
, ut16_
TIM_OCMode
);

1091 
TIM_UpdeDibCfig
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
);

1092 
TIM_UpdeRequeCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_UpdeSour
);

1093 
TIM_SeHlSs
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
);

1094 
TIM_SeOPulMode
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OPMode
);

1095 
TIM_SeOuutTrigg
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_TRGOSour
);

1096 
TIM_SeSveMode
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_SveMode
);

1097 
TIM_SeMaSveMode
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_MaSveMode
);

1098 
TIM_SCou
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Cou
);

1099 
TIM_SAutܖd
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Autܖd
);

1100 
TIM_SCom1
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Com1
);

1101 
TIM_SCom2
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Com2
);

1102 
TIM_SCom3
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Com3
);

1103 
TIM_SCom4
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Com4
);

1104 
TIM_SIC1Psr
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPSC
);

1105 
TIM_SIC2Psr
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPSC
);

1106 
TIM_SIC3Psr
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPSC
);

1107 
TIM_SIC4Psr
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPSC
);

1108 
TIM_SClockDivisi
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_CKD
);

1109 
ut16_t
 
TIM_GCtu1
(
TIM_TyDef
* 
TIMx
);

1110 
ut16_t
 
TIM_GCtu2
(
TIM_TyDef
* 
TIMx
);

1111 
ut16_t
 
TIM_GCtu3
(
TIM_TyDef
* 
TIMx
);

1112 
ut16_t
 
TIM_GCtu4
(
TIM_TyDef
* 
TIMx
);

1113 
ut16_t
 
TIM_GCou
(
TIM_TyDef
* 
TIMx
);

1114 
ut16_t
 
TIM_GPsr
(
TIM_TyDef
* 
TIMx
);

1115 
FgStus
 
TIM_GFgStus
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FLAG
);

1116 
TIM_CˬFg
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FLAG
);

1117 
ITStus
 
TIM_GITStus
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IT
);

1118 
TIM_CˬITPdgB
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IT
);

1120 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_usart.h

23 #ide
__STM32F10x_USART_H


24 
	#__STM32F10x_USART_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

51 
ut32_t
 
USART_BaudRe
;

56 
ut16_t
 
USART_WdLgth
;

59 
ut16_t
 
USART_StBs
;

62 
ut16_t
 
USART_Py
;

69 
ut16_t
 
USART_Mode
;

72 
ut16_t
 
USART_HdweFlowCڌ
;

75 } 
	tUSART_InTyDef
;

84 
ut16_t
 
USART_Clock
;

87 
ut16_t
 
USART_CPOL
;

90 
ut16_t
 
USART_CPHA
;

93 
ut16_t
 
USART_LaB
;

96 } 
	tUSART_ClockInTyDef
;

106 
	#IS_USART_ALL_PERIPH
(
PERIPH
(((PERIPH=
USART1
) || \

107 ((
PERIPH
=
USART2
) || \

108 ((
PERIPH
=
USART3
) || \

109 ((
PERIPH
=
UART4
) || \

110 ((
PERIPH
=
UART5
))

	)

112 
	#IS_USART_123_PERIPH
(
PERIPH
(((PERIPH=
USART1
) || \

113 ((
PERIPH
=
USART2
) || \

114 ((
PERIPH
=
USART3
))

	)

116 
	#IS_USART_1234_PERIPH
(
PERIPH
(((PERIPH=
USART1
) || \

117 ((
PERIPH
=
USART2
) || \

118 ((
PERIPH
=
USART3
) || \

119 ((
PERIPH
=
UART4
))

	)

124 
	#USART_WdLgth_8b
 ((
ut16_t
)0x0000)

	)

125 
	#USART_WdLgth_9b
 ((
ut16_t
)0x1000)

	)

127 
	#IS_USART_WORD_LENGTH
(
LENGTH
(((LENGTH=
USART_WdLgth_8b
) || \

128 ((
LENGTH
=
USART_WdLgth_9b
))

	)

137 
	#USART_StBs_1
 ((
ut16_t
)0x0000)

	)

138 
	#USART_StBs_0_5
 ((
ut16_t
)0x1000)

	)

139 
	#USART_StBs_2
 ((
ut16_t
)0x2000)

	)

140 
	#USART_StBs_1_5
 ((
ut16_t
)0x3000)

	)

141 
	#IS_USART_STOPBITS
(
STOPBITS
(((STOPBITS=
USART_StBs_1
) || \

142 ((
STOPBITS
=
USART_StBs_0_5
) || \

143 ((
STOPBITS
=
USART_StBs_2
) || \

144 ((
STOPBITS
=
USART_StBs_1_5
))

	)

153 
	#USART_Py_No
 ((
ut16_t
)0x0000)

	)

154 
	#USART_Py_Ev
 ((
ut16_t
)0x0400)

	)

155 
	#USART_Py_Odd
 ((
ut16_t
)0x0600)

	)

156 
	#IS_USART_PARITY
(
PARITY
(((PARITY=
USART_Py_No
) || \

157 ((
PARITY
=
USART_Py_Ev
) || \

158 ((
PARITY
=
USART_Py_Odd
))

	)

167 
	#USART_Mode_Rx
 ((
ut16_t
)0x0004)

	)

168 
	#USART_Mode_Tx
 ((
ut16_t
)0x0008)

	)

169 
	#IS_USART_MODE
(
MODE
((((MODE& (
ut16_t
)0xFFF3=0x00&& ((MODE!(ut16_t)0x00))

	)

177 
	#USART_HdweFlowCڌ_Ne
 ((
ut16_t
)0x0000)

	)

178 
	#USART_HdweFlowCڌ_RTS
 ((
ut16_t
)0x0100)

	)

179 
	#USART_HdweFlowCڌ_CTS
 ((
ut16_t
)0x0200)

	)

180 
	#USART_HdweFlowCڌ_RTS_CTS
 ((
ut16_t
)0x0300)

	)

181 
	#IS_USART_HARDWARE_FLOW_CONTROL
(
CONTROL
)\

182 (((
CONTROL
=
USART_HdweFlowCڌ_Ne
) || \

183 ((
CONTROL
=
USART_HdweFlowCڌ_RTS
) || \

184 ((
CONTROL
=
USART_HdweFlowCڌ_CTS
) || \

185 ((
CONTROL
=
USART_HdweFlowCڌ_RTS_CTS
))

	)

193 
	#USART_Clock_Dib
 ((
ut16_t
)0x0000)

	)

194 
	#USART_Clock_Eb
 ((
ut16_t
)0x0800)

	)

195 
	#IS_USART_CLOCK
(
CLOCK
(((CLOCK=
USART_Clock_Dib
) || \

196 ((
CLOCK
=
USART_Clock_Eb
))

	)

205 
	#USART_CPOL_Low
 ((
ut16_t
)0x0000)

	)

206 
	#USART_CPOL_High
 ((
ut16_t
)0x0400)

	)

207 
	#IS_USART_CPOL
(
CPOL
(((CPOL=
USART_CPOL_Low
|| ((CPOL=
USART_CPOL_High
))

	)

217 
	#USART_CPHA_1Edge
 ((
ut16_t
)0x0000)

	)

218 
	#USART_CPHA_2Edge
 ((
ut16_t
)0x0200)

	)

219 
	#IS_USART_CPHA
(
CPHA
(((CPHA=
USART_CPHA_1Edge
|| ((CPHA=
USART_CPHA_2Edge
))

	)

229 
	#USART_LaB_Dib
 ((
ut16_t
)0x0000)

	)

230 
	#USART_LaB_Eb
 ((
ut16_t
)0x0100)

	)

231 
	#IS_USART_LASTBIT
(
LASTBIT
(((LASTBIT=
USART_LaB_Dib
) || \

232 ((
LASTBIT
=
USART_LaB_Eb
))

	)

241 
	#USART_IT_PE
 ((
ut16_t
)0x0028)

	)

242 
	#USART_IT_TXE
 ((
ut16_t
)0x0727)

	)

243 
	#USART_IT_TC
 ((
ut16_t
)0x0626)

	)

244 
	#USART_IT_RXNE
 ((
ut16_t
)0x0525)

	)

245 
	#USART_IT_IDLE
 ((
ut16_t
)0x0424)

	)

246 
	#USART_IT_LBD
 ((
ut16_t
)0x0846)

	)

247 
	#USART_IT_CTS
 ((
ut16_t
)0x096A)

	)

248 
	#USART_IT_ERR
 ((
ut16_t
)0x0060)

	)

249 
	#USART_IT_ORE
 ((
ut16_t
)0x0360)

	)

250 
	#USART_IT_NE
 ((
ut16_t
)0x0260)

	)

251 
	#USART_IT_FE
 ((
ut16_t
)0x0160)

	)

252 
	#IS_USART_CONFIG_IT
(
IT
(((IT=
USART_IT_PE
|| ((IT=
USART_IT_TXE
) || \

253 ((
IT
=
USART_IT_TC
|| ((IT=
USART_IT_RXNE
) || \

254 ((
IT
=
USART_IT_IDLE
|| ((IT=
USART_IT_LBD
) || \

255 ((
IT
=
USART_IT_CTS
|| ((IT=
USART_IT_ERR
))

	)

256 
	#IS_USART_GET_IT
(
IT
(((IT=
USART_IT_PE
|| ((IT=
USART_IT_TXE
) || \

257 ((
IT
=
USART_IT_TC
|| ((IT=
USART_IT_RXNE
) || \

258 ((
IT
=
USART_IT_IDLE
|| ((IT=
USART_IT_LBD
) || \

259 ((
IT
=
USART_IT_CTS
|| ((IT=
USART_IT_ORE
) || \

260 ((
IT
=
USART_IT_NE
|| ((IT=
USART_IT_FE
))

	)

261 
	#IS_USART_CLEAR_IT
(
IT
(((IT=
USART_IT_TC
|| ((IT=
USART_IT_RXNE
) || \

262 ((
IT
=
USART_IT_LBD
|| ((IT=
USART_IT_CTS
))

	)

271 
	#USART_DMAReq_Tx
 ((
ut16_t
)0x0080)

	)

272 
	#USART_DMAReq_Rx
 ((
ut16_t
)0x0040)

	)

273 
	#IS_USART_DMAREQ
(
DMAREQ
((((DMAREQ& (
ut16_t
)0xFF3F=0x00&& ((DMAREQ!(ut16_t)0x00))

	)

283 
	#USART_WakeUp_IdLe
 ((
ut16_t
)0x0000)

	)

284 
	#USART_WakeUp_AddssMk
 ((
ut16_t
)0x0800)

	)

285 
	#IS_USART_WAKEUP
(
WAKEUP
(((WAKEUP=
USART_WakeUp_IdLe
) || \

286 ((
WAKEUP
=
USART_WakeUp_AddssMk
))

	)

295 
	#USART_LINBakDeLgth_10b
 ((
ut16_t
)0x0000)

	)

296 
	#USART_LINBakDeLgth_11b
 ((
ut16_t
)0x0020)

	)

297 
	#IS_USART_LIN_BREAK_DETECT_LENGTH
(
LENGTH
) \

298 (((
LENGTH
=
USART_LINBakDeLgth_10b
) || \

299 ((
LENGTH
=
USART_LINBakDeLgth_11b
))

	)

308 
	#USART_IrDAMode_LowPow
 ((
ut16_t
)0x0004)

	)

309 
	#USART_IrDAMode_Nm
 ((
ut16_t
)0x0000)

	)

310 
	#IS_USART_IRDA_MODE
(
MODE
(((MODE=
USART_IrDAMode_LowPow
) || \

311 ((
MODE
=
USART_IrDAMode_Nm
))

	)

320 
	#USART_FLAG_CTS
 ((
ut16_t
)0x0200)

	)

321 
	#USART_FLAG_LBD
 ((
ut16_t
)0x0100)

	)

322 
	#USART_FLAG_TXE
 ((
ut16_t
)0x0080)

	)

323 
	#USART_FLAG_TC
 ((
ut16_t
)0x0040)

	)

324 
	#USART_FLAG_RXNE
 ((
ut16_t
)0x0020)

	)

325 
	#USART_FLAG_IDLE
 ((
ut16_t
)0x0010)

	)

326 
	#USART_FLAG_ORE
 ((
ut16_t
)0x0008)

	)

327 
	#USART_FLAG_NE
 ((
ut16_t
)0x0004)

	)

328 
	#USART_FLAG_FE
 ((
ut16_t
)0x0002)

	)

329 
	#USART_FLAG_PE
 ((
ut16_t
)0x0001)

	)

330 
	#IS_USART_FLAG
(
FLAG
(((FLAG=
USART_FLAG_PE
|| ((FLAG=
USART_FLAG_TXE
) || \

331 ((
FLAG
=
USART_FLAG_TC
|| ((FLAG=
USART_FLAG_RXNE
) || \

332 ((
FLAG
=
USART_FLAG_IDLE
|| ((FLAG=
USART_FLAG_LBD
) || \

333 ((
FLAG
=
USART_FLAG_CTS
|| ((FLAG=
USART_FLAG_ORE
) || \

334 ((
FLAG
=
USART_FLAG_NE
|| ((FLAG=
USART_FLAG_FE
))

	)

336 
	#IS_USART_CLEAR_FLAG
(
FLAG
((((FLAG& (
ut16_t
)0xFC9F=0x00&& ((FLAG!(ut16_t)0x00))

	)

337 
	#IS_USART_PERIPH_FLAG
(
PERIPH
, 
USART_FLAG
((((*(
ut32_t
*)&(PERIPH)!
UART4_BASE
) &&\

338 ((*(
ut32_t
*)&(
PERIPH
)!
UART5_BASE
)) \

339 || ((
USART_FLAG
!
USART_FLAG_CTS
))

	)

340 
	#IS_USART_BAUDRATE
(
BAUDRATE
(((BAUDRATE> 0&& ((BAUDRATE< 0x0044AA21))

	)

341 
	#IS_USART_ADDRESS
(
ADDRESS
((ADDRESS<0xF)

	)

342 
	#IS_USART_DATA
(
DATA
((DATA<0x1FF)

	)

364 
USART_DeIn
(
USART_TyDef
* 
USARTx
);

365 
USART_In
(
USART_TyDef
* 
USARTx
, 
USART_InTyDef
* 
USART_InSu
);

366 
USART_SuIn
(
USART_InTyDef
* 
USART_InSu
);

367 
USART_ClockIn
(
USART_TyDef
* 
USARTx
, 
USART_ClockInTyDef
* 
USART_ClockInSu
);

368 
USART_ClockSuIn
(
USART_ClockInTyDef
* 
USART_ClockInSu
);

369 
USART_Cmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
);

370 
USART_ITCfig
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_IT
, 
FuniڮS
 
NewS
);

371 
USART_DMACmd
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_DMAReq
, 
FuniڮS
 
NewS
);

372 
USART_SAddss
(
USART_TyDef
* 
USARTx
, 
ut8_t
 
USART_Addss
);

373 
USART_WakeUpCfig
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_WakeUp
);

374 
USART_ReivWakeUpCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
);

375 
USART_LINBakDeLgthCfig
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_LINBakDeLgth
);

376 
USART_LINCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
);

377 
USART_SdDa
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
Da
);

378 
ut16_t
 
USART_ReiveDa
(
USART_TyDef
* 
USARTx
);

379 
USART_SdBak
(
USART_TyDef
* 
USARTx
);

380 
USART_SGudTime
(
USART_TyDef
* 
USARTx
, 
ut8_t
 
USART_GudTime
);

381 
USART_SPsr
(
USART_TyDef
* 
USARTx
, 
ut8_t
 
USART_Psr
);

382 
USART_SmtCdCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
);

383 
USART_SmtCdNACKCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
);

384 
USART_HfDuexCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
);

385 
USART_OvSamg8Cmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
);

386 
USART_OBMhodCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
);

387 
USART_IrDACfig
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_IrDAMode
);

388 
USART_IrDACmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
);

389 
FgStus
 
USART_GFgStus
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_FLAG
);

390 
USART_CˬFg
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_FLAG
);

391 
ITStus
 
USART_GITStus
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_IT
);

392 
USART_CˬITPdgB
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_IT
);

394 #ifde
__lulus


	@ports/stm32f10x/drivers/inc/stm32f10x_wwdg.h

23 #ide
__STM32F10x_WWDG_H


24 
	#__STM32F10x_WWDG_H


	)

26 #ifde
__lulus


31 
	~"m32f10x.h
"

57 
	#WWDG_Psr_1
 ((
ut32_t
)0x00000000)

	)

58 
	#WWDG_Psr_2
 ((
ut32_t
)0x00000080)

	)

59 
	#WWDG_Psr_4
 ((
ut32_t
)0x00000100)

	)

60 
	#WWDG_Psr_8
 ((
ut32_t
)0x00000180)

	)

61 
	#IS_WWDG_PRESCALER
(
PRESCALER
(((PRESCALER=
WWDG_Psr_1
) || \

62 ((
PRESCALER
=
WWDG_Psr_2
) || \

63 ((
PRESCALER
=
WWDG_Psr_4
) || \

64 ((
PRESCALER
=
WWDG_Psr_8
))

	)

65 
	#IS_WWDG_WINDOW_VALUE
(
VALUE
((VALUE<0x7F)

	)

66 
	#IS_WWDG_COUNTER
(
COUNTER
(((COUNTER>0x40&& ((COUNTER<0x7F))

	)

87 
WWDG_DeIn
();

88 
WWDG_SPsr
(
ut32_t
 
WWDG_Psr
);

89 
WWDG_SWdowVue
(
ut8_t
 
WdowVue
);

90 
WWDG_EbIT
();

91 
WWDG_SCou
(
ut8_t
 
Cou
);

92 
WWDG_Eb
(
ut8_t
 
Cou
);

93 
FgStus
 
WWDG_GFgStus
();

94 
WWDG_CˬFg
();

96 #ifde
__lulus


	@ports/stm32f10x/drivers/src/stm32f10x_adc.c

22 
	~"m32f10x_adc.h
"

23 
	~"m32f10x_rcc.h
"

47 
	#CR1_DISCNUM_Ret
 ((
ut32_t
)0xFFFF1FFF)

	)

50 
	#CR1_DISCEN_S
 ((
ut32_t
)0x00000800)

	)

51 
	#CR1_DISCEN_Ret
 ((
ut32_t
)0xFFFFF7FF)

	)

54 
	#CR1_JAUTO_S
 ((
ut32_t
)0x00000400)

	)

55 
	#CR1_JAUTO_Ret
 ((
ut32_t
)0xFFFFFBFF)

	)

58 
	#CR1_JDISCEN_S
 ((
ut32_t
)0x00001000)

	)

59 
	#CR1_JDISCEN_Ret
 ((
ut32_t
)0xFFFFEFFF)

	)

62 
	#CR1_AWDCH_Ret
 ((
ut32_t
)0xFFFFFFE0)

	)

65 
	#CR1_AWDMode_Ret
 ((
ut32_t
)0xFF3FFDFF)

	)

68 
	#CR1_CLEAR_Mask
 ((
ut32_t
)0xFFF0FEFF)

	)

71 
	#CR2_ADON_S
 ((
ut32_t
)0x00000001)

	)

72 
	#CR2_ADON_Ret
 ((
ut32_t
)0xFFFFFFFE)

	)

75 
	#CR2_DMA_S
 ((
ut32_t
)0x00000100)

	)

76 
	#CR2_DMA_Ret
 ((
ut32_t
)0xFFFFFEFF)

	)

79 
	#CR2_RSTCAL_S
 ((
ut32_t
)0x00000008)

	)

82 
	#CR2_CAL_S
 ((
ut32_t
)0x00000004)

	)

85 
	#CR2_SWSTART_S
 ((
ut32_t
)0x00400000)

	)

88 
	#CR2_EXTTRIG_S
 ((
ut32_t
)0x00100000)

	)

89 
	#CR2_EXTTRIG_Ret
 ((
ut32_t
)0xFFEFFFFF)

	)

92 
	#CR2_EXTTRIG_SWSTART_S
 ((
ut32_t
)0x00500000)

	)

93 
	#CR2_EXTTRIG_SWSTART_Ret
 ((
ut32_t
)0xFFAFFFFF)

	)

96 
	#CR2_JEXTSEL_Ret
 ((
ut32_t
)0xFFFF8FFF)

	)

99 
	#CR2_JEXTTRIG_S
 ((
ut32_t
)0x00008000)

	)

100 
	#CR2_JEXTTRIG_Ret
 ((
ut32_t
)0xFFFF7FFF)

	)

103 
	#CR2_JSWSTART_S
 ((
ut32_t
)0x00200000)

	)

106 
	#CR2_JEXTTRIG_JSWSTART_S
 ((
ut32_t
)0x00208000)

	)

107 
	#CR2_JEXTTRIG_JSWSTART_Ret
 ((
ut32_t
)0xFFDF7FFF)

	)

110 
	#CR2_TSVREFE_S
 ((
ut32_t
)0x00800000)

	)

111 
	#CR2_TSVREFE_Ret
 ((
ut32_t
)0xFF7FFFFF)

	)

114 
	#CR2_CLEAR_Mask
 ((
ut32_t
)0xFFF1F7FD)

	)

117 
	#SQR3_SQ_S
 ((
ut32_t
)0x0000001F)

	)

118 
	#SQR2_SQ_S
 ((
ut32_t
)0x0000001F)

	)

119 
	#SQR1_SQ_S
 ((
ut32_t
)0x0000001F)

	)

122 
	#SQR1_CLEAR_Mask
 ((
ut32_t
)0xFF0FFFFF)

	)

125 
	#JSQR_JSQ_S
 ((
ut32_t
)0x0000001F)

	)

128 
	#JSQR_JL_S
 ((
ut32_t
)0x00300000)

	)

129 
	#JSQR_JL_Ret
 ((
ut32_t
)0xFFCFFFFF)

	)

132 
	#SMPR1_SMP_S
 ((
ut32_t
)0x00000007)

	)

133 
	#SMPR2_SMP_S
 ((
ut32_t
)0x00000007)

	)

136 
	#JDR_Offt
 ((
ut8_t
)0x28)

	)

139 
	#DR_ADDRESS
 ((
ut32_t
)0x4001244C)

	)

178 
	$ADC_DeIn
(
ADC_TyDef
* 
ADCx
)

181 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

183 i(
ADCx
 =
ADC1
)

186 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_ADC1
, 
ENABLE
);

188 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_ADC1
, 
DISABLE
);

190 i(
ADCx
 =
ADC2
)

193 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_ADC2
, 
ENABLE
);

195 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_ADC2
, 
DISABLE
);

199 i(
ADCx
 =
ADC3
)

202 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_ADC3
, 
ENABLE
);

204 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_ADC3
, 
DISABLE
);

207 
	}
}

217 
	$ADC_In
(
ADC_TyDef
* 
ADCx
, 
ADC_InTyDef
* 
ADC_InSu
)

219 
ut32_t
 
tmeg1
 = 0;

220 
ut8_t
 
tmeg2
 = 0;

222 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

223 
	`as_m
(
	`IS_ADC_MODE
(
ADC_InSu
->
ADC_Mode
));

224 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
ADC_InSu
->
ADC_SnCvMode
));

225 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
ADC_InSu
->
ADC_CtuousCvMode
));

226 
	`as_m
(
	`IS_ADC_EXT_TRIG
(
ADC_InSu
->
ADC_ExTrigCv
));

227 
	`as_m
(
	`IS_ADC_DATA_ALIGN
(
ADC_InSu
->
ADC_DaAlign
));

228 
	`as_m
(
	`IS_ADC_REGULAR_LENGTH
(
ADC_InSu
->
ADC_NbrOfChl
));

232 
tmeg1
 = 
ADCx
->
CR1
;

234 
tmeg1
 &
CR1_CLEAR_Mask
;

238 
tmeg1
 |(
ut32_t
)(
ADC_InSu
->
ADC_Mode
 | ((ut32_t)ADC_InSu->
ADC_SnCvMode
 << 8));

240 
ADCx
->
CR1
 = 
tmeg1
;

244 
tmeg1
 = 
ADCx
->
CR2
;

246 
tmeg1
 &
CR2_CLEAR_Mask
;

251 
tmeg1
 |(
ut32_t
)(
ADC_InSu
->
ADC_DaAlign
 | ADC_InSu->
ADC_ExTrigCv
 |

252 ((
ut32_t
)
ADC_InSu
->
ADC_CtuousCvMode
 << 1));

254 
ADCx
->
CR2
 = 
tmeg1
;

258 
tmeg1
 = 
ADCx
->
SQR1
;

260 
tmeg1
 &
SQR1_CLEAR_Mask
;

263 
tmeg2
 |(
ut8_t
(
ADC_InSu
->
ADC_NbrOfChl
 - (uint8_t)1);

264 
tmeg1
 |(
ut32_t
)
tmeg2
 << 20;

266 
ADCx
->
SQR1
 = 
tmeg1
;

267 
	}
}

274 
	$ADC_SuIn
(
ADC_InTyDef
* 
ADC_InSu
)

278 
ADC_InSu
->
ADC_Mode
 = 
ADC_Mode_Inddt
;

280 
ADC_InSu
->
ADC_SnCvMode
 = 
DISABLE
;

282 
ADC_InSu
->
ADC_CtuousCvMode
 = 
DISABLE
;

284 
ADC_InSu
->
ADC_ExTrigCv
 = 
ADC_ExTrigCv_T1_CC1
;

286 
ADC_InSu
->
ADC_DaAlign
 = 
ADC_DaAlign_Right
;

288 
ADC_InSu
->
ADC_NbrOfChl
 = 1;

289 
	}
}

298 
	$ADC_Cmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
)

301 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

302 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

303 i(
NewS
 !
DISABLE
)

306 
ADCx
->
CR2
 |
CR2_ADON_S
;

311 
ADCx
->
CR2
 &
CR2_ADON_Ret
;

313 
	}
}

323 
	$ADC_DMACmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
)

326 
	`as_m
(
	`IS_ADC_DMA_PERIPH
(
ADCx
));

327 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

328 i(
NewS
 !
DISABLE
)

331 
ADCx
->
CR2
 |
CR2_DMA_S
;

336 
ADCx
->
CR2
 &
CR2_DMA_Ret
;

338 
	}
}

352 
	$ADC_ITCfig
(
ADC_TyDef
* 
ADCx
, 
ut16_t
 
ADC_IT
, 
FuniڮS
 
NewS
)

354 
ut8_t
 
mask
 = 0;

356 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

357 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

358 
	`as_m
(
	`IS_ADC_IT
(
ADC_IT
));

360 
mask
 = (
ut8_t
)
ADC_IT
;

361 i(
NewS
 !
DISABLE
)

364 
ADCx
->
CR1
 |
mask
;

369 
ADCx
->
CR1
 &(~(
ut32_t
)
mask
);

371 
	}
}

378 
	$ADC_RetCibti
(
ADC_TyDef
* 
ADCx
)

381 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

383 
ADCx
->
CR2
 |
CR2_RSTCAL_S
;

384 
	}
}

391 
FgStus
 
	$ADC_GRetCibtiStus
(
ADC_TyDef
* 
ADCx
)

393 
FgStus
 
bus
 = 
RESET
;

395 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

397 i((
ADCx
->
CR2
 & 
CR2_RSTCAL_S
!(
ut32_t
)
RESET
)

400 
bus
 = 
SET
;

405 
bus
 = 
RESET
;

408  
bus
;

409 
	}
}

416 
	$ADC_SCibti
(
ADC_TyDef
* 
ADCx
)

419 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

421 
ADCx
->
CR2
 |
CR2_CAL_S
;

422 
	}
}

429 
FgStus
 
	$ADC_GCibtiStus
(
ADC_TyDef
* 
ADCx
)

431 
FgStus
 
bus
 = 
RESET
;

433 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

435 i((
ADCx
->
CR2
 & 
CR2_CAL_S
!(
ut32_t
)
RESET
)

438 
bus
 = 
SET
;

443 
bus
 = 
RESET
;

446  
bus
;

447 
	}
}

456 
	$ADC_SoweSCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
)

459 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

460 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

461 i(
NewS
 !
DISABLE
)

465 
ADCx
->
CR2
 |
CR2_EXTTRIG_SWSTART_S
;

471 
ADCx
->
CR2
 &
CR2_EXTTRIG_SWSTART_Ret
;

473 
	}
}

480 
FgStus
 
	$ADC_GSoweSCvStus
(
ADC_TyDef
* 
ADCx
)

482 
FgStus
 
bus
 = 
RESET
;

484 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

486 i((
ADCx
->
CR2
 & 
CR2_SWSTART_S
!(
ut32_t
)
RESET
)

489 
bus
 = 
SET
;

494 
bus
 = 
RESET
;

497  
bus
;

498 
	}
}

508 
	$ADC_DiscModeChlCouCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
Numb
)

510 
ut32_t
 
tmeg1
 = 0;

511 
ut32_t
 
tmeg2
 = 0;

513 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

514 
	`as_m
(
	`IS_ADC_REGULAR_DISC_NUMBER
(
Numb
));

516 
tmeg1
 = 
ADCx
->
CR1
;

518 
tmeg1
 &
CR1_DISCNUM_Ret
;

520 
tmeg2
 = 
Numb
 - 1;

521 
tmeg1
 |
tmeg2
 << 13;

523 
ADCx
->
CR1
 = 
tmeg1
;

524 
	}
}

535 
	$ADC_DiscModeCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
)

538 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

539 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

540 i(
NewS
 !
DISABLE
)

543 
ADCx
->
CR1
 |
CR1_DISCEN_S
;

548 
ADCx
->
CR1
 &
CR1_DISCEN_Ret
;

550 
	}
}

589 
	$ADC_RegurChlCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_Chl
, ut8_
Rk
, ut8_
ADC_SameTime
)

591 
ut32_t
 
tmeg1
 = 0, 
tmeg2
 = 0;

593 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

594 
	`as_m
(
	`IS_ADC_CHANNEL
(
ADC_Chl
));

595 
	`as_m
(
	`IS_ADC_REGULAR_RANK
(
Rk
));

596 
	`as_m
(
	`IS_ADC_SAMPLE_TIME
(
ADC_SameTime
));

598 i(
ADC_Chl
 > 
ADC_Chl_9
)

601 
tmeg1
 = 
ADCx
->
SMPR1
;

603 
tmeg2
 = 
SMPR1_SMP_S
 << (3 * (
ADC_Chl
 - 10));

605 
tmeg1
 &~
tmeg2
;

607 
tmeg2
 = (
ut32_t
)
ADC_SameTime
 << (3 * (
ADC_Chl
 - 10));

609 
tmeg1
 |
tmeg2
;

611 
ADCx
->
SMPR1
 = 
tmeg1
;

616 
tmeg1
 = 
ADCx
->
SMPR2
;

618 
tmeg2
 = 
SMPR2_SMP_S
 << (3 * 
ADC_Chl
);

620 
tmeg1
 &~
tmeg2
;

622 
tmeg2
 = (
ut32_t
)
ADC_SameTime
 << (3 * 
ADC_Chl
);

624 
tmeg1
 |
tmeg2
;

626 
ADCx
->
SMPR2
 = 
tmeg1
;

629 i(
Rk
 < 7)

632 
tmeg1
 = 
ADCx
->
SQR3
;

634 
tmeg2
 = 
SQR3_SQ_S
 << (5 * (
Rk
 - 1));

636 
tmeg1
 &~
tmeg2
;

638 
tmeg2
 = (
ut32_t
)
ADC_Chl
 << (5 * (
Rk
 - 1));

640 
tmeg1
 |
tmeg2
;

642 
ADCx
->
SQR3
 = 
tmeg1
;

645 i(
Rk
 < 13)

648 
tmeg1
 = 
ADCx
->
SQR2
;

650 
tmeg2
 = 
SQR2_SQ_S
 << (5 * (
Rk
 - 7));

652 
tmeg1
 &~
tmeg2
;

654 
tmeg2
 = (
ut32_t
)
ADC_Chl
 << (5 * (
Rk
 - 7));

656 
tmeg1
 |
tmeg2
;

658 
ADCx
->
SQR2
 = 
tmeg1
;

664 
tmeg1
 = 
ADCx
->
SQR1
;

666 
tmeg2
 = 
SQR1_SQ_S
 << (5 * (
Rk
 - 13));

668 
tmeg1
 &~
tmeg2
;

670 
tmeg2
 = (
ut32_t
)
ADC_Chl
 << (5 * (
Rk
 - 13));

672 
tmeg1
 |
tmeg2
;

674 
ADCx
->
SQR1
 = 
tmeg1
;

676 
	}
}

685 
	$ADC_ExTrigCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
)

688 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

689 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

690 i(
NewS
 !
DISABLE
)

693 
ADCx
->
CR2
 |
CR2_EXTTRIG_S
;

698 
ADCx
->
CR2
 &
CR2_EXTTRIG_Ret
;

700 
	}
}

707 
ut16_t
 
	$ADC_GCvsiVue
(
ADC_TyDef
* 
ADCx
)

710 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

712  (
ut16_t

ADCx
->
DR
;

713 
	}
}

719 
ut32_t
 
	$ADC_GDuModeCvsiVue
()

722  (*(
__IO
 
ut32_t
 *
DR_ADDRESS
);

723 
	}
}

733 
	$ADC_AutoInjeedCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
)

736 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

737 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

738 i(
NewS
 !
DISABLE
)

741 
ADCx
->
CR1
 |
CR1_JAUTO_S
;

746 
ADCx
->
CR1
 &
CR1_JAUTO_Ret
;

748 
	}
}

759 
	$ADC_InjeedDiscModeCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
)

762 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

763 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

764 i(
NewS
 !
DISABLE
)

767 
ADCx
->
CR1
 |
CR1_JDISCEN_S
;

772 
ADCx
->
CR1
 &
CR1_JDISCEN_Ret
;

774 
	}
}

798 
	$ADC_ExTrigInjeedCvCfig
(
ADC_TyDef
* 
ADCx
, 
ut32_t
 
ADC_ExTrigInjecCv
)

800 
ut32_t
 
tmeg
 = 0;

802 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

803 
	`as_m
(
	`IS_ADC_EXT_INJEC_TRIG
(
ADC_ExTrigInjecCv
));

805 
tmeg
 = 
ADCx
->
CR2
;

807 
tmeg
 &
CR2_JEXTSEL_Ret
;

809 
tmeg
 |
ADC_ExTrigInjecCv
;

811 
ADCx
->
CR2
 = 
tmeg
;

812 
	}
}

823 
	$ADC_ExTrigInjeedCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
)

826 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

827 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

828 i(
NewS
 !
DISABLE
)

831 
ADCx
->
CR2
 |
CR2_JEXTTRIG_S
;

836 
ADCx
->
CR2
 &
CR2_JEXTTRIG_Ret
;

838 
	}
}

848 
	$ADC_SoweSInjeedCvCmd
(
ADC_TyDef
* 
ADCx
, 
FuniڮS
 
NewS
)

851 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

852 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

853 i(
NewS
 !
DISABLE
)

857 
ADCx
->
CR2
 |
CR2_JEXTTRIG_JSWSTART_S
;

863 
ADCx
->
CR2
 &
CR2_JEXTTRIG_JSWSTART_Ret
;

865 
	}
}

872 
FgStus
 
	$ADC_GSoweSInjeedCvCmdStus
(
ADC_TyDef
* 
ADCx
)

874 
FgStus
 
bus
 = 
RESET
;

876 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

878 i((
ADCx
->
CR2
 & 
CR2_JSWSTART_S
!(
ut32_t
)
RESET
)

881 
bus
 = 
SET
;

886 
bus
 = 
RESET
;

889  
bus
;

890 
	}
}

929 
	$ADC_InjeedChlCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_Chl
, ut8_
Rk
, ut8_
ADC_SameTime
)

931 
ut32_t
 
tmeg1
 = 0, 
tmeg2
 = 0, 
tmeg3
 = 0;

933 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

934 
	`as_m
(
	`IS_ADC_CHANNEL
(
ADC_Chl
));

935 
	`as_m
(
	`IS_ADC_INJECTED_RANK
(
Rk
));

936 
	`as_m
(
	`IS_ADC_SAMPLE_TIME
(
ADC_SameTime
));

938 i(
ADC_Chl
 > 
ADC_Chl_9
)

941 
tmeg1
 = 
ADCx
->
SMPR1
;

943 
tmeg2
 = 
SMPR1_SMP_S
 << (3*(
ADC_Chl
 - 10));

945 
tmeg1
 &~
tmeg2
;

947 
tmeg2
 = (
ut32_t
)
ADC_SameTime
 << (3*(
ADC_Chl
 - 10));

949 
tmeg1
 |
tmeg2
;

951 
ADCx
->
SMPR1
 = 
tmeg1
;

956 
tmeg1
 = 
ADCx
->
SMPR2
;

958 
tmeg2
 = 
SMPR2_SMP_S
 << (3 * 
ADC_Chl
);

960 
tmeg1
 &~
tmeg2
;

962 
tmeg2
 = (
ut32_t
)
ADC_SameTime
 << (3 * 
ADC_Chl
);

964 
tmeg1
 |
tmeg2
;

966 
ADCx
->
SMPR2
 = 
tmeg1
;

970 
tmeg1
 = 
ADCx
->
JSQR
;

972 
tmeg3
 = (
tmeg1
 & 
JSQR_JL_S
)>> 20;

974 
tmeg2
 = 
JSQR_JSQ_S
 << (5 * (
ut8_t
)((
Rk
 + 3- (
tmeg3
 + 1)));

976 
tmeg1
 &~
tmeg2
;

978 
tmeg2
 = (
ut32_t
)
ADC_Chl
 << (5 * (
ut8_t
)((
Rk
 + 3- (
tmeg3
 + 1)));

980 
tmeg1
 |
tmeg2
;

982 
ADCx
->
JSQR
 = 
tmeg1
;

983 
	}
}

992 
	$ADC_InjeedSequrLgthCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
Lgth
)

994 
ut32_t
 
tmeg1
 = 0;

995 
ut32_t
 
tmeg2
 = 0;

997 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

998 
	`as_m
(
	`IS_ADC_INJECTED_LENGTH
(
Lgth
));

1001 
tmeg1
 = 
ADCx
->
JSQR
;

1003 
tmeg1
 &
JSQR_JL_Ret
;

1005 
tmeg2
 = 
Lgth
 - 1;

1006 
tmeg1
 |
tmeg2
 << 20;

1008 
ADCx
->
JSQR
 = 
tmeg1
;

1009 
	}
}

1024 
	$ADC_SInjeedOfft
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_InjeedChl
, 
ut16_t
 
Offt
)

1026 
__IO
 
ut32_t
 
tmp
 = 0;

1029 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1030 
	`as_m
(
	`IS_ADC_INJECTED_CHANNEL
(
ADC_InjeedChl
));

1031 
	`as_m
(
	`IS_ADC_OFFSET
(
Offt
));

1033 
tmp
 = (
ut32_t
)
ADCx
;

1034 
tmp
 +
ADC_InjeedChl
;

1037 *(
__IO
 
ut32_t
 *
tmp
 = (ut32_t)
Offt
;

1038 
	}
}

1051 
ut16_t
 
	$ADC_GInjeedCvsiVue
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_InjeedChl
)

1053 
__IO
 
ut32_t
 
tmp
 = 0;

1056 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1057 
	`as_m
(
	`IS_ADC_INJECTED_CHANNEL
(
ADC_InjeedChl
));

1059 
tmp
 = (
ut32_t
)
ADCx
;

1060 
tmp
 +
ADC_InjeedChl
 + 
JDR_Offt
;

1063  (
ut16_t
(*(
__IO
 
ut32_t
*
tmp
);

1064 
	}
}

1081 
	$ADC_AlogWchdogCmd
(
ADC_TyDef
* 
ADCx
, 
ut32_t
 
ADC_AlogWchdog
)

1083 
ut32_t
 
tmeg
 = 0;

1085 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1086 
	`as_m
(
	`IS_ADC_ANALOG_WATCHDOG
(
ADC_AlogWchdog
));

1088 
tmeg
 = 
ADCx
->
CR1
;

1090 
tmeg
 &
CR1_AWDMode_Ret
;

1092 
tmeg
 |
ADC_AlogWchdog
;

1094 
ADCx
->
CR1
 = 
tmeg
;

1095 
	}
}

1106 
	$ADC_AlogWchdogThshdsCfig
(
ADC_TyDef
* 
ADCx
, 
ut16_t
 
HighThshd
,

1107 
ut16_t
 
LowThshd
)

1110 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1111 
	`as_m
(
	`IS_ADC_THRESHOLD
(
HighThshd
));

1112 
	`as_m
(
	`IS_ADC_THRESHOLD
(
LowThshd
));

1114 
ADCx
->
HTR
 = 
HighThshd
;

1116 
ADCx
->
LTR
 = 
LowThshd
;

1117 
	}
}

1144 
	$ADC_AlogWchdogSgChlCfig
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_Chl
)

1146 
ut32_t
 
tmeg
 = 0;

1148 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1149 
	`as_m
(
	`IS_ADC_CHANNEL
(
ADC_Chl
));

1151 
tmeg
 = 
ADCx
->
CR1
;

1153 
tmeg
 &
CR1_AWDCH_Ret
;

1155 
tmeg
 |
ADC_Chl
;

1157 
ADCx
->
CR1
 = 
tmeg
;

1158 
	}
}

1166 
	$ADC_TempSsVftCmd
(
FuniڮS
 
NewS
)

1169 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1170 i(
NewS
 !
DISABLE
)

1173 
ADC1
->
CR2
 |
CR2_TSVREFE_S
;

1178 
ADC1
->
CR2
 &
CR2_TSVREFE_Ret
;

1180 
	}
}

1194 
FgStus
 
	$ADC_GFgStus
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_FLAG
)

1196 
FgStus
 
bus
 = 
RESET
;

1198 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1199 
	`as_m
(
	`IS_ADC_GET_FLAG
(
ADC_FLAG
));

1201 i((
ADCx
->
SR
 & 
ADC_FLAG
!(
ut8_t
)
RESET
)

1204 
bus
 = 
SET
;

1209 
bus
 = 
RESET
;

1212  
bus
;

1213 
	}
}

1227 
	$ADC_CˬFg
(
ADC_TyDef
* 
ADCx
, 
ut8_t
 
ADC_FLAG
)

1230 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1231 
	`as_m
(
	`IS_ADC_CLEAR_FLAG
(
ADC_FLAG
));

1233 
ADCx
->
SR
 = ~(
ut32_t
)
ADC_FLAG
;

1234 
	}
}

1246 
ITStus
 
	$ADC_GITStus
(
ADC_TyDef
* 
ADCx
, 
ut16_t
 
ADC_IT
)

1248 
ITStus
 
bus
 = 
RESET
;

1249 
ut32_t
 
mask
 = 0, 
abˡus
 = 0;

1251 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1252 
	`as_m
(
	`IS_ADC_GET_IT
(
ADC_IT
));

1254 
mask
 = 
ADC_IT
 >> 8;

1256 
abˡus
 = (
ADCx
->
CR1
 & (
ut8_t
)
ADC_IT
) ;

1258 i(((
ADCx
->
SR
 & 
mask
!(
ut32_t
)
RESET
&& 
abˡus
)

1261 
bus
 = 
SET
;

1266 
bus
 = 
RESET
;

1269  
bus
;

1270 
	}
}

1282 
	$ADC_CˬITPdgB
(
ADC_TyDef
* 
ADCx
, 
ut16_t
 
ADC_IT
)

1284 
ut8_t
 
mask
 = 0;

1286 
	`as_m
(
	`IS_ADC_ALL_PERIPH
(
ADCx
));

1287 
	`as_m
(
	`IS_ADC_IT
(
ADC_IT
));

1289 
mask
 = (
ut8_t
)(
ADC_IT
 >> 8);

1291 
ADCx
->
SR
 = ~(
ut32_t
)
mask
;

1292 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_bkp.c

22 
	~"m32f10x_bkp.h
"

23 
	~"m32f10x_rcc.h
"

47 
	#BKP_OFFSET
 (
BKP_BASE
 - 
PERIPH_BASE
)

	)

52 
	#CR_OFFSET
 (
BKP_OFFSET
 + 0x30)

	)

53 
	#TPAL_BNumb
 0x01

	)

54 
	#CR_TPAL_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32+ (
TPAL_BNumb
 * 4))

	)

57 
	#TPE_BNumb
 0x00

	)

58 
	#CR_TPE_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32+ (
TPE_BNumb
 * 4))

	)

63 
	#CSR_OFFSET
 (
BKP_OFFSET
 + 0x34)

	)

64 
	#TPIE_BNumb
 0x02

	)

65 
	#CSR_TPIE_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32+ (
TPIE_BNumb
 * 4))

	)

68 
	#TIF_BNumb
 0x09

	)

69 
	#CSR_TIF_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32+ (
TIF_BNumb
 * 4))

	)

72 
	#TEF_BNumb
 0x08

	)

73 
	#CSR_TEF_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32+ (
TEF_BNumb
 * 4))

	)

78 
	#RTCCR_CAL_MASK
 ((
ut16_t
)0xFF80)

	)

79 
	#RTCCR_MASK
 ((
ut16_t
)0xFC7F)

	)

119 
	$BKP_DeIn
()

121 
	`RCC_BackupRetCmd
(
ENABLE
);

122 
	`RCC_BackupRetCmd
(
DISABLE
);

123 
	}
}

133 
	$BKP_TamrPLevCfig
(
ut16_t
 
BKP_TamrPLev
)

136 
	`as_m
(
	`IS_BKP_TAMPER_PIN_LEVEL
(
BKP_TamrPLev
));

137 *(
__IO
 
ut32_t
 *
CR_TPAL_BB
 = 
BKP_TamrPLev
;

138 
	}
}

146 
	$BKP_TamrPCmd
(
FuniڮS
 
NewS
)

149 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

150 *(
__IO
 
ut32_t
 *
CR_TPE_BB
 = (ut32_t)
NewS
;

151 
	}
}

159 
	$BKP_ITCfig
(
FuniڮS
 
NewS
)

162 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

163 *(
__IO
 
ut32_t
 *
CSR_TPIE_BB
 = (ut32_t)
NewS
;

164 
	}
}

179 
	$BKP_RTCOuutCfig
(
ut16_t
 
BKP_RTCOuutSour
)

181 
ut16_t
 
tmeg
 = 0;

183 
	`as_m
(
	`IS_BKP_RTC_OUTPUT_SOURCE
(
BKP_RTCOuutSour
));

184 
tmeg
 = 
BKP
->
RTCCR
;

186 
tmeg
 &
RTCCR_MASK
;

189 
tmeg
 |
BKP_RTCOuutSour
;

191 
BKP
->
RTCCR
 = 
tmeg
;

192 
	}
}

200 
	$BKP_SRTCCibtiVue
(
ut8_t
 
CibtiVue
)

202 
ut16_t
 
tmeg
 = 0;

204 
	`as_m
(
	`IS_BKP_CALIBRATION_VALUE
(
CibtiVue
));

205 
tmeg
 = 
BKP
->
RTCCR
;

207 
tmeg
 &
RTCCR_CAL_MASK
;

209 
tmeg
 |
CibtiVue
;

211 
BKP
->
RTCCR
 = 
tmeg
;

212 
	}
}

221 
	$BKP_WreBackupRegi
(
ut16_t
 
BKP_DR
, ut16_
Da
)

223 
__IO
 
ut32_t
 
tmp
 = 0;

226 
	`as_m
(
	`IS_BKP_DR
(
BKP_DR
));

228 
tmp
 = (
ut32_t
)
BKP_BASE
;

229 
tmp
 +
BKP_DR
;

231 *(
__IO
 
ut32_t
 *
tmp
 = 
Da
;

232 
	}
}

240 
ut16_t
 
	$BKP_RdBackupRegi
(
ut16_t
 
BKP_DR
)

242 
__IO
 
ut32_t
 
tmp
 = 0;

245 
	`as_m
(
	`IS_BKP_DR
(
BKP_DR
));

247 
tmp
 = (
ut32_t
)
BKP_BASE
;

248 
tmp
 +
BKP_DR
;

250  (*(
__IO
 
ut16_t
 *
tmp
);

251 
	}
}

258 
FgStus
 
	$BKP_GFgStus
()

260  (
FgStus
)(*(
__IO
 
ut32_t
 *
CSR_TEF_BB
);

261 
	}
}

268 
	$BKP_CˬFg
()

271 
BKP
->
CSR
 |
BKP_CSR_CTE
;

272 
	}
}

279 
ITStus
 
	$BKP_GITStus
()

281  (
ITStus
)(*(
__IO
 
ut32_t
 *
CSR_TIF_BB
);

282 
	}
}

289 
	$BKP_CˬITPdgB
()

292 
BKP
->
CSR
 |
BKP_CSR_CTI
;

293 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_can.c

22 
	~"m32f10x_n.h
"

23 
	~"m32f10x_rcc.h
"

48 
	#MCR_DBF
 ((
ut32_t
)0x00010000

	)

51 
	#TMIDxR_TXRQ
 ((
ut32_t
)0x00000001

	)

54 
	#FMR_FINIT
 ((
ut32_t
)0x00000001

	)

57 
	#INAK_TIMEOUT
 ((
ut32_t
)0x0000FFFF)

	)

59 
	#SLAK_TIMEOUT
 ((
ut32_t
)0x0000FFFF)

	)

64 
	#CAN_FLAGS_TSR
 ((
ut32_t
)0x08000000)

	)

66 
	#CAN_FLAGS_RF1R
 ((
ut32_t
)0x04000000)

	)

68 
	#CAN_FLAGS_RF0R
 ((
ut32_t
)0x02000000)

	)

70 
	#CAN_FLAGS_MSR
 ((
ut32_t
)0x01000000)

	)

72 
	#CAN_FLAGS_ESR
 ((
ut32_t
)0x00F00000)

	)

99 
ITStus
 
CheckITStus
(
ut32_t
 
CAN_Reg
, ut32_
It_B
);

114 
	$CAN_DeIn
(
CAN_TyDef
* 
CANx
)

117 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

119 i(
CANx
 =
CAN1
)

122 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_CAN1
, 
ENABLE
);

124 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_CAN1
, 
DISABLE
);

129 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_CAN2
, 
ENABLE
);

131 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_CAN2
, 
DISABLE
);

133 
	}
}

144 
ut8_t
 
	$CAN_In
(
CAN_TyDef
* 
CANx
, 
CAN_InTyDef
* 
CAN_InSu
)

146 
ut8_t
 
InStus
 = 
CANINITFAILED
;

147 
ut32_t
 
wa_ack
 = 0x00000000;

149 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

150 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
CAN_InSu
->
CAN_TTCM
));

151 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
CAN_InSu
->
CAN_ABOM
));

152 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
CAN_InSu
->
CAN_AWUM
));

153 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
CAN_InSu
->
CAN_NART
));

154 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
CAN_InSu
->
CAN_RFLM
));

155 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
CAN_InSu
->
CAN_TXFP
));

156 
	`as_m
(
	`IS_CAN_MODE
(
CAN_InSu
->
CAN_Mode
));

157 
	`as_m
(
	`IS_CAN_SJW
(
CAN_InSu
->
CAN_SJW
));

158 
	`as_m
(
	`IS_CAN_BS1
(
CAN_InSu
->
CAN_BS1
));

159 
	`as_m
(
	`IS_CAN_BS2
(
CAN_InSu
->
CAN_BS2
));

160 
	`as_m
(
	`IS_CAN_PRESCALER
(
CAN_InSu
->
CAN_Psr
));

163 
CANx
->
MCR
 &(~(
ut32_t
)
CAN_MCR_SLEEP
);

166 
CANx
->
MCR
 |
CAN_MCR_INRQ
 ;

169 ((
CANx
->
MSR
 & 
CAN_MSR_INAK
!CAN_MSR_INAK&& (
wa_ack
 !
INAK_TIMEOUT
))

171 
wa_ack
++;

175 i((
CANx
->
MSR
 & 
CAN_MSR_INAK
) != CAN_MSR_INAK)

177 
InStus
 = 
CANINITFAILED
;

182 i(
CAN_InSu
->
CAN_TTCM
 =
ENABLE
)

184 
CANx
->
MCR
 |
CAN_MCR_TTCM
;

188 
CANx
->
MCR
 &~(
ut32_t
)
CAN_MCR_TTCM
;

192 i(
CAN_InSu
->
CAN_ABOM
 =
ENABLE
)

194 
CANx
->
MCR
 |
CAN_MCR_ABOM
;

198 
CANx
->
MCR
 &~(
ut32_t
)
CAN_MCR_ABOM
;

202 i(
CAN_InSu
->
CAN_AWUM
 =
ENABLE
)

204 
CANx
->
MCR
 |
CAN_MCR_AWUM
;

208 
CANx
->
MCR
 &~(
ut32_t
)
CAN_MCR_AWUM
;

212 i(
CAN_InSu
->
CAN_NART
 =
ENABLE
)

214 
CANx
->
MCR
 |
CAN_MCR_NART
;

218 
CANx
->
MCR
 &~(
ut32_t
)
CAN_MCR_NART
;

222 i(
CAN_InSu
->
CAN_RFLM
 =
ENABLE
)

224 
CANx
->
MCR
 |
CAN_MCR_RFLM
;

228 
CANx
->
MCR
 &~(
ut32_t
)
CAN_MCR_RFLM
;

232 i(
CAN_InSu
->
CAN_TXFP
 =
ENABLE
)

234 
CANx
->
MCR
 |
CAN_MCR_TXFP
;

238 
CANx
->
MCR
 &~(
ut32_t
)
CAN_MCR_TXFP
;

242 
CANx
->
BTR
 = (
ut32_t
)((ut32_t)
CAN_InSu
->
CAN_Mode
 << 30| ((ut32_t)CAN_InSu->
CAN_SJW
 << 24) |

243 ((
ut32_t
)
CAN_InSu
->
CAN_BS1
 << 16| ((ut32_t)CAN_InSu->
CAN_BS2
 << 20) |

244 ((
ut32_t
)
CAN_InSu
->
CAN_Psr
 - 1);

247 
CANx
->
MCR
 &~(
ut32_t
)
CAN_MCR_INRQ
;

250 
wa_ack
 = 0x00;

252 ((
CANx
->
MSR
 & 
CAN_MSR_INAK
=CAN_MSR_INAK&& (
wa_ack
 !
INAK_TIMEOUT
))

254 
wa_ack
++;

258 i((
CANx
->
MSR
 & 
CAN_MSR_INAK
) == CAN_MSR_INAK)

260 
InStus
 = 
CANINITFAILED
;

264 
InStus
 = 
CANINITOK
 ;

269  
InStus
;

270 
	}
}

279 
	$CAN_FrIn
(
CAN_FrInTyDef
* 
CAN_FrInSu
)

281 
ut32_t
 
fr_numb_b_pos
 = 0;

283 
	`as_m
(
	`IS_CAN_FILTER_NUMBER
(
CAN_FrInSu
->
CAN_FrNumb
));

284 
	`as_m
(
	`IS_CAN_FILTER_MODE
(
CAN_FrInSu
->
CAN_FrMode
));

285 
	`as_m
(
	`IS_CAN_FILTER_SCALE
(
CAN_FrInSu
->
CAN_FrS
));

286 
	`as_m
(
	`IS_CAN_FILTER_FIFO
(
CAN_FrInSu
->
CAN_FrFIFOAssignmt
));

287 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
CAN_FrInSu
->
CAN_FrAivi
));

289 
fr_numb_b_pos
 = ((
ut32_t
)0x00000001<< 
CAN_FrInSu
->
CAN_FrNumb
;

292 
CAN1
->
FMR
 |
FMR_FINIT
;

295 
CAN1
->
FA1R
 &~(
ut32_t
)
fr_numb_b_pos
;

298 i(
CAN_FrInSu
->
CAN_FrS
 =
CAN_FrS_16b
)

301 
CAN1
->
FS1R
 &~(
ut32_t
)
fr_numb_b_pos
;

305 
CAN1
->
sFrRegi
[
CAN_FrInSu
->
CAN_FrNumb
].
FR1
 =

306 ((0x0000FFFF & (
ut32_t
)
CAN_FrInSu
->
CAN_FrMaskIdLow
) << 16) |

307 (0x0000FFFF & (
ut32_t
)
CAN_FrInSu
->
CAN_FrIdLow
);

311 
CAN1
->
sFrRegi
[
CAN_FrInSu
->
CAN_FrNumb
].
FR2
 =

312 ((0x0000FFFF & (
ut32_t
)
CAN_FrInSu
->
CAN_FrMaskIdHigh
) << 16) |

313 (0x0000FFFF & (
ut32_t
)
CAN_FrInSu
->
CAN_FrIdHigh
);

316 i(
CAN_FrInSu
->
CAN_FrS
 =
CAN_FrS_32b
)

319 
CAN1
->
FS1R
 |
fr_numb_b_pos
;

321 
CAN1
->
sFrRegi
[
CAN_FrInSu
->
CAN_FrNumb
].
FR1
 =

322 ((0x0000FFFF & (
ut32_t
)
CAN_FrInSu
->
CAN_FrIdHigh
) << 16) |

323 (0x0000FFFF & (
ut32_t
)
CAN_FrInSu
->
CAN_FrIdLow
);

325 
CAN1
->
sFrRegi
[
CAN_FrInSu
->
CAN_FrNumb
].
FR2
 =

326 ((0x0000FFFF & (
ut32_t
)
CAN_FrInSu
->
CAN_FrMaskIdHigh
) << 16) |

327 (0x0000FFFF & (
ut32_t
)
CAN_FrInSu
->
CAN_FrMaskIdLow
);

331 i(
CAN_FrInSu
->
CAN_FrMode
 =
CAN_FrMode_IdMask
)

334 
CAN1
->
FM1R
 &~(
ut32_t
)
fr_numb_b_pos
;

339 
CAN1
->
FM1R
 |(
ut32_t
)
fr_numb_b_pos
;

343 i(
CAN_FrInSu
->
CAN_FrFIFOAssignmt
 =
CAN_FrFIFO0
)

346 
CAN1
->
FFA1R
 &~(
ut32_t
)
fr_numb_b_pos
;

349 i(
CAN_FrInSu
->
CAN_FrFIFOAssignmt
 =
CAN_FrFIFO1
)

352 
CAN1
->
FFA1R
 |(
ut32_t
)
fr_numb_b_pos
;

356 i(
CAN_FrInSu
->
CAN_FrAivi
 =
ENABLE
)

358 
CAN1
->
FA1R
 |
fr_numb_b_pos
;

362 
CAN1
->
FMR
 &~
FMR_FINIT
;

363 
	}
}

371 
	$CAN_SuIn
(
CAN_InTyDef
* 
CAN_InSu
)

375 
CAN_InSu
->
CAN_TTCM
 = 
DISABLE
;

377 
CAN_InSu
->
CAN_ABOM
 = 
DISABLE
;

379 
CAN_InSu
->
CAN_AWUM
 = 
DISABLE
;

381 
CAN_InSu
->
CAN_NART
 = 
DISABLE
;

383 
CAN_InSu
->
CAN_RFLM
 = 
DISABLE
;

385 
CAN_InSu
->
CAN_TXFP
 = 
DISABLE
;

387 
CAN_InSu
->
CAN_Mode
 = 
CAN_Mode_Nm
;

389 
CAN_InSu
->
CAN_SJW
 = 
CAN_SJW_1tq
;

391 
CAN_InSu
->
CAN_BS1
 = 
CAN_BS1_4tq
;

393 
CAN_InSu
->
CAN_BS2
 = 
CAN_BS2_3tq
;

395 
CAN_InSu
->
CAN_Psr
 = 1;

396 
	}
}

404 
	$CAN_SveSBk
(
ut8_t
 
CAN_BkNumb
)

407 
	`as_m
(
	`IS_CAN_BANKNUMBER
(
CAN_BkNumb
));

409 
CAN1
->
FMR
 |
FMR_FINIT
;

411 
CAN1
->
FMR
 &(
ut32_t
)0xFFFFC0F1 ;

412 
CAN1
->
FMR
 |(
ut32_t
)(
CAN_BkNumb
)<<8;

414 
CAN1
->
FMR
 &~
FMR_FINIT
;

415 
	}
}

439 
	$CAN_ITCfig
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_IT
, 
FuniڮS
 
NewS
)

442 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

443 
	`as_m
(
	`IS_CAN_IT
(
CAN_IT
));

444 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

446 i(
NewS
 !
DISABLE
)

449 
CANx
->
IER
 |
CAN_IT
;

454 
CANx
->
IER
 &~
CAN_IT
;

456 
	}
}

466 
ut8_t
 
	$CAN_Tnsm
(
CAN_TyDef
* 
CANx
, 
CTxMsg
* 
TxMesge
)

468 
ut8_t
 
sm_mabox
 = 0;

470 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

471 
	`as_m
(
	`IS_CAN_IDTYPE
(
TxMesge
->
IDE
));

472 
	`as_m
(
	`IS_CAN_RTR
(
TxMesge
->
RTR
));

473 
	`as_m
(
	`IS_CAN_DLC
(
TxMesge
->
DLC
));

476 i((
CANx
->
TSR
&
CAN_TSR_TME0
) == CAN_TSR_TME0)

478 
sm_mabox
 = 0;

480 i((
CANx
->
TSR
&
CAN_TSR_TME1
) == CAN_TSR_TME1)

482 
sm_mabox
 = 1;

484 i((
CANx
->
TSR
&
CAN_TSR_TME2
) == CAN_TSR_TME2)

486 
sm_mabox
 = 2;

490 
sm_mabox
 = 
CAN_NO_MB
;

493 i(
sm_mabox
 !
CAN_NO_MB
)

496 
CANx
->
sTxMaBox
[
sm_mabox
].
TIR
 &
TMIDxR_TXRQ
;

497 i(
TxMesge
->
IDE
 =
CAN_ID_STD
)

499 
	`as_m
(
	`IS_CAN_STDID
(
TxMesge
->
StdId
));

500 
CANx
->
sTxMaBox
[
sm_mabox
].
TIR
 |((
TxMesge
->
StdId
 << 21| TxMesge->
RTR
);

504 
	`as_m
(
	`IS_CAN_EXTID
(
TxMesge
->
ExtId
));

505 
CANx
->
sTxMaBox
[
sm_mabox
].
TIR
 |((
TxMesge
->
ExtId
<<3| TxMesge->
IDE
 |

506 
TxMesge
->
RTR
);

511 
TxMesge
->
DLC
 &(
ut8_t
)0x0000000F;

512 
CANx
->
sTxMaBox
[
sm_mabox
].
TDTR
 &(
ut32_t
)0xFFFFFFF0;

513 
CANx
->
sTxMaBox
[
sm_mabox
].
TDTR
 |
TxMesge
->
DLC
;

516 
CANx
->
sTxMaBox
[
sm_mabox
].
TDLR
 = (((
ut32_t
)
TxMesge
->
Da
[3] << 24) |

517 ((
ut32_t
)
TxMesge
->
Da
[2] << 16) |

518 ((
ut32_t
)
TxMesge
->
Da
[1] << 8) |

519 ((
ut32_t
)
TxMesge
->
Da
[0]));

520 
CANx
->
sTxMaBox
[
sm_mabox
].
TDHR
 = (((
ut32_t
)
TxMesge
->
Da
[7] << 24) |

521 ((
ut32_t
)
TxMesge
->
Da
[6] << 16) |

522 ((
ut32_t
)
TxMesge
->
Da
[5] << 8) |

523 ((
ut32_t
)
TxMesge
->
Da
[4]));

525 
CANx
->
sTxMaBox
[
sm_mabox
].
TIR
 |
TMIDxR_TXRQ
;

527  
sm_mabox
;

528 
	}
}

536 
ut8_t
 
	$CAN_TnsmStus
(
CAN_TyDef
* 
CANx
, 
ut8_t
 
TnsmMabox
)

539 
ut8_t
 
e
 = 0;

541 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

542 
	`as_m
(
	`IS_CAN_TRANSMITMAILBOX
(
TnsmMabox
));

543 
TnsmMabox
)

545 (0): 
e
 |(
ut8_t
)((
CANx
->
TSR
 & 
CAN_TSR_RQCP0
) << 2);

546 
e
 |(
ut8_t
)((
CANx
->
TSR
 & 
CAN_TSR_TXOK0
) >> 0);

547 
e
 |(
ut8_t
)((
CANx
->
TSR
 & 
CAN_TSR_TME0
) >> 26);

549 (1): 
e
 |(
ut8_t
)((
CANx
->
TSR
 & 
CAN_TSR_RQCP1
) >> 6);

550 
e
 |(
ut8_t
)((
CANx
->
TSR
 & 
CAN_TSR_TXOK1
) >> 8);

551 
e
 |(
ut8_t
)((
CANx
->
TSR
 & 
CAN_TSR_TME1
) >> 27);

553 (2): 
e
 |(
ut8_t
)((
CANx
->
TSR
 & 
CAN_TSR_RQCP2
) >> 14);

554 
e
 |(
ut8_t
)((
CANx
->
TSR
 & 
CAN_TSR_TXOK2
) >> 16);

555 
e
 |(
ut8_t
)((
CANx
->
TSR
 & 
CAN_TSR_TME2
) >> 28);

558 
e
 = 
CANTXFAILED
;

561 
e
)

564 (0x0): 
e
 = 
CANTXPENDING
;

567 (0x5): 
e
 = 
CANTXFAILED
;

570 (0x7): 
e
 = 
CANTXOK
;

573 
e
 = 
CANTXFAILED
;

576  
e
;

577 
	}
}

585 
	$CAN_ClTnsm
(
CAN_TyDef
* 
CANx
, 
ut8_t
 
Mabox
)

588 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

589 
	`as_m
(
	`IS_CAN_TRANSMITMAILBOX
(
Mabox
));

591 
Mabox
)

593 (0): 
CANx
->
TSR
 |
CAN_TSR_ABRQ0
;

595 (1): 
CANx
->
TSR
 |
CAN_TSR_ABRQ1
;

597 (2): 
CANx
->
TSR
 |
CAN_TSR_ABRQ2
;

602 
	}
}

610 
	$CAN_FIFOR
(
CAN_TyDef
* 
CANx
, 
ut8_t
 
FIFONumb
)

613 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

614 
	`as_m
(
	`IS_CAN_FIFO
(
FIFONumb
));

616 i(
FIFONumb
 =
CAN_FIFO0
)

618 
CANx
->
RF0R
 |
CAN_RF0R_RFOM0
;

623 
CANx
->
RF1R
 |
CAN_RF1R_RFOM1
;

625 
	}
}

633 
ut8_t
 
	$CAN_MesgePdg
(
CAN_TyDef
* 
CANx
, 
ut8_t
 
FIFONumb
)

635 
ut8_t
 
mesge_ndg
=0;

637 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

638 
	`as_m
(
	`IS_CAN_FIFO
(
FIFONumb
));

639 i(
FIFONumb
 =
CAN_FIFO0
)

641 
mesge_ndg
 = (
ut8_t
)(
CANx
->
RF0R
&(
ut32_t
)0x03);

643 i(
FIFONumb
 =
CAN_FIFO1
)

645 
mesge_ndg
 = (
ut8_t
)(
CANx
->
RF1R
&(
ut32_t
)0x03);

649 
mesge_ndg
 = 0;

651  
mesge_ndg
;

652 
	}
}

662 
	$CAN_Reive
(
CAN_TyDef
* 
CANx
, 
ut8_t
 
FIFONumb
, 
CRxMsg
* 
RxMesge
)

665 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

666 
	`as_m
(
	`IS_CAN_FIFO
(
FIFONumb
));

668 
RxMesge
->
IDE
 = (
ut8_t
)0x04 & 
CANx
->
sFIFOMaBox
[
FIFONumb
].
RIR
;

669 i(
RxMesge
->
IDE
 =
CAN_ID_STD
)

671 
RxMesge
->
StdId
 = (
ut32_t
)0x000007FF & (
CANx
->
sFIFOMaBox
[
FIFONumb
].
RIR
 >> 21);

675 
RxMesge
->
ExtId
 = (
ut32_t
)0x1FFFFFFF & (
CANx
->
sFIFOMaBox
[
FIFONumb
].
RIR
 >> 3);

678 
RxMesge
->
RTR
 = (
ut8_t
)0x02 & 
CANx
->
sFIFOMaBox
[
FIFONumb
].
RIR
;

680 
RxMesge
->
DLC
 = (
ut8_t
)0x0F & 
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDTR
;

682 
RxMesge
->
FMI
 = (
ut8_t
)0xFF & (
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDTR
 >> 8);

684 
RxMesge
->
Da
[0] = (
ut8_t
)0xFF & 
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDLR
;

685 
RxMesge
->
Da
[1] = (
ut8_t
)0xFF & (
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDLR
 >> 8);

686 
RxMesge
->
Da
[2] = (
ut8_t
)0xFF & (
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDLR
 >> 16);

687 
RxMesge
->
Da
[3] = (
ut8_t
)0xFF & (
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDLR
 >> 24);

688 
RxMesge
->
Da
[4] = (
ut8_t
)0xFF & 
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDHR
;

689 
RxMesge
->
Da
[5] = (
ut8_t
)0xFF & (
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDHR
 >> 8);

690 
RxMesge
->
Da
[6] = (
ut8_t
)0xFF & (
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDHR
 >> 16);

691 
RxMesge
->
Da
[7] = (
ut8_t
)0xFF & (
CANx
->
sFIFOMaBox
[
FIFONumb
].
RDHR
 >> 24);

693 
	`CAN_FIFOR
(
CANx
, 
FIFONumb
);

694 
	}
}

703 
	$CAN_DBGFeze
(
CAN_TyDef
* 
CANx
, 
FuniڮS
 
NewS
)

706 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

707 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

709 i(
NewS
 !
DISABLE
)

712 
CANx
->
MCR
 |
MCR_DBF
;

717 
CANx
->
MCR
 &~
MCR_DBF
;

719 
	}
}

726 
ut8_t
 
	$CAN_S˕
(
CAN_TyDef
* 
CANx
)

728 
ut8_t
 
pus
 = 
CANSLEEPFAILED
;

731 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

734 
CANx
->
MCR
 = (((CANx->MCR& (
ut32_t
)(~(ut32_t)
CAN_MCR_INRQ
)| 
CAN_MCR_SLEEP
);

737 i((
CANx
->
MSR
 & (
CAN_MSR_SLAK
|
CAN_MSR_INAK
)) == CAN_MSR_SLAK)

740 
pus
 = 
CANSLEEPOK
;

743  (
ut8_t
)
pus
;

744 
	}
}

751 
ut8_t
 
	$CAN_WakeUp
(
CAN_TyDef
* 
CANx
)

753 
ut32_t
 
wa_ak
 = 
SLAK_TIMEOUT
;

754 
ut8_t
 
wakeupus
 = 
CANWAKEUPFAILED
;

757 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

760 
CANx
->
MCR
 &~(
ut32_t
)
CAN_MCR_SLEEP
;

763 ((
CANx
->
MSR
 & 
CAN_MSR_SLAK
=CAN_MSR_SLAK)&&(
wa_ak
!=0x00))

765 
wa_ak
--;

767 if((
CANx
->
MSR
 & 
CAN_MSR_SLAK
) != CAN_MSR_SLAK)

770 
wakeupus
 = 
CANWAKEUPOK
;

773  (
ut8_t
)
wakeupus
;

774 
	}
}

798 
FgStus
 
	$CAN_GFgStus
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_FLAG
)

800 
FgStus
 
bus
 = 
RESET
;

803 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

804 
	`as_m
(
	`IS_CAN_GET_FLAG
(
CAN_FLAG
));

807 if((
CAN_FLAG
 & 
CAN_FLAGS_ESR
!(
ut32_t
)
RESET
)

810 i((
CANx
->
ESR
 & (
CAN_FLAG
 & 0x000FFFFF)!(
ut32_t
)
RESET
)

813 
bus
 = 
SET
;

818 
bus
 = 
RESET
;

821 if((
CAN_FLAG
 & 
CAN_FLAGS_MSR
!(
ut32_t
)
RESET
)

824 i((
CANx
->
MSR
 & (
CAN_FLAG
 & 0x000FFFFF)!(
ut32_t
)
RESET
)

827 
bus
 = 
SET
;

832 
bus
 = 
RESET
;

835 if((
CAN_FLAG
 & 
CAN_FLAGS_TSR
!(
ut32_t
)
RESET
)

838 i((
CANx
->
TSR
 & (
CAN_FLAG
 & 0x000FFFFF)!(
ut32_t
)
RESET
)

841 
bus
 = 
SET
;

846 
bus
 = 
RESET
;

849 if((
CAN_FLAG
 & 
CAN_FLAGS_RF0R
!(
ut32_t
)
RESET
)

852 i((
CANx
->
RF0R
 & (
CAN_FLAG
 & 0x000FFFFF)!(
ut32_t
)
RESET
)

855 
bus
 = 
SET
;

860 
bus
 = 
RESET
;

866 i((
ut32_t
)(
CANx
->
RF1R
 & (
CAN_FLAG
 & 0x000FFFFF)!(ut32_t)
RESET
)

869 
bus
 = 
SET
;

874 
bus
 = 
RESET
;

878  
bus
;

879 
	}
}

898 
	$CAN_CˬFg
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_FLAG
)

900 
ut32_t
 
agtmp
=0;

902 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

903 
	`as_m
(
	`IS_CAN_CLEAR_FLAG
(
CAN_FLAG
));

905 i(
CAN_FLAG
 =
CAN_FLAG_LEC
)

908 
CANx
->
ESR
 = (
ut32_t
)
RESET
;

912 
agtmp
 = 
CAN_FLAG
 & 0x000FFFFF;

914 i((
CAN_FLAG
 & 
CAN_FLAGS_RF0R
)!=(
ut32_t
)
RESET
)

917 
CANx
->
RF0R
 = (
ut32_t
)(
agtmp
);

919 i((
CAN_FLAG
 & 
CAN_FLAGS_RF1R
)!=(
ut32_t
)
RESET
)

922 
CANx
->
RF1R
 = (
ut32_t
)(
agtmp
);

924 i((
CAN_FLAG
 & 
CAN_FLAGS_TSR
)!=(
ut32_t
)
RESET
)

927 
CANx
->
TSR
 = (
ut32_t
)(
agtmp
);

932 
CANx
->
MSR
 = (
ut32_t
)(
agtmp
);

935 
	}
}

958 
ITStus
 
	$CAN_GITStus
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_IT
)

960 
ITStus
 
us
 = 
RESET
;

962 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

963 
	`as_m
(
	`IS_CAN_IT
(
CAN_IT
));

966 if((
CANx
->
IER
 & 
CAN_IT
!
RESET
)

969 
CAN_IT
)

971 
CAN_IT_TME
:

973 
us
 = 
	`CheckITStus
(
CANx
->
TSR
, 
CAN_TSR_RQCP0
|
CAN_TSR_RQCP1
|
CAN_TSR_RQCP2
);

975 
CAN_IT_FMP0
:

977 
us
 = 
	`CheckITStus
(
CANx
->
RF0R
, 
CAN_RF0R_FMP0
);

979 
CAN_IT_FF0
:

981 
us
 = 
	`CheckITStus
(
CANx
->
RF0R
, 
CAN_RF0R_FULL0
);

983 
CAN_IT_FOV0
:

985 
us
 = 
	`CheckITStus
(
CANx
->
RF0R
, 
CAN_RF0R_FOVR0
);

987 
CAN_IT_FMP1
:

989 
us
 = 
	`CheckITStus
(
CANx
->
RF1R
, 
CAN_RF1R_FMP1
);

991 
CAN_IT_FF1
:

993 
us
 = 
	`CheckITStus
(
CANx
->
RF1R
, 
CAN_RF1R_FULL1
);

995 
CAN_IT_FOV1
:

997 
us
 = 
	`CheckITStus
(
CANx
->
RF1R
, 
CAN_RF1R_FOVR1
);

999 
CAN_IT_WKU
:

1001 
us
 = 
	`CheckITStus
(
CANx
->
MSR
, 
CAN_MSR_WKUI
);

1003 
CAN_IT_SLK
:

1005 
us
 = 
	`CheckITStus
(
CANx
->
MSR
, 
CAN_MSR_SLAKI
);

1007 
CAN_IT_EWG
:

1009 
us
 = 
	`CheckITStus
(
CANx
->
ESR
, 
CAN_ESR_EWGF
);

1011 
CAN_IT_EPV
:

1013 
us
 = 
	`CheckITStus
(
CANx
->
ESR
, 
CAN_ESR_EPVF
);

1015 
CAN_IT_BOF
:

1017 
us
 = 
	`CheckITStus
(
CANx
->
ESR
, 
CAN_ESR_BOFF
);

1019 
CAN_IT_LEC
:

1021 
us
 = 
	`CheckITStus
(
CANx
->
ESR
, 
CAN_ESR_LEC
);

1023 
CAN_IT_ERR
:

1025 
us
 = 
	`CheckITStus
(
CANx
->
ESR
, 
CAN_ESR_EWGF
|
CAN_ESR_EPVF
|
CAN_ESR_BOFF
|
CAN_ESR_LEC
);

1026 
us
 |
	`CheckITStus
(
CANx
->
MSR
, 
CAN_MSR_ERRI
);

1030 
us
 = 
RESET
;

1037 
us
 = 
RESET
;

1041  
us
;

1042 
	}
}

1062 
	$CAN_CˬITPdgB
(
CAN_TyDef
* 
CANx
, 
ut32_t
 
CAN_IT
)

1065 
	`as_m
(
	`IS_CAN_ALL_PERIPH
(
CANx
));

1066 
	`as_m
(
	`IS_CAN_CLEAR_IT
(
CAN_IT
));

1068 
CAN_IT
)

1070 
CAN_IT_TME
:

1072 
CANx
->
TSR
 = 
CAN_TSR_RQCP0
|
CAN_TSR_RQCP1
|
CAN_TSR_RQCP2
;

1074 
CAN_IT_FF0
:

1076 
CANx
->
RF0R
 = 
CAN_RF0R_FULL0
;

1078 
CAN_IT_FOV0
:

1080 
CANx
->
RF0R
 = 
CAN_RF0R_FOVR0
;

1082 
CAN_IT_FF1
:

1084 
CANx
->
RF1R
 = 
CAN_RF1R_FULL1
;

1086 
CAN_IT_FOV1
:

1088 
CANx
->
RF1R
 = 
CAN_RF1R_FOVR1
;

1090 
CAN_IT_WKU
:

1092 
CANx
->
MSR
 = 
CAN_MSR_WKUI
;

1094 
CAN_IT_SLK
:

1096 
CANx
->
MSR
 = 
CAN_MSR_SLAKI
;

1098 
CAN_IT_EWG
:

1100 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1103 
CAN_IT_EPV
:

1105 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1108 
CAN_IT_BOF
:

1110 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1113 
CAN_IT_LEC
:

1115 
CANx
->
ESR
 = 
RESET
;

1117 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1119 
CAN_IT_ERR
:

1121 
CANx
->
ESR
 = 
RESET
;

1123 
CANx
->
MSR
 = 
CAN_MSR_ERRI
;

1129 
	}
}

1137 
ITStus
 
	$CheckITStus
(
ut32_t
 
CAN_Reg
, ut32_
It_B
)

1139 
ITStus
 
ndgbus
 = 
RESET
;

1141 i((
CAN_Reg
 & 
It_B
!(
ut32_t
)
RESET
)

1144 
ndgbus
 = 
SET
;

1149 
ndgbus
 = 
RESET
;

1151  
ndgbus
;

1152 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_cec.c

22 
	~"m32f10x_c.h
"

23 
	~"m32f10x_rcc.h
"

48 
	#CEC_OFFSET
 (
CEC_BASE
 - 
PERIPH_BASE
)

	)

53 
	#CFGR_OFFSET
 (
CEC_OFFSET
 + 0x00)

	)

54 
	#PE_BNumb
 0x00

	)

55 
	#CFGR_PE_BB
 (
PERIPH_BB_BASE
 + (
CFGR_OFFSET
 * 32+ (
PE_BNumb
 * 4))

	)

58 
	#IE_BNumb
 0x01

	)

59 
	#CFGR_IE_BB
 (
PERIPH_BB_BASE
 + (
CFGR_OFFSET
 * 32+ (
IE_BNumb
 * 4))

	)

64 
	#CSR_OFFSET
 (
CEC_OFFSET
 + 0x10)

	)

65 
	#TSOM_BNumb
 0x00

	)

66 
	#CSR_TSOM_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32+ (
TSOM_BNumb
 * 4))

	)

69 
	#TEOM_BNumb
 0x01

	)

70 
	#CSR_TEOM_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32+ (
TEOM_BNumb
 * 4))

	)

72 
	#CFGR_CLEAR_Mask
 (
ut8_t
)(0xF3

	)

73 
	#FLAG_Mask
 ((
ut32_t
)0x00FFFFFF

	)

117 
	$CEC_DeIn
()

120 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_CEC
, 
ENABLE
);

122 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_CEC
, 
DISABLE
);

123 
	}
}

134 
	$CEC_In
(
CEC_InTyDef
* 
CEC_InSu
)

136 
ut16_t
 
tmeg
 = 0;

139 
	`as_m
(
	`IS_CEC_BIT_TIMING_ERROR_MODE
(
CEC_InSu
->
CEC_BTimgMode
));

140 
	`as_m
(
	`IS_CEC_BIT_PERIOD_ERROR_MODE
(
CEC_InSu
->
CEC_BPiodMode
));

144 
tmeg
 = 
CEC
->
CFGR
;

147 
tmeg
 &
CFGR_CLEAR_Mask
;

150 
tmeg
 |(
ut16_t
)(
CEC_InSu
->
CEC_BTimgMode
 | CEC_InSu->
CEC_BPiodMode
);

153 
CEC
->
CFGR
 = 
tmeg
;

155 
	}
}

163 
	$CEC_Cmd
(
FuniڮS
 
NewS
)

166 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

168 *(
__IO
 
ut32_t
 *
CFGR_PE_BB
 = (ut32_t)
NewS
;

170 if(
NewS
 =
DISABLE
)

173 (
CEC
->
CFGR
 & 
CEC_CFGR_PE
!(
ut32_t
)
RESET
)

177 
	}
}

185 
	$CEC_ITCfig
(
FuniڮS
 
NewS
)

188 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

190 *(
__IO
 
ut32_t
 *
CFGR_IE_BB
 = (ut32_t)
NewS
;

191 
	}
}

198 
	$CEC_OwnAddssCfig
(
ut8_t
 
CEC_OwnAddss
)

201 
	`as_m
(
	`IS_CEC_ADDRESS
(
CEC_OwnAddss
));

204 
CEC
->
OAR
 = 
CEC_OwnAddss
;

205 
	}
}

212 
	$CEC_SPsr
(
ut16_t
 
CEC_Psr
)

215 
	`as_m
(
	`IS_CEC_PRESCALER
(
CEC_Psr
));

218 
CEC
->
PRES
 = 
CEC_Psr
;

219 
	}
}

226 
	$CEC_SdDaBy
(
ut8_t
 
Da
)

229 
CEC
->
TXD
 = 
Da
 ;

230 
	}
}

238 
ut8_t
 
	$CEC_ReiveDaBy
()

241  (
ut8_t
)(
CEC
->
RXD
);

242 
	}
}

249 
	$CEC_SOfMesge
()

252 *(
__IO
 
ut32_t
 *
CSR_TSOM_BB
 = (uint32_t)0x1;

253 
	}
}

261 
	$CEC_EndOfMesgeCmd
(
FuniڮS
 
NewS
)

264 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

267 *(
__IO
 
ut32_t
 *
CSR_TEOM_BB
 = (ut32_t)
NewS
;

268 
	}
}

290 
FgStus
 
	$CEC_GFgStus
(
ut32_t
 
CEC_FLAG
)

292 
FgStus
 
bus
 = 
RESET
;

293 
ut32_t
 
eg
 = 0, 
cba
 = 0;

296 
	`as_m
(
	`IS_CEC_GET_FLAG
(
CEC_FLAG
));

299 
cba
 = (
ut32_t
)(
CEC_BASE
);

302 
eg
 = 
CEC_FLAG
 >> 28;

305 
CEC_FLAG
 &
FLAG_Mask
;

307 if(
eg
 != 0)

310 
CEC_FLAG
 = (
ut32_t
)(CEC_FLAG >> 16);

313 
cba
 += 0xC;

318 
cba
 += 0x10;

321 if(((*(
__IO
 
ut32_t
 *)
cba
& 
CEC_FLAG
!(ut32_t)
RESET
)

324 
bus
 = 
SET
;

329 
bus
 = 
RESET
;

333  
bus
;

334 
	}
}

348 
	$CEC_CˬFg
(
ut32_t
 
CEC_FLAG
)

350 
ut32_t
 
tmp
 = 0x0;

353 
	`as_m
(
	`IS_CEC_CLEAR_FLAG
(
CEC_FLAG
));

355 
tmp
 = 
CEC
->
CSR
 & 0x2;

358 
CEC
->
CSR
 &(
ut32_t
)(((~(ut32_t)
CEC_FLAG
& 0xFFFFFFFC| 
tmp
);

359 
	}
}

371 
ITStus
 
	$CEC_GITStus
(
ut8_t
 
CEC_IT
)

373 
ITStus
 
bus
 = 
RESET
;

374 
ut32_t
 
abˡus
 = 0;

377 
	`as_m
(
	`IS_CEC_GET_IT
(
CEC_IT
));

380 
abˡus
 = (
CEC
->
CFGR
 & (
ut8_t
)
CEC_CFGR_IE
) ;

383 i(((
CEC
->
CSR
 & 
CEC_IT
!(
ut32_t
)
RESET
&& 
abˡus
)

386 
bus
 = 
SET
;

391 
bus
 = 
RESET
;

394  
bus
;

395 
	}
}

407 
	$CEC_CˬITPdgB
(
ut16_t
 
CEC_IT
)

409 
ut32_t
 
tmp
 = 0x0;

412 
	`as_m
(
	`IS_CEC_GET_IT
(
CEC_IT
));

414 
tmp
 = 
CEC
->
CSR
 & 0x2;

417 
CEC
->
CSR
 &(
ut32_t
)(((~(ut32_t)
CEC_IT
& 0xFFFFFFFC| 
tmp
);

418 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_crc.c

22 
	~"m32f10x_c.h
"

82 
	$CRC_RetDR
()

85 
CRC
->
CR
 = 
CRC_CR_RESET
;

86 
	}
}

93 
ut32_t
 
	$CRC_CcCRC
(
ut32_t
 
Da
)

95 
CRC
->
DR
 = 
Da
;

97  (
CRC
->
DR
);

98 
	}
}

106 
ut32_t
 
	$CRC_CcBlockCRC
(
ut32_t
 
pBufr
[], ut32_
BufrLgth
)

108 
ut32_t
 
dex
 = 0;

110 
dex
 = 0; index < 
BufrLgth
; index++)

112 
CRC
->
DR
 = 
pBufr
[
dex
];

114  (
CRC
->
DR
);

115 
	}
}

122 
ut32_t
 
	$CRC_GCRC
()

124  (
CRC
->
DR
);

125 
	}
}

132 
	$CRC_SIDRegi
(
ut8_t
 
IDVue
)

134 
CRC
->
IDR
 = 
IDVue
;

135 
	}
}

142 
ut8_t
 
	$CRC_GIDRegi
()

144  (
CRC
->
IDR
);

145 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_dac.c

22 
	~"m32f10x_dac.h
"

23 
	~"m32f10x_rcc.h
"

47 
	#CR_CLEAR_MASK
 ((
ut32_t
)0x00000FFE)

	)

50 
	#DUAL_SWTRIG_SET
 ((
ut32_t
)0x00000003)

	)

51 
	#DUAL_SWTRIG_RESET
 ((
ut32_t
)0xFFFFFFFC)

	)

54 
	#DHR12R1_OFFSET
 ((
ut32_t
)0x00000008)

	)

55 
	#DHR12R2_OFFSET
 ((
ut32_t
)0x00000014)

	)

56 
	#DHR12RD_OFFSET
 ((
ut32_t
)0x00000020)

	)

59 
	#DOR_OFFSET
 ((
ut32_t
)0x0000002C)

	)

97 
	$DAC_DeIn
()

100 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_DAC
, 
ENABLE
);

102 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_DAC
, 
DISABLE
);

103 
	}
}

116 
	$DAC_In
(
ut32_t
 
DAC_Chl
, 
DAC_InTyDef
* 
DAC_InSu
)

118 
ut32_t
 
tmeg1
 = 0, 
tmeg2
 = 0;

120 
	`as_m
(
	`IS_DAC_TRIGGER
(
DAC_InSu
->
DAC_Trigg
));

121 
	`as_m
(
	`IS_DAC_GENERATE_WAVE
(
DAC_InSu
->
DAC_WaveGi
));

122 
	`as_m
(
	`IS_DAC_LFSR_UNMASK_TRIANGLE_AMPLITUDE
(
DAC_InSu
->
DAC_LFSRUnmask_TrngAmude
));

123 
	`as_m
(
	`IS_DAC_OUTPUT_BUFFER_STATE
(
DAC_InSu
->
DAC_OuutBufr
));

126 
tmeg1
 = 
DAC
->
CR
;

128 
tmeg1
 &~(
CR_CLEAR_MASK
 << 
DAC_Chl
);

135 
tmeg2
 = (
DAC_InSu
->
DAC_Trigg
 | DAC_InSu->
DAC_WaveGi
 |

136 
DAC_InSu
->
DAC_LFSRUnmask_TrngAmude
 | DAC_InSu->
DAC_OuutBufr
);

138 
tmeg1
 |
tmeg2
 << 
DAC_Chl
;

140 
DAC
->
CR
 = 
tmeg1
;

141 
	}
}

149 
	$DAC_SuIn
(
DAC_InTyDef
* 
DAC_InSu
)

153 
DAC_InSu
->
DAC_Trigg
 = 
DAC_Trigg_Ne
;

155 
DAC_InSu
->
DAC_WaveGi
 = 
DAC_WaveGi_Ne
;

157 
DAC_InSu
->
DAC_LFSRUnmask_TrngAmude
 = 
DAC_LFSRUnmask_B0
;

159 
DAC_InSu
->
DAC_OuutBufr
 = 
DAC_OuutBufr_Eb
;

160 
	}
}

172 
	$DAC_Cmd
(
ut32_t
 
DAC_Chl
, 
FuniڮS
 
NewS
)

175 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

176 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

177 i(
NewS
 !
DISABLE
)

180 
DAC
->
CR
 |(
DAC_CR_EN1
 << 
DAC_Chl
);

185 
DAC
->
CR
 &~(
DAC_CR_EN1
 << 
DAC_Chl
);

187 
	}
}

188 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

202 
	$DAC_ITCfig
(
ut32_t
 
DAC_Chl
, ut32_
DAC_IT
, 
FuniڮS
 
NewS
)

205 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

206 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

207 
	`as_m
(
	`IS_DAC_IT
(
DAC_IT
));

209 i(
NewS
 !
DISABLE
)

212 
DAC
->
CR
 |(
DAC_IT
 << 
DAC_Chl
);

217 
DAC
->
CR
 &(~(
ut32_t
)(
DAC_IT
 << 
DAC_Chl
));

219 
	}
}

232 
	$DAC_DMACmd
(
ut32_t
 
DAC_Chl
, 
FuniڮS
 
NewS
)

235 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

236 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

237 i(
NewS
 !
DISABLE
)

240 
DAC
->
CR
 |(
DAC_CR_DMAEN1
 << 
DAC_Chl
);

245 
DAC
->
CR
 &~(
DAC_CR_DMAEN1
 << 
DAC_Chl
);

247 
	}
}

259 
	$DAC_SoweTriggCmd
(
ut32_t
 
DAC_Chl
, 
FuniڮS
 
NewS
)

262 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

263 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

264 i(
NewS
 !
DISABLE
)

267 
DAC
->
SWTRIGR
 |(
ut32_t
)
DAC_SWTRIGR_SWTRIG1
 << (
DAC_Chl
 >> 4);

272 
DAC
->
SWTRIGR
 &~((
ut32_t
)
DAC_SWTRIGR_SWTRIG1
 << (
DAC_Chl
 >> 4));

274 
	}
}

283 
	$DAC_DuSoweTriggCmd
(
FuniڮS
 
NewS
)

286 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

287 i(
NewS
 !
DISABLE
)

290 
DAC
->
SWTRIGR
 |
DUAL_SWTRIG_SET
 ;

295 
DAC
->
SWTRIGR
 &
DUAL_SWTRIG_RESET
;

297 
	}
}

313 
	$DAC_WaveGiCmd
(
ut32_t
 
DAC_Chl
, ut32_
DAC_Wave
, 
FuniڮS
 
NewS
)

316 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

317 
	`as_m
(
	`IS_DAC_WAVE
(
DAC_Wave
));

318 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

319 i(
NewS
 !
DISABLE
)

322 
DAC
->
CR
 |
DAC_Wave
 << 
DAC_Chl
;

327 
DAC
->
CR
 &~(
DAC_Wave
 << 
DAC_Chl
);

329 
	}
}

341 
	$DAC_SChl1Da
(
ut32_t
 
DAC_Align
, 
ut16_t
 
Da
)

343 
__IO
 
ut32_t
 
tmp
 = 0;

346 
	`as_m
(
	`IS_DAC_ALIGN
(
DAC_Align
));

347 
	`as_m
(
	`IS_DAC_DATA
(
Da
));

349 
tmp
 = (
ut32_t
)
DAC_BASE
;

350 
tmp
 +
DHR12R1_OFFSET
 + 
DAC_Align
;

353 *(
__IO
 
ut32_t
 *
tmp
 = 
Da
;

354 
	}
}

366 
	$DAC_SChl2Da
(
ut32_t
 
DAC_Align
, 
ut16_t
 
Da
)

368 
__IO
 
ut32_t
 
tmp
 = 0;

371 
	`as_m
(
	`IS_DAC_ALIGN
(
DAC_Align
));

372 
	`as_m
(
	`IS_DAC_DATA
(
Da
));

374 
tmp
 = (
ut32_t
)
DAC_BASE
;

375 
tmp
 +
DHR12R2_OFFSET
 + 
DAC_Align
;

378 *(
__IO
 
ut32_t
 *)
tmp
 = 
Da
;

379 
	}
}

395 
	$DAC_SDuChlDa
(
ut32_t
 
DAC_Align
, 
ut16_t
 
Da2
, ut16_
Da1
)

397 
ut32_t
 
da
 = 0, 
tmp
 = 0;

400 
	`as_m
(
	`IS_DAC_ALIGN
(
DAC_Align
));

401 
	`as_m
(
	`IS_DAC_DATA
(
Da1
));

402 
	`as_m
(
	`IS_DAC_DATA
(
Da2
));

405 i(
DAC_Align
 =
DAC_Align_8b_R
)

407 
da
 = ((
ut32_t
)
Da2
 << 8| 
Da1
;

411 
da
 = ((
ut32_t
)
Da2
 << 16| 
Da1
;

414 
tmp
 = (
ut32_t
)
DAC_BASE
;

415 
tmp
 +
DHR12RD_OFFSET
 + 
DAC_Align
;

418 *(
__IO
 
ut32_t
 *)
tmp
 = 
da
;

419 
	}
}

429 
ut16_t
 
	$DAC_GDaOuutVue
(
ut32_t
 
DAC_Chl
)

431 
__IO
 
ut32_t
 
tmp
 = 0;

434 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

436 
tmp
 = (
ut32_t

DAC_BASE
 ;

437 
tmp
 +
DOR_OFFSET
 + ((
ut32_t
)
DAC_Chl
 >> 2);

440  (
ut16_t
(*(
__IO
 
ut32_t
*
tmp
);

441 
	}
}

443 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

455 
FgStus
 
	$DAC_GFgStus
(
ut32_t
 
DAC_Chl
, ut32_
DAC_FLAG
)

457 
FgStus
 
bus
 = 
RESET
;

459 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

460 
	`as_m
(
	`IS_DAC_FLAG
(
DAC_FLAG
));

463 i((
DAC
->
SR
 & (
DAC_FLAG
 << 
DAC_Chl
)!(
ut8_t
)
RESET
)

466 
bus
 = 
SET
;

471 
bus
 = 
RESET
;

474  
bus
;

475 
	}
}

488 
	$DAC_CˬFg
(
ut32_t
 
DAC_Chl
, ut32_
DAC_FLAG
)

491 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

492 
	`as_m
(
	`IS_DAC_FLAG
(
DAC_FLAG
));

495 
DAC
->
SR
 = (
DAC_FLAG
 << 
DAC_Chl
);

496 
	}
}

509 
ITStus
 
	$DAC_GITStus
(
ut32_t
 
DAC_Chl
, ut32_
DAC_IT
)

511 
ITStus
 
bus
 = 
RESET
;

512 
ut32_t
 
abˡus
 = 0;

515 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

516 
	`as_m
(
	`IS_DAC_IT
(
DAC_IT
));

519 
abˡus
 = (
DAC
->
CR
 & (
DAC_IT
 << 
DAC_Chl
)) ;

522 i(((
DAC
->
SR
 & (
DAC_IT
 << 
DAC_Chl
)!(
ut32_t
)
RESET
&& 
abˡus
)

525 
bus
 = 
SET
;

530 
bus
 = 
RESET
;

533  
bus
;

534 
	}
}

547 
	$DAC_CˬITPdgB
(
ut32_t
 
DAC_Chl
, ut32_
DAC_IT
)

550 
	`as_m
(
	`IS_DAC_CHANNEL
(
DAC_Chl
));

551 
	`as_m
(
	`IS_DAC_IT
(
DAC_IT
));

554 
DAC
->
SR
 = (
DAC_IT
 << 
DAC_Chl
);

555 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_dbgmcu.c

22 
	~"m32f10x_dbgmcu.h
"

45 
	#IDCODE_DEVID_MASK
 ((
ut32_t
)0x00000FFF)

	)

83 
ut32_t
 
	$DBGMCU_GREVID
()

85 (
DBGMCU
->
IDCODE
 >> 16);

86 
	}
}

93 
ut32_t
 
	$DBGMCU_GDEVID
()

95 (
DBGMCU
->
IDCODE
 & 
IDCODE_DEVID_MASK
);

96 
	}
}

133 
	$DBGMCU_Cfig
(
ut32_t
 
DBGMCU_Ph
, 
FuniڮS
 
NewS
)

136 
	`as_m
(
	`IS_DBGMCU_PERIPH
(
DBGMCU_Ph
));

137 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

139 i(
NewS
 !
DISABLE
)

141 
DBGMCU
->
CR
 |
DBGMCU_Ph
;

145 
DBGMCU
->
CR
 &~
DBGMCU_Ph
;

147 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_dma.c

22 
	~"m32f10x_dma.h
"

23 
	~"m32f10x_rcc.h
"

47 
	#DMA1_Chl1_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF1
 | 
DMA_ISR_TCIF1
 | 
DMA_ISR_HTIF1
 | 
DMA_ISR_TEIF1
))

	)

48 
	#DMA1_Chl2_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF2
 | 
DMA_ISR_TCIF2
 | 
DMA_ISR_HTIF2
 | 
DMA_ISR_TEIF2
))

	)

49 
	#DMA1_Chl3_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF3
 | 
DMA_ISR_TCIF3
 | 
DMA_ISR_HTIF3
 | 
DMA_ISR_TEIF3
))

	)

50 
	#DMA1_Chl4_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF4
 | 
DMA_ISR_TCIF4
 | 
DMA_ISR_HTIF4
 | 
DMA_ISR_TEIF4
))

	)

51 
	#DMA1_Chl5_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF5
 | 
DMA_ISR_TCIF5
 | 
DMA_ISR_HTIF5
 | 
DMA_ISR_TEIF5
))

	)

52 
	#DMA1_Chl6_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF6
 | 
DMA_ISR_TCIF6
 | 
DMA_ISR_HTIF6
 | 
DMA_ISR_TEIF6
))

	)

53 
	#DMA1_Chl7_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF7
 | 
DMA_ISR_TCIF7
 | 
DMA_ISR_HTIF7
 | 
DMA_ISR_TEIF7
))

	)

56 
	#DMA2_Chl1_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF1
 | 
DMA_ISR_TCIF1
 | 
DMA_ISR_HTIF1
 | 
DMA_ISR_TEIF1
))

	)

57 
	#DMA2_Chl2_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF2
 | 
DMA_ISR_TCIF2
 | 
DMA_ISR_HTIF2
 | 
DMA_ISR_TEIF2
))

	)

58 
	#DMA2_Chl3_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF3
 | 
DMA_ISR_TCIF3
 | 
DMA_ISR_HTIF3
 | 
DMA_ISR_TEIF3
))

	)

59 
	#DMA2_Chl4_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF4
 | 
DMA_ISR_TCIF4
 | 
DMA_ISR_HTIF4
 | 
DMA_ISR_TEIF4
))

	)

60 
	#DMA2_Chl5_IT_Mask
 ((
ut32_t
)(
DMA_ISR_GIF5
 | 
DMA_ISR_TCIF5
 | 
DMA_ISR_HTIF5
 | 
DMA_ISR_TEIF5
))

	)

63 
	#FLAG_Mask
 ((
ut32_t
)0x10000000)

	)

66 
	#CCR_CLEAR_Mask
 ((
ut32_t
)0xFFFF800F)

	)

107 
	$DMA_DeIn
(
DMA_Chl_TyDef
* 
DMAy_Chlx
)

110 
	`as_m
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Chlx
));

113 
DMAy_Chlx
->
CCR
 &(
ut16_t
)(~
DMA_CCR1_EN
);

116 
DMAy_Chlx
->
CCR
 = 0;

119 
DMAy_Chlx
->
CNDTR
 = 0;

122 
DMAy_Chlx
->
CPAR
 = 0;

125 
DMAy_Chlx
->
CMAR
 = 0;

127 i(
DMAy_Chlx
 =
DMA1_Chl1
)

130 
DMA1
->
IFCR
 |
DMA1_Chl1_IT_Mask
;

132 i(
DMAy_Chlx
 =
DMA1_Chl2
)

135 
DMA1
->
IFCR
 |
DMA1_Chl2_IT_Mask
;

137 i(
DMAy_Chlx
 =
DMA1_Chl3
)

140 
DMA1
->
IFCR
 |
DMA1_Chl3_IT_Mask
;

142 i(
DMAy_Chlx
 =
DMA1_Chl4
)

145 
DMA1
->
IFCR
 |
DMA1_Chl4_IT_Mask
;

147 i(
DMAy_Chlx
 =
DMA1_Chl5
)

150 
DMA1
->
IFCR
 |
DMA1_Chl5_IT_Mask
;

152 i(
DMAy_Chlx
 =
DMA1_Chl6
)

155 
DMA1
->
IFCR
 |
DMA1_Chl6_IT_Mask
;

157 i(
DMAy_Chlx
 =
DMA1_Chl7
)

160 
DMA1
->
IFCR
 |
DMA1_Chl7_IT_Mask
;

162 i(
DMAy_Chlx
 =
DMA2_Chl1
)

165 
DMA2
->
IFCR
 |
DMA2_Chl1_IT_Mask
;

167 i(
DMAy_Chlx
 =
DMA2_Chl2
)

170 
DMA2
->
IFCR
 |
DMA2_Chl2_IT_Mask
;

172 i(
DMAy_Chlx
 =
DMA2_Chl3
)

175 
DMA2
->
IFCR
 |
DMA2_Chl3_IT_Mask
;

177 i(
DMAy_Chlx
 =
DMA2_Chl4
)

180 
DMA2
->
IFCR
 |
DMA2_Chl4_IT_Mask
;

184 i(
DMAy_Chlx
 =
DMA2_Chl5
)

187 
DMA2
->
IFCR
 |
DMA2_Chl5_IT_Mask
;

190 
	}
}

201 
	$DMA_In
(
DMA_Chl_TyDef
* 
DMAy_Chlx
, 
DMA_InTyDef
* 
DMA_InSu
)

203 
ut32_t
 
tmeg
 = 0;

206 
	`as_m
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Chlx
));

207 
	`as_m
(
	`IS_DMA_DIR
(
DMA_InSu
->
DMA_DIR
));

208 
	`as_m
(
	`IS_DMA_BUFFER_SIZE
(
DMA_InSu
->
DMA_BufrSize
));

209 
	`as_m
(
	`IS_DMA_PERIPHERAL_INC_STATE
(
DMA_InSu
->
DMA_PhInc
));

210 
	`as_m
(
	`IS_DMA_MEMORY_INC_STATE
(
DMA_InSu
->
DMA_MemyInc
));

211 
	`as_m
(
	`IS_DMA_PERIPHERAL_DATA_SIZE
(
DMA_InSu
->
DMA_PhDaSize
));

212 
	`as_m
(
	`IS_DMA_MEMORY_DATA_SIZE
(
DMA_InSu
->
DMA_MemyDaSize
));

213 
	`as_m
(
	`IS_DMA_MODE
(
DMA_InSu
->
DMA_Mode
));

214 
	`as_m
(
	`IS_DMA_PRIORITY
(
DMA_InSu
->
DMA_Priܙy
));

215 
	`as_m
(
	`IS_DMA_M2M_STATE
(
DMA_InSu
->
DMA_M2M
));

219 
tmeg
 = 
DMAy_Chlx
->
CCR
;

221 
tmeg
 &
CCR_CLEAR_Mask
;

231 
tmeg
 |
DMA_InSu
->
DMA_DIR
 | DMA_InSu->
DMA_Mode
 |

232 
DMA_InSu
->
DMA_PhInc
 | DMA_InSu->
DMA_MemyInc
 |

233 
DMA_InSu
->
DMA_PhDaSize
 | DMA_InSu->
DMA_MemyDaSize
 |

234 
DMA_InSu
->
DMA_Priܙy
 | DMA_InSu->
DMA_M2M
;

237 
DMAy_Chlx
->
CCR
 = 
tmeg
;

241 
DMAy_Chlx
->
CNDTR
 = 
DMA_InSu
->
DMA_BufrSize
;

245 
DMAy_Chlx
->
CPAR
 = 
DMA_InSu
->
DMA_PhBaAddr
;

249 
DMAy_Chlx
->
CMAR
 = 
DMA_InSu
->
DMA_MemyBaAddr
;

250 
	}
}

258 
	$DMA_SuIn
(
DMA_InTyDef
* 
DMA_InSu
)

262 
DMA_InSu
->
DMA_PhBaAddr
 = 0;

264 
DMA_InSu
->
DMA_MemyBaAddr
 = 0;

266 
DMA_InSu
->
DMA_DIR
 = 
DMA_DIR_PhSRC
;

268 
DMA_InSu
->
DMA_BufrSize
 = 0;

270 
DMA_InSu
->
DMA_PhInc
 = 
DMA_PhInc_Dib
;

272 
DMA_InSu
->
DMA_MemyInc
 = 
DMA_MemyInc_Dib
;

274 
DMA_InSu
->
DMA_PhDaSize
 = 
DMA_PhDaSize_By
;

276 
DMA_InSu
->
DMA_MemyDaSize
 = 
DMA_MemyDaSize_By
;

278 
DMA_InSu
->
DMA_Mode
 = 
DMA_Mode_Nm
;

280 
DMA_InSu
->
DMA_Priܙy
 = 
DMA_Priܙy_Low
;

282 
DMA_InSu
->
DMA_M2M
 = 
DMA_M2M_Dib
;

283 
	}
}

293 
	$DMA_Cmd
(
DMA_Chl_TyDef
* 
DMAy_Chlx
, 
FuniڮS
 
NewS
)

296 
	`as_m
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Chlx
));

297 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

299 i(
NewS
 !
DISABLE
)

302 
DMAy_Chlx
->
CCR
 |
DMA_CCR1_EN
;

307 
DMAy_Chlx
->
CCR
 &(
ut16_t
)(~
DMA_CCR1_EN
);

309 
	}
}

325 
	$DMA_ITCfig
(
DMA_Chl_TyDef
* 
DMAy_Chlx
, 
ut32_t
 
DMA_IT
, 
FuniڮS
 
NewS
)

328 
	`as_m
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Chlx
));

329 
	`as_m
(
	`IS_DMA_CONFIG_IT
(
DMA_IT
));

330 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

331 i(
NewS
 !
DISABLE
)

334 
DMAy_Chlx
->
CCR
 |
DMA_IT
;

339 
DMAy_Chlx
->
CCR
 &~
DMA_IT
;

341 
	}
}

352 
	$DMA_SCuDaCou
(
DMA_Chl_TyDef
* 
DMAy_Chlx
, 
ut16_t
 
DaNumb
)

355 
	`as_m
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Chlx
));

359 
DMAy_Chlx
->
CNDTR
 = 
DaNumb
;

360 
	}
}

370 
ut16_t
 
	$DMA_GCuDaCou
(
DMA_Chl_TyDef
* 
DMAy_Chlx
)

373 
	`as_m
(
	`IS_DMA_ALL_PERIPH
(
DMAy_Chlx
));

375  ((
ut16_t
)(
DMAy_Chlx
->
CNDTR
));

376 
	}
}

432 
FgStus
 
	$DMA_GFgStus
(
ut32_t
 
DMA_FLAG
)

434 
FgStus
 
bus
 = 
RESET
;

435 
ut32_t
 
tmeg
 = 0;

437 
	`as_m
(
	`IS_DMA_GET_FLAG
(
DMA_FLAG
));

440 i((
DMA_FLAG
 & 
FLAG_Mask
!(
ut32_t
)
RESET
)

443 
tmeg
 = 
DMA2
->
ISR
 ;

448 
tmeg
 = 
DMA1
->
ISR
 ;

452 i((
tmeg
 & 
DMA_FLAG
!(
ut32_t
)
RESET
)

455 
bus
 = 
SET
;

460 
bus
 = 
RESET
;

464  
bus
;

465 
	}
}

521 
	$DMA_CˬFg
(
ut32_t
 
DMA_FLAG
)

524 
	`as_m
(
	`IS_DMA_CLEAR_FLAG
(
DMA_FLAG
));

527 i((
DMA_FLAG
 & 
FLAG_Mask
!(
ut32_t
)
RESET
)

530 
DMA2
->
IFCR
 = 
DMA_FLAG
;

535 
DMA1
->
IFCR
 = 
DMA_FLAG
;

537 
	}
}

593 
ITStus
 
	$DMA_GITStus
(
ut32_t
 
DMA_IT
)

595 
ITStus
 
bus
 = 
RESET
;

596 
ut32_t
 
tmeg
 = 0;

598 
	`as_m
(
	`IS_DMA_GET_IT
(
DMA_IT
));

601 i((
DMA_IT
 & 
FLAG_Mask
!(
ut32_t
)
RESET
)

604 
tmeg
 = 
DMA2
->
ISR
 ;

609 
tmeg
 = 
DMA1
->
ISR
 ;

613 i((
tmeg
 & 
DMA_IT
!(
ut32_t
)
RESET
)

616 
bus
 = 
SET
;

621 
bus
 = 
RESET
;

624  
bus
;

625 
	}
}

681 
	$DMA_CˬITPdgB
(
ut32_t
 
DMA_IT
)

684 
	`as_m
(
	`IS_DMA_CLEAR_IT
(
DMA_IT
));

687 i((
DMA_IT
 & 
FLAG_Mask
!(
ut32_t
)
RESET
)

690 
DMA2
->
IFCR
 = 
DMA_IT
;

695 
DMA1
->
IFCR
 = 
DMA_IT
;

697 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_exti.c

22 
	~"m32f10x_exti.h
"

45 
	#EXTI_LINENONE
 ((
ut32_t
)0x00000

	)

84 
	$EXTI_DeIn
()

86 
EXTI
->
IMR
 = 0x00000000;

87 
EXTI
->
EMR
 = 0x00000000;

88 
EXTI
->
RTSR
 = 0x00000000;

89 
EXTI
->
FTSR
 = 0x00000000;

90 
EXTI
->
PR
 = 0x000FFFFF;

91 
	}
}

100 
	$EXTI_In
(
EXTI_InTyDef
* 
EXTI_InSu
)

102 
ut32_t
 
tmp
 = 0;

105 
	`as_m
(
	`IS_EXTI_MODE
(
EXTI_InSu
->
EXTI_Mode
));

106 
	`as_m
(
	`IS_EXTI_TRIGGER
(
EXTI_InSu
->
EXTI_Trigg
));

107 
	`as_m
(
	`IS_EXTI_LINE
(
EXTI_InSu
->
EXTI_Le
));

108 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
EXTI_InSu
->
EXTI_LeCmd
));

110 
tmp
 = (
ut32_t
)
EXTI_BASE
;

112 i(
EXTI_InSu
->
EXTI_LeCmd
 !
DISABLE
)

115 
EXTI
->
IMR
 &~
EXTI_InSu
->
EXTI_Le
;

116 
EXTI
->
EMR
 &~
EXTI_InSu
->
EXTI_Le
;

118 
tmp
 +
EXTI_InSu
->
EXTI_Mode
;

120 *(
__IO
 
ut32_t
 *
tmp
 |
EXTI_InSu
->
EXTI_Le
;

123 
EXTI
->
RTSR
 &~
EXTI_InSu
->
EXTI_Le
;

124 
EXTI
->
FTSR
 &~
EXTI_InSu
->
EXTI_Le
;

127 i(
EXTI_InSu
->
EXTI_Trigg
 =
EXTI_Trigg_Risg_Flg
)

130 
EXTI
->
RTSR
 |
EXTI_InSu
->
EXTI_Le
;

131 
EXTI
->
FTSR
 |
EXTI_InSu
->
EXTI_Le
;

135 
tmp
 = (
ut32_t
)
EXTI_BASE
;

136 
tmp
 +
EXTI_InSu
->
EXTI_Trigg
;

138 *(
__IO
 
ut32_t
 *
tmp
 |
EXTI_InSu
->
EXTI_Le
;

143 
tmp
 +
EXTI_InSu
->
EXTI_Mode
;

146 *(
__IO
 
ut32_t
 *
tmp
 &~
EXTI_InSu
->
EXTI_Le
;

148 
	}
}

156 
	$EXTI_SuIn
(
EXTI_InTyDef
* 
EXTI_InSu
)

158 
EXTI_InSu
->
EXTI_Le
 = 
EXTI_LINENONE
;

159 
EXTI_InSu
->
EXTI_Mode
 = 
EXTI_Mode_Iru
;

160 
EXTI_InSu
->
EXTI_Trigg
 = 
EXTI_Trigg_Flg
;

161 
EXTI_InSu
->
EXTI_LeCmd
 = 
DISABLE
;

162 
	}
}

170 
	$EXTI_GeSWIru
(
ut32_t
 
EXTI_Le
)

173 
	`as_m
(
	`IS_EXTI_LINE
(
EXTI_Le
));

175 
EXTI
->
SWIER
 |
EXTI_Le
;

176 
	}
}

185 
FgStus
 
	$EXTI_GFgStus
(
ut32_t
 
EXTI_Le
)

187 
FgStus
 
bus
 = 
RESET
;

189 
	`as_m
(
	`IS_GET_EXTI_LINE
(
EXTI_Le
));

191 i((
EXTI
->
PR
 & 
EXTI_Le
!(
ut32_t
)
RESET
)

193 
bus
 = 
SET
;

197 
bus
 = 
RESET
;

199  
bus
;

200 
	}
}

208 
	$EXTI_CˬFg
(
ut32_t
 
EXTI_Le
)

211 
	`as_m
(
	`IS_EXTI_LINE
(
EXTI_Le
));

213 
EXTI
->
PR
 = 
EXTI_Le
;

214 
	}
}

223 
ITStus
 
	$EXTI_GITStus
(
ut32_t
 
EXTI_Le
)

225 
ITStus
 
bus
 = 
RESET
;

226 
ut32_t
 
abˡus
 = 0;

228 
	`as_m
(
	`IS_GET_EXTI_LINE
(
EXTI_Le
));

230 
abˡus
 = 
EXTI
->
IMR
 & 
EXTI_Le
;

231 i(((
EXTI
->
PR
 & 
EXTI_Le
!(
ut32_t
)
RESET
&& (
abˡus
 != (uint32_t)RESET))

233 
bus
 = 
SET
;

237 
bus
 = 
RESET
;

239  
bus
;

240 
	}
}

248 
	$EXTI_CˬITPdgB
(
ut32_t
 
EXTI_Le
)

251 
	`as_m
(
	`IS_EXTI_LINE
(
EXTI_Le
));

253 
EXTI
->
PR
 = 
EXTI_Le
;

254 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_flash.c

22 
	~"m32f10x_ash.h
"

46 
	#ACR_LATENCY_Mask
 ((
ut32_t
)0x00000038)

	)

47 
	#ACR_HLFCYA_Mask
 ((
ut32_t
)0xFFFFFFF7)

	)

48 
	#ACR_PRFTBE_Mask
 ((
ut32_t
)0xFFFFFFEF)

	)

51 
	#ACR_PRFTBS_Mask
 ((
ut32_t
)0x00000020)

	)

54 
	#CR_PG_S
 ((
ut32_t
)0x00000001)

	)

55 
	#CR_PG_Ret
 ((
ut32_t
)0x00001FFE)

	)

56 
	#CR_PER_S
 ((
ut32_t
)0x00000002)

	)

57 
	#CR_PER_Ret
 ((
ut32_t
)0x00001FFD)

	)

58 
	#CR_MER_S
 ((
ut32_t
)0x00000004)

	)

59 
	#CR_MER_Ret
 ((
ut32_t
)0x00001FFB)

	)

60 
	#CR_OPTPG_S
 ((
ut32_t
)0x00000010)

	)

61 
	#CR_OPTPG_Ret
 ((
ut32_t
)0x00001FEF)

	)

62 
	#CR_OPTER_S
 ((
ut32_t
)0x00000020)

	)

63 
	#CR_OPTER_Ret
 ((
ut32_t
)0x00001FDF)

	)

64 
	#CR_STRT_S
 ((
ut32_t
)0x00000040)

	)

65 
	#CR_LOCK_S
 ((
ut32_t
)0x00000080)

	)

68 
	#RDPRT_Mask
 ((
ut32_t
)0x00000002)

	)

69 
	#WRP0_Mask
 ((
ut32_t
)0x000000FF)

	)

70 
	#WRP1_Mask
 ((
ut32_t
)0x0000FF00)

	)

71 
	#WRP2_Mask
 ((
ut32_t
)0x00FF0000)

	)

72 
	#WRP3_Mask
 ((
ut32_t
)0xFF000000)

	)

73 
	#OB_USER_BFB2
 ((
ut16_t
)0x0008)

	)

76 
	#RDP_Key
 ((
ut16_t
)0x00A5)

	)

77 
	#FLASH_KEY1
 ((
ut32_t
)0x45670123)

	)

78 
	#FLASH_KEY2
 ((
ut32_t
)0xCDEF89AB)

	)

81 
	#FLASH_BANK1_END_ADDRESS
 ((
ut32_t
)0x807FFFF)

	)

84 
	#ETimeout
 ((
ut32_t
)0x000B0000)

	)

85 
	#ProgmTimeout
 ((
ut32_t
)0x00002000)

	)

253 
	$FLASH_SLcy
(
ut32_t
 
FLASH_Lcy
)

255 
ut32_t
 
tmeg
 = 0;

258 
	`as_m
(
	`IS_FLASH_LATENCY
(
FLASH_Lcy
));

261 
tmeg
 = 
FLASH
->
ACR
;

264 
tmeg
 &
ACR_LATENCY_Mask
;

265 
tmeg
 |
FLASH_Lcy
;

268 
FLASH
->
ACR
 = 
tmeg
;

269 
	}
}

280 
	$FLASH_HfCyeAcssCmd
(
ut32_t
 
FLASH_HfCyeAcss
)

283 
	`as_m
(
	`IS_FLASH_HALFCYCLEACCESS_STATE
(
FLASH_HfCyeAcss
));

286 
FLASH
->
ACR
 &
ACR_HLFCYA_Mask
;

287 
FLASH
->
ACR
 |
FLASH_HfCyeAcss
;

288 
	}
}

299 
	$FLASH_PtchBufrCmd
(
ut32_t
 
FLASH_PtchBufr
)

302 
	`as_m
(
	`IS_FLASH_PREFETCHBUFFER_STATE
(
FLASH_PtchBufr
));

305 
FLASH
->
ACR
 &
ACR_PRFTBE_Mask
;

306 
FLASH
->
ACR
 |
FLASH_PtchBufr
;

307 
	}
}

318 
	$FLASH_Uock
()

321 
FLASH
->
KEYR
 = 
FLASH_KEY1
;

322 
FLASH
->
KEYR
 = 
FLASH_KEY2
;

324 #ifde
STM32F10X_XL


326 
FLASH
->
KEYR2
 = 
FLASH_KEY1
;

327 
FLASH
->
KEYR2
 = 
FLASH_KEY2
;

329 
	}
}

339 
	$FLASH_UockBk1
()

342 
FLASH
->
KEYR
 = 
FLASH_KEY1
;

343 
FLASH
->
KEYR
 = 
FLASH_KEY2
;

344 
	}
}

346 #ifde
STM32F10X_XL


353 
	$FLASH_UockBk2
()

356 
FLASH
->
KEYR2
 = 
FLASH_KEY1
;

357 
FLASH
->
KEYR2
 = 
FLASH_KEY2
;

359 
	}
}

371 
	$FLASH_Lock
()

374 
FLASH
->
CR
 |
CR_LOCK_S
;

376 #ifde
STM32F10X_XL


378 
FLASH
->
CR2
 |
CR_LOCK_S
;

380 
	}
}

391 
	$FLASH_LockBk1
()

394 
FLASH
->
CR
 |
CR_LOCK_S
;

395 
	}
}

397 #ifde
STM32F10X_XL


404 
	$FLASH_LockBk2
()

407 
FLASH
->
CR2
 |
CR_LOCK_S
;

408 
	}
}

418 
FLASH_Stus
 
	$FLASH_EPage
(
ut32_t
 
Page_Addss
)

420 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

422 
	`as_m
(
	`IS_FLASH_ADDRESS
(
Page_Addss
));

424 #ifde
STM32F10X_XL


425 if(
Page_Addss
 < 
FLASH_BANK1_END_ADDRESS
)

428 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ETimeout
);

429 if(
us
 =
FLASH_COMPLETE
)

432 
FLASH
->
CR
|
CR_PER_S
;

433 
FLASH
->
AR
 = 
Page_Addss
;

434 
FLASH
->
CR
|
CR_STRT_S
;

437 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ETimeout
);

440 
FLASH
->
CR
 &
CR_PER_Ret
;

446 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ETimeout
);

447 if(
us
 =
FLASH_COMPLETE
)

450 
FLASH
->
CR2
|
CR_PER_S
;

451 
FLASH
->
AR2
 = 
Page_Addss
;

452 
FLASH
->
CR2
|
CR_STRT_S
;

455 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ETimeout
);

458 
FLASH
->
CR2
 &
CR_PER_Ret
;

463 
us
 = 
	`FLASH_WaFLaOti
(
ETimeout
);

465 if(
us
 =
FLASH_COMPLETE
)

468 
FLASH
->
CR
|
CR_PER_S
;

469 
FLASH
->
AR
 = 
Page_Addss
;

470 
FLASH
->
CR
|
CR_STRT_S
;

473 
us
 = 
	`FLASH_WaFLaOti
(
ETimeout
);

476 
FLASH
->
CR
 &
CR_PER_Ret
;

481  
us
;

482 
	}
}

491 
FLASH_Stus
 
	$FLASH_EAPages
()

493 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

495 #ifde
STM32F10X_XL


497 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ETimeout
);

499 if(
us
 =
FLASH_COMPLETE
)

502 
FLASH
->
CR
 |
CR_MER_S
;

503 
FLASH
->
CR
 |
CR_STRT_S
;

506 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ETimeout
);

509 
FLASH
->
CR
 &
CR_MER_Ret
;

511 if(
us
 =
FLASH_COMPLETE
)

514 
FLASH
->
CR2
 |
CR_MER_S
;

515 
FLASH
->
CR2
 |
CR_STRT_S
;

518 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ETimeout
);

521 
FLASH
->
CR2
 &
CR_MER_Ret
;

525 
us
 = 
	`FLASH_WaFLaOti
(
ETimeout
);

526 if(
us
 =
FLASH_COMPLETE
)

529 
FLASH
->
CR
 |
CR_MER_S
;

530 
FLASH
->
CR
 |
CR_STRT_S
;

533 
us
 = 
	`FLASH_WaFLaOti
(
ETimeout
);

536 
FLASH
->
CR
 &
CR_MER_Ret
;

541  
us
;

542 
	}
}

554 
FLASH_Stus
 
	$FLASH_EABk1Pages
()

556 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

558 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ETimeout
);

560 if(
us
 =
FLASH_COMPLETE
)

563 
FLASH
->
CR
 |
CR_MER_S
;

564 
FLASH
->
CR
 |
CR_STRT_S
;

567 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ETimeout
);

570 
FLASH
->
CR
 &
CR_MER_Ret
;

573  
us
;

574 
	}
}

576 #ifde
STM32F10X_XL


584 
FLASH_Stus
 
	$FLASH_EABk2Pages
()

586 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

588 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ETimeout
);

590 if(
us
 =
FLASH_COMPLETE
)

593 
FLASH
->
CR2
 |
CR_MER_S
;

594 
FLASH
->
CR2
 |
CR_STRT_S
;

597 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ETimeout
);

600 
FLASH
->
CR2
 &
CR_MER_Ret
;

603  
us
;

604 
	}
}

615 
FLASH_Stus
 
	$FLASH_EOiBys
()

617 
ut16_t
 
rdmp
 = 
RDP_Key
;

619 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

622 if(
	`FLASH_GRdOutPreiStus
(!
RESET
)

624 
rdmp
 = 0x00;

628 
us
 = 
	`FLASH_WaFLaOti
(
ETimeout
);

629 if(
us
 =
FLASH_COMPLETE
)

632 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

633 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

636 
FLASH
->
CR
 |
CR_OPTER_S
;

637 
FLASH
->
CR
 |
CR_STRT_S
;

639 
us
 = 
	`FLASH_WaFLaOti
(
ETimeout
);

641 if(
us
 =
FLASH_COMPLETE
)

644 
FLASH
->
CR
 &
CR_OPTER_Ret
;

647 
FLASH
->
CR
 |
CR_OPTPG_S
;

649 
OB
->
RDP
 = (
ut16_t
)
rdmp
;

651 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

653 if(
us
 !
FLASH_TIMEOUT
)

656 
FLASH
->
CR
 &
CR_OPTPG_Ret
;

661 i(
us
 !
FLASH_TIMEOUT
)

664 
FLASH
->
CR
 &
CR_OPTPG_Ret
;

669  
us
;

670 
	}
}

680 
FLASH_Stus
 
	$FLASH_ProgmWd
(
ut32_t
 
Addss
, ut32_
Da
)

682 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

683 
__IO
 
ut32_t
 
tmp
 = 0;

686 
	`as_m
(
	`IS_FLASH_ADDRESS
(
Addss
));

688 #ifde
STM32F10X_XL


689 if(
Addss
 < 
FLASH_BANK1_END_ADDRESS
 - 2)

692 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ProgmTimeout
);

693 if(
us
 =
FLASH_COMPLETE
)

697 
FLASH
->
CR
 |
CR_PG_S
;

699 *(
__IO
 
ut16_t
*)
Addss
 = (ut16_t)
Da
;

701 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

703 if(
us
 =
FLASH_COMPLETE
)

707 
tmp
 = 
Addss
 + 2;

709 *(
__IO
 
ut16_t
*
tmp
 = 
Da
 >> 16;

712 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

715 
FLASH
->
CR
 &
CR_PG_Ret
;

720 
FLASH
->
CR
 &
CR_PG_Ret
;

724 if(
Addss
 =(
FLASH_BANK1_END_ADDRESS
 - 1))

727 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ProgmTimeout
);

729 if(
us
 =
FLASH_COMPLETE
)

733 
FLASH
->
CR
 |
CR_PG_S
;

735 *(
__IO
 
ut16_t
*)
Addss
 = (ut16_t)
Da
;

738 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ProgmTimeout
);

741 
FLASH
->
CR
 &
CR_PG_Ret
;

746 
FLASH
->
CR
 &
CR_PG_Ret
;

750 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ProgmTimeout
);

752 if(
us
 =
FLASH_COMPLETE
)

756 
FLASH
->
CR2
 |
CR_PG_S
;

757 
tmp
 = 
Addss
 + 2;

759 *(
__IO
 
ut16_t
*
tmp
 = 
Da
 >> 16;

762 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ProgmTimeout
);

765 
FLASH
->
CR2
 &
CR_PG_Ret
;

770 
FLASH
->
CR2
 &
CR_PG_Ret
;

776 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ProgmTimeout
);

778 if(
us
 =
FLASH_COMPLETE
)

782 
FLASH
->
CR2
 |
CR_PG_S
;

784 *(
__IO
 
ut16_t
*)
Addss
 = (ut16_t)
Da
;

786 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ProgmTimeout
);

788 if(
us
 =
FLASH_COMPLETE
)

792 
tmp
 = 
Addss
 + 2;

794 *(
__IO
 
ut16_t
*
tmp
 = 
Da
 >> 16;

797 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ProgmTimeout
);

800 
FLASH
->
CR2
 &
CR_PG_Ret
;

805 
FLASH
->
CR2
 &
CR_PG_Ret
;

811 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

813 if(
us
 =
FLASH_COMPLETE
)

817 
FLASH
->
CR
 |
CR_PG_S
;

819 *(
__IO
 
ut16_t
*)
Addss
 = (ut16_t)
Da
;

821 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

823 if(
us
 =
FLASH_COMPLETE
)

827 
tmp
 = 
Addss
 + 2;

829 *(
__IO
 
ut16_t
*
tmp
 = 
Da
 >> 16;

832 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

835 
FLASH
->
CR
 &
CR_PG_Ret
;

840 
FLASH
->
CR
 &
CR_PG_Ret
;

846  
us
;

847 
	}
}

857 
FLASH_Stus
 
	$FLASH_ProgmHfWd
(
ut32_t
 
Addss
, 
ut16_t
 
Da
)

859 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

861 
	`as_m
(
	`IS_FLASH_ADDRESS
(
Addss
));

863 #ifde
STM32F10X_XL


865 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

867 if(
Addss
 < 
FLASH_BANK1_END_ADDRESS
)

869 if(
us
 =
FLASH_COMPLETE
)

872 
FLASH
->
CR
 |
CR_PG_S
;

874 *(
__IO
 
ut16_t
*)
Addss
 = 
Da
;

876 
us
 = 
	`FLASH_WaFLaBk1Oti
(
ProgmTimeout
);

879 
FLASH
->
CR
 &
CR_PG_Ret
;

884 if(
us
 =
FLASH_COMPLETE
)

887 
FLASH
->
CR2
 |
CR_PG_S
;

889 *(
__IO
 
ut16_t
*)
Addss
 = 
Da
;

891 
us
 = 
	`FLASH_WaFLaBk2Oti
(
ProgmTimeout
);

894 
FLASH
->
CR2
 &
CR_PG_Ret
;

899 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

901 if(
us
 =
FLASH_COMPLETE
)

904 
FLASH
->
CR
 |
CR_PG_S
;

906 *(
__IO
 
ut16_t
*)
Addss
 = 
Da
;

908 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

911 
FLASH
->
CR
 &
CR_PG_Ret
;

916  
us
;

917 
	}
}

928 
FLASH_Stus
 
	$FLASH_ProgmOiByDa
(
ut32_t
 
Addss
, 
ut8_t
 
Da
)

930 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

932 
	`as_m
(
	`IS_OB_DATA_ADDRESS
(
Addss
));

933 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

935 if(
us
 =
FLASH_COMPLETE
)

938 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

939 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

941 
FLASH
->
CR
 |
CR_OPTPG_S
;

942 *(
__IO
 
ut16_t
*)
Addss
 = 
Da
;

945 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

946 if(
us
 !
FLASH_TIMEOUT
)

949 
FLASH
->
CR
 &
CR_OPTPG_Ret
;

953  
us
;

954 
	}
}

974 
FLASH_Stus
 
	$FLASH_EbWrePrei
(
ut32_t
 
FLASH_Pages
)

976 
ut16_t
 
WRP0_Da
 = 0xFFFF, 
WRP1_Da
 = 0xFFFF, 
WRP2_Da
 = 0xFFFF, 
WRP3_Da
 = 0xFFFF;

978 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

981 
	`as_m
(
	`IS_FLASH_WRPROT_PAGE
(
FLASH_Pages
));

983 
FLASH_Pages
 = (
ut32_t
)(~FLASH_Pages);

984 
WRP0_Da
 = (
ut16_t
)(
FLASH_Pages
 & 
WRP0_Mask
);

985 
WRP1_Da
 = (
ut16_t
)((
FLASH_Pages
 & 
WRP1_Mask
) >> 8);

986 
WRP2_Da
 = (
ut16_t
)((
FLASH_Pages
 & 
WRP2_Mask
) >> 16);

987 
WRP3_Da
 = (
ut16_t
)((
FLASH_Pages
 & 
WRP3_Mask
) >> 24);

990 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

992 if(
us
 =
FLASH_COMPLETE
)

995 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

996 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

997 
FLASH
->
CR
 |
CR_OPTPG_S
;

998 if(
WRP0_Da
 != 0xFF)

1000 
OB
->
WRP0
 = 
WRP0_Da
;

1003 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

1005 if((
us
 =
FLASH_COMPLETE
&& (
WRP1_Da
 != 0xFF))

1007 
OB
->
WRP1
 = 
WRP1_Da
;

1010 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

1012 if((
us
 =
FLASH_COMPLETE
&& (
WRP2_Da
 != 0xFF))

1014 
OB
->
WRP2
 = 
WRP2_Da
;

1017 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

1020 if((
us
 =
FLASH_COMPLETE
)&& (
WRP3_Da
 != 0xFF))

1022 
OB
->
WRP3
 = 
WRP3_Da
;

1025 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

1028 if(
us
 !
FLASH_TIMEOUT
)

1031 
FLASH
->
CR
 &
CR_OPTPG_Ret
;

1035  
us
;

1036 
	}
}

1048 
FLASH_Stus
 
	$FLASH_RdOutPrei
(
FuniڮS
 
NewS
)

1050 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

1052 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1053 
us
 = 
	`FLASH_WaFLaOti
(
ETimeout
);

1054 if(
us
 =
FLASH_COMPLETE
)

1057 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

1058 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

1059 
FLASH
->
CR
 |
CR_OPTER_S
;

1060 
FLASH
->
CR
 |
CR_STRT_S
;

1062 
us
 = 
	`FLASH_WaFLaOti
(
ETimeout
);

1063 if(
us
 =
FLASH_COMPLETE
)

1066 
FLASH
->
CR
 &
CR_OPTER_Ret
;

1068 
FLASH
->
CR
 |
CR_OPTPG_S
;

1069 if(
NewS
 !
DISABLE
)

1071 
OB
->
RDP
 = 0x00;

1075 
OB
->
RDP
 = 
RDP_Key
;

1078 
us
 = 
	`FLASH_WaFLaOti
(
ETimeout
);

1080 if(
us
 !
FLASH_TIMEOUT
)

1083 
FLASH
->
CR
 &
CR_OPTPG_Ret
;

1088 if(
us
 !
FLASH_TIMEOUT
)

1091 
FLASH
->
CR
 &
CR_OPTER_Ret
;

1096  
us
;

1097 
	}
}

1117 
FLASH_Stus
 
	$FLASH_UrOiByCfig
(
ut16_t
 
OB_IWDG
, ut16_
OB_STOP
, ut16_
OB_STDBY
)

1119 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

1122 
	`as_m
(
	`IS_OB_IWDG_SOURCE
(
OB_IWDG
));

1123 
	`as_m
(
	`IS_OB_STOP_SOURCE
(
OB_STOP
));

1124 
	`as_m
(
	`IS_OB_STDBY_SOURCE
(
OB_STDBY
));

1127 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

1128 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

1131 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

1133 if(
us
 =
FLASH_COMPLETE
)

1136 
FLASH
->
CR
 |
CR_OPTPG_S
;

1138 
OB
->
USER
 = 
OB_IWDG
 | (
ut16_t
)(
OB_STOP
 | (ut16_t)(
OB_STDBY
 | ((uint16_t)0xF8)));

1141 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

1142 if(
us
 !
FLASH_TIMEOUT
)

1145 
FLASH
->
CR
 &
CR_OPTPG_Ret
;

1149  
us
;

1150 
	}
}

1152 #ifde
STM32F10X_XL


1171 
FLASH_Stus
 
	$FLASH_BoCfig
(
ut16_t
 
FLASH_BOOT
)

1173 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

1174 
	`as_m
(
	`IS_FLASH_BOOT
(
FLASH_BOOT
));

1176 
FLASH
->
OPTKEYR
 = 
FLASH_KEY1
;

1177 
FLASH
->
OPTKEYR
 = 
FLASH_KEY2
;

1180 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

1182 if(
us
 =
FLASH_COMPLETE
)

1185 
FLASH
->
CR
 |
CR_OPTPG_S
;

1187 if(
FLASH_BOOT
 =
FLASH_BOOT_Bk1
)

1189 
OB
->
USER
 |
OB_USER_BFB2
;

1193 
OB
->
USER
 &(
ut16_t
)(~(ut16_t)(
OB_USER_BFB2
));

1196 
us
 = 
	`FLASH_WaFLaOti
(
ProgmTimeout
);

1197 if(
us
 !
FLASH_TIMEOUT
)

1200 
FLASH
->
CR
 &
CR_OPTPG_Ret
;

1204  
us
;

1205 
	}
}

1215 
ut32_t
 
	$FLASH_GUrOiBy
()

1218  (
ut32_t
)(
FLASH
->
OBR
 >> 2);

1219 
	}
}

1227 
ut32_t
 
	$FLASH_GWrePreiOiBy
()

1230  (
ut32_t
)(
FLASH
->
WRPR
);

1231 
	}
}

1239 
FgStus
 
	$FLASH_GRdOutPreiStus
()

1241 
FgStus
 
adoutus
 = 
RESET
;

1242 i((
FLASH
->
OBR
 & 
RDPRT_Mask
!(
ut32_t
)
RESET
)

1244 
adoutus
 = 
SET
;

1248 
adoutus
 = 
RESET
;

1250  
adoutus
;

1251 
	}
}

1259 
FgStus
 
	$FLASH_GPtchBufrStus
()

1261 
FgStus
 
bus
 = 
RESET
;

1263 i((
FLASH
->
ACR
 & 
ACR_PRFTBS_Mask
!(
ut32_t
)
RESET
)

1265 
bus
 = 
SET
;

1269 
bus
 = 
RESET
;

1272  
bus
;

1273 
	}
}

1289 
	$FLASH_ITCfig
(
ut32_t
 
FLASH_IT
, 
FuniڮS
 
NewS
)

1291 #ifde
STM32F10X_XL


1293 
	`as_m
(
	`IS_FLASH_IT
(
FLASH_IT
));

1294 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1296 if((
FLASH_IT
 & 0x80000000) != 0x0)

1298 if(
NewS
 !
DISABLE
)

1301 
FLASH
->
CR2
 |(
FLASH_IT
 & 0x7FFFFFFF);

1306 
FLASH
->
CR2
 &~(
ut32_t
)(
FLASH_IT
 & 0x7FFFFFFF);

1311 if(
NewS
 !
DISABLE
)

1314 
FLASH
->
CR
 |
FLASH_IT
;

1319 
FLASH
->
CR
 &~(
ut32_t
)
FLASH_IT
;

1324 
	`as_m
(
	`IS_FLASH_IT
(
FLASH_IT
));

1325 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1327 if(
NewS
 !
DISABLE
)

1330 
FLASH
->
CR
 |
FLASH_IT
;

1335 
FLASH
->
CR
 &~(
ut32_t
)
FLASH_IT
;

1338 
	}
}

1356 
FgStus
 
	$FLASH_GFgStus
(
ut32_t
 
FLASH_FLAG
)

1358 
FgStus
 
bus
 = 
RESET
;

1360 #ifde
STM32F10X_XL


1362 
	`as_m
(
	`IS_FLASH_GET_FLAG
(
FLASH_FLAG
)) ;

1363 if(
FLASH_FLAG
 =
FLASH_FLAG_OPTERR
)

1365 if((
FLASH
->
OBR
 & 
FLASH_FLAG_OPTERR
!(
ut32_t
)
RESET
)

1367 
bus
 = 
SET
;

1371 
bus
 = 
RESET
;

1376 if((
FLASH_FLAG
 & 0x80000000) != 0x0)

1378 if((
FLASH
->
SR2
 & 
FLASH_FLAG
!(
ut32_t
)
RESET
)

1380 
bus
 = 
SET
;

1384 
bus
 = 
RESET
;

1389 if((
FLASH
->
SR
 & 
FLASH_FLAG
!(
ut32_t
)
RESET
)

1391 
bus
 = 
SET
;

1395 
bus
 = 
RESET
;

1401 
	`as_m
(
	`IS_FLASH_GET_FLAG
(
FLASH_FLAG
)) ;

1402 if(
FLASH_FLAG
 =
FLASH_FLAG_OPTERR
)

1404 if((
FLASH
->
OBR
 & 
FLASH_FLAG_OPTERR
!(
ut32_t
)
RESET
)

1406 
bus
 = 
SET
;

1410 
bus
 = 
RESET
;

1415 if((
FLASH
->
SR
 & 
FLASH_FLAG
!(
ut32_t
)
RESET
)

1417 
bus
 = 
SET
;

1421 
bus
 = 
RESET
;

1427  
bus
;

1428 
	}
}

1442 
	$FLASH_CˬFg
(
ut32_t
 
FLASH_FLAG
)

1444 #ifde
STM32F10X_XL


1446 
	`as_m
(
	`IS_FLASH_CLEAR_FLAG
(
FLASH_FLAG
)) ;

1448 if((
FLASH_FLAG
 & 0x80000000) != 0x0)

1451 
FLASH
->
SR2
 = 
FLASH_FLAG
;

1456 
FLASH
->
SR
 = 
FLASH_FLAG
;

1461 
	`as_m
(
	`IS_FLASH_CLEAR_FLAG
(
FLASH_FLAG
)) ;

1464 
FLASH
->
SR
 = 
FLASH_FLAG
;

1466 
	}
}

1476 
FLASH_Stus
 
	$FLASH_GStus
()

1478 
FLASH_Stus
 
ashus
 = 
FLASH_COMPLETE
;

1480 if((
FLASH
->
SR
 & 
FLASH_FLAG_BSY
) == FLASH_FLAG_BSY)

1482 
ashus
 = 
FLASH_BUSY
;

1486 if((
FLASH
->
SR
 & 
FLASH_FLAG_PGERR
) != 0)

1488 
ashus
 = 
FLASH_ERROR_PG
;

1492 if((
FLASH
->
SR
 & 
FLASH_FLAG_WRPRTERR
) != 0 )

1494 
ashus
 = 
FLASH_ERROR_WRP
;

1498 
ashus
 = 
FLASH_COMPLETE
;

1503  
ashus
;

1504 
	}
}

1514 
FLASH_Stus
 
	$FLASH_GBk1Stus
()

1516 
FLASH_Stus
 
ashus
 = 
FLASH_COMPLETE
;

1518 if((
FLASH
->
SR
 & 
FLASH_FLAG_BANK1_BSY
=
FLASH_FLAG_BSY
)

1520 
ashus
 = 
FLASH_BUSY
;

1524 if((
FLASH
->
SR
 & 
FLASH_FLAG_BANK1_PGERR
) != 0)

1526 
ashus
 = 
FLASH_ERROR_PG
;

1530 if((
FLASH
->
SR
 & 
FLASH_FLAG_BANK1_WRPRTERR
) != 0 )

1532 
ashus
 = 
FLASH_ERROR_WRP
;

1536 
ashus
 = 
FLASH_COMPLETE
;

1541  
ashus
;

1542 
	}
}

1544 #ifde
STM32F10X_XL


1552 
FLASH_Stus
 
	$FLASH_GBk2Stus
()

1554 
FLASH_Stus
 
ashus
 = 
FLASH_COMPLETE
;

1556 if((
FLASH
->
SR2
 & (
FLASH_FLAG_BANK2_BSY
 & 0x7FFFFFFF)) == (FLASH_FLAG_BANK2_BSY & 0x7FFFFFFF))

1558 
ashus
 = 
FLASH_BUSY
;

1562 if((
FLASH
->
SR2
 & (
FLASH_FLAG_BANK2_PGERR
 & 0x7FFFFFFF)) != 0)

1564 
ashus
 = 
FLASH_ERROR_PG
;

1568 if((
FLASH
->
SR2
 & (
FLASH_FLAG_BANK2_WRPRTERR
 & 0x7FFFFFFF)) != 0 )

1570 
ashus
 = 
FLASH_ERROR_WRP
;

1574 
ashus
 = 
FLASH_COMPLETE
;

1579  
ashus
;

1580 
	}
}

1594 
FLASH_Stus
 
	$FLASH_WaFLaOti
(
ut32_t
 
Timeout
)

1596 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

1599 
us
 = 
	`FLASH_GBk1Stus
();

1601 (
us
 =
FLASH_BUSY
&& (
Timeout
 != 0x00))

1603 
us
 = 
	`FLASH_GBk1Stus
();

1604 
Timeout
--;

1606 if(
Timeout
 == 0x00 )

1608 
us
 = 
FLASH_TIMEOUT
;

1611  
us
;

1612 
	}
}

1622 
FLASH_Stus
 
	$FLASH_WaFLaBk1Oti
(
ut32_t
 
Timeout
)

1624 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

1627 
us
 = 
	`FLASH_GBk1Stus
();

1629 (
us
 =
FLASH_FLAG_BANK1_BSY
&& (
Timeout
 != 0x00))

1631 
us
 = 
	`FLASH_GBk1Stus
();

1632 
Timeout
--;

1634 if(
Timeout
 == 0x00 )

1636 
us
 = 
FLASH_TIMEOUT
;

1639  
us
;

1640 
	}
}

1642 #ifde
STM32F10X_XL


1650 
FLASH_Stus
 
	$FLASH_WaFLaBk2Oti
(
ut32_t
 
Timeout
)

1652 
FLASH_Stus
 
us
 = 
FLASH_COMPLETE
;

1655 
us
 = 
	`FLASH_GBk2Stus
();

1657 (
us
 =(
FLASH_FLAG_BANK2_BSY
 & 0x7FFFFFFF)&& (
Timeout
 != 0x00))

1659 
us
 = 
	`FLASH_GBk2Stus
();

1660 
Timeout
--;

1662 if(
Timeout
 == 0x00 )

1664 
us
 = 
FLASH_TIMEOUT
;

1667  
us
;

1668 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_fsmc.c

22 
	~"m32f10x_fsmc.h
"

23 
	~"m32f10x_rcc.h
"

48 
	#BCR_MBKEN_S
 ((
ut32_t
)0x00000001)

	)

49 
	#BCR_MBKEN_Ret
 ((
ut32_t
)0x000FFFFE)

	)

50 
	#BCR_FACCEN_S
 ((
ut32_t
)0x00000040)

	)

53 
	#PCR_PBKEN_S
 ((
ut32_t
)0x00000004)

	)

54 
	#PCR_PBKEN_Ret
 ((
ut32_t
)0x000FFFFB)

	)

55 
	#PCR_ECCEN_S
 ((
ut32_t
)0x00000040)

	)

56 
	#PCR_ECCEN_Ret
 ((
ut32_t
)0x000FFFBF)

	)

57 
	#PCR_MemyTy_NAND
 ((
ut32_t
)0x00000008)

	)

101 
	$FSMC_NORSRAMDeIn
(
ut32_t
 
FSMC_Bk
)

104 
	`as_m
(
	`IS_FSMC_NORSRAM_BANK
(
FSMC_Bk
));

107 if(
FSMC_Bk
 =
FSMC_Bk1_NORSRAM1
)

109 
FSMC_Bk1
->
BTCR
[
FSMC_Bk
] = 0x000030DB;

114 
FSMC_Bk1
->
BTCR
[
FSMC_Bk
] = 0x000030D2;

116 
FSMC_Bk1
->
BTCR
[
FSMC_Bk
 + 1] = 0x0FFFFFFF;

117 
FSMC_Bk1E
->
BWTR
[
FSMC_Bk
] = 0x0FFFFFFF;

118 
	}
}

128 
	$FSMC_NANDDeIn
(
ut32_t
 
FSMC_Bk
)

131 
	`as_m
(
	`IS_FSMC_NAND_BANK
(
FSMC_Bk
));

133 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

136 
FSMC_Bk2
->
PCR2
 = 0x00000018;

137 
FSMC_Bk2
->
SR2
 = 0x00000040;

138 
FSMC_Bk2
->
PMEM2
 = 0xFCFCFCFC;

139 
FSMC_Bk2
->
PATT2
 = 0xFCFCFCFC;

145 
FSMC_Bk3
->
PCR3
 = 0x00000018;

146 
FSMC_Bk3
->
SR3
 = 0x00000040;

147 
FSMC_Bk3
->
PMEM3
 = 0xFCFCFCFC;

148 
FSMC_Bk3
->
PATT3
 = 0xFCFCFCFC;

150 
	}
}

157 
	$FSMC_PCCARDDeIn
()

160 
FSMC_Bk4
->
PCR4
 = 0x00000018;

161 
FSMC_Bk4
->
SR4
 = 0x00000000;

162 
FSMC_Bk4
->
PMEM4
 = 0xFCFCFCFC;

163 
FSMC_Bk4
->
PATT4
 = 0xFCFCFCFC;

164 
FSMC_Bk4
->
PIO4
 = 0xFCFCFCFC;

165 
	}
}

175 
	$FSMC_NORSRAMIn
(
FSMC_NORSRAMInTyDef
* 
FSMC_NORSRAMInSu
)

178 
	`as_m
(
	`IS_FSMC_NORSRAM_BANK
(
FSMC_NORSRAMInSu
->
FSMC_Bk
));

179 
	`as_m
(
	`IS_FSMC_MUX
(
FSMC_NORSRAMInSu
->
FSMC_DaAddssMux
));

180 
	`as_m
(
	`IS_FSMC_MEMORY
(
FSMC_NORSRAMInSu
->
FSMC_MemyTy
));

181 
	`as_m
(
	`IS_FSMC_MEMORY_WIDTH
(
FSMC_NORSRAMInSu
->
FSMC_MemyDaWidth
));

182 
	`as_m
(
	`IS_FSMC_BURSTMODE
(
FSMC_NORSRAMInSu
->
FSMC_BurAcssMode
));

183 
	`as_m
(
	`IS_FSMC_ASYNWAIT
(
FSMC_NORSRAMInSu
->
FSMC_AsynchrousWa
));

184 
	`as_m
(
	`IS_FSMC_WAIT_POLARITY
(
FSMC_NORSRAMInSu
->
FSMC_WaSiglPެy
));

185 
	`as_m
(
	`IS_FSMC_WRAP_MODE
(
FSMC_NORSRAMInSu
->
FSMC_WpMode
));

186 
	`as_m
(
	`IS_FSMC_WAIT_SIGNAL_ACTIVE
(
FSMC_NORSRAMInSu
->
FSMC_WaSiglAive
));

187 
	`as_m
(
	`IS_FSMC_WRITE_OPERATION
(
FSMC_NORSRAMInSu
->
FSMC_WreOti
));

188 
	`as_m
(
	`IS_FSMC_WAITE_SIGNAL
(
FSMC_NORSRAMInSu
->
FSMC_WaSigl
));

189 
	`as_m
(
	`IS_FSMC_EXTENDED_MODE
(
FSMC_NORSRAMInSu
->
FSMC_ExndedMode
));

190 
	`as_m
(
	`IS_FSMC_WRITE_BURST
(
FSMC_NORSRAMInSu
->
FSMC_WreBur
));

191 
	`as_m
(
	`IS_FSMC_ADDRESS_SETUP_TIME
(
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_AddssSupTime
));

192 
	`as_m
(
	`IS_FSMC_ADDRESS_HOLD_TIME
(
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_AddssHdTime
));

193 
	`as_m
(
	`IS_FSMC_DATASETUP_TIME
(
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_DaSupTime
));

194 
	`as_m
(
	`IS_FSMC_TURNAROUND_TIME
(
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_BusTuAroundDuti
));

195 
	`as_m
(
	`IS_FSMC_CLK_DIV
(
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_CLKDivisi
));

196 
	`as_m
(
	`IS_FSMC_DATA_LATENCY
(
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_DaLcy
));

197 
	`as_m
(
	`IS_FSMC_ACCESS_MODE
(
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_AcssMode
));

200 
FSMC_Bk1
->
BTCR
[
FSMC_NORSRAMInSu
->
FSMC_Bk
] =

201 (
ut32_t
)
FSMC_NORSRAMInSu
->
FSMC_DaAddssMux
 |

202 
FSMC_NORSRAMInSu
->
FSMC_MemyTy
 |

203 
FSMC_NORSRAMInSu
->
FSMC_MemyDaWidth
 |

204 
FSMC_NORSRAMInSu
->
FSMC_BurAcssMode
 |

205 
FSMC_NORSRAMInSu
->
FSMC_AsynchrousWa
 |

206 
FSMC_NORSRAMInSu
->
FSMC_WaSiglPެy
 |

207 
FSMC_NORSRAMInSu
->
FSMC_WpMode
 |

208 
FSMC_NORSRAMInSu
->
FSMC_WaSiglAive
 |

209 
FSMC_NORSRAMInSu
->
FSMC_WreOti
 |

210 
FSMC_NORSRAMInSu
->
FSMC_WaSigl
 |

211 
FSMC_NORSRAMInSu
->
FSMC_ExndedMode
 |

212 
FSMC_NORSRAMInSu
->
FSMC_WreBur
;

214 if(
FSMC_NORSRAMInSu
->
FSMC_MemyTy
 =
FSMC_MemyTy_NOR
)

216 
FSMC_Bk1
->
BTCR
[
FSMC_NORSRAMInSu
->
FSMC_Bk
] |(
ut32_t
)
BCR_FACCEN_S
;

220 
FSMC_Bk1
->
BTCR
[
FSMC_NORSRAMInSu
->
FSMC_Bk
+1] =

221 (
ut32_t
)
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_AddssSupTime
 |

222 (
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_AddssHdTime
 << 4) |

223 (
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_DaSupTime
 << 8) |

224 (
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_BusTuAroundDuti
 << 16) |

225 (
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_CLKDivisi
 << 20) |

226 (
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_DaLcy
 << 24) |

227 
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_AcssMode
;

231 if(
FSMC_NORSRAMInSu
->
FSMC_ExndedMode
 =
FSMC_ExndedMode_Eb
)

233 
	`as_m
(
	`IS_FSMC_ADDRESS_SETUP_TIME
(
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_AddssSupTime
));

234 
	`as_m
(
	`IS_FSMC_ADDRESS_HOLD_TIME
(
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_AddssHdTime
));

235 
	`as_m
(
	`IS_FSMC_DATASETUP_TIME
(
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_DaSupTime
));

236 
	`as_m
(
	`IS_FSMC_CLK_DIV
(
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_CLKDivisi
));

237 
	`as_m
(
	`IS_FSMC_DATA_LATENCY
(
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_DaLcy
));

238 
	`as_m
(
	`IS_FSMC_ACCESS_MODE
(
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_AcssMode
));

239 
FSMC_Bk1E
->
BWTR
[
FSMC_NORSRAMInSu
->
FSMC_Bk
] =

240 (
ut32_t
)
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_AddssSupTime
 |

241 (
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_AddssHdTime
 << 4 )|

242 (
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_DaSupTime
 << 8) |

243 (
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_CLKDivisi
 << 20) |

244 (
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_DaLcy
 << 24) |

245 
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_AcssMode
;

249 
FSMC_Bk1E
->
BWTR
[
FSMC_NORSRAMInSu
->
FSMC_Bk
] = 0x0FFFFFFF;

251 
	}
}

260 
	$FSMC_NANDIn
(
FSMC_NANDInTyDef
* 
FSMC_NANDInSu
)

262 
ut32_t
 
tm
 = 0x00000000, 
tmmem
 = 0x00000000, 
tmt
 = 0x00000000;

265 
	`as_m

	`IS_FSMC_NAND_BANK
(
FSMC_NANDInSu
->
FSMC_Bk
));

266 
	`as_m

	`IS_FSMC_WAIT_FEATURE
(
FSMC_NANDInSu
->
FSMC_Wau
));

267 
	`as_m

	`IS_FSMC_MEMORY_WIDTH
(
FSMC_NANDInSu
->
FSMC_MemyDaWidth
));

268 
	`as_m

	`IS_FSMC_ECC_STATE
(
FSMC_NANDInSu
->
FSMC_ECC
));

269 
	`as_m

	`IS_FSMC_ECCPAGE_SIZE
(
FSMC_NANDInSu
->
FSMC_ECCPageSize
));

270 
	`as_m

	`IS_FSMC_TCLR_TIME
(
FSMC_NANDInSu
->
FSMC_TCLRSupTime
));

271 
	`as_m

	`IS_FSMC_TAR_TIME
(
FSMC_NANDInSu
->
FSMC_TARSupTime
));

272 
	`as_m
(
	`IS_FSMC_SETUP_TIME
(
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_SupTime
));

273 
	`as_m
(
	`IS_FSMC_WAIT_TIME
(
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_WaSupTime
));

274 
	`as_m
(
	`IS_FSMC_HOLD_TIME
(
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_HdSupTime
));

275 
	`as_m
(
	`IS_FSMC_HIZ_TIME
(
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_HiZSupTime
));

276 
	`as_m
(
	`IS_FSMC_SETUP_TIME
(
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_SupTime
));

277 
	`as_m
(
	`IS_FSMC_WAIT_TIME
(
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_WaSupTime
));

278 
	`as_m
(
	`IS_FSMC_HOLD_TIME
(
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HdSupTime
));

279 
	`as_m
(
	`IS_FSMC_HIZ_TIME
(
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HiZSupTime
));

282 
tm
 = (
ut32_t
)
FSMC_NANDInSu
->
FSMC_Wau
 |

283 
PCR_MemyTy_NAND
 |

284 
FSMC_NANDInSu
->
FSMC_MemyDaWidth
 |

285 
FSMC_NANDInSu
->
FSMC_ECC
 |

286 
FSMC_NANDInSu
->
FSMC_ECCPageSize
 |

287 (
FSMC_NANDInSu
->
FSMC_TCLRSupTime
 << 9 )|

288 (
FSMC_NANDInSu
->
FSMC_TARSupTime
 << 13);

291 
tmmem
 = (
ut32_t
)
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_SupTime
 |

292 (
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_WaSupTime
 << 8) |

293 (
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_HdSupTime
 << 16)|

294 (
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_HiZSupTime
 << 24);

297 
tmt
 = (
ut32_t
)
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_SupTime
 |

298 (
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_WaSupTime
 << 8) |

299 (
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HdSupTime
 << 16)|

300 (
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HiZSupTime
 << 24);

302 if(
FSMC_NANDInSu
->
FSMC_Bk
 =
FSMC_Bk2_NAND
)

305 
FSMC_Bk2
->
PCR2
 = 
tm
;

306 
FSMC_Bk2
->
PMEM2
 = 
tmmem
;

307 
FSMC_Bk2
->
PATT2
 = 
tmt
;

312 
FSMC_Bk3
->
PCR3
 = 
tm
;

313 
FSMC_Bk3
->
PMEM3
 = 
tmmem
;

314 
FSMC_Bk3
->
PATT3
 = 
tmt
;

316 
	}
}

325 
	$FSMC_PCCARDIn
(
FSMC_PCCARDInTyDef
* 
FSMC_PCCARDInSu
)

328 
	`as_m
(
	`IS_FSMC_WAIT_FEATURE
(
FSMC_PCCARDInSu
->
FSMC_Wau
));

329 
	`as_m
(
	`IS_FSMC_TCLR_TIME
(
FSMC_PCCARDInSu
->
FSMC_TCLRSupTime
));

330 
	`as_m
(
	`IS_FSMC_TAR_TIME
(
FSMC_PCCARDInSu
->
FSMC_TARSupTime
));

332 
	`as_m
(
	`IS_FSMC_SETUP_TIME
(
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_SupTime
));

333 
	`as_m
(
	`IS_FSMC_WAIT_TIME
(
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_WaSupTime
));

334 
	`as_m
(
	`IS_FSMC_HOLD_TIME
(
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_HdSupTime
));

335 
	`as_m
(
	`IS_FSMC_HIZ_TIME
(
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_HiZSupTime
));

337 
	`as_m
(
	`IS_FSMC_SETUP_TIME
(
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_SupTime
));

338 
	`as_m
(
	`IS_FSMC_WAIT_TIME
(
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_WaSupTime
));

339 
	`as_m
(
	`IS_FSMC_HOLD_TIME
(
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HdSupTime
));

340 
	`as_m
(
	`IS_FSMC_HIZ_TIME
(
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HiZSupTime
));

341 
	`as_m
(
	`IS_FSMC_SETUP_TIME
(
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_SupTime
));

342 
	`as_m
(
	`IS_FSMC_WAIT_TIME
(
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_WaSupTime
));

343 
	`as_m
(
	`IS_FSMC_HOLD_TIME
(
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_HdSupTime
));

344 
	`as_m
(
	`IS_FSMC_HIZ_TIME
(
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_HiZSupTime
));

347 
FSMC_Bk4
->
PCR4
 = (
ut32_t
)
FSMC_PCCARDInSu
->
FSMC_Wau
 |

348 
FSMC_MemyDaWidth_16b
 |

349 (
FSMC_PCCARDInSu
->
FSMC_TCLRSupTime
 << 9) |

350 (
FSMC_PCCARDInSu
->
FSMC_TARSupTime
 << 13);

353 
FSMC_Bk4
->
PMEM4
 = (
ut32_t
)
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_SupTime
 |

354 (
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_WaSupTime
 << 8) |

355 (
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_HdSupTime
 << 16)|

356 (
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_HiZSupTime
 << 24);

359 
FSMC_Bk4
->
PATT4
 = (
ut32_t
)
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_SupTime
 |

360 (
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_WaSupTime
 << 8) |

361 (
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HdSupTime
 << 16)|

362 (
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HiZSupTime
 << 24);

365 
FSMC_Bk4
->
PIO4
 = (
ut32_t
)
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_SupTime
 |

366 (
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_WaSupTime
 << 8) |

367 (
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_HdSupTime
 << 16)|

368 (
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_HiZSupTime
 << 24);

369 
	}
}

377 
	$FSMC_NORSRAMSuIn
(
FSMC_NORSRAMInTyDef
* 
FSMC_NORSRAMInSu
)

380 
FSMC_NORSRAMInSu
->
FSMC_Bk
 = 
FSMC_Bk1_NORSRAM1
;

381 
FSMC_NORSRAMInSu
->
FSMC_DaAddssMux
 = 
FSMC_DaAddssMux_Eb
;

382 
FSMC_NORSRAMInSu
->
FSMC_MemyTy
 = 
FSMC_MemyTy_SRAM
;

383 
FSMC_NORSRAMInSu
->
FSMC_MemyDaWidth
 = 
FSMC_MemyDaWidth_8b
;

384 
FSMC_NORSRAMInSu
->
FSMC_BurAcssMode
 = 
FSMC_BurAcssMode_Dib
;

385 
FSMC_NORSRAMInSu
->
FSMC_AsynchrousWa
 = 
FSMC_AsynchrousWa_Dib
;

386 
FSMC_NORSRAMInSu
->
FSMC_WaSiglPެy
 = 
FSMC_WaSiglPެy_Low
;

387 
FSMC_NORSRAMInSu
->
FSMC_WpMode
 = 
FSMC_WpMode_Dib
;

388 
FSMC_NORSRAMInSu
->
FSMC_WaSiglAive
 = 
FSMC_WaSiglAive_BefeWaS
;

389 
FSMC_NORSRAMInSu
->
FSMC_WreOti
 = 
FSMC_WreOti_Eb
;

390 
FSMC_NORSRAMInSu
->
FSMC_WaSigl
 = 
FSMC_WaSigl_Eb
;

391 
FSMC_NORSRAMInSu
->
FSMC_ExndedMode
 = 
FSMC_ExndedMode_Dib
;

392 
FSMC_NORSRAMInSu
->
FSMC_WreBur
 = 
FSMC_WreBur_Dib
;

393 
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_AddssSupTime
 = 0xF;

394 
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_AddssHdTime
 = 0xF;

395 
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_DaSupTime
 = 0xFF;

396 
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_BusTuAroundDuti
 = 0xF;

397 
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_CLKDivisi
 = 0xF;

398 
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_DaLcy
 = 0xF;

399 
FSMC_NORSRAMInSu
->
FSMC_RdWreTimgSu
->
FSMC_AcssMode
 = 
FSMC_AcssMode_A
;

400 
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_AddssSupTime
 = 0xF;

401 
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_AddssHdTime
 = 0xF;

402 
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_DaSupTime
 = 0xFF;

403 
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_BusTuAroundDuti
 = 0xF;

404 
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_CLKDivisi
 = 0xF;

405 
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_DaLcy
 = 0xF;

406 
FSMC_NORSRAMInSu
->
FSMC_WreTimgSu
->
FSMC_AcssMode
 = 
FSMC_AcssMode_A
;

407 
	}
}

415 
	$FSMC_NANDSuIn
(
FSMC_NANDInTyDef
* 
FSMC_NANDInSu
)

418 
FSMC_NANDInSu
->
FSMC_Bk
 = 
FSMC_Bk2_NAND
;

419 
FSMC_NANDInSu
->
FSMC_Wau
 = 
FSMC_Wau_Dib
;

420 
FSMC_NANDInSu
->
FSMC_MemyDaWidth
 = 
FSMC_MemyDaWidth_8b
;

421 
FSMC_NANDInSu
->
FSMC_ECC
 = 
FSMC_ECC_Dib
;

422 
FSMC_NANDInSu
->
FSMC_ECCPageSize
 = 
FSMC_ECCPageSize_256Bys
;

423 
FSMC_NANDInSu
->
FSMC_TCLRSupTime
 = 0x0;

424 
FSMC_NANDInSu
->
FSMC_TARSupTime
 = 0x0;

425 
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_SupTime
 = 0xFC;

426 
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_WaSupTime
 = 0xFC;

427 
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_HdSupTime
 = 0xFC;

428 
FSMC_NANDInSu
->
FSMC_CommSTimgSu
->
FSMC_HiZSupTime
 = 0xFC;

429 
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_SupTime
 = 0xFC;

430 
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_WaSupTime
 = 0xFC;

431 
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HdSupTime
 = 0xFC;

432 
FSMC_NANDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HiZSupTime
 = 0xFC;

433 
	}
}

441 
	$FSMC_PCCARDSuIn
(
FSMC_PCCARDInTyDef
* 
FSMC_PCCARDInSu
)

444 
FSMC_PCCARDInSu
->
FSMC_Wau
 = 
FSMC_Wau_Dib
;

445 
FSMC_PCCARDInSu
->
FSMC_TCLRSupTime
 = 0x0;

446 
FSMC_PCCARDInSu
->
FSMC_TARSupTime
 = 0x0;

447 
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_SupTime
 = 0xFC;

448 
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_WaSupTime
 = 0xFC;

449 
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_HdSupTime
 = 0xFC;

450 
FSMC_PCCARDInSu
->
FSMC_CommSTimgSu
->
FSMC_HiZSupTime
 = 0xFC;

451 
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_SupTime
 = 0xFC;

452 
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_WaSupTime
 = 0xFC;

453 
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HdSupTime
 = 0xFC;

454 
FSMC_PCCARDInSu
->
FSMC_AribuSTimgSu
->
FSMC_HiZSupTime
 = 0xFC;

455 
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_SupTime
 = 0xFC;

456 
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_WaSupTime
 = 0xFC;

457 
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_HdSupTime
 = 0xFC;

458 
FSMC_PCCARDInSu
->
FSMC_IOSTimgSu
->
FSMC_HiZSupTime
 = 0xFC;

459 
	}
}

472 
	$FSMC_NORSRAMCmd
(
ut32_t
 
FSMC_Bk
, 
FuniڮS
 
NewS
)

474 
	`as_m
(
	`IS_FSMC_NORSRAM_BANK
(
FSMC_Bk
));

475 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

477 i(
NewS
 !
DISABLE
)

480 
FSMC_Bk1
->
BTCR
[
FSMC_Bk
] |
BCR_MBKEN_S
;

485 
FSMC_Bk1
->
BTCR
[
FSMC_Bk
] &
BCR_MBKEN_Ret
;

487 
	}
}

498 
	$FSMC_NANDCmd
(
ut32_t
 
FSMC_Bk
, 
FuniڮS
 
NewS
)

500 
	`as_m
(
	`IS_FSMC_NAND_BANK
(
FSMC_Bk
));

501 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

503 i(
NewS
 !
DISABLE
)

506 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

508 
FSMC_Bk2
->
PCR2
 |
PCR_PBKEN_S
;

512 
FSMC_Bk3
->
PCR3
 |
PCR_PBKEN_S
;

518 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

520 
FSMC_Bk2
->
PCR2
 &
PCR_PBKEN_Ret
;

524 
FSMC_Bk3
->
PCR3
 &
PCR_PBKEN_Ret
;

527 
	}
}

535 
	$FSMC_PCCARDCmd
(
FuniڮS
 
NewS
)

537 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

539 i(
NewS
 !
DISABLE
)

542 
FSMC_Bk4
->
PCR4
 |
PCR_PBKEN_S
;

547 
FSMC_Bk4
->
PCR4
 &
PCR_PBKEN_Ret
;

549 
	}
}

561 
	$FSMC_NANDECCCmd
(
ut32_t
 
FSMC_Bk
, 
FuniڮS
 
NewS
)

563 
	`as_m
(
	`IS_FSMC_NAND_BANK
(
FSMC_Bk
));

564 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

566 i(
NewS
 !
DISABLE
)

569 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

571 
FSMC_Bk2
->
PCR2
 |
PCR_ECCEN_S
;

575 
FSMC_Bk3
->
PCR3
 |
PCR_ECCEN_S
;

581 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

583 
FSMC_Bk2
->
PCR2
 &
PCR_ECCEN_Ret
;

587 
FSMC_Bk3
->
PCR3
 &
PCR_ECCEN_Ret
;

590 
	}
}

600 
ut32_t
 
	$FSMC_GECC
(
ut32_t
 
FSMC_Bk
)

602 
ut32_t
 
eccv
 = 0x00000000;

604 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

607 
eccv
 = 
FSMC_Bk2
->
ECCR2
;

612 
eccv
 = 
FSMC_Bk3
->
ECCR3
;

615 (
eccv
);

616 
	}
}

634 
	$FSMC_ITCfig
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_IT
, 
FuniڮS
 
NewS
)

636 
	`as_m
(
	`IS_FSMC_IT_BANK
(
FSMC_Bk
));

637 
	`as_m
(
	`IS_FSMC_IT
(
FSMC_IT
));

638 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

640 i(
NewS
 !
DISABLE
)

643 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

645 
FSMC_Bk2
->
SR2
 |
FSMC_IT
;

648 i(
FSMC_Bk
 =
FSMC_Bk3_NAND
)

650 
FSMC_Bk3
->
SR3
 |
FSMC_IT
;

655 
FSMC_Bk4
->
SR4
 |
FSMC_IT
;

661 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

664 
FSMC_Bk2
->
SR2
 &(
ut32_t
)~
FSMC_IT
;

667 i(
FSMC_Bk
 =
FSMC_Bk3_NAND
)

669 
FSMC_Bk3
->
SR3
 &(
ut32_t
)~
FSMC_IT
;

674 
FSMC_Bk4
->
SR4
 &(
ut32_t
)~
FSMC_IT
;

677 
	}
}

694 
FgStus
 
	$FSMC_GFgStus
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_FLAG
)

696 
FgStus
 
bus
 = 
RESET
;

697 
ut32_t
 
tmp
 = 0x00000000;

700 
	`as_m
(
	`IS_FSMC_GETFLAG_BANK
(
FSMC_Bk
));

701 
	`as_m
(
	`IS_FSMC_GET_FLAG
(
FSMC_FLAG
));

703 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

705 
tmp
 = 
FSMC_Bk2
->
SR2
;

707 if(
FSMC_Bk
 =
FSMC_Bk3_NAND
)

709 
tmp
 = 
FSMC_Bk3
->
SR3
;

714 
tmp
 = 
FSMC_Bk4
->
SR4
;

718 i((
tmp
 & 
FSMC_FLAG
!(
ut16_t
)
RESET
 )

720 
bus
 = 
SET
;

724 
bus
 = 
RESET
;

727  
bus
;

728 
	}
}

744 
	$FSMC_CˬFg
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_FLAG
)

747 
	`as_m
(
	`IS_FSMC_GETFLAG_BANK
(
FSMC_Bk
));

748 
	`as_m
(
	`IS_FSMC_CLEAR_FLAG
(
FSMC_FLAG
)) ;

750 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

752 
FSMC_Bk2
->
SR2
 &~
FSMC_FLAG
;

754 if(
FSMC_Bk
 =
FSMC_Bk3_NAND
)

756 
FSMC_Bk3
->
SR3
 &~
FSMC_FLAG
;

761 
FSMC_Bk4
->
SR4
 &~
FSMC_FLAG
;

763 
	}
}

779 
ITStus
 
	$FSMC_GITStus
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_IT
)

781 
ITStus
 
bus
 = 
RESET
;

782 
ut32_t
 
tmp
 = 0x0, 
us
 = 0x0, 
ab
 = 0x0;

785 
	`as_m
(
	`IS_FSMC_IT_BANK
(
FSMC_Bk
));

786 
	`as_m
(
	`IS_FSMC_GET_IT
(
FSMC_IT
));

788 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

790 
tmp
 = 
FSMC_Bk2
->
SR2
;

792 if(
FSMC_Bk
 =
FSMC_Bk3_NAND
)

794 
tmp
 = 
FSMC_Bk3
->
SR3
;

799 
tmp
 = 
FSMC_Bk4
->
SR4
;

802 
us
 = 
tmp
 & 
FSMC_IT
;

804 
ab
 = 
tmp
 & (
FSMC_IT
 >> 3);

805 i((
us
 !(
ut32_t
)
RESET
&& (
ab
 != (uint32_t)RESET))

807 
bus
 = 
SET
;

811 
bus
 = 
RESET
;

813  
bus
;

814 
	}
}

830 
	$FSMC_CˬITPdgB
(
ut32_t
 
FSMC_Bk
, ut32_
FSMC_IT
)

833 
	`as_m
(
	`IS_FSMC_IT_BANK
(
FSMC_Bk
));

834 
	`as_m
(
	`IS_FSMC_IT
(
FSMC_IT
));

836 if(
FSMC_Bk
 =
FSMC_Bk2_NAND
)

838 
FSMC_Bk2
->
SR2
 &~(
FSMC_IT
 >> 3);

840 if(
FSMC_Bk
 =
FSMC_Bk3_NAND
)

842 
FSMC_Bk3
->
SR3
 &~(
FSMC_IT
 >> 3);

847 
FSMC_Bk4
->
SR4
 &~(
FSMC_IT
 >> 3);

849 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_gpio.c

22 
	~"m32f10x_gpio.h
"

23 
	~"m32f10x_rcc.h
"

47 
	#AFIO_OFFSET
 (
AFIO_BASE
 - 
PERIPH_BASE
)

	)

52 
	#EVCR_OFFSET
 (
AFIO_OFFSET
 + 0x00)

	)

53 
	#EVOE_BNumb
 ((
ut8_t
)0x07)

	)

54 
	#EVCR_EVOE_BB
 (
PERIPH_BB_BASE
 + (
EVCR_OFFSET
 * 32+ (
EVOE_BNumb
 * 4))

	)

59 
	#MAPR_OFFSET
 (
AFIO_OFFSET
 + 0x04)

	)

60 
	#MII_RMII_SEL_BNumb
 ((
u8
)0x17)

	)

61 
	#MAPR_MII_RMII_SEL_BB
 (
PERIPH_BB_BASE
 + (
MAPR_OFFSET
 * 32+ (
MII_RMII_SEL_BNumb
 * 4))

	)

64 
	#EVCR_PORTPINCONFIG_MASK
 ((
ut16_t
)0xFF80)

	)

65 
	#LSB_MASK
 ((
ut16_t
)0xFFFF)

	)

66 
	#DBGAFR_POSITION_MASK
 ((
ut32_t
)0x000F0000)

	)

67 
	#DBGAFR_SWJCFG_MASK
 ((
ut32_t
)0xF0FFFFFF)

	)

68 
	#DBGAFR_LOCATION_MASK
 ((
ut32_t
)0x00200000)

	)

69 
	#DBGAFR_NUMBITS_MASK
 ((
ut32_t
)0x00100000)

	)

107 
	$GPIO_DeIn
(
GPIO_TyDef
* 
GPIOx
)

110 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

112 i(
GPIOx
 =
GPIOA
)

114 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOA
, 
ENABLE
);

115 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOA
, 
DISABLE
);

117 i(
GPIOx
 =
GPIOB
)

119 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOB
, 
ENABLE
);

120 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOB
, 
DISABLE
);

122 i(
GPIOx
 =
GPIOC
)

124 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOC
, 
ENABLE
);

125 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOC
, 
DISABLE
);

127 i(
GPIOx
 =
GPIOD
)

129 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOD
, 
ENABLE
);

130 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOD
, 
DISABLE
);

132 i(
GPIOx
 =
GPIOE
)

134 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOE
, 
ENABLE
);

135 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOE
, 
DISABLE
);

137 i(
GPIOx
 =
GPIOF
)

139 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOF
, 
ENABLE
);

140 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOF
, 
DISABLE
);

144 i(
GPIOx
 =
GPIOG
)

146 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOG
, 
ENABLE
);

147 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_GPIOG
, 
DISABLE
);

150 
	}
}

158 
	$GPIO_AFIODeIn
()

160 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_AFIO
, 
ENABLE
);

161 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_AFIO
, 
DISABLE
);

162 
	}
}

172 
	$GPIO_In
(
GPIO_TyDef
* 
GPIOx
, 
GPIO_InTyDef
* 
GPIO_InSu
)

174 
ut32_t
 
cutmode
 = 0x00, 
cu
 = 0x00, 
ppos
 = 0x00, 
pos
 = 0x00;

175 
ut32_t
 
tmeg
 = 0x00, 
pmask
 = 0x00;

177 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

178 
	`as_m
(
	`IS_GPIO_MODE
(
GPIO_InSu
->
GPIO_Mode
));

179 
	`as_m
(
	`IS_GPIO_PIN
(
GPIO_InSu
->
GPIO_P
));

182 
cutmode
 = ((
ut32_t
)
GPIO_InSu
->
GPIO_Mode
) & ((uint32_t)0x0F);

183 i((((
ut32_t
)
GPIO_InSu
->
GPIO_Mode
) & ((uint32_t)0x10)) != 0x00)

186 
	`as_m
(
	`IS_GPIO_SPEED
(
GPIO_InSu
->
GPIO_Sed
));

188 
cutmode
 |(
ut32_t
)
GPIO_InSu
->
GPIO_Sed
;

192 i(((
ut32_t
)
GPIO_InSu
->
GPIO_P
 & ((uint32_t)0x00FF)) != 0x00)

194 
tmeg
 = 
GPIOx
->
CRL
;

195 
ppos
 = 0x00;inpos < 0x08;inpos++)

197 
pos
 = ((
ut32_t
)0x01<< 
ppos
;

199 
cu
 = (
GPIO_InSu
->
GPIO_P
& 
pos
;

200 i(
cu
 =
pos
)

202 
pos
 = 
ppos
 << 2;

204 
pmask
 = ((
ut32_t
)0x0F<< 
pos
;

205 
tmeg
 &~
pmask
;

207 
tmeg
 |(
cutmode
 << 
pos
);

209 i(
GPIO_InSu
->
GPIO_Mode
 =
GPIO_Mode_IPD
)

211 
GPIOx
->
BRR
 = (((
ut32_t
)0x01<< 
ppos
);

216 i(
GPIO_InSu
->
GPIO_Mode
 =
GPIO_Mode_IPU
)

218 
GPIOx
->
BSRR
 = (((
ut32_t
)0x01<< 
ppos
);

223 
GPIOx
->
CRL
 = 
tmeg
;

227 i(
GPIO_InSu
->
GPIO_P
 > 0x00FF)

229 
tmeg
 = 
GPIOx
->
CRH
;

230 
ppos
 = 0x00;inpos < 0x08;inpos++)

232 
pos
 = (((
ut32_t
)0x01<< (
ppos
 + 0x08));

234 
cu
 = ((
GPIO_InSu
->
GPIO_P
& 
pos
);

235 i(
cu
 =
pos
)

237 
pos
 = 
ppos
 << 2;

239 
pmask
 = ((
ut32_t
)0x0F<< 
pos
;

240 
tmeg
 &~
pmask
;

242 
tmeg
 |(
cutmode
 << 
pos
);

244 i(
GPIO_InSu
->
GPIO_Mode
 =
GPIO_Mode_IPD
)

246 
GPIOx
->
BRR
 = (((
ut32_t
)0x01<< (
ppos
 + 0x08));

249 i(
GPIO_InSu
->
GPIO_Mode
 =
GPIO_Mode_IPU
)

251 
GPIOx
->
BSRR
 = (((
ut32_t
)0x01<< (
ppos
 + 0x08));

255 
GPIOx
->
CRH
 = 
tmeg
;

257 
	}
}

265 
	$GPIO_SuIn
(
GPIO_InTyDef
* 
GPIO_InSu
)

268 
GPIO_InSu
->
GPIO_P
 = 
GPIO_P_A
;

269 
GPIO_InSu
->
GPIO_Sed
 = 
GPIO_Sed_2MHz
;

270 
GPIO_InSu
->
GPIO_Mode
 = 
GPIO_Mode_IN_FLOATING
;

271 
	}
}

280 
ut8_t
 
	$GPIO_RdIutDaB
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
)

282 
ut8_t
 
bus
 = 0x00;

285 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

286 
	`as_m
(
	`IS_GET_GPIO_PIN
(
GPIO_P
));

288 i((
GPIOx
->
IDR
 & 
GPIO_P
!(
ut32_t
)
B_RESET
)

290 
bus
 = (
ut8_t
)
B_SET
;

294 
bus
 = (
ut8_t
)
B_RESET
;

296  
bus
;

297 
	}
}

304 
ut16_t
 
	$GPIO_RdIutDa
(
GPIO_TyDef
* 
GPIOx
)

307 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

309  ((
ut16_t
)
GPIOx
->
IDR
);

310 
	}
}

319 
ut8_t
 
	$GPIO_RdOuutDaB
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
)

321 
ut8_t
 
bus
 = 0x00;

323 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

324 
	`as_m
(
	`IS_GET_GPIO_PIN
(
GPIO_P
));

326 i((
GPIOx
->
ODR
 & 
GPIO_P
!(
ut32_t
)
B_RESET
)

328 
bus
 = (
ut8_t
)
B_SET
;

332 
bus
 = (
ut8_t
)
B_RESET
;

334  
bus
;

335 
	}
}

342 
ut16_t
 
	$GPIO_RdOuutDa
(
GPIO_TyDef
* 
GPIOx
)

345 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

347  ((
ut16_t
)
GPIOx
->
ODR
);

348 
	}
}

357 
	$GPIO_SBs
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
)

360 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

361 
	`as_m
(
	`IS_GPIO_PIN
(
GPIO_P
));

363 
GPIOx
->
BSRR
 = 
GPIO_P
;

364 
	}
}

373 
	$GPIO_RetBs
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
)

376 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

377 
	`as_m
(
	`IS_GPIO_PIN
(
GPIO_P
));

379 
GPIOx
->
BRR
 = 
GPIO_P
;

380 
	}
}

393 
	$GPIO_WreB
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
, 
BAi
 
BV
)

396 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

397 
	`as_m
(
	`IS_GET_GPIO_PIN
(
GPIO_P
));

398 
	`as_m
(
	`IS_GPIO_BIT_ACTION
(
BV
));

400 i(
BV
 !
B_RESET
)

402 
GPIOx
->
BSRR
 = 
GPIO_P
;

406 
GPIOx
->
BRR
 = 
GPIO_P
;

408 
	}
}

416 
	$GPIO_Wre
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
PtV
)

419 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

421 
GPIOx
->
ODR
 = 
PtV
;

422 
	}
}

431 
	$GPIO_PLockCfig
(
GPIO_TyDef
* 
GPIOx
, 
ut16_t
 
GPIO_P
)

433 
ut32_t
 
tmp
 = 0x00010000;

436 
	`as_m
(
	`IS_GPIO_ALL_PERIPH
(
GPIOx
));

437 
	`as_m
(
	`IS_GPIO_PIN
(
GPIO_P
));

439 
tmp
 |
GPIO_P
;

441 
GPIOx
->
LCKR
 = 
tmp
;

443 
GPIOx
->
LCKR
 = 
GPIO_P
;

445 
GPIOx
->
LCKR
 = 
tmp
;

447 
tmp
 = 
GPIOx
->
LCKR
;

449 
tmp
 = 
GPIOx
->
LCKR
;

450 
	}
}

461 
	$GPIO_EvtOuutCfig
(
ut8_t
 
GPIO_PtSour
, ut8_
GPIO_PSour
)

463 
ut32_t
 
tmeg
 = 0x00;

465 
	`as_m
(
	`IS_GPIO_EVENTOUT_PORT_SOURCE
(
GPIO_PtSour
));

466 
	`as_m
(
	`IS_GPIO_PIN_SOURCE
(
GPIO_PSour
));

468 
tmeg
 = 
AFIO
->
EVCR
;

470 
tmeg
 &
EVCR_PORTPINCONFIG_MASK
;

471 
tmeg
 |(
ut32_t
)
GPIO_PtSour
 << 0x04;

472 
tmeg
 |
GPIO_PSour
;

473 
AFIO
->
EVCR
 = 
tmeg
;

474 
	}
}

482 
	$GPIO_EvtOuutCmd
(
FuniڮS
 
NewS
)

485 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

487 *(
__IO
 
ut32_t
 *
EVCR_EVOE_BB
 = (ut32_t)
NewS
;

488 
	}
}

546 
	$GPIO_PRemCfig
(
ut32_t
 
GPIO_Rem
, 
FuniڮS
 
NewS
)

548 
ut32_t
 
tmp
 = 0x00, 
tmp1
 = 0x00, 
tmeg
 = 0x00, 
tmpmask
 = 0x00;

551 
	`as_m
(
	`IS_GPIO_REMAP
(
GPIO_Rem
));

552 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

554 if((
GPIO_Rem
 & 0x80000000) == 0x80000000)

556 
tmeg
 = 
AFIO
->
MAPR2
;

560 
tmeg
 = 
AFIO
->
MAPR
;

563 
tmpmask
 = (
GPIO_Rem
 & 
DBGAFR_POSITION_MASK
) >> 0x10;

564 
tmp
 = 
GPIO_Rem
 & 
LSB_MASK
;

566 i((
GPIO_Rem
 & (
DBGAFR_LOCATION_MASK
 | 
DBGAFR_NUMBITS_MASK
)) == (DBGAFR_LOCATION_MASK | DBGAFR_NUMBITS_MASK))

568 
tmeg
 &
DBGAFR_SWJCFG_MASK
;

569 
AFIO
->
MAPR
 &
DBGAFR_SWJCFG_MASK
;

571 i((
GPIO_Rem
 & 
DBGAFR_NUMBITS_MASK
) == DBGAFR_NUMBITS_MASK)

573 
tmp1
 = ((
ut32_t
)0x03<< 
tmpmask
;

574 
tmeg
 &~
tmp1
;

575 
tmeg
 |~
DBGAFR_SWJCFG_MASK
;

579 
tmeg
 &~(
tmp
 << ((
GPIO_Rem
 >> 0x15)*0x10));

580 
tmeg
 |~
DBGAFR_SWJCFG_MASK
;

583 i(
NewS
 !
DISABLE
)

585 
tmeg
 |(
tmp
 << ((
GPIO_Rem
 >> 0x15)*0x10));

588 if((
GPIO_Rem
 & 0x80000000) == 0x80000000)

590 
AFIO
->
MAPR2
 = 
tmeg
;

594 
AFIO
->
MAPR
 = 
tmeg
;

596 
	}
}

606 
	$GPIO_EXTILeCfig
(
ut8_t
 
GPIO_PtSour
, ut8_
GPIO_PSour
)

608 
ut32_t
 
tmp
 = 0x00;

610 
	`as_m
(
	`IS_GPIO_EXTI_PORT_SOURCE
(
GPIO_PtSour
));

611 
	`as_m
(
	`IS_GPIO_PIN_SOURCE
(
GPIO_PSour
));

613 
tmp
 = ((
ut32_t
)0x0F<< (0x04 * (
GPIO_PSour
 & (
ut8_t
)0x03));

614 
AFIO
->
EXTICR
[
GPIO_PSour
 >> 0x02] &~
tmp
;

615 
AFIO
->
EXTICR
[
GPIO_PSour
 >> 0x02] |(((
ut32_t
)
GPIO_PtSour
<< (0x04 * (GPIO_PSour & (
ut8_t
)0x03)));

616 
	}
}

627 
	$GPIO_ETH_MedICfig
(
ut32_t
 
GPIO_ETH_MedI
)

629 
	`as_m
(
	`IS_GPIO_ETH_MEDIA_INTERFACE
(
GPIO_ETH_MedI
));

632 *(
__IO
 
ut32_t
 *
MAPR_MII_RMII_SEL_BB
 = 
GPIO_ETH_MedI
;

633 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_i2c.c

22 
	~"m32f10x_i2c.h
"

23 
	~"m32f10x_rcc.h
"

48 
	#CR1_PE_S
 ((
ut16_t
)0x0001)

	)

49 
	#CR1_PE_Ret
 ((
ut16_t
)0xFFFE)

	)

52 
	#CR1_START_S
 ((
ut16_t
)0x0100)

	)

53 
	#CR1_START_Ret
 ((
ut16_t
)0xFEFF)

	)

56 
	#CR1_STOP_S
 ((
ut16_t
)0x0200)

	)

57 
	#CR1_STOP_Ret
 ((
ut16_t
)0xFDFF)

	)

60 
	#CR1_ACK_S
 ((
ut16_t
)0x0400)

	)

61 
	#CR1_ACK_Ret
 ((
ut16_t
)0xFBFF)

	)

64 
	#CR1_ENGC_S
 ((
ut16_t
)0x0040)

	)

65 
	#CR1_ENGC_Ret
 ((
ut16_t
)0xFFBF)

	)

68 
	#CR1_SWRST_S
 ((
ut16_t
)0x8000)

	)

69 
	#CR1_SWRST_Ret
 ((
ut16_t
)0x7FFF)

	)

72 
	#CR1_PEC_S
 ((
ut16_t
)0x1000)

	)

73 
	#CR1_PEC_Ret
 ((
ut16_t
)0xEFFF)

	)

76 
	#CR1_ENPEC_S
 ((
ut16_t
)0x0020)

	)

77 
	#CR1_ENPEC_Ret
 ((
ut16_t
)0xFFDF)

	)

80 
	#CR1_ENARP_S
 ((
ut16_t
)0x0010)

	)

81 
	#CR1_ENARP_Ret
 ((
ut16_t
)0xFFEF)

	)

84 
	#CR1_NOSTRETCH_S
 ((
ut16_t
)0x0080)

	)

85 
	#CR1_NOSTRETCH_Ret
 ((
ut16_t
)0xFF7F)

	)

88 
	#CR1_CLEAR_Mask
 ((
ut16_t
)0xFBF5)

	)

91 
	#CR2_DMAEN_S
 ((
ut16_t
)0x0800)

	)

92 
	#CR2_DMAEN_Ret
 ((
ut16_t
)0xF7FF)

	)

95 
	#CR2_LAST_S
 ((
ut16_t
)0x1000)

	)

96 
	#CR2_LAST_Ret
 ((
ut16_t
)0xEFFF)

	)

99 
	#CR2_FREQ_Ret
 ((
ut16_t
)0xFFC0)

	)

102 
	#OAR1_ADD0_S
 ((
ut16_t
)0x0001)

	)

103 
	#OAR1_ADD0_Ret
 ((
ut16_t
)0xFFFE)

	)

106 
	#OAR2_ENDUAL_S
 ((
ut16_t
)0x0001)

	)

107 
	#OAR2_ENDUAL_Ret
 ((
ut16_t
)0xFFFE)

	)

110 
	#OAR2_ADD2_Ret
 ((
ut16_t
)0xFF01)

	)

113 
	#CCR_FS_S
 ((
ut16_t
)0x8000)

	)

116 
	#CCR_CCR_S
 ((
ut16_t
)0x0FFF)

	)

119 
	#FLAG_Mask
 ((
ut32_t
)0x00FFFFFF)

	)

122 
	#ITEN_Mask
 ((
ut32_t
)0x07000000)

	)

161 
	$I2C_DeIn
(
I2C_TyDef
* 
I2Cx
)

164 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

166 i(
I2Cx
 =
I2C1
)

169 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_I2C1
, 
ENABLE
);

171 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_I2C1
, 
DISABLE
);

176 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_I2C2
, 
ENABLE
);

178 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_I2C2
, 
DISABLE
);

180 
	}
}

190 
	$I2C_In
(
I2C_TyDef
* 
I2Cx
, 
I2C_InTyDef
* 
I2C_InSu
)

192 
ut16_t
 
tmeg
 = 0, 
eqnge
 = 0;

193 
ut16_t
 
su
 = 0x04;

194 
ut32_t
 
pk1
 = 8000000;

195 
RCC_ClocksTyDef
 
rcc_ocks
;

197 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

198 
	`as_m
(
	`IS_I2C_CLOCK_SPEED
(
I2C_InSu
->
I2C_ClockSed
));

199 
	`as_m
(
	`IS_I2C_MODE
(
I2C_InSu
->
I2C_Mode
));

200 
	`as_m
(
	`IS_I2C_DUTY_CYCLE
(
I2C_InSu
->
I2C_DutyCye
));

201 
	`as_m
(
	`IS_I2C_OWN_ADDRESS1
(
I2C_InSu
->
I2C_OwnAddss1
));

202 
	`as_m
(
	`IS_I2C_ACK_STATE
(
I2C_InSu
->
I2C_Ack
));

203 
	`as_m
(
	`IS_I2C_ACKNOWLEDGE_ADDRESS
(
I2C_InSu
->
I2C_AcknowdgedAddss
));

207 
tmeg
 = 
I2Cx
->
CR2
;

209 
tmeg
 &
CR2_FREQ_Ret
;

211 
	`RCC_GClocksFq
(&
rcc_ocks
);

212 
pk1
 = 
rcc_ocks
.
PCLK1_Fqucy
;

214 
eqnge
 = (
ut16_t
)(
pk1
 / 1000000);

215 
tmeg
 |
eqnge
;

217 
I2Cx
->
CR2
 = 
tmeg
;

221 
I2Cx
->
CR1
 &
CR1_PE_Ret
;

224 
tmeg
 = 0;

227 i(
I2C_InSu
->
I2C_ClockSed
 <= 100000)

230 
su
 = (
ut16_t
)(
pk1
 / (
I2C_InSu
->
I2C_ClockSed
 << 1));

232 i(
su
 < 0x04)

235 
su
 = 0x04;

238 
tmeg
 |
su
;

240 
I2Cx
->
TRISE
 = 
eqnge
 + 1;

245 i(
I2C_InSu
->
I2C_DutyCye
 =
I2C_DutyCye_2
)

248 
su
 = (
ut16_t
)(
pk1
 / (
I2C_InSu
->
I2C_ClockSed
 * 3));

253 
su
 = (
ut16_t
)(
pk1
 / (
I2C_InSu
->
I2C_ClockSed
 * 25));

255 
su
 |
I2C_DutyCye_16_9
;

259 i((
su
 & 
CCR_CCR_S
) == 0)

262 
su
 |(
ut16_t
)0x0001;

265 
tmeg
 |(
ut16_t
)(
su
 | 
CCR_FS_S
);

267 
I2Cx
->
TRISE
 = (
ut16_t
)(((
eqnge
 * (uint16_t)300) / (uint16_t)1000) + (uint16_t)1);

271 
I2Cx
->
CCR
 = 
tmeg
;

273 
I2Cx
->
CR1
 |
CR1_PE_S
;

277 
tmeg
 = 
I2Cx
->
CR1
;

279 
tmeg
 &
CR1_CLEAR_Mask
;

283 
tmeg
 |(
ut16_t
)((
ut32_t
)
I2C_InSu
->
I2C_Mode
 | I2C_InSu->
I2C_Ack
);

285 
I2Cx
->
CR1
 = 
tmeg
;

289 
I2Cx
->
OAR1
 = (
I2C_InSu
->
I2C_AcknowdgedAddss
 | I2C_InSu->
I2C_OwnAddss1
);

290 
	}
}

297 
	$I2C_SuIn
(
I2C_InTyDef
* 
I2C_InSu
)

301 
I2C_InSu
->
I2C_ClockSed
 = 5000;

303 
I2C_InSu
->
I2C_Mode
 = 
I2C_Mode_I2C
;

305 
I2C_InSu
->
I2C_DutyCye
 = 
I2C_DutyCye_2
;

307 
I2C_InSu
->
I2C_OwnAddss1
 = 0;

309 
I2C_InSu
->
I2C_Ack
 = 
I2C_Ack_Dib
;

311 
I2C_InSu
->
I2C_AcknowdgedAddss
 = 
I2C_AcknowdgedAddss_7b
;

312 
	}
}

321 
	$I2C_Cmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

324 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

325 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

326 i(
NewS
 !
DISABLE
)

329 
I2Cx
->
CR1
 |
CR1_PE_S
;

334 
I2Cx
->
CR1
 &
CR1_PE_Ret
;

336 
	}
}

345 
	$I2C_DMACmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

348 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

349 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

350 i(
NewS
 !
DISABLE
)

353 
I2Cx
->
CR2
 |
CR2_DMAEN_S
;

358 
I2Cx
->
CR2
 &
CR2_DMAEN_Ret
;

360 
	}
}

369 
	$I2C_DMALaTnsrCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

372 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

373 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

374 i(
NewS
 !
DISABLE
)

377 
I2Cx
->
CR2
 |
CR2_LAST_S
;

382 
I2Cx
->
CR2
 &
CR2_LAST_Ret
;

384 
	}
}

393 
	$I2C_GeSTART
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

396 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

397 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

398 i(
NewS
 !
DISABLE
)

401 
I2Cx
->
CR1
 |
CR1_START_S
;

406 
I2Cx
->
CR1
 &
CR1_START_Ret
;

408 
	}
}

417 
	$I2C_GeSTOP
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

420 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

421 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

422 i(
NewS
 !
DISABLE
)

425 
I2Cx
->
CR1
 |
CR1_STOP_S
;

430 
I2Cx
->
CR1
 &
CR1_STOP_Ret
;

432 
	}
}

441 
	$I2C_AcknowdgeCfig
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

444 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

445 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

446 i(
NewS
 !
DISABLE
)

449 
I2Cx
->
CR1
 |
CR1_ACK_S
;

454 
I2Cx
->
CR1
 &
CR1_ACK_Ret
;

456 
	}
}

464 
	$I2C_OwnAddss2Cfig
(
I2C_TyDef
* 
I2Cx
, 
ut8_t
 
Addss
)

466 
ut16_t
 
tmeg
 = 0;

469 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

472 
tmeg
 = 
I2Cx
->
OAR2
;

475 
tmeg
 &
OAR2_ADD2_Ret
;

478 
tmeg
 |(
ut16_t
)((ut16_t)
Addss
 & (uint16_t)0x00FE);

481 
I2Cx
->
OAR2
 = 
tmeg
;

482 
	}
}

491 
	$I2C_DuAddssCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

494 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

495 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

496 i(
NewS
 !
DISABLE
)

499 
I2Cx
->
OAR2
 |
OAR2_ENDUAL_S
;

504 
I2Cx
->
OAR2
 &
OAR2_ENDUAL_Ret
;

506 
	}
}

515 
	$I2C_GClCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

518 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

519 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

520 i(
NewS
 !
DISABLE
)

523 
I2Cx
->
CR1
 |
CR1_ENGC_S
;

528 
I2Cx
->
CR1
 &
CR1_ENGC_Ret
;

530 
	}
}

544 
	$I2C_ITCfig
(
I2C_TyDef
* 
I2Cx
, 
ut16_t
 
I2C_IT
, 
FuniڮS
 
NewS
)

547 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

548 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

549 
	`as_m
(
	`IS_I2C_CONFIG_IT
(
I2C_IT
));

551 i(
NewS
 !
DISABLE
)

554 
I2Cx
->
CR2
 |
I2C_IT
;

559 
I2Cx
->
CR2
 &(
ut16_t
)~
I2C_IT
;

561 
	}
}

569 
	$I2C_SdDa
(
I2C_TyDef
* 
I2Cx
, 
ut8_t
 
Da
)

572 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

574 
I2Cx
->
DR
 = 
Da
;

575 
	}
}

582 
ut8_t
 
	$I2C_ReiveDa
(
I2C_TyDef
* 
I2Cx
)

585 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

587  (
ut8_t
)
I2Cx
->
DR
;

588 
	}
}

600 
	$I2C_Sd7bAddss
(
I2C_TyDef
* 
I2Cx
, 
ut8_t
 
Addss
, ut8_
I2C_Dei
)

603 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

604 
	`as_m
(
	`IS_I2C_DIRECTION
(
I2C_Dei
));

606 i(
I2C_Dei
 !
I2C_Dei_Tnsmr
)

609 
Addss
 |
OAR1_ADD0_S
;

614 
Addss
 &
OAR1_ADD0_Ret
;

617 
I2Cx
->
DR
 = 
Addss
;

618 
	}
}

635 
ut16_t
 
	$I2C_RdRegi
(
I2C_TyDef
* 
I2Cx
, 
ut8_t
 
I2C_Regi
)

637 
__IO
 
ut32_t
 
tmp
 = 0;

640 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

641 
	`as_m
(
	`IS_I2C_REGISTER
(
I2C_Regi
));

643 
tmp
 = (
ut32_t

I2Cx
;

644 
tmp
 +
I2C_Regi
;

647  (*(
__IO
 
ut16_t
 *
tmp
);

648 
	}
}

657 
	$I2C_SoweRetCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

660 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

661 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

662 i(
NewS
 !
DISABLE
)

665 
I2Cx
->
CR1
 |
CR1_SWRST_S
;

670 
I2Cx
->
CR1
 &
CR1_SWRST_Ret
;

672 
	}
}

683 
	$I2C_SMBusA˹Cfig
(
I2C_TyDef
* 
I2Cx
, 
ut16_t
 
I2C_SMBusA˹
)

686 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

687 
	`as_m
(
	`IS_I2C_SMBUS_ALERT
(
I2C_SMBusA˹
));

688 i(
I2C_SMBusA˹
 =
I2C_SMBusA˹_Low
)

691 
I2Cx
->
CR1
 |
I2C_SMBusA˹_Low
;

696 
I2Cx
->
CR1
 &
I2C_SMBusA˹_High
;

698 
	}
}

707 
	$I2C_TnsmPEC
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

710 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

711 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

712 i(
NewS
 !
DISABLE
)

715 
I2Cx
->
CR1
 |
CR1_PEC_S
;

720 
I2Cx
->
CR1
 &
CR1_PEC_Ret
;

722 
	}
}

733 
	$I2C_PECPosiCfig
(
I2C_TyDef
* 
I2Cx
, 
ut16_t
 
I2C_PECPosi
)

736 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

737 
	`as_m
(
	`IS_I2C_PEC_POSITION
(
I2C_PECPosi
));

738 i(
I2C_PECPosi
 =
I2C_PECPosi_Next
)

741 
I2Cx
->
CR1
 |
I2C_PECPosi_Next
;

746 
I2Cx
->
CR1
 &
I2C_PECPosi_Cut
;

748 
	}
}

757 
	$I2C_CcuϋPEC
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

760 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

761 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

762 i(
NewS
 !
DISABLE
)

765 
I2Cx
->
CR1
 |
CR1_ENPEC_S
;

770 
I2Cx
->
CR1
 &
CR1_ENPEC_Ret
;

772 
	}
}

779 
ut8_t
 
	$I2C_GPEC
(
I2C_TyDef
* 
I2Cx
)

782 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

784  ((
I2Cx
->
SR2
) >> 8);

785 
	}
}

794 
	$I2C_ARPCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

797 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

798 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

799 i(
NewS
 !
DISABLE
)

802 
I2Cx
->
CR1
 |
CR1_ENARP_S
;

807 
I2Cx
->
CR1
 &
CR1_ENARP_Ret
;

809 
	}
}

818 
	$I2C_SchClockCmd
(
I2C_TyDef
* 
I2Cx
, 
FuniڮS
 
NewS
)

821 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

822 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

823 i(
NewS
 =
DISABLE
)

826 
I2Cx
->
CR1
 |
CR1_NOSTRETCH_S
;

831 
I2Cx
->
CR1
 &
CR1_NOSTRETCH_Ret
;

833 
	}
}

844 
	$I2C_FaModeDutyCyeCfig
(
I2C_TyDef
* 
I2Cx
, 
ut16_t
 
I2C_DutyCye
)

847 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

848 
	`as_m
(
	`IS_I2C_DUTY_CYCLE
(
I2C_DutyCye
));

849 i(
I2C_DutyCye
 !
I2C_DutyCye_16_9
)

852 
I2Cx
->
CCR
 &
I2C_DutyCye_2
;

857 
I2Cx
->
CCR
 |
I2C_DutyCye_16_9
;

859 
	}
}

984 
EStus
 
	$I2C_CheckEvt
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_EVENT
)

986 
ut32_t
 
ϡevt
 = 0;

987 
ut32_t
 
ag1
 = 0, 
ag2
 = 0;

988 
EStus
 
us
 = 
ERROR
;

991 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

992 
	`as_m
(
	`IS_I2C_EVENT
(
I2C_EVENT
));

995 
ag1
 = 
I2Cx
->
SR1
;

996 
ag2
 = 
I2Cx
->
SR2
;

997 
ag2
 = flag2 << 16;

1000 
ϡevt
 = (
ag1
 | 
ag2
& 
FLAG_Mask
;

1003 i((
ϡevt
 & 
I2C_EVENT
) == I2C_EVENT)

1006 
us
 = 
SUCCESS
;

1011 
us
 = 
ERROR
;

1014  
us
;

1015 
	}
}

1032 
ut32_t
 
	$I2C_GLaEvt
(
I2C_TyDef
* 
I2Cx
)

1034 
ut32_t
 
ϡevt
 = 0;

1035 
ut32_t
 
ag1
 = 0, 
ag2
 = 0;

1038 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1041 
ag1
 = 
I2Cx
->
SR1
;

1042 
ag2
 = 
I2Cx
->
SR2
;

1043 
ag2
 = flag2 << 16;

1046 
ϡevt
 = (
ag1
 | 
ag2
& 
FLAG_Mask
;

1049  
ϡevt
;

1050 
	}
}

1087 
FgStus
 
	$I2C_GFgStus
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_FLAG
)

1089 
FgStus
 
bus
 = 
RESET
;

1090 
__IO
 
ut32_t
 
i2eg
 = 0, 
i2cxba
 = 0;

1093 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1094 
	`as_m
(
	`IS_I2C_GET_FLAG
(
I2C_FLAG
));

1097 
i2cxba
 = (
ut32_t
)
I2Cx
;

1100 
i2eg
 = 
I2C_FLAG
 >> 28;

1103 
I2C_FLAG
 &
FLAG_Mask
;

1105 if(
i2eg
 != 0)

1108 
i2cxba
 += 0x14;

1113 
I2C_FLAG
 = (
ut32_t
)(I2C_FLAG >> 16);

1115 
i2cxba
 += 0x18;

1118 if(((*(
__IO
 
ut32_t
 *)
i2cxba
& 
I2C_FLAG
!(ut32_t)
RESET
)

1121 
bus
 = 
SET
;

1126 
bus
 = 
RESET
;

1130  
bus
;

1131 
	}
}

1166 
	$I2C_CˬFg
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_FLAG
)

1168 
ut32_t
 
agpos
 = 0;

1170 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1171 
	`as_m
(
	`IS_I2C_CLEAR_FLAG
(
I2C_FLAG
));

1173 
agpos
 = 
I2C_FLAG
 & 
FLAG_Mask
;

1175 
I2Cx
->
SR1
 = (
ut16_t
)~
agpos
;

1176 
	}
}

1200 
ITStus
 
	$I2C_GITStus
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_IT
)

1202 
ITStus
 
bus
 = 
RESET
;

1203 
ut32_t
 
abˡus
 = 0;

1206 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1207 
	`as_m
(
	`IS_I2C_GET_IT
(
I2C_IT
));

1210 
abˡus
 = (
ut32_t
)(((
I2C_IT
 & 
ITEN_Mask
>> 16& (
I2Cx
->
CR2
)) ;

1213 
I2C_IT
 &
FLAG_Mask
;

1216 i(((
I2Cx
->
SR1
 & 
I2C_IT
!(
ut32_t
)
RESET
&& 
abˡus
)

1219 
bus
 = 
SET
;

1224 
bus
 = 
RESET
;

1227  
bus
;

1228 
	}
}

1261 
	$I2C_CˬITPdgB
(
I2C_TyDef
* 
I2Cx
, 
ut32_t
 
I2C_IT
)

1263 
ut32_t
 
agpos
 = 0;

1265 
	`as_m
(
	`IS_I2C_ALL_PERIPH
(
I2Cx
));

1266 
	`as_m
(
	`IS_I2C_CLEAR_IT
(
I2C_IT
));

1268 
agpos
 = 
I2C_IT
 & 
FLAG_Mask
;

1270 
I2Cx
->
SR1
 = (
ut16_t
)~
agpos
;

1271 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_iwdg.c

22 
	~"m32f10x_iwdg.h
"

48 
	#KR_KEY_Rd
 ((
ut16_t
)0xAAAA)

	)

49 
	#KR_KEY_Eb
 ((
ut16_t
)0xCCCC)

	)

91 
	$IWDG_WreAcssCmd
(
ut16_t
 
IWDG_WreAcss
)

94 
	`as_m
(
	`IS_IWDG_WRITE_ACCESS
(
IWDG_WreAcss
));

95 
IWDG
->
KR
 = 
IWDG_WreAcss
;

96 
	}
}

111 
	$IWDG_SPsr
(
ut8_t
 
IWDG_Psr
)

114 
	`as_m
(
	`IS_IWDG_PRESCALER
(
IWDG_Psr
));

115 
IWDG
->
PR
 = 
IWDG_Psr
;

116 
	}
}

124 
	$IWDG_SRd
(
ut16_t
 
Rd
)

127 
	`as_m
(
	`IS_IWDG_RELOAD
(
Rd
));

128 
IWDG
->
RLR
 = 
Rd
;

129 
	}
}

137 
	$IWDG_RdCou
()

139 
IWDG
->
KR
 = 
KR_KEY_Rd
;

140 
	}
}

147 
	$IWDG_Eb
()

149 
IWDG
->
KR
 = 
KR_KEY_Eb
;

150 
	}
}

160 
FgStus
 
	$IWDG_GFgStus
(
ut16_t
 
IWDG_FLAG
)

162 
FgStus
 
bus
 = 
RESET
;

164 
	`as_m
(
	`IS_IWDG_FLAG
(
IWDG_FLAG
));

165 i((
IWDG
->
SR
 & 
IWDG_FLAG
!(
ut32_t
)
RESET
)

167 
bus
 = 
SET
;

171 
bus
 = 
RESET
;

174  
bus
;

175 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_misc.c

23 
	~"m32f10x_misc.h
"

46 
	#AIRCR_VECTKEY_MASK
 ((
ut32_t
)0x05FA0000)

	)

95 
	$NVIC_PriܙyGroupCfig
(
ut32_t
 
NVIC_PriܙyGroup
)

98 
	`as_m
(
	`IS_NVIC_PRIORITY_GROUP
(
NVIC_PriܙyGroup
));

101 
SCB
->
AIRCR
 = 
AIRCR_VECTKEY_MASK
 | 
NVIC_PriܙyGroup
;

102 
	}
}

111 
	$NVIC_In
(
NVIC_InTyDef
* 
NVIC_InSu
)

113 
ut32_t
 
tmriܙy
 = 0x00, 
tm
 = 0x00, 
tmpsub
 = 0x0F;

116 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NVIC_InSu
->
NVIC_IRQChlCmd
));

117 
	`as_m
(
	`IS_NVIC_PREEMPTION_PRIORITY
(
NVIC_InSu
->
NVIC_IRQChlPemiPriܙy
));

118 
	`as_m
(
	`IS_NVIC_SUB_PRIORITY
(
NVIC_InSu
->
NVIC_IRQChlSubPriܙy
));

120 i(
NVIC_InSu
->
NVIC_IRQChlCmd
 !
DISABLE
)

123 
tmriܙy
 = (0x700 - ((
SCB
->
AIRCR
& (
ut32_t
)0x700))>> 0x08;

124 
tm
 = (0x4 - 
tmriܙy
);

125 
tmpsub
 =mpsub >> 
tmriܙy
;

127 
tmriܙy
 = (
ut32_t
)
NVIC_InSu
->
NVIC_IRQChlPemiPriܙy
 << 
tm
;

128 
tmriܙy
 |
NVIC_InSu
->
NVIC_IRQChlSubPriܙy
 & 
tmpsub
;

129 
tmriܙy
 =mppriority << 0x04;

131 
NVIC
->
IP
[
NVIC_InSu
->
NVIC_IRQChl
] = 
tmriܙy
;

134 
NVIC
->
ISER
[
NVIC_InSu
->
NVIC_IRQChl
 >> 0x05] =

135 (
ut32_t
)0x01 << (
NVIC_InSu
->
NVIC_IRQChl
 & (
ut8_t
)0x1F);

140 
NVIC
->
ICER
[
NVIC_InSu
->
NVIC_IRQChl
 >> 0x05] =

141 (
ut32_t
)0x01 << (
NVIC_InSu
->
NVIC_IRQChl
 & (
ut8_t
)0x1F);

143 
	}
}

154 
	$NVIC_SVeTab
(
ut32_t
 
NVIC_VeTab
, ut32_
Offt
)

157 
	`as_m
(
	`IS_NVIC_VECTTAB
(
NVIC_VeTab
));

158 
	`as_m
(
	`IS_NVIC_OFFSET
(
Offt
));

160 
SCB
->
VTOR
 = 
NVIC_VeTab
 | (
Offt
 & (
ut32_t
)0x1FFFFF80);

161 
	}
}

173 
	$NVIC_SyemLPCfig
(
ut8_t
 
LowPowMode
, 
FuniڮS
 
NewS
)

176 
	`as_m
(
	`IS_NVIC_LP
(
LowPowMode
));

177 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

179 i(
NewS
 !
DISABLE
)

181 
SCB
->
SCR
 |
LowPowMode
;

185 
SCB
->
SCR
 &(
ut32_t
)(~(ut32_t)
LowPowMode
);

187 
	}
}

197 
	$SysTick_CLKSourCfig
(
ut32_t
 
SysTick_CLKSour
)

200 
	`as_m
(
	`IS_SYSTICK_CLK_SOURCE
(
SysTick_CLKSour
));

201 i(
SysTick_CLKSour
 =
SysTick_CLKSour_HCLK
)

203 
SysTick
->
CTRL
 |
SysTick_CLKSour_HCLK
;

207 
SysTick
->
CTRL
 &
SysTick_CLKSour_HCLK_Div8
;

209 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_pwr.c

22 
	~"m32f10x_pwr.h
"

23 
	~"m32f10x_rcc.h
"

47 
	#PWR_OFFSET
 (
PWR_BASE
 - 
PERIPH_BASE
)

	)

52 
	#CR_OFFSET
 (
PWR_OFFSET
 + 0x00)

	)

53 
	#DBP_BNumb
 0x08

	)

54 
	#CR_DBP_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32+ (
DBP_BNumb
 * 4))

	)

57 
	#PVDE_BNumb
 0x04

	)

58 
	#CR_PVDE_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32+ (
PVDE_BNumb
 * 4))

	)

63 
	#CSR_OFFSET
 (
PWR_OFFSET
 + 0x04)

	)

64 
	#EWUP_BNumb
 0x08

	)

65 
	#CSR_EWUP_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32+ (
EWUP_BNumb
 * 4))

	)

70 
	#CR_DS_MASK
 ((
ut32_t
)0xFFFFFFFC)

	)

71 
	#CR_PLS_MASK
 ((
ut32_t
)0xFFFFFF1F)

	)

111 
	$PWR_DeIn
()

113 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_PWR
, 
ENABLE
);

114 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_PWR
, 
DISABLE
);

115 
	}
}

123 
	$PWR_BackupAcssCmd
(
FuniڮS
 
NewS
)

126 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

127 *(
__IO
 
ut32_t
 *
CR_DBP_BB
 = (ut32_t)
NewS
;

128 
	}
}

136 
	$PWR_PVDCmd
(
FuniڮS
 
NewS
)

139 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

140 *(
__IO
 
ut32_t
 *
CR_PVDE_BB
 = (ut32_t)
NewS
;

141 
	}
}

157 
	$PWR_PVDLevCfig
(
ut32_t
 
PWR_PVDLev
)

159 
ut32_t
 
tmeg
 = 0;

161 
	`as_m
(
	`IS_PWR_PVD_LEVEL
(
PWR_PVDLev
));

162 
tmeg
 = 
PWR
->
CR
;

164 
tmeg
 &
CR_PLS_MASK
;

166 
tmeg
 |
PWR_PVDLev
;

168 
PWR
->
CR
 = 
tmeg
;

169 
	}
}

177 
	$PWR_WakeUpPCmd
(
FuniڮS
 
NewS
)

180 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

181 *(
__IO
 
ut32_t
 *
CSR_EWUP_BB
 = (ut32_t)
NewS
;

182 
	}
}

196 
	$PWR_ESTOPMode
(
ut32_t
 
PWR_Regut
, 
ut8_t
 
PWR_STOPEry
)

198 
ut32_t
 
tmeg
 = 0;

200 
	`as_m
(
	`IS_PWR_REGULATOR
(
PWR_Regut
));

201 
	`as_m
(
	`IS_PWR_STOP_ENTRY
(
PWR_STOPEry
));

204 
tmeg
 = 
PWR
->
CR
;

206 
tmeg
 &
CR_DS_MASK
;

208 
tmeg
 |
PWR_Regut
;

210 
PWR
->
CR
 = 
tmeg
;

212 
SCB
->
SCR
 |
SCB_SCR_SLEEPDEEP
;

215 if(
PWR_STOPEry
 =
PWR_STOPEry_WFI
)

218 
	`__WFI
();

223 
	`__WFE
();

227 
SCB
->
SCR
 &(
ut32_t
)~((ut32_t)
SCB_SCR_SLEEPDEEP
);

228 
	}
}

235 
	$PWR_ESTANDBYMode
()

238 
PWR
->
CR
 |
PWR_CR_CWUF
;

240 
PWR
->
CR
 |
PWR_CR_PDDS
;

242 
SCB
->
SCR
 |
SCB_SCR_SLEEPDEEP
;

244 #i
	`defed
 ( 
__CC_ARM
 )

245 
	`__f_es
();

248 
	`__WFI
();

249 
	}
}

260 
FgStus
 
	$PWR_GFgStus
(
ut32_t
 
PWR_FLAG
)

262 
FgStus
 
bus
 = 
RESET
;

264 
	`as_m
(
	`IS_PWR_GET_FLAG
(
PWR_FLAG
));

266 i((
PWR
->
CSR
 & 
PWR_FLAG
!(
ut32_t
)
RESET
)

268 
bus
 = 
SET
;

272 
bus
 = 
RESET
;

275  
bus
;

276 
	}
}

286 
	$PWR_CˬFg
(
ut32_t
 
PWR_FLAG
)

289 
	`as_m
(
	`IS_PWR_CLEAR_FLAG
(
PWR_FLAG
));

291 
PWR
->
CR
 |
PWR_FLAG
 << 2;

292 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_rcc.c

22 
	~"m32f10x_rcc.h
"

46 
	#RCC_OFFSET
 (
RCC_BASE
 - 
PERIPH_BASE
)

	)

51 
	#CR_OFFSET
 (
RCC_OFFSET
 + 0x00)

	)

52 
	#HSION_BNumb
 0x00

	)

53 
	#CR_HSION_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32+ (
HSION_BNumb
 * 4))

	)

56 
	#PLLON_BNumb
 0x18

	)

57 
	#CR_PLLON_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32+ (
PLLON_BNumb
 * 4))

	)

59 #ifde
STM32F10X_CL


61 
	#PLL2ON_BNumb
 0x1A

	)

62 
	#CR_PLL2ON_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32+ (
PLL2ON_BNumb
 * 4))

	)

65 
	#PLL3ON_BNumb
 0x1C

	)

66 
	#CR_PLL3ON_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32+ (
PLL3ON_BNumb
 * 4))

	)

70 
	#CSSON_BNumb
 0x13

	)

71 
	#CR_CSSON_BB
 (
PERIPH_BB_BASE
 + (
CR_OFFSET
 * 32+ (
CSSON_BNumb
 * 4))

	)

76 
	#CFGR_OFFSET
 (
RCC_OFFSET
 + 0x04)

	)

78 #ide
STM32F10X_CL


79 
	#USBPRE_BNumb
 0x16

	)

80 
	#CFGR_USBPRE_BB
 (
PERIPH_BB_BASE
 + (
CFGR_OFFSET
 * 32+ (
USBPRE_BNumb
 * 4))

	)

82 
	#OTGFSPRE_BNumb
 0x16

	)

83 
	#CFGR_OTGFSPRE_BB
 (
PERIPH_BB_BASE
 + (
CFGR_OFFSET
 * 32+ (
OTGFSPRE_BNumb
 * 4))

	)

89 
	#BDCR_OFFSET
 (
RCC_OFFSET
 + 0x20)

	)

90 
	#RTCEN_BNumb
 0x0F

	)

91 
	#BDCR_RTCEN_BB
 (
PERIPH_BB_BASE
 + (
BDCR_OFFSET
 * 32+ (
RTCEN_BNumb
 * 4))

	)

94 
	#BDRST_BNumb
 0x10

	)

95 
	#BDCR_BDRST_BB
 (
PERIPH_BB_BASE
 + (
BDCR_OFFSET
 * 32+ (
BDRST_BNumb
 * 4))

	)

100 
	#CSR_OFFSET
 (
RCC_OFFSET
 + 0x24)

	)

101 
	#LSION_BNumb
 0x00

	)

102 
	#CSR_LSION_BB
 (
PERIPH_BB_BASE
 + (
CSR_OFFSET
 * 32+ (
LSION_BNumb
 * 4))

	)

104 #ifde
STM32F10X_CL


108 
	#CFGR2_OFFSET
 (
RCC_OFFSET
 + 0x2C)

	)

109 
	#I2S2SRC_BNumb
 0x11

	)

110 
	#CFGR2_I2S2SRC_BB
 (
PERIPH_BB_BASE
 + (
CFGR2_OFFSET
 * 32+ (
I2S2SRC_BNumb
 * 4))

	)

113 
	#I2S3SRC_BNumb
 0x12

	)

114 
	#CFGR2_I2S3SRC_BB
 (
PERIPH_BB_BASE
 + (
CFGR2_OFFSET
 * 32+ (
I2S3SRC_BNumb
 * 4))

	)

120 
	#CR_HSEBYP_Ret
 ((
ut32_t
)0xFFFBFFFF)

	)

121 
	#CR_HSEBYP_S
 ((
ut32_t
)0x00040000)

	)

122 
	#CR_HSEON_Ret
 ((
ut32_t
)0xFFFEFFFF)

	)

123 
	#CR_HSEON_S
 ((
ut32_t
)0x00010000)

	)

124 
	#CR_HSITRIM_Mask
 ((
ut32_t
)0xFFFFFF07)

	)

127 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
|| defed (
STM32F10X_CL
)

128 
	#CFGR_PLL_Mask
 ((
ut32_t
)0xFFC2FFFF)

	)

130 
	#CFGR_PLL_Mask
 ((
ut32_t
)0xFFC0FFFF)

	)

133 
	#CFGR_PLLMu_Mask
 ((
ut32_t
)0x003C0000)

	)

134 
	#CFGR_PLLSRC_Mask
 ((
ut32_t
)0x00010000)

	)

135 
	#CFGR_PLLXTPRE_Mask
 ((
ut32_t
)0x00020000)

	)

136 
	#CFGR_SWS_Mask
 ((
ut32_t
)0x0000000C)

	)

137 
	#CFGR_SW_Mask
 ((
ut32_t
)0xFFFFFFFC)

	)

138 
	#CFGR_HPRE_Ret_Mask
 ((
ut32_t
)0xFFFFFF0F)

	)

139 
	#CFGR_HPRE_S_Mask
 ((
ut32_t
)0x000000F0)

	)

140 
	#CFGR_PPRE1_Ret_Mask
 ((
ut32_t
)0xFFFFF8FF)

	)

141 
	#CFGR_PPRE1_S_Mask
 ((
ut32_t
)0x00000700)

	)

142 
	#CFGR_PPRE2_Ret_Mask
 ((
ut32_t
)0xFFFFC7FF)

	)

143 
	#CFGR_PPRE2_S_Mask
 ((
ut32_t
)0x00003800)

	)

144 
	#CFGR_ADCPRE_Ret_Mask
 ((
ut32_t
)0xFFFF3FFF)

	)

145 
	#CFGR_ADCPRE_S_Mask
 ((
ut32_t
)0x0000C000)

	)

148 
	#CSR_RMVF_S
 ((
ut32_t
)0x01000000)

	)

150 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
|| defed (
STM32F10X_CL
)

152 
	#CFGR2_PREDIV1SRC
 ((
ut32_t
)0x00010000)

	)

153 
	#CFGR2_PREDIV1
 ((
ut32_t
)0x0000000F)

	)

155 #ifde
STM32F10X_CL


156 
	#CFGR2_PREDIV2
 ((
ut32_t
)0x000000F0)

	)

157 
	#CFGR2_PLL2MUL
 ((
ut32_t
)0x00000F00)

	)

158 
	#CFGR2_PLL3MUL
 ((
ut32_t
)0x0000F000)

	)

162 
	#FLAG_Mask
 ((
ut8_t
)0x1F)

	)

165 
	#CIR_BYTE2_ADDRESS
 ((
ut32_t
)0x40021009)

	)

168 
	#CIR_BYTE3_ADDRESS
 ((
ut32_t
)0x4002100A)

	)

171 
	#CFGR_BYTE4_ADDRESS
 ((
ut32_t
)0x40021007)

	)

174 
	#BDCR_ADDRESS
 (
PERIPH_BASE
 + 
BDCR_OFFSET
)

	)

192 
__I
 
ut8_t
 
	gAPBAHBPscTab
[16] = {0, 0, 0, 0, 1, 2, 3, 4, 1, 2, 3, 4, 6, 7, 8, 9};

193 
__I
 
ut8_t
 
	gADCPscTab
[4] = {2, 4, 6, 8};

216 
	$RCC_DeIn
()

219 
RCC
->
CR
 |(
ut32_t
)0x00000001;

222 #ide
STM32F10X_CL


223 
RCC
->
CFGR
 &(
ut32_t
)0xF8FF0000;

225 
RCC
->
CFGR
 &(
ut32_t
)0xF0FF0000;

229 
RCC
->
CR
 &(
ut32_t
)0xFEF6FFFF;

232 
RCC
->
CR
 &(
ut32_t
)0xFFFBFFFF;

235 
RCC
->
CFGR
 &(
ut32_t
)0xFF80FFFF;

237 #ifde
STM32F10X_CL


239 
RCC
->
CR
 &(
ut32_t
)0xEBFFFFFF;

242 
RCC
->
CIR
 = 0x00FF0000;

245 
RCC
->
CFGR2
 = 0x00000000;

246 #i
	`defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

248 
RCC
->
CIR
 = 0x009F0000;

251 
RCC
->
CFGR2
 = 0x00000000;

254 
RCC
->
CIR
 = 0x009F0000;

257 
	}
}

269 
	$RCC_HSECfig
(
ut32_t
 
RCC_HSE
)

272 
	`as_m
(
	`IS_RCC_HSE
(
RCC_HSE
));

275 
RCC
->
CR
 &
CR_HSEON_Ret
;

277 
RCC
->
CR
 &
CR_HSEBYP_Ret
;

279 
RCC_HSE
)

281 
RCC_HSE_ON
:

283 
RCC
->
CR
 |
CR_HSEON_S
;

286 
RCC_HSE_Byss
:

288 
RCC
->
CR
 |
CR_HSEBYP_S
 | 
CR_HSEON_S
;

294 
	}
}

303 
EStus
 
	$RCC_WaFHSESUp
()

305 
__IO
 
ut32_t
 
SUpCou
 = 0;

306 
EStus
 
us
 = 
ERROR
;

307 
FgStus
 
HSEStus
 = 
RESET
;

312 
HSEStus
 = 
	`RCC_GFgStus
(
RCC_FLAG_HSERDY
);

313 
SUpCou
++;

314 } (
SUpCou
 !
HSE_STARTUP_TIMEOUT
&& (
HSEStus
 =
RESET
));

316 i(
	`RCC_GFgStus
(
RCC_FLAG_HSERDY
!
RESET
)

318 
us
 = 
SUCCESS
;

322 
us
 = 
ERROR
;

324  (
us
);

325 
	}
}

333 
	$RCC_AdjuHSICibtiVue
(
ut8_t
 
HSICibtiVue
)

335 
ut32_t
 
tmeg
 = 0;

337 
	`as_m
(
	`IS_RCC_CALIBRATION_VALUE
(
HSICibtiVue
));

338 
tmeg
 = 
RCC
->
CR
;

340 
tmeg
 &
CR_HSITRIM_Mask
;

342 
tmeg
 |(
ut32_t
)
HSICibtiVue
 << 3;

344 
RCC
->
CR
 = 
tmeg
;

345 
	}
}

353 
	$RCC_HSICmd
(
FuniڮS
 
NewS
)

356 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

357 *(
__IO
 
ut32_t
 *
CR_HSION_BB
 = (ut32_t)
NewS
;

358 
	}
}

377 
	$RCC_PLLCfig
(
ut32_t
 
RCC_PLLSour
, ut32_
RCC_PLLMul
)

379 
ut32_t
 
tmeg
 = 0;

382 
	`as_m
(
	`IS_RCC_PLL_SOURCE
(
RCC_PLLSour
));

383 
	`as_m
(
	`IS_RCC_PLL_MUL
(
RCC_PLLMul
));

385 
tmeg
 = 
RCC
->
CFGR
;

387 
tmeg
 &
CFGR_PLL_Mask
;

389 
tmeg
 |
RCC_PLLSour
 | 
RCC_PLLMul
;

391 
RCC
->
CFGR
 = 
tmeg
;

392 
	}
}

400 
	$RCC_PLLCmd
(
FuniڮS
 
NewS
)

403 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

405 *(
__IO
 
ut32_t
 *
CR_PLLON_BB
 = (ut32_t)
NewS
;

406 
	}
}

408 #i
defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
|| defed (
STM32F10X_CL
)

425 
	$RCC_PREDIV1Cfig
(
ut32_t
 
RCC_PREDIV1_Sour
, ut32_
RCC_PREDIV1_Div
)

427 
ut32_t
 
tmeg
 = 0;

430 
	`as_m
(
	`IS_RCC_PREDIV1_SOURCE
(
RCC_PREDIV1_Sour
));

431 
	`as_m
(
	`IS_RCC_PREDIV1
(
RCC_PREDIV1_Div
));

433 
tmeg
 = 
RCC
->
CFGR2
;

435 
tmeg
 &~(
CFGR2_PREDIV1
 | 
CFGR2_PREDIV1SRC
);

437 
tmeg
 |
RCC_PREDIV1_Sour
 | 
RCC_PREDIV1_Div
 ;

439 
RCC
->
CFGR2
 = 
tmeg
;

440 
	}
}

443 #ifde
STM32F10X_CL


453 
	$RCC_PREDIV2Cfig
(
ut32_t
 
RCC_PREDIV2_Div
)

455 
ut32_t
 
tmeg
 = 0;

458 
	`as_m
(
	`IS_RCC_PREDIV2
(
RCC_PREDIV2_Div
));

460 
tmeg
 = 
RCC
->
CFGR2
;

462 
tmeg
 &~
CFGR2_PREDIV2
;

464 
tmeg
 |
RCC_PREDIV2_Div
;

466 
RCC
->
CFGR2
 = 
tmeg
;

467 
	}
}

478 
	$RCC_PLL2Cfig
(
ut32_t
 
RCC_PLL2Mul
)

480 
ut32_t
 
tmeg
 = 0;

483 
	`as_m
(
	`IS_RCC_PLL2_MUL
(
RCC_PLL2Mul
));

485 
tmeg
 = 
RCC
->
CFGR2
;

487 
tmeg
 &~
CFGR2_PLL2MUL
;

489 
tmeg
 |
RCC_PLL2Mul
;

491 
RCC
->
CFGR2
 = 
tmeg
;

492 
	}
}

504 
	$RCC_PLL2Cmd
(
FuniڮS
 
NewS
)

507 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

509 *(
__IO
 
ut32_t
 *
CR_PLL2ON_BB
 = (ut32_t)
NewS
;

510 
	}
}

522 
	$RCC_PLL3Cfig
(
ut32_t
 
RCC_PLL3Mul
)

524 
ut32_t
 
tmeg
 = 0;

527 
	`as_m
(
	`IS_RCC_PLL3_MUL
(
RCC_PLL3Mul
));

529 
tmeg
 = 
RCC
->
CFGR2
;

531 
tmeg
 &~
CFGR2_PLL3MUL
;

533 
tmeg
 |
RCC_PLL3Mul
;

535 
RCC
->
CFGR2
 = 
tmeg
;

536 
	}
}

545 
	$RCC_PLL3Cmd
(
FuniڮS
 
NewS
)

549 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

550 *(
__IO
 
ut32_t
 *
CR_PLL3ON_BB
 = (ut32_t)
NewS
;

551 
	}
}

563 
	$RCC_SYSCLKCfig
(
ut32_t
 
RCC_SYSCLKSour
)

565 
ut32_t
 
tmeg
 = 0;

567 
	`as_m
(
	`IS_RCC_SYSCLK_SOURCE
(
RCC_SYSCLKSour
));

568 
tmeg
 = 
RCC
->
CFGR
;

570 
tmeg
 &
CFGR_SW_Mask
;

572 
tmeg
 |
RCC_SYSCLKSour
;

574 
RCC
->
CFGR
 = 
tmeg
;

575 
	}
}

586 
ut8_t
 
	$RCC_GSYSCLKSour
()

588  ((
ut8_t
)(
RCC
->
CFGR
 & 
CFGR_SWS_Mask
));

589 
	}
}

607 
	$RCC_HCLKCfig
(
ut32_t
 
RCC_SYSCLK
)

609 
ut32_t
 
tmeg
 = 0;

611 
	`as_m
(
	`IS_RCC_HCLK
(
RCC_SYSCLK
));

612 
tmeg
 = 
RCC
->
CFGR
;

614 
tmeg
 &
CFGR_HPRE_Ret_Mask
;

616 
tmeg
 |
RCC_SYSCLK
;

618 
RCC
->
CFGR
 = 
tmeg
;

619 
	}
}

633 
	$RCC_PCLK1Cfig
(
ut32_t
 
RCC_HCLK
)

635 
ut32_t
 
tmeg
 = 0;

637 
	`as_m
(
	`IS_RCC_PCLK
(
RCC_HCLK
));

638 
tmeg
 = 
RCC
->
CFGR
;

640 
tmeg
 &
CFGR_PPRE1_Ret_Mask
;

642 
tmeg
 |
RCC_HCLK
;

644 
RCC
->
CFGR
 = 
tmeg
;

645 
	}
}

659 
	$RCC_PCLK2Cfig
(
ut32_t
 
RCC_HCLK
)

661 
ut32_t
 
tmeg
 = 0;

663 
	`as_m
(
	`IS_RCC_PCLK
(
RCC_HCLK
));

664 
tmeg
 = 
RCC
->
CFGR
;

666 
tmeg
 &
CFGR_PPRE2_Ret_Mask
;

668 
tmeg
 |
RCC_HCLK
 << 3;

670 
RCC
->
CFGR
 = 
tmeg
;

671 
	}
}

699 
	$RCC_ITCfig
(
ut8_t
 
RCC_IT
, 
FuniڮS
 
NewS
)

702 
	`as_m
(
	`IS_RCC_IT
(
RCC_IT
));

703 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

704 i(
NewS
 !
DISABLE
)

707 *(
__IO
 
ut8_t
 *
CIR_BYTE2_ADDRESS
 |
RCC_IT
;

712 *(
__IO
 
ut8_t
 *
CIR_BYTE2_ADDRESS
 &(ut8_t)~
RCC_IT
;

714 
	}
}

716 #ide
STM32F10X_CL


727 
	$RCC_USBCLKCfig
(
ut32_t
 
RCC_USBCLKSour
)

730 
	`as_m
(
	`IS_RCC_USBCLK_SOURCE
(
RCC_USBCLKSour
));

732 *(
__IO
 
ut32_t
 *
CFGR_USBPRE_BB
 = 
RCC_USBCLKSour
;

733 
	}
}

745 
	$RCC_OTGFSCLKCfig
(
ut32_t
 
RCC_OTGFSCLKSour
)

748 
	`as_m
(
	`IS_RCC_OTGFSCLK_SOURCE
(
RCC_OTGFSCLKSour
));

750 *(
__IO
 
ut32_t
 *
CFGR_OTGFSPRE_BB
 = 
RCC_OTGFSCLKSour
;

751 
	}
}

765 
	$RCC_ADCCLKCfig
(
ut32_t
 
RCC_PCLK2
)

767 
ut32_t
 
tmeg
 = 0;

769 
	`as_m
(
	`IS_RCC_ADCCLK
(
RCC_PCLK2
));

770 
tmeg
 = 
RCC
->
CFGR
;

772 
tmeg
 &
CFGR_ADCPRE_Ret_Mask
;

774 
tmeg
 |
RCC_PCLK2
;

776 
RCC
->
CFGR
 = 
tmeg
;

777 
	}
}

779 #ifde
STM32F10X_CL


791 
	$RCC_I2S2CLKCfig
(
ut32_t
 
RCC_I2S2CLKSour
)

794 
	`as_m
(
	`IS_RCC_I2S2CLK_SOURCE
(
RCC_I2S2CLKSour
));

796 *(
__IO
 
ut32_t
 *
CFGR2_I2S2SRC_BB
 = 
RCC_I2S2CLKSour
;

797 
	}
}

810 
	$RCC_I2S3CLKCfig
(
ut32_t
 
RCC_I2S3CLKSour
)

813 
	`as_m
(
	`IS_RCC_I2S3CLK_SOURCE
(
RCC_I2S3CLKSour
));

815 *(
__IO
 
ut32_t
 *
CFGR2_I2S3SRC_BB
 = 
RCC_I2S3CLKSour
;

816 
	}
}

828 
	$RCC_LSECfig
(
ut8_t
 
RCC_LSE
)

831 
	`as_m
(
	`IS_RCC_LSE
(
RCC_LSE
));

834 *(
__IO
 
ut8_t
 *
BDCR_ADDRESS
 = 
RCC_LSE_OFF
;

836 *(
__IO
 
ut8_t
 *
BDCR_ADDRESS
 = 
RCC_LSE_OFF
;

838 
RCC_LSE
)

840 
RCC_LSE_ON
:

842 *(
__IO
 
ut8_t
 *
BDCR_ADDRESS
 = 
RCC_LSE_ON
;

845 
RCC_LSE_Byss
:

847 *(
__IO
 
ut8_t
 *
BDCR_ADDRESS
 = 
RCC_LSE_Byss
 | 
RCC_LSE_ON
;

853 
	}
}

861 
	$RCC_LSICmd
(
FuniڮS
 
NewS
)

864 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

865 *(
__IO
 
ut32_t
 *
CSR_LSION_BB
 = (ut32_t)
NewS
;

866 
	}
}

878 
	$RCC_RTCCLKCfig
(
ut32_t
 
RCC_RTCCLKSour
)

881 
	`as_m
(
	`IS_RCC_RTCCLK_SOURCE
(
RCC_RTCCLKSour
));

883 
RCC
->
BDCR
 |
RCC_RTCCLKSour
;

884 
	}
}

892 
	$RCC_RTCCLKCmd
(
FuniڮS
 
NewS
)

895 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

896 *(
__IO
 
ut32_t
 *
BDCR_RTCEN_BB
 = (ut32_t)
NewS
;

897 
	}
}

907 
	$RCC_GClocksFq
(
RCC_ClocksTyDef
* 
RCC_Clocks
)

909 
ut32_t
 
tmp
 = 0, 
lmu
 = 0, 
lsour
 = 0, 
esc
 = 0;

911 #ifde 
STM32F10X_CL


912 
ut32_t
 
ediv1sour
 = 0, 
ediv1
 = 0, 
ediv2
 = 0, 
l2mu
 = 0;

915 #i
	`defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

916 
ut32_t
 
ediv1
 = 0;

920 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_SWS_Mask
;

922 
tmp
)

925 
RCC_Clocks
->
SYSCLK_Fqucy
 = 
HSI_VALUE
;

928 
RCC_Clocks
->
SYSCLK_Fqucy
 = 
HSE_VALUE
;

933 
lmu
 = 
RCC
->
CFGR
 & 
CFGR_PLLMu_Mask
;

934 
lsour
 = 
RCC
->
CFGR
 & 
CFGR_PLLSRC_Mask
;

936 #ide
STM32F10X_CL


937 
lmu
 = (llmull >> 18) + 2;

939 i(
lsour
 == 0x00)

941 
RCC_Clocks
->
SYSCLK_Fqucy
 = (
HSI_VALUE
 >> 1* 
lmu
;

945 #i
	`defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

946 
ediv1
 = (
RCC
->
CFGR2
 & 
CFGR2_PREDIV1
) + 1;

948 
RCC_Clocks
->
SYSCLK_Fqucy
 = (
HSE_VALUE
 / 
ediv1
* 
lmu
;

951 i((
RCC
->
CFGR
 & 
CFGR_PLLXTPRE_Mask
!(
ut32_t
)
RESET
)

953 
RCC_Clocks
->
SYSCLK_Fqucy
 = (
HSE_VALUE
 >> 1* 
lmu
;

957 
RCC_Clocks
->
SYSCLK_Fqucy
 = 
HSE_VALUE
 * 
lmu
;

962 
lmu
 =llmull >> 18;

964 i(
lmu
 != 0x0D)

966 
lmu
 += 2;

970 
lmu
 = 13 / 2;

973 i(
lsour
 == 0x00)

975 
RCC_Clocks
->
SYSCLK_Fqucy
 = (
HSI_VALUE
 >> 1* 
lmu
;

981 
ediv1sour
 = 
RCC
->
CFGR2
 & 
CFGR2_PREDIV1SRC
;

982 
ediv1
 = (
RCC
->
CFGR2
 & 
CFGR2_PREDIV1
) + 1;

984 i(
ediv1sour
 == 0)

986 
RCC_Clocks
->
SYSCLK_Fqucy
 = (
HSE_VALUE
 / 
ediv1
* 
lmu
;

992 
ediv2
 = ((
RCC
->
CFGR2
 & 
CFGR2_PREDIV2
) >> 4) + 1;

993 
l2mu
 = ((
RCC
->
CFGR2
 & 
CFGR2_PLL2MUL
) >> 8 ) + 2;

994 
RCC_Clocks
->
SYSCLK_Fqucy
 = (((
HSE_VALUE
 / 
ediv2
* 
l2mu
/ 
ediv1
* 
lmu
;

1001 
RCC_Clocks
->
SYSCLK_Fqucy
 = 
HSI_VALUE
;

1007 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_HPRE_S_Mask
;

1008 
tmp
 =mp >> 4;

1009 
esc
 = 
APBAHBPscTab
[
tmp
];

1011 
RCC_Clocks
->
HCLK_Fqucy
 = RCC_Clocks->
SYSCLK_Fqucy
 >> 
esc
;

1013 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_PPRE1_S_Mask
;

1014 
tmp
 =mp >> 8;

1015 
esc
 = 
APBAHBPscTab
[
tmp
];

1017 
RCC_Clocks
->
PCLK1_Fqucy
 = RCC_Clocks->
HCLK_Fqucy
 >> 
esc
;

1019 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_PPRE2_S_Mask
;

1020 
tmp
 =mp >> 11;

1021 
esc
 = 
APBAHBPscTab
[
tmp
];

1023 
RCC_Clocks
->
PCLK2_Fqucy
 = RCC_Clocks->
HCLK_Fqucy
 >> 
esc
;

1025 
tmp
 = 
RCC
->
CFGR
 & 
CFGR_ADCPRE_S_Mask
;

1026 
tmp
 =mp >> 14;

1027 
esc
 = 
ADCPscTab
[
tmp
];

1029 
RCC_Clocks
->
ADCCLK_Fqucy
 = RCC_Clocks->
PCLK2_Fqucy
 / 
esc
;

1030 
	}
}

1063 
	$RCC_AHBPhClockCmd
(
ut32_t
 
RCC_AHBPh
, 
FuniڮS
 
NewS
)

1066 
	`as_m
(
	`IS_RCC_AHB_PERIPH
(
RCC_AHBPh
));

1067 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1069 i(
NewS
 !
DISABLE
)

1071 
RCC
->
AHBENR
 |
RCC_AHBPh
;

1075 
RCC
->
AHBENR
 &~
RCC_AHBPh
;

1077 
	}
}

1094 
	$RCC_APB2PhClockCmd
(
ut32_t
 
RCC_APB2Ph
, 
FuniڮS
 
NewS
)

1097 
	`as_m
(
	`IS_RCC_APB2_PERIPH
(
RCC_APB2Ph
));

1098 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1099 i(
NewS
 !
DISABLE
)

1101 
RCC
->
APB2ENR
 |
RCC_APB2Ph
;

1105 
RCC
->
APB2ENR
 &~
RCC_APB2Ph
;

1107 
	}
}

1125 
	$RCC_APB1PhClockCmd
(
ut32_t
 
RCC_APB1Ph
, 
FuniڮS
 
NewS
)

1128 
	`as_m
(
	`IS_RCC_APB1_PERIPH
(
RCC_APB1Ph
));

1129 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1130 i(
NewS
 !
DISABLE
)

1132 
RCC
->
APB1ENR
 |
RCC_APB1Ph
;

1136 
RCC
->
APB1ENR
 &~
RCC_APB1Ph
;

1138 
	}
}

1140 #ifde
STM32F10X_CL


1152 
	$RCC_AHBPhRetCmd
(
ut32_t
 
RCC_AHBPh
, 
FuniڮS
 
NewS
)

1155 
	`as_m
(
	`IS_RCC_AHB_PERIPH_RESET
(
RCC_AHBPh
));

1156 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1158 i(
NewS
 !
DISABLE
)

1160 
RCC
->
AHBRSTR
 |
RCC_AHBPh
;

1164 
RCC
->
AHBRSTR
 &~
RCC_AHBPh
;

1166 
	}
}

1184 
	$RCC_APB2PhRetCmd
(
ut32_t
 
RCC_APB2Ph
, 
FuniڮS
 
NewS
)

1187 
	`as_m
(
	`IS_RCC_APB2_PERIPH
(
RCC_APB2Ph
));

1188 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1189 i(
NewS
 !
DISABLE
)

1191 
RCC
->
APB2RSTR
 |
RCC_APB2Ph
;

1195 
RCC
->
APB2RSTR
 &~
RCC_APB2Ph
;

1197 
	}
}

1215 
	$RCC_APB1PhRetCmd
(
ut32_t
 
RCC_APB1Ph
, 
FuniڮS
 
NewS
)

1218 
	`as_m
(
	`IS_RCC_APB1_PERIPH
(
RCC_APB1Ph
));

1219 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1220 i(
NewS
 !
DISABLE
)

1222 
RCC
->
APB1RSTR
 |
RCC_APB1Ph
;

1226 
RCC
->
APB1RSTR
 &~
RCC_APB1Ph
;

1228 
	}
}

1236 
	$RCC_BackupRetCmd
(
FuniڮS
 
NewS
)

1239 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1240 *(
__IO
 
ut32_t
 *
BDCR_BDRST_BB
 = (ut32_t)
NewS
;

1241 
	}
}

1249 
	$RCC_ClockSecurySyemCmd
(
FuniڮS
 
NewS
)

1252 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1253 *(
__IO
 
ut32_t
 *
CR_CSSON_BB
 = (ut32_t)
NewS
;

1254 
	}
}

1281 
	$RCC_MCOCfig
(
ut8_t
 
RCC_MCO
)

1284 
	`as_m
(
	`IS_RCC_MCO
(
RCC_MCO
));

1287 *(
__IO
 
ut8_t
 *
CFGR_BYTE4_ADDRESS
 = 
RCC_MCO
;

1288 
	}
}

1325 
FgStus
 
	$RCC_GFgStus
(
ut8_t
 
RCC_FLAG
)

1327 
ut32_t
 
tmp
 = 0;

1328 
ut32_t
 
ueg
 = 0;

1329 
FgStus
 
bus
 = 
RESET
;

1331 
	`as_m
(
	`IS_RCC_FLAG
(
RCC_FLAG
));

1334 
tmp
 = 
RCC_FLAG
 >> 5;

1335 i(
tmp
 == 1)

1337 
ueg
 = 
RCC
->
CR
;

1339 i(
tmp
 == 2)

1341 
ueg
 = 
RCC
->
BDCR
;

1345 
ueg
 = 
RCC
->
CSR
;

1349 
tmp
 = 
RCC_FLAG
 & 
FLAG_Mask
;

1350 i((
ueg
 & ((
ut32_t
)1 << 
tmp
)!(ut32_t)
RESET
)

1352 
bus
 = 
SET
;

1356 
bus
 = 
RESET
;

1360  
bus
;

1361 
	}
}

1370 
	$RCC_CˬFg
()

1373 
RCC
->
CSR
 |
CSR_RMVF_S
;

1374 
	}
}

1401 
ITStus
 
	$RCC_GITStus
(
ut8_t
 
RCC_IT
)

1403 
ITStus
 
bus
 = 
RESET
;

1405 
	`as_m
(
	`IS_RCC_GET_IT
(
RCC_IT
));

1408 i((
RCC
->
CIR
 & 
RCC_IT
!(
ut32_t
)
RESET
)

1410 
bus
 = 
SET
;

1414 
bus
 = 
RESET
;

1418  
bus
;

1419 
	}
}

1447 
	$RCC_CˬITPdgB
(
ut8_t
 
RCC_IT
)

1450 
	`as_m
(
	`IS_RCC_CLEAR_IT
(
RCC_IT
));

1454 *(
__IO
 
ut8_t
 *
CIR_BYTE3_ADDRESS
 = 
RCC_IT
;

1455 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_rtc.c

22 
	~"m32f10x_c.h
"

43 
	#RTC_LSB_MASK
 ((
ut32_t
)0x0000FFFF

	)

44 
	#PRLH_MSB_MASK
 ((
ut32_t
)0x000F0000

	)

89 
	$RTC_ITCfig
(
ut16_t
 
RTC_IT
, 
FuniڮS
 
NewS
)

92 
	`as_m
(
	`IS_RTC_IT
(
RTC_IT
));

93 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

95 i(
NewS
 !
DISABLE
)

97 
RTC
->
CRH
 |
RTC_IT
;

101 
RTC
->
CRH
 &(
ut16_t
)~
RTC_IT
;

103 
	}
}

110 
	$RTC_ECfigMode
()

113 
RTC
->
CRL
 |
RTC_CRL_CNF
;

114 
	}
}

121 
	$RTC_ExCfigMode
()

124 
RTC
->
CRL
 &(
ut16_t
)~((ut16_t)
RTC_CRL_CNF
);

125 
	}
}

132 
ut32_t
 
	$RTC_GCou
()

134 
ut16_t
 
tmp
 = 0;

135 
tmp
 = 
RTC
->
CNTL
;

136  (((
ut32_t
)
RTC
->
CNTH
 << 16 ) | 
tmp
) ;

137 
	}
}

144 
	$RTC_SCou
(
ut32_t
 
CouVue
)

146 
	`RTC_ECfigMode
();

148 
RTC
->
CNTH
 = 
CouVue
 >> 16;

150 
RTC
->
CNTL
 = (
CouVue
 & 
RTC_LSB_MASK
);

151 
	`RTC_ExCfigMode
();

152 
	}
}

159 
	$RTC_SPsr
(
ut32_t
 
PsrVue
)

162 
	`as_m
(
	`IS_RTC_PRESCALER
(
PsrVue
));

164 
	`RTC_ECfigMode
();

166 
RTC
->
PRLH
 = (
PsrVue
 & 
PRLH_MSB_MASK
) >> 16;

168 
RTC
->
PRLL
 = (
PsrVue
 & 
RTC_LSB_MASK
);

169 
	`RTC_ExCfigMode
();

170 
	}
}

177 
	$RTC_SArm
(
ut32_t
 
ArmVue
)

179 
	`RTC_ECfigMode
();

181 
RTC
->
ALRH
 = 
ArmVue
 >> 16;

183 
RTC
->
ALRL
 = (
ArmVue
 & 
RTC_LSB_MASK
);

184 
	`RTC_ExCfigMode
();

185 
	}
}

192 
ut32_t
 
	$RTC_GDivid
()

194 
ut32_t
 
tmp
 = 0x00;

195 
tmp
 = ((
ut32_t
)
RTC
->
DIVH
 & (uint32_t)0x000F) << 16;

196 
tmp
 |
RTC
->
DIVL
;

197  
tmp
;

198 
	}
}

206 
	$RTC_WaFLaTask
()

209 (
RTC
->
CRL
 & 
RTC_FLAG_RTOFF
=(
ut16_t
)
RESET
)

212 
	}
}

222 
	$RTC_WaFSynchro
()

225 
RTC
->
CRL
 &(
ut16_t
)~
RTC_FLAG_RSF
;

227 (
RTC
->
CRL
 & 
RTC_FLAG_RSF
=(
ut16_t
)
RESET
)

230 
	}
}

243 
FgStus
 
	$RTC_GFgStus
(
ut16_t
 
RTC_FLAG
)

245 
FgStus
 
bus
 = 
RESET
;

248 
	`as_m
(
	`IS_RTC_GET_FLAG
(
RTC_FLAG
));

250 i((
RTC
->
CRL
 & 
RTC_FLAG
!(
ut16_t
)
RESET
)

252 
bus
 = 
SET
;

256 
bus
 = 
RESET
;

258  
bus
;

259 
	}
}

272 
	$RTC_CˬFg
(
ut16_t
 
RTC_FLAG
)

275 
	`as_m
(
	`IS_RTC_CLEAR_FLAG
(
RTC_FLAG
));

278 
RTC
->
CRL
 &(
ut16_t
)~
RTC_FLAG
;

279 
	}
}

290 
ITStus
 
	$RTC_GITStus
(
ut16_t
 
RTC_IT
)

292 
ITStus
 
bus
 = 
RESET
;

294 
	`as_m
(
	`IS_RTC_GET_IT
(
RTC_IT
));

296 
bus
 = (
ITStus
)(
RTC
->
CRL
 & 
RTC_IT
);

297 i(((
RTC
->
CRH
 & 
RTC_IT
!(
ut16_t
)
RESET
&& (
bus
 != (uint16_t)RESET))

299 
bus
 = 
SET
;

303 
bus
 = 
RESET
;

305  
bus
;

306 
	}
}

317 
	$RTC_CˬITPdgB
(
ut16_t
 
RTC_IT
)

320 
	`as_m
(
	`IS_RTC_IT
(
RTC_IT
));

323 
RTC
->
CRL
 &(
ut16_t
)~
RTC_IT
;

324 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_sdio.c

22 
	~"m32f10x_sdio.h
"

23 
	~"m32f10x_rcc.h
"

39 
	#SDIO_OFFSET
 (
SDIO_BASE
 - 
PERIPH_BASE
)

	)

44 
	#CLKCR_OFFSET
 (
SDIO_OFFSET
 + 0x04)

	)

45 
	#CLKEN_BNumb
 0x08

	)

46 
	#CLKCR_CLKEN_BB
 (
PERIPH_BB_BASE
 + (
CLKCR_OFFSET
 * 32+ (
CLKEN_BNumb
 * 4))

	)

51 
	#CMD_OFFSET
 (
SDIO_OFFSET
 + 0x0C)

	)

52 
	#SDIOSUSPEND_BNumb
 0x0B

	)

53 
	#CMD_SDIOSUSPEND_BB
 (
PERIPH_BB_BASE
 + (
CMD_OFFSET
 * 32+ (
SDIOSUSPEND_BNumb
 * 4))

	)

56 
	#ENCMDCOMPL_BNumb
 0x0C

	)

57 
	#CMD_ENCMDCOMPL_BB
 (
PERIPH_BB_BASE
 + (
CMD_OFFSET
 * 32+ (
ENCMDCOMPL_BNumb
 * 4))

	)

60 
	#NIEN_BNumb
 0x0D

	)

61 
	#CMD_NIEN_BB
 (
PERIPH_BB_BASE
 + (
CMD_OFFSET
 * 32+ (
NIEN_BNumb
 * 4))

	)

64 
	#ATACMD_BNumb
 0x0E

	)

65 
	#CMD_ATACMD_BB
 (
PERIPH_BB_BASE
 + (
CMD_OFFSET
 * 32+ (
ATACMD_BNumb
 * 4))

	)

70 
	#DCTRL_OFFSET
 (
SDIO_OFFSET
 + 0x2C)

	)

71 
	#DMAEN_BNumb
 0x03

	)

72 
	#DCTRL_DMAEN_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32+ (
DMAEN_BNumb
 * 4))

	)

75 
	#RWSTART_BNumb
 0x08

	)

76 
	#DCTRL_RWSTART_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32+ (
RWSTART_BNumb
 * 4))

	)

79 
	#RWSTOP_BNumb
 0x09

	)

80 
	#DCTRL_RWSTOP_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32+ (
RWSTOP_BNumb
 * 4))

	)

83 
	#RWMOD_BNumb
 0x0A

	)

84 
	#DCTRL_RWMOD_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32+ (
RWMOD_BNumb
 * 4))

	)

87 
	#SDIOEN_BNumb
 0x0B

	)

88 
	#DCTRL_SDIOEN_BB
 (
PERIPH_BB_BASE
 + (
DCTRL_OFFSET
 * 32+ (
SDIOEN_BNumb
 * 4))

	)

95 
	#CLKCR_CLEAR_MASK
 ((
ut32_t
)0xFFFF8100)

	)

100 
	#PWR_PWRCTRL_MASK
 ((
ut32_t
)0xFFFFFFFC)

	)

105 
	#DCTRL_CLEAR_MASK
 ((
ut32_t
)0xFFFFFF08)

	)

110 
	#CMD_CLEAR_MASK
 ((
ut32_t
)0xFFFFF800)

	)

113 
	#SDIO_RESP_ADDR
 ((
ut32_t
)(
SDIO_BASE
 + 0x14))

	)

160 
	$SDIO_DeIn
()

162 
SDIO
->
POWER
 = 0x00000000;

163 
SDIO
->
CLKCR
 = 0x00000000;

164 
SDIO
->
ARG
 = 0x00000000;

165 
SDIO
->
CMD
 = 0x00000000;

166 
SDIO
->
DTIMER
 = 0x00000000;

167 
SDIO
->
DLEN
 = 0x00000000;

168 
SDIO
->
DCTRL
 = 0x00000000;

169 
SDIO
->
ICR
 = 0x00C007FF;

170 
SDIO
->
MASK
 = 0x00000000;

171 
	}
}

180 
	$SDIO_In
(
SDIO_InTyDef
* 
SDIO_InSu
)

182 
ut32_t
 
tmeg
 = 0;

185 
	`as_m
(
	`IS_SDIO_CLOCK_EDGE
(
SDIO_InSu
->
SDIO_ClockEdge
));

186 
	`as_m
(
	`IS_SDIO_CLOCK_BYPASS
(
SDIO_InSu
->
SDIO_ClockByss
));

187 
	`as_m
(
	`IS_SDIO_CLOCK_POWER_SAVE
(
SDIO_InSu
->
SDIO_ClockPowSave
));

188 
	`as_m
(
	`IS_SDIO_BUS_WIDE
(
SDIO_InSu
->
SDIO_BusWide
));

189 
	`as_m
(
	`IS_SDIO_HARDWARE_FLOW_CONTROL
(
SDIO_InSu
->
SDIO_HdweFlowCڌ
));

193 
tmeg
 = 
SDIO
->
CLKCR
;

196 
tmeg
 &
CLKCR_CLEAR_MASK
;

204 
tmeg
 |(
SDIO_InSu
->
SDIO_ClockDiv
 | SDIO_InSu->
SDIO_ClockPowSave
 |

205 
SDIO_InSu
->
SDIO_ClockByss
 | SDIO_InSu->
SDIO_BusWide
 |

206 
SDIO_InSu
->
SDIO_ClockEdge
 | SDIO_InSu->
SDIO_HdweFlowCڌ
);

209 
SDIO
->
CLKCR
 = 
tmeg
;

210 
	}
}

218 
	$SDIO_SuIn
(
SDIO_InTyDef
* 
SDIO_InSu
)

221 
SDIO_InSu
->
SDIO_ClockDiv
 = 0x00;

222 
SDIO_InSu
->
SDIO_ClockEdge
 = 
SDIO_ClockEdge_Risg
;

223 
SDIO_InSu
->
SDIO_ClockByss
 = 
SDIO_ClockByss_Dib
;

224 
SDIO_InSu
->
SDIO_ClockPowSave
 = 
SDIO_ClockPowSave_Dib
;

225 
SDIO_InSu
->
SDIO_BusWide
 = 
SDIO_BusWide_1b
;

226 
SDIO_InSu
->
SDIO_HdweFlowCڌ
 = 
SDIO_HdweFlowCڌ_Dib
;

227 
	}
}

234 
	$SDIO_ClockCmd
(
FuniڮS
 
NewS
)

237 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

239 *(
__IO
 
ut32_t
 *
CLKCR_CLKEN_BB
 = (ut32_t)
NewS
;

240 
	}
}

250 
	$SDIO_SPowS
(
ut32_t
 
SDIO_PowS
)

253 
	`as_m
(
	`IS_SDIO_POWER_STATE
(
SDIO_PowS
));

255 
SDIO
->
POWER
 &
PWR_PWRCTRL_MASK
;

256 
SDIO
->
POWER
 |
SDIO_PowS
;

257 
	}
}

268 
ut32_t
 
	$SDIO_GPowS
()

270  (
SDIO
->
POWER
 & (~
PWR_PWRCTRL_MASK
));

271 
	}
}

306 
	$SDIO_ITCfig
(
ut32_t
 
SDIO_IT
, 
FuniڮS
 
NewS
)

309 
	`as_m
(
	`IS_SDIO_IT
(
SDIO_IT
));

310 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

312 i(
NewS
 !
DISABLE
)

315 
SDIO
->
MASK
 |
SDIO_IT
;

320 
SDIO
->
MASK
 &~
SDIO_IT
;

322 
	}
}

330 
	$SDIO_DMACmd
(
FuniڮS
 
NewS
)

333 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

335 *(
__IO
 
ut32_t
 *
DCTRL_DMAEN_BB
 = (ut32_t)
NewS
;

336 
	}
}

345 
	$SDIO_SdCommd
(
SDIO_CmdInTyDef
 *
SDIO_CmdInSu
)

347 
ut32_t
 
tmeg
 = 0;

350 
	`as_m
(
	`IS_SDIO_CMD_INDEX
(
SDIO_CmdInSu
->
SDIO_CmdIndex
));

351 
	`as_m
(
	`IS_SDIO_RESPONSE
(
SDIO_CmdInSu
->
SDIO_Reڣ
));

352 
	`as_m
(
	`IS_SDIO_WAIT
(
SDIO_CmdInSu
->
SDIO_Wa
));

353 
	`as_m
(
	`IS_SDIO_CPSM
(
SDIO_CmdInSu
->
SDIO_CPSM
));

357 
SDIO
->
ARG
 = 
SDIO_CmdInSu
->
SDIO_Argumt
;

361 
tmeg
 = 
SDIO
->
CMD
;

363 
tmeg
 &
CMD_CLEAR_MASK
;

368 
tmeg
 |(
ut32_t
)
SDIO_CmdInSu
->
SDIO_CmdIndex
 | SDIO_CmdInSu->
SDIO_Reڣ


369 | 
SDIO_CmdInSu
->
SDIO_Wa
 | SDIO_CmdInSu->
SDIO_CPSM
;

372 
SDIO
->
CMD
 = 
tmeg
;

373 
	}
}

381 
	$SDIO_CmdSuIn
(
SDIO_CmdInTyDef
* 
SDIO_CmdInSu
)

384 
SDIO_CmdInSu
->
SDIO_Argumt
 = 0x00;

385 
SDIO_CmdInSu
->
SDIO_CmdIndex
 = 0x00;

386 
SDIO_CmdInSu
->
SDIO_Reڣ
 = 
SDIO_Reڣ_No
;

387 
SDIO_CmdInSu
->
SDIO_Wa
 = 
SDIO_Wa_No
;

388 
SDIO_CmdInSu
->
SDIO_CPSM
 = 
SDIO_CPSM_Dib
;

389 
	}
}

396 
ut8_t
 
	$SDIO_GCommdReڣ
()

398  (
ut8_t
)(
SDIO
->
RESPCMD
);

399 
	}
}

411 
ut32_t
 
	$SDIO_GReڣ
(
ut32_t
 
SDIO_RESP
)

413 
__IO
 
ut32_t
 
tmp
 = 0;

416 
	`as_m
(
	`IS_SDIO_RESP
(
SDIO_RESP
));

418 
tmp
 = 
SDIO_RESP_ADDR
 + 
SDIO_RESP
;

420  (*(
__IO
 
ut32_t
 *
tmp
);

421 
	}
}

430 
	$SDIO_DaCfig
(
SDIO_DaInTyDef
* 
SDIO_DaInSu
)

432 
ut32_t
 
tmeg
 = 0;

435 
	`as_m
(
	`IS_SDIO_DATA_LENGTH
(
SDIO_DaInSu
->
SDIO_DaLgth
));

436 
	`as_m
(
	`IS_SDIO_BLOCK_SIZE
(
SDIO_DaInSu
->
SDIO_DaBlockSize
));

437 
	`as_m
(
	`IS_SDIO_TRANSFER_DIR
(
SDIO_DaInSu
->
SDIO_TnsrD
));

438 
	`as_m
(
	`IS_SDIO_TRANSFER_MODE
(
SDIO_DaInSu
->
SDIO_TnsrMode
));

439 
	`as_m
(
	`IS_SDIO_DPSM
(
SDIO_DaInSu
->
SDIO_DPSM
));

443 
SDIO
->
DTIMER
 = 
SDIO_DaInSu
->
SDIO_DaTimeOut
;

447 
SDIO
->
DLEN
 = 
SDIO_DaInSu
->
SDIO_DaLgth
;

451 
tmeg
 = 
SDIO
->
DCTRL
;

453 
tmeg
 &
DCTRL_CLEAR_MASK
;

458 
tmeg
 |(
ut32_t
)
SDIO_DaInSu
->
SDIO_DaBlockSize
 | SDIO_DaInSu->
SDIO_TnsrD


459 | 
SDIO_DaInSu
->
SDIO_TnsrMode
 | SDIO_DaInSu->
SDIO_DPSM
;

462 
SDIO
->
DCTRL
 = 
tmeg
;

463 
	}
}

471 
	$SDIO_DaSuIn
(
SDIO_DaInTyDef
* 
SDIO_DaInSu
)

474 
SDIO_DaInSu
->
SDIO_DaTimeOut
 = 0xFFFFFFFF;

475 
SDIO_DaInSu
->
SDIO_DaLgth
 = 0x00;

476 
SDIO_DaInSu
->
SDIO_DaBlockSize
 = 
SDIO_DaBlockSize_1b
;

477 
SDIO_DaInSu
->
SDIO_TnsrD
 = 
SDIO_TnsrD_ToCd
;

478 
SDIO_DaInSu
->
SDIO_TnsrMode
 = 
SDIO_TnsrMode_Block
;

479 
SDIO_DaInSu
->
SDIO_DPSM
 = 
SDIO_DPSM_Dib
;

480 
	}
}

487 
ut32_t
 
	$SDIO_GDaCou
()

489  
SDIO
->
DCOUNT
;

490 
	}
}

497 
ut32_t
 
	$SDIO_RdDa
()

499  
SDIO
->
FIFO
;

500 
	}
}

507 
	$SDIO_WreDa
(
ut32_t
 
Da
)

509 
SDIO
->
FIFO
 = 
Da
;

510 
	}
}

517 
ut32_t
 
	$SDIO_GFIFOCou
()

519  
SDIO
->
FIFOCNT
;

520 
	}
}

528 
	$SDIO_SSDIORdWa
(
FuniڮS
 
NewS
)

531 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

533 *(
__IO
 
ut32_t
 *
DCTRL_RWSTART_BB
 = (ut32_t
NewS
;

534 
	}
}

542 
	$SDIO_StSDIORdWa
(
FuniڮS
 
NewS
)

545 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

547 *(
__IO
 
ut32_t
 *
DCTRL_RWSTOP_BB
 = (ut32_t
NewS
;

548 
	}
}

558 
	$SDIO_SSDIORdWaMode
(
ut32_t
 
SDIO_RdWaMode
)

561 
	`as_m
(
	`IS_SDIO_READWAIT_MODE
(
SDIO_RdWaMode
));

563 *(
__IO
 
ut32_t
 *
DCTRL_RWMOD_BB
 = 
SDIO_RdWaMode
;

564 
	}
}

572 
	$SDIO_SSDIOOti
(
FuniڮS
 
NewS
)

575 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

577 *(
__IO
 
ut32_t
 *
DCTRL_SDIOEN_BB
 = (ut32_t)
NewS
;

578 
	}
}

586 
	$SDIO_SdSDIOSudCmd
(
FuniڮS
 
NewS
)

589 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

591 *(
__IO
 
ut32_t
 *
CMD_SDIOSUSPEND_BB
 = (ut32_t)
NewS
;

592 
	}
}

600 
	$SDIO_CommdComiCmd
(
FuniڮS
 
NewS
)

603 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

605 *(
__IO
 
ut32_t
 *
CMD_ENCMDCOMPL_BB
 = (ut32_t)
NewS
;

606 
	}
}

613 
	$SDIO_CEATAITCmd
(
FuniڮS
 
NewS
)

616 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

618 *(
__IO
 
ut32_t
 *
CMD_NIEN_BB
 = (ut32_t)((~((ut32_t)
NewS
)) & ((uint32_t)0x1));

619 
	}
}

626 
	$SDIO_SdCEATACmd
(
FuniڮS
 
NewS
)

629 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

631 *(
__IO
 
ut32_t
 *
CMD_ATACMD_BB
 = (ut32_t)
NewS
;

632 
	}
}

665 
FgStus
 
	$SDIO_GFgStus
(
ut32_t
 
SDIO_FLAG
)

667 
FgStus
 
bus
 = 
RESET
;

670 
	`as_m
(
	`IS_SDIO_FLAG
(
SDIO_FLAG
));

672 i((
SDIO
->
STA
 & 
SDIO_FLAG
!(
ut32_t
)
RESET
)

674 
bus
 = 
SET
;

678 
bus
 = 
RESET
;

680  
bus
;

681 
	}
}

703 
	$SDIO_CˬFg
(
ut32_t
 
SDIO_FLAG
)

706 
	`as_m
(
	`IS_SDIO_CLEAR_FLAG
(
SDIO_FLAG
));

708 
SDIO
->
ICR
 = 
SDIO_FLAG
;

709 
	}
}

742 
ITStus
 
	$SDIO_GITStus
(
ut32_t
 
SDIO_IT
)

744 
ITStus
 
bus
 = 
RESET
;

747 
	`as_m
(
	`IS_SDIO_GET_IT
(
SDIO_IT
));

748 i((
SDIO
->
STA
 & 
SDIO_IT
!(
ut32_t
)
RESET
)

750 
bus
 = 
SET
;

754 
bus
 = 
RESET
;

756  
bus
;

757 
	}
}

778 
	$SDIO_CˬITPdgB
(
ut32_t
 
SDIO_IT
)

781 
	`as_m
(
	`IS_SDIO_CLEAR_IT
(
SDIO_IT
));

783 
SDIO
->
ICR
 = 
SDIO_IT
;

784 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_spi.c

22 
	~"m32f10x_i.h
"

23 
	~"m32f10x_rcc.h
"

48 
	#CR1_SPE_S
 ((
ut16_t
)0x0040)

	)

49 
	#CR1_SPE_Ret
 ((
ut16_t
)0xFFBF)

	)

52 
	#I2SCFGR_I2SE_S
 ((
ut16_t
)0x0400)

	)

53 
	#I2SCFGR_I2SE_Ret
 ((
ut16_t
)0xFBFF)

	)

56 
	#CR1_CRCNext_S
 ((
ut16_t
)0x1000)

	)

59 
	#CR1_CRCEN_S
 ((
ut16_t
)0x2000)

	)

60 
	#CR1_CRCEN_Ret
 ((
ut16_t
)0xDFFF)

	)

63 
	#CR2_SSOE_S
 ((
ut16_t
)0x0004)

	)

64 
	#CR2_SSOE_Ret
 ((
ut16_t
)0xFFFB)

	)

67 
	#CR1_CLEAR_Mask
 ((
ut16_t
)0x3040)

	)

68 
	#I2SCFGR_CLEAR_Mask
 ((
ut16_t
)0xF040)

	)

71 
	#SPI_Mode_Se
 ((
ut16_t
)0xF7FF)

	)

72 
	#I2S_Mode_Se
 ((
ut16_t
)0x0800)

	)

75 
	#I2S2_CLOCK_SRC
 ((
ut32_t
)(0x00020000))

	)

76 
	#I2S3_CLOCK_SRC
 ((
ut32_t
)(0x00040000))

	)

77 
	#I2S_MUL_MASK
 ((
ut32_t
)(0x0000F000))

	)

78 
	#I2S_DIV_MASK
 ((
ut32_t
)(0x000000F0))

	)

118 
	$SPI_I2S_DeIn
(
SPI_TyDef
* 
SPIx
)

121 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

123 i(
SPIx
 =
SPI1
)

126 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_SPI1
, 
ENABLE
);

128 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_SPI1
, 
DISABLE
);

130 i(
SPIx
 =
SPI2
)

133 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_SPI2
, 
ENABLE
);

135 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_SPI2
, 
DISABLE
);

139 i(
SPIx
 =
SPI3
)

142 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_SPI3
, 
ENABLE
);

144 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_SPI3
, 
DISABLE
);

147 
	}
}

157 
	$SPI_In
(
SPI_TyDef
* 
SPIx
, 
SPI_InTyDef
* 
SPI_InSu
)

159 
ut16_t
 
tmeg
 = 0;

162 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

165 
	`as_m
(
	`IS_SPI_DIRECTION_MODE
(
SPI_InSu
->
SPI_Dei
));

166 
	`as_m
(
	`IS_SPI_MODE
(
SPI_InSu
->
SPI_Mode
));

167 
	`as_m
(
	`IS_SPI_DATASIZE
(
SPI_InSu
->
SPI_DaSize
));

168 
	`as_m
(
	`IS_SPI_CPOL
(
SPI_InSu
->
SPI_CPOL
));

169 
	`as_m
(
	`IS_SPI_CPHA
(
SPI_InSu
->
SPI_CPHA
));

170 
	`as_m
(
	`IS_SPI_NSS
(
SPI_InSu
->
SPI_NSS
));

171 
	`as_m
(
	`IS_SPI_BAUDRATE_PRESCALER
(
SPI_InSu
->
SPI_BaudRePsr
));

172 
	`as_m
(
	`IS_SPI_FIRST_BIT
(
SPI_InSu
->
SPI_FB
));

173 
	`as_m
(
	`IS_SPI_CRC_POLYNOMIAL
(
SPI_InSu
->
SPI_CRCPynoml
));

177 
tmeg
 = 
SPIx
->
CR1
;

179 
tmeg
 &
CR1_CLEAR_Mask
;

188 
tmeg
 |(
ut16_t
)((
ut32_t
)
SPI_InSu
->
SPI_Dei
 | SPI_InSu->
SPI_Mode
 |

189 
SPI_InSu
->
SPI_DaSize
 | SPI_InSu->
SPI_CPOL
 |

190 
SPI_InSu
->
SPI_CPHA
 | SPI_InSu->
SPI_NSS
 |

191 
SPI_InSu
->
SPI_BaudRePsr
 | SPI_InSu->
SPI_FB
);

193 
SPIx
->
CR1
 = 
tmeg
;

196 
SPIx
->
I2SCFGR
 &
SPI_Mode_Se
;

200 
SPIx
->
CRCPR
 = 
SPI_InSu
->
SPI_CRCPynoml
;

201 
	}
}

218 
	$I2S_In
(
SPI_TyDef
* 
SPIx
, 
I2S_InTyDef
* 
I2S_InSu
)

220 
ut16_t
 
tmeg
 = 0, 
i2sdiv
 = 2, 
i2sodd
 = 0, 
ckngth
 = 1;

221 
ut32_t
 
tmp
 = 0;

222 
RCC_ClocksTyDef
 
RCC_Clocks
;

223 
ut32_t
 
sourock
 = 0;

226 
	`as_m
(
	`IS_SPI_23_PERIPH
(
SPIx
));

227 
	`as_m
(
	`IS_I2S_MODE
(
I2S_InSu
->
I2S_Mode
));

228 
	`as_m
(
	`IS_I2S_STANDARD
(
I2S_InSu
->
I2S_Sndd
));

229 
	`as_m
(
	`IS_I2S_DATA_FORMAT
(
I2S_InSu
->
I2S_DaFm
));

230 
	`as_m
(
	`IS_I2S_MCLK_OUTPUT
(
I2S_InSu
->
I2S_MCLKOuut
));

231 
	`as_m
(
	`IS_I2S_AUDIO_FREQ
(
I2S_InSu
->
I2S_AudioFq
));

232 
	`as_m
(
	`IS_I2S_CPOL
(
I2S_InSu
->
I2S_CPOL
));

236 
SPIx
->
I2SCFGR
 &
I2SCFGR_CLEAR_Mask
;

237 
SPIx
->
I2SPR
 = 0x0002;

240 
tmeg
 = 
SPIx
->
I2SCFGR
;

243 if(
I2S_InSu
->
I2S_AudioFq
 =
I2S_AudioFq_Deu
)

245 
i2sodd
 = (
ut16_t
)0;

246 
i2sdiv
 = (
ut16_t
)2;

252 if(
I2S_InSu
->
I2S_DaFm
 =
I2S_DaFm_16b
)

255 
ckngth
 = 1;

260 
ckngth
 = 2;

264 if(((
ut32_t
)
SPIx
=
SPI2_BASE
)

267 
tmp
 = 
I2S2_CLOCK_SRC
;

272 
tmp
 = 
I2S3_CLOCK_SRC
;

277 #ifde
STM32F10X_CL


278 if((
RCC
->
CFGR2
 & 
tmp
) != 0)

281 
tmp
 = (
ut32_t
)((
RCC
->
CFGR2
 & 
I2S_MUL_MASK
) >> 12);

284 if((
tmp
 > 5) && (tmp < 15))

287 
tmp
 += 2;

291 i(
tmp
 == 15)

294 
tmp
 = 20;

298 
sourock
 = (
ut32_t
)(((
RCC
->
CFGR2
 & 
I2S_DIV_MASK
) >> 4) + 1);

301 
sourock
 = (
ut32_t
((
HSE_Vue
 / sourock* 
tmp
 * 2);

306 
	`RCC_GClocksFq
(&
RCC_Clocks
);

309 
sourock
 = 
RCC_Clocks
.
SYSCLK_Fqucy
;

313 
	`RCC_GClocksFq
(&
RCC_Clocks
);

316 
sourock
 = 
RCC_Clocks
.
SYSCLK_Fqucy
;

320 if(
I2S_InSu
->
I2S_MCLKOuut
 =
I2S_MCLKOuut_Eb
)

323 
tmp
 = (
ut16_t
)(((((
sourock
 / 256* 10/ 
I2S_InSu
->
I2S_AudioFq
)) + 5);

328 
tmp
 = (
ut16_t
)(((((
sourock
 / (32 * 
ckngth
)*10 ) / 
I2S_InSu
->
I2S_AudioFq
)) + 5);

332 
tmp
 =mp / 10;

335 
i2sodd
 = (
ut16_t
)(
tmp
 & (uint16_t)0x0001);

338 
i2sdiv
 = (
ut16_t
)((
tmp
 - 
i2sodd
) / 2);

341 
i2sodd
 = (
ut16_t
) (i2sodd << 8);

345 i((
i2sdiv
 < 2) || (i2sdiv > 0xFF))

348 
i2sdiv
 = 2;

349 
i2sodd
 = 0;

353 
SPIx
->
I2SPR
 = (
ut16_t
)(
i2sdiv
 | (ut16_t)(
i2sodd
 | (ut16_t)
I2S_InSu
->
I2S_MCLKOuut
));

356 
tmeg
 |(
ut16_t
)(
I2S_Mode_Se
 | (ut16_t)(
I2S_InSu
->
I2S_Mode
 | \

357 (
ut16_t
)(
I2S_InSu
->
I2S_Sndd
 | (ut16_t)(I2S_InSu->
I2S_DaFm
 | \

358 (
ut16_t
)
I2S_InSu
->
I2S_CPOL
))));

361 
SPIx
->
I2SCFGR
 = 
tmeg
;

362 
	}
}

369 
	$SPI_SuIn
(
SPI_InTyDef
* 
SPI_InSu
)

373 
SPI_InSu
->
SPI_Dei
 = 
SPI_Dei_2Les_FuDuex
;

375 
SPI_InSu
->
SPI_Mode
 = 
SPI_Mode_Sve
;

377 
SPI_InSu
->
SPI_DaSize
 = 
SPI_DaSize_8b
;

379 
SPI_InSu
->
SPI_CPOL
 = 
SPI_CPOL_Low
;

381 
SPI_InSu
->
SPI_CPHA
 = 
SPI_CPHA_1Edge
;

383 
SPI_InSu
->
SPI_NSS
 = 
SPI_NSS_Hd
;

385 
SPI_InSu
->
SPI_BaudRePsr
 = 
SPI_BaudRePsr_2
;

387 
SPI_InSu
->
SPI_FB
 = 
SPI_FB_MSB
;

389 
SPI_InSu
->
SPI_CRCPynoml
 = 7;

390 
	}
}

397 
	$I2S_SuIn
(
I2S_InTyDef
* 
I2S_InSu
)

401 
I2S_InSu
->
I2S_Mode
 = 
I2S_Mode_SveTx
;

404 
I2S_InSu
->
I2S_Sndd
 = 
I2S_Sndd_Phls
;

407 
I2S_InSu
->
I2S_DaFm
 = 
I2S_DaFm_16b
;

410 
I2S_InSu
->
I2S_MCLKOuut
 = 
I2S_MCLKOuut_Dib
;

413 
I2S_InSu
->
I2S_AudioFq
 = 
I2S_AudioFq_Deu
;

416 
I2S_InSu
->
I2S_CPOL
 = 
I2S_CPOL_Low
;

417 
	}
}

426 
	$SPI_Cmd
(
SPI_TyDef
* 
SPIx
, 
FuniڮS
 
NewS
)

429 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

430 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

431 i(
NewS
 !
DISABLE
)

434 
SPIx
->
CR1
 |
CR1_SPE_S
;

439 
SPIx
->
CR1
 &
CR1_SPE_Ret
;

441 
	}
}

450 
	$I2S_Cmd
(
SPI_TyDef
* 
SPIx
, 
FuniڮS
 
NewS
)

453 
	`as_m
(
	`IS_SPI_23_PERIPH
(
SPIx
));

454 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

455 i(
NewS
 !
DISABLE
)

458 
SPIx
->
I2SCFGR
 |
I2SCFGR_I2SE_S
;

463 
SPIx
->
I2SCFGR
 &
I2SCFGR_I2SE_Ret
;

465 
	}
}

481 
	$SPI_I2S_ITCfig
(
SPI_TyDef
* 
SPIx
, 
ut8_t
 
SPI_I2S_IT
, 
FuniڮS
 
NewS
)

483 
ut16_t
 
pos
 = 0, 
mask
 = 0 ;

485 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

486 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

487 
	`as_m
(
	`IS_SPI_I2S_CONFIG_IT
(
SPI_I2S_IT
));

490 
pos
 = 
SPI_I2S_IT
 >> 4;

493 
mask
 = (
ut16_t
)1 << (ut16_t)
pos
;

495 i(
NewS
 !
DISABLE
)

498 
SPIx
->
CR2
 |
mask
;

503 
SPIx
->
CR2
 &(
ut16_t
)~
mask
;

505 
	}
}

520 
	$SPI_I2S_DMACmd
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_I2S_DMAReq
, 
FuniڮS
 
NewS
)

523 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

524 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

525 
	`as_m
(
	`IS_SPI_I2S_DMAREQ
(
SPI_I2S_DMAReq
));

526 i(
NewS
 !
DISABLE
)

529 
SPIx
->
CR2
 |
SPI_I2S_DMAReq
;

534 
SPIx
->
CR2
 &(
ut16_t
)~
SPI_I2S_DMAReq
;

536 
	}
}

546 
	$SPI_I2S_SdDa
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
Da
)

549 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

552 
SPIx
->
DR
 = 
Da
;

553 
	}
}

562 
ut16_t
 
	$SPI_I2S_ReiveDa
(
SPI_TyDef
* 
SPIx
)

565 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

568  
SPIx
->
DR
;

569 
	}
}

580 
	$SPI_NSSIlSoweCfig
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_NSSIlSo
)

583 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

584 
	`as_m
(
	`IS_SPI_NSS_INTERNAL
(
SPI_NSSIlSo
));

585 i(
SPI_NSSIlSo
 !
SPI_NSSIlSo_Ret
)

588 
SPIx
->
CR1
 |
SPI_NSSIlSo_S
;

593 
SPIx
->
CR1
 &
SPI_NSSIlSo_Ret
;

595 
	}
}

604 
	$SPI_SSOuutCmd
(
SPI_TyDef
* 
SPIx
, 
FuniڮS
 
NewS
)

607 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

608 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

609 i(
NewS
 !
DISABLE
)

612 
SPIx
->
CR2
 |
CR2_SSOE_S
;

617 
SPIx
->
CR2
 &
CR2_SSOE_Ret
;

619 
	}
}

630 
	$SPI_DaSizeCfig
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_DaSize
)

633 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

634 
	`as_m
(
	`IS_SPI_DATASIZE
(
SPI_DaSize
));

636 
SPIx
->
CR1
 &(
ut16_t
)~
SPI_DaSize_16b
;

638 
SPIx
->
CR1
 |
SPI_DaSize
;

639 
	}
}

646 
	$SPI_TnsmCRC
(
SPI_TyDef
* 
SPIx
)

649 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

652 
SPIx
->
CR1
 |
CR1_CRCNext_S
;

653 
	}
}

662 
	$SPI_CcuϋCRC
(
SPI_TyDef
* 
SPIx
, 
FuniڮS
 
NewS
)

665 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

666 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

667 i(
NewS
 !
DISABLE
)

670 
SPIx
->
CR1
 |
CR1_CRCEN_S
;

675 
SPIx
->
CR1
 &
CR1_CRCEN_Ret
;

677 
	}
}

688 
ut16_t
 
	$SPI_GCRC
(
SPI_TyDef
* 
SPIx
, 
ut8_t
 
SPI_CRC
)

690 
ut16_t
 
eg
 = 0;

692 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

693 
	`as_m
(
	`IS_SPI_CRC
(
SPI_CRC
));

694 i(
SPI_CRC
 !
SPI_CRC_Rx
)

697 
eg
 = 
SPIx
->
TXCRCR
;

702 
eg
 = 
SPIx
->
RXCRCR
;

705  
eg
;

706 
	}
}

713 
ut16_t
 
	$SPI_GCRCPynoml
(
SPI_TyDef
* 
SPIx
)

716 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

719  
SPIx
->
CRCPR
;

720 
	}
}

731 
	$SPI_BiDeiڮLeCfig
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_Dei
)

734 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

735 
	`as_m
(
	`IS_SPI_DIRECTION
(
SPI_Dei
));

736 i(
SPI_Dei
 =
SPI_Dei_Tx
)

739 
SPIx
->
CR1
 |
SPI_Dei_Tx
;

744 
SPIx
->
CR1
 &
SPI_Dei_Rx
;

746 
	}
}

765 
FgStus
 
	$SPI_I2S_GFgStus
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_I2S_FLAG
)

767 
FgStus
 
bus
 = 
RESET
;

769 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

770 
	`as_m
(
	`IS_SPI_I2S_GET_FLAG
(
SPI_I2S_FLAG
));

772 i((
SPIx
->
SR
 & 
SPI_I2S_FLAG
!(
ut16_t
)
RESET
)

775 
bus
 = 
SET
;

780 
bus
 = 
RESET
;

783  
bus
;

784 
	}
}

803 
	$SPI_I2S_CˬFg
(
SPI_TyDef
* 
SPIx
, 
ut16_t
 
SPI_I2S_FLAG
)

806 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

807 
	`as_m
(
	`IS_SPI_I2S_CLEAR_FLAG
(
SPI_I2S_FLAG
));

810 
SPIx
->
SR
 = (
ut16_t
)~
SPI_I2S_FLAG
;

811 
	}
}

828 
ITStus
 
	$SPI_I2S_GITStus
(
SPI_TyDef
* 
SPIx
, 
ut8_t
 
SPI_I2S_IT
)

830 
ITStus
 
bus
 = 
RESET
;

831 
ut16_t
 
pos
 = 0, 
mask
 = 0, 
abˡus
 = 0;

834 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

835 
	`as_m
(
	`IS_SPI_I2S_GET_IT
(
SPI_I2S_IT
));

838 
pos
 = 0x01 << (
SPI_I2S_IT
 & 0x0F);

841 
mask
 = 
SPI_I2S_IT
 >> 4;

844 
mask
 = 0x01 << itmask;

847 
abˡus
 = (
SPIx
->
CR2
 & 
mask
) ;

850 i(((
SPIx
->
SR
 & 
pos
!(
ut16_t
)
RESET
&& 
abˡus
)

853 
bus
 = 
SET
;

858 
bus
 = 
RESET
;

861  
bus
;

862 
	}
}

882 
	$SPI_I2S_CˬITPdgB
(
SPI_TyDef
* 
SPIx
, 
ut8_t
 
SPI_I2S_IT
)

884 
ut16_t
 
pos
 = 0;

886 
	`as_m
(
	`IS_SPI_ALL_PERIPH
(
SPIx
));

887 
	`as_m
(
	`IS_SPI_I2S_CLEAR_IT
(
SPI_I2S_IT
));

890 
pos
 = 0x01 << (
SPI_I2S_IT
 & 0x0F);

893 
SPIx
->
SR
 = (
ut16_t
)~
pos
;

894 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_tim.c

22 
	~"m32f10x_tim.h
"

23 
	~"m32f10x_rcc.h
"

47 
	#SMCR_ETR_Mask
 ((
ut16_t
)0x00FF)

	)

48 
	#CCMR_Offt
 ((
ut16_t
)0x0018)

	)

49 
	#CCER_CCE_S
 ((
ut16_t
)0x0001)

	)

50 
	#CCER_CCNE_S
 ((
ut16_t
)0x0004)

	)

76 
TI1_Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPެy
, ut16_
TIM_ICSei
,

77 
ut16_t
 
TIM_ICFr
);

78 
TI2_Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPެy
, ut16_
TIM_ICSei
,

79 
ut16_t
 
TIM_ICFr
);

80 
TI3_Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPެy
, ut16_
TIM_ICSei
,

81 
ut16_t
 
TIM_ICFr
);

82 
TI4_Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPެy
, ut16_
TIM_ICSei
,

83 
ut16_t
 
TIM_ICFr
);

121 
	$TIM_DeIn
(
TIM_TyDef
* 
TIMx
)

124 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

126 i(
TIMx
 =
TIM1
)

128 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM1
, 
ENABLE
);

129 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM1
, 
DISABLE
);

131 i(
TIMx
 =
TIM2
)

133 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM2
, 
ENABLE
);

134 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM2
, 
DISABLE
);

136 i(
TIMx
 =
TIM3
)

138 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM3
, 
ENABLE
);

139 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM3
, 
DISABLE
);

141 i(
TIMx
 =
TIM4
)

143 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM4
, 
ENABLE
);

144 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM4
, 
DISABLE
);

146 i(
TIMx
 =
TIM5
)

148 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM5
, 
ENABLE
);

149 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM5
, 
DISABLE
);

151 i(
TIMx
 =
TIM6
)

153 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM6
, 
ENABLE
);

154 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM6
, 
DISABLE
);

156 i(
TIMx
 =
TIM7
)

158 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM7
, 
ENABLE
);

159 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM7
, 
DISABLE
);

161 i(
TIMx
 =
TIM8
)

163 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM8
, 
ENABLE
);

164 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM8
, 
DISABLE
);

166 i(
TIMx
 =
TIM9
)

168 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM9
, 
ENABLE
);

169 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM9
, 
DISABLE
);

171 i(
TIMx
 =
TIM10
)

173 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM10
, 
ENABLE
);

174 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM10
, 
DISABLE
);

176 i(
TIMx
 =
TIM11
)

178 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM11
, 
ENABLE
);

179 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM11
, 
DISABLE
);

181 i(
TIMx
 =
TIM12
)

183 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM12
, 
ENABLE
);

184 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM12
, 
DISABLE
);

186 i(
TIMx
 =
TIM13
)

188 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM13
, 
ENABLE
);

189 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM13
, 
DISABLE
);

191 i(
TIMx
 =
TIM14
)

193 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM14
, 
ENABLE
);

194 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_TIM14
, 
DISABLE
);

196 i(
TIMx
 =
TIM15
)

198 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM15
, 
ENABLE
);

199 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM15
, 
DISABLE
);

201 i(
TIMx
 =
TIM16
)

203 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM16
, 
ENABLE
);

204 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM16
, 
DISABLE
);

208 i(
TIMx
 =
TIM17
)

210 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM17
, 
ENABLE
);

211 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_TIM17
, 
DISABLE
);

214 
	}
}

224 
	$TIM_TimeBaIn
(
TIM_TyDef
* 
TIMx
, 
TIM_TimeBaInTyDef
* 
TIM_TimeBaInSu
)

226 
ut16_t
 
tmp1
 = 0;

229 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

230 
	`as_m
(
	`IS_TIM_COUNTER_MODE
(
TIM_TimeBaInSu
->
TIM_CouMode
));

231 
	`as_m
(
	`IS_TIM_CKD_DIV
(
TIM_TimeBaInSu
->
TIM_ClockDivisi
));

233 
tmp1
 = 
TIMx
->
CR1
;

235 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
)|| (TIMx =
TIM2
|| (TIMx =
TIM3
)||

236 (
TIMx
 =
TIM4
|| (TIMx =
TIM5
))

239 
tmp1
 &(
ut16_t
)(~((ut16_t)(
TIM_CR1_DIR
 | 
TIM_CR1_CMS
)));

240 
tmp1
 |(
ut32_t
)
TIM_TimeBaInSu
->
TIM_CouMode
;

243 if((
TIMx
 !
TIM6
&& (TIMx !
TIM7
))

246 
tmp1
 &(
ut16_t
)(~((ut16_t)
TIM_CR1_CKD
));

247 
tmp1
 |(
ut32_t
)
TIM_TimeBaInSu
->
TIM_ClockDivisi
;

250 
TIMx
->
CR1
 = 
tmp1
;

253 
TIMx
->
ARR
 = 
TIM_TimeBaInSu
->
TIM_Piod
 ;

256 
TIMx
->
PSC
 = 
TIM_TimeBaInSu
->
TIM_Psr
;

258 i((
TIMx
 =
TIM1
|| (TIMx =
TIM8
)|| (TIMx =
TIM15
)|| (TIMx =
TIM16
|| (TIMx =
TIM17
))

261 
TIMx
->
RCR
 = 
TIM_TimeBaInSu
->
TIM_RiCou
;

266 
TIMx
->
EGR
 = 
TIM_PSCRdMode_Immed
;

267 
	}
}

277 
	$TIM_OC1In
(
TIM_TyDef
* 
TIMx
, 
TIM_OCInTyDef
* 
TIM_OCInSu
)

279 
ut16_t
 
tmpccmrx
 = 0, 
tmpcr
 = 0, 
tmp2
 = 0;

282 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

283 
	`as_m
(
	`IS_TIM_OC_MODE
(
TIM_OCInSu
->
TIM_OCMode
));

284 
	`as_m
(
	`IS_TIM_OUTPUT_STATE
(
TIM_OCInSu
->
TIM_OuutS
));

285 
	`as_m
(
	`IS_TIM_OC_POLARITY
(
TIM_OCInSu
->
TIM_OCPެy
));

287 
TIMx
->
CCER
 &(
ut16_t
)(~(ut16_t)
TIM_CCER_CC1E
);

289 
tmpcr
 = 
TIMx
->
CCER
;

291 
tmp2
 = 
TIMx
->
CR2
;

294 
tmpccmrx
 = 
TIMx
->
CCMR1
;

297 
tmpccmrx
 &(
ut16_t
)(~((ut16_t)
TIM_CCMR1_OC1M
));

298 
tmpccmrx
 &(
ut16_t
)(~((ut16_t)
TIM_CCMR1_CC1S
));

301 
tmpccmrx
 |
TIM_OCInSu
->
TIM_OCMode
;

304 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC1P
));

306 
tmpcr
 |
TIM_OCInSu
->
TIM_OCPެy
;

309 
tmpcr
 |
TIM_OCInSu
->
TIM_OuutS
;

311 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
)|| (TIMx =
TIM15
)||

312 (
TIMx
 =
TIM16
)|| (TIMx =
TIM17
))

314 
	`as_m
(
	`IS_TIM_OUTPUTN_STATE
(
TIM_OCInSu
->
TIM_OuutNS
));

315 
	`as_m
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCInSu
->
TIM_OCNPެy
));

316 
	`as_m
(
	`IS_TIM_OCNIDLE_STATE
(
TIM_OCInSu
->
TIM_OCNIdS
));

317 
	`as_m
(
	`IS_TIM_OCIDLE_STATE
(
TIM_OCInSu
->
TIM_OCIdS
));

320 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC1NP
));

322 
tmpcr
 |
TIM_OCInSu
->
TIM_OCNPެy
;

325 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC1NE
));

327 
tmpcr
 |
TIM_OCInSu
->
TIM_OuutNS
;

330 
tmp2
 &(
ut16_t
)(~((ut16_t)
TIM_CR2_OIS1
));

331 
tmp2
 &(
ut16_t
)(~((ut16_t)
TIM_CR2_OIS1N
));

334 
tmp2
 |
TIM_OCInSu
->
TIM_OCIdS
;

336 
tmp2
 |
TIM_OCInSu
->
TIM_OCNIdS
;

339 
TIMx
->
CR2
 = 
tmp2
;

342 
TIMx
->
CCMR1
 = 
tmpccmrx
;

345 
TIMx
->
CCR1
 = 
TIM_OCInSu
->
TIM_Pul
;

348 
TIMx
->
CCER
 = 
tmpcr
;

349 
	}
}

360 
	$TIM_OC2In
(
TIM_TyDef
* 
TIMx
, 
TIM_OCInTyDef
* 
TIM_OCInSu
)

362 
ut16_t
 
tmpccmrx
 = 0, 
tmpcr
 = 0, 
tmp2
 = 0;

365 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

366 
	`as_m
(
	`IS_TIM_OC_MODE
(
TIM_OCInSu
->
TIM_OCMode
));

367 
	`as_m
(
	`IS_TIM_OUTPUT_STATE
(
TIM_OCInSu
->
TIM_OuutS
));

368 
	`as_m
(
	`IS_TIM_OC_POLARITY
(
TIM_OCInSu
->
TIM_OCPެy
));

370 
TIMx
->
CCER
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC2E
));

373 
tmpcr
 = 
TIMx
->
CCER
;

375 
tmp2
 = 
TIMx
->
CR2
;

378 
tmpccmrx
 = 
TIMx
->
CCMR1
;

381 
tmpccmrx
 &(
ut16_t
)(~((ut16_t)
TIM_CCMR1_OC2M
));

382 
tmpccmrx
 &(
ut16_t
)(~((ut16_t)
TIM_CCMR1_CC2S
));

385 
tmpccmrx
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCMode
 << 8);

388 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC2P
));

390 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCPެy
 << 4);

393 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OuutS
 << 4);

395 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
))

397 
	`as_m
(
	`IS_TIM_OUTPUTN_STATE
(
TIM_OCInSu
->
TIM_OuutNS
));

398 
	`as_m
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCInSu
->
TIM_OCNPެy
));

399 
	`as_m
(
	`IS_TIM_OCNIDLE_STATE
(
TIM_OCInSu
->
TIM_OCNIdS
));

400 
	`as_m
(
	`IS_TIM_OCIDLE_STATE
(
TIM_OCInSu
->
TIM_OCIdS
));

403 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC2NP
));

405 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCNPެy
 << 4);

408 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC2NE
));

410 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OuutNS
 << 4);

413 
tmp2
 &(
ut16_t
)(~((ut16_t)
TIM_CR2_OIS2
));

414 
tmp2
 &(
ut16_t
)(~((ut16_t)
TIM_CR2_OIS2N
));

417 
tmp2
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCIdS
 << 2);

419 
tmp2
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCNIdS
 << 2);

422 
TIMx
->
CR2
 = 
tmp2
;

425 
TIMx
->
CCMR1
 = 
tmpccmrx
;

428 
TIMx
->
CCR2
 = 
TIM_OCInSu
->
TIM_Pul
;

431 
TIMx
->
CCER
 = 
tmpcr
;

432 
	}
}

442 
	$TIM_OC3In
(
TIM_TyDef
* 
TIMx
, 
TIM_OCInTyDef
* 
TIM_OCInSu
)

444 
ut16_t
 
tmpccmrx
 = 0, 
tmpcr
 = 0, 
tmp2
 = 0;

447 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

448 
	`as_m
(
	`IS_TIM_OC_MODE
(
TIM_OCInSu
->
TIM_OCMode
));

449 
	`as_m
(
	`IS_TIM_OUTPUT_STATE
(
TIM_OCInSu
->
TIM_OuutS
));

450 
	`as_m
(
	`IS_TIM_OC_POLARITY
(
TIM_OCInSu
->
TIM_OCPެy
));

452 
TIMx
->
CCER
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC3E
));

455 
tmpcr
 = 
TIMx
->
CCER
;

457 
tmp2
 = 
TIMx
->
CR2
;

460 
tmpccmrx
 = 
TIMx
->
CCMR2
;

463 
tmpccmrx
 &(
ut16_t
)(~((ut16_t)
TIM_CCMR2_OC3M
));

464 
tmpccmrx
 &(
ut16_t
)(~((ut16_t)
TIM_CCMR2_CC3S
));

466 
tmpccmrx
 |
TIM_OCInSu
->
TIM_OCMode
;

469 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC3P
));

471 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCPެy
 << 8);

474 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OuutS
 << 8);

476 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
))

478 
	`as_m
(
	`IS_TIM_OUTPUTN_STATE
(
TIM_OCInSu
->
TIM_OuutNS
));

479 
	`as_m
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCInSu
->
TIM_OCNPެy
));

480 
	`as_m
(
	`IS_TIM_OCNIDLE_STATE
(
TIM_OCInSu
->
TIM_OCNIdS
));

481 
	`as_m
(
	`IS_TIM_OCIDLE_STATE
(
TIM_OCInSu
->
TIM_OCIdS
));

484 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC3NP
));

486 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCNPެy
 << 8);

488 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC3NE
));

491 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OuutNS
 << 8);

493 
tmp2
 &(
ut16_t
)(~((ut16_t)
TIM_CR2_OIS3
));

494 
tmp2
 &(
ut16_t
)(~((ut16_t)
TIM_CR2_OIS3N
));

496 
tmp2
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCIdS
 << 4);

498 
tmp2
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCNIdS
 << 4);

501 
TIMx
->
CR2
 = 
tmp2
;

504 
TIMx
->
CCMR2
 = 
tmpccmrx
;

507 
TIMx
->
CCR3
 = 
TIM_OCInSu
->
TIM_Pul
;

510 
TIMx
->
CCER
 = 
tmpcr
;

511 
	}
}

521 
	$TIM_OC4In
(
TIM_TyDef
* 
TIMx
, 
TIM_OCInTyDef
* 
TIM_OCInSu
)

523 
ut16_t
 
tmpccmrx
 = 0, 
tmpcr
 = 0, 
tmp2
 = 0;

526 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

527 
	`as_m
(
	`IS_TIM_OC_MODE
(
TIM_OCInSu
->
TIM_OCMode
));

528 
	`as_m
(
	`IS_TIM_OUTPUT_STATE
(
TIM_OCInSu
->
TIM_OuutS
));

529 
	`as_m
(
	`IS_TIM_OC_POLARITY
(
TIM_OCInSu
->
TIM_OCPެy
));

531 
TIMx
->
CCER
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC4E
));

534 
tmpcr
 = 
TIMx
->
CCER
;

536 
tmp2
 = 
TIMx
->
CR2
;

539 
tmpccmrx
 = 
TIMx
->
CCMR2
;

542 
tmpccmrx
 &(
ut16_t
)(~((ut16_t)
TIM_CCMR2_OC4M
));

543 
tmpccmrx
 &(
ut16_t
)(~((ut16_t)
TIM_CCMR2_CC4S
));

546 
tmpccmrx
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCMode
 << 8);

549 
tmpcr
 &(
ut16_t
)(~((ut16_t)
TIM_CCER_CC4P
));

551 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCPެy
 << 12);

554 
tmpcr
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OuutS
 << 12);

556 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
))

558 
	`as_m
(
	`IS_TIM_OCIDLE_STATE
(
TIM_OCInSu
->
TIM_OCIdS
));

560 
tmp2
 &(
ut16_t
)(~((ut16_t)
TIM_CR2_OIS4
));

562 
tmp2
 |(
ut16_t
)(
TIM_OCInSu
->
TIM_OCIdS
 << 6);

565 
TIMx
->
CR2
 = 
tmp2
;

568 
TIMx
->
CCMR2
 = 
tmpccmrx
;

571 
TIMx
->
CCR4
 = 
TIM_OCInSu
->
TIM_Pul
;

574 
TIMx
->
CCER
 = 
tmpcr
;

575 
	}
}

585 
	$TIM_ICIn
(
TIM_TyDef
* 
TIMx
, 
TIM_ICInTyDef
* 
TIM_ICInSu
)

588 
	`as_m
(
	`IS_TIM_CHANNEL
(
TIM_ICInSu
->
TIM_Chl
));

589 
	`as_m
(
	`IS_TIM_IC_SELECTION
(
TIM_ICInSu
->
TIM_ICSei
));

590 
	`as_m
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICInSu
->
TIM_ICPsr
));

591 
	`as_m
(
	`IS_TIM_IC_FILTER
(
TIM_ICInSu
->
TIM_ICFr
));

593 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
|| (TIMx =
TIM2
|| (TIMx =
TIM3
) ||

594 (
TIMx
 =
TIM4
||(TIMx =
TIM5
))

596 
	`as_m
(
	`IS_TIM_IC_POLARITY
(
TIM_ICInSu
->
TIM_ICPެy
));

600 
	`as_m
(
	`IS_TIM_IC_POLARITY_LITE
(
TIM_ICInSu
->
TIM_ICPެy
));

602 i(
TIM_ICInSu
->
TIM_Chl
 =
TIM_Chl_1
)

604 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

606 
	`TI1_Cfig
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPެy
,

607 
TIM_ICInSu
->
TIM_ICSei
,

608 
TIM_ICInSu
->
TIM_ICFr
);

610 
	`TIM_SIC1Psr
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPsr
);

612 i(
TIM_ICInSu
->
TIM_Chl
 =
TIM_Chl_2
)

614 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

616 
	`TI2_Cfig
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPެy
,

617 
TIM_ICInSu
->
TIM_ICSei
,

618 
TIM_ICInSu
->
TIM_ICFr
);

620 
	`TIM_SIC2Psr
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPsr
);

622 i(
TIM_ICInSu
->
TIM_Chl
 =
TIM_Chl_3
)

624 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

626 
	`TI3_Cfig
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPެy
,

627 
TIM_ICInSu
->
TIM_ICSei
,

628 
TIM_ICInSu
->
TIM_ICFr
);

630 
	`TIM_SIC3Psr
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPsr
);

634 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

636 
	`TI4_Cfig
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPެy
,

637 
TIM_ICInSu
->
TIM_ICSei
,

638 
TIM_ICInSu
->
TIM_ICFr
);

640 
	`TIM_SIC4Psr
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPsr
);

642 
	}
}

652 
	$TIM_PWMICfig
(
TIM_TyDef
* 
TIMx
, 
TIM_ICInTyDef
* 
TIM_ICInSu
)

654 
ut16_t
 
icposެy
 = 
TIM_ICPެy_Risg
;

655 
ut16_t
 
icposei
 = 
TIM_ICSei_DeTI
;

657 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

659 i(
TIM_ICInSu
->
TIM_ICPެy
 =
TIM_ICPެy_Risg
)

661 
icposެy
 = 
TIM_ICPެy_Flg
;

665 
icposެy
 = 
TIM_ICPެy_Risg
;

668 i(
TIM_ICInSu
->
TIM_ICSei
 =
TIM_ICSei_DeTI
)

670 
icposei
 = 
TIM_ICSei_IndeTI
;

674 
icposei
 = 
TIM_ICSei_DeTI
;

676 i(
TIM_ICInSu
->
TIM_Chl
 =
TIM_Chl_1
)

679 
	`TI1_Cfig
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPެy
, TIM_ICInSu->
TIM_ICSei
,

680 
TIM_ICInSu
->
TIM_ICFr
);

682 
	`TIM_SIC1Psr
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPsr
);

684 
	`TI2_Cfig
(
TIMx
, 
icposެy
, 
icposei
, 
TIM_ICInSu
->
TIM_ICFr
);

686 
	`TIM_SIC2Psr
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPsr
);

691 
	`TI2_Cfig
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPެy
, TIM_ICInSu->
TIM_ICSei
,

692 
TIM_ICInSu
->
TIM_ICFr
);

694 
	`TIM_SIC2Psr
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPsr
);

696 
	`TI1_Cfig
(
TIMx
, 
icposެy
, 
icposei
, 
TIM_ICInSu
->
TIM_ICFr
);

698 
	`TIM_SIC1Psr
(
TIMx
, 
TIM_ICInSu
->
TIM_ICPsr
);

700 
	}
}

710 
	$TIM_BDTRCfig
(
TIM_TyDef
* 
TIMx
, 
TIM_BDTRInTyDef
 *
TIM_BDTRInSu
)

713 
	`as_m
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

714 
	`as_m
(
	`IS_TIM_OSSR_STATE
(
TIM_BDTRInSu
->
TIM_OSSRS
));

715 
	`as_m
(
	`IS_TIM_OSSI_STATE
(
TIM_BDTRInSu
->
TIM_OSSIS
));

716 
	`as_m
(
	`IS_TIM_LOCK_LEVEL
(
TIM_BDTRInSu
->
TIM_LOCKLev
));

717 
	`as_m
(
	`IS_TIM_BREAK_STATE
(
TIM_BDTRInSu
->
TIM_Bak
));

718 
	`as_m
(
	`IS_TIM_BREAK_POLARITY
(
TIM_BDTRInSu
->
TIM_BakPެy
));

719 
	`as_m
(
	`IS_TIM_AUTOMATIC_OUTPUT_STATE
(
TIM_BDTRInSu
->
TIM_AutomicOuut
));

722 
TIMx
->
BDTR
 = (
ut32_t
)
TIM_BDTRInSu
->
TIM_OSSRS
 | TIM_BDTRInSu->
TIM_OSSIS
 |

723 
TIM_BDTRInSu
->
TIM_LOCKLev
 | TIM_BDTRInSu->
TIM_DdTime
 |

724 
TIM_BDTRInSu
->
TIM_Bak
 | TIM_BDTRInSu->
TIM_BakPެy
 |

725 
TIM_BDTRInSu
->
TIM_AutomicOuut
;

726 
	}
}

734 
	$TIM_TimeBaSuIn
(
TIM_TimeBaInTyDef
* 
TIM_TimeBaInSu
)

737 
TIM_TimeBaInSu
->
TIM_Piod
 = 0xFFFF;

738 
TIM_TimeBaInSu
->
TIM_Psr
 = 0x0000;

739 
TIM_TimeBaInSu
->
TIM_ClockDivisi
 = 
TIM_CKD_DIV1
;

740 
TIM_TimeBaInSu
->
TIM_CouMode
 = 
TIM_CouMode_Up
;

741 
TIM_TimeBaInSu
->
TIM_RiCou
 = 0x0000;

742 
	}
}

750 
	$TIM_OCSuIn
(
TIM_OCInTyDef
* 
TIM_OCInSu
)

753 
TIM_OCInSu
->
TIM_OCMode
 = 
TIM_OCMode_Timg
;

754 
TIM_OCInSu
->
TIM_OuutS
 = 
TIM_OuutS_Dib
;

755 
TIM_OCInSu
->
TIM_OuutNS
 = 
TIM_OuutNS_Dib
;

756 
TIM_OCInSu
->
TIM_Pul
 = 0x0000;

757 
TIM_OCInSu
->
TIM_OCPެy
 = 
TIM_OCPެy_High
;

758 
TIM_OCInSu
->
TIM_OCNPެy
 = 
TIM_OCPެy_High
;

759 
TIM_OCInSu
->
TIM_OCIdS
 = 
TIM_OCIdS_Ret
;

760 
TIM_OCInSu
->
TIM_OCNIdS
 = 
TIM_OCNIdS_Ret
;

761 
	}
}

769 
	$TIM_ICSuIn
(
TIM_ICInTyDef
* 
TIM_ICInSu
)

772 
TIM_ICInSu
->
TIM_Chl
 = 
TIM_Chl_1
;

773 
TIM_ICInSu
->
TIM_ICPެy
 = 
TIM_ICPެy_Risg
;

774 
TIM_ICInSu
->
TIM_ICSei
 = 
TIM_ICSei_DeTI
;

775 
TIM_ICInSu
->
TIM_ICPsr
 = 
TIM_ICPSC_DIV1
;

776 
TIM_ICInSu
->
TIM_ICFr
 = 0x00;

777 
	}
}

785 
	$TIM_BDTRSuIn
(
TIM_BDTRInTyDef
* 
TIM_BDTRInSu
)

788 
TIM_BDTRInSu
->
TIM_OSSRS
 = 
TIM_OSSRS_Dib
;

789 
TIM_BDTRInSu
->
TIM_OSSIS
 = 
TIM_OSSIS_Dib
;

790 
TIM_BDTRInSu
->
TIM_LOCKLev
 = 
TIM_LOCKLev_OFF
;

791 
TIM_BDTRInSu
->
TIM_DdTime
 = 0x00;

792 
TIM_BDTRInSu
->
TIM_Bak
 = 
TIM_Bak_Dib
;

793 
TIM_BDTRInSu
->
TIM_BakPެy
 = 
TIM_BakPެy_Low
;

794 
TIM_BDTRInSu
->
TIM_AutomicOuut
 = 
TIM_AutomicOuut_Dib
;

795 
	}
}

804 
	$TIM_Cmd
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
)

807 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

808 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

810 i(
NewS
 !
DISABLE
)

813 
TIMx
->
CR1
 |
TIM_CR1_CEN
;

818 
TIMx
->
CR1
 &(
ut16_t
)(~((ut16_t)
TIM_CR1_CEN
));

820 
	}
}

829 
	$TIM_ClPWMOuuts
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
)

832 
	`as_m
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

833 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

834 i(
NewS
 !
DISABLE
)

837 
TIMx
->
BDTR
 |
TIM_BDTR_MOE
;

842 
TIMx
->
BDTR
 &(
ut16_t
)(~((ut16_t)
TIM_BDTR_MOE
));

844 
	}
}

870 
	$TIM_ITCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IT
, 
FuniڮS
 
NewS
)

873 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

874 
	`as_m
(
	`IS_TIM_IT
(
TIM_IT
));

875 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

877 i(
NewS
 !
DISABLE
)

880 
TIMx
->
DIER
 |
TIM_IT
;

885 
TIMx
->
DIER
 &(
ut16_t
)~
TIM_IT
;

887 
	}
}

907 
	$TIM_GeEvt
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_EvtSour
)

910 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

911 
	`as_m
(
	`IS_TIM_EVENT_SOURCE
(
TIM_EvtSour
));

914 
TIMx
->
EGR
 = 
TIM_EvtSour
;

915 
	}
}

935 
	$TIM_DMACfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_DMABa
, ut16_
TIM_DMABurLgth
)

938 
	`as_m
(
	`IS_TIM_LIST4_PERIPH
(
TIMx
));

939 
	`as_m
(
	`IS_TIM_DMA_BASE
(
TIM_DMABa
));

940 
	`as_m
(
	`IS_TIM_DMA_LENGTH
(
TIM_DMABurLgth
));

942 
TIMx
->
DCR
 = 
TIM_DMABa
 | 
TIM_DMABurLgth
;

943 
	}
}

962 
	$TIM_DMACmd
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_DMASour
, 
FuniڮS
 
NewS
)

965 
	`as_m
(
	`IS_TIM_LIST9_PERIPH
(
TIMx
));

966 
	`as_m
(
	`IS_TIM_DMA_SOURCE
(
TIM_DMASour
));

967 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

969 i(
NewS
 !
DISABLE
)

972 
TIMx
->
DIER
 |
TIM_DMASour
;

977 
TIMx
->
DIER
 &(
ut16_t
)~
TIM_DMASour
;

979 
	}
}

987 
	$TIM_IlClockCfig
(
TIM_TyDef
* 
TIMx
)

990 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

992 
TIMx
->
SMCR
 &(
ut16_t
)(~((ut16_t)
TIM_SMCR_SMS
));

993 
	}
}

1006 
	$TIM_ITRxExClockCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IutTriggSour
)

1009 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1010 
	`as_m
(
	`IS_TIM_INTERNAL_TRIGGER_SELECTION
(
TIM_IutTriggSour
));

1012 
	`TIM_SeIutTrigg
(
TIMx
, 
TIM_IutTriggSour
);

1014 
TIMx
->
SMCR
 |
TIM_SveMode_Ex1
;

1015 
	}
}

1033 
	$TIM_TIxExClockCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_TIxExCLKSour
,

1034 
ut16_t
 
TIM_ICPެy
, ut16_
ICFr
)

1037 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1038 
	`as_m
(
	`IS_TIM_TIXCLK_SOURCE
(
TIM_TIxExCLKSour
));

1039 
	`as_m
(
	`IS_TIM_IC_POLARITY
(
TIM_ICPެy
));

1040 
	`as_m
(
	`IS_TIM_IC_FILTER
(
ICFr
));

1042 i(
TIM_TIxExCLKSour
 =
TIM_TIxExCLK1Sour_TI2
)

1044 
	`TI2_Cfig
(
TIMx
, 
TIM_ICPެy
, 
TIM_ICSei_DeTI
, 
ICFr
);

1048 
	`TI1_Cfig
(
TIMx
, 
TIM_ICPެy
, 
TIM_ICSei_DeTI
, 
ICFr
);

1051 
	`TIM_SeIutTrigg
(
TIMx
, 
TIM_TIxExCLKSour
);

1053 
TIMx
->
SMCR
 |
TIM_SveMode_Ex1
;

1054 
	}
}

1073 
	$TIM_ETRClockMode1Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ExtTRGPsr
, ut16_
TIM_ExtTRGPެy
,

1074 
ut16_t
 
ExtTRGFr
)

1076 
ut16_t
 
tmpsm
 = 0;

1078 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1079 
	`as_m
(
	`IS_TIM_EXT_PRESCALER
(
TIM_ExtTRGPsr
));

1080 
	`as_m
(
	`IS_TIM_EXT_POLARITY
(
TIM_ExtTRGPެy
));

1081 
	`as_m
(
	`IS_TIM_EXT_FILTER
(
ExtTRGFr
));

1083 
	`TIM_ETRCfig
(
TIMx
, 
TIM_ExtTRGPsr
, 
TIM_ExtTRGPެy
, 
ExtTRGFr
);

1086 
tmpsm
 = 
TIMx
->
SMCR
;

1088 
tmpsm
 &(
ut16_t
)(~((ut16_t)
TIM_SMCR_SMS
));

1090 
tmpsm
 |
TIM_SveMode_Ex1
;

1092 
tmpsm
 &(
ut16_t
)(~((ut16_t)
TIM_SMCR_TS
));

1093 
tmpsm
 |
TIM_TS_ETRF
;

1095 
TIMx
->
SMCR
 = 
tmpsm
;

1096 
	}
}

1115 
	$TIM_ETRClockMode2Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ExtTRGPsr
,

1116 
ut16_t
 
TIM_ExtTRGPެy
, ut16_
ExtTRGFr
)

1119 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1120 
	`as_m
(
	`IS_TIM_EXT_PRESCALER
(
TIM_ExtTRGPsr
));

1121 
	`as_m
(
	`IS_TIM_EXT_POLARITY
(
TIM_ExtTRGPެy
));

1122 
	`as_m
(
	`IS_TIM_EXT_FILTER
(
ExtTRGFr
));

1124 
	`TIM_ETRCfig
(
TIMx
, 
TIM_ExtTRGPsr
, 
TIM_ExtTRGPެy
, 
ExtTRGFr
);

1126 
TIMx
->
SMCR
 |
TIM_SMCR_ECE
;

1127 
	}
}

1146 
	$TIM_ETRCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ExtTRGPsr
, ut16_
TIM_ExtTRGPެy
,

1147 
ut16_t
 
ExtTRGFr
)

1149 
ut16_t
 
tmpsm
 = 0;

1151 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1152 
	`as_m
(
	`IS_TIM_EXT_PRESCALER
(
TIM_ExtTRGPsr
));

1153 
	`as_m
(
	`IS_TIM_EXT_POLARITY
(
TIM_ExtTRGPެy
));

1154 
	`as_m
(
	`IS_TIM_EXT_FILTER
(
ExtTRGFr
));

1155 
tmpsm
 = 
TIMx
->
SMCR
;

1157 
tmpsm
 &
SMCR_ETR_Mask
;

1159 
tmpsm
 |(
ut16_t
)(
TIM_ExtTRGPsr
 | (ut16_t)(
TIM_ExtTRGPެy
 | (ut16_t)(
ExtTRGFr
 << (uint16_t)8)));

1161 
TIMx
->
SMCR
 = 
tmpsm
;

1162 
	}
}

1174 
	$TIM_PsrCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Psr
, ut16_
TIM_PSCRdMode
)

1177 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

1178 
	`as_m
(
	`IS_TIM_PRESCALER_RELOAD
(
TIM_PSCRdMode
));

1180 
TIMx
->
PSC
 = 
Psr
;

1182 
TIMx
->
EGR
 = 
TIM_PSCRdMode
;

1183 
	}
}

1197 
	$TIM_CouModeCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_CouMode
)

1199 
ut16_t
 
tmp1
 = 0;

1201 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1202 
	`as_m
(
	`IS_TIM_COUNTER_MODE
(
TIM_CouMode
));

1203 
tmp1
 = 
TIMx
->
CR1
;

1205 
tmp1
 &(
ut16_t
)(~((ut16_t)(
TIM_CR1_DIR
 | 
TIM_CR1_CMS
)));

1207 
tmp1
 |
TIM_CouMode
;

1209 
TIMx
->
CR1
 = 
tmp1
;

1210 
	}
}

1227 
	$TIM_SeIutTrigg
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IutTriggSour
)

1229 
ut16_t
 
tmpsm
 = 0;

1231 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1232 
	`as_m
(
	`IS_TIM_TRIGGER_SELECTION
(
TIM_IutTriggSour
));

1234 
tmpsm
 = 
TIMx
->
SMCR
;

1236 
tmpsm
 &(
ut16_t
)(~((ut16_t)
TIM_SMCR_TS
));

1238 
tmpsm
 |
TIM_IutTriggSour
;

1240 
TIMx
->
SMCR
 = 
tmpsm
;

1241 
	}
}

1262 
	$TIM_EncodICfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_EncodMode
,

1263 
ut16_t
 
TIM_IC1Pެy
, ut16_
TIM_IC2Pެy
)

1265 
ut16_t
 
tmpsm
 = 0;

1266 
ut16_t
 
tmpccmr1
 = 0;

1267 
ut16_t
 
tmpcr
 = 0;

1270 
	`as_m
(
	`IS_TIM_LIST5_PERIPH
(
TIMx
));

1271 
	`as_m
(
	`IS_TIM_ENCODER_MODE
(
TIM_EncodMode
));

1272 
	`as_m
(
	`IS_TIM_IC_POLARITY
(
TIM_IC1Pެy
));

1273 
	`as_m
(
	`IS_TIM_IC_POLARITY
(
TIM_IC2Pެy
));

1276 
tmpsm
 = 
TIMx
->
SMCR
;

1279 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1282 
tmpcr
 = 
TIMx
->
CCER
;

1285 
tmpsm
 &(
ut16_t
)(~((ut16_t)
TIM_SMCR_SMS
));

1286 
tmpsm
 |
TIM_EncodMode
;

1289 
tmpccmr1
 &(
ut16_t
)(((ut16_t)~((ut16_t)
TIM_CCMR1_CC1S
)& (ut16_t)(~((ut16_t)
TIM_CCMR1_CC2S
)));

1290 
tmpccmr1
 |
TIM_CCMR1_CC1S_0
 | 
TIM_CCMR1_CC2S_0
;

1293 
tmpcr
 &(
ut16_t
)(((ut16_t)~((ut16_t)
TIM_CCER_CC1P
)& ((ut16_t)~((ut16_t)
TIM_CCER_CC2P
)));

1294 
tmpcr
 |(
ut16_t
)(
TIM_IC1Pެy
 | (ut16_t)(
TIM_IC2Pެy
 << (uint16_t)4));

1297 
TIMx
->
SMCR
 = 
tmpsm
;

1299 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1301 
TIMx
->
CCER
 = 
tmpcr
;

1302 
	}
}

1313 
	$TIM_FdOC1Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FdAi
)

1315 
ut16_t
 
tmpccmr1
 = 0;

1317 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1318 
	`as_m
(
	`IS_TIM_FORCED_ACTION
(
TIM_FdAi
));

1319 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1321 
tmpccmr1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_OC1M
);

1323 
tmpccmr1
 |
TIM_FdAi
;

1325 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1326 
	}
}

1337 
	$TIM_FdOC2Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FdAi
)

1339 
ut16_t
 
tmpccmr1
 = 0;

1341 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1342 
	`as_m
(
	`IS_TIM_FORCED_ACTION
(
TIM_FdAi
));

1343 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1345 
tmpccmr1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_OC2M
);

1347 
tmpccmr1
 |(
ut16_t
)(
TIM_FdAi
 << 8);

1349 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1350 
	}
}

1361 
	$TIM_FdOC3Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FdAi
)

1363 
ut16_t
 
tmpccmr2
 = 0;

1365 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1366 
	`as_m
(
	`IS_TIM_FORCED_ACTION
(
TIM_FdAi
));

1367 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1369 
tmpccmr2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_OC3M
);

1371 
tmpccmr2
 |
TIM_FdAi
;

1373 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1374 
	}
}

1385 
	$TIM_FdOC4Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FdAi
)

1387 
ut16_t
 
tmpccmr2
 = 0;

1389 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1390 
	`as_m
(
	`IS_TIM_FORCED_ACTION
(
TIM_FdAi
));

1391 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1393 
tmpccmr2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_OC4M
);

1395 
tmpccmr2
 |(
ut16_t
)(
TIM_FdAi
 << 8);

1397 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1398 
	}
}

1407 
	$TIM_ARRPldCfig
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
)

1410 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

1411 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1412 i(
NewS
 !
DISABLE
)

1415 
TIMx
->
CR1
 |
TIM_CR1_ARPE
;

1420 
TIMx
->
CR1
 &(
ut16_t
)~((ut16_t)
TIM_CR1_ARPE
);

1422 
	}
}

1431 
	$TIM_SeCOM
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
)

1434 
	`as_m
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

1435 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1436 i(
NewS
 !
DISABLE
)

1439 
TIMx
->
CR2
 |
TIM_CR2_CCUS
;

1444 
TIMx
->
CR2
 &(
ut16_t
)~((ut16_t)
TIM_CR2_CCUS
);

1446 
	}
}

1456 
	$TIM_SeCCDMA
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
)

1459 
	`as_m
(
	`IS_TIM_LIST4_PERIPH
(
TIMx
));

1460 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1461 i(
NewS
 !
DISABLE
)

1464 
TIMx
->
CR2
 |
TIM_CR2_CCDS
;

1469 
TIMx
->
CR2
 &(
ut16_t
)~((ut16_t)
TIM_CR2_CCDS
);

1471 
	}
}

1481 
	$TIM_CCPldCڌ
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
)

1484 
	`as_m
(
	`IS_TIM_LIST5_PERIPH
(
TIMx
));

1485 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

1486 i(
NewS
 !
DISABLE
)

1489 
TIMx
->
CR2
 |
TIM_CR2_CCPC
;

1494 
TIMx
->
CR2
 &(
ut16_t
)~((ut16_t)
TIM_CR2_CCPC
);

1496 
	}
}

1507 
	$TIM_OC1PldCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPld
)

1509 
ut16_t
 
tmpccmr1
 = 0;

1511 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1512 
	`as_m
(
	`IS_TIM_OCPRELOAD_STATE
(
TIM_OCPld
));

1513 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1515 
tmpccmr1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_OC1PE
);

1517 
tmpccmr1
 |
TIM_OCPld
;

1519 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1520 
	}
}

1532 
	$TIM_OC2PldCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPld
)

1534 
ut16_t
 
tmpccmr1
 = 0;

1536 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1537 
	`as_m
(
	`IS_TIM_OCPRELOAD_STATE
(
TIM_OCPld
));

1538 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1540 
tmpccmr1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_OC2PE
);

1542 
tmpccmr1
 |(
ut16_t
)(
TIM_OCPld
 << 8);

1544 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1545 
	}
}

1556 
	$TIM_OC3PldCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPld
)

1558 
ut16_t
 
tmpccmr2
 = 0;

1560 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1561 
	`as_m
(
	`IS_TIM_OCPRELOAD_STATE
(
TIM_OCPld
));

1562 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1564 
tmpccmr2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_OC3PE
);

1566 
tmpccmr2
 |
TIM_OCPld
;

1568 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1569 
	}
}

1580 
	$TIM_OC4PldCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPld
)

1582 
ut16_t
 
tmpccmr2
 = 0;

1584 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1585 
	`as_m
(
	`IS_TIM_OCPRELOAD_STATE
(
TIM_OCPld
));

1586 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1588 
tmpccmr2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_OC4PE
);

1590 
tmpccmr2
 |(
ut16_t
)(
TIM_OCPld
 << 8);

1592 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1593 
	}
}

1604 
	$TIM_OC1FaCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCFa
)

1606 
ut16_t
 
tmpccmr1
 = 0;

1608 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1609 
	`as_m
(
	`IS_TIM_OCFAST_STATE
(
TIM_OCFa
));

1611 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1613 
tmpccmr1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_OC1FE
);

1615 
tmpccmr1
 |
TIM_OCFa
;

1617 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1618 
	}
}

1630 
	$TIM_OC2FaCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCFa
)

1632 
ut16_t
 
tmpccmr1
 = 0;

1634 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1635 
	`as_m
(
	`IS_TIM_OCFAST_STATE
(
TIM_OCFa
));

1637 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1639 
tmpccmr1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_OC2FE
);

1641 
tmpccmr1
 |(
ut16_t
)(
TIM_OCFa
 << 8);

1643 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1644 
	}
}

1655 
	$TIM_OC3FaCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCFa
)

1657 
ut16_t
 
tmpccmr2
 = 0;

1659 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1660 
	`as_m
(
	`IS_TIM_OCFAST_STATE
(
TIM_OCFa
));

1662 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1664 
tmpccmr2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_OC3FE
);

1666 
tmpccmr2
 |
TIM_OCFa
;

1668 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1669 
	}
}

1680 
	$TIM_OC4FaCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCFa
)

1682 
ut16_t
 
tmpccmr2
 = 0;

1684 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1685 
	`as_m
(
	`IS_TIM_OCFAST_STATE
(
TIM_OCFa
));

1687 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1689 
tmpccmr2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_OC4FE
);

1691 
tmpccmr2
 |(
ut16_t
)(
TIM_OCFa
 << 8);

1693 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1694 
	}
}

1705 
	$TIM_CˬOC1Ref
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCCˬ
)

1707 
ut16_t
 
tmpccmr1
 = 0;

1709 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1710 
	`as_m
(
	`IS_TIM_OCCLEAR_STATE
(
TIM_OCCˬ
));

1712 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1715 
tmpccmr1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_OC1CE
);

1717 
tmpccmr1
 |
TIM_OCCˬ
;

1719 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1720 
	}
}

1731 
	$TIM_CˬOC2Ref
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCCˬ
)

1733 
ut16_t
 
tmpccmr1
 = 0;

1735 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1736 
	`as_m
(
	`IS_TIM_OCCLEAR_STATE
(
TIM_OCCˬ
));

1737 
tmpccmr1
 = 
TIMx
->
CCMR1
;

1739 
tmpccmr1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_OC2CE
);

1741 
tmpccmr1
 |(
ut16_t
)(
TIM_OCCˬ
 << 8);

1743 
TIMx
->
CCMR1
 = 
tmpccmr1
;

1744 
	}
}

1755 
	$TIM_CˬOC3Ref
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCCˬ
)

1757 
ut16_t
 
tmpccmr2
 = 0;

1759 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1760 
	`as_m
(
	`IS_TIM_OCCLEAR_STATE
(
TIM_OCCˬ
));

1761 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1763 
tmpccmr2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_OC3CE
);

1765 
tmpccmr2
 |
TIM_OCCˬ
;

1767 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1768 
	}
}

1779 
	$TIM_CˬOC4Ref
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCCˬ
)

1781 
ut16_t
 
tmpccmr2
 = 0;

1783 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1784 
	`as_m
(
	`IS_TIM_OCCLEAR_STATE
(
TIM_OCCˬ
));

1785 
tmpccmr2
 = 
TIMx
->
CCMR2
;

1787 
tmpccmr2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_OC4CE
);

1789 
tmpccmr2
 |(
ut16_t
)(
TIM_OCCˬ
 << 8);

1791 
TIMx
->
CCMR2
 = 
tmpccmr2
;

1792 
	}
}

1803 
	$TIM_OC1PެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPެy
)

1805 
ut16_t
 
tmpcr
 = 0;

1807 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1808 
	`as_m
(
	`IS_TIM_OC_POLARITY
(
TIM_OCPެy
));

1809 
tmpcr
 = 
TIMx
->
CCER
;

1811 
tmpcr
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC1P
);

1812 
tmpcr
 |
TIM_OCPެy
;

1814 
TIMx
->
CCER
 = 
tmpcr
;

1815 
	}
}

1826 
	$TIM_OC1NPެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCNPެy
)

1828 
ut16_t
 
tmpcr
 = 0;

1830 
	`as_m
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

1831 
	`as_m
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCNPެy
));

1833 
tmpcr
 = 
TIMx
->
CCER
;

1835 
tmpcr
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC1NP
);

1836 
tmpcr
 |
TIM_OCNPެy
;

1838 
TIMx
->
CCER
 = 
tmpcr
;

1839 
	}
}

1850 
	$TIM_OC2PެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPެy
)

1852 
ut16_t
 
tmpcr
 = 0;

1854 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

1855 
	`as_m
(
	`IS_TIM_OC_POLARITY
(
TIM_OCPެy
));

1856 
tmpcr
 = 
TIMx
->
CCER
;

1858 
tmpcr
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC2P
);

1859 
tmpcr
 |(
ut16_t
)(
TIM_OCPެy
 << 4);

1861 
TIMx
->
CCER
 = 
tmpcr
;

1862 
	}
}

1873 
	$TIM_OC2NPެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCNPެy
)

1875 
ut16_t
 
tmpcr
 = 0;

1877 
	`as_m
(
	`IS_TIM_LIST1_PERIPH
(
TIMx
));

1878 
	`as_m
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCNPެy
));

1880 
tmpcr
 = 
TIMx
->
CCER
;

1882 
tmpcr
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC2NP
);

1883 
tmpcr
 |(
ut16_t
)(
TIM_OCNPެy
 << 4);

1885 
TIMx
->
CCER
 = 
tmpcr
;

1886 
	}
}

1897 
	$TIM_OC3PެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPެy
)

1899 
ut16_t
 
tmpcr
 = 0;

1901 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1902 
	`as_m
(
	`IS_TIM_OC_POLARITY
(
TIM_OCPެy
));

1903 
tmpcr
 = 
TIMx
->
CCER
;

1905 
tmpcr
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC3P
);

1906 
tmpcr
 |(
ut16_t
)(
TIM_OCPެy
 << 8);

1908 
TIMx
->
CCER
 = 
tmpcr
;

1909 
	}
}

1920 
	$TIM_OC3NPެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCNPެy
)

1922 
ut16_t
 
tmpcr
 = 0;

1925 
	`as_m
(
	`IS_TIM_LIST1_PERIPH
(
TIMx
));

1926 
	`as_m
(
	`IS_TIM_OCN_POLARITY
(
TIM_OCNPެy
));

1928 
tmpcr
 = 
TIMx
->
CCER
;

1930 
tmpcr
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC3NP
);

1931 
tmpcr
 |(
ut16_t
)(
TIM_OCNPެy
 << 8);

1933 
TIMx
->
CCER
 = 
tmpcr
;

1934 
	}
}

1945 
	$TIM_OC4PެyCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OCPެy
)

1947 
ut16_t
 
tmpcr
 = 0;

1949 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

1950 
	`as_m
(
	`IS_TIM_OC_POLARITY
(
TIM_OCPެy
));

1951 
tmpcr
 = 
TIMx
->
CCER
;

1953 
tmpcr
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC4P
);

1954 
tmpcr
 |(
ut16_t
)(
TIM_OCPެy
 << 12);

1956 
TIMx
->
CCER
 = 
tmpcr
;

1957 
	}
}

1972 
	$TIM_CCxCmd
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_Chl
, ut16_
TIM_CCx
)

1974 
ut16_t
 
tmp
 = 0;

1977 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

1978 
	`as_m
(
	`IS_TIM_CHANNEL
(
TIM_Chl
));

1979 
	`as_m
(
	`IS_TIM_CCX
(
TIM_CCx
));

1981 
tmp
 = 
CCER_CCE_S
 << 
TIM_Chl
;

1984 
TIMx
->
CCER
 &(
ut16_t
)~ 
tmp
;

1987 
TIMx
->
CCER
 |(
ut16_t
)(
TIM_CCx
 << 
TIM_Chl
);

1988 
	}
}

2002 
	$TIM_CCxNCmd
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_Chl
, ut16_
TIM_CCxN
)

2004 
ut16_t
 
tmp
 = 0;

2007 
	`as_m
(
	`IS_TIM_LIST2_PERIPH
(
TIMx
));

2008 
	`as_m
(
	`IS_TIM_COMPLEMENTARY_CHANNEL
(
TIM_Chl
));

2009 
	`as_m
(
	`IS_TIM_CCXN
(
TIM_CCxN
));

2011 
tmp
 = 
CCER_CCNE_S
 << 
TIM_Chl
;

2014 
TIMx
->
CCER
 &(
ut16_t
~
tmp
;

2017 
TIMx
->
CCER
 |(
ut16_t
)(
TIM_CCxN
 << 
TIM_Chl
);

2018 
	}
}

2043 
	$TIM_SeOCxM
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_Chl
, ut16_
TIM_OCMode
)

2045 
ut32_t
 
tmp
 = 0;

2046 
ut16_t
 
tmp1
 = 0;

2049 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2050 
	`as_m
(
	`IS_TIM_CHANNEL
(
TIM_Chl
));

2051 
	`as_m
(
	`IS_TIM_OCM
(
TIM_OCMode
));

2053 
tmp
 = (
ut32_t

TIMx
;

2054 
tmp
 +
CCMR_Offt
;

2056 
tmp1
 = 
CCER_CCE_S
 << (
ut16_t
)
TIM_Chl
;

2059 
TIMx
->
CCER
 &(
ut16_t
~
tmp1
;

2061 if((
TIM_Chl
 =
TIM_Chl_1
||(TIM_Ch=
TIM_Chl_3
))

2063 
tmp
 +(
TIM_Chl
>>1);

2066 *(
__IO
 
ut32_t
 *
tmp
 &(ut32_t)~((ut32_t)
TIM_CCMR1_OC1M
);

2069 *(
__IO
 
ut32_t
 *
tmp
 |
TIM_OCMode
;

2073 
tmp
 +(
ut16_t
)(
TIM_Chl
 - (uint16_t)4)>> (uint16_t)1;

2076 *(
__IO
 
ut32_t
 *
tmp
 &(ut32_t)~((ut32_t)
TIM_CCMR1_OC2M
);

2079 *(
__IO
 
ut32_t
 *
tmp
 |(
ut16_t
)(
TIM_OCMode
 << 8);

2081 
	}
}

2090 
	$TIM_UpdeDibCfig
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
)

2093 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2094 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

2095 i(
NewS
 !
DISABLE
)

2098 
TIMx
->
CR1
 |
TIM_CR1_UDIS
;

2103 
TIMx
->
CR1
 &(
ut16_t
)~((ut16_t)
TIM_CR1_UDIS
);

2105 
	}
}

2118 
	$TIM_UpdeRequeCfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_UpdeSour
)

2121 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2122 
	`as_m
(
	`IS_TIM_UPDATE_SOURCE
(
TIM_UpdeSour
));

2123 i(
TIM_UpdeSour
 !
TIM_UpdeSour_Glob
)

2126 
TIMx
->
CR1
 |
TIM_CR1_URS
;

2131 
TIMx
->
CR1
 &(
ut16_t
)~((ut16_t)
TIM_CR1_URS
);

2133 
	}
}

2142 
	$TIM_SeHlSs
(
TIM_TyDef
* 
TIMx
, 
FuniڮS
 
NewS
)

2145 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2146 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

2147 i(
NewS
 !
DISABLE
)

2150 
TIMx
->
CR2
 |
TIM_CR2_TI1S
;

2155 
TIMx
->
CR2
 &(
ut16_t
)~((ut16_t)
TIM_CR2_TI1S
);

2157 
	}
}

2168 
	$TIM_SeOPulMode
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_OPMode
)

2171 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2172 
	`as_m
(
	`IS_TIM_OPM_MODE
(
TIM_OPMode
));

2174 
TIMx
->
CR1
 &(
ut16_t
)~((ut16_t)
TIM_CR1_OPM
);

2176 
TIMx
->
CR1
 |
TIM_OPMode
;

2177 
	}
}

2200 
	$TIM_SeOuutTrigg
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_TRGOSour
)

2203 
	`as_m
(
	`IS_TIM_LIST7_PERIPH
(
TIMx
));

2204 
	`as_m
(
	`IS_TIM_TRGO_SOURCE
(
TIM_TRGOSour
));

2206 
TIMx
->
CR2
 &(
ut16_t
)~((ut16_t)
TIM_CR2_MMS
);

2208 
TIMx
->
CR2
 |
TIM_TRGOSour
;

2209 
	}
}

2223 
	$TIM_SeSveMode
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_SveMode
)

2226 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2227 
	`as_m
(
	`IS_TIM_SLAVE_MODE
(
TIM_SveMode
));

2229 
TIMx
->
SMCR
 &(
ut16_t
)~((ut16_t)
TIM_SMCR_SMS
);

2231 
TIMx
->
SMCR
 |
TIM_SveMode
;

2232 
	}
}

2244 
	$TIM_SeMaSveMode
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_MaSveMode
)

2247 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2248 
	`as_m
(
	`IS_TIM_MSM_STATE
(
TIM_MaSveMode
));

2250 
TIMx
->
SMCR
 &(
ut16_t
)~((ut16_t)
TIM_SMCR_MSM
);

2253 
TIMx
->
SMCR
 |
TIM_MaSveMode
;

2254 
	}
}

2262 
	$TIM_SCou
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Cou
)

2265 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2267 
TIMx
->
CNT
 = 
Cou
;

2268 
	}
}

2276 
	$TIM_SAutܖd
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Autܖd
)

2279 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2281 
TIMx
->
ARR
 = 
Autܖd
;

2282 
	}
}

2290 
	$TIM_SCom1
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Com1
)

2293 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2295 
TIMx
->
CCR1
 = 
Com1
;

2296 
	}
}

2304 
	$TIM_SCom2
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Com2
)

2307 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2309 
TIMx
->
CCR2
 = 
Com2
;

2310 
	}
}

2318 
	$TIM_SCom3
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Com3
)

2321 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2323 
TIMx
->
CCR3
 = 
Com3
;

2324 
	}
}

2332 
	$TIM_SCom4
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
Com4
)

2335 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2337 
TIMx
->
CCR4
 = 
Com4
;

2338 
	}
}

2351 
	$TIM_SIC1Psr
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPSC
)

2354 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2355 
	`as_m
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICPSC
));

2357 
TIMx
->
CCMR1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_IC1PSC
);

2359 
TIMx
->
CCMR1
 |
TIM_ICPSC
;

2360 
	}
}

2373 
	$TIM_SIC2Psr
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPSC
)

2376 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2377 
	`as_m
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICPSC
));

2379 
TIMx
->
CCMR1
 &(
ut16_t
)~((ut16_t)
TIM_CCMR1_IC2PSC
);

2381 
TIMx
->
CCMR1
 |(
ut16_t
)(
TIM_ICPSC
 << 8);

2382 
	}
}

2395 
	$TIM_SIC3Psr
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPSC
)

2398 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2399 
	`as_m
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICPSC
));

2401 
TIMx
->
CCMR2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_IC3PSC
);

2403 
TIMx
->
CCMR2
 |
TIM_ICPSC
;

2404 
	}
}

2417 
	$TIM_SIC4Psr
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPSC
)

2420 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2421 
	`as_m
(
	`IS_TIM_IC_PRESCALER
(
TIM_ICPSC
));

2423 
TIMx
->
CCMR2
 &(
ut16_t
)~((ut16_t)
TIM_CCMR2_IC4PSC
);

2425 
TIMx
->
CCMR2
 |(
ut16_t
)(
TIM_ICPSC
 << 8);

2426 
	}
}

2439 
	$TIM_SClockDivisi
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_CKD
)

2442 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2443 
	`as_m
(
	`IS_TIM_CKD_DIV
(
TIM_CKD
));

2445 
TIMx
->
CR1
 &(
ut16_t
)~((ut16_t)
TIM_CR1_CKD
);

2447 
TIMx
->
CR1
 |
TIM_CKD
;

2448 
	}
}

2455 
ut16_t
 
	$TIM_GCtu1
(
TIM_TyDef
* 
TIMx
)

2458 
	`as_m
(
	`IS_TIM_LIST8_PERIPH
(
TIMx
));

2460  
TIMx
->
CCR1
;

2461 
	}
}

2468 
ut16_t
 
	$TIM_GCtu2
(
TIM_TyDef
* 
TIMx
)

2471 
	`as_m
(
	`IS_TIM_LIST6_PERIPH
(
TIMx
));

2473  
TIMx
->
CCR2
;

2474 
	}
}

2481 
ut16_t
 
	$TIM_GCtu3
(
TIM_TyDef
* 
TIMx
)

2484 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2486  
TIMx
->
CCR3
;

2487 
	}
}

2494 
ut16_t
 
	$TIM_GCtu4
(
TIM_TyDef
* 
TIMx
)

2497 
	`as_m
(
	`IS_TIM_LIST3_PERIPH
(
TIMx
));

2499  
TIMx
->
CCR4
;

2500 
	}
}

2507 
ut16_t
 
	$TIM_GCou
(
TIM_TyDef
* 
TIMx
)

2510 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2512  
TIMx
->
CNT
;

2513 
	}
}

2520 
ut16_t
 
	$TIM_GPsr
(
TIM_TyDef
* 
TIMx
)

2523 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2525  
TIMx
->
PSC
;

2526 
	}
}

2554 
FgStus
 
	$TIM_GFgStus
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FLAG
)

2556 
ITStus
 
bus
 = 
RESET
;

2558 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2559 
	`as_m
(
	`IS_TIM_GET_FLAG
(
TIM_FLAG
));

2561 i((
TIMx
->
SR
 & 
TIM_FLAG
!(
ut16_t
)
RESET
)

2563 
bus
 = 
SET
;

2567 
bus
 = 
RESET
;

2569  
bus
;

2570 
	}
}

2598 
	$TIM_CˬFg
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_FLAG
)

2601 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2602 
	`as_m
(
	`IS_TIM_CLEAR_FLAG
(
TIM_FLAG
));

2605 
TIMx
->
SR
 = (
ut16_t
)~
TIM_FLAG
;

2606 
	}
}

2630 
ITStus
 
	$TIM_GITStus
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IT
)

2632 
ITStus
 
bus
 = 
RESET
;

2633 
ut16_t
 
us
 = 0x0, 
ab
 = 0x0;

2635 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2636 
	`as_m
(
	`IS_TIM_GET_IT
(
TIM_IT
));

2638 
us
 = 
TIMx
->
SR
 & 
TIM_IT
;

2640 
ab
 = 
TIMx
->
DIER
 & 
TIM_IT
;

2641 i((
us
 !(
ut16_t
)
RESET
&& (
ab
 != (uint16_t)RESET))

2643 
bus
 = 
SET
;

2647 
bus
 = 
RESET
;

2649  
bus
;

2650 
	}
}

2674 
	$TIM_CˬITPdgB
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_IT
)

2677 
	`as_m
(
	`IS_TIM_ALL_PERIPH
(
TIMx
));

2678 
	`as_m
(
	`IS_TIM_IT
(
TIM_IT
));

2680 
TIMx
->
SR
 = (
ut16_t
)~
TIM_IT
;

2681 
	}
}

2699 
	$TI1_Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPެy
, ut16_
TIM_ICSei
,

2700 
ut16_t
 
TIM_ICFr
)

2702 
ut16_t
 
tmpccmr1
 = 0, 
tmpcr
 = 0;

2704 
TIMx
->
CCER
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC1E
);

2705 
tmpccmr1
 = 
TIMx
->
CCMR1
;

2706 
tmpcr
 = 
TIMx
->
CCER
;

2708 
tmpccmr1
 &(
ut16_t
)(((ut16_t)~((ut16_t)
TIM_CCMR1_CC1S
)& ((ut16_t)~((ut16_t)
TIM_CCMR1_IC1F
)));

2709 
tmpccmr1
 |(
ut16_t
)(
TIM_ICSei
 | (ut16_t)(
TIM_ICFr
 << (uint16_t)4));

2711 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
|| (TIMx =
TIM2
|| (TIMx =
TIM3
) ||

2712 (
TIMx
 =
TIM4
||(TIMx =
TIM5
))

2715 
tmpcr
 &(
ut16_t
)~((ut16_t)(
TIM_CCER_CC1P
));

2716 
tmpcr
 |(
ut16_t
)(
TIM_ICPެy
 | (ut16_t)
TIM_CCER_CC1E
);

2721 
tmpcr
 &(
ut16_t
)~((ut16_t)(
TIM_CCER_CC1P
 | 
TIM_CCER_CC1NP
));

2722 
tmpcr
 |(
ut16_t
)(
TIM_ICPެy
 | (ut16_t)
TIM_CCER_CC1E
);

2726 
TIMx
->
CCMR1
 = 
tmpccmr1
;

2727 
TIMx
->
CCER
 = 
tmpcr
;

2728 
	}
}

2746 
	$TI2_Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPެy
, ut16_
TIM_ICSei
,

2747 
ut16_t
 
TIM_ICFr
)

2749 
ut16_t
 
tmpccmr1
 = 0, 
tmpcr
 = 0, 
tmp
 = 0;

2751 
TIMx
->
CCER
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC2E
);

2752 
tmpccmr1
 = 
TIMx
->
CCMR1
;

2753 
tmpcr
 = 
TIMx
->
CCER
;

2754 
tmp
 = (
ut16_t
)(
TIM_ICPެy
 << 4);

2756 
tmpccmr1
 &(
ut16_t
)(((ut16_t)~((ut16_t)
TIM_CCMR1_CC2S
)& ((ut16_t)~((ut16_t)
TIM_CCMR1_IC2F
)));

2757 
tmpccmr1
 |(
ut16_t
)(
TIM_ICFr
 << 12);

2758 
tmpccmr1
 |(
ut16_t
)(
TIM_ICSei
 << 8);

2760 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
|| (TIMx =
TIM2
|| (TIMx =
TIM3
) ||

2761 (
TIMx
 =
TIM4
||(TIMx =
TIM5
))

2764 
tmpcr
 &(
ut16_t
)~((ut16_t)(
TIM_CCER_CC2P
));

2765 
tmpcr
 |(
ut16_t
)(
tmp
 | (ut16_t)
TIM_CCER_CC2E
);

2770 
tmpcr
 &(
ut16_t
)~((ut16_t)(
TIM_CCER_CC2P
 | 
TIM_CCER_CC2NP
));

2771 
tmpcr
 |(
ut16_t
)(
TIM_ICPެy
 | (ut16_t)
TIM_CCER_CC2E
);

2775 
TIMx
->
CCMR1
 = 
tmpccmr1
 ;

2776 
TIMx
->
CCER
 = 
tmpcr
;

2777 
	}
}

2795 
	$TI3_Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPެy
, ut16_
TIM_ICSei
,

2796 
ut16_t
 
TIM_ICFr
)

2798 
ut16_t
 
tmpccmr2
 = 0, 
tmpcr
 = 0, 
tmp
 = 0;

2800 
TIMx
->
CCER
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC3E
);

2801 
tmpccmr2
 = 
TIMx
->
CCMR2
;

2802 
tmpcr
 = 
TIMx
->
CCER
;

2803 
tmp
 = (
ut16_t
)(
TIM_ICPެy
 << 8);

2805 
tmpccmr2
 &(
ut16_t
)(((ut16_t)~((ut16_t)
TIM_CCMR2_CC3S
)& ((ut16_t)~((ut16_t)
TIM_CCMR2_IC3F
)));

2806 
tmpccmr2
 |(
ut16_t
)(
TIM_ICSei
 | (ut16_t)(
TIM_ICFr
 << (uint16_t)4));

2808 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
|| (TIMx =
TIM2
|| (TIMx =
TIM3
) ||

2809 (
TIMx
 =
TIM4
||(TIMx =
TIM5
))

2812 
tmpcr
 &(
ut16_t
)~((ut16_t)(
TIM_CCER_CC3P
));

2813 
tmpcr
 |(
ut16_t
)(
tmp
 | (ut16_t)
TIM_CCER_CC3E
);

2818 
tmpcr
 &(
ut16_t
)~((ut16_t)(
TIM_CCER_CC3P
 | 
TIM_CCER_CC3NP
));

2819 
tmpcr
 |(
ut16_t
)(
TIM_ICPެy
 | (ut16_t)
TIM_CCER_CC3E
);

2823 
TIMx
->
CCMR2
 = 
tmpccmr2
;

2824 
TIMx
->
CCER
 = 
tmpcr
;

2825 
	}
}

2843 
	$TI4_Cfig
(
TIM_TyDef
* 
TIMx
, 
ut16_t
 
TIM_ICPެy
, ut16_
TIM_ICSei
,

2844 
ut16_t
 
TIM_ICFr
)

2846 
ut16_t
 
tmpccmr2
 = 0, 
tmpcr
 = 0, 
tmp
 = 0;

2849 
TIMx
->
CCER
 &(
ut16_t
)~((ut16_t)
TIM_CCER_CC4E
);

2850 
tmpccmr2
 = 
TIMx
->
CCMR2
;

2851 
tmpcr
 = 
TIMx
->
CCER
;

2852 
tmp
 = (
ut16_t
)(
TIM_ICPެy
 << 12);

2854 
tmpccmr2
 &(
ut16_t
)((ut16_t)(~(ut16_t)
TIM_CCMR2_CC4S
& ((ut16_t)~((ut16_t)
TIM_CCMR2_IC4F
)));

2855 
tmpccmr2
 |(
ut16_t
)(
TIM_ICSei
 << 8);

2856 
tmpccmr2
 |(
ut16_t
)(
TIM_ICFr
 << 12);

2858 if((
TIMx
 =
TIM1
|| (TIMx =
TIM8
|| (TIMx =
TIM2
|| (TIMx =
TIM3
) ||

2859 (
TIMx
 =
TIM4
||(TIMx =
TIM5
))

2862 
tmpcr
 &(
ut16_t
)~((ut16_t)(
TIM_CCER_CC4P
));

2863 
tmpcr
 |(
ut16_t
)(
tmp
 | (ut16_t)
TIM_CCER_CC4E
);

2868 
tmpcr
 &(
ut16_t
)~((ut16_t)(
TIM_CCER_CC3P
 | 
TIM_CCER_CC4NP
));

2869 
tmpcr
 |(
ut16_t
)(
TIM_ICPެy
 | (ut16_t)
TIM_CCER_CC4E
);

2872 
TIMx
->
CCMR2
 = 
tmpccmr2
;

2873 
TIMx
->
CCER
 = 
tmpcr
;

2874 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_usart.c

22 
	~"m32f10x_u.h
"

23 
	~"m32f10x_rcc.h
"

46 
	#CR1_UE_S
 ((
ut16_t
)0x2000

	)

47 
	#CR1_UE_Ret
 ((
ut16_t
)0xDFFF

	)

49 
	#CR1_WAKE_Mask
 ((
ut16_t
)0xF7FF

	)

51 
	#CR1_RWU_S
 ((
ut16_t
)0x0002

	)

52 
	#CR1_RWU_Ret
 ((
ut16_t
)0xFFFD

	)

53 
	#CR1_SBK_S
 ((
ut16_t
)0x0001

	)

54 
	#CR1_CLEAR_Mask
 ((
ut16_t
)0xE9F3

	)

55 
	#CR2_Addss_Mask
 ((
ut16_t
)0xFFF0

	)

57 
	#CR2_LINEN_S
 ((
ut16_t
)0x4000

	)

58 
	#CR2_LINEN_Ret
 ((
ut16_t
)0xBFFF

	)

60 
	#CR2_LBDL_Mask
 ((
ut16_t
)0xFFDF

	)

61 
	#CR2_STOP_CLEAR_Mask
 ((
ut16_t
)0xCFFF

	)

62 
	#CR2_CLOCK_CLEAR_Mask
 ((
ut16_t
)0xF0FF

	)

64 
	#CR3_SCEN_S
 ((
ut16_t
)0x0020

	)

65 
	#CR3_SCEN_Ret
 ((
ut16_t
)0xFFDF

	)

67 
	#CR3_NACK_S
 ((
ut16_t
)0x0010

	)

68 
	#CR3_NACK_Ret
 ((
ut16_t
)0xFFEF

	)

70 
	#CR3_HDSEL_S
 ((
ut16_t
)0x0008

	)

71 
	#CR3_HDSEL_Ret
 ((
ut16_t
)0xFFF7

	)

73 
	#CR3_IRLP_Mask
 ((
ut16_t
)0xFFFB

	)

74 
	#CR3_CLEAR_Mask
 ((
ut16_t
)0xFCFF

	)

76 
	#CR3_IREN_S
 ((
ut16_t
)0x0002

	)

77 
	#CR3_IREN_Ret
 ((
ut16_t
)0xFFFD

	)

78 
	#GTPR_LSB_Mask
 ((
ut16_t
)0x00FF

	)

79 
	#GTPR_MSB_Mask
 ((
ut16_t
)0xFF00

	)

80 
	#IT_Mask
 ((
ut16_t
)0x001F

	)

83 
	#CR1_OVER8_S
 ((
u16
)0x8000

	)

84 
	#CR1_OVER8_Ret
 ((
u16
)0x7FFF

	)

87 
	#CR3_ONEBITE_S
 ((
u16
)0x0800

	)

88 
	#CR3_ONEBITE_Ret
 ((
u16
)0xF7FF

	)

128 
	$USART_DeIn
(
USART_TyDef
* 
USARTx
)

131 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

133 i(
USARTx
 =
USART1
)

135 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_USART1
, 
ENABLE
);

136 
	`RCC_APB2PhRetCmd
(
RCC_APB2Ph_USART1
, 
DISABLE
);

138 i(
USARTx
 =
USART2
)

140 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_USART2
, 
ENABLE
);

141 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_USART2
, 
DISABLE
);

143 i(
USARTx
 =
USART3
)

145 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_USART3
, 
ENABLE
);

146 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_USART3
, 
DISABLE
);

148 i(
USARTx
 =
UART4
)

150 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_UART4
, 
ENABLE
);

151 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_UART4
, 
DISABLE
);

155 i(
USARTx
 =
UART5
)

157 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_UART5
, 
ENABLE
);

158 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_UART5
, 
DISABLE
);

161 
	}
}

173 
	$USART_In
(
USART_TyDef
* 
USARTx
, 
USART_InTyDef
* 
USART_InSu
)

175 
ut32_t
 
tmeg
 = 0x00, 
bock
 = 0x00;

176 
ut32_t
 
gdivid
 = 0x00;

177 
ut32_t
 
aiڮdivid
 = 0x00;

178 
ut32_t
 
uxba
 = 0;

179 
RCC_ClocksTyDef
 
RCC_ClocksStus
;

181 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

182 
	`as_m
(
	`IS_USART_BAUDRATE
(
USART_InSu
->
USART_BaudRe
));

183 
	`as_m
(
	`IS_USART_WORD_LENGTH
(
USART_InSu
->
USART_WdLgth
));

184 
	`as_m
(
	`IS_USART_STOPBITS
(
USART_InSu
->
USART_StBs
));

185 
	`as_m
(
	`IS_USART_PARITY
(
USART_InSu
->
USART_Py
));

186 
	`as_m
(
	`IS_USART_MODE
(
USART_InSu
->
USART_Mode
));

187 
	`as_m
(
	`IS_USART_HARDWARE_FLOW_CONTROL
(
USART_InSu
->
USART_HdweFlowCڌ
));

189 i(
USART_InSu
->
USART_HdweFlowCڌ
 !
USART_HdweFlowCڌ_Ne
)

191 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

194 
uxba
 = (
ut32_t
)
USARTx
;

197 
tmeg
 = 
USARTx
->
CR2
;

199 
tmeg
 &
CR2_STOP_CLEAR_Mask
;

202 
tmeg
 |(
ut32_t
)
USART_InSu
->
USART_StBs
;

205 
USARTx
->
CR2
 = (
ut16_t
)
tmeg
;

208 
tmeg
 = 
USARTx
->
CR1
;

210 
tmeg
 &
CR1_CLEAR_Mask
;

215 
tmeg
 |(
ut32_t
)
USART_InSu
->
USART_WdLgth
 | USART_InSu->
USART_Py
 |

216 
USART_InSu
->
USART_Mode
;

218 
USARTx
->
CR1
 = (
ut16_t
)
tmeg
;

221 
tmeg
 = 
USARTx
->
CR3
;

223 
tmeg
 &
CR3_CLEAR_Mask
;

226 
tmeg
 |
USART_InSu
->
USART_HdweFlowCڌ
;

228 
USARTx
->
CR3
 = (
ut16_t
)
tmeg
;

232 
	`RCC_GClocksFq
(&
RCC_ClocksStus
);

233 i(
uxba
 =
USART1_BASE
)

235 
bock
 = 
RCC_ClocksStus
.
PCLK2_Fqucy
;

239 
bock
 = 
RCC_ClocksStus
.
PCLK1_Fqucy
;

243 i((
USARTx
->
CR1
 & 
CR1_OVER8_S
) != 0)

246 
gdivid
 = ((25 * 
bock
/ (2 * (
USART_InSu
->
USART_BaudRe
)));

251 
gdivid
 = ((25 * 
bock
/ (4 * (
USART_InSu
->
USART_BaudRe
)));

253 
tmeg
 = (
gdivid
 / 100) << 4;

256 
aiڮdivid
 = 
gdivid
 - (100 * (
tmeg
 >> 4));

259 i((
USARTx
->
CR1
 & 
CR1_OVER8_S
) != 0)

261 
tmeg
 |((((
aiڮdivid
 * 8+ 50/ 100)& ((
ut8_t
)0x07);

265 
tmeg
 |((((
aiڮdivid
 * 16+ 50/ 100)& ((
ut8_t
)0x0F);

269 
USARTx
->
BRR
 = (
ut16_t
)
tmeg
;

270 
	}
}

278 
	$USART_SuIn
(
USART_InTyDef
* 
USART_InSu
)

281 
USART_InSu
->
USART_BaudRe
 = 9600;

282 
USART_InSu
->
USART_WdLgth
 = 
USART_WdLgth_8b
;

283 
USART_InSu
->
USART_StBs
 = 
USART_StBs_1
;

284 
USART_InSu
->
USART_Py
 = 
USART_Py_No
 ;

285 
USART_InSu
->
USART_Mode
 = 
USART_Mode_Rx
 | 
USART_Mode_Tx
;

286 
USART_InSu
->
USART_HdweFlowCڌ
 = 
USART_HdweFlowCڌ_Ne
;

287 
	}
}

299 
	$USART_ClockIn
(
USART_TyDef
* 
USARTx
, 
USART_ClockInTyDef
* 
USART_ClockInSu
)

301 
ut32_t
 
tmeg
 = 0x00;

303 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

304 
	`as_m
(
	`IS_USART_CLOCK
(
USART_ClockInSu
->
USART_Clock
));

305 
	`as_m
(
	`IS_USART_CPOL
(
USART_ClockInSu
->
USART_CPOL
));

306 
	`as_m
(
	`IS_USART_CPHA
(
USART_ClockInSu
->
USART_CPHA
));

307 
	`as_m
(
	`IS_USART_LASTBIT
(
USART_ClockInSu
->
USART_LaB
));

310 
tmeg
 = 
USARTx
->
CR2
;

312 
tmeg
 &
CR2_CLOCK_CLEAR_Mask
;

318 
tmeg
 |(
ut32_t
)
USART_ClockInSu
->
USART_Clock
 | USART_ClockInSu->
USART_CPOL
 |

319 
USART_ClockInSu
->
USART_CPHA
 | USART_ClockInSu->
USART_LaB
;

321 
USARTx
->
CR2
 = (
ut16_t
)
tmeg
;

322 
	}
}

330 
	$USART_ClockSuIn
(
USART_ClockInTyDef
* 
USART_ClockInSu
)

333 
USART_ClockInSu
->
USART_Clock
 = 
USART_Clock_Dib
;

334 
USART_ClockInSu
->
USART_CPOL
 = 
USART_CPOL_Low
;

335 
USART_ClockInSu
->
USART_CPHA
 = 
USART_CPHA_1Edge
;

336 
USART_ClockInSu
->
USART_LaB
 = 
USART_LaB_Dib
;

337 
	}
}

348 
	$USART_Cmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
)

351 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

352 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

354 i(
NewS
 !
DISABLE
)

357 
USARTx
->
CR1
 |
CR1_UE_S
;

362 
USARTx
->
CR1
 &
CR1_UE_Ret
;

364 
	}
}

385 
	$USART_ITCfig
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_IT
, 
FuniڮS
 
NewS
)

387 
ut32_t
 
ug
 = 0x00, 
pos
 = 0x00, 
mask
 = 0x00;

388 
ut32_t
 
uxba
 = 0x00;

390 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

391 
	`as_m
(
	`IS_USART_CONFIG_IT
(
USART_IT
));

392 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

394 i(
USART_IT
 =
USART_IT_CTS
)

396 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

399 
uxba
 = (
ut32_t
)
USARTx
;

402 
ug
 = (((
ut8_t
)
USART_IT
) >> 0x05);

405 
pos
 = 
USART_IT
 & 
IT_Mask
;

406 
mask
 = (((
ut32_t
)0x01<< 
pos
);

408 i(
ug
 == 0x01)

410 
uxba
 += 0x0C;

412 i(
ug
 == 0x02)

414 
uxba
 += 0x10;

418 
uxba
 += 0x14;

420 i(
NewS
 !
DISABLE
)

422 *(
__IO
 
ut32_t
*)
uxba
 |
mask
;

426 *(
__IO
 
ut32_t
*)
uxba
 &~
mask
;

428 
	}
}

445 
	$USART_DMACmd
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_DMAReq
, 
FuniڮS
 
NewS
)

448 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

449 
	`as_m
(
	`IS_USART_DMAREQ
(
USART_DMAReq
));

450 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

451 i(
NewS
 !
DISABLE
)

455 
USARTx
->
CR3
 |
USART_DMAReq
;

461 
USARTx
->
CR3
 &(
ut16_t
)~
USART_DMAReq
;

463 
	}
}

473 
	$USART_SAddss
(
USART_TyDef
* 
USARTx
, 
ut8_t
 
USART_Addss
)

476 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

477 
	`as_m
(
	`IS_USART_ADDRESS
(
USART_Addss
));

480 
USARTx
->
CR2
 &
CR2_Addss_Mask
;

482 
USARTx
->
CR2
 |
USART_Addss
;

483 
	}
}

496 
	$USART_WakeUpCfig
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_WakeUp
)

499 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

500 
	`as_m
(
	`IS_USART_WAKEUP
(
USART_WakeUp
));

502 
USARTx
->
CR1
 &
CR1_WAKE_Mask
;

503 
USARTx
->
CR1
 |
USART_WakeUp
;

504 
	}
}

515 
	$USART_ReivWakeUpCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
)

518 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

519 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

521 i(
NewS
 !
DISABLE
)

524 
USARTx
->
CR1
 |
CR1_RWU_S
;

529 
USARTx
->
CR1
 &
CR1_RWU_Ret
;

531 
	}
}

544 
	$USART_LINBakDeLgthCfig
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_LINBakDeLgth
)

547 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

548 
	`as_m
(
	`IS_USART_LIN_BREAK_DETECT_LENGTH
(
USART_LINBakDeLgth
));

550 
USARTx
->
CR2
 &
CR2_LBDL_Mask
;

551 
USARTx
->
CR2
 |
USART_LINBakDeLgth
;

552 
	}
}

563 
	$USART_LINCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
)

566 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

567 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

569 i(
NewS
 !
DISABLE
)

572 
USARTx
->
CR2
 |
CR2_LINEN_S
;

577 
USARTx
->
CR2
 &
CR2_LINEN_Ret
;

579 
	}
}

589 
	$USART_SdDa
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
Da
)

592 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

593 
	`as_m
(
	`IS_USART_DATA
(
Da
));

596 
USARTx
->
DR
 = (
Da
 & (
ut16_t
)0x01FF);

597 
	}
}

606 
ut16_t
 
	$USART_ReiveDa
(
USART_TyDef
* 
USARTx
)

609 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

612  (
ut16_t
)(
USARTx
->
DR
 & (uint16_t)0x01FF);

613 
	}
}

622 
	$USART_SdBak
(
USART_TyDef
* 
USARTx
)

625 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

628 
USARTx
->
CR1
 |
CR1_SBK_S
;

629 
	}
}

638 
	$USART_SGudTime
(
USART_TyDef
* 
USARTx
, 
ut8_t
 
USART_GudTime
)

641 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

644 
USARTx
->
GTPR
 &
GTPR_LSB_Mask
;

646 
USARTx
->
GTPR
 |(
ut16_t
)((ut16_t)
USART_GudTime
 << 0x08);

647 
	}
}

658 
	$USART_SPsr
(
USART_TyDef
* 
USARTx
, 
ut8_t
 
USART_Psr
)

661 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

664 
USARTx
->
GTPR
 &
GTPR_MSB_Mask
;

666 
USARTx
->
GTPR
 |
USART_Psr
;

667 
	}
}

677 
	$USART_SmtCdCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
)

680 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

681 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

682 i(
NewS
 !
DISABLE
)

685 
USARTx
->
CR3
 |
CR3_SCEN_S
;

690 
USARTx
->
CR3
 &
CR3_SCEN_Ret
;

692 
	}
}

702 
	$USART_SmtCdNACKCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
)

705 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

706 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

707 i(
NewS
 !
DISABLE
)

710 
USARTx
->
CR3
 |
CR3_NACK_S
;

715 
USARTx
->
CR3
 &
CR3_NACK_Ret
;

717 
	}
}

728 
	$USART_HfDuexCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
)

731 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

732 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

734 i(
NewS
 !
DISABLE
)

737 
USARTx
->
CR3
 |
CR3_HDSEL_S
;

742 
USARTx
->
CR3
 &
CR3_HDSEL_Ret
;

744 
	}
}

759 
	$USART_OvSamg8Cmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
)

762 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

763 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

765 i(
NewS
 !
DISABLE
)

768 
USARTx
->
CR1
 |
CR1_OVER8_S
;

773 
USARTx
->
CR1
 &
CR1_OVER8_Ret
;

775 
	}
}

786 
	$USART_OBMhodCmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
)

789 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

790 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

792 i(
NewS
 !
DISABLE
)

795 
USARTx
->
CR3
 |
CR3_ONEBITE_S
;

800 
USARTx
->
CR3
 &
CR3_ONEBITE_Ret
;

802 
	}
}

815 
	$USART_IrDACfig
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_IrDAMode
)

818 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

819 
	`as_m
(
	`IS_USART_IRDA_MODE
(
USART_IrDAMode
));

821 
USARTx
->
CR3
 &
CR3_IRLP_Mask
;

822 
USARTx
->
CR3
 |
USART_IrDAMode
;

823 
	}
}

834 
	$USART_IrDACmd
(
USART_TyDef
* 
USARTx
, 
FuniڮS
 
NewS
)

837 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

838 
	`as_m
(
	`IS_FUNCTIONAL_STATE
(
NewS
));

840 i(
NewS
 !
DISABLE
)

843 
USARTx
->
CR3
 |
CR3_IREN_S
;

848 
USARTx
->
CR3
 &
CR3_IREN_Ret
;

850 
	}
}

871 
FgStus
 
	$USART_GFgStus
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_FLAG
)

873 
FgStus
 
bus
 = 
RESET
;

875 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

876 
	`as_m
(
	`IS_USART_FLAG
(
USART_FLAG
));

878 i(
USART_FLAG
 =
USART_FLAG_CTS
)

880 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

883 i((
USARTx
->
SR
 & 
USART_FLAG
!(
ut16_t
)
RESET
)

885 
bus
 = 
SET
;

889 
bus
 = 
RESET
;

891  
bus
;

892 
	}
}

920 
	$USART_CˬFg
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_FLAG
)

923 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

924 
	`as_m
(
	`IS_USART_CLEAR_FLAG
(
USART_FLAG
));

926 i((
USART_FLAG
 & 
USART_FLAG_CTS
) == USART_FLAG_CTS)

928 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

931 
USARTx
->
SR
 = (
ut16_t
)~
USART_FLAG
;

932 
	}
}

953 
ITStus
 
	$USART_GITStus
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_IT
)

955 
ut32_t
 
bpos
 = 0x00, 
mask
 = 0x00, 
ug
 = 0x00;

956 
ITStus
 
bus
 = 
RESET
;

958 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

959 
	`as_m
(
	`IS_USART_GET_IT
(
USART_IT
));

961 i(
USART_IT
 =
USART_IT_CTS
)

963 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

967 
ug
 = (((
ut8_t
)
USART_IT
) >> 0x05);

969 
mask
 = 
USART_IT
 & 
IT_Mask
;

970 
mask
 = (
ut32_t
)0x01 << itmask;

972 i(
ug
 == 0x01)

974 
mask
 &
USARTx
->
CR1
;

976 i(
ug
 == 0x02)

978 
mask
 &
USARTx
->
CR2
;

982 
mask
 &
USARTx
->
CR3
;

985 
bpos
 = 
USART_IT
 >> 0x08;

986 
bpos
 = (
ut32_t
)0x01 << bitpos;

987 
bpos
 &
USARTx
->
SR
;

988 i((
mask
 !(
ut16_t
)
RESET
)&&(
bpos
 != (uint16_t)RESET))

990 
bus
 = 
SET
;

994 
bus
 = 
RESET
;

997  
bus
;

998 
	}
}

1027 
	$USART_CˬITPdgB
(
USART_TyDef
* 
USARTx
, 
ut16_t
 
USART_IT
)

1029 
ut16_t
 
bpos
 = 0x00, 
mask
 = 0x00;

1031 
	`as_m
(
	`IS_USART_ALL_PERIPH
(
USARTx
));

1032 
	`as_m
(
	`IS_USART_CLEAR_IT
(
USART_IT
));

1034 i(
USART_IT
 =
USART_IT_CTS
)

1036 
	`as_m
(
	`IS_USART_123_PERIPH
(
USARTx
));

1039 
bpos
 = 
USART_IT
 >> 0x08;

1040 
mask
 = ((
ut16_t
)0x01 << (ut16_t)
bpos
);

1041 
USARTx
->
SR
 = (
ut16_t
)~
mask
;

1042 
	}
}

	@ports/stm32f10x/drivers/src/stm32f10x_wwdg.c

22 
	~"m32f10x_wwdg.h
"

23 
	~"m32f10x_rcc.h
"

47 
	#WWDG_OFFSET
 (
WWDG_BASE
 - 
PERIPH_BASE
)

	)

50 
	#CFR_OFFSET
 (
WWDG_OFFSET
 + 0x04)

	)

51 
	#EWI_BNumb
 0x09

	)

52 
	#CFR_EWI_BB
 (
PERIPH_BB_BASE
 + (
CFR_OFFSET
 * 32+ (
EWI_BNumb
 * 4))

	)

57 
	#CR_WDGA_S
 ((
ut32_t
)0x00000080)

	)

60 
	#CFR_WDGTB_Mask
 ((
ut32_t
)0xFFFFFE7F)

	)

61 
	#CFR_W_Mask
 ((
ut32_t
)0xFFFFFF80)

	)

62 
	#BIT_Mask
 ((
ut8_t
)0x7F)

	)

101 
	$WWDG_DeIn
()

103 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_WWDG
, 
ENABLE
);

104 
	`RCC_APB1PhRetCmd
(
RCC_APB1Ph_WWDG
, 
DISABLE
);

105 
	}
}

117 
	$WWDG_SPsr
(
ut32_t
 
WWDG_Psr
)

119 
ut32_t
 
tmeg
 = 0;

121 
	`as_m
(
	`IS_WWDG_PRESCALER
(
WWDG_Psr
));

123 
tmeg
 = 
WWDG
->
CFR
 & 
CFR_WDGTB_Mask
;

125 
tmeg
 |
WWDG_Psr
;

127 
WWDG
->
CFR
 = 
tmeg
;

128 
	}
}

136 
	$WWDG_SWdowVue
(
ut8_t
 
WdowVue
)

138 
__IO
 
ut32_t
 
tmeg
 = 0;

141 
	`as_m
(
	`IS_WWDG_WINDOW_VALUE
(
WdowVue
));

144 
tmeg
 = 
WWDG
->
CFR
 & 
CFR_W_Mask
;

147 
tmeg
 |
WdowVue
 & (
ut32_t

BIT_Mask
;

150 
WWDG
->
CFR
 = 
tmeg
;

151 
	}
}

158 
	$WWDG_EbIT
()

160 *(
__IO
 
ut32_t
 *
CFR_EWI_BB
 = (ut32_t)
ENABLE
;

161 
	}
}

169 
	$WWDG_SCou
(
ut8_t
 
Cou
)

172 
	`as_m
(
	`IS_WWDG_COUNTER
(
Cou
));

175 
WWDG
->
CR
 = 
Cou
 & 
BIT_Mask
;

176 
	}
}

184 
	$WWDG_Eb
(
ut8_t
 
Cou
)

187 
	`as_m
(
	`IS_WWDG_COUNTER
(
Cou
));

188 
WWDG
->
CR
 = 
CR_WDGA_S
 | 
Cou
;

189 
	}
}

196 
FgStus
 
	$WWDG_GFgStus
()

198  (
FgStus
)(
WWDG
->
SR
);

199 
	}
}

206 
	$WWDG_CˬFg
()

208 
WWDG
->
SR
 = (
ut32_t
)
RESET
;

209 
	}
}

	@ports/stm32f10x/drivers/src/syscalls.c

10 
	~<sys/.h
>

11 
	~<dlib.h
>

12 
	~<o.h
>

13 
	~<dio.h
>

14 
	~<sigl.h
>

15 
	~<time.h
>

16 
	~<sys/time.h
>

17 
	~<sys/times.h
>

19 #unde
o


20 
o
;

21 
__io_putch
(
ch
);

23 * 
ack_r
 
asm
("sp");

25 *
	g__v
[1] = { 0 };

26 **
	gv
 = 
__v
;

28 
	$li_mڙ_hds
()

30 
	}
}

32 
	$_gpid
()

35 
	}
}

37 
	$_kl
(
pid
, 
sig
)

39 
o
 = 
EINVAL
;

41 
	}
}

43 
	$_ex
 (
us
)

45 
	`_kl
(
us
, -1);

47 
	}
}

49 
	$_wre
(
fe
, *
r
, 
n
)

51 
todo
;

53 
todo
 = 0;od< 
n
;odo++)

55 
	`__io_putch
*
r
++ );

59  
n
;

60 
	}
}

62 
ddr_t
 
	$_sbrk
(

)

64 
d
 
	`asm
("end");

65 *
hp_d
;

66 *
ev_hp_d
;

68 i(
hp_d
 == 0)

69 
hp_d
 = &
d
;

71 
ev_hp_d
 = 
hp_d
;

72 i(
hp_d
 + 

 > 
ack_r
)

76 
o
 = 
ENOMEM
;

77  (
ddr_t
) -1;

80 
hp_d
 +

;

82  (
ddr_t

ev_hp_d
;

83 
	}
}

85 
	$_o
(
fe
)

88 
	}
}

91 
	$_f
(
fe
, 

 *

)

93 

->
_mode
 = 
S_IFCHR
;

95 
	}
}

97 
	$_iy
(
fe
)

100 
	}
}

102 
	$_lek
(
fe
, 
r
, 
d
)

105 
	}
}

107 
	$_ad
(
fe
, *
r
, 
n
)

110 
	}
}

112 
	$_ݒ
(*
th
, 
ags
, ...)

116 
	}
}

118 
	$_wa
(*
us
)

120 
o
 = 
ECHILD
;

122 
	}
}

124 
	$_uƚk
(*
me
)

126 
o
 = 
ENOENT
;

128 
	}
}

130 
	$_times
(
tms
 *
buf
)

133 
	}
}

135 
	$_
(*
fe
, 

 *

)

137 

->
_mode
 = 
S_IFCHR
;

139 
	}
}

141 
	$_lk
(*
d
, *
w
)

143 
o
 = 
EMLINK
;

145 
	}
}

147 
	$_fk
()

149 
o
 = 
EAGAIN
;

151 
	}
}

153 
	$_execve
(*
me
, **
gv
, **
v
)

155 
o
 = 
ENOMEM
;

157 
	}
}

	@ports/stm32f10x/hardware.h

25 #ide
HARDWARE_H


26 
	#HARDWARE_H


	)

28 
	~"m32f10x_cf.h
"

29 
	~"m32f10x_.h
"

31 
	#MAX_BINARY_OUTPUTS
 2

	)

	@ports/stm32f10x/led.c

24 
	~<dt.h
>

25 
	~"hdwe.h
"

26 
	~"tim.h
"

27 
	~"d.h
"

29 
im
 
	gOff_Day_Tim_Rx
;

30 
im
 
	gOff_Day_Tim_Tx
;

31 
bo
 
	gRx_S
;

32 
bo
 
	gTx_S
;

33 
bo
 
	gLD3_S
;

40 
	$d_tx_
(

43 
	`GPIO_WreB
(
GPIOB
, 
GPIO_P_15
, 
B_SET
);

44 
	`tim_rv_no_expe
(&
Off_Day_Tim_Tx
);

45 
Tx_S
 = 
ue
;

46 
	}
}

53 
	$d_rx_
(

56 
	`GPIO_WreB
(
GPIOB
, 
GPIO_P_14
, 
B_SET
);

57 
	`tim_rv_no_expe
(&
Off_Day_Tim_Rx
);

58 
Rx_S
 = 
ue
;

59 
	}
}

66 
	$d_tx_off
(

69 
	`GPIO_WreB
(
GPIOB
, 
GPIO_P_15
, 
B_RESET
);

70 
	`tim_rv_no_expe
(&
Off_Day_Tim_Tx
);

71 
Tx_S
 = 
l
;

72 
	}
}

79 
	$d_rx_off
(

82 
	`GPIO_WreB
(
GPIOB
, 
GPIO_P_14
, 
B_RESET
);

83 
	`tim_rv_no_expe
(&
Off_Day_Tim_Rx
);

84 
Rx_S
 = 
l
;

85 
	}
}

92 
bo
 
	$d_rx_e
(

95  
Rx_S
;

96 
	}
}

103 
bo
 
	$d_tx_e
(

106  
Tx_S
;

107 
	}
}

114 
	$d_tx_togg
(

117 i(
	`d_tx_e
()) {

118 
	`d_tx_off
();

120 
	`d_tx_
();

122 
	}
}

129 
	$d_rx_togg
(

132 i(
	`d_rx_e
()) {

133 
	`d_rx_off
();

135 
	`d_rx_
();

137 
	}
}

144 
	$d_rx_off_day
(

145 
ut32_t
 
day_ms
)

147 
	`tim_rv_t
(&
Off_Day_Tim_Rx
, 
day_ms
);

148 
	}
}

155 
	$d_tx_off_day
(

156 
ut32_t
 
day_ms
)

158 
	`tim_rv_t
(&
Off_Day_Tim_Tx
, 
day_ms
);

159 
	}
}

166 
	$d_rx__rv
(

167 
ut16_t
 
rv_ms
)

169 
	`d_rx_
();

170 
	`tim_rv_t
(&
Off_Day_Tim_Rx
, 
rv_ms
);

171 
	}
}

178 
	$d_tx__rv
(

179 
ut16_t
 
rv_ms
)

181 
	`d_tx_
();

182 
	`tim_rv_t
(&
Off_Day_Tim_Tx
, 
rv_ms
);

183 
	}
}

190 
	$d_sk
(

193 i(
	`tim_rv_exped
(&
Off_Day_Tim_Rx
)) {

194 
	`tim_rv_no_expe
(&
Off_Day_Tim_Rx
);

195 
	`d_rx_off
();

197 i(
	`tim_rv_exped
(&
Off_Day_Tim_Tx
)) {

198 
	`tim_rv_no_expe
(&
Off_Day_Tim_Tx
);

199 
	`d_tx_off
();

201 
	}
}

208 
	$d_ld4_
(

211 
	`GPIO_WreB
(
GPIOC
, 
GPIO_P_8
, 
B_SET
);

212 
	}
}

219 
	$d_ld4_off
(

222 
	`GPIO_WreB
(
GPIOC
, 
GPIO_P_8
, 
B_RESET
);

223 
	}
}

230 
	$d_ld3_
(

233 
	`GPIO_WreB
(
GPIOC
, 
GPIO_P_9
, 
B_SET
);

234 
LD3_S
 = 
ue
;

235 
	}
}

242 
	$d_ld3_off
(

245 
	`GPIO_WreB
(
GPIOC
, 
GPIO_P_9
, 
B_RESET
);

246 
LD3_S
 = 
l
;

247 
	}
}

254 
bo
 
	$d_ld3_e
(

257  
LD3_S
;

258 
	}
}

265 
	$d_ld3_togg
(

268 i(
	`d_ld3_e
()) {

269 
	`d_ld3_off
();

271 
	`d_ld3_
();

273 
	}
}

280 
	$d_
(

283 
GPIO_InTyDef
 
GPIO_InSuu
;

285 
	`GPIO_SuIn
(&
GPIO_InSuu
);

287 
GPIO_InSuu
.
GPIO_P
 = 
GPIO_P_14
;

288 
GPIO_InSuu
.
GPIO_Sed
 = 
GPIO_Sed_50MHz
;

289 
GPIO_InSuu
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

290 
	`GPIO_In
(
GPIOB
, &
GPIO_InSuu
);

292 
GPIO_InSuu
.
GPIO_P
 = 
GPIO_P_15
;

293 
GPIO_InSuu
.
GPIO_Sed
 = 
GPIO_Sed_50MHz
;

294 
GPIO_InSuu
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

295 
	`GPIO_In
(
GPIOB
, &
GPIO_InSuu
);

296 
	`RCC_APB2PhClockCmd
(
RCC_APB2Ph_GPIOB
, 
ENABLE
);

298 
GPIO_InSuu
.
GPIO_P
 = 
GPIO_P_8
;

299 
GPIO_InSuu
.
GPIO_Sed
 = 
GPIO_Sed_50MHz
;

300 
GPIO_InSuu
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

301 
	`GPIO_In
(
GPIOC
, &
GPIO_InSuu
);

303 
GPIO_InSuu
.
GPIO_P
 = 
GPIO_P_9
;

304 
GPIO_InSuu
.
GPIO_Sed
 = 
GPIO_Sed_50MHz
;

305 
GPIO_InSuu
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

306 
	`GPIO_In
(
GPIOC
, &
GPIO_InSuu
);

308 
	`RCC_APB2PhClockCmd
(
RCC_APB2Ph_GPIOC
, 
ENABLE
);

310 
	`d_tx_
();

311 
	`d_rx_
();

312 
	`d_ld3_
();

313 
	`d_ld4_
();

314 
	}
}

	@ports/stm32f10x/led.h

24 #ide
LED_H


25 
	#LED_H


	)

27 
	~<dt.h
>

28 
	~<dbo.h
>

30 #ifde
__lulus


34 
d_ld3_
(

36 
d_ld4_
(

38 
d_ld3_off
(

40 
d_ld4_off
(

42 
bo
 
d_ld3_e
(

44 
d_ld3_togg
(

47 
d_tx_
(

49 
d_rx_
(

52 
d_tx__rv
(

53 
ut16_t
 
rv_ms
);

54 
d_rx__rv
(

55 
ut16_t
 
rv_ms
);

57 
d_tx_off
(

59 
d_rx_off
(

62 
d_tx_off_day
(

63 
ut32_t
 
day_ms
);

64 
d_rx_off_day
(

65 
ut32_t
 
day_ms
);

67 
d_tx_togg
(

69 
d_rx_togg
(

72 
bo
 
d_tx_e
(

74 
bo
 
d_rx_e
(

77 
d_sk
(

79 
d_
(

82 #ifde
__lulus


	@ports/stm32f10x/main.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~"hdwe.h
"

29 
	~"tim.h
"

30 
	~"tim.h
"

31 
	~"rs485.h
"

32 
	~"d.h
"

33 
	~"ba.h
"

36 *
	gBACt_Vsi
 = "1.0";

38 #ifde 
USE_FULL_ASSERT


47 
	$as_ed
(

48 
ut8_t
 * 
fe
,

49 
ut32_t
 
le
)

57 
	}
}

61 
	#LSE_FAIL_FLAG
 0x80

	)

62 
	#LSE_PASS_FLAG
 0x100

	)

64 
	$l_
(

67 
ut32_t
 
LSE_Day
 = 0;

68 
im
 
Day_Tim
;

71 
	`PWR_BackupAcssCmd
(
ENABLE
);

73 
	`RCC_LSECfig
(
RCC_LSE_ON
);

77 i(
LSE_Day
 < 
LSE_FAIL_FLAG
) {

78 
	`tim_d_t
(&
Day_Tim
);

79 !
	`tim_d_mlicds
(&
Day_Tim
, 500)) {

83 
LSE_Day
 += 0x10;

84 i(
	`RCC_GFgStus
(
RCC_FLAG_LSERDY
!
RESET
) {

86 
LSE_Day
 |
LSE_PASS_FLAG
;

87 
	`d_ld4_off
();

89 
	`RCC_LSECfig
(
RCC_LSE_OFF
);

95 i(
LSE_Day
 >
LSE_FAIL_FLAG
) {

96 i(
	`RCC_GFgStus
(
RCC_FLAG_LSERDY
=
RESET
) {

98 
LSE_Day
 |
LSE_FAIL_FLAG
;

99 
	`d_ld4_
();

102 
	`RCC_LSECfig
(
RCC_LSE_OFF
);

106 
	}
}

108 
	$ma
(

111 
im
 
Blk_Tim
;

118 
	`RCC_APB1PhClockCmd
(
RCC_APB1Ph_PWR
, 
ENABLE
);

119 
	`RCC_APB2PhClockCmd
(
RCC_APB2Ph_AFIO
, 
ENABLE
);

120 
	`RCC_APB2PhClockCmd
(
RCC_APB2Ph_GPIOA
 | 
RCC_APB2Ph_GPIOB
 |

121 
RCC_APB2Ph_GPIOC
 | 
RCC_APB2Ph_GPIOD
 | 
RCC_APB2Ph_GPIOE
,

122 
ENABLE
);

123 
	`tim_
();

124 
	`l_
();

125 
	`d_
();

126 
	`ba_
();

127 
	`tim_rv_t
(&
Blk_Tim
, 125);

129 i(
	`tim_rv_exped
(&
Blk_Tim
)) {

130 
	`tim_rv_t
(&
Blk_Tim
);

131 
	`d_ld3_togg
();

133 
	`d_sk
();

134 
	`ba_sk
();

136 
	}
}

	@ports/stm32f10x/rs485.c

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<dlib.h
>

30 
	~"hdwe.h
"

31 
	~"tim.h
"

32 
	~"bs.h
"

33 
	~"fifo.h
"

34 
	~"d.h
"

35 
	~"rs485.h
"

38 
ut8_t
 
	gReive_Bufr_Da
[512];

39 
FIFO_BUFFER
 
	gReive_Bufr
;

41 
im
 
	gS_Tim
;

43 
ut32_t
 
	gBaud_Re
 = 38400;

54 
	#Ttuound
 (40UL)

	)

61 
	$rs485_s_t
(

64 
	`tim_d_t
(&
S_Tim
);

65 
	}
}

72 
bo
 
	$rs485_s_d
(

73 
ut32_t
 
rv
)

75  
	`tim_d_mlicds
(&
S_Tim
, 
rv
);

76 
	}
}

83 
ut16_t
 
	$rs485_tuound_time
(

89 i(
Baud_Re
) {

90  (2 + ((
Ttuound
 * 1000UL/ 
Baud_Re
));

94 
	}
}

101 
bo
 
	$rs485_tuound_d
(

104  
	`tim_d_mlicds
(&
S_Tim
, 
	`rs485_tuound_time
());

105 
	}
}

113 
bo
 
	$rs485_ive_r
(

116  
l
;

117 
	}
}

124 
	$USART2_IRQHdr
(

127 
ut8_t
 
da_by
;

130 i(
	`USART_GITStus
(
USART2
, 
USART_IT_RXNE
!
RESET
) {

132 
da_by
 = 
	`USART_ReiveDa
(
USART2
);

133 (
	`FIFO_Put
(&
Reive_Bufr
, 
da_by
);

135 
	}
}

142 
bo
 
	$rs485_by_avaab
(

143 
ut8_t
 * 
da_gi
)

145 
bo
 
da_avaab
 = 
l
;

147 i(!
	`FIFO_Emy
(&
Reive_Bufr
)) {

148 i(
da_gi
) {

149 *
da_gi
 = 
	`FIFO_G
(&
Reive_Bufr
);

151 
	`tim_d_t
(&
S_Tim
);

152 
da_avaab
 = 
ue
;

153 
	`d_rx__rv
(10);

156  
da_avaab
;

157 
	}
}

164 
	$rs485_by_nd
(

165 
ut8_t
 
tx_by
)

167 
	`d_tx__rv
(10);

168 
	`USART_SdDa
(
USART2
, 
tx_by
);

169 
	`tim_d_t
(&
S_Tim
);

170 
	}
}

178 
bo
 
	$rs485_by_
(

181  
	`USART_GFgStus
(
USART2
, 
USART_FLAG_TXE
);

182 
	}
}

189 
bo
 
	$rs485_ame_
(

192  
	`USART_GFgStus
(
USART2
, 
USART_FLAG_TC
);

193 
	}
}

200 
	$rs485_bys_nd
(

201 
ut8_t
 * 
bufr
,

202 
ut16_t
 
nbys
)

204 
ut8_t
 
tx_by
;

206 
nbys
) {

208 
tx_by
 = *
bufr
;

210 
	`USART_SdDa
(
USART2
, 
tx_by
);

211 !
	`rs485_by_
()) {

214 
bufr
++;

215 
nbys
--;

218 !
	`rs485_ame_
()) {

222 
	`tim_d_t
(&
S_Tim
);

225 
	}
}

232 
	$rs485_baud__cfigu
(

235 
USART_InTyDef
 
USART_InSuu
;

237 
USART_InSuu
.
USART_BaudRe
 = 
Baud_Re
;

238 
USART_InSuu
.
USART_WdLgth
 = 
USART_WdLgth_8b
;

239 
USART_InSuu
.
USART_StBs
 = 
USART_StBs_1
;

240 
USART_InSuu
.
USART_Py
 = 
USART_Py_No
;

241 
USART_InSuu
.
USART_HdweFlowCڌ
 =

242 
USART_HdweFlowCڌ_Ne
;

243 
USART_InSuu
.
USART_Mode
 = 
USART_Mode_Rx
 | 
USART_Mode_Tx
;

246 
	`USART_In
(
USART2
, &
USART_InSuu
);

247 
	}
}

254 
bo
 
	$rs485_baud__t
(

255 
ut32_t
 
baud
)

257 
bo
 
vid
 = 
ue
;

259 
baud
) {

266 
Baud_Re
 = 
baud
;

267 
	`rs485_baud__cfigu
();

270 
vid
 = 
l
;

274  
vid
;

275 
	}
}

282 
ut32_t
 
	$rs485_baud_
(

285  
Baud_Re
;

286 
	}
}

293 
	$rs485_s_ab
(

294 
bo
 
ab
)

296 i(
ab
) {

297 
	`GPIO_WreB
(
GPIOA
, 
GPIO_P_1
, 
B_SET
);

299 
	`GPIO_WreB
(
GPIOA
, 
GPIO_P_1
, 
B_RESET
);

301 
	}
}

308 
	$rs485_
(

311 
GPIO_InTyDef
 
GPIO_InSuu
;

312 
NVIC_InTyDef
 
NVIC_InSuu
;

314 
	`GPIO_SuIn
(&
GPIO_InSuu
);

316 
GPIO_InSuu
.
GPIO_P
 = 
GPIO_P_3
;

317 
GPIO_InSuu
.
GPIO_Sed
 = 
GPIO_Sed_50MHz
;

318 
GPIO_InSuu
.
GPIO_Mode
 = 
GPIO_Mode_IN_FLOATING
;

319 
	`GPIO_In
(
GPIOA
, &
GPIO_InSuu
);

321 
GPIO_InSuu
.
GPIO_P
 = 
GPIO_P_2
;

322 
GPIO_InSuu
.
GPIO_Sed
 = 
GPIO_Sed_50MHz
;

323 
GPIO_InSuu
.
GPIO_Mode
 = 
GPIO_Mode_AF_PP
;

324 
	`GPIO_In
(
GPIOA
, &
GPIO_InSuu
);

326 
GPIO_InSuu
.
GPIO_P
 = 
GPIO_P_1
;

327 
GPIO_InSuu
.
GPIO_Sed
 = 
GPIO_Sed_50MHz
;

328 
GPIO_InSuu
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

329 
	`GPIO_In
(
GPIOA
, &
GPIO_InSuu
);

331 
	`RCC_APB1PhClockCmd
(
RCC_APB1Ph_USART2
, 
ENABLE
);

334 
	`RCC_APB2PhClockCmd
(
RCC_APB2Ph_GPIOA
, 
ENABLE
);

340 
	`NVIC_PriܙyGroupCfig
(
NVIC_PriܙyGroup_0
);

342 
NVIC_InSuu
.
NVIC_IRQChl
 = 
USART2_IRQn
;

343 
NVIC_InSuu
.
NVIC_IRQChlSubPriܙy
 = 0;

344 
NVIC_InSuu
.
NVIC_IRQChlCmd
 = 
ENABLE
;

345 
	`NVIC_In
(&
NVIC_InSuu
);

347 
	`USART_ITCfig
(
USART2
, 
USART_IT_RXNE
, 
ENABLE
);

349 
	`rs485_baud__t
(
Baud_Re
);

351 
	`USART_Cmd
(
USART2
, 
ENABLE
);

353 
	`FIFO_In
(&
Reive_Bufr
, &
Reive_Bufr_Da
[0],

354 ((
Reive_Bufr_Da
));

355 
	`tim_d_t
(&
S_Tim
);

356 
	}
}

	@ports/stm32f10x/rs485.h

27 #ide
RS485_H


28 
	#RS485_H


	)

30 
	~<dt.h
>

31 
	~<dbo.h
>

33 #ifde
__lulus


37 
rs485_
(

39 
rs485_s_ab
(

40 
bo
 
ab
);

41 
bo
 
rs485_by_avaab
(

42 
ut8_t
 * 
da_gi
);

43 
bo
 
rs485_ive_r
(

45 
rs485_bys_nd
(

46 
ut8_t
 * 
bufr
,

47 
ut16_t
 
nbys
);

48 
ut32_t
 
rs485_baud_
(

50 
bo
 
rs485_baud__t
(

51 
ut32_t
 
baud
);

53 
rs485_by_nd
(

54 
ut8_t
 
da_gi
);

55 
bo
 
rs485_by_
(

57 
bo
 
rs485_ame_
(

59 
bo
 
rs485_tuound_d
(

62 
rs485_s_t
(

64 
bo
 
rs485_s_d
(

65 
ut32_t
 
rv
);

67 #ifde
__lulus


	@ports/stm32f10x/stm32f10x_conf.h

22 #ide
__STM32F10x_CONF_H


23 
	#__STM32F10x_CONF_H


	)

27 
	~"m32f10x_adc.h
"

28 
	~"m32f10x_bkp.h
"

29 
	~"m32f10x_n.h
"

30 
	~"m32f10x_c.h
"

31 
	~"m32f10x_c.h
"

32 
	~"m32f10x_dac.h
"

33 
	~"m32f10x_dbgmcu.h
"

34 
	~"m32f10x_dma.h
"

35 
	~"m32f10x_exti.h
"

36 
	~"m32f10x_ash.h
"

37 
	~"m32f10x_fsmc.h
"

38 
	~"m32f10x_gpio.h
"

39 
	~"m32f10x_i2c.h
"

40 
	~"m32f10x_iwdg.h
"

41 
	~"m32f10x_pwr.h
"

42 
	~"m32f10x_rcc.h
"

43 
	~"m32f10x_c.h
"

44 
	~"m32f10x_sdio.h
"

45 
	~"m32f10x_i.h
"

46 
	~"m32f10x_tim.h
"

47 
	~"m32f10x_u.h
"

48 
	~"m32f10x_wwdg.h
"

50 
	~"m32f10x_misc.h
"

56 #ifde 
USE_FULL_ASSERT


66 
	#as_m
(
ex
(x? ()0 : 
	`as_ed
((
ut8_t
 *)
__FILE__
, 
__LINE__
))

	)

68 
as_ed
(

69 
ut8_t
 * 
fe
,

70 
ut32_t
 
le
);

72 
	#as_m
(
ex
(()0)

	)

	@ports/stm32f10x/stm32f10x_it.c

24 
	~"m32f10x_.h
"

50 
	$NMI_Hdr
(

53 
	}
}

60 
	$HdFau_Hdr
(

66 
	}
}

73 
	$MemMage_Hdr
(

79 
	}
}

86 
	$BusFau_Hdr
(

92 
	}
}

99 
	$UgeFau_Hdr
(

105 
	}
}

112 
	$SVC_Hdr
(

115 
	}
}

122 
	$DebugM_Hdr
(

125 
	}
}

132 
	$PdSV_Hdr
(

135 
	}
}

	@ports/stm32f10x/stm32f10x_it.h

22 #ide
__STM32F10x_IT_H


23 
	#__STM32F10x_IT_H


	)

26 
	~"m32f10x.h
"

33 
NMI_Hdr
(

35 
HdFau_Hdr
(

37 
MemMage_Hdr
(

39 
BusFau_Hdr
(

41 
UgeFau_Hdr
(

43 
SVC_Hdr
(

45 
DebugM_Hdr
(

47 
PdSV_Hdr
(

	@ports/stm32f10x/system_stm32f10x.c

33 
	~"m32f10x.h
"

74 #i
defed
 (
STM32F10X_LD_VL
|| (defed 
STM32F10X_MD_VL
|| (defed 
STM32F10X_HD_VL
)

76 
	#SYSCLK_FREQ_24MHz
 24000000

	)

83 
	#SYSCLK_FREQ_72MHz
 72000000

	)

89 #i
defed
 (
STM32F10X_HD
|| (defed 
STM32F10X_XL
|| (defed 
STM32F10X_HD_VL
)

96 
	#VECT_TAB_OFFSET
 0x0

	)

119 #ifde
SYSCLK_FREQ_HSE


120 
ut32_t
 
	gSyemCeClock
 = 
SYSCLK_FREQ_HSE
;

121 #i
defed
 
SYSCLK_FREQ_24MHz


122 
ut32_t
 
	gSyemCeClock
 = 
SYSCLK_FREQ_24MHz
;

123 #i
defed
 
SYSCLK_FREQ_36MHz


124 
ut32_t
 
	gSyemCeClock
 = 
SYSCLK_FREQ_36MHz
;

125 #i
defed
 
SYSCLK_FREQ_48MHz


126 
ut32_t
 
	gSyemCeClock
 = 
SYSCLK_FREQ_48MHz
;

127 #i
defed
 
SYSCLK_FREQ_56MHz


128 
ut32_t
 
	gSyemCeClock
 = 
SYSCLK_FREQ_56MHz
;

129 #i
defed
 
SYSCLK_FREQ_72MHz


130 
ut32_t
 
	gSyemCeClock
 = 
SYSCLK_FREQ_72MHz
;

132 
ut32_t
 
	gSyemCeClock
 = 
HSI_VALUE
;

135 
__I
 
ut8_t
 
	gAHBPscTab
[16] =

145 
SSysClock
(

148 #ifde
SYSCLK_FREQ_HSE


149 
SSysClockToHSE
(

151 #i
defed
 
SYSCLK_FREQ_24MHz


152 
SSysClockTo24
(

154 #i
defed
 
SYSCLK_FREQ_36MHz


155 
SSysClockTo36
(

157 #i
defed
 
SYSCLK_FREQ_48MHz


158 
SSysClockTo48
(

160 #i
defed
 
SYSCLK_FREQ_56MHz


161 
SSysClockTo56
(

163 #i
defed
 
SYSCLK_FREQ_72MHz


164 
SSysClockTo72
(

168 #ifde
DATA_IN_ExtSRAM


169 
SyemIn_ExtMemC
(

189 
	$SyemIn
(

194 
RCC
->
CR
 |(
ut32_t
) 0x00000001;

197 #ide
STM32F10X_CL


198 
RCC
->
CFGR
 &(
ut32_t
) 0xF8FF0000;

200 
RCC
->
CFGR
 &(
ut32_t
) 0xF0FF0000;

204 
RCC
->
CR
 &(
ut32_t
) 0xFEF6FFFF;

207 
RCC
->
CR
 &(
ut32_t
) 0xFFFBFFFF;

210 
RCC
->
CFGR
 &(
ut32_t
) 0xFF80FFFF;

212 #ifde
STM32F10X_CL


214 
RCC
->
CR
 &(
ut32_t
) 0xEBFFFFFF;

217 
RCC
->
CIR
 = 0x00FF0000;

220 
RCC
->
CFGR2
 = 0x00000000;

221 #i
	`defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| (
defed
 
STM32F10X_HD_VL
)

223 
RCC
->
CIR
 = 0x009F0000;

226 
RCC
->
CFGR2
 = 0x00000000;

229 
RCC
->
CIR
 = 0x009F0000;

232 #i
	`defed
 (
STM32F10X_HD
|| (
defed
 
STM32F10X_XL
|| (defed 
STM32F10X_HD_VL
)

233 #ifde
DATA_IN_ExtSRAM


234 
	`SyemIn_ExtMemC
();

240 
	`SSysClock
();

242 #ifde
VECT_TAB_SRAM


243 
SCB
->
VTOR
 = 
SRAM_BASE
 | 
VECT_TAB_OFFSET
;

245 
SCB
->
VTOR
 = 
FLASH_BASE
 | 
VECT_TAB_OFFSET
;

247 
	}
}

255 
	$SyemCeClockUpde
(

258 
ut32_t
 
tmp
 = 0, 
lmu
 = 0, 
lsour
 = 0;

260 #ifde 
STM32F10X_CL


261 
ut32_t
 
ediv1sour
 = 0, 
ediv1
 = 0, 
ediv2
 =

262 0, 
l2mu
 = 0;

265 #i
	`defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| (
defed
 
STM32F10X_HD_VL
)

266 
ut32_t
 
ediv1
 = 0;

270 
tmp
 = 
RCC
->
CFGR
 & 
RCC_CFGR_SWS
;

272 
tmp
) {

274 
SyemCeClock
 = 
HSI_VALUE
;

277 
SyemCeClock
 = 
HSE_VALUE
;

282 
lmu
 = 
RCC
->
CFGR
 & 
RCC_CFGR_PLLMULL
;

283 
lsour
 = 
RCC
->
CFGR
 & 
RCC_CFGR_PLLSRC
;

285 #ide
STM32F10X_CL


286 
lmu
 = (pllmull >> 18) + 2;

288 i(
lsour
 == 0x00) {

290 
SyemCeClock
 = (
HSI_VALUE
 >> 1* 
lmu
;

292 #i
	`defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| (
defed
 
STM32F10X_HD_VL
)

293 
ediv1
 = (
RCC
->
CFGR2
 & 
RCC_CFGR2_PREDIV1
) + 1;

295 
SyemCeClock
 = (
HSE_VALUE
 / 
ediv1
* 
lmu
;

298 i((
RCC
->
CFGR
 & 
RCC_CFGR_PLLXTPRE
!(
ut32_t

RESET
) {

299 
SyemCeClock
 = (
HSE_VALUE
 >> 1* 
lmu
;

301 
SyemCeClock
 = 
HSE_VALUE
 * 
lmu
;

306 
lmu
 =llmull >> 18;

308 i(
lmu
 != 0x0D) {

309 
lmu
 += 2;

311 
lmu
 = 13 / 2;

314 i(
lsour
 == 0x00) {

316 
SyemCeClock
 = (
HSI_VALUE
 >> 1* 
lmu
;

320 
ediv1sour
 = 
RCC
->
CFGR2
 & 
RCC_CFGR2_PREDIV1SRC
;

321 
ediv1
 = (
RCC
->
CFGR2
 & 
RCC_CFGR2_PREDIV1
) + 1;

323 i(
ediv1sour
 == 0) {

325 
SyemCeClock
 = (
HSE_VALUE
 / 
ediv1
* 
lmu
;

329 
ediv2
 =

330 ((
RCC
->
CFGR2
 & 
RCC_CFGR2_PREDIV2
) >> 4) + 1;

331 
l2mu
 = ((
RCC
->
CFGR2
 & 
RCC_CFGR2_PLL2MUL
) >> 8) + 2;

332 
SyemCeClock
 =

333 (((
HSE_VALUE
 / 
ediv2
* 
l2mu
) /

334 
ediv1
* 
lmu
;

341 
SyemCeClock
 = 
HSI_VALUE
;

347 
tmp
 = 
AHBPscTab
[((
RCC
->
CFGR
 & 
RCC_CFGR_HPRE
) >> 4)];

349 
SyemCeClock
 >>
tmp
;

350 
	}
}

357 
	$SSysClock
(

360 #ifde
SYSCLK_FREQ_HSE


361 
	`SSysClockToHSE
();

362 #i
defed
 
SYSCLK_FREQ_24MHz


363 
	`SSysClockTo24
();

364 #i
defed
 
SYSCLK_FREQ_36MHz


365 
	`SSysClockTo36
();

366 #i
defed
 
SYSCLK_FREQ_48MHz


367 
	`SSysClockTo48
();

368 #i
defed
 
SYSCLK_FREQ_56MHz


369 
	`SSysClockTo56
();

370 #i
defed
 
SYSCLK_FREQ_72MHz


371 
	`SSysClockTo72
();

376 
	}
}

384 #ifde
DATA_IN_ExtSRAM


394 
	$SyemIn_ExtMemC
(

401 
RCC
->
AHBENR
 = 0x00000114;

404 
RCC
->
APB2ENR
 = 0x000001E0;

412 
GPIOD
->
CRL
 = 0x44BB44BB;

413 
GPIOD
->
CRH
 = 0xBBBBBBBB;

415 
GPIOE
->
CRL
 = 0xB44444BB;

416 
GPIOE
->
CRH
 = 0xBBBBBBBB;

418 
GPIOF
->
CRL
 = 0x44BBBBBB;

419 
GPIOF
->
CRH
 = 0xBBBB4444;

421 
GPIOG
->
CRL
 = 0x44BBBBBB;

422 
GPIOG
->
CRH
 = 0x44444B44;

427 
FSMC_Bk1
->
BTCR
[4] = 0x00001011;

428 
FSMC_Bk1
->
BTCR
[5] = 0x00000200;

429 
	}
}

432 #ifde
SYSCLK_FREQ_HSE


440 
	$SSysClockToHSE
(

443 
__IO
 
ut32_t
 
SUpCou
 = 0, 
HSEStus
 = 0;

447 
RCC
->
CR
 |((
ut32_t

RCC_CR_HSEON
);

451 
HSEStus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

452 
SUpCou
++;

453 } (
HSEStus
 =0&& (
SUpCou
 !
HSE_STARTUP_TIMEOUT
));

455 i((
RCC
->
CR
 & 
RCC_CR_HSERDY
!
RESET
) {

456 
HSEStus
 = (
ut32_t
) 0x01;

458 
HSEStus
 = (
ut32_t
) 0x00;

461 i(
HSEStus
 =(
ut32_t
) 0x01) {

463 #i!
defed
 
STM32F10X_LD_VL
 && !defed 
STM32F10X_MD_VL
 && !defed 
STM32F10X_HD_VL


465 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

468 
FLASH
->
ACR
 &(
ut32_t
((ut32_t~ 
FLASH_ACR_LATENCY
);

470 #ide
STM32F10X_CL


471 
FLASH
->
ACR
 |(
ut32_t

FLASH_ACR_LATENCY_0
;

473 i(
HSE_VALUE
 <= 24000000) {

474 
FLASH
->
ACR
 |(
ut32_t

FLASH_ACR_LATENCY_0
;

476 
FLASH
->
ACR
 |(
ut32_t

FLASH_ACR_LATENCY_1
;

482 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_HPRE_DIV1
;

485 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE2_DIV1
;

488 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE1_DIV1
;

491 
RCC
->
CFGR
 &(
ut32_t
((ut32_t~ (
RCC_CFGR_SW
));

492 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_SW_HSE
;

495 (
RCC
->
CFGR
 & (
ut32_t

RCC_CFGR_SWS
) != (uint32_t) 0x04) {

500 
	}
}

501 #i
defed
 
SYSCLK_FREQ_24MHz


509 
	$SSysClockTo24
(

512 
__IO
 
ut32_t
 
SUpCou
 = 0, 
HSEStus
 = 0;

516 
RCC
->
CR
 |((
ut32_t

RCC_CR_HSEON
);

520 
HSEStus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

521 
SUpCou
++;

522 } (
HSEStus
 =0&& (
SUpCou
 !
HSE_STARTUP_TIMEOUT
));

524 i((
RCC
->
CR
 & 
RCC_CR_HSERDY
!
RESET
) {

525 
HSEStus
 = (
ut32_t
) 0x01;

527 
HSEStus
 = (
ut32_t
) 0x00;

530 i(
HSEStus
 =(
ut32_t
) 0x01) {

531 #i!
defed
 
STM32F10X_LD_VL
 && !defed 
STM32F10X_MD_VL
 && !defed 
STM32F10X_HD_VL


533 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

536 
FLASH
->
ACR
 &(
ut32_t
((ut32_t~ 
FLASH_ACR_LATENCY
);

537 
FLASH
->
ACR
 |(
ut32_t

FLASH_ACR_LATENCY_0
;

541 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_HPRE_DIV1
;

544 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE2_DIV1
;

547 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE1_DIV1
;

549 #ifde
STM32F10X_CL


552 
RCC
->
CFGR
 &=

553 (
ut32_t
~ (
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 |

554 
RCC_CFGR_PLLMULL
);

555 
RCC
->
CFGR
 |=

556 (
ut32_t
(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

557 
RCC_CFGR_PLLMULL6
);

561 
RCC
->
CFGR2
 &=

562 (
ut32_t
~ (
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

563 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

564 
RCC
->
CFGR2
 |=

565 (
ut32_t
(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

566 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV10
);

569 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

571 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0) {

573 #i
	`defed
 (
STM32F10X_LD_VL
|| defed (
STM32F10X_MD_VL
|| defed (
STM32F10X_HD_VL
)

575 
RCC
->
CFGR
 &=

576 (
ut32_t
((ut32_t~ (
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 |

577 
RCC_CFGR_PLLMULL
));

578 
RCC
->
CFGR
 |=

579 (
ut32_t
(
RCC_CFGR_PLLSRC_PREDIV1
 |

580 
RCC_CFGR_PLLXTPRE_PREDIV1_Div2
 | 
RCC_CFGR_PLLMULL6
);

583 
RCC
->
CFGR
 &=

584 (
ut32_t
((ut32_t~ (
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 |

585 
RCC_CFGR_PLLMULL
));

586 
RCC
->
CFGR
 |=

587 (
ut32_t
(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLXTPRE_HSE_Div2
 |

588 
RCC_CFGR_PLLMULL6
);

592 
RCC
->
CR
 |
RCC_CR_PLLON
;

595 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0) {

599 
RCC
->
CFGR
 &(
ut32_t
((ut32_t~ (
RCC_CFGR_SW
));

600 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_SW_PLL
;

603 (
RCC
->
CFGR
 & (
ut32_t

RCC_CFGR_SWS
) != (uint32_t) 0x08) {

608 
	}
}

609 #i
defed
 
SYSCLK_FREQ_36MHz


617 
	$SSysClockTo36
(

620 
__IO
 
ut32_t
 
SUpCou
 = 0, 
HSEStus
 = 0;

624 
RCC
->
CR
 |((
ut32_t

RCC_CR_HSEON
);

628 
HSEStus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

629 
SUpCou
++;

630 } (
HSEStus
 =0&& (
SUpCou
 !
HSE_STARTUP_TIMEOUT
));

632 i((
RCC
->
CR
 & 
RCC_CR_HSERDY
!
RESET
) {

633 
HSEStus
 = (
ut32_t
) 0x01;

635 
HSEStus
 = (
ut32_t
) 0x00;

638 i(
HSEStus
 =(
ut32_t
) 0x01) {

640 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

643 
FLASH
->
ACR
 &(
ut32_t
((ut32_t~ 
FLASH_ACR_LATENCY
);

644 
FLASH
->
ACR
 |(
ut32_t

FLASH_ACR_LATENCY_1
;

647 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_HPRE_DIV1
;

650 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE2_DIV1
;

653 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE1_DIV1
;

655 #ifde
STM32F10X_CL


659 
RCC
->
CFGR
 &=

660 (
ut32_t
~ (
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 |

661 
RCC_CFGR_PLLMULL
);

662 
RCC
->
CFGR
 |=

663 (
ut32_t
(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

664 
RCC_CFGR_PLLMULL9
);

669 
RCC
->
CFGR2
 &=

670 (
ut32_t
~ (
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

671 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

672 
RCC
->
CFGR2
 |=

673 (
ut32_t
(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

674 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV10
);

677 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

679 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0) {

684 
RCC
->
CFGR
 &=

685 (
ut32_t
((ut32_t~ (
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 |

686 
RCC_CFGR_PLLMULL
));

687 
RCC
->
CFGR
 |=

688 (
ut32_t
(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLXTPRE_HSE_Div2
 |

689 
RCC_CFGR_PLLMULL9
);

693 
RCC
->
CR
 |
RCC_CR_PLLON
;

696 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0) {

700 
RCC
->
CFGR
 &(
ut32_t
((ut32_t~ (
RCC_CFGR_SW
));

701 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_SW_PLL
;

704 (
RCC
->
CFGR
 & (
ut32_t

RCC_CFGR_SWS
) != (uint32_t) 0x08) {

709 
	}
}

710 #i
defed
 
SYSCLK_FREQ_48MHz


718 
	$SSysClockTo48
(

721 
__IO
 
ut32_t
 
SUpCou
 = 0, 
HSEStus
 = 0;

725 
RCC
->
CR
 |((
ut32_t

RCC_CR_HSEON
);

729 
HSEStus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

730 
SUpCou
++;

731 } (
HSEStus
 =0&& (
SUpCou
 !
HSE_STARTUP_TIMEOUT
));

733 i((
RCC
->
CR
 & 
RCC_CR_HSERDY
!
RESET
) {

734 
HSEStus
 = (
ut32_t
) 0x01;

736 
HSEStus
 = (
ut32_t
) 0x00;

739 i(
HSEStus
 =(
ut32_t
) 0x01) {

741 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

744 
FLASH
->
ACR
 &(
ut32_t
((ut32_t~ 
FLASH_ACR_LATENCY
);

745 
FLASH
->
ACR
 |(
ut32_t

FLASH_ACR_LATENCY_1
;

748 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_HPRE_DIV1
;

751 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE2_DIV1
;

754 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE1_DIV2
;

756 #ifde
STM32F10X_CL


761 
RCC
->
CFGR2
 &=

762 (
ut32_t
~ (
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

763 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

764 
RCC
->
CFGR2
 |=

765 (
ut32_t
(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

766 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV5
);

769 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

771 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0) {

776 
RCC
->
CFGR
 &=

777 (
ut32_t
~ (
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 |

778 
RCC_CFGR_PLLMULL
);

779 
RCC
->
CFGR
 |=

780 (
ut32_t
(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

781 
RCC_CFGR_PLLMULL6
);

784 
RCC
->
CFGR
 &=

785 (
ut32_t
((ut32_t~ (
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 |

786 
RCC_CFGR_PLLMULL
));

787 
RCC
->
CFGR
 |(
ut32_t
(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLMULL6
);

791 
RCC
->
CR
 |
RCC_CR_PLLON
;

794 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0) {

798 
RCC
->
CFGR
 &(
ut32_t
((ut32_t~ (
RCC_CFGR_SW
));

799 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_SW_PLL
;

802 (
RCC
->
CFGR
 & (
ut32_t

RCC_CFGR_SWS
) != (uint32_t) 0x08) {

807 
	}
}

809 #i
defed
 
SYSCLK_FREQ_56MHz


817 
	$SSysClockTo56
(

820 
__IO
 
ut32_t
 
SUpCou
 = 0, 
HSEStus
 = 0;

824 
RCC
->
CR
 |((
ut32_t

RCC_CR_HSEON
);

828 
HSEStus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

829 
SUpCou
++;

830 } (
HSEStus
 =0&& (
SUpCou
 !
HSE_STARTUP_TIMEOUT
));

832 i((
RCC
->
CR
 & 
RCC_CR_HSERDY
!
RESET
) {

833 
HSEStus
 = (
ut32_t
) 0x01;

835 
HSEStus
 = (
ut32_t
) 0x00;

838 i(
HSEStus
 =(
ut32_t
) 0x01) {

840 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

843 
FLASH
->
ACR
 &(
ut32_t
((ut32_t~ 
FLASH_ACR_LATENCY
);

844 
FLASH
->
ACR
 |(
ut32_t

FLASH_ACR_LATENCY_2
;

847 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_HPRE_DIV1
;

850 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE2_DIV1
;

853 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE1_DIV2
;

855 #ifde
STM32F10X_CL


860 
RCC
->
CFGR2
 &=

861 (
ut32_t
~ (
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

862 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

863 
RCC
->
CFGR2
 |=

864 (
ut32_t
(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

865 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV5
);

868 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

870 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0) {

875 
RCC
->
CFGR
 &=

876 (
ut32_t
~ (
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 |

877 
RCC_CFGR_PLLMULL
);

878 
RCC
->
CFGR
 |=

879 (
ut32_t
(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

880 
RCC_CFGR_PLLMULL7
);

883 
RCC
->
CFGR
 &=

884 (
ut32_t
((ut32_t~ (
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 |

885 
RCC_CFGR_PLLMULL
));

886 
RCC
->
CFGR
 |(
ut32_t
(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLMULL7
);

891 
RCC
->
CR
 |
RCC_CR_PLLON
;

894 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0) {

898 
RCC
->
CFGR
 &(
ut32_t
((ut32_t~ (
RCC_CFGR_SW
));

899 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_SW_PLL
;

902 (
RCC
->
CFGR
 & (
ut32_t

RCC_CFGR_SWS
) != (uint32_t) 0x08) {

907 
	}
}

909 #i
defed
 
SYSCLK_FREQ_72MHz


917 
	$SSysClockTo72
(

920 
__IO
 
ut32_t
 
SUpCou
 = 0, 
HSEStus
 = 0;

924 
RCC
->
CR
 |((
ut32_t

RCC_CR_HSEON
);

928 
HSEStus
 = 
RCC
->
CR
 & 
RCC_CR_HSERDY
;

929 
SUpCou
++;

930 } (
HSEStus
 =0&& (
SUpCou
 !
HSE_STARTUP_TIMEOUT
));

932 i((
RCC
->
CR
 & 
RCC_CR_HSERDY
!
RESET
) {

933 
HSEStus
 = (
ut32_t
) 0x01;

935 
HSEStus
 = (
ut32_t
) 0x00;

938 i(
HSEStus
 =(
ut32_t
) 0x01) {

940 
FLASH
->
ACR
 |
FLASH_ACR_PRFTBE
;

943 
FLASH
->
ACR
 &(
ut32_t
((ut32_t~ 
FLASH_ACR_LATENCY
);

944 
FLASH
->
ACR
 |(
ut32_t

FLASH_ACR_LATENCY_2
;

948 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_HPRE_DIV1
;

951 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE2_DIV1
;

954 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_PPRE1_DIV2
;

956 #ifde
STM32F10X_CL


961 
RCC
->
CFGR2
 &=

962 (
ut32_t
~ (
RCC_CFGR2_PREDIV2
 | 
RCC_CFGR2_PLL2MUL
 |

963 
RCC_CFGR2_PREDIV1
 | 
RCC_CFGR2_PREDIV1SRC
);

964 
RCC
->
CFGR2
 |=

965 (
ut32_t
(
RCC_CFGR2_PREDIV2_DIV5
 | 
RCC_CFGR2_PLL2MUL8
 |

966 
RCC_CFGR2_PREDIV1SRC_PLL2
 | 
RCC_CFGR2_PREDIV1_DIV5
);

969 
RCC
->
CR
 |
RCC_CR_PLL2ON
;

971 (
RCC
->
CR
 & 
RCC_CR_PLL2RDY
) == 0) {

976 
RCC
->
CFGR
 &=

977 (
ut32_t
~ (
RCC_CFGR_PLLXTPRE
 | 
RCC_CFGR_PLLSRC
 |

978 
RCC_CFGR_PLLMULL
);

979 
RCC
->
CFGR
 |=

980 (
ut32_t
(
RCC_CFGR_PLLXTPRE_PREDIV1
 | 
RCC_CFGR_PLLSRC_PREDIV1
 |

981 
RCC_CFGR_PLLMULL9
);

984 
RCC
->
CFGR
 &=

985 (
ut32_t
((ut32_t~ (
RCC_CFGR_PLLSRC
 | 
RCC_CFGR_PLLXTPRE
 |

986 
RCC_CFGR_PLLMULL
));

987 
RCC
->
CFGR
 |(
ut32_t
(
RCC_CFGR_PLLSRC_HSE
 | 
RCC_CFGR_PLLMULL9
);

991 
RCC
->
CR
 |
RCC_CR_PLLON
;

994 (
RCC
->
CR
 & 
RCC_CR_PLLRDY
) == 0) {

998 
RCC
->
CFGR
 &(
ut32_t
((ut32_t~ (
RCC_CFGR_SW
));

999 
RCC
->
CFGR
 |(
ut32_t

RCC_CFGR_SW_PLL
;

1002 (
RCC
->
CFGR
 & (
ut32_t

RCC_CFGR_SWS
) != (uint32_t) 0x08) {

1007 
	}
}

	@ports/stm32f10x/timer.c

24 
	~<dbo.h
>

25 
	~<dt.h
>

26 
	~"tim.h
"

37 
	$tim_d_t
(

38 
im
 *
t
)

40 
ut32_t
 
now
 = 
	`tim_mlicds
();

42 i(
t
) {

43 
t
->
t
 = 
now
;

45 
	}
}

52 
ut32_t
 
	$tim_d_time
(

53 
im
 *
t
)

55 
ut32_t
 
now
 = 
	`tim_mlicds
();

56 
ut32_t
 
d
 = 0;

58 i(
t
) {

59 
d
 = 
now
 - 
t
->
t
;

62  
d
;

63 
	}
}

70 
	$tim_d_t_offt
(

71 
im
 *
t
,

72 
ut32_t
 
offt
)

74 
ut32_t
 
now
 = 
	`tim_mlicds
();

76 i(
t
) {

77 
t
->
t
 = 
now
 + 
offt
;

79 
	}
}

86 
bo
 
	$tim_d_mlicds
(

87 
im
 *
t
,

88 
ut32_t
 
mlicds
)

90  (
	`tim_d_time
(
t
>
mlicds
);

91 
	}
}

98 
bo
 
	$tim_d_cds
(

99 
im
 * 
t
,

100 
ut32_t
 
cds
)

102 
ut32_t
 
mlicds
 = 
cds
;

104 
mlicds
 *= 1000L;

106  
	`tim_d_mlicds
(
t
, 
mlicds
);

107 
	}
}

114 
bo
 
	$tim_d_mus
(

115 
im
 * 
t
,

116 
ut32_t
 
mus
)

118 
ut32_t
 
mlicds
 = 
mus
;

120 
mlicds
 *= 1000L;

121 
mlicds
 *= 60L;

123  
	`tim_d_mlicds
(
t
, 
mlicds
);

124 
	}
}

131 
bo
 
	$tim_d_mlicds_sht
(

132 
im
 * 
t
,

133 
ut16_t
 
vue
)

135 
ut32_t
 
mlicds
;

137 
mlicds
 = 
vue
;

139  (
	`tim_d_time
(
t
>
mlicds
);

140 
	}
}

147 
bo
 
	$tim_d_cds_sht
(

148 
im
 * 
t
,

149 
ut16_t
 
vue
)

151  
	`tim_d_cds
(
t
, 
vue
);

152 
	}
}

159 
bo
 
	$tim_d_mus_sht
(

160 
im
 * 
t
,

161 
ut16_t
 
vue
)

163  
	`tim_d_mus
(
t
, 
vue
);

164 
	}
}

171 
	$tim_rv_t
(

172 
im
 *
t
,

173 
ut32_t
 
rv
)

175 i(
t
) {

176 
t
->
t
 = 
	`tim_mlicds
();

177 
t
->
rv
 = interval;

179 
	}
}

186 
	$tim_rv_t_cds
(

187 
im
 *
t
,

188 
ut32_t
 
cds
)

190 
ut32_t
 
rv
 = 
cds
;

192 
rv
 *= 1000L;

193 
	`tim_rv_t
(
t
, 
rv
);

194 
	}
}

201 
	$tim_rv_t_mus
(

202 
im
 *
t
,

203 
ut32_t
 
mus
)

205 
ut32_t
 
rv
 = 
mus
;

207 
rv
 *= 1000L;

208 
rv
 *= 60L;

209 
	`tim_rv_t
(
t
, 
rv
);

210 
	}
}

217 
ut32_t
 
	$tim_rv_d
(

218 
im
 *
t
)

220 
ut32_t
 
now
 = 
	`tim_mlicds
();

221 
ut32_t
 
d
 = 0;

223 i(
t
) {

224 
d
 = 
now
 - 
t
->
t
;

227  
d
;

228 
	}
}

235 
ut32_t
 
	$tim_rv
(

236 
im
 * 
t
)

238 
ut32_t
 
rv
 = 0;

240 i(
t
) {

241 
rv
 = 
t
->interval;

244  
rv
;

245 
	}
}

252 
bo
 
	$tim_rv_exped
(

253 
im
 * 
t
)

255 
bo
 
exped
 = 
l
;

257 i(
t
) {

258 i(
t
->
rv
) {

259 
exped
 = 
	`tim_rv_d
(
t
>t->
rv
;

263  
exped
;

264 
	}
}

271 
	$tim_rv_no_expe
(

272 
im
 *
t
)

274 i(
t
) {

275 
t
->
rv
 = 0;

277 
	}
}

285 
	$tim_rv_t
(

286 
im
 *
t
)

288 i(
t
) {

289 
t
->
t
 +t->
rv
;

291 
	}
}

298 
	$tim_rv_t
(

299 
im
 *
t
)

301 i(
t
) {

302 
t
->
t
 = 
	`tim_mlicds
();

304 
	}
}

311 
ut8_t
 
	$tim_mlicds_d
(

312 
ut8_t
 
t
)

314  (
	`tim_mlicds_by
(- 
t
);

315 
	}
}

322 
ut8_t
 
	$tim_mlicds_mk
(

325  
	`tim_mlicds_by
();

326 
	}
}

328 #ifde
TEST


329 
	~<as.h
>

330 
	~<rg.h
>

332 
	~"e.h
"

334 
ut32_t
 
	gMlicds
;

336 
ut32_t
 
	$tim_mlicds
(

339  
Mlicds
;

340 
	}
}

342 
ut32_t
 
	$tim_mlicds_t
(

343 
ut32_t
 
vue
)

345 
ut32_t
 
d_vue
 = 
Mlicds
;

347 
Mlicds
 = 
vue
;

349  
d_vue
;

350 
	}
}

352 
	$EpdTim
(

353 
Te
 * 
pTe
)

355 
im
 
t
;

356 
ut32_t
 
_time
 = 0;

358 
	`tim_mlicds_t
(
_time
);

359 
	`tim_d_t
(&
t
);

360 
	`_
(
pTe
, 
	`tim_d_time
(&
t
=
_time
);

361 
_time
 = 0xffff;

362 
	`tim_mlicds_t
(
_time
);

363 
	`_
(
pTe
, 
	`tim_d_time
(&
t
=
_time
);

364 
_time
 = 0xffffffff;

365 
	`tim_mlicds_t
(
_time
);

366 
	`_
(
pTe
, 
	`tim_d_time
(&
t
=
_time
);

367 
	}
}

369 
	$IvTim
(

370 
Te
 * 
pTe
)

372 
im
 
t
;

373 
ut32_t
 
rv
 = 0;

374 
ut32_t
 
_time
 = 0;

376 
	`tim_mlicds_t
(
_time
);

377 
	`tim_rv_t
(&
t
, 
rv
);

378 
_time
 = 0xffff;

379 
	`tim_mlicds_t
(
_time
);

380 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

381 
	`_
(
pTe
, 
	`tim_rv_d
(&
t
=
_time
);

382 
_time
 = 0xffffffff;

383 
	`tim_mlicds_t
(
_time
);

384 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

385 
	`_
(
pTe
, 
	`tim_rv_d
(&
t
=
_time
);

386 
_time
 = 0;

387 
	`tim_mlicds_t
(
_time
);

388 
rv
 = 0xffff;

389 
	`tim_rv_t
(&
t
, 
rv
);

390 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

391 
rv
 = 0xffffffff;

392 
	`tim_rv_t
(&
t
, 
rv
);

393 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

395 
rv
 = 0;

396 
	`tim_rv_t_cds
(&
t
, 
rv
);

397 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

398 
rv
 = 60L;

399 
	`tim_rv_t_cds
(&
t
, 
rv
);

400 
rv
 *= 1000L;

401 
	`_
(
pTe
, 
	`tim_rv
(&
t
=
rv
);

403 
	}
}

406 #ifde
TEST_TIMER


407 
	$ma
(

410 
Te
 *
pTe
;

411 
bo
 
rc
;

413 
pTe
 = 
	`_
("Tim", 
NULL
);

416 
rc
 = 
	`_addTeFuni
(
pTe
, 
EpdTim
);

417 
	`as
(
rc
);

418 
rc
 = 
	`_addTeFuni
(
pTe
, 
IvTim
);

419 
	`as
(
rc
);

422 
	`_tSm
(
pTe
, 
dout
);

423 
	`_run
(
pTe
);

424 (
	`_pt
(
pTe
);

426 
	`_deroy
(
pTe
);

429 
	}
}

	@ports/stm32f10x/timer.h

24 #ide
TIMER_H


25 
	#TIMER_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

33 
	sim
 {

34 
ut32_t
 
	mt
;

37 
	sim
 {

38 
ut32_t
 
	mt
;

39 
ut32_t
 
	mrv
;

42 #ifde
__lulus


47 
tim_
(

49 
ut32_t
 
tim_mlicds
(

51 
ut8_t
 
tim_mlicds_by
(

57 
tim_d_t
(

58 
im
 *
t
);

59 
tim_d_t_offt
(

60 
im
 *
t
,

61 
ut32_t
 
offt
);

62 
ut32_t
 
tim_d_time
(

63 
im
 *
t
);

64 
bo
 
tim_d_mlicds
(

65 
im
 *
t
,

66 
ut32_t
 
vue
);

67 
bo
 
tim_d_cds
(

68 
im
 *
t
,

69 
ut32_t
 
vue
);

70 
bo
 
tim_d_mus
(

71 
im
 *
t
,

72 
ut32_t
 
vue
);

73 
bo
 
tim_d_mlicds_sht
(

74 
im
 *
t
,

75 
ut16_t
 
vue
);

76 
bo
 
tim_d_cds_sht
(

77 
im
 *
t
,

78 
ut16_t
 
vue
);

79 
bo
 
tim_d_mus_sht
(

80 
im
 *
t
,

81 
ut16_t
 
vue
);

84 
tim_rv_t
(

85 
im
 *
t
,

86 
ut32_t
 
rv
);

87 
tim_rv_t_cds
(

88 
im
 *
t
,

89 
ut32_t
 
rv
);

90 
tim_rv_t_mus
(

91 
im
 *
t
,

92 
ut32_t
 
rv
);

93 
bo
 
tim_rv_exped
(

94 
im
 *
t
);

95 
ut32_t
 
tim_rv
(

96 
im
 *
t
);

97 
ut32_t
 
tim_rv_d
(

98 
im
 *
t
);

99 
tim_rv_no_expe
(

100 
im
 *
t
);

101 
tim_rv_t
(

102 
im
 *
t
);

103 
tim_rv_t
(

104 
im
 *
t
);

107 
ut8_t
 
tim_mlicds_d
(

108 
ut8_t
 
t
);

109 
ut8_t
 
tim_mlicds_mk
(

112 #ifde
__lulus


	@ports/stm32f10x/timer_sys.c

28 
	~<dbo.h
>

29 
	~<dt.h
>

30 
	~"hdwe.h
"

31 
	~"tim.h
"

32 
	~"debug.h
"

35 vީ
ut32_t
 
	gMlicd_Cou
;

42 
	$tim_debug_
(

45 
	`GPIO_WreB
(
GPIOB
, 
GPIO_P_13
, 
B_SET
);

46 
	}
}

53 
	$tim_debug_off
(

56 
	`GPIO_WreB
(
GPIOB
, 
GPIO_P_13
, 
B_RESET
);

57 
	}
}

64 
	$tim_debug_togg
(

67 
bo
 
e
 = 
l
;

69 i(
e
) {

70 
	`tim_debug_off
();

71 
e
 = 
l
;

73 
	`tim_debug_
();

74 
e
 = 
ue
;

76 
	}
}

83 
	$SysTick_Hdr
(

87 
Mlicd_Cou
++;

88 
	`tim_debug_togg
();

89 
	}
}

96 
ut32_t
 
	$tim_mlicds
(

99  
Mlicd_Cou
;

100 
	}
}

107 
	$tim_
(

110 
GPIO_InTyDef
 
GPIO_InSuu
;

112 
	`GPIO_SuIn
(&
GPIO_InSuu
);

114 
GPIO_InSuu
.
GPIO_P
 = 
GPIO_P_13
;

115 
GPIO_InSuu
.
GPIO_Sed
 = 
GPIO_Sed_50MHz
;

116 
GPIO_InSuu
.
GPIO_Mode
 = 
GPIO_Mode_Out_PP
;

117 
	`GPIO_In
(
GPIOB
, &
GPIO_InSuu
);

120 i(
	`SysTick_Cfig
(
SyemCeClock
 / 1000)) {

125 
	}
}

	@ports/win32/bip-init.c

36 
	~<dio.h
>

37 
	~<dlib.h
>

38 
	~<dt.h
>

39 
	~<dbo.h
>

40 
	~"bacdcode.h
"

41 
	~"cfig.h
"

42 
	~"b.h
"

43 
	~"t.h
"

45 
bo
 
	gBIP_Debug
 = 
l
;

52 
	$b_gaddrbyme
(

53 cڡ *
ho_me
)

55 
hot
 *
ho_t
;

57 i((
ho_t
 = 
	`ghobyme
(
ho_me
)=
NULL
)

60  *(*
ho_t
->
h_addr
;

61 
	}
}

64 
	$ghoaddr
(

67 
hot
 *
ho_t
;

68 
ho_me
[255];

70 i(
	`ghome
(
ho_me
, (host_name)) != 0)

73 i((
ho_t
 = 
	`ghobyme
(
ho_me
)=
NULL
)

75 i(
BIP_Debug
) {

76 
	`tf
("ho: % %u.%u.%u.%u\n", 
ho_me
,

77 (((
ut8_t
 *
ho_t
->
h_addr
)[0],

78 (((
ut8_t
 *
ho_t
->
h_addr
)[1],

79 (((
ut8_t
 *
ho_t
->
h_addr
)[2],

80 (((
ut8_t
 *
ho_t
->
h_addr
)[3]);

83  *(*
ho_t
->
h_addr
;

84 
	}
}

86 #i(!
defed
(
USE_INADDR
) || (USE_INADDR == 0)) && \

87 (!
defed
(
USE_CLASSADDR
|| (
	gUSE_CLASSADDR
 == 0))

89 
ut32_t
 
	$gIpMaskFIpAddss
(

90 
ut32_t
 
Addss
)

93 
IP_ADAPTER_INFO
 
AdrInfo
[16];

95 
DWORD
 
dwBufL
 = (
AdrInfo
);

96 
ut32_t
 
Mask
 = 
INADDR_BROADCAST
;

97 
bo
 
found
 = 
l
;

99 
PIP_ADAPTER_INFO
 
pAdrInfo
;

104 
DWORD
 
dwStus
 = 
	`GAdrsInfo
(
AdrInfo
,

105 &
dwBufL
);

106 i(
dwStus
 =
ERROR_SUCCESS
) {

109 
pAdrInfo
 = 
AdrInfo
;

112 
IP_ADDR_STRING
 *
pIpAddssInfo
 = &
pAdrInfo
->
IpAddssLi
;

114 
adrAddss
 =

115 
	`_addr
(
pIpAddssInfo
->
IpAddss
.
Sg
);

116 
adrMask
 =

117 
	`_addr
(
pIpAddssInfo
->
IpMask
.
Sg
);

118 i(
adrAddss
 =
Addss
) {

119 
Mask
 = 
adrMask
;

120 
found
 = 
ue
;

122 
pIpAddssInfo
 =IpAddssInfo->
Next
;

123 } 
pIpAddssInfo
 && !
found
);

125 
pAdrInfo
 =AdrInfo->
Next
;

127 } 
pAdrInfo
 && !
found
);

130  
Mask
;

131 
	}
}

134 
	$t_brd_addss
(

135 
ut32_t
 
t_addss
)

137 #i
	`defed
(
USE_INADDR
) && USE_INADDR

140 
t_addss
 =et_address;

141 
	`b_t_brd_addr
(
INADDR_BROADCAST
);

142 #i
	`defed
(
USE_CLASSADDR
) && USE_CLASSADDR

143 
brd_addss
 = 0;

145 i(
	`IN_CLASSA
(
	`ohl
(
t_addss
)))

146 
brd_addss
 =

147 (
	`ohl
(
t_addss
& ~
IN_CLASSA_HOST
) | IN_CLASSA_HOST;

148 i(
	`IN_CLASSB
(
	`ohl
(
t_addss
)))

149 
brd_addss
 =

150 (
	`ohl
(
t_addss
& ~
IN_CLASSB_HOST
) | IN_CLASSB_HOST;

151 i(
	`IN_CLASSC
(
	`ohl
(
t_addss
)))

152 
brd_addss
 =

153 (
	`ohl
(
t_addss
& ~
IN_CLASSC_HOST
) | IN_CLASSC_HOST;

154 i(
	`IN_CLASSD
(
	`ohl
(
t_addss
)))

155 
brd_addss
 =

156 (
	`ohl
(
t_addss
& ~
IN_CLASSD_HOST
) | IN_CLASSD_HOST;

158 
brd_addss
 = 
INADDR_BROADCAST
;

159 
	`b_t_brd_addr
(
	`htl
(
brd_addss
));

162 
brd_addss
 = 0;

163 
t_mask
 = 0;

165 
t_mask
 = 
	`gIpMaskFIpAddss
(
t_addss
);

166 i(
BIP_Debug
) {

167 
_addr
 
addss
;

168 
addss
.
s_addr
 = 
t_mask
;

169 
	`tf
("IP Mask: %s\n", 
	`_
(
addss
));

171 
brd_addss
 = (
t_addss
 & 
t_mask
) | (~net_mask);

172 
	`b_t_brd_addr
(
brd_addss
);

174 
	}
}

177 
	$b_t_r
(

178 *
iame
)

180 
_addr
 
addss
;

183 i(
	`b_g_addr
() == 0) {

184 
	`b_t_addr
(
	`_addr
(
iame
));

186 i(
BIP_Debug
) {

187 
addss
.
s_addr
 = 
	`b_g_addr
();

188 
	`rtf
(
dr
, "I: %s\n", 
iame
);

191 i(
	`b_g_brd_addr
() == 0) {

192 
addss
.
s_addr
 = 
	`b_g_addr
();

193 
	`t_brd_addss
(
addss
.
s_addr
);

195 
	}
}

197 *
	$wsock_r_code_xt
(

198 
code
)

200 
code
) {

201 
WSAEACCES
:

203 
WSAEINTR
:

205 
WSAEBADF
:

207 
WSAEFAULT
:

209 
WSAEINVAL
:

211 
WSAEMFILE
:

213 
WSAEWOULDBLOCK
:

215 
WSAEINPROGRESS
:

220 
WSAENOTSOCK
:

222 
WSAEDESTADDRREQ
:

224 
WSAEMSGSIZE
:

226 
WSAEPROTOTYPE
:

228 
WSAENOPROTOOPT
:

230 
WSAEPROTONOSUPPORT
:

232 
WSAESOCKTNOSUPPORT
:

234 
WSAEOPNOTSUPP
:

236 
WSAEPFNOSUPPORT
:

238 
WSAEAFNOSUPPORT
:

240 
WSAEADDRINUSE
:

242 
WSAEADDRNOTAVAIL
:

244 
WSAENETDOWN
:

249 
WSAENETUNREACH
:

251 
WSAENETRESET
:

253 
WSAECONNABORTED
:

255 
WSAECONNRESET
:

257 
WSAENOBUFS
:

259 
WSAEISCONN
:

261 
WSAENOTCONN
:

263 
WSAESHUTDOWN
:

265 
WSAETOOMANYREFS
:

267 
WSAETIMEDOUT
:

269 
WSAECONNREFUSED
:

271 
WSAELOOP
:

273 
WSAENAMETOOLONG
:

275 
WSAEHOSTDOWN
:

277 
WSAEHOSTUNREACH
:

279 
WSASYSNOTREADY
:

282 
WSAVERNOTSUPPORTED
:

286 
WSANOTINITIALISED
:

292 
WSAEDISCON
:

294 
WSAHOST_NOT_FOUND
:

297 
WSATRY_AGAIN
:

301 
WSANO_RECOVERY
:

305 
WSANO_DATA
:

312 
	}
}

331 
bo
 
	$b_
(

332 *
iame
)

334 
rv
 = 0;

335 
sockaddr_
 
s
 = { -1 };

336 
vue
 = 1;

337 
sock_fd
 = -1;

338 
Resu
;

339 
Code
;

340 
WSADATA
 
wd
;

341 
_addr
 
addss
;

342 
_addr
 
brd_addss
;

344 
Resu
 = 
	`WSASup
((1 << 8| 1, &
wd
);

346 i(
Resu
 != 0) {

347 
Code
 = 
	`WSAGLaE
();

348 
	`tf
("TCP/IP stack initialization failed\n" "rror code: %i %s\n",

349 
Code
, 
	`wsock_r_code_xt
(Code));

350 
	`ex
(1);

352 
	`ex
(
b_nup
);

354 i(
iame
)

355 
	`b_t_r
(
iame
);

357 
addss
.
s_addr
 = 
	`b_g_addr
();

358 i(
addss
.
s_addr
 == 0) {

359 
addss
.
s_addr
 = 
	`ghoaddr
();

360 i(
addss
.
s_addr
 == () -1) {

361 
Code
 = 
	`WSAGLaE
();

362 
	`tf
("G hoddsed\n" " code: %%s\n", 
Code
,

363 
	`wsock_r_code_xt
(
Code
));

364 
	`ex
(1);

366 
	`b_t_addr
(
addss
.
s_addr
);

368 i(
BIP_Debug
) {

369 
	`rtf
(
dr
, "IP Addss: %s\n", 
	`_
(
addss
));

372 i(
	`b_g_brd_addr
() == 0) {

373 
	`t_brd_addss
(
addss
.
s_addr
);

375 i(
BIP_Debug
) {

376 
brd_addss
.
s_addr
 = 
	`b_g_brd_addr
();

377 
	`rtf
(
dr
, "IP Broadcast Address: %s\n",

378 
	`_
(
brd_addss
));

379 
	`rtf
(
dr
, "UDP Pt: 0x%04X [%hu]\n", 
	`ohs
(
	`b_g_pt
()),

380 
	`ohs
(
	`b_g_pt
()));

383 
sock_fd
 = 
	`sock
(
AF_INET
, 
SOCK_DGRAM
, 
IPPROTO_UDP
);

384 
	`b_t_sock
(
sock_fd
);

385 i(
sock_fd
 < 0) {

386 
	`rtf
(
dr
, "bip: failedollocate socket.\n");

387  
l
;

391 
rv
 = 
	`tsockt
(
sock_fd
, 
SOL_SOCKET
, 
SO_REUSEADDR
, (*&
vue
,

392 (
vue
));

393 i(
rv
 < 0) {

394 
	`rtf
(
dr
, "bip: failedo set REUSEADDR socket option.\n");

395 
	`o
(
sock_fd
);

396 
	`b_t_sock
(-1);

397  
l
;

400 
rv
 = 
	`tsockt
(
sock_fd
, 
SOL_SOCKET
, 
SO_BROADCAST
, (*&
vue
,

401 (
vue
));

402 i(
rv
 < 0) {

403 
	`rtf
(
dr
, "bip: failedo set BROADCAST socket option.\n");

404 
	`o
(
sock_fd
);

405 
	`b_t_sock
(-1);

406  
l
;

412 
rv
 = 
	`tsockt
(
sock_fd
, 
SOL_SOCKET
, 
SO_REUSEPORT
, (*&
vue
,

413 (
vue
));

414 i(
rv
 < 0) {

415 
	`rtf
(
dr
, "bip: failedo set REUSEPORT socket option.\n");

416 
	`o
(
sock_fd
);

417 
	`b_t_sock
(-1);

418  
l
;

422 
s
.
s_my
 = 
AF_INET
;

423 #i
	`defed
(
USE_INADDR
) && USE_INADDR

436 
s
.
s_addr
.
s_addr
 = 
	`htl
(
INADDR_ANY
);

440 
s
.
s_addr
.
s_addr
 = 
addss
.s_addr;

442 
s
.
s_pt
 = 
	`b_g_pt
();

443 
	`memt
(&(
s
.
s_zo
), '\0', (sin.sin_zero));

444 
rv
 = 
	`bd
(
sock_fd
, (cڡ 
sockaddr
 *&
s
,

445 (
sockaddr
));

446 i(
rv
 < 0) {

447 
	`rtf
(
dr
, "bip: failedo bindo %sort %hu\n",

448 
	`_
(
s
.
s_addr
), 
	`ohs
(
	`b_g_pt
()));

449 
	`o
(
sock_fd
);

450 
	`b_t_sock
(-1);

451  
l
;

454  
ue
;

455 
	}
}

460 
	$b_nup
(

463 
sock_fd
 = 0;

465 i(
	`b_vid
()) {

466 
sock_fd
 = 
	`b_sock
();

467 
	`o
(
sock_fd
);

469 
	`b_t_sock
(-1);

470 
	`WSAC˪up
();

473 
	}
}

	@ports/win32/bip6.c

35 
	~<dio.h
>

36 
	~<dlib.h
>

37 
	~<dt.h
>

38 
	~<dbo.h
>

39 
	~"bacdcode.h
"

40 
	~"cfig.h
"

41 
	~"debug.h
"

42 
	~"devi.h
"

43 
	~"b6.h
"

44 
	~"t.h
"

47 
SOCKET
 
	gBIP6_Sock
 = 
INVALID_SOCKET
;

49 
BACNET_IP6_ADDRESS
 
	gBIP6_Addr
;

50 
BACNET_IP6_ADDRESS
 
	gBIP6_Brd_Addr
;

52 
	$debug_t_v6
(cڡ *
r
, cڡ 
6_addr
 * 
addr
) {

53 
	`debug_tf
( "BIP6: %s %02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x:%02x%02x\n",

54 
r
,

55 ()
addr
->
s6_addr
[0], ()addr->s6_addr[1],

56 ()
addr
->
s6_addr
[2], ()addr->s6_addr[3],

57 ()
addr
->
s6_addr
[4], ()addr->s6_addr[5],

58 ()
addr
->
s6_addr
[6], ()addr->s6_addr[7],

59 ()
addr
->
s6_addr
[8], ()addr->s6_addr[9],

60 ()
addr
->
s6_addr
[10], ()addr->s6_addr[11],

61 ()
addr
->
s6_addr
[12], ()addr->s6_addr[13],

62 ()
addr
->
s6_addr
[14], ()addr->s6_addr[15]);

63 
	}
}

65 
LPSTR
 
	$PrtE
(
ECode
)

67 
Mesge
[1024];

73 
	`FmMesge
(
FORMAT_MESSAGE_FROM_SYSTEM
 | 
FORMAT_MESSAGE_IGNORE_INSERTS
 |

74 
FORMAT_MESSAGE_MAX_WIDTH_MASK
, 
NULL
, 
ECode
,

75 
	`MAKELANGID
(
LANG_NEUTRAL
, 
SUBLANG_DEFAULT
),

76 (
LPSTR

Mesge
, 1024, 
NULL
);

77  
Mesge
;

78 
	}
}

81 
	$b6_t_r
(

82 *
iame
)

84 
i
, 
RV
;

85 
addrfo
 
Hts
, *
AddrInfo
, *
AI
;

86 
sockaddr_6
* 
s
;

87 
sockaddr_6
 
rv
;

88 
6_addr
 
brd_addss
;

89 
v6_mq
 
jo_que
;

90 
SOCKET
 
SvSock
[
FD_SETSIZE
];

91 
pt
[6] = "";

92 
sockt
 = 0;

101 
	`memt
(&
Hts
, 0,  (Hints));

102 
Hts
.
ai_my
 = 
PF_INET6
;

103 
Hts
.
ai_sockty
 = 
SOCK_DGRAM
;

104 
Hts
.
ai_oc
 = 
IPPROTO_UDP
;

105 
Hts
.
ai_ags
 = 
AI_NUMERICHOST
 | 
AI_PASSIVE
;

106 
	`tf
(
pt
, t), "%u", 
BIP6_Addr
.port);

107 
	`debug_tf
("BIP6: gaddrf- IPv6dds%p܈%s\n", 
iame
, 
pt
);

108 
RV
 = 
	`gaddrfo
(
iame
, &
pt
[0], &
Hts
, &
AddrInfo
);

109 i(
RV
 != 0) {

110 
	`rtf
(
dr
, "BIP6: getaddrinfo failed withrror %d: %s\n",

111 
RV
, 
	`gai_
(RetVal));

112 
	`WSAC˪up
();

120 
i
 = 0, 
AI
 = 
AddrInfo
; AI !
NULL
; AI = AI->
ai_xt
) {

122 i(
i
 =
FD_SETSIZE
) {

123 
	`rtf
(
dr
,

128 i(
AI
->
ai_my
 !
PF_INET6
) {

132 i(
AI
->
ai_sockty
 !
SOCK_DGRAM
) {

136 i(
AI
->
ai_oc
 !
IPPROTO_UDP
) {

139 
BIP6_Sock
 = 
	`sock
(
PF_INET6
, 
SOCK_DGRAM
, 
IPPROTO_UDP
);

140 i(
BIP6_Sock
 =
INVALID_SOCKET
) {

141 
	`rtf
(
dr
, "BIP6: socket() failed withrror %d: %s\n",

142 
	`WSAGLaE
(), 
	`PrtE
(WSAGetLastError()));

145 i((
AI
->
ai_my
 =
PF_INET6
) &&

146 
	`IN6_IS_ADDR_LINKLOCAL
(
AI
->
ai_addr
) &&

147 (((
SOCKADDR_IN6
 *(
AI
->
ai_addr
))->
s6_sce_id
 == 0)) {

148 
	`rtf
(
dr
,

153 
sockt
 = 1;

154 
RV
 =

155 
	`tsockt
(
BIP6_Sock
, 
SOL_SOCKET
, 
SO_REUSEADDR
,

156 (*)&
sockt
, (sockopt));

157 i(
RV
 < 0) {

158 
	`osock
(
BIP6_Sock
);

159 
BIP6_Sock
 = 
INVALID_SOCKET
;

163 
RV
 =

164 
	`tsockt
(
BIP6_Sock
, 
SOL_SOCKET
, 
SO_BROADCAST
,

165 (*)&
sockt
, (sockopt));

166 i(
RV
 < 0) {

167 
	`osock
(
BIP6_Sock
);

168 
BIP6_Sock
 = 
INVALID_SOCKET
;

169 
	`rtf
(
dr
, "BIP6: setsockopt(SO_BROADCAST) failed "

171 
	`WSAGLaE
(), 
	`PrtE
(WSAGetLastError()));

175 
	`memy
(&
brd_addss
.
s6_addr
[0], &
BIP6_Brd_Addr
.
addss
[0],

176 
IP6_ADDRESS_MAX
);

177 
	`memy
(&
jo_que
.
v6mr_muɟddr
, &
brd_addss
,

178 (
6_addr
));

180 
jo_que
.
v6mr_r
 = 0;

181 
RV
 = 
	`tsockt
(
BIP6_Sock
, 
IPPROTO_IPV6
, 
IPV6_JOIN_GROUP
,

182 (*)&
jo_que
, (join_request));

183 i(
RV
 < 0) {

184 
	`rtf
(
dr
, "BIP6: setsockopt(IPV6_JOIN_GROUP) failed "

186 
	`WSAGLaE
(), 
	`PrtE
(WSAGetLastError()));

194 
	`memt
(&
rv
, 0, (server));

195 
rv
.
s6_my
 = 
PF_INET6
;

196 
rv
.
s6_pt
 = 
	`hts
(
BIP6_Addr
.
pt
);

197 
rv
.
s6_addr
 = 
6addr_y
;

198 i(
	`bd
(
BIP6_Sock
, (
sockaddr
 *&
rv
, (server)) ==

199 
SOCKET_ERROR
) {

200 
	`rtf
(
dr
, "BIP6: bind() failed withrror %d: %s\n",

201 
	`WSAGLaE
(), 
	`PrtE
(WSAGetLastError()));

202 
	`osock
(
SvSock
[
i
]);

205 
s
 = (
sockaddr_6
*)
AI
->
ai_addr
;

206 
	`bvlc6_addss_t
(&
BIP6_Addr
,

207 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[0]),

208 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[1]),

209 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[2]),

210 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[3]),

211 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[4]),

212 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[5]),

213 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[6]),

214 
	`ohs
(
s
->
s6_addr
.
s6_addr16
[7]));

217 
i
++;

218 i(
BIP6_Sock
 !
INVALID_SOCKET
) {

222 
	`addrfo
(
AddrInfo
);

223 
	}
}

230 
	$b6_t_pt
(

231 
ut16_t
 
pt
)

233 
BIP6_Addr
.
pt
 =ort;

234 
BIP6_Brd_Addr
.
pt
 =ort;

235 
	}
}

242 
ut16_t
 
	$b6_g_pt
(

245  
BIP6_Addr
.
pt
;

246 
	}
}

254 
	$b6_g_brd_addss
(

255 
BACNET_ADDRESS
 * 
addr
)

257 i(
addr
) {

258 
addr
->
t
 = 
BACNET_BROADCAST_NETWORK
;

259 
addr
->
mac_n
 = 0;

260 
addr
->
n
 = 0;

262 
	}
}

269 
	$b6_g_my_addss
(

270 
BACNET_ADDRESS
 * 
addr
)

272 
ut32_t
 
devi_id
 = 0;

274 i(
addr
) {

275 
devi_id
 = 
	`Devi_Obje_In_Numb
();

276 
	`bvlc6_vmac_addss_t
(
addr
, 
devi_id
);

278 
	}
}

285 
bo
 
	$b6_t_addr
(

286 
BACNET_IP6_ADDRESS
 *
addr
)

288  
	`bvlc6_addss_cy
(&
BIP6_Addr
, 
addr
);

289 
	}
}

296 
bo
 
	$b6_g_addr
(

297 
BACNET_IP6_ADDRESS
 *
addr
)

299  
	`bvlc6_addss_cy
(
addr
, &
BIP6_Addr
);

300 
	}
}

310 
bo
 
	$b6_addss_mch_lf
(

311 
BACNET_IP6_ADDRESS
 *
addr
)

313  !
	`bvlc6_addss_dif
(
addr
, &
BIP6_Addr
);

314 
	}
}

321 
bo
 
	$b6_t_brd_addr
(

322 
BACNET_IP6_ADDRESS
 *
addr
)

324  
	`bvlc6_addss_cy
(&
BIP6_Brd_Addr
, 
addr
);

325 
	}
}

332 
bo
 
	$b6_g_brd_addr
(

333 
BACNET_IP6_ADDRESS
 *
addr
)

335  
	`bvlc6_addss_cy
(
addr
, &
BIP6_Brd_Addr
);

336 
	}
}

349 
	$b6_nd_mpdu
(

350 
BACNET_IP6_ADDRESS
 *
de
,

351 
ut8_t
 * 
mtu
,

352 
ut16_t
 
mtu_n
)

354 
sockaddr_6
 
bvlc_de
 = { 0 };

355 
ut16_t
 
addr16
[8];

358 i(
BIP6_Sock
 < 0) {

362 
bvlc_de
.
s6_my
 = 
AF_INET6
;

363 
	`bvlc6_addss_g
(
de
, &
addr16
[0], &addr16[1], &addr16[2], &addr16[3],

364 &
addr16
[4], &addr16[5], &addr16[6], &addr16[7]);

365 
bvlc_de
.
s6_addr
.
s6_addr16
[0] = 
	`hts
(
addr16
[0]);

366 
bvlc_de
.
s6_addr
.
s6_addr16
[1] = 
	`hts
(
addr16
[1]);

367 
bvlc_de
.
s6_addr
.
s6_addr16
[2] = 
	`hts
(
addr16
[2]);

368 
bvlc_de
.
s6_addr
.
s6_addr16
[3] = 
	`hts
(
addr16
[3]);

369 
bvlc_de
.
s6_addr
.
s6_addr16
[4] = 
	`hts
(
addr16
[4]);

370 
bvlc_de
.
s6_addr
.
s6_addr16
[5] = 
	`hts
(
addr16
[5]);

371 
bvlc_de
.
s6_addr
.
s6_addr16
[6] = 
	`hts
(
addr16
[6]);

372 
bvlc_de
.
s6_addr
.
s6_addr16
[7] = 
	`hts
(
addr16
[7]);

373 
bvlc_de
.
s6_pt
 = 
	`hts
(
de
->
pt
);

374 
	`debug_t_v6
("BIP6: Sdg MPDU->", &
bvlc_de
.
s6_addr
);

376  
	`ndto
(
BIP6_Sock
, (*
mtu
, 
mtu_n
, 0,

377 (
sockaddr
 *&
bvlc_de
, (bvlc_dest));

378 
	}
}

390 
ut16_t
 
	$b6_ive
(

391 
BACNET_ADDRESS
 * 
c
,

392 
ut8_t
 * 
du
,

393 
ut16_t
 
max_du
,

394 
timeout
)

396 
ut16_t
 
du_n
 = 0;

397 
fd_t
 
ad_fds
;

398 
max
 = 0;

399 
timev
 
_timeout
;

400 
sockaddr_6
 
s
 = { 0 };

401 
BACNET_IP6_ADDRESS
 
addr
 = {{ 0 }};

402 
sockn_t
 
s_n
 = (
s
);

403 
ived_bys
 = 0;

404 
offt
 = 0;

405 
ut16_t
 
i
 = 0;

408 i(
BIP6_Sock
 < 0) {

414 i(
timeout
 >= 1000) {

415 
_timeout
.
tv_c
 = 
timeout
 / 1000;

416 
_timeout
.
tv_uc
 =

417 1000 * (
timeout
 - 
_timeout
.
tv_c
 * 1000);

419 
_timeout
.
tv_c
 = 0;

420 
_timeout
.
tv_uc
 = 1000 * 
timeout
;

422 
	`FD_ZERO
(&
ad_fds
);

423 
	`FD_SET
(
BIP6_Sock
, &
ad_fds
);

424 
max
 = 
BIP6_Sock
;

426 i(
	`
(
max
 + 1, &
ad_fds
, 
NULL
, NULL, &
_timeout
) > 0) {

427 
ived_bys
 =

428 
	`cvom
(
BIP6_Sock
, (*&
du
[0], 
max_du
, 0,

429 (
sockaddr
 *&
s
, &
s_n
);

434 i(
ived_bys
 < 0) {

438 i(
ived_bys
 == 0) {

442 i(
du
[0] !
BVLL_TYPE_BACNET_IP6
) {

446 
	`memy
(&
addr
.
addss
[0], &(
s
.
s6_addr
), 16);

447 
	`memy
(&
addr
.
pt
, &
s
.
s6_pt
, 2);

448 
offt
 = 
	`bvlc6_hdr
(&
addr
, 
c
, 
du
, 
ived_bys
);

449 i(
offt
 > 0) {

450 
du_n
 = 
ived_bys
 - 
offt
;

451 i(
du_n
 <
max_du
) {

453 
i
 = 0; i < 
du_n
; i++) {

454 
du
[
i
] =pdu[
offt
 + i];

457 
du_n
 = 0;

461  
du_n
;

462 
	}
}

467 
	$b6_nup
(

470 i(
BIP6_Sock
 != -1) {

471 
	`o
(
BIP6_Sock
);

473 
BIP6_Sock
 = -1;

474 
	`WSAC˪up
();

477 
	}
}

498 
bo
 
	$b6_
(

499 *
iame
)

501 
WSADATA
 
wd
;

502 
RV
;

505 i((
RV
 = 
	`WSASup
(
	`MAKEWORD
(2, 2), &
wd
)) != 0) {

506 
	`rtf
(
dr
, "BIP6: WSAStartup failed withrror %d: %s\n",

507 
RV
, 
	`PrtE
(RetVal));

508 
	`WSAC˪up
();

509 
	`ex
(1);

511 i(
BIP6_Addr
.
pt
 == 0) {

512 
	`b6_t_pt
(0xBAC0);

514 
	`debug_tf
("BIP6: IPv6 UDPt: 0x%04X\n", 
BIP6_Addr
.
pt
);

515 
	`b6_t_r
(
iame
);

516 i(
BIP6_Brd_Addr
.
addss
[0] == 0) {

517 
	`bvlc6_addss_t
(&
BIP6_Brd_Addr
,

518 
BIP6_MULTICAST_LINK_LOCAL
, 0, 0, 0, 0, 0, 0,

519 
BIP6_MULTICAST_GROUP_ID
);

521 i(
BIP6_Sock
 =
INVALID_SOCKET
) {

522 
	`rtf
(
dr
, "BIP6: Fatalrror: unableo serve onnyddress.\n");

523 
	`WSAC˪up
();

524 
	`ex
(1);

527  
ue
;

528 
	}
}

	@ports/win32/dlmstp-mm.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<ddef.h
>

29 
	~<dlib.h
>

30 
	~<rg.h
>

31 
	~<dio.h
>

32 
	~"bacdef.h
"

33 
	~"baddr.h
"

34 
	~"mp.h
"

35 
	~"dlmp.h
"

36 
	~"rs485.h
"

37 
	~"du.h
"

38 
	~"bs.h
"

40 
	#WIN32_LEAN_AND_MEAN


	)

41 
	#STRICT
 1

	)

42 
	~<wdows.h
>

43 
	~<MMSyem.h
>

46 
ut16_t
 
	gMSTP_Packs
 = 0;

49 
DLMSTP_PACKET
 
	gReive_Pack
;

50 
HANDLE
 
	gReive_Pack_Fg
;

52 
HANDLE
 
	gReived_Fme_Fg
;

53 
DLMSTP_PACKET
 
	gTnsm_Pack
;

55 vީ
mp_pt_ru_t
 
	gMSTP_Pt
;

57 
ut8_t
 
	gTxBufr
[
MAX_MPDU
];

58 
ut8_t
 
	gRxBufr
[
MAX_MPDU
];

60 
ut32_t
 
	gSSTime
;

61 
ut32_t
 
	gTimeBegPiod
;

63 
	#TARGET_RESOLUTION
 1

	)

65 
ut16_t
 
	$Tim_S
(

68 
ut32_t
 
now
 = 
	`timeGTime
();

69 
ut32_t
 
d_time
 = 0;

71 i(
SSTime
 < 
now
) {

72 
d_time
 = 
now
 - 
SSTime
;

74 
d_time
 = (
UINT32_MAX
 - 
SSTime
+ 
now
 + 1;

76 i(
d_time
 > 0xFFFF) {

77 
d_time
 = 0xFFFF;

80  (
ut16_t

d_time
;

81 
	}
}

83 
	$Tim_S_Ret
(

86 
SSTime
 = 
	`timeGTime
();

87 
	}
}

89 
	$dlmp_
(

93 
	`dlmp_t_mac_addss
(
DEFAULT_MAC_ADDRESS
);

94 
	`dlmp_t_max_fo_ames
(
DEFAULT_MAX_INFO_FRAMES
);

95 
	`dlmp_t_max_ma
(
DEFAULT_MAX_MASTER
);

97 
	`timeEndPiod
(
TimeBegPiod
);

98 
	}
}

100 
	$dlmp_nup
(

104 i(
Reived_Fme_Fg
) {

105 
	`CloHd
(
Reived_Fme_Fg
);

107 i(
Reive_Pack_Fg
) {

108 
	`CloHd
(
Reive_Pack_Fg
);

110 
	}
}

113 
	$dlmp_nd_pdu
(

114 
BACNET_ADDRESS
 * 
de
,

115 
BACNET_NPDU_DATA
 * 
du_da
,

116 
ut8_t
 * 
pdu
,

117 
pdu_n
)

119 
bys_
 = 0;

120 
i
 = 0;

122 i(!
Tnsm_Pack
.
ady
) {

123 i(
du_da
->
da_exg_y
) {

124 
Tnsm_Pack
.
ame_ty
 =

125 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

127 
Tnsm_Pack
.
ame_ty
 =

128 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

130 
Tnsm_Pack
.
pdu_n
 =du_len;

131 
i
 = 0; i < 
pdu_n
; i++) {

132 
Tnsm_Pack
.
pdu
[
i
] =du[i];

134 
	`ba_addss_cy
(&
Tnsm_Pack
.
addss
, 
de
);

135 
bys_
 = 
pdu_n
 + 
MAX_HEADER
;

136 
Tnsm_Pack
.
ady
 = 
ue
;

139  
bys_
;

140 
	}
}

142 
ut16_t
 
	$dlmp_ive
(

143 
BACNET_ADDRESS
 * 
c
,

144 
ut8_t
 * 
pdu
,

145 
ut16_t
 
max_pdu
,

146 
timeout
)

148 
ut16_t
 
pdu_n
 = 0;

149 
DWORD
 
wa_us
 = 0;

151 (
max_pdu
;

154 
wa_us
 = 
	`WaFSgObje
(
Reive_Pack_Fg
, 
timeout
);

155 i(
wa_us
 =
WAIT_OBJECT_0
) {

156 i(
Reive_Pack
.
ady
) {

157 i(
Reive_Pack
.
pdu_n
) {

158 
MSTP_Packs
++;

159 i(
c
) {

160 
	`memmove
(
c
, &
Reive_Pack
.
addss
,

161 (
Reive_Pack
.
addss
));

163 i(
pdu
) {

164 
	`memmove
(
pdu
, &
Reive_Pack
.pdu,

165 (
Reive_Pack
.
pdu
));

167 
pdu_n
 = 
Reive_Pack
.pdu_len;

169 
Reive_Pack
.
ady
 = 
l
;

173  
pdu_n
;

174 
	}
}

176 
	$dlmp_ive_fsm_sk
(

177 *
pArg
)

179 
bo
 
ived_ame
;

181 (
pArg
;

182 (
	`SThadPriܙy
(
	`GCutThad
(),

183 
THREAD_PRIORITY_TIME_CRITICAL
);

184 
TRUE
) {

186 i((
MSTP_Pt
.
ReivedVidFme
 =
l
) &&

187 (
MSTP_Pt
.
ReivedInvidFme
 =
l
)) {

189 
	`RS485_Check_UART_Da
(&
MSTP_Pt
);

190 
	`MSTP_Reive_Fme_FSM
(&
MSTP_Pt
);

191 
ived_ame
 = 
MSTP_Pt
.
ReivedVidFme
 ||

192 
MSTP_Pt
.
ReivedInvidFme
;

193 i(
ived_ame
) {

194 
	`RSemhe
(
Reived_Fme_Fg
, 1, 
NULL
);

197 } 
MSTP_Pt
.
DaAvaab
);

200 
	}
}

202 
	$dlmp_ma_fsm_sk
(

203 *
pArg
)

205 
DWORD
 
dwMlicds
 = 0;

207 (
pArg
;

208 (
	`SThadPriܙy
(
	`GCutThad
(),

209 
THREAD_PRIORITY_TIME_CRITICAL
);

210 
TRUE
) {

211 
MSTP_Pt
.
ma_e
) {

212 
MSTP_MASTER_STATE_IDLE
:

213 
dwMlicds
 = 
Tno_tok
;

215 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

216 
dwMlicds
 = 
Ty_timeout
;

218 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

219 
dwMlicds
 = 
Tuge_timeout
;

222 
dwMlicds
 = 0;

225 i(
dwMlicds
)

226 
	`WaFSgObje
(
Reived_Fme_Fg
, 
dwMlicds
);

227 
	`MSTP_Ma_Node_FSM
(&
MSTP_Pt
);

229 
	}
}

231 
	$dlmp_fl_ba_addss
(

232 
BACNET_ADDRESS
 * 
c
,

233 
ut8_t
 
mp_addss
)

235 
i
 = 0;

237 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

239 
c
->
mac_n
 = 0;

240 
c
->
mac
[0] = 0;

242 
c
->
mac_n
 = 1;

243 
c
->
mac
[0] = 
mp_addss
;

246 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

247 
c
->
mac
[
i
] = 0;

249 
c
->
t
 = 0;

250 
c
->
n
 = 0;

251 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

252 
c
->
adr
[
i
] = 0;

254 
	}
}

257 
ut16_t
 
	$MSTP_Put_Reive
(

258 vީ
mp_pt_ru_t
 *
mp_pt
)

260 
ut16_t
 
pdu_n
 = 0;

261 
BOOL
 
rc
;

263 i(!
Reive_Pack
.
ady
) {

265 
pdu_n
 = 
mp_pt
->
DaLgth
;

266 i(
pdu_n
 > (
Reive_Pack
.
pdu
))

267 
pdu_n
 = (
Reive_Pack
.
pdu
);

268 
	`memmove
((*&
Reive_Pack
.
pdu
[0],

269 (*&
mp_pt
->
IutBufr
[0], 
pdu_n
);

270 
	`dlmp_fl_ba_addss
(&
Reive_Pack
.
addss
,

271 
mp_pt
->
SourAddss
);

272 
Reive_Pack
.
pdu_n
 = 
mp_pt
->
DaLgth
;

273 
Reive_Pack
.
ady
 = 
ue
;

274 
rc
 = 
	`RSemhe
(
Reive_Pack_Fg
, 1, 
NULL
);

277  
pdu_n
;

278 
	}
}

282 
ut16_t
 
	$MSTP_G_Sd
(

283 vީ
mp_pt_ru_t
 * 
mp_pt
,

284 
timeout
)

286 
ut16_t
 
pdu_n
 = 0;

287 
ut8_t
 
dei
 = 0;

289 (
timeout
;

290 i(!
Tnsm_Pack
.
ady
) {

295 i(
Tnsm_Pack
.
addss
.
mac_n
) {

296 
dei
 = 
Tnsm_Pack
.
addss
.
mac
[0];

298 
dei
 = 
MSTP_BROADCAST_ADDRESS
;

300 i((
MAX_HEADER
 + 
Tnsm_Pack
.
pdu_n
> 
MAX_MPDU
) {

304 
pdu_n
 = 
	`MSTP_Ce_Fme
(&
mp_pt
->
OuutBufr
[0],

305 
mp_pt
->
OuutBufrSize
, 
Tnsm_Pack
.
ame_ty
, 
dei
,

306 
mp_pt
->
This_Sti
, &
Tnsm_Pack
.
pdu
[0],

307 
Tnsm_Pack
.
pdu_n
);

308 
Tnsm_Pack
.
ady
 = 
l
;

310  
pdu_n
;

311 
	}
}

313 
bo
 
	$dlmp_com_da_exg_y
(

314 
ut8_t
 * 
que_pdu
,

315 
ut16_t
 
que_pdu_n
,

316 
ut8_t
 
c_addss
,

317 
ut8_t
 * 
y_pdu
,

318 
ut16_t
 
y_pdu_n
,

319 
BACNET_ADDRESS
 * 
de_addss
)

321 
ut16_t
 
offt
;

325 
	sDER_com_t
 {

326 
BACNET_NPDU_DATA
 
du_da
;

327 
BACNET_ADDRESS
 
addss
;

328 
ut8_t
 
pdu_ty
;

329 
ut8_t
 
voke_id
;

330 
ut8_t
 
rvi_choi
;

332 
DER_com_t
 
que
;

333 
DER_com_t
 
y
;

336 
que_pdu_n
 =equest_pdu_len;

337 
y_pdu_n
 =eply_pdu_len;

339 
que
.
addss
.
mac
[0] = 
c_addss
;

340 
que
.
addss
.
mac_n
 = 1;

341 
offt
 =

342 
	`du_decode
(&
que_pdu
[0], 
NULL
, &
que
.
addss
,

343 &
que
.
du_da
);

344 i(
que
.
du_da
.
twk_y_mesge
) {

345  
l
;

347 
que
.
pdu_ty
 = 
que_pdu
[
offt
] & 0xF0;

348 i(
que
.
pdu_ty
 !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
) {

349  
l
;

351 
que
.
voke_id
 = 
que_pdu
[
offt
 + 2];

353 i(
que_pdu
[
offt
] & 
BIT3
)

354 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 5];

356 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 3];

358 
	`ba_addss_cy
(&
y
.
addss
, 
de_addss
);

359 
offt
 =

360 
	`du_decode
(&
y_pdu
[0], &
y
.
addss
, 
NULL
, &y.
du_da
);

361 i(
y
.
du_da
.
twk_y_mesge
) {

362  
l
;

366 
y
.
pdu_ty
 = 
y_pdu
[
offt
] & 0xF0;

367 
y
.
pdu_ty
) {

368 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

369 
y
.
voke_id
 = 
y_pdu
[
offt
 + 2];

371 i(
y_pdu
[
offt
] & 
BIT3
)

372 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 5];

374 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 3];

376 
PDU_TYPE_SIMPLE_ACK
:

377 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

378 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

380 
PDU_TYPE_COMPLEX_ACK
:

381 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

383 i(
y_pdu
[
offt
] & 
BIT3
)

384 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 4];

386 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

388 
PDU_TYPE_ERROR
:

389 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

390 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

392 
PDU_TYPE_REJECT
:

393 
PDU_TYPE_ABORT
:

394 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

397  
l
;

400 i((
y
.
pdu_ty
 =
PDU_TYPE_REJECT
) ||

401 (
y
.
pdu_ty
 =
PDU_TYPE_ABORT
)) {

402 i(
que
.
voke_id
 !
y
.invoke_id) {

403  
l
;

406 i(
que
.
voke_id
 !
y
.invoke_id) {

407  
l
;

409 i(
que
.
rvi_choi
 !
y
.service_choice) {

410  
l
;

413 i(
que
.
du_da
.
oc_vsi
 !
y
.npdu_data.protocol_version) {

414  
l
;

419 i(
que
.
du_da
.
iܙy
 !
y
.npdu_data.priority) {

420  
l
;

423 i(!
	`ba_addss_me
(&
que
.
addss
, &
y
.address)) {

424  
l
;

427  
ue
;

428 
	}
}

431 
ut16_t
 
	$MSTP_G_Rly
(

432 vީ
mp_pt_ru_t
 * 
mp_pt
,

433 
timeout
)

435 
ut16_t
 
pdu_n
 = 0;

436 
ut8_t
 
dei
 = 0;

437 
bo
 
mched
 = 
l
;

439 (
timeout
;

440 i(!
Tnsm_Pack
.
ady
) {

444 i(
Tnsm_Pack
.
addss
.
mac_n
 == 1) {

445 
dei
 = 
Tnsm_Pack
.
addss
.
mac
[0];

449 i((
MAX_HEADER
 + 
Tnsm_Pack
.
pdu_n
> 
MAX_MPDU
) {

453 
mched
 =

454 
	`dlmp_com_da_exg_y
(&
mp_pt
->
IutBufr
[0],

455 
mp_pt
->
DaLgth
, mp_pt->
SourAddss
,

456 &
Tnsm_Pack
.
pdu
[0], Tnsm_Pack.
pdu_n
,

457 &
Tnsm_Pack
.
addss
);

458 i(!
mched
)

461 
pdu_n
 = 
	`MSTP_Ce_Fme
(&
mp_pt
->
OuutBufr
[0],

462 
mp_pt
->
OuutBufrSize
, 
Tnsm_Pack
.
ame_ty
, 
dei
,

463 
mp_pt
->
This_Sti
, &
Tnsm_Pack
.
pdu
[0],

464 
Tnsm_Pack
.
pdu_n
);

465 
Tnsm_Pack
.
ady
 = 
l
;

467  
pdu_n
;

468 
	}
}

470 
	$dlmp_t_mac_addss
(

471 
ut8_t
 
mac_addss
)

474 i(
mac_addss
 <= 127) {

475 
MSTP_Pt
.
This_Sti
 = 
mac_addss
;

481 i(
mac_addss
 > 
MSTP_Pt
.
Nmax_ma
)

482 
	`dlmp_t_max_ma
(
mac_addss
);

486 
	}
}

488 
ut8_t
 
	$dlmp_mac_addss
(

491  
MSTP_Pt
.
This_Sti
;

492 
	}
}

501 
	$dlmp_t_max_fo_ames
(

502 
ut8_t
 
max_fo_ames
)

504 i(
max_fo_ames
 >= 1) {

505 
MSTP_Pt
.
Nmax_fo_ames
 = 
max_fo_ames
;

514 
	}
}

516 
ut8_t
 
	$dlmp_max_fo_ames
(

519  
MSTP_Pt
.
Nmax_fo_ames
;

520 
	}
}

527 
	$dlmp_t_max_ma
(

528 
ut8_t
 
max_ma
)

530 i(
max_ma
 <= 127) {

531 i(
MSTP_Pt
.
This_Sti
 <
max_ma
) {

532 
MSTP_Pt
.
Nmax_ma
 = 
max_ma
;

542 
	}
}

544 
ut8_t
 
	$dlmp_max_ma
(

547  
MSTP_Pt
.
Nmax_ma
;

548 
	}
}

551 
	$dlmp_t_baud_
(

552 
ut32_t
 
baud
)

554 
	`RS485_S_Baud_Re
(
baud
);

555 
	}
}

557 
ut32_t
 
	$dlmp_baud_
(

560  
	`RS485_G_Baud_Re
();

561 
	}
}

563 
	$dlmp_g_my_addss
(

564 
BACNET_ADDRESS
 * 
my_addss
)

566 
i
 = 0;

568 
my_addss
->
mac_n
 = 1;

569 
my_addss
->
mac
[0] = 
MSTP_Pt
.
This_Sti
;

570 
my_addss
->
t
 = 0;

571 
my_addss
->
n
 = 0;

572 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

573 
my_addss
->
adr
[
i
] = 0;

577 
	}
}

579 
	$dlmp_g_brd_addss
(

580 
BACNET_ADDRESS
 * 
de
)

582 
i
 = 0;

584 i(
de
) {

585 
de
->
mac_n
 = 1;

586 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

587 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

588 
de
->
n
 = 0;

589 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

590 
de
->
adr
[
i
] = 0;

595 
	}
}

597 
bo
 
	$dlmp_
(

598 *
iame
)

600 
hThad
 = 0;

601 
ut32_t
 
g_vue
 = 0;

602 
TIMECAPS
 
tc
;

605 
Reive_Pack
.
ady
 = 
l
;

606 
Reive_Pack
.
pdu_n
 = 0;

607 
Reive_Pack_Fg
 = 
	`CeSemhe
(
NULL
, 0, 1, "dlmstpReceivePacket");

608 i(
Reive_Pack_Fg
 =
NULL
)

609 
	`ex
(1);

610 
Reived_Fme_Fg
 = 
	`CeSemhe
(
NULL
, 0, 1, "dlsmtpReceiveFrame");

611 i(
Reived_Fme_Fg
 =
NULL
) {

612 
	`CloHd
(
Reive_Pack_Fg
);

613 
	`ex
(1);

617 i(
iame
) {

618 
	`RS485_S_I
(
iame
);

619 #i
PRINT_ENABLED


620 
	`rtf
(
dr
, "MS/TP I: %s\n", 
iame
);

623 
	`RS485_Inlize
();

624 
MSTP_Pt
.
IutBufr
 = &
RxBufr
[0];

625 
MSTP_Pt
.
IutBufrSize
 = (
RxBufr
);

626 
MSTP_Pt
.
OuutBufr
 = &
TxBufr
[0];

627 
MSTP_Pt
.
OuutBufrSize
 = (
TxBufr
);

628 
MSTP_Pt
.
STim
 = 
Tim_S
;

629 
MSTP_Pt
.
STimRet
 = 
Tim_S_Ret
;

630 
	`MSTP_In
(&
MSTP_Pt
);

632 
ut8_t
 
da
;

635 
da
 = 64;

638 i(
da
 <= 127)

639 
MSTP_Pt
.
This_Sti
 = 
da
;

641 
	`dlmp_t_my_addss
(
DEFAULT_MAC_ADDRESS
);

643 
da
 = 127;

646 i((
da
 <127&& (d>
MSTP_Pt
.
This_Sti
))

647 
MSTP_Pt
.
Nmax_ma
 = 
da
;

649 
	`dlmp_t_max_ma
(
DEFAULT_MAX_MASTER
);

651 
da
 = 1;

655 i(
da
 >= 1)

656 
MSTP_Pt
.
Nmax_fo_ames
 = 
da
;

658 
	`dlmp_t_max_fo_ames
(
DEFAULT_MAX_INFO_FRAMES
);

660 #i
PRINT_ENABLED


661 
	`rtf
(
dr
, "MS/TP MAC: %02X\n", 
MSTP_Pt
.
This_Sti
);

662 
	`rtf
(
dr
, "MS/TP Max_Ma: %02X\n", 
MSTP_Pt
.
Nmax_ma
);

663 
	`rtf
(
dr
, "MS/TP Max_Info_Fmes: %u\n", 
MSTP_Pt
.
Nmax_fo_ames
);

666 i(
	`timeGDevCs
(&
tc
, (
TIMECAPS
)!
TIMERR_NOERROR
) {

667 
	`rtf
(
dr
, "Failedo setimeresolution\n");

669 
TimeBegPiod
 =

670 
	`m
(
	`max
(
tc
.
wPiodM
, 
TARGET_RESOLUTION
),c.
wPiodMax
);

671 
	`timeBegPiod
(
TimeBegPiod
);

674 
hThad
 = 
	`_begthad
(
dlmp_ive_fsm_sk
, 4096, &
g_vue
);

675 i(
hThad
 == 0) {

676 
	`rtf
(
dr
, "Failedo startecive FSMask\n");

678 
hThad
 = 
	`_begthad
(
dlmp_ma_fsm_sk
, 4096, &
g_vue
);

679 i(
hThad
 == 0) {

680 
	`rtf
(
dr
, "Failedo start Master Node FSMask\n");

683  
ue
;

684 
	}
}

686 #ifde
TEST_DLMSTP


687 
	~<dio.h
>

689 
	$du_hdr
(

690 
BACNET_ADDRESS
 * 
c
,

691 
ut8_t
 * 
du
,

692 
ut16_t
 
pdu_n
)

694 (
c
;

695 (
du
;

696 (
pdu_n
;

697 
	}
}

700 
ut32_t
 
	$timeamp_ms
(

703 
DWORD
 
ticks
 = 0, 
d_ticks
 = 0;

704 
DWORD
 
ϡ_ticks
 = 0;

706 
ticks
 = 
	`GTickCou
();

707 
d_ticks
 =

708 (
ticks
 >
ϡ_ticks
 ?ick-a_tick: 
MAXDWORD
 -ast_ticks);

709 
ϡ_ticks
 = 
ticks
;

711  
d_ticks
;

712 
	}
}

714 *
	gNwk_I
 = "COM3";

716 
	$ma
(

717 
gc
,

718 *
gv
[])

720 
ut16_t
 
pdu_n
 = 0;

723 i(
gc
 > 1) {

724 
Nwk_I
 = 
gv
[1];

726 
	`dlmp_t_baud_
(38400);

727 
	`dlmp_t_mac_addss
(0x05);

728 
	`dlmp_t_max_fo_ames
(
DEFAULT_MAX_INFO_FRAMES
);

729 
	`dlmp_t_max_ma
(
DEFAULT_MAX_MASTER
);

730 
	`dlmp_
(
Nwk_I
);

733 
pdu_n
 = 
	`dlmp_ive
(
NULL
, NULL, 0, 
INFINITE
);

735 
	`MSTP_Ce_And_Sd_Fme
(&
MSTP_Pt
, 
FRAME_TYPE_TEST_REQUEST
,

736 
MSTP_Pt
.
SourAddss
, MSTP_Pt.
This_Sti
, 
NULL
, 0);

741 
	}
}

	@ports/win32/dlmstp.c

26 
	~<dbo.h
>

27 
	~<dt.h
>

28 
	~<ddef.h
>

29 
	~<dlib.h
>

30 
	~<rg.h
>

31 
	~<dio.h
>

32 #ifde
__BORLANDC__


33 
	~<oss.h
>

35 
	~"bacdef.h
"

36 
	~"baddr.h
"

37 
	~"mp.h
"

38 
	~"dlmp.h
"

39 
	~"rs485.h
"

40 
	~"du.h
"

41 
	~"bs.h
"

42 
	~"rgbuf.h
"

43 
	~"tim.h
"

45 
	#WIN32_LEAN_AND_MEAN


	)

46 
	#STRICT
 1

	)

47 
	~<wdows.h
>

50 
ut16_t
 
	gMSTP_Packs
 = 0;

53 
DLMSTP_PACKET
 
	gReive_Pack
;

54 
HANDLE
 
	gReive_Pack_Fg
;

56 
HANDLE
 
	gReived_Fme_Fg
;

57 
DLMSTP_PACKET
 
	gTnsm_Pack
;

59 vީ
mp_pt_ru_t
 
	gMSTP_Pt
;

61 
ut8_t
 
	gTxBufr
[
MAX_MPDU
];

62 
ut8_t
 
	gRxBufr
[
MAX_MPDU
];

67 
ut16_t
 
	gTy_timeout
 = 260;

72 
ut8_t
 
	gTuge_timeout
 = 50;

75 
ut32_t
 
	$Tim_S
(

76 *
pArg
)

78  
	`tim_mlicds
(
TIMER_SILENCE
);

79 
	}
}

81 
	$Tim_S_Ret
(

82 *
pArg
)

84 
	`tim_t
(
TIMER_SILENCE
);

85 
	}
}

87 
	$dlmp_nup
(

91 i(
Reived_Fme_Fg
) {

92 
	`CloHd
(
Reived_Fme_Fg
);

94 i(
Reive_Pack_Fg
) {

95 
	`CloHd
(
Reive_Pack_Fg
);

97 
	}
}

100 
	$dlmp_nd_pdu
(

101 
BACNET_ADDRESS
 * 
de
,

102 
BACNET_NPDU_DATA
 * 
du_da
,

103 
ut8_t
 * 
pdu
,

104 
pdu_n
)

106 
bys_
 = 0;

107 
i
 = 0;

109 i(!
Tnsm_Pack
.
ady
) {

110 i(
du_da
->
da_exg_y
) {

111 
Tnsm_Pack
.
ame_ty
 =

112 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
;

114 
Tnsm_Pack
.
ame_ty
 =

115 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
;

117 
Tnsm_Pack
.
pdu_n
 = (
ut16_t
)du_len;

118 
i
 = 0; i < 
pdu_n
; i++) {

119 
Tnsm_Pack
.
pdu
[
i
] =du[i];

121 
	`ba_addss_cy
(&
Tnsm_Pack
.
addss
, 
de
);

122 
bys_
 = 
pdu_n
 + 
MAX_HEADER
;

123 
Tnsm_Pack
.
ady
 = 
ue
;

126  
bys_
;

127 
	}
}

129 
ut16_t
 
	$dlmp_ive
(

130 
BACNET_ADDRESS
 * 
c
,

131 
ut8_t
 * 
pdu
,

132 
ut16_t
 
max_pdu
,

133 
timeout
)

135 
ut16_t
 
pdu_n
 = 0;

136 
DWORD
 
wa_us
 = 0;

138 (
max_pdu
;

141 
wa_us
 = 
	`WaFSgObje
(
Reive_Pack_Fg
, 
timeout
);

142 i(
wa_us
 =
WAIT_OBJECT_0
) {

143 i(
Reive_Pack
.
ady
) {

144 i(
Reive_Pack
.
pdu_n
) {

145 
MSTP_Packs
++;

146 i(
c
) {

147 
	`memmove
(
c
, &
Reive_Pack
.
addss
,

148 (
Reive_Pack
.
addss
));

150 i(
pdu
) {

151 
	`memmove
(
pdu
, &
Reive_Pack
.pdu,

152 (
Reive_Pack
.
pdu
));

154 
pdu_n
 = 
Reive_Pack
.pdu_len;

156 
Reive_Pack
.
ady
 = 
l
;

160  
pdu_n
;

161 
	}
}

163 
	$dlmp_ive_fsm_sk
(

164 *
pArg
)

166 
bo
 
ived_ame
;

168 (
pArg
;

169 (
	`SThadPriܙy
(
	`GCutThad
(),

170 
THREAD_PRIORITY_TIME_CRITICAL
);

173 i((
MSTP_Pt
.
ReivedVidFme
 =
l
) &&

174 (
MSTP_Pt
.
ReivedInvidFme
 =
l
)) {

176 
	`RS485_Check_UART_Da
(&
MSTP_Pt
);

177 
	`MSTP_Reive_Fme_FSM
(&
MSTP_Pt
);

178 
ived_ame
 = 
MSTP_Pt
.
ReivedVidFme
 ||

179 
MSTP_Pt
.
ReivedInvidFme
;

180 i(
ived_ame
) {

181 
	`RSemhe
(
Reived_Fme_Fg
, 1, 
NULL
);

184 } 
MSTP_Pt
.
DaAvaab
);

187 
	}
}

189 
	$dlmp_ma_fsm_sk
(

190 *
pArg
)

192 
DWORD
 
dwMlicds
 = 0;

194 (
pArg
;

195 (
	`SThadPriܙy
(
	`GCutThad
(),

196 
THREAD_PRIORITY_TIME_CRITICAL
);

198 
MSTP_Pt
.
ma_e
) {

199 
MSTP_MASTER_STATE_IDLE
:

200 
dwMlicds
 = 
Tno_tok
;

202 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

203 
dwMlicds
 = 
Ty_timeout
;

205 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

206 
dwMlicds
 = 
Tuge_timeout
;

209 
dwMlicds
 = 0;

212 i(
dwMlicds
)

213 
	`WaFSgObje
(
Reived_Fme_Fg
, 
dwMlicds
);

214 
	`MSTP_Ma_Node_FSM
(&
MSTP_Pt
);

216 
	}
}

218 
	$dlmp_fl_ba_addss
(

219 
BACNET_ADDRESS
 * 
c
,

220 
ut8_t
 
mp_addss
)

222 
i
 = 0;

224 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

226 
c
->
mac_n
 = 0;

227 
c
->
mac
[0] = 0;

229 
c
->
mac_n
 = 1;

230 
c
->
mac
[0] = 
mp_addss
;

233 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

234 
c
->
mac
[
i
] = 0;

236 
c
->
t
 = 0;

237 
c
->
n
 = 0;

238 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

239 
c
->
adr
[
i
] = 0;

241 
	}
}

244 
ut16_t
 
	$MSTP_Put_Reive
(

245 vީ
mp_pt_ru_t
 *
mp_pt
)

247 
ut16_t
 
pdu_n
 = 0;

248 
BOOL
 
rc
;

250 i(!
Reive_Pack
.
ady
) {

252 
pdu_n
 = 
mp_pt
->
DaLgth
;

253 i(
pdu_n
 > (
Reive_Pack
.
pdu
))

254 
pdu_n
 = (
Reive_Pack
.
pdu
);

255 
	`memmove
((*&
Reive_Pack
.
pdu
[0],

256 (*&
mp_pt
->
IutBufr
[0], 
pdu_n
);

257 
	`dlmp_fl_ba_addss
(&
Reive_Pack
.
addss
,

258 
mp_pt
->
SourAddss
);

259 
Reive_Pack
.
pdu_n
 = 
mp_pt
->
DaLgth
;

260 
Reive_Pack
.
ady
 = 
ue
;

261 
rc
 = 
	`RSemhe
(
Reive_Pack_Fg
, 1, 
NULL
);

262 (
rc
;

265  
pdu_n
;

266 
	}
}

270 
ut16_t
 
	$MSTP_G_Sd
(

271 vީ
mp_pt_ru_t
 * 
mp_pt
,

272 
timeout
)

274 
ut16_t
 
pdu_n
 = 0;

275 
ut8_t
 
dei
 = 0;

277 (
timeout
;

278 i(!
Tnsm_Pack
.
ady
) {

282 i(
Tnsm_Pack
.
addss
.
mac_n
) {

283 
dei
 = 
Tnsm_Pack
.
addss
.
mac
[0];

285 
dei
 = 
MSTP_BROADCAST_ADDRESS
;

287 i((
MAX_HEADER
 + 
Tnsm_Pack
.
pdu_n
> 
MAX_MPDU
) {

291 
pdu_n
 = 
	`MSTP_Ce_Fme
(&
mp_pt
->
OuutBufr
[0],

292 
mp_pt
->
OuutBufrSize
, 
Tnsm_Pack
.
ame_ty
, 
dei
,

293 
mp_pt
->
This_Sti
, &
Tnsm_Pack
.
pdu
[0],

294 
Tnsm_Pack
.
pdu_n
);

295 
Tnsm_Pack
.
ady
 = 
l
;

297  
pdu_n
;

298 
	}
}

300 
bo
 
	$dlmp_com_da_exg_y
(

301 
ut8_t
 * 
que_pdu
,

302 
ut16_t
 
que_pdu_n
,

303 
ut8_t
 
c_addss
,

304 
ut8_t
 * 
y_pdu
,

305 
ut16_t
 
y_pdu_n
,

306 
BACNET_ADDRESS
 * 
de_addss
)

308 
ut16_t
 
offt
;

312 
	sDER_com_t
 {

313 
BACNET_NPDU_DATA
 
du_da
;

314 
BACNET_ADDRESS
 
addss
;

315 
ut8_t
 
pdu_ty
;

316 
ut8_t
 
voke_id
;

317 
ut8_t
 
rvi_choi
;

319 
DER_com_t
 
que
;

320 
DER_com_t
 
y
;

323 
que_pdu_n
 =equest_pdu_len;

324 
y_pdu_n
 =eply_pdu_len;

326 
que
.
addss
.
mac
[0] = 
c_addss
;

327 
que
.
addss
.
mac_n
 = 1;

328 
offt
 =

329 (
ut16_t

	`du_decode
(&
que_pdu
[0], 
NULL
, &
que
.
addss
,

330 &
que
.
du_da
);

331 i(
que
.
du_da
.
twk_y_mesge
) {

332  
l
;

334 
que
.
pdu_ty
 = 
que_pdu
[
offt
] & 0xF0;

335 i(
que
.
pdu_ty
 !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
) {

336  
l
;

338 
que
.
voke_id
 = 
que_pdu
[
offt
 + 2];

340 i(
que_pdu
[
offt
] & 
BIT3
)

341 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 5];

343 
que
.
rvi_choi
 = 
que_pdu
[
offt
 + 3];

345 
	`ba_addss_cy
(&
y
.
addss
, 
de_addss
);

346 
offt
 =

347 (
ut16_t

	`du_decode
(&
y_pdu
[0], &
y
.
addss
, 
NULL
,

348 &
y
.
du_da
);

349 i(
y
.
du_da
.
twk_y_mesge
) {

350  
l
;

354 
y
.
pdu_ty
 = 
y_pdu
[
offt
] & 0xF0;

355 
y
.
pdu_ty
) {

356 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

357 
y
.
voke_id
 = 
y_pdu
[
offt
 + 2];

359 i(
y_pdu
[
offt
] & 
BIT3
)

360 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 5];

362 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 3];

364 
PDU_TYPE_SIMPLE_ACK
:

365 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

366 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

368 
PDU_TYPE_COMPLEX_ACK
:

369 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

371 i(
y_pdu
[
offt
] & 
BIT3
)

372 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 4];

374 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

376 
PDU_TYPE_ERROR
:

377 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

378 
y
.
rvi_choi
 = 
y_pdu
[
offt
 + 2];

380 
PDU_TYPE_REJECT
:

381 
PDU_TYPE_ABORT
:

382 
y
.
voke_id
 = 
y_pdu
[
offt
 + 1];

385  
l
;

388 i((
y
.
pdu_ty
 =
PDU_TYPE_REJECT
) ||

389 (
y
.
pdu_ty
 =
PDU_TYPE_ABORT
)) {

390 i(
que
.
voke_id
 !
y
.invoke_id) {

391  
l
;

394 i(
que
.
voke_id
 !
y
.invoke_id) {

395  
l
;

397 i(
que
.
rvi_choi
 !
y
.service_choice) {

398  
l
;

401 i(
que
.
du_da
.
oc_vsi
 !
y
.npdu_data.protocol_version) {

402  
l
;

407 i(
que
.
du_da
.
iܙy
 !
y
.npdu_data.priority) {

408  
l
;

411 i(!
	`ba_addss_me
(&
que
.
addss
, &
y
.address)) {

412  
l
;

415  
ue
;

416 
	}
}

419 
ut16_t
 
	$MSTP_G_Rly
(

420 vީ
mp_pt_ru_t
 * 
mp_pt
,

421 
timeout
)

423 
ut16_t
 
pdu_n
 = 0;

424 
ut8_t
 
dei
 = 0;

425 
bo
 
mched
 = 
l
;

427 (
timeout
;

428 i(!
Tnsm_Pack
.
ady
) {

432 i(
Tnsm_Pack
.
addss
.
mac_n
 == 1) {

433 
dei
 = 
Tnsm_Pack
.
addss
.
mac
[0];

437 i((
MAX_HEADER
 + 
Tnsm_Pack
.
pdu_n
> 
MAX_MPDU
) {

441 
mched
 =

442 
	`dlmp_com_da_exg_y
(&
mp_pt
->
IutBufr
[0],

443 
mp_pt
->
DaLgth
, mp_pt->
SourAddss
,

444 &
Tnsm_Pack
.
pdu
[0], Tnsm_Pack.
pdu_n
,

445 &
Tnsm_Pack
.
addss
);

446 i(!
mched
)

449 
pdu_n
 = 
	`MSTP_Ce_Fme
(&
mp_pt
->
OuutBufr
[0],

450 
mp_pt
->
OuutBufrSize
, 
Tnsm_Pack
.
ame_ty
, 
dei
,

451 
mp_pt
->
This_Sti
, &
Tnsm_Pack
.
pdu
[0],

452 
Tnsm_Pack
.
pdu_n
);

453 
Tnsm_Pack
.
ady
 = 
l
;

455  
pdu_n
;

456 
	}
}

458 
	$dlmp_t_mac_addss
(

459 
ut8_t
 
mac_addss
)

462 i(
mac_addss
 <= 127) {

463 
MSTP_Pt
.
This_Sti
 = 
mac_addss
;

469 i(
mac_addss
 > 
MSTP_Pt
.
Nmax_ma
)

470 
	`dlmp_t_max_ma
(
mac_addss
);

474 
	}
}

476 
ut8_t
 
	$dlmp_mac_addss
(

479  
MSTP_Pt
.
This_Sti
;

480 
	}
}

489 
	$dlmp_t_max_fo_ames
(

490 
ut8_t
 
max_fo_ames
)

492 i(
max_fo_ames
 >= 1) {

493 
MSTP_Pt
.
Nmax_fo_ames
 = 
max_fo_ames
;

502 
	}
}

504 
ut8_t
 
	$dlmp_max_fo_ames
(

507  
MSTP_Pt
.
Nmax_fo_ames
;

508 
	}
}

515 
	$dlmp_t_max_ma
(

516 
ut8_t
 
max_ma
)

518 i(
max_ma
 <= 127) {

519 i(
MSTP_Pt
.
This_Sti
 <
max_ma
) {

520 
MSTP_Pt
.
Nmax_ma
 = 
max_ma
;

530 
	}
}

532 
ut8_t
 
	$dlmp_max_ma
(

535  
MSTP_Pt
.
Nmax_ma
;

536 
	}
}

539 
	$dlmp_t_baud_
(

540 
ut32_t
 
baud
)

542 
	`RS485_S_Baud_Re
(
baud
);

543 
	}
}

545 
ut32_t
 
	$dlmp_baud_
(

548  
	`RS485_G_Baud_Re
();

549 
	}
}

551 
	$dlmp_g_my_addss
(

552 
BACNET_ADDRESS
 * 
my_addss
)

554 
i
 = 0;

556 
my_addss
->
mac_n
 = 1;

557 
my_addss
->
mac
[0] = 
MSTP_Pt
.
This_Sti
;

558 
my_addss
->
t
 = 0;

559 
my_addss
->
n
 = 0;

560 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

561 
my_addss
->
adr
[
i
] = 0;

565 
	}
}

567 
	$dlmp_g_brd_addss
(

568 
BACNET_ADDRESS
 * 
de
)

570 
i
 = 0;

572 i(
de
) {

573 
de
->
mac_n
 = 1;

574 
de
->
mac
[0] = 
MSTP_BROADCAST_ADDRESS
;

575 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

576 
de
->
n
 = 0;

577 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

578 
de
->
adr
[
i
] = 0;

583 
	}
}

585 
bo
 
	$dlmp_
(

586 *
iame
)

588 
hThad
 = 0;

589 
ut32_t
 
g_vue
 = 0;

592 
Reive_Pack
.
ady
 = 
l
;

593 
Reive_Pack
.
pdu_n
 = 0;

594 
Reive_Pack_Fg
 = 
	`CeSemhe
(
NULL
, 0, 1, "dlmstpReceivePacket");

595 i(
Reive_Pack_Fg
 =
NULL
)

596 
	`ex
(1);

597 
Reived_Fme_Fg
 = 
	`CeSemhe
(
NULL
, 0, 1, "dlsmtpReceiveFrame");

598 i(
Reived_Fme_Fg
 =
NULL
) {

599 
	`CloHd
(
Reive_Pack_Fg
);

600 
	`ex
(1);

603 
	`tim_
();

604 i(
iame
) {

605 
	`RS485_S_I
(
iame
);

607 
	`RS485_Inlize
();

608 
MSTP_Pt
.
IutBufr
 = &
RxBufr
[0];

609 
MSTP_Pt
.
IutBufrSize
 = (
RxBufr
);

610 
MSTP_Pt
.
OuutBufr
 = &
TxBufr
[0];

611 
MSTP_Pt
.
OuutBufrSize
 = (
TxBufr
);

612 
MSTP_Pt
.
STim
 = 
Tim_S
;

613 
MSTP_Pt
.
STimRet
 = 
Tim_S_Ret
;

614 
	`MSTP_In
(&
MSTP_Pt
);

616 
ut8_t
 
da
;

619 
da
 = 64;

622 i(
da
 <= 127)

623 
MSTP_Pt
.
This_Sti
 = 
da
;

625 
	`dlmp_t_my_addss
(
DEFAULT_MAC_ADDRESS
);

627 
da
 = 127;

630 i((
da
 <127&& (d>
MSTP_Pt
.
This_Sti
))

631 
MSTP_Pt
.
Nmax_ma
 = 
da
;

633 
	`dlmp_t_max_ma
(
DEFAULT_MAX_MASTER
);

635 
da
 = 1;

639 i(
da
 >= 1)

640 
MSTP_Pt
.
Nmax_fo_ames
 = 
da
;

642 
	`dlmp_t_max_fo_ames
(
DEFAULT_MAX_INFO_FRAMES
);

644 #i
PRINT_ENABLED


645 
	`rtf
(
dr
, "MS/TP MAC: %02X\n", 
MSTP_Pt
.
This_Sti
);

646 
	`rtf
(
dr
, "MS/TP Max_Ma: %02X\n", 
MSTP_Pt
.
Nmax_ma
);

647 
	`rtf
(
dr
, "MS/TP Max_Info_Frames: %u\n",

648 (
MSTP_Pt
.
Nmax_fo_ames
);

650 
hThad
 = 
	`_begthad
(
dlmp_ive_fsm_sk
, 4096, &
g_vue
);

651 i(
hThad
 == 0) {

652 
	`rtf
(
dr
, "Failedo startecive FSMask\n");

654 
hThad
 = 
	`_begthad
(
dlmp_ma_fsm_sk
, 4096, &
g_vue
);

655 i(
hThad
 == 0) {

656 
	`rtf
(
dr
, "Failedo start Master Node FSMask\n");

659  
ue
;

660 
	}
}

662 #ifde
TEST_DLMSTP


663 
	~<dio.h
>

665 
	$du_hdr
(

666 
BACNET_ADDRESS
 * 
c
,

667 
ut8_t
 * 
du
,

668 
ut16_t
 
pdu_n
)

670 (
c
;

671 (
du
;

672 (
pdu_n
;

673 
	}
}

676 
ut32_t
 
	$timeamp_ms
(

679 
DWORD
 
ticks
 = 0, 
d_ticks
 = 0;

680 
DWORD
 
ϡ_ticks
 = 0;

682 
ticks
 = 
	`GTickCou
();

683 
d_ticks
 =

684 (
ticks
 >
ϡ_ticks
 ?ick-a_tick: 
MAXDWORD
 -ast_ticks);

685 
ϡ_ticks
 = 
ticks
;

687  
d_ticks
;

688 
	}
}

690 *
	gNwk_I
 = 
NULL
;

692 
	$ma
(

693 
gc
,

694 *
gv
[])

696 
ut16_t
 
pdu_n
 = 0;

699 i(
gc
 > 1) {

700 
Nwk_I
 = 
gv
[1];

702 
	`dlmp_t_baud_
(38400);

703 
	`dlmp_t_mac_addss
(0x05);

704 
	`dlmp_t_max_fo_ames
(
DEFAULT_MAX_INFO_FRAMES
);

705 
	`dlmp_t_max_ma
(
DEFAULT_MAX_MASTER
);

706 
	`dlmp_
(
Nwk_I
);

709 
pdu_n
 = 
	`dlmp_ive
(
NULL
, NULL, 0, 
INFINITE
);

711 
	`MSTP_Ce_And_Sd_Fme
(&
MSTP_Pt
, 
FRAME_TYPE_TEST_REQUEST
,

712 
MSTP_Pt
.
SourAddss
, MSTP_Pt.
This_Sti
, 
NULL
, 0);

717 
	}
}

	@ports/win32/ethernet.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~<as.h
>

38 
	~<de.h
>

39 
	~<io.h
>

41 
	~"bacdef.h
"

42 
	~"ht.h
"

43 
	~"bacdcode.h
"

57 
	~"pp.h
"

58 
	~"ck32.h
"

59 
	~"ddndis.h
"

60 
	~"me-ext.h
"

64 
ut8_t
 
	gEtht_Brd
[
MAX_MAC_LEN
] =

67 
ut8_t
 
	gEtht_Emy_MAC
[
MAX_MAC_LEN
] = { 0, 0, 0, 0, 0, 0 };

70 
ut8_t
 
	gEtht_MAC_Addss
[
MAX_MAC_LEN
] = { 0 };

73 
	gpp_rbuf
[
PCAP_ERRBUF_SIZE
 + 1];

74 
pp_t
 *
	gpp_h802_
 = 
NULL
;

75 
	gh_timeout
 = 100;

81 
LogInfo
(

82 cڡ *
msg
);

84 
LogE
(

85 cڡ *
msg
);

87 
LogDebug
(

88 cڡ *
msg
);

91 
bo
 
	$ht_vid
(

94  (
pp_h802_
 !
NULL
);

95 
	}
}

97 
	$ht_nup
(

100 i(
pp_h802_
) {

101 
	`pp_o
(
pp_h802_
);

102 
pp_h802_
 = 
NULL
;

104 
	`LogInfo
("ethernet.c:thernet_cleanup() ok.\n");

105 
	}
}

107 
	$ht_t_timeout
(

108 
timeout
)

110 
h_timeout
 = 
timeout
;

111 
	}
}

138 
bo
 
	$ht_
(

139 *
if_me
)

141 
PPACKET_OID_DATA
 
pOidDa
;

142 
LPADAPTER
 
Adr
;

143 
pp_if_t
 *
pp_l_if
;

144 
pp_if_t
 *
dev
;

145 
BOOLEAN
 
su
;

146 
CHAR
 
r
[(
PACKET_OID_DATA
) + 128];

147 
i
;

148 
msgBuf
[200];

150 i(
	`ht_vid
())

151 
	`ht_nup
();

157 i(
	`pp_fdldevs
(&
pp_l_if
, 
pp_rbuf
) == -1) {

158 
	`rtf
(
msgBuf
, "ethernet.c:rror incap_findalldevs: %s\n",

159 
pp_rbuf
);

160 
	`LogE
(
msgBuf
);

161  
l
;

164 
dev
 = 
pp_l_if
; dev; dev = dev->
xt
) {

165 i(
	`rcmp
(
if_me
, 
dev
->
me
) == 0)

168 
	`pp_䓮ldevs
(
pp_l_if
);

169 i(
dev
 =
NULL
) {

170 
	`rtf
(
msgBuf
, "ethernet.c: specified interfaceot found: %s\n",

171 
if_me
);

172 
	`LogE
(
msgBuf
);

173  
l
;

179 
	`ZoMemy
(
r
, (
PACKET_OID_DATA
) + 128);

180 
Adr
 = 
	`PackOnAdr
(
if_me
);

181 i(
Adr
 =
NULL
) {

182 
	`ht_nup
();

183 
	`rtf
(
msgBuf
, "ethernet.c:rror in PacketOpenAdapter(\"%s\")\n",

184 
if_me
);

185 
	`LogE
(
msgBuf
);

186  
l
;

188 
pOidDa
 = (
PPACKET_OID_DATA

r
;

189 
pOidDa
->
Oid
 = 
OID_802_3_CURRENT_ADDRESS
;

190 
pOidDa
->
Lgth
 = 6;

191 
su
 = 
	`PackReque
(
Adr
, 
FALSE
, 
pOidDa
);

192 i(!
su
) {

193 
	`PackCloAdr
(
Adr
);

194 
	`ht_nup
();

195 
	`LogE
("ethernet.c:rror in PacketRequest()\n");

196  
l
;

198 
i
 = 0; i < 6; ++i)

199 
Etht_MAC_Addss
[
i
] = 
pOidDa
->
Da
[i];

200 
	`PackCloAdr
(
Adr
);

206 
pp_h802_
 = 
	`pp_ݒ
(
if_me
,

207 
MAX_MPDU
,

208 
PCAP_OPENFLAG_PROMISCUOUS
,

209 
h_timeout
,

210 
NULL
,

211 
pp_rbuf


213 i(
pp_h802_
 =
NULL
) {

214 
	`PackCloAdr
(
Adr
);

215 
	`ht_nup
();

216 
	`rtf
(
msgBuf
,

218 
if_me
);

219 
	`LogE
(
msgBuf
);

220  
l
;

223 
	`LogInfo
("ethernet.c:thernet_init() ok.\n");

225 
	`ex
(
ht_nup
);

227  
	`ht_vid
();

228 
	}
}

232 
	$ht_nd
(

233 
BACNET_ADDRESS
 * 
de
,

234 
BACNET_ADDRESS
 * 
c
,

235 
ut8_t
 * 
pdu
,

236 
pdu_n


239 
bys
 = 0;

240 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

241 
mtu_n
 = 0;

242 
i
 = 0;

245 i(!
	`ht_vid
()) {

246 
	`LogE
("ethernet.c: invalid 802.2thernet interface descriptor!\n");

250 i(
de
->
mac_n
 == 6) {

251 
i
 = 0; i < 6; i++) {

252 
mtu
[
mtu_n
] = 
de
->
mac
[
i
];

253 
mtu_n
++;

256 
	`LogE
("ethernet.c: invalid destination MACddress!\n");

261 i(
c
->
mac_n
 == 6) {

262 
i
 = 0; i < 6; i++) {

263 
mtu
[
mtu_n
] = 
c
->
mac
[
i
];

264 
mtu_n
++;

267 
	`LogE
("ethernet.c: invalid source MACddress!\n");

270 i((14 + 3 + 
pdu_n
> 
MAX_MPDU
) {

271 
	`LogE
("ethernet.c: PDU isoo bigo send!\n");

275 
mtu_n
 +
	`code_unsigd16
(&
mtu
[12], 3 + 
pdu_n
);

277 
mtu
[
mtu_n
++] = 0x82;

278 
mtu
[
mtu_n
++] = 0x82;

279 
mtu
[
mtu_n
++] = 0x03;

280 
	`memy
(&
mtu
[
mtu_n
], 
pdu
, 
pdu_n
);

281 
mtu_n
 +
pdu_n
;

284 i(
	`pp_ndck
(
pp_h802_
, 
mtu
, 
mtu_n
) != 0) {

286 
msgBuf
[200];

287 
	`rtf
(
msgBuf
, "ethernet.c:rror sendingacket: %s\n",

288 
	`pp_gr
(
pp_h802_
));

289 
	`LogE
(
msgBuf
);

293  
mtu_n
;

294 
	}
}

298 
	$ht_nd_pdu
(

299 
BACNET_ADDRESS
 * 
de
,

300 
ut8_t
 * 
pdu
,

301 
pdu_n


304 
i
 = 0;

305 
BACNET_ADDRESS
 
c
 = { 0 };

307 
i
 = 0; i < 6; i++) {

308 
c
.
mac
[
i
] = 
Etht_MAC_Addss
[i];

309 
c
.
mac_n
++;

313  
	`ht_nd
(
de
,

314 &
c
,

315 
pdu
,

316 
pdu_n


318 
	}
}

322 
ut16_t
 
	$ht_ive
(

323 
BACNET_ADDRESS
 * 
c
,

324 
ut8_t
 * 
pdu
,

325 
ut16_t
 
max_pdu
,

326 
timeout


329 
pp_pkthdr
 *
hd
;

330 
s
;

331 
u_ch
 *
pkt_da
;

332 
ut16_t
 
pdu_n
 = 0;

335 i(!
	`ht_vid
()) {

336 
	`LogE
("ethernet.c: invalid 802.2thernet interface descriptor!\n");

341 
s
 = 
	`pp_xt_ex
(
pp_h802_
, &
hd
, &
pkt_da
);

342 i(
s
 < 0) {

343 
msgBuf
[200];

344 
	`rtf
(
msgBuf
, "ethernet.c:rror ineceivingacket: %s\n",

345 
	`pp_gr
(
pp_h802_
));

347 } i(
s
 == 0)

350 i(
hd
->
n
 =0 || hd->

 == 0)

354 i((
pkt_da
[14] != 0x82) && (pkt_data[15] != 0x82)) {

359 
c
->
mac_n
 = 6;

360 
	`memmove
(
c
->
mac
, &
pkt_da
[6], 6);

364 i((
	`memcmp
(&
pkt_da
[0], 
Etht_MAC_Addss
, 6) != 0)

365 && (
	`memcmp
(&
pkt_da
[0], 
Etht_Brd
, 6) != 0)) {

370 (
	`decode_unsigd16
(&
pkt_da
[12], &
pdu_n
);

371 
pdu_n
 -= 3 ;

373 i(
pdu_n
 < 
max_pdu
)

374 
	`memmove
(&
pdu
[0], &
pkt_da
[17], 
pdu_n
);

377 
pdu_n
 = 0;

379  
pdu_n
;

380 
	}
}

382 
	$ht_t_my_addss
(

383 
BACNET_ADDRESS
 * 
my_addss
)

385 
i
 = 0;

387 
i
 = 0; i < 6; i++) {

388 
Etht_MAC_Addss
[
i
] = 
my_addss
->
mac
[i];

392 
	}
}

394 
	$ht_g_my_addss
(

395 
BACNET_ADDRESS
 * 
my_addss
)

397 
i
 = 0;

399 
my_addss
->
mac_n
 = 0;

400 
i
 = 0; i < 6; i++) {

401 
my_addss
->
mac
[
i
] = 
Etht_MAC_Addss
[i];

402 
my_addss
->
mac_n
++;

404 
my_addss
->
t
 = 0;

405 
my_addss
->
n
 = 0;

406 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

407 
my_addss
->
adr
[
i
] = 0;

411 
	}
}

413 
	$ht_g_brd_addss
(

414 
BACNET_ADDRESS
 * 
de
)

416 
i
 = 0;

418 i(
de
) {

419 
i
 = 0; i < 6; i++) {

420 
de
->
mac
[
i
] = 
Etht_Brd
[i];

422 
de
->
mac_n
 = 6;

423 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

424 
de
->
n
 = 0;

425 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

426 
de
->
adr
[
i
] = 0;

431 
	}
}

433 
	$ht_debug_addss
(

434 cڡ *
fo
,

435 
BACNET_ADDRESS
 * 
de
)

437 
i
 = 0;

438 
msgBuf
[200];

440 i(
fo
) {

441 
	`rtf
(
msgBuf
, "%s", 
fo
);

442 
	`LogE
(
msgBuf
);

445 i(
de
) {

446 
	`rtf
(
msgBuf
, "Address:\n MAC Length=%d\n MAC Address=",

447 
de
->
mac_n
);

448 
	`LogInfo
(
msgBuf
);

449 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

450 
	`rtf
(
msgBuf
, "%02X ", (
de
->
mac
[
i
]);

451 
	`LogInfo
(
msgBuf
);

453 
	`LogInfo
("\n");

454 
	`rtf
(
msgBuf
, " N=%hu\ L=%d\ Adr=", 
de
->
t
, de->
n
);

455 
	`LogInfo
(
msgBuf
);

456 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

457 
	`rtf
(
msgBuf
, "%02X ", (
de
->
adr
[
i
]);

458 
	`LogInfo
(
msgBuf
);

460 
	`LogInfo
("\n");

464 
	}
}

	@ports/win32/main.c

28 
	~<wsock2.h
>

29 
	~<ddef.h
>

30 
	~<dt.h
>

31 
	~<dio.h
>

32 
	~<cio.h
>

33 
	~"m.h
"

34 
	~"addss.h
"

35 
	~"cfig.h
"

36 
	~"bacdef.h
"

37 
	~"du.h
"

38 
	~"du.h
"

39 
	~"devi.h
"

40 
	~"hdrs.h
"

41 
	~".h
"

42 
	~"dk.h
"

43 
	~"txbuf.h
"

44 
	~"dnv.h
"

46 
	~"devi.h
"

47 
	~"ai.h
"

48 
	~"ao.h
"

49 
	~"av.h
"

50 
	~"bi.h
"

51 
	~"bo.h
"

52 
	~"bv.h
"

53 
	~"lc.h
"

54 
	~"l.h
"

55 
	~"mso.h
"

56 
	~"ms-put.h
"

57 
	~"dlog.h
"

58 #i
defed
(
BACFILE
)

59 
	~"bacfe.h
"

63 
ut8_t
 
	gRx_Buf
[
MAX_MPDU
] = { 0 };

66 
bo
 
	gWho_Is_Reque
 = 
ue
;

67 
bo
 
	gI_Am_Reque
 = 
ue
;

69 
	$Rd_Prݔts
(

72 
ut32_t
 
devi_id
 = 0;

73 
bo
 
us
 = 
l
;

74 
max_du
 = 0;

75 
BACNET_ADDRESS
 
c
;

76 
bo
 
xt_devi
 = 
l
;

77 
dex
 = 0;

78 
ݔty
 = 0;

83 cڡ 
obje_s
[] = {

84 
PROP_OBJECT_IDENTIFIER
,

85 
PROP_OBJECT_NAME
,

86 
PROP_OBJECT_TYPE
,

87 
PROP_SYSTEM_STATUS
,

88 
PROP_VENDOR_NAME
,

89 
PROP_VENDOR_IDENTIFIER
,

90 
PROP_MODEL_NAME
,

91 
PROP_FIRMWARE_REVISION
,

92 
PROP_APPLICATION_SOFTWARE_VERSION
,

93 
PROP_PROTOCOL_VERSION
,

94 
PROP_PROTOCOL_SERVICES_SUPPORTED
,

95 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

96 
PROP_MAX_APDU_LENGTH_ACCEPTED
,

97 
PROP_SEGMENTATION_SUPPORTED
,

98 
PROP_LOCAL_TIME
,

99 
PROP_LOCAL_DATE
,

100 
PROP_UTC_OFFSET
,

101 
PROP_DAYLIGHT_SAVINGS_STATUS
,

102 
PROP_APDU_SEGMENT_TIMEOUT
,

103 
PROP_APDU_TIMEOUT
,

104 
PROP_NUMBER_OF_APDU_RETRIES
,

105 
PROP_TIME_SYNCHRONIZATION_RECIPIENTS
,

106 
PROP_MAX_MASTER
,

107 
PROP_MAX_INFO_FRAMES
,

108 
PROP_DEVICE_ADDRESS_BINDING
,

118 i(
	`addss_cou
()) {

119 i(
	`addss_g_by_dex
(
dex
, &
devi_id
, &
max_du
, &
c
)) {

120 i(
obje_s
[
ݔty
] < 0)

121 
xt_devi
 = 
ue
;

123 
us
 = 
	`Sd_Rd_Prݔty_Reque
(
devi_id
,

124 
OBJECT_DEVICE
, 
devi_id
, 
obje_s
[
ݔty
],

125 
BACNET_ARRAY_ALL
);

126 i(
us
)

127 
ݔty
++;

130 
xt_devi
 = 
ue
;

131 i(
xt_devi
) {

132 
xt_devi
 = 
l
;

133 
dex
++;

134 i(
dex
 >
MAX_ADDRESS_CACHE
)

135 
dex
 = 0;

136 
ݔty
 = 0;

141 
	}
}

143 
	$LolIAmHdr
(

144 
ut8_t
 * 
rvi_que
,

145 
ut16_t
 
rvi_n
,

146 
BACNET_ADDRESS
 * 
c
)

148 
n
 = 0;

149 
ut32_t
 
devi_id
 = 0;

150 
max_du
 = 0;

151 
gmti
 = 0;

152 
ut16_t
 
vd_id
 = 0;

154 (
c
;

155 (
rvi_n
;

156 
n
 =

157 
	`m_decode_rvi_que
(
rvi_que
, &
devi_id
, &
max_du
,

158 &
gmti
, &
vd_id
);

159 
	`rtf
(
dr
, "Received I-Am Request");

160 i(
n
 != -1) {

161 
	`rtf
(
dr
, " from %u!\n", 
devi_id
);

162 
	`addss_add
(
devi_id
, 
max_du
, 
c
);

164 
	`rtf
(
dr
, "!\n");

167 
	}
}

169 
	$In_Svi_Hdrs
(

172 
	`Devi_In
(
NULL
);

175 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_WHO_IS
, 
hdr_who_is
);

176 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_I_AM
, 
LolIAmHdr
);

180 
du_t_uecognized_rvi_hdr_hdr


181 (
hdr_uecognized_rvi
);

183 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

184 
hdr_ad_ݔty
);

185 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
,

186 
hdr_ad_ݔty_muɝ
);

188 
	`du_t_cfmed_ack_hdr
(
SERVICE_CONFIRMED_READ_PROPERTY
,

189 
hdr_ad_ݔty_ack
);

190 #i
	`defed
(
BACFILE
)

191 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_ATOMIC_READ_FILE
,

192 
hdr_omic_ad_fe
);

194 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_SUBSCRIBE_COV
,

195 
hdr_cov_subsibe
);

199 #i
	`defed
(
BACFILE
)

200 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
,

201 
hdr_omic_wre_fe
);

203 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_READ_RANGE
,

204 
hdr_ad_nge
);

205 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
,

206 
hdr_lize_devi
);

207 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_UTC_TIME_SYNCHRONIZATION
,

208 
hdr_timesync_utc
);

209 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_TIME_SYNCHRONIZATION
,

210 
hdr_timesync
);

211 
	`du_t_uncfmed_hdr
(
SERVICE_UNCONFIRMED_COV_NOTIFICATION
,

212 
hdr_ucov_nifiti
);

214 
	`du_t_cfmed_hdr
(
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

215 
hdr_devi_communiti_cڌ
);

217 
	}
}

219 
	$t_addss
(

220 *
me
,

221 
BACNET_ADDRESS
 * 
de
)

223 
i
 = 0;

225 i(
de
) {

226 
	`tf
("%s: ", 
me
);

227 
i
 = 0; i < 
de
->
mac_n
; i++) {

228 
	`tf
("%02X", 
de
->
mac
[
i
]);

230 
	`tf
("\n");

232 
	}
}

234 
	$t_addss_che
(

237 
i
, 
j
;

238 
BACNET_ADDRESS
 
addss
;

239 
ut32_t
 
devi_id
 = 0;

240 
max_du
 = 0;

242 
	`rtf
(
dr
, "Device\tMAC\tMaxAPDU\tNet\n");

243 
i
 = 0; i < 
MAX_ADDRESS_CACHE
; i++) {

244 i(
	`addss_g_by_dex
(
i
, &
devi_id
, &
max_du
, &
addss
)) {

245 
	`rtf
(
dr
, "%u\t", 
devi_id
);

246 
j
 = 0; j < 
addss
.
mac_n
; j++) {

247 
	`rtf
(
dr
, "%02X", 
addss
.
mac
[
j
]);

249 
	`rtf
(
dr
, "\t");

250 
	`rtf
(
dr
, "%hu\t", 
max_du
);

251 
	`rtf
(
dr
, "%hu\n", 
addss
.
t
);

254 
	}
}

256 
	$ma
(

257 
gc
,

258 *
gv
[])

260 
BACNET_ADDRESS
 
c
 = {

263 
ut16_t
 
pdu_n
 = 0;

264 
timeout
 = 100;

265 
BACNET_ADDRESS
 
my_addss
, 
brd_addss
;

267 (
gc
;

268 (
gv
;

269 
	`Devi_S_Obje_In_Numb
(4194300);

270 
	`addss_
();

271 
	`In_Svi_Hdrs
();

272 
	`dnv_
();

273 
	`dk_g_brd_addss
(&
brd_addss
);

274 
	`t_addss
("Brd", &
brd_addss
);

275 
	`dk_g_my_addss
(&
my_addss
);

276 
	`t_addss
("Addss", &
my_addss
);

277 
	`tf
("BACnet stackunning...\n");

283 
pdu_n
 = 
	`dk_ive
(&
c
, &
Rx_Buf
[0], 
MAX_MPDU
, 
timeout
);

285 i(
pdu_n
) {

286 
	`du_hdr
(&
c
, &
Rx_Buf
[0], 
pdu_n
);

288 i(
I_Am_Reque
) {

289 
I_Am_Reque
 = 
l
;

290 
	`Sd_I_Am
(&
Hdr_Tnsm_Bufr
[0]);

291 } i(
Who_Is_Reque
) {

292 
Who_Is_Reque
 = 
l
;

293 
	`Sd_WhoIs
(-1, -1);

295 
	`Rd_Prݔts
();

303 i(
	`kbh
(&& (
	`gch
() == 0x1B))

307 
	`t_addss_che
();

310 
	}
}

	@ports/win32/net.h

26 #ide
NET_H


27 
	#NET_H


	)

29 
	#WIN32_LEAN_AND_MEAN


	)

30 
	#STRICT
 1

	)

32 #i(
_WIN32_WINNT
 < 
_WIN32_WINNT_WINXP
)

33 #unde
_WIN32_WINNT


34 
	#_WIN32_WINNT
 
_WIN32_WINNT_WINXP


	)

35 #unde
NTDDI_VERSION


36 
	#NTDDI_VERSION
 
NTDDI_WINXP


	)

40 
	~<wdows.h
>

41 #i(!
defed
(
USE_INADDR
) || (USE_INADDR == 0)) && \

42 (!
defed
(
USE_CLASSADDR
|| (
	gUSE_CLASSADDR
 == 0))

43 
	~<hͭi.h
>

45 
	~<wdows.h
>

46 
	~<wsock2.h
>

47 
	~<ws2t.h
>

48 #ide
IPPROTO_IPV6


51 
	~<v6.h
>

53 
	~<dlib.h
>

54 
	~<dio.h
>

55 #ifde
__MINGW32__


56 
	~<ws2i.h
>

58 
	~<wpi.h
>

61 
	~<sys/timeb.h
>

63 #ifde
_MSC_VER


64 
	#le
 
__le


	)

67 #ifde
__BORLANDC__


68 
	#le
 
__le


	)

71 
	#o
 
osock


	)

73 
	tsockn_t
;

	@ports/win32/rs485.c

44 
	~<ddef.h
>

45 
	~<dt.h
>

46 
	~<dbo.h
>

47 
	~<dlib.h
>

48 
	~<dio.h
>

49 
	~<rg.h
>

50 
	~<y.h
>

51 
	~"mp.h
"

52 
	~"dlmp.h
"

53 
	#WIN32_LEAN_AND_MEAN


	)

54 
	#STRICT
 1

	)

55 
	~<wdows.h
>

56 
	~"rs485.h
"

57 
	~"fifo.h
"

62 
HANDLE
 
	gRS485_Hd
;

64 
COMMTIMEOUTS
 
	gRS485_Timeouts
;

66 
	gRS485_Pt_Name
[256] = "COM4";

71 
DWORD
 
	gRS485_Baud
 = 
CBR_38400
;

73 
DWORD
 
	gRS485_BySize
 = 8;

76 
DWORD
 
	gRS485_Py
 = 
NOPARITY
;

79 
DWORD
 
	gRS485_StBs
 = 
ONESTOPBIT
;

82 
DWORD
 
	gRS485_DTRCڌ
 = 
DTR_CONTROL_DISABLE
;

86 
DWORD
 
	gRS485_RTSCڌ
 = 
RTS_CONTROL_DISABLE
;

94 
	$ru
(

95 *
r
)

97 *
p
;

98 
p
 = 
r
; *p != '\0'; ++p) {

99 *
p
 = (
	`tou
(*p);

101 
	}
}

110 
	$RS485_S_I
(

111 *
iame
)

116 i(
iame
) {

117 
	`ru
(
iame
);

118 i(
	`cmp
("COM", 
iame
, 3) == 0) {

119 i(
	`
(
iame
) > 3) {

120 
	`rtf
(
RS485_Pt_Name
, "\\\\.\\COM%i", 
	`oi
(
iame
 + 3));

121 
	`rtf
(
dout
, "Adjusted interfaceameo %s\r\n",

122 
RS485_Pt_Name
);

126 
	}
}

134 
bo
 
	$RS485_I_Vid
(

135 
pt_numb
)

137 
HANDLE
 
h
 = 0;

138 
DWORD
 
r
 = 0;

139 
bo
 
us
 = 
l
;

140 
iame
[255] = "";

142 
	`rtf
(
iame
, "\\\\.\\COM%u", 
pt_numb
);

143 
h
 = 
	`CeFe
(
iame
, 
GENERIC_READ
 | 
GENERIC_WRITE
, 0, 
NULL
,

144 
OPEN_EXISTING
, 0, 
NULL
);

145 i(
h
 =
INVALID_HANDLE_VALUE
) {

146 
r
 = 
	`GLaE
();

147 i((
r
 =
ERROR_ACCESS_DENIED
|| (=
ERROR_GEN_FAILURE
) ||

148 (
r
 =
ERROR_SHARING_VIOLATION
|| (=
ERROR_SEM_TIMEOUT
)) {

149 
us
 = 
ue
;

152 
us
 = 
ue
;

153 
	`CloHd
(
h
);

156  
us
;

157 
	}
}

159 cڡ *
	$RS485_I
(

162  
RS485_Pt_Name
;

163 
	}
}

165 
	$RS485_Prt_E
(

168 
LPVOID
 
MsgBuf
;

170 
	`FmMesge
(
FORMAT_MESSAGE_ALLOCATE_BUFFER
 | 
FORMAT_MESSAGE_FROM_SYSTEM
,

171 
NULL
, 
	`GLaE
(), 
	`MAKELANGID
(
LANG_NEUTRAL
, 
SUBLANG_DEFAULT
),

172 (
LPTSTR
& 
MsgBuf
, 0, 
NULL
);

173 
	`MesgeBox
(
NULL
, 
MsgBuf
, "GLaE", 
MB_OK
 | 
MB_ICONINFORMATION
);

174 
	`LolFe
(
MsgBuf
);

177 
	}
}

179 
	$RS485_Cfigu_Stus
(

182 
DCB
 
dcb
 = { 0 };

183 
COMMTIMEOUTS
 
New
;

186 
dcb
.
DCBngth
 = (dcb);

188 i(!
	`GCommS
(
RS485_Hd
, &
dcb
)) {

189 
	`rtf
(
dr
, "Ubˁg stuom %s\n", 
RS485_Pt_Name
);

190 
	`RS485_Prt_E
();

191 
	`ex
(1);

195 
dcb
.
BaudRe
 = 
RS485_Baud
;

196 
dcb
.
BySize
 = (
RS485_BySize
;

197 
dcb
.
Py
 = (
RS485_Py
;

198 
dcb
.
StBs
 = (
RS485_StBs
;

201 
dcb
.
fDCڌ
 = 
RS485_DTRCڌ
;

202 
dcb
.
fRtsCڌ
 = 
RS485_RTSCڌ
;

217 i(!
	`SCommS
(
RS485_Hd
, &
dcb
)) {

218 
	`rtf
(
dr
, "Ubˁأu %s\n", 
RS485_Pt_Name
);

219 
	`RS485_Prt_E
();

222 
New
.
RdIvTimeout
 = 
MAXDWORD
;

223 
New
.
RdTٮTimeoutMuɝlr
 = 
MAXDWORD
;

224 
New
.
RdTٮTimeoutCڡt
 = 1000;

225 
New
.
WreTٮTimeoutMuɝlr
 = 0;

226 
New
.
WreTٮTimeoutCڡt
 = 0;

227 i(!
	`SCommTimeouts
(
RS485_Hd
, &
New
)) {

228 
	`RS485_Prt_E
();

231 i(!
	`PurgeComm
(
RS485_Hd
, 
PURGE_TXABORT
 | 
PURGE_RXABORT
)) {

232 
	`rtf
(
dr
, "Ubˁpurg%s\n", 
RS485_Pt_Name
);

233 
	`RS485_Prt_E
();

236 
	`SupComm
(
RS485_Hd
, 
MAX_MPDU
, MAX_MPDU);

238 i(!
	`EsCommFuni
(
RS485_Hd
, 
SETDTR
)) {

239 
	`rtf
(
dr
, "UbˁأDTR o%s\n", 
RS485_Pt_Name
);

240 
	`RS485_Prt_E
();

242 
	}
}

250 
	$RS485_C˪up
(

253 i(!
	`EsCommFuni
(
RS485_Hd
, 
CLRDTR
)) {

254 
	`RS485_Prt_E
();

257 i(!
	`SCommTimeouts
(
RS485_Hd
, &
RS485_Timeouts
)) {

258 
	`RS485_Prt_E
();

261 
	`CloHd
(
RS485_Hd
);

262 
	}
}

271 
	$RS485_Inlize
(

274 
RS485_Hd
 =

275 
	`CeFe
(
RS485_Pt_Name
, 
GENERIC_READ
 | 
GENERIC_WRITE
, 0, 0,

276 
OPEN_EXISTING
,

279 i(
RS485_Hd
 =
INVALID_HANDLE_VALUE
) {

280 
	`rtf
(
dr
, "Ubˁݒ %s\n", 
RS485_Pt_Name
);

281 
	`RS485_Prt_E
();

282 
	`ex
(1);

284 i(!
	`GCommTimeouts
(
RS485_Hd
, &
RS485_Timeouts
)) {

285 
	`RS485_Prt_E
();

287 
	`RS485_Cfigu_Stus
();

288 #i
PRINT_ENABLED


289 
	`rtf
(
dout
, "RS485 I: %s\n", 
RS485_Pt_Name
);

292 
	`ex
(
RS485_C˪up
);

295 
	}
}

303 
ut32_t
 
	$RS485_G_Baud_Re
(

306 
RS485_Baud
) {

307 
CBR_19200
:

309 
CBR_38400
:

311 
CBR_57600
:

313 
CBR_115200
:

315 
CBR_110
:

317 
CBR_300
:

319 
CBR_600
:

321 
CBR_1200
:

323 
CBR_2400
:

325 
CBR_4800
:

327 
CBR_14400
:

329 
CBR_56000
:

331 
CBR_128000
:

333 
CBR_256000
:

343 
CBR_9600
:

347 
	}
}

355 
bo
 
	$RS485_S_Baud_Re
(

356 
ut32_t
 
baud
)

358 
bo
 
vid
 = 
ue
;

360 
baud
) {

362 
RS485_Baud
 = 
CBR_9600
;

365 
RS485_Baud
 = 
CBR_19200
;

368 
RS485_Baud
 = 
CBR_38400
;

371 
RS485_Baud
 = 
CBR_57600
;

374 
RS485_Baud
 = 
CBR_115200
;

377 
RS485_Baud
 = 
CBR_110
;

380 
RS485_Baud
 = 
CBR_300
;

383 
RS485_Baud
 = 
CBR_600
;

386 
RS485_Baud
 = 
CBR_1200
;

389 
RS485_Baud
 = 
CBR_2400
;

392 
RS485_Baud
 = 
CBR_4800
;

395 
RS485_Baud
 = 
CBR_14400
;

398 
RS485_Baud
 = 
CBR_56000
;

401 
RS485_Baud
 = 
CBR_128000
;

404 
RS485_Baud
 = 
CBR_256000
;

419 
RS485_Baud
 = 76800;

422 
vid
 = 
l
;

426 i(
vid
) {

430  
vid
;

431 
	}
}

434 
	$RS485_Sd_Fme
(

435 vީ
mp_pt_ru_t
 *
mp_pt
,

436 
ut8_t
 * 
bufr
,

437 
ut16_t
 
nbys
)

439 
DWORD
 
dwWrn
 = 0;

441 i(
mp_pt
) {

442 
ut32_t
 
baud
;

443 
ut8_t
 
tuound_time
;

444 
baud
 = 
	`RS485_G_Baud_Re
();

446 i(
baud
 == 9600)

447 
tuound_time
 = 4;

448 i(
baud
 == 19200)

449 
tuound_time
 = 2;

451 
tuound_time
 = 2;

452 
mp_pt
->
	`STim
(
NULL
< 
tuound_time
) {

456 
	`WreFe
(
RS485_Hd
, 
bufr
, 
nbys
, &
dwWrn
, 
NULL
);

459 i(
mp_pt
) {

460 
mp_pt
->
	`STimRet
(
NULL
);

464 
	}
}

467 
	$RS485_Check_UART_Da
(

468 vީ
mp_pt_ru_t
 *
mp_pt
)

470 
Buf
[1];

471 
DWORD
 
dwRd
 = 0;

473 i(
mp_pt
->
ReiveE
 =
ue
) {

477 i(
mp_pt
->
DaAvaab
 =
l
) {

479 i(!
	`RdFe
(
RS485_Hd
, 
Buf
, pBuf), &
dwRd
, 
NULL
)) {

480 i(
	`GLaE
(!
ERROR_IO_PENDING
) {

481 
mp_pt
->
ReiveE
 = 
TRUE
;

484 i(
dwRd
) {

485 
mp_pt
->
DaRegi
 = 
Buf
[0];

486 
mp_pt
->
DaAvaab
 = 
TRUE
;

490 
	}
}

497 
	$RS485_Prt_Pts
(

500 
i
 = 0;

503 
i
 = 1; i < 256; i++) {

504 i(
	`RS485_I_Vid
(
i
)) {

506 
	`tf
("interface {value=COM%u}"

507 "{diy=BACÈMS/TP oCOM%u}\n", 
i
, i);

510 
	}
}

512 #ifde
TEST_RS485


514 
	~"mpdef.h
"

517 
	$_sm_sk
(

518 *
pArg
)

520 *
TxBuf
 = "BACnet MS/TP";

521 
size_t
 
n
 = 
	`
(
TxBuf
) + 1;

523 
TRUE
) {

524 
	`S˕
(1000);

525 
	`RS485_Sd_Fme
(
NULL
, &
TxBuf
[0], 
n
);

527 
	}
}

529 #i
defed
(
_WIN32
)

530 
BOOL
 
WINAPI
 
	$ClCHdr
(

531 
DWORD
 
dwClTy
)

533 
dwClTy
 = dwCtrlType;

534 
	`ex
(0);

535  
TRUE
;

536 
	}
}

539 
	$ascii_hex_to_t
(

540 
ch
)

542 
rv
 = -1;

544 i((
ch
 >= '0') && (ch <= '9')) {

545 
rv
 = 
ch
 - '0';

546 } i((
ch
 >= 'a') && (ch <= 'f')) {

547 
rv
 = 10 + 
ch
 - 'a';

548 } i((
ch
 >= 'A') && (ch <= 'F')) {

549 
rv
 = 10 + 
ch
 - 'a';

552  
rv
;

553 
	}
}

555 
	$ma
(

556 
gc
,

557 *
gv
[])

559 
hThad
 = 0;

560 
ut32_t
 
g_vue
 = 0;

561 
Buf
[1];

562 
DWORD
 
dwRd
 = 0;

563 
i
 = 0, 
n
 = 0, 
cou
 = 0;

564 
hex_
[5] = "0xff";

565 
ch
 = ' ';

566 
lsb
 = 0, 
msb
 = 0;

567 
my_baud
 = 38400;

568 
ut8_t
 
bufr
[501] = { 0 };

570 i(
gc
 > 1) {

571 
	`RS485_S_I
(
gv
[1]);

573 i(
gc
 > 2) {

574 
my_baud
 = 
	`
(
gv
[2], 
NULL
, 0);

576 
	`RS485_S_Baud_Re
(
my_baud
);

577 
	`RS485_Inlize
();

578 #i
	`defed
(
_WIN32
)

579 
	`SCseMode
(
	`GStdHd
(
STD_INPUT_HANDLE
), 
ENABLE_PROCESSED_INPUT
);

580 
	`SCseClHdr
((
PHANDLER_ROUTINE

ClCHdr
, 
TRUE
);

582 #ifde
TEST_RS485_TRANSMIT


584 i(
gc
 > 3) {

585 
n
 = 
	`
(
gv
[3]);

586 
i
 = 0; i < 
n
; i++) {

588 
ch
 = 
gv
[3][
i
];

589 i(
ch
 == ' ') {

592 
msb
 = 
	`ascii_hex_to_t
(
ch
);

593 i(
msb
 >= 0) {

594 
i
++;

595 
ch
 = 
gv
[3][
i
];

596 
lsb
 = 
	`ascii_hex_to_t
(
ch
);

597 i(
lsb
 >= 0) {

598 
bufr
[
cou
] = 
msb
 << 4 | 
lsb
;

600 
bufr
[
cou
] = 
msb
;

602 
cou
++;

603 i(
cou
 >(
bufr
)) {

608 
	`RS485_Sd_Fme
(
NULL
, 
bufr
, 
cou
);

611 #ifde
TEST_RS485_RECEIVE


614 i(!
	`RdFe
(
RS485_Hd
, 
Buf
, pBuf), &
dwRd
, 
NULL
)) {

615 i(
	`GLaE
(!
ERROR_IO_PENDING
) {

616 
	`RS485_Prt_E
();

620 i(
dwRd
) {

621 
i
 = 0; i < 
dwRd
; i++) {

622 
	`rtf
(
dr
, "%02X ", 
Buf
[
i
]);

625 
dwRd
 = 0;

629 
	}
}

	@ports/win32/rs485.h

36 #ide
RS485_H


37 
	#RS485_H


	)

39 
	~<dt.h
>

40 
	~"mp.h
"

41 
	~"t.h
"

43 #ifde
__lulus


47 
RS485_S_I
(

48 *
iame
);

49 cڡ *
RS485_I
(

52 
RS485_Inlize
(

55 
RS485_Sd_Fme
(

56 vީ
mp_pt_ru_t
 *
mp_pt
,

57 
ut8_t
 * 
bufr
,

58 
ut16_t
 
nbys
);

60 
RS485_Check_UART_Da
(

61 vީ
mp_pt_ru_t
 *
mp_pt
);

63 
ut32_t
 
RS485_G_Baud_Re
(

65 
bo
 
RS485_S_Baud_Re
(

66 
ut32_t
 
baud
);

68 
RS485_Prt_E
(

71 
bo
 
RS485_I_Vid
(

72 
pt_numb
);

73 
RS485_Prt_Pts
(

77 #ifde
__lulus


	@ports/win32/rx_fsm.c

36 
	~<ddef.h
>

37 
	~<dt.h
>

38 
	~<dio.h
>

39 
	~<dlib.h
>

40 
	~<cio.h
>

41 
	~<time.h
>

44 
	#WIN32_LEAN_AND_MEAN


	)

45 
	#STRICT
 1

	)

46 
	~<wdows.h
>

49 
	~"bys.h
"

50 
	~"rs485.h
"

51 
	~"mp.h
"

52 
	~"mext.h
"

53 
	~"c.h
"

55 #ide
max


56 
	#max
(
a
,
b
(((b)? (a: (b))

	)

57 
	#m
(
a
,
b
((< (b)? (a: (b))

	)

62 
	spp_hdr_s
 {

63 
ut32_t
 
	mmagic_numb
;

64 
ut16_t
 
	mvsi_maj
;

65 
ut16_t
 
	mvsi_m
;

66 
t32_t
 
	mthisze
;

67 
ut32_t
 
	msigfigs
;

68 
ut32_t
 
	mn
;

69 
ut32_t
 
	mtwk
;

70 } 
	tpp_hdr_t
;

72 
	spec_hdr_s
 {

73 
ut32_t
 
	mts_c
;

74 
ut32_t
 
	mts_uc
;

75 
ut32_t
 
	m_n
;

76 
ut32_t
 
	mig_n
;

77 } 
	tpec_hdr_t
;

80 vީ
mp_pt_ru_t
 
	gMSTP_Pt
;

81 
ut8_t
 
	gRxBufr
[
MAX_MPDU
];

82 
ut8_t
 
	gTxBufr
[
MAX_MPDU
];

83 
ut16_t
 
	gSTime
;

84 
	#INCREMENT_AND_LIMIT_UINT16
(
x
{i(x < 0xFFFFx++;}

	)

85 
ut16_t
 
	$Tim_S
(

88  
STime
;

89 
	}
}

91 
	$Tim_S_Ret
(

94 
STime
 = 0;

95 
	}
}

97 
	$dlmp_mlicd_tim
(

100 
	`INCREMENT_AND_LIMIT_UINT16
(
STime
);

101 
	}
}

103 *
	$mlicds_sk
(

104 *
pArg
)

106 (
pArg
;

108 
	`S˕
(1);

109 
	`dlmp_mlicd_tim
();

113 
	}
}

116 
ut16_t
 
	$MSTP_Put_Reive
(

117 vީ
mp_pt_ru_t
 *
mp_pt
)

119 (
mp_pt
;

122 
	}
}

126 
ut16_t
 
	$MSTP_G_Sd
(

127 vީ
mp_pt_ru_t
 * 
mp_pt
,

128 
timeout
)

130 (
mp_pt
;

131 (
timeout
;

133 
	}
}

135 
ut16_t
 
	$MSTP_G_Rly
(

136 vީ
mp_pt_ru_t
 * 
mp_pt
,

137 
timeout
)

139 (
mp_pt
;

140 (
timeout
;

142 
	}
}

145 
	$t_ived_ck
(

146 vީ
mp_pt_ru_t
 *
mp_pt
)

148 
i
;

160 
	`rtf
(
dr
, "55 FF %02X %02X %02X %02X %02X %02X ",

161 
mp_pt
->
FmeTy
, mp_pt->
DeiAddss
,

162 
mp_pt
->
SourAddss
, 
	`HI_BYTE
(mp_pt->
DaLgth
),

163 
	`LO_BYTE
(
mp_pt
->
DaLgth
), mp_pt->
HdCRCAu
);

164 i(
mp_pt
->
DaLgth
) {

165 
max_da
 = 
	`m
(
mp_pt
->
IutBufrSize
, mp_pt->
DaLgth
);

166 
i
 = 0; i < 
max_da
; i++) {

167 
	`rtf
(
dr
, "%02X ", 
mp_pt
->
IutBufr
[
i
]);

169 
	`rtf
(
dr
, "%02X %02X ", 
mp_pt
->
DaCRCAuMSB
,

170 
mp_pt
->
DaCRCAuLSB
);

172 
	`rtf
(
dr
, "%s", 
	`mext_ame_ty
(
mp_pt
->
FmeTy
));

173 
	`rtf
(
dr
, "\n");

174 
	}
}

178 
	$timeamp
(

179 
ut32_t
 * 
ts_c
,

180 
ut32_t
 * 
ts_uc
)

182 
DWORD
 
ticks
 = 0;

183 
DWORD
 
l_ticks
 = 0;

184 
time_t
 
l_cds
 = 0;

185 
time_t
 
cds
 = 0;

186 
time_t
 
mlicds
 = 0;

187 
time_t
 
d_ticks
 = 0;

189 i(
l_cds
 == 0) {

190 
l_cds
 = 
	`time
(
NULL
);

191 
l_ticks
 = 
	`GTickCou
();

193 
ticks
 = 
	`GTickCou
();

195 
d_ticks
 = 
ticks
 - 
l_ticks
;

196 
cds
 = 
d_ticks
 / 1000;

197 
mlicds
 = 
d_ticks
 - (
cds
 * 1000);

198 *
ts_c
 = 
l_cds
 + 
cds
;

199 *
ts_uc
 = 
mlicds
 * 1000;

202 
	}
}

204 cڡ *
	gCtu_Fame
 = "mstp.cap";

205 
FILE
 *
	gpFe
 = 
NULL
;

208 
	$wre_glob_hd
(

211 
ut32_t
 
magic_numb
 = 0xa1b2c3d4;

212 
ut16_t
 
vsi_maj
 = 2;

213 
ut16_t
 
vsi_m
 = 4;

214 
t32_t
 
thisze
 = 0;

215 
ut32_t
 
sigfigs
 = 0;

216 
ut32_t
 
n
 = 65535;

217 
ut32_t
 
twk
 = 165;

220 
pFe
 = 
	`fݒ
(
Ctu_Fame
, "wb");

221 i(
pFe
) {

222 
	`fwre
(&
magic_numb
, (magic_numb), 1, 
pFe
);

223 
	`fwre
(&
vsi_maj
, (vsi_maj), 1, 
pFe
);

224 
	`fwre
(&
vsi_m
, (vsi_m), 1, 
pFe
);

225 
	`fwre
(&
thisze
, hisze), 1, 
pFe
);

226 
	`fwre
(&
sigfigs
, (sigfigs), 1, 
pFe
);

227 
	`fwre
(&
n
, (n), 1, 
pFe
);

228 
	`fwre
(&
twk
, ґwk), 1, 
pFe
);

230 
	`rtf
(
dr
, "rx_fsm: faedݒ %s: %s\n", 
Ctu_Fame
,

231 
	`
(
o
));

233 
	}
}

235 
	$wre_ived_ck
(

236 vީ
mp_pt_ru_t
 *
mp_pt
)

238 
ut32_t
 
ts_c
;

239 
ut32_t
 
ts_uc
;

240 
ut32_t
 
_n
;

241 
ut32_t
 
ig_n
;

242 
ut8_t
 
hd
[8];

244 i(
pFe
) {

245 
	`timeamp
(&
ts_c
, &
ts_uc
);

246 
	`fwre
(&
ts_c
, s_c), 1, 
pFe
);

247 
	`fwre
(&
ts_uc
, s_uc), 1, 
pFe
);

248 i(
mp_pt
->
DaLgth
) {

249 
max_da
 = 
	`m
(
mp_pt
->
IutBufrSize
, mp_pt->
DaLgth
);

250 
_n
 = 
ig_n
 = 8 + 
max_da
 + 2;

252 
_n
 = 
ig_n
 = 8;

254 
	`fwre
(&
_n
, (_n), 1, 
pFe
);

255 
	`fwre
(&
ig_n
, (ig_n), 1, 
pFe
);

256 
hd
[0] = 0x55;

257 
hd
[1] = 0xFF;

258 
hd
[2] = 
mp_pt
->
FmeTy
;

259 
hd
[3] = 
mp_pt
->
DeiAddss
;

260 
hd
[4] = 
mp_pt
->
SourAddss
;

261 
hd
[5] = 
	`HI_BYTE
(
mp_pt
->
DaLgth
);

262 
hd
[6] = 
	`LO_BYTE
(
mp_pt
->
DaLgth
);

263 
hd
[7] = 
mp_pt
->
HdCRCAu
;

264 
	`fwre
(
hd
, (hd), 1, 
pFe
);

265 i(
mp_pt
->
DaLgth
) {

266 
	`fwre
(&(
mp_pt
->
DaCRCAuMSB
), 1, 1, 
pFe
);

267 
	`fwre
(&(
mp_pt
->
DaCRCAuLSB
), 1, 1, 
pFe
);

270 
	`rtf
(
dr
, "rx_fsm: faedݒ %s: %s\n", 
Ctu_Fame
,

271 
	`
(
o
));

273 
	}
}

275 *
	gNwk_I
 = 
NULL
;

277 
	$nup
(

280 i(
pFe
) {

281 
	`fush
(
pFe
);

282 
	`fo
(
pFe
);

284 
pFe
 = 
NULL
;

285 
	}
}

288 
	$ma
(

289 
gc
,

290 *
gv
[])

292 vީ
mp_pt_ru_t
 *
mp_pt
;

293 
rc
 = 0;

294 
hThad
 = 0;

295 
ut32_t
 
g_vue
 = 0;

296 
my_mac
 = 127;

297 
my_baud
 = 38400;

300 
mp_pt
 = &
MSTP_Pt
;

302 i(
gc
 > 1) {

303 
Nwk_I
 = 
gv
[1];

305 i(
gc
 > 2) {

306 
my_baud
 = 
	`
(
gv
[2], 
NULL
, 0);

308 i(
gc
 > 3) {

309 
my_mac
 = 
	`
(
gv
[3], 
NULL
, 0);

310 i(
my_mac
 > 127)

311 
my_mac
 = 127;

314 
	`RS485_S_I
(
Nwk_I
);

315 
	`RS485_S_Baud_Re
(
my_baud
);

316 
	`RS485_Inlize
();

317 
MSTP_Pt
.
IutBufr
 = &
RxBufr
[0];

318 
MSTP_Pt
.
IutBufrSize
 = (
RxBufr
);

319 
MSTP_Pt
.
OuutBufr
 = &
TxBufr
[0];

320 
MSTP_Pt
.
OuutBufrSize
 = (
TxBufr
);

321 
MSTP_Pt
.
This_Sti
 = 
my_mac
;

322 
MSTP_Pt
.
Nmax_fo_ames
 = 1;

323 
MSTP_Pt
.
Nmax_ma
 = 127;

324 
MSTP_Pt
.
STim
 = 
Tim_S
;

325 
MSTP_Pt
.
STimRet
 = 
Tim_S_Ret
;

326 
	`MSTP_In
(&
MSTP_Pt
);

327 
mp_pt
->
Lurkg
 = 
ue
;

329 
hThad
 = 
	`_begthad
(
mlicds_sk
, 4096, &
g_vue
);

330 i(
hThad
 == 0) {

331 
	`rtf
(
dr
, "Failedo startimerask\n");

333 
	`ex
(
nup
);

334 
	`wre_glob_hd
();

335 (
	`SThadPriܙy
(
	`GCutThad
(),

336 
THREAD_PRIORITY_TIME_CRITICAL
);

339 
	`RS485_Check_UART_Da
(
mp_pt
);

340 
	`MSTP_Reive_Fme_FSM
(
mp_pt
);

342 i(
mp_pt
->
ReivedVidFme
) {

343 
mp_pt
->
ReivedVidFme
 = 
l
;

345 
	`t_ived_ck
(
mp_pt
);

347 
	`wre_ived_ck
(
mp_pt
);

348 } i(
mp_pt
->
ReivedInvidFme
) {

349 
mp_pt
->
ReivedInvidFme
 = 
l
;

350 
	`rtf
(
dr
, "ReceivedInvalidFrame\n");

352 
	`t_ived_ck
(
mp_pt
);

354 
	`wre_ived_ck
(
mp_pt
);

359 
	}
}

	@ports/win32/stdbool.h

1 #ide
_STDBOOL_H


2 
	#_STDBOOL_H


	)

4 
	~<dt.h
>

9 #i!
defed
(
__lulus
)

11 #i!
defed
(
__GNUC__
)

18 #i
_MSC_VER
 < 1600

19 
t8_t
 
	t_Bo
;

24 
	#bo
 
_Bo


	)

25 
	#ue
 1

	)

26 
	#l
 0

	)

27 
	#__bo_ue_l_e_defed
 1

	)

	@ports/win32/stdint.h

4 #ide
_STDINT_H


5 
	#_STDINT_H


	)

7 
	~<ddef.h
>

9 
	tut8_t
;

10 sigd 
	tt8_t
;

11 
	tut16_t
;

12 sigd 
	tt16_t
;

14 
	tut32_t
;

15 
	tt32_t
;

19 
	#INT8_MIN
 (-128)

	)

20 
	#INT16_MIN
 (-32768)

	)

21 
	#INT32_MIN
 (-2147483647 - 1)

	)

23 
	#INT8_MAX
 127

	)

24 
	#INT16_MAX
 32767

	)

25 
	#INT32_MAX
 2147483647

	)

27 
	#UINT8_MAX
 0xf

	)

28 
	#UINT16_MAX
 0xfff

	)

29 
	#UINT32_MAX
 0xfffffff

	)

	@ports/win32/timer.c

26 
	~<dio.h
>

27 
	~<dbo.h
>

28 
	~<dt.h
>

29 
	~<dlib.h
>

30 
	~<time.h
>

31 
	#WIN32_LEAN_AND_MEAN


	)

32 
	#STRICT
 1

	)

33 
	~<wdows.h
>

34 
	~"t.h
"

35 
	~<MMSyem.h
>

36 
	~"tim.h
"

40 #i
defed
(
_MSC_VER
|| defed(
_MSC_EXTENSIONS
|| defed(
__BORLANDC__
)

41 
	#DELTA_EPOCH_IN_MICROSECS
 11644473600000000U
i64


	)

43 
	#DELTA_EPOCH_IN_MICROSECS
 11644473600000000ULL

	)

47 vީ
ut32_t
 
	gMlicd_Cou
[
MAX_MILLISECOND_TIMERS
];

50 
ut32_t
 
	gTim_Piod
 = 1;

52 #i
defed
(
_MSC_VER
|| defed(
__BORLANDC__
)

53 
	stimeze
 {

54 
	mtz_muswe
;

55 
	mtz_dtime
;

67 
	$gtimeofday
(

68 
timev
 *

,

69 *
tzp
)

71 
tzag
 = 0;

72 
timeze
 *
tz
;

74 
LONGLONG
 
uc_tim
 = 0;

75 
LONGLONG
 
uc_d
 = 0;

77 
ut32_t
 
time_t
 = 0;

79 
FILETIME
 

;

80 
ut32_t
 
d_mlicds
 = 0;

82 
tzp
 =zp;

83 i(
uc_tim
 == 0) {

86 
	`GSyemTimeAsFeTime
(&

);

87 
uc_tim
 = 

.
dwHighDeTime
;

88 
uc_tim
 <<= 32;

89 
uc_tim
 |

.
dwLowDeTime
;

91 
uc_tim
 /= 10;

92 
uc_tim
 -
DELTA_EPOCH_IN_MICROSECS
;

93 

->
tv_c
 = ((
uc_tim
 / 1000000UL);

94 

->
tv_uc
 = ((
uc_tim
 % 1000000UL);

95 
time_t
 = 
	`timeGTime
();

97 
d_mlicds
 = 
	`timeGTime
(- 
time_t
;

98 
uc_d
 = 
uc_tim
 + ((
LONGLONG

d_mlicds
 * 1000UL);

99 

->
tv_c
 = ((
uc_d
 / 1000000UL);

100 

->
tv_uc
 = ((
uc_d
 % 1000000UL);

102 i(
tzp
) {

103 i(!
tzag
) {

104 
	`_tzt
();

105 
tzag
++;

107 
tz
 = 
tzp
;

108 
tz
->
tz_muswe
 = 
_timeze
 / 60;

109 
tz
->
tz_dtime
 = 
_daylight
;

113 
	}
}

121 
ut32_t
 
	$tim_mlicds
(

122 
dex
)

124 
ut32_t
 
now
 = 
	`timeGTime
();

125 
ut32_t
 
d_time
 = 0;

128 i(
dex
 < 
MAX_MILLISECOND_TIMERS
) {

129 i(
Mlicd_Cou
[
dex
] <
now
) {

130 
d_time
 = 
now
 - 
Mlicd_Cou
[
dex
];

132 
d_time
 = (
UINT32_MAX
 - 
Mlicd_Cou
[
dex
]+ 
now
 + 1;

136  
d_time
;

137 
	}
}

144 
bo
 
	$tim_d_mlicds
(

145 
dex
,

146 
ut32_t
 
vue
)

148  (
	`tim_mlicds
(
dex
>
vue
);

149 
	}
}

156 
bo
 
	$tim_d_cds
(

157 
dex
,

158 
ut32_t
 
cds
)

160  ((
	`tim_mlicds
(
dex
/ 1000>
cds
);

161 
	}
}

168 
bo
 
	$tim_d_mus
(

169 
dex
,

170 
ut32_t
 
mus
)

172  ((
	`tim_mlicds
(
dex
/ (1000 * 60)>
mus
);

173 
	}
}

180 
ut32_t
 
	$tim_t
(

181 
dex
)

183 
ut32_t
 
tim_vue
 = 
	`tim_mlicds
(
dex
);

184 i(
dex
 < 
MAX_MILLISECOND_TIMERS
) {

185 
Mlicd_Cou
[
dex
] = 
	`timeGTime
();

187  
tim_vue
;

188 
	}
}

195 
	$tim_nup
(

198 
	`timeEndPiod
(
Tim_Piod
);

199 
	}
}

206 
	$tim_
(

209 
TIMECAPS
 
tc
;

212 i(
	`timeGDevCs
(&
tc
, (
TIMECAPS
)!
TIMERR_NOERROR
) {

213 
	`rtf
(
dr
, "Failedo getimeresolutionarameters\n");

216 
Tim_Piod
 = 
	`m
(
	`max
(
tc
.
wPiodM
, 1L),c.
wPiodMax
);

217 i(
Tim_Piod
 != 1L) {

218 
	`rtf
(
dr
,

220 (
Tim_Piod
);

222 
	`timeBegPiod
(
Tim_Piod
);

223 
	`ex
(
tim_nup
);

224 
	}
}

226 #ifde
TEST_TIMER_WIN


227 
ut32_t
 
	$timev_diff_ms
(

228 
timev
 *
d
,

229 
timev
 *
now
)

231 
ut32_t
 
ms
 = 0;

234 
ms
 = (
now
->
tv_c
 - 
d
->tv_c* 1000 + (now->
tv_uc
 -

235 
d
->
tv_uc
) / 1000;

237  
ms
;

238 
	}
}

240 
	$ma
(

241 
gc
,

242 *
gv
[])

244 
now
 = 0, 
ϡ
 = 0, 
d
 = 0;

245 
timev
 
tv
;

246 
timev
 
d_tv
 = { 0 };

248 
	`tim_
();

249 
	`tf
("Testing granularity ofimeGetTime()...\n");

250 
	`tim_t
(0);

252 
now
 = 
	`timeGTime
();

253 
d
 = 
now
 - 
ϡ
;

254 i(
d
) {

255 i(
d
 > 1) {

256 
	`tf
("D i%ld.\n", 
d
);

258 
ϡ
 = 
now
;

260 i(
	`tim_d_mlicds
(0, 5000)) {

264 
	`tf
("Testing granularity of gettimeofday()...\n");

266 
	`gtimeofday
(&
tv
, 
NULL
);

267 
d
 = 
	`timev_diff_ms
(&
d_tv
, &
tv
);

268 i(
d
) {

269 i(
d
 > 1) {

270 
	`tf
("D i%ld.\n", 
d
);

272 
d_tv
.
tv_c
 = 
tv
.tv_sec;

273 
d_tv
.
tv_uc
 = 
tv
.tv_usec;

275 i(
	`tim_d_mlicds
(0, 10000)) {

280 
	}
}

	@ports/win32/timer.h

24 #ide
TIMER_H


25 
	#TIMER_H


	)

27 
	~<dbo.h
>

28 
	~<dt.h
>

30 
	#WIN32_LEAN_AND_MEAN


	)

31 
	#STRICT
 1

	)

32 
	~<wdows.h
>

33 #i
defed
(
__BORLANDC__
)

34 
	~<wsock2.h
>

36 #i!
defed
(
_MSC_VER
)

37 
	~<sys/time.h
>

40 
	~<sys/timeb.h
>

41 #i
defed
(
__BORLANDC__
)

42 
	#_timeb
 
timeb


	)

43 
	#_ime
(
m

	`ime
լam)

	)

47 #ide
MAX_MILLISECOND_TIMERS


48 
	#TIMER_SILENCE
 0

	)

49 
	#MAX_MILLISECOND_TIMERS
 1

	)

52 #ifde
__lulus


56 
gtimeofday
(

57 
timev
 *

,

58 *
tzp
);

60 
tim_
(

62 
ut32_t
 
tim_mlicds
(

63 
dex
);

64 
bo
 
tim_d_mlicds
(

65 
dex
,

66 
ut32_t
 
vue
);

67 
bo
 
tim_d_cds
(

68 
dex
,

69 
ut32_t
 
vue
);

70 
bo
 
tim_d_mus
(

71 
dex
,

72 
ut32_t
 
cds
);

73 
ut32_t
 
tim_mlicds_t
(

74 
dex
,

75 
ut32_t
 
vue
);

76 
ut32_t
 
tim_t
(

77 
dex
);

79 #ifde
__lulus


	@src/abort.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"abt.h
"

47 
BACNET_ABORT_REASON
 
	$abt_cvt_r_code
(

48 
BACNET_ERROR_CODE
 
r_code
)

50 
BACNET_ABORT_REASON
 
abt_code
 = 
ABORT_REASON_OTHER
;

52 
r_code
) {

53 
ERROR_CODE_ABORT_BUFFER_OVERFLOW
:

54 
abt_code
 = 
ABORT_REASON_BUFFER_OVERFLOW
;

56 
ERROR_CODE_ABORT_INVALID_APDU_IN_THIS_STATE
:

57 
abt_code
 = 
ABORT_REASON_INVALID_APDU_IN_THIS_STATE
;

59 
ERROR_CODE_ABORT_PREEMPTED_BY_HIGHER_PRIORITY_TASK
:

60 
abt_code
 = 
ABORT_REASON_PREEMPTED_BY_HIGHER_PRIORITY_TASK
;

62 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
:

63 
abt_code
 = 
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
;

65 
ERROR_CODE_ABORT_PROPRIETARY
:

66 
abt_code
 = 
FIRST_PROPRIETARY_ABORT_REASON
;

68 
ERROR_CODE_ABORT_OTHER
:

70 
abt_code
 = 
ABORT_REASON_OTHER
;

74  (
abt_code
);

75 
	}
}

78 
	$abt_code_du
(

79 
ut8_t
 * 
du
,

80 
ut8_t
 
voke_id
,

81 
ut8_t
 
abt_as
,

82 
bo
 
rv
)

84 
du_n
 = 0;

86 i(
du
) {

87 i(
rv
)

88 
du
[0] = 
PDU_TYPE_ABORT
 | 1;

90 
du
[0] = 
PDU_TYPE_ABORT
;

91 
du
[1] = 
voke_id
;

92 
du
[2] = 
abt_as
;

93 
du_n
 = 3;

96  
du_n
;

97 
	}
}

99 #i!
BACNET_SVC_SERVER


101 
	$abt_decode_rvi_que
(

102 
ut8_t
 * 
du
,

103 
du_n
,

104 
ut8_t
 * 
voke_id
,

105 
ut8_t
 * 
abt_as
)

107 
n
 = 0;

109 i(
du_n
 > 0) {

110 i(
voke_id
)

111 *
voke_id
 = 
du
[0];

112 i(
abt_as
)

113 *
abt_as
 = 
du
[1];

116  
n
;

117 
	}
}

120 #ifde
TEST


121 
	~<as.h
>

122 
	~<rg.h
>

123 
	~"e.h
"

126 
	$abt_decode_du
(

127 
ut8_t
 * 
du
,

128 
du_n
,

129 
ut8_t
 * 
voke_id
,

130 
ut8_t
 * 
abt_as
,

131 
bo
 * 
rv
)

133 
n
 = 0;

135 i(!
du
)

138 i(
du_n
 > 0) {

139 i((
du
[0] & 0xF0!
PDU_TYPE_ABORT
)

141 i(
du
[0] & 1)

142 *
rv
 = 
ue
;

144 *
rv
 = 
l
;

145 i(
du_n
 > 1) {

146 
n
 =

147 
	`abt_decode_rvi_que
(&
du
[1], 
du_n
 - 1, 
voke_id
,

148 
abt_as
);

152  
n
;

153 
	}
}

155 
	$AbtAPDU
(

156 
Te
 * 
pTe
,

157 
ut8_t
 
voke_id
,

158 
ut8_t
 
abt_as
,

159 
bo
 
rv
)

161 
ut8_t
 
du
[480] = { 0 };

162 
n
 = 0;

163 
du_n
 = 0;

164 
ut8_t
 
_voke_id
 = 0;

165 
ut8_t
 
_abt_as
 = 0;

166 
bo
 
_rv
 = 
l
;

168 
n
 = 
	`abt_code_du
(&
du
[0], 
voke_id
, 
abt_as
, 
rv
);

169 
du_n
 = 
n
;

170 
	`_
(
pTe
, 
n
 != 0);

171 
n
 =

172 
	`abt_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

173 &
_abt_as
, &
_rv
);

174 
	`_
(
pTe
, 
n
 != -1);

175 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

176 
	`_
(
pTe
, 
_abt_as
 =
abt_as
);

177 
	`_
(
pTe
, 
_rv
 =
rv
);

180 
	}
}

183 
	$Abt
(

184 
Te
 * 
pTe
)

186 
ut8_t
 
du
[480] = { 0 };

187 
n
 = 0;

188 
du_n
 = 0;

189 
ut8_t
 
voke_id
 = 0;

190 
ut8_t
 
_voke_id
 = 0;

191 
ut8_t
 
abt_as
 = 0;

192 
ut8_t
 
_abt_as
 = 0;

193 
bo
 
rv
 = 
l
;

194 
bo
 
_rv
 = 
l
;

196 
n
 = 
	`abt_code_du
(&
du
[0], 
voke_id
, 
abt_as
, 
rv
);

197 
	`_
(
pTe
, 
n
 != 0);

198 
du_n
 = 
n
;

199 
n
 =

200 
	`abt_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

201 &
_abt_as
, &
_rv
);

202 
	`_
(
pTe
, 
n
 != -1);

203 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

204 
	`_
(
pTe
, 
_abt_as
 =
abt_as
);

205 
	`_
(
pTe
, 
_rv
 =
rv
);

208 
du
[0] = 
PDU_TYPE_REJECT
;

209 
n
 =

210 
	`abt_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

211 &
_abt_as
, &
_rv
);

212 
	`_
(
pTe
, 
n
 == -1);

215 
n
 =

216 
	`abt_decode_du
(
NULL
, 
du_n
, &
_voke_id
, &
_abt_as
,

217 &
_rv
);

218 
	`_
(
pTe
, 
n
 == -1);

221 
n
 =

222 
	`abt_decode_du
(&
du
[0], 0, &
_voke_id
, &
_abt_as
,

223 &
_rv
);

224 
	`_
(
pTe
, 
n
 == 0);

227 
voke_id
 = 0; invoke_id < 255; invoke_id++) {

228 
abt_as
 = 0;bort_reason < 255;bort_reason++) {

229 
	`AbtAPDU
(
pTe
, 
voke_id
, 
abt_as
, 
l
);

230 
	`AbtAPDU
(
pTe
, 
voke_id
, 
abt_as
, 
ue
);

233 
	}
}

235 #ifde
TEST_ABORT


236 
	$ma
(

239 
Te
 *
pTe
;

240 
bo
 
rc
;

242 
pTe
 = 
	`_
("BACÈAbt", 
NULL
);

244 
rc
 = 
	`_addTeFuni
(
pTe
, 
Abt
);

245 
	`as
(
rc
);

247 
	`_tSm
(
pTe
, 
dout
);

248 
	`_run
(
pTe
);

249 (
	`_pt
(
pTe
);

250 
	`_deroy
(
pTe
);

253 
	}
}

	@src/address.c

34 
	~<ddef.h
>

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~<dio.h
>

38 
	~<dlib.h
>

39 
	~"cfig.h
"

40 
	~"baddr.h
"

41 
	~"addss.h
"

42 
	~"bacdef.h
"

43 
	~"bacdcode.h
"

44 
	~"adnge.h
"

47 #i!
defed
(
BACNET_ADDRESS_CACHE_FILE
)

48 #i
PRINT_ENABLED


49 
	#BACNET_ADDRESS_CACHE_FILE


	)

59 
ut32_t
 
	gT_Preed_Ery
;

60 
ut32_t
 
	gOwn_Devi_ID
 = 0xFFFFFFFF;

62 
	sAddss_Cache_Ery
 {

63 
ut8_t
 
	mFgs
;

64 
ut32_t
 
	mdevi_id
;

65 
	mmax_du
;

66 
BACNET_ADDRESS
 
	maddss
;

67 
ut32_t
 
	mTimeToLive
;

68 } 
	gAddss_Cache
[
MAX_ADDRESS_CACHE
];

72 
	#BAC_ADDR_IN_USE
 1

	)

73 
	#BAC_ADDR_BIND_REQ
 2

	)

74 
	#BAC_ADDR_STATIC
 4

	)

75 
	#BAC_ADDR_SHORT_TTL
 8

	)

76 
	#BAC_ADDR_RESERVED
 128

	)

78 
	#BAC_ADDR_SECS_1HOUR
 3600

	)

79 
	#BAC_ADDR_SECS_1DAY
 86400

	)

81 
	#BAC_ADDR_LONG_TIME
 
BAC_ADDR_SECS_1DAY


	)

82 
	#BAC_ADDR_SHORT_TIME
 
BAC_ADDR_SECS_1HOUR


	)

83 
	#BAC_ADDR_FOREVER
 0xFFFFFFFF

	)

86 
	$addss_eed_y_dex_t
(
ut32_t
 
t_eed_y_dex
)

88 
T_Preed_Ery
 = 
t_eed_y_dex
;

89 
	}
}

91 
	$addss_own_devi_id_t
(
ut32_t
 
own_id
)

93 
Own_Devi_ID
 = 
own_id
;

94 
	}
}

96 
bo
 
	$addss_mch
(

97 
BACNET_ADDRESS
 * 
de
,

98 
BACNET_ADDRESS
 * 
c
)

100 
ut8_t
 
i
 = 0;

101 
ut8_t
 
max_n
 = 0;

103 i(
de
->
mac_n
 !
c
->mac_len)

104  
l
;

105 
max_n
 = 
de
->
mac_n
;

106 i(
max_n
 > 
MAX_MAC_LEN
)

107 
max_n
 = 
MAX_MAC_LEN
;

108 
i
 = 0; i < 
max_n
; i++) {

109 i(
de
->
mac
[
i
] !
c
->mac[i])

110  
l
;

112 i(
de
->
t
 !
c
->net)

113  
l
;

116 i(
de
->
t
 == 0)

117  
ue
;

119 i(
de
->
n
 !
c
->len)

120  
l
;

121 
max_n
 = 
de
->
n
;

122 i(
max_n
 > 
MAX_MAC_LEN
)

123 
max_n
 = 
MAX_MAC_LEN
;

124 
i
 = 0; i < 
max_n
; i++) {

125 i(
de
->
adr
[
i
] !
c
->adr[i])

126  
l
;

129  
ue
;

130 
	}
}

132 
	$addss_move_devi
(

133 
ut32_t
 
devi_id
)

135 
Addss_Cache_Ery
 *
pMch
;

136 
ut32_t
 
dex
 = 0;

138 
pMch
 = 
Addss_Cache
;

139 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

140 i(((
pMch
->
Fgs
 & 
BAC_ADDR_IN_USE
) != 0) &&

141 (
pMch
->
devi_id
 == device_id)) {

142 
pMch
->
Fgs
 = 0;

143 i(
dex
 < 
T_Preed_Ery
) {

144 
T_Preed_Ery
--;

148 
pMch
++;

149 
dex
++;

153 
	}
}

164 
Addss_Cache_Ery
 *
	$addss_move_de
(

167 
Addss_Cache_Ery
 *
pMch
;

168 
Addss_Cache_Ery
 *
pCdide
;

169 
ut32_t
 
ulTime
;

171 
pCdide
 = 
NULL
;

172 i(
T_Preed_Ery
 > (
MAX_ADDRESS_CACHE
 - 1)) {

173  
pCdide
;

175 
ulTime
 = 
BAC_ADDR_FOREVER
 - 1;

179 
pMch
 = &
Addss_Cache
[
T_Preed_Ery
];

180 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

181 i((
pMch
->

182 
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
 |

183 
BAC_ADDR_STATIC
)=
BAC_ADDR_IN_USE
) {

184 i(
pMch
->
TimeToLive
 <
ulTime
) {

185 
ulTime
 = 
pMch
->
TimeToLive
;

186 
pCdide
 = 
pMch
;

189 
pMch
++;

192 i(
pCdide
 !
NULL
) {

193 
pCdide
->
Fgs
 = 
BAC_ADDR_RESERVED
;

194 
pCdide
->
TimeToLive
 = 
BAC_ADDR_SHORT_TIME
;

195  (
pCdide
);

199 
pMch
 = 
Addss_Cache
;

200 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

201 i((
pMch
->

202 
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
 |

203 
BAC_ADDR_STATIC
)) ==

204 ((
ut8_t
(
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
))) {

205 i(
pMch
->
TimeToLive
 <
ulTime
) {

206 
ulTime
 = 
pMch
->
TimeToLive
;

207 
pCdide
 = 
pMch
;

210 
pMch
++;

213 i(
pCdide
 !
NULL
) {

214 
pCdide
->
Fgs
 = 
BAC_ADDR_RESERVED
;

215 
pCdide
->
TimeToLive
 = 
BAC_ADDR_SHORT_TIME
;

218  (
pCdide
);

219 
	}
}

221 #ifde
BACNET_ADDRESS_CACHE_FILE


228 cڡ *
	gAddss_Cache_Fame
 = "address_cache";

230 
	$addss_fe_
(

231 cڡ *
pFame
)

233 
FILE
 *
pFe
 = 
NULL
;

234 
le
[256] = { "" };

235 
devi_id
 = 0;

236 

 = 0;

237 
max_du
 = 0;

238 
mac
[
MAX_MAC_LEN
] = { 0 };

239 
cou
 = 0;

240 
mac_rg
[80] = { "" }, 
dr_rg
[80] = {

242 
BACNET_ADDRESS
 
c
 = { 0 };

243 
dex
 = 0;

245 
pFe
 = 
	`fݒ
(
pFame
, "r");

246 i(
pFe
) {

247 
	`fgs
(
le
, (֚e), 
pFe
!
NULL
) {

249 i(
le
[0] != ';') {

250 i(
	`ssnf
(
le
, "%7ld %79%5u %79%4u", &
devi_id
,

251 &
mac_rg
[0], &

, &
dr_rg
[0],

252 &
max_du
) == 5) {

253 
cou
 =

254 
	`ssnf
(
mac_rg
, "%2x:%2x:%2x:%2x:%2x:%2x", &
mac
[0],

255 &
mac
[1], &mac[2], &mac[3], &mac[4], &mac[5]);

256 
c
.
mac_n
 = (
ut8_t

cou
;

257 
dex
 = 0; index < 
MAX_MAC_LEN
; index++) {

258 
c
.
mac
[
dex
] = (
ut8_t
) mac[index];

260 
c
.
t
 = (
ut16_t


;

261 i(

) {

262 
cou
 =

263 
	`ssnf
(
dr_rg
, "%2x:%2x:%2x:%2x:%2x:%2x",

264 &
mac
[0], &mac[1], &mac[2], &mac[3], &mac[4],

265 &
mac
[5]);

266 
c
.
n
 = (
ut8_t

cou
;

267 
dex
 = 0; index < 
MAX_MAC_LEN
; index++) {

268 
c
.
adr
[
dex
] = (
ut8_t

mac
[index];

271 
c
.
n
 = 0;

272 
dex
 = 0; index < 
MAX_MAC_LEN
; index++) {

273 
c
.
adr
[
dex
] = 0;

276 
	`addss_add
((
ut32_t

devi_id
, 
max_du
, &
c
);

277 
	`addss_t_devi_TTL
((
ut32_t

devi_id
, 0, 
ue
);

281 
	`fo
(
pFe
);

285 
	}
}

293 
	$addss_
(

296 
Addss_Cache_Ery
 *
pMch
;

298 
T_Preed_Ery
 = 0;

300 
pMch
 = 
Addss_Cache
;

301 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

302 
pMch
->
Fgs
 = 0;

303 
pMch
++;

305 #ifde
BACNET_ADDRESS_CACHE_FILE


306 
	`addss_fe_
(
Addss_Cache_Fame
);

309 
	}
}

319 
	$addss__l
()

321 
Addss_Cache_Ery
 *
pMch
;

323 
pMch
 = 
Addss_Cache
;

324 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

325 i((
pMch
->
Fgs
 & 
BAC_ADDR_IN_USE
) != 0) {

326 i(((
pMch
->
Fgs
 & 
BAC_ADDR_BIND_REQ
) != 0) ||

327 (
pMch
->
TimeToLive
 == 0))

328 
pMch
->
Fgs
 = 0;

331 i((
pMch
->
Fgs
 & 
BAC_ADDR_RESERVED
) != 0) {

332 
pMch
->
Fgs
 = 0;

335 
pMch
++;

337 #ifde
BACNET_ADDRESS_CACHE_FILE


338 
	`addss_fe_
(
Addss_Cache_Fame
);

342 
	}
}

352 
	$addss_t_devi_TTL
(

353 
ut32_t
 
devi_id
,

354 
ut32_t
 
TimeOut
,

355 
bo
 
SticFg
)

357 
Addss_Cache_Ery
 *
pMch
;

359 
pMch
 = 
Addss_Cache
;

360 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

361 i(((
pMch
->
Fgs
 & 
BAC_ADDR_IN_USE
) != 0) &&

362 (
pMch
->
devi_id
 == device_id)) {

363 i((
pMch
->
Fgs
 & 
BAC_ADDR_BIND_REQ
) == 0) {

364 i(
SticFg
) {

365 
pMch
->
Fgs
 |
BAC_ADDR_STATIC
;

366 
pMch
->
TimeToLive
 = 
BAC_ADDR_FOREVER
;

368 
pMch
->
Fgs
 &~
BAC_ADDR_STATIC
;

369 
pMch
->
TimeToLive
 = 
TimeOut
;

372 
pMch
->
TimeToLive
 = 
TimeOut
;

376 
pMch
++;

378 
	}
}

381 
bo
 
	$addss_g_by_devi
(

382 
ut32_t
 
devi_id
,

383 *
max_du
,

384 
BACNET_ADDRESS
 * 
c
)

386 
Addss_Cache_Ery
 *
pMch
;

387 
bo
 
found
 = 
l
;

389 
pMch
 = 
Addss_Cache
;

390 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

391 i(((
pMch
->
Fgs
 & 
BAC_ADDR_IN_USE
) != 0) &&

392 (
pMch
->
devi_id
 == device_id)) {

393 i((
pMch
->
Fgs
 & 
BAC_ADDR_BIND_REQ
) == 0) {

394 *
c
 = 
pMch
->
addss
;

395 *
max_du
 = 
pMch
->max_apdu;

396 
found
 = 
ue
;

400 
pMch
++;

403  
found
;

404 
	}
}

408 
bo
 
	$addss_g_devi_id
(

409 
BACNET_ADDRESS
 * 
c
,

410 
ut32_t
 * 
devi_id
)

412 
Addss_Cache_Ery
 *
pMch
;

413 
bo
 
found
 = 
l
;

415 
pMch
 = 
Addss_Cache
;

416 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

417 i((
pMch
->
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
)) == BAC_ADDR_IN_USE) {

418 i(
	`ba_addss_me
(&
pMch
->
addss
, 
c
)) {

419 i(
devi_id
) {

420 *
devi_id
 = 
pMch
->device_id;

422 
found
 = 
ue
;

426 
pMch
++;

429  
found
;

430 
	}
}

432 
	$addss_add
(

433 
ut32_t
 
devi_id
,

434 
max_du
,

435 
BACNET_ADDRESS
 * 
c
)

437 
bo
 
found
 = 
l
;

438 
Addss_Cache_Ery
 *
pMch
;

440 i(
Own_Devi_ID
 =
devi_id
) {

451 
pMch
 = 
Addss_Cache
;

452 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

453 i(((
pMch
->
Fgs
 & 
BAC_ADDR_IN_USE
) != 0) &&

454 (
pMch
->
devi_id
 == device_id)) {

455 
pMch
->
addss
 = *
c
;

456 
pMch
->
max_du
 = max_apdu;

460 i((
pMch
->
Fgs
 & 
BAC_ADDR_BIND_REQ
) != 0)

461 
pMch
->
TimeToLive
 = 
BAC_ADDR_LONG_TIME
;

462 i((
pMch
->
Fgs
 & 
BAC_ADDR_STATIC
) != 0)

463 
pMch
->
TimeToLive
 = 
BAC_ADDR_FOREVER
;

464 i((
pMch
->
Fgs
 & 
BAC_ADDR_SHORT_TTL
) != 0)

465 
pMch
->
TimeToLive
 = 
BAC_ADDR_SHORT_TIME
;

467 
pMch
->
TimeToLive
 = 
BAC_ADDR_LONG_TIME
;

469 
pMch
->
Fgs
 &~
BAC_ADDR_BIND_REQ
;

470 
found
 = 
ue
;

473 
pMch
++;

477 i(!
found
) {

478 
pMch
 = 
Addss_Cache
;

479 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

480 i((
pMch
->
Fgs
 & 
BAC_ADDR_IN_USE
) == 0) {

481 
pMch
->
Fgs
 = 
BAC_ADDR_IN_USE
;

482 
pMch
->
devi_id
 = device_id;

483 
pMch
->
max_du
 = max_apdu;

484 
pMch
->
addss
 = *
c
;

485 
pMch
->
TimeToLive
 = 
BAC_ADDR_SHORT_TIME
;

486 
found
 = 
ue
;

489 
pMch
++;

494 i(!
found
) {

495 
pMch
 = 
	`addss_move_de
();

496 i(
pMch
 !
NULL
) {

497 
pMch
->
Fgs
 = 
BAC_ADDR_IN_USE
;

498 
pMch
->
devi_id
 = device_id;

499 
pMch
->
max_du
 = max_apdu;

500 
pMch
->
addss
 = *
c
;

501 
pMch
->
TimeToLive
 = 
BAC_ADDR_SHORT_TIME
;

505 
	}
}

509 
bo
 
	$addss_devi_bd_que
(

510 
ut32_t
 
devi_id
,

511 
ut32_t
 * 
devi_l
,

512 *
max_du
,

513 
BACNET_ADDRESS
 * 
c
)

515 
bo
 
found
 = 
l
;

516 
Addss_Cache_Ery
 *
pMch
;

519 
pMch
 = 
Addss_Cache
;

520 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

521 i(((
pMch
->
Fgs
 & 
BAC_ADDR_IN_USE
) != 0) &&

522 (
pMch
->
devi_id
 == device_id)) {

523 i((
pMch
->
Fgs
 & 
BAC_ADDR_BIND_REQ
) == 0) {

524 
found
 = 
ue
;

525 i(
c
) {

526 *
c
 = 
pMch
->
addss
;

528 i(
max_du
) {

529 *
max_du
 = 
pMch
->max_apdu;

531 i(
devi_l
) {

532 *
devi_l
 = 
pMch
->
TimeToLive
;

534 i((
pMch
->
Fgs
 & 
BAC_ADDR_SHORT_TTL
) != 0) {

535 
pMch
->
Fgs
 &~
BAC_ADDR_SHORT_TTL
;

536 
pMch
->
TimeToLive
 = 
BAC_ADDR_LONG_TIME
;

539  (
found
);

541 
pMch
++;

545 
pMch
 = 
Addss_Cache
;

546 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

547 i((
pMch
->
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_RESERVED
)) == 0) {

549 
pMch
->
Fgs
 = (
ut8_t
(
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
);

550 
pMch
->
devi_id
 = device_id;

552 
pMch
->
TimeToLive
 = 
BAC_ADDR_SHORT_TIME
;

554  (
l
);

556 
pMch
++;

560 
pMch
 = 
	`addss_move_de
();

561 i(
pMch
 !
NULL
) {

562 
pMch
->
Fgs
 = (
ut8_t
(
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
);

563 
pMch
->
devi_id
 = device_id;

565 
pMch
->
TimeToLive
 = 
BAC_ADDR_SHORT_TIME
;

567  (
l
);

568 
	}
}

572 
bo
 
	$addss_bd_que
(

573 
ut32_t
 
devi_id
,

574 *
max_du
,

575 
BACNET_ADDRESS
 * 
c
)

577  
	`addss_devi_bd_que
(
devi_id
, 
NULL
, 
max_du
, 
c
);

578 
	}
}

580 
	$addss_add_bdg
(

581 
ut32_t
 
devi_id
,

582 
max_du
,

583 
BACNET_ADDRESS
 * 
c
)

585 
Addss_Cache_Ery
 *
pMch
;

588 
pMch
 = 
Addss_Cache
;

589 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

590 i(((
pMch
->
Fgs
 & 
BAC_ADDR_IN_USE
) != 0) &&

591 (
pMch
->
devi_id
 == device_id)) {

592 
pMch
->
addss
 = *
c
;

593 
pMch
->
max_du
 = max_apdu;

595 
pMch
->
Fgs
 &~
BAC_ADDR_BIND_REQ
;

597 i((
pMch
->
Fgs
 & 
BAC_ADDR_STATIC
) == 0) {

599 
pMch
->
TimeToLive
 = 
BAC_ADDR_LONG_TIME
;

603 
pMch
++;

606 
	}
}

608 
bo
 
	$addss_devi_g_by_dex
(

609 
dex
,

610 
ut32_t
 * 
devi_id
,

611 
ut32_t
 * 
devi_l
,

612 *
max_du
,

613 
BACNET_ADDRESS
 * 
c
)

615 
Addss_Cache_Ery
 *
pMch
;

616 
bo
 
found
 = 
l
;

618 i(
dex
 < 
MAX_ADDRESS_CACHE
) {

619 
pMch
 = &
Addss_Cache
[
dex
];

620 i((
pMch
->
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
)) ==

621 
BAC_ADDR_IN_USE
) {

622 i(
c
) {

623 *
c
 = 
pMch
->
addss
;

625 i(
devi_id
) {

626 *
devi_id
 = 
pMch
->device_id;

628 i(
max_du
) {

629 *
max_du
 = 
pMch
->max_apdu;

631 i(
devi_l
) {

632 *
devi_l
 = 
pMch
->
TimeToLive
;

634 
found
 = 
ue
;

638  
found
;

639 
	}
}

641 
bo
 
	$addss_g_by_dex
(

642 
dex
,

643 
ut32_t
 * 
devi_id
,

644 *
max_du
,

645 
BACNET_ADDRESS
 * 
c
)

647  
	`addss_devi_g_by_dex
(
dex
, 
devi_id
, 
NULL
, 
max_du
, 
c
);

648 
	}
}

650 
	$addss_cou
(

653 
Addss_Cache_Ery
 *
pMch
;

654 
cou
 = 0;

656 
pMch
 = 
Addss_Cache
;

657 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

659 i((
pMch
->
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
)) ==

660 
BAC_ADDR_IN_USE
)

661 
cou
++;

663 
pMch
++;

666  
cou
;

667 
	}
}

674 
	$addss_li_code
(

675 
ut8_t
 * 
du
,

676 
du_n
)

678 
iL
 = 0;

679 
Addss_Cache_Ery
 *
pMch
;

680 
BACNET_OCTET_STRING
 
MAC_Addss
;

685 
du_n
 =pdu_len;

687 
pMch
 = 
Addss_Cache
;

688 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

689 i((
pMch
->
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
)) ==

690 
BAC_ADDR_IN_USE
) {

691 
iL
 +=

692 
	`code_iti_obje_id
(&
du
[
iL
], 
OBJECT_DEVICE
,

693 
pMch
->
devi_id
);

694 
iL
 +=

695 
	`code_iti_unsigd
(&
du
[
iL
], 
pMch
->
addss
.
t
);

699 i(
pMch
->
addss
.
n
 != 0) {

700 
	`org_
(&
MAC_Addss
, 
pMch
->
addss
.
adr
,

701 
pMch
->
addss
.
n
);

702 
iL
 +=

703 
	`code_iti_o_rg
(&
du
[
iL
], &
MAC_Addss
);

705 
	`org_
(&
MAC_Addss
, 
pMch
->
addss
.
mac
,

706 
pMch
->
addss
.
mac_n
);

707 
iL
 +=

708 
	`code_iti_o_rg
(&
du
[
iL
], &
MAC_Addss
);

711 
pMch
++;

714  (
iL
);

715 
	}
}

740 
	#ACACHE_MAX_ENC
 17

	)

742 
	$_addss_li_code
(

743 
ut8_t
 * 
du
,

744 
BACNET_READ_RANGE_DATA
 * 
pReque
)

746 
iL
 = 0;

747 
t32_t
 
iTemp
 = 0;

748 
Addss_Cache_Ery
 *
pMch
 = 
NULL
;

749 
BACNET_OCTET_STRING
 
MAC_Addss
;

750 
ut32_t
 
uiTٮ
 = 0;

751 
ut32_t
 
uiIndex
 = 0;

752 
ut32_t
 
uiF
 = 0;

753 
ut32_t
 
uiLa
 = 0;

754 
ut32_t
 
uiTg
 = 0;

755 
ut32_t
 
uiRemag
 = 0;

758 
	`brg_
(&
pReque
->
ResuFgs
);

759 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_FIRST_ITEM
, 
l
);

760 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_LAST_ITEM
, 
l
);

761 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_MORE_ITEMS
, 
l
);

763 
uiRemag
 = (
ut32_t
(
MAX_APDU
 - 
pReque
->
Ovhd
);

765 
pReque
->
ImCou
 = 0;

766 
uiTٮ
 = 
	`addss_cou
();

767 i(
uiTٮ
 == 0)

770 i(
pReque
->
RequeTy
 =
RR_READ_ALL
) {

776 
pReque
->
Cou
 = 
uiTٮ
;

777 
pReque
->
Rge
.
RefIndex
 = 1;

780 i(
pReque
->
Cou
 < 0) {

794 
iTemp
 = 
pReque
->
Rge
.
RefIndex
;

795 
iTemp
 +
pReque
->
Cou
 + 1;

796 i(
iTemp
 < 1) {

797 
pReque
->
Cou
 =Reque->
Rge
.
RefIndex
;

798 
pReque
->
Rge
.
RefIndex
 = 1;

800 
pReque
->
Rge
.
RefIndex
 = 
iTemp
;

801 
pReque
->
Cou
 = -pRequest->Count;

807 i(
pReque
->
Rge
.
RefIndex
 > 
uiTٮ
)

810 
uiTg
 = 
pReque
->
Rge
.
RefIndex
 +Reque->
Cou
 - 1;

811 i(
uiTg
 > 
uiTٮ
)

812 
uiTg
 = 
uiTٮ
;

814 
pMch
 = 
Addss_Cache
;

815 
uiIndex
 = 1;

816 (
pMch
->
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
)) != BAC_ADDR_IN_USE)

817 
pMch
++;

820 
uiIndex
 !
pReque
->
Rge
.
RefIndex
) {

821 i((
pMch
->
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
)) == BAC_ADDR_IN_USE) {

822 
pMch
++;

823 
uiIndex
++;

825 
pMch
++;

828 
uiF
 = 
uiIndex
;

829 
uiIndex
 <
uiTg
) {

830 i(
uiRemag
 < 
ACACHE_MAX_ENC
) {

835 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_MORE_ITEMS
,

836 
ue
);

840 
iTemp
 =

841 (
t32_t

	`code_iti_obje_id
(&
du
[
iL
], 
OBJECT_DEVICE
,

842 
pMch
->
devi_id
);

843 
iTemp
 +=

844 
	`code_iti_unsigd
(&
du
[
iL
 + 
iTemp
],

845 
pMch
->
addss
.
t
);

849 i(
pMch
->
addss
.
n
 != 0) {

850 
	`org_
(&
MAC_Addss
, 
pMch
->
addss
.
adr
,

851 
pMch
->
addss
.
n
);

852 
iTemp
 +=

853 
	`code_iti_o_rg
(&
du
[
iL
 + 
iTemp
],

854 &
MAC_Addss
);

856 
	`org_
(&
MAC_Addss
, 
pMch
->
addss
.
mac
,

857 
pMch
->
addss
.
mac_n
);

858 
iTemp
 +=

859 
	`code_iti_o_rg
(&
du
[
iL
 + 
iTemp
],

860 &
MAC_Addss
);

863 
uiRemag
 -
iTemp
;

864 
iL
 +
iTemp
;

866 
uiLa
 = 
uiIndex
;

867 
uiIndex
++;

868 
pMch
++;

869 
pReque
->
ImCou
++;

871 (
pMch
->
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_BIND_REQ
)) != BAC_ADDR_IN_USE)

872 
pMch
++;

876 i(
uiF
 == 1)

877 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_FIRST_ITEM
,

878 
ue
);

880 i(
uiLa
 =
uiTٮ
)

881 
	`brg_t_b
(&
pReque
->
ResuFgs
, 
RESULT_FLAG_LAST_ITEM
, 
ue
);

883  (
iL
);

884 
	}
}

893 
	$addss_che_tim
(

894 
ut16_t
 
uSecds
)

896 
Addss_Cache_Ery
 *
pMch
;

898 
pMch
 = 
Addss_Cache
;

899 
pMch
 <&
Addss_Cache
[
MAX_ADDRESS_CACHE
 - 1]) {

900 i(((
pMch
->
Fgs
 & (
BAC_ADDR_IN_USE
 | 
BAC_ADDR_RESERVED
)) != 0)

901 && ((
pMch
->
Fgs
 & 
BAC_ADDR_STATIC
) == 0)) {

902 i(
pMch
->
TimeToLive
 >
uSecds
)

903 
pMch
->
TimeToLive
 -
uSecds
;

905 
pMch
->
Fgs
 = 0;

908 
pMch
++;

910 
	}
}

914 #ifde
TEST


915 
	~<as.h
>

916 
	~<rg.h
>

917 
	~"e.h
"

919 
	$t_addss
(

920 
dex
,

921 
BACNET_ADDRESS
 * 
de
)

923 
i
;

925 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

926 
de
->
mac
[
i
] = 
dex
;

928 
de
->
mac_n
 = 
MAX_MAC_LEN
;

929 
de
->
t
 = 7;

930 
de
->
n
 = 
MAX_MAC_LEN
;

931 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

932 
de
->
adr
[
i
] = 
dex
;

934 
	}
}

936 
	$t_fe_addss
(

937 cڡ *
pFame
,

938 
ut32_t
 
devi_id
,

939 
BACNET_ADDRESS
 * 
de
,

940 
ut16_t
 
max_du
)

942 
i
;

943 
FILE
 *
pFe
 = 
NULL
;

945 
pFe
 = 
	`fݒ
(
pFame
, "w");

947 i(
pFe
) {

948 
	`rtf
(
pFe
, "%lu ", (
devi_id
);

949 
i
 = 0; i < 
de
->
mac_n
; i++) {

950 
	`rtf
(
pFe
, "%02x", 
de
->
mac
[
i
]);

951 i((
i
 + 1< 
de
->
mac_n
) {

952 
	`rtf
(
pFe
, ":");

955 
	`rtf
(
pFe
, " %hu ", 
de
->
t
);

956 i(
de
->
t
) {

957 
i
 = 0; i < 
de
->
n
; i++) {

958 
	`rtf
(
pFe
, "%02x", 
de
->
adr
[
i
]);

959 i((
i
 + 1< 
de
->
n
) {

960 
	`rtf
(
pFe
, ":");

964 
	`rtf
(
pFe
, "0");

966 
	`rtf
(
pFe
, " %hu\n", 
max_du
);

967 
	`fo
(
pFe
);

969 
	}
}

971 
	$AddssFe
(

972 
Te
 * 
pTe
)

974 
BACNET_ADDRESS
 
c
 = { 0 };

975 
ut32_t
 
devi_id
 = 0;

976 
max_du
 = 480;

977 
BACNET_ADDRESS
 
_addss
 = { 0 };

978 
_max_du
 = 0;

981 
devi_id
 = 55555;

982 
c
.
mac_n
 = 1;

983 
c
.
mac
[0] = 25;

984 
c
.
t
 = 0;

985 
c
.
adr
[0] = 0;

986 
max_du
 = 50;

987 
	`t_fe_addss
(
Addss_Cache_Fame
, 
devi_id
, &
c
, 
max_du
);

989 
	`addss_fe_
(
Addss_Cache_Fame
);

990 
	`_
(
pTe
, 
	`addss_g_by_devi
(
devi_id
, &
_max_du
,

991 &
_addss
));

992 
	`_
(
pTe
, 
_max_du
 =
max_du
);

993 
	`_
(
pTe
, 
	`ba_addss_me
(&
_addss
, &
c
));

996 
devi_id
 = 55555;

997 
c
.
mac_n
 = 6;

998 
c
.
mac
[0] = 0xC0;

999 
c
.
mac
[1] = 0xA8;

1000 
c
.
mac
[2] = 0x00;

1001 
c
.
mac
[3] = 0x18;

1002 
c
.
mac
[4] = 0xBA;

1003 
c
.
mac
[5] = 0xC0;

1004 
c
.
t
 = 26001;

1005 
c
.
n
 = 1;

1006 
c
.
adr
[0] = 25;

1007 
max_du
 = 50;

1008 
	`t_fe_addss
(
Addss_Cache_Fame
, 
devi_id
, &
c
, 
max_du
);

1010 
	`addss_fe_
(
Addss_Cache_Fame
);

1011 
	`_
(
pTe
, 
	`addss_g_by_devi
(
devi_id
, &
_max_du
,

1012 &
_addss
));

1013 
	`_
(
pTe
, 
_max_du
 =
max_du
);

1014 
	`_
(
pTe
, 
	`ba_addss_me
(&
_addss
, &
c
));

1016 
	}
}

1018 
	$Addss
(

1019 
Te
 * 
pTe
)

1021 
i
, 
cou
;

1022 
BACNET_ADDRESS
 
c
;

1023 
ut32_t
 
devi_id
 = 0;

1024 
max_du
 = 480;

1025 
BACNET_ADDRESS
 
_addss
;

1026 
ut32_t
 
_devi_id
 = 0;

1027 
_max_du
 = 0;

1030 
i
 = 0; i < 
MAX_ADDRESS_CACHE
; i++) {

1031 
	`t_addss
(
i
, &
c
);

1032 
devi_id
 = 
i
 * 255;

1033 
	`addss_add
(
devi_id
, 
max_du
, &
c
);

1034 
cou
 = 
	`addss_cou
();

1035 
	`_
(
pTe
, 
cou
 =(
i
 + 1));

1038 
i
 = 0; i < 
MAX_ADDRESS_CACHE
; i++) {

1039 
devi_id
 = 
i
 * 255;

1040 
	`t_addss
(
i
, &
c
);

1042 
	`_
(
pTe
, 
	`addss_g_by_devi
(
devi_id
, &
_max_du
,

1043 &
_addss
));

1044 
	`_
(
pTe
, 
_max_du
 =
max_du
);

1045 
	`_
(
pTe
, 
	`ba_addss_me
(&
_addss
, &
c
));

1046 
	`_
(
pTe
, 
	`addss_g_by_dex
(
i
, &
_devi_id
, &
_max_du
,

1047 &
_addss
));

1048 
	`_
(
pTe
, 
_devi_id
 =
devi_id
);

1049 
	`_
(
pTe
, 
_max_du
 =
max_du
);

1050 
	`_
(
pTe
, 
	`ba_addss_me
(&
_addss
, &
c
));

1051 
	`_
(
pTe
, 
	`addss_cou
(=
MAX_ADDRESS_CACHE
);

1053 
	`_
(
pTe
, 
	`addss_g_devi_id
(&
c
, &
_devi_id
));

1054 
	`_
(
pTe
, 
_devi_id
 =
devi_id
);

1057 
i
 = 0; i < 
MAX_ADDRESS_CACHE
; i++) {

1058 
devi_id
 = 
i
 * 255;

1059 
	`addss_move_devi
(
devi_id
);

1060 
	`_
(
pTe
, !
	`addss_g_by_devi
(
devi_id
, &
_max_du
,

1061 &
_addss
));

1062 
cou
 = 
	`addss_cou
();

1063 
	`_
(
pTe
, 
cou
 =(
MAX_ADDRESS_CACHE
 - 
i
 - 1));

1065 
	}
}

1067 #ifde
TEST_ADDRESS


1068 
	$ma
(

1071 
Te
 *
pTe
;

1072 
bo
 
rc
;

1074 
pTe
 = 
	`_
("BACÈAddss", 
NULL
);

1076 
rc
 = 
	`_addTeFuni
(
pTe
, 
Addss
);

1077 
	`as
(
rc
);

1078 
rc
 = 
	`_addTeFuni
(
pTe
, 
AddssFe
);

1079 
	`as
(
rc
);

1082 
	`_tSm
(
pTe
, 
dout
);

1083 
	`_run
(
pTe
);

1084 (
	`_pt
(
pTe
);

1085 
	`_deroy
(
pTe
);

1088 
	}
}

	@src/alarm_ack.c

35 
	~"m_ack.h
"

44 
	$m_ack_code_du
(

45 
ut8_t
 * 
du
,

46 
ut8_t
 
voke_id
,

47 
BACNET_ALARM_ACK_DATA
 * 
da
)

49 
n
 = 0;

50 
du_n
 = 0;

52 i(
du
) {

53 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

54 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

55 
du
[2] = 
voke_id
;

56 
du
[3] = 
SERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
;

57 
du_n
 = 4;

59 
n
 = 
	`m_ack_code_rvi_que
(&
du
[
du_n
], 
da
);

60 
du_n
 +
n
;

63  
du_n
;

64 
	}
}

72 
	$m_ack_code_rvi_que
(

73 
ut8_t
 * 
du
,

74 
BACNET_ALARM_ACK_DATA
 * 
da
)

76 
n
 = 0;

77 
du_n
 = 0;

79 i(
du
) {

80 
n
 =

81 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0,

82 
da
->
ackProssIdtifr
);

83 
du_n
 +
n
;

85 
n
 =

86 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 1,

87 (
da
->
evtObjeIdtifr
.
ty
,

88 
da
->
evtObjeIdtifr
.

);

89 
du_n
 +
n
;

91 
n
 =

92 
	`code_cڋxt_umed
(&
du
[
du_n
], 2,

93 
da
->
evtSAcked
);

94 
du_n
 +
n
;

96 
n
 =

97 
	`ba_code_cڋxt_timeamp
(&
du
[
du_n
], 3,

98 &
da
->
evtTimeSmp
);

99 
du_n
 +
n
;

101 
n
 =

102 
	`code_cڋxt_cha_rg
(&
du
[
du_n
], 4,

103 &
da
->
ackSour
);

104 
du_n
 +
n
;

106 
n
 =

107 
	`ba_code_cڋxt_timeamp
(&
du
[
du_n
], 5,

108 &
da
->
ackTimeSmp
);

109 
du_n
 +
n
;

112  
du_n
;

113 
	}
}

121 
	$m_ack_decode_rvi_que
(

122 
ut8_t
 * 
du
,

123 
du_n
,

124 
BACNET_ALARM_ACK_DATA
 * 
da
)

126 
n
 = 0;

127 
i_n
;

128 
ut32_t
 
umVue
;

131 
du_n
 =pdu_len;

133 i(-1 =(
i_n
 =

134 
	`decode_cڋxt_unsigd
(&
du
[
n
], 0,

135 &
da
->
ackProssIdtifr
))) {

138 
n
 +
i_n
;

140 i(-1 =(
i_n
 =

141 
	`decode_cڋxt_obje_id
(&
du
[
n
], 1,

142 &
da
->
evtObjeIdtifr
.
ty
,

143 &
da
->
evtObjeIdtifr
.

))) {

146 
n
 +
i_n
;

148 i(-1 =(
i_n
 =

149 
	`decode_cڋxt_umed
(&
du
[
n
], 2, &
umVue
))) {

152 
da
->
evtSAcked
 = (
BACNET_EVENT_STATE

umVue
;

153 
n
 +
i_n
;

155 i(-1 =(
i_n
 =

156 
	`ba_decode_cڋxt_timeamp
(&
du
[
n
], 3,

157 &
da
->
evtTimeSmp
))) {

160 
n
 +
i_n
;

162 i(-1 =(
i_n
 =

163 
	`decode_cڋxt_cha_rg
(&
du
[
n
], 4,

164 &
da
->
ackSour
))) {

167 
n
 +
i_n
;

169 i(-1 =(
i_n
 =

170 
	`ba_decode_cڋxt_timeamp
(&
du
[
n
], 5,

171 &
da
->
ackTimeSmp
))) {

174 
n
 +
i_n
;

176  
n
;

177 
	}
}

179 #ifde
TEST


181 
	~<as.h
>

182 
	~<rg.h
>

183 
	~"e.h
"

186 
	$ArmAck
(

187 
Te
 * 
pTe
)

189 
BACNET_ALARM_ACK_DATA
 
ArmAckIn
;

190 
BACNET_ALARM_ACK_DATA
 
ArmAckOut
;

192 
ut8_t
 
bufr
[
MAX_APDU
];

193 
L
;

194 
outL
;

196 
ArmAckIn
.
ackProssIdtifr
 = 0x1234;

197 
	`charg__si
(&
ArmAckIn
.
ackSour
, "This isest");

198 
ArmAckIn
.
ackTimeSmp
.
g
 = 
TIME_STAMP_SEQUENCE
;

199 
ArmAckIn
.
ackTimeSmp
.
vue
.
quNum
 = 0x4331;

200 
ArmAckIn
.
evtObjeIdtifr
.

 = 567;

201 
ArmAckIn
.
evtObjeIdtifr
.
ty
 = 
OBJECT_DEVICE
;

202 
ArmAckIn
.
evtTimeSmp
.
g
 = 
TIME_STAMP_TIME
;

203 
ArmAckIn
.
evtTimeSmp
.
vue
.
time
.
hour
 = 10;

204 
ArmAckIn
.
evtTimeSmp
.
vue
.
time
.
m
 = 11;

205 
ArmAckIn
.
evtTimeSmp
.
vue
.
time
.
c
 = 12;

206 
ArmAckIn
.
evtTimeSmp
.
vue
.
time
.
hunddths
 = 14;

207 
ArmAckIn
.
evtSAcked
 = 
EVENT_STATE_OFFNORMAL
;

209 
	`memt
(&
ArmAckOut
, 0, (testAlarmAckOut));

212 
L
 = 
	`m_ack_code_rvi_que
(
bufr
, &
ArmAckIn
);

213 
outL
 = 
	`m_ack_decode_rvi_que
(
bufr
, 
L
, &
ArmAckOut
);

215 
	`_
(
pTe
, 
L
 =
outL
);

217 
	`_
(
pTe
,

218 
ArmAckIn
.
ackProssIdtifr
 ==

219 
ArmAckOut
.
ackProssIdtifr
);

221 
	`_
(
pTe
,

222 
ArmAckIn
.
ackTimeSmp
.
g
 =
ArmAckOut
.ackTimeStamp.tag);

223 
	`_
(
pTe
,

224 
ArmAckIn
.
ackTimeSmp
.
vue
.
quNum
 ==

225 
ArmAckOut
.
ackTimeSmp
.
vue
.
quNum
);

227 
	`_
(
pTe
,

228 
ArmAckIn
.
ackProssIdtifr
 ==

229 
ArmAckOut
.
ackProssIdtifr
);

231 
	`_
(
pTe
,

232 
ArmAckIn
.
evtObjeIdtifr
.

 ==

233 
ArmAckOut
.
evtObjeIdtifr
.

);

234 
	`_
(
pTe
,

235 
ArmAckIn
.
evtObjeIdtifr
.
ty
 ==

236 
ArmAckOut
.
evtObjeIdtifr
.
ty
);

238 
	`_
(
pTe
,

239 
ArmAckIn
.
evtTimeSmp
.
g
 ==

240 
ArmAckOut
.
evtTimeSmp
.
g
);

241 
	`_
(
pTe
,

242 
ArmAckIn
.
evtTimeSmp
.
vue
.
time
.
hour
 ==

243 
ArmAckOut
.
evtTimeSmp
.
vue
.
time
.
hour
);

244 
	`_
(
pTe
,

245 
ArmAckIn
.
evtTimeSmp
.
vue
.
time
.
m
 ==

246 
ArmAckOut
.
evtTimeSmp
.
vue
.
time
.
m
);

247 
	`_
(
pTe
,

248 
ArmAckIn
.
evtTimeSmp
.
vue
.
time
.
c
 ==

249 
ArmAckOut
.
evtTimeSmp
.
vue
.
time
.
c
);

250 
	`_
(
pTe
,

251 
ArmAckIn
.
evtTimeSmp
.
vue
.
time
.
hunddths
 ==

252 
ArmAckOut
.
evtTimeSmp
.
vue
.
time
.
hunddths
);

254 
	`_
(
pTe
,

255 
ArmAckIn
.
evtSAcked
 =
ArmAckOut
.eventStateAcked);

257 
	}
}

260 #ifde
TEST_ALARM_ACK


261 
	$ma
(

264 
Te
 *
pTe
;

265 
bo
 
rc
;

267 
pTe
 = 
	`_
("BACÈArm Ack", 
NULL
);

269 
rc
 = 
	`_addTeFuni
(
pTe
, 
ArmAck
);

270 
	`as
(
rc
);

272 
	`_tSm
(
pTe
, 
dout
);

273 
	`_run
(
pTe
);

274 (
	`_pt
(
pTe
);

275 
	`_deroy
(
pTe
);

278 
	}
}

	@src/apdu.c

34 
	~<dbo.h
>

35 
	~<dt.h
>

36 
	~<ddef.h
>

37 
	~"bs.h
"

38 
	~"du.h
"

39 
	~"bacdef.h
"

40 
	~"bacdcode.h
"

41 
	~"banum.h
"

42 
	~"tsm.h
"

43 
	~"dcc.h
"

44 
	~"m.h
"

48 
Roud_Devi_Svi_Arov
(

49 
BACNET_CONFIRMED_SERVICE
 
rvi
,

50 
rvi_gumt
,

51 
ut8_t
 * 
du_buff
,

52 
ut8_t
 
voke_id
);

56 
ut16_t
 
	gTimeout_Mlicds
 = 3000;

58 
ut8_t
 
	gNumb_Of_Rrs
 = 3;

61 
BACNET_SERVICES_SUPPORTED


62 
	gcfmed_rvi_su܋d
[
MAX_BACNET_CONFIRMED_SERVICE
] = {

63 
SERVICE_SUPPORTED_ACKNOWLEDGE_ALARM
,

64 
SERVICE_SUPPORTED_CONFIRMED_COV_NOTIFICATION
,

65 
SERVICE_SUPPORTED_CONFIRMED_EVENT_NOTIFICATION
,

66 
SERVICE_SUPPORTED_GET_ALARM_SUMMARY
,

67 
SERVICE_SUPPORTED_GET_ENROLLMENT_SUMMARY
,

68 
SERVICE_SUPPORTED_SUBSCRIBE_COV
,

69 
SERVICE_SUPPORTED_ATOMIC_READ_FILE
,

70 
SERVICE_SUPPORTED_ATOMIC_WRITE_FILE
,

71 
SERVICE_SUPPORTED_ADD_LIST_ELEMENT
,

72 
SERVICE_SUPPORTED_REMOVE_LIST_ELEMENT
,

73 
SERVICE_SUPPORTED_CREATE_OBJECT
,

74 
SERVICE_SUPPORTED_DELETE_OBJECT
,

75 
SERVICE_SUPPORTED_READ_PROPERTY
,

76 
SERVICE_SUPPORTED_READ_PROP_CONDITIONAL
,

77 
SERVICE_SUPPORTED_READ_PROP_MULTIPLE
,

78 
SERVICE_SUPPORTED_WRITE_PROPERTY
,

79 
SERVICE_SUPPORTED_WRITE_PROP_MULTIPLE
,

80 
SERVICE_SUPPORTED_DEVICE_COMMUNICATION_CONTROL
,

81 
SERVICE_SUPPORTED_PRIVATE_TRANSFER
,

82 
SERVICE_SUPPORTED_TEXT_MESSAGE
,

83 
SERVICE_SUPPORTED_REINITIALIZE_DEVICE
,

84 
SERVICE_SUPPORTED_VT_OPEN
,

85 
SERVICE_SUPPORTED_VT_CLOSE
,

86 
SERVICE_SUPPORTED_VT_DATA
,

87 
SERVICE_SUPPORTED_AUTHENTICATE
,

88 
SERVICE_SUPPORTED_REQUEST_KEY
,

89 
SERVICE_SUPPORTED_READ_RANGE
,

90 
SERVICE_SUPPORTED_LIFE_SAFETY_OPERATION
,

91 
SERVICE_SUPPORTED_SUBSCRIBE_COV_PROPERTY
,

92 
SERVICE_SUPPORTED_GET_EVENT_INFORMATION


96 
BACNET_SERVICES_SUPPORTED


97 
	guncfmed_rvi_su܋d
[
MAX_BACNET_UNCONFIRMED_SERVICE
] = {

98 
SERVICE_SUPPORTED_I_AM
,

99 
SERVICE_SUPPORTED_I_HAVE
,

100 
SERVICE_SUPPORTED_UNCONFIRMED_COV_NOTIFICATION
,

101 
SERVICE_SUPPORTED_UNCONFIRMED_EVENT_NOTIFICATION
,

102 
SERVICE_SUPPORTED_UNCONFIRMED_PRIVATE_TRANSFER
,

103 
SERVICE_SUPPORTED_UNCONFIRMED_TEXT_MESSAGE
,

104 
SERVICE_SUPPORTED_TIME_SYNCHRONIZATION
,

105 
SERVICE_SUPPORTED_WHO_HAS
,

106 
SERVICE_SUPPORTED_WHO_IS
,

107 
SERVICE_SUPPORTED_UTC_TIME_SYNCHRONIZATION


112 
cfmed_funi
 
	gCfmed_Funi
[
MAX_BACNET_CONFIRMED_SERVICE
];

114 
	$du_t_cfmed_hdr
(

115 
BACNET_CONFIRMED_SERVICE
 
rvi_choi
,

116 
cfmed_funi
 
pFuni
)

118 i(
rvi_choi
 < 
MAX_BACNET_CONFIRMED_SERVICE
)

119 
Cfmed_Funi
[
rvi_choi
] = 
pFuni
;

120 
	}
}

123 
cfmed_funi
 
	gUecognized_Svi_Hdr
;

125 
	$du_t_uecognized_rvi_hdr_hdr
(

126 
cfmed_funi
 
pFuni
)

128 
Uecognized_Svi_Hdr
 = 
pFuni
;

129 
	}
}

133 
uncfmed_funi


134 
	gUncfmed_Funi
[
MAX_BACNET_UNCONFIRMED_SERVICE
];

136 
	$du_t_uncfmed_hdr
(

137 
BACNET_UNCONFIRMED_SERVICE
 
rvi_choi
,

138 
uncfmed_funi
 
pFuni
)

140 i(
rvi_choi
 < 
MAX_BACNET_UNCONFIRMED_SERVICE
)

141 
Uncfmed_Funi
[
rvi_choi
] = 
pFuni
;

142 
	}
}

144 
bo
 
	$du_rvi_su܋d
(

145 
BACNET_SERVICES_SUPPORTED
 
rvi_su܋d
)

147 
i
 = 0;

148 
bo
 
us
 = 
l
;

149 
bo
 
found
 = 
l
;

151 i(
rvi_su܋d
 < 
MAX_BACNET_SERVICES_SUPPORTED
) {

153 
i
 = 0; i < 
MAX_BACNET_CONFIRMED_SERVICE
; i++) {

154 i(
cfmed_rvi_su܋d
[
i
] =
rvi_su܋d
) {

155 
found
 = 
ue
;

156 i(
Cfmed_Funi
[
i
] !
NULL
) {

157 #i
BAC_ROUTING


159 
n
 =

160 
	`Roud_Devi_Svi_Arov
(
rvi_su܋d
, 0,

161 
NULL
, 0);

162 i(
n
 > 0)

166 
us
 = 
ue
;

172 i(!
found
) {

174 
i
 = 0; i < 
MAX_BACNET_UNCONFIRMED_SERVICE
; i++) {

175 i(
uncfmed_rvi_su܋d
[
i
] =
rvi_su܋d
) {

176 i(
Uncfmed_Funi
[
i
] !
NULL
)

177 
us
 = 
ue
;

183  
us
;

184 
	}
}

196 
bo
 
	$du_rvi_su܋d_to_dex
(

197 
BACNET_SERVICES_SUPPORTED
 
rvi_su܋d
,

198 
size_t
 * 
dex
,

199 
bo
 * 
bIsCfmed
)

201 
i
 = 0;

202 
bo
 
found
 = 
l
;

204 *
bIsCfmed
 = 
l
;

205 i(
rvi_su܋d
 < 
MAX_BACNET_SERVICES_SUPPORTED
) {

207 
i
 = 0; i < 
MAX_BACNET_CONFIRMED_SERVICE
; i++) {

208 i(
cfmed_rvi_su܋d
[
i
] =
rvi_su܋d
) {

209 
found
 = 
ue
;

210 *
dex
 = (
size_t

i
;

211 *
bIsCfmed
 = 
ue
;

216 i(!
found
) {

218 
i
 = 0; i < 
MAX_BACNET_UNCONFIRMED_SERVICE
; i++) {

219 i(
uncfmed_rvi_su܋d
[
i
] =
rvi_su܋d
) {

220 
found
 = 
ue
;

221 *
dex
 = (
size_t

i
;

227  
found
;

228 
	}
}

231 
cfmed_ack_funi


232 
	gCfmed_ACK_Funi
[
MAX_BACNET_CONFIRMED_SERVICE
];

234 
	$du_t_cfmed_sime_ack_hdr
(

235 
BACNET_CONFIRMED_SERVICE
 
rvi_choi
,

236 
cfmed_sime_ack_funi
 
pFuni
)

238 
rvi_choi
) {

239 
SERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
:

240 
SERVICE_CONFIRMED_COV_NOTIFICATION
:

241 
SERVICE_CONFIRMED_EVENT_NOTIFICATION
:

242 
SERVICE_CONFIRMED_SUBSCRIBE_COV
:

243 
SERVICE_CONFIRMED_SUBSCRIBE_COV_PROPERTY
:

244 
SERVICE_CONFIRMED_LIFE_SAFETY_OPERATION
:

246 
SERVICE_CONFIRMED_ADD_LIST_ELEMENT
:

247 
SERVICE_CONFIRMED_REMOVE_LIST_ELEMENT
:

248 
SERVICE_CONFIRMED_DELETE_OBJECT
:

249 
SERVICE_CONFIRMED_WRITE_PROPERTY
:

250 
SERVICE_CONFIRMED_WRITE_PROP_MULTIPLE
:

252 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
:

253 
SERVICE_CONFIRMED_TEXT_MESSAGE
:

254 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
:

256 
SERVICE_CONFIRMED_VT_CLOSE
:

258 
SERVICE_CONFIRMED_REQUEST_KEY
:

259 
Cfmed_ACK_Funi
[
rvi_choi
] =

260 (
cfmed_ack_funi

pFuni
;

265 
	}
}

267 
	$du_t_cfmed_ack_hdr
(

268 
BACNET_CONFIRMED_SERVICE
 
rvi_choi
,

269 
cfmed_ack_funi
 
pFuni
)

271 
rvi_choi
) {

272 
SERVICE_CONFIRMED_GET_ALARM_SUMMARY
:

273 
SERVICE_CONFIRMED_GET_ENROLLMENT_SUMMARY
:

274 
SERVICE_CONFIRMED_GET_EVENT_INFORMATION
:

276 
SERVICE_CONFIRMED_ATOMIC_READ_FILE
:

277 
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
:

279 
SERVICE_CONFIRMED_CREATE_OBJECT
:

280 
SERVICE_CONFIRMED_READ_PROPERTY
:

281 
SERVICE_CONFIRMED_READ_PROP_CONDITIONAL
:

282 
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
:

283 
SERVICE_CONFIRMED_READ_RANGE
:

285 
SERVICE_CONFIRMED_PRIVATE_TRANSFER
:

287 
SERVICE_CONFIRMED_VT_OPEN
:

288 
SERVICE_CONFIRMED_VT_DATA
:

290 
SERVICE_CONFIRMED_AUTHENTICATE
:

291 
Cfmed_ACK_Funi
[
rvi_choi
] = 
pFuni
;

296 
	}
}

298 
r_funi
 
	gE_Funi
[
MAX_BACNET_CONFIRMED_SERVICE
];

300 
	$du_t_r_hdr
(

301 
BACNET_CONFIRMED_SERVICE
 
rvi_choi
,

302 
r_funi
 
pFuni
)

304 i(
rvi_choi
 < 
MAX_BACNET_CONFIRMED_SERVICE
)

305 
E_Funi
[
rvi_choi
] = 
pFuni
;

306 
	}
}

308 
abt_funi
 
	gAbt_Funi
;

310 
	$du_t_abt_hdr
(

311 
abt_funi
 
pFuni
)

313 
Abt_Funi
 = 
pFuni
;

314 
	}
}

316 
je_funi
 
	gReje_Funi
;

318 
	$du_t_je_hdr
(

319 
je_funi
 
pFuni
)

321 
Reje_Funi
 = 
pFuni
;

322 
	}
}

324 
ut16_t
 
	$du_decode_cfmed_rvi_que
(

325 
ut8_t
 * 
du
,

326 
ut16_t
 
du_n
,

327 
BACNET_CONFIRMED_SERVICE_DATA
 * 
rvi_da
,

328 
ut8_t
 * 
rvi_choi
,

329 
ut8_t
 ** 
rvi_que
,

330 
ut16_t
 * 
rvi_que_n
)

332 
ut16_t
 
n
 = 0;

334 
rvi_da
->
gmd_mesge
 = (
du
[0] & 
	`BIT
(3)? 
ue
 : 
l
;

335 
rvi_da
->
me_flows
 = (
du
[0] & 
	`BIT
(2)? 
ue
 : 
l
;

336 
rvi_da
->
gmd_ڣ_aced
 =

337 (
du
[0] & 
	`BIT
(1)? 
ue
 : 
l
;

338 
rvi_da
->
max_gs
 = 
	`decode_max_gs
(
du
[1]);

339 
rvi_da
->
max_
 = 
	`decode_max_du
(
du
[1]);

340 
rvi_da
->
voke_id
 = 
du
[2];

341 
n
 = 3;

342 i(
rvi_da
->
gmd_mesge
) {

343 
rvi_da
->
qu_numb
 = 
du
[
n
++];

344 
rvi_da
->
od_wdow_numb
 = 
du
[
n
++];

346 *
rvi_choi
 = 
du
[
n
++];

347 *
rvi_que
 = &
du
[
n
];

348 *
rvi_que_n
 = 
du_n
 - 
n
;

350  
n
;

351 
	}
}

353 
ut16_t
 
	$du_timeout
(

356  
Timeout_Mlicds
;

357 
	}
}

359 
	$du_timeout_t
(

360 
ut16_t
 
mlicds
)

362 
Timeout_Mlicds
 = 
mlicds
;

363 
	}
}

365 
ut8_t
 
	$du_s
(

368  
Numb_Of_Rrs
;

369 
	}
}

371 
	$du_s_t
(

372 
ut8_t
 
vue
)

374 
Numb_Of_Rrs
 = 
vue
;

375 
	}
}

384 
bo
 
	$du_cfmed_dcc_dibd
(

385 
ut8_t
 
rvi_choi
)

387 
bo
 
us
 = 
l
;

389 i(
	`dcc_communiti_dibd
()) {

390 
rvi_choi
) {

391 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
:

392 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
:

395 
us
 = 
ue
;

400  
us
;

401 
	}
}

410 
bo
 
	$du_uncfmed_dcc_dibd
(

411 
ut8_t
 
rvi_choi
)

413 
bo
 
us
 = 
l
;

415 i(
	`dcc_communiti_dibd
()) {

418 
us
 = 
ue
;

419 } i(
	`dcc_communiti_ti_dibd
()) {

421 
rvi_choi
) {

422 
SERVICE_UNCONFIRMED_WHO_IS
:

425 
us
 = 
ue
;

430  
us
;

431 
	}
}

442 
	$du_hdr
(

443 
BACNET_ADDRESS
 * 
c
,

444 
ut8_t
 * 
du
,

445 
ut16_t
 
du_n
)

447 
BACNET_CONFIRMED_SERVICE_DATA
 
rvi_da
 = { 0 };

448 
BACNET_CONFIRMED_SERVICE_ACK_DATA
 
rvi_ack_da
 = { 0 };

449 
ut8_t
 
voke_id
 = 0;

450 
ut8_t
 
rvi_choi
 = 0;

451 
ut8_t
 *
rvi_que
 = 
NULL
;

452 
ut16_t
 
rvi_que_n
 = 0;

453 
n
 = 0;

454 
ut8_t
 
g_numb
 = 0;

455 
ut32_t
 
n_vue
 = 0;

456 
ut32_t
 
r_code
 = 0;

457 
ut32_t
 
r_ass
 = 0;

458 
ut8_t
 
as
 = 0;

459 
bo
 
rv
 = 
l
;

461 i(
du
) {

463 
du
[0] & 0xF0) {

464 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
:

465 ()
	`du_decode_cfmed_rvi_que
(&
du
[0],

466 
du_n
, &
rvi_da
, &
rvi_choi
, &
rvi_que
,

467 &
rvi_que_n
);

468 i(
	`du_cfmed_dcc_dibd
(
rvi_choi
)) {

474 i((
rvi_choi
 < 
MAX_BACNET_CONFIRMED_SERVICE
) &&

475 (
Cfmed_Funi
[
rvi_choi
]))

476 
Cfmed_Funi
[
rvi_choi
] (
rvi_que
,

477 
rvi_que_n
, 
c
, &
rvi_da
);

478 i(
Uecognized_Svi_Hdr
)

479 
	`Uecognized_Svi_Hdr
(
rvi_que
,

480 
rvi_que_n
, 
c
, &
rvi_da
);

482 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
:

483 
rvi_choi
 = 
du
[1];

484 
rvi_que
 = &
du
[2];

485 
rvi_que_n
 = 
du_n
 - 2;

486 i(
	`du_uncfmed_dcc_dibd
(
rvi_choi
)) {

494 i(
rvi_choi
 < 
MAX_BACNET_UNCONFIRMED_SERVICE
) {

495 i(
Uncfmed_Funi
[
rvi_choi
])

496 
Uncfmed_Funi
[
rvi_choi
] (
rvi_que
,

497 
rvi_que_n
, 
c
);

500 
PDU_TYPE_SIMPLE_ACK
:

501 
voke_id
 = 
du
[1];

502 
rvi_choi
 = 
du
[2];

503 
rvi_choi
) {

504 
SERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
:

505 
SERVICE_CONFIRMED_COV_NOTIFICATION
:

506 
SERVICE_CONFIRMED_EVENT_NOTIFICATION
:

507 
SERVICE_CONFIRMED_SUBSCRIBE_COV
:

508 
SERVICE_CONFIRMED_SUBSCRIBE_COV_PROPERTY
:

509 
SERVICE_CONFIRMED_LIFE_SAFETY_OPERATION
:

511 
SERVICE_CONFIRMED_ADD_LIST_ELEMENT
:

512 
SERVICE_CONFIRMED_REMOVE_LIST_ELEMENT
:

513 
SERVICE_CONFIRMED_DELETE_OBJECT
:

514 
SERVICE_CONFIRMED_WRITE_PROPERTY
:

515 
SERVICE_CONFIRMED_WRITE_PROP_MULTIPLE
:

517 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
:

518 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
:

519 
SERVICE_CONFIRMED_TEXT_MESSAGE
:

521 
SERVICE_CONFIRMED_VT_CLOSE
:

523 
SERVICE_CONFIRMED_REQUEST_KEY
:

524 i(
Cfmed_ACK_Funi
[
rvi_choi
] !
NULL
) {

525 ((
cfmed_sime_ack_funi
)

526 
Cfmed_ACK_Funi
[
rvi_choi
](
c
,

527 
voke_id
);

529 
	`tsm__voke_id
(
voke_id
);

535 
PDU_TYPE_COMPLEX_ACK
:

536 
rvi_ack_da
.
gmd_mesge
 =

537 (
du
[0] & 
	`BIT
(3)? 
ue
 : 
l
;

538 
rvi_ack_da
.
me_flows
 =

539 (
du
[0] & 
	`BIT
(2)? 
ue
 : 
l
;

540 
voke_id
 = 
rvi_ack_da
.voke_id = 
du
[1];

541 
n
 = 2;

542 i(
rvi_ack_da
.
gmd_mesge
) {

543 
rvi_ack_da
.
qu_numb
 = 
du
[
n
++];

544 
rvi_ack_da
.
od_wdow_numb
 = 
du
[
n
++];

546 
rvi_choi
 = 
du
[
n
++];

547 
rvi_que
 = &
du
[
n
];

548 
rvi_que_n
 = 
du_n
 - (
ut16_t

n
;

549 
rvi_choi
) {

550 
SERVICE_CONFIRMED_GET_ALARM_SUMMARY
:

551 
SERVICE_CONFIRMED_GET_ENROLLMENT_SUMMARY
:

552 
SERVICE_CONFIRMED_GET_EVENT_INFORMATION
:

554 
SERVICE_CONFIRMED_ATOMIC_READ_FILE
:

555 
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
:

557 
SERVICE_CONFIRMED_CREATE_OBJECT
:

558 
SERVICE_CONFIRMED_READ_PROPERTY
:

559 
SERVICE_CONFIRMED_READ_PROP_CONDITIONAL
:

560 
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
:

561 
SERVICE_CONFIRMED_READ_RANGE
:

562 
SERVICE_CONFIRMED_PRIVATE_TRANSFER
:

564 
SERVICE_CONFIRMED_VT_OPEN
:

565 
SERVICE_CONFIRMED_VT_DATA
:

567 
SERVICE_CONFIRMED_AUTHENTICATE
:

568 i(
Cfmed_ACK_Funi
[
rvi_choi
] !
NULL
) {

569 (
Cfmed_ACK_Funi
[
rvi_choi
])

570 (
rvi_que
, 
rvi_que_n
, 
c
,

571 &
rvi_ack_da
);

573 
	`tsm__voke_id
(
voke_id
);

579 
PDU_TYPE_SEGMENT_ACK
:

582 
	`tsm__voke_id
(
voke_id
);

584 
PDU_TYPE_ERROR
:

585 
voke_id
 = 
du
[1];

586 
rvi_choi
 = 
du
[2];

587 
n
 = 3;

594 i(
rvi_choi
 =
SERVICE_CONFIRMED_PRIVATE_TRANSFER
) {

595 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 0)) {

596 
n
++;

599 
n
 +=

600 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

601 &
n_vue
);

603 
n
 +
	`decode_umed
(&
du
[n], 
n_vue
, &
r_ass
);

604 
n
 +=

605 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

606 &
n_vue
);

608 
n
 +
	`decode_umed
(&
du
[n], 
n_vue
, &
r_code
);

610 i(
rvi_choi
 =
SERVICE_CONFIRMED_PRIVATE_TRANSFER
) {

611 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 0)) {

612 
n
++;

615 i(
rvi_choi
 < 
MAX_BACNET_CONFIRMED_SERVICE
) {

616 i(
E_Funi
[
rvi_choi
])

617 
E_Funi
[
rvi_choi
] (
c
, 
voke_id
,

618 (
BACNET_ERROR_CLASS

r_ass
,

619 (
BACNET_ERROR_CODE

r_code
);

621 
	`tsm__voke_id
(
voke_id
);

623 
PDU_TYPE_REJECT
:

624 
voke_id
 = 
du
[1];

625 
as
 = 
du
[2];

626 i(
Reje_Funi
)

627 
	`Reje_Funi
(
c
, 
voke_id
, 
as
);

628 
	`tsm__voke_id
(
voke_id
);

630 
PDU_TYPE_ABORT
:

631 
rv
 = 
du
[0] & 0x01;

632 
voke_id
 = 
du
[1];

633 
as
 = 
du
[2];

634 i(
Abt_Funi
)

635 
	`Abt_Funi
(
c
, 
voke_id
, 
as
, 
rv
);

636 
	`tsm__voke_id
(
voke_id
);

643 
	}
}

	@src/arf.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"f.h
"

43 
	$f_code_du
(

44 
ut8_t
 * 
du
,

45 
ut8_t
 
voke_id
,

46 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

48 
du_n
 = 0;

50 i(
du
) {

51 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

52 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

53 
du
[2] = 
voke_id
;

54 
du
[3] = 
SERVICE_CONFIRMED_ATOMIC_READ_FILE
;

55 
du_n
 = 4;

56 
du_n
 +=

57 
	`code_iti_obje_id
(&
du
[
du_n
], 
da
->
obje_ty
,

58 
da
->
obje_
);

59 
da
->
acss
) {

60 
FILE_STREAM_ACCESS
:

61 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 0);

62 
du_n
 +=

63 
	`code_iti_sigd
(&
du
[
du_n
],

64 
da
->
ty
.
am
.
feSPosi
);

65 
du_n
 +=

66 
	`code_iti_unsigd
(&
du
[
du_n
],

67 
da
->
ty
.
am
.
queedOCou
);

68 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 0);

70 
FILE_RECORD_ACCESS
:

71 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 1);

72 
du_n
 +=

73 
	`code_iti_sigd
(&
du
[
du_n
],

74 
da
->
ty
.
cd
.
feSRecd
);

75 
du_n
 +=

76 
	`code_iti_unsigd
(&
du
[
du_n
],

77 
da
->
ty
.
cd
.
RecdCou
);

78 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 1);

85  
du_n
;

86 
	}
}

89 
	$f_decode_rvi_que
(

90 
ut8_t
 * 
du
,

91 
du_n
,

92 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

94 
n
 = 0;

95 
g_n
 = 0;

96 
ut8_t
 
g_numb
 = 0;

97 
ut32_t
 
n_vue_ty
 = 0;

98 
ut16_t
 
ty
 = 0;

101 i(
du_n
 && 
da
) {

102 
n
 =

103 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
,

104 &
n_vue_ty
);

105 i(
g_numb
 !
BACNET_APPLICATION_TAG_OBJECT_ID
)

107 
n
 +
	`decode_obje_id
(&
du
[n], &
ty
, &
da
->
obje_
);

108 
da
->
obje_ty
 = (
BACNET_OBJECT_TYPE

ty
;

109 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 0)) {

110 
da
->
acss
 = 
FILE_STREAM_ACCESS
;

112 
n
++;

114 
g_n
 =

115 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

116 &
n_vue_ty
);

117 
n
 +
g_n
;

118 i(
g_numb
 !
BACNET_APPLICATION_TAG_SIGNED_INT
)

120 
n
 +=

121 
	`decode_sigd
(&
du
[
n
], 
n_vue_ty
,

122 &
da
->
ty
.
am
.
feSPosi
);

124 
g_n
 =

125 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

126 &
n_vue_ty
);

127 
n
 +
g_n
;

128 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
)

130 
n
 +=

131 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
,

132 &
da
->
ty
.
am
.
queedOCou
);

133 i(!
	`decode_is_osg_g_numb
(&
du
[
n
], 0))

136 
n
++;

137 } i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 1)) {

138 
da
->
acss
 = 
FILE_RECORD_ACCESS
;

140 
n
++;

142 
g_n
 =

143 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

144 &
n_vue_ty
);

145 
n
 +
g_n
;

146 i(
g_numb
 !
BACNET_APPLICATION_TAG_SIGNED_INT
)

148 
n
 +=

149 
	`decode_sigd
(&
du
[
n
], 
n_vue_ty
,

150 &
da
->
ty
.
cd
.
feSRecd
);

152 
g_n
 =

153 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

154 &
n_vue_ty
);

155 
n
 +
g_n
;

156 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
)

158 
n
 +=

159 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
,

160 &
da
->
ty
.
cd
.
RecdCou
);

161 i(!
	`decode_is_osg_g_numb
(&
du
[
n
], 1))

164 
n
++;

169  
n
;

170 
	}
}

172 
	$f_decode_du
(

173 
ut8_t
 * 
du
,

174 
du_n
,

175 
ut8_t
 * 
voke_id
,

176 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

178 
n
 = 0;

179 
offt
 = 0;

181 i(!
du
)

184 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

187 *
voke_id
 = 
du
[2];

188 i(
du
[3] !
SERVICE_CONFIRMED_ATOMIC_READ_FILE
)

190 
offt
 = 4;

192 i(
du_n
 > 
offt
) {

193 
n
 =

194 
	`f_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offt, 
da
);

197  
n
;

198 
	}
}

201 
	$f_ack_code_du
(

202 
ut8_t
 * 
du
,

203 
ut8_t
 
voke_id
,

204 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

206 
du_n
 = 0;

208 i(
du
) {

209 
du
[0] = 
PDU_TYPE_COMPLEX_ACK
;

210 
du
[1] = 
voke_id
;

211 
du
[2] = 
SERVICE_CONFIRMED_ATOMIC_READ_FILE
;

212 
du_n
 = 3;

214 
du_n
 +=

215 
	`code_iti_boޗn
(&
du
[
du_n
], 
da
->
dOfFe
);

216 
da
->
acss
) {

217 
FILE_STREAM_ACCESS
:

218 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 0);

219 
du_n
 +=

220 
	`code_iti_sigd
(&
du
[
du_n
],

221 
da
->
ty
.
am
.
feSPosi
);

222 
du_n
 +=

223 
	`code_iti_o_rg
(&
du
[
du_n
],

224 &
da
->
feDa
);

225 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 0);

227 
FILE_RECORD_ACCESS
:

228 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 1);

229 
du_n
 +=

230 
	`code_iti_sigd
(&
du
[
du_n
],

231 
da
->
ty
.
cd
.
feSRecd
);

232 
du_n
 +=

233 
	`code_iti_unsigd
(&
du
[
du_n
],

234 
da
->
ty
.
cd
.
RecdCou
);

235 
du_n
 +=

236 
	`code_iti_o_rg
(&
du
[
du_n
],

237 &
da
->
feDa
);

238 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 1);

245  
du_n
;

246 
	}
}

249 
	$f_ack_decode_rvi_que
(

250 
ut8_t
 * 
du
,

251 
du_n
,

252 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

254 
n
 = 0;

255 
g_n
 = 0;

256 
decoded_n
 = 0;

257 
ut8_t
 
g_numb
 = 0;

258 
ut32_t
 
n_vue_ty
 = 0;

261 i(
du_n
 && 
da
) {

262 
n
 =

263 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
,

264 &
n_vue_ty
);

265 i(
g_numb
 !
BACNET_APPLICATION_TAG_BOOLEAN
) {

268 
da
->
dOfFe
 = 
	`decode_boޗn
(
n_vue_ty
);

269 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 0)) {

270 
da
->
acss
 = 
FILE_STREAM_ACCESS
;

272 
n
++;

274 
g_n
 =

275 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

276 &
n_vue_ty
);

277 
n
 +
g_n
;

278 i(
g_numb
 !
BACNET_APPLICATION_TAG_SIGNED_INT
) {

281 
n
 +=

282 
	`decode_sigd
(&
du
[
n
], 
n_vue_ty
,

283 &
da
->
ty
.
am
.
feSPosi
);

285 
g_n
 =

286 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

287 &
n_vue_ty
);

288 
n
 +
g_n
;

289 i(
g_numb
 !
BACNET_APPLICATION_TAG_OCTET_STRING
) {

292 
decoded_n
 =

293 
	`decode_o_rg
(&
du
[
n
], 
n_vue_ty
,

294 &
da
->
feDa
);

295 i((
ut32_t
)
decoded_n
 !
n_vue_ty
) {

298 
n
 +
decoded_n
;

299 i(!
	`decode_is_osg_g_numb
(&
du
[
n
], 0)) {

303 
n
++;

304 } i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 1)) {

305 
da
->
acss
 = 
FILE_RECORD_ACCESS
;

307 
n
++;

309 
g_n
 =

310 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

311 &
n_vue_ty
);

312 
n
 +
g_n
;

313 i(
g_numb
 !
BACNET_APPLICATION_TAG_SIGNED_INT
) {

316 
n
 +=

317 
	`decode_sigd
(&
du
[
n
], 
n_vue_ty
,

318 &
da
->
ty
.
cd
.
feSRecd
);

320 
g_n
 =

321 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

322 &
n_vue_ty
);

323 
n
 +
g_n
;

324 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

327 
n
 +=

328 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
,

329 &
da
->
ty
.
cd
.
RecdCou
);

331 
g_n
 =

332 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

333 &
n_vue_ty
);

334 
n
 +
g_n
;

335 i(
g_numb
 !
BACNET_APPLICATION_TAG_OCTET_STRING
)

337 
n
 +=

338 
	`decode_o_rg
(&
du
[
n
], 
n_vue_ty
,

339 &
da
->
feDa
);

340 i(!
	`decode_is_osg_g_numb
(&
du
[
n
], 1)) {

344 
n
++;

350  
n
;

351 
	}
}

353 
	$f_ack_decode_du
(

354 
ut8_t
 * 
du
,

355 
du_n
,

356 
ut8_t
 * 
voke_id
,

357 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

359 
n
 = 0;

360 
offt
 = 0;

362 i(!
du
)

365 i(
du
[0] !
PDU_TYPE_COMPLEX_ACK
)

367 *
voke_id
 = 
du
[1];

368 i(
du
[2] !
SERVICE_CONFIRMED_ATOMIC_READ_FILE
)

370 
offt
 = 3;

372 i(
du_n
 > 
offt
) {

373 
n
 =

374 
	`f_ack_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

375 
da
);

378  
n
;

379 
	}
}

382 #ifde
TEST


383 
	~<as.h
>

384 
	~<rg.h
>

385 
	~"e.h
"

387 
	$AtomicRdFeAckAcss
(

388 
Te
 * 
pTe
,

389 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

391 
BACNET_ATOMIC_READ_FILE_DATA
 
_da
 = { 0 };

392 
ut8_t
 
du
[480] = { 0 };

393 
n
 = 0;

394 
du_n
 = 0;

395 
ut8_t
 
voke_id
 = 128;

396 
ut8_t
 
_voke_id
 = 0;

398 
n
 = 
	`f_ack_code_du
(&
du
[0], 
voke_id
, 
da
);

399 
	`_
(
pTe
, 
n
 != 0);

400 
du_n
 = 
n
;

402 
n
 = 
	`f_ack_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
_da
);

403 
	`_
(
pTe
, 
n
 != -1);

404 
	`_
(
pTe
, 
_da
.
dOfFe
 =
da
->endOfFile);

405 
	`_
(
pTe
, 
_da
.
acss
 =
da
->access);

406 i(
_da
.
acss
 =
FILE_STREAM_ACCESS
) {

407 
	`_
(
pTe
,

408 
_da
.
ty
.
am
.
feSPosi
 ==

409 
da
->
ty
.
am
.
feSPosi
);

410 } i(
_da
.
acss
 =
FILE_RECORD_ACCESS
) {

411 
	`_
(
pTe
,

412 
_da
.
ty
.
cd
.
feSRecd
 ==

413 
da
->
ty
.
cd
.
feSRecd
);

414 
	`_
(
pTe
,

415 
_da
.
ty
.
cd
.
RecdCou
 ==

416 
da
->
ty
.
cd
.
RecdCou
);

418 
	`_
(
pTe
,

419 
	`org_ngth
(&
_da
.
feDa
) ==

420 
	`org_ngth
(&
da
->
feDa
));

421 
	`_
(
pTe
, 
	`memcmp
(
	`org_vue
(&
_da
.
feDa
),

422 
	`org_vue
(&
da
->
feDa
),

423 
	`org_ngth
(&
_da
.
feDa
)) == 0);

424 
	}
}

426 
	$AtomicRdFeAck
(

427 
Te
 * 
pTe
)

429 
BACNET_ATOMIC_READ_FILE_DATA
 
da
 = { 0 };

430 
ut8_t
 
_o_rg
[32] = "Joshua-Mary-Anna-Christopher";

433 
da
.
dOfFe
 = 
ue
;

434 
da
.
acss
 = 
FILE_STREAM_ACCESS
;

435 
da
.
ty
.
am
.
feSPosi
 = 0;

436 
	`org_
(&
da
.
feDa
, 
_o_rg
,

437 (
_o_rg
));

438 
	`AtomicRdFeAckAcss
(
pTe
, &
da
);

440 
da
.
dOfFe
 = 
l
;

441 
da
.
acss
 = 
FILE_RECORD_ACCESS
;

442 
da
.
ty
.
cd
.
feSRecd
 = 1;

443 
da
.
ty
.
cd
.
RecdCou
 = 2;

444 
	`org_
(&
da
.
feDa
, 
_o_rg
,

445 (
_o_rg
));

446 
	`AtomicRdFeAckAcss
(
pTe
, &
da
);

449 
	}
}

451 
	$AtomicRdFeAcss
(

452 
Te
 * 
pTe
,

453 
BACNET_ATOMIC_READ_FILE_DATA
 * 
da
)

455 
BACNET_ATOMIC_READ_FILE_DATA
 
_da
 = { 0 };

456 
ut8_t
 
du
[480] = { 0 };

457 
n
 = 0;

458 
du_n
 = 0;

459 
ut8_t
 
voke_id
 = 128;

460 
ut8_t
 
_voke_id
 = 0;

462 
n
 = 
	`f_code_du
(&
du
[0], 
voke_id
, 
da
);

463 
	`_
(
pTe
, 
n
 != 0);

464 
du_n
 = 
n
;

466 
n
 = 
	`f_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
_da
);

467 
	`_
(
pTe
, 
n
 != -1);

468 
	`_
(
pTe
, 
_da
.
obje_ty
 =
da
->object_type);

469 
	`_
(
pTe
, 
_da
.
obje_
 =
da
->object_instance);

470 
	`_
(
pTe
, 
_da
.
acss
 =
da
->access);

471 i(
_da
.
acss
 =
FILE_STREAM_ACCESS
) {

472 
	`_
(
pTe
,

473 
_da
.
ty
.
am
.
feSPosi
 ==

474 
da
->
ty
.
am
.
feSPosi
);

475 
	`_
(
pTe
,

476 
_da
.
ty
.
am
.
queedOCou
 ==

477 
da
->
ty
.
am
.
queedOCou
);

478 } i(
_da
.
acss
 =
FILE_RECORD_ACCESS
) {

479 
	`_
(
pTe
,

480 
_da
.
ty
.
cd
.
feSRecd
 ==

481 
da
->
ty
.
cd
.
feSRecd
);

482 
	`_
(
pTe
,

483 
_da
.
ty
.
cd
.
RecdCou
 ==

484 
da
->
ty
.
cd
.
RecdCou
);

486 
	}
}

488 
	$AtomicRdFe
(

489 
Te
 * 
pTe
)

491 
BACNET_ATOMIC_READ_FILE_DATA
 
da
 = { 0 };

493 
da
.
obje_ty
 = 
OBJECT_FILE
;

494 
da
.
obje_
 = 1;

495 
da
.
acss
 = 
FILE_STREAM_ACCESS
;

496 
da
.
ty
.
am
.
feSPosi
 = 0;

497 
da
.
ty
.
am
.
queedOCou
 = 128;

498 
	`AtomicRdFeAcss
(
pTe
, &
da
);

500 
da
.
obje_ty
 = 
OBJECT_FILE
;

501 
da
.
obje_
 = 2;

502 
da
.
acss
 = 
FILE_RECORD_ACCESS
;

503 
da
.
ty
.
cd
.
feSRecd
 = 1;

504 
da
.
ty
.
cd
.
RecdCou
 = 2;

505 
	`AtomicRdFeAcss
(
pTe
, &
da
);

508 
	}
}

510 #ifde
TEST_ATOMIC_READ_FILE


511 
	$ma
(

514 
Te
 *
pTe
;

515 
bo
 
rc
;

517 
pTe
 = 
	`_
("BACÈAtomicRdFe", 
NULL
);

519 
rc
 = 
	`_addTeFuni
(
pTe
, 
AtomicRdFe
);

520 
	`as
(
rc
);

521 
rc
 = 
	`_addTeFuni
(
pTe
, 
AtomicRdFeAck
);

522 
	`as
(
rc
);

524 
	`_tSm
(
pTe
, 
dout
);

525 
	`_run
(
pTe
);

526 (
	`_pt
(
pTe
);

527 
	`_deroy
(
pTe
);

530 
	}
}

	@src/awf.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"awf.h
"

43 
	$awf_code_du
(

44 
ut8_t
 * 
du
,

45 
ut8_t
 
voke_id
,

46 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
)

48 
du_n
 = 0;

50 i(
du
) {

51 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

52 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

53 
du
[2] = 
voke_id
;

54 
du
[3] = 
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
;

55 
du_n
 = 4;

56 
du_n
 +=

57 
	`code_iti_obje_id
(&
du
[
du_n
], 
da
->
obje_ty
,

58 
da
->
obje_
);

59 
da
->
acss
) {

60 
FILE_STREAM_ACCESS
:

61 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 0);

62 
du_n
 +=

63 
	`code_iti_sigd
(&
du
[
du_n
],

64 
da
->
ty
.
am
.
feSPosi
);

65 
du_n
 +=

66 
	`code_iti_o_rg
(&
du
[
du_n
],

67 &
da
->
feDa
);

68 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 0);

70 
FILE_RECORD_ACCESS
:

71 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 1);

72 
du_n
 +=

73 
	`code_iti_sigd
(&
du
[
du_n
],

74 
da
->
ty
.
cd
.
feSRecd
);

75 
du_n
 +=

76 
	`code_iti_unsigd
(&
du
[
du_n
],

77 
da
->
ty
.
cd
.
tuedRecdCou
);

78 
du_n
 +=

79 
	`code_iti_o_rg
(&
du
[
du_n
],

80 &
da
->
feDa
);

81 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 1);

88  
du_n
;

89 
	}
}

92 
	$awf_decode_rvi_que
(

93 
ut8_t
 * 
du
,

94 
du_n
,

95 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
)

97 
n
 = 0;

98 
g_n
 = 0;

99 
decoded_n
 = 0;

100 
ut8_t
 
g_numb
 = 0;

101 
ut32_t
 
n_vue_ty
 = 0;

102 
t32_t
 
sigd_vue
 = 0;

103 
ut32_t
 
unsigd_vue
 = 0;

104 
ut16_t
 
ty
 = 0;

107 i(
du_n
 && 
da
) {

108 
n
 =

109 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
,

110 &
n_vue_ty
);

111 i(
g_numb
 !
BACNET_APPLICATION_TAG_OBJECT_ID
)

113 
n
 +
	`decode_obje_id
(&
du
[n], &
ty
, &
da
->
obje_
);

114 
da
->
obje_ty
 = (
BACNET_OBJECT_TYPE

ty
;

115 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 0)) {

116 
da
->
acss
 = 
FILE_STREAM_ACCESS
;

118 
n
++;

120 
g_n
 =

121 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

122 &
n_vue_ty
);

123 
n
 +
g_n
;

124 i(
g_numb
 !
BACNET_APPLICATION_TAG_SIGNED_INT
)

126 
n
 +
	`decode_sigd
(&
du
[n], 
n_vue_ty
, &
sigd_vue
);

127 
da
->
ty
.
am
.
feSPosi
 = 
sigd_vue
;

129 
g_n
 =

130 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

131 &
n_vue_ty
);

132 
n
 +
g_n
;

133 i(
g_numb
 !
BACNET_APPLICATION_TAG_OCTET_STRING
)

135 
decoded_n
 =

136 
	`decode_o_rg
(&
du
[
n
], 
n_vue_ty
,

137 &
da
->
feDa
);

138 i((
ut32_t
)
decoded_n
 !
n_vue_ty
) {

141 
n
 +
decoded_n
;

142 i(!
	`decode_is_osg_g_numb
(&
du
[
n
], 0))

145 
n
++;

146 } i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 1)) {

147 
da
->
acss
 = 
FILE_RECORD_ACCESS
;

149 
n
++;

151 
g_n
 =

152 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

153 &
n_vue_ty
);

154 
n
 +
g_n
;

155 i(
g_numb
 !
BACNET_APPLICATION_TAG_SIGNED_INT
)

157 
n
 +
	`decode_sigd
(&
du
[n], 
n_vue_ty
, &
sigd_vue
);

158 
da
->
ty
.
cd
.
feSRecd
 = 
sigd_vue
;

160 
g_n
 =

161 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

162 &
n_vue_ty
);

163 
n
 +
g_n
;

164 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
)

166 
n
 +=

167 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
, &
unsigd_vue
);

168 
da
->
ty
.
cd
.
tuedRecdCou
 = 
unsigd_vue
;

170 
g_n
 =

171 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

172 &
n_vue_ty
);

173 
n
 +
g_n
;

174 i(
g_numb
 !
BACNET_APPLICATION_TAG_OCTET_STRING
)

176 
decoded_n
 =

177 
	`decode_o_rg
(&
du
[
n
], 
n_vue_ty
,

178 &
da
->
feDa
);

179 i((
ut32_t
)
decoded_n
 !
n_vue_ty
) {

182 
n
 +
decoded_n
;

183 i(!
	`decode_is_osg_g_numb
(&
du
[
n
], 1))

186 
n
++;

191  
n
;

192 
	}
}

194 
	$awf_decode_du
(

195 
ut8_t
 * 
du
,

196 
du_n
,

197 
ut8_t
 * 
voke_id
,

198 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
)

200 
n
 = 0;

201 
offt
 = 0;

203 i(!
du
)

206 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

209 *
voke_id
 = 
du
[2];

210 i(
du
[3] !
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
)

212 
offt
 = 4;

214 i(
du_n
 > 
offt
) {

215 
n
 =

216 
	`awf_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offt, 
da
);

219  
n
;

220 
	}
}

222 
	$awf_ack_code_du
(

223 
ut8_t
 * 
du
,

224 
ut8_t
 
voke_id
,

225 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
)

227 
du_n
 = 0;

229 i(
du
) {

230 
du
[0] = 
PDU_TYPE_COMPLEX_ACK
;

231 
du
[1] = 
voke_id
;

232 
du
[2] = 
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
;

233 
du_n
 = 3;

234 
da
->
acss
) {

235 
FILE_STREAM_ACCESS
:

236 
du_n
 +=

237 
	`code_cڋxt_sigd
(&
du
[
du_n
], 0,

238 
da
->
ty
.
am
.
feSPosi
);

240 
FILE_RECORD_ACCESS
:

241 
du_n
 +=

242 
	`code_cڋxt_sigd
(&
du
[
du_n
], 1,

243 
da
->
ty
.
cd
.
feSRecd
);

250  
du_n
;

251 
	}
}

254 
	$awf_ack_decode_rvi_que
(

255 
ut8_t
 * 
du
,

256 
du_n
,

257 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
)

259 
n
 = 0;

260 
ut8_t
 
g_numb
 = 0;

261 
ut32_t
 
n_vue_ty
 = 0;

264 i(
du_n
 && 
da
) {

265 
n
 =

266 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
,

267 &
n_vue_ty
);

268 i(
g_numb
 == 0) {

269 
da
->
acss
 = 
FILE_STREAM_ACCESS
;

270 
n
 +=

271 
	`decode_sigd
(&
du
[
n
], 
n_vue_ty
,

272 &
da
->
ty
.
am
.
feSPosi
);

273 } i(
g_numb
 == 1) {

274 
da
->
acss
 = 
FILE_RECORD_ACCESS
;

275 
n
 +=

276 
	`decode_sigd
(&
du
[
n
], 
n_vue_ty
,

277 &
da
->
ty
.
cd
.
feSRecd
);

282  
n
;

283 
	}
}

285 
	$awf_ack_decode_du
(

286 
ut8_t
 * 
du
,

287 
du_n
,

288 
ut8_t
 * 
voke_id
,

289 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
)

291 
n
 = 0;

292 
offt
 = 0;

294 i(!
du
)

297 i(
du
[0] !
PDU_TYPE_COMPLEX_ACK
)

299 *
voke_id
 = 
du
[1];

300 i(
du
[2] !
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
)

302 
offt
 = 3;

304 i(
du_n
 > 
offt
) {

305 
n
 =

306 
	`awf_ack_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

307 
da
);

310  
n
;

311 
	}
}

313 #ifde
TEST


314 
	~<as.h
>

315 
	~<rg.h
>

316 
	~"e.h
"

318 
	$AtomicWreFeAcss
(

319 
Te
 * 
pTe
,

320 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
)

322 
BACNET_ATOMIC_WRITE_FILE_DATA
 
_da
 = { 0 };

323 
ut8_t
 
du
[480] = { 0 };

324 
n
 = 0;

325 
du_n
 = 0;

326 
ut8_t
 
voke_id
 = 128;

327 
ut8_t
 
_voke_id
 = 0;

329 
n
 = 
	`awf_code_du
(&
du
[0], 
voke_id
, 
da
);

330 
	`_
(
pTe
, 
n
 != 0);

331 
du_n
 = 
n
;

333 
n
 = 
	`awf_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
_da
);

334 
	`_
(
pTe
, 
n
 != -1);

335 
	`_
(
pTe
, 
_da
.
obje_ty
 =
da
->object_type);

336 
	`_
(
pTe
, 
_da
.
obje_
 =
da
->object_instance);

337 
	`_
(
pTe
, 
_da
.
acss
 =
da
->access);

338 i(
_da
.
acss
 =
FILE_STREAM_ACCESS
) {

339 
	`_
(
pTe
,

340 
_da
.
ty
.
am
.
feSPosi
 ==

341 
da
->
ty
.
am
.
feSPosi
);

342 } i(
_da
.
acss
 =
FILE_RECORD_ACCESS
) {

343 
	`_
(
pTe
,

344 
_da
.
ty
.
cd
.
feSRecd
 ==

345 
da
->
ty
.
cd
.
feSRecd
);

346 
	`_
(
pTe
,

347 
_da
.
ty
.
cd
.
tuedRecdCou
 ==

348 
da
->
ty
.
cd
.
tuedRecdCou
);

350 
	`_
(
pTe
,

351 
	`org_ngth
(&
_da
.
feDa
) ==

352 
	`org_ngth
(&
da
->
feDa
));

353 
	`_
(
pTe
, 
	`memcmp
(
	`org_vue
(&
_da
.
feDa
),

354 
	`org_vue
(&
da
->
feDa
),

355 
	`org_ngth
(&
_da
.
feDa
)) == 0);

356 
	}
}

358 
	$AtomicWreFe
(

359 
Te
 * 
pTe
)

361 
BACNET_ATOMIC_WRITE_FILE_DATA
 
da
 = { 0 };

362 
ut8_t
 
_o_rg
[32] = "Joshua-Mary-Anna-Christopher";

364 
da
.
obje_ty
 = 
OBJECT_FILE
;

365 
da
.
obje_
 = 1;

366 
da
.
acss
 = 
FILE_STREAM_ACCESS
;

367 
da
.
ty
.
am
.
feSPosi
 = 0;

368 
	`org_
(&
da
.
feDa
, 
_o_rg
,

369 (
_o_rg
));

370 
	`AtomicWreFeAcss
(
pTe
, &
da
);

372 
da
.
obje_ty
 = 
OBJECT_FILE
;

373 
da
.
obje_
 = 1;

374 
da
.
acss
 = 
FILE_RECORD_ACCESS
;

375 
da
.
ty
.
cd
.
feSRecd
 = 1;

376 
da
.
ty
.
cd
.
tuedRecdCou
 = 2;

377 
	`org_
(&
da
.
feDa
, 
_o_rg
,

378 (
_o_rg
));

379 
	`AtomicWreFeAcss
(
pTe
, &
da
);

382 
	}
}

384 
	$AtomicWreFeAckAcss
(

385 
Te
 * 
pTe
,

386 
BACNET_ATOMIC_WRITE_FILE_DATA
 * 
da
)

388 
BACNET_ATOMIC_WRITE_FILE_DATA
 
_da
 = { 0 };

389 
ut8_t
 
du
[480] = { 0 };

390 
n
 = 0;

391 
du_n
 = 0;

392 
ut8_t
 
voke_id
 = 128;

393 
ut8_t
 
_voke_id
 = 0;

395 
n
 = 
	`awf_code_du
(&
du
[0], 
voke_id
, 
da
);

396 
	`_
(
pTe
, 
n
 != 0);

397 
du_n
 = 
n
;

399 
n
 = 
	`awf_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
_da
);

400 
	`_
(
pTe
, 
n
 != -1);

401 
	`_
(
pTe
, 
_da
.
acss
 =
da
->access);

402 i(
_da
.
acss
 =
FILE_STREAM_ACCESS
) {

403 
	`_
(
pTe
,

404 
_da
.
ty
.
am
.
feSPosi
 ==

405 
da
->
ty
.
am
.
feSPosi
);

406 } i(
_da
.
acss
 =
FILE_RECORD_ACCESS
) {

407 
	`_
(
pTe
,

408 
_da
.
ty
.
cd
.
feSRecd
 ==

409 
da
->
ty
.
cd
.
feSRecd
);

411 
	}
}

413 
	$AtomicWreFeAck
(

414 
Te
 * 
pTe
)

416 
BACNET_ATOMIC_WRITE_FILE_DATA
 
da
 = { 0 };

418 
da
.
acss
 = 
FILE_STREAM_ACCESS
;

419 
da
.
ty
.
am
.
feSPosi
 = 42;

420 
	`AtomicWreFeAckAcss
(
pTe
, &
da
);

422 
da
.
acss
 = 
FILE_RECORD_ACCESS
;

423 
da
.
ty
.
cd
.
feSRecd
 = 54;

424 
	`AtomicWreFeAckAcss
(
pTe
, &
da
);

427 
	}
}

429 #ifde
TEST_ATOMIC_WRITE_FILE


430 
	$ma
(

433 
Te
 *
pTe
;

434 
bo
 
rc
;

436 
pTe
 = 
	`_
("BACÈAtomicWreFe", 
NULL
);

438 
rc
 = 
	`_addTeFuni
(
pTe
, 
AtomicWreFe
);

439 
	`as
(
rc
);

440 
rc
 = 
	`_addTeFuni
(
pTe
, 
AtomicWreFeAck
);

441 
	`as
(
rc
);

443 
	`_tSm
(
pTe
, 
dout
);

444 
	`_run
(
pTe
);

445 (
	`_pt
(
pTe
);

446 
	`_deroy
(
pTe
);

449 
	}
}

	@src/bacaddr.c

34 
	~<ddef.h
>

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~"cfig.h
"

38 
	~"bacdef.h
"

39 
	~"baddr.h
"

43 
	$ba_addss_cy
(

44 
BACNET_ADDRESS
 * 
de
,

45 
BACNET_ADDRESS
 * 
c
)

47 
i
 = 0;

49 i(
de
 && 
c
) {

50 
de
->
mac_n
 = 
c
->mac_len;

51 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

52 
de
->
mac
[
i
] = 
c
->mac[i];

54 
de
->
t
 = 
c
->net;

55 
de
->
n
 = 
c
->len;

56 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

57 
de
->
adr
[
i
] = 
c
->adr[i];

60 
	}
}

62 
bo
 
	$ba_addss_me
(

63 
BACNET_ADDRESS
 * 
de
,

64 
BACNET_ADDRESS
 * 
c
)

66 
ut8_t
 
i
 = 0;

67 
ut8_t
 
max_n
 = 0;

69 i(
de
 =
c
)

70  
ue
;

72 i(
de
->
t
 !
c
->net)

73  
l
;

75 i(
de
->
n
 !
c
->len)

76  
l
;

78 
max_n
 = 
de
->
n
;

79 i(
max_n
 > 
MAX_MAC_LEN
)

80 
max_n
 = 
MAX_MAC_LEN
;

81 
i
 = 0; i < 
max_n
; i++) {

82 i(
de
->
adr
[
i
] !
c
->adr[i])

83  
l
;

85 i(
de
->
t
 == 0) {

86 i(
de
->
mac_n
 !
c
->mac_len)

87  
l
;

88 
max_n
 = 
de
->
mac_n
;

89 i(
max_n
 > 
MAX_MAC_LEN
)

90 
max_n
 = 
MAX_MAC_LEN
;

91 
i
 = 0; i < 
max_n
; i++) {

92 i(
de
->
mac
[
i
] !
c
->mac[i])

93  
l
;

96  
ue
;

97 
	}
}

	@src/bacapp.c

34 
	~<dt.h
>

35 
	~<dbo.h
>

36 
	~<rg.h
>

37 
	~<dio.h
>

38 
	~<dlib.h
>

39 
	~<y.h
>

40 
	~"banum.h
"

41 
	~"bacdcode.h
"

42 
	~"bact.h
"

43 
	~"bal.h
"

44 
	~"bacdef.h
"

45 
	~"ba.h
"

46 
	~"baext.h
"

47 
	~"dime.h
"

48 
	~"bacr.h
"

52 #i
defed
(
_MSC_VER
)

53 
	#tf
 
_tf


	)

56 
	$ba_code_iti_da
(

57 
ut8_t
 * 
du
,

58 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
)

60 
du_n
 = 0;

62 i(
vue
 && 
du
) {

63 
vue
->
g
) {

64 #i
	`defed
 (
BACAPP_NULL
)

65 
BACNET_APPLICATION_TAG_NULL
:

66 
du
[0] = 
vue
->
g
;

67 
du_n
++;

70 #i
	`defed
 (
BACAPP_BOOLEAN
)

71 
BACNET_APPLICATION_TAG_BOOLEAN
:

72 
du_n
 =

73 
	`code_iti_boޗn
(&
du
[0], 
vue
->
ty
.
Boޗn
);

76 #i
	`defed
 (
BACAPP_UNSIGNED
)

77 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

78 
du_n
 =

79 
	`code_iti_unsigd
(&
du
[0],

80 
vue
->
ty
.
Unsigd_I
);

83 #i
	`defed
 (
BACAPP_SIGNED
)

84 
BACNET_APPLICATION_TAG_SIGNED_INT
:

85 
du_n
 =

86 
	`code_iti_sigd
(&
du
[0],

87 
vue
->
ty
.
Sigd_I
);

90 #i
	`defed
 (
BACAPP_REAL
)

91 
BACNET_APPLICATION_TAG_REAL
:

92 
du_n
 = 
	`code_iti_
(&
du
[0], 
vue
->
ty
.
Rl
);

95 #i
	`defed
 (
BACAPP_DOUBLE
)

96 
BACNET_APPLICATION_TAG_DOUBLE
:

97 
du_n
 =

98 
	`code_iti_doub
(&
du
[0], 
vue
->
ty
.
Doub
);

101 #i
	`defed
 (
BACAPP_OCTET_STRING
)

102 
BACNET_APPLICATION_TAG_OCTET_STRING
:

103 
du_n
 =

104 
	`code_iti_o_rg
(&
du
[0],

105 &
vue
->
ty
.
O_Sg
);

108 #i
	`defed
 (
BACAPP_CHARACTER_STRING
)

109 
BACNET_APPLICATION_TAG_CHARACTER_STRING
:

110 
du_n
 =

111 
	`code_iti_cha_rg
(&
du
[0],

112 &
vue
->
ty
.
Cha_Sg
);

115 #i
	`defed
 (
BACAPP_BIT_STRING
)

116 
BACNET_APPLICATION_TAG_BIT_STRING
:

117 
du_n
 =

118 
	`code_iti_brg
(&
du
[0],

119 &
vue
->
ty
.
B_Sg
);

122 #i
	`defed
 (
BACAPP_ENUMERATED
)

123 
BACNET_APPLICATION_TAG_ENUMERATED
:

124 
du_n
 =

125 
	`code_iti_umed
(&
du
[0],

126 
vue
->
ty
.
Enumed
);

129 #i
	`defed
 (
BACAPP_DATE
)

130 
BACNET_APPLICATION_TAG_DATE
:

131 
du_n
 =

132 
	`code_iti_de
(&
du
[0], &
vue
->
ty
.
De
);

135 #i
	`defed
 (
BACAPP_TIME
)

136 
BACNET_APPLICATION_TAG_TIME
:

137 
du_n
 =

138 
	`code_iti_time
(&
du
[0], &
vue
->
ty
.
Time
);

141 #i
	`defed
 (
BACAPP_OBJECT_ID
)

142 
BACNET_APPLICATION_TAG_OBJECT_ID
:

143 
du_n
 =

144 
	`code_iti_obje_id
(&
du
[0],

145 (
vue
->
ty
.
Obje_Id
.type,

146 
vue
->
ty
.
Obje_Id
.

);

149 #i
	`defed
 (
BACAPP_LIGHTING_COMMAND
)

150 
BACNET_APPLICATION_TAG_LIGHTING_COMMAND
:

151 
du_n
 =

152 
	`lightg_commd_code
(&
du
[0],

153 &
vue
->
ty
.
Lightg_Commd
);

156 #i
	`defed
 (
BACAPP_DEVICE_OBJECT_PROP_REF
)

157 
BACNET_APPLICATION_TAG_DEVICE_OBJECT_PROPERTY_REFERENCE
:

159 
du_n
 =

160 
	`ba_code_devi_obj_ݔty_f
(&
du
[0],

161 &
vue
->
ty
.
Devi_Obje_Prݔty_Ren
);

169  
du_n
;

170 
	}
}

174 
	$ba_decode_da
(

175 
ut8_t
 * 
du
,

176 
ut8_t
 
g_da_ty
,

177 
ut32_t
 
n_vue_ty
,

178 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
)

180 
n
 = 0;

182 i(
du
 && 
vue
) {

183 
g_da_ty
) {

184 #i
	`defed
 (
BACAPP_NULL
)

185 
BACNET_APPLICATION_TAG_NULL
:

189 #i
	`defed
 (
BACAPP_BOOLEAN
)

190 
BACNET_APPLICATION_TAG_BOOLEAN
:

191 
vue
->
ty
.
Boޗn
 = 
	`decode_boޗn
(
n_vue_ty
);

194 #i
	`defed
 (
BACAPP_UNSIGNED
)

195 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

196 
n
 =

197 
	`decode_unsigd
(&
du
[0], 
n_vue_ty
,

198 &
vue
->
ty
.
Unsigd_I
);

201 #i
	`defed
 (
BACAPP_SIGNED
)

202 
BACNET_APPLICATION_TAG_SIGNED_INT
:

203 
n
 =

204 
	`decode_sigd
(&
du
[0], 
n_vue_ty
,

205 &
vue
->
ty
.
Sigd_I
);

208 #i
	`defed
 (
BACAPP_REAL
)

209 
BACNET_APPLICATION_TAG_REAL
:

210 
n
 =

211 
	`decode__
(&
du
[0], 
n_vue_ty
,

212 &(
vue
->
ty
.
Rl
));

215 #i
	`defed
 (
BACAPP_DOUBLE
)

216 
BACNET_APPLICATION_TAG_DOUBLE
:

217 
n
 =

218 
	`decode_doub_
(&
du
[0], 
n_vue_ty
,

219 &(
vue
->
ty
.
Doub
));

222 #i
	`defed
 (
BACAPP_OCTET_STRING
)

223 
BACNET_APPLICATION_TAG_OCTET_STRING
:

224 
n
 =

225 
	`decode_o_rg
(&
du
[0], 
n_vue_ty
,

226 &
vue
->
ty
.
O_Sg
);

229 #i
	`defed
 (
BACAPP_CHARACTER_STRING
)

230 
BACNET_APPLICATION_TAG_CHARACTER_STRING
:

231 
n
 =

232 
	`decode_cha_rg
(&
du
[0], 
n_vue_ty
,

233 &
vue
->
ty
.
Cha_Sg
);

236 #i
	`defed
 (
BACAPP_BIT_STRING
)

237 
BACNET_APPLICATION_TAG_BIT_STRING
:

238 
n
 =

239 
	`decode_brg
(&
du
[0], 
n_vue_ty
,

240 &
vue
->
ty
.
B_Sg
);

243 #i
	`defed
 (
BACAPP_ENUMERATED
)

244 
BACNET_APPLICATION_TAG_ENUMERATED
:

245 
n
 =

246 
	`decode_umed
(&
du
[0], 
n_vue_ty
,

247 &
vue
->
ty
.
Enumed
);

250 #i
	`defed
 (
BACAPP_DATE
)

251 
BACNET_APPLICATION_TAG_DATE
:

252 
n
 =

253 
	`decode_de_
(&
du
[0], 
n_vue_ty
,

254 &
vue
->
ty
.
De
);

257 #i
	`defed
 (
BACAPP_TIME
)

258 
BACNET_APPLICATION_TAG_TIME
:

259 
n
 =

260 
	`decode_ba_time_
(&
du
[0], 
n_vue_ty
,

261 &
vue
->
ty
.
Time
);

264 #i
	`defed
 (
BACAPP_OBJECT_ID
)

265 
BACNET_APPLICATION_TAG_OBJECT_ID
:

267 
ut16_t
 
obje_ty
 = 0;

268 
ut32_t
 

 = 0;

269 
n
 =

270 
	`decode_obje_id_
(&
du
[0], 
n_vue_ty
,

271 &
obje_ty
, &

);

272 
vue
->
ty
.
Obje_Id
.ty = 
obje_ty
;

273 
vue
->
ty
.
Obje_Id
.

 = instance;

277 #i
	`defed
 (
BACAPP_LIGHTING_COMMAND
)

278 
BACNET_APPLICATION_TAG_LIGHTING_COMMAND
:

279 
n
 =

280 
	`lightg_commd_decode
(

281 &
du
[0], 
n_vue_ty
,

282 &
vue
->
ty
.
Lightg_Commd
);

290 i((
n
 =0&& (
g_da_ty
 !
BACNET_APPLICATION_TAG_NULL
) &&

291 (
g_da_ty
 !
BACNET_APPLICATION_TAG_BOOLEAN
) &&

292 (
g_da_ty
 !
BACNET_APPLICATION_TAG_OCTET_STRING
)) {

294 i(
vue
) {

295 
vue
->
g
 = 
MAX_BACNET_APPLICATION_TAG
;

298  
n
;

299 
	}
}

301 
	$ba_decode_iti_da
(

302 
ut8_t
 * 
du
,

303 
max_du_n
,

304 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
)

306 
n
 = 0;

307 
g_n
 = 0;

308 
decode_n
 = 0;

309 
ut8_t
 
g_numb
 = 0;

310 
ut32_t
 
n_vue_ty
 = 0;

313 ()
max_du_n
;

314 i(
du
 && 
vue
 && !
	`IS_CONTEXT_SPECIFIC
(*apdu)) {

315 
vue
->
cڋxt_ecific
 = 
l
;

316 
g_n
 =

317 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
,

318 &
n_vue_ty
);

319 i(
g_n
) {

320 
n
 +
g_n
;

321 
vue
->
g
 = 
g_numb
;

322 
decode_n
 =

323 
	`ba_decode_da
(&
du
[
n
], 
g_numb
, 
n_vue_ty
,

324 
vue
);

325 i(
vue
->
g
 !
MAX_BACNET_APPLICATION_TAG
) {

326 
n
 +
decode_n
;

328 
n
 = 
BACNET_STATUS_ERROR
;

331 
vue
->
xt
 = 
NULL
;

334  
n
;

335 
	}
}

350 
bo
 
	$ba_decode_iti_da_
(

351 
ut8_t
 * 
w_du
,

352 
ut32_t
 
w_du_n
,

353 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
)

356 
ut8_t
 *
du
 = 
NULL
;

357 
ut32_t
 
du_n_mag
 = 0;

358 
ut32_t
 
du_n
 = 0;

359 
n
 = 0;

360 
g_n
 = 0;

361 
ut8_t
 
g_numb
 = 0;

362 
ut32_t
 
n_vue_ty
 = 0;

364 
bo
 
t
 = 
l
;

366 i(
w_du
 !
NULL
) {

367 
du
 = 
w_du
;

368 
du_n_mag
 = 
w_du_n
;

369 
du_n
 = 0;

372 i(
vue
 && 
du_n_mag
 > 0 &&

373 !
	`IS_CONTEXT_SPECIFIC
(
du
[
du_n
])) {

374 
vue
->
cڋxt_ecific
 = 
l
;

375 
g_n
 =

376 
	`decode_g_numb_d_vue_
(&
du
[
du_n
],

377 
du_n_mag
, &
g_numb
, &
n_vue_ty
);

379 i(
g_n
) {

380 
du_n
 +
g_n
;

381 
du_n_mag
 -
g_n
;

384 i(
g_numb
 =
BACNET_APPLICATION_TAG_BOOLEAN
 ||

385 
n_vue_ty
 <
du_n_mag
) {

386 
vue
->
g
 = 
g_numb
;

387 
n
 =

388 
	`ba_decode_da
(&
du
[
du_n
], 
g_numb
,

389 
n_vue_ty
, 
vue
);

390 
du_n
 +
n
;

391 
du_n_mag
 -
n
;

393 
t
 = 
ue
;

396 
vue
->
xt
 = 
NULL
;

400  
t
;

401 
	}
}

405 
	$ba_decode_da_n
(

406 
ut8_t
 * 
du
,

407 
ut8_t
 
g_da_ty
,

408 
ut32_t
 
n_vue_ty
)

410 
n
 = 0;

412 i(
du
) {

413 
g_da_ty
) {

414 
BACNET_APPLICATION_TAG_NULL
:

416 
BACNET_APPLICATION_TAG_BOOLEAN
:

418 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

419 
BACNET_APPLICATION_TAG_SIGNED_INT
:

420 
BACNET_APPLICATION_TAG_REAL
:

421 
BACNET_APPLICATION_TAG_DOUBLE
:

422 
BACNET_APPLICATION_TAG_OCTET_STRING
:

423 
BACNET_APPLICATION_TAG_CHARACTER_STRING
:

424 
BACNET_APPLICATION_TAG_BIT_STRING
:

425 
BACNET_APPLICATION_TAG_ENUMERATED
:

426 
BACNET_APPLICATION_TAG_DATE
:

427 
BACNET_APPLICATION_TAG_TIME
:

428 
BACNET_APPLICATION_TAG_OBJECT_ID
:

429 
n
 = (
n_vue_ty
;

436  
n
;

437 
	}
}

439 
	$ba_decode_iti_da_n
(

440 
ut8_t
 * 
du
,

441 
max_du_n
)

443 
n
 = 0;

444 
g_n
 = 0;

445 
decode_n
 = 0;

446 
ut8_t
 
g_numb
 = 0;

447 
ut32_t
 
n_vue_ty
 = 0;

450 ()
max_du_n
;

451 i(
du
 && !
	`IS_CONTEXT_SPECIFIC
(*apdu)) {

452 
g_n
 =

453 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
,

454 &
n_vue_ty
);

455 i(
g_n
) {

456 
n
 +
g_n
;

457 
decode_n
 =

458 
	`ba_decode_da_n
(&
du
[
n
], 
g_numb
, 
n_vue_ty
);

459 
n
 +
decode_n
;

463  
n
;

464 
	}
}

466 
	$ba_code_cڋxt_da_vue
(

467 
ut8_t
 * 
du
,

468 
ut8_t
 
cڋxt_g_numb
,

469 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
)

471 
du_n
 = 0;

473 i(
vue
 && 
du
) {

474 
vue
->
g
) {

475 #i
	`defed
 (
BACAPP_NULL
)

476 
BACNET_APPLICATION_TAG_NULL
:

477 
du_n
 = 
	`code_cڋxt_nu
(&
du
[0], 
cڋxt_g_numb
);

480 #i
	`defed
 (
BACAPP_BOOLEAN
)

481 
BACNET_APPLICATION_TAG_BOOLEAN
:

482 
du_n
 =

483 
	`code_cڋxt_boޗn
(&
du
[0], 
cڋxt_g_numb
,

484 
vue
->
ty
.
Boޗn
);

487 #i
	`defed
 (
BACAPP_UNSIGNED
)

488 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

489 
du_n
 =

490 
	`code_cڋxt_unsigd
(&
du
[0], 
cڋxt_g_numb
,

491 
vue
->
ty
.
Unsigd_I
);

494 #i
	`defed
 (
BACAPP_SIGNED
)

495 
BACNET_APPLICATION_TAG_SIGNED_INT
:

496 
du_n
 =

497 
	`code_cڋxt_sigd
(&
du
[0], 
cڋxt_g_numb
,

498 
vue
->
ty
.
Sigd_I
);

501 #i
	`defed
 (
BACAPP_REAL
)

502 
BACNET_APPLICATION_TAG_REAL
:

503 
du_n
 =

504 
	`code_cڋxt_
(&
du
[0], 
cڋxt_g_numb
,

505 
vue
->
ty
.
Rl
);

508 #i
	`defed
 (
BACAPP_DOUBLE
)

509 
BACNET_APPLICATION_TAG_DOUBLE
:

510 
du_n
 =

511 
	`code_cڋxt_doub
(&
du
[0], 
cڋxt_g_numb
,

512 
vue
->
ty
.
Doub
);

515 #i
	`defed
 (
BACAPP_OCTET_STRING
)

516 
BACNET_APPLICATION_TAG_OCTET_STRING
:

517 
du_n
 =

518 
	`code_cڋxt_o_rg
(&
du
[0], 
cڋxt_g_numb
,

519 &
vue
->
ty
.
O_Sg
);

522 #i
	`defed
 (
BACAPP_CHARACTER_STRING
)

523 
BACNET_APPLICATION_TAG_CHARACTER_STRING
:

524 
du_n
 =

525 
	`code_cڋxt_cha_rg
(&
du
[0],

526 
cڋxt_g_numb
, &
vue
->
ty
.
Cha_Sg
);

529 #i
	`defed
 (
BACAPP_BIT_STRING
)

530 
BACNET_APPLICATION_TAG_BIT_STRING
:

531 
du_n
 =

532 
	`code_cڋxt_brg
(&
du
[0], 
cڋxt_g_numb
,

533 &
vue
->
ty
.
B_Sg
);

536 #i
	`defed
 (
BACAPP_ENUMERATED
)

537 
BACNET_APPLICATION_TAG_ENUMERATED
:

538 
du_n
 =

539 
	`code_cڋxt_umed
(&
du
[0], 
cڋxt_g_numb
,

540 
vue
->
ty
.
Enumed
);

543 #i
	`defed
 (
BACAPP_DATE
)

544 
BACNET_APPLICATION_TAG_DATE
:

545 
du_n
 =

546 
	`code_cڋxt_de
(&
du
[0], 
cڋxt_g_numb
,

547 &
vue
->
ty
.
De
);

550 #i
	`defed
 (
BACAPP_TIME
)

551 
BACNET_APPLICATION_TAG_TIME
:

552 
du_n
 =

553 
	`code_cڋxt_time
(&
du
[0], 
cڋxt_g_numb
,

554 &
vue
->
ty
.
Time
);

557 #i
	`defed
 (
BACAPP_OBJECT_ID
)

558 
BACNET_APPLICATION_TAG_OBJECT_ID
:

559 
du_n
 =

560 
	`code_cڋxt_obje_id
(&
du
[0], 
cڋxt_g_numb
,

561 (
vue
->
ty
.
Obje_Id
.type,

562 
vue
->
ty
.
Obje_Id
.

);

565 #i
	`defed
 (
BACAPP_LIGHTING_COMMAND
)

566 
BACNET_APPLICATION_TAG_LIGHTING_COMMAND
:

567 
du_n
 =

568 
	`lightg_commd_code_cڋxt
(

569 &
du
[0], 
cڋxt_g_numb
,

570 &
vue
->
ty
.
Lightg_Commd
);

578  
du_n
;

579 
	}
}

582 
BACNET_APPLICATION_TAG
 
	$ba_cڋxt_g_ty
(

583 
BACNET_PROPERTY_ID
 
ݔty
,

584 
ut8_t
 
g_numb
)

586 
BACNET_APPLICATION_TAG
 
g
 = 
MAX_BACNET_APPLICATION_TAG
;

588 
ݔty
) {

589 
PROP_ACTUAL_SHED_LEVEL
:

590 
PROP_REQUESTED_SHED_LEVEL
:

591 
PROP_EXPECTED_SHED_LEVEL
:

592 
g_numb
) {

595 
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

598 
g
 = 
BACNET_APPLICATION_TAG_REAL
;

604 
PROP_ACTION
:

605 
g_numb
) {

608 
g
 = 
BACNET_APPLICATION_TAG_OBJECT_ID
;

611 
g
 = 
BACNET_APPLICATION_TAG_ENUMERATED
;

616 
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

620 
g
 = 
BACNET_APPLICATION_TAG_BOOLEAN
;

627 
PROP_LIST_OF_GROUP_MEMBERS
:

629 
g_numb
) {

631 
g
 = 
BACNET_APPLICATION_TAG_OBJECT_ID
;

637 
PROP_EXCEPTION_SCHEDULE
:

638 
g_numb
) {

640 
g
 = 
BACNET_APPLICATION_TAG_OBJECT_ID
;

643 
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

651 
PROP_LOG_DEVICE_OBJECT_PROPERTY
:

652 
g_numb
) {

655 
g
 = 
BACNET_APPLICATION_TAG_OBJECT_ID
;

658 
g
 = 
BACNET_APPLICATION_TAG_ENUMERATED
;

661 
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

667 
PROP_SUBORDINATE_LIST
:

669 
g_numb
) {

672 
g
 = 
BACNET_APPLICATION_TAG_OBJECT_ID
;

679 
PROP_RECIPIENT_LIST
:

681 
g_numb
) {

683 
g
 = 
BACNET_APPLICATION_TAG_OBJECT_ID
;

689 
PROP_ACTIVE_COV_SUBSCRIPTIONS
:

691 
g_numb
) {

696 
g
 = 
BACNET_APPLICATION_TAG_BOOLEAN
;

699 
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

702 
g
 = 
BACNET_APPLICATION_TAG_REAL
;

712  
g
;

713 
	}
}

715 
	$ba_code_cڋxt_da
(

716 
ut8_t
 * 
du
,

717 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
,

718 
BACNET_PROPERTY_ID
 
ݔty
)

720 
du_n
 = 0;

721 
BACNET_APPLICATION_TAG
 
g_da_ty
;

723 i(
vue
 && 
du
) {

724 
g_da_ty
 = 
	`ba_cڋxt_g_ty
(
ݔty
, 
vue
->
cڋxt_g
);

725 i(
g_da_ty
 < 
MAX_BACNET_APPLICATION_TAG
) {

726 
du_n
 =

727 
	`ba_code_cڋxt_da_vue
(&
du
[0], 
vue
->
cڋxt_g
,

728 
vue
);

731 
du_n
 = 0;

733 
vue
->
xt
 = 
NULL
;

736  
du_n
;

737 
	}
}

739 
	$ba_decode_cڋxt_da
(

740 
ut8_t
 * 
du
,

741 
max_du_n
,

742 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
,

743 
BACNET_PROPERTY_ID
 
ݔty
)

745 
du_n
 = 0, 
n
 = 0;

746 
g_n
 = 0;

747 
ut8_t
 
g_numb
 = 0;

748 
ut32_t
 
n_vue_ty
 = 0;

750 i(
du
 && 
vue
 && 
	`IS_CONTEXT_SPECIFIC
(*apdu)) {

751 
vue
->
cڋxt_ecific
 = 
ue
;

752 
vue
->
xt
 = 
NULL
;

753 
g_n
 =

754 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
,

755 &
n_vue_ty
);

756 
du_n
 = 
g_n
;

758 i(
g_n
 && ((g_<
max_du_n
) &&

759 !
	`decode_is_osg_g_numb
(&
du
[0], 
g_numb
)) {

760 
vue
->
cڋxt_g
 = 
g_numb
;

761 
vue
->
g
 = 
	`ba_cڋxt_g_ty
(
ݔty
, 
g_numb
);

762 i(
vue
->
g
 < 
MAX_BACNET_APPLICATION_TAG
) {

763 
n
 =

764 
	`ba_decode_da
(&
du
[
du_n
], 
vue
->
g
,

765 
n_vue_ty
, 
vue
);

766 
du_n
 +
n
;

767 } i(
n_vue_ty
) {

769 
du_n
 +
n_vue_ty
;

772 
du_n
 = 
BACNET_STATUS_ERROR
;

774 } i(
g_n
 == 1)

775 
du_n
 = 0;

778  
du_n
;

779 
	}
}

781 
	$ba_decode_cڋxt_da_n
(

782 
ut8_t
 * 
du
,

783 
max_du_n
,

784 
BACNET_PROPERTY_ID
 
ݔty
)

786 
du_n
 = 0, 
n
 = 0;

787 
g_n
 = 0;

788 
ut8_t
 
g_numb
 = 0;

789 
ut32_t
 
n_vue_ty
 = 0;

790 
ut8_t
 
g
 = 0;

793 ()
max_du_n
;

794 i(
du
 && 
	`IS_CONTEXT_SPECIFIC
(*apdu)) {

795 
g_n
 =

796 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
,

797 &
n_vue_ty
);

798 i(
g_n
) {

799 
du_n
 = 
g_n
;

800 
g
 = 
	`ba_cڋxt_g_ty
(
ݔty
, 
g_numb
);

801 i(
g
 < 
MAX_BACNET_APPLICATION_TAG
) {

802 
n
 =

803 
	`ba_decode_da_n
(&
du
[
du_n
], 
g
,

804 
n_vue_ty
);

805 
du_n
 +
n
;

807 
du_n
 +
n_vue_ty
;

812  
du_n
;

813 
	}
}

815 
	$ba_code_da
(

816 
ut8_t
 * 
du
,

817 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
)

819 
du_n
 = 0;

821 i(
vue
 && 
du
) {

822 i(
vue
->
cڋxt_ecific
) {

823 
du_n
 =

824 
	`ba_code_cڋxt_da_vue
(&
du
[0], 
vue
->
cڋxt_g
,

825 
vue
);

827 
du_n
 = 
	`ba_code_iti_da
(&
du
[0], 
vue
);

831  
du_n
;

832 
	}
}

835 
bo
 
	$ba_cy
(

836 
BACNET_APPLICATION_DATA_VALUE
 * 
de_vue
,

837 
BACNET_APPLICATION_DATA_VALUE
 * 
c_vue
)

839 
bo
 
us
 = 
ue
;

841 i(
de_vue
 && 
c_vue
) {

842 
de_vue
->
g
 = 
c_vue
->tag;

843 
c_vue
->
g
) {

844 #i
	`defed
 (
BACAPP_NULL
)

845 
BACNET_APPLICATION_TAG_NULL
:

848 #i
	`defed
 (
BACAPP_BOOLEAN
)

849 
BACNET_APPLICATION_TAG_BOOLEAN
:

850 
de_vue
->
ty
.
Boޗn
 = 
c_vue
->type.Boolean;

853 #i
	`defed
 (
BACAPP_UNSIGNED
)

854 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

855 
de_vue
->
ty
.
Unsigd_I
 = 
c_vue
->type.Unsigned_Int;

858 #i
	`defed
 (
BACAPP_SIGNED
)

859 
BACNET_APPLICATION_TAG_SIGNED_INT
:

860 
de_vue
->
ty
.
Sigd_I
 = 
c_vue
->type.Signed_Int;

863 #i
	`defed
 (
BACAPP_REAL
)

864 
BACNET_APPLICATION_TAG_REAL
:

865 
de_vue
->
ty
.
Rl
 = 
c_vue
->type.Real;

868 #i
	`defed
 (
BACAPP_DOUBLE
)

869 
BACNET_APPLICATION_TAG_DOUBLE
:

870 
de_vue
->
ty
.
Doub
 = 
c_vue
->type.Double;

873 #i
	`defed
 (
BACAPP_OCTET_STRING
)

874 
BACNET_APPLICATION_TAG_OCTET_STRING
:

875 
	`org_cy
(&
de_vue
->
ty
.
O_Sg
,

876 &
c_vue
->
ty
.
O_Sg
);

879 #i
	`defed
 (
BACAPP_CHARACTER_STRING
)

880 
BACNET_APPLICATION_TAG_CHARACTER_STRING
:

881 
	`charg_cy
(&
de_vue
->
ty
.
Cha_Sg
,

882 &
c_vue
->
ty
.
Cha_Sg
);

885 #i
	`defed
 (
BACAPP_BIT_STRING
)

886 
BACNET_APPLICATION_TAG_BIT_STRING
:

887 
	`brg_cy
(&
de_vue
->
ty
.
B_Sg
,

888 &
c_vue
->
ty
.
B_Sg
);

891 #i
	`defed
 (
BACAPP_ENUMERATED
)

892 
BACNET_APPLICATION_TAG_ENUMERATED
:

893 
de_vue
->
ty
.
Enumed
 = 
c_vue
->type.Enumerated;

896 #i
	`defed
 (
BACAPP_DATE
)

897 
BACNET_APPLICATION_TAG_DATE
:

898 
	`dime_cy_de
(&
de_vue
->
ty
.
De
,

899 &
c_vue
->
ty
.
De
);

902 #i
	`defed
 (
BACAPP_TIME
)

903 
BACNET_APPLICATION_TAG_TIME
:

904 
	`dime_cy_time
(&
de_vue
->
ty
.
Time
,

905 &
c_vue
->
ty
.
Time
);

908 #i
	`defed
 (
BACAPP_OBJECT_ID
)

909 
BACNET_APPLICATION_TAG_OBJECT_ID
:

910 
de_vue
->
ty
.
Obje_Id
.type =

911 
c_vue
->
ty
.
Obje_Id
.type;

912 
de_vue
->
ty
.
Obje_Id
.

 =

913 
c_vue
->
ty
.
Obje_Id
.

;

916 #i
	`defed
 (
BACAPP_LIGHTING_COMMAND
)

917 
BACNET_APPLICATION_TAG_LIGHTING_COMMAND
:

918 
us
 = 
	`lightg_commd_cy
(

919 &
de_vue
->
ty
.
Lightg_Commd
,

920 &
c_vue
->
ty
.
Lightg_Commd
);

924 
us
 = 
l
;

927 
de_vue
->
xt
 = 
c_vue
->next;

930  
us
;

931 
	}
}

937 
	$ba_da_n
(

938 
ut8_t
 * 
du
,

939 
max_du_n
,

940 
BACNET_PROPERTY_ID
 
ݔty
)

942 
n
 = 0;

943 
tٮ_n
 = 0;

944 
du_n
 = 0;

945 
ut8_t
 
g_numb
 = 0;

946 
ut8_t
 
ݒg_g_numb
 = 0;

947 
ut8_t
 
ݒg_g_numb_cou
 = 0;

948 
ut32_t
 
vue
 = 0;

950 i(
	`IS_OPENING_TAG
(
du
[0])) {

951 
n
 =

952 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
, &
vue
);

953 
du_n
 +
n
;

954 
ݒg_g_numb
 = 
g_numb
;

955 
ݒg_g_numb_cou
 = 1;

956 
ݒg_g_numb_cou
) {

957 i(
	`IS_OPENING_TAG
(
du
[
du_n
])) {

958 
n
 =

959 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

960 &
vue
);

961 i(
g_numb
 =
ݒg_g_numb
)

962 
ݒg_g_numb_cou
++;

963 } i(
	`IS_CLOSING_TAG
(
du
[
du_n
])) {

964 
n
 =

965 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

966 &
vue
);

967 i(
g_numb
 =
ݒg_g_numb
)

968 
ݒg_g_numb_cou
--;

969 } i(
	`IS_CONTEXT_SPECIFIC
(
du
[
du_n
])) {

971 
n
 =

972 
	`ba_decode_cڋxt_da_n
(&
du
[
du_n
],

973 
max_du_n
 - 
du_n
, 
ݔty
);

976 
n
 =

977 
	`ba_decode_iti_da_n
(&
du
[
du_n
],

978 
max_du_n
 - 
du_n
);

980 
du_n
 +
n
;

981 i(
ݒg_g_numb_cou
) {

982 i(
n
 > 0) {

983 
tٮ_n
 +
n
;

986 
tٮ_n
 = 
BACNET_STATUS_ERROR
;

990 i((
du_n
 > 
max_du_n
) {

992 
tٮ_n
 = 
BACNET_STATUS_ERROR
;

998  
tٮ_n
;

999 
	}
}

1001 #ifde
BACAPP_SNPRINTF_ENABLED


1002 
bo
 
	$nd_r
(

1003 **
r
,

1004 
size_t
 * 
m_r_n
,

1005 cڡ *
add_r
)

1007 
bo
 
tv
;

1008 
ut16_t
 
bys_wrn
;

1010 
bys_wrn
 = 
	`tf
(*
r
, *
m_r_n
, "%s", 
add_r
);

1011 i((
bys_wrn
 < 0|| (bys_wr>*
m_r_n
)) {

1013 
tv
 = 
l
;

1017 *
r
 +
bys_wrn
;

1018 *
m_r_n
 -
bys_wrn
;

1019 
tv
 = 
ue
;

1022  
tv
;

1023 
	}
}

1033 
	$ba_tf_vue
(

1034 *
r
,

1035 
size_t
 
r_n
,

1036 
BACNET_OBJECT_PROPERTY_VALUE
 * 
obje_vue
)

1038 
size_t
 
n
 = 0, 
i
 = 0;

1039 *
ch_r
;

1040 
ut8_t
 *
o_r
;

1041 
BACNET_APPLICATION_DATA_VALUE
 *
vue
;

1042 
BACNET_PROPERTY_ID
 
ݔty
 = 
PROP_ALL
;

1043 
BACNET_OBJECT_TYPE
 
obje_ty
 = 
MAX_BACNET_OBJECT_TYPE
;

1044 
t_v
 = -1;

1045 *
p_r
 = 
r
;

1046 
size_t
 
m_r_n
 = 
r_n
;

1047 
mp_r
[32];

1049 i(
obje_vue
 && obje_vue->
vue
) {

1050 
vue
 = 
obje_vue
->value;

1051 
ݔty
 = 
obje_vue
->
obje_ݔty
;

1052 
obje_ty
 = 
obje_vue
->object_type;

1053 
vue
->
g
) {

1054 
BACNET_APPLICATION_TAG_NULL
:

1055 
t_v
 = 
	`tf
(
r
, 
r_n
, "Null");

1057 
BACNET_APPLICATION_TAG_BOOLEAN
:

1058 
t_v
 =

1059 (
vue
->
ty
.
Boޗn
? 
	`tf
(
r
, 
r_n
,

1060 "TRUE": 
	`tf
(
r
, 
r_n
, "FALSE");

1062 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

1063 
t_v
 =

1064 
	`tf
(
r
, 
r_n
, "%lu",

1065 (
vue
->
ty
.
Unsigd_I
);

1067 
BACNET_APPLICATION_TAG_SIGNED_INT
:

1068 
t_v
 =

1069 
	`tf
(
r
, 
r_n
, "%ld",

1070 (
vue
->
ty
.
Sigd_I
);

1072 
BACNET_APPLICATION_TAG_REAL
:

1073 
t_v
 =

1074 
	`tf
(
r
, 
r_n
, "%f", (
vue
->
ty
.
Rl
);

1076 #i
	`defed
 (
BACAPP_DOUBLE
)

1077 
BACNET_APPLICATION_TAG_DOUBLE
:

1078 
t_v
 = 
	`tf
(
r
, 
r_n
, "%f", 
vue
->
ty
.
Doub
);

1081 
BACNET_APPLICATION_TAG_OCTET_STRING
:

1082 
n
 = 
	`org_ngth
(&
vue
->
ty
.
O_Sg
);

1083 
o_r
 = 
	`org_vue
(&
vue
->
ty
.
O_Sg
);

1084 
i
 = 0; i < 
n
; i++) {

1085 
	`tf
(
mp_r
, emp_r), "%02X", *
o_r
);

1086 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1088 
o_r
++;

1090 i(
i
 =
n
) {

1092 
t_v
 = 
r_n
 - 
m_r_n
;

1095 
BACNET_APPLICATION_TAG_CHARACTER_STRING
:

1096 
n
 = 
	`charg_ngth
(&
vue
->
ty
.
Cha_Sg
);

1097 
ch_r
 =

1098 
	`charg_vue
(&
vue
->
ty
.
Cha_Sg
);

1099 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "\""))

1101 
i
 = 0; i < 
n
; i++) {

1102 i(
	`irt
(*((*
ch_r
))) {

1103 
	`tf
(
mp_r
, emp_r), "%c", *
ch_r
);

1105 
	`tf
(
mp_r
, (temp_str), "%c", '.');

1107 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1109 
ch_r
++;

1111 i((
i
 =
n
&& 
	`nd_r
(&
p_r
, &
m_r_n
, "\"")

1115 
t_v
 = 
r_n
 - 
m_r_n
;

1118 
BACNET_APPLICATION_TAG_BIT_STRING
:

1119 
n
 = 
	`brg_bs_ud
(&
vue
->
ty
.
B_Sg
);

1120 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "{"))

1122 
i
 = 0; i < 
n
; i++) {

1123 
	`tf
(
mp_r
, (temp_str), "%s",

1124 
	`brg_b
(&
vue
->
ty
.
B_Sg
,

1125 (
ut8_t

i
) ? "true" : "false");

1126 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1128 i(
i
 < 
n
 - 1) {

1129 i(!
	`nd_r
(&
p_r
, &
m_r_n
, ","))

1133 i((
i
 =
n
&& 
	`nd_r
(&
p_r
, &
m_r_n
, "}")

1137 
t_v
 = 
r_n
 - 
m_r_n
;

1140 
BACNET_APPLICATION_TAG_ENUMERATED
:

1141 
ݔty
) {

1142 
PROP_OBJECT_TYPE
:

1143 i(
vue
->
ty
.
Enumed
 < 
MAX_ASHRAE_OBJECT_TYPE
) {

1144 
t_v
 =

1145 
	`tf
(
r
, 
r_n
, "%s",

1146 
	`baext_obje_ty_me
(
vue
->
ty
.

1147 
Enumed
));

1148 } i(
vue
->
ty
.
Enumed
 < 128) {

1149 
t_v
 =

1150 
	`tf
(
r
, 
r_n
, "reserved %lu",

1151 (
vue
->
ty
.
Enumed
);

1153 
t_v
 =

1154 
	`tf
(
r
, 
r_n
, "proprietary %lu",

1155 (
vue
->
ty
.
Enumed
);

1158 
PROP_EVENT_STATE
:

1159 
t_v
 =

1160 
	`tf
(
r
, 
r_n
, "%s",

1161 
	`baext_evt_e_me
(
vue
->
ty
.
Enumed
));

1163 
PROP_UNITS
:

1164 i(
vue
->
ty
.
Enumed
 < 256) {

1165 
t_v
 =

1166 
	`tf
(
r
, 
r_n
, "%s",

1167 
	`baext_grg_un_me
(
vue
->

1168 
ty
.
Enumed
));

1170 
t_v
 =

1171 
	`tf
(
r
, 
r_n
, "proprietary %lu",

1172 (
vue
->
ty
.
Enumed
);

1175 
PROP_POLARITY
:

1176 
t_v
 =

1177 
	`tf
(
r
, 
r_n
, "%s",

1178 
	`baext_by_pެy_me
(
vue
->

1179 
ty
.
Enumed
));

1181 
PROP_PRESENT_VALUE
:

1182 
PROP_RELINQUISH_DEFAULT
:

1183 i(
obje_ty
 < 
OBJECT_PROPRIETARY_MIN
) {

1184 
t_v
 =

1185 
	`tf
(
r
, 
r_n
, "%s",

1186 
	`baext_by_e_vue_me
(
vue
->
ty
.

1187 
Enumed
));

1189 
t_v
 =

1190 
	`tf
(
r
, 
r_n
, "%lu",

1191 (
vue
->
ty
.
Enumed
);

1194 
PROP_RELIABILITY
:

1195 
t_v
 =

1196 
	`tf
(
r
, 
r_n
, "%s",

1197 
	`baext_lby_me
(
vue
->
ty
.
Enumed
));

1199 
PROP_SYSTEM_STATUS
:

1200 
t_v
 =

1201 
	`tf
(
r
, 
r_n
, "%s",

1202 
	`baext_devi_us_me
(
vue
->

1203 
ty
.
Enumed
));

1205 
PROP_SEGMENTATION_SUPPORTED
:

1206 
t_v
 =

1207 
	`tf
(
r
, 
r_n
, "%s",

1208 
	`baext_gmti_me
(
vue
->
ty
.
Enumed
));

1210 
PROP_NODE_TYPE
:

1211 
t_v
 =

1212 
	`tf
(
r
, 
r_n
, "%s",

1213 
	`baext_node_ty_me
(
vue
->
ty
.
Enumed
));

1216 
t_v
 =

1217 
	`tf
(
r
, 
r_n
, "%lu",

1218 (
vue
->
ty
.
Enumed
);

1222 
BACNET_APPLICATION_TAG_DATE
:

1223 i(!
	`nd_r
(&
p_r
, &
m_r_n
,

1224 
	`baext_day_of_wk_me
(
vue
->
ty
.
De
.
wday
)

1228 i(!
	`nd_r
(&
p_r
, &
m_r_n
, ", "))

1231 i(!
	`nd_r
(&
p_r
, &
m_r_n
,

1232 
	`baext_mth_me
(
vue
->
ty
.
De
.
mth
)

1236 i(
vue
->
ty
.
De
.
day
 == 255) {

1237 i(!
	`nd_r
(&
p_r
, &
m_r_n
, " (unspecified), "))

1240 
	`tf
(
mp_r
, (temp_str), " %u, ",

1241 (
vue
->
ty
.
De
.
day
);

1242 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1245 i(
vue
->
ty
.
De
.
yr
 == 2155) {

1246 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "(unspecified)"))

1249 
	`tf
(
mp_r
, (temp_str), "%u",

1250 (
vue
->
ty
.
De
.
yr
);

1251 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1256 
t_v
 = 
r_n
 - 
m_r_n
;

1258 
BACNET_APPLICATION_TAG_TIME
:

1259 i(
vue
->
ty
.
Time
.
hour
 == 255) {

1260 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "**:"))

1263 
	`tf
(
mp_r
, (temp_str), "%02u:",

1264 (
vue
->
ty
.
Time
.
hour
);

1265 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1268 i(
vue
->
ty
.
Time
.
m
 == 255) {

1269 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "**:"))

1272 
	`tf
(
mp_r
, (temp_str), "%02u:",

1273 (
vue
->
ty
.
Time
.
m
);

1274 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1277 i(
vue
->
ty
.
Time
.
c
 == 255) {

1278 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "**."))

1281 
	`tf
(
mp_r
, (temp_str), "%02u.",

1282 (
vue
->
ty
.
Time
.
c
);

1283 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1286 i(
vue
->
ty
.
Time
.
hunddths
 == 255) {

1287 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "**"))

1290 
	`tf
(
mp_r
, (temp_str), "%02u",

1291 (
vue
->
ty
.
Time
.
hunddths
);

1292 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1297 
t_v
 = 
r_n
 - 
m_r_n
;

1299 
BACNET_APPLICATION_TAG_OBJECT_ID
:

1300 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "("))

1302 i(
vue
->
ty
.
Obje_Id
.ty < 
MAX_ASHRAE_OBJECT_TYPE
) {

1303 i(!
	`nd_r
(&
p_r
, &
m_r_n
,

1304 
	`baext_obje_ty_me
(
vue
->
ty
.

1305 
Obje_Id
.
ty
)

1309 
	`tf
(
mp_r
, (temp_str), ", %lu",

1310 (
vue
->
ty
.
Obje_Id
.

);

1311 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1313 } i(
vue
->
ty
.
Obje_Id
.type < 128) {

1314 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "reserved "))

1316 
	`tf
(
mp_r
, (temp_str), "%u, ",

1317 (
vue
->
ty
.
Obje_Id
.type);

1318 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1320 
	`tf
(
mp_r
, (temp_str), "%lu",

1321 (
vue
->
ty
.
Obje_Id
.

);

1322 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1325 i(!
	`nd_r
(&
p_r
, &
m_r_n
, "proprietary "))

1327 
	`tf
(
mp_r
, (temp_str), "%u, ",

1328 (
vue
->
ty
.
Obje_Id
.type);

1329 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1331 
	`tf
(
mp_r
, (temp_str), "%lu",

1332 (
vue
->
ty
.
Obje_Id
.

);

1333 i(!
	`nd_r
(&
p_r
, &
m_r_n
, 
mp_r
))

1336 i(!
	`nd_r
(&
p_r
, &
m_r_n
, ")"))

1340 
t_v
 = 
r_n
 - 
m_r_n
;

1343 
t_v
 = 0;

1348  
t_v
;

1349 
	}
}

1352 #ifde
BACAPP_PRINT_ENABLED


1357 
bo
 
	$ba_t_vue
(

1358 
FILE
 * 
am
,

1359 
BACNET_OBJECT_PROPERTY_VALUE
 * 
obje_vue
)

1361 *
r
;

1362 
bo
 
tv
 = 
l
;

1363 
size_t
 
r_n
 = 32;

1364 
us
;

1366 
ue
) {

1368 
r
 = (*
	`oc
((), 
r_n
);

1369 i(!
r
)

1374 
us
 = 
	`ba_tf_vue
(
r
, 
r_n
, 
obje_vue
);

1375 i((
us
 < 0|| (u>
r_n
)) {

1376 
	`
(
r
);

1377 
r_n
 *= 2;

1378 } i(
us
 == 0) {

1379 
	`
(
r
);

1382 i(
am
)

1383 
	`rtf
(
am
, "%s", 
r
);

1384 
	`
(
r
);

1385 
tv
 = 
ue
;

1389  
tv
;

1390 
	}
}

1393 #ifde
BACAPP_PRINT_ENABLED


1396 
bo
 
	$ba_r_iti_da
(

1397 
BACNET_APPLICATION_TAG
 
g_numb
,

1398 cڡ *
gv
,

1399 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
)

1401 
hour
, 
m
, 
c
, 
hunddths
;

1402 
yr
, 
mth
, 
day
, 
wday
;

1403 
obje_ty
 = 0;

1404 
ut32_t
 

 = 0;

1405 
bo
 
us
 = 
l
;

1406 
lg_vue
 = 0;

1407 
unsigd_lg_vue
 = 0;

1408 
doub_vue
 = 0.0;

1409 
cou
 = 0;

1411 i(
vue
 && (
g_numb
 < 
MAX_BACNET_APPLICATION_TAG
)) {

1412 
us
 = 
ue
;

1413 
vue
->
g
 = 
g_numb
;

1414 
g_numb
) {

1415 
BACNET_APPLICATION_TAG_BOOLEAN
:

1416 
lg_vue
 = 
	`
(
gv
, 
NULL
, 0);

1417 i(
lg_vue
)

1418 
vue
->
ty
.
Boޗn
 = 
ue
;

1420 
vue
->
ty
.
Boޗn
 = 
l
;

1422 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

1423 
unsigd_lg_vue
 = 
	`oul
(
gv
, 
NULL
, 0);

1424 
vue
->
ty
.
Unsigd_I
 = 
unsigd_lg_vue
;

1426 
BACNET_APPLICATION_TAG_SIGNED_INT
:

1427 
lg_vue
 = 
	`
(
gv
, 
NULL
, 0);

1428 
vue
->
ty
.
Sigd_I
 = 
lg_vue
;

1430 
BACNET_APPLICATION_TAG_REAL
:

1431 
doub_vue
 = 
	`od
(
gv
, 
NULL
);

1432 
vue
->
ty
.
Rl
 = (
doub_vue
;

1434 #i
	`defed
 (
BACAPP_DOUBLE
)

1435 
BACNET_APPLICATION_TAG_DOUBLE
:

1436 
doub_vue
 = 
	`od
(
gv
, 
NULL
);

1437 
vue
->
ty
.
Doub
 = 
doub_vue
;

1440 
BACNET_APPLICATION_TAG_OCTET_STRING
:

1441 #i
PRINT_ENABLED


1442 
us
 =

1443 
	`org__ascii_hex
(&
vue
->
ty
.
O_Sg
,

1444 
gv
);

1447 
BACNET_APPLICATION_TAG_CHARACTER_STRING
:

1448 
us
 =

1449 
	`charg__si
(&
vue
->
ty
.
Cha_Sg
,

1450 (*
gv
);

1452 
BACNET_APPLICATION_TAG_BIT_STRING
:

1453 #i
PRINT_ENABLED


1454 
us
 = 
	`brg__ascii
(&
vue
->
ty
.
B_Sg
, 
gv
);

1457 
BACNET_APPLICATION_TAG_ENUMERATED
:

1458 
unsigd_lg_vue
 = 
	`oul
(
gv
, 
NULL
, 0);

1459 
vue
->
ty
.
Enumed
 = 
unsigd_lg_vue
;

1461 
BACNET_APPLICATION_TAG_DATE
:

1462 
cou
 =

1463 
	`ssnf
(
gv
, "%4d/%3d/%3d:%3d", &
yr
, &
mth
, &
day
,

1464 &
wday
);

1465 i(
cou
 == 3) {

1466 
	`dime_t_de
(&
vue
->
ty
.
De
, (
ut16_t

yr
,

1467 (
ut8_t

mth
, (ut8_t
day
);

1468 } i(
cou
 == 4) {

1469 
vue
->
ty
.
De
.
yr
 = (
ut16_t
) year;

1470 
vue
->
ty
.
De
.
mth
 = (
ut8_t
) month;

1471 
vue
->
ty
.
De
.
day
 = (
ut8_t
) day;

1472 
vue
->
ty
.
De
.
wday
 = (
ut8_t
) wday;

1474 
us
 = 
l
;

1477 
BACNET_APPLICATION_TAG_TIME
:

1478 
cou
 =

1479 
	`ssnf
(
gv
, "%3d:%3d:%3d.%3d", &
hour
, &
m
, &
c
,

1480 &
hunddths
);

1481 i(
cou
 == 4) {

1482 
vue
->
ty
.
Time
.
hour
 = (
ut8_t
) hour;

1483 
vue
->
ty
.
Time
.
m
 = (
ut8_t
) min;

1484 
vue
->
ty
.
Time
.
c
 = (
ut8_t
) sec;

1485 
vue
->
ty
.
Time
.
hunddths
 = (
ut8_t
) hundredths;

1486 } i(
cou
 == 3) {

1487 
vue
->
ty
.
Time
.
hour
 = (
ut8_t
) hour;

1488 
vue
->
ty
.
Time
.
m
 = (
ut8_t
) min;

1489 
vue
->
ty
.
Time
.
c
 = (
ut8_t
) sec;

1490 
vue
->
ty
.
Time
.
hunddths
 = 0;

1491 } i(
cou
 == 2) {

1492 
vue
->
ty
.
Time
.
hour
 = (
ut8_t
) hour;

1493 
vue
->
ty
.
Time
.
m
 = (
ut8_t
) min;

1494 
vue
->
ty
.
Time
.
c
 = 0;

1495 
vue
->
ty
.
Time
.
hunddths
 = 0;

1497 
us
 = 
l
;

1500 
BACNET_APPLICATION_TAG_OBJECT_ID
:

1501 
cou
 = 
	`ssnf
(
gv
, "%4d:%7d", &
obje_ty
, &

);

1502 i(
cou
 == 2) {

1503 
vue
->
ty
.
Obje_Id
.ty = (
ut16_t

obje_ty
;

1504 
vue
->
ty
.
Obje_Id
.

 = instance;

1506 
us
 = 
l
;

1512 
vue
->
xt
 = 
NULL
;

1515  
us
;

1516 
	}
}

1519 #ifde
TEST


1520 
	~<as.h
>

1521 
	~<rg.h
>

1522 
	~"e.h
"

1525 
	~<as.h
>

1529 
bo
 
	$ba_me_vue
(

1530 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
,

1531 
BACNET_APPLICATION_DATA_VALUE
 * 
_vue
)

1533 
bo
 
us
 = 
l
;

1536 i(
_vue
->
g
 =
vue
->tag)

1537 
us
 = 
ue
;

1538 i(
us
) {

1540 
us
 = 
l
;

1542 
_vue
->
g
) {

1543 #i
	`defed
 (
BACAPP_NULL
)

1544 
BACNET_APPLICATION_TAG_NULL
:

1545 
us
 = 
ue
;

1548 #i
	`defed
 (
BACAPP_BOOLEAN
)

1549 
BACNET_APPLICATION_TAG_BOOLEAN
:

1550 i(
_vue
->
ty
.
Boޗn
 =
vue
->type.Boolean)

1551 
us
 = 
ue
;

1554 #i
	`defed
 (
BACAPP_UNSIGNED
)

1555 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

1556 i(
_vue
->
ty
.
Unsigd_I
 =
vue
->type.Unsigned_Int)

1557 
us
 = 
ue
;

1560 #i
	`defed
 (
BACAPP_SIGNED
)

1561 
BACNET_APPLICATION_TAG_SIGNED_INT
:

1562 i(
_vue
->
ty
.
Sigd_I
 =
vue
->type.Signed_Int)

1563 
us
 = 
ue
;

1566 #i
	`defed
 (
BACAPP_REAL
)

1567 
BACNET_APPLICATION_TAG_REAL
:

1568 i(
_vue
->
ty
.
Rl
 =
vue
->type.Real)

1569 
us
 = 
ue
;

1572 #i
	`defed
 (
BACAPP_DOUBLE
)

1573 
BACNET_APPLICATION_TAG_DOUBLE
:

1574 i(
_vue
->
ty
.
Doub
 =
vue
->type.Double)

1575 
us
 = 
ue
;

1578 #i
	`defed
 (
BACAPP_ENUMERATED
)

1579 
BACNET_APPLICATION_TAG_ENUMERATED
:

1580 i(
_vue
->
ty
.
Enumed
 =
vue
->type.Enumerated)

1581 
us
 = 
ue
;

1584 #i
	`defed
 (
BACAPP_DATE
)

1585 
BACNET_APPLICATION_TAG_DATE
:

1586 i(
	`dime_com_de
(&
_vue
->
ty
.
De
,

1587 &
vue
->
ty
.
De
) == 0)

1588 
us
 = 
ue
;

1591 #i
	`defed
 (
BACAPP_TIME
)

1592 
BACNET_APPLICATION_TAG_TIME
:

1593 i(
	`dime_com_time
(&
_vue
->
ty
.
Time
,

1594 &
vue
->
ty
.
Time
) == 0)

1595 
us
 = 
ue
;

1598 #i
	`defed
 (
BACAPP_OBJECT_ID
)

1599 
BACNET_APPLICATION_TAG_OBJECT_ID
:

1600 i((
_vue
->
ty
.
Obje_Id
.type ==

1601 
vue
->
ty
.
Obje_Id
.type) &&

1602 (
_vue
->
ty
.
Obje_Id
.

 ==

1603 
vue
->
ty
.
Obje_Id
.

)) {

1604 
us
 = 
ue
;

1608 #i
	`defed
 (
BACAPP_CHARACTER_STRING
)

1609 
BACNET_APPLICATION_TAG_CHARACTER_STRING
:

1610 
us
 =

1611 
	`charg_me
(&
vue
->
ty
.
Cha_Sg
,

1612 &
_vue
->
ty
.
Cha_Sg
);

1615 #i
	`defed
 (
BACAPP_OCTET_STRING
)

1616 
BACNET_APPLICATION_TAG_OCTET_STRING
:

1617 
us
 =

1618 
	`org_vue_me
(&
vue
->
ty
.
O_Sg
,

1619 &
_vue
->
ty
.
O_Sg
);

1622 #i
	`defed
 (
BACAPP_BIT_STRING
)

1623 
BACNET_APPLICATION_TAG_BIT_STRING
:

1624 
us
 =

1625 
	`brg_me
(&
vue
->
ty
.
B_Sg
,

1626 &
_vue
->
ty
.
B_Sg
);

1629 #i
	`defed
 (
BACAPP_LIGHTING_COMMAND
)

1630 
BACNET_APPLICATION_TAG_LIGHTING_COMMAND
:

1631 
us
 = 
	`lightg_commd_me
(

1632 &
vue
->
ty
.
Lightg_Commd
,

1633 &
_vue
->
ty
.
Lightg_Commd
);

1637 
us
 = 
l
;

1641  
us
;

1642 
	}
}

1644 
	$BACtAlitiDa_Sa
(

1645 
Te
 * 
pTe
)

1647 
i
;

1648 
ut8_t
 
du
[
MAX_APDU
];

1649 
n
 = 0;

1650 
du_n
;

1651 
BACNET_APPLICATION_DATA_VALUE
 
put_vue
[13];

1652 
ut32_t
 
n_gmt
[13];

1653 
ut32_t
 
sg_ngth_gmt
;

1654 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1657 
i
 = 0; i < 13; i++) {

1658 
put_vue
[
i
].
g
 = (
BACNET_APPLICATION_TAG
) i;

1659 
put_vue
[
i
].
cڋxt_ecific
 = 0;

1660 
put_vue
[
i
].
cڋxt_g
 = 0;

1661 
put_vue
[
i
].
xt
 = 
NULL
;

1662 
put_vue
[
i
].
g
) {

1663 
BACNET_APPLICATION_TAG_NULL
:

1667 
BACNET_APPLICATION_TAG_BOOLEAN
:

1668 
put_vue
[
i
].
ty
.
Boޗn
 = 
ue
;

1671 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

1672 
put_vue
[
i
].
ty
.
Unsigd_I
 = 0xDEADBEEF;

1675 
BACNET_APPLICATION_TAG_SIGNED_INT
:

1676 
put_vue
[
i
].
ty
.
Sigd_I
 = 0x00C0FFEE;

1678 
BACNET_APPLICATION_TAG_REAL
:

1679 
put_vue
[
i
].
ty
.
Rl
 = 3.141592654f;

1681 
BACNET_APPLICATION_TAG_DOUBLE
:

1682 
put_vue
[
i
].
ty
.
Doub
 = 2.32323232323;

1685 
BACNET_APPLICATION_TAG_OCTET_STRING
:

1687 
ut8_t
 
_o
[5] = { "Karg" };

1688 
	`org_
(&
put_vue
[
i
].
ty
.
O_Sg
,

1689 
_o
, (test_octet));

1693 
BACNET_APPLICATION_TAG_CHARACTER_STRING
:

1694 
	`charg__si
(&
put_vue
[
i
].
ty
.

1695 
Cha_Sg
, "Hello There!");

1698 
BACNET_APPLICATION_TAG_BIT_STRING
:

1699 
	`brg_
(&
put_vue
[
i
].
ty
.
B_Sg
);

1700 
	`brg_t_b
(&
put_vue
[
i
].
ty
.
B_Sg
, 0, 
ue
);

1701 
	`brg_t_b
(&
put_vue
[
i
].
ty
.
B_Sg
, 1, 
l
);

1702 
	`brg_t_b
(&
put_vue
[
i
].
ty
.
B_Sg
, 2, 
l
);

1703 
	`brg_t_b
(&
put_vue
[
i
].
ty
.
B_Sg
, 3, 
ue
);

1704 
	`brg_t_b
(&
put_vue
[
i
].
ty
.
B_Sg
, 4, 
l
);

1705 
	`brg_t_b
(&
put_vue
[
i
].
ty
.
B_Sg
, 5, 
ue
);

1706 
	`brg_t_b
(&
put_vue
[
i
].
ty
.
B_Sg
, 6, 
ue
);

1709 
BACNET_APPLICATION_TAG_ENUMERATED
:

1710 
put_vue
[
i
].
ty
.
Enumed
 = 0x0BADF00D;

1713 
BACNET_APPLICATION_TAG_DATE
:

1714 
put_vue
[
i
].
ty
.
De
.
day
 = 10;

1715 
put_vue
[
i
].
ty
.
De
.
mth
 = 9;

1716 
put_vue
[
i
].
ty
.
De
.
wday
 = 3;

1717 
put_vue
[
i
].
ty
.
De
.
yr
 = 1998;

1720 
BACNET_APPLICATION_TAG_TIME
:

1721 
put_vue
[
i
].
ty
.
Time
.
hour
 = 12;

1722 
put_vue
[
i
].
ty
.
Time
.
hunddths
 = 56;

1723 
put_vue
[
i
].
ty
.
Time
.
m
 = 20;

1724 
put_vue
[
i
].
ty
.
Time
.
c
 = 41;

1727 
BACNET_APPLICATION_TAG_OBJECT_ID
:

1728 
put_vue
[
i
].
ty
.
Obje_Id
.

 = 1234;

1729 
put_vue
[
i
].
ty
.
Obje_Id
.type = 12;

1735 
sg_ngth_gmt
 =

1736 
	`ba_code_da
(&
du
[
n
], &
put_vue
[
i
]);;

1737 
	`as
(
sg_ngth_gmt
 > 0);

1739 i(
i
 == 0) {

1740 
n_gmt
[
i
] = 
sg_ngth_gmt
;

1742 
n_gmt
[
i
] = 
sg_ngth_gmt
 +en_segment[i - 1];

1744 
n
 = 
n_gmt
[
i
];

1750 
du_n
 = 
n
;pdu_len >= 0;pdu_len--) {

1751 
bo
 
us
;

1752 
bo
 
exed_us
;

1753 
i
 = 0; i < 14; i++) {

1754 i(
i
 == 13) {

1755 
exed_us
 = 
l
;

1758 i(
du_n
 < 
n_gmt
[
i
]) {

1759 
exed_us
 = 
l
;

1761 
exed_us
 = 
ue
;

1764 
us
 =

1765 
	`ba_decode_iti_da_
(
i
 =0 ? 
du
 : 
NULL
,

1766 
du_n
, &
vue
);

1768 
	`_
(
pTe
, 
us
 =
exed_us
);

1769 i(
us
) {

1770 
	`_
(
pTe
, 
vue
.
g
 =
i
);

1771 
	`_
(
pTe
, 
	`ba_me_vue
(&
put_vue
[
i
], &
vue
));

1772 
	`_
(
pTe
, !
vue
.
cڋxt_ecific
);

1773 
	`_
(
pTe
, 
vue
.
xt
 =
NULL
);

1779 
	}
}

1782 
	$BACtAlitiDaLgth
(

1783 
Te
 * 
pTe
)

1785 
du_n
 = 0;

1786 
n
 = 0;

1787 
_n
 = 0;

1788 
ut8_t
 
du
[480] = { 0 };

1789 
BACNET_TIME
 
lol_time
;

1790 
BACNET_DATE
 
lol_de
;

1794 
_n
 = 0;

1795 
du_n
 = 0;

1796 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 3);

1797 
du_n
 +
n
;

1798 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 3);

1799 
du_n
 +
n
;

1801 
n
 =

1802 
	`ba_da_n
(&
du
[0], 
du_n
,

1803 
PROP_LIST_OF_OBJECT_PROPERTY_REFERENCES
);

1804 
	`_
(
pTe
, 
_n
 =
n
);

1807 
_n
 = 0;

1808 
du_n
 = 0;

1809 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 3);

1810 
du_n
 +
n
;

1811 
n
 = 
	`code_iti_unsigd
(&
du
[
du_n
], 4194303);

1812 
_n
 +
n
;

1813 
du_n
 +
n
;

1814 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 3);

1815 
du_n
 +
n
;

1817 
n
 = 
	`ba_da_n
(&
du
[0], 
du_n
, 
PROP_OBJECT_IDENTIFIER
);

1818 
	`_
(
pTe
, 
_n
 =
n
);

1821 
_n
 = 0;

1822 
du_n
 = 0;

1823 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 3);

1824 
du_n
 +
n
;

1825 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1826 
_n
 +
n
;

1827 
du_n
 +
n
;

1828 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1829 
_n
 +
n
;

1830 
du_n
 +
n
;

1831 
n
 = 
	`code_iti_unsigd
(&
du
[
du_n
], 1);

1832 
_n
 +
n
;

1833 
du_n
 +
n
;

1834 
n
 = 
	`code_iti_unsigd
(&
du
[
du_n
], 42);

1835 
_n
 +
n
;

1836 
du_n
 +
n
;

1837 
n
 = 
	`code_iti_unsigd
(&
du
[
du_n
], 91);

1838 
_n
 +
n
;

1839 
du_n
 +
n
;

1840 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1841 
_n
 +
n
;

1842 
du_n
 +
n
;

1843 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1844 
_n
 +
n
;

1845 
du_n
 +
n
;

1846 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1847 
_n
 +
n
;

1848 
du_n
 +
n
;

1849 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1850 
_n
 +
n
;

1851 
du_n
 +
n
;

1852 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1853 
_n
 +
n
;

1854 
du_n
 +
n
;

1855 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1856 
_n
 +
n
;

1857 
du_n
 +
n
;

1858 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1859 
_n
 +
n
;

1860 
du_n
 +
n
;

1861 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1862 
_n
 +
n
;

1863 
du_n
 +
n
;

1864 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1865 
_n
 +
n
;

1866 
du_n
 +
n
;

1867 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1868 
_n
 +
n
;

1869 
du_n
 +
n
;

1870 
n
 = 
	`code_iti_nu
(&
du
[
du_n
]);

1871 
_n
 +
n
;

1872 
du_n
 +
n
;

1873 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 3);

1874 
du_n
 +
n
;

1876 
n
 = 
	`ba_da_n
(&
du
[0], 
du_n
, 
PROP_PRIORITY_ARRAY
);

1877 
	`_
(
pTe
, 
_n
 =
n
);

1880 
_n
 = 0;

1881 
du_n
 = 0;

1882 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 3);

1883 
du_n
 +
n
;

1884 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 3);

1885 
_n
 +
n
;

1886 
du_n
 +
n
;

1887 
lol_de
.
yr
 = 2006;

1888 
lol_de
.
mth
 = 4;

1889 
lol_de
.
day
 = 1;

1890 
lol_de
.
wday
 = 6;

1891 
n
 = 
	`code_iti_de
(&
du
[
du_n
], &
lol_de
);

1892 
_n
 +
n
;

1893 
du_n
 +
n
;

1894 
lol_time
.
hour
 = 7;

1895 
lol_time
.
m
 = 0;

1896 
lol_time
.
c
 = 3;

1897 
lol_time
.
hunddths
 = 1;

1898 
n
 = 
	`code_iti_time
(&
du
[
du_n
], &
lol_time
);

1899 
_n
 +
n
;

1900 
du_n
 +
n
;

1901 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 3);

1902 
_n
 +
n
;

1903 
du_n
 +
n
;

1904 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 3);

1905 
du_n
 +
n
;

1907 
n
 = 
	`ba_da_n
(&
du
[0], 
du_n
, 
PROP_START_TIME
);

1908 
	`_
(
pTe
, 
_n
 =
n
);

1915 
_n
 = 0;

1916 
du_n
 = 0;

1917 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 3);

1918 
du_n
 +
n
;

1919 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1, 91);

1920 
_n
 +
n
;

1921 
du_n
 +
n
;

1922 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 3);

1923 
du_n
 +
n
;

1925 
n
 = 
	`ba_da_n
(&
du
[0], 
du_n
, 
PROP_REQUESTED_SHED_LEVEL
);

1926 
	`_
(
pTe
, 
_n
 =
n
);

1927 
	}
}

1929 
bo
 
	$BACtAlitiDaVue
(

1930 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
)

1932 
ut8_t
 
du
[480] = { 0 };

1933 
du_n
 = 0;

1934 
BACNET_APPLICATION_DATA_VALUE
 
_vue
;

1936 
du_n
 = 
	`ba_code_iti_da
(&
du
[0], 
vue
);

1937 
	`ba_decode_iti_da
(&
du
[0], 
du_n
, &
_vue
);

1939  
	`ba_me_vue
(
vue
, &
_vue
);

1940 
	}
}

1942 
	$BACtAlitiDa
(

1943 
Te
 * 
pTe
)

1945 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

1946 
bo
 
us
 = 
l
;

1949 
us
 =

1950 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_NULL
, 
NULL
,

1951 &
vue
);

1952 
	`_
(
pTe
, 
us
 =
ue
);

1953 
us
 = 
	`BACtAlitiDaVue
(&
vue
);

1954 
	`_
(
pTe
, 
us
 =
ue
);

1956 
us
 =

1957 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_BOOLEAN
, "1",

1958 &
vue
);

1959 
	`_
(
pTe
, 
us
 =
ue
);

1960 
	`_
(
pTe
, 
vue
.
ty
.
Boޗn
 =
ue
);

1961 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

1963 
us
 =

1964 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_BOOLEAN
, "0",

1965 &
vue
);

1966 
	`_
(
pTe
, 
us
 =
ue
);

1967 
	`_
(
pTe
, 
vue
.
ty
.
Boޗn
 =
l
);

1968 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

1970 
us
 =

1971 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_UNSIGNED_INT
, "0",

1972 &
vue
);

1973 
	`_
(
pTe
, 
us
 =
ue
);

1974 
	`_
(
pTe
, 
vue
.
ty
.
Unsigd_I
 == 0);

1975 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

1976 
us
 =

1977 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1978 "0xFFFF", &
vue
);

1979 
	`_
(
pTe
, 
us
 =
ue
);

1980 
	`_
(
pTe
, 
vue
.
ty
.
Unsigd_I
 == 0xFFFF);

1981 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

1982 
us
 =

1983 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_UNSIGNED_INT
,

1984 "0xFFFFFFFF", &
vue
);

1985 
	`_
(
pTe
, 
us
 =
ue
);

1986 
	`_
(
pTe
, 
vue
.
ty
.
Unsigd_I
 == 0xFFFFFFFF);

1987 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

1989 
us
 =

1990 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_SIGNED_INT
, "0",

1991 &
vue
);

1992 
	`_
(
pTe
, 
us
 =
ue
);

1993 
	`_
(
pTe
, 
vue
.
ty
.
Sigd_I
 == 0);

1994 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

1995 
us
 =

1996 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_SIGNED_INT
, "-1",

1997 &
vue
);

1998 
	`_
(
pTe
, 
us
 =
ue
);

1999 
	`_
(
pTe
, 
vue
.
ty
.
Sigd_I
 == -1);

2000 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2001 
us
 =

2002 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_SIGNED_INT
,

2003 "32768", &
vue
);

2004 
	`_
(
pTe
, 
us
 =
ue
);

2005 
	`_
(
pTe
, 
vue
.
ty
.
Sigd_I
 == 32768);

2006 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2007 
us
 =

2008 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_SIGNED_INT
,

2009 "-32768", &
vue
);

2010 
	`_
(
pTe
, 
us
 =
ue
);

2011 
	`_
(
pTe
, 
vue
.
ty
.
Sigd_I
 == -32768);

2012 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2014 
us
 =

2015 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_REAL
, "0.0",

2016 &
vue
);

2017 
	`_
(
pTe
, 
us
 =
ue
);

2018 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2019 
us
 =

2020 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_REAL
, "-1.0",

2021 &
vue
);

2022 
	`_
(
pTe
, 
us
 =
ue
);

2023 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2024 
us
 =

2025 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_REAL
, "1.0",

2026 &
vue
);

2027 
	`_
(
pTe
, 
us
 =
ue
);

2028 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2029 
us
 =

2030 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_REAL
, "3.14159",

2031 &
vue
);

2032 
	`_
(
pTe
, 
us
 =
ue
);

2033 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2034 
us
 =

2035 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_REAL
, "-3.14159",

2036 &
vue
);

2037 
	`_
(
pTe
, 
us
 =
ue
);

2038 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2040 
us
 =

2041 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_ENUMERATED
, "0",

2042 &
vue
);

2043 
	`_
(
pTe
, 
us
 =
ue
);

2044 
	`_
(
pTe
, 
vue
.
ty
.
Enumed
 == 0);

2045 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2046 
us
 =

2047 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_ENUMERATED
,

2048 "0xFFFF", &
vue
);

2049 
	`_
(
pTe
, 
us
 =
ue
);

2050 
	`_
(
pTe
, 
vue
.
ty
.
Enumed
 == 0xFFFF);

2051 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2052 
us
 =

2053 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_ENUMERATED
,

2054 "0xFFFFFFFF", &
vue
);

2055 
	`_
(
pTe
, 
us
 =
ue
);

2056 
	`_
(
pTe
, 
vue
.
ty
.
Enumed
 == 0xFFFFFFFF);

2057 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2059 
us
 =

2060 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_DATE
,

2061 "2005/5/22:1", &
vue
);

2062 
	`_
(
pTe
, 
us
 =
ue
);

2063 
	`_
(
pTe
, 
vue
.
ty
.
De
.
yr
 == 2005);

2064 
	`_
(
pTe
, 
vue
.
ty
.
De
.
mth
 == 5);

2065 
	`_
(
pTe
, 
vue
.
ty
.
De
.
day
 == 22);

2066 
	`_
(
pTe
, 
vue
.
ty
.
De
.
wday
 == 1);

2067 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2070 
us
 =

2071 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_DATE
, "2007/2/14",

2072 &
vue
);

2073 
	`_
(
pTe
, 
us
 =
ue
);

2074 
	`_
(
pTe
, 
vue
.
ty
.
De
.
yr
 == 2007);

2075 
	`_
(
pTe
, 
vue
.
ty
.
De
.
mth
 == 2);

2076 
	`_
(
pTe
, 
vue
.
ty
.
De
.
day
 == 14);

2077 
	`_
(
pTe
, 
vue
.
ty
.
De
.
wday
 =
BACNET_WEEKDAY_WEDNESDAY
);

2078 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2081 
us
 =

2082 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_DATE
,

2083 "2155/255/255:255", &
vue
);

2084 
	`_
(
pTe
, 
us
 =
ue
);

2085 
	`_
(
pTe
, 
vue
.
ty
.
De
.
yr
 == 2155);

2086 
	`_
(
pTe
, 
vue
.
ty
.
De
.
mth
 == 255);

2087 
	`_
(
pTe
, 
vue
.
ty
.
De
.
day
 == 255);

2088 
	`_
(
pTe
, 
vue
.
ty
.
De
.
wday
 == 255);

2089 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2091 
us
 =

2092 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_TIME
,

2093 "23:59:59.12", &
vue
);

2094 
	`_
(
pTe
, 
us
 =
ue
);

2095 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
hour
 == 23);

2096 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
m
 == 59);

2097 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
c
 == 59);

2098 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
hunddths
 == 12);

2099 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2101 
us
 =

2102 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_TIME
, "23:59:59",

2103 &
vue
);

2104 
	`_
(
pTe
, 
us
 =
ue
);

2105 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
hour
 == 23);

2106 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
m
 == 59);

2107 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
c
 == 59);

2108 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
hunddths
 == 0);

2109 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2111 
us
 =

2112 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_TIME
, "23:59",

2113 &
vue
);

2114 
	`_
(
pTe
, 
us
 =
ue
);

2115 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
hour
 == 23);

2116 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
m
 == 59);

2117 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
c
 == 0);

2118 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
hunddths
 == 0);

2119 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2122 
us
 =

2123 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_TIME
,

2124 "255:255:255.255", &
vue
);

2125 
	`_
(
pTe
, 
us
 =
ue
);

2126 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
hour
 == 255);

2127 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
m
 == 255);

2128 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
c
 == 255);

2129 
	`_
(
pTe
, 
vue
.
ty
.
Time
.
hunddths
 == 255);

2130 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2132 
us
 =

2133 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_OBJECT_ID
,

2134 "0:100", &
vue
);

2135 
	`_
(
pTe
, 
us
 =
ue
);

2136 
	`_
(
pTe
, 
vue
.
ty
.
Obje_Id
.type == 0);

2137 
	`_
(
pTe
, 
vue
.
ty
.
Obje_Id
.

 == 100);

2138 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2140 
us
 =

2141 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_CHARACTER_STRING
,

2142 "Kg!", &
vue
);

2143 
	`_
(
pTe
, 
us
 =
ue
);

2144 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2146 
us
 =

2147 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_CHARACTER_STRING
,

2148 "", &
vue
);

2149 
	`_
(
pTe
, 
us
 =
ue
);

2150 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2152 
us
 =

2153 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_OCTET_STRING
,

2154 "1234567890ABCDEF", &
vue
);

2155 
	`_
(
pTe
, 
us
 =
ue
);

2156 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2157 
us
 =

2158 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_OCTET_STRING
,

2159 "12-34-56-78-90-AB-CD-EF", &
vue
);

2160 
	`_
(
pTe
, 
us
 =
ue
);

2161 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2162 
us
 =

2163 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_OCTET_STRING
,

2164 "12 34 56 78 90 AB CD EF", &
vue
);

2165 
	`_
(
pTe
, 
us
 =
ue
);

2166 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2168 
us
 =

2169 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_OCTET_STRING
, "",

2170 &
vue
);

2171 
	`_
(
pTe
, 
us
 =
ue
);

2172 
	`_
(
pTe
, 
	`BACtAlitiDaVue
(&
vue
));

2175 
	}
}

2178 #ifde
TEST_BACNET_APPLICATION_DATA


2179 
	$ma
(

2182 
Te
 *
pTe
;

2183 
bo
 
rc
;

2185 
pTe
 = 
	`_
("BACÈAliti Da", 
NULL
);

2187 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtAlitiDa
);

2188 
	`as
(
rc
);

2189 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtAlitiDaLgth
);

2190 
	`as
(
rc
);

2191 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtAlitiDa_Sa
);

2192 
	`as
(
rc
);

2194 
	`_tSm
(
pTe
, 
dout
);

2195 
	`_run
(
pTe
);

2196 (
	`_pt
(
pTe
);

2197 
	`_deroy
(
pTe
);

2200 
	}
}

	@src/bacdcode.c

35 
	~<rg.h
>

37 
	~"bacdef.h
"

38 
	~"bacdcode.h
"

39 
	~"banum.h
"

40 
	~"bs.h
"

41 
	~"bacr.h
"

42 
	~"bact.h
"

43 
	~"bal.h
"

98 
ut8_t
 
	$code_max_gs_max_du
(

99 
max_gs
,

100 
max_du
)

102 
ut8_t
 
o
 = 0;

104 i(
max_gs
 < 2)

105 
o
 = 0;

106 i(
max_gs
 < 4)

107 
o
 = 0x10;

108 i(
max_gs
 < 8)

109 
o
 = 0x20;

110 i(
max_gs
 < 16)

111 
o
 = 0x30;

112 i(
max_gs
 < 32)

113 
o
 = 0x40;

114 i(
max_gs
 < 64)

115 
o
 = 0x50;

116 i(
max_gs
 == 64)

117 
o
 = 0x60;

119 
o
 = 0x70;

122 i(
max_du
 <= 50)

123 
o
 |= 0x00;

124 i(
max_du
 <= 128)

125 
o
 |= 0x01;

127 i(
max_du
 <= 206)

128 
o
 |= 0x02;

130 i(
max_du
 <= 480)

131 
o
 |= 0x03;

132 i(
max_du
 <= 1024)

133 
o
 |= 0x04;

135 i(
max_du
 <= 1476)

136 
o
 |= 0x05;

138  
o
;

139 
	}
}

144 
	$decode_max_gs
(

145 
ut8_t
 
o
)

147 
max_gs
 = 0;

149 
o
 & 0xF0) {

151 
max_gs
 = 0;

154 
max_gs
 = 2;

157 
max_gs
 = 4;

160 
max_gs
 = 8;

163 
max_gs
 = 16;

166 
max_gs
 = 32;

169 
max_gs
 = 64;

172 
max_gs
 = 65;

178  
max_gs
;

179 
	}
}

181 
	$decode_max_du
(

182 
ut8_t
 
o
)

184 
max_du
 = 0;

186 
o
 & 0x0F) {

188 
max_du
 = 50;

191 
max_du
 = 128;

194 
max_du
 = 206;

197 
max_du
 = 480;

200 
max_du
 = 1024;

203 
max_du
 = 1476;

209  
max_du
;

210 
	}
}

214 
	$code_g
(

215 
ut8_t
 * 
du
,

216 
ut8_t
 
g_numb
,

217 
bo
 
cڋxt_ecific
,

218 
ut32_t
 
n_vue_ty
)

220 
n
 = 1;

222 
du
[0] = 0;

223 i(
cڋxt_ecific
)

224 
du
[0] = 
BIT3
;

228 i(
g_numb
 <= 14) {

229 
du
[0] |(
g_numb
 << 4);

231 
du
[0] |= 0xF0;

232 
du
[1] = 
g_numb
;

233 
n
++;

238 i(
n_vue_ty
 <= 4) {

239 
du
[0] |
n_vue_ty
;

241 
du
[0] |= 5;

242 i(
n_vue_ty
 <= 253) {

243 
du
[
n
++] = (
ut8_t

n_vue_ty
;

244 } i(
n_vue_ty
 <= 65535) {

245 
du
[
n
++] = 254;

246 
n
 +
	`code_unsigd16
(&
du
[n], (
ut16_t

n_vue_ty
);

248 
du
[
n
++] = 255;

249 
n
 +
	`code_unsigd32
(&
du
[n], 
n_vue_ty
);

253  
n
;

254 
	}
}

258 
	$code_ݒg_g
(

259 
ut8_t
 * 
du
,

260 
ut8_t
 
g_numb
)

262 
n
 = 1;

265 
du
[0] = 
BIT3
;

267 i(
g_numb
 <= 14) {

268 
du
[0] |(
g_numb
 << 4);

270 
du
[0] |= 0xF0;

271 
du
[1] = 
g_numb
;

272 
n
++;

275 
du
[0] |= 6;

277  
n
;

278 
	}
}

282 
	$code_osg_g
(

283 
ut8_t
 * 
du
,

284 
ut8_t
 
g_numb
)

286 
n
 = 1;

289 
du
[0] = 
BIT3
;

291 i(
g_numb
 <= 14) {

292 
du
[0] |(
g_numb
 << 4);

294 
du
[0] |= 0xF0;

295 
du
[1] = 
g_numb
;

296 
n
++;

299 
du
[0] |= 7;

301  
n
;

302 
	}
}

306 
	$decode_g_numb
(

307 
ut8_t
 * 
du
,

308 
ut8_t
 * 
g_numb
)

310 
n
 = 1;

313 i(
	`IS_EXTENDED_TAG_NUMBER
(
du
[0])) {

315 i(
g_numb
) {

316 *
g_numb
 = 
du
[1];

318 
n
++;

320 i(
g_numb
) {

321 *
g_numb
 = (
ut8_t
(
du
[0] >> 4);

325  
n
;

326 
	}
}

329 
	$decode_g_numb_
(

330 
ut8_t
 * 
du
,

331 
ut32_t
 
du_n_mag
,

332 
ut8_t
 * 
g_numb
)

334 
n
 = 0;

337 i(
du_n_mag
 >= 1) {

338 i(
	`IS_EXTENDED_TAG_NUMBER
(
du
[0]&& 
du_n_mag
 >= 2) {

340 i(
g_numb
) {

341 *
g_numb
 = 
du
[1];

343 
n
 = 2;

345 i(
g_numb
) {

346 *
g_numb
 = (
ut8_t
(
du
[0] >> 4);

348 
n
 = 1;

351  
n
;

352 
	}
}

354 
bo
 
	$decode_is_ݒg_g
(

355 
ut8_t
 * 
du
)

357  (
bo
((
du
[0] & 0x07) == 6);

358 
	}
}

362 
bo
 
	$decode_is_osg_g
(

363 
ut8_t
 * 
du
)

365  (
bo
((
du
[0] & 0x07) == 7);

366 
	}
}

370 
	$decode_g_numb_d_vue
(

371 
ut8_t
 * 
du
,

372 
ut8_t
 * 
g_numb
,

373 
ut32_t
 * 
vue
)

375 
n
 = 1;

376 
ut16_t
 
vue16
;

377 
ut32_t
 
vue32
;

379 
n
 = 
	`decode_g_numb
(&
du
[0], 
g_numb
);

380 i(
	`IS_EXTENDED_VALUE
(
du
[0])) {

382 i(
du
[
n
] == 255) {

383 
n
++;

384 
n
 +
	`decode_unsigd32
(&
du
[n], &
vue32
);

385 i(
vue
) {

386 *
vue
 = 
vue32
;

390 i(
du
[
n
] == 254) {

391 
n
++;

392 
n
 +
	`decode_unsigd16
(&
du
[n], &
vue16
);

393 i(
vue
) {

394 *
vue
 = 
vue16
;

399 i(
vue
) {

400 *
vue
 = 
du
[
n
];

402 
n
++;

404 } i(
	`IS_OPENING_TAG
(
du
[0]&& 
vue
) {

405 *
vue
 = 0;

406 } i(
	`IS_CLOSING_TAG
(
du
[0]&& 
vue
) {

408 *
vue
 = 0;

409 } i(
vue
) {

411 *
vue
 = 
du
[0] & 0x07;

414  
n
;

415 
	}
}

418 
	$decode_g_numb_d_vue_
(

419 
ut8_t
 * 
du
,

420 
ut32_t
 
du_n_mag
,

421 
ut8_t
 * 
g_numb
,

422 
ut32_t
 * 
vue
)

424 
n
 = 0;

426 
n
 = 
	`decode_g_numb_
(&
du
[0], 
du_n_mag
, 
g_numb
);

428 i(
n
 > 0) {

429 
du_n_mag
 -
n
;

430 i(
	`IS_EXTENDED_VALUE
(
du
[0])) {

432 i(
du
[
n
] =255 && 
du_n_mag
 >= 5) {

433 
ut32_t
 
vue32
;

434 
n
++;

435 
n
 +
	`decode_unsigd32
(&
du
[n], &
vue32
);

436 i(
vue
) {

437 *
vue
 = 
vue32
;

441 i(
du
[
n
] =254 && 
du_n_mag
 >= 3) {

442 
ut16_t
 
vue16
;

443 
n
++;

444 
n
 +
	`decode_unsigd16
(&
du
[n], &
vue16
);

445 i(
vue
) {

446 *
vue
 = 
vue16
;

450 i(
du
[
n
] < 254 && 
du_n_mag
 >= 1) {

451 i(
vue
) {

452 *
vue
 = 
du
[
n
];

454 
n
++;

457 
n
 = 0;

459 } i(
	`IS_OPENING_TAG
(
du
[0]&& 
vue
) {

460 *
vue
 = 0;

461 } i(
	`IS_CLOSING_TAG
(
du
[0]&& 
vue
) {

463 *
vue
 = 0;

464 } i(
vue
) {

466 *
vue
 = 
du
[0] & 0x07;

469  
n
;

470 
	}
}

474 
bo
 
	$decode_is_cڋxt_g
(

475 
ut8_t
 * 
du
,

476 
ut8_t
 
g_numb
)

478 
ut8_t
 
my_g_numb
 = 0;

480 
	`decode_g_numb
(
du
, &
my_g_numb
);

481  (
bo
(
	`IS_CONTEXT_SPECIFIC
(*
du
) &&

482 (
my_g_numb
 =
g_numb
));

483 
	}
}

485 
bo
 
	$decode_is_cڋxt_g_wh_ngth
(

486 
ut8_t
 * 
du
,

487 
ut8_t
 
g_numb
,

488 *
g_ngth
)

490 
ut8_t
 
my_g_numb
 = 0;

492 *
g_ngth
 = 
	`decode_g_numb
(
du
, &
my_g_numb
);

494  (
bo
(
	`IS_CONTEXT_SPECIFIC
(*
du
) &&

495 (
my_g_numb
 =
g_numb
));

496 
	}
}

500 
bo
 
	$decode_is_ݒg_g_numb
(

501 
ut8_t
 * 
du
,

502 
ut8_t
 
g_numb
)

504 
ut8_t
 
my_g_numb
 = 0;

506 
	`decode_g_numb
(
du
, &
my_g_numb
);

507  (
bo
(
	`IS_OPENING_TAG
(
du
[0]&& (
my_g_numb
 =
g_numb
));

508 
	}
}

512 
bo
 
	$decode_is_osg_g_numb
(

513 
ut8_t
 * 
du
,

514 
ut8_t
 
g_numb
)

516 
ut8_t
 
my_g_numb
 = 0;

518 
	`decode_g_numb
(
du
, &
my_g_numb
);

519  (
bo
(
	`IS_CLOSING_TAG
(
du
[0]&& (
my_g_numb
 =
g_numb
));

520 
	}
}

525 
	$code_iti_boޗn
(

526 
ut8_t
 * 
du
,

527 
bo
 
boޗn_vue
)

529 
n
 = 0;

530 
ut32_t
 
n_vue
 = 0;

532 i(
boޗn_vue
) {

533 
n_vue
 = 1;

535 
n
 =

536 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_BOOLEAN
, 
l
, 
n_vue
);

538  
n
;

539 
	}
}

542 
	$code_cڋxt_boޗn
(

543 
ut8_t
 * 
du
,

544 
ut8_t
 
g_numb
,

545 
bo
 
boޗn_vue
)

547 
n
 = 0;

549 
n
 = 
	`code_g
(&
du
[0], (
ut8_t

g_numb
, 
ue
, 1);

550 
du
[
n
] = (
bo
(
boޗn_vue
 ? 1 : 0);

551 
n
++;

553  
n
;

554 
	}
}

556 
bo
 
	$decode_cڋxt_boޗn
(

557 
ut8_t
 * 
du
)

559 
bo
 
boޗn_vue
 = 
l
;

561 i(
du
[0]) {

562 
boޗn_vue
 = 
ue
;

565  
boޗn_vue
;

566 
	}
}

568 
	$decode_cڋxt_boޗn2
(

569 
ut8_t
 * 
du
,

570 
ut8_t
 
g_numb
,

571 
bo
 * 
boޗn_vue
)

573 
n
 = 0;

574 i(
	`decode_is_cڋxt_g_wh_ngth
(&
du
[
n
], 
g_numb
, &len)) {

575 i(
du
[
n
]) {

576 *
boޗn_vue
 = 
ue
;

578 *
boޗn_vue
 = 
l
;

580 
n
++;

582 
n
 = 
BACNET_STATUS_ERROR
;

584  
n
;

585 
	}
}

590 
bo
 
	$decode_boޗn
(

591 
ut32_t
 
n_vue
)

593 
bo
 
boޗn_vue
 = 
l
;

595 i(
n_vue
) {

596 
boޗn_vue
 = 
ue
;

599  
boޗn_vue
;

600 
	}
}

605 
	$code_iti_nu
(

606 
ut8_t
 * 
du
)

608  
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_NULL
, 
l
, 0);

609 
	}
}

611 
	$code_cڋxt_nu
(

612 
ut8_t
 * 
du
,

613 
ut8_t
 
g_numb
)

615  
	`code_g
(&
du
[0], 
g_numb
, 
ue
, 0);

616 
	}
}

618 
ut8_t
 
	$by_v_bs
(

619 
ut8_t
 
_by
)

621 
ut8_t
 
out_by
 = 0;

623 i(
_by
 & 
BIT0
) {

624 
out_by
 |
BIT7
;

626 i(
_by
 & 
BIT1
) {

627 
out_by
 |
BIT6
;

629 i(
_by
 & 
BIT2
) {

630 
out_by
 |
BIT5
;

632 i(
_by
 & 
BIT3
) {

633 
out_by
 |
BIT4
;

635 i(
_by
 & 
BIT4
) {

636 
out_by
 |
BIT3
;

638 i(
_by
 & 
BIT5
) {

639 
out_by
 |
BIT2
;

641 i(
_by
 & 
BIT6
) {

642 
out_by
 |
BIT1
;

644 i(
_by
 & 
BIT7
) {

645 
out_by
 |
BIT0
;

648  
out_by
;

649 
	}
}

653 
	$decode_brg
(

654 
ut8_t
 * 
du
,

655 
ut32_t
 
n_vue
,

656 
BACNET_BIT_STRING
 * 
b_rg
)

658 
n
 = 0;

659 
ut8_t
 
unud_bs
 = 0;

660 
ut32_t
 
i
 = 0;

661 
ut32_t
 
bys_ud
 = 0;

664 
	`brg_
(
b_rg
);

665 i(
n_vue
) {

667 
bys_ud
 = 
n_vue
 - 1;

668 i(
bys_ud
 <
MAX_BITSTRING_BYTES
) {

669 
n
 = 1;

670 
i
 = 0; i < 
bys_ud
; i++) {

671 
	`brg_t_o
(
b_rg
, (
ut8_t

i
,

672 
	`by_v_bs
(
du
[
n
++]));

674 
unud_bs
 = (
ut8_t
(
du
[0] & 0x07);

675 
	`brg_t_bs_ud
(
b_rg
, (
ut8_t

bys_ud
,

676 
unud_bs
);

680  
n
;

681 
	}
}

683 
	$decode_cڋxt_brg
(

684 
ut8_t
 * 
du
,

685 
ut8_t
 
g_numb
,

686 
BACNET_BIT_STRING
 * 
b_rg
)

688 
ut32_t
 
n_vue
;

689 
n
 = 0;

691 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 
g_numb
)) {

692 
n
 +=

693 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

694 
n
 +
	`decode_brg
(&
du
[n], 
n_vue
, 
b_rg
);

696 
n
 = 
BACNET_STATUS_ERROR
;

698  
n
;

699 
	}
}

704 
	$code_brg
(

705 
ut8_t
 * 
du
,

706 
BACNET_BIT_STRING
 * 
b_rg
)

708 
n
 = 0;

709 
ut8_t
 
mag_ud_bs
 = 0;

710 
ut8_t
 
ud_bys
 = 0;

711 
ut8_t
 
i
 = 0;

714 i(
	`brg_bs_ud
(
b_rg
) == 0) {

715 
du
[
n
++] = 0;

717 
ud_bys
 = 
	`brg_bys_ud
(
b_rg
);

718 
mag_ud_bs
 =

719 (
ut8_t
(
	`brg_bs_ud
(
b_rg
- ((
ud_bys
 -

722 
du
[
n
++] = (
ut8_t
(8 - 
mag_ud_bs
);

723 
i
 = 0; i < 
ud_bys
; i++) {

724 
du
[
n
++] = 
	`by_v_bs
(
	`brg_o
(
b_rg
, 
i
));

728  
n
;

729 
	}
}

731 
	$code_iti_brg
(

732 
ut8_t
 * 
du
,

733 
BACNET_BIT_STRING
 * 
b_rg
)

735 
n
 = 0;

736 
ut32_t
 
b_rg_coded_ngth
 = 1;

739 
b_rg_coded_ngth
 +
	`brg_bys_ud
(
b_rg
);

740 
n
 =

741 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_BIT_STRING
, 
l
,

742 
b_rg_coded_ngth
);

743 
n
 +
	`code_brg
(&
du
[n], 
b_rg
);

745  
n
;

746 
	}
}

748 
	$code_cڋxt_brg
(

749 
ut8_t
 * 
du
,

750 
ut8_t
 
g_numb
,

751 
BACNET_BIT_STRING
 * 
b_rg
)

753 
n
 = 0;

754 
ut32_t
 
b_rg_coded_ngth
 = 1;

757 
b_rg_coded_ngth
 +
	`brg_bys_ud
(
b_rg
);

758 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
ue
, 
b_rg_coded_ngth
);

759 
n
 +
	`code_brg
(&
du
[n], 
b_rg
);

761  
n
;

762 
	}
}

766 
	$decode_obje_id
(

767 
ut8_t
 * 
du
,

768 
ut16_t
 * 
obje_ty
,

769 
ut32_t
 * 

)

771 
ut32_t
 
vue
 = 0;

772 
n
 = 0;

774 
n
 = 
	`decode_unsigd32
(
du
, &
vue
);

775 *
obje_ty
 =

776 (
ut16_t
(((
vue
 >> 
BACNET_INSTANCE_BITS
& 
BACNET_MAX_OBJECT
));

777 *

 = (
vue
 & 
BACNET_MAX_INSTANCE
);

779  
n
;

780 
	}
}

782 
	$decode_obje_id_
(

783 
ut8_t
 * 
du
,

784 
ut32_t
 
n_vue
,

785 
ut16_t
 * 
obje_ty
,

786 
ut32_t
 * 

)

788 i(
n_vue
 != 4) {

791  
	`decode_obje_id
(
du
, 
obje_ty
, 

);

793 
	}
}

795 
	$decode_cڋxt_obje_id
(

796 
ut8_t
 * 
du
,

797 
ut8_t
 
g_numb
,

798 
ut16_t
 * 
obje_ty
,

799 
ut32_t
 * 

)

801 
n
 = 0;

803 i(
	`decode_is_cڋxt_g_wh_ngth
(&
du
[
n
], 
g_numb
, &len)) {

804 
n
 +
	`decode_obje_id
(&
du
[n], 
obje_ty
, 

);

806 
n
 = 
BACNET_STATUS_ERROR
;

808  
n
;

809 
	}
}

813 
	$code_ba_obje_id
(

814 
ut8_t
 * 
du
,

815 
obje_ty
,

816 
ut32_t
 

)

818 
ut32_t
 
vue
 = 0;

819 
ut32_t
 
ty
 = 0;

820 
n
 = 0;

822 
ty
 = (
ut32_t

obje_ty
;

823 
vue
 =

824 ((
ty
 & 
BACNET_MAX_OBJECT
<< 
BACNET_INSTANCE_BITS
| (

 &

825 
BACNET_MAX_INSTANCE
);

826 
n
 = 
	`code_unsigd32
(
du
, 
vue
);

828  
n
;

829 
	}
}

834 
	$code_cڋxt_obje_id
(

835 
ut8_t
 * 
du
,

836 
ut8_t
 
g_numb
,

837 
obje_ty
,

838 
ut32_t
 

)

840 
n
 = 0;

844 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
ue
, 4);

845 
n
 +
	`code_ba_obje_id
(&
du
[n], 
obje_ty
, 

);

847  
n
;

848 
	}
}

853 
	$code_iti_obje_id
(

854 
ut8_t
 * 
du
,

855 
obje_ty
,

856 
ut32_t
 

)

858 
n
 = 0;

861 
n
 = 
	`code_ba_obje_id
(&
du
[1], 
obje_ty
, 

);

862 
n
 +=

863 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_OBJECT_ID
, 
l
,

864 (
ut32_t

n
);

866  
n
;

867 
	}
}

869 #i
BACNET_USE_OCTETSTRING


873 
	$code_o_rg
(

874 
ut8_t
 * 
du
,

875 
BACNET_OCTET_STRING
 * 
o_rg
)

877 
n
 = 0;

878 
ut8_t
 *
vue
;

879 
i
 = 0;

881 i(
o_rg
) {

884 
n
 = (
	`org_ngth
(
o_rg
);

885 
vue
 = 
	`org_vue
(
o_rg
);

886 i(
vue
) {

887 
i
 = 0; i < 
n
; i++) {

888 
du
[
i
] = 
vue
[i];

893  
n
;

894 
	}
}

899 
	$code_iti_o_rg
(

900 
ut8_t
 * 
du
,

901 
BACNET_OCTET_STRING
 * 
o_rg
)

903 
du_n
 = 0;

905 i(
o_rg
) {

906 
du_n
 =

907 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_OCTET_STRING
, 
l
,

908 
	`org_ngth
(
o_rg
));

911 i((
du_n
 + 
	`org_ngth
(
o_rg
)< 
MAX_APDU
) {

912 
du_n
 +
	`code_o_rg
(&
du
[du_n], 
o_rg
);

914 
du_n
 = 0;

918  
du_n
;

919 
	}
}

924 
	$code_cڋxt_o_rg
(

925 
ut8_t
 * 
du
,

926 
ut8_t
 
g_numb
,

927 
BACNET_OCTET_STRING
 * 
o_rg
)

929 
du_n
 = 0;

931 i(
du
 && 
o_rg
) {

932 
du_n
 =

933 
	`code_g
(&
du
[0], 
g_numb
, 
ue
,

934 
	`org_ngth
(
o_rg
));

935 i((
du_n
 + 
	`org_ngth
(
o_rg
)< 
MAX_APDU
) {

936 
du_n
 +
	`code_o_rg
(&
du
[du_n], 
o_rg
);

938 
du_n
 = 0;

942  
du_n
;

943 
	}
}

948 
	$decode_o_rg
(

949 
ut8_t
 * 
du
,

950 
ut32_t
 
n_vue
,

951 
BACNET_OCTET_STRING
 * 
o_rg
)

953 
n
 = 0;

954 
bo
 
us
 = 
l
;

956 
us
 = 
	`org_
(
o_rg
, &
du
[0], 
n_vue
);

957 i(
us
) {

958 
n
 = (
n_vue
;

961  
n
;

962 
	}
}

964 
	$decode_cڋxt_o_rg
(

965 
ut8_t
 * 
du
,

966 
ut8_t
 
g_numb
,

967 
BACNET_OCTET_STRING
 * 
o_rg
)

969 
n
 = 0;

970 
bo
 
us
 = 
l
;

971 
ut32_t
 
n_vue
 = 0;

973 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 
g_numb
)) {

974 
n
 +=

975 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

977 
us
 = 
	`org_
(
o_rg
, &
du
[
n
], 
n_vue
);

979 i(
us
) {

980 
n
 +
n_vue
;

983 
n
 = 
BACNET_STATUS_ERROR
;

986  
n
;

987 
	}
}

992 
ut32_t
 
	$code_ba_cha_rg_
(

993 
ut8_t
 * 
du
,

994 
ut32_t
 
max_du
,

995 
ut8_t
 
codg
,

996 *
pSg
,

997 
ut32_t
 
ngth
)

999 
ut32_t
 
du_n
 = 1 ;

1000 
ut32_t
 
i
;

1002 
du_n
 +
ngth
;

1003 i(
du
 && (
du_n
 <
max_du
)) {

1004 
du
[0] = 
codg
;

1005 
i
 = 0; i < 
ngth
; i++) {

1006 
du
[1 + 
i
] = (
ut8_t

pSg
[i];

1009 
du_n
 = 0;

1012  
du_n
;

1013 
	}
}

1015 
	$code_ba_cha_rg
(

1016 
ut8_t
 * 
du
,

1017 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

1019  (
	`code_ba_cha_rg_
(
du
, 
MAX_APDU
,

1020 
	`charg_codg
(
ch_rg
),

1021 
	`charg_vue
(
ch_rg
),

1022 
	`charg_ngth
(
ch_rg
));

1023 
	}
}

1028 
	$code_iti_cha_rg
(

1029 
ut8_t
 * 
du
,

1030 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

1032 
n
 = 0;

1033 
rg_n
 = 0;

1035 
rg_n
 =

1036 (
	`charg_ngth
(
ch_rg
) + 1 ;

1037 
n
 =

1038 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_CHARACTER_STRING
, 
l
,

1039 (
ut32_t

rg_n
);

1040 i((
n
 + 
rg_n
< 
MAX_APDU
) {

1041 
n
 +
	`code_ba_cha_rg
(&
du
[n], 
ch_rg
);

1043 
n
 = 0;

1046  
n
;

1047 
	}
}

1049 
	$code_cڋxt_cha_rg
(

1050 
ut8_t
 * 
du
,

1051 
ut8_t
 
g_numb
,

1052 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

1054 
n
 = 0;

1055 
rg_n
 = 0;

1057 
rg_n
 =

1058 (
	`charg_ngth
(
ch_rg
) + 1 ;

1059 
n
 +
	`code_g
(&
du
[0], 
g_numb
, 
ue
, (
ut32_t

rg_n
);

1060 i((
n
 + 
rg_n
< 
MAX_APDU
) {

1061 
n
 +
	`code_ba_cha_rg
(&
du
[n], 
ch_rg
);

1063 
n
 = 0;

1066  
n
;

1067 
	}
}

1072 
	$decode_cha_rg
(

1073 
ut8_t
 * 
du
,

1074 
ut32_t
 
n_vue
,

1075 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

1077 
n
 = 0;

1078 
bo
 
us
 = 
l
;

1080 
us
 =

1081 
	`charg_
(
ch_rg
, 
du
[0], (*) &apdu[1],

1082 
n_vue
 - 1);

1083 i(
us
) {

1084 
n
 = (
n_vue
;

1087  
n
;

1088 
	}
}

1090 
	$decode_cڋxt_cha_rg
(

1091 
ut8_t
 * 
du
,

1092 
ut8_t
 
g_numb
,

1093 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

1095 
n
 = 0;

1096 
bo
 
us
 = 
l
;

1097 
ut32_t
 
n_vue
 = 0;

1099 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 
g_numb
)) {

1100 
n
 +=

1101 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

1103 
us
 =

1104 
	`charg_
(
ch_rg
, 
du
[
n
],

1105 (*&
du
[
n
 + 1], 
n_vue
 - 1);

1106 i(
us
) {

1107 
n
 +
n_vue
;

1110 
n
 = 
BACNET_STATUS_ERROR
;

1113  
n
;

1114 
	}
}

1119 
	$decode_unsigd
(

1120 
ut8_t
 * 
du
,

1121 
ut32_t
 
n_vue
,

1122 
ut32_t
 * 
vue
)

1124 
ut16_t
 
unsigd16_vue
 = 0;

1126 i(
vue
) {

1127 
n_vue
) {

1129 *
vue
 = 
du
[0];

1132 
	`decode_unsigd16
(&
du
[0], &
unsigd16_vue
);

1133 *
vue
 = 
unsigd16_vue
;

1136 
	`decode_unsigd24
(&
du
[0], 
vue
);

1139 
	`decode_unsigd32
(&
du
[0], 
vue
);

1142 *
vue
 = 0;

1147  (
n_vue
;

1148 
	}
}

1150 
	$decode_cڋxt_unsigd
(

1151 
ut8_t
 * 
du
,

1152 
ut8_t
 
g_numb
,

1153 
ut32_t
 * 
vue
)

1155 
ut32_t
 
n_vue
;

1156 
n
 = 0;

1158 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 
g_numb
)) {

1159 
n
 +=

1160 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

1161 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, 
vue
);

1163 
n
 = 
BACNET_STATUS_ERROR
;

1165  
n
;

1166 
	}
}

1172 
	$code_ba_unsigd
(

1173 
ut8_t
 * 
du
,

1174 
ut32_t
 
vue
)

1176 
n
 = 0;

1178 i(
vue
 < 0x100) {

1179 
du
[0] = (
ut8_t

vue
;

1180 
n
 = 1;

1181 } i(
vue
 < 0x10000) {

1182 
n
 = 
	`code_unsigd16
(&
du
[0], (
ut16_t

vue
);

1183 } i(
vue
 < 0x1000000) {

1184 
n
 = 
	`code_unsigd24
(&
du
[0], 
vue
);

1186 
n
 = 
	`code_unsigd32
(&
du
[0], 
vue
);

1189  
n
;

1190 
	}
}

1195 
	$code_cڋxt_unsigd
(

1196 
ut8_t
 * 
du
,

1197 
ut8_t
 
g_numb
,

1198 
ut32_t
 
vue
)

1200 
n
 = 0;

1203 i(
vue
 < 0x100) {

1204 
n
 = 1;

1205 } i(
vue
 < 0x10000) {

1206 
n
 = 2;

1207 } i(
vue
 < 0x1000000) {

1208 
n
 = 3;

1210 
n
 = 4;

1213 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
ue
, (
ut32_t
)en);

1214 
n
 +
	`code_ba_unsigd
(&
du
[n], 
vue
);

1216  
n
;

1217 
	}
}

1222 
	$code_iti_unsigd
(

1223 
ut8_t
 * 
du
,

1224 
ut32_t
 
vue
)

1226 
n
 = 0;

1228 
n
 = 
	`code_ba_unsigd
(&
du
[1], 
vue
);

1229 
n
 +=

1230 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_UNSIGNED_INT
, 
l
,

1231 (
ut32_t

n
);

1233  
n
;

1234 
	}
}

1239 
	$decode_umed
(

1240 
ut8_t
 * 
du
,

1241 
ut32_t
 
n_vue
,

1242 
ut32_t
 * 
vue
)

1244 
ut32_t
 
unsigd_vue
 = 0;

1245 
n
;

1247 
n
 = 
	`decode_unsigd
(
du
, 
n_vue
, &
unsigd_vue
);

1248 i(
vue
) {

1249 *
vue
 = 
unsigd_vue
;

1252  
n
;

1253 
	}
}

1255 
	$decode_cڋxt_umed
(

1256 
ut8_t
 * 
du
,

1257 
ut8_t
 
g_vue
,

1258 
ut32_t
 * 
vue
)

1260 
n
 = 0;

1261 
ut8_t
 
g_numb
;

1262 
ut32_t
 
n_vue
;

1264 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 
g_vue
)) {

1265 
n
 +=

1266 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

1267 
n
 +
	`decode_umed
(&
du
[n], 
n_vue
, 
vue
);

1269 
n
 = 
BACNET_STATUS_ERROR
;

1271  
n
;

1272 
	}
}

1277 
	$code_ba_umed
(

1278 
ut8_t
 * 
du
,

1279 
ut32_t
 
vue
)

1281  
	`code_ba_unsigd
(
du
, 
vue
);

1282 
	}
}

1287 
	$code_iti_umed
(

1288 
ut8_t
 * 
du
,

1289 
ut32_t
 
vue
)

1291 
n
 = 0;

1294 
n
 = 
	`code_ba_umed
(&
du
[1], 
vue
);

1295 
n
 +=

1296 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_ENUMERATED
, 
l
,

1297 (
ut32_t

n
);

1299  
n
;

1300 
	}
}

1305 
	$code_cڋxt_umed
(

1306 
ut8_t
 * 
du
,

1307 
ut8_t
 
g_numb
,

1308 
ut32_t
 
vue
)

1310 
n
 = 0;

1313 i(
vue
 < 0x100) {

1314 
n
 = 1;

1315 } i(
vue
 < 0x10000) {

1316 
n
 = 2;

1317 } i(
vue
 < 0x1000000) {

1318 
n
 = 3;

1320 
n
 = 4;

1323 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
ue
, (
ut32_t
)en);

1324 
n
 +
	`code_ba_umed
(&
du
[n], 
vue
);

1326  
n
;

1327 
	}
}

1329 #i
BACNET_USE_SIGNED


1333 
	$decode_sigd
(

1334 
ut8_t
 * 
du
,

1335 
ut32_t
 
n_vue
,

1336 
t32_t
 * 
vue
)

1338 i(
vue
) {

1339 
n_vue
) {

1341 
	`decode_sigd8
(&
du
[0], 
vue
);

1344 
	`decode_sigd16
(&
du
[0], 
vue
);

1347 
	`decode_sigd24
(&
du
[0], 
vue
);

1350 
	`decode_sigd32
(&
du
[0], 
vue
);

1353 *
vue
 = 0;

1358  (
n_vue
;

1359 
	}
}

1361 
	$decode_cڋxt_sigd
(

1362 
ut8_t
 * 
du
,

1363 
ut8_t
 
g_numb
,

1364 
t32_t
 * 
vue
)

1366 
ut32_t
 
n_vue
;

1367 
n
 = 0;

1369 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 
g_numb
)) {

1370 
n
 +=

1371 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

1372 
n
 +
	`decode_sigd
(&
du
[n], 
n_vue
, 
vue
);

1374 
n
 = 
BACNET_STATUS_ERROR
;

1376  
n
;

1377 
	}
}

1382 
	$code_ba_sigd
(

1383 
ut8_t
 * 
du
,

1384 
t32_t
 
vue
)

1386 
n
 = 0;

1393 i((
vue
 >= -128) && (value < 128)) {

1394 
n
 = 
	`code_sigd8
(&
du
[0], (
t8_t

vue
);

1395 } i((
vue
 >= -32768) && (value < 32768)) {

1396 
n
 = 
	`code_sigd16
(&
du
[0], (
t16_t

vue
);

1397 } i((
vue
 > -8388608) && (value < 8388608)) {

1398 
n
 = 
	`code_sigd24
(&
du
[0], 
vue
);

1400 
n
 = 
	`code_sigd32
(&
du
[0], 
vue
);

1403  
n
;

1404 
	}
}

1409 
	$code_iti_sigd
(

1410 
ut8_t
 * 
du
,

1411 
t32_t
 
vue
)

1413 
n
 = 0;

1416 
n
 = 
	`code_ba_sigd
(&
du
[1], 
vue
);

1417 
n
 +=

1418 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_SIGNED_INT
, 
l
,

1419 (
ut32_t

n
);

1421  
n
;

1422 
	}
}

1427 
	$code_cڋxt_sigd
(

1428 
ut8_t
 * 
du
,

1429 
ut8_t
 
g_numb
,

1430 
t32_t
 
vue
)

1432 
n
 = 0;

1435 i((
vue
 >= -128) && (value < 128)) {

1436 
n
 = 1;

1437 } i((
vue
 >= -32768) && (value < 32768)) {

1438 
n
 = 2;

1439 } i((
vue
 > -8388608) && (value < 8388608)) {

1440 
n
 = 3;

1442 
n
 = 4;

1445 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
ue
, (
ut32_t
)en);

1446 
n
 +
	`code_ba_sigd
(&
du
[n], 
vue
);

1448  
n
;

1449 
	}
}

1455 
	$code_iti_
(

1456 
ut8_t
 * 
du
,

1457 
vue
)

1459 
n
 = 0;

1462 
n
 = 
	`code_ba_
(
vue
, &
du
[1]);

1463 
n
 +=

1464 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_REAL
, 
l
,

1465 (
ut32_t

n
);

1467  
n
;

1468 
	}
}

1470 
	$code_cڋxt_
(

1471 
ut8_t
 * 
du
,

1472 
ut8_t
 
g_numb
,

1473 
vue
)

1475 
n
 = 0;

1478 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
ue
, 4);

1479 
n
 +
	`code_ba_
(
vue
, &
du
[len]);

1480  
n
;

1481 
	}
}

1483 #i
BACNET_USE_DOUBLE


1487 
	$code_iti_doub
(

1488 
ut8_t
 * 
du
,

1489 
vue
)

1491 
n
 = 0;

1494 
n
 = 
	`code_ba_doub
(
vue
, &
du
[2]);

1496 
n
 +=

1497 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_DOUBLE
, 
l
,

1498 (
ut32_t

n
);

1500  
n
;

1501 
	}
}

1503 
	$code_cڋxt_doub
(

1504 
ut8_t
 * 
du
,

1505 
ut8_t
 
g_numb
,

1506 
vue
)

1508 
n
 = 0;

1511 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
ue
, 8);

1512 
n
 +
	`code_ba_doub
(
vue
, &
du
[len]);

1514  
n
;

1515 
	}
}

1521 
	$code_ba_time
(

1522 
ut8_t
 * 
du
,

1523 
BACNET_TIME
 * 
btime
)

1525 
du
[0] = 
btime
->
hour
;

1526 
du
[1] = 
btime
->
m
;

1527 
du
[2] = 
btime
->
c
;

1528 
du
[3] = 
btime
->
hunddths
;

1531 
	}
}

1536 
	$code_iti_time
(

1537 
ut8_t
 * 
du
,

1538 
BACNET_TIME
 * 
btime
)

1540 
n
 = 0;

1543 
n
 = 
	`code_ba_time
(&
du
[1], 
btime
);

1544 
n
 +=

1545 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_TIME
, 
l
,

1546 (
ut32_t

n
);

1548  
n
;

1549 
	}
}

1551 
	$code_cڋxt_time
(

1552 
ut8_t
 * 
du
,

1553 
ut8_t
 
g_numb
,

1554 
BACNET_TIME
 * 
btime
)

1556 
n
 = 0;

1559 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
ue
, 4);

1560 
n
 +
	`code_ba_time
(&
du
[n], 
btime
);

1562  
n
;

1563 
	}
}

1568 
	$decode_ba_time
(

1569 
ut8_t
 * 
du
,

1570 
BACNET_TIME
 * 
btime
)

1572 
btime
->
hour
 = 
du
[0];

1573 
btime
->
m
 = 
du
[1];

1574 
btime
->
c
 = 
du
[2];

1575 
btime
->
hunddths
 = 
du
[3];

1578 
	}
}

1580 
	$decode_ba_time_
(

1581 
ut8_t
 * 
du
,

1582 
ut32_t
 
n_vue
,

1583 
BACNET_TIME
 * 
btime
)

1585 i(
n_vue
 != 4) {

1586 
btime
->
hour
 = 0;

1587 
btime
->
hunddths
 = 0;

1588 
btime
->
m
 = 0;

1589 
btime
->
c
 = 0;

1590  (
n_vue
;

1592  
	`decode_ba_time
(
du
, 
btime
);

1594 
	}
}

1596 
	$decode_iti_time
(

1597 
ut8_t
 * 
du
,

1598 
BACNET_TIME
 * 
btime
)

1600 
n
 = 0;

1601 
ut8_t
 
g_numb
;

1602 
	`decode_g_numb
(&
du
[
n
], &
g_numb
);

1604 i(
g_numb
 =
BACNET_APPLICATION_TAG_TIME
) {

1605 
n
++;

1606 
n
 +
	`decode_ba_time
(&
du
[n], 
btime
);

1608 
n
 = 
BACNET_STATUS_ERROR
;

1610  
n
;

1611 
	}
}

1614 
	$decode_cڋxt_ba_time
(

1615 
ut8_t
 * 
du
,

1616 
ut8_t
 
g_numb
,

1617 
BACNET_TIME
 * 
btime
)

1619 
n
 = 0;

1621 i(
	`decode_is_cڋxt_g_wh_ngth
(&
du
[
n
], 
g_numb
, &len)) {

1622 
n
 +
	`decode_ba_time
(&
du
[n], 
btime
);

1624 
n
 = 
BACNET_STATUS_ERROR
;

1626  
n
;

1627 
	}
}

1639 
	$code_ba_de
(

1640 
ut8_t
 * 
du
,

1641 
BACNET_DATE
 * 
bde
)

1644 i(
bde
->
yr
 >= 1900) {

1645 
du
[0] = (
ut8_t
(
bde
->
yr
 - 1900);

1646 } i(
bde
->
yr
 < 0x100) {

1647 
du
[0] = (
ut8_t

bde
->
yr
;

1653  
BACNET_STATUS_ERROR
;

1657 
du
[1] = 
bde
->
mth
;

1658 
du
[2] = 
bde
->
day
;

1659 
du
[3] = 
bde
->
wday
;

1662 
	}
}

1668 
	$code_iti_de
(

1669 
ut8_t
 * 
du
,

1670 
BACNET_DATE
 * 
bde
)

1672 
n
 = 0;

1675 
n
 = 
	`code_ba_de
(&
du
[1], 
bde
);

1676 
n
 +=

1677 
	`code_g
(&
du
[0], 
BACNET_APPLICATION_TAG_DATE
, 
l
,

1678 (
ut32_t

n
);

1680  
n
;

1682 
	}
}

1684 
	$code_cڋxt_de
(

1685 
ut8_t
 * 
du
,

1686 
ut8_t
 
g_numb
,

1687 
BACNET_DATE
 * 
bde
)

1689 
n
 = 0;

1692 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
ue
, 4);

1693 
n
 +
	`code_ba_de
(&
du
[n], 
bde
);

1695  
n
;

1696 
	}
}

1701 
	$decode_de
(

1702 
ut8_t
 * 
du
,

1703 
BACNET_DATE
 * 
bde
)

1705 
bde
->
yr
 = (
ut16_t
(
du
[0] + 1900);

1706 
bde
->
mth
 = 
du
[1];

1707 
bde
->
day
 = 
du
[2];

1708 
bde
->
wday
 = 
du
[3];

1711 
	}
}

1713 
	$decode_de_
(

1714 
ut8_t
 * 
du
,

1715 
ut32_t
 
n_vue
,

1716 
BACNET_DATE
 * 
bde
)

1718 i(
n_vue
 != 4) {

1719 
bde
->
day
 = 0;

1720 
bde
->
mth
 = 0;

1721 
bde
->
wday
 = 0;

1722 
bde
->
yr
 = 0;

1723  (
n_vue
;

1725  
	`decode_de
(
du
, 
bde
);

1727 
	}
}

1730 
	$decode_iti_de
(

1731 
ut8_t
 * 
du
,

1732 
BACNET_DATE
 * 
bde
)

1734 
n
 = 0;

1735 
ut8_t
 
g_numb
;

1736 
	`decode_g_numb
(&
du
[
n
], &
g_numb
);

1738 i(
g_numb
 =
BACNET_APPLICATION_TAG_DATE
) {

1739 
n
++;

1740 
n
 +
	`decode_de
(&
du
[n], 
bde
);

1742 
n
 = 
BACNET_STATUS_ERROR
;

1744  
n
;

1745 
	}
}

1747 
	$decode_cڋxt_de
(

1748 
ut8_t
 * 
du
,

1749 
ut8_t
 
g_numb
,

1750 
BACNET_DATE
 * 
bde
)

1752 
n
 = 0;

1754 i(
	`decode_is_cڋxt_g_wh_ngth
(&
du
[
n
], 
g_numb
, &len)) {

1755 
n
 +
	`decode_de
(&
du
[n], 
bde
);

1757 
n
 = 
BACNET_STATUS_ERROR
;

1759  
n
;

1760 
	}
}

1765 
	$code_sime_ack
(

1766 
ut8_t
 * 
du
,

1767 
ut8_t
 
voke_id
,

1768 
ut8_t
 
rvi_choi
)

1770 
du
[0] = 
PDU_TYPE_SIMPLE_ACK
;

1771 
du
[1] = 
voke_id
;

1772 
du
[2] = 
rvi_choi
;

1775 
	}
}

1778 #ifde
TEST


1779 
	~<as.h
>

1780 
	~<rg.h
>

1781 
	~<y.h
>

1782 
	~"e.h
"

1784 
	$g_du_n
(

1785 
bo
 
exnded_g
,

1786 
ut32_t
 
vue
)

1788 
_n
 = 1;

1790 i(
exnded_g
) {

1791 
_n
++;

1793 i(
vue
 <= 4) {

1794 
_n
 += 0;

1795 } i(
vue
 <= 253) {

1796 
_n
 += 1;

1797 } i(
vue
 <= 65535) {

1798 
_n
 += 3;

1800 
_n
 += 5;

1803  
_n
;

1804 
	}
}

1806 
	$t_du
(

1807 
ut8_t
 * 
pBlock
,

1808 
ut32_t
 
num
)

1810 
size_t
 
les
 = 0;

1811 
size_t
 
le
 = 0;

1812 
size_t
 
ϡ_le
 = 0;

1813 
cou
 = 0;

1814 
i
 = 0;

1816 i(
pBlock
 && 
num
) {

1818 
num
--;

1819 
les
 = (
num
 / 16) + 1;

1820 
ϡ_le
 = 
num
 % 16;

1823 
le
 = 0;< 
les
;ine++) {

1825 
	`tf
("%08lX: ", 
cou
);

1827 
i
 = 0; i < 16; i++) {

1828 i(((
le
 =(
les
 - 1)&& (
i
 <
ϡ_le
)) ||

1829 (
le
 !(
les
 - 1))) {

1830 
	`tf
("%02X ", ((0x00FF & 
pBlock
[
i
]));

1832 
	`tf
("-- ");

1835 
	`tf
(" ");

1837 
i
 = 0; i < 16; i++) {

1838 i(((
le
 =(
les
 - 1)&& (
i
 <
ϡ_le
)) ||

1839 (
le
 !(
les
 - 1))) {

1840 i(
	`irt
(
pBlock
[
i
])) {

1841 
	`tf
("%c", 
pBlock
[
i
]);

1843 
	`tf
(".");

1846 
	`tf
(".");

1849 
	`tf
("\r\n");

1850 
pBlock
 += 16;

1851 
cou
 += 16;

1856 
	}
}

1858 
	$BACDCodeTags
(

1859 
Te
 * 
pTe
)

1861 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

1862 
ut8_t
 
g_numb
 = 0, 
_g_numb
 = 0;

1863 
n
 = 0, 
_n
 = 0;

1864 
ut32_t
 
vue
 = 0, 
_vue
 = 0;

1866 
g_numb
 = 0;;ag_number++) {

1867 
n
 = 
	`code_ݒg_g
(&
du
[0], 
g_numb
);

1868 
_n
 = 
	`g_du_n
(
	`IS_EXTENDED_TAG_NUMBER
(
du
[0]), 0);

1869 
	`_
(
pTe
, 
n
 =
_n
);

1870 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
_g_numb
, &
vue
);

1871 
	`_
(
pTe
, 
vue
 == 0);

1872 
	`_
(
pTe
, 
n
 =
_n
);

1873 
	`_
(
pTe
, 
g_numb
 =
_g_numb
);

1874 
	`_
(
pTe
, 
	`IS_OPENING_TAG
(
du
[0]=
ue
);

1875 
	`_
(
pTe
, 
	`IS_CLOSING_TAG
(
du
[0]=
l
);

1876 
n
 = 
	`code_osg_g
(&
du
[0], 
g_numb
);

1877 
	`_
(
pTe
, 
n
 =
_n
);

1878 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
_g_numb
, &
vue
);

1879 
	`_
(
pTe
, 
n
 =
_n
);

1880 
	`_
(
pTe
, 
vue
 == 0);

1881 
	`_
(
pTe
, 
g_numb
 =
_g_numb
);

1882 
	`_
(
pTe
, 
	`IS_OPENING_TAG
(
du
[0]=
l
);

1883 
	`_
(
pTe
, 
	`IS_CLOSING_TAG
(
du
[0]=
ue
);

1885 
vue
 = 1;; value = value << 1) {

1886 
n
 = 
	`code_g
(&
du
[0], 
g_numb
, 
l
, 
vue
);

1887 
n
 =

1888 
	`decode_g_numb_d_vue
(&
du
[0], &
_g_numb
,

1889 &
_vue
);

1890 
	`_
(
pTe
, 
g_numb
 =
_g_numb
);

1891 
	`_
(
pTe
, 
vue
 =
_vue
);

1892 
_n
 = 
	`g_du_n
(
	`IS_EXTENDED_TAG_NUMBER
(
du
[0]), 
vue
);

1893 
	`_
(
pTe
, 
n
 =
_n
);

1895 i(
vue
 & 
BIT31
) {

1900 i(
g_numb
 == 255) {

1906 
	}
}

1908 
	$BACDCodeEnumed
(

1909 
Te
 * 
pTe
)

1911 
ut8_t
 
y
[5] = { 0 };

1912 
ut8_t
 
coded_y
[5] = { 0 };

1913 
ut32_t
 
vue
 = 1;

1914 
ut32_t
 
decoded_vue
 = 0;

1915 
i
 = 0, 
du_n
 = 0;

1916 
n
 = 0;

1917 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

1918 
ut8_t
 
g_numb
 = 0;

1919 
ut32_t
 
n_vue
 = 0;

1921 
i
 = 0; i < 31; i++) {

1922 
du_n
 = 
	`code_iti_umed
(&
y
[0], 
vue
);

1923 
n
 = 
	`decode_g_numb_d_vue
(&
y
[0], &
g_numb
, &
n_vue
);

1924 
n
 +
	`decode_umed
(&
y
[n], 
n_vue
, &
decoded_vue
);

1925 
	`_
(
pTe
, 
decoded_vue
 =
vue
);

1926 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_ENUMERATED
);

1927 
	`_
(
pTe
, 
n
 =
du_n
);

1929 
	`code_iti_umed
(&
coded_y
[0], 
decoded_vue
);

1930 
	`_
(
pTe
, 
	`memcmp
(&
y
[0], &
coded_y
[0],

1931 (
y
)) == 0);

1934 
du_n
 = 
	`code_iti_umed
(&
du
[0], 
vue
);

1935 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, 
NULL
);

1936 
	`_
(
pTe
, 
n
 == 1);

1937 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_ENUMERATED
);

1938 
	`_
(
pTe
, 
	`IS_CONTEXT_SPECIFIC
(
du
[0]=
l
);

1940 
du_n
 = 
	`code_cڋxt_umed
(&
du
[0], 3, 
vue
);

1941 
	`_
(
pTe
, 
	`IS_CONTEXT_SPECIFIC
(
du
[0]=
ue
);

1942 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, 
NULL
);

1943 
	`_
(
pTe
, 
n
 == 1);

1944 
	`_
(
pTe
, 
g_numb
 == 3);

1946 
vue
 = value << 1;

1950 
	}
}

1952 
	$BACDCodeRl
(

1953 
Te
 * 
pTe
)

1955 
ut8_t
 
_y
[4] = { 0 };

1956 
ut8_t
 
coded_y
[4] = { 0 };

1957 
vue
 = 42.123F;

1958 
decoded_vue
 = 0.0F;

1959 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

1960 
n
 = 0, 
du_n
 = 0;

1961 
ut8_t
 
g_numb
 = 0;

1962 
ut32_t
 
lg_vue
 = 0;

1964 
	`code_ba_
(
vue
, &
_y
[0]);

1965 
	`decode_
(&
_y
[0], &
decoded_vue
);

1966 
	`_
(
pTe
, 
decoded_vue
 =
vue
);

1967 
	`code_ba_
(
vue
, &
coded_y
[0]);

1968 
	`_
(
pTe
, 
	`memcmp
(&
_y
, &
coded_y
,

1969 (
_y
)) == 0);

1972 
du_n
 = 
	`code_iti_
(&
du
[0], 
vue
);

1973 
	`_
(
pTe
, 
du_n
 == 5);

1975 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
lg_vue
);

1976 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_REAL
);

1977 
	`_
(
pTe
, 
	`IS_CONTEXT_SPECIFIC
(
du
[0]=
l
);

1978 
	`_
(
pTe
, 
n
 == 1);

1979 
	`_
(
pTe
, 
lg_vue
 == 4);

1980 
	`decode_
(&
du
[
n
], &
decoded_vue
);

1981 
	`_
(
pTe
, 
decoded_vue
 =
vue
);

1984 
	}
}

1986 
	$BACDCodeDoub
(

1987 
Te
 * 
pTe
)

1989 
ut8_t
 
doub_y
[8] = { 0 };

1990 
ut8_t
 
coded_y
[8] = { 0 };

1991 
vue
 = 42.123;

1992 
decoded_vue
 = 0.0;

1993 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

1994 
n
 = 0, 
du_n
 = 0;

1995 
ut8_t
 
g_numb
 = 0;

1996 
ut32_t
 
lg_vue
 = 0;

1998 
	`code_ba_doub
(
vue
, &
doub_y
[0]);

1999 
	`decode_doub
(&
doub_y
[0], &
decoded_vue
);

2000 
	`_
(
pTe
, 
decoded_vue
 =
vue
);

2001 
	`code_ba_doub
(
vue
, &
coded_y
[0]);

2002 
	`_
(
pTe
, 
	`memcmp
(&
doub_y
, &
coded_y
,

2003 (
doub_y
)) == 0);

2006 
du_n
 = 
	`code_iti_doub
(&
du
[0], 
vue
);

2007 
	`_
(
pTe
, 
du_n
 == 10);

2009 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
lg_vue
);

2010 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_DOUBLE
);

2011 
	`_
(
pTe
, 
	`IS_CONTEXT_SPECIFIC
(
du
[0]=
l
);

2012 
	`_
(
pTe
, 
n
 == 2);

2013 
	`_
(
pTe
, 
lg_vue
 == 8);

2014 
	`decode_doub
(&
du
[
n
], &
decoded_vue
);

2015 
	`_
(
pTe
, 
decoded_vue
 =
vue
);

2018 
	}
}

2020 
	$BACDCodeUnsigdVue
(

2021 
Te
 * 
pTe
,

2022 
ut32_t
 
vue
)

2024 
ut8_t
 
y
[5] = { 0 };

2025 
ut8_t
 
coded_y
[5] = { 0 };

2026 
ut32_t
 
decoded_vue
 = 0;

2027 
n
;

2028 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

2029 
ut8_t
 
g_numb
 = 0;

2030 
ut32_t
 
n_vue
 = 0;

2032 
n_vue
 = 
	`code_iti_unsigd
(&
y
[0], 
vue
);

2033 
n
 = 
	`decode_g_numb_d_vue
(&
y
[0], &
g_numb
, &
n_vue
);

2034 
n
 = 
	`decode_unsigd
(&
y
[n], 
n_vue
, &
decoded_vue
);

2035 
	`_
(
pTe
, 
decoded_vue
 =
vue
);

2036 i(
decoded_vue
 !
vue
) {

2037 
	`tf
("vue=%lu decoded_vue=%lu\n", (
vue
,

2038 (
decoded_vue
);

2039 
	`t_du
(&
y
[0], (array));

2041 
	`code_iti_unsigd
(&
coded_y
[0], 
decoded_vue
);

2042 
	`_
(
pTe
, 
	`memcmp
(&
y
[0], &
coded_y
[0], (array)) == 0);

2045 
	`code_iti_unsigd
(&
du
[0], 
vue
);

2047 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, 
NULL
);

2048 
	`_
(
pTe
, 
n
 == 1);

2049 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_UNSIGNED_INT
);

2050 
	`_
(
pTe
, 
	`IS_CONTEXT_SPECIFIC
(
du
[0]=
l
);

2051 
	}
}

2053 
	$BACDCodeUnsigd
(

2054 
Te
 * 
pTe
)

2056 
ut32_t
 
vue
 = 1;

2057 
i
;

2059 
i
 = 0; i < 32; i++) {

2060 
	`BACDCodeUnsigdVue
(
pTe
, 
vue
 - 1);

2061 
	`BACDCodeUnsigdVue
(
pTe
, 
vue
);

2062 
	`BACDCodeUnsigdVue
(
pTe
, 
vue
 + 1);

2063 
vue
 = value << 1;

2067 
	}
}

2069 
	$BACtUnsigd
(

2070 
Te
 * 
pTe
)

2072 
ut8_t
 
du
[32] = { 0 };

2073 
ut32_t
 
vue
 = 0, 
_vue
 = 0;

2074 
n
 = 0, 
_n
 = 0;

2076 
vue
 = 0;; value += 0xFF) {

2077 
n
 = 
	`code_ba_unsigd
(&
du
[0], 
vue
);

2078 
_n
 = 
	`decode_unsigd
(&
du
[0], 
n
, &
_vue
);

2079 
	`_
(
pTe
, 
n
 =
_n
);

2080 
	`_
(
pTe
, 
vue
 =
_vue
);

2081 i(
vue
 == 0xFFFFFFFF)

2084 
	}
}

2086 
	$BACDCodeSigdVue
(

2087 
Te
 * 
pTe
,

2088 
t32_t
 
vue
)

2090 
ut8_t
 
y
[5] = { 0 };

2091 
ut8_t
 
coded_y
[5] = { 0 };

2092 
t32_t
 
decoded_vue
 = 0;

2093 
n
 = 0;

2094 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

2095 
ut8_t
 
g_numb
 = 0;

2096 
ut32_t
 
n_vue
 = 0;

2097 
diff
 = 0;

2099 
n
 = 
	`code_iti_sigd
(&
y
[0], 
vue
);

2100 
n
 = 
	`decode_g_numb_d_vue
(&
y
[0], &
g_numb
, &
n_vue
);

2101 
n
 = 
	`decode_sigd
(&
y
[n], 
n_vue
, &
decoded_vue
);

2102 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_SIGNED_INT
);

2103 
	`_
(
pTe
, 
decoded_vue
 =
vue
);

2104 i(
decoded_vue
 !
vue
) {

2105 
	`tf
("vue=%ld decoded_vue=%ld\n", (
vue
,

2106 (
decoded_vue
);

2107 
	`t_du
(&
y
[0], (array));

2109 
	`code_iti_sigd
(&
coded_y
[0], 
decoded_vue
);

2110 
diff
 = 
	`memcmp
(&
y
[0], &
coded_y
[0], (array));

2111 
	`_
(
pTe
, 
diff
 == 0);

2112 i(
diff
) {

2113 
	`tf
("vue=%ld decoded_vue=%ld\n", (
vue
,

2114 (
decoded_vue
);

2115 
	`t_du
(&
y
[0], (array));

2116 
	`t_du
(&
coded_y
[0], (
y
));

2120 
	`code_iti_sigd
(&
du
[0], 
vue
);

2121 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, 
NULL
);

2122 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_SIGNED_INT
);

2123 
	`_
(
pTe
, 
	`IS_CONTEXT_SPECIFIC
(
du
[0]=
l
);

2126 
	}
}

2128 
	$BACDCodeSigd
(

2129 
Te
 * 
pTe
)

2131 
vue
 = 1;

2132 
i
 = 0;

2134 
i
 = 0; i < 32; i++) {

2135 
	`BACDCodeSigdVue
(
pTe
, 
vue
 - 1);

2136 
	`BACDCodeSigdVue
(
pTe
, 
vue
);

2137 
	`BACDCodeSigdVue
(
pTe
, 
vue
 + 1);

2138 
vue
 = value << 1;

2141 
	`BACDCodeSigdVue
(
pTe
, -1);

2142 
vue
 = -2;

2143 
i
 = 0; i < 32; i++) {

2144 
	`BACDCodeSigdVue
(
pTe
, 
vue
 - 1);

2145 
	`BACDCodeSigdVue
(
pTe
, 
vue
);

2146 
	`BACDCodeSigdVue
(
pTe
, 
vue
 + 1);

2147 
vue
 = value << 1;

2151 
	}
}

2153 
	$BACtSigd
(

2154 
Te
 * 
pTe
)

2156 
ut8_t
 
du
[32] = { 0 };

2157 
t32_t
 
vue
 = 0, 
_vue
 = 0;

2158 
n
 = 0, 
_n
 = 0;

2160 
vue
 = -2147483647; value < 0; value += 127) {

2161 
n
 = 
	`code_ba_sigd
(&
du
[0], 
vue
);

2162 
_n
 = 
	`decode_sigd
(&
du
[0], 
n
, &
_vue
);

2163 
	`_
(
pTe
, 
n
 =
_n
);

2164 
	`_
(
pTe
, 
vue
 =
_vue
);

2166 
vue
 = 2147483647; value > 0; value -= 127) {

2167 
n
 = 
	`code_ba_sigd
(&
du
[0], 
vue
);

2168 
_n
 = 
	`decode_sigd
(&
du
[0], 
n
, &
_vue
);

2169 
	`_
(
pTe
, 
n
 =
_n
);

2170 
	`_
(
pTe
, 
vue
 =
_vue
);

2172 
	}
}

2174 
	$BACDCodeOSg
(

2175 
Te
 * 
pTe
)

2177 
ut8_t
 
y
[
MAX_APDU
] = { 0 };

2178 
ut8_t
 
coded_y
[
MAX_APDU
] = { 0 };

2179 
BACNET_OCTET_STRING
 
o_rg
;

2180 
BACNET_OCTET_STRING
 
_o_rg
;

2181 
ut8_t
 
_vue
[
MAX_APDU
] = { "" };

2182 
i
;

2183 
du_n
;

2184 
n
;

2185 
ut8_t
 
g_numb
 = 0;

2186 
ut32_t
 
n_vue
 = 0;

2187 
bo
 
us
 = 
l
;

2188 
diff
 = 0;

2190 
us
 = 
	`org_
(&
o_rg
, 
NULL
, 0);

2191 
	`_
(
pTe
, 
us
 =
ue
);

2192 
du_n
 = 
	`code_iti_o_rg
(&
y
[0], &
o_rg
);

2193 
n
 = 
	`decode_g_numb_d_vue
(&
y
[0], &
g_numb
, &
n_vue
);

2194 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OCTET_STRING
);

2195 
n
 +
	`decode_o_rg
(&
y
[n], 
n_vue
, &
_o_rg
);

2196 
	`_
(
pTe
, 
du_n
 =
n
);

2197 
diff
 =

2198 
	`memcmp
(
	`org_vue
(&
o_rg
), &
_vue
[0],

2199 
	`org_ngth
(&
o_rg
));

2200 
	`_
(
pTe
, 
diff
 == 0);

2202 
i
 = 0; i < (
MAX_APDU
 - 6); i++) {

2203 
_vue
[
i
] = '0' + (i % 10);

2204 
us
 = 
	`org_
(&
o_rg
, 
_vue
, 
i
);

2205 
	`_
(
pTe
, 
us
 =
ue
);

2206 
du_n
 =

2207 
	`code_iti_o_rg
(&
coded_y
[0], &
o_rg
);

2208 
n
 =

2209 
	`decode_g_numb_d_vue
(&
coded_y
[0], &
g_numb
,

2210 &
n_vue
);

2211 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_OCTET_STRING
);

2212 
n
 +=

2213 
	`decode_o_rg
(&
coded_y
[
n
], 
n_vue
,

2214 &
_o_rg
);

2215 i(
du_n
 !
n
) {

2216 
	`tf
(" o sg=#%d\n", 
i
);

2218 
	`_
(
pTe
, 
du_n
 =
n
);

2219 
diff
 =

2220 
	`memcmp
(
	`org_vue
(&
o_rg
), &
_vue
[0],

2221 
	`org_ngth
(&
o_rg
));

2222 i(
diff
) {

2223 
	`tf
(" o sg=#%d\n", 
i
);

2225 
	`_
(
pTe
, 
diff
 == 0);

2229 
	}
}

2231 
	$BACDCodeChaSg
(

2232 
Te
 * 
pTe
)

2234 
ut8_t
 
y
[
MAX_APDU
] = { 0 };

2235 
ut8_t
 
coded_y
[
MAX_APDU
] = { 0 };

2236 
BACNET_CHARACTER_STRING
 
ch_rg
;

2237 
BACNET_CHARACTER_STRING
 
_ch_rg
;

2238 
_vue
[
MAX_APDU
] = { "" };

2239 
i
;

2240 
du_n
;

2241 
n
;

2242 
ut8_t
 
g_numb
 = 0;

2243 
ut32_t
 
n_vue
 = 0;

2244 
diff
 = 0;

2245 
bo
 
us
 = 
l
;

2247 
us
 = 
	`charg_
(&
ch_rg
, 
CHARACTER_ANSI_X34
, 
NULL
, 0);

2248 
	`_
(
pTe
, 
us
 =
ue
);

2249 
du_n
 = 
	`code_iti_cha_rg
(&
y
[0], &
ch_rg
);

2250 
n
 = 
	`decode_g_numb_d_vue
(&
y
[0], &
g_numb
, &
n_vue
);

2251 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
);

2252 
n
 +
	`decode_cha_rg
(&
y
[n], 
n_vue
, &
_ch_rg
);

2253 
	`_
(
pTe
, 
du_n
 =
n
);

2254 
diff
 =

2255 
	`memcmp
(
	`charg_vue
(&
ch_rg
), &
_vue
[0],

2256 
	`charg_ngth
(&
ch_rg
));

2257 
	`_
(
pTe
, 
diff
 == 0);

2258 
i
 = 0; i < 
MAX_CHARACTER_STRING_BYTES
 - 1; i++) {

2259 
_vue
[
i
] = 'S';

2260 
_vue
[
i
 + 1] = '\0';

2261 
us
 = 
	`charg__si
(&
ch_rg
, 
_vue
);

2262 
	`_
(
pTe
, 
us
 =
ue
);

2263 
du_n
 =

2264 
	`code_iti_cha_rg
(&
coded_y
[0],

2265 &
ch_rg
);

2266 
n
 =

2267 
	`decode_g_numb_d_vue
(&
coded_y
[0], &
g_numb
,

2268 &
n_vue
);

2269 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
);

2270 
n
 +=

2271 
	`decode_cha_rg
(&
coded_y
[
n
], 
n_vue
,

2272 &
_ch_rg
);

2273 i(
du_n
 !
n
) {

2274 
	`tf
(" sg=#%dpdu_n=%d=%d\n", 
i
, 
du_n
, 
n
);

2276 
	`_
(
pTe
, 
du_n
 =
n
);

2277 
diff
 =

2278 
	`memcmp
(
	`charg_vue
(&
ch_rg
), &
_vue
[0],

2279 
	`charg_ngth
(&
ch_rg
));

2280 i(
diff
) {

2281 
	`tf
(" sg=#%d\n", 
i
);

2283 
	`_
(
pTe
, 
diff
 == 0);

2287 
	}
}

2289 
	$BACDCodeObje
(

2290 
Te
 * 
pTe
)

2292 
ut8_t
 
obje_y
[4] = {

2295 
ut8_t
 
coded_y
[4] = {

2298 
ut16_t
 
ty
 = 
OBJECT_BINARY_INPUT
;

2299 
ut16_t
 
decoded_ty
 = 
OBJECT_ANALOG_OUTPUT
;

2300 
ut32_t
 

 = 123;

2301 
ut32_t
 
decoded_
 = 0;

2303 
	`code_ba_obje_id
(&
coded_y
[0], 
ty
, 

);

2304 
	`decode_obje_id
(&
coded_y
[0], &
decoded_ty
, &
decoded_
);

2305 
	`_
(
pTe
, 
decoded_ty
 =
ty
);

2306 
	`_
(
pTe
, 
decoded_
 =

);

2307 
	`code_ba_obje_id
(&
obje_y
[0], 
ty
, 

);

2308 
	`_
(
pTe
, 
	`memcmp
(&
obje_y
[0], &
coded_y
[0],

2309 (
obje_y
)) == 0);

2310 
ty
 = 0;ype < 1024;ype++) {

2311 

 = 0; in <
BACNET_MAX_INSTANCE
; instance += 1024) {

2312 
	`code_ba_obje_id
(&
coded_y
[0], 
ty
, 

);

2313 
	`decode_obje_id
(&
coded_y
[0], &
decoded_ty
,

2314 &
decoded_
);

2315 
	`_
(
pTe
, 
decoded_ty
 =
ty
);

2316 
	`_
(
pTe
, 
decoded_
 =

);

2317 
	`code_ba_obje_id
(&
obje_y
[0], 
ty
, 

);

2318 
	`_
(
pTe
, 
	`memcmp
(&
obje_y
[0], &
coded_y
[0],

2319 (
obje_y
)) == 0);

2324 
	}
}

2326 
	$BACDCodeMaxSegsApdu
(

2327 
Te
 * 
pTe
)

2329 
max_gs
[8] = { 0, 2, 4, 8, 16, 32, 64, 65 };

2330 
max_du
[6] = { 50, 128, 206, 480, 1024, 1476 };

2331 
i
 = 0;

2332 
j
 = 0;

2333 
ut8_t
 
o
 = 0;

2336 
i
 = 0; i < 8; i++) {

2337 
j
 = 0; j < 6; j++) {

2338 
o
 = 
	`code_max_gs_max_du
(
max_gs
[
i
], 
max_du
[
j
]);

2339 
	`_
(
pTe
, 
max_gs
[
i
] =
	`decode_max_gs
(
o
));

2340 
	`_
(
pTe
, 
max_du
[
j
] =
	`decode_max_du
(
o
));

2343 
	}
}

2345 
	$BACDCodeBSg
(

2346 
Te
 * 
pTe
)

2348 
ut8_t
 
b
 = 0;

2349 
BACNET_BIT_STRING
 
b_rg
;

2350 
BACNET_BIT_STRING
 
decoded_b_rg
;

2351 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

2352 
ut32_t
 
n_vue
 = 0;

2353 
ut8_t
 
g_numb
 = 0;

2354 
n
 = 0;

2356 
	`brg_
(&
b_rg
);

2358 
	`_
(
pTe
, 
	`brg_bs_ud
(&
b_rg
) == 0);

2359 
b
 = 0; b < (
MAX_BITSTRING_BYTES
 * 8); bit++) {

2360 
	`_
(
pTe
, 
	`brg_b
(&
b_rg
, 
b
=
l
);

2363 
b
 = 0; b < (
MAX_BITSTRING_BYTES
 * 8); bit++) {

2364 
	`brg_t_b
(&
b_rg
, 
b
, 
ue
);

2365 
	`_
(
pTe
, 
	`brg_bs_ud
(&
b_rg
=(
b
 + 1));

2366 
	`_
(
pTe
, 
	`brg_b
(&
b_rg
, 
b
=
ue
);

2368 
n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

2370 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

2371 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_BIT_STRING
);

2372 
n
 +
	`decode_brg
(&
du
[n], 
n_vue
, &
decoded_b_rg
);

2373 
	`_
(
pTe
, 
	`brg_bs_ud
(&
decoded_b_rg
=(
b
 + 1));

2374 
	`_
(
pTe
, 
	`brg_b
(&
decoded_b_rg
, 
b
=
ue
);

2377 
	`brg_
(&
b_rg
);

2378 
b
 = 0; b < (
MAX_BITSTRING_BYTES
 * 8); bit++) {

2379 
	`brg_t_b
(&
b_rg
, 
b
, 
l
);

2380 
	`_
(
pTe
, 
	`brg_bs_ud
(&
b_rg
=(
b
 + 1));

2381 
	`_
(
pTe
, 
	`brg_b
(&
b_rg
, 
b
=
l
);

2383 
n
 = 
	`code_iti_brg
(&
du
[0], &
b_rg
);

2385 
n
 = 
	`decode_g_numb_d_vue
(&
du
[0], &
g_numb
, &
n_vue
);

2386 
	`_
(
pTe
, 
g_numb
 =
BACNET_APPLICATION_TAG_BIT_STRING
);

2387 
n
 +
	`decode_brg
(&
du
[n], 
n_vue
, &
decoded_b_rg
);

2388 
	`_
(
pTe
, 
	`brg_bs_ud
(&
decoded_b_rg
=(
b
 + 1));

2389 
	`_
(
pTe
, 
	`brg_b
(&
decoded_b_rg
, 
b
=
l
);

2391 
	}
}

2393 
	$UnsigdCڋxtDecodes
(

2394 
Te
 * 
pTe
)

2396 
ut8_t
 
du
[
MAX_APDU
];

2397 
L
;

2398 
outL
;

2399 
outL2
;

2400 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2403 
ut32_t
 

 = 0xdeadbeef;

2404 
ut32_t
 
out
;

2406 
outL2
 = 
	`decode_cڋxt_unsigd
(
du
, 9, &
out
);

2408 

 = 0xdeadbeef;

2409 
L
 = 
	`code_cڋxt_unsigd
(
du
, 10, 

);

2410 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 10, &
out
);

2412 
	`_
(
pTe
, 
L
 =
outL
);

2413 
	`_
(
pTe
, 

 =
out
);

2414 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2416 
L
 = 
	`code_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, 

);

2417 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, &
out
);

2418 
outL2
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2420 
	`_
(
pTe
, 
L
 =
outL
);

2421 
	`_
(
pTe
, 

 =
out
);

2422 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2425 

 = 0xdead;

2426 
L
 = 
	`code_cڋxt_unsigd
(
du
, 10, 

);

2427 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 10, &
out
);

2429 
	`_
(
pTe
, 
L
 =
outL
);

2430 
	`_
(
pTe
, 

 =
out
);

2432 
L
 = 
	`code_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, 

);

2433 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, &
out
);

2434 
outL2
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2436 
	`_
(
pTe
, 
L
 =
outL
);

2437 
	`_
(
pTe
, 

 =
out
);

2438 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2440 

 = 0xde;

2441 
L
 = 
	`code_cڋxt_unsigd
(
du
, 10, 

);

2442 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 10, &
out
);

2444 
	`_
(
pTe
, 
L
 =
outL
);

2445 
	`_
(
pTe
, 

 =
out
);

2447 
L
 = 
	`code_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, 

);

2448 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, &
out
);

2449 
outL2
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2451 
	`_
(
pTe
, 
L
 =
outL
);

2452 
	`_
(
pTe
, 

 =
out
);

2453 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2455 

 = 0xd;

2456 
L
 = 
	`code_cڋxt_unsigd
(
du
, 10, 

);

2457 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 10, &
out
);

2459 
	`_
(
pTe
, 
L
 =
outL
);

2460 
	`_
(
pTe
, 

 =
out
);

2462 
L
 = 
	`code_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, 

);

2463 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, &
out
);

2464 
outL2
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2466 
	`_
(
pTe
, 
L
 =
outL
);

2467 
	`_
(
pTe
, 

 =
out
);

2468 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2470 

 = 0x2;

2471 
L
 = 
	`code_cڋxt_unsigd
(
du
, 10, 

);

2472 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 10, &
out
);

2474 
	`_
(
pTe
, 
L
 =
outL
);

2475 
	`_
(
pTe
, 

 =
out
);

2477 
L
 = 
	`code_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, 

);

2478 
outL
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
, &
out
);

2479 
outL2
 = 
	`decode_cڋxt_unsigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2481 
	`_
(
pTe
, 
L
 =
outL
);

2482 
	`_
(
pTe
, 

 =
out
);

2483 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2485 
	}
}

2487 
	$SigdCڋxtDecodes
(

2488 
Te
 * 
pTe
)

2490 
ut8_t
 
du
[
MAX_APDU
];

2491 
L
;

2492 
outL
;

2493 
outL2
;

2494 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2498 
t32_t
 

 = 0xdeadbeef;

2499 
t32_t
 
out
;

2501 
outL2
 = 
	`decode_cڋxt_sigd
(
du
, 9, &
out
);

2503 

 = 0xdeadbeef;

2504 
L
 = 
	`code_cڋxt_sigd
(
du
, 10, 

);

2505 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 10, &
out
);

2507 
	`_
(
pTe
, 
L
 =
outL
);

2508 
	`_
(
pTe
, 

 =
out
);

2509 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2511 
L
 = 
	`code_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, 

);

2512 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, &
out
);

2513 
outL2
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2515 
	`_
(
pTe
, 
L
 =
outL
);

2516 
	`_
(
pTe
, 

 =
out
);

2517 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2520 

 = 0xdead;

2521 
L
 = 
	`code_cڋxt_sigd
(
du
, 10, 

);

2522 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 10, &
out
);

2524 
	`_
(
pTe
, 
L
 =
outL
);

2525 
	`_
(
pTe
, 

 =
out
);

2527 
L
 = 
	`code_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, 

);

2528 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, &
out
);

2529 
outL2
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2531 
	`_
(
pTe
, 
L
 =
outL
);

2532 
	`_
(
pTe
, 

 =
out
);

2533 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2536 

 = 0xde;

2537 
L
 = 
	`code_cڋxt_sigd
(
du
, 10, 

);

2538 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 10, &
out
);

2540 
	`_
(
pTe
, 
L
 =
outL
);

2541 
	`_
(
pTe
, 

 =
out
);

2543 
L
 = 
	`code_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, 

);

2544 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, &
out
);

2545 
outL2
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2547 
	`_
(
pTe
, 
L
 =
outL
);

2548 
	`_
(
pTe
, 

 =
out
);

2549 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2552 

 = 0xd;

2553 
L
 = 
	`code_cڋxt_sigd
(
du
, 10, 

);

2554 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 10, &
out
);

2556 
	`_
(
pTe
, 
L
 =
outL
);

2557 
	`_
(
pTe
, 

 =
out
);

2559 
L
 = 
	`code_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, 

);

2560 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, &
out
);

2561 
outL2
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2563 
	`_
(
pTe
, 
L
 =
outL
);

2564 
	`_
(
pTe
, 

 =
out
);

2565 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2568 

 = 0x2;

2569 
L
 = 
	`code_cڋxt_sigd
(
du
, 10, 

);

2570 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 10, &
out
);

2572 
	`_
(
pTe
, 
L
 =
outL
);

2573 
	`_
(
pTe
, 

 =
out
);

2575 
L
 = 
	`code_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, 

);

2576 
outL
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
, &
out
);

2577 
outL2
 = 
	`decode_cڋxt_sigd
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2579 
	`_
(
pTe
, 
L
 =
outL
);

2580 
	`_
(
pTe
, 

 =
out
);

2581 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2583 
	}
}

2585 
	$EnumedCڋxtDecodes
(

2586 
Te
 * 
pTe
)

2588 
ut8_t
 
du
[
MAX_APDU
];

2589 
L
;

2590 
outL
;

2591 
outL2
;

2592 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2595 
ut32_t
 

 = 0xdeadbeef;

2596 
ut32_t
 
out
;

2598 
outL2
 = 
	`decode_cڋxt_umed
(
du
, 9, &
out
);

2600 

 = 0xdeadbeef;

2601 
L
 = 
	`code_cڋxt_umed
(
du
, 10, 

);

2602 
outL
 = 
	`decode_cڋxt_umed
(
du
, 10, &
out
);

2604 
	`_
(
pTe
, 
L
 =
outL
);

2605 
	`_
(
pTe
, 

 =
out
);

2606 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2608 
L
 = 
	`code_cڋxt_umed
(
du
, 
rge_cڋxt_g
, 

);

2609 
outL
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
, &
out
);

2610 
outL2
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2612 
	`_
(
pTe
, 
L
 =
outL
);

2613 
	`_
(
pTe
, 

 =
out
);

2614 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2617 

 = 0xdead;

2618 
L
 = 
	`code_cڋxt_umed
(
du
, 10, 

);

2619 
outL
 = 
	`decode_cڋxt_umed
(
du
, 10, &
out
);

2621 
	`_
(
pTe
, 
L
 =
outL
);

2622 
	`_
(
pTe
, 

 =
out
);

2624 
L
 = 
	`code_cڋxt_umed
(
du
, 
rge_cڋxt_g
, 

);

2625 
outL
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
, &
out
);

2626 
outL2
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2628 
	`_
(
pTe
, 
L
 =
outL
);

2629 
	`_
(
pTe
, 

 =
out
);

2630 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2632 

 = 0xde;

2633 
L
 = 
	`code_cڋxt_umed
(
du
, 10, 

);

2634 
outL
 = 
	`decode_cڋxt_umed
(
du
, 10, &
out
);

2636 
	`_
(
pTe
, 
L
 =
outL
);

2637 
	`_
(
pTe
, 

 =
out
);

2639 
L
 = 
	`code_cڋxt_umed
(
du
, 
rge_cڋxt_g
, 

);

2640 
outL
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
, &
out
);

2641 
outL2
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2643 
	`_
(
pTe
, 
L
 =
outL
);

2644 
	`_
(
pTe
, 

 =
out
);

2645 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2647 

 = 0xd;

2648 
L
 = 
	`code_cڋxt_umed
(
du
, 10, 

);

2649 
outL
 = 
	`decode_cڋxt_umed
(
du
, 10, &
out
);

2651 
	`_
(
pTe
, 
L
 =
outL
);

2652 
	`_
(
pTe
, 

 =
out
);

2654 
L
 = 
	`code_cڋxt_umed
(
du
, 
rge_cڋxt_g
, 

);

2655 
outL
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
, &
out
);

2656 
outL2
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2658 
	`_
(
pTe
, 
L
 =
outL
);

2659 
	`_
(
pTe
, 

 =
out
);

2660 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2662 

 = 0x2;

2663 
L
 = 
	`code_cڋxt_umed
(
du
, 10, 

);

2664 
outL
 = 
	`decode_cڋxt_umed
(
du
, 10, &
out
);

2666 
	`_
(
pTe
, 
L
 =
outL
);

2667 
	`_
(
pTe
, 

 =
out
);

2669 
L
 = 
	`code_cڋxt_umed
(
du
, 
rge_cڋxt_g
, 

);

2670 
outL
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
, &
out
);

2671 
outL2
 = 
	`decode_cڋxt_umed
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2673 
	`_
(
pTe
, 
L
 =
outL
);

2674 
	`_
(
pTe
, 

 =
out
);

2675 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2676 
	}
}

2678 
	$FltCڋxtDecodes
(

2679 
Te
 * 
pTe
)

2681 
ut8_t
 
du
[
MAX_APDU
];

2682 
L
;

2683 
outL
;

2684 
outL2
;

2685 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2688 

;

2689 
out
;

2692 

 = 0.1234f;

2693 
L
 = 
	`code_cڋxt_
(
du
, 10, 

);

2694 
outL
 = 
	`decode_cڋxt_
(
du
, 10, &
out
);

2695 
outL2
 = 
	`decode_cڋxt_
(
du
, 9, &
out
);

2697 
	`_
(
pTe
, 
L
 =
outL
);

2698 
	`_
(
pTe
, 

 =
out
);

2699 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2701 
L
 = 
	`code_cڋxt_
(
du
, 
rge_cڋxt_g
, 

);

2702 
outL
 = 
	`decode_cڋxt_
(
du
, 
rge_cڋxt_g
, &
out
);

2703 
outL2
 = 
	`decode_cڋxt_
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2705 
	`_
(
pTe
, 
L
 =
outL
);

2706 
	`_
(
pTe
, 

 =
out
);

2707 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2709 

 = 0.0f;

2710 
L
 = 
	`code_cڋxt_
(
du
, 10, 

);

2711 
outL
 = 
	`decode_cڋxt_
(
du
, 10, &
out
);

2712 
outL2
 = 
	`decode_cڋxt_
(
du
, 9, &
out
);

2714 
	`_
(
pTe
, 
L
 =
outL
);

2715 
	`_
(
pTe
, 

 =
out
);

2717 
L
 = 
	`code_cڋxt_
(
du
, 
rge_cڋxt_g
, 

);

2718 
outL
 = 
	`decode_cڋxt_
(
du
, 
rge_cڋxt_g
, &
out
);

2719 
outL2
 = 
	`decode_cڋxt_
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2721 
	`_
(
pTe
, 
L
 =
outL
);

2722 
	`_
(
pTe
, 

 =
out
);

2723 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2724 
	}
}

2726 
	$DoubCڋxtDecodes
(

2727 
Te
 * 
pTe
)

2729 
ut8_t
 
du
[
MAX_APDU
];

2730 
L
;

2731 
outL
;

2732 
outL2
;

2733 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2736 

;

2737 
out
;

2740 

 = 0.1234;

2741 
L
 = 
	`code_cڋxt_doub
(
du
, 10, 

);

2742 
outL
 = 
	`decode_cڋxt_doub
(
du
, 10, &
out
);

2743 
outL2
 = 
	`decode_cڋxt_doub
(
du
, 9, &
out
);

2745 
	`_
(
pTe
, 
L
 =
outL
);

2746 
	`_
(
pTe
, 

 =
out
);

2747 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2749 
L
 = 
	`code_cڋxt_doub
(
du
, 
rge_cڋxt_g
, 

);

2750 
outL
 = 
	`decode_cڋxt_doub
(
du
, 
rge_cڋxt_g
, &
out
);

2751 
outL2
 = 
	`decode_cڋxt_doub
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2753 
	`_
(
pTe
, 
L
 =
outL
);

2754 
	`_
(
pTe
, 

 =
out
);

2755 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2757 

 = 0.0;

2758 
L
 = 
	`code_cڋxt_doub
(
du
, 10, 

);

2759 
outL
 = 
	`decode_cڋxt_doub
(
du
, 10, &
out
);

2760 
outL2
 = 
	`decode_cڋxt_doub
(
du
, 9, &
out
);

2762 
	`_
(
pTe
, 
L
 =
outL
);

2763 
	`_
(
pTe
, 

 =
out
);

2765 
L
 = 
	`code_cڋxt_doub
(
du
, 
rge_cڋxt_g
, 

);

2766 
outL
 = 
	`decode_cڋxt_doub
(
du
, 
rge_cڋxt_g
, &
out
);

2767 
outL2
 = 
	`decode_cڋxt_doub
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2769 
	`_
(
pTe
, 
L
 =
outL
);

2770 
	`_
(
pTe
, 

 =
out
);

2771 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2772 
	}
}

2774 
	$ObjeIDCڋxtDecodes
(

2775 
Te
 * 
pTe
)

2777 
ut8_t
 
du
[
MAX_APDU
];

2778 
L
;

2779 
outL
;

2780 
outL2
;

2781 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2784 
ut16_t
 
_ty
;

2785 
ut32_t
 
_id
;

2787 
ut16_t
 
out_ty
;

2788 
ut32_t
 
out_id
;

2790 
_ty
 = 0xde;

2791 
_id
 = 0xbeef;

2793 
L
 = 
	`code_cڋxt_obje_id
(
du
, 10, 
_ty
, 
_id
);

2794 
outL
 = 
	`decode_cڋxt_obje_id
(
du
, 10, &
out_ty
, &
out_id
);

2795 
outL2
 = 
	`decode_cڋxt_obje_id
(
du
, 9, &
out_ty
, &
out_id
);

2797 
	`_
(
pTe
, 
L
 =
outL
);

2798 
	`_
(
pTe
, 
_ty
 =
out_ty
);

2799 
	`_
(
pTe
, 
_id
 =
out_id
);

2800 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2802 
L
 = 
	`code_cڋxt_obje_id
(
du
, 
rge_cڋxt_g
, 
_ty
, 
_id
);

2803 
outL
 =

2804 
	`decode_cڋxt_obje_id
(
du
, 
rge_cڋxt_g
, &
out_ty
, &
out_id
);

2805 
outL2
 =

2806 
	`decode_cڋxt_obje_id
(
du
, 
rge_cڋxt_g
 - 1, &
out_ty
,

2807 &
out_id
);

2809 
	`_
(
pTe
, 
L
 =
outL
);

2810 
	`_
(
pTe
, 
_ty
 =
out_ty
);

2811 
	`_
(
pTe
, 
_id
 =
out_id
);

2812 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2813 
	}
}

2815 
	$ChaSgCڋxtDecodes
(

2816 
Te
 * 
pTe
)

2818 
ut8_t
 
du
[
MAX_APDU
];

2819 
L
;

2820 
outL
;

2821 
outL2
;

2822 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2825 
BACNET_CHARACTER_STRING
 

;

2826 
BACNET_CHARACTER_STRING
 
out
;

2828 
	`charg__si
(&

, "This isest");

2830 
L
 = 
	`code_cڋxt_cha_rg
(
du
, 10, &

);

2831 
outL
 = 
	`decode_cڋxt_cha_rg
(
du
, 10, &
out
);

2832 
outL2
 = 
	`decode_cڋxt_cha_rg
(
du
, 9, &
out
);

2834 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2835 
	`_
(
pTe
, 
L
 =
outL
);

2836 
	`_
(
pTe
, 

.
ngth
 =
out
.length);

2837 
	`_
(
pTe
, 

.
codg
 =
out
.encoding);

2838 
	`_
(
pTe
, 
	`rcmp
(

.
vue
, 
out
.value) == 0);

2840 
L
 = 
	`code_cڋxt_cha_rg
(
du
, 
rge_cڋxt_g
, &

);

2841 
outL
 = 
	`decode_cڋxt_cha_rg
(
du
, 
rge_cڋxt_g
, &
out
);

2842 
outL2
 =

2843 
	`decode_cڋxt_cha_rg
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2845 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2846 
	`_
(
pTe
, 
L
 =
outL
);

2847 
	`_
(
pTe
, 

.
ngth
 =
out
.length);

2848 
	`_
(
pTe
, 

.
codg
 =
out
.encoding);

2849 
	`_
(
pTe
, 
	`rcmp
(

.
vue
, 
out
.value) == 0);

2850 
	}
}

2852 
	$BSgCڋxtDecodes
(

2853 
Te
 * 
pTe
)

2855 
ut8_t
 
du
[
MAX_APDU
];

2856 
L
;

2857 
outL
;

2858 
outL2
;

2859 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2861 
BACNET_BIT_STRING
 

;

2862 
BACNET_BIT_STRING
 
out
;

2864 
	`brg_
(&

);

2865 
	`brg_t_b
(&

, 1, 
ue
);

2866 
	`brg_t_b
(&

, 3, 
ue
);

2867 
	`brg_t_b
(&

, 6, 
ue
);

2868 
	`brg_t_b
(&

, 10, 
l
);

2869 
	`brg_t_b
(&

, 11, 
ue
);

2870 
	`brg_t_b
(&

, 12, 
l
);

2872 
L
 = 
	`code_cڋxt_brg
(
du
, 10, &

);

2873 
outL
 = 
	`decode_cڋxt_brg
(
du
, 10, &
out
);

2874 
outL2
 = 
	`decode_cڋxt_brg
(
du
, 9, &
out
);

2876 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2877 
	`_
(
pTe
, 
L
 =
outL
);

2878 
	`_
(
pTe
, 

.
bs_ud
 =
out
.bits_used);

2879 
	`_
(
pTe
, 
	`memcmp
(

.
vue
, 
out
.vue, 
MAX_BITSTRING_BYTES
) == 0);

2881 
L
 = 
	`code_cڋxt_brg
(
du
, 
rge_cڋxt_g
, &

);

2882 
outL
 = 
	`decode_cڋxt_brg
(
du
, 
rge_cڋxt_g
, &
out
);

2883 
outL2
 = 
	`decode_cڋxt_brg
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2885 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2886 
	`_
(
pTe
, 
L
 =
outL
);

2887 
	`_
(
pTe
, 

.
bs_ud
 =
out
.bits_used);

2888 
	`_
(
pTe
, 
	`memcmp
(

.
vue
, 
out
.vue, 
MAX_BITSTRING_BYTES
) == 0);

2889 
	}
}

2891 
	$OSgCڋxtDecodes
(

2892 
Te
 * 
pTe
)

2894 
ut8_t
 
du
[
MAX_APDU
];

2895 
L
;

2896 
outL
;

2897 
outL2
;

2898 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2901 
BACNET_OCTET_STRING
 

;

2902 
BACNET_OCTET_STRING
 
out
;

2904 
ut8_t
 
Da
[] = { 0xde, 0xad, 0xbe, 0xef };

2906 
	`org_
(&

, 
Da
, (initData));

2908 
L
 = 
	`code_cڋxt_o_rg
(
du
, 10, &

);

2909 
outL
 = 
	`decode_cڋxt_o_rg
(
du
, 10, &
out
);

2910 
outL2
 = 
	`decode_cڋxt_o_rg
(
du
, 9, &
out
);

2912 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2913 
	`_
(
pTe
, 
L
 =
outL
);

2914 
	`_
(
pTe
, 

.
ngth
 =
out
.length);

2915 
	`_
(
pTe
, 
	`org_vue_me
(&

, &
out
));

2917 
L
 = 
	`code_cڋxt_o_rg
(
du
, 
rge_cڋxt_g
, &

);

2918 
outL
 = 
	`decode_cڋxt_o_rg
(
du
, 
rge_cڋxt_g
, &
out
);

2919 
outL2
 = 
	`decode_cڋxt_o_rg
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2921 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2922 
	`_
(
pTe
, 
L
 =
outL
);

2923 
	`_
(
pTe
, 

.
ngth
 =
out
.length);

2924 
	`_
(
pTe
, 
	`org_vue_me
(&

, &
out
));

2926 
	}
}

2928 
	$TimeCڋxtDecodes
(

2929 
Te
 * 
pTe
)

2931 
ut8_t
 
du
[
MAX_APDU
];

2932 
L
;

2933 
outL
;

2934 
outL2
;

2935 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2937 
BACNET_TIME
 

;

2938 
BACNET_TIME
 
out
;

2940 

.
hour
 = 10;

2941 

.
hunddths
 = 20;

2942 

.
m
 = 30;

2943 

.
c
 = 40;

2945 
L
 = 
	`code_cڋxt_time
(
du
, 10, &

);

2946 
outL
 = 
	`decode_cڋxt_ba_time
(
du
, 10, &
out
);

2947 
outL2
 = 
	`decode_cڋxt_ba_time
(
du
, 9, &
out
);

2949 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2950 
	`_
(
pTe
, 
L
 =
outL
);

2951 
	`_
(
pTe
, 

.
hour
 =
out
.hour);

2952 
	`_
(
pTe
, 

.
hunddths
 =
out
.hundredths);

2953 
	`_
(
pTe
, 

.
m
 =
out
.min);

2954 
	`_
(
pTe
, 

.
c
 =
out
.sec);

2956 
L
 = 
	`code_cڋxt_time
(
du
, 
rge_cڋxt_g
, &

);

2957 
outL
 = 
	`decode_cڋxt_ba_time
(
du
, 
rge_cڋxt_g
, &
out
);

2958 
outL2
 = 
	`decode_cڋxt_ba_time
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

2960 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2961 
	`_
(
pTe
, 
L
 =
outL
);

2962 
	`_
(
pTe
, 

.
hour
 =
out
.hour);

2963 
	`_
(
pTe
, 

.
hunddths
 =
out
.hundredths);

2964 
	`_
(
pTe
, 

.
m
 =
out
.min);

2965 
	`_
(
pTe
, 

.
c
 =
out
.sec);

2968 
	}
}

2970 
	$DeCڋxtDecodes
(

2971 
Te
 * 
pTe
)

2973 
ut8_t
 
du
[
MAX_APDU
];

2974 
L
;

2975 
outL
;

2976 
outL2
;

2977 
ut8_t
 
rge_cڋxt_g
 = 0xfe;

2980 
BACNET_DATE
 

;

2981 
BACNET_DATE
 
out
;

2983 

.
day
 = 3;

2984 

.
mth
 = 10;

2985 

.
wday
 = 5;

2986 

.
yr
 = 1945;

2988 
L
 = 
	`code_cڋxt_de
(
du
, 10, &

);

2989 
outL
 = 
	`decode_cڋxt_de
(
du
, 10, &
out
);

2990 
outL2
 = 
	`decode_cڋxt_de
(
du
, 9, &
out
);

2992 
	`_
(
pTe
, 
outL2
 =
BACNET_STATUS_ERROR
);

2993 
	`_
(
pTe
, 
L
 =
outL
);

2994 
	`_
(
pTe
, 

.
day
 =
out
.day);

2995 
	`_
(
pTe
, 

.
mth
 =
out
.month);

2996 
	`_
(
pTe
, 

.
wday
 =
out
.wday);

2997 
	`_
(
pTe
, 

.
yr
 =
out
.year);

3000 
L
 = 
	`code_cڋxt_de
(
du
, 
rge_cڋxt_g
, &

);

3001 
outL
 = 
	`decode_cڋxt_de
(
du
, 
rge_cڋxt_g
, &
out
);

3002 
outL2
 = 
	`decode_cڋxt_de
(
du
, 
rge_cڋxt_g
 - 1, &
out
);

3004 
	`_
(
pTe
, 
L
 =
outL
);

3005 
	`_
(
pTe
, 

.
day
 =
out
.day);

3006 
	`_
(
pTe
, 

.
mth
 =
out
.month);

3007 
	`_
(
pTe
, 

.
wday
 =
out
.wday);

3008 
	`_
(
pTe
, 

.
yr
 =
out
.year);

3009 
	}
}

3011 
	$_BACDCode
(

3012 
Te
 * 
pTe
)

3014 
bo
 
rc
;

3017 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeTags
);

3018 
	`as
(
rc
);

3019 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeRl
);

3020 
	`as
(
rc
);

3021 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeUnsigd
);

3022 
	`as
(
rc
);

3023 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtUnsigd
);

3024 
	`as
(
rc
);

3025 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeSigd
);

3026 
	`as
(
rc
);

3027 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtSigd
);

3028 
	`as
(
rc
);

3029 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeEnumed
);

3030 
	`as
(
rc
);

3031 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeOSg
);

3032 
	`as
(
rc
);

3033 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeChaSg
);

3034 
	`as
(
rc
);

3035 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeObje
);

3036 
	`as
(
rc
);

3037 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeMaxSegsApdu
);

3038 
	`as
(
rc
);

3039 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeBSg
);

3040 
	`as
(
rc
);

3041 
rc
 = 
	`_addTeFuni
(
pTe
, 
UnsigdCڋxtDecodes
);

3042 
	`as
(
rc
);

3043 
rc
 = 
	`_addTeFuni
(
pTe
, 
SigdCڋxtDecodes
);

3044 
	`as
(
rc
);

3045 
rc
 = 
	`_addTeFuni
(
pTe
, 
EnumedCڋxtDecodes
);

3046 
	`as
(
rc
);

3047 
rc
 = 
	`_addTeFuni
(
pTe
, 
ChaSgCڋxtDecodes
);

3048 
	`as
(
rc
);

3049 
rc
 = 
	`_addTeFuni
(
pTe
, 
FltCڋxtDecodes
);

3050 
	`as
(
rc
);

3051 
rc
 = 
	`_addTeFuni
(
pTe
, 
DoubCڋxtDecodes
);

3052 
	`as
(
rc
);

3053 
rc
 = 
	`_addTeFuni
(
pTe
, 
ObjeIDCڋxtDecodes
);

3054 
	`as
(
rc
);

3055 
rc
 = 
	`_addTeFuni
(
pTe
, 
BSgCڋxtDecodes
);

3056 
	`as
(
rc
);

3057 
rc
 = 
	`_addTeFuni
(
pTe
, 
TimeCڋxtDecodes
);

3058 
	`as
(
rc
);

3059 
rc
 = 
	`_addTeFuni
(
pTe
, 
DeCڋxtDecodes
);

3060 
	`as
(
rc
);

3061 
rc
 = 
	`_addTeFuni
(
pTe
, 
OSgCڋxtDecodes
);

3062 
	`as
(
rc
);

3063 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACDCodeDoub
);

3064 
	`as
(
rc
);

3065 
	}
}

3067 #ifde
TEST_DECODE


3068 
	$ma
(

3071 
Te
 *
pTe
;

3073 
pTe
 = 
	`_
("BACDCode", 
NULL
);

3074 
	`_BACDCode
(
pTe
);

3077 
	`_tSm
(
pTe
, 
dout
);

3078 
	`_run
(
pTe
);

3079 (
	`_pt
(
pTe
);

3080 
	`_deroy
(
pTe
);

3083 
	}
}

	@src/bacdevobjpropref.c

34 
	~<dt.h
>

35 
	~<dbo.h
>

36 
	~"bacdcode.h
"

37 
	~"du.h
"

38 
	~"timeamp.h
"

39 
	~"bacdevobjݻf.h
"

43 
	$ba_code_cڋxt_devi_obj_ݔty_f
(

44 
ut8_t
 * 
du
,

45 
ut8_t
 
g_numb
,

46 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 * 
vue
)

48 
n
;

49 
du_n
 = 0;

51 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 
g_numb
);

52 
du_n
 +
n
;

54 
n
 = 
	`ba_code_devi_obj_ݔty_f
(&
du
[
du_n
], 
vue
);

55 
du_n
 +
n
;

57 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 
g_numb
);

58 
du_n
 +
n
;

60  
du_n
;

61 
	}
}

73 
	$ba_code_devi_obj_ݔty_f
(

74 
ut8_t
 * 
du
,

75 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 * 
vue
)

77 
n
;

78 
du_n
 = 0;

81 
n
 =

82 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0,

83 (
vue
->
objeIdtifr
.
ty
, vue->objeIdtifr.

);

84 
du_n
 +
n
;

86 
n
 =

87 
	`code_cڋxt_umed
(&
du
[
du_n
], 1,

88 
vue
->
ݔtyIdtifr
);

89 
du_n
 +
n
;

92 i(
vue
->
yIndex
 !
BACNET_ARRAY_ALL
) {

93 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 2, 
vue
->
yIndex
);

94 
du_n
 +
n
;

100 i(
vue
->
deviIndtifr
.
ty
 =
OBJECT_DEVICE
) {

101 
n
 =

102 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 3,

103 (
vue
->
deviIndtifr
.
ty
,

104 
vue
->
deviIndtifr
.

);

105 
du_n
 +
n
;

107  
du_n
;

108 
	}
}

120 
	$ba_decode_devi_obj_ݔty_f
(

121 
ut8_t
 * 
du
,

122 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 * 
vue
)

124 
n
;

125 
du_n
 = 0;

126 
ut32_t
 
umVue
;

129 i(-1 =(
n
 =

130 
	`decode_cڋxt_obje_id
(&
du
[
du_n
], 0,

131 &
vue
->
objeIdtifr
.
ty
,

132 &
vue
->
objeIdtifr
.

))) {

135 
du_n
 +
n
;

137 i(-1 =(
n
 =

138 
	`decode_cڋxt_umed
(&
du
[
du_n
], 1, &
umVue
))) {

141 
vue
->
ݔtyIdtifr
 = (
BACNET_PROPERTY_ID

umVue
;

142 
du_n
 +
n
;

144 i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 2) &&

145 !
	`decode_is_osg_g
(&
du
[
du_n
])) {

146 i(-1 =(
n
 =

147 
	`decode_cڋxt_unsigd
(&
du
[
du_n
], 2,

148 &
vue
->
yIndex
))) {

151 
du_n
 +
n
;

153 
vue
->
yIndex
 = 
BACNET_ARRAY_ALL
;

156 i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 3) &&

157 !
	`decode_is_osg_g
(&
du
[
du_n
])) {

158 i(-1 =(
n
 =

159 
	`decode_cڋxt_obje_id
(&
du
[
du_n
], 3,

160 &
vue
->
deviIndtifr
.
ty
,

161 &
vue
->
deviIndtifr
.

))) {

164 
du_n
 +
n
;

166 
vue
->
deviIndtifr
.
ty
 = 
BACNET_NO_DEV_TYPE
;

167 
vue
->
deviIndtifr
.

 = 
BACNET_NO_DEV_ID
;

170  
du_n
;

171 
	}
}

173 
	$ba_decode_cڋxt_devi_obj_ݔty_f
(

174 
ut8_t
 * 
du
,

175 
ut8_t
 
g_numb
,

176 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 * 
vue
)

178 
n
 = 0;

179 
i_ngth
;

181 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 
g_numb
)) {

182 
n
++;

183 
i_ngth
 =

184 
	`ba_decode_devi_obj_ݔty_f
(&
du
[
n
], 
vue
);

186 i(
i_ngth
 == -1) {

187 
n
 = -1;

189 
n
 +
i_ngth
;

190 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 
g_numb
)) {

191 
n
++;

193 
n
 = -1;

197 
n
 = -1;

199  
n
;

200 
	}
}

207 
	$ba_code_cڋxt_devi_obj_f
(

208 
ut8_t
 * 
du
,

209 
ut8_t
 
g_numb
,

210 
BACNET_DEVICE_OBJECT_REFERENCE
 * 
vue
)

212 
n
;

213 
du_n
 = 0;

215 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 
g_numb
);

216 
du_n
 +
n
;

218 
n
 = 
	`ba_code_devi_obj_f
(&
du
[
du_n
], 
vue
);

219 
du_n
 +
n
;

221 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 
g_numb
);

222 
du_n
 +
n
;

224  
du_n
;

225 
	}
}

231 
	$ba_code_devi_obj_f
(

232 
ut8_t
 * 
du
,

233 
BACNET_DEVICE_OBJECT_REFERENCE
 * 
vue
)

235 
n
;

236 
du_n
 = 0;

242 i(
vue
->
deviIndtifr
.
ty
 =
OBJECT_DEVICE
) {

243 
n
 =

244 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0,

245 (
vue
->
deviIndtifr
.
ty
,

246 
vue
->
deviIndtifr
.

);

247 
du_n
 +
n
;

250 
n
 =

251 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 1,

252 (
vue
->
objeIdtifr
.
ty
, vue->objeIdtifr.

);

253 
du_n
 +
n
;

255  
du_n
;

256 
	}
}

262 
	$ba_decode_devi_obj_f
(

263 
ut8_t
 * 
du
,

264 
BACNET_DEVICE_OBJECT_REFERENCE
 * 
vue
)

266 
n
;

267 
du_n
 = 0;

270 i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 0) &&

271 !
	`decode_is_osg_g
(&
du
[
du_n
])) {

272 i(-1 =(
n
 =

273 
	`decode_cڋxt_obje_id
(&
du
[
du_n
], 0,

274 &
vue
->
deviIndtifr
.
ty
,

275 &
vue
->
deviIndtifr
.

))) {

278 
du_n
 +
n
;

280 
vue
->
deviIndtifr
.
ty
 = 
BACNET_NO_DEV_TYPE
;

281 
vue
->
deviIndtifr
.

 = 
BACNET_NO_DEV_ID
;

284 i(-1 =(
n
 =

285 
	`decode_cڋxt_obje_id
(&
du
[
du_n
], 1,

286 &
vue
->
objeIdtifr
.
ty
,

287 &
vue
->
objeIdtifr
.

))) {

290 
du_n
 +
n
;

292  
du_n
;

293 
	}
}

295 
	$ba_decode_cڋxt_devi_obj_f
(

296 
ut8_t
 * 
du
,

297 
ut8_t
 
g_numb
,

298 
BACNET_DEVICE_OBJECT_REFERENCE
 * 
vue
)

300 
n
 = 0;

301 
i_ngth
;

303 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 
g_numb
)) {

304 
n
++;

305 
i_ngth
 = 
	`ba_decode_devi_obj_f
(&
du
[
n
], 
vue
);

307 i(
i_ngth
 == -1) {

308 
n
 = -1;

310 
n
 +
i_ngth
;

311 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 
g_numb
)) {

312 
n
++;

314 
n
 = -1;

318 
n
 = -1;

320  
n
;

321 
	}
}

323 #ifde
TEST


324 
	~<as.h
>

325 
	~<rg.h
>

326 
	~"e.h
"

327 
	$DevObjPrRef
(

328 
Te
 * 
pTe
,

329 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 *
Da
)

331 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 
outDa
;

332 
ut8_t
 
bufr
[
MAX_APDU
] = {0};

333 
L
 = 0;

334 
outL
 = 0;

337 
L
 = 
	`ba_code_devi_obj_ݔty_f
(
bufr
, 
Da
);

340 
	`code_osg_g
(&
bufr
[
L
], 3);

342 
outL
 = 
	`ba_decode_devi_obj_ݔty_f
(
bufr
, &
outDa
);

343 
	`_
(
pTe
, 
outL
 =
L
);

344 
	`_
(
pTe
,

345 
Da
->
objeIdtifr
.

 =
outDa
.objectIdentifier.instance);

346 
	`_
(
pTe
,

347 
Da
->
objeIdtifr
.
ty
 =
outDa
.objectIdentifier.type);

348 
	`_
(
pTe
, 
Da
->
ݔtyIdtifr
 =
outDa
.propertyIdentifier);

349 i(
Da
->
yIndex
 !
BACNET_ARRAY_ALL
) {

350 
	`_
(
pTe
, 
Da
->
yIndex
 =
outDa
.arrayIndex);

352 
	`_
(
pTe
, 
outDa
.
yIndex
 =
BACNET_ARRAY_ALL
);

354 i(
Da
->
deviIndtifr
.
ty
 =
OBJECT_DEVICE
) {

355 
	`_
(
pTe
,

356 
Da
->
deviIndtifr
.

 ==

357 
outDa
.
deviIndtifr
.

);

358 
	`_
(
pTe
,

359 
Da
->
deviIndtifr
.
ty
 =
outDa
.deviceIndentifier.type);

361 
	`_
(
pTe
,
outDa
.
deviIndtifr
.

 =
BACNET_NO_DEV_ID
);

362 
	`_
(
pTe
,
outDa
.
deviIndtifr
.
ty
 =
BACNET_NO_DEV_TYPE
);

364 
	}
}

366 
	$DevIdPrRef
(

367 
Te
 * 
pTe
)

369 
BACNET_DEVICE_OBJECT_PROPERTY_REFERENCE
 
Da
;

372 
Da
.
objeIdtifr
.

 = 0x1234;

373 
Da
.
objeIdtifr
.
ty
 = 15;

374 
Da
.
ݔtyIdtifr
 = 25;

375 
Da
.
yIndex
 = 0x5678;

376 
Da
.
deviIndtifr
.

 = 0x4343;

377 
Da
.
deviIndtifr
.
ty
 = 
OBJECT_DEVICE
;

378 
	`DevObjPrRef
(
pTe
, &
Da
);

380 
Da
.
objeIdtifr
.

 = 0x1234;

381 
Da
.
objeIdtifr
.
ty
 = 15;

382 
Da
.
ݔtyIdtifr
 = 25;

383 
Da
.
yIndex
 = 
BACNET_ARRAY_ALL
;

384 
Da
.
deviIndtifr
.

 = 0x4343;

385 
Da
.
deviIndtifr
.
ty
 = 
OBJECT_DEVICE
;

386 
	`DevObjPrRef
(
pTe
, &
Da
);

388 
Da
.
objeIdtifr
.

 = 0x1234;

389 
Da
.
objeIdtifr
.
ty
 = 15;

390 
Da
.
ݔtyIdtifr
 = 25;

391 
Da
.
yIndex
 = 1;

392 
Da
.
deviIndtifr
.

 = 0;

393 
Da
.
deviIndtifr
.
ty
 = 
BACNET_NO_DEV_TYPE
;

394 
	`DevObjPrRef
(
pTe
, &
Da
);

396 
Da
.
objeIdtifr
.

 = 0x1234;

397 
Da
.
objeIdtifr
.
ty
 = 15;

398 
Da
.
ݔtyIdtifr
 = 25;

399 
Da
.
yIndex
 = 
BACNET_ARRAY_ALL
;

400 
Da
.
deviIndtifr
.

 = 0;

401 
Da
.
deviIndtifr
.
ty
 = 
BACNET_NO_DEV_TYPE
;

402 
	`DevObjPrRef
(
pTe
, &
Da
);

403 
	}
}

405 
	$DevIdRef
(

406 
Te
 * 
pTe
)

408 
BACNET_DEVICE_OBJECT_REFERENCE
 
Da
;

409 
BACNET_DEVICE_OBJECT_REFERENCE
 
outDa
;

410 
ut8_t
 
bufr
[
MAX_APDU
];

411 
L
;

412 
outL
;

414 
Da
.
deviIndtifr
.

 = 0x4343;

415 
Da
.
deviIndtifr
.
ty
 = 
OBJECT_DEVICE
;

416 
L
 = 
	`ba_code_devi_obj_f
(
bufr
, &
Da
);

417 
outL
 = 
	`ba_decode_devi_obj_f
(
bufr
, &
outDa
);

418 
	`_
(
pTe
, 
outL
 =
L
);

419 
	`_
(
pTe
,

420 
Da
.
deviIndtifr
.

 ==

421 
outDa
.
deviIndtifr
.

);

422 
	`_
(
pTe
,

423 
Da
.
deviIndtifr
.
ty
 =
outDa
.deviceIndentifier.type);

424 
	}
}

426 
	$BACtDeviObjePrݔtyRen
(

427 
Te
 * 
pTe
)

429 
bo
 
rc
;

432 
rc
 = 
	`_addTeFuni
(
pTe
, 
DevIdPrRef
);

433 
	`as
(
rc
);

434 
rc
 = 
	`_addTeFuni
(
pTe
, 
DevIdRef
);

435 
	`as
(
rc
);

436 
	}
}

438 #ifde
TEST_DEV_ID_PROP_REF


439 
	~<as.h
>

440 
	$ma
(

443 
Te
 *
pTe
;

445 
pTe
 = 
	`_
("BACÈPr Ref", 
NULL
);

446 
	`BACtDeviObjePrݔtyRen
(
pTe
);

448 
	`_tSm
(
pTe
, 
dout
);

449 
	`_run
(
pTe
);

450 (
	`_pt
(
pTe
);

451 
	`_deroy
(
pTe
);

454 
	}
}

	@src/bacerror.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"ba.h
"

43 
	$ba_code_du
(

44 
ut8_t
 * 
du
,

45 
ut8_t
 
voke_id
,

46 
BACNET_CONFIRMED_SERVICE
 
rvi
,

47 
BACNET_ERROR_CLASS
 
r_ass
,

48 
BACNET_ERROR_CODE
 
r_code
)

50 
du_n
 = 0;

52 i(
du
) {

53 
du
[0] = 
PDU_TYPE_ERROR
;

54 
du
[1] = 
voke_id
;

55 
du
[2] = 
rvi
;

56 
du_n
 = 3;

58 
du_n
 +=

59 
	`code_iti_umed
(&
du
[
du_n
], 
r_ass
);

60 
du_n
 +
	`code_iti_umed
(&
du
[du_n], 
r_code
);

63  
du_n
;

64 
	}
}

66 #i!
BACNET_SVC_SERVER


68 
	$ba_decode_r_ass_d_code
(

69 
ut8_t
 * 
du
,

70 
du_n
,

71 
BACNET_ERROR_CLASS
 * 
r_ass
,

72 
BACNET_ERROR_CODE
 * 
r_code
)

74 
n
 = 0;

75 
ut8_t
 
g_numb
 = 0;

76 
ut32_t
 
n_vue_ty
 = 0;

77 
ut32_t
 
decoded_vue
 = 0;

79 i(
du_n
) {

81 
n
 +=

82 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

83 &
n_vue_ty
);

84 i(
g_numb
 !
BACNET_APPLICATION_TAG_ENUMERATED
)

86 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
decoded_vue
);

87 i(
r_ass
)

88 *
r_ass
 = (
BACNET_ERROR_CLASS

decoded_vue
;

90 
n
 +=

91 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

92 &
n_vue_ty
);

93 i(
g_numb
 !
BACNET_APPLICATION_TAG_ENUMERATED
)

95 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
decoded_vue
);

96 i(
r_code
)

97 *
r_code
 = (
BACNET_ERROR_CODE

decoded_vue
;

100  
n
;

101 
	}
}

104 
	$ba_decode_rvi_que
(

105 
ut8_t
 * 
du
,

106 
du_n
,

107 
ut8_t
 * 
voke_id
,

108 
BACNET_CONFIRMED_SERVICE
 * 
rvi
,

109 
BACNET_ERROR_CLASS
 * 
r_ass
,

110 
BACNET_ERROR_CODE
 * 
r_code
)

112 
n
 = 0;

114 i(
du_n
 > 2) {

115 i(
voke_id
)

116 *
voke_id
 = 
du
[0];

117 i(
rvi
)

118 *
rvi
 = (
BACNET_CONFIRMED_SERVICE

du
[1];

120 
n
 =

121 
	`ba_decode_r_ass_d_code
(&
du
[2], 
du_n
 - 2,

122 
r_ass
, 
r_code
);

125  
n
;

126 
	}
}

129 #ifde
TEST


130 
	~<as.h
>

131 
	~<rg.h
>

132 
	~"e.h
"

135 
	$ba_decode_du
(

136 
ut8_t
 * 
du
,

137 
du_n
,

138 
ut8_t
 * 
voke_id
,

139 
BACNET_CONFIRMED_SERVICE
 * 
rvi
,

140 
BACNET_ERROR_CLASS
 * 
r_ass
,

141 
BACNET_ERROR_CODE
 * 
r_code
)

143 
n
 = 0;

145 i(!
du
)

148 i(
du_n
) {

149 i(
du
[0] !
PDU_TYPE_ERROR
)

151 i(
du_n
 > 1) {

152 
n
 =

153 
	`ba_decode_rvi_que
(&
du
[1], 
du_n
 - 1,

154 
voke_id
, 
rvi
, 
r_ass
, 
r_code
);

158  
n
;

159 
	}
}

161 
	$BACE
(

162 
Te
 * 
pTe
)

164 
ut8_t
 
du
[480] = { 0 };

165 
n
 = 0;

166 
du_n
 = 0;

167 
ut8_t
 
voke_id
 = 0;

168 
BACNET_CONFIRMED_SERVICE
 
rvi
 = 0;

169 
BACNET_ERROR_CLASS
 
r_ass
 = 0;

170 
BACNET_ERROR_CODE
 
r_code
 = 0;

171 
ut8_t
 
_voke_id
 = 0;

172 
BACNET_CONFIRMED_SERVICE
 
_rvi
 = 0;

173 
BACNET_ERROR_CLASS
 
_r_ass
 = 0;

174 
BACNET_ERROR_CODE
 
_r_code
 = 0;

176 
n
 =

177 
	`ba_code_du
(&
du
[0], 
voke_id
, 
rvi
, 
r_ass
,

178 
r_code
);

179 
	`_
(
pTe
, 
n
 != 0);

180 
du_n
 = 
n
;

182 
n
 =

183 
	`ba_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

184 &
_rvi
, &
_r_ass
, &
_r_code
);

185 
	`_
(
pTe
, 
n
 != -1);

186 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

187 
	`_
(
pTe
, 
_rvi
 =
rvi
);

188 
	`_
(
pTe
, 
_r_ass
 =
r_ass
);

189 
	`_
(
pTe
, 
_r_code
 =
r_code
);

192 
du
[0] = 
PDU_TYPE_ABORT
;

193 
n
 =

194 
	`ba_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

195 &
_rvi
, &
_r_ass
, &
_r_code
);

196 
	`_
(
pTe
, 
n
 == -1);

199 
n
 =

200 
	`ba_decode_du
(
NULL
, 
du_n
, &
_voke_id
, &
_rvi
,

201 &
_r_ass
, &
_r_code
);

202 
	`_
(
pTe
, 
n
 == -1);

205 
n
 =

206 
	`ba_decode_du
(&
du
[0], 0, &
_voke_id
, &
_rvi
,

207 &
_r_ass
, &
_r_code
);

208 
	`_
(
pTe
, 
n
 == 0);

212 
rvi
 = 0; svi < 
MAX_BACNET_CONFIRMED_SERVICE
; service++) {

213 
r_ass
 = 0;_as< 
MAX_BACNET_ERROR_CLASS
;

214 
r_ass
++) {

215 
r_code
 = 0;_cod< 
MAX_BACNET_ERROR_CODE
;

216 
r_code
++) {

217 
n
 =

218 
	`ba_code_du
(&
du
[0], 
voke_id
, 
rvi
,

219 
r_ass
, 
r_code
);

220 
du_n
 = 
n
;

221 
	`_
(
pTe
, 
n
 != 0);

222 
n
 =

223 
	`ba_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

224 &
_rvi
, &
_r_ass
, &
_r_code
);

225 
	`_
(
pTe
, 
n
 != -1);

226 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

227 
	`_
(
pTe
, 
_rvi
 =
rvi
);

228 
	`_
(
pTe
, 
_r_ass
 =
r_ass
);

229 
	`_
(
pTe
, 
_r_code
 =
r_code
);

235 
rvi
 = 255;

236 
r_ass
 = 
LAST_PROPRIETARY_ERROR_CLASS
;

237 
r_code
 = 
LAST_PROPRIETARY_ERROR_CODE
;

238 
n
 =

239 
	`ba_code_du
(&
du
[0], 
voke_id
, 
rvi
, 
r_ass
,

240 
r_code
);

241 
du_n
 = 
n
;

242 
	`_
(
pTe
, 
n
 != 0);

243 
n
 =

244 
	`ba_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

245 &
_rvi
, &
_r_ass
, &
_r_code
);

246 
	`_
(
pTe
, 
n
 != -1);

247 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

248 
	`_
(
pTe
, 
_rvi
 =
rvi
);

249 
	`_
(
pTe
, 
_r_ass
 =
r_ass
);

250 
	`_
(
pTe
, 
_r_code
 =
r_code
);

252 
	}
}

254 #ifde
TEST_BACERROR


255 
	$ma
(

258 
Te
 *
pTe
;

259 
bo
 
rc
;

261 
pTe
 = 
	`_
("BACÈE", 
NULL
);

263 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACE
);

264 
	`as
(
rc
);

266 
	`_tSm
(
pTe
, 
dout
);

267 
	`_run
(
pTe
);

268 (
	`_pt
(
pTe
);

269 
	`_deroy
(
pTe
);

272 
	}
}

	@src/bacint.c

37 
	~<dt.h
>

38 
	~<dbo.h
>

39 
	~"cfig.h
"

40 
	~"bact.h
"

44 
	$code_unsigd16
(

45 
ut8_t
 * 
du
,

46 
ut16_t
 
vue
)

48 
du
[0] = (
ut8_t
((
vue
 & 0xff00) >> 8);

49 
du
[1] = (
ut8_t
(
vue
 & 0x00ff);

52 
	}
}

54 
	$decode_unsigd16
(

55 
ut8_t
 * 
du
,

56 
ut16_t
 * 
vue
)

58 i(
vue
) {

59 *
vue
 = (
ut16_t
((((ut16_t
du
[0]) << 8) & 0xff00);

60 *
vue
 |((
ut16_t
(((ut16_t
du
[1]) & 0x00ff));

64 
	}
}

66 
	$code_unsigd24
(

67 
ut8_t
 * 
du
,

68 
ut32_t
 
vue
)

70 
du
[0] = (
ut8_t
((
vue
 & 0xff0000) >> 16);

71 
du
[1] = (
ut8_t
((
vue
 & 0x00ff00) >> 8);

72 
du
[2] = (
ut8_t
(
vue
 & 0x0000ff);

75 
	}
}

77 
	$decode_unsigd24
(

78 
ut8_t
 * 
du
,

79 
ut32_t
 * 
vue
)

81 i(
vue
) {

82 *
vue
 = ((
ut32_t
((((ut32_t
du
[0]) << 16) & 0x00ff0000));

83 *
vue
 |(
ut32_t
((((ut32_t
du
[1]) << 8) & 0x0000ff00);

84 *
vue
 |((
ut32_t
(((ut32_t
du
[2]) & 0x000000ff));

88 
	}
}

90 
	$code_unsigd32
(

91 
ut8_t
 * 
du
,

92 
ut32_t
 
vue
)

94 
du
[0] = (
ut8_t
((
vue
 & 0xff000000) >> 24);

95 
du
[1] = (
ut8_t
((
vue
 & 0x00ff0000) >> 16);

96 
du
[2] = (
ut8_t
((
vue
 & 0x0000ff00) >> 8);

97 
du
[3] = (
ut8_t
(
vue
 & 0x000000ff);

100 
	}
}

102 
	$decode_unsigd32
(

103 
ut8_t
 * 
du
,

104 
ut32_t
 * 
vue
)

106 i(
vue
) {

107 *
vue
 = ((
ut32_t
((((ut32_t
du
[0]) << 24) & 0xff000000));

108 *
vue
 |((
ut32_t
((((ut32_t
du
[1]) << 16) & 0x00ff0000));

109 *
vue
 |((
ut32_t
((((ut32_t
du
[2]) << 8) & 0x0000ff00));

110 *
vue
 |((
ut32_t
(((ut32_t
du
[3]) & 0x000000ff));

114 
	}
}

116 #i
BACNET_USE_SIGNED


117 
	$code_sigd8
(

118 
ut8_t
 * 
du
,

119 
t8_t
 
vue
)

121 
du
[0] = (
ut8_t

vue
;

124 
	}
}

126 
	$decode_sigd8
(

127 
ut8_t
 * 
du
,

128 
t32_t
 * 
vue
)

130 i(
vue
) {

132 i(
du
[0] & 0x80)

133 *
vue
 = 0xFFFFFF00;

135 *
vue
 = 0;

136 *
vue
 |((
t32_t
(((t32_t
du
[0]) & 0x000000ff));

140 
	}
}

142 
	$code_sigd16
(

143 
ut8_t
 * 
du
,

144 
t16_t
 
vue
)

146 
du
[0] = (
ut8_t
((
vue
 & 0xff00) >> 8);

147 
du
[1] = (
ut8_t
(
vue
 & 0x00ff);

150 
	}
}

152 
	$decode_sigd16
(

153 
ut8_t
 * 
du
,

154 
t32_t
 * 
vue
)

156 i(
vue
) {

158 i(
du
[0] & 0x80)

159 *
vue
 = 0xFFFF0000;

161 *
vue
 = 0;

162 *
vue
 |((
t32_t
((((t32_t
du
[0]) << 8) & 0x0000ff00));

163 *
vue
 |((
t32_t
(((t32_t
du
[1]) & 0x000000ff));

167 
	}
}

169 
	$code_sigd24
(

170 
ut8_t
 * 
du
,

171 
t32_t
 
vue
)

173 
du
[0] = (
ut8_t
((
vue
 & 0xff0000) >> 16);

174 
du
[1] = (
ut8_t
((
vue
 & 0x00ff00) >> 8);

175 
du
[2] = (
ut8_t
(
vue
 & 0x0000ff);

178 
	}
}

180 
	$decode_sigd24
(

181 
ut8_t
 * 
du
,

182 
t32_t
 * 
vue
)

184 i(
vue
) {

186 i(
du
[0] & 0x80)

187 *
vue
 = 0xFF000000;

189 *
vue
 = 0;

190 *
vue
 |((
t32_t
((((t32_t
du
[0]) << 16) & 0x00ff0000));

191 *
vue
 |((
t32_t
((((t32_t
du
[1]) << 8) & 0x0000ff00));

192 *
vue
 |((
t32_t
(((t32_t
du
[2]) & 0x000000ff));

196 
	}
}

198 
	$code_sigd32
(

199 
ut8_t
 * 
du
,

200 
t32_t
 
vue
)

202 
du
[0] = (
ut8_t
((
vue
 & 0xff000000) >> 24);

203 
du
[1] = (
ut8_t
((
vue
 & 0x00ff0000) >> 16);

204 
du
[2] = (
ut8_t
((
vue
 & 0x0000ff00) >> 8);

205 
du
[3] = (
ut8_t
(
vue
 & 0x000000ff);

208 
	}
}

210 
	$decode_sigd32
(

211 
ut8_t
 * 
du
,

212 
t32_t
 * 
vue
)

214 i(
vue
) {

215 *
vue
 = ((
t32_t
((((t32_t
du
[0]) << 24) & 0xff000000));

216 *
vue
 |((
t32_t
((((t32_t
du
[1]) << 16) & 0x00ff0000));

217 *
vue
 |((
t32_t
((((t32_t
du
[2]) << 8) & 0x0000ff00));

218 *
vue
 |((
t32_t
(((t32_t
du
[3]) & 0x000000ff));

222 
	}
}

225 #ifde
TEST


226 
	~<as.h
>

227 
	~<rg.h
>

228 
	~<y.h
>

229 
	~"e.h
"

231 
	$BACtUnsigd16
(

232 
Te
 * 
pTe
)

234 
ut8_t
 
du
[32] = { 0 };

235 
ut16_t
 
vue
 = 0, 
_vue
 = 0;

236 
n
 = 0;

238 
vue
 = 0;; value++) {

239 
n
 = 
	`code_unsigd16
(&
du
[0], 
vue
);

240 
	`_
(
pTe
, 
n
 == 2);

241 
n
 = 
	`decode_unsigd16
(&
du
[0], &
_vue
);

242 
	`_
(
pTe
, 
vue
 =
_vue
);

243 i(
vue
 == 0xFFFF)

246 
	}
}

248 
	$BACtUnsigd24
(

249 
Te
 * 
pTe
)

251 
ut8_t
 
du
[32] = { 0 };

252 
ut32_t
 
vue
 = 0, 
_vue
 = 0;

253 
n
 = 0;

255 
vue
 = 0;; value += 0xf) {

256 
n
 = 
	`code_unsigd24
(&
du
[0], 
vue
);

257 
	`_
(
pTe
, 
n
 == 3);

258 
n
 = 
	`decode_unsigd24
(&
du
[0], &
_vue
);

259 
	`_
(
pTe
, 
vue
 =
_vue
);

260 i(
vue
 == 0xffffff)

263 
	}
}

265 
	$BACtUnsigd32
(

266 
Te
 * 
pTe
)

268 
ut8_t
 
du
[32] = { 0 };

269 
ut32_t
 
vue
 = 0, 
_vue
 = 0;

270 
n
 = 0;

272 
vue
 = 0;; value += 0xff) {

273 
n
 = 
	`code_unsigd32
(&
du
[0], 
vue
);

274 
	`_
(
pTe
, 
n
 == 4);

275 
n
 = 
	`decode_unsigd32
(&
du
[0], &
_vue
);

276 
	`_
(
pTe
, 
vue
 =
_vue
);

277 i(
vue
 == 0xffffffff)

280 
	}
}

282 
	$BACtSigd8
(

283 
Te
 * 
pTe
)

285 
ut8_t
 
du
[32] = { 0 };

286 
t32_t
 
vue
 = 0, 
_vue
 = 0;

287 
n
 = 0;

289 
vue
 = -127;; value++) {

290 
n
 = 
	`code_sigd8
(&
du
[0], 
vue
);

291 
	`_
(
pTe
, 
n
 == 1);

292 
n
 = 
	`decode_sigd8
(&
du
[0], &
_vue
);

293 
	`_
(
pTe
, 
vue
 =
_vue
);

294 i(
vue
 == 127)

297 
	}
}

299 
	$BACtSigd16
(

300 
Te
 * 
pTe
)

302 
ut8_t
 
du
[32] = { 0 };

303 
t32_t
 
vue
 = 0, 
_vue
 = 0;

304 
n
 = 0;

306 
vue
 = -32767;; value++) {

307 
n
 = 
	`code_sigd16
(&
du
[0], 
vue
);

308 
	`_
(
pTe
, 
n
 == 2);

309 
n
 = 
	`decode_sigd16
(&
du
[0], &
_vue
);

310 
	`_
(
pTe
, 
vue
 =
_vue
);

311 i(
vue
 == 32767)

314 
	}
}

316 
	$BACtSigd24
(

317 
Te
 * 
pTe
)

319 
ut8_t
 
du
[32] = { 0 };

320 
t32_t
 
vue
 = 0, 
_vue
 = 0;

321 
n
 = 0;

323 
vue
 = -8388607; value <= 8388607; value += 15) {

324 
n
 = 
	`code_sigd24
(&
du
[0], 
vue
);

325 
	`_
(
pTe
, 
n
 == 3);

326 
n
 = 
	`decode_sigd24
(&
du
[0], &
_vue
);

327 
	`_
(
pTe
, 
vue
 =
_vue
);

329 
	}
}

331 
	$BACtSigd32
(

332 
Te
 * 
pTe
)

334 
ut8_t
 
du
[32] = { 0 };

335 
t32_t
 
vue
 = 0, 
_vue
 = 0;

336 
n
 = 0;

338 
vue
 = -2147483647; value < 0; value += 127) {

339 
n
 = 
	`code_sigd32
(&
du
[0], 
vue
);

340 
	`_
(
pTe
, 
n
 == 4);

341 
n
 = 
	`decode_sigd32
(&
du
[0], &
_vue
);

342 
	`_
(
pTe
, 
vue
 =
_vue
);

344 
vue
 = 2147483647; value > 0; value -= 127) {

345 
n
 = 
	`code_sigd32
(&
du
[0], 
vue
);

346 
	`_
(
pTe
, 
n
 == 4);

347 
n
 = 
	`decode_sigd32
(&
du
[0], &
_vue
);

348 
	`_
(
pTe
, 
vue
 =
_vue
);

350 
	}
}

352 
	$BACtIegs
(

353 
Te
 * 
pTe
)

355 
bo
 
rc
;

357 
	`as
(
pTe
);

359 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtUnsigd16
);

360 
	`as
(
rc
);

361 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtUnsigd24
);

362 
	`as
(
rc
);

363 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtUnsigd32
);

364 
	`as
(
rc
);

365 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtSigd8
);

366 
	`as
(
rc
);

367 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtSigd16
);

368 
	`as
(
rc
);

369 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtSigd24
);

370 
	`as
(
rc
);

371 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtSigd32
);

372 
	`as
(
rc
);

373 
	}
}

375 #ifde
TEST_BACINT


376 
	$ma
(

379 
Te
 *
pTe
;

381 
pTe
 = 
	`_
("BACt", 
NULL
);

382 
	`BACtIegs
(
pTe
);

384 
	`_tSm
(
pTe
, 
dout
);

385 
	`_run
(
pTe
);

386 (
	`_pt
(
pTe
);

387 
	`_deroy
(
pTe
);

390 
	}
}

	@src/bacprop.c

34 
	~<dbo.h
>

35 
	~<rg.h
>

36 #i
PRINT_ENABLED


37 
	~<dio.h
>

39 
	~"bar.h
"

43 
PROP_TAG_DATA
 
	gba_obje_devi_ݔty_g_m
[] = {

44 {
PROP_OBJECT_IDENTIFIER
, 
BACNET_APPLICATION_TAG_OBJECT_ID
}

46 {
PROP_OBJECT_NAME
, 
BACNET_APPLICATION_TAG_CHARACTER_STRING
}

48 {
PROP_OBJECT_TYPE
, 
BACNET_APPLICATION_TAG_ENUMERATED
}

50 {
PROP_SYSTEM_STATUS
, 
BACNET_APPLICATION_TAG_ENUMERATED
}

52 {
PROP_VENDOR_NAME
, 
BACNET_APPLICATION_TAG_CHARACTER_STRING
}

54 {
PROP_VENDOR_IDENTIFIER
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
}

56 {
PROP_MODEL_NAME
, 
BACNET_APPLICATION_TAG_CHARACTER_STRING
}

58 {
PROP_FIRMWARE_REVISION
, 
BACNET_APPLICATION_TAG_CHARACTER_STRING
}

60 {
PROP_APPLICATION_SOFTWARE_VERSION
,

61 
BACNET_APPLICATION_TAG_CHARACTER_STRING
}

63 {
PROP_PROTOCOL_VERSION
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
}

65 {
PROP_PROTOCOL_CONFORMANCE_CLASS
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
}

67 {
PROP_PROTOCOL_SERVICES_SUPPORTED
, 
BACNET_APPLICATION_TAG_BIT_STRING
}

69 {
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

70 
BACNET_APPLICATION_TAG_BIT_STRING
}

72 {
PROP_MAX_APDU_LENGTH_ACCEPTED
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
}

74 {
PROP_SEGMENTATION_SUPPORTED
, 
BACNET_APPLICATION_TAG_ENUMERATED
}

76 {
PROP_APDU_TIMEOUT
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
}

78 {
PROP_NUMBER_OF_APDU_RETRIES
, 
BACNET_APPLICATION_TAG_UNSIGNED_INT
}

83 sigd 
	$bar_g_by_dex_deu
(

84 
PROP_TAG_DATA
 * 
da_li
,

85 sigd 
dex
,

86 sigd 
deu_t
)

88 sigd 
pUnsigd
 = 0;

90 i(
da_li
) {

91 
da_li
->
_id
 != -1) {

92 i(
da_li
->
_id
 =
dex
) {

93 
pUnsigd
 = 
da_li
->
g_id
;

96 
da_li
++;

100  
pUnsigd
 ?Unsigd : 
deu_t
;

101 
	}
}

104 sigd 
	$bar_ݔty_g
(

105 
BACNET_OBJECT_TYPE
 
ty
,

106 sigd 

)

108 
ty
) {

109 
OBJECT_DEVICE
:

111 
bar_g_by_dex_deu


112 (
ba_obje_devi_ݔty_g_m
, 

, -1);

114 #i
PRINT_ENABLED


115 
	`rtf
(
dr
, "Unsupported objectype");

121 
	}
}

	@src/bacpropstates.c

35 
	~"bacdcode.h
"

36 
	~"du.h
"

37 
	~"timeamp.h
"

38 
	~"barݡes.h
"

42 
	$ba_decode_ݔty_e
(

43 
ut8_t
 * 
du
,

44 
BACNET_PROPERTY_STATE
 * 
vue
)

46 
n
 = 0;

47 
ut32_t
 
n_vue_ty
;

48 
i_ngth
;

49 
ut32_t
 
umVue
;

50 
ut8_t
 
gnum
;

52 
i_ngth
 =

53 
	`decode_g_numb_d_vue
(&
du
[
n
], &
gnum
, &
n_vue_ty
);

55 i(-1 =
i_ngth
) {

58 
vue
->
g
 = 
gnum
;

59 
n
 +
i_ngth
;

60 
vue
->
g
) {

61 
BOOLEAN_VALUE
:

62 
vue
->
e
.
boޗnVue
 = 
	`decode_boޗn
(
n_vue_ty
);

65 
BINARY_VALUE
:

66 i(-1 =(
i_ngth
 =

67 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

68 &
umVue
))) {

71 
vue
->
e
.
byVue
 = (
BACNET_BINARY_PV

umVue
;

74 
EVENT_TYPE
:

75 i(-1 =(
i_ngth
 =

76 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

77 &
umVue
))) {

80 
vue
->
e
.
evtTy
 = (
BACNET_EVENT_TYPE

umVue
;

83 
POLARITY
:

84 i(-1 =(
i_ngth
 =

85 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

86 &
umVue
))) {

89 
vue
->
e
.
pެy
 = (
BACNET_POLARITY

umVue
;

92 
PROGRAM_CHANGE
:

93 i(-1 =(
i_ngth
 =

94 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

95 &
umVue
))) {

98 
vue
->
e
.
ogmChge
 = (
BACNET_PROGRAM_REQUEST

umVue
;

101 
PROGRAM_STATE
:

102 i(-1 =(
i_ngth
 =

103 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

104 &
umVue
))) {

107 
vue
->
e
.
ogmS
 = (
BACNET_PROGRAM_STATE

umVue
;

110 
REASON_FOR_HALT
:

111 i(-1 =(
i_ngth
 =

112 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

113 &
umVue
))) {

116 
vue
->
e
.
ogmE
 = (
BACNET_PROGRAM_ERROR

umVue
;

119 
RELIABILITY
:

120 i(-1 =(
i_ngth
 =

121 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

122 &
umVue
))) {

125 
vue
->
e
.
lby
 = (
BACNET_RELIABILITY

umVue
;

128 
STATE
:

129 i(-1 =(
i_ngth
 =

130 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

131 &
umVue
))) {

134 
vue
->
e
.(
BACNET_EVENT_STATE

umVue
;

137 
SYSTEM_STATUS
:

138 i(-1 =(
i_ngth
 =

139 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

140 &
umVue
))) {

143 
vue
->
e
.
syemStus
 = (
BACNET_DEVICE_STATUS

umVue
;

146 
UNITS
:

147 i(-1 =(
i_ngth
 =

148 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

149 &
umVue
))) {

152 
vue
->
e
.
uns
 = (
BACNET_ENGINEERING_UNITS

umVue
;

155 
UNSIGNED_VALUE
:

156 i(-1 =(
i_ngth
 =

157 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
,

158 &
vue
->
e
.
unsigdVue
))) {

163 
LIFE_SAFETY_MODE
:

164 i(-1 =(
i_ngth
 =

165 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

166 &
umVue
))) {

169 
vue
->
e
.
liSatyMode
 = (
BACNET_LIFE_SAFETY_MODE

umVue
;

172 
LIFE_SAFETY_STATE
:

173 i(-1 =(
i_ngth
 =

174 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
,

175 &
umVue
))) {

178 
vue
->
e
.
liSatyS
 =

179 (
BACNET_LIFE_SAFETY_STATE

umVue
;

185 
n
 +
i_ngth
;

187  
n
;

188 
	}
}

190 
	$ba_decode_cڋxt_ݔty_e
(

191 
ut8_t
 * 
du
,

192 
ut8_t
 
g_numb
,

193 
BACNET_PROPERTY_STATE
 * 
vue
)

195 
n
 = 0;

196 
i_ngth
;

198 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 
g_numb
)) {

199 
n
++;

200 
i_ngth
 = 
	`ba_decode_ݔty_e
(&
du
[
n
], 
vue
);

202 i(
i_ngth
 == -1) {

203 
n
 = -1;

205 
n
 +
i_ngth
;

206 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 
g_numb
)) {

207 
n
++;

209 
n
 = -1;

213 
n
 = -1;

215  
n
;

216 
	}
}

218 
	$ba_code_ݔty_e
(

219 
ut8_t
 * 
du
,

220 
BACNET_PROPERTY_STATE
 * 
vue
)

222 
n
 = 0;

223 i(
vue
 && 
du
) {

224 
vue
->
g
) {

225 
BOOLEAN_VALUE
:

226 
n
 =

227 
	`code_cڋxt_boޗn
(&
du
[0], 0,

228 
vue
->
e
.
boޗnVue
);

231 
BINARY_VALUE
:

232 
n
 =

233 
	`code_cڋxt_umed
(&
du
[0], 1,

234 
vue
->
e
.
byVue
);

237 
EVENT_TYPE
:

238 
n
 =

239 
	`code_cڋxt_umed
(&
du
[0], 2,

240 
vue
->
e
.
evtTy
);

243 
POLARITY
:

244 
n
 =

245 
	`code_cڋxt_umed
(&
du
[0], 3,

246 
vue
->
e
.
pެy
);

249 
PROGRAM_CHANGE
:

250 
n
 =

251 
	`code_cڋxt_umed
(&
du
[0], 4,

252 
vue
->
e
.
ogmChge
);

255 
PROGRAM_STATE
:

256 
n
 =

257 
	`code_cڋxt_umed
(&
du
[0], 5,

258 
vue
->
e
.
ogmS
);

261 
REASON_FOR_HALT
:

262 
n
 =

263 
	`code_cڋxt_umed
(&
du
[0], 6,

264 
vue
->
e
.
ogmE
);

267 
RELIABILITY
:

268 
n
 =

269 
	`code_cڋxt_umed
(&
du
[0], 7,

270 
vue
->
e
.
lby
);

273 
STATE
:

274 
n
 =

275 
	`code_cڋxt_umed
(&
du
[0], 8, 
vue
->
e
.state);

278 
SYSTEM_STATUS
:

279 
n
 =

280 
	`code_cڋxt_umed
(&
du
[0], 9,

281 
vue
->
e
.
syemStus
);

284 
UNITS
:

285 
n
 =

286 
	`code_cڋxt_umed
(&
du
[0], 10,

287 
vue
->
e
.
uns
);

290 
UNSIGNED_VALUE
:

291 
n
 =

292 
	`code_cڋxt_unsigd
(&
du
[0], 11,

293 
vue
->
e
.
unsigdVue
);

296 
LIFE_SAFETY_MODE
:

297 
n
 =

298 
	`code_cڋxt_umed
(&
du
[0], 12,

299 
vue
->
e
.
liSatyMode
);

302 
LIFE_SAFETY_STATE
:

303 
n
 =

304 
	`code_cڋxt_umed
(&
du
[0], 13,

305 
vue
->
e
.
liSatyS
);

313  
n
;

314 
	}
}

316 #ifde
TEST


317 
	~<rg.h
>

319 
	$PrSs
(

320 
Te
 * 
pTe
)

322 
BACNET_PROPERTY_STATE
 
Da
;

323 
BACNET_PROPERTY_STATE
 
outDa
;

324 
ut8_t
 
pMsg
[
MAX_APDU
];

325 
L
;

326 
outL
;

328 
Da
.
g
 = 
BOOLEAN_VALUE
;

329 
Da
.
e
.
boޗnVue
 = 
ue
;

331 
L
 = 
	`ba_code_ݔty_e
(
pMsg
, &
Da
);

333 
	`memt
(&
outDa
, 0, (outData));

335 
outL
 = 
	`ba_decode_ݔty_e
(
pMsg
, &
outDa
);

337 
	`_
(
pTe
, 
outL
 =
L
);

338 
	`_
(
pTe
, 
Da
.
g
 =
outDa
.tag);

339 
	`_
(
pTe
, 
Da
.
e
.
boޗnVue
 =
outDa
.state.booleanValue);

344 
Da
.
g
 = 
BINARY_VALUE
;

345 
Da
.
e
.
byVue
 = 
BINARY_ACTIVE
;

347 
L
 = 
	`ba_code_ݔty_e
(
pMsg
, &
Da
);

349 
	`memt
(&
outDa
, 0, (outData));

351 
outL
 = 
	`ba_decode_ݔty_e
(
pMsg
, &
outDa
);

353 
	`_
(
pTe
, 
outL
 =
L
);

354 
	`_
(
pTe
, 
Da
.
g
 =
outDa
.tag);

355 
	`_
(
pTe
, 
Da
.
e
.
byVue
 =
outDa
.state.binaryValue);

360 
Da
.
g
 = 
EVENT_TYPE
;

361 
Da
.
e
.
evtTy
 = 
EVENT_BUFFER_READY
;

363 
L
 = 
	`ba_code_ݔty_e
(
pMsg
, &
Da
);

365 
	`memt
(&
outDa
, 0, (outData));

367 
outL
 = 
	`ba_decode_ݔty_e
(
pMsg
, &
outDa
);

369 
	`_
(
pTe
, 
outL
 =
L
);

370 
	`_
(
pTe
, 
Da
.
g
 =
outDa
.tag);

371 
	`_
(
pTe
, 
Da
.
e
.
evtTy
 =
outDa
.state.eventType);

376 
Da
.
g
 = 
POLARITY
;

377 
Da
.
e
.
pެy
 = 
POLARITY_REVERSE
;

379 
L
 = 
	`ba_code_ݔty_e
(
pMsg
, &
Da
);

381 
	`memt
(&
outDa
, 0, (outData));

383 
outL
 = 
	`ba_decode_ݔty_e
(
pMsg
, &
outDa
);

385 
	`_
(
pTe
, 
outL
 =
L
);

386 
	`_
(
pTe
, 
Da
.
g
 =
outDa
.tag);

387 
	`_
(
pTe
, 
Da
.
e
.
pެy
 =
outDa
.state.polarity);

392 
Da
.
g
 = 
PROGRAM_CHANGE
;

393 
Da
.
e
.
ogmChge
 = 
PROGRAM_REQUEST_RESTART
;

395 
L
 = 
	`ba_code_ݔty_e
(
pMsg
, &
Da
);

397 
	`memt
(&
outDa
, 0, (outData));

399 
outL
 = 
	`ba_decode_ݔty_e
(
pMsg
, &
outDa
);

401 
	`_
(
pTe
, 
outL
 =
L
);

402 
	`_
(
pTe
, 
Da
.
g
 =
outDa
.tag);

403 
	`_
(
pTe
, 
Da
.
e
.
ogmChge
 =
outDa
.state.programChange);

408 
Da
.
g
 = 
UNSIGNED_VALUE
;

409 
Da
.
e
.
unsigdVue
 = 0xdeadbeef;

411 
L
 = 
	`ba_code_ݔty_e
(
pMsg
, &
Da
);

413 
	`memt
(&
outDa
, 0, (outData));

415 
outL
 = 
	`ba_decode_ݔty_e
(
pMsg
, &
outDa
);

417 
	`_
(
pTe
, 
outL
 =
L
);

418 
	`_
(
pTe
, 
Da
.
g
 =
outDa
.tag);

419 
	`_
(
pTe
, 
Da
.
e
.
unsigdVue
 =
outDa
.state.unsignedValue);

421 
	}
}

423 #ifde
TEST_PROP_STATES


424 
	~<as.h
>

425 
	$ma
(

428 
Te
 *
pTe
;

429 
bo
 
rc
;

431 
pTe
 = 
	`_
("BACÈEvt", 
NULL
);

433 
rc
 = 
	`_addTeFuni
(
pTe
, 
PrSs
);

434 
	`as
(
rc
);

436 
	`_tSm
(
pTe
, 
dout
);

437 
	`_run
(
pTe
);

438 (
	`_pt
(
pTe
);

439 
	`_deroy
(
pTe
);

442 
	}
}

	@src/bacreal.c

35 
	~<rg.h
>

37 
	~"bacdef.h
"

38 
	~"bacdcode.h
"

39 
	~"banum.h
"

40 
	~"bs.h
"

41 
	~"bacr.h
"

42 
	~"bact.h
"

43 
	~"bal.h
"

49 #ide
BIG_ENDIAN


50 #r 
Defe
 
BIG_ENDIAN
=0 

 BIG_ENDIAN=1 
BACt
 
Sck
 

 
comp
 
gs


55 
	$decode_
(

56 
ut8_t
 * 
du
,

57 *
_vue
)

60 
ut8_t
 
by
[4];

61 
_vue
;

62 } 
my_da
;

65 #i
BIG_ENDIAN


66 
my_da
.
by
[0] = 
du
[0];

67 
my_da
.
by
[1] = 
du
[1];

68 
my_da
.
by
[2] = 
du
[2];

69 
my_da
.
by
[3] = 
du
[3];

71 
my_da
.
by
[0] = 
du
[3];

72 
my_da
.
by
[1] = 
du
[2];

73 
my_da
.
by
[2] = 
du
[1];

74 
my_da
.
by
[3] = 
du
[0];

77 *
_vue
 = 
my_da
.real_value;

80 
	}
}

82 
	$decode__
(

83 
ut8_t
 * 
du
,

84 
ut32_t
 
n_vue
,

85 *
_vue
)

87 i(
n_vue
 != 4) {

88 *
_vue
 = 0.0f;

89  (
n_vue
;

91  
	`decode_
(
du
, 
_vue
);

93 
	}
}

95 
	$decode_cڋxt_
(

96 
ut8_t
 * 
du
,

97 
ut8_t
 
g_numb
,

98 *
_vue
)

100 
ut32_t
 
n_vue
;

101 
n
 = 0;

103 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 
g_numb
)) {

104 
n
 +=

105 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

106 
n
 +
	`decode_
(&
du
[n], 
_vue
);

108 
n
 = -1;

110  
n
;

111 
	}
}

115 
	$code_ba_
(

116 
vue
,

117 
ut8_t
 * 
du
)

120 
ut8_t
 
by
[4];

121 
_vue
;

122 } 
my_da
;

125 
my_da
.
_vue
 = 
vue
;

126 #i
BIG_ENDIAN


127 
du
[0] = 
my_da
.
by
[0];

128 
du
[1] = 
my_da
.
by
[1];

129 
du
[2] = 
my_da
.
by
[2];

130 
du
[3] = 
my_da
.
by
[3];

132 
du
[0] = 
my_da
.
by
[3];

133 
du
[1] = 
my_da
.
by
[2];

134 
du
[2] = 
my_da
.
by
[1];

135 
du
[3] = 
my_da
.
by
[0];

139 
	}
}

141 #i
BACNET_USE_DOUBLE


145 
	$decode_doub
(

146 
ut8_t
 * 
du
,

147 *
doub_vue
)

150 
ut8_t
 
by
[8];

151 
doub_vue
;

152 } 
my_da
;

155 #i
BIG_ENDIAN


156 
my_da
.
by
[0] = 
du
[0];

157 
my_da
.
by
[1] = 
du
[1];

158 
my_da
.
by
[2] = 
du
[2];

159 
my_da
.
by
[3] = 
du
[3];

160 
my_da
.
by
[4] = 
du
[4];

161 
my_da
.
by
[5] = 
du
[5];

162 
my_da
.
by
[6] = 
du
[6];

163 
my_da
.
by
[7] = 
du
[7];

165 
my_da
.
by
[0] = 
du
[7];

166 
my_da
.
by
[1] = 
du
[6];

167 
my_da
.
by
[2] = 
du
[5];

168 
my_da
.
by
[3] = 
du
[4];

169 
my_da
.
by
[4] = 
du
[3];

170 
my_da
.
by
[5] = 
du
[2];

171 
my_da
.
by
[6] = 
du
[1];

172 
my_da
.
by
[7] = 
du
[0];

175 *
doub_vue
 = 
my_da
.double_value;

178 
	}
}

180 
	$decode_doub_
(

181 
ut8_t
 * 
du
,

182 
ut32_t
 
n_vue
,

183 *
doub_vue
)

185 i(
n_vue
 != 8) {

186 *
doub_vue
 = 0.0;

187  (
n_vue
;

189  
	`decode_doub
(
du
, 
doub_vue
);

191 
	}
}

195 
	$code_ba_doub
(

196 
vue
,

197 
ut8_t
 * 
du
)

200 
ut8_t
 
by
[8];

201 
doub_vue
;

202 } 
my_da
;

205 
my_da
.
doub_vue
 = 
vue
;

206 #i
BIG_ENDIAN


207 
du
[0] = 
my_da
.
by
[0];

208 
du
[1] = 
my_da
.
by
[1];

209 
du
[2] = 
my_da
.
by
[2];

210 
du
[3] = 
my_da
.
by
[3];

211 
du
[4] = 
my_da
.
by
[4];

212 
du
[5] = 
my_da
.
by
[5];

213 
du
[6] = 
my_da
.
by
[6];

214 
du
[7] = 
my_da
.
by
[7];

216 
du
[0] = 
my_da
.
by
[7];

217 
du
[1] = 
my_da
.
by
[6];

218 
du
[2] = 
my_da
.
by
[5];

219 
du
[3] = 
my_da
.
by
[4];

220 
du
[4] = 
my_da
.
by
[3];

221 
du
[5] = 
my_da
.
by
[2];

222 
du
[6] = 
my_da
.
by
[1];

223 
du
[7] = 
my_da
.
by
[0];

227 
	}
}

229 
	$decode_cڋxt_doub
(

230 
ut8_t
 * 
du
,

231 
ut8_t
 
g_numb
,

232 *
doub_vue
)

234 
ut32_t
 
n_vue
;

235 
n
 = 0;

237 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 
g_numb
)) {

238 
n
 +=

239 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

240 
n
 +
	`decode_doub
(&
du
[n], 
doub_vue
);

242 
n
 = -1;

244  
n
;

245 
	}
}

249 #ifde
TEST


250 
	~<as.h
>

251 
	~<rg.h
>

252 
	~<y.h
>

253 
	~"e.h
"

255 
	$BAC
(

256 
Te
 * 
pTe
)

258 
_vue
 = 3.14159F, 
__vue
 = 0.0;

259 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

260 
n
 = 0, 
_n
 = 0;

262 
n
 = 
	`code_ba_
(
_vue
, &
du
[0]);

263 
	`_
(
pTe
, 
n
 == 4);

264 
_n
 = 
	`decode_
(&
du
[0], &
__vue
);

265 
	`_
(
pTe
, 
_n
 =
n
);

266 
	`_
(
pTe
, 
__vue
 =
_vue
);

267 
	}
}

269 
	$BACdoub
(

270 
Te
 * 
pTe
)

272 
doub_vue
 = 3.1415927, 
_doub_vue
 = 0.0;

273 
ut8_t
 
du
[
MAX_APDU
] = { 0 };

274 
n
 = 0, 
_n
 = 0;

276 
n
 = 
	`code_ba_doub
(
doub_vue
, &
du
[0]);

277 
	`_
(
pTe
, 
n
 == 8);

278 
_n
 = 
	`decode_doub
(&
du
[0], &
_doub_vue
);

279 
	`_
(
pTe
, 
_n
 =
n
);

280 
	`_
(
pTe
, 
_doub_vue
 =
doub_vue
);

281 
	}
}

283 #ifde
TEST_BACNET_REAL


284 
	$ma
(

287 
Te
 *
pTe
;

288 
bo
 
rc
;

290 
pTe
 = 
	`_
("BAC", 
NULL
);

292 
rc
 = 
	`_addTeFuni
(
pTe
, 
BAC
);

293 
	`as
(
rc
);

294 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACdoub
);

295 
	`as
(
rc
);

298 
	`_tSm
(
pTe
, 
dout
);

299 
	`_run
(
pTe
);

300 (
	`_pt
(
pTe
);

301 
	`_deroy
(
pTe
);

304 
	}
}

	@src/bacstr.c

35 
	~<dbo.h
>

36 
	~<dt.h
>

37 
	~<rg.h
>

38 
	~"cfig.h
"

39 
	~"bacr.h
"

40 
	~"bs.h
"

41 #i
PRINT_ENABLED


42 
	~<dlib.h
>

43 
	~<y.h
>

48 
	$brg_
(

49 
BACNET_BIT_STRING
 * 
b_rg
)

51 
i
;

53 
b_rg
->
bs_ud
 = 0;

54 
i
 = 0; i < 
MAX_BITSTRING_BYTES
; i++) {

55 
b_rg
->
vue
[
i
] = 0;

57 
	}
}

59 
	$brg_t_b
(

60 
BACNET_BIT_STRING
 * 
b_rg
,

61 
ut8_t
 
b_numb
,

62 
bo
 
vue
)

64 
ut8_t
 
by_numb
 = 
b_numb
 / 8;

65 
ut8_t
 
b_mask
 = 1;

67 i(
by_numb
 < 
MAX_BITSTRING_BYTES
) {

69 i(
b_rg
->
bs_ud
 < (
b_numb
 + 1)) {

70 
b_rg
->
bs_ud
 = 
b_numb
 + 1;

72 
b_mask
 = b_mask << (
b_numb
 - (
by_numb
 * 8));

73 i(
vue
) {

74 
b_rg
->
vue
[
by_numb
] |
b_mask
;

76 
b_rg
->
vue
[
by_numb
] &(~(
b_mask
));

79 
	}
}

81 
bo
 
	$brg_b
(

82 
BACNET_BIT_STRING
 * 
b_rg
,

83 
ut8_t
 
b_numb
)

85 
bo
 
vue
 = 
l
;

86 
ut8_t
 
by_numb
 = 
b_numb
 / 8;

87 
ut8_t
 
b_mask
 = 1;

89 i(
b_numb
 < (
MAX_BITSTRING_BYTES
 * 8)) {

90 
b_mask
 = b_mask << (
b_numb
 - (
by_numb
 * 8));

91 i(
b_rg
->
vue
[
by_numb
] & 
b_mask
) {

92 
vue
 = 
ue
;

96  
vue
;

97 
	}
}

99 
ut8_t
 
	$brg_bs_ud
(

100 
BACNET_BIT_STRING
 * 
b_rg
)

102  
b_rg
->
bs_ud
;

103 
	}
}

106 
ut8_t
 
	$brg_bys_ud
(

107 
BACNET_BIT_STRING
 * 
b_rg
)

109 
ut8_t
 
n
 = 0;

110 
ut8_t
 
ud_bys
 = 0;

111 
ut8_t
 
ϡ_b
 = 0;

113 i(
b_rg
->
bs_ud
) {

114 
ϡ_b
 = 
b_rg
->
bs_ud
 - 1;

115 
ud_bys
 = 
ϡ_b
 / 8;

117 
ud_bys
++;

118 
n
 = 
ud_bys
;

121  
n
;

122 
	}
}

124 
ut8_t
 
	$brg_o
(

125 
BACNET_BIT_STRING
 * 
b_rg
,

126 
ut8_t
 
o_dex
)

128 
ut8_t
 
o
 = 0;

130 i(
b_rg
) {

131 i(
o_dex
 < 
MAX_BITSTRING_BYTES
) {

132 
o
 = 
b_rg
->
vue
[
o_dex
];

136  
o
;

137 
	}
}

139 
bo
 
	$brg_t_o
(

140 
BACNET_BIT_STRING
 * 
b_rg
,

141 
ut8_t
 
dex
,

142 
ut8_t
 
o
)

144 
bo
 
us
 = 
l
;

146 i(
b_rg
) {

147 i(
dex
 < 
MAX_BITSTRING_BYTES
) {

148 
b_rg
->
vue
[
dex
] = 
o
;

149 
us
 = 
ue
;

153  
us
;

154 
	}
}

156 
bo
 
	$brg_t_bs_ud
(

157 
BACNET_BIT_STRING
 * 
b_rg
,

158 
ut8_t
 
bys_ud
,

159 
ut8_t
 
unud_bs
)

161 
bo
 
us
 = 
l
;

163 i(
b_rg
) {

165 
b_rg
->
bs_ud
 = 
bys_ud
 * 8;

166 
b_rg
->
bs_ud
 -
unud_bs
;

167 
us
 = 
ue
;

170  
us
;

171 
	}
}

173 
ut8_t
 
	$brg_bs_cy
(

174 
BACNET_BIT_STRING
 * 
b_rg
)

176 i(
b_rg
) {

177  (
MAX_BITSTRING_BYTES
 * 8);

181 
	}
}

183 
bo
 
	$brg_cy
(

184 
BACNET_BIT_STRING
 * 
de
,

185 
BACNET_BIT_STRING
 * 
c
)

187 
i
;

188 
bo
 
us
 = 
l
;

190 i(
de
 && 
c
) {

191 
de
->
bs_ud
 = 
c
->bits_used;

192 
i
 = 0; i < 
MAX_BITSTRING_BYTES
; i++) {

193 
de
->
vue
[
i
] = 
c
->value[i];

195 
us
 = 
ue
;

198  
us
;

199 
	}
}

202 
bo
 
	$brg_me
(

203 
BACNET_BIT_STRING
 * 
brg1
,

204 
BACNET_BIT_STRING
 * 
brg2
)

206 
i
 = 0;

207 
bys_ud
 = 0;

208 
ut8_t
 
com_mask
 = 0;

210 i(
brg1
 && 
brg2
) {

211 i((
brg1
->
bs_ud
 =
brg2
->bits_used) &&

212 (
brg1
->
bs_ud
 / 8 <
MAX_BITSTRING_BYTES
)) {

213 
bys_ud
 = ((
brg1
->
bs_ud
 / 8);

214 
com_mask
 = 0xFF >> (8 - (
brg1
->
bs_ud
 % 8));

216 
i
 = 0; i < 
bys_ud
; i++) {

217 i(
brg1
->
vue
[
i
] !
brg2
->value[i]) {

218  
l
;

221 i((
brg1
->
vue
[
bys_ud
] & 
com_mask
) !=

222 (
brg2
->
vue
[
bys_ud
] & 
com_mask
)) {

223  
l
;

225  
ue
;

230  
l
;

231 
	}
}

233 #i
PRINT_ENABLED


237 
bo
 
	$brg__ascii
(

238 
BACNET_BIT_STRING
 * 
b_rg
,

239 cڡ *
ascii
)

241 
bo
 
us
 = 
l
;

242 
dex
 = 0;

243 
ut8_t
 
b_numb
 = 0;

245 i(
b_rg
) {

246 
	`brg_
(
b_rg
);

247 i(
ascii
[0] == 0) {

249 
us
 = 
ue
;

251 
ascii
[
dex
] != 0) {

252 i(
b_numb
 > 
	`brg_bs_cy
(
b_rg
)) {

254 
us
 = 
l
;

257 i(
ascii
[
dex
] == '1') {

258 
	`brg_t_b
(
b_rg
, 
b_numb
, 
ue
);

259 
b_numb
++;

260 
us
 = 
ue
;

261 } i(
ascii
[
dex
] == '0') {

262 
	`brg_t_b
(
b_rg
, 
b_numb
, 
l
);

263 
b_numb
++;

264 
us
 = 
ue
;

267 
dex
++;

271 
dex
++;

276  
us
;

277 
	}
}

280 
	#CHARACTER_STRING_CAPACITY
 (
MAX_CHARACTER_STRING_BYTES
 - 1)

	)

283 
bo
 
	$charg_
(

284 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

285 
ut8_t
 
codg
,

286 cڡ *
vue
,

287 
size_t
 
ngth
)

289 
bo
 
us
 = 
l
;

290 
size_t
 
i
;

292 i(
ch_rg
) {

293 
ch_rg
->
ngth
 = 0;

294 
ch_rg
->
codg
 =ncoding;

297 i(
ngth
 <
CHARACTER_STRING_CAPACITY
) {

298 i(
vue
) {

299 
i
 = 0; i < 
MAX_CHARACTER_STRING_BYTES
; i++) {

300 i(
i
 < 
ngth
) {

301 
ch_rg
->
vue
[ch_rg->
ngth
] = vue[
i
];

302 
ch_rg
->
ngth
++;

304 
ch_rg
->
vue
[
i
] = 0;

308 
i
 = 0; i < 
MAX_CHARACTER_STRING_BYTES
; i++) {

309 
ch_rg
->
vue
[
i
] = 0;

312 
us
 = 
ue
;

316  
us
;

317 
	}
}

319 
bo
 
	$charg__si
(

320 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

321 cڡ *
vue
)

323  
	`charg_
(
ch_rg
, 
CHARACTER_ANSI_X34
, 
vue
,

324 
vue
 ? 
	`
(value) : 0);

325 
	}
}

327 
bo
 
	$charg_cy
(

328 
BACNET_CHARACTER_STRING
 * 
de
,

329 
BACNET_CHARACTER_STRING
 * 
c
)

331  
	`charg_
(
de
, 
	`charg_codg
(
c
),

332 
	`charg_vue
(
c
), 
	`charg_ngth
(src));

333 
	}
}

335 
bo
 
	$charg_si_cy
(

336 *
de
,

337 
size_t
 
de_max_n
,

338 
BACNET_CHARACTER_STRING
 * 
c
)

340 
size_t
 
i
;

342 i(
de
 && 
c
 && (c->
codg
 =
CHARACTER_ANSI_X34
) &&

343 (
c
->
ngth
 < 
de_max_n
)) {

344 
i
 = 0; i < 
de_max_n
; i++) {

345 i(
i
 < 
c
->
ngth
) {

346 
de
[
i
] = 
c
->
vue
[i];

348 
de
[
i
] = 0;

351  
ue
;

354  
l
;

355 
	}
}

358 
bo
 
	$charg_me
(

359 
BACNET_CHARACTER_STRING
 * 
de
,

360 
BACNET_CHARACTER_STRING
 * 
c
)

362 
size_t
 
i
;

363 
bo
 
me_us
 = 
l
;

365 i(
c
 && 
de
) {

366 i((
c
->
ngth
 =
de
->ngth&& (c->
codg
 == dest->encoding)) {

367 
me_us
 = 
ue
;

368 
i
 = 0; (< 
c
->
ngth
&& 
me_us
; i++) {

369 i(
c
->
vue
[
i
] !
de
->value[i]) {

370 
me_us
 = 
l
;

374 } i(
c
) {

375 i(
c
->
ngth
 == 0) {

376 
me_us
 = 
ue
;

378 } i(
de
) {

379 i(
de
->
ngth
 == 0) {

380 
me_us
 = 
ue
;

384  
me_us
;

385 
	}
}

387 
bo
 
	$charg_si_me
(

388 
BACNET_CHARACTER_STRING
 * 
de
,

389 cڡ *
c
)

391 
size_t
 
i
;

392 
bo
 
me_us
 = 
l
;

394 i(
c
 && 
de
) {

395 i((
de
->
ngth
 =
	`
(
c
)) &&

396 (
de
->
codg
 =
CHARACTER_ANSI_X34
)) {

397 
me_us
 = 
ue
;

398 
i
 = 0; (< 
de
->
ngth
&& 
me_us
; i++) {

399 i(
c
[
i
] !
de
->
vue
[i]) {

400 
me_us
 = 
l
;

406 i(
c
) {

407 i(
	`
(
c
) == 0) {

408 
me_us
 = 
ue
;

410 } i(
de
) {

411 i(
de
->
ngth
 == 0) {

412 
me_us
 = 
ue
;

416  
me_us
;

417 
	}
}

420 
bo
 
	$charg_nd
(

421 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

422 cڡ *
vue
,

423 
size_t
 
ngth
)

425 
size_t
 
i
;

426 
bo
 
us
 = 
l
;

428 i(
ch_rg
) {

429 i((
ngth
 + 
ch_rg
->ngth<
CHARACTER_STRING_CAPACITY
) {

430 
i
 = 0; i < 
ngth
; i++) {

431 
ch_rg
->
vue
[ch_rg->
ngth
] = vue[
i
];

432 
ch_rg
->
ngth
++;

434 
us
 = 
ue
;

438  
us
;

439 
	}
}

444 
bo
 
	$charg_un
(

445 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

446 
size_t
 
ngth
)

448 
bo
 
us
 = 
l
;

450 i(
ch_rg
) {

451 i(
ngth
 <
CHARACTER_STRING_CAPACITY
) {

452 
ch_rg
->
ngth
 =ength;

453 
us
 = 
ue
;

457  
us
;

458 
	}
}

461 *
	$charg_vue
(

462 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

464 *
vue
 = 
NULL
;

466 i(
ch_rg
) {

467 
vue
 = 
ch_rg
->value;

470  
vue
;

471 
	}
}

474 
size_t
 
	$charg_ngth
(

475 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

477 
size_t
 
ngth
 = 0;

479 i(
ch_rg
) {

481 
ngth
 = 
ch_rg
->length;

484  
ngth
;

485 
	}
}

487 
size_t
 
	$charg_cy
(

488 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

490 
size_t
 
ngth
 = 0;

492 i(
ch_rg
) {

493 
ngth
 = 
CHARACTER_STRING_CAPACITY
;

496  
ngth
;

497 
	}
}

500 
ut8_t
 
	$charg_codg
(

501 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

503 
ut8_t
 
codg
 = 0;

505 i(
ch_rg
) {

506 
codg
 = 
ch_rg
->encoding;

509  
codg
;

510 
	}
}

513 
bo
 
	$charg_t_codg
(

514 
BACNET_CHARACTER_STRING
 * 
ch_rg
,

515 
ut8_t
 
codg
)

517 
bo
 
us
 = 
l
;

519 i(
ch_rg
) {

520 
ch_rg
->
codg
 =ncoding;

521 
us
 = 
ue
;

524  
us
;

525 
	}
}

538 
bo
 
	$charg_b
(

539 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

541 
bo
 
us
 = 
l
;

542 
size_t
 
i
;

544 i(
ch_rg
) {

545 i(
ch_rg
->
codg
 =
CHARACTER_ANSI_X34
) {

546 
us
 = 
ue
;

547 
i
 = 0; i < 
MAX_CHARACTER_STRING_BYTES
; i++) {

548 i(
i
 < 
ch_rg
->
ngth
) {

549 i((
ch_rg
->
vue
[
i
] < 0x20) ||

550 (
ch_rg
->
vue
[
i
] > 0x7E)) {

551 
us
 = 
l
;

558 
us
 = 
ue
;

562  
us
;

563 
	}
}

568 cڡ 
	gagBysFUTF8
[256] = {

590 
bo
 
	$utf8_isvid
(

591 cڡ *
r
,

592 
size_t
 
ngth
)

594 cڡ *
p
, *
nd
 = (*
r
 + 
ngth
;

595 
c
;

596 
size_t
 
ab
;

599 i(
ngth
 == 0) {

600  
ue
;

602 
p
 = (cڡ *
r
; < 
nd
;++) {

603 
c
 = *
p
;

605 i(
c
 == 0) {

606  
l
;

609 i(
c
 < 128) {

612 i((
c
 & 0xc0) != 0xc0) {

613  
l
;

615 
ab
 = (
size_t

agBysFUTF8
[
c
];

616 i(
ngth
 < 
ab
) {

617  
l
;

619 
ngth
 -
ab
;

621 
p
++;

623 i((*
p
 & 0xc0) != 0x80) {

624  
l
;

627 
ab
) {

630 i((
c
 & 0x3e) == 0)

631  
l
;

636 i(
c
 =0xe0 && (*
p
 & 0x20) == 0)

637  
l
;

642 i(
c
 =0xf0 && (*
p
 & 0x30) == 0)

643  
l
;

648 i(
c
 =0xf8 && (*
p
 & 0x38) == 0)

649  
l
;

655 i(
c
 =0x || c =0xf|| (=0xf&& (*
p
 & 0x3c) == 0))

656  
l
;

661 --
ab
 > 0) {

662 i((*(++
p
) & 0xc0) != 0x80)

663  
l
;

667  
ue
;

668 
	}
}

670 
bo
 
	$charg_vid
(

671 
BACNET_CHARACTER_STRING
 * 
ch_rg
)

673 
bo
 
vid
 = 
l
;

675 i(
ch_rg
->
codg
 < 
MAX_CHARACTER_STRING_ENCODING
) {

676 i(
ch_rg
->
codg
 =
CHARACTER_UTF8
) {

677 i(
	`utf8_isvid
(
ch_rg
->
vue
, ch_rg->
ngth
)) {

678 
vid
 = 
ue
;

681 
vid
 = 
ue
;

685  
vid
;

686 
	}
}

688 #i
BACNET_USE_OCTETSTRING


691 
bo
 
	$org_
(

692 
BACNET_OCTET_STRING
 * 
o_rg
,

693 
ut8_t
 * 
vue
,

694 
size_t
 
ngth
)

696 
bo
 
us
 = 
l
;

697 
size_t
 
i
;

699 i(
o_rg
 && (
ngth
 <
MAX_OCTET_STRING_BYTES
)) {

700 
o_rg
->
ngth
 = 0;

701 i(
vue
) {

702 
i
 = 0; i < 
MAX_OCTET_STRING_BYTES
; i++) {

703 i(
i
 < 
ngth
) {

704 
o_rg
->
vue
[
i
] = value[i];

706 
o_rg
->
vue
[
i
] = 0;

709 
o_rg
->
ngth
 =ength;

711 
i
 = 0; i < 
MAX_OCTET_STRING_BYTES
; i++) {

712 
o_rg
->
vue
[
i
] = 0;

715 
us
 = 
ue
;

718  
us
;

719 
	}
}

721 #i
PRINT_ENABLED


724 
bo
 
	$org__ascii_hex
(

725 
BACNET_OCTET_STRING
 * 
o_rg
,

726 cڡ *
ascii_hex
)

728 
bo
 
us
 = 
l
;

729 
dex
 = 0;

730 
ut8_t
 
vue
 = 0;

731 
hex__rg
[3] = "";

733 i(
o_rg
) {

734 
o_rg
->
ngth
 = 0;

735 i(
ascii_hex
[0] == 0) {

737 
us
 = 
ue
;

739 
ascii_hex
[
dex
] != 0) {

740 i(!
	`ium
(
ascii_hex
[
dex
])) {

742 
dex
++;

745 i(
ascii_hex
[
dex
 + 1] == 0) {

748 
hex__rg
[0] = 
ascii_hex
[
dex
];

749 
hex__rg
[1] = 
ascii_hex
[
dex
 + 1];

750 
vue
 = (
ut8_t

	`
(
hex__rg
, 
NULL
, 16);

751 i(
o_rg
->
ngth
 <
MAX_OCTET_STRING_BYTES
) {

752 
o_rg
->
vue
[o_rg->
ngth
] = value;

753 
o_rg
->
ngth
++;

755 
us
 = 
ue
;

758 
us
 = 
l
;

761 
dex
 += 2;

766  
us
;

767 
	}
}

770 
bo
 
	$org_cy
(

771 
BACNET_OCTET_STRING
 * 
de
,

772 
BACNET_OCTET_STRING
 * 
c
)

774  
	`org_
(
de
, 
	`org_vue
(
c
),

775 
	`org_ngth
(
c
));

776 
	}
}

780 
size_t
 
	$org_cy_vue
(

781 
ut8_t
 * 
de
,

782 
size_t
 
ngth
,

783 
BACNET_OCTET_STRING
 * 
c
)

785 
size_t
 
bys_cݛd
 = 0;

786 
size_t
 
i
;

788 i(
c
 && 
de
) {

789 i(
ngth
 <
c
->length) {

790 
i
 = 0; i < 
c
->
ngth
; i++) {

791 
de
[
i
] = 
c
->
vue
[i];

793 
bys_cݛd
 = 
c
->
ngth
;

797  
bys_cݛd
;

798 
	}
}

801 
bo
 
	$org_nd
(

802 
BACNET_OCTET_STRING
 * 
o_rg
,

803 
ut8_t
 * 
vue
,

804 
size_t
 
ngth
)

806 
size_t
 
i
;

807 
bo
 
us
 = 
l
;

809 i(
o_rg
) {

810 i((
ngth
 + 
o_rg
->ngth<
MAX_OCTET_STRING_BYTES
) {

811 
i
 = 0; i < 
ngth
; i++) {

812 
o_rg
->
vue
[o_rg->
ngth
] = vue[
i
];

813 
o_rg
->
ngth
++;

815 
us
 = 
ue
;

819  
us
;

820 
	}
}

825 
bo
 
	$org_un
(

826 
BACNET_OCTET_STRING
 * 
o_rg
,

827 
size_t
 
ngth
)

829 
bo
 
us
 = 
l
;

831 i(
o_rg
) {

832 i(
ngth
 <
MAX_OCTET_STRING_BYTES
) {

833 
o_rg
->
ngth
 =ength;

834 
us
 = 
ue
;

838  
us
;

839 
	}
}

842 
ut8_t
 *
	$org_vue
(

843 
BACNET_OCTET_STRING
 * 
o_rg
)

845 
ut8_t
 *
vue
 = 
NULL
;

847 i(
o_rg
) {

848 
vue
 = 
o_rg
->value;

851  
vue
;

852 
	}
}

855 
size_t
 
	$org_ngth
(

856 
BACNET_OCTET_STRING
 * 
o_rg
)

858 
size_t
 
ngth
 = 0;

860 i(
o_rg
) {

862 
ngth
 = 
o_rg
->length;

865  
ngth
;

866 
	}
}

869 
size_t
 
	$org_cy
(

870 
BACNET_OCTET_STRING
 * 
o_rg
)

872 
size_t
 
ngth
 = 0;

874 i(
o_rg
) {

876 
ngth
 = 
MAX_OCTET_STRING_BYTES
;

879  
ngth
;

880 
	}
}

883 
bo
 
	$org_vue_me
(

884 
BACNET_OCTET_STRING
 * 
o_rg1
,

885 
BACNET_OCTET_STRING
 * 
o_rg2
)

887 
size_t
 
i
 = 0;

889 i(
o_rg1
 && 
o_rg2
) {

890 i((
o_rg1
->
ngth
 =
o_rg2
->length) &&

891 (
o_rg1
->
ngth
 <
MAX_OCTET_STRING_BYTES
)) {

892 
i
 = 0; i < 
o_rg1
->
ngth
; i++) {

893 i(
o_rg1
->
vue
[
i
] !
o_rg2
->value[i]) {

894  
l
;

897  
ue
;

901  
l
;

902 
	}
}

905 #ifde
TEST


906 
	~<as.h
>

907 
	~<rg.h
>

908 
	~<dlib.h
>

909 
	~<time.h
>

910 
	~"e.h
"

912 
	$BSg
(

913 
Te
 * 
pTe
)

915 
ut8_t
 
b
 = 0;

916 
max_b
;

917 
BACNET_BIT_STRING
 
b_rg
;

918 
BACNET_BIT_STRING
 
b_rg2
;

919 
BACNET_BIT_STRING
 
b_rg3
;

921 
	`brg_
(&
b_rg
);

923 
	`_
(
pTe
, 
	`brg_bs_ud
(&
b_rg
) == 0);

924 
b
 = 0; b < (
MAX_BITSTRING_BYTES
 * 8); bit++) {

925 
	`_
(
pTe
, 
	`brg_b
(&
b_rg
, 
b
=
l
);

929 
b
 = 0; b < (
MAX_BITSTRING_BYTES
 * 8); bit++) {

930 
	`brg_t_b
(&
b_rg
, 
b
, 
ue
);

931 
	`_
(
pTe
, 
	`brg_bs_ud
(&
b_rg
=(
b
 + 1));

932 
	`_
(
pTe
, 
	`brg_b
(&
b_rg
, 
b
=
ue
);

935 
	`brg_
(&
b_rg
);

936 
b
 = 0; b < (
MAX_BITSTRING_BYTES
 * 8); bit++) {

937 
	`brg_t_b
(&
b_rg
, 
b
, 
l
);

938 
	`_
(
pTe
, 
	`brg_bs_ud
(&
b_rg
=(
b
 + 1));

939 
	`_
(
pTe
, 
	`brg_b
(&
b_rg
, 
b
=
l
);

943 
	`d
(
	`time
(
NULL
));

944 
max_b
 = 0; max_b < (
MAX_BITSTRING_BYTES
 * 8); max_bit++) {

945 
	`brg_
(&
b_rg
);

946 
	`brg_
(&
b_rg2
);

947 
b
 = 0; b < 
max_b
; bit++) {

948 
bo
 
b_vue
 = 
	`nd
() % 2;

949 
	`brg_t_b
(&
b_rg
, 
b
, 
b_vue
);

950 
	`brg_t_b
(&
b_rg2
, 
b
, 
b_vue
);

952 
	`_
(
pTe
, 
	`brg_me
(&
b_rg
, &
b_rg2
));

955 
max_b
 = 1; max_b < (
MAX_BITSTRING_BYTES
 * 8); max_bit++) {

956 
	`brg_
(&
b_rg
);

957 
	`brg_
(&
b_rg2
);

958 
	`brg_
(&
b_rg3
);

959 
b
 = 0; b < 
max_b
; bit++) {

960 
bo
 
b_vue
 = 
	`nd
() % 2;

961 
	`brg_t_b
(&
b_rg
, 
b
, 
b_vue
);

962 
	`brg_t_b
(&
b_rg2
, 
b
, 
b_vue
);

963 
	`brg_t_b
(&
b_rg3
, 
b
, 
b_vue
);

966 
	`brg_t_b
(&
b_rg2
, 0, !
	`brg_b
(&
b_rg
, 0));

967 
	`brg_t_b
(&
b_rg3
, 
max_b
 - 1,

968 !
	`brg_b
(&
b_rg
, 
max_b
 - 1));

969 
	`_
(
pTe
, !
	`brg_me
(&
b_rg
, &
b_rg2
));

970 
	`_
(
pTe
, !
	`brg_me
(&
b_rg
, &
b_rg3
));

972 
	}
}

974 
	$ChaSg
(

975 
Te
 * 
pTe
)

977 
BACNET_CHARACTER_STRING
 
ba_rg
;

978 *
vue
 = "Joshua,Mary,Anna,Christopher";

979 
_vue
[
MAX_APDU
] = "Patricia";

980 
_nd_vue
[
MAX_APDU
] = "ndhe Kids";

981 
_nd_rg
[
MAX_APDU
] = "";

982 
bo
 
us
 = 
l
;

983 
size_t
 
ngth
 = 0;

984 
size_t
 
_ngth
 = 0;

985 
size_t
 
i
 = 0;

988 
us
 = 
	`charg_
(&
ba_rg
, 
CHARACTER_ANSI_X34
, 
NULL
, 0);

989 
	`_
(
pTe
, 
us
 =
ue
);

990 
	`_
(
pTe
, 
	`charg_ngth
(&
ba_rg
) == 0);

991 
	`_
(
pTe
,

992 
	`charg_codg
(&
ba_rg
=
CHARACTER_ANSI_X34
);

994 
us
 =

995 
	`charg_
(&
ba_rg
, 
CHARACTER_ANSI_X34
, 
NULL
,

996 
	`charg_cy
(&
ba_rg
) + 1);

997 
	`_
(
pTe
, 
us
 =
l
);

998 
us
 =

999 
	`charg_un
(&
ba_rg
,

1000 
	`charg_cy
(&
ba_rg
) + 1);

1001 
	`_
(
pTe
, 
us
 =
l
);

1002 
us
 =

1003 
	`charg_un
(&
ba_rg
,

1004 
	`charg_cy
(&
ba_rg
));

1005 
	`_
(
pTe
, 
us
 =
ue
);

1007 
_ngth
 = 
	`
(
_vue
);

1008 
us
 =

1009 
	`charg_
(&
ba_rg
, 
CHARACTER_ANSI_X34
,

1010 &
_vue
[0], 
_ngth
);

1011 
	`_
(
pTe
, 
us
 =
ue
);

1012 
vue
 = 
	`charg_vue
(&
ba_rg
);

1013 
ngth
 = 
	`charg_ngth
(&
ba_rg
);

1014 
	`_
(
pTe
, 
ngth
 =
_ngth
);

1015 
i
 = 0; i < 
_ngth
; i++) {

1016 
	`_
(
pTe
, 
vue
[
i
] =
_vue
[i]);

1018 
_ngth
 = 
	`
(
_nd_vue
);

1019 
us
 =

1020 
	`charg_nd
(&
ba_rg
, &
_nd_vue
[0],

1021 
_ngth
);

1022 
	`rt
(
_nd_rg
, 
_vue
);

1023 
	`rt
(
_nd_rg
, 
_nd_vue
);

1024 
_ngth
 = 
	`
(
_nd_rg
);

1025 
	`_
(
pTe
, 
us
 =
ue
);

1026 
ngth
 = 
	`charg_ngth
(&
ba_rg
);

1027 
vue
 = 
	`charg_vue
(&
ba_rg
);

1028 
	`_
(
pTe
, 
ngth
 =
_ngth
);

1029 
i
 = 0; i < 
_ngth
; i++) {

1030 
	`_
(
pTe
, 
vue
[
i
] =
_nd_rg
[i]);

1032 
	}
}

1034 
	$OSg
(

1035 
Te
 * 
pTe
)

1037 
BACNET_OCTET_STRING
 
ba_rg
;

1038 
ut8_t
 *
vue
 = 
NULL
;

1039 
ut8_t
 
_vue
[
MAX_APDU
] = "Patricia";

1040 
ut8_t
 
_nd_vue
[
MAX_APDU
] = "ndhe Kids";

1041 
ut8_t
 
_nd_rg
[
MAX_APDU
] = "";

1042 
bo
 
us
 = 
l
;

1043 
size_t
 
ngth
 = 0;

1044 
size_t
 
_ngth
 = 0;

1045 
size_t
 
i
 = 0;

1048 
us
 = 
	`org_
(&
ba_rg
, 
NULL
, 0);

1049 
	`_
(
pTe
, 
us
 =
ue
);

1050 
	`_
(
pTe
, 
	`org_ngth
(&
ba_rg
) == 0);

1051 
vue
 = 
	`org_vue
(&
ba_rg
);

1052 
i
 = 0; i < 
	`org_cy
(&
ba_rg
); i++) {

1053 
	`_
(
pTe
, 
vue
[
i
] == 0);

1056 
us
 =

1057 
	`org_
(&
ba_rg
, 
NULL
,

1058 
	`org_cy
(&
ba_rg
) + 1);

1059 
	`_
(
pTe
, 
us
 =
l
);

1060 
us
 =

1061 
	`org_
(&
ba_rg
, 
NULL
,

1062 
	`org_cy
(&
ba_rg
));

1063 
	`_
(
pTe
, 
us
 =
ue
);

1064 
us
 =

1065 
	`org_un
(&
ba_rg
,

1066 
	`org_cy
(&
ba_rg
) + 1);

1067 
	`_
(
pTe
, 
us
 =
l
);

1068 
us
 =

1069 
	`org_un
(&
ba_rg
,

1070 
	`org_cy
(&
ba_rg
));

1071 
	`_
(
pTe
, 
us
 =
ue
);

1073 
_ngth
 = 
	`
((*
_vue
);

1074 
us
 = 
	`org_
(&
ba_rg
, &
_vue
[0], 
_ngth
);

1075 
	`_
(
pTe
, 
us
 =
ue
);

1076 
ngth
 = 
	`org_ngth
(&
ba_rg
);

1077 
vue
 = 
	`org_vue
(&
ba_rg
);

1078 
	`_
(
pTe
, 
ngth
 =
_ngth
);

1079 
i
 = 0; i < 
_ngth
; i++) {

1080 
	`_
(
pTe
, 
vue
[
i
] =
_vue
[i]);

1083 
_ngth
 = 
	`
((*
_nd_vue
);

1084 
us
 =

1085 
	`org_nd
(&
ba_rg
, &
_nd_vue
[0], 
_ngth
);

1086 
	`rt
((*
_nd_rg
, (*
_vue
);

1087 
	`rt
((*
_nd_rg
, (*
_nd_vue
);

1088 
_ngth
 = 
	`
((*
_nd_rg
);

1089 
	`_
(
pTe
, 
us
 =
ue
);

1090 
ngth
 = 
	`org_ngth
(&
ba_rg
);

1091 
vue
 = 
	`org_vue
(&
ba_rg
);

1092 
	`_
(
pTe
, 
ngth
 =
_ngth
);

1093 
i
 = 0; i < 
_ngth
; i++) {

1094 
	`_
(
pTe
, 
vue
[
i
] =
_nd_rg
[i]);

1096 
	}
}

1098 
	$BACtSgs
(

1099 
Te
 * 
pTe
)

1101 
bo
 
rc
;

1104 
rc
 = 
	`_addTeFuni
(
pTe
, 
BSg
);

1105 
	`as
(
rc
);

1106 
rc
 = 
	`_addTeFuni
(
pTe
, 
ChaSg
);

1107 
	`as
(
rc
);

1108 
rc
 = 
	`_addTeFuni
(
pTe
, 
OSg
);

1109 
	`as
(
rc
);

1110 
	}
}

1112 #ifde
TEST_BACSTR


1113 
	$ma
(

1116 
Te
 *
pTe
;

1118 
pTe
 = 
	`_
("BACÈSgs", 
NULL
);

1119 
	`BACtSgs
(
pTe
);

1121 
	`_tSm
(
pTe
, 
dout
);

1122 
	`_run
(
pTe
);

1123 (
	`_pt
(
pTe
);

1124 
	`_deroy
(
pTe
);

1127 
	}
}

	@src/bactext.c

35 
	~<dio.h
>

36 
	~"dxt.h
"

37 
	~"banum.h
"

38 
	~"baext.h
"

42 cڡ *
	gASHRAE_Rerved_Sg
 = "Reserved for Use by ASHRAE";

43 cڡ *
	gVd_Prrry_Sg
 = "Vendor Proprietary Value";

45 
INDTEXT_DATA
 
	gba_cfmed_rvi_mes
[] = {

46 {
SERVICE_CONFIRMED_ACKNOWLEDGE_ALARM
, "Acknowledge-Alarm"},

47 {
SERVICE_CONFIRMED_COV_NOTIFICATION
, "COV-Notification"},

48 {
SERVICE_CONFIRMED_EVENT_NOTIFICATION
, "Event-Notification"},

49 {
SERVICE_CONFIRMED_GET_ALARM_SUMMARY
, "Get-Alarm-Summary"},

50 {
SERVICE_CONFIRMED_GET_ENROLLMENT_SUMMARY
, "Get-Enrollment-Summary"},

51 {
SERVICE_CONFIRMED_SUBSCRIBE_COV
, "Subscribe-COV"},

52 {
SERVICE_CONFIRMED_ATOMIC_READ_FILE
, "Atomic-Read-File"},

53 {
SERVICE_CONFIRMED_ATOMIC_WRITE_FILE
, "Atomic-Write-File"},

54 {
SERVICE_CONFIRMED_ADD_LIST_ELEMENT
, "Add-List-Element"},

55 {
SERVICE_CONFIRMED_REMOVE_LIST_ELEMENT
, "Remove-List-Element"},

56 {
SERVICE_CONFIRMED_CREATE_OBJECT
, "Create-Object"},

57 {
SERVICE_CONFIRMED_DELETE_OBJECT
, "Delete-Object"},

58 {
SERVICE_CONFIRMED_READ_PROPERTY
, "Read-Property"},

59 {
SERVICE_CONFIRMED_READ_PROP_CONDITIONAL
,

61 {
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
, "Read-Property-Multiple"},

62 {
SERVICE_CONFIRMED_WRITE_PROPERTY
, "Write-Property"},

63 {
SERVICE_CONFIRMED_WRITE_PROP_MULTIPLE
, "Write-Property-Multiple"},

64 {
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
,

66 {
SERVICE_CONFIRMED_PRIVATE_TRANSFER
, "Private-Transfer"},

67 {
SERVICE_CONFIRMED_TEXT_MESSAGE
, "Text-Message"},

68 {
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
, "Reinitialize-Device"},

69 {
SERVICE_CONFIRMED_VT_OPEN
, "VT-Open"},

70 {
SERVICE_CONFIRMED_VT_CLOSE
, "VT-Close"},

71 {
SERVICE_CONFIRMED_VT_DATA
, "VT-Data"},

72 {
SERVICE_CONFIRMED_AUTHENTICATE
, "Authenticate"},

73 {
SERVICE_CONFIRMED_REQUEST_KEY
, "Request-Key"},

74 {
SERVICE_CONFIRMED_READ_RANGE
, "Read-Range"},

75 {
SERVICE_CONFIRMED_LIFE_SAFETY_OPERATION
, "Life-Safety_Operation"},

76 {
SERVICE_CONFIRMED_SUBSCRIBE_COV_PROPERTY
, "Subscribe-COV-Property"},

77 {
SERVICE_CONFIRMED_GET_EVENT_INFORMATION
, "Get-Event-Information"},

78 {0, 
NULL
}

81 cڡ *
	$baext_cfmed_rvi_me
(

82 
dex
)

84  
	`dxt_by_dex_deu
(
ba_cfmed_rvi_mes
, 
dex
,

85 
ASHRAE_Rerved_Sg
);

86 
	}
}

88 
INDTEXT_DATA
 
	gba_uncfmed_rvi_mes
[] = {

89 {
SERVICE_UNCONFIRMED_I_AM
, "I-Am"}

91 {
SERVICE_UNCONFIRMED_I_HAVE
, "I-Have"}

93 {
SERVICE_UNCONFIRMED_COV_NOTIFICATION
, "COV-Notification"}

95 {
SERVICE_UNCONFIRMED_EVENT_NOTIFICATION
, "Event-Notification"}

97 {
SERVICE_UNCONFIRMED_PRIVATE_TRANSFER
, "Private-Transfer"}

99 {
SERVICE_UNCONFIRMED_TEXT_MESSAGE
, "Text-Message"}

101 {
SERVICE_UNCONFIRMED_TIME_SYNCHRONIZATION
, "Time-Synchronization"}

103 {
SERVICE_UNCONFIRMED_WHO_HAS
, "Who-Has"}

105 {
SERVICE_UNCONFIRMED_WHO_IS
, "Who-Is"}

107 {
SERVICE_UNCONFIRMED_UTC_TIME_SYNCHRONIZATION
,

110 {
SERVICE_UNCONFIRMED_WRITE_GROUP
,

113 {0, 
NULL
}

116 cڡ *
	$baext_uncfmed_rvi_me
(

117 
dex
)

119  
	`dxt_by_dex_deu
(
ba_uncfmed_rvi_mes
, 
dex
,

120 
ASHRAE_Rerved_Sg
);

121 
	}
}

123 
INDTEXT_DATA
 
	gba_iti_g_mes
[] = {

124 {
BACNET_APPLICATION_TAG_NULL
, "Null"}

126 {
BACNET_APPLICATION_TAG_BOOLEAN
, "Boolean"}

128 {
BACNET_APPLICATION_TAG_UNSIGNED_INT
, "Unsigned Int"}

130 {
BACNET_APPLICATION_TAG_SIGNED_INT
, "Signed Int"}

132 {
BACNET_APPLICATION_TAG_REAL
, "Real"}

134 {
BACNET_APPLICATION_TAG_DOUBLE
, "Double"}

136 {
BACNET_APPLICATION_TAG_OCTET_STRING
, "Octet String"}

138 {
BACNET_APPLICATION_TAG_CHARACTER_STRING
, "Character String"}

140 {
BACNET_APPLICATION_TAG_BIT_STRING
, "Bit String"}

142 {
BACNET_APPLICATION_TAG_ENUMERATED
, "Enumerated"}

144 {
BACNET_APPLICATION_TAG_DATE
, "Date"}

146 {
BACNET_APPLICATION_TAG_TIME
, "Time"}

148 {
BACNET_APPLICATION_TAG_OBJECT_ID
, "Object ID"}

150 {
BACNET_APPLICATION_TAG_RESERVE1
, "Reserved 1"}

152 {
BACNET_APPLICATION_TAG_RESERVE2
, "Reserved 2"}

154 {
BACNET_APPLICATION_TAG_RESERVE3
, "Reserved 3"}

156 {0, 
NULL
}

159 cڡ *
	$baext_iti_g_me
(

160 
dex
)

162  
	`dxt_by_dex_deu
(
ba_iti_g_mes
, 
dex
,

163 
ASHRAE_Rerved_Sg
);

164 
	}
}

166 
bo
 
	$baext_iti_g_dex
(

167 cڡ *
ch_me
,

168 *
found_dex
)

170  
	`dxt_by_irg
(
ba_iti_g_mes
, 
ch_me
,

171 
found_dex
);

172 
	}
}

174 
INDTEXT_DATA
 
	gba_obje_ty_mes
[] = {

175 {
OBJECT_ANALOG_INPUT
, "analog-input"}

177 {
OBJECT_ANALOG_OUTPUT
, "analog-output"}

179 {
OBJECT_ANALOG_VALUE
, "analog-value"}

181 {
OBJECT_BINARY_INPUT
, "binary-input"}

183 {
OBJECT_BINARY_OUTPUT
, "binary-output"}

185 {
OBJECT_BINARY_VALUE
, "binary-value"}

187 {
OBJECT_CALENDAR
, "calendar"}

189 {
OBJECT_COMMAND
, "command"}

191 {
OBJECT_DEVICE
, "device"}

193 {
OBJECT_EVENT_ENROLLMENT
, "event-enrollment"}

195 {
OBJECT_FILE
, "file"}

197 {
OBJECT_GROUP
, "group"}

199 {
OBJECT_LOOP
, "loop"}

201 {
OBJECT_MULTI_STATE_INPUT
, "multi-state-input"}

203 {
OBJECT_MULTI_STATE_OUTPUT
, "multi-state-output"}

205 {
OBJECT_NOTIFICATION_CLASS
, "notification-class"}

207 {
OBJECT_PROGRAM
, "program"}

209 {
OBJECT_SCHEDULE
, "schedule"}

211 {
OBJECT_AVERAGING
, "averaging"}

213 {
OBJECT_MULTI_STATE_VALUE
, "multi-state-value"}

215 {
OBJECT_TRENDLOG
, "trend-log"}

217 {
OBJECT_LIFE_SAFETY_POINT
, "life-safety-point"}

219 {
OBJECT_LIFE_SAFETY_ZONE
, "life-safety-zone"}

221 {
OBJECT_ACCUMULATOR
, "accumulator"}

223 {
OBJECT_PULSE_CONVERTER
, "pulse-converter"}

225 {
OBJECT_EVENT_LOG
, "event-log"}

227 {
OBJECT_GLOBAL_GROUP
, "global-group"}

229 {
OBJECT_TREND_LOG_MULTIPLE
, "trend-log-multiple"}

231 {
OBJECT_LOAD_CONTROL
, "load-control"}

233 {
OBJECT_STRUCTURED_VIEW
, "structured-view"}

235 {
OBJECT_ACCESS_DOOR
, "access-door"}

237 {
OBJECT_LIGHTING_OUTPUT
, "lighting-output"}

239 {
OBJECT_ACCESS_CREDENTIAL
, "access-credential"}

241 {
OBJECT_ACCESS_POINT
, "access-point"}

243 {
OBJECT_ACCESS_RIGHTS
, "access-rights"}

245 {
OBJECT_ACCESS_USER
, "access-user"}

247 {
OBJECT_ACCESS_ZONE
, "access-zone"}

249 {
OBJECT_CREDENTIAL_DATA_INPUT
, "credential-data-input"}

251 {
OBJECT_NETWORK_SECURITY
, "network-security"}

253 {
OBJECT_BITSTRING_VALUE
, "bitstring-value"}

255 {
OBJECT_CHARACTERSTRING_VALUE
, "characterstring-value"}

257 {
OBJECT_DATE_PATTERN_VALUE
, "date-pattern-value"}

259 {
OBJECT_DATE_VALUE
, "date-value"}

261 {
OBJECT_DATETIME_PATTERN_VALUE
, "datetime-pattern-value"}

263 {
OBJECT_DATETIME_VALUE
, "datetime-value"}

265 {
OBJECT_INTEGER_VALUE
, "integer-value"}

267 {
OBJECT_LARGE_ANALOG_VALUE
, "large-analog-value"}

269 {
OBJECT_OCTETSTRING_VALUE
, "octetstring-value"}

271 {
OBJECT_POSITIVE_INTEGER_VALUE
, "positive-integer-value"}

273 {
OBJECT_TIME_PATTERN_VALUE
, "time-pattern-value"}

275 {
OBJECT_TIME_VALUE
, "time-value"}

277 {
OBJECT_NOTIFICATION_FORWARDER
, "notification-forwarder"}

279 {
OBJECT_ALERT_ENROLLMENT
, "alert-enrollment"}

281 {
OBJECT_CHANNEL
, "channel"}

283 {
OBJECT_LIGHTING_OUTPUT
, "lighting-output"}

285 {0, 
NULL
}

291 cڡ *
	$baext_obje_ty_me
(

292 
dex
)

294  
	`dxt_by_dex_l_deu
(
ba_obje_ty_mes
, 
dex
, 128,

295 
ASHRAE_Rerved_Sg
, 
Vd_Prrry_Sg
);

296 
	}
}

298 
bo
 
	$baext_obje_ty_dex
(

299 cڡ *
ch_me
,

300 *
found_dex
)

302  
	`dxt_by_irg
(
ba_obje_ty_mes
, 
ch_me
,

303 
found_dex
);

304 
	}
}

306 
INDTEXT_DATA
 
	gba_ݔty_mes
[] = {

308 {
PROP_ACKED_TRANSITIONS
, "acked-transitions"}

310 {
PROP_ACK_REQUIRED
, "ack-required"}

312 {
PROP_ACTION
, "action"}

314 {
PROP_ACTION_TEXT
, "action-text"}

316 {
PROP_ACTIVE_TEXT
, "active-text"}

318 {
PROP_ACTIVE_VT_SESSIONS
, "active-vt-sessions"}

320 {
PROP_ALARM_VALUE
, "alarm-value"}

322 {
PROP_ALARM_VALUES
, "alarm-values"}

324 {
PROP_ALL
, "all"}

326 {
PROP_ALL_WRITES_SUCCESSFUL
, "all-writes-successful"}

328 {
PROP_APDU_SEGMENT_TIMEOUT
, "apdu-segment-timeout"}

330 {
PROP_APDU_TIMEOUT
, "apdu-timeout"}

332 {
PROP_APPLICATION_SOFTWARE_VERSION
, "application-software-version"}

334 {
PROP_ARCHIVE
, "archive"}

336 {
PROP_BIAS
, "bias"}

338 {
PROP_CHANGE_OF_STATE_COUNT
, "change-of-state-count"}

340 {
PROP_CHANGE_OF_STATE_TIME
, "change-of-state-time"}

342 {
PROP_NOTIFICATION_CLASS
, "notification-class"}

344 {
PROP_BLANK_1
, "(deleted in 135-2001)"}

346 {
PROP_CONTROLLED_VARIABLE_REFERENCE
, "controlled-variable-reference"}

348 {
PROP_CONTROLLED_VARIABLE_UNITS
, "controlled-variable-units"}

350 {
PROP_CONTROLLED_VARIABLE_VALUE
, "controlled-variable-value"}

352 {
PROP_COV_INCREMENT
, "COV-increment"}

354 {
PROP_DATE_LIST
, "datelist"}

356 {
PROP_DAYLIGHT_SAVINGS_STATUS
, "daylight-savings-status"}

358 {
PROP_DEADBAND
, "deadband"}

360 {
PROP_DERIVATIVE_CONSTANT
, "derivative-constant"}

362 {
PROP_DERIVATIVE_CONSTANT_UNITS
, "derivative-constant-units"}

364 {
PROP_DESCRIPTION
, "description"}

366 {
PROP_DESCRIPTION_OF_HALT
, "description-of-halt"}

368 {
PROP_DEVICE_ADDRESS_BINDING
, "device-address-binding"}

370 {
PROP_DEVICE_TYPE
, "device-type"}

372 {
PROP_EFFECTIVE_PERIOD
, "effective-period"}

374 {
PROP_ELAPSED_ACTIVE_TIME
, "elapsed-active-time"}

376 {
PROP_ERROR_LIMIT
, "error-limit"}

378 {
PROP_EVENT_ENABLE
, "event-enable"}

380 {
PROP_EVENT_STATE
, "event-state"}

382 {
PROP_EVENT_TYPE
, "event-type"}

384 {
PROP_EXCEPTION_SCHEDULE
, "exception-schedule"}

386 {
PROP_FAULT_VALUES
, "fault-values"}

388 {
PROP_FEEDBACK_VALUE
, "feedback-value"}

390 {
PROP_FILE_ACCESS_METHOD
, "file-access-method"}

392 {
PROP_FILE_SIZE
, "file-size"}

394 {
PROP_FILE_TYPE
, "file-type"}

396 {
PROP_FIRMWARE_REVISION
, "firmware-revision"}

398 {
PROP_HIGH_LIMIT
, "high-limit"}

400 {
PROP_INACTIVE_TEXT
, "inactive-text"}

402 {
PROP_IN_PROCESS
, "in-process"}

404 {
PROP_INSTANCE_OF
, "instance-of"}

406 {
PROP_INTEGRAL_CONSTANT
, "integral-constant"}

408 {
PROP_INTEGRAL_CONSTANT_UNITS
, "integral-constant-units"}

410 {
PROP_ISSUE_CONFIRMED_NOTIFICATIONS
, "issue-confirmednotifications"}

412 {
PROP_LIMIT_ENABLE
, "limit-enable"}

414 {
PROP_LIST_OF_GROUP_MEMBERS
, "list-of-group-members"}

416 {
PROP_LIST_OF_OBJECT_PROPERTY_REFERENCES
,

419 {
PROP_LIST_OF_SESSION_KEYS
, "list-of-session-keys"}

421 {
PROP_LOCAL_DATE
, "local-date"}

423 {
PROP_LOCAL_TIME
, "local-time"}

425 {
PROP_LOCATION
, "location"}

427 {
PROP_LOW_LIMIT
, "low-limit"}

429 {
PROP_MANIPULATED_VARIABLE_REFERENCE
, "manipulated-variable-reference"}

431 {
PROP_MAXIMUM_OUTPUT
, "maximum-output"}

433 {
PROP_MAX_APDU_LENGTH_ACCEPTED
, "max-apdu-length-accepted"}

435 {
PROP_MAX_INFO_FRAMES
, "max-info-frames"}

437 {
PROP_MAX_MASTER
, "max-master"}

439 {
PROP_MAX_PRES_VALUE
, "max-pres-value"}

441 {
PROP_MINIMUM_OFF_TIME
, "minimum-off-time"}

443 {
PROP_MINIMUM_ON_TIME
, "minimum-on-time"}

445 {
PROP_MINIMUM_OUTPUT
, "minimum-output"}

447 {
PROP_MIN_PRES_VALUE
, "min-pres-value"}

449 {
PROP_MODEL_NAME
, "model-name"}

451 {
PROP_MODIFICATION_DATE
, "modification-date"}

453 {
PROP_NOTIFY_TYPE
, "notify-type"}

455 {
PROP_NUMBER_OF_APDU_RETRIES
, "number-of-APDU-retries"}

457 {
PROP_NUMBER_OF_STATES
, "number-of-states"}

459 {
PROP_OBJECT_IDENTIFIER
, "object-identifier"}

461 {
PROP_OBJECT_LIST
, "object-list"}

463 {
PROP_OBJECT_NAME
, "object-name"}

465 {
PROP_OBJECT_PROPERTY_REFERENCE
, "object-property-reference"}

467 {
PROP_OBJECT_TYPE
, "object-type"}

469 {
PROP_OPTIONAL
, "optional"}

471 {
PROP_OUT_OF_SERVICE
, "out-of-service"}

473 {
PROP_OUTPUT_UNITS
, "output-units"}

475 {
PROP_EVENT_PARAMETERS
, "event-parameters"}

477 {
PROP_POLARITY
, "polarity"}

479 {
PROP_PRESENT_VALUE
, "present-value"}

481 {
PROP_PRIORITY
, "priority"}

483 {
PROP_PRIORITY_ARRAY
, "priority-array"}

485 {
PROP_PRIORITY_FOR_WRITING
, "priority-for-writing"}

487 {
PROP_PROCESS_IDENTIFIER
, "process-identifier"}

489 {
PROP_PROGRAM_CHANGE
, "program-change"}

491 {
PROP_PROGRAM_LOCATION
, "program-location"}

493 {
PROP_PROGRAM_STATE
, "program-state"}

495 {
PROP_PROPORTIONAL_CONSTANT
, "proportional-constant"}

497 {
PROP_PROPORTIONAL_CONSTANT_UNITS
, "proportional-constant-units"}

499 {
PROP_PROTOCOL_CONFORMANCE_CLASS
, "protocol-conformance-class"}

501 {
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

504 {
PROP_PROTOCOL_SERVICES_SUPPORTED
, "protocol-services-supported"}

506 {
PROP_PROTOCOL_VERSION
, "protocol-version"}

508 {
PROP_READ_ONLY
, "read-only"}

510 {
PROP_REASON_FOR_HALT
, "reason-for-halt"}

512 {
PROP_RECIPIENT
, "recipient"}

514 {
PROP_RECIPIENT_LIST
, "recipient-list"}

516 {
PROP_RELIABILITY
, "reliability"}

518 {
PROP_RELINQUISH_DEFAULT
, "relinquish-default"}

520 {
PROP_REQUIRED
, "required"}

522 {
PROP_RESOLUTION
, "resolution"}

524 {
PROP_SEGMENTATION_SUPPORTED
, "segmentation-supported"}

526 {
PROP_SETPOINT
, "setpoint"}

528 {
PROP_SETPOINT_REFERENCE
, "setpoint-reference"}

530 {
PROP_STATE_TEXT
, "state-text"}

532 {
PROP_STATUS_FLAGS
, "status-flags"}

534 {
PROP_SYSTEM_STATUS
, "system-status"}

536 {
PROP_TIME_DELAY
, "time-delay"}

538 {
PROP_TIME_OF_ACTIVE_TIME_RESET
, "time-of-active-time-reset"}

540 {
PROP_TIME_OF_STATE_COUNT_RESET
, "time-of-state-count-reset"}

542 {
PROP_TIME_SYNCHRONIZATION_RECIPIENTS
,

545 {
PROP_UNITS
, "units"}

547 {
PROP_UPDATE_INTERVAL
, "update-interval"}

549 {
PROP_UTC_OFFSET
, "utc-offset"}

551 {
PROP_VENDOR_IDENTIFIER
, "vendor-identifier"}

553 {
PROP_VENDOR_NAME
, "vendor-name"}

555 {
PROP_VT_CLASSES_SUPPORTED
, "vt-classes-supported"}

557 {
PROP_WEEKLY_SCHEDULE
, "weekly-schedule"}

559 {
PROP_ATTEMPTED_SAMPLES
, "attempted-samples"}

561 {
PROP_AVERAGE_VALUE
, "average-value"}

563 {
PROP_BUFFER_SIZE
, "buffer-size"}

565 {
PROP_CLIENT_COV_INCREMENT
, "client-cov-increment"}

567 {
PROP_COV_RESUBSCRIPTION_INTERVAL
, "cov-resubscription-interval"}

569 {
PROP_CURRENT_NOTIFY_TIME
, "current-notify-time"}

571 {
PROP_EVENT_TIME_STAMPS
, "event-time-stamps"}

573 {
PROP_LOG_BUFFER
, "log-buffer"}

575 {
PROP_LOG_DEVICE_OBJECT_PROPERTY
, "log-device-object-property"}

577 {
PROP_ENABLE
, "enable"}

579 {
PROP_LOG_INTERVAL
, "log-interval"}

581 {
PROP_MAXIMUM_VALUE
, "maximum-value"}

583 {
PROP_MINIMUM_VALUE
, "minimum-value"}

585 {
PROP_NOTIFICATION_THRESHOLD
, "notification-threshold"}

587 {
PROP_PREVIOUS_NOTIFY_TIME
, "previous-notify-time"}

589 {
PROP_PROTOCOL_REVISION
, "protocol-revision"}

591 {
PROP_RECORDS_SINCE_NOTIFICATION
, "records-since-notification"}

593 {
PROP_RECORD_COUNT
, "record-count"}

595 {
PROP_START_TIME
, "start-time"}

597 {
PROP_STOP_TIME
, "stop-time"}

599 {
PROP_STOP_WHEN_FULL
, "stop-when-full"}

601 {
PROP_TOTAL_RECORD_COUNT
, "total-record-count"}

603 {
PROP_VALID_SAMPLES
, "valid-samples"}

605 {
PROP_WINDOW_INTERVAL
, "window-interval"}

607 {
PROP_WINDOW_SAMPLES
, "window-samples"}

609 {
PROP_MAXIMUM_VALUE_TIMESTAMP
, "maximum-value-timestamp"}

611 {
PROP_MINIMUM_VALUE_TIMESTAMP
, "minimum-value-timestamp"}

613 {
PROP_VARIANCE_VALUE
, "variance-value"}

615 {
PROP_ACTIVE_COV_SUBSCRIPTIONS
, "active-cov-subscriptions"}

617 {
PROP_BACKUP_FAILURE_TIMEOUT
, "backup-failure-timeout"}

619 {
PROP_CONFIGURATION_FILES
, "configuration-files"}

621 {
PROP_DATABASE_REVISION
, "database-revision"}

623 {
PROP_DIRECT_READING
, "direct-reading"}

625 {
PROP_LAST_RESTORE_TIME
, "last-restore-time"}

627 {
PROP_MAINTENANCE_REQUIRED
, "maintenance-required"}

629 {
PROP_MEMBER_OF
, "member-of"}

631 {
PROP_MODE
, "mode"}

633 {
PROP_OPERATION_EXPECTED
, "operation-expected"}

635 {
PROP_SETTING
, "setting"}

637 {
PROP_SILENCED
, "silenced"}

639 {
PROP_TRACKING_VALUE
, "tracking-value"}

641 {
PROP_ZONE_MEMBERS
, "zone-members"}

643 {
PROP_LIFE_SAFETY_ALARM_VALUES
, "life-safety-alarm-values"}

645 {
PROP_MAX_SEGMENTS_ACCEPTED
, "max-segments-accepted"}

647 {
PROP_PROFILE_NAME
, "profile-name"}

649 {
PROP_AUTO_SLAVE_DISCOVERY
, "auto-slave-discovery"}

651 {
PROP_MANUAL_SLAVE_ADDRESS_BINDING
, "manual-slave-address-binding"}

653 {
PROP_SLAVE_ADDRESS_BINDING
, "slave-address-binding"}

655 {
PROP_SLAVE_PROXY_ENABLE
, "slave-proxy-enable"}

657 {
PROP_LAST_NOTIFY_RECORD
, "last-notify-record"}

659 {
PROP_SCHEDULE_DEFAULT
, "schedule-default"}

661 {
PROP_ACCEPTED_MODES
, "accepted-modes"}

663 {
PROP_ADJUST_VALUE
, "adjust-value"}

665 {
PROP_COUNT
, "count"}

667 {
PROP_COUNT_BEFORE_CHANGE
, "count-before-change"}

669 {
PROP_COUNT_CHANGE_TIME
, "count-change-time"}

671 {
PROP_COV_PERIOD
, "COV-period"}

673 {
PROP_INPUT_REFERENCE
, "input-reference"}

675 {
PROP_LIMIT_MONITORING_INTERVAL
, "limit-monitoring-interval"}

677 {
PROP_LOGGING_OBJECT
, "logging-object"}

679 {
PROP_LOGGING_RECORD
, "logging-record"}

681 {
PROP_PRESCALE
, "prescale"}

683 {
PROP_PULSE_RATE
, "pulse-rate"}

685 {
PROP_SCALE
, "scale"}

687 {
PROP_SCALE_FACTOR
, "scale-factor"}

689 {
PROP_UPDATE_TIME
, "update-time"}

691 {
PROP_VALUE_BEFORE_CHANGE
, "value-before-change"}

693 {
PROP_VALUE_SET
, "value-set"}

695 {
PROP_VALUE_CHANGE_TIME
, "value-change-time"}

697 {
PROP_ALIGN_INTERVALS
, "align-intervals"}

699 {
PROP_INTERVAL_OFFSET
, "interval-offset"}

701 {
PROP_LAST_RESTART_REASON
, "last-restart-reason"}

703 {
PROP_LOGGING_TYPE
, "logging-type"}

705 {
PROP_TIME_OF_DEVICE_RESTART
, "time-of-device-restart"}

707 {
PROP_TIME_SYNCHRONIZATION_INTERVAL
, "time-synchronization-interval"}

709 {
PROP_TRIGGER
, "trigger"}

711 {
PROP_UTC_TIME_SYNCHRONIZATION_RECIPIENTS
,

714 {
PROP_NODE_SUBTYPE
, "node-subtype"}

716 {
PROP_NODE_TYPE
, "node-type"}

718 {
PROP_STRUCTURED_OBJECT_LIST
, "structured-object-list"}

720 {
PROP_SUBORDINATE_ANNOTATIONS
, "subordinate-annotations"}

722 {
PROP_SUBORDINATE_LIST
, "subordinate-list"}

724 {
PROP_ACTUAL_SHED_LEVEL
, "actual-shed-level"}

726 {
PROP_DUTY_WINDOW
, "duty-window"}

728 {
PROP_EXPECTED_SHED_LEVEL
, "expected-shed-level"}

730 {
PROP_FULL_DUTY_BASELINE
, "full-duty-baseline"}

732 {
PROP_REQUESTED_SHED_LEVEL
, "requested-shed-level"}

734 {
PROP_SHED_DURATION
, "shed-duration"}

736 {
PROP_SHED_LEVEL_DESCRIPTIONS
, "shed-level-descriptions"}

738 {
PROP_SHED_LEVELS
, "shed-levels"}

740 {
PROP_STATE_DESCRIPTION
, "state-description"}

742 {
PROP_DOOR_ALARM_STATE
, "door-alarm-state"}

744 {
PROP_DOOR_EXTENDED_PULSE_TIME
, "door-extended-pulse-time"}

746 {
PROP_DOOR_MEMBERS
, "door-members"}

748 {
PROP_DOOR_OPEN_TOO_LONG_TIME
, "door-open-too-long-time"}

750 {
PROP_DOOR_PULSE_TIME
, "door-pulse-time"}

752 {
PROP_DOOR_STATUS
, "door-status"}

754 {
PROP_DOOR_UNLOCK_DELAY_TIME
, "door-unlock-delay-time"}

756 {
PROP_LOCK_STATUS
, "lock-status"}

758 {
PROP_MASKED_ALARM_VALUES
, "masked-alarm-values"}

760 {
PROP_SECURED_STATUS
, "secured-status"}

762 {
PROP_ABSENTEE_LIMIT
, "absentee-limit"}

764 {
PROP_ACCESS_ALARM_EVENTS
, "access-alarm-events"}

766 {
PROP_ACCESS_DOORS
, "access-doors"}

768 {
PROP_ACCESS_EVENT
, "access-event"}

770 {
PROP_ACCESS_EVENT_AUTHENTICATION_FACTOR
,

773 {
PROP_ACCESS_EVENT_CREDENTIAL
, "access-event-credential"}

775 {
PROP_ACCESS_EVENT_TIME
, "access-event-time"}

777 {
PROP_ACCESS_TRANSACTION_EVENTS
, "access-transaction-events"}

779 {
PROP_ACCOMPANIMENT
, "accompaniment"}

781 {
PROP_ACCOMPANIMENT_TIME
, "accompaniment-time"}

783 {
PROP_ACTIVATION_TIME
, "activation-time"}

785 {
PROP_ACTIVE_AUTHENTICATION_POLICY
, "active-authentication-policy"}

787 {
PROP_ASSIGNED_ACCESS_RIGHTS
, "assigned-access-rights"}

789 {
PROP_AUTHENTICATION_FACTORS
, "authentication-factors"}

791 {
PROP_AUTHENTICATION_POLICY_LIST
, "authentication-policy-list"}

793 {
PROP_AUTHENTICATION_POLICY_NAMES
, "authentication-policy-names"}

795 {
PROP_AUTHENTICATION_STATUS
, "authentication-status"}

797 {
PROP_AUTHORIZATION_MODE
, "authorization-mode"}

799 {
PROP_BELONGS_TO
, "belongs-to"}

801 {
PROP_CREDENTIAL_DISABLE
, "credential-disable"}

803 {
PROP_CREDENTIAL_STATUS
, "credential-status"}

805 {
PROP_CREDENTIALS
, "credentials"}

807 {
PROP_CREDENTIALS_IN_ZONE
, "credentials-in-zone"}

809 {
PROP_DAYS_REMAINING
, "days-remaining"}

811 {
PROP_ENTRY_POINTS
, "entry-points"}

813 {
PROP_EXIT_POINTS
, "exit-points"}

815 {
PROP_EXPIRATION_TIME
, "expiration-time"}

817 {
PROP_EXTENDED_TIME_ENABLE
, "extended-time-enable"}

819 {
PROP_FAILED_ATTEMPT_EVENTS
, "failed-attempt-events"}

821 {
PROP_FAILED_ATTEMPTS
, "failed-attempts"}

823 {
PROP_FAILED_ATTEMPTS_TIME
, "failed-attempts-time"}

825 {
PROP_LAST_ACCESS_EVENT
, "last-access-event"}

827 {
PROP_LAST_ACCESS_POINT
, "last-access-point"}

829 {
PROP_LAST_CREDENTIAL_ADDED
, "last-credential-added"}

831 {
PROP_LAST_CREDENTIAL_ADDED_TIME
, "last-credential-added-time"}

833 {
PROP_LAST_CREDENTIAL_REMOVED
, "last-credential-removed"}

835 {
PROP_LAST_CREDENTIAL_REMOVED_TIME
, "last-credential-removed-time"}

837 {
PROP_LAST_USE_TIME
, "last-use-time"}

839 {
PROP_LOCKOUT
, "lockout"}

841 {
PROP_LOCKOUT_RELINQUISH_TIME
, "lockout-relinquish-time"}

843 {
PROP_MASTER_EXEMPTION
, "master-exemption"}

845 {
PROP_MAX_FAILED_ATTEMPTS
, "max-failed-attempts"}

847 {
PROP_MEMBERS
, "members"}

849 {
PROP_MUSTER_POINT
, "muster-point"}

851 {
PROP_NEGATIVE_ACCESS_RULES
, "negative-access-rules"}

853 {
PROP_NUMBER_OF_AUTHENTICATION_POLICIES
,

856 {
PROP_OCCUPANCY_COUNT
, "occupancy-count"}

858 {
PROP_OCCUPANCY_COUNT_ADJUST
, "occupancy-count-adjust"}

860 {
PROP_OCCUPANCY_COUNT_ENABLE
, "occupancy-count-enable"}

862 {
PROP_OCCUPANCY_EXEMPTION
, "occupancy-exemption"}

864 {
PROP_OCCUPANCY_LOWER_LIMIT
, "occupancy-lower-limit"}

866 {
PROP_OCCUPANCY_LOWER_LIMIT_ENFORCED
,

869 {
PROP_OCCUPANCY_STATE
, "occupancy-state"}

871 {
PROP_OCCUPANCY_UPPER_LIMIT
, "occupancy-upper-limit"}

873 {
PROP_OCCUPANCY_UPPER_LIMIT_ENFORCED
, "occupancy-upper-limit-enforced"}

875 {
PROP_PASSBACK_EXEMPTION
, "passback-exemption"}

877 {
PROP_PASSBACK_MODE
, "passback-mode"}

879 {
PROP_PASSBACK_TIMEOUT
, "passback-timeout"}

881 {
PROP_POSITIVE_ACCESS_RULES
, "positive-access-rules"}

883 {
PROP_REASON_FOR_DISABLE
, "reason-for-disable"}

885 {
PROP_SUPPORTED_FORMATS
, "supported-formats"}

887 {
PROP_SUPPORTED_FORMAT_CLASSES
, "supported-format-classes"}

889 {
PROP_THREAT_AUTHORITY
, "threat-authority"}

891 {
PROP_THREAT_LEVEL
, "threat-level"}

893 {
PROP_TRACE_FLAG
, "trace-flag"}

895 {
PROP_TRANSACTION_NOTIFICATION_CLASS
, "transaction-notification-class"}

897 {
PROP_USER_EXTERNAL_IDENTIFIER
, "user-external-identifier"}

899 {
PROP_USER_INFORMATION_REFERENCE
, "user-information-reference"}

901 {
PROP_USER_INFORMATION_REFERENCE
, "user-information-reference"}

903 {
PROP_USER_NAME
, "user-name"}

905 {
PROP_USER_TYPE
, "user-type"}

907 {
PROP_USES_REMAINING
, "uses-remaining"}

909 {
PROP_ZONE_FROM
, "zone-from"}

911 {
PROP_ZONE_TO
, "zone-to"}

913 {
PROP_VERIFICATION_TIME
, "verification-time"}

915 {
PROP_BASE_DEVICE_SECURITY_POLICY
, "base-device-security-policy"}

917 {
PROP_DISTRIBUTION_KEY_REVISION
, "distribution-key-revision"}

919 {
PROP_DO_NOT_HIDE
, "do-not-hide"}

921 {
PROP_KEY_SETS
, "key-sets"}

923 {
PROP_LAST_KEY_SERVER
, "last-key-server"}

925 {
PROP_NETWORK_ACCESS_SECURITY_POLICIES
,

928 {
PROP_PACKET_REORDER_TIME
, "packet-reorder-time"}

930 {
PROP_SECURITY_PDU_TIMEOUT
, "security-pdu-timeout"}

932 {
PROP_SECURITY_TIME_WINDOW
, "security-time-window"}

934 {
PROP_SUPPORTED_SECURITY_ALGORITHM
, "supported-security-algorithm"}

936 {
PROP_UPDATE_KEY_SET_TIMEOUT
, "update-key-set-timeout"}

938 {
PROP_BACKUP_AND_RESTORE_STATE
, "backup-and-restore-state"}

940 {
PROP_BACKUP_PREPARATION_TIME
, "backup-preparation-time"}

942 {
PROP_RESTORE_COMPLETION_TIME
, "restore-completion-time"}

944 {
PROP_RESTORE_PREPARATION_TIME
, "restore-preparation-time"}

946 {
PROP_BIT_MASK
, "bit-mask"}

948 {
PROP_BIT_TEXT
, "bit-text"}

950 {
PROP_IS_UTC
, "is-utc"}

952 {
PROP_GROUP_MEMBERS
, "group-members"}

954 {
PROP_GROUP_MEMBER_NAMES
, "group-member-names"}

956 {
PROP_MEMBER_STATUS_FLAGS
, "member-status-flags"}

958 {
PROP_REQUESTED_UPDATE_INTERVAL
, "requested-update-interval"}

960 {
PROP_COVU_PERIOD
, "covu-period"}

962 {
PROP_COVU_RECIPIENTS
, "covu-recipients"}

964 {
PROP_EVENT_MESSAGE_TEXTS
, "event-message-texts"}

966 {
PROP_EVENT_MESSAGE_TEXTS_CONFIG
, "event-message-texts-config"}

968 {
PROP_EVENT_DETECTION_ENABLE
, "event-detection-enable"}

970 {
PROP_EVENT_ALGORITHM_INHIBIT
, "event-algorithm-inhibit"}

972 {
PROP_EVENT_ALGORITHM_INHIBIT_REF
, "event-algorithm-inhibit-ref"}

974 {
PROP_TIME_DELAY_NORMAL
, "time-delay-normal"}

976 {
PROP_RELIABILITY_EVALUATION_INHIBIT
, "reliability-evaluation-inhibit"}

978 {
PROP_FAULT_PARAMETERS
, "fault-parameters"}

980 {
PROP_FAULT_TYPE
, "fault-type"}

982 {
PROP_LOCAL_FORWARDING_ONLY
, "local-forwarding-only"}

984 {
PROP_PROCESS_IDENTIFIER_FILTER
, "process-identifier-filter"}

986 {
PROP_SUBSCRIBED_RECIPIENTS
, "subscribed-recipients"}

988 {
PROP_PORT_FILTER
, "port-filter"}

990 {
PROP_AUTHORIZATION_EXEMPTIONS
, "authorization-exemptions"}

992 {
PROP_ALLOW_GROUP_DELAY_INHIBIT
, "allow-group-delay-inhibit"}

994 {
PROP_CHANNEL_NUMBER
, "channel-number"}

996 {
PROP_CONTROL_GROUPS
, "control-groups"}

998 {
PROP_EXECUTION_DELAY
, "execution-delay"}

1000 {
PROP_LAST_PRIORITY
, "last-priority"}

1002 {
PROP_WRITE_STATUS
, "write-status"}

1004 {
PROP_PROPERTY_LIST
, "property-list"}

1006 {
PROP_SERIAL_NUMBER
, "serial-number"}

1008 {
PROP_BLINK_WARN_ENABLE
, "blink-warn-enable"}

1010 {
PROP_DEFAULT_FADE_TIME
, "default-fade-time"}

1012 {
PROP_DEFAULT_RAMP_RATE
, "default-ramp-rate"}

1014 {
PROP_DEFAULT_STEP_INCREMENT
, "default-step-increment"}

1016 {
PROP_EGRESS_TIME
, "egress-time"}

1018 {
PROP_IN_PROGRESS
, "in-progress"}

1020 {
PROP_INSTANTANEOUS_POWER
, "instantaneous-power"}

1022 {
PROP_LIGHTING_COMMAND
, "lighting-command"}

1024 {
PROP_LIGHTING_COMMAND_DEFAULT_PRIORITY
,

1027 {
PROP_MAX_ACTUAL_VALUE
, "max-actual-value"}

1029 {
PROP_MIN_ACTUAL_VALUE
, "min-actual-value"}

1031 {
PROP_POWER
, "power"}

1033 {
PROP_TRANSITION
, "transition"}

1035 {
PROP_EGRESS_ACTIVE
, "egress-active"}

1037 {0, 
NULL
}

1043 cڡ *
	$baext_ݔty_me
(

1044 
dex
)

1046  
	`dxt_by_dex_l_deu
(
ba_ݔty_mes
, 
dex
, 512,

1047 
ASHRAE_Rerved_Sg
, 
Vd_Prrry_Sg
);

1048 
	}
}

1050 
	$baext_ݔty_id
(

1051 cڡ *
me
)

1053  
	`dxt_by_irg_deu
(
ba_ݔty_mes
, 
me
, 0);

1054 
	}
}

1056 
bo
 
	$baext_ݔty_dex
(

1057 cڡ *
ch_me
,

1058 *
found_dex
)

1060  
	`dxt_by_irg
(
ba_ݔty_mes
, 
ch_me
, 
found_dex
);

1061 
	}
}

1063 
INDTEXT_DATA
 
	gba_grg_un_mes
[] = {

1064 {
UNITS_SQUARE_METERS
, "square-meters"}

1066 {
UNITS_SQUARE_FEET
, "square-feet"}

1068 {
UNITS_MILLIAMPERES
, "milliamperes"}

1070 {
UNITS_AMPERES
, "amperes"}

1072 {
UNITS_OHMS
, "ohms"}

1074 {
UNITS_VOLTS
, "volts"}

1076 {
UNITS_KILOVOLTS
, "kilovolts"}

1078 {
UNITS_MEGAVOLTS
, "megavolts"}

1080 {
UNITS_VOLT_AMPERES
, "volt-amperes"}

1082 {
UNITS_KILOVOLT_AMPERES
, "kilovolt-amperes"}

1084 {
UNITS_MEGAVOLT_AMPERES
, "megavolt-amperes"}

1086 {
UNITS_VOLT_AMPERES_REACTIVE
, "volt-amperes-reactive"}

1088 {
UNITS_KILOVOLT_AMPERES_REACTIVE
, "kilovolt-amperes-reactive"}

1090 {
UNITS_MEGAVOLT_AMPERES_REACTIVE
, "megavolt-amperes-reactive"}

1092 {
UNITS_DEGREES_PHASE
, "degrees-phase"}

1094 {
UNITS_POWER_FACTOR
, "power-factor"}

1096 {
UNITS_JOULES
, "joules"}

1098 {
UNITS_KILOJOULES
, "kilojoules"}

1100 {
UNITS_WATT_HOURS
, "watt-hours"}

1102 {
UNITS_KILOWATT_HOURS
, "kilowatt-hours"}

1104 {
UNITS_BTUS
, "btus"}

1106 {
UNITS_THERMS
, "therms"}

1108 {
UNITS_TON_HOURS
, "ton-hours"}

1110 {
UNITS_JOULES_PER_KILOGRAM_DRY_AIR
, "joules-per-kilogram-dry-air"}

1112 {
UNITS_BTUS_PER_POUND_DRY_AIR
, "btus-per-pound-dry-air"}

1114 {
UNITS_CYCLES_PER_HOUR
, "cycles-per-hour"}

1116 {
UNITS_CYCLES_PER_MINUTE
, "cycles-per-minute"}

1118 {
UNITS_HERTZ
, "hertz"}

1120 {
UNITS_GRAMS_OF_WATER_PER_KILOGRAM_DRY_AIR
,

1123 {
UNITS_PERCENT_RELATIVE_HUMIDITY
, "percent-relative-humidity"}

1125 {
UNITS_MILLIMETERS
, "millimeters"}

1127 {
UNITS_METERS
, "meters"}

1129 {
UNITS_INCHES
, "inches"}

1131 {
UNITS_FEET
, "feet"}

1133 {
UNITS_WATTS_PER_SQUARE_FOOT
, "watts-per-square-foot"}

1135 {
UNITS_WATTS_PER_SQUARE_METER
, "watts-per-square-meter"}

1137 {
UNITS_LUMENS
, "lumens"}

1139 {
UNITS_LUXES
, "luxes"}

1141 {
UNITS_FOOT_CANDLES
, "foot-candles"}

1143 {
UNITS_KILOGRAMS
, "kilograms"}

1145 {
UNITS_POUNDS_MASS
, "pounds-mass"}

1147 {
UNITS_TONS
, "tons"}

1149 {
UNITS_KILOGRAMS_PER_SECOND
, "kilograms-per-second"}

1151 {
UNITS_KILOGRAMS_PER_MINUTE
, "kilograms-per-minute"}

1153 {
UNITS_KILOGRAMS_PER_HOUR
, "kilograms-per-hour"}

1155 {
UNITS_POUNDS_MASS_PER_MINUTE
, "pounds-mass-per-minute"}

1157 {
UNITS_POUNDS_MASS_PER_HOUR
, "pounds-mass-per-hour"}

1159 {
UNITS_WATTS
, "watts"}

1161 {
UNITS_KILOWATTS
, "kilowatts"}

1163 {
UNITS_MEGAWATTS
, "megawatts"}

1165 {
UNITS_BTUS_PER_HOUR
, "btus-per-hour"}

1167 {
UNITS_HORSEPOWER
, "horsepower"}

1169 {
UNITS_TONS_REFRIGERATION
, "tons-refrigeration"}

1171 {
UNITS_PASCALS
, "pascals"}

1173 {
UNITS_KILOPASCALS
, "kilopascals"}

1175 {
UNITS_BARS
, "bars"}

1177 {
UNITS_POUNDS_FORCE_PER_SQUARE_INCH
, "pounds-force-per-square-inch"}

1179 {
UNITS_CENTIMETERS_OF_WATER
, "centimeters-of-water"}

1181 {
UNITS_INCHES_OF_WATER
, "inches-of-water"}

1183 {
UNITS_MILLIMETERS_OF_MERCURY
, "millimeters-of-mercury"}

1185 {
UNITS_CENTIMETERS_OF_MERCURY
, "centimeters-of-mercury"}

1187 {
UNITS_INCHES_OF_MERCURY
, "inches-of-mercury"}

1189 {
UNITS_DEGREES_CELSIUS
, "degrees-celsius"}

1191 {
UNITS_DEGREES_KELVIN
, "degrees-kelvin"}

1193 {
UNITS_DEGREES_FAHRENHEIT
, "degrees-fahrenheit"}

1195 {
UNITS_DEGREE_DAYS_CELSIUS
, "degree-days-celsius"}

1197 {
UNITS_DEGREE_DAYS_FAHRENHEIT
, "degree-days-fahrenheit"}

1199 {
UNITS_YEARS
, "years"}

1201 {
UNITS_MONTHS
, "months"}

1203 {
UNITS_WEEKS
, "weeks"}

1205 {
UNITS_DAYS
, "days"}

1207 {
UNITS_HOURS
, "hours"}

1209 {
UNITS_MINUTES
, "minutes"}

1211 {
UNITS_SECONDS
, "seconds"}

1213 {
UNITS_METERS_PER_SECOND
, "meters-per-second"}

1215 {
UNITS_KILOMETERS_PER_HOUR
, "kilometers-per-hour"}

1217 {
UNITS_FEET_PER_SECOND
, "feet-per-second"}

1219 {
UNITS_FEET_PER_MINUTE
, "feet-per-minute"}

1221 {
UNITS_MILES_PER_HOUR
, "miles-per-hour"}

1223 {
UNITS_CUBIC_FEET
, "cubic-feet"}

1225 {
UNITS_CUBIC_METERS
, "cubic-meters"}

1227 {
UNITS_IMPERIAL_GALLONS
, "imperial-gallons"}

1229 {
UNITS_LITERS
, "liters"}

1231 {
UNITS_US_GALLONS
, "us-gallons"}

1233 {
UNITS_CUBIC_FEET_PER_MINUTE
, "cubic-feet-per-minute"}

1235 {
UNITS_CUBIC_METERS_PER_SECOND
, "cubic-meters-per-second"}

1237 {
UNITS_IMPERIAL_GALLONS_PER_MINUTE
, "imperial-gallons-per-minute"}

1239 {
UNITS_LITERS_PER_SECOND
, "liters-per-second"}

1241 {
UNITS_LITERS_PER_MINUTE
, "liters-per-minute"}

1243 {
UNITS_US_GALLONS_PER_MINUTE
, "us-gallons-per-minute"}

1245 {
UNITS_DEGREES_ANGULAR
, "degrees-angular"}

1247 {
UNITS_DEGREES_CELSIUS_PER_HOUR
, "degrees-celsius-per-hour"}

1249 {
UNITS_DEGREES_CELSIUS_PER_MINUTE
, "degrees-celsius-per-minute"}

1251 {
UNITS_DEGREES_FAHRENHEIT_PER_HOUR
, "degrees-fahrenheit-per-hour"}

1253 {
UNITS_DEGREES_FAHRENHEIT_PER_MINUTE
, "degrees-fahrenheit-per-minute"}

1255 {
UNITS_NO_UNITS
, "no-units"}

1257 {
UNITS_PARTS_PER_MILLION
, "parts-per-million"}

1259 {
UNITS_PARTS_PER_BILLION
, "parts-per-billion"}

1261 {
UNITS_PERCENT
, "percent"}

1263 {
UNITS_PERCENT_PER_SECOND
, "percent-per-second"}

1265 {
UNITS_PER_MINUTE
, "per-minute"}

1267 {
UNITS_PER_SECOND
, "per-second"}

1269 {
UNITS_PSI_PER_DEGREE_FAHRENHEIT
, "psi-per-degree-fahrenheit"}

1271 {
UNITS_RADIANS
, "radians"}

1273 {
UNITS_REVOLUTIONS_PER_MINUTE
, "revolutions-per-minute"}

1275 {
UNITS_CURRENCY1
, "currency1"}

1277 {
UNITS_CURRENCY2
, "currency2"}

1279 {
UNITS_CURRENCY3
, "currency3"}

1281 {
UNITS_CURRENCY4
, "currency4"}

1283 {
UNITS_CURRENCY5
, "currency5"}

1285 {
UNITS_CURRENCY6
, "currency6"}

1287 {
UNITS_CURRENCY7
, "currency7"}

1289 {
UNITS_CURRENCY8
, "currency8"}

1291 {
UNITS_CURRENCY9
, "currency9"}

1293 {
UNITS_CURRENCY10
, "currency10"}

1295 {
UNITS_SQUARE_INCHES
, "square-inches"}

1297 {
UNITS_SQUARE_CENTIMETERS
, "square-centimeters"}

1299 {
UNITS_BTUS_PER_POUND
, "btus_per-pound"}

1301 {
UNITS_CENTIMETERS
, "centimeters"}

1303 {
UNITS_POUNDS_MASS_PER_SECOND
, "pounds-mass-per-second"}

1305 {
UNITS_DELTA_DEGREES_FAHRENHEIT
, "delta-degrees-fahrenheit"}

1307 {
UNITS_DELTA_DEGREES_KELVIN
, "delta-degrees-kelvin"}

1309 {
UNITS_KILOHMS
, "kilohms"}

1311 {
UNITS_MEGOHMS
, "megohms"}

1313 {
UNITS_MILLIVOLTS
, "millivolts"}

1315 {
UNITS_KILOJOULES_PER_KILOGRAM
, "kilojoules-per-kilogram"}

1317 {
UNITS_MEGAJOULES
, "megajoules"}

1319 {
UNITS_JOULES_PER_DEGREE_KELVIN
, "joules-per-degree-kelvin"}

1321 {
UNITS_JOULES_PER_KILOGRAM_DEGREE_KELVIN
,

1324 {
UNITS_KILOHERTZ
, "kilohertz"}

1326 {
UNITS_MEGAHERTZ
, "megahertz"}

1328 {
UNITS_PER_HOUR
, "per-hour"}

1330 {
UNITS_MILLIWATTS
, "milliwatts"}

1332 {
UNITS_HECTOPASCALS
, "hectopascals"}

1334 {
UNITS_MILLIBARS
, "millibars"}

1336 {
UNITS_CUBIC_METERS_PER_HOUR
, "cubic-meters-per-hour"}

1338 {
UNITS_LITERS_PER_HOUR
, "liters-per-hour"}

1340 {
UNITS_KW_HOURS_PER_SQUARE_METER
,

1343 {
UNITS_KW_HOURS_PER_SQUARE_FOOT
, "kilowatt-hours-per-square-foot"}

1345 {
UNITS_MEGAJOULES_PER_SQUARE_METER
, "megajoules-per-square-meter"}

1347 {
UNITS_MEGAJOULES_PER_SQUARE_FOOT
, "megajoules-per-square-foot"}

1349 {
UNITS_CUBIC_FEET_PER_SECOND
, "cubic-feet-per-second"}

1351 {
UNITS_WATTS_PER_SQUARE_METER_DEGREE_KELVIN
,

1354 {
UNITS_PERCENT_OBSCURATION_PER_FOOT
, "percent-obscuration-per-foot"}

1356 {
UNITS_PERCENT_OBSCURATION_PER_METER
, "percent-obscuration-per-meter"}

1358 {
UNITS_MILLIOHMS
, "milliohms"}

1360 {
UNITS_MEGAWATT_HOURS
, "megawatt-hours"}

1362 {
UNITS_KILO_BTUS
, "kilo-btus"}

1364 {
UNITS_MEGA_BTUS
, "mega-btus"}

1366 {
UNITS_KILOJOULES_PER_KILOGRAM_DRY_AIR
,

1369 {
UNITS_MEGAJOULES_PER_KILOGRAM_DRY_AIR
,

1372 {
UNITS_KILOJOULES_PER_DEGREE_KELVIN
, "kilojoules-per-degree-Kelvin"}

1374 {
UNITS_MEGAJOULES_PER_DEGREE_KELVIN
, "megajoules-per-degree-Kelvin"}

1376 {
UNITS_NEWTON
, "newton"}

1378 {
UNITS_GRAMS_PER_SECOND
, "grams-per-second"}

1380 {
UNITS_GRAMS_PER_MINUTE
, "grams-per-minute"}

1382 {
UNITS_TONS_PER_HOUR
, "tons-per-hour"}

1384 {
UNITS_KILO_BTUS_PER_HOUR
, "kilo-btus-per-hour"}

1386 {
UNITS_HUNDREDTHS_SECONDS
, "hundredths-seconds"}

1388 {
UNITS_MILLISECONDS
, "milliseconds"}

1390 {
UNITS_NEWTON_METERS
, "newton-meters"}

1392 {
UNITS_MILLIMETERS_PER_SECOND
, "millimeters-per-second"}

1394 {
UNITS_MILLIMETERS_PER_MINUTE
, "millimeters-per-minute"}

1396 {
UNITS_METERS_PER_MINUTE
, "meters-per-minute"}

1398 {
UNITS_METERS_PER_HOUR
, "meters-per-hour"}

1400 {
UNITS_CUBIC_METERS_PER_MINUTE
, "cubic-meters-per-minute"}

1402 {
UNITS_METERS_PER_SECOND_PER_SECOND
, "meters-per-second-per-second"}

1404 {
UNITS_AMPERES_PER_METER
, "amperes-per-meter"}

1406 {
UNITS_AMPERES_PER_SQUARE_METER
, "amperes-per-square-meter"}

1408 {
UNITS_AMPERE_SQUARE_METERS
, "ampere-square-meters"}

1410 {
UNITS_FARADS
, "farads"}

1412 {
UNITS_HENRYS
, "henrys"}

1414 {
UNITS_OHM_METERS
, "ohm-meters"}

1416 {
UNITS_SIEMENS
, "siemens"}

1418 {
UNITS_SIEMENS_PER_METER
, "siemens-per-meter"}

1420 {
UNITS_TESLAS
, "teslas"}

1422 {
UNITS_VOLTS_PER_DEGREE_KELVIN
, "volts-per-degree-Kelvin"}

1424 {
UNITS_VOLTS_PER_METER
, "volts-per-meter"}

1426 {
UNITS_WEBERS
, "webers"}

1428 {
UNITS_CANDELAS
, "candelas"}

1430 {
UNITS_CANDELAS_PER_SQUARE_METER
, "candelas-per-square-meter"}

1432 {
UNITS_DEGREES_KELVIN_PER_HOUR
, "degrees-Kelvin-per-hour"}

1434 {
UNITS_DEGREES_KELVIN_PER_MINUTE
, "degrees-Kelvin-per-minute"}

1436 {
UNITS_JOULE_SECONDS
, "joule-seconds"}

1438 {
UNITS_RADIANS_PER_SECOND
, "radians-per-second"}

1440 {
UNITS_SQUARE_METERS_PER_NEWTON
, "square-meters-per-Newton"}

1442 {
UNITS_KILOGRAMS_PER_CUBIC_METER
, "kilograms-per-cubic-meter"}

1444 {
UNITS_NEWTON_SECONDS
, "newton-seconds"}

1446 {
UNITS_NEWTONS_PER_METER
, "newtons-per-meter"}

1448 {
UNITS_WATTS_PER_METER_PER_DEGREE_KELVIN
,

1451 {0, 
NULL
}

1457 cڡ *
	$baext_grg_un_me
(

1458 
dex
)

1460  
	`dxt_by_dex_l_deu
(
ba_grg_un_mes
, 
dex
,

1461 256, 
ASHRAE_Rerved_Sg
, 
Vd_Prrry_Sg
);

1462 
	}
}

1464 
bo
 
	$baext_grg_un_dex
(

1465 cڡ *
ch_me
,

1466 *
found_dex
)

1468  
	`dxt_by_irg
(
ba_grg_un_mes
, 
ch_me
,

1469 
found_dex
);

1470 
	}
}

1472 
INDTEXT_DATA
 
	gba_je_as_mes
[] = {

1473 {
REJECT_REASON_OTHER
, "Other"}

1475 {
REJECT_REASON_BUFFER_OVERFLOW
, "Buffer Overflow"}

1477 {
REJECT_REASON_INCONSISTENT_PARAMETERS
, "Inconsistent Parameters"}

1479 {
REJECT_REASON_INVALID_PARAMETER_DATA_TYPE
,

1482 {
REJECT_REASON_INVALID_TAG
, "Invalid Tag"}

1484 {
REJECT_REASON_MISSING_REQUIRED_PARAMETER
, "Missing Required Parameter"}

1486 {
REJECT_REASON_PARAMETER_OUT_OF_RANGE
, "Parameter Out of Range"}

1488 {
REJECT_REASON_TOO_MANY_ARGUMENTS
, "Too Many Arguments"}

1490 {
REJECT_REASON_UNDEFINED_ENUMERATION
, "Undefined Enumeration"}

1492 {
REJECT_REASON_UNRECOGNIZED_SERVICE
, "Unrecognized Service"}

1494 {0, 
NULL
}

1497 cڡ *
	$baext_je_as_me
(

1498 
dex
)

1500  
	`dxt_by_dex_l_deu
(
ba_je_as_mes
, 
dex
,

1501 
FIRST_PROPRIETARY_REJECT_REASON
, 
ASHRAE_Rerved_Sg
,

1502 
Vd_Prrry_Sg
);

1503 
	}
}

1505 
INDTEXT_DATA
 
	gba_abt_as_mes
[] = {

1506 {
ABORT_REASON_OTHER
, "Other"}

1508 {
ABORT_REASON_BUFFER_OVERFLOW
, "Buffer Overflow"}

1510 {
ABORT_REASON_INVALID_APDU_IN_THIS_STATE
, "Invalid APDU inhis State"}

1512 {
ABORT_REASON_PREEMPTED_BY_HIGHER_PRIORITY_TASK
,

1515 {
ABORT_REASON_SEGMENTATION_NOT_SUPPORTED
, "Segmentation Not Supported"}

1517 {0, 
NULL
}

1520 cڡ *
	$baext_abt_as_me
(

1521 
dex
)

1523  
	`dxt_by_dex_l_deu
(
ba_abt_as_mes
, 
dex
,

1524 
FIRST_PROPRIETARY_ABORT_REASON
, 
ASHRAE_Rerved_Sg
,

1525 
Vd_Prrry_Sg
);

1526 
	}
}

1528 
INDTEXT_DATA
 
	gba_r_ass_mes
[] = {

1529 {
ERROR_CLASS_DEVICE
, "device"}

1531 {
ERROR_CLASS_OBJECT
, "object"}

1533 {
ERROR_CLASS_PROPERTY
, "property"}

1535 {
ERROR_CLASS_RESOURCES
, "resources"}

1537 {
ERROR_CLASS_SECURITY
, "security"}

1539 {
ERROR_CLASS_SERVICES
, "services"}

1541 {
ERROR_CLASS_VT
, "vt"}

1543 {0, 
NULL
}

1546 cڡ *
	$baext_r_ass_me
(

1547 
dex
)

1549  
	`dxt_by_dex_l_deu
(
ba_r_ass_mes
, 
dex
,

1550 
FIRST_PROPRIETARY_ERROR_CLASS
, 
ASHRAE_Rerved_Sg
,

1551 
Vd_Prrry_Sg
);

1552 
	}
}

1554 
INDTEXT_DATA
 
	gba_r_code_mes
[] = {

1555 {
ERROR_CODE_OTHER
, "other"}

1557 {
ERROR_CODE_AUTHENTICATION_FAILED
, "authentication-failed"}

1559 {
ERROR_CODE_CHARACTER_SET_NOT_SUPPORTED
, "character-set-not-supported"}

1561 {
ERROR_CODE_CONFIGURATION_IN_PROGRESS
, "configuration-in-progress"}

1563 {
ERROR_CODE_DATATYPE_NOT_SUPPORTED
, "datatype-not-supported"}

1565 {
ERROR_CODE_DEVICE_BUSY
, "device-busy"}

1567 {
ERROR_CODE_DUPLICATE_NAME
, "duplicate-name"}

1569 {
ERROR_CODE_DUPLICATE_OBJECT_ID
, "duplicate-object-id"}

1571 {
ERROR_CODE_DYNAMIC_CREATION_NOT_SUPPORTED
,

1574 {
ERROR_CODE_FILE_ACCESS_DENIED
, "file-access-denied"}

1576 {
ERROR_CODE_INCOMPATIBLE_SECURITY_LEVELS
,

1579 {
ERROR_CODE_INCONSISTENT_PARAMETERS
, "inconsistent-parameters"}

1581 {
ERROR_CODE_INCONSISTENT_SELECTION_CRITERION
,

1584 {
ERROR_CODE_INVALID_ARRAY_INDEX
, "invalid-array-index"}

1586 {
ERROR_CODE_INVALID_CONFIGURATION_DATA
, "invalid-configuration-data"}

1588 {
ERROR_CODE_INVALID_DATA_TYPE
, "invalid-data-type"}

1590 {
ERROR_CODE_INVALID_FILE_ACCESS_METHOD
, "invalid-file-access-method"}

1592 {
ERROR_CODE_INVALID_FILE_START_POSITION
,

1595 {
ERROR_CODE_INVALID_OPERATOR_NAME
, "invalid-operator-name"}

1597 {
ERROR_CODE_INVALID_PARAMETER_DATA_TYPE
, "invalid-parameter-data-type"}

1599 {
ERROR_CODE_INVALID_TIME_STAMP
, "invalid-time-stamp"}

1601 {
ERROR_CODE_KEY_GENERATION_ERROR
, "key-generation-error"}

1603 {
ERROR_CODE_MISSING_REQUIRED_PARAMETER
, "missing-required-parameter"}

1605 {
ERROR_CODE_NO_OBJECTS_OF_SPECIFIED_TYPE
,

1608 {
ERROR_CODE_NO_SPACE_FOR_OBJECT
, "no-space-for-object"}

1610 {
ERROR_CODE_NO_SPACE_TO_ADD_LIST_ELEMENT
,

1613 {
ERROR_CODE_NO_SPACE_TO_WRITE_PROPERTY
, "no-space-to-write-property"}

1615 {
ERROR_CODE_NO_VT_SESSIONS_AVAILABLE
, "no-vt-sessions-available"}

1617 {
ERROR_CODE_OBJECT_DELETION_NOT_PERMITTED
,

1620 {
ERROR_CODE_OBJECT_IDENTIFIER_ALREADY_EXISTS
,

1623 {
ERROR_CODE_OPERATIONAL_PROBLEM
, "operational-problem"}

1625 {
ERROR_CODE_OPTIONAL_FUNCTIONALITY_NOT_SUPPORTED
,

1628 {
ERROR_CODE_PASSWORD_FAILURE
, "password-failure"}

1630 {
ERROR_CODE_PROPERTY_IS_NOT_A_LIST
, "property-is-not-a-list"}

1632 {
ERROR_CODE_PROPERTY_IS_NOT_AN_ARRAY
, "property-is-not-an-array"}

1634 {
ERROR_CODE_READ_ACCESS_DENIED
, "read-access-denied"}

1636 {
ERROR_CODE_SECURITY_NOT_SUPPORTED
, "security-not-supported"}

1638 {
ERROR_CODE_SERVICE_REQUEST_DENIED
, "service-request-denied"}

1640 {
ERROR_CODE_TIMEOUT
, "timeout"}

1642 {
ERROR_CODE_UNKNOWN_OBJECT
, "unknown-object"}

1644 {
ERROR_CODE_UNKNOWN_PROPERTY
, "unknown-property"}

1646 {
ERROR_CODE_RESERVED1
, "reserved1"}

1648 {
ERROR_CODE_UNKNOWN_VT_CLASS
, "unknown-vt-class"}

1650 {
ERROR_CODE_UNKNOWN_VT_SESSION
, "unknown-vt-session"}

1652 {
ERROR_CODE_UNSUPPORTED_OBJECT_TYPE
, "unsupported-object-type"}

1654 {
ERROR_CODE_VALUE_OUT_OF_RANGE
, "value-out-of-range"}

1656 {
ERROR_CODE_VT_SESSION_ALREADY_CLOSED
, "vt-session-already-closed"}

1658 {
ERROR_CODE_VT_SESSION_TERMINATION_FAILURE
,

1661 {
ERROR_CODE_WRITE_ACCESS_DENIED
, "write-access-denied"}

1663 {
ERROR_CODE_COV_SUBSCRIPTION_FAILED
, "cov-subscription-failed"}

1665 {
ERROR_CODE_NOT_COV_PROPERTY
, "not-cov-property"}

1667 {
ERROR_CODE_ABORT_BUFFER_OVERFLOW
, "abort-buffer-overflow"}

1669 {
ERROR_CODE_ABORT_INVALID_APDU_IN_THIS_STATE
,

1672 {
ERROR_CODE_ABORT_PREEMPTED_BY_HIGHER_PRIORITY_TASK
,

1675 {
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
,

1678 {
ERROR_CODE_ABORT_PROPRIETARY
, "abort-proprietary"}

1680 {
ERROR_CODE_ABORT_OTHER
, "abort-other"}

1682 {
ERROR_CODE_INVALID_TAG
, "invalid-tag"}

1684 {
ERROR_CODE_NETWORK_DOWN
, "network-down"}

1686 {
ERROR_CODE_REJECT_BUFFER_OVERFLOW
, "reject-buffer-overflow"}

1688 {
ERROR_CODE_REJECT_INCONSISTENT_PARAMETERS
,

1691 {
ERROR_CODE_REJECT_INVALID_PARAMETER_DATA_TYPE
,

1694 {
ERROR_CODE_REJECT_INVALID_TAG
, "reject-invalid-tag"}

1696 {
ERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
,

1699 {
ERROR_CODE_REJECT_PARAMETER_OUT_OF_RANGE
, "reject-parameter-out-of-range"}

1701 {
ERROR_CODE_REJECT_TOO_MANY_ARGUMENTS
, "reject-too-many-arguments"}

1703 {
ERROR_CODE_REJECT_UNDEFINED_ENUMERATION
, "reject-undefined-enumeration"}

1705 {
ERROR_CODE_REJECT_UNRECOGNIZED_SERVICE
, "reject-unrecognized-service"}

1707 {
ERROR_CODE_REJECT_PROPRIETARY
, "reject-proprietary"}

1709 {
ERROR_CODE_REJECT_OTHER
, "reject-other"}

1711 {
ERROR_CODE_UNKNOWN_DEVICE
, "unknown-device"}

1713 {
ERROR_CODE_UNKNOWN_ROUTE
, "unknown-route"}

1715 {
ERROR_CODE_VALUE_NOT_INITIALIZED
, "value-not-initialized"}

1717 {
ERROR_CODE_INVALID_EVENT_STATE
, "invalid-event-state"}

1719 {
ERROR_CODE_NO_ALARM_CONFIGURED
, "no-alarm-configured"}

1721 {
ERROR_CODE_LOG_BUFFER_FULL
, "log-buffer-full"}

1723 {
ERROR_CODE_LOGGED_VALUE_PURGED
, "logged-value-purged"}

1725 {
ERROR_CODE_NO_PROPERTY_SPECIFIED
, "no-property-specified"}

1727 {
ERROR_CODE_NOT_CONFIGURED_FOR_TRIGGERED_LOGGING
,

1730 {
ERROR_CODE_UNKNOWN_SUBSCRIPTION
, "unknown-subscription"}

1732 {
ERROR_CODE_PARAMETER_OUT_OF_RANGE
, "parameter-out-of-range"}

1734 {
ERROR_CODE_LIST_ELEMENT_NOT_FOUND
, "list-element-not-found"}

1736 {
ERROR_CODE_BUSY
, "busy"}

1738 {
ERROR_CODE_COMMUNICATION_DISABLED
, "communication-disabled"}

1740 {
ERROR_CODE_COMMUNICATION_DISABLED
, "access-denied"}

1742 {
ERROR_CODE_SUCCESS
, "success"},

1743 {
ERROR_CODE_ACCESS_DENIED
, "access-denied"},

1744 {
ERROR_CODE_BAD_DESTINATION_ADDRESS
, "bad-destination-address"},

1745 {
ERROR_CODE_BAD_DESTINATION_DEVICE_ID
, "bad-destination-device-id"},

1746 {
ERROR_CODE_BAD_SIGNATURE
, "bad-signature"},

1747 {
ERROR_CODE_BAD_SOURCE_ADDRESS
, "bad-source-address"},

1748 {
ERROR_CODE_BAD_TIMESTAMP
, "bad-timestamp"},

1749 {
ERROR_CODE_CANNOT_USE_KEY
, "cannot-use-key"},

1750 {
ERROR_CODE_CANNOT_VERIFY_MESSAGE_ID
, "cannot-verify-message-id"},

1751 {
ERROR_CODE_CORRECT_KEY_REVISION
, "correct-key-revision"},

1752 {
ERROR_CODE_DESTINATION_DEVICE_ID_REQUIRED
, "destination-device-id-required"},

1753 {
ERROR_CODE_DUPLICATE_MESSAGE
, "duplicate-message"},

1754 {
ERROR_CODE_ENCRYPTION_NOT_CONFIGURED
, "encryption-not-configured"},

1755 {
ERROR_CODE_ENCRYPTION_REQUIRED
, "encryption-required"},

1756 {
ERROR_CODE_INCORRECT_KEY
, "incorrect-key"},

1757 {
ERROR_CODE_INVALID_KEY_DATA
, "invalid-key-data"},

1758 {
ERROR_CODE_KEY_UPDATE_IN_PROGRESS
, "key-update-in-progress"},

1759 {
ERROR_CODE_MALFORMED_MESSAGE
, "malformed-message"},

1760 {
ERROR_CODE_NOT_KEY_SERVER
, "not-key-server"},

1761 {
ERROR_CODE_SECURITY_NOT_CONFIGURED
, "security-not-configured"},

1762 {
ERROR_CODE_SOURCE_SECURITY_REQUIRED
, "source-security-required"},

1763 {
ERROR_CODE_TOO_MANY_KEYS
, "too-many-keys"},

1764 {
ERROR_CODE_UNKNOWN_AUTHENTICATION_TYPE
, "unknown-authentication-type"},

1765 {
ERROR_CODE_UNKNOWN_KEY
, "unknown-key"},

1766 {
ERROR_CODE_UNKNOWN_KEY_REVISION
, "unknown-key-revision"},

1767 {
ERROR_CODE_UNKNOWN_SOURCE_MESSAGE
, "unknown-source-message"},

1768 {
ERROR_CODE_NOT_ROUTER_TO_DNET
, "not-router-to-dnet"},

1769 {
ERROR_CODE_ROUTER_BUSY
, "router-busy"},

1770 {
ERROR_CODE_UNKNOWN_NETWORK_MESSAGE
, "unknown-network-message"},

1771 {
ERROR_CODE_MESSAGE_TOO_LONG
, "message-too-long"},

1772 {
ERROR_CODE_SECURITY_ERROR
, "security-error"},

1773 {
ERROR_CODE_ADDRESSING_ERROR
, "addressing-error"},

1774 {
ERROR_CODE_WRITE_BDT_FAILED
, "write-bdt-failed"},

1775 {
ERROR_CODE_READ_BDT_FAILED
, "read-bdt-failed"},

1776 {
ERROR_CODE_REGISTER_FOREIGN_DEVICE_FAILED
, "register-foreign-device-failed"},

1777 {
ERROR_CODE_READ_FDT_FAILED
, "read-fdt-failed"},

1778 {
ERROR_CODE_DELETE_FDT_ENTRY_FAILED
, "delete-fdt-entry-failed"},

1779 {
ERROR_CODE_DISTRIBUTE_BROADCAST_FAILED
, "distribute-broadcast-failed"},

1780 {
ERROR_CODE_UNKNOWN_FILE_SIZE
, "unknown-file-size"},

1781 {
ERROR_CODE_ABORT_APDU_TOO_LONG
, "abort-apdu-too-long"},

1782 {
ERROR_CODE_ABORT_APPLICATION_EXCEEDED_REPLY_TIME
, "abort-application-exceeded-reply-time"},

1783 {
ERROR_CODE_ABORT_OUT_OF_RESOURCES
, "abort-out-of-resources"},

1784 {
ERROR_CODE_ABORT_TSM_TIMEOUT
, "abort-tsm-timeout"},

1785 {
ERROR_CODE_ABORT_WINDOW_SIZE_OUT_OF_RANGE
, "abort-window-size-out-of-range"},

1786 {
ERROR_CODE_FILE_FULL
, "file-full"},

1787 {
ERROR_CODE_INCONSISTENT_CONFIGURATION
, "inconsistent-configuration"},

1788 {
ERROR_CODE_INCONSISTENT_OBJECT_TYPE
, "inconsistent-object-type"},

1789 {
ERROR_CODE_INTERNAL_ERROR
, "internal-error"},

1790 {
ERROR_CODE_NOT_CONFIGURED
, "not-configured"},

1791 {
ERROR_CODE_OUT_OF_MEMORY
, "out-of-memory"},

1792 {
ERROR_CODE_VALUE_TOO_LONG
, "value-too-long"},

1793 {
ERROR_CODE_ABORT_INSUFFICIENT_SECURITY
, "abort-insufficient-security"},

1794 {
ERROR_CODE_ABORT_SECURITY_ERROR
, "abort-security-error"},

1795 {0, 
NULL
}

1798 cڡ *
	$baext_r_code_me
(

1799 
dex
)

1801  
	`dxt_by_dex_l_deu
(
ba_r_code_mes
, 
dex
,

1802 
FIRST_PROPRIETARY_ERROR_CLASS
, 
ASHRAE_Rerved_Sg
,

1803 
Vd_Prrry_Sg
);

1804 
	}
}

1806 
INDTEXT_DATA
 
	gba_mth_mes
[] = {

1837 {0, 
NULL
}

1840 cڡ *
	$baext_mth_me
(

1841 
dex
)

1843  
	`dxt_by_dex_deu
(
ba_mth_mes
, 
dex
,

1844 
ASHRAE_Rerved_Sg
);

1845 
	}
}

1847 
INDTEXT_DATA
 
	gba_wk_of_mth_mes
[] = {

1862 {0, 
NULL
}

1865 cڡ *
	$baext_wk_of_mth_me
(

1866 
dex
)

1868  
	`dxt_by_dex_deu
(
ba_wk_of_mth_mes
, 
dex
,

1869 
ASHRAE_Rerved_Sg
);

1870 
	}
}

1873 
INDTEXT_DATA
 
	gba_day_of_wk_mes
[] = {

1890 {0, 
NULL
}

1893 cڡ *
	$baext_day_of_wk_me
(

1894 
dex
)

1896  
	`dxt_by_dex_deu
(
ba_day_of_wk_mes
, 
dex
,

1897 
ASHRAE_Rerved_Sg
);

1898 
	}
}

1901 
INDTEXT_DATA
 
	gba_days_of_wk_mes
[] = {

1902 {
BACNET_DAYS_OF_WEEK_MONDAY
, "Monday"}

1904 {
BACNET_DAYS_OF_WEEK_TUESDAY
, "Tuesday"}

1906 {
BACNET_DAYS_OF_WEEK_WEDNESDAY
, "Wednesday"}

1908 {
BACNET_DAYS_OF_WEEK_THURSDAY
, "Thursday"}

1910 {
BACNET_DAYS_OF_WEEK_FRIDAY
, "Friday"}

1912 {
BACNET_DAYS_OF_WEEK_SATURDAY
, "Saturday"}

1914 {
BACNET_DAYS_OF_WEEK_SUNDAY
, "Sunday"}

1916 {0, 
NULL
}

1919 cڡ *
	$baext_days_of_wk_me
(

1920 
dex
)

1922  
	`dxt_by_dex_deu
(
ba_days_of_wk_mes
, 
dex
,

1923 
ASHRAE_Rerved_Sg
);

1924 
	}
}

1926 
bo
 
	$baext_days_of_wk_dex
(

1927 cڡ *
ch_me
,

1928 *
found_dex
)

1930  
	`dxt_by_irg
(
ba_days_of_wk_mes
, 
ch_me
,

1931 
found_dex
);

1932 
	}
}

1934 
INDTEXT_DATA
 
	gba_evt_si_mes
[] = {

1935 {
TRANSITION_TO_OFFNORMAL
, "offnormal"}

1937 {
TRANSITION_TO_NORMAL
, "normal"}

1939 {
TRANSITION_TO_FAULT
, "fault"}

1941 {0, 
NULL
}

1944 cڡ *
	$baext_evt_si_me
(

1945 
dex
)

1947  
	`dxt_by_dex_deu
(
ba_evt_si_mes
, 
dex
,

1948 
ASHRAE_Rerved_Sg
);

1949 
	}
}

1951 
bo
 
	$baext_evt_si_dex
(

1952 cڡ *
ch_me
,

1953 *
found_dex
)

1955  
	`dxt_by_irg
(
ba_evt_si_mes
, 
ch_me
,

1956 
found_dex
);

1957 
	}
}

1959 
INDTEXT_DATA
 
	gba_evt_e_mes
[] = {

1960 {
EVENT_STATE_NORMAL
, "normal"}

1962 {
EVENT_STATE_FAULT
, "fault"}

1964 {
EVENT_STATE_OFFNORMAL
, "offnormal"}

1966 {
EVENT_STATE_HIGH_LIMIT
, "highimit"}

1968 {
EVENT_STATE_LOW_LIMIT
, "lowimit"}

1970 {0, 
NULL
}

1973 cڡ *
	$baext_evt_e_me
(

1974 
dex
)

1976  
	`dxt_by_dex_deu
(
ba_evt_e_mes
, 
dex
,

1977 
ASHRAE_Rerved_Sg
);

1978 
	}
}

1980 
INDTEXT_DATA
 
	gba_by_e_vue_mes
[] = {

1981 {
BINARY_INACTIVE
, "inactive"}

1983 {
BINARY_ACTIVE
, "active"}

1985 {0, 
NULL
}

1988 cڡ *
	$baext_by_e_vue_me
(

1989 
dex
)

1991  
	`dxt_by_dex_deu
(
ba_by_e_vue_mes
, 
dex
,

1992 
ASHRAE_Rerved_Sg
);

1993 
	}
}

1995 
bo
 
	$baext_by_e_vue_dex
(

1996 cڡ *
ch_me
,

1997 *
found_dex
)

1999  
	`dxt_by_irg
(
ba_by_e_vue_mes
, 
ch_me
,

2000 
found_dex
);

2001 
	}
}

2003 
INDTEXT_DATA
 
	gba_by_pެy_mes
[] = {

2004 {
POLARITY_NORMAL
, "normal"}

2006 {
POLARITY_REVERSE
, "reverse"}

2008 {0, 
NULL
}

2011 cڡ *
	$baext_by_pެy_me
(

2012 
dex
)

2014  
	`dxt_by_dex_deu
(
ba_by_pެy_mes
, 
dex
,

2015 
ASHRAE_Rerved_Sg
);

2016 
	}
}

2019 
INDTEXT_DATA
 
	gba_lby_mes
[] = {

2020 {
RELIABILITY_NO_FAULT_DETECTED
, "no-fault-detected"}

2022 {
RELIABILITY_NO_SENSOR
, "no-sensor"}

2024 {
RELIABILITY_OVER_RANGE
, "over-range"}

2026 {
RELIABILITY_UNDER_RANGE
, "under-range"}

2028 {
RELIABILITY_OPEN_LOOP
, "open-loop"}

2030 {
RELIABILITY_SHORTED_LOOP
, "shorted-loop"}

2032 {
RELIABILITY_NO_OUTPUT
, "no-output"}

2034 {
RELIABILITY_UNRELIABLE_OTHER
, "unreliable-other"}

2036 {
RELIABILITY_PROCESS_ERROR
, "process-error"}

2038 {
RELIABILITY_MULTI_STATE_FAULT
, "mult-state-fault"}

2040 {
RELIABILITY_CONFIGURATION_ERROR
, "configuration-error"}

2042 {
RELIABILITY_MEMBER_FAULT
, "member-fault"}

2044 {
RELIABILITY_COMMUNICATION_FAILURE
, "communication-failure"}

2046 {
RELIABILITY_TRIPPED
, "tripped"}

2048 {0, 
NULL
}

2051 cڡ *
	$baext_lby_me
(

2052 
dex
)

2054  
	`dxt_by_dex_deu
(
ba_lby_mes
, 
dex
,

2055 
ASHRAE_Rerved_Sg
);

2056 
	}
}

2058 
INDTEXT_DATA
 
	gba_devi_us_mes
[] = {

2059 {
STATUS_OPERATIONAL
, "operational"}

2061 {
STATUS_OPERATIONAL_READ_ONLY
, "operational-read-only"}

2063 {
STATUS_DOWNLOAD_REQUIRED
, "download-required"}

2065 {
STATUS_DOWNLOAD_IN_PROGRESS
, "download-in-progress"}

2067 {
STATUS_NON_OPERATIONAL
, "non-operational"}

2069 {
STATUS_BACKUP_IN_PROGRESS
, "backup-in-progress"}

2071 {0, 
NULL
}

2074 cڡ *
	$baext_devi_us_me
(

2075 
dex
)

2077  
	`dxt_by_dex_deu
(
ba_devi_us_mes
, 
dex
,

2078 
ASHRAE_Rerved_Sg
);

2079 
	}
}

2081 
INDTEXT_DATA
 
	gba_gmti_mes
[] = {

2082 {
SEGMENTATION_BOTH
, "segmented-both"}

2084 {
SEGMENTATION_TRANSMIT
, "segmented-transmit"}

2086 {
SEGMENTATION_RECEIVE
, "segmented-receive"}

2088 {
SEGMENTATION_NONE
, "no-segmentation"}

2090 {0, 
NULL
}

2093 cڡ *
	$baext_gmti_me
(

2094 
dex
)

2096  
	`dxt_by_dex_deu
(
ba_gmti_mes
, 
dex
,

2097 
ASHRAE_Rerved_Sg
);

2098 
	}
}

2100 
bo
 
	$baext_gmti_dex
(

2101 cڡ *
ch_me
,

2102 *
found_dex
)

2104  
	`dxt_by_irg
(
ba_gmti_mes
, 
ch_me
,

2105 
found_dex
);

2106 
	}
}

2108 
INDTEXT_DATA
 
	gba_node_ty_mes
[] = {

2109 {
BACNET_NODE_UNKNOWN
, "unknown"}

2111 {
BACNET_NODE_SYSTEM
, "system"}

2113 {
BACNET_NODE_NETWORK
, "network"}

2115 {
BACNET_NODE_DEVICE
, "device"}

2117 {
BACNET_NODE_ORGANIZATIONAL
, "organizational"}

2119 {
BACNET_NODE_AREA
, "area"}

2121 {
BACNET_NODE_EQUIPMENT
, "equipment"}

2123 {
BACNET_NODE_POINT
, "point"}

2125 {
BACNET_NODE_COLLECTION
, "collection"}

2127 {
BACNET_NODE_PROPERTY
, "property"}

2129 {
BACNET_NODE_FUNCTIONAL
, "functional"}

2131 {
BACNET_NODE_OTHER
, "other"}

2133 {0, 
NULL
}

2136 cڡ *
	$baext_node_ty_me
(

2137 
dex
)

2139  
	`dxt_by_dex_deu
(
ba_node_ty_mes
, 
dex
,

2140 
ASHRAE_Rerved_Sg
);

2141 
	}
}

2143 
INDTEXT_DATA
 
	gtwk_y_msg_mes
[] = {

2144 {
NETWORK_MESSAGE_WHO_IS_ROUTER_TO_NETWORK
, "Who-Is-Router-To-Network"}

2146 {
NETWORK_MESSAGE_I_AM_ROUTER_TO_NETWORK
, "I-Am-Router-To-Network"}

2148 {
NETWORK_MESSAGE_I_COULD_BE_ROUTER_TO_NETWORK
,

2151 {
NETWORK_MESSAGE_REJECT_MESSAGE_TO_NETWORK
, "Reject-Message-to-Network"}

2153 {
NETWORK_MESSAGE_ROUTER_BUSY_TO_NETWORK
, "Router-Busy-To-Network"}

2155 {
NETWORK_MESSAGE_ROUTER_AVAILABLE_TO_NETWORK
, "Router-Available-To-Network"}

2157 {
NETWORK_MESSAGE_INIT_RT_TABLE
, "Initialize-Routing-Table"}

2159 {
NETWORK_MESSAGE_INIT_RT_TABLE_ACK
, "Initialize-Routing-Table-Ack"}

2161 {
NETWORK_MESSAGE_ESTABLISH_CONNECTION_TO_NETWORK
, "Est-Conn-Ntwk"}

2163 {
NETWORK_MESSAGE_DISCONNECT_CONNECTION_TO_NETWORK
, "Dsc-Conn-Ntwk"}

2165 {0, 
NULL
}

2168 cڡ *
	$baext_twk_y_msg_me
(

2169 
dex
)

2171 i(
dex
 <= 0x7F)

2172  
	`dxt_by_dex_deu
(
twk_y_msg_mes
, 
dex
,

2173 
ASHRAE_Rerved_Sg
);

2174 i(
dex
 < 
NETWORK_MESSAGE_INVALID
)

2175  
Vd_Prrry_Sg
;

2178 
	}
}

2180 
INDTEXT_DATA
 
	gli_ty_e_mes
[] = {

2181 {
LIFE_SAFETY_STATE_QUIET
, "quiet"}

2183 {
LIFE_SAFETY_STATE_PRE_ALARM
, "pre-alarm"}

2185 {
LIFE_SAFETY_STATE_ALARM
, "alarm"}

2187 {
LIFE_SAFETY_STATE_FAULT
, "fault"}

2189 {
LIFE_SAFETY_STATE_FAULT_PRE_ALARM
, "fault-pre-alarm"}

2191 {
LIFE_SAFETY_STATE_FAULT_ALARM
, "fault-alarm"}

2193 {
LIFE_SAFETY_STATE_NOT_READY
, "not-ready"}

2195 {
LIFE_SAFETY_STATE_ACTIVE
, "active"}

2197 {
LIFE_SAFETY_STATE_TAMPER
, "tamper"}

2199 {
LIFE_SAFETY_STATE_TEST_ALARM
, "test-alarm"}

2201 {
LIFE_SAFETY_STATE_TEST_ACTIVE
, "test-active"}

2203 {
LIFE_SAFETY_STATE_TEST_FAULT
, "test-fault"}

2205 {
LIFE_SAFETY_STATE_TEST_FAULT_ALARM
, "fault-alarm"}

2207 {
LIFE_SAFETY_STATE_HOLDUP
, "holdupt"}

2209 {
LIFE_SAFETY_STATE_DURESS
, "duress"}

2211 {
LIFE_SAFETY_STATE_TAMPER_ALARM
, "tamper-alarm"}

2213 {
LIFE_SAFETY_STATE_ABNORMAL
, "abnormal"}

2215 {
LIFE_SAFETY_STATE_EMERGENCY_POWER
, "emergency-power"}

2217 {
LIFE_SAFETY_STATE_DELAYED
, "delayed"}

2219 {
LIFE_SAFETY_STATE_BLOCKED
, "blocked"}

2221 {
LIFE_SAFETY_STATE_LOCAL_ALARM
, "local-alarm"}

2223 {
LIFE_SAFETY_STATE_GENERAL_ALARM
, "general-alarm"}

2225 {
LIFE_SAFETY_STATE_SUPERVISORY
, "supervisory"}

2227 {
LIFE_SAFETY_STATE_TEST_SUPERVISORY
, "test-supervisory"}

2229 {0, 
NULL
}

2232 cڡ *
	$baext_li_ty_e_me
(

2233 
dex
)

2235 i(
dex
 < 
MAX_LIFE_SAFETY_STATE
)

2236  
	`dxt_by_dex_deu
(
li_ty_e_mes
, 
dex
,

2237 
ASHRAE_Rerved_Sg
);

2240 
	}
}

2242 
INDTEXT_DATA
 
	glightg__ogss
[] = {

2243 {
BACNET_LIGHTING_IDLE
, "idle" }

2245 { 
BACNET_LIGHTING_FADE_ACTIVE
, "fade" }

2247 { 
BACNET_LIGHTING_RAMP_ACTIVE
, "ramp" }

2249 { 
BACNET_LIGHTING_NOT_CONTROLLED
, "not" }

2251 {
BACNET_LIGHTING_OTHER
, "other"}

2253 { 0, 
NULL
 }

2256 cڡ *
	$baext_lightg__ogss
(

2257 
dex
)

2259 i(
dex
 < 
MAX_BACNET_LIGHTING_IN_PROGRESS
)

2260  
	`dxt_by_dex_deu
(
lightg__ogss
, 
dex
,

2261 
ASHRAE_Rerved_Sg
);

2264 
	}
}

2266 
INDTEXT_DATA
 
	glightg_si
[] = {

2267 { 
BACNET_LIGHTING_TRANSITION_IDLE
, "idle" }

2269 { 
BACNET_LIGHTING_TRANSITION_FADE
, "fade" }

2271 { 
BACNET_LIGHTING_TRANSITION_RAMP
, "ramp" }

2273 { 0, 
NULL
 }

2276 cڡ *
	$baext_lightg_si
(

2277 
dex
)

2279 i(
dex
 < 
MAX_BACNET_LIGHTING_TRANSITION
)

2280  
	`dxt_by_dex_deu
(
lightg_si
, 
dex
,

2281 
ASHRAE_Rerved_Sg
);

2284 
	}
}

2286 
INDTEXT_DATA
 
	gba_lightg_ݔi_mes
[] = {

2287 {
BACNET_LIGHTS_NONE
, "none"}

2289 {
BACNET_LIGHTS_FADE_TO
, "fade-to"}

2291 {
BACNET_LIGHTS_RAMP_TO
, "ramp-to"}

2293 {
BACNET_LIGHTS_STEP_UP
, "step-up"}

2295 {
BACNET_LIGHTS_STEP_DOWN
, "step-down"}

2297 {
BACNET_LIGHTS_STEP_ON
, "step-on"}

2299 {
BACNET_LIGHTS_STEP_OFF
, "step-off"}

2301 {
BACNET_LIGHTS_WARN
, "warn"}

2303 {
BACNET_LIGHTS_WARN_OFF
, "warn-off"}

2305 {
BACNET_LIGHTS_WARN_RELINQUISH
, "warn-relinquish"}

2307 {
BACNET_LIGHTS_STOP
, "stop"}

2309 {0, 
NULL
}

2312 cڡ *
	$baext_lightg_ݔi_me
(

2313 
dex
)

2315 i(
dex
 < 
BACNET_LIGHTS_PROPRIETARY_FIRST
)

2316  
	`dxt_by_dex_deu
(
twk_y_msg_mes
, 
dex
,

2317 
ASHRAE_Rerved_Sg
);

2318 i(
dex
 <
BACNET_LIGHTS_PROPRIETARY_LAST
)

2319  
Vd_Prrry_Sg
;

2322 
	}
}

	@src/bactimevalue.c

35 
	~<dbo.h
>

36 
	~<dt.h
>

37 
	~"bacdcode.h
"

38 
	~"baimevue.h
"

40 
	$ba_code_time_vue
(
ut8_t
 * 
du
,

41 
BACNET_TIME_VALUE
 * 
vue
)

43 
n
;

44 
du_n
 = 0;

46 
n
 = 
	`code_iti_time
(&
du
[
du_n
], &
vue
->
Time
);

47 
du_n
 +
n
;

49 
n
 = 
	`ba_code_iti_da
(&
du
[
du_n
], &
vue
->
Vue
);

50 
du_n
 +
n
;

52  
du_n
;

53 
	}
}

55 
	$ba_code_cڋxt_time_vue
(
ut8_t
 * 
du
,

56 
ut8_t
 
g_numb
,

57 
BACNET_TIME_VALUE
 * 
vue
)

59 
n
;

60 
du_n
 = 0;

62 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 
g_numb
);

63 
du_n
 +
n
;

65 
n
 = 
	`ba_code_time_vue
(&
du
[
du_n
], 
vue
);

66 
du_n
 +
n
;

68 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 
g_numb
);

69 
du_n
 +
n
;

71  
du_n
;

72 
	}
}

74 
	$ba_decode_time_vue
(
ut8_t
 * 
du
,

75 
BACNET_TIME_VALUE
 * 
vue
)

77 
n
;

78 
du_n
 = 0;

80 
n
 = 
	`decode_iti_time
(&
du
[
du_n
], &
vue
->
Time
);

81 i(
n
 <= 0)

83 
du_n
 +
n
;

85 
n
 = 
	`ba_decode_iti_da
(&
du
[
du_n
], 2048, &
vue
->
Vue
);

86 i(
n
 <= 0)

88 
du_n
 +
n
;

90  
du_n
;

91 
	}
}

93 
	$ba_decode_cڋxt_time_vue
(
ut8_t
 * 
du
,

94 
ut8_t
 
g_numb
,

95 
BACNET_TIME_VALUE
 * 
vue
)

97 
n
 = 0;

98 
i_ngth
;

100 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 
g_numb
))

101 
n
++;

105 
i_ngth
 = 
	`ba_decode_time_vue
(&
du
[
n
], 
vue
);

106 i(
i_ngth
 > 0)

107 
n
 +
i_ngth
;

111 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 
g_numb
))

112 
n
++;

116  
n
;

117 
	}
}

	@src/bigend.c

6 
	~"bigd.h
"

38 
	$big_dn
(

42 
l
;

43 
c
[()];

44 } 
u
;

46 
u
.
l
 = 1;

48  (
u
.
c
[() - 1] == 1);

49 
	}
}

	@src/bip.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~"bacdcode.h
"

38 
	~"bact.h
"

39 
	~"b.h
"

40 
	~"bvlc.h
"

41 
	~"t.h
"

42 #i
PRINT_ENABLED


43 
	~<dio.h
>

48 
	gBIP_Sock
 = -1;

50 
ut16_t
 
	gBIP_Pt
 = 0;

52 
_addr
 
	gBIP_Addss
;

54 
_addr
 
	gBIP_Brd_Addss
;

60 
	$b_t_sock
(

61 
sock_fd
)

63 
BIP_Sock
 = 
sock_fd
;

64 
	}
}

70 
	$b_sock
(

73  
BIP_Sock
;

74 
	}
}

76 
bo
 
	$b_vid
(

79  (
BIP_Sock
 != -1);

80 
	}
}

82 
	$b_t_addr
(

83 
ut32_t
 
t_addss
)

85 
BIP_Addss
.
s_addr
 = 
t_addss
;

86 
	}
}

89 
ut32_t
 
	$b_g_addr
(

92  
BIP_Addss
.
s_addr
;

93 
	}
}

95 
	$b_t_brd_addr
(

96 
ut32_t
 
t_addss
)

98 
BIP_Brd_Addss
.
s_addr
 = 
t_addss
;

99 
	}
}

102 
ut32_t
 
	$b_g_brd_addr
(

105  
BIP_Brd_Addss
.
s_addr
;

106 
	}
}

109 
	$b_t_pt
(

110 
ut16_t
 
pt
)

112 
BIP_Pt
 = 
pt
;

113 
	}
}

116 
ut16_t
 
	$b_g_pt
(

119  
BIP_Pt
;

120 
	}
}

122 
	$b_decode_b_addss
(

123 
BACNET_ADDRESS
 * 
bac_addr
,

124 
_addr
 *
addss
,

125 
ut16_t
 * 
pt
)

127 
n
 = 0;

129 i(
bac_addr
) {

130 
	`memy
(&
addss
->
s_addr
, &
bac_addr
->
mac
[0], 4);

131 
	`memy
(
pt
, &
bac_addr
->
mac
[4], 2);

132 
n
 = 6;

135  
n
;

136 
	}
}

147 
	$b_nd_pdu
(

148 
BACNET_ADDRESS
 * 
de
,

149 
BACNET_NPDU_DATA
 * 
du_da
,

150 
ut8_t
 * 
pdu
,

151 
pdu_n
)

153 
sockaddr_
 
b_de
;

154 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

155 
mtu_n
 = 0;

156 
bys_
 = 0;

158 
_addr
 
addss
;

159 
ut16_t
 
pt
 = 0;

161 (
du_da
;

163 i(
BIP_Sock
 < 0) {

164  
BIP_Sock
;

167 
mtu
[0] = 
BVLL_TYPE_BACNET_IP
;

168 
b_de
.
s_my
 = 
AF_INET
;

169 i((
de
->
t
 =
BACNET_BROADCAST_NETWORK
|| (de->
mac_n
 == 0)) {

171 
addss
.
s_addr
 = 
BIP_Brd_Addss
.s_addr;

172 
pt
 = 
BIP_Pt
;

173 
mtu
[1] = 
BVLC_ORIGINAL_BROADCAST_NPDU
;

174 } i((
de
->
t
 > 0&& (de->
n
 == 0)) {

176 i(
de
->
mac_n
 == 6) {

177 
	`b_decode_b_addss
(
de
, &
addss
, &
pt
);

179 
addss
.
s_addr
 = 
BIP_Brd_Addss
.s_addr;

180 
pt
 = 
BIP_Pt
;

182 
mtu
[1] = 
BVLC_ORIGINAL_BROADCAST_NPDU
;

183 } i(
de
->
mac_n
 == 6) {

184 
	`b_decode_b_addss
(
de
, &
addss
, &
pt
);

185 
mtu
[1] = 
BVLC_ORIGINAL_UNICAST_NPDU
;

190 
b_de
.
s_addr
.
s_addr
 = 
addss
.s_addr;

191 
b_de
.
s_pt
 = 
pt
;

192 
	`memt
(&(
b_de
.
s_zo
), '\0', 8);

193 
mtu_n
 = 2;

194 
mtu_n
 +=

195 
	`code_unsigd16
(&
mtu
[
mtu_n
],

196 (
ut16_t
(
pdu_n
 + 4 ));

197 
	`memy
(&
mtu
[
mtu_n
], 
pdu
, 
pdu_n
);

198 
mtu_n
 +
pdu_n
;

201 
bys_
 =

202 
	`ndto
(
BIP_Sock
, (*
mtu
, 
mtu_n
, 0,

203 (
sockaddr
 *&
b_de
, (sockaddr));

205  
bys_
;

206 
	}
}

219 
ut16_t
 
	$b_ive
(

220 
BACNET_ADDRESS
 * 
c
,

221 
ut8_t
 * 
pdu
,

222 
ut16_t
 
max_pdu
,

223 
timeout
)

225 
ived_bys
 = 0;

226 
ut16_t
 
pdu_n
 = 0;

227 
fd_t
 
ad_fds
;

228 
max
 = 0;

229 
timev
 
_timeout
;

230 
sockaddr_
 
s
 = { 0 };

231 
sockn_t
 
s_n
 = (
s
);

232 
ut16_t
 
i
 = 0;

233 
funi
 = 0;

236 i(
BIP_Sock
 < 0)

242 i(
timeout
 >= 1000) {

243 
_timeout
.
tv_c
 = 
timeout
 / 1000;

244 
_timeout
.
tv_uc
 =

245 1000 * (
timeout
 - 
_timeout
.
tv_c
 * 1000);

247 
_timeout
.
tv_c
 = 0;

248 
_timeout
.
tv_uc
 = 1000 * 
timeout
;

250 
	`FD_ZERO
(&
ad_fds
);

251 
	`FD_SET
(
BIP_Sock
, &
ad_fds
);

252 
max
 = 
BIP_Sock
;

254 i(
	`
(
max
 + 1, &
ad_fds
, 
NULL
, NULL, &
_timeout
) > 0)

255 
ived_bys
 =

256 
	`cvom
(
BIP_Sock
, (*&
pdu
[0], 
max_pdu
, 0,

257 (
sockaddr
 *&
s
, &
s_n
);

262 i(
ived_bys
 < 0) {

267 i(
ived_bys
 == 0)

271 i(
pdu
[0] !
BVLL_TYPE_BACNET_IP
)

274 i(
	`bvlc_f_n_bbmd
(&
s
, 
pdu
, 
ived_bys
) > 0) {

276 #i
PRINT_ENABLED


277 
	`rtf
(
dr
, "BIP: BVLC discarded!\n");

282 
funi
 = 
	`bvlc_g_funi_code
();

283 i((
funi
 =
BVLC_ORIGINAL_UNICAST_NPDU
) ||

284 (
funi
 =
BVLC_ORIGINAL_BROADCAST_NPDU
)) {

286 i((
s
.
s_addr
.
s_addr
 =
BIP_Addss
.s_addr) &&

287 (
s
.
s_pt
 =
BIP_Pt
)) {

288 
pdu_n
 = 0;

290 
	`rtf
(
dr
, "BIP: src is me. Discarded!\n");

294 
c
->
mac_n
 = 6;

295 
	`memy
(&
c
->
mac
[0], &
s
.
s_addr
.
s_addr
, 4);

296 
	`memy
(&
c
->
mac
[4], &
s
.
s_pt
, 2);

300 (
	`decode_unsigd16
(&
pdu
[2], &
pdu_n
);

302 
pdu_n
 -= 4;

303 i(
pdu_n
 < 
max_pdu
) {

305 
	`rtf
(
dr
, "BIP: NPDU[%hu]:", 
pdu_n
);

308 
i
 = 0; i < 
pdu_n
; i++) {

309 
pdu
[
i
] =du[4 + i];

311 
	`rtf
(
dr
, "%02X ", 
pdu
[
i
]);

315 
	`rtf
(
dr
, "\n");

321 
pdu_n
 = 0;

322 #i
PRINT_ENABLED


323 
	`rtf
(
dr
, "BIP: PDUooarge. Discarded!.\n");

327 } i(
funi
 =
BVLC_FORWARDED_NPDU
) {

328 
	`memy
(&
s
.
s_addr
.
s_addr
, &
pdu
[4], 4);

329 
	`memy
(&
s
.
s_pt
, &
pdu
[8], 2);

330 i((
s
.
s_addr
.
s_addr
 =
BIP_Addss
.s_addr) &&

331 (
s
.
s_pt
 =
BIP_Pt
)) {

333 
pdu_n
 = 0;

336 
c
->
mac_n
 = 6;

337 
	`memy
(&
c
->
mac
[0], &
s
.
s_addr
.
s_addr
, 4);

338 
	`memy
(&
c
->
mac
[4], &
s
.
s_pt
, 2);

342 (
	`decode_unsigd16
(&
pdu
[2], &
pdu_n
);

344 
pdu_n
 -= 10;

345 i(
pdu_n
 < 
max_pdu
) {

347 
i
 = 0; i < 
pdu_n
; i++) {

348 
pdu
[
i
] =du[4 + 6 + i];

353 
pdu_n
 = 0;

358  
pdu_n
;

359 
	}
}

361 
	$b_g_my_addss
(

362 
BACNET_ADDRESS
 * 
my_addss
)

364 
i
 = 0;

366 i(
my_addss
) {

367 
my_addss
->
mac_n
 = 6;

368 
	`memy
(&
my_addss
->
mac
[0], &
BIP_Addss
.
s_addr
, 4);

369 
	`memy
(&
my_addss
->
mac
[4], &
BIP_Pt
, 2);

370 
my_addss
->
t
 = 0;

371 
my_addss
->
n
 = 0;

372 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

374 
my_addss
->
adr
[
i
] = 0;

379 
	}
}

381 
	$b_g_brd_addss
(

382 
BACNET_ADDRESS
 * 
de
)

384 
i
 = 0;

386 i(
de
) {

387 
de
->
mac_n
 = 6;

388 
	`memy
(&
de
->
mac
[0], &
BIP_Brd_Addss
.
s_addr
, 4);

389 
	`memy
(&
de
->
mac
[4], &
BIP_Pt
, 2);

390 
de
->
t
 = 
BACNET_BROADCAST_NETWORK
;

391 
de
->
n
 = 0;

392 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

394 
de
->
adr
[
i
] = 0;

399 
	}
}

	@src/bvlc.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~<time.h
>

38 
	~"banum.h
"

39 
	~"bacdcode.h
"

40 
	~"bact.h
"

41 
	~"bvlc.h
"

42 #ide
DEBUG_ENABLED


43 
	#DEBUG_ENABLED
 0

	)

45 
	~"debug.h
"

55 
sockaddr_
 
	gReme_BBMD
;

58 
_addr
 
	gBVLC_Glob_Addss
;

61 
bo
 
	gBVLC_NAT_Hdlg
 = 
l
;

64 
BACNET_BVLC_RESULT
 
	gBVLC_Resu_Code
 = 
BVLC_RESULT_SUCCESSFUL_COMPLETION
;

67 
BACNET_BVLC_FUNCTION
 
	gBVLC_Funi_Code
 = 
BVLC_RESULT
;

74 #i
defed
(
BBMD_ENABLED
) && BBMD_ENABLED

77 #ide
MAX_BBMD_ENTRIES


78 
	#MAX_BBMD_ENTRIES
 128

	)

80 
BBMD_TABLE_ENTRY
 
	gBBMD_Tab
[
MAX_BBMD_ENTRIES
];

92 
bo
 
	mvid
;

94 
_addr
 
	mde_addss
;

96 
ut16_t
 
	mde_pt
;

98 
ut16_t
 
	mtime_to_live
;

100 
time_t
 
	mcds_mag
;

101 } 
	tFD_TABLE_ENTRY
;

103 #ide
MAX_FD_ENTRIES


104 
	#MAX_FD_ENTRIES
 128

	)

106 
FD_TABLE_ENTRY
 
	gFD_Tab
[
MAX_FD_ENTRIES
];

118 
	#BBMD_BACKUP_FILE
 
BACt_BDT_b


	)

119 #i
defed
(
BBMD_BACKUP_FILE
)

121 
	#tor
(
a

	`r
)

	)

122 
	#r
(
a
#a

	)

124 
	$bvlc_bdt_backup_lol
(

127 
FILE
 *
bdt_fe_r
 = 
NULL
;

130 i(!
bdt_fe_r
)

131 
bdt_fe_r
 = 
	`fݒ
(
	`tor
(
BBMD_BACKUP_FILE
),"wb");

134 i(!
bdt_fe_r
)

137 
	`fek
(
bdt_fe_r
, 0, 
SEEK_SET
);

138 
	`fwre
(
BBMD_Tab
, (
BBMD_TABLE_ENTRY
), 
MAX_BBMD_ENTRIES
, 
bdt_fe_r
);

139 
	`fush
(
bdt_fe_r
);

140 
	}
}

142 
	$bvlc_bdt_e_lol
(

145 
FILE
 *
bdt_fe_r
 = 
NULL
;

148 i(!
bdt_fe_r
)

149 
bdt_fe_r
 = 
	`fݒ
(
	`tor
(
BBMD_BACKUP_FILE
),"rb");

152 i(!
bdt_fe_r
)

155 
	`fek
(
bdt_fe_r
, 0, 
SEEK_SET
);

157 
BBMD_TABLE_ENTRY
 
BBMD_Tab_tmp
[
MAX_BBMD_ENTRIES
];

158 
size_t
 
s
 = 0;

160 
s
 = 
	`d
(
BBMD_Tab_tmp
, (
BBMD_TABLE_ENTRY
), 
MAX_BBMD_ENTRIES
, 
bdt_fe_r
);

161 i(
s
 =
MAX_BBMD_ENTRIES
)

163 
	`memy
(
BBMD_Tab
, 
BBMD_Tab_tmp
, (
BBMD_TABLE_ENTRY
* 
MAX_BBMD_ENTRIES
);

165 
	}
}

167 
	$bvlc_bdt_backup_lol
 ({
	}
}

168 
	$bvlc_bdt_e_lol
({
	}
}

179 
	$bvlc_man_tim
(

180 
time_t
 
cds
)

182 
i
 = 0;

184 
i
 = 0; i < 
MAX_FD_ENTRIES
; i++) {

185 i(
FD_Tab
[
i
].
vid
) {

186 i(
FD_Tab
[
i
].
cds_mag
) {

187 i(
FD_Tab
[
i
].
cds_mag
 < 
cds
) {

188 
FD_Tab
[
i
].
cds_mag
 = 0;

190 
FD_Tab
[
i
].
cds_mag
 -
cds
;

192 i(
FD_Tab
[
i
].
cds_mag
 == 0) {

193 
FD_Tab
[
i
].
vid
 = 
l
;

198 
	}
}

209 
	$bvlc__to_ba_addss
(

210 
BACNET_ADDRESS
 * 
c
,

211 
sockaddr_
 *
s
)

213 i(
c
 && 
s
) {

214 
	`memy
(&
c
->
mac
[0], &
s
->
s_addr
.
s_addr
, 4);

215 
	`memy
(&
c
->
mac
[4], &
s
->
s_pt
, 2);

216 
c
->
mac_n
 = (
ut8_t
) 6;

217 
c
->
t
 = 0;

218 
c
->
n
 = 0;

222 
	}
}

239 
	$bvlc_code_b_addss
(

240 
ut8_t
 * 
pdu
,

241 
_addr
 *
addss
,

242 
ut16_t
 
pt
)

244 
n
 = 0;

246 i(
pdu
) {

247 
	`memy
(&
pdu
[0], &
addss
->
s_addr
, 4);

248 
	`memy
(&
pdu
[4], &
pt
, 2);

249 
n
 = 6;

252  
n
;

253 
	}
}

263 
	$bvlc_decode_b_addss
(

264 
ut8_t
 * 
pdu
,

265 
_addr
 *
addss
,

266 
ut16_t
 * 
pt
)

268 
n
 = 0;

270 i(
pdu
) {

271 
	`memy
(&
addss
->
s_addr
, &
pdu
[0], 4);

272 
	`memy
(
pt
, &
pdu
[4], 2);

273 
n
 = 6;

276  
n
;

277 
	}
}

288 
	$bvlc_code_addss_y
(

289 
ut8_t
 * 
pdu
,

290 
_addr
 *
addss
,

291 
ut16_t
 
pt
,

292 
_addr
 *
mask
)

294 
n
 = 0;

296 i(
pdu
) {

297 
n
 = 
	`bvlc_code_b_addss
(
pdu
, 
addss
, 
pt
);

298 
	`memy
(&
pdu
[
n
], &
mask
->
s_addr
, 4);

299 
n
 += 4;

302  
n
;

303 
	}
}

314 
	$bvlc_code_bvlc_su
(

315 
ut8_t
 * 
pdu
,

316 
BACNET_BVLC_RESULT
 
su_code
)

318 i(
pdu
) {

319 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

320 
pdu
[1] = 
BVLC_RESULT
;

324 
	`code_unsigd16
(&
pdu
[2], 6);

325 
	`code_unsigd16
(&
pdu
[4], (
ut16_t

su_code
);

329 
	}
}

331 #i
defed
(
BBMD_CLIENT_ENABLED
) && BBMD_CLIENT_ENABLED

339 
	$bvlc_code_wre_bdt_
(

340 
ut8_t
 * 
pdu
,

341 
s
)

343 
n
 = 0;

344 
ut16_t
 
BVLC_ngth
 = 0;

346 i(
pdu
) {

347 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

348 
pdu
[1] = 
BVLC_WRITE_BROADCAST_DISTRIBUTION_TABLE
;

352 
BVLC_ngth
 = 4 + (
ut16_t
(
s
 * 10);

353 
	`code_unsigd16
(&
pdu
[2], 
BVLC_ngth
);

354 
n
 = 4;

357  
n
;

358 
	}
}

367 
	$bvlc_code_ad_bdt
(

368 
ut8_t
 * 
pdu
)

370 
n
 = 0;

372 i(
pdu
) {

373 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

374 
pdu
[1] = 
BVLC_READ_BROADCAST_DIST_TABLE
;

378 
	`code_unsigd16
(&
pdu
[2], 4);

379 
n
 = 4;

382  
n
;

383 
	}
}

394 
	$bvlc_bbmd_ad_bdt
(

395 
ut32_t
 
bbmd_addss
,

396 
ut16_t
 
bbmd_pt
)

398 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

399 
ut16_t
 
mtu_n
 = 0;

400 
rv
 = 0;

401 
sockaddr_
 
bbmd
 = { 0 };

403 
mtu_n
 = 
	`bvlc_code_ad_bdt
(
mtu
);

404 i(
mtu_n
 > 0) {

405 
bbmd
.
s_addr
.
s_addr
 = 
bbmd_addss
;

406 
bbmd
.
s_pt
 = 
bbmd_pt
;

407 
rv
 = 
	`bvlc_nd_mpdu
(&
bbmd
, &
mtu
[0], 
mtu_n
);

410  
rv
;

411 
	}
}

413 #i
defed
(
BBMD_ENABLED
) && BBMD_ENABLED

421 
	$bvlc_code_ad_bdt_ack_
(

422 
ut8_t
 * 
pdu
,

423 
s
)

425 
n
 = 0;

426 
ut16_t
 
BVLC_ngth
 = 0;

428 i(
pdu
) {

429 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

430 
pdu
[1] = 
BVLC_READ_BROADCAST_DIST_TABLE_ACK
;

434 
BVLC_ngth
 = 4 + (
ut16_t
(
s
 * 10);

435 
	`code_unsigd16
(&
pdu
[2], 
BVLC_ngth
);

436 
n
 = 4;

439  
n
;

440 
	}
}

449 
	$bvlc_code_ad_bdt_ack
(

450 
ut8_t
 * 
pdu
,

451 
ut16_t
 
max_pdu
)

453 
pdu_n
 = 0;

454 
n
 = 0;

455 
cou
 = 0;

456 
i
;

458 
i
 = 0; i < 
MAX_BBMD_ENTRIES
; i++) {

459 i(
BBMD_Tab
[
i
].
vid
) {

460 
cou
++;

463 
n
 = 
	`bvlc_code_ad_bdt_ack_
(&
pdu
[0], 
cou
);

464 
pdu_n
 +
n
;

465 
i
 = 0; i < 
MAX_BBMD_ENTRIES
; i++) {

466 i(
BBMD_Tab
[
i
].
vid
) {

468 i((
pdu_n
 + 10> 
max_pdu
) {

469 
pdu_n
 = 0;

472 
n
 =

473 
	`bvlc_code_addss_y
(&
pdu
[
pdu_n
],

474 &
BBMD_Tab
[
i
].
de_addss
, BBMD_Tab[i].
de_pt
,

475 &
BBMD_Tab
[
i
].
brd_mask
);

476 
pdu_n
 +
n
;

480  
pdu_n
;

481 
	}
}

493 
	$bvlc_code_fwded_du
(

494 
ut8_t
 * 
pdu
,

495 
ut16_t
 
max_pdu
,

496 
sockaddr_
 *
s
,

497 
ut8_t
 * 
du
,

498 
du_ngth
)

500 
n
 = 0;

502 
i
;

504 i(
pdu
 && 
s
 && 
du
) {

505 i((
du_ngth
 + 4 + 6<
max_pdu
) {

506 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

507 
pdu
[1] = 
BVLC_FORWARDED_NPDU
;

511 
	`code_unsigd16
(&
pdu
[2], (
ut16_t
(4 + 6 + 
du_ngth
));

512 
n
 = 4;

514 
n
 +=

515 
	`bvlc_code_b_addss
(&
pdu
[
n
], &
s
->
s_addr
,

516 
s
->
s_pt
);

517 
i
 = 0; i < 
du_ngth
; i++) {

518 
pdu
[
n
] = 
du
[
i
];

519 
n
++;

524  
n
;

525 
	}
}

528 #i
defed
(
BBMD_CLIENT_ENABLED
) && BBMD_CLIENT_ENABLED

535 
	$bvlc_code_ad_fdt
(

536 
ut8_t
 * 
pdu
)

538 
n
 = 0;

540 i(
pdu
) {

541 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

542 
pdu
[1] = 
BVLC_READ_FOREIGN_DEVICE_TABLE
;

546 
	`code_unsigd16
(&
pdu
[2], 4);

547 
n
 = 4;

550  
n
;

551 
	}
}

555 #i
defed
(
BBMD_ENABLED
) && BBMD_ENABLED

563 
	$bvlc_code_ad_fdt_ack_
(

564 
ut8_t
 * 
pdu
,

565 
s
)

567 
n
 = 0;

568 
ut16_t
 
BVLC_ngth
 = 0;

570 i(
pdu
) {

571 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

572 
pdu
[1] = 
BVLC_READ_FOREIGN_DEVICE_TABLE_ACK
;

576 
BVLC_ngth
 = 4 + (
ut16_t
(
s
 * 10);

577 
	`code_unsigd16
(&
pdu
[2], 
BVLC_ngth
);

578 
n
 = 4;

581  
n
;

582 
	}
}

591 
	$bvlc_code_ad_fdt_ack
(

592 
ut8_t
 * 
pdu
,

593 
ut16_t
 
max_pdu
)

595 
pdu_n
 = 0;

596 
n
 = 0;

597 
cou
 = 0;

598 
i
;

599 
ut16_t
 
cds_mag
 = 0;

601 
i
 = 0; i < 
MAX_FD_ENTRIES
; i++) {

602 i(
FD_Tab
[
i
].
vid
) {

603 
cou
++;

606 
n
 = 
	`bvlc_code_ad_fdt_ack_
(&
pdu
[0], 
cou
);

607 
pdu_n
 +
n
;

608 
i
 = 0; i < 
MAX_FD_ENTRIES
; i++) {

609 i(
FD_Tab
[
i
].
vid
) {

611 i((
pdu_n
 + 10> 
max_pdu
) {

612 
pdu_n
 = 0;

615 
n
 =

616 
	`bvlc_code_b_addss
(&
pdu
[
pdu_n
],

617 &
FD_Tab
[
i
].
de_addss
, FD_Tab[i].
de_pt
);

618 
pdu_n
 +
n
;

619 
n
 = 
	`code_unsigd16
(&
pdu
[
pdu_n
], 
FD_Tab
[
i
].
time_to_live
);

620 
pdu_n
 +
n
;

621 
cds_mag
 = (
ut16_t

FD_Tab
[
i
].seconds_remaining;

622 
n
 = 
	`code_unsigd16
(&
pdu
[
pdu_n
], 
cds_mag
);

623 
pdu_n
 +
n
;

627  
pdu_n
;

628 
	}
}

632 #i
defed
(
BBMD_CLIENT_ENABLED
) && BBMD_CLIENT_ENABLED

641 
	$bvlc_code_de_fdt_y
(

642 
ut8_t
 * 
pdu
,

643 
ut32_t
 
addss
,

644 
ut16_t
 
pt
)

646 
n
 = 0;

648 i(
pdu
) {

649 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

650 
pdu
[1] = 
BVLC_DELETE_FOREIGN_DEVICE_TABLE_ENTRY
;

654 
	`code_unsigd16
(&
pdu
[2], 10);

656 
	`code_unsigd32
(&
pdu
[4], 
addss
);

657 
	`code_unsigd16
(&
pdu
[8], 
pt
);

658 
n
 = 10;

661  
n
;

662 
	}
}

665 #i
defed
(
BBMD_CLIENT_ENABLED
) && BBMD_CLIENT_ENABLED

674 
	$bvlc_code_ig_uni_du
(

675 
ut8_t
 * 
pdu
,

676 
ut8_t
 * 
du
,

677 
du_ngth
)

679 
n
 = 0;

680 
i
 = 0;

681 
ut16_t
 
BVLC_ngth
 = 0;

683 i(
pdu
) {

684 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

685 
pdu
[1] = 
BVLC_ORIGINAL_UNICAST_NPDU
;

689 
BVLC_ngth
 = 4 + (
ut16_t

du_ngth
;

690 
n
 = 
	`code_unsigd16
(&
pdu
[2], 
BVLC_ngth
) + 2;

691 
i
 = 0; i < 
du_ngth
; i++) {

692 
pdu
[
n
] = 
du
[
i
];

693 
n
++;

697  
n
;

698 
	}
}

701 #i
defed
(
BBMD_CLIENT_ENABLED
) && BBMD_CLIENT_ENABLED

710 
	$bvlc_code_ig_brd_du
(

711 
ut8_t
 * 
pdu
,

712 
ut8_t
 * 
du
,

713 
du_ngth
)

715 
n
 = 0;

716 
i
 = 0;

717 
ut16_t
 
BVLC_ngth
 = 0;

719 i(
pdu
) {

720 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

721 
pdu
[1] = 
BVLC_ORIGINAL_BROADCAST_NPDU
;

725 
BVLC_ngth
 = 4 + (
ut16_t

du_ngth
;

726 
n
 = 
	`code_unsigd16
(&
pdu
[2], 
BVLC_ngth
) + 2;

727 
i
 = 0; i < 
du_ngth
; i++) {

728 
pdu
[
n
] = 
du
[
i
];

729 
n
++;

733  
n
;

734 
	}
}

737 #i
defed
(
BBMD_ENABLED
) && BBMD_ENABLED

745 
bo
 
	$bvlc__bdt
(

746 
ut8_t
 * 
du
,

747 
ut16_t
 
du_ngth
)

749 
bo
 
us
 = 
l
;

750 
i
 = 0;

751 
ut16_t
 
pdu_offt
 = 0;

753 
i
 = 0; i < 
MAX_BBMD_ENTRIES
; i++) {

754 i(
du_ngth
 >= 10) {

755 
BBMD_Tab
[
i
].
vid
 = 
ue
;

756 
	`memy
(&
BBMD_Tab
[
i
].
de_addss
.
s_addr
, &
du
[
pdu_offt
], 4);

757 
pdu_offt
 += 4;

758 
	`memy
(&
BBMD_Tab
[
i
].
de_pt
, &
du
[
pdu_offt
], 2);

759 
pdu_offt
 += 2;

760 
	`memy
(&
BBMD_Tab
[
i
].
brd_mask
.
s_addr
, &
du
[
pdu_offt
], 4);

761 
pdu_offt
 += 4;

762 
du_ngth
 -= (4 + 2 + 4);

764 
BBMD_Tab
[
i
].
vid
 = 
l
;

765 
BBMD_Tab
[
i
].
de_addss
.
s_addr
 = 0;

766 
BBMD_Tab
[
i
].
de_pt
 = 0;

767 
BBMD_Tab
[
i
].
brd_mask
.
s_addr
 = 0;

771 
	`bvlc_bdt_backup_lol
();

774 i(
du_ngth
 < 10) {

775 
us
 = 
ue
;

778  
us
;

779 
	}
}

788 
bo
 
	$bvlc_gi_feign_devi
(

789 
sockaddr_
 *
s
,

790 
ut16_t
 
time_to_live
)

792 
i
 = 0;

793 
bo
 
us
 = 
l
;

796 
i
 = 0; i < 
MAX_FD_ENTRIES
; i++) {

797 i(
FD_Tab
[
i
].
vid
) {

798 i((
FD_Tab
[
i
].
de_addss
.
s_addr
 =
s
->
s_addr
.s_addr) &&

799 (
FD_Tab
[
i
].
de_pt
 =
s
->
s_pt
)) {

800 
us
 = 
ue
;

801 
FD_Tab
[
i
].
time_to_live
 =ime_to_live;

806 
FD_Tab
[
i
].
cds_mag
 = 
time_to_live
 + 30;

811 i(!
us
) {

812 
i
 = 0; i < 
MAX_FD_ENTRIES
; i++) {

813 i(!
FD_Tab
[
i
].
vid
) {

814 
FD_Tab
[
i
].
de_addss
.
s_addr
 = 
s
->
s_addr
.s_addr;

815 
FD_Tab
[
i
].
de_pt
 = 
s
->
s_pt
;

816 
FD_Tab
[
i
].
time_to_live
 =ime_to_live;

817 
FD_Tab
[
i
].
cds_mag
 = 
time_to_live
 + 30;

818 
FD_Tab
[
i
].
vid
 = 
ue
;

819 
us
 = 
ue
;

826  
us
;

827 
	}
}

835 
bo
 
	$bvlc_de_feign_devi
(

836 
ut8_t
 * 
pdu
,

837 
ut16_t
 
pdu_n
)

839 
sockaddr_
 
s
 = { 0 };

840 
bo
 
us
 = 
l
;

841 
i
 = 0;

843 i(
pdu_n
 < 6) {

844  
us
;

846 
	`bvlc_decode_b_addss
(
pdu
, &
s
.
s_addr
, &s.
s_pt
);

847 
i
 = 0; i < 
MAX_FD_ENTRIES
; i++) {

848 i(
FD_Tab
[
i
].
vid
) {

849 i((
FD_Tab
[
i
].
de_addss
.
s_addr
 =
s
.
s_addr
.s_addr) &&

850 (
FD_Tab
[
i
].
de_pt
 =
s
.
s_pt
)) {

851 
FD_Tab
[
i
].
vid
 = 
l
;

852 
FD_Tab
[
i
].
cds_mag
 = 0;

853 
us
 = 
ue
;

858  
us
;

859 
	}
}

874 
	$bvlc_nd_mpdu
(

875 
sockaddr_
 *
de
,

876 
ut8_t
 * 
mtu
,

877 
ut16_t
 
mtu_n
)

879 
sockaddr_
 
bvlc_de
 = { 0 };

882 i(
	`b_sock
() < 0) {

886 
bvlc_de
.
s_my
 = 
AF_INET
;

887 
bvlc_de
.
s_addr
.
s_addr
 = 
de
->sin_addr.s_addr;

888 
bvlc_de
.
s_pt
 = 
de
->sin_port;

889 
	`memt
(&(
bvlc_de
.
s_zo
), '\0', 8);

891  
	`ndto
(
	`b_sock
(), (*
mtu
, 
mtu_n
, 0,

892 (
sockaddr
 *&
bvlc_de
, (sockaddr));

893 
	}
}

895 #i
defed
(
BBMD_ENABLED
) && BBMD_ENABLED

904 
	$bvlc_bdt_fwd_du
(

905 
sockaddr_
 *
s
,

906 
ut8_t
 * 
du
,

907 
ut16_t
 
du_ngth
,

908 
bo
 
ig
)

910 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

911 
ut16_t
 
mtu_n
 = 0;

912 
i
 = 0;

913 
sockaddr_
 
b_de
 = { 0 };

923 if(
BVLC_NAT_Hdlg
 && 
ig
) {

924 
sockaddr_
 
t_addr
 = *
s
;

925 
t_addr
.
s_addr
 = 
BVLC_Glob_Addss
;

926 
mtu_n
 = (
ut16_t

	`bvlc_code_fwded_du
(&
mtu
[0],

927 (
ut16_t
)(
mtu
), &
t_addr
, 
du
, 
du_ngth
);

930 
mtu_n
 = (
ut16_t

	`bvlc_code_fwded_du
(&
mtu
[0],

931 (
ut16_t
)(
mtu
), 
s
, 
du
, 
du_ngth
);

934 
i
 = 0; i < 
MAX_BBMD_ENTRIES
; i++) {

935 i(
BBMD_Tab
[
i
].
vid
) {

940 
b_de
.
s_addr
.
s_addr
 =

941 ((~
BBMD_Tab
[
i
].
brd_mask
.

942 
s_addr
| 
BBMD_Tab
[
i
].
de_addss
.s_addr);

943 
b_de
.
s_pt
 = 
BBMD_Tab
[
i
].
de_pt
;

945 i((
b_de
.
s_addr
.
s_addr
 =
	`b_g_brd_addr
())

946 && (
b_de
.
s_pt
 =
	`b_g_pt
())) {

950 i((
b_de
.
s_addr
.
s_addr
 =
	`b_g_addr
()) &&

951 (
b_de
.
s_pt
 =
	`b_g_pt
())) {

958 i(
BVLC_NAT_Hdlg
 &&

959 (
b_de
.
s_addr
.
s_addr
 =
BVLC_Glob_Addss
.s_addr) &&

960 (
b_de
.
s_pt
 =
	`b_g_pt
())) {

963 
	`bvlc_nd_mpdu
(&
b_de
, 
mtu
, 
mtu_n
);

964 
	`debug_tf
("BVLC: BDT Sent Forwarded-NPDUo %s:%04X\n",

965 
	`_
(
b_de
.
s_addr
), 
	`ohs
(b_de.
s_pt
));

970 
	}
}

980 
	$bvlc_fwd_du
(

981 
sockaddr_
 *
s
,

982 
ut8_t
 * 
du
,

983 
ut16_t
 
du_ngth
)

985 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

986 
ut16_t
 
mtu_n
 = 0;

987 
sockaddr_
 
b_de
 = { 0 };

989 
mtu_n
 =

990 (
ut16_t

	`bvlc_code_fwded_du
(&
mtu
[0],

991 (
ut16_t
)(
mtu
), 
s
, 
du
, 
du_ngth
);

992 
b_de
.
s_addr
.
s_addr
 = 
	`b_g_brd_addr
();

993 
b_de
.
s_pt
 = 
	`b_g_pt
();

994 
	`bvlc_nd_mpdu
(&
b_de
, 
mtu
, 
mtu_n
);

995 
	`debug_tf
("BVLC: Sent Forwarded-NPDUsocal broadcast.\n");

996 
	}
}

1006 
	$bvlc_fdt_fwd_du
(

1007 
sockaddr_
 *
s
,

1008 
ut8_t
 * 
du
,

1009 
ut16_t
 
du_ngth
,

1010 
bo
 
ig
)

1012 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

1013 
ut16_t
 
mtu_n
 = 0;

1014 
i
 = 0;

1015 
sockaddr_
 
b_de
 = { 0 };

1025 if(
BVLC_NAT_Hdlg
 && 
ig
) {

1026 
sockaddr_
 
t_addr
 = *
s
;

1027 
t_addr
.
s_addr
 = 
BVLC_Glob_Addss
;

1028 
mtu_n
 = (
ut16_t
)
	`bvlc_code_fwded_du
(&
mtu
[0],

1029 (
ut16_t
)(
mtu
), &
t_addr
, 
du
, 
du_ngth
);

1031 
mtu_n
 = (
ut16_t
)
	`bvlc_code_fwded_du
(&
mtu
[0],

1032 (
ut16_t
)(
mtu
), 
s
, 
du
, 
du_ngth
);

1036 
i
 = 0; i < 
MAX_FD_ENTRIES
; i++) {

1037 i(
FD_Tab
[
i
].
vid
 && FD_Tab[i].
cds_mag
) {

1038 
b_de
.
s_addr
.
s_addr
 = 
FD_Tab
[
i
].
de_addss
.s_addr;

1039 
b_de
.
s_pt
 = 
FD_Tab
[
i
].
de_pt
;

1041 i((
b_de
.
s_addr
.
s_addr
 =
	`b_g_addr
()) &&

1042 (
b_de
.
s_pt
 =
	`b_g_pt
())) {

1046 i((
b_de
.
s_addr
.
s_addr
 =
s
->sin_addr.s_addr) &&

1047 (
b_de
.
s_pt
 =
s
->sin_port)) {

1054 i(
BVLC_NAT_Hdlg
 &&

1055 (
b_de
.
s_addr
.
s_addr
 =
BVLC_Glob_Addss
.s_addr) &&

1056 (
b_de
.
s_pt
 =
	`b_g_pt
())) {

1059 
	`bvlc_nd_mpdu
(&
b_de
, 
mtu
, 
mtu_n
);

1060 
	`debug_tf
("BVLC: FDT Sent Forwarded-NPDUo %s:%04X\n",

1061 
	`_
(
b_de
.
s_addr
), 
	`ohs
(b_de.
s_pt
));

1066 
	}
}

1077 
	$bvlc_nd_su
(

1078 
sockaddr_
 *
de
,

1079 
BACNET_BVLC_RESULT
 
su_code
)

1081 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

1082 
ut16_t
 
mtu_n
 = 0;

1084 
mtu_n
 = (
ut16_t

	`bvlc_code_bvlc_su
(&
mtu
[0], 
su_code
);

1085 i(
mtu_n
) {

1086 
	`bvlc_nd_mpdu
(
de
, 
mtu
, 
mtu_n
);

1089  
mtu_n
;

1090 
	}
}

1092 #i
defed
(
BBMD_ENABLED
) && BBMD_ENABLED

1099 
	$bvlc_nd_bdt
(

1100 
sockaddr_
 *
de
)

1102 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

1103 
ut16_t
 
mtu_n
 = 0;

1105 
mtu_n
 = (
ut16_t

	`bvlc_code_ad_bdt_ack
(&
mtu
[0], (mtu));

1106 i(
mtu_n
) {

1107 
	`bvlc_nd_mpdu
(
de
, &
mtu
[0], 
mtu_n
);

1110  
mtu_n
;

1111 
	}
}

1119 
	$bvlc_nd_fdt
(

1120 
sockaddr_
 *
de
)

1122 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

1123 
ut16_t
 
mtu_n
 = 0;

1125 
mtu_n
 = (
ut16_t

	`bvlc_code_ad_fdt_ack
(&
mtu
[0], (mtu));

1126 i(
mtu_n
) {

1127 
	`bvlc_nd_mpdu
(
de
, &
mtu
[0], 
mtu_n
);

1130  
mtu_n
;

1131 
	}
}

1139 
bo
 
	$bvlc_bdt_memb_mask_is_uni
(

1140 
sockaddr_
 *
s
)

1142 
bo
 
uni
 = 
l
;

1143 
i
 = 0;

1145 
i
 = 0; i < 
MAX_BBMD_ENTRIES
; i++) {

1146 i(
BBMD_Tab
[
i
].
vid
) {

1149 i((
BBMD_Tab
[
i
].
de_addss
.
s_addr
 =
	`b_g_addr
()) &&

1150 (
BBMD_Tab
[
i
].
de_pt
 =
	`b_g_pt
())) {

1155 i((
BBMD_Tab
[
i
].
de_addss
.
s_addr
 =
s
->
s_addr
.s_addr) &&

1156 (
BBMD_Tab
[
i
].
de_pt
 =
s
->
s_pt
)) {

1158 i(
BBMD_Tab
[
i
].
brd_mask
.
s_addr
 == 0xFFFFFFFFL) {

1159 
uni
 = 
ue
;

1166  
uni
;

1167 
	}
}

1178 
ut16_t
 
	$bvlc_ive
(

1179 
BACNET_ADDRESS
 * 
c
,

1180 
ut8_t
 * 
du
,

1181 
ut16_t
 
max_du
,

1182 
timeout
)

1184 
ut16_t
 
du_n
 = 0;

1185 
fd_t
 
ad_fds
;

1186 
max
 = 0;

1187 
timev
 
_timeout
;

1188 
sockaddr_
 
s
 = { 0 };

1189 
sockaddr_
 
ig_s
 = { 0 };

1190 
sockaddr_
 
de
 = { 0 };

1191 
sockn_t
 
s_n
 = (
s
);

1192 
ived_bys
 = 0;

1193 
ut16_t
 
su_code
 = 0;

1194 
ut16_t
 
i
 = 0;

1195 
bo
 
us
 = 
l
;

1196 
ut16_t
 
time_to_live
 = 0;

1199 i(
	`b_sock
() < 0) {

1206 i(
timeout
 >= 1000) {

1207 
_timeout
.
tv_c
 = 
timeout
 / 1000;

1208 
_timeout
.
tv_uc
 =

1209 1000 * (
timeout
 - 
_timeout
.
tv_c
 * 1000);

1211 
_timeout
.
tv_c
 = 0;

1212 
_timeout
.
tv_uc
 = 1000 * 
timeout
;

1214 
	`FD_ZERO
(&
ad_fds
);

1215 
	`FD_SET
(
	`b_sock
(), &
ad_fds
);

1216 
max
 = 
	`b_sock
();

1218 i(
	`
(
max
 + 1, &
ad_fds
, 
NULL
, NULL, &
_timeout
) > 0) {

1219 
ived_bys
 =

1220 
	`cvom
(
	`b_sock
(), (*&
du
[0], 
max_du
, 0,

1221 (
sockaddr
 *&
s
, &
s_n
);

1226 i(
ived_bys
 < 0) {

1230 i(
ived_bys
 == 0) {

1234 i(
du
[0] !
BVLL_TYPE_BACNET_IP
) {

1237 
BVLC_Funi_Code
 = 
du
[1];

1239 (
	`decode_unsigd16
(&
du
[2], &
du_n
);

1240 i((
du_n
 < 4|| (du_> (
max_du
-4))) {

1244 
du_n
 -= 4;

1245 
BVLC_Funi_Code
) {

1246 
BVLC_RESULT
:

1255 (
	`decode_unsigd16
(&
du
[4], &
su_code
);

1256 
BVLC_Resu_Code
 = (
BACNET_BVLC_RESULT

su_code
;

1257 
	`debug_tf
("BVLC: Resu Code=%d\n", 
BVLC_Resu_Code
);

1259 
du_n
 = 0;

1261 
BVLC_WRITE_BROADCAST_DISTRIBUTION_TABLE
:

1262 
	`debug_tf
("BVLC: Received Write-BDT.\n");

1271 
us
 = 
	`bvlc__bdt
(&
du
[4], 
du_n
);

1272 i(
us
) {

1273 
	`bvlc_nd_su
(&
s
, 
BVLC_RESULT_SUCCESSFUL_COMPLETION
);

1275 
	`bvlc_nd_su
(&
s
,

1276 
BVLC_RESULT_WRITE_BROADCAST_DISTRIBUTION_TABLE_NAK
);

1279 
du_n
 = 0;

1281 
BVLC_READ_BROADCAST_DIST_TABLE
:

1282 
	`debug_tf
("BVLC: Received Read-BDT.\n");

1290 i(
	`bvlc_nd_bdt
(&
s
) <= 0) {

1291 
	`bvlc_nd_su
(&
s
,

1292 
BVLC_RESULT_READ_BROADCAST_DISTRIBUTION_TABLE_NAK
);

1295 
du_n
 = 0;

1297 
BVLC_READ_BROADCAST_DIST_TABLE_ACK
:

1298 
	`debug_tf
("BVLC: Received Read-BDT-Ack.\n");

1301 
du_n
 = 0;

1303 
BVLC_FORWARDED_NPDU
:

1322 i(
du_n
 < 6) {

1326 
	`bvlc_decode_b_addss
(&
du
[4], &
ig_s
.
s_addr
,

1327 &
ig_s
.
s_pt
);

1328 
	`debug_tf
("BVLC: Received Forwarded-NPDU from %s:%04X.\n",

1329 
	`_
(
ig_s
.
s_addr
), 
	`ohs
(ig_s.
s_pt
));

1330 
du_n
 -= 6;

1332 i(
	`bvlc_bdt_memb_mask_is_uni
(&
s
)) {

1333 
de
.
s_addr
.
s_addr
 = 
	`b_g_brd_addr
();

1334 
de
.
s_pt
 = 
	`b_g_pt
();

1335 
	`debug_tf
("BVLC: Received unicast from BDT member,e-broadcastingocallyo %s:%04X.\n",

1336 
	`_
(
de
.
s_addr
), 
	`ohs
(de.
s_pt
));

1337 
	`bvlc_nd_mpdu
(&
de
, &
du
[0], 
du_n
+4+6);

1340 
de
.
s_addr
.
s_addr
 = 
ig_s
.sin_addr.s_addr;

1341 
de
.
s_pt
 = 
ig_s
.sin_port;

1342 
	`bvlc_fdt_fwd_du
(&
de
, &
du
[4 + 6], 
du_n
, 
l
);

1343 
	`debug_tf
("BVLC: Received Forwarded-NPDU from %s:%04X.\n",

1344 
	`_
(
de
.
s_addr
), 
	`ohs
(de.
s_pt
));

1345 
	`bvlc__to_ba_addss
(
c
, &
de
);

1346 i(
du_n
 < 
max_du
) {

1348 
i
 = 0; i < 
du_n
; i++) {

1349 
du
[
i
] =pdu[4 + 6 + i];

1354 
du_n
 = 0;

1357 
BVLC_REGISTER_FOREIGN_DEVICE
:

1367 i(
du_n
 < 2) {

1370 (
	`decode_unsigd16
(&
du
[4], &
time_to_live
);

1371 i(
	`bvlc_gi_feign_devi
(&
s
, 
time_to_live
)) {

1372 
	`bvlc_nd_su
(&
s
, 
BVLC_RESULT_SUCCESSFUL_COMPLETION
);

1373 
	`debug_tf
("BVLC: Registered Foreign Device.\n");

1375 
	`bvlc_nd_su
(&
s
,

1376 
BVLC_RESULT_REGISTER_FOREIGN_DEVICE_NAK
);

1377 
	`debug_tf
("BVLC: Failedo Register Foreign Device.\n");

1380 
du_n
 = 0;

1382 
BVLC_READ_FOREIGN_DEVICE_TABLE
:

1383 
	`debug_tf
("BVLC: Received Read-FDT.\n");

1391 i(
	`bvlc_nd_fdt
(&
s
) <= 0) {

1392 
	`bvlc_nd_su
(&
s
,

1393 
BVLC_RESULT_READ_FOREIGN_DEVICE_TABLE_NAK
);

1396 
du_n
 = 0;

1398 
BVLC_READ_FOREIGN_DEVICE_TABLE_ACK
:

1399 
	`debug_tf
("BVLC: Received Read-FDT-Ack.\n");

1402 
du_n
 = 0;

1404 
BVLC_DELETE_FOREIGN_DEVICE_TABLE_ENTRY
:

1405 
	`debug_tf
("BVLC: Received Delete-FDT-Entry.\n");

1414 i(
	`bvlc_de_feign_devi
(&
du
[4], 
du_n
)) {

1415 
	`bvlc_nd_su
(&
s
, 
BVLC_RESULT_SUCCESSFUL_COMPLETION
);

1417 
	`bvlc_nd_su
(&
s
,

1418 
BVLC_RESULT_DELETE_FOREIGN_DEVICE_TABLE_ENTRY_NAK
);

1421 
du_n
 = 0;

1423 
BVLC_DISTRIBUTE_BROADCAST_TO_NETWORK
:

1424 
debug_tf


1426 
	`_
(
s
.
s_addr
), 
	`ohs
(s.
s_pt
));

1439 
	`bvlc_fwd_du
(&
s
, &
du
[4], 
du_n
);

1440 
	`bvlc_bdt_fwd_du
(&
s
, &
du
[4], 
du_n
, 
l
);

1441 
	`bvlc_fdt_fwd_du
(&
s
, &
du
[4], 
du_n
, 
l
);

1443 
du_n
 = 0;

1445 
BVLC_ORIGINAL_UNICAST_NPDU
:

1446 
	`debug_tf
("BVLC: Received Original-Unicast-NPDU.\n");

1447 i((
s
.
s_addr
.
s_addr
 =
	`b_g_addr
()) &&

1448 (
s
.
s_pt
 =
	`b_g_pt
())) {

1450 
du_n
 = 0;

1451 } i(
BVLC_NAT_Hdlg
 &&

1452 (
s
.
s_addr
.
s_addr
 =
BVLC_Glob_Addss
.s_addr) &&

1453 (
s
.
s_pt
 =
	`b_g_pt
())) {

1456 
du_n
 = 0;

1458 
	`bvlc__to_ba_addss
(
c
, &
s
);

1459 i(
du_n
 < 
max_du
) {

1461 
i
 = 0; i < 
du_n
; i++) {

1462 
du
[
i
] =pdu[4 + i];

1467 
du_n
 = 0;

1471 
BVLC_ORIGINAL_BROADCAST_NPDU
:

1472 
	`debug_tf
("BVLC: Received Original-Broadcast-NPDU.\n");

1486 
	`bvlc__to_ba_addss
(
c
, &
s
);

1487 i(
du_n
 < 
max_du
) {

1489 
i
 = 0; i < 
du_n
; i++) {

1490 
du
[
i
] =pdu[4 + i];

1493 
	`bvlc_bdt_fwd_du
(&
s
, &
du
[0], 
du_n
, 
ue
);

1494 
	`bvlc_fdt_fwd_du
(&
s
, &
du
[0], 
du_n
, 
ue
);

1497 
du_n
 = 0;

1504  
du_n
;

1505 
	}
}

1516 
	$bvlc_nd_pdu
(

1517 
BACNET_ADDRESS
 * 
de
,

1518 
BACNET_NPDU_DATA
 * 
du_da
,

1519 
ut8_t
 * 
pdu
,

1520 
pdu_n
)

1522 
sockaddr_
 
bvlc_de
 = { 0 };

1523 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

1524 
ut16_t
 
mtu_n
 = 0;

1526 
_addr
 
addss
;

1527 
ut16_t
 
pt
 = 0;

1528 
ut16_t
 
BVLC_ngth
 = 0;

1531 (
du_da
;

1532 
mtu
[0] = 
BVLL_TYPE_BACNET_IP
;

1536 i((
de
->
t
 =
BACNET_BROADCAST_NETWORK
|| (de->
mac_n
 == 0)) {

1538 i(
Reme_BBMD
.
s_pt
) {

1539 
mtu
[1] = 
BVLC_DISTRIBUTE_BROADCAST_TO_NETWORK
;

1540 
addss
.
s_addr
 = 
Reme_BBMD
.
s_addr
.s_addr;

1541 
pt
 = 
Reme_BBMD
.
s_pt
;

1542 
	`debug_tf
("BVLC: Sent Distribute-Broadcast-to-Network.\n");

1544 
addss
.
s_addr
 = 
	`b_g_brd_addr
();

1545 
pt
 = 
	`b_g_pt
();

1546 
mtu
[1] = 
BVLC_ORIGINAL_BROADCAST_NPDU
;

1547 
	`debug_tf
("BVLC: Sent Original-Broadcast-NPDU.\n");

1549 } i((
de
->
t
 > 0&& (de->
n
 == 0)) {

1551 i(
de
->
mac_n
 == 6) {

1553 
	`bvlc_decode_b_addss
(&
de
->
mac
[0], &
addss
, &
pt
);

1555 
addss
.
s_addr
 = 
	`b_g_brd_addr
();

1556 
pt
 = 
	`b_g_pt
();

1558 
mtu
[1] = 
BVLC_ORIGINAL_BROADCAST_NPDU
;

1559 
	`debug_tf
("BVLC: Sent Original-Broadcast-NPDU.\n");

1560 } i(
de
->
mac_n
 == 6) {

1562 
	`bvlc_decode_b_addss
(&
de
->
mac
[0], &
addss
, &
pt
);

1563 
mtu
[1] = 
BVLC_ORIGINAL_UNICAST_NPDU
;

1564 
	`debug_tf
("BVLC: Sent Original-Unicast-NPDU.\n");

1569 
bvlc_de
.
s_addr
.
s_addr
 = 
addss
.s_addr;

1570 
bvlc_de
.
s_pt
 = 
pt
;

1571 
BVLC_ngth
 = (
ut16_t

pdu_n
 + 4 ;

1572 
mtu_n
 = 2;

1573 
mtu_n
 +(
ut16_t

	`code_unsigd16
(&
mtu
[mtu_n], 
BVLC_ngth
);

1574 
	`memy
(&
mtu
[
mtu_n
], 
pdu
, 
pdu_n
);

1575 
mtu_n
 +(
ut16_t

pdu_n
;

1576  
	`bvlc_nd_mpdu
(&
bvlc_de
, 
mtu
, 
mtu_n
);

1577 
	}
}

1593 
	$bvlc_code_gi_feign_devi
(

1594 
ut8_t
 * 
pdu
,

1595 
ut16_t
 
time_to_live_cds
)

1597 
n
 = 0;

1599 i(
pdu
) {

1600 
pdu
[0] = 
BVLL_TYPE_BACNET_IP
;

1601 
pdu
[1] = 
BVLC_REGISTER_FOREIGN_DEVICE
;

1605 
	`code_unsigd16
(&
pdu
[2], 6);

1606 
	`code_unsigd16
(&
pdu
[4], 
time_to_live_cds
);

1607 
n
 = 6;

1610  
n
;

1611 
	}
}

1622 
	$bvlc_gi_wh_bbmd
(

1623 
ut32_t
 
bbmd_addss
,

1624 
ut16_t
 
bbmd_pt
,

1625 
ut16_t
 
time_to_live_cds
)

1627 
ut8_t
 
mtu
[
MAX_MPDU
] = { 0 };

1628 
ut16_t
 
mtu_n
 = 0;

1629 
tv
 = 0;

1633 
Reme_BBMD
.
s_addr
.
s_addr
 = 
bbmd_addss
;

1634 
Reme_BBMD
.
s_pt
 = 
bbmd_pt
;

1639 
mtu_n
 =

1640 (
ut16_t

	`bvlc_code_gi_feign_devi
(&
mtu
[0],

1641 
time_to_live_cds
);

1642 
tv
 = 
	`bvlc_nd_mpdu
(&
Reme_BBMD
, &
mtu
[0], 
mtu_n
);

1643  
tv
;

1644 
	}
}

1657 
	$bvlc_f_n_bbmd
(

1658 
sockaddr_
 *
sout
,

1659 
ut8_t
 * 
du
,

1660 
ut16_t
 
ived_bys
)

1662 
ut16_t
 
su_code
 = 0;

1664 
BVLC_Funi_Code
 = 
du
[1];

1665 
BVLC_Funi_Code
) {

1666 
BVLC_RESULT
:

1667 i(
ived_bys
 >= 6) {

1669 (
	`decode_unsigd16
(&
du
[4], &
su_code
);

1670 
BVLC_Resu_Code
 = (
BACNET_BVLC_RESULT

su_code
;

1671 
	`debug_tf
("BVLC: Resu Code=%d\n", 
BVLC_Resu_Code
);

1673 
su_code
 = 0;

1676 
BVLC_WRITE_BROADCAST_DISTRIBUTION_TABLE
:

1677 
su_code
 = 
BVLC_RESULT_WRITE_BROADCAST_DISTRIBUTION_TABLE_NAK
;

1679 
BVLC_READ_BROADCAST_DIST_TABLE
:

1680 
su_code
 = 
BVLC_RESULT_READ_BROADCAST_DISTRIBUTION_TABLE_NAK
;

1683 
BVLC_REGISTER_FOREIGN_DEVICE
:

1684 
su_code
 = 
BVLC_RESULT_REGISTER_FOREIGN_DEVICE_NAK
;

1686 
BVLC_READ_FOREIGN_DEVICE_TABLE
:

1687 
su_code
 = 
BVLC_RESULT_READ_FOREIGN_DEVICE_TABLE_NAK
;

1690 
BVLC_DELETE_FOREIGN_DEVICE_TABLE_ENTRY
:

1691 
su_code
 = 
BVLC_RESULT_DELETE_FOREIGN_DEVICE_TABLE_ENTRY_NAK
;

1693 
BVLC_DISTRIBUTE_BROADCAST_TO_NETWORK
:

1694 
su_code
 = 
BVLC_RESULT_DISTRIBUTE_BROADCAST_TO_NETWORK_NAK
;

1702 i(
su_code
 > 0) {

1703 
	`bvlc_nd_su
(
sout
, 
su_code
);

1704 
	`debug_tf
("BVLC: NAK code=%d\n", 
su_code
);

1707  
su_code
;

1708 
	}
}

1718 
BACNET_BVLC_RESULT
 
	$bvlc_g_ϡ_su
(

1721  
BVLC_Resu_Code
;

1722 
	}
}

1731 
BACNET_BVLC_FUNCTION
 
	$bvlc_g_funi_code
(

1734  
BVLC_Funi_Code
;

1735 
	}
}

1747 
	$bvlc_g_bdt_lol
(

1748 cڡ 
BBMD_TABLE_ENTRY
** 
b
)

1750 
cou
 = 0;

1752 if(
b
 =
NULL
)

1755 *
b
 = 
BBMD_Tab
;

1757 
cou
 = 0; cou < 
MAX_BBMD_ENTRIES
; ++count) {

1758 i(!
BBMD_Tab
[
cou
].
vid
) {

1763  
cou
;

1764 
	}
}

1768 
	$bvlc_r_bdt_lol
(

1771 
i
 = 0;

1772 
i
 = 0; i < 
MAX_BBMD_ENTRIES
; ++i) {

1773 
BBMD_Tab
[
i
].
vid
 = 
l
;

1774 
BBMD_Tab
[
i
].
de_addss
.
s_addr
 = 0;

1775 
BBMD_Tab
[
i
].
de_pt
 = 0;

1776 
BBMD_Tab
[
i
].
brd_mask
.
s_addr
 = 0;

1779 
	`bvlc_bdt_backup_lol
();

1780 
	}
}

1786 
bo
 
	$bvlc_add_bdt_y_lol
(

1787 
BBMD_TABLE_ENTRY
* 
y
)

1789 
bo
 
found
 = 
l
;

1790 
i
 = 0;

1792 if(
y
 =
NULL
)

1793  
l
;

1796 
i
 = 0; i < 
MAX_BBMD_ENTRIES
; ++i) {

1797 i(!
BBMD_Tab
[
i
].
vid
) {

1798 
found
 = 
ue
;

1803 if(
BBMD_Tab
[
i
].
de_addss
.
s_addr
 =
y
->dest_address.s_addr &&

1804 
BBMD_Tab
[
i
].
brd_mask
.
s_addr
 =
y
->broadcast_mask.s_addr &&

1805 
BBMD_Tab
[
i
].
de_pt
 =
y
->dest_port) {

1806  
l
;

1810 if(!
found
)

1811  
l
;

1814 
BBMD_Tab
[
i
] = *
y
;

1815 
BBMD_Tab
[
i
].
vid
 = 
ue
;

1817 
	`bvlc_bdt_backup_lol
();

1819  
ue
;

1820 
	}
}

1825 
	$bvlc_t_glob_addss_f_t
(cڡ 
_addr
* 
addr
)

1827 
BVLC_Glob_Addss
 = *
addr
;

1828 
BVLC_NAT_Hdlg
 = 
ue
;

1829 
	}
}

1833 
	$bvlc_dib_t
()

1835 
BVLC_NAT_Hdlg
 = 
l
;

1836 
BVLC_Glob_Addss
.
s_addr
 = 0;

1837 
	}
}

1840 #ifde
TEST


1841 
	~<as.h
>

1842 
	~<rg.h
>

1843 
	~"e.h
"

1847 
	$bvlc_ba_to__addss
(

1848 
sockaddr_
 *
s
,

1849 
BACNET_ADDRESS
 * 
c
)

1852 i(
c
 && 
s
) {

1853 i(
c
->
mac_n
 == 6) {

1854 
	`memy
(&
s
->
s_addr
.
s_addr
, &
c
->
mac
[0], 4);

1855 
	`memy
(&
s
->
s_pt
, &
c
->
mac
[4], 2);

1860 
	}
}

1862 
	$BIPAddss
(

1863 
Te
 * 
pTe
)

1865 
ut8_t
 
du
[50] = { 0 };

1866 
ut32_t
 
vue
 = 0, 
_vue
 = 0;

1867 
n
 = 0, 
_n
 = 0;

1868 
_addr
 
addss
;

1869 
_addr
 
_addss
;

1870 
ut16_t
 
pt
 = 0, 
_pt
 = 0;

1872 
addss
.
s_addr
 = 42;

1873 
n
 = 
	`bvlc_code_b_addss
(&
du
[0], &
addss
, 
pt
);

1874 
_n
 = 
	`bvlc_decode_b_addss
(&
du
[0], &
_addss
, &
_pt
);

1875 
	`_
(
pTe
, 
n
 =
_n
);

1876 
	`_
(
pTe
, 
addss
.
s_addr
 =
_addss
.s_addr);

1877 
	`_
(
pTe
, 
pt
 =
_pt
);

1878 
	}
}

1880 
	$ItAddss
(

1881 
Te
 * 
pTe
)

1883 
BACNET_ADDRESS
 
c
;

1884 
BACNET_ADDRESS
 
_c
;

1885 
sockaddr_
 
s
 = { 0 };

1886 
sockaddr_
 
_s
 = { 0 };

1888 
s
.
s_pt
 = 
	`hts
(0xBAC0);

1889 
s
.
s_addr
.
s_addr
 = 
	`_addr
("192.168.0.1");

1890 
	`bvlc__to_ba_addss
(&
c
, &
s
);

1891 
	`bvlc_ba_to__addss
(&
_s
, &
c
);

1892 
	`_
(
pTe
, 
s
.
s_pt
 =
_s
.sin_port);

1893 
	`_
(
pTe
, 
s
.
s_addr
.
s_addr
 =
_s
.sin_addr.s_addr);

1894 
	}
}

1896 #ifde
TEST_BVLC


1897 
	$ma
(

1900 
Te
 *
pTe
;

1901 
bo
 
rc
;

1903 
pTe
 = 
	`_
("BACÈVtu Lk Cڌ", 
NULL
);

1905 
rc
 = 
	`_addTeFuni
(
pTe
, 
BIPAddss
);

1906 
	`as
(
rc
);

1907 
rc
 = 
	`_addTeFuni
(
pTe
, 
ItAddss
);

1908 
	`as
(
rc
);

1910 
	`_tSm
(
pTe
, 
dout
);

1911 
	`_run
(
pTe
);

1912 (
	`_pt
(
pTe
);

1913 
	`_deroy
(
pTe
);

1916 
	}
}

	@src/bvlc6.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~<time.h
>

38 
	~"banum.h
"

39 
	~"bacdcode.h
"

40 
	~"bact.h
"

41 
	~"bvlc6.h
"

42 #ide
DEBUG_ENABLED


43 
	#DEBUG_ENABLED
 0

	)

45 
	~"debug.h
"

56 
	$bvlc6_code_hd
(

57 
ut8_t
 * 
pdu
,

58 
ut16_t
 
pdu_size
,

59 
ut8_t
 
mesge_ty
,

60 
ut16_t
 
ngth
)

62 
bys_coded
 = 0;

64 i(
pdu
 && (
pdu_size
 >= 2)) {

65 
pdu
[0] = 
BVLL_TYPE_BACNET_IP6
;

66 
pdu
[1] = 
mesge_ty
;

70 
	`code_unsigd16
(&
pdu
[2], 
ngth
);

71 
bys_coded
 = 4;

74  
bys_coded
;

75 
	}
}

86 
	$bvlc6_decode_hd
(

87 
ut8_t
 * 
pdu
,

88 
ut16_t
 
pdu_n
,

89 
ut8_t
 * 
mesge_ty
,

90 
ut16_t
 * 
ngth
)

92 
bys_csumed
 = 0;

94 i(
pdu
 && (
pdu_n
 >= 4)) {

95 i(
pdu
[0] =
BVLL_TYPE_BACNET_IP6
) {

96 i(
mesge_ty
) {

97 *
mesge_ty
 = 
pdu
[1];

99 i(
ngth
) {

100 
	`decode_unsigd16
(&
pdu
[2], 
ngth
);

102 
bys_csumed
 = 4;

106  
bys_csumed
;

107 
	}
}

133 
	$bvlc6_code_su
(

134 
ut8_t
 * 
pdu
,

135 
ut16_t
 
pdu_size
,

136 
ut32_t
 
vmac
,

137 
ut16_t
 
su_code
)

139 
bys_coded
 = 0;

140 cڡ 
ut16_t
 
ngth
 = 9;

142 i(
pdu
 && (
pdu_size
 >9&& (
vmac
 <= 0xFFFFFF)) {

143 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

144 
BVLC6_RESULT
, 
ngth
);

145 i(
bys_coded
 == 4) {

146 
	`code_unsigd24
(&
pdu
[4], 
vmac
);

147 
	`code_unsigd16
(&
pdu
[7], 
su_code
);

148 
bys_coded
 = ()
ngth
;

152  
bys_coded
;

153 
	}
}

164 
	$bvlc6_decode_su
(

165 
ut8_t
 * 
pdu
,

166 
ut16_t
 
pdu_n
,

167 
ut32_t
 * 
vmac
,

168 
ut16_t
 * 
su_code
)

170 
bys_csumed
 = 0;

172 i(
pdu
 && (
pdu_n
 >= 5)) {

173 i(
vmac
) {

174 
	`decode_unsigd24
(&
pdu
[0], 
vmac
);

176 i(
su_code
) {

177 
	`decode_unsigd16
(&
pdu
[3], 
su_code
);

179 
bys_csumed
 = 5;

182  
bys_csumed
;

183 
	}
}

206 
	$bvlc6_code_ig_uni
(

207 
ut8_t
 * 
pdu
,

208 
ut16_t
 
pdu_size
,

209 
ut32_t
 
vmac_c
,

210 
ut32_t
 
vmac_d
,

211 
ut8_t
 * 
du
,

212 
ut16_t
 
du_n
)

214 
bys_coded
 = 0;

215 
ut16_t
 
ngth
 = 10;

216 
ut16_t
 
i
 = 0;

219 
ngth
 +
du_n
;

220 i(
pdu
 &&

221 (
pdu_size
 >
ngth
) &&

222 (
vmac_c
 <= 0xFFFFFF) &&

223 (
vmac_d
 <= 0xFFFFFF)) {

224 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

225 
BVLC6_ORIGINAL_UNICAST_NPDU
, 
ngth
);

226 i(
bys_coded
 == 4) {

227 
	`code_unsigd24
(&
pdu
[4], 
vmac_c
);

228 
	`code_unsigd24
(&
pdu
[7], 
vmac_d
);

229 i(
du
 && 
ngth
) {

230 
i
 = 0; i < 
du_n
; i++) {

231 
pdu
[10+
i
] = 
du
[i];

234 
bys_coded
 = ()
ngth
;

238  
bys_coded
;

239 
	}
}

253 
	$bvlc6_decode_ig_uni
(

254 
ut8_t
 * 
pdu
,

255 
ut16_t
 
pdu_n
,

256 
ut32_t
 * 
vmac_c
,

257 
ut32_t
 * 
vmac_d
,

258 
ut8_t
 * 
du
,

259 
ut16_t
 
du_size
,

260 
ut16_t
 * 
du_n
)

262 
bys_csumed
 = 0;

263 
ut16_t
 
ngth
 = 0;

264 
ut16_t
 
i
 = 0;

266 i(
pdu
 && (
pdu_n
 >= 6)) {

267 i(
vmac_c
) {

268 
	`decode_unsigd24
(&
pdu
[0], 
vmac_c
);

270 i(
vmac_d
) {

271 
	`decode_unsigd24
(&
pdu
[3], 
vmac_d
);

273 
ngth
 = 
pdu_n
 - 6;

274 i(
du
 && 
ngth
 && (ngth <
du_size
)) {

275 
i
 = 0; i < 
ngth
; i++) {

276 
du
[
i
] = 
pdu
[6+i];

279 i(
du_n
) {

280 *
du_n
 = 
ngth
;

282 
bys_csumed
 = ()
pdu_n
;

285  
bys_csumed
;

286 
	}
}

307 
	$bvlc6_code_ig_brd
(

308 
ut8_t
 * 
pdu
,

309 
ut16_t
 
pdu_size
,

310 
ut32_t
 
vmac
,

311 
ut8_t
 * 
du
,

312 
ut16_t
 
du_n
)

314 
bys_coded
 = 0;

315 
ut16_t
 
ngth
 = 7;

316 
ut16_t
 
i
 = 0;

318 
ngth
 +
du_n
;

319 i(
pdu
 &&

320 (
pdu_size
 >
ngth
) &&

321 (
vmac
 <= 0xFFFFFF)) {

322 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

323 
BVLC6_ORIGINAL_BROADCAST_NPDU
, 
ngth
);

324 i(
bys_coded
 == 4) {

325 
	`code_unsigd24
(&
pdu
[4], 
vmac
);

326 i(
du
 && 
ngth
) {

327 
i
 = 0; i < 
du_n
; i++) {

328 
pdu
[7+
i
] = 
du
[i];

331 
bys_coded
 = ()
ngth
;

335  
bys_coded
;

336 
	}
}

349 
	$bvlc6_decode_ig_brd
(

350 
ut8_t
 * 
pdu
,

351 
ut16_t
 
pdu_n
,

352 
ut32_t
 * 
vmac
,

353 
ut8_t
 * 
du
,

354 
ut16_t
 
du_size
,

355 
ut16_t
 * 
du_n
)

357 
bys_csumed
 = 0;

358 
ut16_t
 
ngth
 = 0;

359 
ut16_t
 
i
 = 0;

361 i(
pdu
 && (
pdu_n
 >= 3)) {

362 i(
vmac
) {

363 
	`decode_unsigd24
(&
pdu
[0], 
vmac
);

365 
ngth
 = 
pdu_n
 - 3;

366 i(
du
 && 
ngth
 && (ngth <
du_size
)) {

367 
i
 = 0; i < 
ngth
; i++) {

368 
du
[
i
] = 
pdu
[3+i];

371 i(
du_n
) {

372 *
du_n
 = 
ngth
;

374 
bys_csumed
 = ()
pdu_n
;

377  
bys_csumed
;

378 
	}
}

399 
	$bvlc6_code_addss_suti
(

400 
ut8_t
 * 
pdu
,

401 
ut16_t
 
pdu_size
,

402 
ut32_t
 
vmac_c
,

403 
ut32_t
 
vmac_rg
)

405 
bys_coded
 = 0;

406 
ut16_t
 
ngth
 = 10;

409 i(
pdu
 && (
pdu_size
 >
ngth
) &&

410 (
vmac_c
 <= 0xFFFFFF) &&

411 (
vmac_rg
 <= 0xFFFFFF)) {

412 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

413 
BVLC6_ADDRESS_RESOLUTION
, 
ngth
);

414 i(
bys_coded
 == 4) {

415 
	`code_unsigd24
(&
pdu
[4], 
vmac_c
);

416 
	`code_unsigd24
(&
pdu
[7], 
vmac_rg
);

417 
bys_coded
 = ()
ngth
;

421  
bys_coded
;

422 
	}
}

433 
	$bvlc6_decode_addss_suti
(

434 
ut8_t
 * 
pdu
,

435 
ut16_t
 
pdu_n
,

436 
ut32_t
 * 
vmac_c
,

437 
ut32_t
 * 
vmac_rg
)

439 
bys_csumed
 = 0;

441 i(
pdu
 && (
pdu_n
 >= 6)) {

442 i(
vmac_c
) {

443 
	`decode_unsigd24
(&
pdu
[0], 
vmac_c
);

445 i(
vmac_rg
) {

446 
	`decode_unsigd24
(&
pdu
[3], 
vmac_rg
);

448 
bys_csumed
 = 6;

451  
bys_csumed
;

452 
	}
}

467 
	$bvlc6_code_addss
(

468 
ut8_t
 * 
pdu
,

469 
ut16_t
 
pdu_size
,

470 
BACNET_IP6_ADDRESS
 * 
b6_addss
)

472 
bys_coded
 = 0;

473 
ut16_t
 
ngth
 = 
BIP6_ADDRESS_MAX
;

474 
i
 = 0;

476 i(
pdu
 && (
pdu_size
 >
ngth
&& 
b6_addss
) {

477 
i
 = 0; i < 
IP6_ADDRESS_MAX
; i++) {

478 
pdu
[
i
] = 
b6_addss
->
addss
[i];

480 
	`code_unsigd16
(&
pdu
[
IP6_ADDRESS_MAX
], 
b6_addss
->
pt
);

481 
bys_coded
 = ()
ngth
;

484  
bys_coded
;

485 
	}
}

495 
	$bvlc6_decode_addss
(

496 
ut8_t
 * 
pdu
,

497 
ut16_t
 
pdu_n
,

498 
BACNET_IP6_ADDRESS
 * 
b6_addss
)

500 
bys_csumed
 = 0;

501 
ut16_t
 
ngth
 = 
BIP6_ADDRESS_MAX
;

502 
i
 = 0;

504 i(
pdu
 && (
pdu_n
 >
ngth
&& 
b6_addss
) {

505 
i
 = 0; i < 
IP6_ADDRESS_MAX
; i++) {

506 
b6_addss
->
addss
[
i
] = 
pdu
[i];

508 
	`decode_unsigd16
(&
pdu
[
IP6_ADDRESS_MAX
], &
b6_addss
->
pt
);

509 
bys_csumed
 = ()
ngth
;

512  
bys_csumed
;

513 
	}
}

527 
bo
 
	$bvlc6_addss_cy
(

528 
BACNET_IP6_ADDRESS
 * 
d
,

529 
BACNET_IP6_ADDRESS
 * 
c
)

531 
bo
 
us
 = 
l
;

532 
i
 = 0;

534 i(
c
 && 
d
) {

535 
i
 = 0; i < 
IP6_ADDRESS_MAX
; i++) {

536 
d
->
addss
[
i
] = 
c
->address[i];

538 
d
->
pt
 = 
c
->port;

539 
us
 = 
ue
;

542  
us
;

543 
	}
}

557 
bo
 
	$bvlc6_addss_dif
(

558 
BACNET_IP6_ADDRESS
 * 
d
,

559 
BACNET_IP6_ADDRESS
 * 
c
)

561 
bo
 
us
 = 
l
;

562 
i
 = 0;

564 i(
c
 && 
d
) {

565 
i
 = 0; i < 
IP6_ADDRESS_MAX
; i++) {

566 i(
d
->
addss
[
i
] !
c
->address[i]) {

567 
us
 = 
ue
;

570 i(
d
->
pt
 !
c
->port) {

571 
us
 = 
ue
;

575  
us
;

576 
	}
}

597 
bo
 
	$bvlc6_addss_t
(

598 
BACNET_IP6_ADDRESS
 * 
addr
,

599 
ut16_t
 
addr0
,

600 
ut16_t
 
addr1
,

601 
ut16_t
 
addr2
,

602 
ut16_t
 
addr3
,

603 
ut16_t
 
addr4
,

604 
ut16_t
 
addr5
,

605 
ut16_t
 
addr6
,

606 
ut16_t
 
addr7
)

608 
bo
 
us
 = 
l
;

610 i(
addr
) {

611 
	`code_unsigd16
(&
addr
->
addss
[0], 
addr0
);

612 
	`code_unsigd16
(&
addr
->
addss
[2], 
addr1
);

613 
	`code_unsigd16
(&
addr
->
addss
[4], 
addr2
);

614 
	`code_unsigd16
(&
addr
->
addss
[6], 
addr3
);

615 
	`code_unsigd16
(&
addr
->
addss
[8], 
addr4
);

616 
	`code_unsigd16
(&
addr
->
addss
[10], 
addr5
);

617 
	`code_unsigd16
(&
addr
->
addss
[12], 
addr6
);

618 
	`code_unsigd16
(&
addr
->
addss
[14], 
addr7
);

619 
us
 = 
ue
;

622  
us
;

623 
	}
}

644 
bo
 
	$bvlc6_addss_g
(

645 
BACNET_IP6_ADDRESS
 * 
addr
,

646 
ut16_t
 *
addr0
,

647 
ut16_t
 *
addr1
,

648 
ut16_t
 *
addr2
,

649 
ut16_t
 *
addr3
,

650 
ut16_t
 *
addr4
,

651 
ut16_t
 *
addr5
,

652 
ut16_t
 *
addr6
,

653 
ut16_t
 *
addr7
)

655 
bo
 
us
 = 
l
;

657 i(
addr
) {

658 i(
addr0
) {

659 
	`decode_unsigd16
(&
addr
->
addss
[0], 
addr0
);

661 i(
addr1
) {

662 
	`decode_unsigd16
(&
addr
->
addss
[2], 
addr1
);

664 i(
addr2
) {

665 
	`decode_unsigd16
(&
addr
->
addss
[4], 
addr2
);

667 i(
addr3
) {

668 
	`decode_unsigd16
(&
addr
->
addss
[6], 
addr3
);

670 i(
addr4
) {

671 
	`decode_unsigd16
(&
addr
->
addss
[8], 
addr4
);

673 i(
addr5
) {

674 
	`decode_unsigd16
(&
addr
->
addss
[10], 
addr5
);

676 i(
addr6
) {

677 
	`decode_unsigd16
(&
addr
->
addss
[12], 
addr6
);

679 i(
addr7
) {

680 
	`decode_unsigd16
(&
addr
->
addss
[14], 
addr7
);

682 
us
 = 
ue
;

685  
us
;

686 
	}
}

695 
bo
 
	$bvlc6_vmac_addss_t
(

696 
BACNET_ADDRESS
 * 
addr
,

697 
ut32_t
 
devi_id
)

699 
bo
 
us
 = 
l
;

701 i(
addr
) {

702 
	`code_unsigd24
(&
addr
->
mac
[0], 
devi_id
);

703 
addr
->
mac_n
 = 3;

704 
addr
->
t
 = 0;

705 
addr
->
n
 = 0;

706 
us
 = 
ue
;

709  
us
;

710 
	}
}

719 
bo
 
	$bvlc6_vmac_addss_g
(

720 
BACNET_ADDRESS
 * 
addr
,

721 
ut32_t
 *
devi_id
)

723 
bo
 
us
 = 
l
;

725 i(
addr
 && 
devi_id
) {

726 i(
addr
->
mac_n
 == 3) {

727 
	`decode_unsigd24
(&
addr
->
mac
[0], 
devi_id
);

728 
us
 = 
ue
;

732  
us
;

733 
	}
}

756 
	$bvlc6_code_fwded_addss_suti
(

757 
ut8_t
 * 
pdu
,

758 
ut16_t
 
pdu_size
,

759 
ut32_t
 
vmac_c
,

760 
ut32_t
 
vmac_rg
,

761 
BACNET_IP6_ADDRESS
 * 
b6_addss
)

763 
bys_coded
 = 0;

764 
ut16_t
 
ngth
 = 0x001C;

765 
ut16_t
 
offt
 = 0;

767 i(
pdu
 && (
pdu_size
 >
ngth
) &&

768 (
vmac_c
 <= 0xFFFFFF) &&

769 (
vmac_rg
 <= 0xFFFFFF) &&

770 
b6_addss
) {

771 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

772 
BVLC6_FORWARDED_ADDRESS_RESOLUTION
, 
ngth
);

773 i(
bys_coded
 == 4) {

774 
offt
 = 4;

775 
	`code_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

776 
offt
 += 3;

777 
	`code_unsigd24
(&
pdu
[
offt
], 
vmac_rg
);

778 
offt
 += 3;

779 
	`bvlc6_code_addss
(&
pdu
[
offt
], 
pdu_size
-offt, 
b6_addss
);

780 
bys_coded
 = ()
ngth
;

784  
bys_coded
;

785 
	}
}

797 
	$bvlc6_decode_fwded_addss_suti
(

798 
ut8_t
 * 
pdu
,

799 
ut16_t
 
pdu_n
,

800 
ut32_t
 * 
vmac_c
,

801 
ut32_t
 * 
vmac_rg
,

802 
BACNET_IP6_ADDRESS
 * 
b6_addss
)

804 
bys_csumed
 = 0;

805 cڡ 
ut16_t
 
ngth
 = 3 + 3 + 
BIP6_ADDRESS_MAX
;

806 
ut16_t
 
offt
 = 0;

808 i(
pdu
 && (
pdu_n
 >
ngth
)) {

809 i(
vmac_c
) {

810 
	`decode_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

812 
offt
 += 3;

813 i(
vmac_rg
) {

814 
	`decode_unsigd24
(&
pdu
[
offt
], 
vmac_rg
);

816 
offt
 += 3;

817 i(
b6_addss
) {

818 
	`bvlc6_decode_addss
(&
pdu
[
offt
], 
pdu_n
-offt, 
b6_addss
);

820 
bys_csumed
 = ()
ngth
;

823  
bys_csumed
;

824 
	}
}

835 
	$bvlc6_code_addss_ack
(

836 
ut8_t
 
mesge_ty
,

837 
ut8_t
 * 
pdu
,

838 
ut16_t
 
pdu_size
,

839 
ut32_t
 
vmac_c
,

840 
ut32_t
 
vmac_d
)

842 
bys_coded
 = 0;

843 cڡ 
ut16_t
 
ngth
 = 10;

844 
ut16_t
 
offt
 = 0;

846 i(
pdu
 && (
pdu_size
 >
ngth
) &&

847 (
vmac_c
 <= 0xFFFFFF) &&

848 (
vmac_d
 <= 0xFFFFFF)) {

849 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

850 
mesge_ty
, 
ngth
);

851 i(
bys_coded
 == 4) {

852 
offt
 = 4;

853 
	`code_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

854 
offt
 += 3;

855 
	`code_unsigd24
(&
pdu
[
offt
], 
vmac_d
);

856 
bys_coded
 = ()
ngth
;

860  
bys_coded
;

861 
	}
}

881 
	$bvlc6_code_addss_suti_ack
(

882 
ut8_t
 * 
pdu
,

883 
ut16_t
 
pdu_size
,

884 
ut32_t
 
vmac_c
,

885 
ut32_t
 
vmac_d
)

887  
	`bvlc6_code_addss_ack
(

888 
BVLC6_ADDRESS_RESOLUTION_ACK
,

889 
pdu
, 
pdu_size
,
vmac_c
, 
vmac_d
);

890 
	}
}

901 
	$bvlc6_decode_addss_suti_ack
(

902 
ut8_t
 * 
pdu
,

903 
ut16_t
 
pdu_n
,

904 
ut32_t
 * 
vmac_c
,

905 
ut32_t
 * 
vmac_d
)

907 
bys_csumed
 = 0;

908 cڡ 
ut16_t
 
ngth
 = 6;

909 
ut16_t
 
offt
 = 0;

911 i(
pdu
 && (
pdu_n
 >
ngth
)) {

912 i(
vmac_c
) {

913 
	`decode_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

915 
offt
 += 3;

916 i(
vmac_d
) {

917 
	`decode_unsigd24
(&
pdu
[
offt
], 
vmac_d
);

919 
bys_csumed
 = ()
ngth
;

922  
bys_csumed
;

923 
	}
}

941 
	$bvlc6_code_vtu_addss_suti
(

942 
ut8_t
 * 
pdu
,

943 
ut16_t
 
pdu_size
,

944 
ut32_t
 
vmac_c
)

946 
bys_coded
 = 0;

947 cڡ 
ut16_t
 
ngth
 = 7;

949 i(
pdu
 && (
pdu_size
 >
ngth
) &&

950 (
vmac_c
 <= 0xFFFFFF)) {

951 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

952 
BVLC6_VIRTUAL_ADDRESS_RESOLUTION
, 
ngth
);

953 i(
bys_coded
 == 4) {

954 
	`code_unsigd24
(&
pdu
[4], 
vmac_c
);

955 
bys_coded
 = ()
ngth
;

959  
bys_coded
;

960 
	}
}

970 
	$bvlc6_decode_vtu_addss_suti
(

971 
ut8_t
 * 
pdu
,

972 
ut16_t
 
pdu_n
,

973 
ut32_t
 * 
vmac_c
)

975 
bys_csumed
 = 0;

977 i(
pdu
 && (
pdu_n
 >= 3)) {

978 i(
vmac_c
) {

979 
	`decode_unsigd24
(&
pdu
[0], 
vmac_c
);

981 
bys_csumed
 = 3;

984  
bys_csumed
;

985 
	}
}

1004 
	$bvlc6_code_vtu_addss_suti_ack
(

1005 
ut8_t
 * 
pdu
,

1006 
ut16_t
 
pdu_size
,

1007 
ut32_t
 
vmac_c
,

1008 
ut32_t
 
vmac_d
)

1010  
	`bvlc6_code_addss_ack
(

1011 
BVLC6_VIRTUAL_ADDRESS_RESOLUTION_ACK
,

1012 
pdu
, 
pdu_size
,
vmac_c
, 
vmac_d
);

1013 
	}
}

1024 
	$bvlc6_decode_vtu_addss_suti_ack
(

1025 
ut8_t
 * 
pdu
,

1026 
ut16_t
 
pdu_n
,

1027 
ut32_t
 * 
vmac_c
,

1028 
ut32_t
 * 
vmac_d
)

1030  
	`bvlc6_decode_addss_suti_ack
(
pdu
, 
pdu_n
,

1031 
vmac_c
, 
vmac_d
);

1032 
	}
}

1057 
	$bvlc6_code_fwded_du
(

1058 
ut8_t
 * 
pdu
,

1059 
ut16_t
 
pdu_size
,

1060 
ut32_t
 
vmac_c
,

1061 
BACNET_IP6_ADDRESS
 * 
b6_addss
,

1062 
ut8_t
 * 
du
,

1063 
ut16_t
 
du_n
)

1065 
bys_coded
 = 0;

1066 
ut16_t
 
ngth
 = 1+1+2+3+
BIP6_ADDRESS_MAX
;

1067 
ut16_t
 
i
 = 0;

1068 
ut16_t
 
offt
 = 0;

1070 
ngth
 +
du_n
;

1071 i(
pdu
 &&

1072 (
pdu_size
 >
ngth
) &&

1073 (
vmac_c
 <= 0xFFFFFF)) {

1074 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

1075 
BVLC6_FORWARDED_NPDU
, 
ngth
);

1076 i(
bys_coded
 == 4) {

1077 
offt
 = 4;

1078 
	`code_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

1079 
offt
 += 3;

1080 
	`bvlc6_code_addss
(&
pdu
[
offt
], 
pdu_size
-offset,

1081 
b6_addss
);

1082 
offt
 +
BIP6_ADDRESS_MAX
;

1083 i(
du
 && 
ngth
) {

1084 
i
 = 0; i < 
du_n
; i++) {

1085 
pdu
[
offt
+
i
] = 
du
[i];

1088 
bys_coded
 = ()
ngth
;

1092  
bys_coded
;

1093 
	}
}

1107 
	$bvlc6_decode_fwded_du
(

1108 
ut8_t
 * 
pdu
,

1109 
ut16_t
 
pdu_n
,

1110 
ut32_t
 * 
vmac_c
,

1111 
BACNET_IP6_ADDRESS
 * 
b6_addss
,

1112 
ut8_t
 * 
du
,

1113 
ut16_t
 
du_size
,

1114 
ut16_t
 * 
du_n
)

1116 
bys_csumed
 = 0;

1117 
ut16_t
 
ngth
 = 0;

1118 
ut16_t
 
i
 = 0;

1119 cڡ 
ut16_t
 
addss_n
 = 3+
BIP6_ADDRESS_MAX
;

1120 
ut16_t
 
offt
 = 0;

1122 i(
pdu
 && (
pdu_n
 >
addss_n
)) {

1123 i(
vmac_c
) {

1124 
	`decode_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

1126 
offt
 += 3;

1127 i(
b6_addss
) {

1128 
	`bvlc6_decode_addss
(&
pdu
[
offt
], 
pdu_n
-offset,

1129 
b6_addss
);

1131 
offt
 +
BIP6_ADDRESS_MAX
;

1132 
ngth
 = 
pdu_n
 - 
offt
;

1133 i(
du
 && 
ngth
 && (ngth <
du_size
)) {

1134 
i
 = 0; i < 
ngth
; i++) {

1135 
du
[
i
] = 
pdu
[
offt
+i];

1138 i(
du_n
) {

1139 *
du_n
 = 
ngth
;

1141 
bys_csumed
 = ()
pdu_n
;

1144  
bys_csumed
;

1145 
	}
}

1166 
	$bvlc6_code_gi_feign_devi
(

1167 
ut8_t
 * 
pdu
,

1168 
ut16_t
 
pdu_size
,

1169 
ut32_t
 
vmac_c
,

1170 
ut16_t
 
l_cds
)

1172 
bys_coded
 = 0;

1173 cڡ 
ut16_t
 
ngth
 = 9;

1174 
ut16_t
 
offt
 = 0;

1176 i(
pdu
 && (
pdu_size
 >
ngth
) &&

1177 (
vmac_c
 <= 0xFFFFFF)) {

1178 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

1179 
BVLC6_REGISTER_FOREIGN_DEVICE
, 
ngth
);

1180 i(
bys_coded
 == 4) {

1181 
offt
 = 4;

1182 
	`code_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

1183 
offt
 += 3;

1184 
	`code_unsigd16
(&
pdu
[
offt
], 
l_cds
);

1185 
bys_coded
 = ()
ngth
;

1189  
bys_coded
;

1190 
	}
}

1201 
	$bvlc6_decode_gi_feign_devi
(

1202 
ut8_t
 * 
pdu
,

1203 
ut16_t
 
pdu_n
,

1204 
ut32_t
 * 
vmac_c
,

1205 
ut16_t
 * 
l_cds
)

1207 
bys_csumed
 = 0;

1208 cڡ 
ut16_t
 
ngth
 = 5;

1209 
ut16_t
 
offt
 = 0;

1211 i(
pdu
 && (
pdu_n
 >
ngth
)) {

1212 i(
vmac_c
) {

1213 
	`decode_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

1215 
offt
 += 3;

1216 i(
l_cds
) {

1217 
	`decode_unsigd16
(&
pdu
[
offt
], 
l_cds
);

1219 
bys_csumed
 = ()
ngth
;

1222  
bys_csumed
;

1223 
	}
}

1244 
	$bvlc6_code_de_feign_devi
(

1245 
ut8_t
 * 
pdu
,

1246 
ut16_t
 
pdu_size
,

1247 
ut32_t
 
vmac_c
,

1248 
BACNET_IP6_FOREIGN_DEVICE_TABLE_ENTRY
 * 
fdt_y
)

1250 
bys_coded
 = 0;

1251 cڡ 
ut16_t
 
ngth
 = 0x0019;

1252 
ut16_t
 
offt
 = 0;

1254 i(
pdu
 && (
pdu_size
 >
ngth
) &&

1255 (
vmac_c
 <= 0xFFFFFF)) {

1256 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

1257 
BVLC6_DELETE_FOREIGN_DEVICE
, 
ngth
);

1258 i(
bys_coded
 == 4) {

1259 
offt
 = 4;

1260 
	`code_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

1261 
offt
 += 3;

1262 i(
fdt_y
) {

1263 
	`bvlc6_code_addss
(&
pdu
[
offt
], 
pdu_size
-offset,

1264 &
fdt_y
->
b6_addss
);

1265 
offt
 +
BIP6_ADDRESS_MAX
;

1266 
	`code_unsigd16
(&
pdu
[
offt
],

1267 
fdt_y
->
l_cds
);

1268 
offt
 += 2;

1269 
	`code_unsigd16
(&
pdu
[
offt
],

1270 
fdt_y
->
l_cds_mag
);

1271 
bys_coded
 = ()
ngth
;

1276  
bys_coded
;

1277 
	}
}

1288 
	$bvlc6_decode_de_feign_devi
(

1289 
ut8_t
 * 
pdu
,

1290 
ut16_t
 
pdu_n
,

1291 
ut32_t
 * 
vmac_c
,

1292 
BACNET_IP6_FOREIGN_DEVICE_TABLE_ENTRY
 * 
fdt_y
)

1294 
bys_csumed
 = 0;

1296 cڡ 
ut16_t
 
ngth
 = 
BIP6_ADDRESS_MAX
+3+2+2-4;

1297 
ut16_t
 
offt
 = 0;

1299 i(
pdu
 && (
pdu_n
 >
ngth
)) {

1300 i(
vmac_c
) {

1301 
	`decode_unsigd24
(&
pdu
[
offt
], 
vmac_c
);

1302 
bys_csumed
 = 3;

1304 
offt
 += 3;

1305 i(
fdt_y
) {

1306 
	`bvlc6_decode_addss
(&
pdu
[
offt
], 
pdu_n
-offset,

1307 &
fdt_y
->
b6_addss
);

1308 
offt
 +
BIP6_ADDRESS_MAX
;

1309 
	`decode_unsigd16
(&
pdu
[
offt
],

1310 &
fdt_y
->
l_cds
);

1311 
offt
 += 2;

1312 
	`decode_unsigd16
(&
pdu
[
offt
],

1313 &
fdt_y
->
l_cds_mag
);

1314 
bys_csumed
 = ()
ngth
;

1316 
bys_csumed
 = ()
ngth
;

1319  
bys_csumed
;

1320 
	}
}

1339 
	$bvlc6_code_cu_bv
(

1340 
ut8_t
 * 
pdu
,

1341 
ut16_t
 
pdu_size
,

1342 
ut8_t
 * 
sbuf
,

1343 
ut16_t
 
sbuf_n
)

1345 
bys_coded
 = 0;

1346 
ut16_t
 
ngth
 = 4;

1347 
ut16_t
 
i
 = 0;

1349 
ngth
 +
sbuf_n
;

1350 i(
pdu
 &&

1351 (
pdu_size
 >
ngth
)) {

1352 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

1353 
BVLC6_SECURE_BVLL
, 
ngth
);

1354 i(
bys_coded
 == 4) {

1355 i(
sbuf
 && 
sbuf_n
) {

1356 
i
 = 0; i < 
sbuf_n
; i++) {

1357 
pdu
[4+
i
] = 
sbuf
[i];

1360 
bys_coded
 = ()
ngth
;

1364  
bys_coded
;

1365 
	}
}

1377 
	$bvlc6_decode_cu_bv
(

1378 
ut8_t
 * 
pdu
,

1379 
ut16_t
 
pdu_n
,

1380 
ut8_t
 * 
sbuf
,

1381 
ut16_t
 
sbuf_size
,

1382 
ut16_t
 * 
sbuf_n
)

1384 
bys_csumed
 = 0;

1385 
ut16_t
 
i
 = 0;

1387 i(
pdu
 && 
sbuf
) {

1388 i(
sbuf_n
) {

1389 *
sbuf_n
 = 
pdu_n
;

1391 i(
pdu_n
) {

1392 
i
 = 0; i < 
pdu_n
; i++) {

1393 
sbuf
[
i
] = 
pdu
[i];

1396 
bys_csumed
 = ()
pdu_n
;

1399  
bys_csumed
;

1400 
	}
}

1424 
	$bvlc6_code_diribu_brd_to_twk
(

1425 
ut8_t
 * 
pdu
,

1426 
ut16_t
 
pdu_size
,

1427 
ut32_t
 
vmac
,

1428 
ut8_t
 * 
du
,

1429 
ut16_t
 
du_n
)

1431 
bys_coded
 = 0;

1432 
ut16_t
 
ngth
 = 7;

1433 
ut16_t
 
i
 = 0;

1436 
ngth
 +
du_n
;

1437 i(
pdu
 &&

1438 (
pdu_size
 >
ngth
) &&

1439 (
vmac
 <= 0xFFFFFF)) {

1440 
bys_coded
 = 
	`bvlc6_code_hd
(
pdu
, 
pdu_size
,

1441 
BVLC6_DISTRIBUTE_BROADCAST_TO_NETWORK
, 
ngth
);

1442 i(
bys_coded
 == 4) {

1443 
	`code_unsigd24
(&
pdu
[4], 
vmac
);

1444 i(
du
 && 
ngth
) {

1445 
i
 = 0; i < 
du_n
; i++) {

1446 
pdu
[7+
i
] = 
du
[i];

1449 
bys_coded
 = ()
ngth
;

1453  
bys_coded
;

1454 
	}
}

1467 
	$bvlc6_decode_diribu_brd_to_twk
(

1468 
ut8_t
 * 
pdu
,

1469 
ut16_t
 
pdu_n
,

1470 
ut32_t
 * 
vmac
,

1471 
ut8_t
 * 
du
,

1472 
ut16_t
 
du_size
,

1473 
ut16_t
 * 
du_n
)

1475 
bys_csumed
 = 0;

1476 
ut16_t
 
ngth
 = 0;

1477 
ut16_t
 
i
 = 0;

1479 i(
pdu
 && (
pdu_n
 >= 3)) {

1480 i(
vmac
) {

1481 
	`decode_unsigd24
(&
pdu
[0], 
vmac
);

1483 
ngth
 = 
pdu_n
 - 3;

1484 i(
du
 && 
ngth
 && (ngth <
du_size
)) {

1485 
i
 = 0; i < 
ngth
; i++) {

1486 
du
[
i
] = 
pdu
[3+i];

1489 i(
du_n
) {

1490 *
du_n
 = 
ngth
;

1492 
bys_csumed
 = ()
pdu_n
;

1495  
bys_csumed
;

1496 
	}
}

1498 #ifde
TEST


1499 
	~<as.h
>

1500 
	~<rg.h
>

1501 
	~"e.h
"

1503 
	$_BVLC6_Addss
(

1504 
Te
 * 
pTe
,

1505 
BACNET_IP6_ADDRESS
 * 
b6_addss_1
,

1506 
BACNET_IP6_ADDRESS
 * 
b6_addss_2
)

1508 
i
 = 0;

1510 i(
b6_addss_1
 && 
b6_addss_2
) {

1511 
	`_
(
pTe
, 
b6_addss_1
->
pt
 =
b6_addss_2
->port);

1512 
i
 = 0; i < 
IP6_ADDRESS_MAX
; i++) {

1513 
	`_
(
pTe
, 
b6_addss_1
->
addss
[
i
] ==

1514 
b6_addss_2
->
addss
[
i
]);

1519 
	}
}

1521 
	$_BVLC6_Hd
(

1522 
Te
 * 
pTe
,

1523 
ut8_t
 * 
pdu
,

1524 
ut16_t
 
pdu_n
,

1525 
ut8_t
 * 
mesge_ty
,

1526 
ut16_t
 * 
ngth
)

1529 
bys_csumed
 = 0;

1530 
n
 = 0;

1532 i(
pdu
 && 
mesge_ty
 && 
ngth
) {

1533 
n
 = 
	`bvlc6_decode_hd
(
pdu
, 
pdu_n
, 
mesge_ty
,

1534 
ngth
);

1535 
	`_
(
pTe
, 
n
 == 4);

1536 
bys_csumed
 = 
n
;

1539  
bys_csumed
;

1540 
	}
}

1542 
	$_BVLC6_Resu_Code
(

1543 
Te
 * 
pTe
,

1544 
ut32_t
 
vmac
,

1545 
ut16_t
 
su_code
)

1547 
ut8_t
 
pdu
[50] = { 0 };

1548 
ut32_t
 
_vmac
 = 0;

1549 
ut16_t
 
_su_code
 = 0;

1550 
ut8_t
 
mesge_ty
 = 0;

1551 
ut16_t
 
ngth
 = 0;

1552 
n
 = 0, 
_n
 = 0;

1554 
n
 = 
	`bvlc6_code_su
(
pdu
, du), 
vmac
, 
su_code
);

1555 
	`_
(
pTe
, 
n
 == 9);

1556 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

1557 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

1558 
	`_
(
pTe
, 
_n
 == 4);

1559 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_RESULT
);

1560 
	`_
(
pTe
, 
ngth
 == 9);

1561 
_n
 +
	`bvlc6_decode_su
(&
pdu
[4], 
ngth
-4,

1562 &
_vmac
, &
_su_code
);

1563 
	`_
(
pTe
, 
n
 =
_n
);

1564 
	`_
(
pTe
, 
vmac
 =
_vmac
);

1565 
	`_
(
pTe
, 
su_code
 =
_su_code
);

1566 
n
 = 
	`bvlc6_code_su
(
pdu
, du), 0xffffff+1, 
su_code
);

1567 
	`_
(
pTe
, 
n
 == 0);

1568 
	}
}

1570 
	$_BVLC6_Resu
(

1571 
Te
 * 
pTe
)

1573 
ut32_t
 
vmac
 = 0;

1574 
ut16_t
 
su_code
[6] = {

1575 
BVLC6_RESULT_SUCCESSFUL_COMPLETION
,

1576 
BVLC6_RESULT_ADDRESS_RESOLUTION_NAK
,

1577 
BVLC6_RESULT_VIRTUAL_ADDRESS_RESOLUTION_NAK
,

1578 
BVLC6_RESULT_REGISTER_FOREIGN_DEVICE_NAK
,

1579 
BVLC6_RESULT_DELETE_FOREIGN_DEVICE_NAK
,

1580 
BVLC6_RESULT_DISTRIBUTE_BROADCAST_TO_NETWORK_NAK


1582 
i
 = 0;

1584 
vmac
 = 4194303;

1585 
i
 = 0; i < 6; i++) {

1586 
	`_BVLC6_Resu_Code
(
pTe
, 
vmac
, 
su_code
[
i
]);

1588 
	}
}

1590 
	$_BVLC6_Orig_Uni_NPDU_Mesge
(

1591 
Te
 * 
pTe
,

1592 
ut8_t
 * 
du
,

1593 
ut16_t
 
du_n
,

1594 
ut32_t
 
vmac_c
,

1595 
ut32_t
 
vmac_d
)

1597 
ut8_t
 
_du
[50] = { 0 };

1598 
ut8_t
 
pdu
[60] = { 0 };

1599 
ut32_t
 
_vmac_c
 = 0;

1600 
ut32_t
 
_vmac_d
 = 0;

1601 
ut16_t
 
_du_n
 = 0;

1602 
ut8_t
 
mesge_ty
 = 0;

1603 
ut16_t
 
ngth
 = 0;

1604 
n
 = 0, 
msg_n
 = 0, 
_n
 = 0;

1605 
ut16_t
 
i
 = 0;

1607 
n
 = 
	`bvlc6_code_ig_uni
(
pdu
, (pdu),

1608 
vmac_c
, 
vmac_d
,

1609 
du
, 
du_n
);

1610 
msg_n
 = 10 + 
du_n
;

1611 
	`_
(
pTe
, 
n
 =
msg_n
);

1612 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

1613 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

1614 
	`_
(
pTe
, 
_n
 == 4);

1615 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_ORIGINAL_UNICAST_NPDU
);

1616 
	`_
(
pTe
, 
ngth
 =
msg_n
);

1617 
_n
 +
	`bvlc6_decode_ig_uni
(&
pdu
[4], 
ngth
-4,

1618 &
_vmac_c
, &
_vmac_d
,

1619 
_du
, e_du), &
_du_n
);

1620 
	`_
(
pTe
, 
n
 =
_n
);

1621 
	`_
(
pTe
, 
msg_n
 =
_n
);

1622 
	`_
(
pTe
, 
vmac_c
 =
_vmac_c
);

1623 
	`_
(
pTe
, 
vmac_d
 =
_vmac_d
);

1624 
	`_
(
pTe
, 
du_n
 =
_du_n
);

1625 
i
 = 0; i < 
du_n
; i++) {

1626 
	`_
(
pTe
, 
du
[
i
] =
_du
[i]);

1628 
	}
}

1630 
	$_BVLC6_Orig_Uni_NPDU
(

1631 
Te
 * 
pTe
)

1633 
ut8_t
 
du
[50] = { 0 };

1634 
ut32_t
 
vmac_c
 = 0;

1635 
ut32_t
 
vmac_d
 = 0;

1636 
ut16_t
 
du_n
 = 0;

1637 
ut16_t
 
i
 = 0;

1639 
	`_BVLC6_Orig_Uni_NPDU_Mesge
(
pTe
,

1640 
du
, 
du_n
, 
vmac_c
, 
vmac_d
);

1642 
i
 = 0; i < (
du
); i++) {

1643 
du
[
i
] = i;

1645 
du_n
 = (
du
);

1646 
vmac_c
 = 4194303;

1647 
vmac_d
 = 4194302;

1648 
	`_BVLC6_Orig_Uni_NPDU_Mesge
(
pTe
,

1649 
du
, 
du_n
, 
vmac_c
, 
vmac_d
);

1650 
	}
}

1652 
	$_BVLC6_Orig_Brd_NPDU_Mesge
(

1653 
Te
 * 
pTe
,

1654 
ut8_t
 * 
du
,

1655 
ut16_t
 
du_n
,

1656 
ut32_t
 
vmac
)

1658 
ut8_t
 
_du
[50] = { 0 };

1659 
ut8_t
 
pdu
[60] = { 0 };

1660 
ut32_t
 
_vmac
 = 0;

1661 
ut16_t
 
_du_n
 = 0;

1662 
ut8_t
 
mesge_ty
 = 0;

1663 
ut16_t
 
ngth
 = 0;

1664 
n
 = 0, 
msg_n
 = 0, 
_n
 = 0;

1665 
ut16_t
 
i
 = 0;

1667 
n
 = 
	`bvlc6_code_ig_brd
(
pdu
, (pdu),

1668 
vmac
, 
du
, 
du_n
);

1669 
msg_n
 = 7 + 
du_n
;

1670 
	`_
(
pTe
, 
n
 =
msg_n
);

1671 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

1672 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

1673 
	`_
(
pTe
, 
_n
 == 4);

1674 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_ORIGINAL_BROADCAST_NPDU
);

1675 
	`_
(
pTe
, 
ngth
 =
msg_n
);

1676 
_n
 +
	`bvlc6_decode_ig_brd
(&
pdu
[4], 
ngth
-4,

1677 &
_vmac
, 
_du
, e_du), &
_du_n
);

1678 
	`_
(
pTe
, 
n
 =
_n
);

1679 
	`_
(
pTe
, 
msg_n
 =
_n
);

1680 
	`_
(
pTe
, 
vmac
 =
_vmac
);

1681 
	`_
(
pTe
, 
du_n
 =
_du_n
);

1682 
i
 = 0; i < 
du_n
; i++) {

1683 
	`_
(
pTe
, 
du
[
i
] =
_du
[i]);

1685 
	}
}

1687 
	$_BVLC6_Orig_Brd_NPDU
(

1688 
Te
 * 
pTe
)

1690 
ut8_t
 
du
[50] = { 0 };

1691 
ut32_t
 
vmac
 = 0;

1692 
ut16_t
 
du_n
 = 0;

1693 
ut16_t
 
i
 = 0;

1695 
	`_BVLC6_Orig_Brd_NPDU_Mesge
(
pTe
,

1696 
du
, 
du_n
, 
vmac
);

1698 
i
 = 0; i < (
du
); i++) {

1699 
du
[
i
] = i;

1701 
du_n
 = (
du
);

1702 
vmac
 = 4194303;

1703 
	`_BVLC6_Orig_Brd_NPDU_Mesge
(
pTe
,

1704 
du
, 
du_n
, 
vmac
);

1705 
	}
}

1707 
	$_BVLC6_Addss_Resuti_Mesge
(

1708 
Te
 * 
pTe
,

1709 
ut32_t
 
vmac_c
,

1710 
ut32_t
 
vmac_rg
)

1712 
ut8_t
 
pdu
[60] = { 0 };

1713 
ut32_t
 
_vmac_c
 = 0;

1714 
ut32_t
 
_vmac_rg
 = 0;

1715 
ut8_t
 
mesge_ty
 = 0;

1716 
ut16_t
 
ngth
 = 0;

1717 
n
 = 0, 
_n
 = 0;

1718 cڡ 
msg_n
 = 10;

1720 
n
 = 
	`bvlc6_code_addss_suti
(
pdu
, (pdu),

1721 
vmac_c
, 
vmac_rg
);

1722 
	`_
(
pTe
, 
n
 =
msg_n
);

1723 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

1724 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

1725 
	`_
(
pTe
, 
_n
 == 4);

1726 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_ADDRESS_RESOLUTION
);

1727 
	`_
(
pTe
, 
ngth
 =
msg_n
);

1728 
_n
 +
	`bvlc6_decode_addss_suti
(&
pdu
[4], 
ngth
-4,

1729 &
_vmac_c
, &
_vmac_rg
);

1730 
	`_
(
pTe
, 
n
 =
_n
);

1731 
	`_
(
pTe
, 
msg_n
 =
_n
);

1732 
	`_
(
pTe
, 
vmac_c
 =
_vmac_c
);

1733 
	`_
(
pTe
, 
vmac_rg
 =
_vmac_rg
);

1734 
	}
}

1736 
	$_BVLC6_Addss_Resuti
(

1737 
Te
 * 
pTe
)

1739 
ut32_t
 
vmac_c
 = 0;

1740 
ut32_t
 
vmac_rg
 = 0;

1742 
	`_BVLC6_Addss_Resuti_Mesge
(
pTe
,

1743 
vmac_c
, 
vmac_rg
);

1744 
vmac_c
 = 4194303;

1745 
vmac_rg
 = 4194302;

1746 
	`_BVLC6_Addss_Resuti_Mesge
(
pTe
,

1747 
vmac_c
, 
vmac_rg
);

1748 
	}
}

1750 
	$_BVLC6_Fwded_Addss_Resuti_Mesge
(

1751 
Te
 * 
pTe
,

1752 
ut32_t
 
vmac_c
,

1753 
ut32_t
 
vmac_d
,

1754 
BACNET_IP6_ADDRESS
 * 
b6_addss
)

1756 
BACNET_IP6_ADDRESS
 
_b6_addss
 = {{0}};

1757 
ut8_t
 
pdu
[60] = { 0 };

1758 
ut32_t
 
_vmac_c
 = 0;

1759 
ut32_t
 
_vmac_d
 = 0;

1760 
ut8_t
 
mesge_ty
 = 0;

1761 
ut16_t
 
ngth
 = 0;

1762 
n
 = 0, 
_n
 = 0;

1763 cڡ 
msg_n
 = 4 + 3 + 3 + 
BIP6_ADDRESS_MAX
;

1765 
n
 = 
	`bvlc6_code_fwded_addss_suti
(

1766 
pdu
, (pdu),

1767 
vmac_c
, 
vmac_d
,

1768 
b6_addss
);

1769 
	`_
(
pTe
, 
n
 =
msg_n
);

1770 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

1771 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

1772 
	`_
(
pTe
, 
_n
 == 4);

1773 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_FORWARDED_ADDRESS_RESOLUTION
);

1774 
	`_
(
pTe
, 
ngth
 =
msg_n
);

1775 
_n
 +
	`bvlc6_decode_fwded_addss_suti
(

1776 &
pdu
[4], 
ngth
-4,

1777 &
_vmac_c
, &
_vmac_d
,

1778 &
_b6_addss
);

1779 
	`_
(
pTe
, 
n
 =
_n
);

1780 
	`_
(
pTe
, 
msg_n
 =
_n
);

1781 
	`_
(
pTe
, 
vmac_c
 =
_vmac_c
);

1782 
	`_
(
pTe
, 
vmac_d
 =
_vmac_d
);

1783 
	`_BVLC6_Addss
(
pTe
, 
b6_addss
, &
_b6_addss
);

1784 
	}
}

1786 
	$_BVLC6_Fwded_Addss_Resuti
(

1787 
Te
 * 
pTe
)

1789 
BACNET_IP6_ADDRESS
 
b6_addss
 = {{0}};

1790 
ut32_t
 
vmac_c
 = 0;

1791 
ut32_t
 
vmac_rg
 = 0;

1792 
ut16_t
 
i
 = 0;

1794 
	`_BVLC6_Fwded_Addss_Resuti_Mesge
(
pTe
,

1795 
vmac_c
, 
vmac_rg
, &
b6_addss
);

1797 
i
 = 0; i < (
b6_addss
.
addss
); i++) {

1798 
b6_addss
.
addss
[
i
] = i;

1800 
b6_addss
.
pt
 = 47808;

1801 
vmac_c
 = 4194303;

1802 
vmac_rg
 = 4194302;

1803 
	`_BVLC6_Fwded_Addss_Resuti_Mesge
(
pTe
,

1804 
vmac_c
, 
vmac_rg
, &
b6_addss
);

1805 
	}
}

1807 
	$_BVLC6_Addss_Resuti_Ack_Mesge
(

1808 
Te
 * 
pTe
,

1809 
ut32_t
 
vmac_c
,

1810 
ut32_t
 
vmac_d
)

1812 
ut8_t
 
pdu
[60] = { 0 };

1813 
ut32_t
 
_vmac_c
 = 0;

1814 
ut32_t
 
_vmac_d
 = 0;

1815 
ut8_t
 
mesge_ty
 = 0;

1816 
ut16_t
 
ngth
 = 0;

1817 
n
 = 0, 
_n
 = 0;

1818 cڡ 
msg_n
 = 10;

1820 
n
 = 
	`bvlc6_code_addss_suti_ack
(
pdu
, (pdu),

1821 
vmac_c
, 
vmac_d
);

1822 
	`_
(
pTe
, 
n
 =
msg_n
);

1823 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

1824 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

1825 
	`_
(
pTe
, 
_n
 == 4);

1826 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_ADDRESS_RESOLUTION_ACK
);

1827 
	`_
(
pTe
, 
ngth
 =
msg_n
);

1828 
_n
 +
	`bvlc6_decode_addss_suti_ack
(&
pdu
[4], 
ngth
-4,

1829 &
_vmac_c
, &
_vmac_d
);

1830 
	`_
(
pTe
, 
n
 =
_n
);

1831 
	`_
(
pTe
, 
msg_n
 =
_n
);

1832 
	`_
(
pTe
, 
vmac_c
 =
_vmac_c
);

1833 
	`_
(
pTe
, 
vmac_d
 =
_vmac_d
);

1834 
	}
}

1836 
	$_BVLC6_Addss_Resuti_Ack
(

1837 
Te
 * 
pTe
)

1839 
ut32_t
 
vmac_c
 = 0;

1840 
ut32_t
 
vmac_d
 = 0;

1842 
	`_BVLC6_Addss_Resuti_Ack_Mesge
(
pTe
,

1843 
vmac_c
, 
vmac_d
);

1844 
vmac_c
 = 4194303;

1845 
vmac_d
 = 4194302;

1846 
	`_BVLC6_Addss_Resuti_Ack_Mesge
(
pTe
,

1847 
vmac_c
, 
vmac_d
);

1848 
	}
}

1850 
	$_BVLC6_Vtu_Addss_Resuti_Mesge
(

1851 
Te
 * 
pTe
,

1852 
ut32_t
 
vmac_c
)

1854 
ut8_t
 
pdu
[60] = { 0 };

1855 
ut32_t
 
_vmac_c
 = 0;

1856 
ut8_t
 
mesge_ty
 = 0;

1857 
ut16_t
 
ngth
 = 0;

1858 
n
 = 0, 
_n
 = 0;

1859 cڡ 
msg_n
 = 7;

1861 
n
 = 
	`bvlc6_code_vtu_addss_suti
(
pdu
, (pdu),

1862 
vmac_c
);

1863 
	`_
(
pTe
, 
n
 =
msg_n
);

1864 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

1865 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

1866 
	`_
(
pTe
, 
_n
 == 4);

1867 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_VIRTUAL_ADDRESS_RESOLUTION
);

1868 
	`_
(
pTe
, 
ngth
 =
msg_n
);

1869 
_n
 +
	`bvlc6_decode_vtu_addss_suti
(&
pdu
[4], 
ngth
-4,

1870 &
_vmac_c
);

1871 
	`_
(
pTe
, 
n
 =
_n
);

1872 
	`_
(
pTe
, 
msg_n
 =
_n
);

1873 
	`_
(
pTe
, 
vmac_c
 =
_vmac_c
);

1874 
	}
}

1876 
	$_BVLC6_Vtu_Addss_Resuti
(

1877 
Te
 * 
pTe
)

1879 
ut32_t
 
vmac_c
 = 0;

1881 
	`_BVLC6_Vtu_Addss_Resuti_Mesge
(
pTe
,

1882 
vmac_c
);

1883 
vmac_c
 = 0x1234;

1884 
	`_BVLC6_Vtu_Addss_Resuti_Mesge
(
pTe
,

1885 
vmac_c
);

1886 
	}
}

1888 
	$_BVLC6_Vtu_Addss_Resuti_Ack_Mesge
(

1889 
Te
 * 
pTe
,

1890 
ut32_t
 
vmac_c
,

1891 
ut32_t
 
vmac_d
)

1893 
ut8_t
 
pdu
[60] = { 0 };

1894 
ut32_t
 
_vmac_c
 = 0;

1895 
ut32_t
 
_vmac_d
 = 0;

1896 
ut8_t
 
mesge_ty
 = 0;

1897 
ut16_t
 
ngth
 = 0;

1898 
n
 = 0, 
_n
 = 0;

1899 cڡ 
msg_n
 = 10;

1901 
n
 = 
	`bvlc6_code_vtu_addss_suti_ack
(
pdu
, (pdu),

1902 
vmac_c
, 
vmac_d
);

1903 
	`_
(
pTe
, 
n
 =
msg_n
);

1904 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

1905 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

1906 
	`_
(
pTe
, 
_n
 == 4);

1907 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_VIRTUAL_ADDRESS_RESOLUTION_ACK
);

1908 
	`_
(
pTe
, 
ngth
 =
msg_n
);

1909 
_n
 +
	`bvlc6_decode_vtu_addss_suti_ack
(&
pdu
[4], 
ngth
-4,

1910 &
_vmac_c
, &
_vmac_d
);

1911 
	`_
(
pTe
, 
n
 =
_n
);

1912 
	`_
(
pTe
, 
msg_n
 =
_n
);

1913 
	`_
(
pTe
, 
vmac_c
 =
_vmac_c
);

1914 
	`_
(
pTe
, 
vmac_d
 =
_vmac_d
);

1915 
	}
}

1917 
	$_BVLC6_Vtu_Addss_Resuti_Ack
(

1918 
Te
 * 
pTe
)

1920 
ut32_t
 
vmac_c
 = 0;

1921 
ut32_t
 
vmac_d
 = 0;

1923 
	`_BVLC6_Vtu_Addss_Resuti_Ack_Mesge
(
pTe
,

1924 
vmac_c
, 
vmac_d
);

1925 
vmac_c
 = 4194303;

1926 
vmac_d
 = 4194302;

1927 
	`_BVLC6_Vtu_Addss_Resuti_Ack_Mesge
(
pTe
,

1928 
vmac_c
, 
vmac_d
);

1929 
	}
}

1931 
	$_BVLC6_Fwded_NPDU_Mesge
(

1932 
Te
 * 
pTe
,

1933 
ut8_t
 * 
du
,

1934 
ut16_t
 
du_n
,

1935 
ut32_t
 
vmac_c
,

1936 
BACNET_IP6_ADDRESS
 * 
b6_addss
)

1938 
ut8_t
 
_du
[50] = { 0 };

1939 
ut8_t
 
pdu
[75] = { 0 };

1940 
ut32_t
 
_vmac_c
 = 0;

1941 
BACNET_IP6_ADDRESS
 
_b6_addss
 = {{0}};

1942 
ut16_t
 
_du_n
 = 0;

1943 
ut8_t
 
mesge_ty
 = 0;

1944 
ut16_t
 
ngth
 = 0;

1945 
n
 = 0, 
msg_n
 = 0, 
_n
 = 0;

1946 
ut16_t
 
i
 = 0;

1948 
n
 = 
	`bvlc6_code_fwded_du
(
pdu
, (pdu),

1949 
vmac_c
, 
b6_addss
,

1950 
du
, 
du_n
);

1951 
msg_n
 = 1+1+2+3+
BIP6_ADDRESS_MAX
+
du_n
;

1952 
	`_
(
pTe
, 
n
 =
msg_n
);

1953 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

1954 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

1955 
	`_
(
pTe
, 
_n
 == 4);

1956 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_FORWARDED_NPDU
);

1957 
	`_
(
pTe
, 
ngth
 =
msg_n
);

1958 
_n
 +
	`bvlc6_decode_fwded_du
(&
pdu
[4], 
ngth
-4,

1959 &
_vmac_c
, &
_b6_addss
,

1960 
_du
, e_du), &
_du_n
);

1961 
	`_
(
pTe
, 
n
 =
_n
);

1962 
	`_
(
pTe
, 
msg_n
 =
_n
);

1963 
	`_
(
pTe
, 
vmac_c
 =
_vmac_c
);

1964 
	`_BVLC6_Addss
(
pTe
, 
b6_addss
, &
_b6_addss
);

1965 
	`_
(
pTe
, 
du_n
 =
_du_n
);

1966 
i
 = 0; i < 
du_n
; i++) {

1967 
	`_
(
pTe
, 
du
[
i
] =
_du
[i]);

1969 
	}
}

1971 
	$_BVLC6_Fwded_NPDU
(

1972 
Te
 * 
pTe
)

1974 
ut8_t
 
du
[50] = { 0 };

1975 
ut32_t
 
vmac_c
 = 0;

1976 
BACNET_IP6_ADDRESS
 
b6_addss
 = {{0}};

1977 
ut16_t
 
du_n
 = 0;

1978 
ut16_t
 
i
 = 0;

1980 
	`_BVLC6_Fwded_NPDU_Mesge
(
pTe
,

1981 
du
, 
du_n
, 
vmac_c
, &
b6_addss
);

1982 
i
 = 0; i < (
b6_addss
.
addss
); i++) {

1983 
b6_addss
.
addss
[
i
] = i;

1985 
b6_addss
.
pt
 = 47808;

1987 
i
 = 0; i < (
du
); i++) {

1988 
du
[
i
] = i;

1990 
du_n
 = (
du
);

1991 
vmac_c
 = 4194303;

1992 
	`_BVLC6_Fwded_NPDU_Mesge
(
pTe
,

1993 
du
, 
du_n
, 
vmac_c
, &
b6_addss
);

1994 
	}
}

1996 
	$_BVLC6_Regi_Feign_Devi_Mesge
(

1997 
Te
 * 
pTe
,

1998 
ut32_t
 
vmac_c
,

1999 
ut16_t
 
l_cds
)

2001 
ut8_t
 
pdu
[60] = { 0 };

2002 
ut32_t
 
_vmac_c
 = 0;

2003 
ut16_t
 
_l_cds
 = 0;

2004 
ut8_t
 
mesge_ty
 = 0;

2005 
ut16_t
 
ngth
 = 0;

2006 
n
 = 0, 
_n
 = 0;

2007 cڡ 
msg_n
 = 9;

2009 
n
 = 
	`bvlc6_code_gi_feign_devi
(
pdu
, (pdu),

2010 
vmac_c
, 
l_cds
);

2011 
	`_
(
pTe
, 
n
 =
msg_n
);

2012 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

2013 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

2014 
	`_
(
pTe
, 
_n
 == 4);

2015 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_REGISTER_FOREIGN_DEVICE
);

2016 
	`_
(
pTe
, 
ngth
 =
msg_n
);

2017 
_n
 +
	`bvlc6_decode_gi_feign_devi
(&
pdu
[4], 
ngth
-4,

2018 &
_vmac_c
, &
_l_cds
);

2019 
	`_
(
pTe
, 
n
 =
_n
);

2020 
	`_
(
pTe
, 
msg_n
 =
_n
);

2021 
	`_
(
pTe
, 
vmac_c
 =
_vmac_c
);

2022 
	`_
(
pTe
, 
l_cds
 =
_l_cds
);

2023 
	}
}

2025 
	$_BVLC6_Regi_Feign_Devi
(

2026 
Te
 * 
pTe
)

2028 
ut32_t
 
vmac_c
 = 0;

2029 
ut16_t
 
l_cds
 = 0;

2031 
	`_BVLC6_Regi_Feign_Devi_Mesge
(
pTe
,

2032 
vmac_c
, 
l_cds
);

2033 
vmac_c
 = 4194303;

2034 
l_cds
 = 600;

2035 
	`_BVLC6_Regi_Feign_Devi_Mesge
(
pTe
,

2036 
vmac_c
, 
l_cds
);

2037 
	}
}

2039 
	$_BVLC6_De_Feign_Devi_Mesge
(

2040 
Te
 * 
pTe
,

2041 
ut32_t
 
vmac_c
,

2042 
BACNET_IP6_FOREIGN_DEVICE_TABLE_ENTRY
 *
fdt_y
)

2044 
ut8_t
 
pdu
[64] = { 0 };

2045 
ut32_t
 
_vmac_c
 = 0;

2046 
BACNET_IP6_FOREIGN_DEVICE_TABLE_ENTRY
 
_fdt_y
 = {0};

2047 
ut8_t
 
mesge_ty
 = 0;

2048 
ut16_t
 
ngth
 = 0;

2049 
n
 = 0, 
_n
 = 0;

2050 cڡ 
msg_n
 = 0x0019;

2052 
n
 = 
	`bvlc6_code_de_feign_devi
(
pdu
, (pdu),

2053 
vmac_c
, 
fdt_y
);

2054 
	`_
(
pTe
, 
n
 =
msg_n
);

2055 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

2056 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

2057 
	`_
(
pTe
, 
_n
 == 4);

2058 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_DELETE_FOREIGN_DEVICE
);

2059 
	`_
(
pTe
, 
ngth
 =
msg_n
);

2060 
_n
 +
	`bvlc6_decode_de_feign_devi
(&
pdu
[4], 
ngth
-4,

2061 &
_vmac_c
, &
_fdt_y
);

2062 
	`_
(
pTe
, 
n
 =
_n
);

2063 
	`_
(
pTe
, 
msg_n
 =
_n
);

2064 
	`_
(
pTe
, 
vmac_c
 =
_vmac_c
);

2065 
	`_BVLC6_Addss
(
pTe
, &
fdt_y
->
b6_addss
,

2066 &
_fdt_y
.
b6_addss
);

2067 
	`_
(
pTe
, 
fdt_y
->
l_cds
 =
_fdt_y
.ttl_seconds);

2068 
	`_
(
pTe
, 
fdt_y
->
l_cds_mag
 ==

2069 
_fdt_y
.
l_cds_mag
);

2070 
	}
}

2072 
	$_BVLC6_De_Feign_Devi
(

2073 
Te
 * 
pTe
)

2075 
ut32_t
 
vmac_c
 = 0;

2076 
BACNET_IP6_FOREIGN_DEVICE_TABLE_ENTRY
 
fdt_y
 = {0};

2077 
i
 = 0;

2080 
	`_BVLC6_De_Feign_Devi_Mesge
(
pTe
,

2081 
vmac_c
, &
fdt_y
);

2083 
vmac_c
 = 4194303;

2084 
i
 = 0; i < (
fdt_y
.
b6_addss
.
addss
); i++) {

2085 
fdt_y
.
b6_addss
.
addss
[
i
] = i;

2087 
fdt_y
.
b6_addss
.
pt
 = 47808;

2088 
fdt_y
.
l_cds
 = 600;

2089 
fdt_y
.
l_cds_mag
 = 42;

2090 
fdt_y
.
xt
 = 
NULL
;

2091 
	`_BVLC6_De_Feign_Devi_Mesge
(
pTe
,

2092 
vmac_c
, &
fdt_y
);

2093 
	}
}

2095 
	$_BVLC6_Secu_BVLL_Mesge
(

2096 
Te
 * 
pTe
,

2097 
ut8_t
 * 
sbuf
,

2098 
ut16_t
 
sbuf_n
)

2100 
ut8_t
 
_sbuf
[50] = { 0 };

2101 
ut8_t
 
pdu
[60] = { 0 };

2102 
ut16_t
 
_sbuf_n
 = 0;

2103 
ut8_t
 
mesge_ty
 = 0;

2104 
ut16_t
 
ngth
 = 0;

2105 
n
 = 0, 
msg_n
 = 0, 
_n
 = 0;

2106 
ut16_t
 
i
 = 0;

2108 
n
 = 
	`bvlc6_code_cu_bv
(
pdu
, (pdu),

2109 
sbuf
, 
sbuf_n
);

2110 
msg_n
 = 1+1+2+
sbuf_n
;

2111 
	`_
(
pTe
, 
n
 =
msg_n
);

2112 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

2113 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

2114 
	`_
(
pTe
, 
_n
 == 4);

2115 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_SECURE_BVLL
);

2116 
	`_
(
pTe
, 
ngth
 =
msg_n
);

2117 
_n
 +
	`bvlc6_decode_cu_bv
(&
pdu
[4], 
ngth
-4,

2118 
_sbuf
, e_sbuf), &
_sbuf_n
);

2119 
	`_
(
pTe
, 
n
 =
_n
);

2120 
	`_
(
pTe
, 
msg_n
 =
_n
);

2121 
	`_
(
pTe
, 
sbuf_n
 =
_sbuf_n
);

2122 
i
 = 0; i < 
sbuf_n
; i++) {

2123 
	`_
(
pTe
, 
sbuf
[
i
] =
_sbuf
[i]);

2125 
	}
}

2127 
	$_BVLC6_Secu_BVLL
(

2128 
Te
 * 
pTe
)

2130 
ut8_t
 
sbuf
[50] = { 0 };

2131 
ut16_t
 
sbuf_n
 = 0;

2132 
ut16_t
 
i
 = 0;

2134 
	`_BVLC6_Secu_BVLL_Mesge
(
pTe
,

2135 
sbuf
, 
sbuf_n
);

2137 
i
 = 0; i < (
sbuf
); i++) {

2138 
sbuf
[
i
] = i;

2140 
sbuf_n
 = (
sbuf
);

2141 
	`_BVLC6_Secu_BVLL_Mesge
(
pTe
,

2142 
sbuf
, 
sbuf_n
);

2143 
	}
}

2145 
	$_BVLC6_Diribu_Brd_To_Nwk_Mesge
(

2146 
Te
 * 
pTe
,

2147 
ut8_t
 * 
du
,

2148 
ut16_t
 
du_n
,

2149 
ut32_t
 
vmac
)

2151 
ut8_t
 
_du
[50] = { 0 };

2152 
ut8_t
 
pdu
[60] = { 0 };

2153 
ut32_t
 
_vmac
 = 0;

2154 
ut16_t
 
_du_n
 = 0;

2155 
ut8_t
 
mesge_ty
 = 0;

2156 
ut16_t
 
ngth
 = 0;

2157 
n
 = 0, 
msg_n
 = 0, 
_n
 = 0;

2158 
ut16_t
 
i
 = 0;

2160 
n
 = 
	`bvlc6_code_diribu_brd_to_twk
(
pdu
, (pdu),

2161 
vmac
, 
du
, 
du_n
);

2162 
msg_n
 = 7 + 
du_n
;

2163 
	`_
(
pTe
, 
n
 =
msg_n
);

2164 
_n
 = 
	`_BVLC6_Hd
(
pTe
,

2165 
pdu
, 
n
, &
mesge_ty
, &
ngth
);

2166 
	`_
(
pTe
, 
_n
 == 4);

2167 
	`_
(
pTe
, 
mesge_ty
 =
BVLC6_DISTRIBUTE_BROADCAST_TO_NETWORK
);

2168 
	`_
(
pTe
, 
ngth
 =
msg_n
);

2169 
_n
 +
	`bvlc6_decode_diribu_brd_to_twk
(

2170 &
pdu
[4], 
ngth
-4,

2171 &
_vmac
, 
_du
, e_du), &
_du_n
);

2172 
	`_
(
pTe
, 
n
 =
_n
);

2173 
	`_
(
pTe
, 
msg_n
 =
_n
);

2174 
	`_
(
pTe
, 
vmac
 =
_vmac
);

2175 
	`_
(
pTe
, 
du_n
 =
_du_n
);

2176 
i
 = 0; i < 
du_n
; i++) {

2177 
	`_
(
pTe
, 
du
[
i
] =
_du
[i]);

2179 
	}
}

2181 
	$_BVLC6_Diribu_Brd_To_Nwk
(

2182 
Te
 * 
pTe
)

2184 
ut8_t
 
du
[50] = { 0 };

2185 
ut32_t
 
vmac
 = 0;

2186 
ut16_t
 
du_n
 = 0;

2187 
ut16_t
 
i
 = 0;

2189 
	`_BVLC6_Diribu_Brd_To_Nwk_Mesge
(
pTe
,

2190 
du
, 
du_n
, 
vmac
);

2192 
i
 = 0; i < (
du
); i++) {

2193 
du
[
i
] = i;

2195 
du_n
 = (
du
);

2196 
vmac
 = 4194303;

2197 
	`_BVLC6_Diribu_Brd_To_Nwk_Mesge
(
pTe
,

2198 
du
, 
du_n
, 
vmac
);

2199 
	}
}

2201 
	$_BVLC6_Addss_Cy
(

2202 
Te
 * 
pTe
)

2204 
i
 = 0;

2205 
BACNET_IP6_ADDRESS
 
c
 = {{0}};

2206 
BACNET_IP6_ADDRESS
 
d
 = {{0}};

2207 
bo
 
us
 = 
l
;

2210 
us
 = 
	`bvlc6_addss_cy
(&
d
, &
c
);

2211 
	`_
(
pTe
, 
us
);

2212 
us
 = 
	`bvlc6_addss_dif
(&
d
, &
c
);

2213 
	`_
(
pTe
, !
us
);

2215 
i
 = 0; i < (
c
.
addss
); i++) {

2216 
c
.
addss
[
i
] = 1 + i;

2218 
c
.
pt
 = 47808;

2219 
us
 = 
	`bvlc6_addss_cy
(&
d
, &
c
);

2220 
	`_
(
pTe
, 
us
);

2221 
us
 = 
	`bvlc6_addss_dif
(&
d
, &
c
);

2222 
	`_
(
pTe
, !
us
);

2224 
d
.
pt
 = 47809;

2225 
us
 = 
	`bvlc6_addss_dif
(&
d
, &
c
);

2226 
	`_
(
pTe
, 
us
);

2228 
d
.
pt
 = 
c
.port;

2229 
i
 = 0; i < (
c
.
addss
); i++) {

2230 
d
.
addss
[
i
] = 0;

2231 
us
 = 
	`bvlc6_addss_dif
(&
d
, &
c
);

2232 
	`_
(
pTe
, 
us
);

2233 
d
.
addss
[
i
] = 1 + i;

2235 
	}
}

2237 
	$_BVLC6_Addss_G_S
(

2238 
Te
 * 
pTe
)

2240 
ut16_t
 
i
 = 0;

2241 
BACNET_IP6_ADDRESS
 
c
 = {{0}};

2242 
ut16_t
 
group
 = 1;

2243 
ut16_t
 
_group
 = 0;

2244 
bo
 
us
 = 
l
;

2246 
i
 = 0; i < 16; i++) {

2247 
us
 = 
	`bvlc6_addss_t
(&
c
,

2248 
group
, 0, 0, 0, 0, 0, 0, 0);

2249 
	`_
(
pTe
, 
us
);

2250 
us
 = 
	`bvlc6_addss_g
(&
c
,

2251 &
_group
, 
NULL
, NULL, NULL, NULL, NULL, NULL, NULL);

2252 
	`_
(
pTe
, 
us
);

2253 
	`_
(
pTe
, 
group
 =
_group
);

2254 
group
 = group<<1;

2256 
	}
}

2258 
	$_BVLC6_VMAC_Addss_G_S
(

2259 
Te
 * 
pTe
)

2261 
ut16_t
 
i
 = 0;

2262 
BACNET_ADDRESS
 
addr
;

2263 
ut32_t
 
devi_id
 = 1;

2264 
ut32_t
 
_devi_id
 = 0;

2265 
bo
 
us
 = 
l
;

2267 
i
 = 0; i < 24; i++) {

2268 
us
 = 
	`bvlc6_vmac_addss_t
(&
addr
, 
devi_id
);

2269 
	`_
(
pTe
, 
us
);

2270 
	`_
(
pTe
, 
addr
.
mac_n
 == 3);

2271 
	`_
(
pTe
, 
addr
.
t
 == 0);

2272 
	`_
(
pTe
, 
addr
.
n
 == 0);

2273 
us
 = 
	`bvlc6_vmac_addss_g
(&
addr
, &
_devi_id
);

2274 
	`_
(
pTe
, 
us
);

2275 
	`_
(
pTe
, 
devi_id
 =
_devi_id
);

2276 
devi_id
 = device_id<<1;

2278 
	}
}

2280 
	$_BVLC6
(

2281 
Te
 * 
pTe
)

2283 
bo
 
rc
;

2286 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Resu
);

2287 
	`as
(
rc
);

2288 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Orig_Uni_NPDU
);

2289 
	`as
(
rc
);

2290 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Orig_Brd_NPDU
);

2291 
	`as
(
rc
);

2292 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Addss_Resuti
);

2293 
	`as
(
rc
);

2294 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Fwded_Addss_Resuti
);

2295 
	`as
(
rc
);

2296 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Addss_Resuti_Ack
);

2297 
	`as
(
rc
);

2298 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Vtu_Addss_Resuti
);

2299 
	`as
(
rc
);

2300 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Vtu_Addss_Resuti_Ack
);

2301 
	`as
(
rc
);

2302 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Fwded_NPDU
);

2303 
	`as
(
rc
);

2304 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Regi_Feign_Devi
);

2305 
	`as
(
rc
);

2306 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_De_Feign_Devi
);

2307 
	`as
(
rc
);

2308 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Secu_BVLL
);

2309 
	`as
(
rc
);

2310 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Diribu_Brd_To_Nwk
);

2311 
	`as
(
rc
);

2312 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Addss_Cy
);

2313 
	`as
(
rc
);

2314 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_Addss_G_S
);

2315 
	`as
(
rc
);

2316 
rc
 = 
	`_addTeFuni
(
pTe
, 
_BVLC6_VMAC_Addss_G_S
);

2317 
	`as
(
rc
);

2318 
	}
}

2320 #ifde
TEST_BVLC6


2321 
	$ma
(

2324 
Te
 *
pTe
;

2326 
pTe
 = 
	`_
("BACÈVtu Lk Cڌ IP/v6", 
NULL
);

2327 
	`_BVLC6
(
pTe
);

2329 
	`_tSm
(
pTe
, 
dout
);

2330 
	`_run
(
pTe
);

2331 (
	`_pt
(
pTe
);

2332 
	`_deroy
(
pTe
);

2335 
	}
}

	@src/cov.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"ba.h
"

39 
	~"cov.h
"

49 
	$nify_code_du
(

50 
ut8_t
 * 
du
,

51 
BACNET_COV_DATA
 * 
da
)

53 
n
 = 0;

54 
du_n
 = 0;

55 
BACNET_PROPERTY_VALUE
 *
vue
 = 
NULL
;

56 
BACNET_APPLICATION_DATA_VALUE
 *
p_da
 = 
NULL
;

58 i(
du
) {

60 
n
 =

61 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0,

62 
da
->
subsibProssIdtifr
);

63 
du_n
 +
n
;

65 
n
 =

66 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 1, 
OBJECT_DEVICE
,

67 
da
->
tgDeviIdtifr
);

68 
du_n
 +
n
;

70 
n
 =

71 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 2,

72 (
da
->
mڙedObjeIdtifr
.
ty
,

73 
da
->
mڙedObjeIdtifr
.

);

74 
du_n
 +
n
;

76 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 3, 
da
->
timeRemag
);

77 
du_n
 +
n
;

79 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 4);

80 
du_n
 +
n
;

85 
vue
 = 
da
->
liOfVues
;

86 
vue
 !
NULL
) {

88 
n
 =

89 
	`code_cڋxt_umed
(&
du
[
du_n
], 0,

90 
vue
->
ݔtyIdtifr
);

91 
du_n
 +
n
;

93 i(
vue
->
ݔtyAayIndex
 !
BACNET_ARRAY_ALL
) {

94 
n
 =

95 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1,

96 
vue
->
ݔtyAayIndex
);

97 
du_n
 +
n
;

101 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 2);

102 
du_n
 +
n
;

103 
p_da
 = &
vue
->value;

104 
p_da
 !
NULL
)

106 
n
 =

107 
	`ba_code_iti_da
(&
du
[
du_n
], 
p_da
);

108 
du_n
 +
n
;

109 
p_da
 =_da->
xt
;

112 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 2);

113 
du_n
 +
n
;

115 i(
vue
->
iܙy
 !
BACNET_NO_PRIORITY
) {

116 
n
 =

117 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 3,

118 
vue
->
iܙy
);

119 
du_n
 +
n
;

123 
vue
 = vue->
xt
;

125 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 4);

126 
du_n
 +
n
;

129  
du_n
;

130 
	}
}

132 
	$ccov_nify_code_du
(

133 
ut8_t
 * 
du
,

134 
ut8_t
 
voke_id
,

135 
BACNET_COV_DATA
 * 
da
)

137 
n
 = 0;

138 
du_n
 = 0;

140 i(
du
) {

141 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

142 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

143 
du
[2] = 
voke_id
;

144 
du
[3] = 
SERVICE_CONFIRMED_COV_NOTIFICATION
;

145 
du_n
 = 4;

146 
n
 = 
	`nify_code_du
(&
du
[
du_n
], 
da
);

147 
du_n
 +
n
;

150  
du_n
;

151 
	}
}

153 
	$ucov_nify_code_du
(

154 
ut8_t
 * 
du
,

155 
BACNET_COV_DATA
 * 
da
)

157 
n
 = 0;

158 
du_n
 = 0;

160 i(
du
 && 
da
) {

161 
du
[0] = 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
;

162 
du
[1] = 
SERVICE_UNCONFIRMED_COV_NOTIFICATION
;

163 
du_n
 = 2;

164 
n
 = 
	`nify_code_du
(&
du
[
du_n
], 
da
);

165 
du_n
 +
n
;

168  
du_n
;

169 
	}
}

173 
	$cov_nify_decode_rvi_que
(

174 
ut8_t
 * 
du
,

175 
du_n
,

176 
BACNET_COV_DATA
 * 
da
)

178 
n
 = 0;

179 
p_n
 = 0;

180 
ut8_t
 
g_numb
 = 0;

181 
ut32_t
 
n_vue
 = 0;

182 
ut32_t
 
decoded_vue
 = 0;

183 
ut16_t
 
decoded_ty
 = 0;

184 
ut32_t
 
ݔty
 = 0;

185 
BACNET_PROPERTY_VALUE
 *
vue
 = 
NULL
;

186 
BACNET_APPLICATION_DATA_VALUE
 *
p_da
 = 
NULL
;

188 i(
du_n
 && 
da
) {

190 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 0)) {

191 
n
 +=

192 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

193 &
n_vue
);

194 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

195 
da
->
subsibProssIdtifr
 = 
decoded_vue
;

197  
BACNET_STATUS_ERROR
;

200 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 1)) {

201 
n
 +=

202 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

203 &
n_vue
);

204 
n
 +=

205 
	`decode_obje_id
(&
du
[
n
], &
decoded_ty
,

206 &
da
->
tgDeviIdtifr
);

207 i(
decoded_ty
 !
OBJECT_DEVICE
) {

208  
BACNET_STATUS_ERROR
;

211  
BACNET_STATUS_ERROR
;

214 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 2)) {

215 
n
 +=

216 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

217 &
n_vue
);

218 
n
 +=

219 
	`decode_obje_id
(&
du
[
n
], &
decoded_ty
,

220 &
da
->
mڙedObjeIdtifr
.

);

221 
da
->
mڙedObjeIdtifr
.
ty
 = 
decoded_ty
;

223  
BACNET_STATUS_ERROR
;

226 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 3)) {

227 
n
 +=

228 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

229 &
n_vue
);

230 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

231 
da
->
timeRemag
 = 
decoded_vue
;

233  
BACNET_STATUS_ERROR
;

236 i(!
	`decode_is_ݒg_g_numb
(&
du
[
n
], 4)) {

237  
BACNET_STATUS_ERROR
;

240 
n
++;

242 
vue
 = 
da
->
liOfVues
;

243 i(
vue
 =
NULL
) {

245  
BACNET_STATUS_ERROR
;

247 
vue
 !
NULL
) {

249 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 0)) {

250 
n
 +=

251 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

252 &
n_vue
);

253 
n
 +
	`decode_umed
(&
du
[n], 
n_vue
, &
ݔty
);

254 
vue
->
ݔtyIdtifr
 = (
BACNET_PROPERTY_ID

ݔty
;

256  
BACNET_STATUS_ERROR
;

259 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 1)) {

260 
n
 +=

261 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

262 &
n_vue
);

263 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

264 
vue
->
ݔtyAayIndex
 = 
decoded_vue
;

266 
vue
->
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

269 i(!
	`decode_is_ݒg_g_numb
(&
du
[
n
], 2)) {

270  
BACNET_STATUS_ERROR
;

273 
n
++;

274 
p_da
 = &
vue
->value;

275 !
	`decode_is_osg_g_numb
(&
du
[
n
], 2))

277 i(
p_da
 =
NULL
) {

279  
BACNET_STATUS_ERROR
;

281 
p_n
 =

282 
	`ba_decode_iti_da
(&
du
[
n
], 
du_n
 -, 
p_da
);

283 i(
p_n
 < 0)

285  
BACNET_STATUS_ERROR
;

287 
n
 +
p_n
;

289 
p_da
 =_da->
xt
;

292 
n
++;

294 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 3)) {

295 
n
 +=

296 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

297 &
n_vue
);

298 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

299 
vue
->
iܙy
 = (
ut8_t

decoded_vue
;

301 
vue
->
iܙy
 = 
BACNET_NO_PRIORITY
;

304 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 4)) {

305 
vue
->
xt
 = 
NULL
;

309 
vue
 = vue->
xt
;

310 i(
vue
 =
NULL
) {

312  
BACNET_STATUS_ERROR
;

317  
n
;

318 
	}
}

342 
	$cov_subsibe_code_du
(

343 
ut8_t
 * 
du
,

344 
ut8_t
 
voke_id
,

345 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
)

347 
n
 = 0;

348 
du_n
 = 0;

350 i(
du
 && 
da
) {

351 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

352 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

353 
du
[2] = 
voke_id
;

354 
du
[3] = 
SERVICE_CONFIRMED_SUBSCRIBE_COV
;

355 
du_n
 = 4;

357 
n
 =

358 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0,

359 
da
->
subsibProssIdtifr
);

360 
du_n
 +
n
;

362 
n
 =

363 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 1,

364 (
da
->
mڙedObjeIdtifr
.
ty
,

365 
da
->
mڙedObjeIdtifr
.

);

366 
du_n
 +
n
;

372 i(!
da
->
nΩiReque
) {

374 
n
 =

375 
	`code_cڋxt_boޗn
(&
du
[
du_n
], 2,

376 
da
->
issueCfmedNifitis
);

377 
du_n
 +
n
;

379 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 3, 
da
->
litime
);

380 
du_n
 +
n
;

384  
du_n
;

385 
	}
}

388 
	$cov_subsibe_decode_rvi_que
(

389 
ut8_t
 * 
du
,

390 
du_n
,

391 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
)

393 
n
 = 0;

394 
ut8_t
 
g_numb
 = 0;

395 
ut32_t
 
n_vue
 = 0;

396 
ut32_t
 
decoded_vue
 = 0;

397 
ut16_t
 
decoded_ty
 = 0;

399 i(
du_n
 && 
da
) {

401 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 0)) {

402 
n
 +=

403 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

404 &
n_vue
);

405 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

406 
da
->
subsibProssIdtifr
 = 
decoded_vue
;

408 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

409  
BACNET_STATUS_REJECT
;

412 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 1)) {

413 
n
 +=

414 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

415 &
n_vue
);

416 
n
 +=

417 
	`decode_obje_id
(&
du
[
n
], &
decoded_ty
,

418 &
da
->
mڙedObjeIdtifr
.

);

419 
da
->
mڙedObjeIdtifr
.
ty
 = 
decoded_ty
;

421 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

422  
BACNET_STATUS_REJECT
;

425 i((
n
 < 
du_n
) {

427 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 2)) {

428 
da
->
nΩiReque
 = 
l
;

429 
n
 +=

430 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

431 &
n_vue
);

432 
da
->
issueCfmedNifitis
 =

433 
	`decode_cڋxt_boޗn
(&
du
[
n
]);

434 
n
 +
n_vue
;

436 
da
->
nΩiReque
 = 
ue
;

439 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 3)) {

440 
n
 +=

441 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

442 &
n_vue
);

443 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

444 
da
->
litime
 = 
decoded_vue
;

446 
da
->
litime
 = 0;

449 
da
->
nΩiReque
 = 
ue
;

453  
n
;

454 
	}
}

476 
	$cov_subsibe_ݔty_code_du
(

477 
ut8_t
 * 
du
,

478 
ut8_t
 
voke_id
,

479 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
)

481 
n
 = 0;

482 
du_n
 = 0;

484 i(
du
 && 
da
) {

485 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

486 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

487 
du
[2] = 
voke_id
;

488 
du
[3] = 
SERVICE_CONFIRMED_SUBSCRIBE_COV_PROPERTY
;

489 
du_n
 = 4;

491 
n
 =

492 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0,

493 
da
->
subsibProssIdtifr
);

494 
du_n
 +
n
;

496 
n
 =

497 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 1,

498 (
da
->
mڙedObjeIdtifr
.
ty
,

499 
da
->
mڙedObjeIdtifr
.

);

500 
du_n
 +
n
;

501 i(!
da
->
nΩiReque
) {

503 
n
 =

504 
	`code_cڋxt_boޗn
(&
du
[
du_n
], 2,

505 
da
->
issueCfmedNifitis
);

506 
du_n
 +
n
;

508 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 3, 
da
->
litime
);

509 
du_n
 +
n
;

512 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 4);

513 
du_n
 +
n
;

514 
n
 =

515 
	`code_cڋxt_umed
(&
du
[
du_n
], 0,

516 
da
->
mڙedPrݔty
.
ݔtyIdtifr
);

517 
du_n
 +
n
;

518 i(
da
->
mڙedPrݔty
.
ݔtyAayIndex
 !
BACNET_ARRAY_ALL
) {

519 
n
 =

520 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1,

521 
da
->
mڙedPrݔty
.
ݔtyAayIndex
);

522 
du_n
 +
n
;

525 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 4);

526 
du_n
 +
n
;

529 i(
da
->
covInemtP
) {

530 
n
 = 
	`code_cڋxt_
(&
du
[
du_n
], 5, 
da
->
covInemt
);

531 
du_n
 +
n
;

535  
du_n
;

536 
	}
}

539 
	$cov_subsibe_ݔty_decode_rvi_que
(

540 
ut8_t
 * 
du
,

541 
du_n
,

542 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
)

544 
n
 = 0;

545 
ut8_t
 
g_numb
 = 0;

546 
ut32_t
 
n_vue
 = 0;

547 
ut32_t
 
decoded_vue
 = 0;

548 
ut16_t
 
decoded_ty
 = 0;

549 
ut32_t
 
ݔty
 = 0;

551 i(
du_n
 && 
da
) {

553 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 0)) {

554 
n
 +=

555 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

556 &
n_vue
);

557 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

558 
da
->
subsibProssIdtifr
 = 
decoded_vue
;

560 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

561  
BACNET_STATUS_REJECT
;

564 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 1)) {

565 
n
 +=

566 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

567 &
n_vue
);

568 
n
 +=

569 
	`decode_obje_id
(&
du
[
n
], &
decoded_ty
,

570 &
da
->
mڙedObjeIdtifr
.

);

571 
da
->
mڙedObjeIdtifr
.
ty
 = 
decoded_ty
;

573 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

574  
BACNET_STATUS_REJECT
;

577 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 2)) {

578 
da
->
nΩiReque
 = 
l
;

579 
n
 +=

580 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

581 &
n_vue
);

582 
da
->
issueCfmedNifitis
 =

583 
	`decode_cڋxt_boޗn
(&
du
[
n
]);

584 
n
++;

586 
da
->
nΩiReque
 = 
ue
;

589 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 3)) {

590 
n
 +=

591 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

592 &
n_vue
);

593 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

594 
da
->
litime
 = 
decoded_vue
;

596 
da
->
litime
 = 0;

599 i(!
	`decode_is_ݒg_g_numb
(&
du
[
n
], 4)) {

600 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

601  
BACNET_STATUS_REJECT
;

604 
n
++;

606 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 0)) {

607 
n
 +=

608 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

609 &
n_vue
);

610 
n
 +
	`decode_umed
(&
du
[n], 
n_vue
, &
ݔty
);

611 
da
->
mڙedPrݔty
.
ݔtyIdtifr
 =

612 (
BACNET_PROPERTY_ID

ݔty
;

614 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

615  
BACNET_STATUS_REJECT
;

618 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 1)) {

619 
n
 +=

620 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

621 &
n_vue
);

622 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

623 
da
->
mڙedPrݔty
.
ݔtyAayIndex
 = 
decoded_vue
;

625 
da
->
mڙedPrݔty
.
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

628 i(!
	`decode_is_osg_g_numb
(&
du
[
n
], 4)) {

629 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

630  
BACNET_STATUS_REJECT
;

633 
n
++;

635 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 5)) {

636 
da
->
covInemtP
 = 
ue
;

637 
n
 +=

638 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

639 &
n_vue
);

640 
n
 +
	`decode_
(&
du
[n], &
da
->
covInemt
);

642 
da
->
covInemtP
 = 
l
;

646  
n
;

647 
	}
}

659 
	$cov_da_vue_li_lk
(

660 
BACNET_COV_DATA
 *
da
,

661 
BACNET_PROPERTY_VALUE
 *
vue_li
,

662 
size_t
 
cou
)

664 
BACNET_PROPERTY_VALUE
 *
cut_vue_li
 = 
NULL
;

666 i(
da
 && 
vue_li
) {

667 
da
->
liOfVues
 = 
vue_li
;

668 
cou
) {

669 i(
cou
 > 1) {

670 
cut_vue_li
 = 
vue_li
;

671 
vue_li
++;

672 
cut_vue_li
->
xt
 = 
vue_li
;

674 
vue_li
->
xt
 = 
NULL
;

676 
cou
--;

679 
	}
}

681 #ifde
TEST


682 
	~<as.h
>

683 
	~<rg.h
>

684 
	~"e.h
"

685 
	~"ba.h
"

687 
	$ccov_nify_decode_du
(

688 
ut8_t
 * 
du
,

689 
du_n
,

690 
ut8_t
 * 
voke_id
,

691 
BACNET_COV_DATA
 * 
da
)

693 
n
 = 0;

694 
offt
 = 0;

696 i(!
du
) {

700 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

703 *
voke_id
 = 
du
[2];

704 i(
du
[3] !
SERVICE_CONFIRMED_COV_NOTIFICATION
)

706 
offt
 = 4;

709 i(
du_n
 > 
offt
) {

710 
n
 =

711 
	`cov_nify_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

712 
da
);

715  
n
;

716 
	}
}

718 
	$ucov_nify_decode_du
(

719 
ut8_t
 * 
du
,

720 
du_n
,

721 
BACNET_COV_DATA
 * 
da
)

723 
n
 = 0;

724 
offt
 = 0;

726 i(!
du
)

729 i(
du
[0] !
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
)

731 i(
du
[1] !
SERVICE_UNCONFIRMED_COV_NOTIFICATION
)

734 
offt
 = 2;

735 i(
du_n
 > 
offt
) {

736 
n
 =

737 
	`cov_nify_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

738 
da
);

741  
n
;

742 
	}
}

744 
	$cov_subsibe_decode_du
(

745 
ut8_t
 * 
du
,

746 
du_n
,

747 
ut8_t
 * 
voke_id
,

748 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
)

750 
n
 = 0;

751 
offt
 = 0;

753 i(!
du
)

756 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

759 *
voke_id
 = 
du
[2];

760 i(
du
[3] !
SERVICE_CONFIRMED_SUBSCRIBE_COV
)

762 
offt
 = 4;

765 i(
du_n
 > 
offt
) {

766 
n
 =

767 
	`cov_subsibe_decode_rvi_que
(&
du
[
offt
],

768 
du_n
 - 
offt
, 
da
);

771  
n
;

772 
	}
}

774 
	$cov_subsibe_ݔty_decode_du
(

775 
ut8_t
 * 
du
,

776 
du_n
,

777 
ut8_t
 * 
voke_id
,

778 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
)

780 
n
 = 0;

781 
offt
 = 0;

783 i(!
du
)

786 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

789 *
voke_id
 = 
du
[2];

790 i(
du
[3] !
SERVICE_CONFIRMED_SUBSCRIBE_COV_PROPERTY
)

792 
offt
 = 4;

795 i(
du_n
 > 
offt
) {

796 
n
 =

797 
	`cov_subsibe_ݔty_decode_rvi_que
(&
du
[
offt
],

798 
du_n
 - 
offt
, 
da
);

801  
n
;

802 
	}
}

804 
	$COVNifyDa
(

805 
Te
 * 
pTe
,

806 
BACNET_COV_DATA
 * 
da
,

807 
BACNET_COV_DATA
 * 
_da
)

809 
BACNET_PROPERTY_VALUE
 *
vue
 = 
NULL
;

810 
BACNET_PROPERTY_VALUE
 *
_vue
 = 
NULL
;

812 
	`_
(
pTe
,

813 
_da
->
subsibProssIdtifr
 ==

814 
da
->
subsibProssIdtifr
);

815 
	`_
(
pTe
,

816 
_da
->
tgDeviIdtifr
 ==

817 
da
->
tgDeviIdtifr
);

818 
	`_
(
pTe
,

819 
_da
->
mڙedObjeIdtifr
.
ty
 ==

820 
da
->
mڙedObjeIdtifr
.
ty
);

821 
	`_
(
pTe
,

822 
_da
->
mڙedObjeIdtifr
.

 ==

823 
da
->
mڙedObjeIdtifr
.

);

824 
	`_
(
pTe
, 
_da
->
timeRemag
 =
da
->timeRemaining);

826 
vue
 = 
da
->
liOfVues
;

827 
_vue
 = 
_da
->
liOfVues
;

828 
vue
) {

829 
	`_
(
pTe
, 
_vue
);

830 i(
_vue
) {

831 
	`_
(
pTe
,

832 
_vue
->
ݔtyIdtifr
 =
vue
->propertyIdentifier);

833 
	`_
(
pTe
,

834 
_vue
->
ݔtyAayIndex
 =
vue
->propertyArrayIndex);

835 
	`_
(
pTe
,

836 
_vue
->
iܙy
 =
vue
->priority);

837 
	`_
(
pTe
,

838 
	`ba_me_vue
(&
_vue
->
vue
, &value->value));

839 
_vue
 =e_vue->
xt
;

841 
vue
 = vue->
xt
;

843 
	}
}

845 
	$UCOVNifyDa
(

846 
Te
 * 
pTe
,

847 
BACNET_COV_DATA
 * 
da
)

849 
ut8_t
 
du
[480] = { 0 };

850 
n
 = 0;

851 
du_n
 = 0;

852 
BACNET_COV_DATA
 
_da
;

853 
BACNET_PROPERTY_VALUE
 
vue_li
[5] = {{0}};

855 
n
 = 
	`ucov_nify_code_du
(&
du
[0], 
da
);

856 
	`_
(
pTe
, 
n
 > 0);

857 
du_n
 = 
n
;

859 
	`cov_da_vue_li_lk
(&
_da
, &
vue_li
[0], 5);

860 
n
 = 
	`ucov_nify_decode_du
(&
du
[0], 
du_n
, &
_da
);

861 
	`_
(
pTe
, 
n
 != -1);

862 
	`COVNifyDa
(
pTe
, 
da
, &
_da
);

863 
	}
}

865 
	$CCOVNifyDa
(

866 
Te
 * 
pTe
,

867 
ut8_t
 
voke_id
,

868 
BACNET_COV_DATA
 * 
da
)

870 
ut8_t
 
du
[480] = { 0 };

871 
n
 = 0;

872 
du_n
 = 0;

873 
BACNET_COV_DATA
 
_da
;

874 
BACNET_PROPERTY_VALUE
 
vue_li
[2] = {{0}};

875 
ut8_t
 
_voke_id
 = 0;

877 
n
 = 
	`ccov_nify_code_du
(&
du
[0], 
voke_id
, 
da
);

878 
	`_
(
pTe
, 
n
 != 0);

879 
du_n
 = 
n
;

881 
	`cov_da_vue_li_lk
(&
_da
, &
vue_li
[0], 2);

882 
n
 =

883 
	`ccov_nify_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

884 &
_da
);

885 
	`_
(
pTe
, 
n
 > 0);

886 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

887 
	`COVNifyDa
(
pTe
, 
da
, &
_da
);

888 
	}
}

890 
	$COVNify
(

891 
Te
 * 
pTe
)

893 
ut8_t
 
voke_id
 = 12;

894 
BACNET_COV_DATA
 
da
;

895 
BACNET_PROPERTY_VALUE
 
vue_li
[2] = {{0}};

897 
da
.
subsibProssIdtifr
 = 1;

898 
da
.
tgDeviIdtifr
 = 123;

899 
da
.
mڙedObjeIdtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

900 
da
.
mڙedObjeIdtifr
.

 = 321;

901 
da
.
timeRemag
 = 456;

903 
	`cov_da_vue_li_lk
(&
da
, &
vue_li
[0], 2);

905 
vue_li
[0].
ݔtyIdtifr
 = 
PROP_PRESENT_VALUE
;

906 
vue_li
[0].
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

907 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_REAL
, "21.0",

908 &
vue_li
[0].
vue
);

909 
vue_li
[0].
iܙy
 = 0;

911 
vue_li
[1].
ݔtyIdtifr
 = 
PROP_STATUS_FLAGS
;

912 
vue_li
[1].
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

913 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_BIT_STRING
, "0000",

914 &
vue_li
[1].
vue
);

915 
vue_li
[1].
iܙy
 = 0;

917 
	`UCOVNifyDa
(
pTe
, &
da
);

918 
	`CCOVNifyDa
(
pTe
, 
voke_id
, &
da
);

919 
	}
}

921 
	$COVSubsibeDa
(

922 
Te
 * 
pTe
,

923 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
,

924 
BACNET_SUBSCRIBE_COV_DATA
 * 
_da
)

926 
	`_
(
pTe
,

927 
_da
->
subsibProssIdtifr
 ==

928 
da
->
subsibProssIdtifr
);

929 
	`_
(
pTe
,

930 
_da
->
mڙedObjeIdtifr
.
ty
 ==

931 
da
->
mڙedObjeIdtifr
.
ty
);

932 
	`_
(
pTe
,

933 
_da
->
mڙedObjeIdtifr
.

 ==

934 
da
->
mڙedObjeIdtifr
.

);

935 
	`_
(
pTe
,

936 
_da
->
nΩiReque
 =
da
->cancellationRequest);

937 i(
_da
->
nΩiReque
 !
da
->cancellationRequest) {

938 
	`tf
("cancellationequest failed!\n");

940 i(!
_da
->
nΩiReque
) {

941 
	`_
(
pTe
,

942 
_da
->
issueCfmedNifitis
 ==

943 
da
->
issueCfmedNifitis
);

944 
	`_
(
pTe
, 
_da
->
litime
 =
da
->lifetime);

946 
	}
}

948 
	$COVSubsibePrݔtyDa
(

949 
Te
 * 
pTe
,

950 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
,

951 
BACNET_SUBSCRIBE_COV_DATA
 * 
_da
)

953 
	`COVSubsibeDa
(
pTe
, 
da
, 
_da
);

954 
	`_
(
pTe
,

955 
_da
->
mڙedPrݔty
.
ݔtyIdtifr
 ==

956 
da
->
mڙedPrݔty
.
ݔtyIdtifr
);

957 
	`_
(
pTe
,

958 
_da
->
mڙedPrݔty
.
ݔtyAayIndex
 ==

959 
da
->
mڙedPrݔty
.
ݔtyAayIndex
);

960 
	`_
(
pTe
,

961 
_da
->
covInemtP
 =
da
->covIncrementPresent);

962 i(
_da
->
covInemtP
) {

963 
	`_
(
pTe
, 
_da
->
covInemt
 =
da
->covIncrement);

965 
	}
}

967 
	$COVSubsibeEncodg
(

968 
Te
 * 
pTe
,

969 
ut8_t
 
voke_id
,

970 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
)

972 
ut8_t
 
du
[480] = { 0 };

973 
n
 = 0;

974 
du_n
 = 0;

975 
BACNET_SUBSCRIBE_COV_DATA
 
_da
;

976 
ut8_t
 
_voke_id
 = 0;

978 
n
 = 
	`cov_subsibe_code_du
(&
du
[0], 
voke_id
, 
da
);

979 
	`_
(
pTe
, 
n
 != 0);

980 
du_n
 = 
n
;

982 
n
 =

983 
	`cov_subsibe_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

984 &
_da
);

985 
	`_
(
pTe
, 
n
 > 0);

986 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

987 
	`COVSubsibeDa
(
pTe
, 
da
, &
_da
);

988 
	}
}

990 
	$COVSubsibePrݔtyEncodg
(

991 
Te
 * 
pTe
,

992 
ut8_t
 
voke_id
,

993 
BACNET_SUBSCRIBE_COV_DATA
 * 
da
)

995 
ut8_t
 
du
[480] = { 0 };

996 
n
 = 0;

997 
du_n
 = 0;

998 
BACNET_SUBSCRIBE_COV_DATA
 
_da
;

999 
ut8_t
 
_voke_id
 = 0;

1001 
n
 = 
	`cov_subsibe_ݔty_code_du
(&
du
[0], 
voke_id
, 
da
);

1002 
	`_
(
pTe
, 
n
 != 0);

1003 
du_n
 = 
n
;

1005 
n
 =

1006 
	`cov_subsibe_ݔty_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

1007 &
_da
);

1008 
	`_
(
pTe
, 
n
 > 0);

1009 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

1010 
	`COVSubsibePrݔtyDa
(
pTe
, 
da
, &
_da
);

1011 
	}
}

1013 
	$COVSubsibe
(

1014 
Te
 * 
pTe
)

1016 
ut8_t
 
voke_id
 = 12;

1017 
BACNET_SUBSCRIBE_COV_DATA
 
da
;

1019 
da
.
subsibProssIdtifr
 = 1;

1020 
da
.
mڙedObjeIdtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

1021 
da
.
mڙedObjeIdtifr
.

 = 321;

1022 
da
.
nΩiReque
 = 
l
;

1023 
da
.
issueCfmedNifitis
 = 
ue
;

1024 
da
.
litime
 = 456;

1026 
	`COVSubsibeEncodg
(
pTe
, 
voke_id
, &
da
);

1027 
da
.
nΩiReque
 = 
ue
;

1028 
	`COVSubsibeEncodg
(
pTe
, 
voke_id
, &
da
);

1029 
	}
}

1031 
	$COVSubsibePrݔty
(

1032 
Te
 * 
pTe
)

1034 
ut8_t
 
voke_id
 = 12;

1035 
BACNET_SUBSCRIBE_COV_DATA
 
da
;

1037 
da
.
subsibProssIdtifr
 = 1;

1038 
da
.
mڙedObjeIdtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

1039 
da
.
mڙedObjeIdtifr
.

 = 321;

1040 
da
.
nΩiReque
 = 
l
;

1041 
da
.
issueCfmedNifitis
 = 
ue
;

1042 
da
.
litime
 = 456;

1043 
da
.
mڙedPrݔty
.
ݔtyIdtifr
 = 
PROP_FILE_SIZE
;

1044 
da
.
mڙedPrݔty
.
ݔtyAayIndex
 = 
BACNET_ARRAY_ALL
;

1045 
da
.
covInemtP
 = 
ue
;

1046 
da
.
covInemt
 = 1.0;

1048 
	`COVSubsibePrݔtyEncodg
(
pTe
, 
voke_id
, &
da
);

1050 
da
.
nΩiReque
 = 
ue
;

1051 
	`COVSubsibePrݔtyEncodg
(
pTe
, 
voke_id
, &
da
);

1053 
da
.
nΩiReque
 = 
l
;

1054 
da
.
covInemtP
 = 
l
;

1055 
	`COVSubsibePrݔtyEncodg
(
pTe
, 
voke_id
, &
da
);

1056 
	}
}

1058 #ifde
TEST_COV


1059 
	$ma
(

1060 
gc
,

1061 *
gv
[])

1063 
Te
 *
pTe
;

1064 
bo
 
rc
;

1066 
pTe
 = 
	`_
("BACÈCOV", 
NULL
);

1068 
rc
 = 
	`_addTeFuni
(
pTe
, 
COVNify
);

1069 
	`as
(
rc
);

1070 
rc
 = 
	`_addTeFuni
(
pTe
, 
COVSubsibe
);

1071 
	`as
(
rc
);

1072 
rc
 = 
	`_addTeFuni
(
pTe
, 
COVSubsibePrݔty
);

1073 
	`as
(
rc
);

1075 
	`_tSm
(
pTe
, 
dout
);

1076 
	`_run
(
pTe
);

1077 (
	`_pt
(
pTe
);

1078 
	`_deroy
(
pTe
);

1081 
	}
}

	@src/crc.c

35 
	~<ddef.h
>

36 
	~<dt.h
>

37 
	~<dbo.h
>

38 
	~"c.h
"

42 #i
defed
(
CRC_USE_TABLE
)

44 cڡ 
ut8_t
 
	gHdCRC
[256] = {

79 
ut8_t
 
	$CRC_Cc_Hd
(

80 
ut8_t
 
daVue
,

81 
ut8_t
 
cVue
)

83  
HdCRC
[
cVue
 ^ 
daVue
];

84 
	}
}

87 cڡ 
ut16_t
 
	gDaCRC
[256] = {

122 
ut16_t
 
	$CRC_Cc_Da
(

123 
ut8_t
 
daVue
,

124 
ut16_t
 
cVue
)

126  ((
cVue
 >> 8^ 
DaCRC
[(cVu& 0x00FF^ 
daVue
]);

128 
	}
}

135 
ut8_t
 
	$CRC_Cc_Hd
(

136 
ut8_t
 
daVue
,

137 
ut8_t
 
cVue
)

139 
ut16_t
 
c
;

141 
c
 = 
cVue
 ^ 
daVue
;

144 
c
 = crc ^ (crc << 1) ^ (crc << 2) ^ (crc << 3)

145 ^ (
c
 << 4) ^ (crc << 5) ^ (crc << 6)

146 ^ (
c
 << 7);

149  (
c
 & 0xfe) ^ ((crc >> 8) & 1);

150 
	}
}

157 
ut16_t
 
	$CRC_Cc_Da
(

158 
ut8_t
 
daVue
,

159 
ut16_t
 
cVue
)

161 
ut16_t
 
cLow
;

163 
cLow
 = (
cVue
 & 0xff^ 
daVue
;

166  (
cVue
 >> 8^ (
cLow
 << 8) ^ (crcLow << 3)

167 ^ (
cLow
 << 12) ^ (crcLow >> 4)

168 ^ (
cLow
 & 0x0f) ^ ((crcLow & 0x0f) << 7);

169 
	}
}

172 #ifde
TEST


173 
	~<as.h
>

174 
	~<rg.h
>

175 
	~"e.h
"

176 
	~"bys.h
"

179 
	$CRC8
(

180 
Te
 * 
pTe
)

182 
ut8_t
 
c
 = 0xff;

183 
ut8_t
 
ame_c
;

185 
c
 = 
	`CRC_Cc_Hd
(0x00, crc);

186 
	`_
(
pTe
, 
c
 == 0x55);

187 
c
 = 
	`CRC_Cc_Hd
(0x10, crc);

188 
	`_
(
pTe
, 
c
 == 0xC2);

189 
c
 = 
	`CRC_Cc_Hd
(0x05, crc);

190 
	`_
(
pTe
, 
c
 == 0xBC);

191 
c
 = 
	`CRC_Cc_Hd
(0x00, crc);

192 
	`_
(
pTe
, 
c
 == 0x95);

193 
c
 = 
	`CRC_Cc_Hd
(0x00, crc);

194 
	`_
(
pTe
, 
c
 == 0x73);

197 
ame_c
 = ~
c
;

198 
	`_
(
pTe
, 
ame_c
 == 0x8C);

200 
c
 = 
	`CRC_Cc_Hd
(
ame_c
, crc);

201 
	`_
(
pTe
, 
c
 == 0x55);

202 
	}
}

205 
	$CRC16
(

206 
Te
 * 
pTe
)

208 
ut16_t
 
c
 = 0xffff;

209 
ut16_t
 
da_c
;

211 
c
 = 
	`CRC_Cc_Da
(0x01, crc);

212 
	`_
(
pTe
, 
c
 == 0x1E0E);

213 
c
 = 
	`CRC_Cc_Da
(0x22, crc);

214 
	`_
(
pTe
, 
c
 == 0xEB70);

215 
c
 = 
	`CRC_Cc_Da
(0x30, crc);

216 
	`_
(
pTe
, 
c
 == 0x42EF);

219 
da_c
 = ~
c
;

220 
	`_
(
pTe
, 
da_c
 == 0xBD10);

221 
c
 = 
	`CRC_Cc_Da
(
	`LO_BYTE
(
da_c
), crc);

222 
	`_
(
pTe
, 
c
 == 0x0F3A);

223 
c
 = 
	`CRC_Cc_Da
(
	`HI_BYTE
(
da_c
), crc);

224 
	`_
(
pTe
, 
c
 == 0xF0B8);

225 
	}
}

227 
	$CRC8CeTab
(

228 
Te
 * 
pTe
)

230 
ut8_t
 
c
 = 0xff;

231 
i
;

233 (
pTe
;

234 
	`tf
("static const uint8_t HeaderCRC[256] =\n");

235 
	`tf
("{\n");

236 
	`tf
(" ");

237 
i
 = 0; i < 256; i++) {

238 
c
 = 
	`CRC_Cc_Hd
(
i
, 0);

239 
	`tf
("0x%02x, ", 
c
);

240 i(!((
i
 + 1) % 8)) {

241 
	`tf
("\n");

242 i(
i
 != 255) {

243 
	`tf
(" ");

247 
	`tf
("};\n");

248 
	}
}

250 
	$CRC16CeTab
(

251 
Te
 * 
pTe
)

253 
ut16_t
 
c
;

254 
i
;

256 (
pTe
;

257 
	`tf
("static const uint16_t DataCRC[256] =\n");

258 
	`tf
("{\n");

259 
	`tf
(" ");

260 
i
 = 0; i < 256; i++) {

261 
c
 = 
	`CRC_Cc_Da
(
i
, 0);

262 
	`tf
("0x%04x, ", 
c
);

263 i(!((
i
 + 1) % 8)) {

264 
	`tf
("\n");

265 i(
i
 != 255) {

266 
	`tf
(" ");

270 
	`tf
("};\n");

271 
	}
}

275 #ifde
TEST_CRC


276 
	$ma
(

279 
Te
 *
pTe
;

280 
bo
 
rc
;

282 
pTe
 = 
	`_
("c", 
NULL
);

285 
rc
 = 
	`_addTeFuni
(
pTe
, 
CRC8
);

286 
	`as
(
rc
);

287 
rc
 = 
	`_addTeFuni
(
pTe
, 
CRC16
);

288 
	`as
(
rc
);

289 
rc
 = 
	`_addTeFuni
(
pTe
, 
CRC8CeTab
);

290 
	`as
(
rc
);

291 
rc
 = 
	`_addTeFuni
(
pTe
, 
CRC16CeTab
);

292 
	`as
(
rc
);

294 
	`_tSm
(
pTe
, 
dout
);

295 
	`_run
(
pTe
);

296 (
	`_pt
(
pTe
);

298 
	`_deroy
(
pTe
);

301 
	}
}

	@src/datalink.c

35 
	~"dk.h
"

37 #i
defed
(
BACDL_ALL
|| defed 
FOR_DOXYGEN


38 
	~"ht.h
"

39 
	~"b.h
"

40 
	~"bvlc.h
"

41 
	~".h
"

42 
	~"dlmp.h
"

43 
	~<rg.h
>

56 
	$bo
(*
dk_
(*
iame
);

68 *
dk_nd_pdu
) (

69 
BACNET_ADDRESS
 * 
de
,

70 
BACNET_NPDU_DATA
 * 
du_da
,

71 
ut8_t
 * 
pdu
,

72 
pdu_n
);

74 
	$ut16_t
(*
dk_ive
(
BACNET_ADDRESS
 * 
c
, 
ut8_t
 * 
pdu
,

75 
ut16_t
 
max_pdu
, 
timeout
);

81 *
dk_nup
) (

85 *
dk_g_brd_addss
) (

86 
BACNET_ADDRESS
 * 
de
);

89 *
dk_g_my_addss
) (

90 
BACNET_ADDRESS
 * 
my_addss
);

92 
	$dk_t
(

93 *
dk_rg
)

95 i(
	`rcmp
("b", 
dk_rg
) == 0) {

96 
dk_
 = 
b_
;

97 
dk_nd_pdu
 = 
b_nd_pdu
;

98 
dk_ive
 = 
b_ive
;

99 
dk_nup
 = 
b_nup
;

100 
dk_g_brd_addss
 = 
b_g_brd_addss
;

101 
dk_g_my_addss
 = 
b_g_my_addss
;

102 } i(
	`rcmp
("bvlc", 
dk_rg
) == 0) {

103 
dk_
 = 
b_
;

104 
dk_nd_pdu
 = 
bvlc_nd_pdu
;

105 
dk_ive
 = 
bvlc_ive
;

106 
dk_nup
 = 
b_nup
;

107 
dk_g_brd_addss
 = 
b_g_brd_addss
;

108 
dk_g_my_addss
 = 
b_g_my_addss
;

109 } i(
	`rcmp
("ht", 
dk_rg
) == 0) {

110 
dk_
 = 
ht_
;

111 
dk_nd_pdu
 = 
ht_nd_pdu
;

112 
dk_ive
 = 
ht_ive
;

113 
dk_nup
 = 
ht_nup
;

114 
dk_g_brd_addss
 = 
ht_g_brd_addss
;

115 
dk_g_my_addss
 = 
ht_g_my_addss
;

116 } i(
	`rcmp
("", 
dk_rg
) == 0) {

117 
dk_
 = 
_
;

118 
dk_nd_pdu
 = 
_nd_pdu
;

119 
dk_ive
 = 
_ive
;

120 
dk_nup
 = 
_nup
;

121 
dk_g_brd_addss
 = 
_g_brd_addss
;

122 
dk_g_my_addss
 = 
_g_my_addss
;

123 } i(
	`rcmp
("mp", 
dk_rg
) == 0) {

124 
dk_
 = 
dlmp_
;

125 
dk_nd_pdu
 = 
dlmp_nd_pdu
;

126 
dk_ive
 = 
dlmp_ive
;

127 
dk_nup
 = 
dlmp_nup
;

128 
dk_g_brd_addss
 = 
dlmp_g_brd_addss
;

129 
dk_g_my_addss
 = 
dlmp_g_my_addss
;

131 
	}
}

134 #i
defed
(
BACDL_NONE
)

135 
	$dk_nd_pdu
(

136 
BACNET_ADDRESS
 * 
de
,

137 
BACNET_NPDU_DATA
 * 
du_da
,

138 
ut8_t
 * 
pdu
,

139 
pdu_n
)

142 
	}
}

144 
ut16_t
 
	$dk_ive
(

145 
BACNET_ADDRESS
 * 
c
,

146 
ut8_t
 * 
pdu
,

147 
ut16_t
 
max_pdu
,

148 
timeout
)

151 
	}
}

153 
	$dk_nup
(

156 
	}
}

158 
	$dk_g_brd_addss
(

159 
BACNET_ADDRESS
 * 
de
)

161 
	}
}

163 
	$dk_g_my_addss
(

164 
BACNET_ADDRESS
 * 
my_addss
)

166 
	}
}

168 
	$dk_t_r
(

169 *
iame
)

171 
	}
}

173 
	$dk_t
(

174 *
dk_rg
)

176 
	}
}

	@src/datetime.c

34 
	~<dt.h
>

35 
	~<dbo.h
>

36 
	~<rg.h
>

37 
	~<dio.h
>

38 
	~<dlib.h
>

39 
	~<y.h
>

40 
	~"dime.h
"

41 
	~"bacdcode.h
"

58 
bo
 
	$dime_is_˭_yr
(

59 
ut16_t
 
yr
)

61 i((
yr
 % 4) == 0 && ((year % 100) != 0 || (year % 400) == 0))

62  (
ue
);

64  (
l
);

65 
	}
}

67 
ut8_t
 
	$dime_mth_days
(

68 
ut16_t
 
yr
,

69 
ut8_t
 
mth
)

73 
mth_days
[13] = { 0, 31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31 };

75 
ut8_t
 
days
 = 0;

78 i((
mth
 =2&& 
	`dime_is_˭_yr
(
yr
)) {

79 
days
 = 29;

80 } i(
mth
 >= 1 && month <= 12) {

81 
days
 = (
ut8_t

mth_days
[
mth
];

84  
days
;

85 
	}
}

87 
bo
 
	$dime_ymd_is_vid
(

88 
ut16_t
 
yr
,

89 
ut8_t
 
mth
,

90 
ut8_t
 
day
)

92 
bo
 
us
 = 
l
;

93 
ut8_t
 
mthdays
 = 0;

95 
mthdays
 = 
	`dime_mth_days
(
yr
, 
mth
);

96 i((
yr
 >1900&& (
mthdays
 > 0) &&

97 (
day
 >1&& (day <
mthdays
)) {

98 
us
 = 
ue
;

101  
us
;

102 
	}
}

104 
bo
 
	$dime_de_is_vid
(

105 
BACNET_DATE
 *
bde
)

108 
bo
 
us
 = 
l
;

110 i(
bde
) {

111 
us
 = 
	`dime_ymd_is_vid
(
bde
->
yr
, bde->
mth
, bde->
day
);

114  
us
;

115 
	}
}

117 
ut32_t
 
	$day_of_yr
(

118 
ut16_t
 
yr
,

119 
ut8_t
 
mth
,

120 
ut8_t
 
day
)

122 
ut32_t
 
days
 = 0;

123 
ut8_t
 
mths
 = 0;

125 i(
	`dime_ymd_is_vid
(
yr
, 
mth
, 
day
)) {

126 
mths
 = 1; mth< 
mth
; months++) {

127 
days
 +
	`dime_mth_days
(
yr
, 
mths
);

129 
days
 +
day
;

132  (
days
);

133 
	}
}

135 
	$day_of_yr_to_md
(

136 
ut32_t
 
days
,

137 
ut16_t
 
yr
,

138 
ut8_t
 * 
pMth
,

139 
ut8_t
 * 
pDay
)

141 
ut8_t
 
mth
 = 1;

142 
ut8_t
 
day
 = 0;

144 
days
 > (
ut32_t

	`dime_mth_days
(
yr
, 
mth
)) {

145 
days
 -
	`dime_mth_days
(
yr
, 
mth
);

146 
mth
++;

149 
day
 = (
ut8_t
(day + 
days
);

151 i(
pMth
) {

152 *
pMth
 = 
mth
;

154 i(
pDay
) {

155 *
pDay
 = 
day
;

159 
	}
}

161 
	$dime_day_of_yr_to_de
(

162 
ut32_t
 
days
,

163 
ut16_t
 
yr
,

164 
BACNET_DATE
 *
bde
)

166 
ut8_t
 
mth
 = 0;

167 
ut8_t
 
day
 = 0;

169 
	`day_of_yr_to_md
(
days
, 
yr
, &
mth
, &
day
);

170 
	`dime_t_de
(
bde
, 
yr
, 
mth
, 
day
);

171 
	}
}

173 
ut32_t
 
	$dime_day_of_yr
(

174 
BACNET_DATE
 *
bde
)

176 
ut32_t
 
days
 = 0;

178 i(
bde
) {

179 
days
 = 
	`day_of_yr
(
bde
->
yr
, bde->
mth
, bde->
day
);

182  
days
;

183 
	}
}

185 
ut32_t
 
	$days_s_och
(

186 
ut16_t
 
yr
,

187 
ut8_t
 
mth
,

188 
ut8_t
 
day
)

190 
ut32_t
 
days
 = 0;

191 
ut16_t
 
yrs
 = 0;

193 i(
	`dime_ymd_is_vid
(
yr
, 
mth
, 
day
)) {

194 
yrs
 = 1900; yr< 
yr
; years++) {

195 
days
 += 365;

196 i(
	`dime_is_˭_yr
(
yrs
))

197 
days
++;

199 
days
 +
	`day_of_yr
(
yr
, 
mth
, 
day
);

201 
days
 -= 1;

204  (
days
);

205 
	}
}

207 
ut32_t
 
	$dime_days_s_och
(

208 
BACNET_DATE
 *
bde
)

210 
ut32_t
 
days
 = 0;

212 i(
bde
) {

213 
days
 = 
	`days_s_och
(
bde
->
yr
, bde->
mth
, bde->
day
);

216  
days
;

217 
	}
}

219 
	$days_s_och_to_ymd
(

220 
ut32_t
 
days
,

221 
ut16_t
 * 
pYr
,

222 
ut8_t
 * 
pMth
,

223 
ut8_t
 * 
pDay
)

225 
ut16_t
 
yr
 = 1900;

226 
ut8_t
 
mth
 = 1;

227 
ut8_t
 
day
 = 1;

229 
days
 >= 365) {

230 i((
	`dime_is_˭_yr
(
yr
)&& (
days
 == 365))

232 
days
 -= 365;

233 i(
	`dime_is_˭_yr
(
yr
))

234 --
days
;

235 
yr
++;

238 
days
 >(
ut32_t

	`dime_mth_days
(
yr
, 
mth
)) {

239 
days
 -
	`dime_mth_days
(
yr
, 
mth
);

240 
mth
++;

243 
day
 = (
ut8_t
(day + 
days
);

245 i(
pYr
)

246 *
pYr
 = 
yr
;

247 i(
pMth
)

248 *
pMth
 = 
mth
;

249 i(
pDay
)

250 *
pDay
 = 
day
;

253 
	}
}

255 
	$dime_days_s_och_to_de
(

256 
ut32_t
 
days
,

257 
BACNET_DATE
 *
bde
)

259 
ut16_t
 
yr
 = 0;

260 
ut8_t
 
mth
 = 0;

261 
ut8_t
 
day
 = 0;

263 
	`days_s_och_to_ymd
(
days
, &
yr
, &
mth
, &
day
);

264 
	`dime_t_de
(
bde
, 
yr
, 
mth
, 
day
);

265 
	}
}

269 
ut8_t
 
	$dime_day_of_wk
(

270 
ut16_t
 
yr
,

271 
ut8_t
 
mth
,

272 
ut8_t
 
day
)

274  (
ut8_t
((
	`days_s_och
(
yr
, 
mth
, 
day
) % 7) + 1);

275 
	}
}

277 
bo
 
	$dime_time_is_vid
(

278 
BACNET_TIME
 *
btime
)

280 
bo
 
us
 = 
l
;

282 i(
btime
) {

283 i((
btime
->
hour
 < 24&& (btime->
m
 < 60&& (btime->
c
 < 60) &&

284 (
btime
->
hunddths
 < 100)) {

285 
us
 = 
ue
;

289  
us
;

290 
	}
}

300 
bo
 
	$dime_is_vid
(

301 
BACNET_DATE
 * 
bde
,

302 
BACNET_TIME
 * 
btime
)

304  
	`dime_de_is_vid
(
bde
&& 
	`dime_time_is_vid
(
btime
);

305 
	}
}

311 
	$dime_com_de
(

312 
BACNET_DATE
 * 
de1
,

313 
BACNET_DATE
 * 
de2
)

315 
diff
 = 0;

317 i(
de1
 && 
de2
) {

318 
diff
 = (
de1
->
yr
 - (
de2
->year;

319 i(
diff
 == 0) {

320 
diff
 = (
de1
->
mth
 - (
de2
->month;

321 i(
diff
 == 0) {

322 
diff
 = (
de1
->
day
 - (
de2
->day;

327  
diff
;

328 
	}
}

333 
	$dime_com_time
(

334 
BACNET_TIME
 * 
time1
,

335 
BACNET_TIME
 * 
time2
)

337 
diff
 = 0;

339 i(
time1
 && 
time2
) {

340 
diff
 = (
time1
->
hour
 - (
time2
->hour;

341 i(
diff
 == 0) {

342 
diff
 = (
time1
->
m
 - (
time2
->min;

343 i(
diff
 == 0) {

344 
diff
 = (
time1
->
c
 - (
time2
->sec;

345 i(
diff
 == 0) {

346 
diff
 = (
time1
->
hunddths
 - (
time2
->hundredths;

352  
diff
;

353 
	}
}

358 
	$dime_com
(

359 
BACNET_DATE_TIME
 * 
dime1
,

360 
BACNET_DATE_TIME
 * 
dime2
)

362 
diff
 = 0;

364 
diff
 = 
	`dime_com_de
(&
dime1
->
de
, &
dime2
->date);

365 i(
diff
 == 0) {

366 
diff
 = 
	`dime_com_time
(&
dime1
->
time
, &
dime2
->time);

369  
diff
;

370 
	}
}

372 
	$dime_wdrd_com_de
(

373 
BACNET_DATE
 * 
de1
,

374 
BACNET_DATE
 * 
de2
)

376 
diff
 = 0;

378 i(
de1
 && 
de2
) {

379 i((
de1
->
yr
 !1900 + 0xFF&& (
de2
->year != 1900 + 0xFF)) {

380 
diff
 = ()
de1
->
yr
 - ()
de2
->year;

382 i(
diff
 == 0) {

383 i((
de1
->
mth
 !0xFF&& (
de2
->month != 0xFF)) {

384 
diff
 = ()
de1
->
mth
 - ()
de2
->month;

386 i(
diff
 == 0) {

387 i((
de1
->
day
 !0xFF&& (
de2
->day != 0xFF)) {

388 
diff
 = ()
de1
->
day
 - ()
de2
->day;

395  
diff
;

396 
	}
}

398 
	$dime_wdrd_com_time
(

399 
BACNET_TIME
 * 
time1
,

400 
BACNET_TIME
 * 
time2
)

402 
diff
 = 0;

404 i(
time1
 && 
time2
) {

405 i((
time1
->
hour
 !0xFF&& (
time2
->hour != 0xFF)) {

406 
diff
 = ()
time1
->
hour
 - ()
time2
->hour;

408 i(
diff
 == 0) {

409 i((
time1
->
m
 !0xFF&& (
time2
->min != 0xFF)) {

410 
diff
 = ()
time1
->
m
 - ()
time2
->min;

412 i(
diff
 == 0) {

413 i((
time1
->
c
 !0xFF&& (
time2
->sec != 0xFF)) {

414 
diff
 = ()
time1
->
c
 - ()
time2
->sec;

416 i(
diff
 == 0) {

417 i((
time1
->
hunddths
 != 0xFF) &&

418 (
time2
->
hunddths
 != 0xFF)) {

419 
diff
 = ()
time1
->
hunddths
 - ()
time2
->hundredths;

426  
diff
;

427 
	}
}

429 
	$dime_wdrd_com
(

430 
BACNET_DATE_TIME
 * 
dime1
,

431 
BACNET_DATE_TIME
 * 
dime2
)

433 
diff
 = 0;

435 
diff
 = 
	`dime_wdrd_com_de
(

436 &
dime1
->
de
,

437 &
dime2
->
de
);

438 i(
diff
 == 0) {

439 
diff
 = 
	`dime_wdrd_com_time
(

440 &
dime1
->
time
,

441 &
dime2
->
time
);

444  
diff
;

445 
	}
}

447 
	$dime_cy_de
(

448 
BACNET_DATE
 * 
de_de
,

449 
BACNET_DATE
 * 
c_de
)

451 i(
de_de
 && 
c_de
) {

452 
de_de
->
yr
 = 
c_de
->year;

453 
de_de
->
mth
 = 
c_de
->month;

454 
de_de
->
day
 = 
c_de
->day;

455 
de_de
->
wday
 = 
c_de
->wday;

457 
	}
}

459 
	$dime_cy_time
(

460 
BACNET_TIME
 * 
de_time
,

461 
BACNET_TIME
 * 
c_time
)

463 i(
de_time
 && 
c_time
) {

464 
de_time
->
hour
 = 
c_time
->hour;

465 
de_time
->
m
 = 
c_time
->min;

466 
de_time
->
c
 = 
c_time
->sec;

467 
de_time
->
hunddths
 = 
c_time
->hundredths;

469 
	}
}

471 
	$dime_cy
(

472 
BACNET_DATE_TIME
 * 
de_dime
,

473 
BACNET_DATE_TIME
 * 
c_dime
)

475 
	`dime_cy_time
(&
de_dime
->
time
, &
c_dime
->time);

476 
	`dime_cy_de
(&
de_dime
->
de
, &
c_dime
->date);

477 
	}
}

479 
	$dime_t_de
(

480 
BACNET_DATE
 * 
bde
,

481 
ut16_t
 
yr
,

482 
ut8_t
 
mth
,

483 
ut8_t
 
day
)

485 i(
bde
) {

486 
bde
->
yr
 = year;

487 
bde
->
mth
 = month;

488 
bde
->
day
 = day;

489 
bde
->
wday
 = 
	`dime_day_of_wk
(
yr
, 
mth
, 
day
);

491 
	}
}

493 
	$dime_t_time
(

494 
BACNET_TIME
 * 
btime
,

495 
ut8_t
 
hour
,

496 
ut8_t
 
mu
,

497 
ut8_t
 
cds
,

498 
ut8_t
 
hunddths
)

500 i(
btime
) {

501 
btime
->
hour
 = hour;

502 
btime
->
m
 = 
mu
;

503 
btime
->
c
 = 
cds
;

504 
btime
->
hunddths
 = hundredths;

506 
	}
}

508 
	$dime_t
(

509 
BACNET_DATE_TIME
 * 
bdime
,

510 
BACNET_DATE
 * 
bde
,

511 
BACNET_TIME
 * 
btime
)

513 i(
bde
 && 
btime
 && 
bdime
) {

514 
bdime
->
time
.
hour
 = 
btime
->hour;

515 
bdime
->
time
.
m
 = 
btime
->min;

516 
bdime
->
time
.
c
 = 
btime
->sec;

517 
bdime
->
time
.
hunddths
 = 
btime
->hundredths;

518 
bdime
->
de
.
yr
 = 
bde
->year;

519 
bdime
->
de
.
mth
 = 
bde
->month;

520 
bdime
->
de
.
day
 = 
bde
->day;

521 
bdime
->
de
.
wday
 = 
bde
->wday;

523 
	}
}

525 
	$dime_t_vues
(

526 
BACNET_DATE_TIME
 * 
bdime
,

527 
ut16_t
 
yr
,

528 
ut8_t
 
mth
,

529 
ut8_t
 
day
,

530 
ut8_t
 
hour
,

531 
ut8_t
 
mu
,

532 
ut8_t
 
cds
,

533 
ut8_t
 
hunddths
)

535 i(
bdime
) {

536 
bdime
->
de
.
yr
 = year;

537 
bdime
->
de
.
mth
 = month;

538 
bdime
->
de
.
day
 = day;

539 
bdime
->
de
.
wday
 = 
	`dime_day_of_wk
(
yr
, 
mth
, 
day
);

540 
bdime
->
time
.
hour
 = hour;

541 
bdime
->
time
.
m
 = 
mu
;

542 
bdime
->
time
.
c
 = 
cds
;

543 
bdime
->
time
.
hunddths
 = hundredths;

545 
	}
}

547 
ut32_t
 
	$cds_s_midnight
(

548 
ut8_t
 
hours
,

549 
ut8_t
 
mus
,

550 
ut8_t
 
cds
)

552  ((
hours
 * 60 * 60+ (
mus
 * 60+ 
cds
);

553 
	}
}

555 
ut16_t
 
	$mus_s_midnight
(

556 
ut8_t
 
hours
,

557 
ut8_t
 
mus
)

559  ((
hours
 * 60+ 
mus
);

560 
	}
}

562 
	$cds_s_midnight_to_hms
(

563 
ut32_t
 
cds
,

564 
ut8_t
 * 
pHours
,

565 
ut8_t
 * 
pMus
,

566 
ut8_t
 * 
pSecds
)

568 
ut8_t
 
hour
 = 0;

569 
ut8_t
 
mu
 = 0;

571 
hour
 = (
ut8_t
(
cds
 / (60 * 60));

572 
cds
 -(
hour
 * 60 * 60);

573 
mu
 = (
ut8_t
(
cds
 / 60);

574 
cds
 -(
mu
 * 60);

576 i(
pHours
)

577 *
pHours
 = 
hour
;

578 i(
pMus
)

579 *
pMus
 = 
mu
;

580 i(
pSecds
)

581 *
pSecds
 = (
ut8_t

cds
;

582 
	}
}

590 
ut32_t
 
	$dime_cds_s_midnight
(

591 
BACNET_TIME
 *
btime
)

593 
ut32_t
 
cds
 = 0;

595 i(
btime
) {

596 
cds
 = 
	`cds_s_midnight
(

597 
btime
->
hour
,

598 
btime
->
m
,

599 
btime
->
c
);

602  
cds
;

603 
	}
}

611 
ut16_t
 
	$dime_mus_s_midnight
(

612 
BACNET_TIME
 *
btime
)

614 
ut32_t
 
mus
 = 0;

616 i(
btime
) {

617 
mus
 = 
	`mus_s_midnight
(

618 
btime
->
hour
,

619 
btime
->
m
);

622  
mus
;

623 
	}
}

630 
	$dime_add_mus
(

631 
BACNET_DATE_TIME
 * 
bdime
,

632 
t32_t
 
mus
)

634 
ut32_t
 
bdime_mus
 = 0;

635 
ut32_t
 
bdime_days
 = 0;

636 
t32_t
 
days
 = 0;

639 
bdime_mus
 =

640 
	`cds_s_midnight
(
bdime
->
time
.
hour
, bdime->time.
m
,

641 
bdime
->
time
.
c
) / 60;

642 
bdime_days
 = 
	`dime_days_s_och
(&
bdime
->
de
);

645 
days
 = 
mus
 / (24 * 60);

646 
bdime_days
 +
days
;

647 
mus
 -(
days
 * 24 * 60);

649 i(
mus
 < 0) {

651 
mus
 *= -1;

652 i((
ut32_t
)
mus
 > 
bdime_mus
) {

654 
bdime_days
 -= 1;

655 
bdime_mus
 +((24 * 60- 
mus
);

657 
bdime_mus
 -
mus
;

658 
days
 = 
bdime_mus
 / (24 * 60);

659 
bdime_days
 +
days
;

660 
bdime_mus
 -(
days
 * 24 * 60);

664 
bdime_mus
 +
mus
;

665 
days
 = 
bdime_mus
 / (24 * 60);

666 
bdime_days
 +
days
;

667 
bdime_mus
 -(
days
 * 24 * 60);

671 
	`cds_s_midnight_to_hms
(
bdime_mus
 * 60,

672 &
bdime
->
time
.
hour
, &bdime->time.
m
, 
NULL
);

673 
	`dime_days_s_och_to_de
(
bdime_days
, &
bdime
->
de
);

674 
	}
}

676 
bo
 
	$dime_wdrd
(

677 
BACNET_DATE_TIME
 * 
bdime
)

679 
bo
 
wdrd_e
 = 
l
;

681 i(
bdime
) {

682 i((
bdime
->
de
.
yr
 == (1900 + 0xFF)) &&

683 (
bdime
->
de
.
mth
 =0xFF&& (bdime->de.
day
 == 0xFF) &&

684 (
bdime
->
de
.
wday
 =0xFF&& (bdime->
time
.
hour
 == 0xFF) &&

685 (
bdime
->
time
.
m
 =0xFF&& (bdime->time.
c
 == 0xFF) &&

686 (
bdime
->
time
.
hunddths
 == 0xFF)) {

687 
wdrd_e
 = 
ue
;

691  
wdrd_e
;

692 
	}
}

697 
bo
 
	$dime_wdrd_e
(

698 
BACNET_DATE_TIME
 * 
bdime
)

700 
bo
 
wdrd_e
 = 
l
;

702 i(
bdime
) {

703 i((
bdime
->
de
.
yr
 == (1900 + 0xFF)) ||

704 (
bdime
->
de
.
mth
 > 12|| (bdime->de.
day
 > 31) ||

705 (
bdime
->
time
.
hour
 =0xFF|| (bdime->time.
m
 == 0xFF) ||

706 (
bdime
->
time
.
c
 == 0xFF) ||

707 (
bdime
->
time
.
hunddths
 == 0xFF)) {

708 
wdrd_e
 = 
ue
;

712  
wdrd_e
;

713 
	}
}

715 
	$dime_de_wdrd_t
(

716 
BACNET_DATE
 * 
bde
)

718 i(
bde
) {

719 
bde
->
yr
 = 1900 + 0xFF;

720 
bde
->
mth
 = 0xFF;

721 
bde
->
day
 = 0xFF;

722 
bde
->
wday
 = 0xFF;

724 
	}
}

726 
	$dime_time_wdrd_t
(

727 
BACNET_TIME
 * 
btime
)

729 i(
btime
) {

730 
btime
->
hour
 = 0xFF;

731 
btime
->
m
 = 0xFF;

732 
btime
->
c
 = 0xFF;

733 
btime
->
hunddths
 = 0xFF;

735 
	}
}

737 
	$dime_wdrd_t
(

738 
BACNET_DATE_TIME
 * 
bdime
)

740 i(
bdime
) {

741 
	`dime_de_wdrd_t
(&
bdime
->
de
);

742 
	`dime_time_wdrd_t
(&
bdime
->
time
);

744 
	}
}

746 
	$ba_code_dime
(

747 
ut8_t
 * 
du
,

748 
BACNET_DATE_TIME
 * 
vue
)

750 
n
 = 0;

751 
du_n
 = 0;

754 i(
du
 && 
vue
) {

755 
n
 = 
	`code_iti_de
(&
du
[0], &
vue
->
de
);

756 
du_n
 +
n
;

758 
n
 = 
	`code_iti_time
(&
du
[
du_n
], &
vue
->
time
);

759 
du_n
 +
n
;

761  
du_n
;

762 
	}
}

765 
	$ba_code_cڋxt_dime
(

766 
ut8_t
 * 
du
,

767 
ut8_t
 
g_numb
,

768 
BACNET_DATE_TIME
 * 
vue
)

770 
n
 = 0;

771 
du_n
 = 0;

774 i(
du
 && 
vue
) {

775 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 
g_numb
);

776 
du_n
 +
n
;

778 
n
 = 
	`ba_code_dime
(&
du
[
du_n
], 
vue
);

779 
du_n
 +
n
;

781 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 
g_numb
);

782 
du_n
 +
n
;

784  
du_n
;

785 
	}
}

787 
	$ba_decode_dime
(

788 
ut8_t
 * 
du
,

789 
BACNET_DATE_TIME
 * 
vue
)

791 
n
 = 0;

792 
i_n
;

794 i(-1 =(
i_n
 =

795 
	`decode_iti_de
(&
du
[
n
], &
vue
->
de
))) {

798 
n
 +
i_n
;

800 i(-1 =(
i_n
 =

801 
	`decode_iti_time
(&
du
[
n
], &
vue
->
time
))) {

805 
n
 +
i_n
;

807  
n
;

808 
	}
}

810 
	$ba_decode_cڋxt_dime
(

811 
ut8_t
 * 
du
,

812 
ut8_t
 
g_numb
,

813 
BACNET_DATE_TIME
 * 
vue
)

815 
du_n
 = 0;

816 
n
;

818 i(
	`decode_is_ݒg_g_numb
(&
du
[
du_n
], 
g_numb
)) {

819 
du_n
++;

824 i(-1 =(
n
 = 
	`ba_decode_dime
(&
du
[
du_n
], 
vue
))) {

827 
du_n
 +
n
;

830 i(
	`decode_is_osg_g_numb
(&
du
[
du_n
], 
g_numb
)) {

831 
du_n
++;

835  
du_n
;

836 
	}
}

841 #ifde
TEST


842 
	~<as.h
>

843 
	~<rg.h
>

844 
	~"e.h
"

846 
	$BACtDeTimeWdrd
(

847 
Te
 * 
pTe
)

849 
BACNET_DATE_TIME
 
bdime
;

850 
bo
 
us
 = 
l
;

852 
	`dime_t_vues
(&
bdime
, 1900, 1, 1, 0, 0, 0, 0);

853 
us
 = 
	`dime_wdrd
(&
bdime
);

854 
	`_
(
pTe
, 
us
 =
l
);

856 
	`dime_wdrd_t
(&
bdime
);

857 
us
 = 
	`dime_wdrd
(&
bdime
);

858 
	`_
(
pTe
, 
us
 =
ue
);

859 
	}
}

861 
	$BACtDeTimeAdd
(

862 
Te
 * 
pTe
)

864 
BACNET_DATE_TIME
 
bdime
, 
_bdime
;

865 
ut32_t
 
mus
 = 0;

866 
diff
 = 0;

868 
	`dime_t_vues
(&
bdime
, 1900, 1, 1, 0, 0, 0, 0);

869 
	`dime_cy
(&
_bdime
, &
bdime
);

870 
	`dime_add_mus
(&
bdime
, 
mus
);

871 
diff
 = 
	`dime_com
(&
_bdime
, &
bdime
);

872 
	`_
(
pTe
, 
diff
 == 0);

874 
	`dime_t_vues
(&
bdime
, 1900, 1, 1, 0, 0, 0, 0);

875 
	`dime_add_mus
(&
bdime
, 60);

876 
	`dime_t_vues
(&
_bdime
, 1900, 1, 1, 1, 0, 0, 0);

877 
diff
 = 
	`dime_com
(&
_bdime
, &
bdime
);

878 
	`_
(
pTe
, 
diff
 == 0);

880 
	`dime_t_vues
(&
bdime
, 1900, 1, 1, 0, 0, 0, 0);

881 
	`dime_add_mus
(&
bdime
, (24 * 60));

882 
	`dime_t_vues
(&
_bdime
, 1900, 1, 2, 0, 0, 0, 0);

883 
diff
 = 
	`dime_com
(&
_bdime
, &
bdime
);

884 
	`_
(
pTe
, 
diff
 == 0);

886 
	`dime_t_vues
(&
bdime
, 1900, 1, 1, 0, 0, 0, 0);

887 
	`dime_add_mus
(&
bdime
, (31 * 24 * 60));

888 
	`dime_t_vues
(&
_bdime
, 1900, 2, 1, 0, 0, 0, 0);

889 
diff
 = 
	`dime_com
(&
_bdime
, &
bdime
);

890 
	`_
(
pTe
, 
diff
 == 0);

892 
	`dime_t_vues
(&
bdime
, 2013, 6, 6, 23, 59, 59, 0);

893 
	`dime_add_mus
(&
bdime
, 60);

894 
	`dime_t_vues
(&
_bdime
, 2013, 6, 7, 0, 59, 59, 0);

895 
diff
 = 
	`dime_com
(&
_bdime
, &
bdime
);

896 
	`_
(
pTe
, 
diff
 == 0);

898 
	`dime_t_vues
(&
bdime
, 2013, 6, 6, 0, 59, 59, 0);

899 
	`dime_add_mus
(&
bdime
, -60);

900 
	`dime_t_vues
(&
_bdime
, 2013, 6, 5, 23, 59, 59, 0);

901 
diff
 = 
	`dime_com
(&
_bdime
, &
bdime
);

902 
	`_
(
pTe
, 
diff
 == 0);

903 
	}
}

905 
	$BACtDeTimeSecds
(

906 
Te
 * 
pTe
)

908 
ut8_t
 
hour
 = 0, 
mu
 = 0, 
cd
 = 0;

909 
ut8_t
 
_hour
 = 0, 
_mu
 = 0, 
_cd
 = 0;

910 
ut32_t
 
cds
 = 0, 
_cds
;

912 
hour
 = 0; hour < 24; hour++) {

913 
mu
 = 0; minute < 60; minute += 3) {

914 
cd
 = 0; second < 60; second += 17) {

915 
cds
 = 
	`cds_s_midnight
(
hour
, 
mu
, 
cd
);

916 
	`cds_s_midnight_to_hms
(
cds
, &
_hour
,

917 &
_mu
, &
_cd
);

918 
_cds
 =

919 
	`cds_s_midnight
(
_hour
, 
_mu
,

920 
_cd
);

921 
	`_
(
pTe
, 
cds
 =
_cds
);

925 
	}
}

927 
	$BACtDe
(

928 
Te
 * 
pTe
)

930 
BACNET_DATE
 
bde1
, 
bde2
;

931 
diff
 = 0;

933 
	`dime_t_de
(&
bde1
, 1900, 1, 1);

934 
	`dime_cy_de
(&
bde2
, &
bde1
);

935 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

936 
	`_
(
pTe
, 
diff
 == 0);

937 
	`dime_t_de
(&
bde2
, 1900, 1, 2);

938 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

939 
	`_
(
pTe
, 
diff
 < 0);

940 
	`dime_t_de
(&
bde2
, 1900, 2, 1);

941 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

942 
	`_
(
pTe
, 
diff
 < 0);

943 
	`dime_t_de
(&
bde2
, 1901, 1, 1);

944 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

945 
	`_
(
pTe
, 
diff
 < 0);

948 
	`dime_t_de
(&
bde1
, 2007, 7, 15);

949 
	`dime_cy_de
(&
bde2
, &
bde1
);

950 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

951 
	`_
(
pTe
, 
diff
 == 0);

952 
	`dime_t_de
(&
bde2
, 2007, 7, 14);

953 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

954 
	`_
(
pTe
, 
diff
 > 0);

955 
	`dime_t_de
(&
bde2
, 2007, 7, 1);

956 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

957 
	`_
(
pTe
, 
diff
 > 0);

958 
	`dime_t_de
(&
bde2
, 2007, 7, 31);

959 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

960 
	`_
(
pTe
, 
diff
 < 0);

961 
	`dime_t_de
(&
bde2
, 2007, 8, 15);

962 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

963 
	`_
(
pTe
, 
diff
 < 0);

964 
	`dime_t_de
(&
bde2
, 2007, 12, 15);

965 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

966 
	`_
(
pTe
, 
diff
 < 0);

967 
	`dime_t_de
(&
bde2
, 2007, 6, 15);

968 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

969 
	`_
(
pTe
, 
diff
 > 0);

970 
	`dime_t_de
(&
bde2
, 2007, 1, 15);

971 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

972 
	`_
(
pTe
, 
diff
 > 0);

973 
	`dime_t_de
(&
bde2
, 2006, 7, 15);

974 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

975 
	`_
(
pTe
, 
diff
 > 0);

976 
	`dime_t_de
(&
bde2
, 1900, 7, 15);

977 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

978 
	`_
(
pTe
, 
diff
 > 0);

979 
	`dime_t_de
(&
bde2
, 2008, 7, 15);

980 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

981 
	`_
(
pTe
, 
diff
 < 0);

982 
	`dime_t_de
(&
bde2
, 2154, 7, 15);

983 
diff
 = 
	`dime_com_de
(&
bde1
, &
bde2
);

984 
	`_
(
pTe
, 
diff
 < 0);

987 
	}
}

989 
	$BACtTime
(

990 
Te
 * 
pTe
)

992 
BACNET_TIME
 
btime1
, 
btime2
;

993 
diff
 = 0;

995 
	`dime_t_time
(&
btime1
, 0, 0, 0, 0);

996 
	`dime_cy_time
(&
btime2
, &
btime1
);

997 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

998 
	`_
(
pTe
, 
diff
 == 0);

1000 
	`dime_t_time
(&
btime1
, 23, 59, 59, 99);

1001 
	`dime_cy_time
(&
btime2
, &
btime1
);

1002 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1003 
	`_
(
pTe
, 
diff
 == 0);

1006 
	`dime_t_time
(&
btime1
, 12, 30, 30, 50);

1007 
	`dime_cy_time
(&
btime2
, &
btime1
);

1008 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1009 
	`_
(
pTe
, 
diff
 == 0);

1010 
	`dime_t_time
(&
btime2
, 12, 30, 30, 51);

1011 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1012 
	`_
(
pTe
, 
diff
 < 0);

1013 
	`dime_t_time
(&
btime2
, 12, 30, 31, 50);

1014 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1015 
	`_
(
pTe
, 
diff
 < 0);

1016 
	`dime_t_time
(&
btime2
, 12, 31, 30, 50);

1017 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1018 
	`_
(
pTe
, 
diff
 < 0);

1019 
	`dime_t_time
(&
btime2
, 13, 30, 30, 50);

1020 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1021 
	`_
(
pTe
, 
diff
 < 0);

1023 
	`dime_t_time
(&
btime2
, 12, 30, 30, 49);

1024 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1025 
	`_
(
pTe
, 
diff
 > 0);

1026 
	`dime_t_time
(&
btime2
, 12, 30, 29, 50);

1027 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1028 
	`_
(
pTe
, 
diff
 > 0);

1029 
	`dime_t_time
(&
btime2
, 12, 29, 30, 50);

1030 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1031 
	`_
(
pTe
, 
diff
 > 0);

1032 
	`dime_t_time
(&
btime2
, 11, 30, 30, 50);

1033 
diff
 = 
	`dime_com_time
(&
btime1
, &
btime2
);

1034 
	`_
(
pTe
, 
diff
 > 0);

1037 
	}
}

1039 
	$BACtDeTime
(

1040 
Te
 * 
pTe
)

1042 
BACNET_DATE_TIME
 
bdime1
, 
bdime2
;

1043 
BACNET_DATE
 
bde
;

1044 
BACNET_TIME
 
btime
;

1045 
diff
 = 0;

1047 
	`dime_t_vues
(&
bdime1
, 1900, 1, 1, 0, 0, 0, 0);

1048 
	`dime_cy
(&
bdime2
, &
bdime1
);

1049 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1050 
	`_
(
pTe
, 
diff
 == 0);

1051 
	`dime_t_time
(&
btime
, 0, 0, 0, 0);

1052 
	`dime_t_de
(&
bde
, 1900, 1, 1);

1053 
	`dime_t
(&
bdime1
, &
bde
, &
btime
);

1054 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1055 
	`_
(
pTe
, 
diff
 == 0);

1059 
	`dime_t_vues
(&
bdime1
, 2000, 7, 15, 12, 30, 30, 50);

1060 
	`dime_t_vues
(&
bdime2
, 2000, 7, 15, 12, 30, 30, 51);

1061 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1062 
	`_
(
pTe
, 
diff
 < 0);

1063 
	`dime_t_vues
(&
bdime2
, 2000, 7, 15, 12, 30, 31, 50);

1064 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1065 
	`_
(
pTe
, 
diff
 < 0);

1066 
	`dime_t_vues
(&
bdime2
, 2000, 7, 15, 12, 31, 30, 50);

1067 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1068 
	`_
(
pTe
, 
diff
 < 0);

1069 
	`dime_t_vues
(&
bdime2
, 2000, 7, 15, 13, 30, 30, 50);

1070 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1071 
	`_
(
pTe
, 
diff
 < 0);

1072 
	`dime_t_vues
(&
bdime2
, 2000, 7, 16, 12, 30, 30, 50);

1073 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1074 
	`_
(
pTe
, 
diff
 < 0);

1075 
	`dime_t_vues
(&
bdime2
, 2000, 8, 15, 12, 30, 30, 50);

1076 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1077 
	`_
(
pTe
, 
diff
 < 0);

1078 
	`dime_t_vues
(&
bdime2
, 2001, 7, 15, 12, 30, 30, 50);

1079 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1080 
	`_
(
pTe
, 
diff
 < 0);

1081 
	`dime_t_vues
(&
bdime2
, 2000, 7, 15, 12, 30, 30, 49);

1082 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1083 
	`_
(
pTe
, 
diff
 > 0);

1084 
	`dime_t_vues
(&
bdime2
, 2000, 7, 15, 12, 30, 29, 50);

1085 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1086 
	`_
(
pTe
, 
diff
 > 0);

1087 
	`dime_t_vues
(&
bdime2
, 2000, 7, 15, 12, 29, 30, 50);

1088 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1089 
	`_
(
pTe
, 
diff
 > 0);

1090 
	`dime_t_vues
(&
bdime2
, 2000, 7, 15, 11, 30, 30, 50);

1091 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1092 
	`_
(
pTe
, 
diff
 > 0);

1093 
	`dime_t_vues
(&
bdime2
, 2000, 7, 14, 12, 30, 30, 50);

1094 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1095 
	`_
(
pTe
, 
diff
 > 0);

1096 
	`dime_t_vues
(&
bdime2
, 2000, 6, 15, 12, 30, 30, 50);

1097 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1098 
	`_
(
pTe
, 
diff
 > 0);

1099 
	`dime_t_vues
(&
bdime2
, 1999, 7, 15, 12, 30, 30, 50);

1100 
diff
 = 
	`dime_com
(&
bdime1
, &
bdime2
);

1101 
	`_
(
pTe
, 
diff
 > 0);

1105 
	}
}

1107 
	$WdrdDeTime
(

1108 
Te
 * 
pTe
)

1110 
BACNET_DATE_TIME
 
bdime1
, 
bdime2
;

1111 
BACNET_DATE
 
bde
;

1112 
BACNET_TIME
 
btime
;

1113 
diff
 = 0;

1115 
	`dime_wdrd_t
(&
bdime1
);

1116 
	`_
(
pTe
, 
	`dime_wdrd
(&
bdime1
));

1117 
	`_
(
pTe
, 
	`dime_wdrd_e
(&
bdime1
));

1118 
	`dime_cy
(&
bdime2
, &
bdime1
);

1119 
diff
 = 
	`dime_wdrd_com
(&
bdime1
, &
bdime2
);

1120 
	`_
(
pTe
, 
diff
 == 0);

1121 
	`dime_time_wdrd_t
(&
btime
);

1122 
	`dime_de_wdrd_t
(&
bde
);

1123 
	`dime_t
(&
bdime1
, &
bde
, &
btime
);

1124 
diff
 = 
	`dime_wdrd_com
(&
bdime1
, &
bdime2
);

1125 
	`_
(
pTe
, 
diff
 == 0);

1128 
	}
}

1130 
	$DayOfYr
(

1131 
Te
 * 
pTe
)

1133 
ut32_t
 
days
 = 0;

1134 
ut8_t
 
mth
 = 0, 
_mth
 = 0;

1135 
ut8_t
 
day
 = 0, 
_day
 = 0;

1136 
ut16_t
 
yr
 = 0;

1137 
BACNET_DATE
 
bde
;

1138 
BACNET_DATE
 
_bde
;

1140 
days
 = 
	`day_of_yr
(1900, 1, 1);

1141 
	`_
(
pTe
, 
days
 == 1);

1142 
	`day_of_yr_to_md
(
days
, 1900, &
mth
, &
day
);

1143 
	`_
(
pTe
, 
mth
 == 1);

1144 
	`_
(
pTe
, 
day
 == 1);

1146 
yr
 = 1900; year <= 2154; year++) {

1147 
mth
 = 1; month <= 12; month++) {

1148 
day
 = 1; day <
	`dime_mth_days
(
yr
, 
mth
); day++) {

1149 
days
 = 
	`day_of_yr
(
yr
, 
mth
, 
day
);

1150 
	`day_of_yr_to_md
(
days
, 
yr
, &
_mth
, &
_day
);

1151 
	`_
(
pTe
, 
mth
 =
_mth
);

1152 
	`_
(
pTe
, 
day
 =
_day
);

1156 
yr
 = 1900; year <= 2154; year++) {

1157 
mth
 = 1; month <= 12; month++) {

1158 
day
 = 1; day <
	`dime_mth_days
(
yr
, 
mth
); day++) {

1159 
	`dime_t_de
(&
bde
, 
yr
, 
mth
, 
day
);

1160 
days
 = 
	`dime_day_of_yr
(&
bde
);

1161 
	`dime_day_of_yr_to_de
(
days
, 
yr
, &
_bde
);

1162 
	`_
(
pTe
, 
	`dime_com_de
(&
bde
, &
_bde
) == 0);

1166 
	}
}

1168 
	$DeEpoch
(

1169 
Te
 * 
pTe
)

1171 
ut32_t
 
days
 = 0;

1172 
ut16_t
 
yr
 = 0, 
_yr
 = 0;

1173 
ut8_t
 
mth
 = 0, 
_mth
 = 0;

1174 
ut8_t
 
day
 = 0, 
_day
 = 0;

1176 
days
 = 
	`days_s_och
(1900, 1, 1);

1177 
	`_
(
pTe
, 
days
 == 0);

1178 
	`days_s_och_to_ymd
(
days
, &
yr
, &
mth
, &
day
);

1179 
	`_
(
pTe
, 
yr
 == 1900);

1180 
	`_
(
pTe
, 
mth
 == 1);

1181 
	`_
(
pTe
, 
day
 == 1);

1184 
yr
 = 1900; year <= 2154; year++) {

1185 
mth
 = 1; month <= 12; month++) {

1186 
day
 = 1; day <
	`dime_mth_days
(
yr
, 
mth
); day++) {

1187 
days
 = 
	`days_s_och
(
yr
, 
mth
, 
day
);

1188 
	`days_s_och_to_ymd
(
days
,

1189 &
_yr
, &
_mth
, &
_day
);

1190 
	`_
(
pTe
, 
yr
 =
_yr
);

1191 
	`_
(
pTe
, 
mth
 =
_mth
);

1192 
	`_
(
pTe
, 
day
 =
_day
);

1196 
	}
}

1198 
	$BACtDayOfWk
(

1199 
Te
 * 
pTe
)

1201 
ut8_t
 
dow
 = 0;

1204 
dow
 = 
	`dime_day_of_wk
(1900, 1, 1);

1205 
	`_
(
pTe
, 
dow
 == 1);

1208 
dow
 = 
	`dime_day_of_wk
(2007, 1, 1);

1209 
	`_
(
pTe
, 
dow
 == 1);

1210 
dow
 = 
	`dime_day_of_wk
(2007, 1, 2);

1211 
	`_
(
pTe
, 
dow
 == 2);

1212 
dow
 = 
	`dime_day_of_wk
(2007, 1, 3);

1213 
	`_
(
pTe
, 
dow
 == 3);

1214 
dow
 = 
	`dime_day_of_wk
(2007, 1, 4);

1215 
	`_
(
pTe
, 
dow
 == 4);

1216 
dow
 = 
	`dime_day_of_wk
(2007, 1, 5);

1217 
	`_
(
pTe
, 
dow
 == 5);

1218 
dow
 = 
	`dime_day_of_wk
(2007, 1, 6);

1219 
	`_
(
pTe
, 
dow
 == 6);

1220 
dow
 = 
	`dime_day_of_wk
(2007, 1, 7);

1221 
	`_
(
pTe
, 
dow
 == 7);

1223 
dow
 = 
	`dime_day_of_wk
(2007, 1, 31);

1224 
	`_
(
pTe
, 
dow
 == 3);

1225 
	}
}

1227 
	$DimeCodec
(

1228 
Te
 * 
pTe
)

1230 
ut8_t
 
du
[
MAX_APDU
];

1231 
BACNET_DATE_TIME
 
dimeIn
;

1232 
BACNET_DATE_TIME
 
dimeOut
;

1233 
L
;

1234 
outL
;

1236 
dimeIn
.
de
.
day
 = 1;

1237 
dimeIn
.
de
.
mth
 = 2;

1238 
dimeIn
.
de
.
wday
 = 3;

1239 
dimeIn
.
de
.
yr
 = 1904;

1241 
dimeIn
.
time
.
hour
 = 5;

1242 
dimeIn
.
time
.
m
 = 6;

1243 
dimeIn
.
time
.
c
 = 7;

1244 
dimeIn
.
time
.
hunddths
 = 8;

1246 
L
 = 
	`ba_code_cڋxt_dime
(
du
, 10, &
dimeIn
);

1247 
outL
 = 
	`ba_decode_cڋxt_dime
(
du
, 10, &
dimeOut
);

1249 
	`_
(
pTe
, 
L
 =
outL
);

1251 
	`_
(
pTe
, 
dimeIn
.
de
.
day
 =
dimeOut
.date.day);

1252 
	`_
(
pTe
, 
dimeIn
.
de
.
mth
 =
dimeOut
.date.month);

1253 
	`_
(
pTe
, 
dimeIn
.
de
.
wday
 =
dimeOut
.date.wday);

1254 
	`_
(
pTe
, 
dimeIn
.
de
.
yr
 =
dimeOut
.date.year);

1256 
	`_
(
pTe
, 
dimeIn
.
time
.
hour
 =
dimeOut
.time.hour);

1257 
	`_
(
pTe
, 
dimeIn
.
time
.
m
 =
dimeOut
.time.min);

1258 
	`_
(
pTe
, 
dimeIn
.
time
.
c
 =
dimeOut
.time.sec);

1259 
	`_
(
pTe
, 
dimeIn
.
time
.
hunddths
 =
dimeOut
.time.hundredths);

1261 
	}
}

1263 
	$DeTime
(

1264 
Te
 * 
pTe
)

1266 
bo
 
rc
;

1269 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtDe
);

1270 
	`as
(
rc
);

1271 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtTime
);

1272 
	`as
(
rc
);

1273 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtDeTime
);

1274 
	`as
(
rc
);

1275 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtDayOfWk
);

1276 
	`as
(
rc
);

1277 
rc
 = 
	`_addTeFuni
(
pTe
, 
DeEpoch
);

1278 
	`as
(
rc
);

1279 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtDeTimeSecds
);

1280 
	`as
(
rc
);

1281 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtDeTimeAdd
);

1282 
	`as
(
rc
);

1283 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtDeTimeWdrd
);

1284 
	`as
(
rc
);

1285 
rc
 = 
	`_addTeFuni
(
pTe
, 
DimeCodec
);

1286 
	`as
(
rc
);

1287 
rc
 = 
	`_addTeFuni
(
pTe
, 
DayOfYr
);

1288 
	`as
(
rc
);

1289 
rc
 = 
	`_addTeFuni
(
pTe
, 
WdrdDeTime
);

1290 
	`as
(
rc
);

1291 
	}
}

1293 #ifde
TEST_DATE_TIME


1294 
	$ma
(

1297 
Te
 *
pTe
;

1299 
pTe
 = 
	`_
("BACÈDTime", 
NULL
);

1300 
	`DeTime
(
pTe
);

1301 
	`_tSm
(
pTe
, 
dout
);

1302 
	`_run
(
pTe
);

1303 (
	`_pt
(
pTe
);

1304 
	`_deroy
(
pTe
);

1307 
	}
}

	@src/dcc.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"dcc.h
"

47 
ut32_t
 
	gDCC_Time_Duti_Secds
 = 0;

48 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
	gDCC_Eb_Dib
 =

49 
COMMUNICATION_ENABLE
;

52 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
	$dcc_ab_us
(

55  
DCC_Eb_Dib
;

56 
	}
}

58 
bo
 
	$dcc_communiti_abd
(

61  (
DCC_Eb_Dib
 =
COMMUNICATION_ENABLE
);

62 
	}
}

67 
bo
 
	$dcc_communiti_dibd
(

70  (
DCC_Eb_Dib
 =
COMMUNICATION_DISABLE
);

71 
	}
}

82 
bo
 
	$dcc_communiti_ti_dibd
(

85  (
DCC_Eb_Dib
 =
COMMUNICATION_DISABLE_INITIATION
);

86 
	}
}

89 
ut32_t
 
	$dcc_duti_cds
(

92  
DCC_Time_Duti_Secds
;

93 
	}
}

97 
	$dcc_tim_cds
(

98 
ut32_t
 
cds
)

100 i(
DCC_Time_Duti_Secds
) {

101 i(
DCC_Time_Duti_Secds
 > 
cds
)

102 
DCC_Time_Duti_Secds
 -
cds
;

104 
DCC_Time_Duti_Secds
 = 0;

106 i(
DCC_Time_Duti_Secds
 == 0)

107 
DCC_Eb_Dib
 = 
COMMUNICATION_ENABLE
;

109 
	}
}

111 
bo
 
	$dcc_t_us_duti
(

112 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
us
,

113 
ut16_t
 
mus
)

115 
bo
 
vid
 = 
l
;

118 i(
us
 < 
MAX_BACNET_COMMUNICATION_ENABLE_DISABLE
) {

119 
DCC_Eb_Dib
 = 
us
;

120 i(
us
 =
COMMUNICATION_ENABLE
) {

121 
DCC_Time_Duti_Secds
 = 0;

123 
DCC_Time_Duti_Secds
 = 
mus
 * 60;

125 
vid
 = 
ue
;

128  
vid
;

129 
	}
}

131 #i
BACNET_SVC_DCC_A


133 
	$dcc_code_du
(

134 
ut8_t
 * 
du
,

135 
ut8_t
 
voke_id
,

136 
ut16_t
 
timeDuti
,

137 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
ab_dib
,

138 
BACNET_CHARACTER_STRING
 * 
sswd
)

140 
n
 = 0;

141 
du_n
 = 0;

143 i(
du
) {

144 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

145 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

146 
du
[2] = 
voke_id
;

147 
du
[3] = 
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
;

148 
du_n
 = 4;

150 i(
timeDuti
) {

151 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0, 
timeDuti
);

152 
du_n
 +
n
;

155 
n
 = 
	`code_cڋxt_umed
(&
du
[
du_n
], 1, 
ab_dib
);

156 
du_n
 +
n
;

158 i(
sswd
) {

160 
n
 =

161 
	`code_cڋxt_cha_rg
(&
du
[
du_n
], 2, 
sswd
);

162 
du_n
 +
n
;

166  
du_n
;

167 
	}
}

171 
	$dcc_decode_rvi_que
(

172 
ut8_t
 * 
du
,

173 
du_n
,

174 
ut16_t
 * 
timeDuti
,

175 
BACNET_COMMUNICATION_ENABLE_DISABLE
 * 
ab_dib
,

176 
BACNET_CHARACTER_STRING
 * 
sswd
)

178 
n
 = 0;

179 
ut8_t
 
g_numb
 = 0;

180 
ut32_t
 
n_vue_ty
 = 0;

181 
ut32_t
 
vue32
 = 0;

184 i(
du_n
) {

188 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 0)) {

189 
n
 +=

190 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

191 &
n_vue_ty
);

192 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue_ty
, &
vue32
);

193 i(
timeDuti
) {

194 *
timeDuti
 = (
ut16_t

vue32
;

196 } i(
timeDuti
) {

199 *
timeDuti
 = 0;

202 i(!
	`decode_is_cڋxt_g
(&
du
[
n
], 1)) {

205 
n
 +=

206 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

207 &
n_vue_ty
);

208 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
vue32
);

209 i(
ab_dib
) {

210 *
ab_dib
 = (
BACNET_COMMUNICATION_ENABLE_DISABLE

vue32
;

213 i(
n
 < 
du_n
) {

214 i(!
	`decode_is_cڋxt_g
(&
du
[
n
], 2)) {

217 
n
 +=

218 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

219 &
n_vue_ty
);

220 
n
 +=

221 
	`decode_cha_rg
(&
du
[
n
], 
n_vue_ty
, 
sswd
);

222 } i(
sswd
) {

223 
	`charg__si
(
sswd
, 
NULL
);

227  (
n
;

228 
	}
}

230 #ifde
TEST


231 
	~<as.h
>

232 
	~<rg.h
>

233 
	~"e.h
"

235 
	$dcc_decode_du
(

236 
ut8_t
 * 
du
,

237 
du_n
,

238 
ut8_t
 * 
voke_id
,

239 
ut16_t
 * 
timeDuti
,

240 
BACNET_COMMUNICATION_ENABLE_DISABLE
 * 
ab_dib
,

241 
BACNET_CHARACTER_STRING
 * 
sswd
)

243 
n
 = 0;

244 
offt
 = 0;

246 i(!
du
)

249 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

252 *
voke_id
 = 
du
[2];

253 i(
du
[3] !
SERVICE_CONFIRMED_DEVICE_COMMUNICATION_CONTROL
)

255 
offt
 = 4;

257 i(
du_n
 > 
offt
) {

258 
n
 =

259 
	`dcc_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

260 
timeDuti
, 
ab_dib
, 
sswd
);

263  
n
;

264 
	}
}

266 
	$_DeviCommunitiCڌDa
(

267 
Te
 * 
pTe
,

268 
ut8_t
 
voke_id
,

269 
ut16_t
 
timeDuti
,

270 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
ab_dib
,

271 
BACNET_CHARACTER_STRING
 * 
sswd
)

273 
ut8_t
 
du
[480] = { 0 };

274 
n
 = 0;

275 
du_n
 = 0;

276 
ut8_t
 
_voke_id
 = 0;

277 
ut16_t
 
_timeDuti
 = 0;

278 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
_ab_dib
;

279 
BACNET_CHARACTER_STRING
 
_sswd
;

281 
n
 =

282 
	`dcc_code_du
(&
du
[0], 
voke_id
, 
timeDuti
, 
ab_dib
,

283 
sswd
);

284 
	`_
(
pTe
, 
n
 != 0);

285 
du_n
 = 
n
;

287 
n
 =

288 
	`dcc_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

289 &
_timeDuti
, &
_ab_dib
, &
_sswd
);

290 
	`_
(
pTe
, 
n
 != -1);

291 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

292 
	`_
(
pTe
, 
_timeDuti
 =
timeDuti
);

293 
	`_
(
pTe
, 
_ab_dib
 =
ab_dib
);

294 
	`_
(
pTe
, 
	`charg_me
(&
_sswd
, 
sswd
));

295 
	}
}

297 
	$_DeviCommunitiCڌ
(

298 
Te
 * 
pTe
)

300 
ut8_t
 
voke_id
 = 128;

301 
ut16_t
 
timeDuti
 = 0;

302 
BACNET_COMMUNICATION_ENABLE_DISABLE
 
ab_dib
;

303 
BACNET_CHARACTER_STRING
 
sswd
;

305 
timeDuti
 = 0;

306 
ab_dib
 = 
COMMUNICATION_DISABLE_INITIATION
;

307 
	`charg__si
(&
sswd
, "John 3:16");

308 
	`_DeviCommunitiCڌDa
(
pTe
, 
voke_id
, 
timeDuti
,

309 
ab_dib
, &
sswd
);

311 
timeDuti
 = 12345;

312 
ab_dib
 = 
COMMUNICATION_DISABLE
;

313 
	`_DeviCommunitiCڌDa
(
pTe
, 
voke_id
, 
timeDuti
,

314 
ab_dib
, 
NULL
);

317 
	}
}

319 #ifde
TEST_DEVICE_COMMUNICATION_CONTROL


320 
	$ma
(

323 
Te
 *
pTe
;

324 
bo
 
rc
;

326 
pTe
 = 
	`_
("BACÈDeviCommunitiCڌ", 
NULL
);

328 
rc
 = 
	`_addTeFuni
(
pTe
, 
_DeviCommunitiCڌ
);

329 
	`as
(
rc
);

331 
	`_tSm
(
pTe
, 
dout
);

332 
	`_run
(
pTe
);

333 (
	`_pt
(
pTe
);

334 
	`_deroy
(
pTe
);

337 
	}
}

	@src/debug.c

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~<dio.h
>

38 
	~<dlib.h
>

39 
	~<dg.h
>

40 
	~"debug.h
"

44 #i
DEBUG_ENABLED


45 
	$debug_tf
(

46 cڡ *
fm
,

49 
va_li
 

;

51 
	`va_t
(

, 
fm
);

52 
	`vrtf
(
dout
, 
fm
, 

);

53 
	`va_d
(

);

54 
	`fush
(
dout
);

57 
	}
}

59 
	$debug_tf
(

60 cڡ *
fm
,

63 
fm
 = format;

64 
	}
}

	@src/event.c

34 
	~<as.h
>

35 
	~"evt.h
"

36 
	~"bacdcode.h
"

37 
	~"du.h
"

38 
	~"timeamp.h
"

42 
	$uevt_nify_code_du
(

43 
ut8_t
 * 
du
,

44 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
)

46 
n
 = 0;

47 
du_n
 = 0;

50 i(
du
) {

51 
du
[0] = 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
;

52 
du
[1] = 
SERVICE_UNCONFIRMED_EVENT_NOTIFICATION
;

53 
du_n
 = 2;

55 
n
 +
	`evt_nify_code_rvi_que
(&
du
[
du_n
], 
da
);

57 i(
n
 > 0) {

58 
du_n
 +
n
;

60 
du_n
 = 0;

64  
du_n
;

65 
	}
}

67 
	$vt_nify_code_du
(

68 
ut8_t
 * 
du
,

69 
ut8_t
 
voke_id
,

70 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
)

72 
n
 = 0;

73 
du_n
 = 0;

75 i(
du
) {

76 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

77 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

78 
du
[2] = 
voke_id
;

79 
du
[3] = 
SERVICE_CONFIRMED_EVENT_NOTIFICATION
;

80 
du_n
 = 4;

82 
n
 +
	`evt_nify_code_rvi_que
(&
du
[
du_n
], 
da
);

84 i(
n
 > 0) {

85 
du_n
 +
n
;

87 
du_n
 = 0;

91  
du_n
;

92 
	}
}

94 
	$evt_nify_code_rvi_que
(

95 
ut8_t
 * 
du
,

96 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
)

98 
n
 = 0;

99 
du_n
 = 0;

101 i(
du
) {

103 
n
 =

104 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0,

105 
da
->
ossIdtifr
);

106 
du_n
 +
n
;

108 
n
 =

109 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 1,

110 (
da
->
tgObjeIdtifr
.
ty
,

111 
da
->
tgObjeIdtifr
.

);

112 
du_n
 +
n
;

115 
n
 =

116 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 2,

117 (
da
->
evtObjeIdtifr
.
ty
,

118 
da
->
evtObjeIdtifr
.

);

119 
du_n
 +
n
;

123 
n
 =

124 
	`ba_code_cڋxt_timeamp
(&
du
[
du_n
], 3,

125 &
da
->
timeSmp
);

126 
du_n
 +
n
;

130 
n
 =

131 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 4,

132 
da
->
nifitiCss
);

133 
du_n
 +
n
;

137 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 5, 
da
->
iܙy
);

138 
du_n
 +
n
;

141 
n
 = 
	`code_cڋxt_umed
(&
du
[
du_n
], 6, 
da
->
evtTy
);

142 
du_n
 +
n
;

145 i(
da
->
mesgeText
) {

146 
n
 =

147 
	`code_cڋxt_cha_rg
(&
du
[
du_n
], 7,

148 
da
->
mesgeText
);

149 
du_n
 +
n
;

152 
n
 = 
	`code_cڋxt_umed
(&
du
[
du_n
], 8, 
da
->
nifyTy
);

153 
du_n
 +
n
;

155 
da
->
nifyTy
) {

156 
NOTIFY_ALARM
:

157 
NOTIFY_EVENT
:

160 
n
 =

161 
	`code_cڋxt_boޗn
(&
du
[
du_n
], 9,

162 
da
->
ackRequed
);

163 
du_n
 +
n
;

166 
n
 =

167 
	`code_cڋxt_umed
(&
du
[
du_n
], 10,

168 
da
->
omS
);

169 
du_n
 +
n
;

177 
n
 = 
	`code_cڋxt_umed
(&
du
[
du_n
], 11, 
da
->
toS
);

178 
du_n
 +
n
;

180 
da
->
nifyTy
) {

181 
NOTIFY_ALARM
:

182 
NOTIFY_EVENT
:

184 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 12);

185 
du_n
 +
n
;

187 
da
->
evtTy
) {

188 
EVENT_CHANGE_OF_BITSTRING
:

189 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 0);

190 
du_n
 +
n
;

192 
n
 =

193 
	`code_cڋxt_brg
(&
du
[
du_n
], 0,

194 &
da
->
nifitiPams
.

195 
chgeOfBrg
.
ndBSg
);

196 
du_n
 +
n
;

198 
n
 =

199 
	`code_cڋxt_brg
(&
du
[
du_n
], 1,

200 &
da
->
nifitiPams
.

201 
chgeOfBrg
.
usFgs
);

202 
du_n
 +
n
;

204 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 0);

205 
du_n
 +
n
;

208 
EVENT_CHANGE_OF_STATE
:

209 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 1);

210 
du_n
 +
n
;

212 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 0);

213 
du_n
 +
n
;

215 
n
 =

216 
	`ba_code_ݔty_e
(&
du
[
du_n
],

217 &
da
->
nifitiPams
.
chgeOfS
.
wS
);

218 
du_n
 +
n
;

220 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 0);

221 
du_n
 +
n
;

223 
n
 =

224 
	`code_cڋxt_brg
(&
du
[
du_n
], 1,

225 &
da
->
nifitiPams
.

226 
chgeOfS
.
usFgs
);

227 
du_n
 +
n
;

229 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 1);

230 
du_n
 +
n
;

233 
EVENT_CHANGE_OF_VALUE
:

234 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 2);

235 
du_n
 +
n
;

237 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 0);

238 
du_n
 +
n
;

240 
da
->
nifitiPams
.
chgeOfVue
.
g
) {

241 
CHANGE_OF_VALUE_REAL
:

242 
n
 =

243 
	`code_cڋxt_
(&
du
[
du_n
], 1,

244 
da
->
nifitiPams
.

245 
chgeOfVue
.
wVue
.
chgeVue
);

246 
du_n
 +
n
;

249 
CHANGE_OF_VALUE_BITS
:

250 
n
 =

251 
	`code_cڋxt_brg
(&
du
[
du_n
],

253 &
da
->
nifitiPams
.

254 
chgeOfVue
.
wVue
.
chgedBs
);

255 
du_n
 +
n
;

262 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 0);

263 
du_n
 +
n
;

265 
n
 =

266 
	`code_cڋxt_brg
(&
du
[
du_n
], 1,

267 &
da
->
nifitiPams
.

268 
chgeOfVue
.
usFgs
);

269 
du_n
 +
n
;

271 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 2);

272 
du_n
 +
n
;

276 
EVENT_FLOATING_LIMIT
:

277 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 4);

278 
du_n
 +
n
;

280 
n
 =

281 
	`code_cڋxt_
(&
du
[
du_n
], 0,

282 
da
->
nifitiPams
.

283 
tgLim
.
nVue
);

284 
du_n
 +
n
;

286 
n
 =

287 
	`code_cڋxt_brg
(&
du
[
du_n
], 1,

288 &
da
->
nifitiPams
.

289 
tgLim
.
usFgs
);

290 
du_n
 +
n
;

292 
n
 =

293 
	`code_cڋxt_
(&
du
[
du_n
], 2,

294 
da
->
nifitiPams
.

295 
tgLim
.
tPotVue
);

296 
du_n
 +
n
;

298 
n
 =

299 
	`code_cڋxt_
(&
du
[
du_n
], 3,

300 
da
->
nifitiPams
.
tgLim
.
rLim
);

301 
du_n
 +
n
;

303 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 4);

304 
du_n
 +
n
;

308 
EVENT_OUT_OF_RANGE
:

309 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 5);

310 
du_n
 +
n
;

312 
n
 =

313 
	`code_cڋxt_
(&
du
[
du_n
], 0,

314 
da
->
nifitiPams
.

315 
outOfRge
.
exedgVue
);

316 
du_n
 +
n
;

318 
n
 =

319 
	`code_cڋxt_brg
(&
du
[
du_n
], 1,

320 &
da
->
nifitiPams
.
outOfRge
.
usFgs
);

321 
du_n
 +
n
;

323 
n
 =

324 
	`code_cڋxt_
(&
du
[
du_n
], 2,

325 
da
->
nifitiPams
.
outOfRge
.
ddbd
);

326 
du_n
 +
n
;

328 
n
 =

329 
	`code_cڋxt_
(&
du
[
du_n
], 3,

330 
da
->
nifitiPams
.
outOfRge
.
exededLim
);

331 
du_n
 +
n
;

333 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 5);

334 
du_n
 +
n
;

337 
EVENT_CHANGE_OF_LIFE_SAFETY
:

338 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 8);

339 
du_n
 +
n
;

341 
n
 =

342 
	`code_cڋxt_umed
(&
du
[
du_n
], 0,

343 
da
->
nifitiPams
.

344 
chgeOfLiSaty
.
wS
);

345 
du_n
 +
n
;

347 
n
 =

348 
	`code_cڋxt_umed
(&
du
[
du_n
], 1,

349 
da
->
nifitiPams
.

350 
chgeOfLiSaty
.
wMode
);

351 
du_n
 +
n
;

353 
n
 =

354 
	`code_cڋxt_brg
(&
du
[
du_n
], 2,

355 &
da
->
nifitiPams
.

356 
chgeOfLiSaty
.
usFgs
);

357 
du_n
 +
n
;

359 
n
 =

360 
	`code_cڋxt_umed
(&
du
[
du_n
], 3,

361 
da
->
nifitiPams
.

362 
chgeOfLiSaty
.
ݔiExed
);

363 
du_n
 +
n
;

365 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 8);

366 
du_n
 +
n
;

369 
EVENT_BUFFER_READY
:

370 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 10);

371 
du_n
 +
n
;

373 
n
 =

374 
	`ba_code_cڋxt_devi_obj_ݔty_f
(&
du


375 [
du_n
], 0,

376 &
da
->
nifitiPams
.

377 
bufrRdy
.
bufrPrݔty
);

378 
du_n
 +
n
;

380 
n
 =

381 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1,

382 
da
->
nifitiPams
.

383 
bufrRdy
.
eviousNifiti
);

384 
du_n
 +
n
;

386 
n
 =

387 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 2,

388 
da
->
nifitiPams
.

389 
bufrRdy
.
cutNifiti
);

390 
du_n
 +
n
;

392 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 10);

393 
du_n
 +
n
;

395 
EVENT_UNSIGNED_RANGE
:

396 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 11);

397 
du_n
 +
n
;

399 
n
 =

400 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0,

401 
da
->
nifitiPams
.

402 
unsigdRge
.
exedgVue
);

403 
du_n
 +
n
;

405 
n
 =

406 
	`code_cڋxt_brg
(&
du
[
du_n
], 1,

407 &
da
->
nifitiPams
.

408 
unsigdRge
.
usFgs
);

409 
du_n
 +
n
;

411 
n
 =

412 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 2,

413 
da
->
nifitiPams
.

414 
unsigdRge
.
exededLim
);

415 
du_n
 +
n
;

417 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 11);

418 
du_n
 +
n
;

420 
EVENT_EXTENDED
:

421 
EVENT_COMMAND_FAILURE
:

423 
	`as
(0);

426 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 12);

427 
du_n
 +
n
;

429 
NOTIFY_ACK_NOTIFICATION
:

435  
du_n
;

436 
	}
}

438 
	$evt_nify_decode_rvi_que
(

439 
ut8_t
 * 
du
,

440 
du_n
,

441 
BACNET_EVENT_NOTIFICATION_DATA
 * 
da
)

443 
n
 = 0;

444 
i_ngth
 = 0;

445 
ut32_t
 
vue
 = 0;

447 i(
du_n
 && 
da
) {

449 i((
i_ngth
 =

450 
	`decode_cڋxt_unsigd
(&
du
[
n
], 0,

451 &
da
->
ossIdtifr
)) == -1) {

454 
n
 +
i_ngth
;

458 i((
i_ngth
 =

459 
	`decode_cڋxt_obje_id
(&
du
[
n
], 1,

460 &
da
->
tgObjeIdtifr
.
ty
,

461 &
da
->
tgObjeIdtifr
.

)) == -1) {

464 
n
 +
i_ngth
;

467 i((
i_ngth
 =

468 
	`decode_cڋxt_obje_id
(&
du
[
n
], 2,

469 &
da
->
evtObjeIdtifr
.
ty
,

470 &
da
->
evtObjeIdtifr
.

)) == -1) {

473 
n
 +
i_ngth
;

476 i((
i_ngth
 =

477 
	`ba_decode_cڋxt_timeamp
(&
du
[
n
], 3,

478 &
da
->
timeSmp
)) == -1) {

481 
n
 +
i_ngth
;

484 i((
i_ngth
 =

485 
	`decode_cڋxt_unsigd
(&
du
[
n
], 4,

486 &
da
->
nifitiCss
)) == -1) {

489 
n
 +
i_ngth
;

492 i((
i_ngth
 =

493 
	`decode_cڋxt_unsigd
(&
du
[
n
], 5, &
vue
)) == -1) {

496 i(
vue
 > 0xff) {

499 
da
->
iܙy
 = (
ut8_t

vue
;

500 
n
 +
i_ngth
;

504 i((
i_ngth
 =

505 
	`decode_cڋxt_umed
(&
du
[
n
], 6, &
vue
)) == -1) {

508 
da
->
evtTy
 = (
BACNET_EVENT_TYPE

vue
;

509 
n
 +
i_ngth
;

513 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 7)) {

514 i(
da
->
mesgeText
 !
NULL
) {

515 i((
i_ngth
 =

516 
	`decode_cڋxt_cha_rg
(&
du
[
n
], 7,

517 
da
->
mesgeText
)) == -1) {

521 
n
 +
i_ngth
;

527 i(
da
->
mesgeText
 !
NULL
) {

528 
	`charg__si
(
da
->
mesgeText
, "");

533 i((
i_ngth
 =

534 
	`decode_cڋxt_umed
(&
du
[
n
], 8, &
vue
)) == -1) {

537 
da
->
nifyTy
 = (
BACNET_NOTIFY_TYPE

vue
;

538 
n
 +
i_ngth
;

540 
da
->
nifyTy
) {

541 
NOTIFY_ALARM
:

542 
NOTIFY_EVENT
:

544 
i_ngth
 =

545 
	`decode_cڋxt_boޗn2
(&
du
[
n
], 9, &
da
->
ackRequed
);

546 i(
i_ngth
 == -1) {

549 
n
 +
i_ngth
;

552 i((
i_ngth
 =

553 
	`decode_cڋxt_umed
(&
du
[
n
], 10,

554 &
vue
)) == -1) {

557 
da
->
omS
 = (
BACNET_EVENT_STATE

vue
;

558 
n
 +
i_ngth
;

564 
NOTIFY_ACK_NOTIFICATION
:

570 i((
i_ngth
 =

571 
	`decode_cڋxt_umed
(&
du
[
n
], 11, &
vue
)) == -1) {

574 
da
->
toS
 = (
BACNET_EVENT_STATE

vue
;

575 
n
 +
i_ngth
;

578 
da
->
nifyTy
) {

579 
NOTIFY_ALARM
:

580 
NOTIFY_EVENT
:

581 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 12)) {

582 
n
++;

586 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
],

587 (
ut8_t

da
->
evtTy
)) {

588 
n
++;

593 
da
->
evtTy
) {

594 
EVENT_CHANGE_OF_BITSTRING
:

595 i(-1 =(
i_ngth
 =

596 
	`decode_cڋxt_brg
(&
du
[
n
], 0,

597 &
da
->

598 
nifitiPams
.
chgeOfBrg
.

599 
ndBSg
))) {

602 
n
 +
i_ngth
;

604 i(-1 =(
i_ngth
 =

605 
	`decode_cڋxt_brg
(&
du
[
n
], 1,

606 &
da
->

607 
nifitiPams
.
chgeOfBrg
.

608 
usFgs
))) {

611 
n
 +
i_ngth
;

615 
EVENT_CHANGE_OF_STATE
:

616 i(-1 =(
i_ngth
 =

617 
	`ba_decode_cڋxt_ݔty_e
(&
du


618 [
n
], 0,

619 &
da
->
nifitiPams
.

620 
chgeOfS
.
wS
))) {

623 
n
 +
i_ngth
;

625 i(-1 =(
i_ngth
 =

626 
	`decode_cڋxt_brg
(&
du
[
n
], 1,

627 &
da
->
nifitiPams
.

628 
chgeOfS
.
usFgs
))) {

631 
n
 +
i_ngth
;

635 
EVENT_CHANGE_OF_VALUE
:

636 i(!
	`decode_is_ݒg_g_numb
(&
du
[
n
], 0)) {

639 
n
++;

641 i(
	`decode_is_cڋxt_g
(&
du
[
n
],

642 
CHANGE_OF_VALUE_BITS
)) {

644 i(-1 =(
i_ngth
 =

645 
	`decode_cڋxt_brg
(&
du
[
n
], 0,

646 &
da
->

647 
nifitiPams
.
chgeOfVue
.

648 
wVue
.
chgedBs
))) {

652 
n
 +
i_ngth
;

653 
da
->
nifitiPams
.
chgeOfVue
.
g
 =

654 
CHANGE_OF_VALUE_BITS
;

655 } i(
	`decode_is_cڋxt_g
(&
du
[
n
],

656 
CHANGE_OF_VALUE_REAL
)) {

657 i(-1 =(
i_ngth
 =

658 
	`decode_cڋxt_
(&
du
[
n
], 1,

659 &
da
->

660 
nifitiPams
.
chgeOfVue
.

661 
wVue
.
chgeVue
))) {

665 
n
 +
i_ngth
;

666 
da
->
nifitiPams
.
chgeOfVue
.
g
 =

667 
CHANGE_OF_VALUE_REAL
;

671 i(!
	`decode_is_osg_g_numb
(&
du
[
n
], 0)) {

674 
n
++;

677 i(-1 =(
i_ngth
 =

678 
	`decode_cڋxt_brg
(&
du
[
n
], 1,

679 &
da
->
nifitiPams
.

680 
chgeOfVue
.
usFgs
))) {

683 
n
 +
i_ngth
;

686 
EVENT_FLOATING_LIMIT
:

687 i(-1 =(
i_ngth
 =

688 
	`decode_cڋxt_
(&
du
[
n
], 0,

689 &
da
->
nifitiPams
.

690 
tgLim
.
nVue
))) {

693 
n
 +
i_ngth
;

695 i(-1 =(
i_ngth
 =

696 
	`decode_cڋxt_brg
(&
du
[
n
], 1,

697 &
da
->
nifitiPams
.

698 
tgLim
.
usFgs
))) {

701 
n
 +
i_ngth
;

702 i(-1 =(
i_ngth
 =

703 
	`decode_cڋxt_
(&
du
[
n
], 2,

704 &
da
->
nifitiPams
.

705 
tgLim
.
tPotVue
))) {

708 
n
 +
i_ngth
;

710 i(-1 =(
i_ngth
 =

711 
	`decode_cڋxt_
(&
du
[
n
], 3,

712 &
da
->
nifitiPams
.

713 
tgLim
.
rLim
))) {

716 
n
 +
i_ngth
;

719 
EVENT_OUT_OF_RANGE
:

720 i(-1 =(
i_ngth
 =

721 
	`decode_cڋxt_
(&
du
[
n
], 0,

722 &
da
->
nifitiPams
.

723 
outOfRge
.
exedgVue
))) {

726 
n
 +
i_ngth
;

728 i(-1 =(
i_ngth
 =

729 
	`decode_cڋxt_brg
(&
du
[
n
], 1,

730 &
da
->
nifitiPams
.

731 
outOfRge
.
usFgs
))) {

734 
n
 +
i_ngth
;

735 i(-1 =(
i_ngth
 =

736 
	`decode_cڋxt_
(&
du
[
n
], 2,

737 &
da
->
nifitiPams
.

738 
outOfRge
.
ddbd
))) {

741 
n
 +
i_ngth
;

743 i(-1 =(
i_ngth
 =

744 
	`decode_cڋxt_
(&
du
[
n
], 3,

745 &
da
->
nifitiPams
.

746 
outOfRge
.
exededLim
))) {

749 
n
 +
i_ngth
;

753 
EVENT_CHANGE_OF_LIFE_SAFETY
:

754 i(-1 =(
i_ngth
 =

755 
	`decode_cڋxt_umed
(&
du
[
n
], 0,

756 &
vue
))) {

759 
da
->
nifitiPams
.
chgeOfLiSaty
.
wS
 =

760 (
BACNET_LIFE_SAFETY_STATE

vue
;

761 
n
 +
i_ngth
;

763 i(-1 =(
i_ngth
 =

764 
	`decode_cڋxt_umed
(&
du
[
n
], 1,

765 &
vue
))) {

768 
da
->
nifitiPams
.
chgeOfLiSaty
.
wMode
 =

769 (
BACNET_LIFE_SAFETY_MODE

vue
;

770 
n
 +
i_ngth
;

772 i(-1 =(
i_ngth
 =

773 
	`decode_cڋxt_brg
(&
du
[
n
], 2,

774 &
da
->

775 
nifitiPams
.
chgeOfLiSaty
.

776 
usFgs
))) {

779 
n
 +
i_ngth
;

781 i(-1 =(
i_ngth
 =

782 
	`decode_cڋxt_umed
(&
du
[
n
], 3,

783 &
vue
))) {

786 
da
->
nifitiPams
.

787 
chgeOfLiSaty
.
ݔiExed
 =

788 (
BACNET_LIFE_SAFETY_OPERATION

vue
;

789 
n
 +
i_ngth
;

792 
EVENT_BUFFER_READY
:

793 i(-1 =(
i_ngth
 =

794 
ba_decode_cڋxt_devi_obj_ݔty_f


795 (&
du
[
n
], 0,

796 &
da
->
nifitiPams
.

797 
bufrRdy
.
bufrPrݔty
))) {

800 
n
 +
i_ngth
;

802 i(-1 =(
i_ngth
 =

803 
	`decode_cڋxt_unsigd
(&
du
[
n
], 1,

804 &
da
->
nifitiPams
.

805 
bufrRdy
.
eviousNifiti
))) {

808 
n
 +
i_ngth
;

810 i(-1 =(
i_ngth
 =

811 
	`decode_cڋxt_unsigd
(&
du
[
n
], 2,

812 &
da
->
nifitiPams
.

813 
bufrRdy
.
cutNifiti
))) {

816 
n
 +
i_ngth
;

819 
EVENT_UNSIGNED_RANGE
:

820 i(-1 =(
i_ngth
 =

821 
	`decode_cڋxt_unsigd
(&
du
[
n
], 0,

822 &
da
->
nifitiPams
.

823 
unsigdRge
.
exedgVue
))) {

826 
n
 +
i_ngth
;

828 i(-1 =(
i_ngth
 =

829 
	`decode_cڋxt_brg
(&
du
[
n
], 1,

830 &
da
->
nifitiPams
.

831 
unsigdRge
.
usFgs
))) {

834 
n
 +
i_ngth
;

836 i(-1 =(
i_ngth
 =

837 
	`decode_cڋxt_unsigd
(&
du
[
n
], 2,

838 &
da
->
nifitiPams
.

839 
unsigdRge
.
exededLim
))) {

842 
n
 +
i_ngth
;

848 i(
	`decode_is_osg_g_numb
(&
du
[
n
],

849 (
ut8_t

da
->
evtTy
)) {

850 
n
++;

854 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 12)) {

855 
n
++;

863 
NOTIFY_ACK_NOTIFICATION
:

869  
n
;

870 
	}
}

872 #ifde 
TEST


874 
	~<as.h
>

875 
	~<rg.h
>

876 
	~"e.h
"

879 
BACNET_EVENT_NOTIFICATION_DATA
 
	gda
;

880 
BACNET_EVENT_NOTIFICATION_DATA
 
	gda2
;

882 
	$BaEvtS
(

883 
Te
 * 
pTe
)

885 
	`_
(
pTe
, 
da
.
ossIdtifr
 =
da2
.processIdentifier);

886 
	`_
(
pTe
,

887 
da
.
tgObjeIdtifr
.

 ==

888 
da2
.
tgObjeIdtifr
.

);

889 
	`_
(
pTe
,

890 
da
.
tgObjeIdtifr
.
ty
 ==

891 
da2
.
tgObjeIdtifr
.
ty
);

892 
	`_
(
pTe
,

893 
da
.
evtObjeIdtifr
.

 ==

894 
da2
.
evtObjeIdtifr
.

);

895 
	`_
(
pTe
,

896 
da
.
evtObjeIdtifr
.
ty
 =
da2
.eventObjectIdentifier.type);

897 
	`_
(
pTe
, 
da
.
nifitiCss
 =
da2
.notificationClass);

898 
	`_
(
pTe
, 
da
.
iܙy
 =
da2
.priority);

899 
	`_
(
pTe
, 
da
.
nifyTy
 =
da2
.notifyType);

900 
	`_
(
pTe
, 
da
.
omS
 =
da2
.fromState);

901 
	`_
(
pTe
, 
da
.
toS
 =
da2
.toState);

902 
	`_
(
pTe
, 
da
.
toS
 =
da2
.toState);

904 i(
da
.
mesgeText
 !
NULL
 && 
da2
.messageText != NULL) {

905 
	`_
(
pTe
,

906 
da
.
mesgeText
->
codg
 =
da2
.messageText->encoding);

907 
	`_
(
pTe
, 
da
.
mesgeText
->
ngth
 =
da2
.messageText->length);

908 
	`_
(
pTe
, 
	`rcmp
(
da
.
mesgeText
->
vue
,

909 
da2
.
mesgeText
->
vue
) == 0);

912 
	`_
(
pTe
, 
da
.
timeSmp
.
g
 =
da2
.timeStamp.tag);

914 
da
.
timeSmp
.
g
) {

915 
TIME_STAMP_SEQUENCE
:

916 
	`_
(
pTe
,

917 
da
.
timeSmp
.
vue
.
quNum
 ==

918 
da2
.
timeSmp
.
vue
.
quNum
);

921 
TIME_STAMP_DATETIME
:

922 
	`_
(
pTe
,

923 
da
.
timeSmp
.
vue
.
deTime
.
time
.
hour
 ==

924 
da2
.
timeSmp
.
vue
.
deTime
.
time
.
hour
);

925 
	`_
(
pTe
,

926 
da
.
timeSmp
.
vue
.
deTime
.
time
.
m
 ==

927 
da2
.
timeSmp
.
vue
.
deTime
.
time
.
m
);

928 
	`_
(
pTe
,

929 
da
.
timeSmp
.
vue
.
deTime
.
time
.
c
 ==

930 
da2
.
timeSmp
.
vue
.
deTime
.
time
.
c
);

931 
	`_
(
pTe
,

932 
da
.
timeSmp
.
vue
.
deTime
.
time
.
hunddths
 ==

933 
da2
.
timeSmp
.
vue
.
deTime
.
time
.
hunddths
);

935 
	`_
(
pTe
,

936 
da
.
timeSmp
.
vue
.
deTime
.
de
.
day
 ==

937 
da2
.
timeSmp
.
vue
.
deTime
.
de
.
day
);

938 
	`_
(
pTe
,

939 
da
.
timeSmp
.
vue
.
deTime
.
de
.
mth
 ==

940 
da2
.
timeSmp
.
vue
.
deTime
.
de
.
mth
);

941 
	`_
(
pTe
,

942 
da
.
timeSmp
.
vue
.
deTime
.
de
.
wday
 ==

943 
da2
.
timeSmp
.
vue
.
deTime
.
de
.
wday
);

944 
	`_
(
pTe
,

945 
da
.
timeSmp
.
vue
.
deTime
.
de
.
yr
 ==

946 
da2
.
timeSmp
.
vue
.
deTime
.
de
.
yr
);

949 
TIME_STAMP_TIME
:

950 
	`_
(
pTe
,

951 
da
.
timeSmp
.
vue
.
time
.
hour
 ==

952 
da2
.
timeSmp
.
vue
.
time
.
hour
);

953 
	`_
(
pTe
,

954 
da
.
timeSmp
.
vue
.
time
.
m
 ==

955 
da2
.
timeSmp
.
vue
.
time
.
m
);

956 
	`_
(
pTe
,

957 
da
.
timeSmp
.
vue
.
time
.
c
 ==

958 
da2
.
timeSmp
.
vue
.
time
.
c
);

959 
	`_
(
pTe
,

960 
da
.
timeSmp
.
vue
.
time
.
hunddths
 ==

961 
da2
.
timeSmp
.
vue
.
time
.
hunddths
);

965 
	`_
(
pTe
, "Unknownype");

968 
	}
}

970 
	$EvtEvtS
(

971 
Te
 * 
pTe
)

973 
ut8_t
 
bufr
[
MAX_APDU
];

974 
L
;

975 
outL
;

976 
BACNET_CHARACTER_STRING
 
mesgeText
;

977 
BACNET_CHARACTER_STRING
 
mesgeText2
;

978 
	`charg__si
(&
mesgeText
,

981 
da
.
mesgeText
 = &messageText;

982 
da2
.
mesgeText
 = &
mesgeText2
;

984 
da
.
ossIdtifr
 = 1234;

985 
da
.
tgObjeIdtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

986 
da
.
tgObjeIdtifr
.

 = 100;

987 
da
.
evtObjeIdtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

988 
da
.
evtObjeIdtifr
.

 = 200;

989 
da
.
timeSmp
.
vue
.
quNum
 = 1234;

990 
da
.
timeSmp
.
g
 = 
TIME_STAMP_SEQUENCE
;

991 
da
.
nifitiCss
 = 50;

992 
da
.
iܙy
 = 50;

993 
da
.
nifyTy
 = 
NOTIFY_ALARM
;

994 
da
.
omS
 = 
EVENT_STATE_NORMAL
;

995 
da
.
toS
 = 
EVENT_STATE_OFFNORMAL
;

997 
da
.
evtTy
 = 
EVENT_CHANGE_OF_STATE
;

998 
da
.
nifitiPams
.
chgeOfS
.
wS
.
g
 = 
UNITS
;

999 
da
.
nifitiPams
.
chgeOfS
.
wS
.
e
.
uns
 =

1000 
UNITS_SQUARE_METERS
;

1002 
	`brg_
(&
da
.
nifitiPams
.
chgeOfS
.
usFgs
);

1003 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfS
.
usFgs
,

1004 
STATUS_FLAG_IN_ALARM
, 
ue
);

1005 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfS
.
usFgs
,

1006 
STATUS_FLAG_FAULT
, 
l
);

1007 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfS
.
usFgs
,

1008 
STATUS_FLAG_OVERRIDDEN
, 
l
);

1009 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfS
.
usFgs
,

1010 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

1013 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1015 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1017 
	`_
(
pTe
, 
L
 =
outL
);

1018 
	`BaEvtS
(
pTe
);

1020 
	`_
(
pTe
,

1021 
da
.
nifitiPams
.
chgeOfS
.
wS
.
g
 ==

1022 
da2
.
nifitiPams
.
chgeOfS
.
wS
.
g
);

1023 
	`_
(
pTe
,

1024 
da
.
nifitiPams
.
chgeOfS
.
wS
.
e
.
uns
 ==

1025 
da2
.
nifitiPams
.
chgeOfS
.
wS
.
e
.
uns
);

1027 
	`_
(
pTe
,

1028 
	`brg_me
(&
da
.
nifitiPams
.
chgeOfS
.
usFgs
,

1029 &
da2
.
nifitiPams
.
chgeOfS
.
usFgs
));

1042 
da
.
timeSmp
.
g
 = 
TIME_STAMP_DATETIME
;

1043 
da
.
timeSmp
.
vue
.
deTime
.
time
.
hour
 = 1;

1044 
da
.
timeSmp
.
vue
.
deTime
.
time
.
m
 = 2;

1045 
da
.
timeSmp
.
vue
.
deTime
.
time
.
c
 = 3;

1046 
da
.
timeSmp
.
vue
.
deTime
.
time
.
hunddths
 = 4;

1048 
da
.
timeSmp
.
vue
.
deTime
.
de
.
day
 = 1;

1049 
da
.
timeSmp
.
vue
.
deTime
.
de
.
mth
 = 1;

1050 
da
.
timeSmp
.
vue
.
deTime
.
de
.
wday
 = 1;

1051 
da
.
timeSmp
.
vue
.
deTime
.
de
.
yr
 = 1945;

1053 
	`memt
(
bufr
, 0, 
MAX_APDU
);

1054 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1056 
	`memt
(&
da2
, 0, (data2));

1057 
da2
.
mesgeText
 = &
mesgeText2
;

1058 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1060 
	`_
(
pTe
, 
L
 =
outL
);

1061 
	`BaEvtS
(
pTe
);

1062 
	`_
(
pTe
,

1063 
da
.
nifitiPams
.
chgeOfS
.
wS
.
g
 ==

1064 
da2
.
nifitiPams
.
chgeOfS
.
wS
.
g
);

1065 
	`_
(
pTe
,

1066 
da
.
nifitiPams
.
chgeOfS
.
wS
.
e
.
uns
 ==

1067 
da2
.
nifitiPams
.
chgeOfS
.
wS
.
e
.
uns
);

1080 
da
.
timeSmp
.
vue
.
quNum
 = 1234;

1081 
da
.
timeSmp
.
g
 = 
TIME_STAMP_SEQUENCE
;

1083 
da
.
evtTy
 = 
EVENT_CHANGE_OF_BITSTRING
;

1085 
	`brg_
(&
da
.
nifitiPams
.

1086 
chgeOfBrg
.
ndBSg
);

1087 
	`brg_t_b
(&
da
.
nifitiPams
.

1088 
chgeOfBrg
.
ndBSg
, 0, 
ue
);

1089 
	`brg_t_b
(&
da
.
nifitiPams
.

1090 
chgeOfBrg
.
ndBSg
, 1, 
l
);

1091 
	`brg_t_b
(&
da
.
nifitiPams
.

1092 
chgeOfBrg
.
ndBSg
, 2, 
ue
);

1093 
	`brg_t_b
(&
da
.
nifitiPams
.

1094 
chgeOfBrg
.
ndBSg
, 2, 
l
);

1096 
	`brg_
(&
da
.
nifitiPams
.
chgeOfBrg
.
usFgs
);

1098 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfBrg
.
usFgs
,

1099 
STATUS_FLAG_IN_ALARM
, 
ue
);

1100 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfBrg
.
usFgs
,

1101 
STATUS_FLAG_FAULT
, 
l
);

1102 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfBrg
.
usFgs
,

1103 
STATUS_FLAG_OVERRIDDEN
, 
l
);

1104 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfBrg
.
usFgs
,

1105 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

1107 
	`memt
(
bufr
, 0, 
MAX_APDU
);

1108 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1110 
	`memt
(&
da2
, 0, (data2));

1111 
da2
.
mesgeText
 = &
mesgeText2
;

1112 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1114 
	`_
(
pTe
, 
L
 =
outL
);

1115 
	`BaEvtS
(
pTe
);

1117 
	`_
(
pTe
,

1118 
	`brg_me
(&
da
.
nifitiPams
.
chgeOfBrg
.

1119 
ndBSg
,

1120 &
da2
.
nifitiPams
.
chgeOfBrg
.
ndBSg
));

1122 
	`_
(
pTe
,

1123 
	`brg_me
(&
da
.
nifitiPams
.
chgeOfBrg
.
usFgs
,

1124 &
da2
.
nifitiPams
.
chgeOfBrg
.
usFgs
));

1137 
da
.
evtTy
 = 
EVENT_CHANGE_OF_VALUE
;

1138 
da
.
nifitiPams
.
chgeOfVue
.
g
 = 
CHANGE_OF_VALUE_REAL
;

1139 
da
.
nifitiPams
.
chgeOfVue
.
wVue
.
chgeVue
 = 1.23f;

1141 
	`brg_
(&
da
.
nifitiPams
.
chgeOfVue
.
usFgs
);

1143 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfVue
.
usFgs
,

1144 
STATUS_FLAG_IN_ALARM
, 
ue
);

1145 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfVue
.
usFgs
,

1146 
STATUS_FLAG_FAULT
, 
l
);

1147 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfVue
.
usFgs
,

1148 
STATUS_FLAG_OVERRIDDEN
, 
l
);

1149 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfVue
.
usFgs
,

1150 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

1152 
	`memt
(
bufr
, 0, 
MAX_APDU
);

1153 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1155 
	`memt
(&
da2
, 0, (data2));

1156 
da2
.
mesgeText
 = &
mesgeText2
;

1157 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1159 
	`_
(
pTe
, 
L
 =
outL
);

1160 
	`BaEvtS
(
pTe
);

1162 
	`_
(
pTe
,

1163 
	`brg_me
(&
da
.
nifitiPams
.
chgeOfVue
.
usFgs
,

1164 &
da2
.
nifitiPams
.
chgeOfVue
.
usFgs
));

1166 
	`_
(
pTe
,

1167 
da
.
nifitiPams
.
chgeOfVue
.
g
 ==

1168 
da2
.
nifitiPams
.
chgeOfVue
.
g
);

1170 
	`_
(
pTe
,

1171 
da
.
nifitiPams
.
chgeOfVue
.
wVue
.
chgeVue
 ==

1172 
da2
.
nifitiPams
.
chgeOfVue
.
wVue
.
chgeVue
);

1180 
da
.
nifitiPams
.
chgeOfVue
.
g
 = 
CHANGE_OF_VALUE_BITS
;

1182 
	`brg_
(&
da
.
nifitiPams
.
chgeOfVue
.

1183 
wVue
.
chgedBs
);

1184 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfVue
.

1185 
wVue
.
chgedBs
, 0, 
ue
);

1186 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfVue
.

1187 
wVue
.
chgedBs
, 1, 
l
);

1188 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfVue
.

1189 
wVue
.
chgedBs
, 2, 
l
);

1190 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfVue
.

1191 
wVue
.
chgedBs
, 3, 
l
);

1193 
	`memt
(
bufr
, 0, 
MAX_APDU
);

1194 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1196 
	`memt
(&
da2
, 0, (data2));

1197 
da2
.
mesgeText
 = &
mesgeText2
;

1198 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1200 
	`_
(
pTe
, 
L
 =
outL
);

1201 
	`BaEvtS
(
pTe
);

1203 
	`_
(
pTe
,

1204 
	`brg_me
(&
da
.
nifitiPams
.
chgeOfVue
.
usFgs
,

1205 &
da2
.
nifitiPams
.
chgeOfVue
.
usFgs
));

1207 
	`_
(
pTe
,

1208 
da
.
nifitiPams
.
chgeOfVue
.
g
 ==

1209 
da2
.
nifitiPams
.
chgeOfVue
.
g
);

1211 
	`_
(
pTe
,

1212 
	`brg_me
(&
da
.
nifitiPams
.
chgeOfVue
.
wVue
.

1213 
chgedBs
,

1214 &
da2
.
nifitiPams
.
chgeOfVue
.
wVue
.
chgedBs
));

1226 
da
.
evtTy
 = 
EVENT_FLOATING_LIMIT
;

1227 
da
.
nifitiPams
.
tgLim
.
nVue
 = 1.23f;

1228 
da
.
nifitiPams
.
tgLim
.
tPotVue
 = 2.34f;

1229 
da
.
nifitiPams
.
tgLim
.
rLim
 = 3.45f;

1231 
	`brg_
(&
da
.
nifitiPams
.
tgLim
.
usFgs
);

1233 
	`brg_t_b
(&
da
.
nifitiPams
.
tgLim
.
usFgs
,

1234 
STATUS_FLAG_IN_ALARM
, 
ue
);

1235 
	`brg_t_b
(&
da
.
nifitiPams
.
tgLim
.
usFgs
,

1236 
STATUS_FLAG_FAULT
, 
l
);

1237 
	`brg_t_b
(&
da
.
nifitiPams
.
tgLim
.
usFgs
,

1238 
STATUS_FLAG_OVERRIDDEN
, 
l
);

1239 
	`brg_t_b
(&
da
.
nifitiPams
.
tgLim
.
usFgs
,

1240 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

1242 
	`memt
(
bufr
, 0, 
MAX_APDU
);

1243 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1245 
	`memt
(&
da2
, 0, (data2));

1246 
da2
.
mesgeText
 = &
mesgeText2
;

1247 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1249 
	`_
(
pTe
, 
L
 =
outL
);

1250 
	`BaEvtS
(
pTe
);

1252 
	`_
(
pTe
,

1253 
da
.
nifitiPams
.
tgLim
.
nVue
 ==

1254 
da2
.
nifitiPams
.
tgLim
.
nVue
);

1256 
	`_
(
pTe
,

1257 
da
.
nifitiPams
.
tgLim
.
tPotVue
 ==

1258 
da2
.
nifitiPams
.
tgLim
.
tPotVue
);

1260 
	`_
(
pTe
,

1261 
da
.
nifitiPams
.
tgLim
.
rLim
 ==

1262 
da2
.
nifitiPams
.
tgLim
.
rLim
);

1263 
	`_
(
pTe
,

1264 
	`brg_me
(&
da
.
nifitiPams
.
tgLim
.
usFgs
,

1265 &
da2
.
nifitiPams
.
tgLim
.
usFgs
));

1278 
da
.
evtTy
 = 
EVENT_OUT_OF_RANGE
;

1279 
da
.
nifitiPams
.
outOfRge
.
exedgVue
 = 3.45f;

1280 
da
.
nifitiPams
.
outOfRge
.
ddbd
 = 2.34f;

1281 
da
.
nifitiPams
.
outOfRge
.
exededLim
 = 1.23f;

1283 
	`brg_
(&
da
.
nifitiPams
.
outOfRge
.
usFgs
);

1285 
	`brg_t_b
(&
da
.
nifitiPams
.
outOfRge
.
usFgs
,

1286 
STATUS_FLAG_IN_ALARM
, 
ue
);

1287 
	`brg_t_b
(&
da
.
nifitiPams
.
outOfRge
.
usFgs
,

1288 
STATUS_FLAG_FAULT
, 
l
);

1289 
	`brg_t_b
(&
da
.
nifitiPams
.
outOfRge
.
usFgs
,

1290 
STATUS_FLAG_OVERRIDDEN
, 
l
);

1291 
	`brg_t_b
(&
da
.
nifitiPams
.
outOfRge
.
usFgs
,

1292 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

1294 
	`memt
(
bufr
, 0, 
MAX_APDU
);

1295 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1297 
	`memt
(&
da2
, 0, (data2));

1298 
da2
.
mesgeText
 = &
mesgeText2
;

1299 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1301 
	`_
(
pTe
, 
L
 =
outL
);

1302 
	`BaEvtS
(
pTe
);

1304 
	`_
(
pTe
,

1305 
da
.
nifitiPams
.
outOfRge
.
ddbd
 ==

1306 
da2
.
nifitiPams
.
outOfRge
.
ddbd
);

1308 
	`_
(
pTe
,

1309 
da
.
nifitiPams
.
outOfRge
.
exededLim
 ==

1310 
da2
.
nifitiPams
.
outOfRge
.
exededLim
);

1312 
	`_
(
pTe
,

1313 
da
.
nifitiPams
.
outOfRge
.
exedgVue
 ==

1314 
da2
.
nifitiPams
.
outOfRge
.
exedgVue
);

1315 
	`_
(
pTe
,

1316 
	`brg_me
(&
da
.
nifitiPams
.
outOfRge
.
usFgs
,

1317 &
da2
.
nifitiPams
.
outOfRge
.
usFgs
));

1329 
da
.
evtTy
 = 
EVENT_CHANGE_OF_LIFE_SAFETY
;

1330 
da
.
nifitiPams
.
chgeOfLiSaty
.
wS
 =

1331 
LIFE_SAFETY_STATE_ALARM
;

1332 
da
.
nifitiPams
.
chgeOfLiSaty
.
wMode
 =

1333 
LIFE_SAFETY_MODE_ARMED
;

1334 
da
.
nifitiPams
.
chgeOfLiSaty
.
ݔiExed
 =

1335 
LIFE_SAFETY_OP_RESET
;

1337 
	`brg_
(&
da
.
nifitiPams
.
chgeOfLiSaty
.
usFgs
);

1339 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfLiSaty
.
usFgs
,

1340 
STATUS_FLAG_IN_ALARM
, 
ue
);

1341 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfLiSaty
.
usFgs
,

1342 
STATUS_FLAG_FAULT
, 
l
);

1343 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfLiSaty
.
usFgs
,

1344 
STATUS_FLAG_OVERRIDDEN
, 
l
);

1345 
	`brg_t_b
(&
da
.
nifitiPams
.
chgeOfLiSaty
.
usFgs
,

1346 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

1348 
	`memt
(
bufr
, 0, 
MAX_APDU
);

1349 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1351 
	`memt
(&
da2
, 0, (data2));

1352 
da2
.
mesgeText
 = &
mesgeText2
;

1353 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1355 
	`_
(
pTe
, 
L
 =
outL
);

1356 
	`BaEvtS
(
pTe
);

1358 
	`_
(
pTe
,

1359 
da
.
nifitiPams
.
chgeOfLiSaty
.
wMode
 ==

1360 
da2
.
nifitiPams
.
chgeOfLiSaty
.
wMode
);

1362 
	`_
(
pTe
,

1363 
da
.
nifitiPams
.
chgeOfLiSaty
.
wS
 ==

1364 
da2
.
nifitiPams
.
chgeOfLiSaty
.
wS
);

1366 
	`_
(
pTe
,

1367 
da
.
nifitiPams
.
chgeOfLiSaty
.
ݔiExed
 ==

1368 
da2
.
nifitiPams
.
chgeOfLiSaty
.
ݔiExed
);

1370 
	`_
(
pTe
,

1371 
	`brg_me
(&
da
.
nifitiPams
.
chgeOfLiSaty
.
usFgs
,

1372 &
da2
.
nifitiPams
.
chgeOfLiSaty
.
usFgs
));

1384 
da
.
evtTy
 = 
EVENT_UNSIGNED_RANGE
;

1385 
da
.
nifitiPams
.
unsigdRge
.
exedgVue
 = 1234;

1386 
da
.
nifitiPams
.
unsigdRge
.
exededLim
 = 2345;

1388 
	`brg_
(&
da
.
nifitiPams
.
unsigdRge
.
usFgs
);

1390 
	`brg_t_b
(&
da
.
nifitiPams
.
unsigdRge
.
usFgs
,

1391 
STATUS_FLAG_IN_ALARM
, 
ue
);

1392 
	`brg_t_b
(&
da
.
nifitiPams
.
unsigdRge
.
usFgs
,

1393 
STATUS_FLAG_FAULT
, 
l
);

1394 
	`brg_t_b
(&
da
.
nifitiPams
.
unsigdRge
.
usFgs
,

1395 
STATUS_FLAG_OVERRIDDEN
, 
l
);

1396 
	`brg_t_b
(&
da
.
nifitiPams
.
unsigdRge
.
usFgs
,

1397 
STATUS_FLAG_OUT_OF_SERVICE
, 
l
);

1399 
	`memt
(
bufr
, 0, 
MAX_APDU
);

1400 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1402 
	`memt
(&
da2
, 0, (data2));

1403 
da2
.
mesgeText
 = &
mesgeText2
;

1404 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1406 
	`_
(
pTe
, 
L
 =
outL
);

1407 
	`BaEvtS
(
pTe
);

1409 
	`_
(
pTe
,

1410 
da
.
nifitiPams
.
unsigdRge
.
exedgVue
 ==

1411 
da2
.
nifitiPams
.
unsigdRge
.
exedgVue
);

1413 
	`_
(
pTe
,

1414 
da
.
nifitiPams
.
unsigdRge
.
exededLim
 ==

1415 
da2
.
nifitiPams
.
unsigdRge
.
exededLim
);

1417 
	`_
(
pTe
,

1418 
	`brg_me
(&
da
.
nifitiPams
.
unsigdRge
.
usFgs
,

1419 &
da2
.
nifitiPams
.
unsigdRge
.
usFgs
));

1431 
da
.
evtTy
 = 
EVENT_BUFFER_READY
;

1432 
da
.
nifitiPams
.
bufrRdy
.
eviousNifiti
 = 1234;

1433 
da
.
nifitiPams
.
bufrRdy
.
cutNifiti
 = 2345;

1434 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.
deviIndtifr
.
ty
 =

1435 
OBJECT_DEVICE
;

1436 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1437 
deviIndtifr
.

 = 500;

1438 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.
objeIdtifr
.
ty
 =

1439 
OBJECT_ANALOG_INPUT
;

1440 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1441 
objeIdtifr
.

 = 100;

1442 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.
ݔtyIdtifr
 =

1443 
PROP_PRESENT_VALUE
;

1444 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.
yIndex
 = 0;

1446 
	`memt
(
bufr
, 0, 
MAX_APDU
);

1447 
L
 = 
	`evt_nify_code_rvi_que
(&
bufr
[0], &
da
);

1449 
	`memt
(&
da2
, 0, (data2));

1450 
da2
.
mesgeText
 = &
mesgeText2
;

1451 
outL
 = 
	`evt_nify_decode_rvi_que
(&
bufr
[0], 
L
, &
da2
);

1453 
	`_
(
pTe
, 
L
 =
outL
);

1454 
	`BaEvtS
(
pTe
);

1456 
	`_
(
pTe
,

1457 
da
.
nifitiPams
.
bufrRdy
.
eviousNifiti
 ==

1458 
da2
.
nifitiPams
.
bufrRdy
.
eviousNifiti
);

1460 
	`_
(
pTe
,

1461 
da
.
nifitiPams
.
bufrRdy
.
cutNifiti
 ==

1462 
da2
.
nifitiPams
.
bufrRdy
.
cutNifiti
);

1465 
	`_
(
pTe
,

1466 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1467 
deviIndtifr
.
ty
 ==

1468 
da2
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1469 
deviIndtifr
.
ty
);

1471 
	`_
(
pTe
,

1472 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1473 
deviIndtifr
.

 ==

1474 
da2
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1475 
deviIndtifr
.

);

1477 
	`_
(
pTe
,

1478 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1479 
objeIdtifr
.

 ==

1480 
da2
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1481 
objeIdtifr
.

);

1483 
	`_
(
pTe
,

1484 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1485 
objeIdtifr
.
ty
 ==

1486 
da2
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.

1487 
objeIdtifr
.
ty
);

1489 
	`_
(
pTe
,

1490 
da
.
nifitiPams
.
bufrRdy
.

1491 
bufrPrݔty
.
ݔtyIdtifr
 ==

1492 
da2
.
nifitiPams
.
bufrRdy
.

1493 
bufrPrݔty
.
ݔtyIdtifr
);

1495 
	`_
(
pTe
,

1496 
da
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.
yIndex
 ==

1497 
da2
.
nifitiPams
.
bufrRdy
.
bufrPrݔty
.
yIndex
);

1498 
	}
}

1500 #ifde
TEST_EVENT


1502 
	$ma
(

1505 
Te
 *
pTe
;

1506 
bo
 
rc
;

1508 
pTe
 = 
	`_
("BACÈEvt", 
NULL
);

1510 
rc
 = 
	`_addTeFuni
(
pTe
, 
EvtEvtS
);

1511 
	`as
(
rc
);

1513 
	`_tSm
(
pTe
, 
dout
);

1514 
	`_run
(
pTe
);

1515 (
	`_pt
(
pTe
);

1516 
	`_deroy
(
pTe
);

1519 
	}
}

	@src/fifo.c

92 
	~<ddef.h
>

93 
	~<dbo.h
>

94 
	~<dt.h
>

95 
	~"fifo.h
"

104 
	$FIFO_Cou
(

105 
FIFO_BUFFER
 cڡ *
b
)

107 
hd
, 

;

109 i(
b
) {

110 
hd
 = 
b
->head;

111 

 = 
b
->tail;

112  
hd
 - 

;

116 
	}
}

125 
bo
 
	$FIFO_Fu
(

126 
FIFO_BUFFER
 cڡ *
b
)

128  (
b
 ? (
	`FIFO_Cou
(b=b->
bufr_n
: 
ue
);

129 
	}
}

139 
bo
 
	$FIFO_Avaab
(

140 
FIFO_BUFFER
 cڡ *
b
,

141 
cou
)

143  (
b
 ? (
cou
 <(b->
bufr_n
 - 
	`FIFO_Cou
(b)): 
l
);

144 
	}
}

152 
bo
 
	$FIFO_Emy
(

153 
FIFO_BUFFER
 cڡ *
b
)

155  (
b
 ? (
	`FIFO_Cou
(b=0: 
ue
);

156 
	}
}

168 
ut8_t
 
	$FIFO_Pk
(

169 
FIFO_BUFFER
 cڡ *
b
)

171 
dex
;

173 i(
b
) {

174 
dex
 = 
b
->

 % b->
bufr_n
;

175  (
b
->
bufr
[
dex
]);

179 
	}
}

191 
ut8_t
 
	$FIFO_G
(

192 
FIFO_BUFFER
 * 
b
)

194 
ut8_t
 
da_by
 = 0;

195 
dex
;

197 i(!
	`FIFO_Emy
(
b
)) {

198 
dex
 = 
b
->

 % b->
bufr_n
;

199 
da_by
 = 
b
->
bufr
[
dex
];

200 
b
->

++;

202  
da_by
;

203 
	}
}

216 
	$FIFO_Pu
(

217 
FIFO_BUFFER
 * 
b
,

218 
ut8_t
 * 
bufr
,

219 
ngth
)

221 
cou
;

222 
ut8_t
 
da_by
;

223 
dex
;

225 
cou
 = 
	`FIFO_Cou
(
b
);

226 i(
cou
 > 
ngth
) {

228 
cou
 = 
ngth
;

230 i(
ngth
 > 
cou
) {

232 
ngth
 = 
cou
;

234 
cou
) {

235 
dex
 = 
b
->

 % b->
bufr_n
;

236 
da_by
 = 
b
->
bufr
[
dex
];

237 
b
->

++;

238 i(
bufr
) {

239 *
bufr
 = 
da_by
;

240 
bufr
++;

242 
cou
--;

245  
ngth
;

246 
	}
}

256 
bo
 
	$FIFO_Put
(

257 
FIFO_BUFFER
 * 
b
,

258 
ut8_t
 
da_by
)

260 
bo
 
us
 = 
l
;

261 
dex
;

263 i(
b
) {

265 i(!
	`FIFO_Fu
(
b
)) {

266 
dex
 = 
b
->
hd
 % b->
bufr_n
;

267 
b
->
bufr
[
dex
] = 
da_by
;

268 
b
->
hd
++;

269 
us
 = 
ue
;

273  
us
;

274 
	}
}

285 
bo
 
	$FIFO_Add
(

286 
FIFO_BUFFER
 * 
b
,

287 
ut8_t
 * 
bufr
,

288 
cou
)

290 
bo
 
us
 = 
l
;

291 
dex
;

294 i(
	`FIFO_Avaab
(
b
, 
cou
&& 
bufr
) {

295 
cou
) {

296 
dex
 = 
b
->
hd
 % b->
bufr_n
;

297 
b
->
bufr
[
dex
] = *buffer;

298 
b
->
hd
++;

299 
bufr
++;

300 
cou
--;

302 
us
 = 
ue
;

305  
us
;

306 
	}
}

315 
	$FIFO_Flush
(

316 
FIFO_BUFFER
 * 
b
)

318 
hd
;

320 i(
b
) {

321 
hd
 = 
b
->head;

322 
b
->

 = 
hd
;

324 
	}
}

335 
	$FIFO_In
(

336 
FIFO_BUFFER
 * 
b
,

337 vީ
ut8_t
 * 
bufr
,

338 
bufr_n
)

340 i(
b
 && 
bufr
 && 
bufr_n
) {

341 
b
->
hd
 = 0;

342 
b
->

 = 0;

343 
b
->
bufr
 = buffer;

344 
b
->
bufr_n
 = buffer_len;

348 
	}
}

350 #ifde
TEST


351 
	~<as.h
>

352 
	~<rg.h
>

353 
	~<dio.h
>

354 
	~"e.h
"

361 
	$FIFOBufr
(

362 
Te
 * 
pTe
)

365 
FIFO_BUFFER
 
_bufr
 = { 0 };

367 vީ
ut8_t
 
da_e
[64] = { 0 };

368 
ut8_t
 
add_da
[40] = { "RoseSteveLouPatRachelJessicaDaniAmyHerb" };

369 
ut8_t
 
_add_da
[40] = { 0 };

370 
ut8_t
 
_da
 = 0;

371 
dex
 = 0;

372 
cou
 = 0;

373 
bo
 
us
 = 0;

375 
	`FIFO_In
(&
_bufr
, 
da_e
, (data_store));

376 
	`_
(
pTe
, 
	`FIFO_Emy
(&
_bufr
));

379 
_da
 = 0;e_d< (
da_e
);est_data++) {

380 
	`_
(
pTe
, !
	`FIFO_Fu
(&
_bufr
));

381 
	`_
(
pTe
, 
	`FIFO_Avaab
(&
_bufr
, 1));

382 
us
 = 
	`FIFO_Put
(&
_bufr
, 
_da
);

383 
	`_
(
pTe
, 
us
 =
ue
);

384 
	`_
(
pTe
, !
	`FIFO_Emy
(&
_bufr
));

387 
	`_
(
pTe
, 
	`FIFO_Fu
(&
_bufr
));

388 
	`_
(
pTe
, !
	`FIFO_Avaab
(&
_bufr
, 1));

389 
us
 = 
	`FIFO_Put
(&
_bufr
, 42);

390 
	`_
(
pTe
, 
us
 =
l
);

392 
dex
 = 0; index < (
da_e
); index++) {

393 
	`_
(
pTe
, !
	`FIFO_Emy
(&
_bufr
));

394 
_da
 = 
	`FIFO_Pk
(&
_bufr
);

395 
	`_
(
pTe
, 
_da
 =
dex
);

396 
_da
 = 
	`FIFO_G
(&
_bufr
);

397 
	`_
(
pTe
, 
_da
 =
dex
);

398 
	`_
(
pTe
, 
	`FIFO_Avaab
(&
_bufr
, 1));

399 
	`_
(
pTe
, !
	`FIFO_Fu
(&
_bufr
));

401 
	`_
(
pTe
, 
	`FIFO_Emy
(&
_bufr
));

402 
_da
 = 
	`FIFO_G
(&
_bufr
);

403 
	`_
(
pTe
, 
_da
 == 0);

404 
_da
 = 
	`FIFO_Pk
(&
_bufr
);

405 
	`_
(
pTe
, 
_da
 == 0);

406 
	`_
(
pTe
, 
	`FIFO_Emy
(&
_bufr
));

408 
dex
 = 0; index < (
da_e
); index++) {

409 
	`_
(
pTe
, 
	`FIFO_Emy
(&
_bufr
));

410 
	`_
(
pTe
, 
	`FIFO_Avaab
(&
_bufr
, 4));

411 
cou
 = 1; count < 4; count++) {

412 
_da
 = 
cou
;

413 
us
 = 
	`FIFO_Put
(&
_bufr
, 
_da
);

414 
	`_
(
pTe
, 
us
 =
ue
);

415 
	`_
(
pTe
, !
	`FIFO_Emy
(&
_bufr
));

417 
cou
 = 1; count < 4; count++) {

418 
	`_
(
pTe
, !
	`FIFO_Emy
(&
_bufr
));

419 
_da
 = 
	`FIFO_Pk
(&
_bufr
);

420 
	`_
(
pTe
, 
_da
 =
cou
);

421 
_da
 = 
	`FIFO_G
(&
_bufr
);

422 
	`_
(
pTe
, 
_da
 =
cou
);

425 
	`_
(
pTe
, 
	`FIFO_Emy
(&
_bufr
));

427 
	`_
(
pTe
, 
	`FIFO_Avaab
(&
_bufr
, (
add_da
)));

428 
us
 = 
	`FIFO_Add
(&
_bufr
, 
add_da
, (add_data));

429 
	`_
(
pTe
, 
us
 =
ue
);

430 
cou
 = 
	`FIFO_Cou
(&
_bufr
);

431 
	`_
(
pTe
, 
cou
 =(
add_da
));

432 
	`_
(
pTe
, !
	`FIFO_Emy
(&
_bufr
));

433 
dex
 = 0; index < (
add_da
); index++) {

435 
	`_
(
pTe
, !
	`FIFO_Emy
(&
_bufr
));

436 
_da
 = 
	`FIFO_Pk
(&
_bufr
);

437 
	`_
(
pTe
, 
_da
 =
add_da
[
dex
]);

438 
_da
 = 
	`FIFO_G
(&
_bufr
);

439 
	`_
(
pTe
, 
_da
 =
add_da
[
dex
]);

441 
	`_
(
pTe
, 
	`FIFO_Emy
(&
_bufr
));

443 
	`_
(
pTe
, 
	`FIFO_Avaab
(&
_bufr
, (
add_da
)));

444 
us
 = 
	`FIFO_Add
(&
_bufr
, 
add_da
, (add_data));

445 
	`_
(
pTe
, 
us
 =
ue
);

446 
cou
 = 
	`FIFO_Cou
(&
_bufr
);

447 
	`_
(
pTe
, 
cou
 =(
add_da
));

448 
	`_
(
pTe
, !
	`FIFO_Emy
(&
_bufr
));

449 
cou
 = 
	`FIFO_Pu
(&
_bufr
, &
_add_da
[0], (test_add_data));

450 
	`_
(
pTe
, 
	`FIFO_Emy
(&
_bufr
));

451 
	`_
(
pTe
, 
cou
 =(
_add_da
));

452 
dex
 = 0; index < (
add_da
); index++) {

453 
	`_
(
pTe
, 
_add_da
[
dex
] =
add_da
[index]);

455 
	`_
(
pTe
, 
	`FIFO_Avaab
(&
_bufr
, (
add_da
)));

456 
us
 = 
	`FIFO_Add
(&
_bufr
, 
_add_da
, (
add_da
));

457 
	`_
(
pTe
, 
us
 =
ue
);

458 
	`_
(
pTe
, !
	`FIFO_Emy
(&
_bufr
));

459 
dex
 = 0; index < (
add_da
); index++) {

460 
cou
 = 
	`FIFO_Pu
(&
_bufr
, &
_add_da
[0], 1);

461 
	`_
(
pTe
, 
cou
 == 1);

462 
	`_
(
pTe
, 
_add_da
[0] =
add_da
[
dex
]);

464 
	`_
(
pTe
, 
	`FIFO_Emy
(&
_bufr
));

466 
us
 = 
	`FIFO_Add
(&
_bufr
, 
_add_da
, (test_add_data));

467 
	`_
(
pTe
, 
us
 =
ue
);

468 
	`_
(
pTe
, !
	`FIFO_Emy
(&
_bufr
));

469 
	`FIFO_Flush
(&
_bufr
);

470 
	`_
(
pTe
, 
	`FIFO_Emy
(&
_bufr
));

473 
	}
}

475 #ifde
TEST_FIFO_BUFFER


481 
	$ma
(

484 
Te
 *
pTe
;

485 
bo
 
rc
;

487 
pTe
 = 
	`_
("FIFO Bufr", 
NULL
);

490 
rc
 = 
	`_addTeFuni
(
pTe
, 
FIFOBufr
);

491 
	`as
(
rc
);

493 
	`_tSm
(
pTe
, 
dout
);

494 
	`_run
(
pTe
);

495 (
	`_pt
(
pTe
);

497 
	`_deroy
(
pTe
);

500 
	}
}

	@src/filename.c

34 
	~<dio.h
>

35 
	~<rg.h
>

36 
	~"fame.h
"

40 *
	$fame_move_th
(

41 cڡ *
fame_
)

43 *
fame_out
 = (*
fame_
;

46 i(
fame_
) {

47 
fame_out
 = 
	`chr
(
fame_
, '\\');

48 i(!
fame_out
) {

49 
fame_out
 = 
	`chr
(
fame_
, '/');

52 i(
fame_out
) {

53 
fame_out
++;

56 
fame_out
 = (*
fame_
;

60  
fame_out
;

61 
	}
}

63 #ifde
TEST


64 
	~<as.h
>

65 
	~<rg.h
>

67 
	~"e.h
"

69 
	$Fame
(

70 
Te
 * 
pTe
)

72 *
da1
 = "c:\\Joshua\\run";

73 *
da2
 = "/home/Anna/run";

74 *
da3
 = "c:\\Program Files\\Christopher\\run.exe";

75 *
da4
 = "//Mary/data/run";

76 *
da5
 = "bin\\run";

77 *
fame
 = 
NULL
;

79 
fame
 = 
	`fame_move_th
(
da1
);

80 
	`_
(
pTe
, 
	`rcmp
("run", 
fame
) == 0);

81 
fame
 = 
	`fame_move_th
(
da2
);

82 
	`_
(
pTe
, 
	`rcmp
("run", 
fame
) == 0);

83 
fame
 = 
	`fame_move_th
(
da3
);

84 
	`_
(
pTe
, 
	`rcmp
("run.exe", 
fame
) == 0);

85 
fame
 = 
	`fame_move_th
(
da4
);

86 
	`_
(
pTe
, 
	`rcmp
("run", 
fame
) == 0);

87 
fame
 = 
	`fame_move_th
(
da5
);

88 
	`_
(
pTe
, 
	`rcmp
("run", 
fame
) == 0);

91 
	}
}

93 #ifde
TEST_FILENAME


94 
	$ma
(

97 
Te
 *
pTe
;

98 
bo
 
rc
;

100 
pTe
 = 
	`_
("fammovth", 
NULL
);

103 
rc
 = 
	`_addTeFuni
(
pTe
, 
Fame
);

104 
	`as
(
rc
);

106 
	`_tSm
(
pTe
, 
dout
);

107 
	`_run
(
pTe
);

108 (
	`_pt
(
pTe
);

110 
	`_deroy
(
pTe
);

113 
	}
}

	@src/get_alarm_sum.c

39 
	~<as.h
>

41 
	~"bacdcode.h
"

42 
	~"g_m_sum.h
"

43 
	~"du.h
"

53 
	$g_m_summy_ack_code_du_
(

54 
ut8_t
 * 
du
,

55 
ut8_t
 
voke_id
)

57 
du_n
 = 0;

59 i(
du
) {

60 
du
[0] = 
PDU_TYPE_COMPLEX_ACK
;

61 
du
[1] = 
voke_id
;

62 
du
[2] = 
SERVICE_CONFIRMED_GET_ALARM_SUMMARY
;

63 
du_n
 = 3;

66  
du_n
;

67 
	}
}

77 
	$g_m_summy_ack_code_du_da
(

78 
ut8_t
 * 
du
,

79 
size_t
 
max_du
,

80 
BACNET_GET_ALARM_SUMMARY_DATA
 * 
g_m_da
)

82 
du_n
 = 0;

84 i(!
du
) {

85 
du_n
 = 
BACNET_STATUS_ERROR
;

86 } i(
max_du
 >= 10) {

88 
du_n
 +=

89 
	`code_iti_obje_id
(&
du
[
du_n
],

90 (
g_m_da
->
objeIdtifr
.
ty
,

91 
g_m_da
->
objeIdtifr
.

);

93 
du_n
 +=

94 
	`code_iti_umed
(&
du
[
du_n
],

95 
g_m_da
->
mS
);

97 
du_n
 +=

98 
	`code_iti_brg
(&
du
[
du_n
],

99 &
g_m_da
->
acknowdgedTnsis
);

101 
du_n
 = 
BACNET_STATUS_ABORT
;

104  
du_n
;

105 
	}
}

115 
	$g_m_summy_ack_decode_du_da
(

116 
ut8_t
 * 
du
,

117 
size_t
 
max_du
,

118 
BACNET_GET_ALARM_SUMMARY_DATA
 * 
g_m_da
)

120 
du_n
 = 0;

121 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

123 i(!
du
) {

124 
du_n
 = 
BACNET_STATUS_ERROR
;

125 } i(
max_du
 >= 10) {

127 
du_n
 +=

128 
	`ba_decode_iti_da
(&
du
[
du_n
],

129 ()(
max_du
 - 
du_n
), &
vue
);

130 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_OBJECT_ID
) {

131 
g_m_da
->
objeIdtifr
 = 
vue
.
ty
.
Obje_Id
;

133  
BACNET_STATUS_ERROR
;

136 
du_n
 +=

137 
	`ba_decode_iti_da
(&
du
[
du_n
],

138 ()(
max_du
 - 
du_n
), &
vue
);

139 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_ENUMERATED
) {

140 
g_m_da
->
mS
 =

141 (
BACNET_EVENT_STATE

vue
.
ty
.
Enumed
;

143  
BACNET_STATUS_ERROR
;

146 
du_n
 +=

147 
	`ba_decode_iti_da
(&
du
[
du_n
],

148 ()(
max_du
 - 
du_n
), &
vue
);

149 i(
vue
.
g
 =
BACNET_APPLICATION_TAG_BIT_STRING
) {

150 
g_m_da
->
acknowdgedTnsis
 = 
vue
.
ty
.
B_Sg
;

152  
BACNET_STATUS_ERROR
;

156  
du_n
;

157 
	}
}

	@src/getevent.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"gevt.h
"

43 
	$gevt_code_du
(

44 
ut8_t
 * 
du
,

45 
ut8_t
 
voke_id
,

46 
BACNET_OBJECT_ID
 * 
ϡReivedObjeIdtifr
)

48 
n
 = 0;

49 
du_n
 = 0;

51 i(
du
) {

52 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

53 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

54 
du
[2] = 
voke_id
;

55 
du
[3] = 
SERVICE_CONFIRMED_GET_EVENT_INFORMATION
;

56 
du_n
 = 4;

58 i(
ϡReivedObjeIdtifr
) {

59 
n
 =

60 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0,

61 (
ϡReivedObjeIdtifr
->
ty
,

62 
ϡReivedObjeIdtifr
->

);

63 
du_n
 +
n
;

67  
du_n
;

68 
	}
}

71 
	$gevt_decode_rvi_que
(

72 
ut8_t
 * 
du
,

73 
du_n
,

74 
BACNET_OBJECT_ID
 * 
ϡReivedObjeIdtifr
)

76 
n
 = 0;

79 i(
du_n
 && 
ϡReivedObjeIdtifr
) {

81 i(!
	`decode_is_cڋxt_g
(&
du
[
n
++], 0))

83 
n
 +=

84 
	`decode_obje_id
(&
du
[
n
], &
ϡReivedObjeIdtifr
->
ty
,

85 &
ϡReivedObjeIdtifr
->

);

88  (
n
;

89 
	}
}

91 
	$gevt_ack_code_du_
(

92 
ut8_t
 * 
du
,

93 
size_t
 
max_du
,

94 
ut8_t
 
voke_id
)

96 
du_n
 = 0;

98 i(
du
 && (
max_du
 >= 4)) {

99 
du
[0] = 
PDU_TYPE_COMPLEX_ACK
;

100 
du
[1] = 
voke_id
;

101 
du
[2] = 
SERVICE_CONFIRMED_GET_EVENT_INFORMATION
;

102 
du_n
 = 3;

105 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 0);

108  
du_n
;

109 
	}
}

111 
	$gevt_ack_code_du_da
(

112 
ut8_t
 * 
du
,

113 
size_t
 
max_du
,

114 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
g_evt_da
)

116 
du_n
 = 0;

117 
BACNET_GET_EVENT_INFORMATION_DATA
 *
evt_da
;

118 
i
 = 0;

121 
max_du
 = max_apdu;

122 i(
du
) {

123 
evt_da
 = 
g_evt_da
;

124 
evt_da
) {

126 
du_n
 +=

127 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0,

128 (
evt_da
->
objeIdtifr
.
ty
,

129 
evt_da
->
objeIdtifr
.

);

131 
du_n
 +=

132 
	`code_cڋxt_umed
(&
du
[
du_n
], 1,

133 
evt_da
->
evtS
);

135 
du_n
 +=

136 
	`code_cڋxt_brg
(&
du
[
du_n
], 2,

137 &
evt_da
->
acknowdgedTnsis
);

139 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 3);

140 
i
 = 0; i < 3; i++) {

141 
du_n
 +=

142 
	`ba_code_timeamp
(&
du
[
du_n
],

143 &
evt_da
->
evtTimeSmps
[
i
]);

145 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 3);

147 
du_n
 +=

148 
	`code_cڋxt_umed
(&
du
[
du_n
], 4,

149 
evt_da
->
nifyTy
);

151 
du_n
 +=

152 
	`code_cڋxt_brg
(&
du
[
du_n
], 5,

153 &
evt_da
->
evtEb
);

155 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 6);

156 
i
 = 0; i < 3; i++) {

157 
du_n
 +=

158 
	`code_iti_unsigd
(&
du
[
du_n
],

159 
evt_da
->
evtPriܙs
[
i
]);

161 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 6);

162 
evt_da
 =vt_da->
xt
;

166  
du_n
;

167 
	}
}

169 
	$gevt_ack_code_du_d
(

170 
ut8_t
 * 
du
,

171 
size_t
 
max_du
,

172 
bo
 
meEvts
)

174 
du_n
 = 0;

177 
max_du
 = max_apdu;

178 i(
du
) {

179 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 0);

180 
du_n
 +
	`code_cڋxt_boޗn
(&
du
[du_n], 1, 
meEvts
);

183  
du_n
;

184 
	}
}

186 
	$gevt_ack_decode_rvi_que
(

187 
ut8_t
 * 
du
,

188 
du_n
,

189 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
g_evt_da
,

190 
bo
 * 
meEvts
)

192 
ut8_t
 
g_numb
 = 0;

193 
ut32_t
 
n_vue
 = 0;

194 
n
 = 0;

195 
ut32_t
 
um_vue
 = 0;

196 
BACNET_GET_EVENT_INFORMATION_DATA
 *
evt_da
;

197 
i
 = 0;

200 
evt_da
 = 
g_evt_da
;

201 i(
du
 && 
du_n
 && 
evt_da
 && 
meEvts
) {

202 i(!
	`decode_is_ݒg_g_numb
(&
du
[
n
], 0)) {

205 
n
++;

206 
evt_da
) {

208 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 0)) {

209 
n
 +=

210 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

211 &
n_vue
);

212 
n
 +=

213 
	`decode_obje_id
(&
du
[
n
],

214 &
evt_da
->
objeIdtifr
.
ty
,

215 &
evt_da
->
objeIdtifr
.

);

220 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 1)) {

221 
n
 +=

222 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

223 &
n_vue
);

224 
n
 +
	`decode_umed
(&
du
[n], 
n_vue
, &
um_vue
);

225 
evt_da
->
evtS
 = 
um_vue
;

230 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 2)) {

231 
n
 +=

232 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

233 &
n_vue
);

234 
n
 +=

235 
	`decode_brg
(&
du
[
n
], 
n_vue
,

236 &
evt_da
->
acknowdgedTnsis
);

241 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 3)) {

242 
n
 +=

243 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

244 &
n_vue
);

245 
i
 = 0; i < 3; i++) {

246 
n
 +=

247 
	`ba_decode_timeamp
(&
du
[
n
],

248 &
evt_da
->
evtTimeSmps
[
i
]);

253 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 3)) {

254 
n
 +=

255 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

256 &
n_vue
);

261 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 4)) {

262 
n
 +=

263 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

264 &
n_vue
);

265 
n
 +
	`decode_umed
(&
du
[n], 
n_vue
, &
um_vue
);

266 
evt_da
->
nifyTy
 = 
um_vue
;

271 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 5)) {

272 
n
 +=

273 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

274 &
n_vue
);

275 
n
 +=

276 
	`decode_brg
(&
du
[
n
], 
n_vue
,

277 &
evt_da
->
evtEb
);

282 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 6)) {

283 
n
 +=

284 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

285 &
n_vue
);

286 
i
 = 0; i < 3; i++) {

287 
n
 +=

288 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

289 &
n_vue
);

290 
n
 +=

291 
	`decode_unsigd
(&
du
[
n
], 
n_vue
,

292 &
evt_da
->
evtPriܙs
[
i
]);

297 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 6)) {

298 
n
 +=

299 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

300 &
n_vue
);

304 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 0)) {

305 
n
 +=

306 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

307 &
n_vue
);

308 
evt_da
->
xt
 = 
NULL
;

310 
evt_da
 =vt_da->
xt
;

312 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 1)) {

313 
n
 +=

314 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

315 &
n_vue
);

316 i(
n_vue
 == 1)

317 *
meEvts
 = 
	`decode_cڋxt_boޗn
(&
du
[
n
++]);

319 *
meEvts
 = 
l
;

325  
n
;

326 
	}
}

328 #ifde
TEST


329 
	~<as.h
>

330 
	~<rg.h
>

331 
	~"e.h
"

333 
	$gevt_decode_du
(

334 
ut8_t
 * 
du
,

335 
du_n
,

336 
ut8_t
 * 
voke_id
,

337 
BACNET_OBJECT_ID
 * 
ϡReivedObjeIdtifr
)

339 
n
 = 0;

340 
offt
 = 0;

342 i(!
du
)

345 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

348 *
voke_id
 = 
du
[2];

349 i(
du
[3] !
SERVICE_CONFIRMED_GET_EVENT_INFORMATION
)

351 
offt
 = 4;

353 i(
du_n
 > 
offt
) {

354 
n
 =

355 
	`gevt_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

356 
ϡReivedObjeIdtifr
);

359  
n
;

360 
	}
}

362 
	$gevt_ack_decode_du
(

363 
ut8_t
 * 
du
,

364 
du_n
,

365 
ut8_t
 * 
voke_id
,

366 
BACNET_GET_EVENT_INFORMATION_DATA
 * 
g_evt_da
,

367 
bo
 * 
meEvts
)

369 
n
 = 0;

370 
offt
 = 0;

372 i(!
du
)

375 i(
du
[0] !
PDU_TYPE_COMPLEX_ACK
)

377 *
voke_id
 = 
du
[1];

378 i(
du
[2] !
SERVICE_CONFIRMED_GET_EVENT_INFORMATION
)

380 
offt
 = 3;

381 i(
du_n
 > 
offt
) {

382 
n
 =

383 
	`gevt_ack_decode_rvi_que
(&
du
[
offt
],

384 
du_n
 - 
offt
, 
g_evt_da
, 
meEvts
);

387  
n
;

388 
	}
}

390 
	$GEvtInfmiAck
(

391 
Te
 * 
pTe
)

393 
ut8_t
 
du
[480] = { 0 };

394 
n
 = 0;

395 
du_n
 = 0;

396 
ut8_t
 
voke_id
 = 1;

397 
ut8_t
 
_voke_id
 = 0;

398 
BACNET_GET_EVENT_INFORMATION_DATA
 
evt_da
;

399 
BACNET_GET_EVENT_INFORMATION_DATA
 
_evt_da
;

400 
bo
 
meEvts
 = 
l
;

401 
bo
 
_meEvts
 = 
l
;

402 
i
 = 0;

404 
evt_da
.
objeIdtifr
.
ty
 = 
OBJECT_BINARY_INPUT
;

405 
evt_da
.
objeIdtifr
.

 = 1;

406 
evt_da
.
evtS
 = 
EVENT_STATE_NORMAL
;

407 
	`brg_
(&
evt_da
.
acknowdgedTnsis
);

408 
	`brg_t_b
(&
evt_da
.
acknowdgedTnsis
,

409 
TRANSITION_TO_OFFNORMAL
, 
l
);

410 
	`brg_t_b
(&
evt_da
.
acknowdgedTnsis
, 
TRANSITION_TO_FAULT
,

411 
l
);

412 
	`brg_t_b
(&
evt_da
.
acknowdgedTnsis
,

413 
TRANSITION_TO_NORMAL
, 
l
);

414 
i
 = 0; i < 3; i++) {

415 
evt_da
.
evtTimeSmps
[
i
].
g
 = 
TIME_STAMP_SEQUENCE
;

416 
evt_da
.
evtTimeSmps
[
i
].
vue
.
quNum
 = 0;

418 
evt_da
.
nifyTy
 = 
NOTIFY_ALARM
;

419 
	`brg_
(&
evt_da
.
evtEb
);

420 
	`brg_t_b
(&
evt_da
.
evtEb
, 
TRANSITION_TO_OFFNORMAL
, 
ue
);

421 
	`brg_t_b
(&
evt_da
.
evtEb
, 
TRANSITION_TO_FAULT
, 
ue
);

422 
	`brg_t_b
(&
evt_da
.
evtEb
, 
TRANSITION_TO_NORMAL
, 
ue
);

423 
i
 = 0; i < 3; i++) {

424 
evt_da
.
evtPriܙs
[
i
] = 1;

426 
evt_da
.
xt
 = 
NULL
;

428 
n
 = 
	`gevt_ack_code_du_
(&
du
[0], pdu), 
voke_id
);

429 
	`_
(
pTe
, 
n
 != 0);

430 
	`_
(
pTe
, 
n
 != -1);

431 
du_n
 = 
n
;

432 
n
 =

433 
	`gevt_ack_code_du_da
(&
du
[
du_n
], (apdu) -pdu_len,

434 &
evt_da
);

435 
	`_
(
pTe
, 
n
 != 0);

436 
	`_
(
pTe
, 
n
 != -1);

437 
du_n
 +
n
;

438 
n
 =

439 
	`gevt_ack_code_du_d
(&
du
[
du_n
], (apdu) -pdu_len,

440 
meEvts
);

441 
	`_
(
pTe
, 
n
 != 0);

442 
	`_
(
pTe
, 
n
 != -1);

443 
du_n
 +
n
;

444 
n
 = 
	`gevt_ack_decode_du
(&
du
[0], 
du_n
,

445 &
_voke_id
, &
_evt_da
, &
_meEvts
);

446 
	`_
(
pTe
, 
n
 != -1);

447 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

449 
	`_
(
pTe
,

450 
evt_da
.
objeIdtifr
.
ty
 ==

451 
_evt_da
.
objeIdtifr
.
ty
);

452 
	`_
(
pTe
,

453 
evt_da
.
objeIdtifr
.

 ==

454 
_evt_da
.
objeIdtifr
.

);

456 
	`_
(
pTe
, 
evt_da
.
evtS
 =
_evt_da
.eventState);

457 
	}
}

459 
	$GEvtInfmi
(

460 
Te
 * 
pTe
)

462 
ut8_t
 
du
[480] = { 0 };

463 
n
 = 0;

464 
du_n
 = 0;

465 
ut8_t
 
voke_id
 = 128;

466 
ut8_t
 
_voke_id
 = 0;

467 
BACNET_OBJECT_ID
 
ϡReivedObjeIdtifr
;

468 
BACNET_OBJECT_ID
 
_ϡReivedObjeIdtifr
;

470 
ϡReivedObjeIdtifr
.
ty
 = 
OBJECT_BINARY_INPUT
;

471 
ϡReivedObjeIdtifr
.

 = 12345;

472 
n
 =

473 
	`gevt_code_du
(&
du
[0], 
voke_id
,

474 &
ϡReivedObjeIdtifr
);

475 
	`_
(
pTe
, 
n
 != 0);

476 
du_n
 = 
n
;

478 
n
 =

479 
	`gevt_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

480 &
_ϡReivedObjeIdtifr
);

481 
	`_
(
pTe
, 
n
 != -1);

482 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

483 
	`_
(
pTe
,

484 
_ϡReivedObjeIdtifr
.
ty
 ==

485 
ϡReivedObjeIdtifr
.
ty
);

486 
	`_
(
pTe
,

487 
_ϡReivedObjeIdtifr
.

 ==

488 
ϡReivedObjeIdtifr
.

);

491 
	}
}

493 #ifde
TEST_GET_EVENT_INFORMATION


494 
	$ma
(

497 
Te
 *
pTe
;

498 
bo
 
rc
;

500 
pTe
 = 
	`_
("BACÈGEvtInfmi", 
NULL
);

502 
rc
 = 
	`_addTeFuni
(
pTe
, 
GEvtInfmi
);

503 
	`as
(
rc
);

504 
rc
 = 
	`_addTeFuni
(
pTe
, 
GEvtInfmiAck
);

505 
	`as
(
rc
);

507 
	`_tSm
(
pTe
, 
dout
);

508 
	`_run
(
pTe
);

509 (
	`_pt
(
pTe
);

510 
	`_deroy
(
pTe
);

513 
	}
}

	@src/iam.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdef.h
"

37 
	~"du.h
"

38 
	~"dcc.h
"

39 
	~"bacdcode.h
"

40 
	~"addss.h
"

41 
	~"m.h
"

46 
	$m_code_du
(

47 
ut8_t
 * 
du
,

48 
ut32_t
 
devi_id
,

49 
max_du
,

50 
gmti
,

51 
ut16_t
 
vd_id
)

53 
n
 = 0;

54 
du_n
 = 0;

56 i(
du
) {

57 
du
[0] = 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
;

58 
du
[1] = 
SERVICE_UNCONFIRMED_I_AM
;

59 
du_n
 = 2;

60 
n
 =

61 
	`code_iti_obje_id
(&
du
[
du_n
], 
OBJECT_DEVICE
,

62 
devi_id
);

63 
du_n
 +
n
;

64 
n
 = 
	`code_iti_unsigd
(&
du
[
du_n
], 
max_du
);

65 
du_n
 +
n
;

66 
n
 =

67 
	`code_iti_umed
(&
du
[
du_n
],

68 (
ut32_t

gmti
);

69 
du_n
 +
n
;

70 
n
 = 
	`code_iti_unsigd
(&
du
[
du_n
], 
vd_id
);

71 
du_n
 +
n
;

74  
du_n
;

75 
	}
}

77 
	$m_decode_rvi_que
(

78 
ut8_t
 * 
du
,

79 
ut32_t
 * 
pDevi_id
,

80 *
pMax_du
,

81 *
pSegmti
,

82 
ut16_t
 * 
pVd_id
)

84 
n
 = 0;

85 
du_n
 = 0;

86 
ut16_t
 
obje_ty
 = 0;

87 
ut32_t
 
obje_
 = 0;

88 
ut8_t
 
g_numb
 = 0;

89 
ut32_t
 
n_vue
 = 0;

90 
ut32_t
 
decoded_vue
 = 0;

93 
n
 =

94 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
, &
n_vue
);

95 
du_n
 +
n
;

96 i(
g_numb
 !
BACNET_APPLICATION_TAG_OBJECT_ID
)

98 
n
 = 
	`decode_obje_id
(&
du
[
du_n
], &
obje_ty
, &
obje_
);

99 
du_n
 +
n
;

100 i(
obje_ty
 !
OBJECT_DEVICE
)

102 i(
pDevi_id
)

103 *
pDevi_id
 = 
obje_
;

105 
n
 =

106 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
, &
n_vue
);

107 
du_n
 +
n
;

108 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
)

110 
n
 = 
	`decode_unsigd
(&
du
[
du_n
], 
n_vue
, &
decoded_vue
);

111 
du_n
 +
n
;

112 i(
pMax_du
)

113 *
pMax_du
 = (
decoded_vue
;

115 
n
 =

116 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
, &
n_vue
);

117 
du_n
 +
n
;

118 i(
g_numb
 !
BACNET_APPLICATION_TAG_ENUMERATED
)

120 
n
 = 
	`decode_umed
(&
du
[
du_n
], 
n_vue
, &
decoded_vue
);

121 
du_n
 +
n
;

122 i(
decoded_vue
 >
MAX_BACNET_SEGMENTATION
)

124 i(
pSegmti
)

125 *
pSegmti
 = (
decoded_vue
;

127 
n
 =

128 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
, &
n_vue
);

129 
du_n
 +
n
;

130 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
)

132 
n
 = 
	`decode_unsigd
(&
du
[
du_n
], 
n_vue
, &
decoded_vue
);

133 
du_n
 +
n
;

134 i(
decoded_vue
 > 0xFFFF)

136 i(
pVd_id
)

137 *
pVd_id
 = (
ut16_t

decoded_vue
;

139  
du_n
;

140 
	}
}

142 #ifde
TEST


143 
	~<as.h
>

144 
	~<rg.h
>

145 
	~"e.h
"

147 
	$m_decode_du
(

148 
ut8_t
 * 
du
,

149 
ut32_t
 * 
pDevi_id
,

150 *
pMax_du
,

151 *
pSegmti
,

152 
ut16_t
 * 
pVd_id
)

154 
du_n
 = 0;

157 i(!
du
)

160 i(
du
[0] !
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
)

162 i(
du
[1] !
SERVICE_UNCONFIRMED_I_AM
)

164 
du_n
 =

165 
	`m_decode_rvi_que
(&
du
[2], 
pDevi_id
, 
pMax_du
,

166 
pSegmti
, 
pVd_id
);

168  
du_n
;

169 
	}
}

171 
	$IAm
(

172 
Te
 * 
pTe
)

174 
ut8_t
 
du
[480] = { 0 };

175 
n
 = 0;

176 
ut32_t
 
devi_id
 = 42;

177 
max_du
 = 480;

178 
gmti
 = 
SEGMENTATION_NONE
;

179 
ut16_t
 
vd_id
 = 42;

180 
ut32_t
 
_devi_id
 = 0;

181 
_max_du
 = 0;

182 
_gmti
 = 0;

183 
ut16_t
 
_vd_id
 = 0;

185 
n
 =

186 
	`m_code_du
(&
du
[0], 
devi_id
, 
max_du
, 
gmti
,

187 
vd_id
);

188 
	`_
(
pTe
, 
n
 != 0);

190 
n
 =

191 
	`m_decode_du
(&
du
[0], &
_devi_id
, &
_max_du
,

192 &
_gmti
, &
_vd_id
);

194 
	`_
(
pTe
, 
n
 != -1);

195 
	`_
(
pTe
, 
_devi_id
 =
devi_id
);

196 
	`_
(
pTe
, 
_vd_id
 =
vd_id
);

197 
	`_
(
pTe
, 
_max_du
 =
max_du
);

198 
	`_
(
pTe
, 
_gmti
 =
gmti
);

199 
	}
}

201 #ifde
TEST_IAM


202 
	$ma
(

205 
Te
 *
pTe
;

206 
bo
 
rc
;

208 
pTe
 = 
	`_
("BACÈI-Am", 
NULL
);

210 
rc
 = 
	`_addTeFuni
(
pTe
, 
IAm
);

211 
	`as
(
rc
);

213 
	`_tSm
(
pTe
, 
dout
);

214 
	`_run
(
pTe
);

215 (
	`_pt
(
pTe
);

216 
	`_deroy
(
pTe
);

219 
	}
}

	@src/ihave.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"ihave.h
"

42 
	$ihave_code_du
(

43 
ut8_t
 * 
du
,

44 
BACNET_I_HAVE_DATA
 * 
da
)

46 
n
 = 0;

47 
du_n
 = 0;

49 i(
du
 && 
da
) {

50 
du
[0] = 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
;

51 
du
[1] = 
SERVICE_UNCONFIRMED_I_HAVE
;

52 
du_n
 = 2;

54 
n
 =

55 
	`code_iti_obje_id
(&
du
[
du_n
],

56 (
da
->
devi_id
.
ty
, da->devi_id.

);

57 
du_n
 +
n
;

59 
n
 =

60 
	`code_iti_obje_id
(&
du
[
du_n
],

61 (
da
->
obje_id
.
ty
, da->obje_id.

);

62 
du_n
 +
n
;

64 
n
 =

65 
	`code_iti_cha_rg
(&
du
[
du_n
],

66 &
da
->
obje_me
);

67 
du_n
 +
n
;

70  
du_n
;

71 
	}
}

73 #i
BACNET_SVC_I_HAVE_A


76 
	$ihave_decode_rvi_que
(

77 
ut8_t
 * 
du
,

78 
du_n
,

79 
BACNET_I_HAVE_DATA
 * 
da
)

81 
n
 = 0;

82 
ut8_t
 
g_numb
 = 0;

83 
ut32_t
 
n_vue
 = 0;

84 
ut16_t
 
decoded_ty
 = 0;

86 i(
du_n
 && 
da
) {

88 
n
 +=

89 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

90 i(
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
) {

91 
n
 +=

92 
	`decode_obje_id
(&
du
[
n
], &
decoded_ty
,

93 &
da
->
devi_id
.

);

94 
da
->
devi_id
.
ty
 = 
decoded_ty
;

98 
n
 +=

99 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

100 i(
g_numb
 =
BACNET_APPLICATION_TAG_OBJECT_ID
) {

101 
n
 +=

102 
	`decode_obje_id
(&
du
[
n
], &
decoded_ty
,

103 &
da
->
obje_id
.

);

104 
da
->
obje_id
.
ty
 = 
decoded_ty
;

108 
n
 +=

109 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

110 i(
g_numb
 =
BACNET_APPLICATION_TAG_CHARACTER_STRING
) {

111 
n
 +=

112 
	`decode_cha_rg
(&
du
[
n
], 
n_vue
,

113 &
da
->
obje_me
);

119  
n
;

120 
	}
}

122 
	$ihave_decode_du
(

123 
ut8_t
 * 
du
,

124 
du_n
,

125 
BACNET_I_HAVE_DATA
 * 
da
)

127 
n
 = 0;

129 i(!
du
)

132 i(
du
[0] !
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
)

134 i(
du
[1] !
SERVICE_UNCONFIRMED_I_HAVE
)

136 
n
 = 
	`ihave_decode_rvi_que
(&
du
[2], 
du_n
 - 2, 
da
);

138  
n
;

139 
	}
}

142 #ifde
TEST


143 
	~<as.h
>

144 
	~<rg.h
>

145 
	~"e.h
"

147 
	$IHaveDa
(

148 
Te
 * 
pTe
,

149 
BACNET_I_HAVE_DATA
 * 
da
)

151 
ut8_t
 
du
[480] = { 0 };

152 
n
 = 0;

153 
du_n
 = 0;

154 
BACNET_I_HAVE_DATA
 
_da
;

156 
n
 = 
	`ihave_code_du
(&
du
[0], 
da
);

157 
	`_
(
pTe
, 
n
 != 0);

158 
du_n
 = 
n
;

160 
n
 = 
	`ihave_decode_du
(&
du
[0], 
du_n
, &
_da
);

161 
	`_
(
pTe
, 
n
 != -1);

162 
	`_
(
pTe
, 
_da
.
devi_id
.
ty
 =
da
->device_id.type);

163 
	`_
(
pTe
, 
_da
.
devi_id
.

 =
da
->device_id.instance);

164 
	`_
(
pTe
, 
_da
.
obje_id
.
ty
 =
da
->object_id.type);

165 
	`_
(
pTe
, 
_da
.
obje_id
.

 =
da
->object_id.instance);

166 
	`_
(
pTe
, 
	`charg_me
(&
_da
.
obje_me
,

167 &
da
->
obje_me
));

168 
	}
}

170 
	$IHave
(

171 
Te
 * 
pTe
)

173 
BACNET_I_HAVE_DATA
 
da
;

175 
	`charg__si
(&
da
.
obje_me
, "Patricia - myove!");

176 
da
.
devi_id
.
ty
 = 
OBJECT_DEVICE
;

177 
da
.
devi_id
.

 = 1;

178 
da
.
devi_id
.

 <
BACNET_MAX_INSTANCE
;

179 
da
.
devi_id
.

 <<= 1) {

180 
da
.
obje_id
.
ty
 = 
OBJECT_ANALOG_INPUT
;

181 
da
.
obje_id
.
ty
 < 
MAX_BACNET_OBJECT_TYPE
;

182 
da
.
obje_id
.
ty
++) {

183 
da
.
obje_id
.

 = 1;

184 
da
.
obje_id
.

 <
BACNET_MAX_INSTANCE
;

185 
da
.
obje_id
.

 <<= 1) {

186 
	`IHaveDa
(
pTe
, &
da
);

190 
	}
}

192 #ifde
TEST_I_HAVE


193 
	$ma
(

196 
Te
 *
pTe
;

197 
bo
 
rc
;

199 
pTe
 = 
	`_
("BACÈI-Have", 
NULL
);

201 
rc
 = 
	`_addTeFuni
(
pTe
, 
IHave
);

202 
	`as
(
rc
);

204 
	`_tSm
(
pTe
, 
dout
);

205 
	`_run
(
pTe
);

206 (
	`_pt
(
pTe
);

207 
	`_deroy
(
pTe
);

210 
	}
}

	@src/indtext.c

34 
	~<dbo.h
>

35 
	~<rg.h
>

36 
	~"dxt.h
"

40 #i!
defed
(
__BORLANDC__
&& !defed(
_MSC_VER
)

41 
	~<y.h
>

42 
	$ricmp
(

43 cڡ *
s1
,

44 cڡ *
s2
)

46 
c1
, 
c2
;

49 
c1
 = (*
s1
;

50 
c2
 = (*
s2
;

51 
c1
 = (
	`tow
(c1);

52 
c2
 = (
	`tow
(c2);

53 
s1
++;

54 
s2
++;

55 } (
c1
 =
c2
) && (c1 != '\0'));

57  (
c1
 - 
c2
;

58 
	}
}

61 
bo
 
	$dxt_by_rg
(

62 
INDTEXT_DATA
 * 
da_li
,

63 cڡ *
ch_me
,

64 *
found_dex
)

66 
bo
 
found
 = 
l
;

67 
dex
 = 0;

69 i(
da_li
 && 
ch_me
) {

70 
da_li
->
pSg
) {

71 i(
	`rcmp
(
da_li
->
pSg
, 
ch_me
) == 0) {

72 
dex
 = 
da_li
->index;

73 
found
 = 
ue
;

76 
da_li
++;

80 i(
found
 && 
found_dex
)

81 *
found_dex
 = 
dex
;

83  
found
;

84 
	}
}

87 
bo
 
	$dxt_by_irg
(

88 
INDTEXT_DATA
 * 
da_li
,

89 cڡ *
ch_me
,

90 *
found_dex
)

92 
bo
 
found
 = 
l
;

93 
dex
 = 0;

95 i(
da_li
 && 
ch_me
) {

96 
da_li
->
pSg
) {

97 i(
	`ricmp
(
da_li
->
pSg
, 
ch_me
) == 0) {

98 
dex
 = 
da_li
->index;

99 
found
 = 
ue
;

102 
da_li
++;

106 i(
found
 && 
found_dex
)

107 *
found_dex
 = 
dex
;

109  
found
;

110 
	}
}

112 
	$dxt_by_rg_deu
(

113 
INDTEXT_DATA
 * 
da_li
,

114 cڡ *
ch_me
,

115 
deu_dex
)

117 
dex
 = 0;

119 i(!
	`dxt_by_rg
(
da_li
, 
ch_me
, &
dex
))

120 
dex
 = 
deu_dex
;

122  
dex
;

123 
	}
}

125 
	$dxt_by_irg_deu
(

126 
INDTEXT_DATA
 * 
da_li
,

127 cڡ *
ch_me
,

128 
deu_dex
)

130 
dex
 = 0;

132 i(!
	`dxt_by_irg
(
da_li
, 
ch_me
, &
dex
))

133 
dex
 = 
deu_dex
;

135  
dex
;

136 
	}
}

138 cڡ *
	$dxt_by_dex_deu
(

139 
INDTEXT_DATA
 * 
da_li
,

140 
dex
,

141 cڡ *
deu_rg
)

143 cڡ *
pSg
 = 
NULL
;

145 i(
da_li
) {

146 
da_li
->
pSg
) {

147 i(
da_li
->
dex
 == index) {

148 
pSg
 = 
da_li
->pString;

151 
da_li
++;

155  
pSg
 ?Sg : 
deu_rg
;

156 
	}
}

158 cڡ *
	$dxt_by_dex_l_deu
(

159 
INDTEXT_DATA
 * 
da_li
,

160 
dex
,

161 
l_dex
,

162 cڡ *
befe_l_deu_me
,

163 cڡ *
deu_me
)

165 i(
dex
 < 
l_dex
)

166  
	`dxt_by_dex_deu
(
da_li
, 
dex
,

167 
befe_l_deu_me
);

169  
	`dxt_by_dex_deu
(
da_li
, 
dex
, 
deu_me
);

170 
	}
}

173 cڡ *
	$dxt_by_dex
(

174 
INDTEXT_DATA
 * 
da_li
,

175 
dex
)

177  
	`dxt_by_dex_deu
(
da_li
, 
dex
, 
NULL
);

178 
	}
}

180 
	$dxt_cou
(

181 
INDTEXT_DATA
 * 
da_li
)

183 
cou
 = 0;

185 i(
da_li
) {

186 
da_li
->
pSg
) {

187 
cou
++;

188 
da_li
++;

191  
cou
;

192 
	}
}

194 #ifde
TEST


195 
	~<as.h
>

196 
	~"e.h
"

198 
INDTEXT_DATA
 
	gda_li
[] = {

204 {0, 
NULL
}

207 
	$IndexText
(

208 
Te
 * 
pTe
)

210 
i
;

211 cڡ *
pSg
;

212 
dex
;

213 
bo
 
vid
;

214 
cou
 = 0;

216 
i
 = 0; i < 10; i++) {

217 
pSg
 = 
	`dxt_by_dex
(
da_li
, 
i
);

218 i(
pSg
) {

219 
cou
++;

220 
vid
 = 
	`dxt_by_rg
(
da_li
, 
pSg
, &
dex
);

221 
	`_
(
pTe
, 
vid
 =
ue
);

222 
	`_
(
pTe
, 
dex
 =
i
);

223 
	`_
(
pTe
, 
dex
 =
	`dxt_by_rg_deu
(
da_li
,

224 
pSg
, 
dex
));

227 
	`_
(
pTe
, 
	`dxt_cou
(
da_li
=
cou
);

228 
	`_
(
pTe
, 
	`dxt_by_rg
(
da_li
, "Hry", 
NULL
=
l
);

229 
	`_
(
pTe
, 
	`dxt_by_rg
(
da_li
, 
NULL
, NULL=
l
);

230 
	`_
(
pTe
, 
	`dxt_by_rg
(
NULL
, NULL, NULL=
l
);

231 
	`_
(
pTe
, 
	`dxt_by_dex
(
da_li
, 0=
NULL
);

232 
	`_
(
pTe
, 
	`dxt_by_dex
(
da_li
, 10=
NULL
);

233 
	`_
(
pTe
, 
	`dxt_by_dex
(
NULL
, 10) == NULL);

235 
	`_
(
pTe
, 
	`dxt_by_irg
(
da_li
, "JOSHUA", 
NULL
=
ue
);

236 
	`_
(
pTe
, 
	`dxt_by_irg
(
da_li
, "joshua", 
NULL
=
ue
);

237 
vid
 = 
	`dxt_by_irg
(
da_li
, "ANNA", &
dex
);

238 
	`_
(
pTe
, 
dex
 =
	`dxt_by_irg_deu
(
da_li
, "ANNA",

239 
dex
));

240 
	}
}

243 #ifde
TEST_INDEX_TEXT


244 
	$ma
(

247 
Te
 *
pTe
;

248 
bo
 
rc
;

250 
pTe
 = 
	`_
("dexext", 
NULL
);

253 
rc
 = 
	`_addTeFuni
(
pTe
, 
IndexText
);

254 
	`as
(
rc
);

256 
	`_tSm
(
pTe
, 
dout
);

257 
	`_run
(
pTe
);

258 (
	`_pt
(
pTe
);

260 
	`_deroy
(
pTe
);

263 
	}
}

	@src/key.c

36 
	~"key.h
"

40 #ifde
TEST


41 
	~<as.h
>

42 
	~<rg.h
>

44 
	~"e.h
"

47 
	$Keys
(

48 
Te
 * 
pTe
)

50 
ty
, 
id
;

51 
decoded_ty
, 
decoded_id
;

52 
KEY
 
key
;

54 
ty
 = 0;y < 
KEY_TYPE_MAX
;ype++) {

55 
id
 = 0; id < 
KEY_ID_MAX
; id++) {

56 
key
 = 
	`KEY_ENCODE
(
ty
, 
id
);

57 
decoded_ty
 = 
	`KEY_DECODE_TYPE
(
key
);

58 
decoded_id
 = 
	`KEY_DECODE_ID
(
key
);

59 
	`_
(
pTe
, 
decoded_ty
 =
ty
);

60 
	`_
(
pTe
, 
decoded_id
 =
id
);

65 
	}
}

68 
	$KeySame
(

69 
Te
 * 
pTe
)

71 
ty
, 
id
;

72 
ty_li
[] = { 0, 1, 
KEY_TYPE_MAX
 / 2, KEY_TYPE_MAX - 1, -1 };

73 
id_li
[] = { 0, 1, 
KEY_ID_MAX
 / 2, KEY_ID_MAX - 1, -1 };

74 
ty_dex
 = 0;

75 
id_dex
 = 0;

76 
decoded_ty
, 
decoded_id
;

77 
KEY
 
key
;

79 
ty_li
[
ty_dex
] != -1) {

80 
id_li
[
id_dex
] != -1) {

81 
ty
 = 
ty_li
[
ty_dex
];

82 
id
 = 
id_li
[
id_dex
];

83 
key
 = 
	`KEY_ENCODE
(
ty
, 
id
);

84 
decoded_ty
 = 
	`KEY_DECODE_TYPE
(
key
);

85 
decoded_id
 = 
	`KEY_DECODE_ID
(
key
);

86 
	`_
(
pTe
, 
decoded_ty
 =
ty
);

87 
	`_
(
pTe
, 
decoded_id
 =
id
);

89 
id_dex
++;

91 
id_dex
 = 0;

92 
ty_dex
++;

96 
	}
}

98 #ifde
TEST_KEY


99 
	$ma
(

102 
Te
 *
pTe
;

103 
bo
 
rc
;

105 
pTe
 = 
	`_
("key", 
NULL
);

109 
rc
 = 
	`_addTeFuni
(
pTe
, 
KeySame
);

110 
	`as
(
rc
);

112 
	`_tSm
(
pTe
, 
dout
);

113 
	`_run
(
pTe
);

114 (
	`_pt
(
pTe
);

116 
	`_deroy
(
pTe
);

119 
	}
}

	@src/keylist.c

43 
	~<dlib.h
>

45 
	~"keyli.h
"

47 #ide
FALSE


48 
	#FALSE
 0

	)

51 #ide
TRUE


52 
	#TRUE
 1

	)

60 
Keyli_Node
 *
	$NodeCe
(

63  
	`oc
(1, (
Keyli_Node
));

64 
	}
}

67 
Keyli
 *
	$KeyliCe
(

70  
	`oc
(1, (
Keyli
));

71 
	}
}

76 
	$CheckAaySize
(

77 
OS_Keyli
 
li
)

79 
w_size
 = 0;

80 cڡ 
chunk
 = 8;

81 
Keyli_Node
 **
w_y
;

82 
i
;

83 i(!
li
)

84  
FALSE
;

87 i(
li
->
cou
 =li->
size
)

88 
w_size
 = 
li
->
size
 + 
chunk
;

91 i((
li
->
size
 > 
chunk
&& (li->
cou
 < (list->size - chunk)))

92 
w_size
 = 
li
->
size
 - 
chunk
;

93 i(
w_size
) {

96 
w_y
 = 
	`oc
((
size_t

w_size
, (new_array));

99 i(!
w_y
)

100  
FALSE
;

103 i(
li
->
y
) {

104 
i
 = 0; i < 
li
->
cou
; i++) {

105 
w_y
[
i
] = 
li
->
y
[i];

107 
	`
(
li
->
y
);

109 
li
->
y
 = 
w_y
;

110 
li
->
size
 = 
w_size
;

112  
TRUE
;

113 
	}
}

122 
	$FdIndex
(

123 
OS_Keyli
 
li
,

124 
KEY
 
key
,

125 *
pIndex
)

127 
Keyli_Node
 *
node
;

128 

 = 0;

129 
right
 = 0;

130 
dex
 = 0;

131 
KEY
 
cut_key
 = 0;

132 
us
 = 
FALSE
;

133 i(!
li
 || !li->
y
 || !li->
cou
) {

134 *
pIndex
 = 0;

135  (
FALSE
);

137 
right
 = 
li
->
cou
 - 1;

142 
dex
 = (

 + 
right
) / 2;

143 
node
 = 
li
->
y
[
dex
];

144 i(!
node
)

146 
cut_key
 = 
node
->
key
;

147 i(
key
 < 
cut_key
)

148 
right
 = 
dex
 - 1;

151 

 = 
dex
 + 1;

153 (
key
 !
cut_key
&& (

 <
right
));

154 i(
key
 =
cut_key
) {

155 
us
 = 
TRUE
;

156 *
pIndex
 = 
dex
;

162 i(
key
 > 
cut_key
)

163 *
pIndex
 = 
dex
 + 1;

166 *
pIndex
 = 
dex
;

168  (
us
);

169 
	}
}

176 
	$Keyli_Da_Add
(

177 
OS_Keyli
 
li
,

178 
KEY
 
key
,

179 *
da
)

181 
Keyli_Node
 *
node
;

182 
dex
 = -1;

183 
i
;

185 i(
li
 && 
	`CheckAaySize
(list)) {

187 i(
li
->
cou
) {

188 (
	`FdIndex
(
li
, 
key
, &
dex
);

190 i(
dex
 < 0)

191 
dex
 = 0;

194 i(
dex
 > 
li
->
cou
)

195 
dex
 = 
li
->
cou
;

198 
i
 = 
li
->
cou
; i > 
dex
; i--) {

199 
li
->
y
[
i
] =ist->array[i - 1];

204 
dex
 = 0;

208 
node
 = 
	`NodeCe
();

209 i(
node
) {

210 
li
->
cou
++;

211 
node
->
key
 = key;

212 
node
->
da
 = data;

213 
li
->
y
[
dex
] = 
node
;

216  
dex
;

217 
	}
}

221 *
	$Keyli_Da_De_By_Index
(

222 
OS_Keyli
 
li
,

223 
dex
)

225 
Keyli_Node
 *
node
;

226 *
da
 = 
NULL
;

228 i(
li
 &&i->
y
 &&i->
cou
 && (
dex
 >= 0) &&

229 (
dex
 < 
li
->
cou
)) {

230 
node
 = 
li
->
y
[
dex
];

231 i(
node
)

232 
da
 = 
node
->data;

235 i(
li
->
cou
 == 1) {

240 i(
dex
 =(
li
->
cou
 - 1)) {

246 
i
;

247 
cou
 = 
li
->count - 1;

248 
i
 = 
dex
; i < 
cou
; i++) {

249 
li
->
y
[
i
] =ist->array[i + 1];

252 
li
->
cou
--;

253 i(
node
)

254 
	`
(
node
);

257 (
	`CheckAaySize
(
li
);

259  (
da
);

260 
	}
}

265 *
	$Keyli_Da_De
(

266 
OS_Keyli
 
li
,

267 
KEY
 
key
)

269 *
da
 = 
NULL
;

270 
dex
;

272 i(
li
) {

273 i(
	`FdIndex
(
li
, 
key
, &
dex
))

274 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 
dex
);

277  
da
;

278 
	}
}

281 *
	$Keyli_Da_P
(

282 
OS_Keyli
 
li
)

284 *
da
 = 
NULL
;

285 
dex
;

287 i(
li
 &&i->
cou
) {

288 
dex
 = 
li
->
cou
 - 1;

289 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 
dex
);

292  
da
;

293 
	}
}

296 *
	$Keyli_Da
(

297 
OS_Keyli
 
li
,

298 
KEY
 
key
)

300 
Keyli_Node
 *
node
 = 
NULL
;

301 
dex
 = 0;

303 i(
li
 &&i->
y
 &&i->
cou
) {

304 i(
	`FdIndex
(
li
, 
key
, &
dex
))

305 
node
 = 
li
->
y
[
dex
];

308  
node
 ?ode->
da
 : 
NULL
;

309 
	}
}

312 
	$Keyli_Index
(

313 
OS_Keyli
 
li
,

314 
KEY
 
key
)

316 
dex
 = -1;

318 i(
li
 &&i->
y
 &&i->
cou
) {

319 i(!
	`FdIndex
(
li
, 
key
, &
dex
)) {

320 
dex
 = -1;

324  
dex
;

325 
	}
}

329 *
	$Keyli_Da_Index
(

330 
OS_Keyli
 
li
,

331 
dex
)

333 
Keyli_Node
 *
node
 = 
NULL
;

335 i(
li
 &&i->
y
 &&i->
cou
 && (
dex
 >= 0) &&

336 (
dex
 < 
li
->
cou
))

337 
node
 = 
li
->
y
[
dex
];

339  
node
 ?ode->
da
 : 
NULL
;

340 
	}
}

343 
KEY
 
	$Keyli_Key
(

344 
OS_Keyli
 
li
,

345 
dex
)

347 
KEY
 
key
 = 0;

348 
Keyli_Node
 *
node
;

350 i(
li
 &&i->
y
 &&i->
cou
 && (
dex
 >= 0) &&

351 (
dex
 < 
li
->
cou
)) {

352 
node
 = 
li
->
y
[
dex
];

353 i(
node
)

354 
key
 = 
node
->key;

357  
key
;

358 
	}
}

361 
KEY
 
	$Keyli_Next_Emy_Key
(

362 
OS_Keyli
 
li
,

363 
KEY
 
key
)

365 
dex
;

367 i(
li
) {

368 
	`FdIndex
(
li
, 
key
, &
dex
)) {

369 i(
	`KEY_LAST
(
key
))

371 
key
++;

375  
key
;

376 
	}
}

379 
	$Keyli_Cou
(

380 
OS_Keyli
 
li
)

382  
li
->
cou
;

383 
	}
}

390 
OS_Keyli
 
	$Keyli_Ce
(

393 
Keyli
 *
li
;

395 
li
 = 
	`KeyliCe
();

396 i(
li
)

397 
	`CheckAaySize
(
li
);

399  
li
;

400 
	}
}

403 
	$Keyli_De
(

404 
OS_Keyli
 
li
)

406 i(
li
) {

408 
li
->
cou
) {

409 (
	`Keyli_Da_De_By_Index
(
li
, 0);

411 i(
li
->
y
)

412 
	`
(
li
->
y
);

413 
	`
(
li
);

417 
	}
}

419 #ifde
TEST


420 
	~<as.h
>

421 
	~<rg.h
>

423 
	~"e.h
"

426 
	$KeyLiFIFO
(

427 
Te
 * 
pTe
)

429 
OS_Keyli
 
li
;

430 
KEY
 
key
;

431 
dex
;

432 *
da1
 = "Joshua";

433 *
da2
 = "Anna";

434 *
da3
 = "Mary";

435 *
da
;

437 
li
 = 
	`Keyli_Ce
();

438 
	`_
(
pTe
, 
li
 !
NULL
);

440 
key
 = 0;

441 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da1
);

442 
	`_
(
pTe
, 
dex
 == 0);

443 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da2
);

444 
	`_
(
pTe
, 
dex
 == 0);

445 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da3
);

446 
	`_
(
pTe
, 
dex
 == 0);

448 
	`_
(
pTe
, 
	`Keyli_Cou
(
li
) == 3);

450 
da
 = 
	`Keyli_Da_P
(
li
);

451 
	`_
(
pTe
, 
da
 !
NULL
);

452 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da1
) == 0);

453 
da
 = 
	`Keyli_Da_P
(
li
);

454 
	`_
(
pTe
, 
da
 !
NULL
);

455 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da2
) == 0);

456 
da
 = 
	`Keyli_Da_P
(
li
);

457 
	`_
(
pTe
, 
da
 !
NULL
);

458 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da3
) == 0);

459 
da
 = 
	`Keyli_Da_P
(
li
);

460 
	`_
(
pTe
, 
da
 =
NULL
);

461 
da
 = 
	`Keyli_Da_P
(
li
);

462 
	`_
(
pTe
, 
da
 =
NULL
);

464 
	`Keyli_De
(
li
);

467 
	}
}

470 
	$KeyLiFILO
(

471 
Te
 * 
pTe
)

473 
OS_Keyli
 
li
;

474 
KEY
 
key
;

475 
dex
;

476 *
da1
 = "Joshua";

477 *
da2
 = "Anna";

478 *
da3
 = "Mary";

479 *
da
;

481 
li
 = 
	`Keyli_Ce
();

482 
	`_
(
pTe
, 
li
 !
NULL
);

484 
key
 = 0;

485 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da1
);

486 
	`_
(
pTe
, 
dex
 == 0);

487 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da2
);

488 
	`_
(
pTe
, 
dex
 == 0);

489 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da3
);

490 
	`_
(
pTe
, 
dex
 == 0);

492 
	`_
(
pTe
, 
	`Keyli_Cou
(
li
) == 3);

494 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 0);

495 
	`_
(
pTe
, 
da
 !
NULL
);

496 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da3
) == 0);

498 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 0);

499 
	`_
(
pTe
, 
da
 !
NULL
);

500 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da2
) == 0);

502 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 0);

503 
	`_
(
pTe
, 
da
 !
NULL
);

504 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da1
) == 0);

506 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 0);

507 
	`_
(
pTe
, 
da
 =
NULL
);

509 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 0);

510 
	`_
(
pTe
, 
da
 =
NULL
);

512 
	`Keyli_De
(
li
);

515 
	}
}

517 
	$KeyLiDaKey
(

518 
Te
 * 
pTe
)

520 
OS_Keyli
 
li
;

521 
KEY
 
key
;

522 
KEY
 
_key
;

523 
dex
;

524 *
da1
 = "Joshua";

525 *
da2
 = "Anna";

526 *
da3
 = "Mary";

527 *
da
;

529 
li
 = 
	`Keyli_Ce
();

530 
	`_
(
pTe
, 
li
 !
NULL
);

532 
key
 = 1;

533 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da1
);

534 
	`_
(
pTe
, 
dex
 == 0);

535 
_key
 = 
	`Keyli_Key
(
li
, 
dex
);

536 
	`_
(
pTe
, 
_key
 =
key
);

538 
key
 = 2;

539 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da2
);

540 
	`_
(
pTe
, 
dex
 == 1);

541 
_key
 = 
	`Keyli_Key
(
li
, 
dex
);

542 
	`_
(
pTe
, 
_key
 =
key
);

544 
key
 = 3;

545 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da3
);

546 
	`_
(
pTe
, 
dex
 == 2);

547 
_key
 = 
	`Keyli_Key
(
li
, 
dex
);

548 
	`_
(
pTe
, 
_key
 =
key
);

550 
	`_
(
pTe
, 
	`Keyli_Cou
(
li
) == 3);

553 
key
 = 2;

554 
da
 = 
	`Keyli_Da
(
li
, 
key
);

555 
	`_
(
pTe
, 
da
 !
NULL
);

556 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da2
) == 0);

558 
key
 = 1;

559 
da
 = 
	`Keyli_Da
(
li
, 
key
);

560 
	`_
(
pTe
, 
da
 !
NULL
);

561 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da1
) == 0);

563 
key
 = 3;

564 
da
 = 
	`Keyli_Da
(
li
, 
key
);

565 
	`_
(
pTe
, 
da
 !
NULL
);

566 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da3
) == 0);

569 
key
 = 2;

570 
da
 = 
	`Keyli_Da_De
(
li
, 
key
);

571 
	`_
(
pTe
, 
da
 !
NULL
);

572 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da2
) == 0);

573 
da
 = 
	`Keyli_Da_De
(
li
, 
key
);

574 
	`_
(
pTe
, 
da
 =
NULL
);

575 
	`_
(
pTe
, 
	`Keyli_Cou
(
li
) == 2);

577 
key
 = 1;

578 
da
 = 
	`Keyli_Da
(
li
, 
key
);

579 
	`_
(
pTe
, 
da
 !
NULL
);

580 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da1
) == 0);

582 
key
 = 3;

583 
da
 = 
	`Keyli_Da
(
li
, 
key
);

584 
	`_
(
pTe
, 
da
 !
NULL
);

585 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da3
) == 0);

589 
da
 = 
	`Keyli_Da_P
(
li
);

591 
da
);

593 
	`Keyli_De
(
li
);

596 
	}
}

598 
	$KeyLiDaIndex
(

599 
Te
 * 
pTe
)

601 
OS_Keyli
 
li
;

602 
KEY
 
key
;

603 
dex
;

604 *
da1
 = "Joshua";

605 *
da2
 = "Anna";

606 *
da3
 = "Mary";

607 *
da
;

609 
li
 = 
	`Keyli_Ce
();

610 
	`_
(
pTe
, 
li
 !
NULL
);

612 
key
 = 0;

613 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da1
);

614 
	`_
(
pTe
, 
dex
 == 0);

615 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da2
);

616 
	`_
(
pTe
, 
dex
 == 0);

617 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, 
da3
);

618 
	`_
(
pTe
, 
dex
 == 0);

621 
	`_
(
pTe
, 
	`Keyli_Cou
(
li
) == 3);

624 
da
 = 
	`Keyli_Da_Index
(
li
, 0);

625 
	`_
(
pTe
, 
da
 !
NULL
);

626 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da3
) == 0);

628 
da
 = 
	`Keyli_Da_Index
(
li
, 1);

629 
	`_
(
pTe
, 
da
 !
NULL
);

630 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da2
) == 0);

632 
da
 = 
	`Keyli_Da_Index
(
li
, 2);

633 
	`_
(
pTe
, 
da
 !
NULL
);

634 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da1
) == 0);

637 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 1);

638 
	`_
(
pTe
, 
da
 !
NULL
);

639 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da2
) == 0);

641 
	`_
(
pTe
, 
	`Keyli_Cou
(
li
) == 2);

643 
da
 = 
	`Keyli_Da_Index
(
li
, 0);

644 
	`_
(
pTe
, 
da
 !
NULL
);

645 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da3
) == 0);

647 
da
 = 
	`Keyli_Da_Index
(
li
, 1);

648 
	`_
(
pTe
, 
da
 !
NULL
);

649 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da1
) == 0);

651 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 1);

652 
	`_
(
pTe
, 
da
 !
NULL
);

653 
	`_
(
pTe
, 
	`rcmp
(
da
, 
da1
) == 0);

655 
da
 = 
	`Keyli_Da_De_By_Index
(
li
, 1);

656 
	`_
(
pTe
, 
da
 =
NULL
);

660 
da
 = 
	`Keyli_Da_P
(
li
);

662 
da
);

664 
	`Keyli_De
(
li
);

667 
	}
}

670 
	$KeyLiLge
(

671 
Te
 * 
pTe
)

673 
da1
 = 42;

674 *
da
;

675 
OS_Keyli
 
li
;

676 
KEY
 
key
;

677 
dex
;

678 cڡ 
num_keys
 = 1024 * 16;

680 
li
 = 
	`Keyli_Ce
();

681 i(!
li
)

684 
key
 = 0; key < 
num_keys
; key++) {

685 
dex
 = 
	`Keyli_Da_Add
(
li
, 
key
, &
da1
);

688 
key
 = 0; key < 
num_keys
; key++) {

689 
da
 = 
	`Keyli_Da
(
li
, 
key
);

690 
	`_
(
pTe
, *
da
 =
da1
);

692 
dex
 = 0; index < 
num_keys
; index++) {

693 
da
 = 
	`Keyli_Da_Index
(
li
, 
dex
);

694 
	`_
(
pTe
, *
da
 =
da1
);

696 
	`Keyli_De
(
li
);

699 
	}
}

702 
	$KeyLi
(

703 
Te
 * 
pTe
)

705 
bo
 
rc
;

708 
rc
 = 
	`_addTeFuni
(
pTe
, 
KeyLiFIFO
);

709 
	`as
(
rc
);

710 
rc
 = 
	`_addTeFuni
(
pTe
, 
KeyLiFILO
);

711 
	`as
(
rc
);

712 
rc
 = 
	`_addTeFuni
(
pTe
, 
KeyLiDaKey
);

713 
	`as
(
rc
);

714 
rc
 = 
	`_addTeFuni
(
pTe
, 
KeyLiDaIndex
);

715 
	`as
(
rc
);

716 
rc
 = 
	`_addTeFuni
(
pTe
, 
KeyLiLge
);

717 
	`as
(
rc
);

718 
	}
}

720 #ifde
TEST_KEYLIST


721 
	$ma
(

724 
Te
 *
pTe
;

726 
pTe
 = 
	`_
("keyli", 
NULL
);

727 
	`KeyLi
(
pTe
);

728 
	`_tSm
(
pTe
, 
dout
);

729 
	`_run
(
pTe
);

730 (
	`_pt
(
pTe
);

732 
	`_deroy
(
pTe
);

735 
	}
}

	@src/lighting.c

34 
	~<dt.h
>

35 
	~<dbo.h
>

36 
	~<rg.h
>

37 
	~<dio.h
>

38 
	~<dlib.h
>

39 
	~<y.h
>

40 
	~"lightg.h
"

41 
	~"bacdcode.h
"

54 
	$lightg_commd_code
(

55 
ut8_t
 * 
du
,

56 
BACNET_LIGHTING_COMMAND
 * 
da
)

58 
du_n
 = 0;

59 
n
 = 0;

61 i(
du
) {

62 
n
 = 
	`code_cڋxt_umed
(&
du
[
du_n
], 0,

63 
da
->
ݔi
);

64 
du_n
 +
n
;

66 i(
da
->
u_rg_v
) {

67 
n
 = 
	`code_cڋxt_
(&
du
[
du_n
], 1,

68 
da
->
rg_v
);

69 
du_n
 +
n
;

72 i(
da
->
u_mp_
) {

73 
n
 = 
	`code_cڋxt_
(&
du
[
du_n
], 2,

74 
da
->
mp_
);

75 
du_n
 +
n
;

78 i(
da
->
u__emt
) {

79 
n
 = 
	`code_cڋxt_
(&
du
[
du_n
], 3,

80 
da
->
_emt
);

81 
du_n
 +
n
;

84 i(
da
->
u_de_time
) {

85 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 4,

86 
da
->
de_time
);

87 
du_n
 +
n
;

90 i(
da
->
u_iܙy
) {

91 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 5,

92 
da
->
iܙy
);

93 
du_n
 +
n
;

97  
du_n
;

98 
	}
}

110 
	$lightg_commd_code_cڋxt
(

111 
ut8_t
 * 
du
,

112 
ut8_t
 
g_numb
,

113 
BACNET_LIGHTING_COMMAND
 * 
vue
)

115 
du_n
 = 0;

117 
du_n
 +
	`code_ݒg_g
(&
du
[du_n], 
g_numb
);

118 
du_n
 +
	`lightg_commd_code
(&
du
[du_n], 
vue
);

119 
du_n
 +
	`code_osg_g
(&
du
[du_n], 
g_numb
);

121  
du_n
;

122 
	}
}

133 
	$lightg_commd_decode
(

134 
ut8_t
 * 
du
,

135 
du_max_n
,

136 
BACNET_LIGHTING_COMMAND
 * 
da
)

138 
n
 = 0;

139 
du_n
 = 0;

140 
ut8_t
 
g_numb
 = 0;

141 
ut32_t
 
n_vue_ty
 = 0;

142 
ut32_t
 
unsigd_vue
 = 0;

143 
_vue
 = 0.0;

145 
du_max_n
 =pdu_max_len;

147 i(
du_max_n
 && 
da
) {

149 i(!
	`decode_is_cڋxt_g
(&
du
[
du_n
], 0))

150  
BACNET_STATUS_ERROR
;

151 
n
 =

152 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

153 &
n_vue_ty
);

154 
du_n
 +
n
;

155 
n
 =

156 
	`decode_umed
(&
du
[
du_n
], 
n_vue_ty
, &
unsigd_vue
);

157 i(
n
 > 0) {

158 
da
->
ݔi
 = 
unsigd_vue
;

160 
du_n
 +
n
;

162 i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 1)) {

163 
n
 =

164 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

165 &
n_vue_ty
);

166 
du_n
 +
n
;

167 
n
 = 
	`decode_
(&
du
[
du_n
], &
_vue
);

168 
da
->
rg_v
 = 
_vue
;

169 
du_n
 +
n
;

170 
da
->
u_rg_v
 = 
ue
;

172 
da
->
u_rg_v
 = 
l
;

175 i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 2)) {

176 
n
 =

177 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

178 &
n_vue_ty
);

179 
du_n
 +
n
;

180 
n
 = 
	`decode_
(&
du
[
du_n
], &
_vue
);

181 
da
->
mp_
 = 
_vue
;

182 
da
->
u_mp_
 = 
ue
;

184 
da
->
u_mp_
 = 
l
;

187 i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 3)) {

188 
n
 =

189 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

190 &
n_vue_ty
);

191 
du_n
 +
n
;

192 
n
 = 
	`decode_
(&
du
[
du_n
], &
_vue
);

193 
da
->
_emt
 = 
_vue
;

194 
da
->
u__emt
 = 
ue
;

196 
da
->
u__emt
 = 
l
;

199 i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 4)) {

200 
n
 =

201 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

202 &
n_vue_ty
);

203 
du_n
 +
n
;

204 
n
 = 
	`decode_unsigd
(&
du
[
du_n
], 
n_vue_ty
,

205 &
unsigd_vue
);

206 
da
->
de_time
 = 
unsigd_vue
;

207 
da
->
u_de_time
 = 
ue
;

209 
da
->
u_de_time
 = 
l
;

212 i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 4)) {

213 
n
 =

214 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

215 &
n_vue_ty
);

216 
du_n
 +
n
;

217 
n
 = 
	`decode_unsigd
(&
du
[
du_n
], 
n_vue_ty
,

218 &
unsigd_vue
);

219 
da
->
iܙy
 = 
unsigd_vue
;

220 
da
->
u_iܙy
 = 
ue
;

222 
da
->
u_iܙy
 = 
l
;

226  
n
;

227 
	}
}

237 
bo
 
	$lightg_commd_cy
(

238 
BACNET_LIGHTING_COMMAND
 * 
d
,

239 
BACNET_LIGHTING_COMMAND
 * 
c
)

241 
bo
 
us
 = 
l
;

243 i(
d
 && 
c
) {

244 
d
->
ݔi
 = 
c
->operation;

245 
d
->
u_rg_v
 = 
c
->use_target_level;

246 
d
->
u_mp_
 = 
c
->use_ramp_rate;

247 
d
->
u__emt
 = 
c
->use_step_increment;

248 
d
->
u_de_time
 = 
c
->use_fade_time;

249 
d
->
u_iܙy
 = 
c
->use_priority;

250 
d
->
rg_v
 = 
c
->target_level;

251 
d
->
mp_
 = 
c
->ramp_rate;

252 
d
->
_emt
 = 
c
->step_increment;

253 
d
->
de_time
 = 
c
->fade_time;

254 
d
->
iܙy
 = 
c
->priority;

255 
us
 = 
ue
;

258  
us
;

259 
	}
}

269 
bo
 
	$lightg_commd_me
(

270 
BACNET_LIGHTING_COMMAND
 * 
d
,

271 
BACNET_LIGHTING_COMMAND
 * 
c
)

273 
bo
 
us
 = 
l
;

275 i(
d
 && 
c
) {

276 i((
d
->
ݔi
 =
c
->operation) &&

277 (
d
->
u_rg_v
 =
c
->use_target_level) &&

278 (
d
->
u_mp_
 =
c
->use_ramp_rate) &&

279 (
d
->
u__emt
 =
c
->use_step_increment) &&

280 (
d
->
u_de_time
 =
c
->use_fade_time) &&

281 (
d
->
u_iܙy
 =
c
->use_priority)) {

282 
us
 = 
ue
;

283 i((
d
->
u_rg_v
) &&

284 (
d
->
rg_v
 !
c
->target_level)) {

285 
us
 = 
l
;

287 i((
d
->
u_mp_
) &&

288 (
d
->
mp_
 !
c
->ramp_rate)) {

289 
us
 = 
l
;

291 i((
d
->
u__emt
) &&

292 (
d
->
_emt
 !
c
->step_increment)) {

293 
us
 = 
l
;

295 i((
d
->
u_de_time
) &&

296 (
d
->
de_time
 !
c
->fade_time)) {

297 
us
 = 
l
;

299 i((
d
->
u_iܙy
) &&

300 (
d
->
iܙy
 !
c
->priority)) {

301 
us
 = 
l
;

306  
us
;

307 
	}
}

309 #ifde
TEST


310 
	~<as.h
>

311 
	~<rg.h
>

312 
	~"e.h
"

314 
	$BACtLightgCommd
(

315 
Te
 * 
pTe
,

316 
BACNET_LIGHTING_COMMAND
 *
da
)

318 
bo
 
us
 = 
l
;

319 
BACNET_LIGHTING_COMMAND
 
_da
;

320 
n
, 
du_n
;

321 
ut8_t
 
du
[
MAX_APDU
] = {0};

323 
us
 = 
	`lightg_commd_cy
(&
_da
, 
NULL
);

324 
	`_
(
pTe
, 
us
 =
l
);

325 
us
 = 
	`lightg_commd_cy
(
NULL
, 
da
);

326 
	`_
(
pTe
, 
us
 =
l
);

327 
us
 = 
	`lightg_commd_cy
(&
_da
, 
da
);

328 
	`_
(
pTe
, 
us
 =
ue
);

329 
us
 = 
	`lightg_commd_me
(&
_da
, 
da
);

330 
	`_
(
pTe
, 
us
 =
ue
);

331 
n
 = 
	`lightg_commd_code
(
du
, 
da
);

332 
du_n
 = 
	`lightg_commd_decode
(
du
, pdu), &
_da
);

333 
	`_
(
pTe
, 
n
 > 0);

334 
	`_
(
pTe
, 
du_n
 > 0);

335 
us
 = 
	`lightg_commd_me
(&
_da
, 
da
);

336 
	}
}

338 
	$BACtLightgCommdA
(

339 
Te
 * 
pTe
)

341 
BACNET_LIGHTING_COMMAND
 
da
;

343 
da
.
ݔi
 = 
BACNET_LIGHTS_NONE
;

344 
da
.
u_rg_v
 = 
l
;

345 
da
.
u_mp_
 = 
l
;

346 
da
.
u__emt
 = 
l
;

347 
da
.
u_de_time
 = 
l
;

348 
da
.
u_iܙy
 = 
l
;

349 
da
.
rg_v
 = 0.0;

350 
da
.
mp_
 = 100.0;

351 
da
.
_emt
 = 1.0;

352 
da
.
de_time
 = 100;

353 
da
.
iܙy
 = 1;

354 
	`BACtLightgCommd
(
pTe
, &
da
);

355 
da
.
ݔi
 = 
BACNET_LIGHTS_STOP
;

356 
da
.
u_rg_v
 = 
ue
;

357 
da
.
u_mp_
 = 
ue
;

358 
da
.
u__emt
 = 
ue
;

359 
da
.
u_de_time
 = 
ue
;

360 
da
.
u_iܙy
 = 
ue
;

361 
	`BACtLightgCommd
(
pTe
, &
da
);

362 
	}
}

364 #ifde
TEST_LIGHTING_COMMAND


365 
	$ma
(

368 
Te
 *
pTe
;

369 
bo
 
rc
;

371 
pTe
 = 
	`_
("BACÈLightg Commd", 
NULL
);

373 
rc
 = 
	`_addTeFuni
(
pTe
, 
BACtLightgCommdA
);

374 
	`as
(
rc
);

376 
	`_tSm
(
pTe
, 
dout
);

377 
	`_run
(
pTe
);

378 (
	`_pt
(
pTe
);

379 
	`_deroy
(
pTe
);

382 
	}
}

	@src/lso.c

34 
	~"lso.h
"

35 
	~"bacdcode.h
"

36 
	~"du.h
"

40 
	$lso_code_du
(

41 
ut8_t
 * 
du
,

42 
ut8_t
 
voke_id
,

43 
BACNET_LSO_DATA
 * 
da
)

45 
n
 = 0;

46 
du_n
 = 0;

48 i(
du
 && 
da
) {

49 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

50 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

51 
du
[2] = 
voke_id
;

52 
du
[3] = 
SERVICE_CONFIRMED_LIFE_SAFETY_OPERATION
;

53 
du_n
 = 4;

55 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0, 
da
->
ossId
);

56 
du_n
 +
n
;

58 
n
 =

59 
	`code_cڋxt_cha_rg
(&
du
[
du_n
], 1,

60 &
da
->
quegSrc
);

61 
du_n
 +
n
;

65 
n
 = 
	`code_cڋxt_umed
(&
du
[
du_n
], 2, 
da
->
ݔi
);

66 
du_n
 +
n
;

71 
n
 =

72 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 3,

73 (
da
->
rgObje
.
ty
, da->rgObje.

);

75 
du_n
 +
n
;

78  
du_n
;

79 
	}
}

81 
	$lso_decode_rvi_que
(

82 
ut8_t
 * 
du
,

83 
du_n
,

84 
BACNET_LSO_DATA
 * 
da
)

86 
n
 = 0;

87 
i_ngth
 = 0;

88 
ut32_t
 
ݔi
 = 0;

91 i(
du_n
 && 
da
) {

94 i((
i_ngth
 =

95 
	`decode_cڋxt_unsigd
(&
du
[
n
], 0,

96 &
da
->
ossId
)) == -1) {

99 
n
 +
i_ngth
;

101 i((
i_ngth
 =

102 
	`decode_cڋxt_cha_rg
(&
du
[
n
], 1,

103 &
da
->
quegSrc
)) == -1) {

106 
n
 +
i_ngth
;

108 i((
i_ngth
 =

109 
	`decode_cڋxt_umed
(&
du
[
n
], 2, &
ݔi
)) == -1) {

112 
da
->
ݔi
 = (
BACNET_LIFE_SAFETY_OPERATION
) operation;

113 
n
 +
i_ngth
;

118 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 3)) {

119 i((
i_ngth
 =

120 
	`decode_cڋxt_obje_id
(&
du
[
n
], 3,

121 &
da
->
rgObje
.
ty
,

122 &
da
->
rgObje
.

)) == -1) {

125 
n
 +
i_ngth
;

127 
da
->
rgObje
.
ty
 = 0;

128 
da
->
rgObje
.

 = 0;

130  
n
;

135 
	}
}

137 #ifde
TEST


138 
	~<as.h
>

139 
	~<rg.h
>

140 
	~"e.h
"

141 
	~"ba.h
"

143 
	$LSO
(

144 
Te
 * 
pTe
)

146 
ut8_t
 
du
[1000];

147 
n
;

149 
BACNET_LSO_DATA
 
da
;

150 
BACNET_LSO_DATA
 
rxda
;

152 
	`memt
(&
rxda
, 0, (rxdata));

155 
	`charg__si
(&
da
.
quegSrc
, "foobar");

156 
da
.
ݔi
 = 
LIFE_SAFETY_OP_RESET
;

157 
da
.
ossId
 = 0x1234;

158 
da
.
rgObje
.

 = 0x1000;

159 
da
.
rgObje
.
ty
 = 
OBJECT_BINARY_INPUT
;

161 
n
 = 
	`lso_code_du
(
du
, 100, &
da
);

163 
	`lso_decode_rvi_que
(&
du
[4], 
n
, &
rxda
);

165 
	`_
(
pTe
, 
da
.
ݔi
 =
rxda
.operation);

166 
	`_
(
pTe
, 
da
.
ossId
 =
rxda
.processId);

167 
	`_
(
pTe
, 
da
.
rgObje
.

 =
rxda
.targetObject.instance);

168 
	`_
(
pTe
, 
da
.
rgObje
.
ty
 =
rxda
.targetObject.type);

169 
	`_
(
pTe
, 
	`memcmp
(
da
.
quegSrc
.
vue
, 
rxda
.requestingSrc.value,

170 
rxda
.
quegSrc
.
ngth
) == 0);

171 
	}
}

173 #ifde
TEST_LSO


174 
	$ma
(

175 
gc
,

176 *
gv
[])

178 
Te
 *
pTe
;

179 
bo
 
rc
;

181 
pTe
 = 
	`_
("BACÈLi Saty Oti", 
NULL
);

183 
rc
 = 
	`_addTeFuni
(
pTe
, 
LSO
);

184 
	`as
(
rc
);

186 
	`_tSm
(
pTe
, 
dout
);

187 
	`_run
(
pTe
);

188 (
	`_pt
(
pTe
);

189 
	`_deroy
(
pTe
);

192 
	}
}

	@src/memcopy.c

34 
	~<ddef.h
>

35 
	~"memcy.h
"

36 
	~<rg.h
>

42 
size_t
 
	$memcy
(

43 *
de
,

44 *
c
,

45 
size_t
 
offt
,

46 
size_t
 
n
,

47 
size_t
 
max
)

55 i(
n
 <(
max
 - 
offt
)) {

56 
	`memy
(&((*
de
)[
offt
], 
c
, 
n
);

57  (
n
);

65 
	}
}

67 #ifde
TEST


68 
	~<as.h
>

69 
	~<rg.h
>

71 
	~"e.h
"

73 
	$_memcy
(

74 
Te
 * 
pTe
)

76 *
da1
 = "Joshua";

77 *
da2
 = "Anna";

78 
bufr
[480] = "";

79 
big_bufr
[480] = "";

80 
size_t
 
n
 = 0;

82 
n
 = 
	`memcy
(&
bufr
[0], &
da1
[0], 0, (data1), (buffer));

83 
	`_
(
pTe
, 
n
 =(
da1
));

84 
	`_
(
pTe
, 
	`memcmp
(&
bufr
[0], &
da1
[0], 
n
) == 0);

85 
n
 = 
	`memcy
(&
bufr
[0], &
da2
[0],en, (data2), (buffer));

86 
	`_
(
pTe
, 
n
 =(
da2
));

87 
n
 =

88 
	`memcy
(&
bufr
[0], &
big_bufr
[0], 1, (big_buffer),

89 (
bufr
));

90 
	`_
(
pTe
, 
n
 == 0);

91 
	}
}

93 #ifde
TEST_MEM_COPY


94 
	$ma
(

97 
Te
 *
pTe
;

98 
bo
 
rc
;

100 
pTe
 = 
	`_
("Memy Cy", 
NULL
);

103 
rc
 = 
	`_addTeFuni
(
pTe
, 
_memcy
);

104 
	`as
(
rc
);

106 
	`_tSm
(
pTe
, 
dout
);

107 
	`_run
(
pTe
);

108 (
	`_pt
(
pTe
);

110 
	`_deroy
(
pTe
);

113 
	}
}

	@src/mstp.c

49 
	~<ddef.h
>

50 
	~<dt.h
>

51 #i
PRINT_ENABLED


52 
	~<dio.h
>

54 
	~"mp.h
"

55 
	~"c.h
"

56 
	~"rs485.h
"

57 
	~"mext.h
"

58 #i!
defed
(
DEBUG_ENABLED
)

59 
	#DEBUG_ENABLED
 1

	)

61 
	~"debug.h
"

63 #i
PRINT_ENABLED


64 #unde
PRINT_ENABLED_RECEIVE


65 #unde
PRINT_ENABLED_RECEIVE_DATA


66 #unde
PRINT_ENABLED_RECEIVE_ERRORS


67 #unde
PRINT_ENABLED_MASTER


70 #i
defed
(
PRINT_ENABLED_RECEIVE
)

71 
	#tf_ive
 
debug_tf


	)

73 
le
 
	$tf_ive
(

74 cڡ *
fm
,

77 
fm
 = format;

78 
	}
}

81 #i
defed
(
PRINT_ENABLED_RECEIVE_DATA
)

82 
	#tf_ive_da
 
debug_tf


	)

84 
le
 
	$tf_ive_da
(

85 cڡ *
fm
,

88 
fm
 = format;

89 
	}
}

92 #i
defed
(
PRINT_ENABLED_RECEIVE_ERRORS
)

93 
	#tf_ive_r
 
debug_tf


	)

95 
le
 
	$tf_ive_r
(

96 cڡ *
fm
,

99 
fm
 = format;

100 
	}
}

103 #i
defed
(
PRINT_ENABLED_MASTER
)

104 
	#tf_ma
 
debug_tf


	)

106 
le
 
	$tf_ma
(

107 cڡ *
fm
,

110 
fm
 = format;

111 
	}
}

130 
	#Nm_os
 4

	)

138 #ide
Tame_abt


139 
	#Tame_abt
 95

	)

145 
	#Ty_day
 250

	)

150 
	#Troff
 30

	)

156 #ide
Ty_timeout


157 
	#Ty_timeout
 295

	)

164 #ide
Tuge_timeout


165 
	#Tuge_timeout
 95

	)

169 
	#INCREMENT_AND_LIMIT_UINT8
(
x
{i(x < 0xFFx++;}

	)

171 
bo
 
	$MSTP_Le_Aive
(

172 vީ
mp_pt_ru_t
 *
mp_pt
)

174  (
mp_pt
->
EvtCou
 > 
Nm_os
);

175 
	}
}

177 
	$MSTP_Fl_BACt_Addss
(

178 
BACNET_ADDRESS
 * 
c
,

179 
ut8_t
 
mp_addss
)

181 
i
 = 0;

183 i(
mp_addss
 =
MSTP_BROADCAST_ADDRESS
) {

185 
c
->
mac_n
 = 0;

186 
c
->
mac
[0] = 0;

188 
c
->
mac_n
 = 1;

189 
c
->
mac
[0] = 
mp_addss
;

192 
i
 = 1; i < 
MAX_MAC_LEN
; i++) {

193 
c
->
mac
[
i
] = 0;

195 
c
->
t
 = 0;

196 
c
->
n
 = 0;

197 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

198 
c
->
adr
[
i
] = 0;

200 
	}
}

202 
ut16_t
 
	$MSTP_Ce_Fme
(

203 
ut8_t
 * 
bufr
,

204 
ut16_t
 
bufr_n
,

205 
ut8_t
 
ame_ty
,

206 
ut8_t
 
dei
,

207 
ut8_t
 
sour
,

208 
ut8_t
 * 
da
,

209 
ut16_t
 
da_n
)

211 
ut8_t
 
c8
 = 0xFF;

212 
ut16_t
 
c16
 = 0xFFFF;

213 
ut16_t
 
dex
 = 0;

216 i(
bufr_n
 < 8)

219 
bufr
[0] = 0x55;

220 
bufr
[1] = 0xFF;

221 
bufr
[2] = 
ame_ty
;

222 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[2], crc8);

223 
bufr
[3] = 
dei
;

224 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[3], crc8);

225 
bufr
[4] = 
sour
;

226 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[4], crc8);

227 
bufr
[5] = 
da_n
 >> 8;

228 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[5], crc8);

229 
bufr
[6] = 
da_n
 & 0xFF;

230 
c8
 = 
	`CRC_Cc_Hd
(
bufr
[6], crc8);

231 
bufr
[7] = ~
c8
;

233 
dex
 = 8;

234 
da_n
 && 
da
 && (
dex
 < 
bufr_n
)) {

235 
bufr
[
dex
] = *
da
;

236 
c16
 = 
	`CRC_Cc_Da
(
bufr
[
dex
], crc16);

237 
da
++;

238 
dex
++;

239 
da_n
--;

242 i(
dex
 > 8) {

243 i((
dex
 + 2<
bufr_n
) {

244 
c16
 = ~crc16;

245 
bufr
[
dex
] = 
c16
 & 0xFF;

246 
dex
++;

247 
bufr
[
dex
] = 
c16
 >> 8;

248 
dex
++;

253  
dex
;

254 
	}
}

256 
	$MSTP_Ce_And_Sd_Fme
(

257 vީ
mp_pt_ru_t
 *
mp_pt
,

258 
ut8_t
 
ame_ty
,

259 
ut8_t
 
dei
,

260 
ut8_t
 
sour
,

261 
ut8_t
 * 
da
,

262 
ut16_t
 
da_n
)

264 
ut16_t
 
n
 = 0;

266 
n
 =

267 
	`MSTP_Ce_Fme
((
ut8_t
 *& 
mp_pt
->
OuutBufr
[0],

268 
mp_pt
->
OuutBufrSize
, 
ame_ty
, 
dei
, 
sour
, 
da
,

269 
da_n
);

271 
	`RS485_Sd_Fme
(
mp_pt
, (
ut8_t
 *& mp_pt->
OuutBufr
[0], 
n
);

273 
	}
}

275 
	$MSTP_Reive_Fme_FSM
(

276 vީ
mp_pt_ru_t
 *
mp_pt
)

278 
MSTP_RECEIVE_STATE
 
ive_e
 = 
mp_pt
->receive_state;

279 
tf_ive


281 
	`mext_ive_e
(
mp_pt
->
ive_e
),

282 
mp_pt
->
DaRegi
, mp_pt->
HdCRC
, mp_pt->
Index
,

283 
mp_pt
->
EvtCou
, mp_pt->
DaLgth
,

284 
mp_pt
->
	`STim
((*) mstp_port));

285 
mp_pt
->
ive_e
) {

287 
MSTP_RECEIVE_STATE_IDLE
:

289 i(
mp_pt
->
ReiveE
 =
ue
) {

290 
mp_pt
->
ReiveE
 = 
l
;

291 
mp_pt
->
	`STimRet
((*) mstp_port);

292 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

294 } i(
mp_pt
->
DaAvaab
 =
ue
) {

295 
	`tf_ive_da
("MSTP Rx: %02X ", 
mp_pt
->
DaRegi
);

297 i(
mp_pt
->
DaRegi
 == 0x55) {

299 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_PREAMBLE
;

303 
	`tf_ive_da
("\n");

306 
mp_pt
->
DaAvaab
 = 
l
;

307 
mp_pt
->
	`STimRet
((*) mstp_port);

308 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

312 
MSTP_RECEIVE_STATE_PREAMBLE
:

314 i(
mp_pt
->
	`STim
((*mp_pt> 
Tame_abt
) {

317 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

320 i(
mp_pt
->
ReiveE
 =
ue
) {

321 
mp_pt
->
ReiveE
 = 
l
;

322 
mp_pt
->
	`STimRet
((*) mstp_port);

323 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

325 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

326 } i(
mp_pt
->
DaAvaab
 =
ue
) {

327 
	`tf_ive_da
("%02X ", 
mp_pt
->
DaRegi
);

329 i(
mp_pt
->
DaRegi
 == 0xFF) {

330 
mp_pt
->
Index
 = 0;

331 
mp_pt
->
HdCRC
 = 0xFF;

333 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_HEADER
;

336 i(
mp_pt
->
DaRegi
 == 0x55) {

342 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

344 
mp_pt
->
DaAvaab
 = 
l
;

345 
mp_pt
->
	`STimRet
((*) mstp_port);

346 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

350 
MSTP_RECEIVE_STATE_HEADER
:

352 i(
mp_pt
->
	`STim
((*mp_pt> 
Tame_abt
) {

354 
mp_pt
->
ReivedInvidFme
 = 
ue
;

356 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

357 
	`tf_ive_r
("MSTP: Rx Header: SilenceTimer %u > %d\n",

358 (
mp_pt
->
	`STim
((*) mstp_port),

359 
Tame_abt
);

362 i(
mp_pt
->
ReiveE
 =
ue
) {

363 
mp_pt
->
ReiveE
 = 
l
;

364 
mp_pt
->
	`STimRet
((*) mstp_port);

365 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

367 
mp_pt
->
ReivedInvidFme
 = 
ue
;

368 
	`tf_ive_r
("MSTP: Rx Header: ReceiveError\n");

370 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

371 } i(
mp_pt
->
DaAvaab
 =
ue
) {

372 
	`tf_ive_da
("%02X ", 
mp_pt
->
DaRegi
);

374 i(
mp_pt
->
Index
 == 0) {

375 
mp_pt
->
HdCRC
 =

376 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

377 
mp_pt
->
HdCRC
);

378 
mp_pt
->
FmeTy
 = mp_pt->
DaRegi
;

379 
mp_pt
->
Index
 = 1;

382 i(
mp_pt
->
Index
 == 1) {

383 
mp_pt
->
HdCRC
 =

384 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

385 
mp_pt
->
HdCRC
);

386 
mp_pt
->
DeiAddss
 = mp_pt->
DaRegi
;

387 
mp_pt
->
Index
 = 2;

390 i(
mp_pt
->
Index
 == 2) {

391 
mp_pt
->
HdCRC
 =

392 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

393 
mp_pt
->
HdCRC
);

394 
mp_pt
->
SourAddss
 = mp_pt->
DaRegi
;

395 
mp_pt
->
Index
 = 3;

398 i(
mp_pt
->
Index
 == 3) {

399 
mp_pt
->
HdCRC
 =

400 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

401 
mp_pt
->
HdCRC
);

402 
mp_pt
->
DaLgth
 = mp_pt->
DaRegi
 * 256;

403 
mp_pt
->
Index
 = 4;

406 i(
mp_pt
->
Index
 == 4) {

407 
mp_pt
->
HdCRC
 =

408 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

409 
mp_pt
->
HdCRC
);

410 
mp_pt
->
DaLgth
 +mp_pt->
DaRegi
;

411 
mp_pt
->
Index
 = 5;

414 i(
mp_pt
->
Index
 == 5) {

415 
mp_pt
->
HdCRC
 =

416 
	`CRC_Cc_Hd
(
mp_pt
->
DaRegi
,

417 
mp_pt
->
HdCRC
);

418 
mp_pt
->
HdCRCAu
 = mp_pt->
DaRegi
;

420 i(
mp_pt
->
HdCRC
 != 0x55) {

424 
mp_pt
->
ReivedInvidFme
 = 
ue
;

425 
tf_ive_r


427 
mp_pt
->
DaRegi
);

429 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

431 i(
mp_pt
->
DaLgth
 == 0) {

433 
	`tf_ive_da
("%s",

434 
	`mext_ame_ty
(()

435 
mp_pt
->
FmeTy
));

436 i((
mp_pt
->
DeiAddss
 ==

437 
mp_pt
->
This_Sti
)

438 || (
mp_pt
->
DeiAddss
 ==

439 
MSTP_BROADCAST_ADDRESS
)) {

442 
mp_pt
->
ReivedVidFme
 = 
ue
;

445 
mp_pt
->
ReivedVidFmeNFUs
 = 
ue
;

448 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

451 i((
mp_pt
->
DeiAddss
 ==

452 
mp_pt
->
This_Sti
)

453 || (
mp_pt
->
DeiAddss
 ==

454 
MSTP_BROADCAST_ADDRESS
)) {

455 i(
mp_pt
->
DaLgth
 <=

456 
mp_pt
->
IutBufrSize
) {

458 
mp_pt
->
ive_e
 =

459 
MSTP_RECEIVE_STATE_DATA
;

462 
tf_ive_r


464 (
mp_pt
->
DaLgth
);

465 
mp_pt
->
ive_e
 =

466 
MSTP_RECEIVE_STATE_SKIP_DATA
;

470 
mp_pt
->
ive_e
 =

471 
MSTP_RECEIVE_STATE_SKIP_DATA
;

473 
mp_pt
->
Index
 = 0;

474 
mp_pt
->
DaCRC
 = 0xFFFF;

480 
mp_pt
->
ReiveE
 = 
l
;

483 
mp_pt
->
ReivedInvidFme
 = 
ue
;

484 
	`tf_ive_r
("MSTP: Rx Data: BadIndex %u\n",

485 (
mp_pt
->
Index
);

487 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

489 
mp_pt
->
	`STimRet
((*) mstp_port);

490 
	`INCREMENT_AND_LIMIT_UINT8
(
mp_pt
->
EvtCou
);

491 
mp_pt
->
DaAvaab
 = 
l
;

495 
MSTP_RECEIVE_STATE_DATA
:

496 
MSTP_RECEIVE_STATE_SKIP_DATA
:

498 i(
mp_pt
->
	`STim
((*mp_pt> 
Tame_abt
) {

500 
mp_pt
->
ReivedInvidFme
 = 
ue
;

501 
tf_ive_r


503 (
mp_pt
->
	`STim
((*) mstp_port),

504 
Tame_abt
);

506 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

509 i(
mp_pt
->
ReiveE
 =
ue
) {

510 
mp_pt
->
ReiveE
 = 
l
;

511 
mp_pt
->
	`STimRet
((*) mstp_port);

513 
mp_pt
->
ReivedInvidFme
 = 
ue
;

514 
	`tf_ive_r
("MSTP: Rx Data: ReceiveError\n");

516 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

517 } i(
mp_pt
->
DaAvaab
 =
ue
) {

518 
	`tf_ive_da
("%02X ", 
mp_pt
->
DaRegi
);

519 i(
mp_pt
->
Index
 < mp_pt->
DaLgth
) {

521 
mp_pt
->
DaCRC
 =

522 
	`CRC_Cc_Da
(
mp_pt
->
DaRegi
,

523 
mp_pt
->
DaCRC
);

524 i(
mp_pt
->
Index
 < mp_pt->
IutBufrSize
) {

525 
mp_pt
->
IutBufr
[mp_pt->
Index
] =

526 
mp_pt
->
DaRegi
;

528 
mp_pt
->
Index
++;

529 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_DATA
;

530 } i(
mp_pt
->
Index
 =mp_pt->
DaLgth
) {

532 
mp_pt
->
DaCRC
 =

533 
	`CRC_Cc_Da
(
mp_pt
->
DaRegi
,

534 
mp_pt
->
DaCRC
);

535 
mp_pt
->
DaCRCAuMSB
 = mp_pt->
DaRegi
;

536 
mp_pt
->
Index
++;

537 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_DATA
;

538 } i(
mp_pt
->
Index
 =(mp_pt->
DaLgth
 + 1)) {

540 
mp_pt
->
DaCRC
 =

541 
	`CRC_Cc_Da
(
mp_pt
->
DaRegi
,

542 
mp_pt
->
DaCRC
);

543 
mp_pt
->
DaCRCAuLSB
 = mp_pt->
DaRegi
;

544 
	`tf_ive_da
("%s",

545 
	`mext_ame_ty
((
mp_pt
->
FmeTy
));

548 i(
mp_pt
->
DaCRC
 == 0xF0B8) {

549 i(
mp_pt
->
ive_e
 ==

550 
MSTP_RECEIVE_STATE_DATA
) {

552 
mp_pt
->
ReivedVidFme
 = 
ue
;

555 
mp_pt
->
ReivedVidFmeNFUs
 = 
ue
;

558 
mp_pt
->
ReivedInvidFme
 = 
ue
;

559 
	`tf_ive_r
("MSTP: Rx Data: BadCRC [%02X]\n",

560 
mp_pt
->
DaRegi
);

562 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

564 
mp_pt
->
ReivedInvidFme
 = 
ue
;

565 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

567 
mp_pt
->
DaAvaab
 = 
l
;

568 
mp_pt
->
	`STimRet
((*) mstp_port);

573 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

576 i((
ive_e
 !
MSTP_RECEIVE_STATE_IDLE
) &&

577 (
mp_pt
->
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
)) {

578 
	`tf_ive_da
("\n");

579 
	`fush
(
dr
);

582 
	}
}

585 
bo
 
	$MSTP_Ma_Node_FSM
(

586 vީ
mp_pt_ru_t
 * 
mp_pt
)

588 
ngth
 = 0;

589 
ut8_t
 
xt_pl_i
 = 0;

590 
ut8_t
 
xt_this_i
 = 0;

591 
ut8_t
 
xt_xt_i
 = 0;

592 
ut16_t
 
my_timeout
 = 10, 
ns_timeout
 = 0;

594 
bo
 
si_now
 = 
l
;

595 
MSTP_MASTER_STATE
 
ma_e
 = 
mp_pt
->master_state;

598 
xt_pl_i
 =

599 (
mp_pt
->
Pl_Sti
 + 1% (mp_pt->
Nmax_ma
 + 1);

600 
xt_this_i
 =

601 (
mp_pt
->
This_Sti
 + 1% (mp_pt->
Nmax_ma
 + 1);

602 
xt_xt_i
 =

603 (
mp_pt
->
Next_Sti
 + 1% (mp_pt->
Nmax_ma
 + 1);

604 
mp_pt
->
ma_e
) {

605 
MSTP_MASTER_STATE_INITIALIZE
:

608 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

609 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

612 
mp_pt
->
TokCou
 = 
Npl
;

613 
mp_pt
->
SeMa
 = 
l
;

614 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

615 
si_now
 = 
ue
;

617 
MSTP_MASTER_STATE_IDLE
:

620 i(
mp_pt
->
	`STim
((*mp_pt>
Tno_tok
) {

622 
mp_pt
->
EvtCou
 = 0;

623 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_NO_TOKEN
;

626 
mp_pt
->
ReivedInvidFme
 = 
l
;

627 
mp_pt
->
ReivedVidFme
 = 
l
;

628 
si_now
 = 
ue
;

629 } i(
mp_pt
->
ReivedInvidFme
 =
ue
) {

632 
mp_pt
->
ReivedInvidFme
 = 
l
;

633 } i(
mp_pt
->
ReivedVidFme
 =
ue
) {

635 
	`tf_ma
("MSTP: ReceivedValidFrame "

637 
mp_pt
->
SourAddss
, mp_pt->
DeiAddss
,

638 
mp_pt
->
DaLgth
, mp_pt->
FmeCou
,

639 
mp_pt
->
	`STim
((*) mstp_port),

640 
	`mext_ame_ty
((
mp_pt
->
FmeTy
));

642 i((
mp_pt
->
DeiAddss
 =mp_pt->
This_Sti
)

643 || (
mp_pt
->
DeiAddss
 ==

644 
MSTP_BROADCAST_ADDRESS
)) {

645 
mp_pt
->
FmeTy
) {

646 
FRAME_TYPE_TOKEN
:

649 i(
mp_pt
->
DeiAddss
 ==

650 
MSTP_BROADCAST_ADDRESS
) {

653 
mp_pt
->
ReivedVidFme
 = 
l
;

654 
mp_pt
->
FmeCou
 = 0;

655 
mp_pt
->
SeMa
 = 
l
;

656 
mp_pt
->
ma_e
 =

657 
MSTP_MASTER_STATE_USE_TOKEN
;

658 
si_now
 = 
ue
;

660 
FRAME_TYPE_POLL_FOR_MASTER
:

663 i(
mp_pt
->
DeiAddss
 ==

664 
mp_pt
->
This_Sti
) {

665 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

666 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
,

667 
mp_pt
->
SourAddss
,

668 
mp_pt
->
This_Sti
, 
NULL
, 0);

671 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

673 (
	`MSTP_Put_Reive
(
mp_pt
);

675 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

678 (
	`MSTP_Put_Reive
(
mp_pt
);

680 i(
mp_pt
->
DeiAddss
 !=

681 
MSTP_BROADCAST_ADDRESS
) {

682 
mp_pt
->
ma_e
 =

683 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
;

686 
FRAME_TYPE_TEST_REQUEST
:

687 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

688 
FRAME_TYPE_TEST_RESPONSE
,

689 
mp_pt
->
SourAddss
,

690 
mp_pt
->
This_Sti
,

691 
mp_pt
->
IutBufr
, mp_pt->
DaLgth
);

693 
FRAME_TYPE_TEST_RESPONSE
:

700 i(
mp_pt
->
ma_e
 !=

701 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
) {

702 
mp_pt
->
ReivedVidFme
 = 
l
;

706 
MSTP_MASTER_STATE_USE_TOKEN
:

711 
ngth
 = (
	`MSTP_G_Sd
(
mp_pt
, 0);

712 i(
ngth
 < 1) {

714 
mp_pt
->
FmeCou
 = mp_pt->
Nmax_fo_ames
;

715 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

716 
si_now
 = 
ue
;

718 
ut8_t
 
ame_ty
 = 
mp_pt
->
OuutBufr
[2];

719 
ut8_t
 
dei
 = 
mp_pt
->
OuutBufr
[3];

720 
	`RS485_Sd_Fme
(
mp_pt
,

721 (
ut8_t
 *& 
mp_pt
->
OuutBufr
[0],

722 (
ut16_t

ngth
);

723 
mp_pt
->
FmeCou
++;

724 
ame_ty
) {

725 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

726 i(
dei
 =
MSTP_BROADCAST_ADDRESS
) {

728 
mp_pt
->
ma_e
 =

729 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

732 
mp_pt
->
ma_e
 =

733 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

736 
FRAME_TYPE_TEST_REQUEST
:

738 
mp_pt
->
ma_e
 =

739 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
;

741 
FRAME_TYPE_TEST_RESPONSE
:

742 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

745 
mp_pt
->
ma_e
 =

746 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

751 
MSTP_MASTER_STATE_WAIT_FOR_REPLY
:

754 i(
mp_pt
->
	`STim
((*mp_pt>
Ty_timeout
) {

757 
mp_pt
->
FmeCou
 = mp_pt->
Nmax_fo_ames
;

758 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

763 
si_now
 = 
ue
;

765 i(
mp_pt
->
ReivedInvidFme
 =
ue
) {

768 
mp_pt
->
ReivedInvidFme
 = 
l
;

769 
mp_pt
->
ma_e
 =

770 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

771 
si_now
 = 
ue
;

772 } i(
mp_pt
->
ReivedVidFme
 =
ue
) {

773 i(
mp_pt
->
DeiAddss
 ==

774 
mp_pt
->
This_Sti
) {

775 
mp_pt
->
FmeTy
) {

776 
FRAME_TYPE_REPLY_POSTPONED
:

778 
mp_pt
->
ma_e
 =

779 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

781 
FRAME_TYPE_TEST_RESPONSE
:

782 
mp_pt
->
ma_e
 =

783 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

785 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

789 (
	`MSTP_Put_Reive
(
mp_pt
);

790 
mp_pt
->
ma_e
 =

791 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
;

796 
mp_pt
->
ma_e
 =

797 
MSTP_MASTER_STATE_IDLE
;

806 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

808 
mp_pt
->
ReivedVidFme
 = 
l
;

809 
si_now
 = 
ue
;

813 
MSTP_MASTER_STATE_DONE_WITH_TOKEN
:

817 i(
mp_pt
->
FmeCou
 < mp_pt->
Nmax_fo_ames
) {

820 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

821 
si_now
 = 
ue
;

822 } i((
mp_pt
->
SeMa
 =
l
) &&

823 (
mp_pt
->
Next_Sti
 =mp_pt->
This_Sti
)) {

827 
mp_pt
->
Pl_Sti
 = 
xt_this_i
;

828 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

829 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

830 
mp_pt
->
This_Sti
, 
NULL
, 0);

831 
mp_pt
->
RryCou
 = 0;

832 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

833 } i(
mp_pt
->
TokCou
 < (
Npl
 - 1)) {

835 i((
mp_pt
->
SeMa
 =
ue
) &&

836 (
mp_pt
->
Next_Sti
 !
xt_this_i
)) {

840 
mp_pt
->
FmeCou
 = 0;

841 
mp_pt
->
TokCou
++;

842 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

843 
si_now
 = 
ue
;

850 
mp_pt
->
TokCou
++;

852 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

853 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

855 
mp_pt
->
RryCou
 = 0;

856 
mp_pt
->
EvtCou
 = 0;

857 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

859 } i(
xt_pl_i
 =
mp_pt
->
Next_Sti
) {

860 i(
mp_pt
->
SeMa
 =
ue
) {

862 
mp_pt
->
Pl_Sti
 = 
xt_xt_i
;

863 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

864 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

865 
mp_pt
->
This_Sti
, 
NULL
, 0);

867 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

868 
mp_pt
->
RryCou
 = 0;

870 
mp_pt
->
TokCou
 = 1;

873 
mp_pt
->
ma_e
 =

874 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

877 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

879 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

880 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

882 
mp_pt
->
RryCou
 = 0;

884 
mp_pt
->
TokCou
 = 1;

885 
mp_pt
->
EvtCou
 = 0;

886 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

890 
mp_pt
->
Pl_Sti
 = 
xt_pl_i
;

891 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

892 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

893 
mp_pt
->
This_Sti
, 
NULL
, 0);

894 
mp_pt
->
RryCou
 = 0;

895 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

898 
MSTP_MASTER_STATE_PASS_TOKEN
:

901 i(
mp_pt
->
	`STim
((*mp_pt<
Tuge_timeout
) {

902 i(
mp_pt
->
EvtCou
 > 
Nm_os
) {

906 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

907 
si_now
 = 
ue
;

910 i(
mp_pt
->
RryCou
 < 
Ny_tok
) {

912 
mp_pt
->
RryCou
++;

914 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

915 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

917 
mp_pt
->
EvtCou
 = 0;

924 
mp_pt
->
Pl_Sti
 = 
xt_xt_i
;

926 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

927 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

928 
mp_pt
->
This_Sti
, 
NULL
, 0);

930 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

931 
mp_pt
->
RryCou
 = 0;

932 
mp_pt
->
TokCou
 = 0;

935 
mp_pt
->
ma_e
 =

936 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

940 
MSTP_MASTER_STATE_NO_TOKEN
:

945 
my_timeout
 = 
Tno_tok
 + (
T
 * 
mp_pt
->
This_Sti
);

946 i(
mp_pt
->
	`STim
((*mp_pt< 
my_timeout
) {

947 i(
mp_pt
->
EvtCou
 > 
Nm_os
) {

951 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

952 
si_now
 = 
ue
;

955 
ns_timeout
 =

956 
Tno_tok
 + (
T
 * (
mp_pt
->
This_Sti
 + 1));

957 i(
mp_pt
->
	`STim
((*mp_pt< 
ns_timeout
) {

961 
mp_pt
->
Pl_Sti
 = 
xt_this_i
;

963 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

964 
FRAME_TYPE_POLL_FOR_MASTER
, 
mp_pt
->
Pl_Sti
,

965 
mp_pt
->
This_Sti
, 
NULL
, 0);

967 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

968 
mp_pt
->
RryCou
 = 0;

969 
mp_pt
->
TokCou
 = 0;

974 
mp_pt
->
ma_e
 =

975 
MSTP_MASTER_STATE_POLL_FOR_MASTER
;

980 i(
mp_pt
->
EvtCou
 > 
Nm_os
) {

985 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

986 
si_now
 = 
ue
;

991 
MSTP_MASTER_STATE_POLL_FOR_MASTER
:

995 i(
mp_pt
->
ReivedVidFme
 =
ue
) {

996 i((
mp_pt
->
DeiAddss
 =mp_pt->
This_Sti
)

997 && (
mp_pt
->
FmeTy
 ==

998 
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
)) {

1000 
mp_pt
->
SeMa
 = 
l
;

1001 
mp_pt
->
Next_Sti
 = mp_pt->
SourAddss
;

1002 
mp_pt
->
EvtCou
 = 0;

1004 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

1005 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
, 
NULL
,

1007 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

1008 
mp_pt
->
TokCou
 = 0;

1009 
mp_pt
->
RryCou
 = 0;

1010 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1017 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1018 
si_now
 = 
ue
;

1020 
mp_pt
->
ReivedVidFme
 = 
l
;

1021 } i((
mp_pt
->
	`STim
((*) mstp_port) >

1022 
Tuge_timeout
) ||

1023 (
mp_pt
->
ReivedInvidFme
 =
ue
)) {

1024 i(
mp_pt
->
SeMa
 =
ue
) {

1028 
mp_pt
->
FmeCou
 = 0;

1030 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_USE_TOKEN
;

1031 
si_now
 = 
ue
;

1033 i(
mp_pt
->
Next_Sti
 !mp_pt->
This_Sti
) {

1037 
mp_pt
->
EvtCou
 = 0;

1039 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TOKEN
,

1040 
mp_pt
->
Next_Sti
, mp_pt->
This_Sti
,

1041 
NULL
, 0);

1042 
mp_pt
->
RryCou
 = 0;

1043 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_PASS_TOKEN
;

1045 i(
xt_pl_i
 !
mp_pt
->
This_Sti
) {

1047 
mp_pt
->
Pl_Sti
 = 
xt_pl_i
;

1049 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1050 
FRAME_TYPE_POLL_FOR_MASTER
,

1051 
mp_pt
->
Pl_Sti
,

1052 
mp_pt
->
This_Sti
, 
NULL
, 0);

1053 
mp_pt
->
RryCou
 = 0;

1058 
mp_pt
->
SeMa
 = 
ue
;

1059 
mp_pt
->
FmeCou
 = 0;

1060 
mp_pt
->
ma_e
 =

1061 
MSTP_MASTER_STATE_USE_TOKEN
;

1062 
si_now
 = 
ue
;

1066 
mp_pt
->
ReivedInvidFme
 = 
l
;

1069 
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
:

1076 
ngth
 = (
	`MSTP_G_Rly
(
mp_pt
, 0);

1077 i(
ngth
 > 0) {

1085 
	`RS485_Sd_Fme
(
mp_pt
,

1086 (
ut8_t
 *& 
mp_pt
->
OuutBufr
[0],

1087 (
ut16_t

ngth
);

1088 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1090 
mp_pt
->
ReivedVidFme
 = 
l
;

1091 } i(
mp_pt
->
	`STim
((*) mstp_port) >

1092 
Ty_day
) {

1102 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
,

1103 
FRAME_TYPE_REPLY_POSTPONED
, 
mp_pt
->
SourAddss
,

1104 
mp_pt
->
This_Sti
, 
NULL
, 0);

1105 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1107 
mp_pt
->
ReivedVidFme
 = 
l
;

1111 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1114 i(
mp_pt
->
ma_e
 != master_state) {

1116 
tf_ma


1118 
mp_pt
->
This_Sti
, 
xt_this_i
,

1119 
mp_pt
->
Next_Sti
, 
xt_xt_i
,

1120 
mp_pt
->
Pl_Sti
, 
xt_pl_i
, mp_pt->
EvtCou
,

1121 
mp_pt
->
TokCou
, mp_pt->
	`STim
((*) mstp_port),

1122 
	`mext_ma_e
(
mp_pt
->
ma_e
));

1125  
si_now
;

1126 
	}
}

1128 
	$MSTP_Sve_Node_FSM
(

1129 vީ
mp_pt_ru_t
 *
mp_pt
)

1131 
ngth
 = 0;

1133 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_IDLE
;

1134 i(
mp_pt
->
ReivedInvidFme
 =
ue
) {

1137 
mp_pt
->
ReivedInvidFme
 = 
l
;

1138 } i(
mp_pt
->
ReivedVidFme
) {

1139 
mp_pt
->
FmeTy
) {

1140 
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
:

1141 i(
mp_pt
->
DeiAddss
 !
MSTP_BROADCAST_ADDRESS
) {

1145 
ngth
 = (
	`MSTP_G_Rly
(
mp_pt
, 0);

1146 i(
ngth
 > 0) {

1154 
	`RS485_Sd_Fme
(
mp_pt
,

1155 (
ut8_t
 *& 
mp_pt
->
OuutBufr
[0],

1156 (
ut16_t

ngth
);

1158 
mp_pt
->
ReivedVidFme
 = 
l
;

1159 } i(
mp_pt
->
	`STim
((*) mstp_port) >

1160 
Ty_day
) {

1166 
mp_pt
->
ReivedVidFme
 = 
l
;

1169 
mp_pt
->
ReivedVidFme
 = 
l
;

1172 
FRAME_TYPE_TEST_REQUEST
:

1173 
mp_pt
->
ReivedVidFme
 = 
l
;

1174 
	`MSTP_Ce_And_Sd_Fme
(
mp_pt
, 
FRAME_TYPE_TEST_RESPONSE
,

1175 
mp_pt
->
SourAddss
, mp_pt->
This_Sti
,

1176 &
mp_pt
->
IutBufr
[0], mp_pt->
DaLgth
);

1178 
FRAME_TYPE_TOKEN
:

1179 
FRAME_TYPE_POLL_FOR_MASTER
:

1180 
FRAME_TYPE_TEST_RESPONSE
:

1181 
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
:

1183 
mp_pt
->
ReivedVidFme
 = 
l
;

1187 
	}
}

1195 
	$MSTP_In
(

1196 vީ
mp_pt_ru_t
 *
mp_pt
)

1198 i(
mp_pt
) {

1202 
mp_pt
->
IutBufr
 = &InputBuffer[0];

1203 
mp_pt
->
IutBufrSize
 = (
IutBufr
);

1204 
mp_pt
->
OuutBufr
 = &OutputBuffer[0];

1205 
mp_pt
->
OuutBufrSize
 = (
OuutBufr
);

1207 
mp_pt
->
Nmax_fo_ames
 = 
DEFAULT_MAX_INFO_FRAMES
;

1208 
mp_pt
->
Nmax_ma
 = 
DEFAULT_MAX_MASTER
;

1210 
mp_pt
->
STim
 = 
Tim_S
;

1211 
mp_pt
 = >
STimRet
 = 
Tim_S_Ret
;

1213 
mp_pt
->
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

1214 
mp_pt
->
ma_e
 = 
MSTP_MASTER_STATE_INITIALIZE
;

1215 
mp_pt
->
ReiveE
 = 
l
;

1216 
mp_pt
->
DaAvaab
 = 
l
;

1217 
mp_pt
->
DaRegi
 = 0;

1218 
mp_pt
->
DaCRC
 = 0;

1219 
mp_pt
->
DaLgth
 = 0;

1220 
mp_pt
->
DeiAddss
 = 0;

1221 
mp_pt
->
EvtCou
 = 0;

1222 
mp_pt
->
FmeTy
 = 
FRAME_TYPE_TOKEN
;

1223 
mp_pt
->
FmeCou
 = 0;

1224 
mp_pt
->
HdCRC
 = 0;

1225 
mp_pt
->
Index
 = 0;

1226 
mp_pt
->
Next_Sti
 = mp_pt->
This_Sti
;

1227 
mp_pt
->
Pl_Sti
 = mp_pt->
This_Sti
;

1228 
mp_pt
->
ReivedInvidFme
 = 
l
;

1229 
mp_pt
->
ReivedVidFme
 = 
l
;

1230 
mp_pt
->
ReivedVidFmeNFUs
 = 
l
;

1231 
mp_pt
->
RryCou
 = 0;

1232 
mp_pt
->
	`STimRet
((*) mstp_port);

1233 
mp_pt
->
SeMa
 = 
l
;

1234 
mp_pt
->
SourAddss
 = 0;

1235 
mp_pt
->
TokCou
 = 0;

1237 
	}
}

1239 #ifde
TEST


1240 
	~<as.h
>

1241 
	~<rg.h
>

1242 
	~"rgbuf.h
"

1243 
	~"e.h
"

1245 
ut8_t
 
	gRxBufr
[
MAX_MPDU
];

1246 
ut8_t
 
	gTxBufr
[
MAX_MPDU
];

1248 
	$RS485_Sd_Fme
(

1249 vީ
mp_pt_ru_t
 *
mp_pt
,

1250 
ut8_t
 * 
bufr
,

1251 
ut16_t
 
nbys
)

1253 (
mp_pt
;

1254 (
bufr
;

1255 (
nbys
;

1256 
	}
}

1258 
	#RING_BUFFER_DATA_SIZE
 1

	)

1259 
	#RING_BUFFER_SIZE
 
MAX_MPDU


	)

1260 
RING_BUFFER
 
	gTe_Bufr
;

1261 
ut8_t
 
	gTe_Bufr_Da
[
RING_BUFFER_DATA_SIZE
 * 
RING_BUFFER_SIZE
];

1262 
	$Ld_Iut_Bufr
(

1263 
ut8_t
 * 
bufr
,

1264 
size_t
 
n
)

1266 
bo
 
lized
 = 
l
;

1267 i(!
lized
) {

1268 
lized
 = 
ue
;

1269 
	`Rgbuf_In
(&
Te_Bufr
, (*
Te_Bufr_Da
,

1270 
RING_BUFFER_DATA_SIZE
, 
RING_BUFFER_SIZE
);

1273 !
	`Rgbuf_Emy
(&
Te_Bufr
)) {

1274 (
	`Rgbuf_P
(&
Te_Bufr
, 
NULL
);

1277 i(
bufr
) {

1278 
n
) {

1279 (
	`Rgbuf_Put
(&
Te_Bufr
, (*
bufr
);

1280 
n
--;

1281 
bufr
++;

1284 
	}
}

1286 
	$RS485_Check_UART_Da
(

1287 vީ
mp_pt_ru_t
 *
mp_pt
)

1289 *
da
;

1290 i(!
	`Rgbuf_Emy
(&
Te_Bufr
&& 
mp_pt
 &&

1291 (
mp_pt
->
DaAvaab
 =
l
)) {

1292 
da
 = 
	`Rgbuf_Pk
(&
Te_Bufr
);

1293 i(
da
) {

1294 
mp_pt
->
DaRegi
 = *
da
;

1295 
mp_pt
->
DaAvaab
 = 
ue
;

1297 (
	`Rgbuf_P
(&
Te_Bufr
, 
NULL
);

1299 
	}
}

1301 
ut16_t
 
	$MSTP_Put_Reive
(

1302 vީ
mp_pt_ru_t
 *
mp_pt
)

1304  
mp_pt
->
DaLgth
;

1305 
	}
}

1309 
ut16_t
 
	$MSTP_G_Sd
(

1310 vީ
mp_pt_ru_t
 * 
mp_pt
,

1311 
timeout
)

1314 
	}
}

1316 
ut16_t
 
	$MSTP_G_Rly
(

1317 vީ
mp_pt_ru_t
 * 
mp_pt
,

1318 
timeout
)

1321 
	}
}

1323 
ut16_t
 
	gSTime
 = 0;

1324 
ut16_t
 
	$Tim_S
(

1327  
STime
;

1328 
	}
}

1330 
	$Tim_S_Ret
(

1333 
STime
 = 0;

1334 
	}
}

1336 
	$ReiveNodeFSM
(

1337 
Te
 * 
pTe
)

1339 vީ
mp_pt_ru_t
 
mp_pt
;

1340 
EvtCou
 = 0;

1341 
ut8_t
 
my_mac
 = 0x05;

1342 
ut8_t
 
HdCRC
 = 0;

1343 
ut8_t
 
FmeTy
 = 0;

1344 
n
;

1345 
size_t
 
i
;

1346 
ut8_t
 
bufr
[
MAX_MPDU
] = {

1349 
ut8_t
 
da
[
MAX_PDU
] = {

1352 
mp_pt
.
IutBufr
 = &
RxBufr
[0];

1353 
mp_pt
.
IutBufrSize
 = (
RxBufr
);

1354 
mp_pt
.
OuutBufr
 = &
TxBufr
[0];

1355 
mp_pt
.
OuutBufrSize
 = (
TxBufr
);

1356 
mp_pt
.
STim
 = 
Tim_S
;

1357 
mp_pt
.
STimRet
 = 
Tim_S_Ret
;

1358 
mp_pt
.
This_Sti
 = 
my_mac
;

1359 
mp_pt
.
Nmax_fo_ames
 = 1;

1360 
mp_pt
.
Nmax_ma
 = 127;

1361 
	`MSTP_In
(&
mp_pt
);

1363 
mp_pt
.
ive_e
 = 
MSTP_RECEIVE_STATE_IDLE
;

1364 
mp_pt
.
ReiveE
 = 
ue
;

1365 
STime
 = 255;

1366 
mp_pt
.
EvtCou
 = 0;

1367 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1368 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1369 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1370 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1371 
	`_
(
pTe
, 
mp_pt
.
ReiveE
 =
l
);

1372 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1374 
mp_pt
.
DaAvaab
 = 
ue
;

1375 
mp_pt
.
DaRegi
 = 0x11;

1376 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1377 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1378 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1379 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1380 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1381 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1383 
mp_pt
.
DaAvaab
 = 
ue
;

1384 
mp_pt
.
DaRegi
 = 0x55;

1385 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1386 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1387 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1388 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1389 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1390 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1392 
STime
 = 
Tame_abt
 + 1;

1393 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1394 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1396 
mp_pt
.
DaAvaab
 = 
ue
;

1397 
mp_pt
.
DaRegi
 = 0x55;

1398 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1399 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1400 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1401 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1402 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1403 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1405 
mp_pt
.
ReiveE
 = 
ue
;

1406 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1407 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1408 
	`_
(
pTe
, 
mp_pt
.
ReiveE
 =
l
);

1409 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1410 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1411 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1413 
mp_pt
.
DaAvaab
 = 
ue
;

1414 
mp_pt
.
DaRegi
 = 0x55;

1415 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1416 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1417 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1418 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1419 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1420 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1421 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1423 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1424 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1425 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1426 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1428 
mp_pt
.
DaAvaab
 = 
ue
;

1429 
mp_pt
.
DaRegi
 = 0x55;

1430 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1431 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1432 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1433 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1434 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1435 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1437 
mp_pt
.
DaAvaab
 = 
ue
;

1438 
mp_pt
.
DaRegi
 = 0x55;

1439 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1440 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1441 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1442 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1443 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1444 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1446 
mp_pt
.
DaAvaab
 = 
ue
;

1447 
mp_pt
.
DaRegi
 = 0x11;

1448 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1449 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1450 
	`_
(
pTe
, 
mp_pt
.
ReiveE
 =
l
);

1451 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1452 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1453 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1455 
mp_pt
.
DaAvaab
 = 
ue
;

1456 
mp_pt
.
DaRegi
 = 0x55;

1457 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1458 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1459 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1460 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1461 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1462 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1463 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1465 
mp_pt
.
DaAvaab
 = 
ue
;

1466 
mp_pt
.
DaRegi
 = 0xFF;

1467 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1468 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1469 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1470 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1471 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1472 
	`_
(
pTe
, 
mp_pt
.
Index
 == 0);

1473 
	`_
(
pTe
, 
mp_pt
.
HdCRC
 == 0xFF);

1474 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1476 
STime
 = 
Tame_abt
 + 1;

1477 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1478 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1479 
	`_
(
pTe
, 
mp_pt
.
ReivedInvidFme
 =
ue
);

1481 
mp_pt
.
DaAvaab
 = 
ue
;

1482 
mp_pt
.
DaRegi
 = 0x55;

1483 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1484 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1485 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1486 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1487 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1488 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1489 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1491 
mp_pt
.
DaAvaab
 = 
ue
;

1492 
mp_pt
.
DaRegi
 = 0xFF;

1493 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1494 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1495 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1496 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1497 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1498 
	`_
(
pTe
, 
mp_pt
.
Index
 == 0);

1499 
	`_
(
pTe
, 
mp_pt
.
HdCRC
 == 0xFF);

1500 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1502 
mp_pt
.
ReiveE
 = 
ue
;

1503 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1504 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1505 
	`_
(
pTe
, 
mp_pt
.
ReiveE
 =
l
);

1506 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1507 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1508 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1510 
mp_pt
.
DaAvaab
 = 
ue
;

1511 
mp_pt
.
DaRegi
 = 0x55;

1512 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1513 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1514 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1515 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1516 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1517 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_PREAMBLE
);

1518 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1520 
mp_pt
.
DaAvaab
 = 
ue
;

1521 
mp_pt
.
DaRegi
 = 0xFF;

1522 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1523 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1524 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1525 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1526 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1527 
	`_
(
pTe
, 
mp_pt
.
Index
 == 0);

1528 
	`_
(
pTe
, 
mp_pt
.
HdCRC
 == 0xFF);

1529 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1531 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1532 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1533 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1534 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1537 
mp_pt
.
DaAvaab
 = 
ue
;

1538 
mp_pt
.
DaRegi
 = 
FRAME_TYPE_TOKEN
;

1539 
HdCRC
 = 0xFF;

1540 
HdCRC
 = 
	`CRC_Cc_Hd
(
mp_pt
.
DaRegi
, HeaderCRC);

1541 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1542 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1543 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1544 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1545 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1546 
	`_
(
pTe
, 
mp_pt
.
Index
 == 1);

1547 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1548 
	`_
(
pTe
, 
FmeTy
 =
FRAME_TYPE_TOKEN
);

1550 
mp_pt
.
DaAvaab
 = 
ue
;

1551 
mp_pt
.
DaRegi
 = 0x10;

1552 
HdCRC
 = 
	`CRC_Cc_Hd
(
mp_pt
.
DaRegi
, HeaderCRC);

1553 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1554 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1555 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1556 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1557 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1558 
	`_
(
pTe
, 
mp_pt
.
Index
 == 2);

1559 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1560 
	`_
(
pTe
, 
mp_pt
.
DeiAddss
 == 0x10);

1562 
mp_pt
.
DaAvaab
 = 
ue
;

1563 
mp_pt
.
DaRegi
 = 
my_mac
;

1564 
HdCRC
 = 
	`CRC_Cc_Hd
(
mp_pt
.
DaRegi
, HeaderCRC);

1565 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1566 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1567 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1568 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1569 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1570 
	`_
(
pTe
, 
mp_pt
.
Index
 == 3);

1571 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1572 
	`_
(
pTe
, 
mp_pt
.
SourAddss
 =
my_mac
);

1574 
mp_pt
.
DaAvaab
 = 
ue
;

1575 
mp_pt
.
DaRegi
 = 0;

1576 
HdCRC
 = 
	`CRC_Cc_Hd
(
mp_pt
.
DaRegi
, HeaderCRC);

1577 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1578 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1579 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1580 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1581 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1582 
	`_
(
pTe
, 
mp_pt
.
Index
 == 4);

1583 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1584 
	`_
(
pTe
, 
mp_pt
.
DaLgth
 == 0);

1586 
mp_pt
.
DaAvaab
 = 
ue
;

1587 
mp_pt
.
DaRegi
 = 0;

1588 
HdCRC
 = 
	`CRC_Cc_Hd
(
mp_pt
.
DaRegi
, HeaderCRC);

1589 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1590 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1591 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1592 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1593 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1594 
	`_
(
pTe
, 
mp_pt
.
Index
 == 5);

1595 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_HEADER
);

1596 
	`_
(
pTe
, 
mp_pt
.
DaLgth
 == 0);

1598 
mp_pt
.
DaAvaab
 = 
ue
;

1599 
	`_
(
pTe
, 
HdCRC
 == 0x73);

1600 
mp_pt
.
DaRegi
 = ~
HdCRC
;

1601 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1602 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1603 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1604 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1605 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1606 
	`_
(
pTe
, 
mp_pt
.
Index
 == 5);

1607 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1608 
	`_
(
pTe
, 
mp_pt
.
HdCRC
 == 0x55);

1610 
mp_pt
.
ReivedInvidFme
 = 
l
;

1611 
mp_pt
.
ReivedVidFme
 = 
l
;

1612 
n
 = 
	`MSTP_Ce_Fme
(
bufr
, (bufr), 
FRAME_TYPE_TOKEN
, 0x10,

1613 
my_mac
,

1614 
NULL
,

1616 
	`_
(
pTe
, 
n
 > 0);

1618 
bufr
[7] = 0x00;

1619 
	`Ld_Iut_Bufr
(
bufr
, 
n
);

1620 
i
 = 0; i < 
n
; i++) {

1621 
	`RS485_Check_UART_Da
(&
mp_pt
);

1622 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1623 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1624 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1625 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1626 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1628 
	`_
(
pTe
, 
mp_pt
.
ReivedInvidFme
 =
ue
);

1629 
	`_
(
pTe
, 
mp_pt
.
ReivedVidFme
 =
l
);

1630 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1632 
mp_pt
.
ReivedInvidFme
 = 
l
;

1633 
mp_pt
.
ReivedVidFme
 = 
l
;

1634 
n
 = 
	`MSTP_Ce_Fme
(
bufr
, (bufr), 
FRAME_TYPE_TOKEN
, 
my_mac
,

1635 
my_mac
,

1636 
NULL
,

1638 
	`_
(
pTe
, 
n
 > 0);

1639 
	`Ld_Iut_Bufr
(
bufr
, 
n
);

1640 
i
 = 0; i < 
n
; i++) {

1641 
	`RS485_Check_UART_Da
(&
mp_pt
);

1642 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1643 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1644 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1645 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1646 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1648 
	`_
(
pTe
, 
mp_pt
.
ReivedInvidFme
 =
l
);

1649 
	`_
(
pTe
, 
mp_pt
.
ReivedVidFme
 =
ue
);

1650 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1652 
mp_pt
.
ReivedInvidFme
 = 
l
;

1653 
mp_pt
.
ReivedVidFme
 = 
l
;

1654 
n
 = 
	`MSTP_Ce_Fme
(
bufr
, (bufr), 
FRAME_TYPE_TOKEN
, 
my_mac
,

1655 
my_mac
,

1656 
NULL
,

1658 
	`_
(
pTe
, 
n
 > 0);

1660 
bufr
[5] = 0x02;

1661 
	`Ld_Iut_Bufr
(
bufr
, 
n
);

1662 
i
 = 0; i < 
n
; i++) {

1663 
	`RS485_Check_UART_Da
(&
mp_pt
);

1664 
	`INCREMENT_AND_LIMIT_UINT8
(
EvtCou
);

1665 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1666 
	`_
(
pTe
, 
mp_pt
.
DaAvaab
 =
l
);

1667 
	`_
(
pTe
, 
mp_pt
.
	`STim
() == 0);

1668 
	`_
(
pTe
, 
mp_pt
.
EvtCou
 == EventCount);

1670 
	`_
(
pTe
, 
mp_pt
.
ReivedInvidFme
 =
ue
);

1671 
	`_
(
pTe
, 
mp_pt
.
ReivedVidFme
 =
l
);

1672 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1674 
mp_pt
.
ReivedInvidFme
 = 
l
;

1675 
mp_pt
.
ReivedVidFme
 = 
l
;

1676 
	`memt
(
da
, 0, (data));

1677 
n
 =

1678 
	`MSTP_Ce_Fme
(
bufr
, (bufr), 
FRAME_TYPE_PROPRIETARY_MIN
,

1679 
my_mac
, my_mac, 
da
, (data));

1680 
	`_
(
pTe
, 
n
 > 0);

1681 
	`Ld_Iut_Bufr
(
bufr
, 
n
);

1682 
	`RS485_Check_UART_Da
(&
mp_pt
);

1683 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1684 
mp_pt
.
ive_e
 !
MSTP_RECEIVE_STATE_IDLE
) {

1685 
	`RS485_Check_UART_Da
(&
mp_pt
);

1686 
	`MSTP_Reive_Fme_FSM
(&
mp_pt
);

1688 
	`_
(
pTe
, 
mp_pt
.
DaLgth
 =(
da
));

1689 
	`_
(
pTe
, 
mp_pt
.
ReivedInvidFme
 =
l
);

1690 
	`_
(
pTe
, 
mp_pt
.
ReivedVidFme
 =
ue
);

1691 
	`_
(
pTe
, 
mp_pt
.
ive_e
 =
MSTP_RECEIVE_STATE_IDLE
);

1693 
	}
}

1695 
	$MaNodeFSM
(

1696 
Te
 * 
pTe
)

1698 vީ
mp_pt_ru_t
 
MSTP_Pt
;

1699 
ut8_t
 
my_mac
 = 0x05;

1700 
MSTP_Pt
.
IutBufr
 = &
RxBufr
[0];

1701 
MSTP_Pt
.
IutBufrSize
 = (
RxBufr
);

1702 
MSTP_Pt
.
OuutBufr
 = &
TxBufr
[0];

1703 
MSTP_Pt
.
OuutBufrSize
 = (
TxBufr
);

1704 
MSTP_Pt
.
This_Sti
 = 
my_mac
;

1705 
MSTP_Pt
.
Nmax_fo_ames
 = 1;

1706 
MSTP_Pt
.
Nmax_ma
 = 127;

1707 
MSTP_Pt
.
STim
 = 
Tim_S
;

1708 
MSTP_Pt
.
STimRet
 = 
Tim_S_Ret
;

1709 
	`MSTP_In
(&
MSTP_Pt
);

1710 
	`_
(
pTe
, 
MSTP_Pt
.
ma_e
 =
MSTP_MASTER_STATE_INITIALIZE
);

1712 
	}
}

1716 #ifde
TEST_MSTP


1717 
	$ma
(

1720 
Te
 *
pTe
;

1721 
bo
 
rc
;

1722 
pTe
 = 
	`_
("mp", 
NULL
);

1724 
rc
 = 
	`_addTeFuni
(
pTe
, 
ReiveNodeFSM
);

1725 
	`as
(
rc
);

1726 
rc
 = 
	`_addTeFuni
(
pTe
, 
MaNodeFSM
);

1727 
	`as
(
rc
);

1728 
	`_tSm
(
pTe
, 
dout
);

1729 
	`_run
(
pTe
);

1730 (
	`_pt
(
pTe
);

1731 
	`_deroy
(
pTe
);

1733 
	}
}

	@src/mstptext.c

34 
	~<dio.h
>

35 
	~"mp.h
"

36 
	~"dxt.h
"

37 
	~"banum.h
"

38 
	~"mext.h
"

42 
INDTEXT_DATA
 
	gmp_ive_e_xt
[] = {

43 {
MSTP_RECEIVE_STATE_IDLE
, "IDLE"},

44 {
MSTP_RECEIVE_STATE_PREAMBLE
, "PREAMBLE"},

45 {
MSTP_RECEIVE_STATE_HEADER
, "HEADER"},

46 {
MSTP_RECEIVE_STATE_DATA
, "DATA"},

47 {0, 
NULL
}

50 cڡ *
	$mext_ive_e
(

51 
dex
)

53  
	`dxt_by_dex_deu
(
mp_ive_e_xt
, 
dex
, "unknown");

54 
	}
}

56 
INDTEXT_DATA
 
	gmp_ma_e_xt
[] = {

57 {
MSTP_MASTER_STATE_INITIALIZE
, "INITIALIZE"},

58 {
MSTP_MASTER_STATE_IDLE
, "IDLE"},

59 {
MSTP_MASTER_STATE_USE_TOKEN
, "USE_TOKEN"},

60 {
MSTP_MASTER_STATE_WAIT_FOR_REPLY
, "WAIT_FOR_REPLY"},

61 {
MSTP_MASTER_STATE_DONE_WITH_TOKEN
, "DONE_WITH_TOKEN"},

62 {
MSTP_MASTER_STATE_PASS_TOKEN
, "PASS_TOKEN"},

63 {
MSTP_MASTER_STATE_NO_TOKEN
, "NO_TOKEN"},

64 {
MSTP_MASTER_STATE_POLL_FOR_MASTER
, "POLL_FOR_MASTER"},

65 {
MSTP_MASTER_STATE_ANSWER_DATA_REQUEST
, "ANSWER_DATA_REQUEST"},

66 {0, 
NULL
}

69 cڡ *
	$mext_ma_e
(

70 
dex
)

72  
	`dxt_by_dex_deu
(
mp_ma_e_xt
, 
dex
, "unknown");

73 
	}
}

75 
INDTEXT_DATA
 
	gmp_ame_ty_xt
[] = {

76 {
FRAME_TYPE_TOKEN
, "TOKEN"},

77 {
FRAME_TYPE_POLL_FOR_MASTER
, "POLL_FOR_MASTER"},

78 {
FRAME_TYPE_REPLY_TO_POLL_FOR_MASTER
, "REPLY_TO_POLL_FOR_MASTER"},

79 {
FRAME_TYPE_TEST_REQUEST
, "TEST_REQUEST"},

80 {
FRAME_TYPE_TEST_RESPONSE
, "TEST_RESPONSE"},

81 {
FRAME_TYPE_BACNET_DATA_EXPECTING_REPLY
, "BACNET_DATA_EXPECTING_REPLY"},

82 {
FRAME_TYPE_BACNET_DATA_NOT_EXPECTING_REPLY
,

84 {
FRAME_TYPE_REPLY_POSTPONED
, "REPLY_POSTPONED"},

85 {0, 
NULL
}

88 cڡ *
	$mext_ame_ty
(

89 
dex
)

91  
	`dxt_by_dex_l_deu
(
mp_ame_ty_xt
, 
dex
,

92 
FRAME_TYPE_PROPRIETARY_MIN
, "UNKNOWN", "PROPRIETARY");

93 
	}
}

	@src/npdu.c

34 
	~<dbo.h
>

35 
	~<dt.h
>

36 
	~"bacdef.h
"

37 
	~"bacdcode.h
"

38 
	~"bact.h
"

39 
	~"banum.h
"

40 
	~"bs.h
"

41 
	~"du.h
"

42 
	~"du.h
"

50 
	$du_cy_da
(

51 
BACNET_NPDU_DATA
 * 
de
,

52 
BACNET_NPDU_DATA
 * 
c
)

54 i(
de
 && 
c
) {

55 
de
->
oc_vsi
 = 
c
->protocol_version;

56 
de
->
da_exg_y
 = 
c
->data_expecting_reply;

57 
de
->
twk_y_mesge
 = 
c
->network_layer_message;

58 
de
->
iܙy
 = 
c
->priority;

59 
de
->
twk_mesge_ty
 = 
c
->network_message_type;

60 
de
->
vd_id
 = 
c
->vendor_id;

61 
de
->
h_cou
 = 
c
->hop_count;

65 
	}
}

132 
	$du_code_pdu
(

133 
ut8_t
 * 
du
,

134 
BACNET_ADDRESS
 * 
de
,

135 
BACNET_ADDRESS
 * 
c
,

136 
BACNET_NPDU_DATA
 * 
du_da
)

138 
n
 = 0;

139 
ut8_t
 
i
 = 0;

142 i(
du
 && 
du_da
) {

144 
du
[0] = 
du_da
->
oc_vsi
;

146 
du
[1] = 0;

151 i(
du_da
->
twk_y_mesge
)

152 
du
[1] |
BIT7
;

159 i(
de
 && de->
t
)

160 
du
[1] |
BIT5
;

167 i(
c
 && src->
t
 && src->
n
)

168 
du
[1] |
BIT3
;

177 i(
du_da
->
da_exg_y
)

178 
du
[1] |
BIT2
;

184 
du
[1] |(
du_da
->
iܙy
 & 0x03);

185 
n
 = 2;

186 i(
de
 && de->
t
) {

187 
n
 +
	`code_unsigd16
(&
du
[n], 
de
->
t
);

188 
du
[
n
++] = 
de
->len;

191 i(
de
->
n
) {

192 
i
 = 0; i < 
de
->
n
; i++) {

193 
du
[
n
++] = 
de
->
adr
[
i
];

197 i(
c
 && src->
t
 && src->
n
) {

198 
n
 +
	`code_unsigd16
(&
du
[n], 
c
->
t
);

199 
du
[
n
++] = 
c
->len;

202 i(
c
->
n
) {

203 
i
 = 0; i < 
c
->
n
; i++) {

204 
du
[
n
++] = 
c
->
adr
[
i
];

211 i(
de
 && de->
t
) {

212 
du
[
n
] = 
du_da
->
h_cou
;

213 
n
++;

215 i(
du_da
->
twk_y_mesge
) {

216 
du
[
n
] = 
du_da
->
twk_mesge_ty
;

217 
n
++;

220 i(
du_da
->
twk_mesge_ty
 >= 0x80)

221 
n
 +
	`code_unsigd16
(&
du
[n], 
du_da
->
vd_id
);

225  
n
;

226 
	}
}

272 
	$du_code_du_da
(

273 
BACNET_NPDU_DATA
 * 
du_da
,

274 
bo
 
da_exg_y
,

275 
BACNET_MESSAGE_PRIORITY
 
iܙy
)

277 i(
du_da
) {

278 
du_da
->
da_exg_y
 = data_expecting_reply;

279 
du_da
->
oc_vsi
 = 
BACNET_PROTOCOL_VERSION
;

280 
du_da
->
twk_y_mesge
 = 
l
;

281 
du_da
->
twk_mesge_ty
 = 
NETWORK_MESSAGE_INVALID
;

282 
du_da
->
vd_id
 = 0;

283 
du_da
->
iܙy
 =riority;

284 
du_da
->
h_cou
 = 
HOP_COUNT_DEFAULT
;

286 
	}
}

309 
	$du_decode
(

310 
ut8_t
 * 
du
,

311 
BACNET_ADDRESS
 * 
de
,

312 
BACNET_ADDRESS
 * 
c
,

313 
BACNET_NPDU_DATA
 * 
du_da
)

315 
n
 = 0;

316 
ut8_t
 
i
 = 0;

317 
ut16_t
 
c_t
 = 0;

318 
ut16_t
 
de_t
 = 0;

319 
ut8_t
 
addss_n
 = 0;

320 
ut8_t
 
mac_o
 = 0;

322 i(
du
 && 
du_da
) {

324 
du_da
->
oc_vsi
 = 
du
[0];

330 
du_da
->
twk_y_mesge
 = (
du
[1] & 
BIT7
? 
ue
 : 
l
;

341 
du_da
->
da_exg_y
 = (
du
[1] & 
BIT2
? 
ue
 : 
l
;

347 
du_da
->
iܙy
 = (
BACNET_MESSAGE_PRIORITY
(
du
[1] & 0x03);

349 
n
 = 2;

355 i(
du
[1] & 
BIT5
) {

356 
n
 +
	`decode_unsigd16
(&
du
[n], &
de_t
);

359 
addss_n
 = 
du
[
n
++];

360 i(
de
) {

361 
de
->
t
 = 
de_t
;

362 
de
->
n
 = 
addss_n
;

364 i(
addss_n
) {

365 i(
addss_n
 > 
MAX_MAC_LEN
) {

370 
i
 = 0; i < 
addss_n
; i++) {

371 
mac_o
 = 
du
[
n
++];

372 i(
de
)

373 
de
->
adr
[
i
] = 
mac_o
;

378 i(
de
) {

379 
de
->
t
 = 0;

380 
de
->
n
 = 0;

381 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

382 
de
->
adr
[
i
] = 0;

390 i(
du
[1] & 
BIT3
) {

391 
n
 +
	`decode_unsigd16
(&
du
[n], &
c_t
);

394 
addss_n
 = 
du
[
n
++];

395 i(
c
) {

396 
c
->
t
 = 
c_t
;

397 
c
->
n
 = 
addss_n
;

399 i(
addss_n
) {

400 i(
addss_n
 > 
MAX_MAC_LEN
) {

405 
i
 = 0; i < 
addss_n
; i++) {

406 
mac_o
 = 
du
[
n
++];

407 i(
c
)

408 
c
->
adr
[
i
] = 
mac_o
;

411 } i(
c
) {

416 i(
c
->
t
 !
BACNET_BROADCAST_NETWORK
)

417 
c
->
t
 = 0;

418 
c
->
n
 = 0;

419 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

420 
c
->
adr
[
i
] = 0;

426 i(
de_t
) {

427 
du_da
->
h_cou
 = 
du
[
n
++];

429 
du_da
->
h_cou
 = 0;

433 i(
du_da
->
twk_y_mesge
) {

434 
du_da
->
twk_mesge_ty
 =

435 (
BACNET_NETWORK_MESSAGE_TYPE

du
[
n
++];

438 i(
du_da
->
twk_mesge_ty
 >= 0x80)

439 
n
 +
	`decode_unsigd16
(&
du
[n], &
du_da
->
vd_id
);

443 
du_da
->
twk_mesge_ty
 = 
NETWORK_MESSAGE_INVALID
;

447  
n
;

448 
	}
}

450 #ifde
TEST


451 
	~<as.h
>

452 
	~<rg.h
>

453 
	~"e.h
"

455 
	$NPDU2
(

456 
Te
 * 
pTe
)

458 
ut8_t
 
pdu
[480] = { 0 };

459 
BACNET_ADDRESS
 
de
 = { 0 };

460 
BACNET_ADDRESS
 
c
 = { 0 };

461 
BACNET_ADDRESS
 
du_de
 = { 0 };

462 
BACNET_ADDRESS
 
du_c
 = { 0 };

463 
n
 = 0;

464 
bo
 
da_exg_y
 = 
ue
;

465 
BACNET_MESSAGE_PRIORITY
 
iܙy
 = 
MESSAGE_PRIORITY_NORMAL
;

466 
BACNET_NPDU_DATA
 
du_da
 = { 0 };

467 
i
 = 0;

468 
du_n
 = 0;

469 
bo
 
twk_y_mesge
 = 
l
;

470 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
 = 0;

471 
ut16_t
 
vd_id
 = 0;

473 
de
.
mac_n
 = 6;

474 
i
 = 0; i < 
de
.
mac_n
; i++) {

475 
de
.
mac
[
i
] = i;

478 
de
.
t
 = 1;

479 
de
.
n
 = 6;

480 
i
 = 0; i < 
de
.
n
; i++) {

481 
de
.
adr
[
i
] = i * 10;

483 
c
.
mac_n
 = 1;

484 
i
 = 0; i < 
c
.
mac_n
; i++) {

485 
c
.
mac
[
i
] = 0x80;

488 
c
.
t
 = 2;

489 
c
.
n
 = 1;

490 
i
 = 0; i < 
c
.
n
; i++) {

491 
c
.
adr
[
i
] = 0x40;

493 
	`du_code_du_da
(&
du_da
, 
ue
, 
iܙy
);

494 
n
 = 
	`du_code_pdu
(&
pdu
[0], &
de
, &
c
, &
du_da
);

495 
	`_
(
pTe
, 
n
 != 0);

497 
du_n
 = 
	`du_decode
(&
pdu
[0], &
du_de
, &
du_c
, &
du_da
);

498 
	`_
(
pTe
, 
du_n
 != 0);

499 
	`_
(
pTe
, 
du_da
.
da_exg_y
 == data_expecting_reply);

500 
	`_
(
pTe
, 
du_da
.
twk_y_mesge
 ==etwork_layer_message);

501 i(
du_da
.
twk_y_mesge
) {

502 
	`_
(
pTe
, 
du_da
.
twk_mesge_ty
 ==etwork_message_type);

504 
	`_
(
pTe
, 
du_da
.
vd_id
 == vendor_id);

505 
	`_
(
pTe
, 
du_da
.
iܙy
 ==riority);

507 
	`_
(
pTe
, 
du_de
.
t
 =
de
.net);

508 
	`_
(
pTe
, 
du_de
.
n
 =
de
.len);

509 
i
 = 0; i < 
de
.
n
; i++) {

510 
	`_
(
pTe
, 
du_de
.
adr
[
i
] =
de
.adr[i]);

513 
	`_
(
pTe
, 
du_c
.
t
 =
c
.net);

514 
	`_
(
pTe
, 
du_c
.
n
 =
c
.len);

515 
i
 = 0; i < 
c
.
n
; i++) {

516 
	`_
(
pTe
, 
du_c
.
adr
[
i
] =
c
.adr[i]);

518 
	}
}

520 
	$NPDU1
(

521 
Te
 * 
pTe
)

523 
ut8_t
 
pdu
[480] = { 0 };

524 
BACNET_ADDRESS
 
de
 = { 0 };

525 
BACNET_ADDRESS
 
c
 = { 0 };

526 
BACNET_ADDRESS
 
du_de
 = { 0 };

527 
BACNET_ADDRESS
 
du_c
 = { 0 };

528 
n
 = 0;

529 
bo
 
da_exg_y
 = 
l
;

530 
BACNET_MESSAGE_PRIORITY
 
iܙy
 = 
MESSAGE_PRIORITY_NORMAL
;

531 
BACNET_NPDU_DATA
 
du_da
 = { 0 };

532 
i
 = 0;

533 
du_n
 = 0;

534 
bo
 
twk_y_mesge
 = 
l
;

535 
BACNET_NETWORK_MESSAGE_TYPE
 
twk_mesge_ty
 = 0;

536 
ut16_t
 
vd_id
 = 0;

539 
de
.
mac_n
 = 0;

540 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

541 
de
.
mac
[
i
] = 0;

544 
de
.
t
 = 0;

545 
de
.
n
 = 0;

546 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

547 
de
.
adr
[
i
] = 0;

549 
c
.
mac_n
 = 0;

550 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

551 
c
.
mac
[
i
] = 0;

554 
c
.
t
 = 0;

555 
c
.
n
 = 0;

556 
i
 = 0; i < 
MAX_MAC_LEN
; i++) {

557 
c
.
adr
[
i
] = 0;

559 
	`du_code_du_da
(&
du_da
, 
l
, 
iܙy
);

560 
n
 = 
	`du_code_pdu
(&
pdu
[0], &
de
, &
c
, &
du_da
);

561 
	`_
(
pTe
, 
n
 != 0);

563 
du_n
 = 
	`du_decode
(&
pdu
[0], &
du_de
, &
du_c
, &
du_da
);

564 
	`_
(
pTe
, 
du_n
 != 0);

565 
	`_
(
pTe
, 
du_da
.
da_exg_y
 == data_expecting_reply);

566 
	`_
(
pTe
, 
du_da
.
twk_y_mesge
 ==etwork_layer_message);

567 i(
du_da
.
twk_y_mesge
) {

568 
	`_
(
pTe
, 
du_da
.
twk_mesge_ty
 ==etwork_message_type);

570 
	`_
(
pTe
, 
du_da
.
vd_id
 == vendor_id);

571 
	`_
(
pTe
, 
du_da
.
iܙy
 ==riority);

572 
	`_
(
pTe
, 
du_de
.
mac_n
 =
c
.mac_len);

573 
	`_
(
pTe
, 
du_c
.
mac_n
 =
de
.mac_len);

574 
	}
}

576 #ifde
TEST_NPDU


578 
	$tsm__voke_id
(

579 
ut8_t
 
vokeID
)

581 (
vokeID
;

582 
	}
}

584 
	$m_hdr
(

585 
ut8_t
 * 
rvi_que
,

586 
ut16_t
 
rvi_n
,

587 
BACNET_ADDRESS
 * 
c
)

589 (
rvi_que
;

590 (
rvi_n
;

591 (
c
;

592 
	}
}

594 
	$ma
(

597 
Te
 *
pTe
;

598 
bo
 
rc
;

600 
pTe
 = 
	`_
("BACÈNPDU", 
NULL
);

602 
rc
 = 
	`_addTeFuni
(
pTe
, 
NPDU1
);

603 
	`as
(
rc
);

604 
rc
 = 
	`_addTeFuni
(
pTe
, 
NPDU2
);

605 
	`as
(
rc
);

607 
	`_tSm
(
pTe
, 
dout
);

608 
	`_run
(
pTe
);

609 (
	`_pt
(
pTe
);

610 
	`_deroy
(
pTe
);

613 
	}
}

	@src/proplist.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdef.h
"

37 
	~"bacdcode.h
"

38 
	~"banum.h
"

39 
	~"m.h
"

40 
	~".h
"

41 
	~"li.h
"

43 #ide
BACNET_PROPERTY_LISTS


44 
	#BACNET_PROPERTY_LISTS
 0

	)

47 #i
BACNET_PROPERTY_LISTS


51 cڡ 
	gDeu_Prݔts_Requed
[] = {

52 
PROP_OBJECT_IDENTIFIER
,

53 
PROP_OBJECT_NAME
,

54 
PROP_OBJECT_TYPE
,

58 cڡ 
	gDevi_Prݔts_Requed
[] = {

59 
PROP_OBJECT_IDENTIFIER
,

60 
PROP_OBJECT_NAME
,

61 
PROP_OBJECT_TYPE
,

62 
PROP_SYSTEM_STATUS
,

63 
PROP_VENDOR_NAME
,

64 
PROP_VENDOR_IDENTIFIER
,

65 
PROP_MODEL_NAME
,

66 
PROP_FIRMWARE_REVISION
,

67 
PROP_APPLICATION_SOFTWARE_VERSION
,

68 
PROP_PROTOCOL_VERSION
,

69 
PROP_PROTOCOL_REVISION
,

70 
PROP_PROTOCOL_SERVICES_SUPPORTED
,

71 
PROP_PROTOCOL_OBJECT_TYPES_SUPPORTED
,

72 
PROP_OBJECT_LIST
,

73 
PROP_MAX_APDU_LENGTH_ACCEPTED
,

74 
PROP_SEGMENTATION_SUPPORTED
,

75 
PROP_APDU_TIMEOUT
,

76 
PROP_NUMBER_OF_APDU_RETRIES
,

77 
PROP_DEVICE_ADDRESS_BINDING
,

78 
PROP_DATABASE_REVISION
,

82 cڡ 
	gDevi_Prݔts_Oiڮ
[] = {

83 
PROP_LOCATION
,

84 
PROP_DESCRIPTION
,

85 
PROP_STRUCTURED_OBJECT_LIST
,

86 
PROP_MAX_SEGMENTS_ACCEPTED
,

87 
PROP_VT_CLASSES_SUPPORTED
,

88 
PROP_ACTIVE_VT_SESSIONS
,

89 
PROP_LOCAL_TIME
,

90 
PROP_LOCAL_DATE
,

91 
PROP_UTC_OFFSET
,

92 
PROP_DAYLIGHT_SAVINGS_STATUS
,

93 
PROP_APDU_SEGMENT_TIMEOUT
,

94 
PROP_TIME_SYNCHRONIZATION_RECIPIENTS
,

95 
PROP_MAX_MASTER
,

96 
PROP_MAX_INFO_FRAMES
,

97 
PROP_CONFIGURATION_FILES
,

98 
PROP_LAST_RESTORE_TIME
,

99 
PROP_BACKUP_FAILURE_TIMEOUT
,

100 
PROP_BACKUP_PREPARATION_TIME
,

101 
PROP_RESTORE_PREPARATION_TIME
,

102 
PROP_RESTORE_COMPLETION_TIME
,

103 
PROP_BACKUP_AND_RESTORE_STATE
,

104 
PROP_ACTIVE_COV_SUBSCRIPTIONS
,

105 
PROP_SLAVE_PROXY_ENABLE
,

106 
PROP_MANUAL_SLAVE_ADDRESS_BINDING
,

107 
PROP_AUTO_SLAVE_DISCOVERY
,

108 
PROP_SLAVE_ADDRESS_BINDING
,

109 
PROP_LAST_RESTART_REASON
,

110 
PROP_TIME_OF_DEVICE_RESTART
,

111 
PROP_RESTART_NOTIFICATION_RECIPIENTS
,

112 
PROP_UTC_TIME_SYNCHRONIZATION_RECIPIENTS
,

113 
PROP_TIME_SYNCHRONIZATION_INTERVAL
,

114 
PROP_ALIGN_INTERVALS
,

115 
PROP_INTERVAL_OFFSET
,

116 
PROP_PROFILE_NAME
,

120 cڡ 
	gAccumut_Prݔts_Requed
[] = {

121 
PROP_OBJECT_IDENTIFIER
,

122 
PROP_OBJECT_NAME
,

123 
PROP_OBJECT_TYPE
,

124 
PROP_PRESENT_VALUE
,

125 
PROP_STATUS_FLAGS
,

126 
PROP_EVENT_STATE
,

127 
PROP_OUT_OF_SERVICE
,

128 
PROP_SCALE
,

129 
PROP_UNITS
,

130 
PROP_MAX_PRES_VALUE
,

134 cڡ 
	gAccumut_Prݔts_Oiڮ
[] = {

135 
PROP_DESCRIPTION
,

136 
PROP_DEVICE_TYPE
,

137 
PROP_RELIABILITY
,

138 
PROP_PRESCALE
,

139 
PROP_VALUE_CHANGE_TIME
,

140 
PROP_VALUE_BEFORE_CHANGE
,

141 
PROP_VALUE_SET
,

142 
PROP_LOGGING_RECORD
,

143 
PROP_LOGGING_OBJECT
,

144 
PROP_PULSE_RATE
,

145 
PROP_HIGH_LIMIT
,

146 
PROP_LOW_LIMIT
,

147 
PROP_LIMIT_MONITORING_INTERVAL
,

148 
PROP_NOTIFICATION_CLASS
,

149 
PROP_TIME_DELAY
,

150 
PROP_LIMIT_ENABLE
,

151 
PROP_EVENT_ENABLE
,

152 
PROP_ACKED_TRANSITIONS
,

153 
PROP_NOTIFY_TYPE
,

154 
PROP_EVENT_TIME_STAMPS
,

155 
PROP_EVENT_MESSAGE_TEXTS
,

156 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

157 
PROP_PROFILE_NAME
,

161 cڡ 
	gAlog_Iut_Prݔts_Requed
[] = {

162 
PROP_OBJECT_IDENTIFIER
,

163 
PROP_OBJECT_NAME
,

164 
PROP_OBJECT_TYPE
,

165 
PROP_PRESENT_VALUE
,

166 
PROP_STATUS_FLAGS
,

167 
PROP_EVENT_STATE
,

168 
PROP_OUT_OF_SERVICE
,

169 
PROP_UNITS
,

173 cڡ 
	gAlog_Iut_Prݔts_Oiڮ
[] = {

174 
PROP_DESCRIPTION
,

175 
PROP_DEVICE_TYPE
,

176 
PROP_RELIABILITY
,

177 
PROP_UPDATE_INTERVAL
,

178 
PROP_MIN_PRES_VALUE
,

179 
PROP_MAX_PRES_VALUE
,

180 
PROP_RESOLUTION
,

181 
PROP_COV_INCREMENT
,

182 
PROP_TIME_DELAY
,

183 
PROP_NOTIFICATION_CLASS
,

184 
PROP_HIGH_LIMIT
,

185 
PROP_LOW_LIMIT
,

186 
PROP_DEADBAND
,

187 
PROP_LIMIT_ENABLE
,

188 
PROP_EVENT_ENABLE
,

189 
PROP_ACKED_TRANSITIONS
,

190 
PROP_NOTIFY_TYPE
,

191 
PROP_EVENT_TIME_STAMPS
,

192 
PROP_EVENT_MESSAGE_TEXTS
,

193 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

194 
PROP_PROFILE_NAME
,

198 cڡ 
	gAlog_Ouut_Prݔts_Requed
[] = {

199 
PROP_OBJECT_IDENTIFIER
,

200 
PROP_OBJECT_NAME
,

201 
PROP_OBJECT_TYPE
,

202 
PROP_PRESENT_VALUE
,

203 
PROP_STATUS_FLAGS
,

204 
PROP_EVENT_STATE
,

205 
PROP_OUT_OF_SERVICE
,

206 
PROP_UNITS
,

207 
PROP_PRIORITY_ARRAY
,

208 
PROP_RELINQUISH_DEFAULT
,

212 cڡ 
	gAlog_Ouut_Prݔts_Oiڮ
[] = {

213 
PROP_DESCRIPTION
,

214 
PROP_DEVICE_TYPE
,

215 
PROP_RELIABILITY
,

216 
PROP_MIN_PRES_VALUE
,

217 
PROP_MAX_PRES_VALUE
,

218 
PROP_RESOLUTION
,

219 
PROP_COV_INCREMENT
,

220 
PROP_TIME_DELAY
,

221 
PROP_NOTIFICATION_CLASS
,

222 
PROP_HIGH_LIMIT
,

223 
PROP_LOW_LIMIT
,

224 
PROP_DEADBAND
,

225 
PROP_LIMIT_ENABLE
,

226 
PROP_EVENT_ENABLE
,

227 
PROP_ACKED_TRANSITIONS
,

228 
PROP_NOTIFY_TYPE
,

229 
PROP_EVENT_TIME_STAMPS
,

230 
PROP_EVENT_MESSAGE_TEXTS
,

231 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

232 
PROP_PROFILE_NAME
,

236 cڡ 
	gAlog_Vue_Prݔts_Requed
[] = {

237 
PROP_OBJECT_IDENTIFIER
,

238 
PROP_OBJECT_NAME
,

239 
PROP_OBJECT_TYPE
,

240 
PROP_PRESENT_VALUE
,

241 
PROP_STATUS_FLAGS
,

242 
PROP_EVENT_STATE
,

243 
PROP_OUT_OF_SERVICE
,

244 
PROP_UNITS
,

248 cڡ 
	gAlog_Vue_Prݔts_Oiڮ
[] = {

249 
PROP_DESCRIPTION
,

250 
PROP_RELIABILITY
,

251 
PROP_PRIORITY_ARRAY
,

252 
PROP_RELINQUISH_DEFAULT
,

253 
PROP_COV_INCREMENT
,

254 
PROP_TIME_DELAY
,

255 
PROP_NOTIFICATION_CLASS
,

256 
PROP_HIGH_LIMIT
,

257 
PROP_LOW_LIMIT
,

258 
PROP_DEADBAND
,

259 
PROP_LIMIT_ENABLE
,

260 
PROP_EVENT_ENABLE
,

261 
PROP_ACKED_TRANSITIONS
,

262 
PROP_NOTIFY_TYPE
,

263 
PROP_EVENT_TIME_STAMPS
,

264 
PROP_EVENT_MESSAGE_TEXTS
,

265 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

266 
PROP_PROFILE_NAME
,

270 cڡ 
	gAvagg_Prݔts_Requed
[] = {

271 
PROP_OBJECT_IDENTIFIER
,

272 
PROP_OBJECT_NAME
,

273 
PROP_OBJECT_TYPE
,

274 
PROP_MINIMUM_VALUE
,

275 
PROP_AVERAGE_VALUE
,

276 
PROP_MAXIMUM_VALUE
,

277 
PROP_STATUS_FLAGS
,

278 
PROP_EVENT_STATE
,

279 
PROP_OUT_OF_SERVICE
,

280 
PROP_UNITS
,

284 cڡ 
	gAvagg_Prݔts_Oiڮ
[] = {

285 
PROP_PROFILE_NAME
,

286 
PROP_MINIMUM_VALUE_TIMESTAMP
,

287 
PROP_VARIANCE_VALUE
,

288 
PROP_MAXIMUM_VALUE_TIMESTAMP
,

289 
PROP_DESCRIPTION
,

290 
PROP_ATTEMPTED_SAMPLES
,

291 
PROP_VALID_SAMPLES
,

292 
PROP_OBJECT_PROPERTY_REFERENCE
,

293 
PROP_WINDOW_INTERVAL
,

294 
PROP_WINDOW_SAMPLES
,

298 cڡ 
	gBy_Iut_Prݔts_Requed
[] = {

299 
PROP_OBJECT_IDENTIFIER
,

300 
PROP_OBJECT_NAME
,

301 
PROP_OBJECT_TYPE
,

302 
PROP_PRESENT_VALUE
,

303 
PROP_STATUS_FLAGS
,

304 
PROP_EVENT_STATE
,

305 
PROP_OUT_OF_SERVICE
,

306 
PROP_POLARITY
,

310 cڡ 
	gBy_Iut_Prݔts_Oiڮ
[] = {

311 
PROP_DESCRIPTION
,

312 
PROP_DEVICE_TYPE
,

313 
PROP_RELIABILITY
,

314 
PROP_INACTIVE_TEXT
,

315 
PROP_ACTIVE_TEXT
,

316 
PROP_CHANGE_OF_STATE_TIME
,

317 
PROP_CHANGE_OF_STATE_COUNT
,

318 
PROP_TIME_OF_STATE_COUNT_RESET
,

319 
PROP_ELAPSED_ACTIVE_TIME
,

320 
PROP_TIME_OF_ACTIVE_TIME_RESET
,

321 
PROP_TIME_DELAY
,

322 
PROP_NOTIFICATION_CLASS
,

323 
PROP_ALARM_VALUE
,

324 
PROP_EVENT_ENABLE
,

325 
PROP_ACKED_TRANSITIONS
,

326 
PROP_NOTIFY_TYPE
,

327 
PROP_EVENT_TIME_STAMPS
,

328 
PROP_EVENT_MESSAGE_TEXTS
,

329 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

330 
PROP_PROFILE_NAME
,

334 cڡ 
	gBy_Ouut_Prݔts_Requed
[] = {

335 
PROP_OBJECT_IDENTIFIER
,

336 
PROP_OBJECT_NAME
,

337 
PROP_OBJECT_TYPE
,

338 
PROP_PRESENT_VALUE
,

339 
PROP_STATUS_FLAGS
,

340 
PROP_EVENT_STATE
,

341 
PROP_OUT_OF_SERVICE
,

342 
PROP_POLARITY
,

343 
PROP_PRIORITY_ARRAY
,

344 
PROP_RELINQUISH_DEFAULT
,

348 cڡ 
	gBy_Ouut_Prݔts_Oiڮ
[] = {

349 
PROP_DESCRIPTION
,

350 
PROP_DEVICE_TYPE
,

351 
PROP_RELIABILITY
,

352 
PROP_INACTIVE_TEXT
,

353 
PROP_ACTIVE_TEXT
,

354 
PROP_CHANGE_OF_STATE_TIME
,

355 
PROP_CHANGE_OF_STATE_COUNT
,

356 
PROP_TIME_OF_STATE_COUNT_RESET
,

357 
PROP_ELAPSED_ACTIVE_TIME
,

358 
PROP_TIME_OF_ACTIVE_TIME_RESET
,

359 
PROP_MINIMUM_OFF_TIME
,

360 
PROP_MINIMUM_ON_TIME
,

361 
PROP_TIME_DELAY
,

362 
PROP_NOTIFICATION_CLASS
,

363 
PROP_FEEDBACK_VALUE
,

364 
PROP_EVENT_ENABLE
,

365 
PROP_ACKED_TRANSITIONS
,

366 
PROP_NOTIFY_TYPE
,

367 
PROP_EVENT_TIME_STAMPS
,

368 
PROP_EVENT_MESSAGE_TEXTS
,

369 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

370 
PROP_PROFILE_NAME
,

374 cڡ 
	gBy_Vue_Prݔts_Requed
[] = {

375 
PROP_OBJECT_IDENTIFIER
,

376 
PROP_OBJECT_NAME
,

377 
PROP_OBJECT_TYPE
,

378 
PROP_PRESENT_VALUE
,

379 
PROP_STATUS_FLAGS
,

380 
PROP_EVENT_STATE
,

381 
PROP_OUT_OF_SERVICE
,

385 cڡ 
	gBy_Vue_Prݔts_Oiڮ
[] = {

386 
PROP_DESCRIPTION
,

387 
PROP_RELIABILITY
,

388 
PROP_INACTIVE_TEXT
,

389 
PROP_ACTIVE_TEXT
,

390 
PROP_CHANGE_OF_STATE_TIME
,

391 
PROP_CHANGE_OF_STATE_COUNT
,

392 
PROP_TIME_OF_STATE_COUNT_RESET
,

393 
PROP_ELAPSED_ACTIVE_TIME
,

394 
PROP_TIME_OF_ACTIVE_TIME_RESET
,

395 
PROP_MINIMUM_OFF_TIME
,

396 
PROP_MINIMUM_ON_TIME
,

397 
PROP_PRIORITY_ARRAY
,

398 
PROP_RELINQUISH_DEFAULT
,

399 
PROP_TIME_DELAY
,

400 
PROP_NOTIFICATION_CLASS
,

401 
PROP_ALARM_VALUE
,

402 
PROP_EVENT_ENABLE
,

403 
PROP_ACKED_TRANSITIONS
,

404 
PROP_NOTIFY_TYPE
,

405 
PROP_EVENT_TIME_STAMPS
,

406 
PROP_EVENT_MESSAGE_TEXTS
,

407 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

408 
PROP_PROFILE_NAME
,

412 cڡ 
	gCd_Prݔts_Requed
[] = {

413 
PROP_OBJECT_IDENTIFIER
,

414 
PROP_OBJECT_NAME
,

415 
PROP_OBJECT_TYPE
,

416 
PROP_PRESENT_VALUE
,

417 
PROP_DATE_LIST
,

421 cڡ 
	gCd_Prݔts_Oiڮ
[] = {

422 
PROP_DESCRIPTION
,

423 
PROP_PROFILE_NAME
,

427 cڡ 
	gChl_Prݔts_Requed
[] = {

428 
PROP_OBJECT_IDENTIFIER
,

429 
PROP_OBJECT_NAME
,

430 
PROP_OBJECT_TYPE
,

431 
PROP_PRESENT_VALUE
,

432 
PROP_LAST_PRIORITY
,

433 
PROP_WRITE_STATUS
,

434 
PROP_STATUS_FLAGS
,

435 
PROP_OUT_OF_SERVICE
,

436 
PROP_LIST_OF_OBJECT_PROPERTY_REFERENCES
,

437 
PROP_CHANNEL_NUMBER
,

438 
PROP_CONTROL_GROUPS
,

442 cڡ 
	gChl_Prݔts_Oiڮ
[] = {

443 
PROP_DESCRIPTION
,

444 
PROP_RELIABILITY
,

445 
PROP_EXECUTION_DELAY
,

446 
PROP_ALLOW_GROUP_DELAY_INHIBIT
,

447 
PROP_EVENT_DETECTION_ENABLE
,

448 
PROP_NOTIFICATION_CLASS
,

449 
PROP_EVENT_ENABLE
,

450 
PROP_EVENT_STATE
,

451 
PROP_ACKED_TRANSITIONS
,

452 
PROP_NOTIFY_TYPE
,

453 
PROP_EVENT_TIME_STAMPS
,

454 
PROP_EVENT_MESSAGE_TEXTS
,

455 
PROP_EVENT_MESSAGE_TEXTS_CONFIG
,

456 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

457 
PROP_PROFILE_NAME
,

461 cڡ 
	gCommd_Prݔts_Requed
[] = {

462 
PROP_OBJECT_IDENTIFIER
,

463 
PROP_OBJECT_NAME
,

464 
PROP_OBJECT_TYPE
,

465 
PROP_PRESENT_VALUE
,

466 
PROP_IN_PROCESS
,

467 
PROP_ALL_WRITES_SUCCESSFUL
,

468 
PROP_ACTION
,

472 cڡ 
	gCommd_Prݔts_Oiڮ
[] = {

473 
PROP_DESCRIPTION
,

474 
PROP_ACTION_TEXT
,

475 
PROP_PROFILE_NAME
,

479 cڡ 
	gChaSg_Vue_Prݔts_Requed
[] = {

480 
PROP_OBJECT_IDENTIFIER
,

481 
PROP_OBJECT_NAME
,

482 
PROP_OBJECT_TYPE
,

483 
PROP_PRESENT_VALUE
,

484 
PROP_STATUS_FLAGS
,

488 cڡ 
	gChaSg_Vue_Prݔts_Oiڮ
[] = {

489 
PROP_DESCRIPTION
,

490 
PROP_EVENT_STATE
,

491 
PROP_RELIABILITY
,

492 
PROP_OUT_OF_SERVICE
,

493 
PROP_PRIORITY_ARRAY
,

494 
PROP_RELINQUISH_DEFAULT
,

495 
PROP_TIME_DELAY
,

496 
PROP_NOTIFICATION_CLASS
,

497 
PROP_ALARM_VALUES
,

498 
PROP_FAULT_VALUES
,

499 
PROP_EVENT_ENABLE
,

500 
PROP_ACKED_TRANSITIONS
,

501 
PROP_NOTIFY_TYPE
,

502 
PROP_EVENT_TIME_STAMPS
,

503 
PROP_EVENT_MESSAGE_TEXTS
,

504 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

505 
PROP_PROFILE_NAME
,

509 cڡ 
	gLightg_Ouut_Prݔts_Requed
[] = {

510 
PROP_OBJECT_IDENTIFIER
,

511 
PROP_OBJECT_NAME
,

512 
PROP_OBJECT_TYPE
,

513 
PROP_PRESENT_VALUE
,

514 
PROP_TRACKING_VALUE
,

515 
PROP_LIGHTING_COMMAND
,

516 
PROP_IN_PROGRESS
,

517 
PROP_STATUS_FLAGS
,

518 
PROP_OUT_OF_SERVICE
,

519 
PROP_BLINK_WARN_ENABLE
,

520 
PROP_EGRESS_TIME
,

521 
PROP_EGRESS_ACTIVE
,

522 
PROP_DEFAULT_FADE_TIME
,

523 
PROP_DEFAULT_RAMP_RATE
,

524 
PROP_DEFAULT_STEP_INCREMENT
,

525 
PROP_PRIORITY_ARRAY
,

526 
PROP_RELINQUISH_DEFAULT
,

527 
PROP_LIGHTING_COMMAND_DEFAULT_PRIORITY
,

531 cڡ 
	gLightg_Ouut_Prݔts_Oiڮ
[] = {

532 
PROP_DESCRIPTION
,

533 
PROP_RELIABILITY
,

534 
PROP_TRANSITION
,

535 
PROP_FEEDBACK_VALUE
,

536 
PROP_POWER
,

537 
PROP_INSTANTANEOUS_POWER
,

538 
PROP_MIN_ACTUAL_VALUE
,

539 
PROP_MAX_ACTUAL_VALUE
,

540 
PROP_COV_INCREMENT
,

541 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

542 
PROP_PROFILE_NAME
,

546 cڡ 
	gLd_Cڌ_Prݔts_Requed
[] = {

547 
PROP_OBJECT_IDENTIFIER
,

548 
PROP_OBJECT_NAME
,

549 
PROP_OBJECT_TYPE
,

550 
PROP_PRESENT_VALUE
,

551 
PROP_STATUS_FLAGS
,

552 
PROP_EVENT_STATE
,

553 
PROP_REQUESTED_SHED_LEVEL
,

554 
PROP_START_TIME
,

555 
PROP_SHED_DURATION
,

556 
PROP_DUTY_WINDOW
,

557 
PROP_ENABLE
,

558 
PROP_EXPECTED_SHED_LEVEL
,

559 
PROP_ACTUAL_SHED_LEVEL
,

560 
PROP_SHED_LEVELS
,

561 
PROP_SHED_LEVEL_DESCRIPTIONS
,

565 cڡ 
	gLd_Cڌ_Prݔts_Oiڮ
[] = {

566 
PROP_DESCRIPTION
,

567 
PROP_STATE_DESCRIPTION
,

568 
PROP_RELIABILITY
,

569 
PROP_FULL_DUTY_BASELINE
,

570 
PROP_NOTIFICATION_CLASS
,

571 
PROP_TIME_DELAY
,

572 
PROP_EVENT_ENABLE
,

573 
PROP_ACKED_TRANSITIONS
,

574 
PROP_NOTIFY_TYPE
,

575 
PROP_EVENT_TIME_STAMPS
,

576 
PROP_EVENT_MESSAGE_TEXTS
,

577 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

578 
PROP_PROFILE_NAME
,

582 cڡ 
	gLi_Saty_Pot_Prݔts_Requed
[] = {

583 
PROP_OBJECT_IDENTIFIER
,

584 
PROP_OBJECT_NAME
,

585 
PROP_OBJECT_TYPE
,

586 
PROP_PRESENT_VALUE
,

587 
PROP_TRACKING_VALUE
,

588 
PROP_STATUS_FLAGS
,

589 
PROP_EVENT_STATE
,

590 
PROP_OUT_OF_SERVICE
,

591 
PROP_RELIABILITY
,

592 
PROP_MODE
,

593 
PROP_ACCEPTED_MODES
,

594 
PROP_SILENCED
,

595 
PROP_OPERATION_EXPECTED
,

599 cڡ 
	gLi_Saty_Pot_Prݔts_Oiڮ
[] = {

600 
PROP_DESCRIPTION
,

601 
PROP_DEVICE_TYPE
,

602 
PROP_NOTIFICATION_CLASS
,

603 
PROP_LIFE_SAFETY_ALARM_VALUES
,

604 
PROP_ALARM_VALUES
,

605 
PROP_FAULT_VALUES
,

606 
PROP_EVENT_ENABLE
,

607 
PROP_ACKED_TRANSITIONS
,

608 
PROP_NOTIFY_TYPE
,

609 
PROP_EVENT_TIME_STAMPS
,

610 
PROP_EVENT_MESSAGE_TEXTS
,

611 
PROP_MAINTENANCE_REQUIRED
,

612 
PROP_SETTING
,

613 
PROP_DIRECT_READING
,

614 
PROP_UNITS
,

615 
PROP_MEMBER_OF
,

616 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

617 
PROP_PROFILE_NAME
,

621 cڡ 
	gMuie_Iut_Prݔts_Requed
[] = {

622 
PROP_OBJECT_IDENTIFIER
,

623 
PROP_OBJECT_NAME
,

624 
PROP_OBJECT_TYPE
,

625 
PROP_PRESENT_VALUE
,

626 
PROP_STATUS_FLAGS
,

627 
PROP_EVENT_STATE
,

628 
PROP_OUT_OF_SERVICE
,

629 
PROP_NUMBER_OF_STATES
,

633 cڡ 
	gMuie_Iut_Prݔts_Oiڮ
[] = {

634 
PROP_DESCRIPTION
,

635 
PROP_DEVICE_TYPE
,

636 
PROP_RELIABILITY
,

637 
PROP_STATE_TEXT
,

638 
PROP_TIME_DELAY
,

639 
PROP_NOTIFICATION_CLASS
,

640 
PROP_ALARM_VALUES
,

641 
PROP_FAULT_VALUES
,

642 
PROP_EVENT_ENABLE
,

643 
PROP_ACKED_TRANSITIONS
,

644 
PROP_NOTIFY_TYPE
,

645 
PROP_EVENT_TIME_STAMPS
,

646 
PROP_EVENT_MESSAGE_TEXTS
,

647 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

648 
PROP_PROFILE_NAME
,

652 cڡ 
	gMuie_Ouut_Prݔts_Requed
[] = {

653 
PROP_OBJECT_IDENTIFIER
,

654 
PROP_OBJECT_NAME
,

655 
PROP_OBJECT_TYPE
,

656 
PROP_PRESENT_VALUE
,

657 
PROP_STATUS_FLAGS
,

658 
PROP_EVENT_STATE
,

659 
PROP_OUT_OF_SERVICE
,

660 
PROP_NUMBER_OF_STATES
,

661 
PROP_PRIORITY_ARRAY
,

662 
PROP_RELINQUISH_DEFAULT
,

666 cڡ 
	gMuie_Ouut_Prݔts_Oiڮ
[] = {

667 
PROP_DESCRIPTION
,

668 
PROP_DEVICE_TYPE
,

669 
PROP_RELIABILITY
,

670 
PROP_STATE_TEXT
,

671 
PROP_TIME_DELAY
,

672 
PROP_NOTIFICATION_CLASS
,

673 
PROP_FEEDBACK_VALUE
,

674 
PROP_EVENT_ENABLE
,

675 
PROP_ACKED_TRANSITIONS
,

676 
PROP_NOTIFY_TYPE
,

677 
PROP_EVENT_TIME_STAMPS
,

678 
PROP_EVENT_MESSAGE_TEXTS
,

679 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

680 
PROP_PROFILE_NAME
,

684 cڡ 
	gMuie_Vue_Prݔts_Requed
[] = {

685 
PROP_OBJECT_IDENTIFIER
,

686 
PROP_OBJECT_NAME
,

687 
PROP_OBJECT_TYPE
,

688 
PROP_PRESENT_VALUE
,

689 
PROP_STATUS_FLAGS
,

690 
PROP_EVENT_STATE
,

691 
PROP_OUT_OF_SERVICE
,

692 
PROP_NUMBER_OF_STATES
,

696 cڡ 
	gMuie_Vue_Prݔts_Oiڮ
[] = {

697 
PROP_DESCRIPTION
,

698 
PROP_RELIABILITY
,

699 
PROP_STATE_TEXT
,

700 
PROP_PRIORITY_ARRAY
,

701 
PROP_RELINQUISH_DEFAULT
,

702 
PROP_TIME_DELAY
,

703 
PROP_NOTIFICATION_CLASS
,

704 
PROP_ALARM_VALUES
,

705 
PROP_FAULT_VALUES
,

706 
PROP_EVENT_ENABLE
,

707 
PROP_ACKED_TRANSITIONS
,

708 
PROP_NOTIFY_TYPE
,

709 
PROP_EVENT_TIME_STAMPS
,

710 
PROP_EVENT_MESSAGE_TEXTS
,

711 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

712 
PROP_PROFILE_NAME
,

716 cڡ 
	gNifiti_Css_Prݔts_Requed
[] = {

717 
PROP_OBJECT_IDENTIFIER
,

718 
PROP_OBJECT_NAME
,

719 
PROP_OBJECT_TYPE
,

720 
PROP_NOTIFICATION_CLASS
,

721 
PROP_PRIORITY
,

722 
PROP_ACK_REQUIRED
,

723 
PROP_RECIPIENT_LIST
,

727 cڡ 
	gNifiti_Css_Prݔts_Oiڮ
[] = {

728 
PROP_DESCRIPTION
,

729 
PROP_PROFILE_NAME
,

733 cڡ 
	gTnd_Log_Prݔts_Requed
[] = {

734 
PROP_OBJECT_IDENTIFIER
,

735 
PROP_OBJECT_NAME
,

736 
PROP_OBJECT_TYPE
,

737 
PROP_ENABLE
,

738 
PROP_STOP_WHEN_FULL
,

739 
PROP_BUFFER_SIZE
,

740 
PROP_LOG_BUFFER
,

741 
PROP_RECORD_COUNT
,

742 
PROP_TOTAL_RECORD_COUNT
,

743 
PROP_EVENT_STATE
,

744 
PROP_LOGGING_TYPE
,

745 
PROP_STATUS_FLAGS
,

749 cڡ 
	gTnd_Log_Prݔts_Oiڮ
[] = {

750 
PROP_DESCRIPTION
,

751 
PROP_START_TIME
,

752 
PROP_STOP_TIME
,

753 
PROP_LOG_DEVICE_OBJECT_PROPERTY
,

754 
PROP_LOG_INTERVAL
,

755 
PROP_COV_RESUBSCRIPTION_INTERVAL
,

756 
PROP_CLIENT_COV_INCREMENT
,

757 
PROP_NOTIFICATION_THRESHOLD
,

758 
PROP_RECORDS_SINCE_NOTIFICATION
,

759 
PROP_LAST_NOTIFY_RECORD
,

760 
PROP_NOTIFICATION_CLASS
,

761 
PROP_EVENT_ENABLE
,

762 
PROP_ACKED_TRANSITIONS
,

763 
PROP_NOTIFY_TYPE
,

764 
PROP_EVENT_TIME_STAMPS
,

765 
PROP_EVENT_MESSAGE_TEXTS
,

766 
PROP_ALIGN_INTERVALS
,

767 
PROP_INTERVAL_OFFSET
,

768 
PROP_TRIGGER
,

769 
PROP_RELIABILITY
,

770 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

771 
PROP_PROFILE_NAME
,

775 cڡ 
	gFe_Prݔts_Requed
[] = {

776 
PROP_OBJECT_IDENTIFIER
,

777 
PROP_OBJECT_NAME
,

778 
PROP_OBJECT_TYPE
,

779 
PROP_FILE_TYPE
,

780 
PROP_FILE_SIZE
,

781 
PROP_MODIFICATION_DATE
,

782 
PROP_ARCHIVE
,

783 
PROP_READ_ONLY
,

784 
PROP_FILE_ACCESS_METHOD
,

788 cڡ 
	gFe_Prݔts_Oiڮ
[] = {

789 
PROP_DESCRIPTION
,

790 
PROP_RECORD_COUNT
,

791 
PROP_PROFILE_NAME
,

796 cڡ 
	gIeg_Vue_Prݔts_Requed
[] = {

797 
PROP_OBJECT_IDENTIFIER
,

798 
PROP_OBJECT_NAME
,

799 
PROP_OBJECT_TYPE
,

800 
PROP_PRESENT_VALUE
,

801 
PROP_STATUS_FLAGS
,

802 
PROP_UNITS
,

806 cڡ 
	gIeg_Vue_Prݔts_Oiڮ
[] = {

807 
PROP_DESCRIPTION
,

808 
PROP_EVENT_STATE
,

809 
PROP_RELIABILITY
,

810 
PROP_OUT_OF_SERVICE
,

811 
PROP_PRIORITY_ARRAY
,

812 
PROP_RELINQUISH_DEFAULT
,

813 
PROP_COV_INCREMENT
,

814 
PROP_TIME_DELAY
,

815 
PROP_NOTIFICATION_CLASS
,

816 
PROP_HIGH_LIMIT
,

817 
PROP_LOW_LIMIT
,

818 
PROP_DEADBAND
,

819 
PROP_LIMIT_ENABLE
,

820 
PROP_EVENT_ENABLE
,

821 
PROP_ACKED_TRANSITIONS
,

822 
PROP_NOTIFY_TYPE
,

823 
PROP_EVENT_TIME_STAMPS
,

824 
PROP_EVENT_MESSAGE_TEXTS
,

825 
PROP_EVENT_MESSAGE_TEXTS_CONFIG
,

826 
PROP_EVENT_DETECTION_ENABLE
,

827 
PROP_EVENT_ALGORITHM_INHIBIT_REF
,

828 
PROP_EVENT_ALGORITHM_INHIBIT
,

829 
PROP_TIME_DELAY_NORMAL
,

830 
PROP_RELIABILITY_EVALUATION_INHIBIT
,

831 
PROP_MIN_PRES_VALUE
,

832 
PROP_MAX_PRES_VALUE
,

833 
PROP_RESOLUTION
,

834 
PROP_PROFILE_NAME
,

847 cڡ * 
	$ݔty_li_tiڮ
(

848 
BACNET_OBJECT_TYPE
 
obje_ty
)

850 cڡ * 
pLi
 = 
NULL
;

852 
obje_ty
) {

853 
OBJECT_DEVICE
:

854 
pLi
 = 
Devi_Prݔts_Oiڮ
;

856 
OBJECT_ACCUMULATOR
:

857 
pLi
 = 
Accumut_Prݔts_Oiڮ
;

859 
OBJECT_ANALOG_INPUT
:

860 
pLi
 = 
Alog_Iut_Prݔts_Oiڮ
;

862 
OBJECT_ANALOG_OUTPUT
:

863 
pLi
 = 
Alog_Ouut_Prݔts_Oiڮ
;

865 
OBJECT_ANALOG_VALUE
:

866 
pLi
 = 
Alog_Vue_Prݔts_Oiڮ
;

868 
OBJECT_AVERAGING
:

869 
pLi
 = 
Avagg_Prݔts_Oiڮ
;

871 
OBJECT_BINARY_INPUT
:

872 
pLi
 = 
By_Iut_Prݔts_Oiڮ
;

874 
OBJECT_BINARY_OUTPUT
:

875 
pLi
 = 
By_Ouut_Prݔts_Oiڮ
;

877 
OBJECT_BINARY_VALUE
:

878 
pLi
 = 
By_Vue_Prݔts_Oiڮ
;

880 
OBJECT_CALENDAR
:

881 
pLi
 = 
Cd_Prݔts_Oiڮ
;

883 
OBJECT_CHANNEL
:

884 
pLi
 = 
Chl_Prݔts_Oiڮ
;

886 
OBJECT_COMMAND
:

887 
pLi
 = 
Commd_Prݔts_Oiڮ
;

889 
OBJECT_CHARACTERSTRING_VALUE
:

890 
pLi
 =

891 
ChaSg_Vue_Prݔts_Oiڮ
;

893 
OBJECT_LIGHTING_OUTPUT
:

894 
pLi
 = 
Lightg_Ouut_Prݔts_Oiڮ
;

896 
OBJECT_LOAD_CONTROL
:

897 
pLi
 = 
Ld_Cڌ_Prݔts_Oiڮ
;

899 
OBJECT_LIFE_SAFETY_POINT
:

900 
pLi
 =

901 
Li_Saty_Pot_Prݔts_Oiڮ
;

903 
OBJECT_MULTI_STATE_INPUT
:

904 
pLi
 =

905 
Muie_Iut_Prݔts_Oiڮ
;

907 
OBJECT_MULTI_STATE_OUTPUT
:

908 
pLi
 =

909 
Muie_Ouut_Prݔts_Oiڮ
;

911 
OBJECT_MULTI_STATE_VALUE
:

912 
pLi
 =

913 
Muie_Vue_Prݔts_Oiڮ
;

915 
OBJECT_NOTIFICATION_CLASS
:

916 
pLi
 =

917 
Nifiti_Css_Prݔts_Oiڮ
;

919 
OBJECT_TRENDLOG
:

920 
pLi
 = 
Tnd_Log_Prݔts_Oiڮ
;

922 
OBJECT_FILE
:

923 
pLi
 = 
Fe_Prݔts_Oiڮ
;

925 
OBJECT_INTEGER_VALUE
:

926 
pLi
 = 
Ieg_Vue_Prݔts_Oiڮ
;

932  
pLi
;

933 
	}
}

944 cڡ * 
	$ݔty_li_qued
(

945 
BACNET_OBJECT_TYPE
 
obje_ty
)

947 cڡ * 
pLi
 = 
NULL
;

949 
obje_ty
) {

950 
OBJECT_DEVICE
:

951 
pLi
 = 
Devi_Prݔts_Requed
;

953 
OBJECT_ACCUMULATOR
:

954 
pLi
 = 
Accumut_Prݔts_Requed
;

956 
OBJECT_ANALOG_INPUT
:

957 
pLi
 = 
Alog_Iut_Prݔts_Requed
;

959 
OBJECT_ANALOG_OUTPUT
:

960 
pLi
 = 
Alog_Ouut_Prݔts_Requed
;

962 
OBJECT_ANALOG_VALUE
:

963 
pLi
 = 
Alog_Vue_Prݔts_Requed
;

965 
OBJECT_AVERAGING
:

966 
pLi
 = 
Avagg_Prݔts_Requed
;

968 
OBJECT_BINARY_INPUT
:

969 
pLi
 = 
By_Iut_Prݔts_Requed
;

971 
OBJECT_BINARY_OUTPUT
:

972 
pLi
 = 
By_Ouut_Prݔts_Requed
;

974 
OBJECT_BINARY_VALUE
:

975 
pLi
 = 
By_Vue_Prݔts_Requed
;

977 
OBJECT_CALENDAR
:

978 
pLi
 = 
Cd_Prݔts_Requed
;

980 
OBJECT_CHANNEL
:

981 
pLi
 = 
Chl_Prݔts_Requed
;

983 
OBJECT_COMMAND
:

984 
pLi
 = 
Commd_Prݔts_Requed
;

986 
OBJECT_CHARACTERSTRING_VALUE
:

987 
pLi
 =

988 
ChaSg_Vue_Prݔts_Requed
;

990 
OBJECT_LOAD_CONTROL
:

991 
pLi
 = 
Ld_Cڌ_Prݔts_Requed
;

993 
OBJECT_LIGHTING_OUTPUT
:

994 
pLi
 = 
Lightg_Ouut_Prݔts_Requed
;

996 
OBJECT_LIFE_SAFETY_POINT
:

997 
pLi
 =

998 
Li_Saty_Pot_Prݔts_Requed
;

1000 
OBJECT_MULTI_STATE_INPUT
:

1001 
pLi
 =

1002 
Muie_Iut_Prݔts_Requed
;

1004 
OBJECT_MULTI_STATE_OUTPUT
:

1005 
pLi
 =

1006 
Muie_Ouut_Prݔts_Requed
;

1008 
OBJECT_MULTI_STATE_VALUE
:

1009 
pLi
 =

1010 
Muie_Vue_Prݔts_Requed
;

1012 
OBJECT_NOTIFICATION_CLASS
:

1013 
pLi
 =

1014 
Nifiti_Css_Prݔts_Requed
;

1016 
OBJECT_TRENDLOG
:

1017 
pLi
 = 
Tnd_Log_Prݔts_Requed
;

1019 
OBJECT_FILE
:

1020 
pLi
 = 
Fe_Prݔts_Requed
;

1022 
OBJECT_INTEGER_VALUE
:

1023 
pLi
 = 
Ieg_Vue_Prݔts_Requed
;

1026 
pLi
 = 
Deu_Prݔts_Requed
;

1030  
pLi
;

1031 
	}
}

1042 
	$ݔty_li_ecl
(

1043 
BACNET_OBJECT_TYPE
 
obje_ty
,

1044 
ecl_ݔty_li_t
 *
pPrݔtyLi
)

1046 i(
pPrݔtyLi
 =
NULL
) {

1049 
pPrݔtyLi
->
Requed
.
pLi
 = 
	`ݔty_li_qued
(
obje_ty
);

1050 
pPrݔtyLi
->
Oiڮ
.
pLi
 = 
	`ݔty_li_tiڮ
(
obje_ty
);

1051 
pPrݔtyLi
->
Prrry
.
pLi
 = 
NULL
;

1053 
pPrݔtyLi
->
Requed
.
cou
 =

1054 
	`ݔty_li_cou
(
pPrݔtyLi
->
Requed
.
pLi
);

1055 
pPrݔtyLi
->
Oiڮ
.
cou
 =

1056 
	`ݔty_li_cou
(
pPrݔtyLi
->
Oiڮ
.
pLi
);

1057 
pPrݔtyLi
->
Prrry
.
cou
 = 0;

1060 
	}
}

1062 
BACNET_PROPERTY_ID
 
	$ݔty_li_ecl_ݔty
(

1063 
BACNET_OBJECT_TYPE
 
obje_ty
,

1064 
BACNET_PROPERTY_ID
 
ecl_ݔty
,

1065 
dex
)

1067 
ݔty
 = -1;

1068 
qued
, 
tiڮ
, 
rry
;

1069 
ecl_ݔty_li_t
 
PrݔtyLi
 = { {0} };

1071 
	`ݔty_li_ecl
(
obje_ty
, &
PrݔtyLi
);

1072 
qued
 = 
PrݔtyLi
.
Requed
.
cou
;

1073 
tiڮ
 = 
PrݔtyLi
.
Oiڮ
.
cou
;

1074 
rry
 = 
PrݔtyLi
.
Prrry
.
cou
;

1075 i(
ecl_ݔty
 =
PROP_ALL
) {

1076 i(
dex
 < 
qued
) {

1077 i(
PrݔtyLi
.
Requed
.
pLi
) {

1078 
ݔty
 = 
PrݔtyLi
.
Requed
.
pLi
[
dex
];

1080 } i(
dex
 < (
qued
 + 
tiڮ
)) {

1081 i(
PrݔtyLi
.
Oiڮ
.
pLi
) {

1082 
dex
 -
qued
;

1083 
ݔty
 = 
PrݔtyLi
.
Oiڮ
.
pLi
[
dex
];

1085 } i(
dex
 < (
qued
 + 
tiڮ
 + 
rry
)) {

1086 i(
PrݔtyLi
.
Prrry
.
pLi
) {

1087 
dex
 -(
qued
 + 
tiڮ
);

1088 
ݔty
 = 
PrݔtyLi
.
Prrry
.
pLi
[
dex
];

1091 } i(
ecl_ݔty
 =
PROP_REQUIRED
) {

1092 i(
dex
 < 
qued
) {

1093 i(
PrݔtyLi
.
Requed
.
pLi
) {

1094 
ݔty
 = 
PrݔtyLi
.
Requed
.
pLi
[
dex
];

1097 } i(
ecl_ݔty
 =
PROP_OPTIONAL
) {

1098 i(
dex
 < 
tiڮ
) {

1099 i(
PrݔtyLi
.
Oiڮ
.
pLi
) {

1100 
ݔty
 = 
PrݔtyLi
.
Oiڮ
.
pLi
[
dex
];

1105  (
BACNET_PROPERTY_ID

ݔty
;

1106 
	}
}

1108 
	$ݔty_li_ecl_cou
(

1109 
BACNET_OBJECT_TYPE
 
obje_ty
,

1110 
BACNET_PROPERTY_ID
 
ecl_ݔty
)

1112 
cou
 = 0;

1113 
ecl_ݔty_li_t
 
PrݔtyLi
 = { {0} };

1115 
	`ݔty_li_ecl
(
obje_ty
, &
PrݔtyLi
);

1116 i(
ecl_ݔty
 =
PROP_ALL
) {

1117 
cou
 =

1118 
PrݔtyLi
.
Requed
.
cou
 + PrݔtyLi.
Oiڮ
.count +

1119 
PrݔtyLi
.
Prrry
.
cou
;

1120 } i(
ecl_ݔty
 =
PROP_REQUIRED
) {

1121 
cou
 = 
PrݔtyLi
.
Requed
.count;

1122 } i(
ecl_ݔty
 =
PROP_OPTIONAL
) {

1123 
cou
 = 
PrݔtyLi
.
Oiڮ
.count;

1126  
cou
;

1127 
	}
}

1136 
	$ݔty_li_cou
(

1137 cڡ *
pLi
)

1139 
ݔty_cou
 = 0;

1141 i(
pLi
) {

1142 *
pLi
 != -1) {

1143 
ݔty_cou
++;

1144 
pLi
++;

1148  
ݔty_cou
;

1149 
	}
}

1161 
	$ݔty_li_code
(

1162 
BACNET_READ_PROPERTY_DATA
 * 
da
,

1163 cڡ *
pLiRequed
,

1164 cڡ *
pLiOiڮ
,

1165 cڡ *
pLiPrrry
)

1167 
du_n
 = 0;

1168 
ut8_t
 *
du
 = 
NULL
;

1169 
max_du_n
 = 0;

1170 
ut32_t
 
cou
 = 0;

1171 
qued_cou
 = 0;

1172 
tiڮ_cou
 = 0;

1173 
rry_cou
 = 0;

1174 
n
 = 0;

1175 
i
 = 0;

1177 
qued_cou
 = 
	`ݔty_li_cou
(
pLiRequed
);

1178 
tiڮ_cou
 = 
	`ݔty_li_cou
(
pLiOiڮ
);

1179 
rry_cou
 = 
	`ݔty_li_cou
(
pLiPrrry
);

1181 
cou
 = 
qued_cou
 + 
tiڮ_cou
 + 
rry_cou
;

1182 i(
qued_cou
 >= 3) {

1184 
cou
 -= 3;

1186 i((
da
 =
NULL
|| (da->
iti_da
 == NULL) ||

1187 (
da
->
iti_da_n
 == 0)) {

1190 
du
 = 
da
->
iti_da
;

1191 
max_du_n
 = 
da
->
iti_da_n
;

1192 
da
->
obje_ݔty
) {

1193 
PROP_PROPERTY_LIST
:

1194 i(
da
->
y_dex
 == 0) {

1196 
du_n
 =

1197 
	`code_iti_unsigd
(&
du
[0], 
cou
);

1198 } i(
da
->
y_dex
 =
BACNET_ARRAY_ALL
) {

1201 i(
qued_cou
 > 3) {

1202 
i
 = 0; i < 
qued_cou
; i++) {

1203 i((
pLiRequed
[
i
] =
PROP_OBJECT_TYPE
) ||

1204 (
pLiRequed
[
i
] =
PROP_OBJECT_IDENTIFIER
) ||

1205 (
pLiRequed
[
i
] =
PROP_OBJECT_NAME
)) {

1208 
n
 =

1209 
	`code_iti_umed
(&
du
[
du_n
],

1210 (
ut32_t
)
pLiRequed
[
i
]);

1213 i((
du_n
 + 
n
< 
max_du_n
) {

1214 
du_n
 +
n
;

1216 
da
->
r_code
 =

1217 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

1218 
du_n
 = 
BACNET_STATUS_ABORT
;

1223 i(
tiڮ_cou
) {

1224 
i
 = 0; i < 
tiڮ_cou
; i++) {

1225 
n
 =

1226 
	`code_iti_umed
(&
du
[
du_n
],

1227 (
ut32_t
)
pLiOiڮ
[
i
]);

1229 i((
du_n
 + 
n
< 
max_du_n
) {

1230 
du_n
 +
n
;

1232 
da
->
r_code
 =

1233 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

1234 
du_n
 = 
BACNET_STATUS_ABORT
;

1239 i(
rry_cou
) {

1240 
i
 = 0; i < 
rry_cou
; i++) {

1241 
n
 =

1242 
	`code_iti_umed
(&
du
[
du_n
],

1243 (
ut32_t
)
pLiPrrry
[
i
]);

1245 i((
du_n
 + 
n
< 
max_du_n
) {

1246 
du_n
 +
n
;

1248 
da
->
r_code
 =

1249 
ERROR_CODE_ABORT_SEGMENTATION_NOT_SUPPORTED
;

1250 
du_n
 = 
BACNET_STATUS_ABORT
;

1256 i(
da
->
y_dex
 <
cou
) {

1257 
cou
 = 0;

1258 i(
qued_cou
 > 3) {

1259 
i
 = 0; i < 
qued_cou
; i++) {

1260 i((
pLiRequed
[
i
] =
PROP_OBJECT_TYPE
) ||

1261 (
pLiRequed
[
i
] =
PROP_OBJECT_IDENTIFIER
) ||

1262 (
pLiRequed
[
i
] =
PROP_OBJECT_NAME
)) {

1265 
cou
++;

1267 i(
cou
 =
da
->
y_dex
) {

1268 
du_n
 = 
	`code_iti_umed
(

1269 &
du
[
du_n
],

1270 (
ut32_t
)
pLiRequed
[
i
]);

1275 i((
du_n
 =0&& (
tiڮ_cou
 > 0)) {

1276 
i
 = 0; i < 
tiڮ_cou
; i++) {

1277 
cou
++;

1278 i(
cou
 =
da
->
y_dex
) {

1279 
du_n
 = 
	`code_iti_umed
(

1280 &
du
[
du_n
],

1281 (
ut32_t
)
pLiOiڮ
[
i
]);

1286 i((
du_n
 =0&& (
rry_cou
 > 0)) {

1287 
i
 = 0; i < 
rry_cou
; i++) {

1288 
cou
++;

1289 i(
cou
 =
da
->
y_dex
) {

1290 
du_n
 = 
	`code_iti_umed
(

1291 &
du
[
du_n
],

1292 (
ut32_t
)
pLiPrrry
[
i
]);

1298 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1299 
da
->
r_code
 = 
ERROR_CODE_INVALID_ARRAY_INDEX
;

1300 
du_n
 = 
BACNET_STATUS_ERROR
;

1305 
da
->
r_ass
 = 
ERROR_CLASS_PROPERTY
;

1306 
da
->
r_code
 = 
ERROR_CODE_UNKNOWN_PROPERTY
;

1307 
du_n
 = 
BACNET_STATUS_ERROR
;

1311  
du_n
;

1312 
	}
}

1314 #ifde
TEST


1315 
	~<as.h
>

1316 
	~<rg.h
>

1317 
	~"e.h
"

1319 
	$PrLi
(

1320 
Te
 * 
pTe
)

1322 
i
 = 0, 
j
 = 0;

1323 
cou
 = 0;

1324 
BACNET_PROPERTY_ID
 
ݔty
 = 
MAX_BACNET_PROPERTY_ID
;

1325 
obje_id
 = 0, 
obje_me
 = 0, 
obje_ty
 = 0;

1327 
i
 = 0; i < 
OBJECT_PROPRIETARY_MIN
; i++) {

1328 
cou
 = 
	`ݔty_li_ecl_cou
((
BACNET_OBJECT_TYPE

i
, 
PROP_ALL
);

1329 
	`_
(
pTe
, 
cou
 >= 3);

1330 
obje_id
 = 0;

1331 
obje_me
 = 0;

1332 
obje_ty
 = 0;

1333 
j
 = 0; j < 
cou
; j++) {

1334 
ݔty
 =

1335 
	`ݔty_li_ecl_ݔty
((
BACNET_OBJECT_TYPE

i
,

1336 
PROP_ALL
, 
j
);

1337 i(
ݔty
 =
PROP_OBJECT_TYPE
) {

1338 
obje_ty
++;

1340 i(
ݔty
 =
PROP_OBJECT_IDENTIFIER
) {

1341 
obje_id
++;

1343 i(
ݔty
 =
PROP_OBJECT_NAME
) {

1344 
obje_me
++;

1347 
	`_
(
pTe
, 
obje_ty
 == 1);

1348 
	`_
(
pTe
, 
obje_id
 == 1);

1349 
	`_
(
pTe
, 
obje_me
 == 1);

1351 
	}
}

1353 #ifde
TEST_PROPLIST


1354 
	$ma
(

1357 
Te
 *
pTe
;

1358 
bo
 
rc
;

1360 
pTe
 = 
	`_
("BACÈPrݔty Li", 
NULL
);

1362 
rc
 = 
	`_addTeFuni
(
pTe
, 
PrLi
);

1363 
	`as
(
rc
);

1365 
	`_tSm
(
pTe
, 
dout
);

1366 
	`_run
(
pTe
);

1367 (
	`_pt
(
pTe
);

1368 
	`_deroy
(
pTe
);

1371 
	}
}

	@src/ptransfer.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"nsr.h
"

43 
	$_code_du
(

44 
ut8_t
 * 
du
,

45 
ut16_t
 
max_du
,

46 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

48 
n
 = 0;

49 
du_n
 = 0;

58 
max_du
 = max_apdu;

59 i(
du
) {

60 
n
 =

61 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0,

62 
ive_da
->
vdID
);

63 
du_n
 +
n
;

64 
n
 =

65 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1,

66 
ive_da
->
rviNumb
);

67 
du_n
 +
n
;

68 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 2);

69 
du_n
 +
n
;

70 
n
 = 0; < 
ive_da
->
rviPamsL
;en++) {

71 
du
[
du_n
] = 
ive_da
->
rviPams
[
n
];

72 
du_n
++;

74 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 2);

75 
du_n
 +
n
;

78  
du_n
;

79 
	}
}

81 
	$nsr_code_du
(

82 
ut8_t
 * 
du
,

83 
ut8_t
 
voke_id
,

84 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

86 
du_n
 = 0;

87 
n
 = 0;

89 i(
du
) {

90 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

91 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

92 
du
[2] = 
voke_id
;

93 
du
[3] = 
SERVICE_CONFIRMED_PRIVATE_TRANSFER
;

94 
du_n
 = 4;

95 
n
 =

96 
	`_code_du
(&
du
[
du_n
], (
ut16_t
(
MAX_APDU
 -pdu_len),

97 
ive_da
);

98 
du_n
 +
n
;

101  
du_n
;

102 
	}
}

104 
	$unsr_code_du
(

105 
ut8_t
 * 
du
,

106 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

108 
du_n
 = 0;

109 
n
 = 0;

111 i(
du
) {

112 
du
[0] = 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
;

113 
du
[1] = 
SERVICE_UNCONFIRMED_PRIVATE_TRANSFER
;

114 
du_n
 = 2;

115 
n
 =

116 
	`_code_du
(&
du
[
du_n
], (
ut16_t
(
MAX_APDU
 -pdu_len),

117 
ive_da
);

118 
du_n
 +
n
;

121  
du_n
;

122 
	}
}

125 
	$nsr_decode_rvi_que
(

126 
ut8_t
 * 
du
,

127 
du_n
,

128 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

130 
n
 = 0;

131 
decode_n
 = 0;

132 
ut32_t
 
unsigd_vue
 = 0;

135 i(
du_n
 && 
ive_da
) {

137 
decode_n
 = 
	`decode_cڋxt_unsigd
(&
du
[
n
], 0, &
unsigd_vue
);

138 i(
decode_n
 < 0) {

141 
n
 = 
decode_n
;

142 
ive_da
->
vdID
 = (
ut16_t

unsigd_vue
;

144 
decode_n
 = 
	`decode_cڋxt_unsigd
(&
du
[
n
], 1, &
unsigd_vue
);

145 i(
decode_n
 < 0) {

148 
n
 +
decode_n
;

149 
ive_da
->
rviNumb
 = 
unsigd_vue
;

151 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 2)) {

153 
n
++;

155 
ive_da
->
rviPams
 = &
du
[
n
];

156 
ive_da
->
rviPamsL
 =

157 (
du_n
 - 
n
 - 1 ;

159 
n
 = (
du_n
;

165  
n
;

166 
	}
}

168 
	$nsr_r_code_du
(

169 
ut8_t
 * 
du
,

170 
ut8_t
 
voke_id
,

171 
BACNET_ERROR_CLASS
 
r_ass
,

172 
BACNET_ERROR_CODE
 
r_code
,

173 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

175 
du_n
 = 0;

176 
n
 = 0;

178 i(
du
) {

179 
du
[0] = 
PDU_TYPE_ERROR
;

180 
du
[1] = 
voke_id
;

181 
du
[2] = 
SERVICE_CONFIRMED_PRIVATE_TRANSFER
;

182 
du_n
 = 3;

192 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 0);

193 
du_n
 +
n
;

194 
n
 = 
	`code_iti_umed
(&
du
[
du_n
], 
r_ass
);

195 
du_n
 +
n
;

196 
n
 = 
	`code_iti_umed
(&
du
[
du_n
], 
r_code
);

197 
du_n
 +
n
;

198 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 0);

199 
du_n
 +
n
;

200 
n
 =

201 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1,

202 
ive_da
->
vdID
);

203 
du_n
 +
n
;

204 
n
 =

205 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 2,

206 
ive_da
->
rviNumb
);

207 
du_n
 +
n
;

208 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 3);

209 
du_n
 +
n
;

210 
n
 = 0; < 
ive_da
->
rviPamsL
;en++) {

211 
du
[
du_n
] = 
ive_da
->
rviPams
[
n
];

212 
du_n
++;

214 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 3);

215 
du_n
 +
n
;

218  
du_n
;

219 
	}
}

222 
	$nsr_r_decode_rvi_que
(

223 
ut8_t
 * 
du
,

224 
du_n
,

225 
BACNET_ERROR_CLASS
 * 
r_ass
,

226 
BACNET_ERROR_CODE
 * 
r_code
,

227 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

229 
n
 = 0;

230 
decode_n
 = 0;

231 
ut8_t
 
g_numb
 = 0;

232 
ut32_t
 
n_vue_ty
 = 0;

233 
ut32_t
 
unsigd_vue
 = 0;

236 i(
du_n
 && 
ive_da
) {

238 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 0)) {

240 
n
++;

242 
decode_n
 =

243 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

244 &
n_vue_ty
);

245 
n
 +
decode_n
;

246 i(
g_numb
 !
BACNET_APPLICATION_TAG_ENUMERATED
) {

249 
decode_n
 =

250 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
, &
unsigd_vue
);

251 
n
 +
decode_n
;

252 i(
r_ass
) {

253 *
r_ass
 = (
BACNET_ERROR_CLASS

unsigd_vue
;

256 
decode_n
 =

257 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

258 &
n_vue_ty
);

259 
n
 +
decode_n
;

260 i(
g_numb
 !
BACNET_APPLICATION_TAG_ENUMERATED
) {

263 
decode_n
 =

264 
	`decode_umed
(&
du
[
n
], 
n_vue_ty
, &
unsigd_vue
);

265 
n
 +
decode_n
;

266 i(
r_code
) {

267 *
r_code
 = (
BACNET_ERROR_CODE

unsigd_vue
;

269 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 0)) {

271 
n
++;

277 
decode_n
 = 
	`decode_cڋxt_unsigd
(&
du
[
n
], 1, &
unsigd_vue
);

278 i(
decode_n
 < 0) {

281 
n
 +
decode_n
;

282 
ive_da
->
vdID
 = (
ut16_t

unsigd_vue
;

284 
decode_n
 = 
	`decode_cڋxt_unsigd
(&
du
[
n
], 2, &
unsigd_vue
);

285 i(
decode_n
 < 0) {

288 
n
 +
decode_n
;

289 
ive_da
->
rviNumb
 = 
unsigd_vue
;

291 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 3)) {

293 
n
++;

295 
ive_da
->
rviPams
 = &
du
[
n
];

296 
ive_da
->
rviPamsL
 =

297 (
du_n
 - 
n
 - 1 ;

304  
n
;

305 
	}
}

307 
	$nsr_ack_code_du
(

308 
ut8_t
 * 
du
,

309 
ut8_t
 
voke_id
,

310 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

312 
n
 = 0;

313 
du_n
 = 0;

315 i(
du
) {

316 
du
[0] = 
PDU_TYPE_COMPLEX_ACK
;

317 
du
[1] = 
voke_id
;

318 
du
[2] = 
SERVICE_CONFIRMED_PRIVATE_TRANSFER
;

319 
du_n
 = 3;

328 
n
 =

329 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0,

330 
ive_da
->
vdID
);

331 
du_n
 +
n
;

332 
n
 =

333 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1,

334 
ive_da
->
rviNumb
);

335 
du_n
 +
n
;

336 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 2);

337 
du_n
 +
n
;

338 
n
 = 0; < 
ive_da
->
rviPamsL
;en++) {

339 
du
[
du_n
] = 
ive_da
->
rviPams
[
n
];

340 
du_n
++;

342 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 2);

343 
du_n
 +
n
;

346  
du_n
;

347 
	}
}

353 #ifde
TEST


354 
	~<as.h
>

355 
	~<rg.h
>

356 
	~"e.h
"

357 
	~"ba.h
"

359 
	$nsr_decode_du
(

360 
ut8_t
 * 
du
,

361 
du_n
,

362 
ut8_t
 * 
voke_id
,

363 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

365 
n
 = 0;

366 
offt
 = 0;

368 i(!
du
)

371 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

375 *
voke_id
 = 
du
[2];

376 i(
du
[3] !
SERVICE_CONFIRMED_PRIVATE_TRANSFER
)

378 
offt
 = 4;

380 i(
du_n
 > 
offt
) {

381 
n
 =

382 
	`nsr_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

383 
ive_da
);

386  
n
;

387 
	}
}

389 
	$unsr_decode_du
(

390 
ut8_t
 * 
du
,

391 
du_n
,

392 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

394 
n
 = 0;

395 
offt
 = 0;

397 i(!
du
) {

401 i(
du
[0] !
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
) {

404 i(
du
[1] !
SERVICE_UNCONFIRMED_PRIVATE_TRANSFER
) {

407 
offt
 = 2;

408 i(
du_n
 > 
offt
) {

409 
n
 =

410 
	`nsr_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

411 
ive_da
);

414  
n
;

415 
	}
}

417 
	$nsr_ack_decode_du
(

418 
ut8_t
 * 
du
,

419 
du_n
,

420 
ut8_t
 * 
voke_id
,

421 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

423 
n
 = 0;

424 
offt
 = 0;

426 i(!
du
)

429 i(
du
[0] !
PDU_TYPE_COMPLEX_ACK
)

431 *
voke_id
 = 
du
[1];

432 i(
du
[2] !
SERVICE_CONFIRMED_PRIVATE_TRANSFER
)

434 
offt
 = 3;

435 i(
du_n
 > 
offt
) {

436 
n
 =

437 
	`nsr_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

438 
ive_da
);

441  
n
;

442 
	}
}

444 
	$nsr_r_decode_du
(

445 
ut8_t
 * 
du
,

446 
du_n
,

447 
ut8_t
 * 
voke_id
,

448 
BACNET_ERROR_CLASS
 * 
r_ass
,

449 
BACNET_ERROR_CODE
 * 
r_code
,

450 
BACNET_PRIVATE_TRANSFER_DATA
 * 
ive_da
)

452 
n
 = 0;

453 
offt
 = 0;

455 i(!
du
)

458 i(
du
[0] !
PDU_TYPE_ERROR
)

460 *
voke_id
 = 
du
[1];

461 i(
du
[2] !
SERVICE_CONFIRMED_PRIVATE_TRANSFER
)

463 
offt
 = 3;

464 i(
du_n
 > 
offt
) {

465 
n
 =

466 
	`nsr_r_decode_rvi_que
(&
du
[
offt
],

467 
du_n
 - 
offt
, 
r_ass
, 
r_code
, 
ive_da
);

470  
n
;

471 
	}
}

473 
	$_Prive_Tnsr_Ack
(

474 
Te
 * 
pTe
)

476 
ut8_t
 
du
[480] = { 0 };

477 
n
 = 0;

478 
du_n
 = 0;

479 
ut8_t
 
voke_id
 = 128;

480 
ut8_t
 
_voke_id
 = 0;

481 
BACNET_PRIVATE_TRANSFER_DATA
 
ive_da
;

482 
BACNET_PRIVATE_TRANSFER_DATA
 
_da
;

483 
ut8_t
 
_vue
[480] = { 0 };

484 
ive_da_n
 = 0;

485 
ive_da_chunk
[33] = { "00112233445566778899AABBCCDDEEFF" };

486 
BACNET_APPLICATION_DATA_VALUE
 
da_vue
;

487 
BACNET_APPLICATION_DATA_VALUE
 
_da_vue
;

488 
bo
 
us
 = 
l
;

490 
ive_da
.
vdID
 = 
BACNET_VENDOR_ID
;

491 
ive_da
.
rviNumb
 = 1;

493 
us
 =

494 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_OCTET_STRING
,

495 &
ive_da_chunk
[0], &
da_vue
);

496 
	`_
(
pTe
, 
us
 =
ue
);

497 
ive_da_n
 =

498 
	`ba_code_iti_da
(&
_vue
[0], &
da_vue
);

500 
ive_da
.
rviPams
 = &
_vue
[0];

501 
ive_da
.
rviPamsL
 = 
ive_da_n
;

504 
n
 = 
	`nsr_ack_code_du
(&
du
[0], 
voke_id
, &
ive_da
);

505 
	`_
(
pTe
, 
n
 != 0);

506 
	`_
(
pTe
, 
n
 != -1);

507 
du_n
 = 
n
;

508 
n
 =

509 
	`nsr_ack_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

510 &
_da
);

511 
	`_
(
pTe
, 
n
 != -1);

512 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

513 
	`_
(
pTe
, 
_da
.
vdID
 =
ive_da
.vendorID);

514 
	`_
(
pTe
, 
_da
.
rviNumb
 =
ive_da
.serviceNumber);

515 
	`_
(
pTe
,

516 
_da
.
rviPamsL
 =
ive_da
.serviceParametersLen);

517 
n
 =

518 
	`ba_decode_iti_da
(
_da
.
rviPams
,

519 
_da
.
rviPamsL
, &
_da_vue
);

520 
	`_
(
pTe
, 
	`ba_me_vue
(&
da_vue
, &
_da_vue
=
ue
);

521 
	}
}

523 
	$_Prive_Tnsr_E
(

524 
Te
 * 
pTe
)

526 
ut8_t
 
du
[480] = { 0 };

527 
n
 = 0;

528 
du_n
 = 0;

529 
ut8_t
 
voke_id
 = 128;

530 
ut8_t
 
_voke_id
 = 0;

531 
BACNET_ERROR_CLASS
 
r_ass
 = 
ERROR_CLASS_RESOURCES
;

532 
BACNET_ERROR_CODE
 
r_code
 = 
ERROR_CODE_OPERATIONAL_PROBLEM
;

533 
BACNET_ERROR_CLASS
 
_r_ass
 = 0;

534 
BACNET_ERROR_CODE
 
_r_code
 = 0;

535 
BACNET_PRIVATE_TRANSFER_DATA
 
ive_da
;

536 
BACNET_PRIVATE_TRANSFER_DATA
 
_da
;

537 
ut8_t
 
_vue
[480] = { 0 };

538 
ive_da_n
 = 0;

539 
ive_da_chunk
[33] = { "00112233445566778899AABBCCDDEEFF" };

540 
BACNET_APPLICATION_DATA_VALUE
 
da_vue
;

541 
BACNET_APPLICATION_DATA_VALUE
 
_da_vue
;

542 
bo
 
us
 = 
l
;

544 
ive_da
.
vdID
 = 
BACNET_VENDOR_ID
;

545 
ive_da
.
rviNumb
 = 1;

547 
us
 =

548 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_OCTET_STRING
,

549 &
ive_da_chunk
[0], &
da_vue
);

550 
	`_
(
pTe
, 
us
 =
ue
);

551 
ive_da_n
 =

552 
	`ba_code_iti_da
(&
_vue
[0], &
da_vue
);

553 
ive_da
.
rviPams
 = &
_vue
[0];

554 
ive_da
.
rviPamsL
 = 
ive_da_n
;

556 
n
 =

557 
	`nsr_r_code_du
(&
du
[0], 
voke_id
, 
r_ass
,

558 
r_code
, &
ive_da
);

559 
	`_
(
pTe
, 
n
 != 0);

560 
	`_
(
pTe
, 
n
 != -1);

561 
du_n
 = 
n
;

562 
n
 =

563 
	`nsr_r_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

564 &
_r_ass
, &
_r_code
, &
_da
);

565 
	`_
(
pTe
, 
n
 != -1);

566 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

567 
	`_
(
pTe
, 
_da
.
vdID
 =
ive_da
.vendorID);

568 
	`_
(
pTe
, 
_da
.
rviNumb
 =
ive_da
.serviceNumber);

569 
	`_
(
pTe
, 
_r_ass
 =
r_ass
);

570 
	`_
(
pTe
, 
_r_code
 =
r_code
);

571 
	`_
(
pTe
,

572 
_da
.
rviPamsL
 =
ive_da
.serviceParametersLen);

573 
n
 =

574 
	`ba_decode_iti_da
(
_da
.
rviPams
,

575 
_da
.
rviPamsL
, &
_da_vue
);

576 
	`_
(
pTe
, 
	`ba_me_vue
(&
da_vue
, &
_da_vue
=
ue
);

577 
	}
}

579 
	$_Prive_Tnsr_Reque
(

580 
Te
 * 
pTe
)

582 
ut8_t
 
du
[480] = { 0 };

583 
ut8_t
 
_vue
[480] = { 0 };

584 
n
 = 0;

585 
du_n
 = 0;

586 
ut8_t
 
voke_id
 = 128;

587 
ut8_t
 
_voke_id
 = 0;

588 
ive_da_n
 = 0;

589 
ive_da_chunk
[33] = { "00112233445566778899AABBCCDDEEFF" };

590 
BACNET_APPLICATION_DATA_VALUE
 
da_vue
 = { 0 };

591 
BACNET_APPLICATION_DATA_VALUE
 
_da_vue
 = { 0 };

592 
BACNET_PRIVATE_TRANSFER_DATA
 
ive_da
 = { 0 };

593 
BACNET_PRIVATE_TRANSFER_DATA
 
_da
 = { 0 };

594 
bo
 
us
 = 
l
;

596 
ive_da
.
vdID
 = 
BACNET_VENDOR_ID
;

597 
ive_da
.
rviNumb
 = 1;

599 
us
 =

600 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_OCTET_STRING
,

601 &
ive_da_chunk
[0], &
da_vue
);

602 
	`_
(
pTe
, 
us
 =
ue
);

603 
ive_da_n
 =

604 
	`ba_code_iti_da
(&
_vue
[0], &
da_vue
);

605 
ive_da
.
rviPams
 = &
_vue
[0];

606 
ive_da
.
rviPamsL
 = 
ive_da_n
;

608 
n
 = 
	`nsr_code_du
(&
du
[0], 
voke_id
, &
ive_da
);

609 
	`_
(
pTe
, 
n
 != 0);

610 
du_n
 = 
n
;

611 
n
 =

612 
	`nsr_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
_da
);

613 
	`_
(
pTe
, 
n
 != -1);

614 
	`_
(
pTe
, 
_da
.
vdID
 =
ive_da
.vendorID);

615 
	`_
(
pTe
, 
_da
.
rviNumb
 =
ive_da
.serviceNumber);

616 
	`_
(
pTe
,

617 
_da
.
rviPamsL
 =
ive_da
.serviceParametersLen);

618 
n
 =

619 
	`ba_decode_iti_da
(
_da
.
rviPams
,

620 
_da
.
rviPamsL
, &
_da_vue
);

621 
	`_
(
pTe
, 
	`ba_me_vue
(&
da_vue
, &
_da_vue
=
ue
);

624 
	}
}

626 
	$_Uncfmed_Prive_Tnsr_Reque
(

627 
Te
 * 
pTe
)

629 
ut8_t
 
du
[480] = { 0 };

630 
ut8_t
 
_vue
[480] = { 0 };

631 
n
 = 0;

632 
du_n
 = 0;

633 
ive_da_n
 = 0;

634 
ive_da_chunk
[32] = { "I Love You, Patricia!" };

635 
BACNET_APPLICATION_DATA_VALUE
 
da_vue
;

636 
BACNET_APPLICATION_DATA_VALUE
 
_da_vue
;

637 
BACNET_PRIVATE_TRANSFER_DATA
 
ive_da
;

638 
BACNET_PRIVATE_TRANSFER_DATA
 
_da
;

639 
bo
 
us
 = 
l
;

641 
ive_da
.
vdID
 = 
BACNET_VENDOR_ID
;

642 
ive_da
.
rviNumb
 = 1;

644 
us
 =

645 
	`ba_r_iti_da
(
BACNET_APPLICATION_TAG_CHARACTER_STRING
,

646 &
ive_da_chunk
[0], &
da_vue
);

647 
	`_
(
pTe
, 
us
 =
ue
);

648 
ive_da_n
 =

649 
	`ba_code_iti_da
(&
_vue
[0], &
da_vue
);

650 
ive_da
.
rviPams
 = &
_vue
[0];

651 
ive_da
.
rviPamsL
 = 
ive_da_n
;

653 
n
 = 
	`unsr_code_du
(&
du
[0], &
ive_da
);

654 
	`_
(
pTe
, 
n
 != 0);

655 
du_n
 = 
n
;

656 
n
 = 
	`unsr_decode_du
(&
du
[0], 
du_n
, &
_da
);

657 
	`_
(
pTe
, 
n
 != -1);

658 
	`_
(
pTe
, 
_da
.
vdID
 =
ive_da
.vendorID);

659 
	`_
(
pTe
, 
_da
.
rviNumb
 =
ive_da
.serviceNumber);

660 
	`_
(
pTe
,

661 
_da
.
rviPamsL
 =
ive_da
.serviceParametersLen);

662 
n
 =

663 
	`ba_decode_iti_da
(
_da
.
rviPams
,

664 
_da
.
rviPamsL
, &
_da_vue
);

665 
	`_
(
pTe
, 
	`ba_me_vue
(&
da_vue
, &
_da_vue
=
ue
);

668 
	}
}

670 #ifde
TEST_PRIVATE_TRANSFER


671 
	$ma
(

674 
Te
 *
pTe
;

675 
bo
 
rc
;

677 
pTe
 = 
	`_
("BACÈPriveTnsr", 
NULL
);

679 
rc
 = 
	`_addTeFuni
(
pTe
, 
_Prive_Tnsr_Reque
);

680 
	`as
(
rc
);

681 
rc
 = 
	`_addTeFuni
(
pTe
, 
_Prive_Tnsr_Ack
);

682 
	`as
(
rc
);

683 
rc
 = 
	`_addTeFuni
(
pTe
, 
_Prive_Tnsr_E
);

684 
	`as
(
rc
);

685 
rc
 = 
	`_addTeFuni
(
pTe
, 
_Uncfmed_Prive_Tnsr_Reque
);

686 
	`as
(
rc
);

688 
	`_tSm
(
pTe
, 
dout
);

689 
	`_run
(
pTe
);

690 (
	`_pt
(
pTe
);

691 
	`_deroy
(
pTe
);

694 
	}
}

	@src/rd.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"rd.h
"

41 #i
BACNET_SVC_RD_A


43 
	$rd_code_du
(

44 
ut8_t
 * 
du
,

45 
ut8_t
 
voke_id
,

46 
BACNET_REINITIALIZED_STATE
 
e
,

47 
BACNET_CHARACTER_STRING
 * 
sswd
)

49 
n
 = 0;

50 
du_n
 = 0;

52 i(
du
) {

53 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

54 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

55 
du
[2] = 
voke_id
;

56 
du
[3] = 
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
;

57 
du_n
 = 4;

58 
n
 = 
	`code_cڋxt_umed
(&
du
[
du_n
], 0, 
e
);

59 
du_n
 +
n
;

61 i(
sswd
) {

63 
n
 =

64 
	`code_cڋxt_cha_rg
(&
du
[
du_n
], 1, 
sswd
);

65 
du_n
 +
n
;

69  
du_n
;

70 
	}
}

74 
	$rd_decode_rvi_que
(

75 
ut8_t
 * 
du
,

76 
du_n
,

77 
BACNET_REINITIALIZED_STATE
 * 
e
,

78 
BACNET_CHARACTER_STRING
 * 
sswd
)

80 
n
 = 0;

81 
ut8_t
 
g_numb
 = 0;

82 
ut32_t
 
n_vue_ty
 = 0;

83 
ut32_t
 
vue
 = 0;

86 i(
du_n
) {

88 i(!
	`decode_is_cڋxt_g
(&
du
[
n
], 0))

90 
n
 +=

91 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

92 &
n_vue_ty
);

93 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
vue
);

94 i(
e
)

95 *
e
 = (
BACNET_REINITIALIZED_STATE

vue
;

97 i(
n
 < 
du_n
) {

98 i(!
	`decode_is_cڋxt_g
(&
du
[
n
], 1))

100 
n
 +=

101 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

102 &
n_vue_ty
);

103 
n
 +=

104 
	`decode_cha_rg
(&
du
[
n
], 
n_vue_ty
, 
sswd
);

108  (
n
;

109 
	}
}

111 #ifde
TEST


112 
	~<as.h
>

113 
	~<rg.h
>

114 
	~"e.h
"

116 
	$rd_decode_du
(

117 
ut8_t
 * 
du
,

118 
du_n
,

119 
ut8_t
 * 
voke_id
,

120 
BACNET_REINITIALIZED_STATE
 * 
e
,

121 
BACNET_CHARACTER_STRING
 * 
sswd
)

123 
n
 = 0;

124 
offt
 = 0;

126 i(!
du
)

129 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

132 *
voke_id
 = 
du
[2];

133 i(
du
[3] !
SERVICE_CONFIRMED_REINITIALIZE_DEVICE
)

135 
offt
 = 4;

137 i(
du_n
 > 
offt
) {

138 
n
 =

139 
	`rd_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offt, 
e
,

140 
sswd
);

143  
n
;

144 
	}
}

146 
	$_RelizeDevi
(

147 
Te
 * 
pTe
)

149 
ut8_t
 
du
[480] = { 0 };

150 
n
 = 0;

151 
du_n
 = 0;

152 
ut8_t
 
voke_id
 = 128;

153 
ut8_t
 
_voke_id
 = 0;

154 
BACNET_REINITIALIZED_STATE
 
e
;

155 
BACNET_REINITIALIZED_STATE
 
_e
;

156 
BACNET_CHARACTER_STRING
 
sswd
;

157 
BACNET_CHARACTER_STRING
 
_sswd
;

159 
e
 = 
BACNET_REINIT_WARMSTART
;

160 
	`charg__si
(&
sswd
, "John 3:16");

161 
n
 = 
	`rd_code_du
(&
du
[0], 
voke_id
, 
e
, &
sswd
);

162 
	`_
(
pTe
, 
n
 != 0);

163 
du_n
 = 
n
;

165 
n
 =

166 
	`rd_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
_e
,

167 &
_sswd
);

168 
	`_
(
pTe
, 
n
 != -1);

169 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

170 
	`_
(
pTe
, 
_e
 =
e
);

171 
	`_
(
pTe
, 
	`charg_me
(&
_sswd
, &
sswd
));

174 
	}
}

176 #ifde
TEST_REINITIALIZE_DEVICE


177 
	$ma
(

180 
Te
 *
pTe
;

181 
bo
 
rc
;

183 
pTe
 = 
	`_
("BACÈRelizeDevi", 
NULL
);

185 
rc
 = 
	`_addTeFuni
(
pTe
, 
_RelizeDevi
);

186 
	`as
(
rc
);

188 
	`_tSm
(
pTe
, 
dout
);

189 
	`_run
(
pTe
);

190 (
	`_pt
(
pTe
);

191 
	`_deroy
(
pTe
);

194 
	}
}

	@src/readrange.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"adnge.h
"

70 
	$_code_du
(

71 
ut8_t
 * 
du
,

72 
ut8_t
 
voke_id
,

73 
BACNET_READ_RANGE_DATA
 * 
da
)

75 
du_n
 = 0;

77 i(
du
) {

78 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

79 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

80 
du
[2] = 
voke_id
;

81 
du
[3] = 
SERVICE_CONFIRMED_READ_RANGE
;

82 
du_n
 = 4;

84 
du_n
 +=

85 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0, 
da
->
obje_ty
,

86 
da
->
obje_
);

87 
du_n
 +=

88 
	`code_cڋxt_umed
(&
du
[
du_n
], 1,

89 
da
->
obje_ݔty
);

93 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

94 
du_n
 +=

95 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 2,

96 
da
->
y_dex
);

101 
da
->
RequeTy
) {

102 
RR_BY_POSITION
:

103 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 3);

104 
du_n
 +=

105 
	`code_iti_unsigd
(&
du
[
du_n
],

106 
da
->
Rge
.
RefIndex
);

107 
du_n
 +=

108 
	`code_iti_sigd
(&
du
[
du_n
], 
da
->
Cou
);

109 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 3);

112 
RR_BY_SEQUENCE
:

113 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 6);

114 
du_n
 +=

115 
	`code_iti_unsigd
(&
du
[
du_n
],

116 
da
->
Rge
.
RefSeqNum
);

117 
du_n
 +=

118 
	`code_iti_sigd
(&
du
[
du_n
], 
da
->
Cou
);

119 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 6);

122 
RR_BY_TIME
:

123 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 7);

124 
du_n
 +=

125 
	`code_iti_de
(&
du
[
du_n
],

126 &
da
->
Rge
.
RefTime
.
de
);

127 
du_n
 +=

128 
	`code_iti_time
(&
du
[
du_n
],

129 &
da
->
Rge
.
RefTime
.
time
);

130 
du_n
 +=

131 
	`code_iti_sigd
(&
du
[
du_n
], 
da
->
Cou
);

132 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 7);

135 
RR_READ_ALL
:

143  
du_n
;

144 
	}
}

150 
	$_decode_rvi_que
(

151 
ut8_t
 * 
du
,

152 
du_n
,

153 
BACNET_READ_RANGE_DATA
 * 
da
)

155 
n
 = 0;

156 
TagL
 = 0;

157 
ut8_t
 
g_numb
 = 0;

158 
ut32_t
 
n_vue_ty
 = 0;

159 
ut16_t
 
ty
 = 0;

160 
ut32_t
 
UnsigdTemp
;

163 i(
du_n
 && 
da
) {

165 i(!
	`decode_is_cڋxt_g
(&
du
[
n
++], 0))

167 
n
 +
	`decode_obje_id
(&
du
[n], &
ty
, &
da
->
obje_
);

168 
da
->
obje_ty
 = (
BACNET_OBJECT_TYPE

ty
;

170 
n
 +=

171 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

172 &
n_vue_ty
);

173 i(
g_numb
 != 1)

175 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
UnsigdTemp
);

176 
da
->
obje_ݔty
 = (
BACNET_PROPERTY_ID

UnsigdTemp
;

177 
da
->
Ovhd
 = 
RR_OVERHEAD
;

180 
da
->
y_dex
 = 
BACNET_ARRAY_ALL
;

181 i(
n
 < 
du_n
) {

182 
TagL
 =

183 (
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

184 &
n_vue_ty
);

185 i(
g_numb
 == 2) {

186 
n
 +
TagL
;

187 
n
 +=

188 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
, &
UnsigdTemp
);

189 
da
->
y_dex
 = 
UnsigdTemp
;

190 
da
->
Ovhd
 +
RR_INDEX_OVERHEAD
;

194 
da
->
RequeTy
 = 
RR_READ_ALL
;

195 i(
n
 < 
du_n
) {

203 
n
 +=

204 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

205 &
n_vue_ty
);

206 
g_numb
) {

208 
da
->
RequeTy
 = 
RR_BY_POSITION
;

209 
n
 +=

210 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

211 &
n_vue_ty
);

212 
n
 +=

213 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
,

214 &
da
->
Rge
.
RefIndex
);

215 
n
 +=

216 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

217 &
n_vue_ty
);

218 
n
 +=

219 
	`decode_sigd
(&
du
[
n
], 
n_vue_ty
,

220 &
da
->
Cou
);

221 
n
 +=

222 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

223 &
n_vue_ty
);

227 
da
->
RequeTy
 = 
RR_BY_SEQUENCE
;

228 
n
 +=

229 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

230 &
n_vue_ty
);

231 
n
 +=

232 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
,

233 &
da
->
Rge
.
RefSeqNum
);

234 
n
 +=

235 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

236 &
n_vue_ty
);

237 
n
 +=

238 
	`decode_sigd
(&
du
[
n
], 
n_vue_ty
,

239 &
da
->
Cou
);

240 
n
 +=

241 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

242 &
n_vue_ty
);

243 
da
->
Ovhd
 +
RR_1ST_SEQ_OVERHEAD
;

247 
da
->
RequeTy
 = 
RR_BY_TIME
;

248 
n
 +=

249 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

250 &
n_vue_ty
);

251 
n
 +=

252 
	`decode_de
(&
du
[
n
], &
da
->
Rge
.
RefTime
.
de
);

253 
n
 +=

254 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

255 &
n_vue_ty
);

256 
n
 +=

257 
	`decode_ba_time
(&
du
[
n
],

258 &
da
->
Rge
.
RefTime
.
time
);

259 
n
 +=

260 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

261 &
n_vue_ty
);

262 
n
 +=

263 
	`decode_sigd
(&
du
[
n
], 
n_vue_ty
,

264 &
da
->
Cou
);

265 
n
 +=

266 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

267 &
n_vue_ty
);

268 
da
->
Ovhd
 +
RR_1ST_SEQ_OVERHEAD
;

278  (
n
;

279 
	}
}

298 
	$_ack_code_du
(

299 
ut8_t
 * 
du
,

300 
ut8_t
 
voke_id
,

301 
BACNET_READ_RANGE_DATA
 * 
da
)

303 
n
 = 0;

304 
du_n
 = 0;

306 i(
du
) {

307 
du
[0] = 
PDU_TYPE_COMPLEX_ACK
;

308 
du
[1] = 
voke_id
;

309 
du
[2] = 
SERVICE_CONFIRMED_READ_RANGE
;

310 
du_n
 = 3;

312 
du_n
 +=

313 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0, 
da
->
obje_ty
,

314 
da
->
obje_
);

315 
du_n
 +=

316 
	`code_cڋxt_umed
(&
du
[
du_n
], 1,

317 
da
->
obje_ݔty
);

319 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

320 
du_n
 +=

321 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 2,

322 
da
->
y_dex
);

325 
du_n
 +=

326 
	`code_cڋxt_brg
(&
du
[
du_n
], 3, &
da
->
ResuFgs
);

328 
du_n
 +=

329 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 4, 
da
->
ImCou
);

333 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 5);

334 i(
da
->
ImCou
 != 0) {

335 
n
 = 0; < 
da
->
iti_da_n
;en++) {

336 
du
[
du_n
++] = 
da
->
iti_da
[
n
];

339 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 5);

341 i((
da
->
ImCou
 !0&& (da->
RequeTy
 !
RR_BY_POSITION
)

342 && (
da
->
RequeTy
 !
RR_READ_ALL
)) {

344 
du_n
 +=

345 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 6,

346 
da
->
FSequ
);

350  
du_n
;

351 
	}
}

357 
	$_ack_decode_rvi_que
(

358 
ut8_t
 * 
du
,

359 
du_n
,

360 
BACNET_READ_RANGE_DATA
 * 
da
)

362 
ut8_t
 
g_numb
 = 0;

363 
ut32_t
 
n_vue_ty
 = 0;

364 
g_n
 = 0;

365 
n
 = 0;

366 
t_n
;

367 
ut16_t
 
obje
 = 0;

368 
ut32_t
 
ݔty
 = 0;

369 
ut32_t
 
y_vue
 = 0;

373 i(!
	`decode_is_cڋxt_g
(&
du
[0], 0))

375 
n
 = 1;

376 
n
 +
	`decode_obje_id
(&
du
[n], &
obje
, &
da
->
obje_
);

377 
da
->
obje_ty
 = (
BACNET_OBJECT_TYPE

obje
;

380 
n
 +=

381 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue_ty
);

382 i(
g_numb
 != 1)

384 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
ݔty
);

385 
da
->
obje_ݔty
 = (
BACNET_PROPERTY_ID

ݔty
;

388 
g_n
 =

389 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue_ty
);

390 i(
g_numb
 == 2) {

391 
n
 +
g_n
;

392 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue_ty
, &
y_vue
);

393 
da
->
y_dex
 = 
y_vue
;

395 
da
->
y_dex
 = 
BACNET_ARRAY_ALL
;

398 
n
 +=

399 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue_ty
);

400 i(
g_numb
 != 3)

403 
n
 +
	`decode_brg
(&
du
[n], 
n_vue_ty
, &
da
->
ResuFgs
);

406 
n
 +=

407 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue_ty
);

408 i(
g_numb
 != 4)

411 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue_ty
, &
da
->
ImCou
);

413 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 5)) {

414 
n
++;

417 
da
->
iti_da
 = &
du
[
n
];

418 
t_n
 = 
n
;

419 
n
 < 
du_n
) {

420 i(
	`IS_CONTEXT_SPECIFIC
(
du
[
n
]) &&

421 (
	`decode_is_osg_g_numb
(&
du
[
n
], 5))) {

422 
da
->
iti_da_n
 = 
n
 - 
t_n
;

423 
n
++;

427 
n
 +=

428 
	`decode_g_numb_d_vue
(&
du
[
n
], 
NULL
,

429 &
n_vue_ty
);

430 
n
 +
n_vue_ty
;

431 i(
n
 >
du_n
)

438 i(
n
 < 
du_n
) {

440 
n
 +=

441 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

442 &
n_vue_ty
);

443 i(
g_numb
 != 6)

446 
n
 +=

447 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
,

448 &
da
->
FSequ
);

451 
n
 = 
du_n
;

452  
n
;

453 
	}
}

	@src/reject.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"je.h
"

49 
BACNET_REJECT_REASON
 
	$je_cvt_r_code
(

50 
BACNET_ERROR_CODE
 
r_code
)

52 
BACNET_REJECT_REASON
 
je_code
 = 
REJECT_REASON_OTHER
;

54 
r_code
) {

55 
ERROR_CODE_REJECT_BUFFER_OVERFLOW
:

56 
je_code
 = 
REJECT_REASON_BUFFER_OVERFLOW
;

58 
ERROR_CODE_REJECT_INCONSISTENT_PARAMETERS
:

59 
je_code
 = 
REJECT_REASON_INCONSISTENT_PARAMETERS
;

61 
ERROR_CODE_REJECT_INVALID_PARAMETER_DATA_TYPE
:

62 
je_code
 = 
REJECT_REASON_INVALID_PARAMETER_DATA_TYPE
;

64 
ERROR_CODE_REJECT_INVALID_TAG
:

65 
je_code
 = 
REJECT_REASON_INVALID_TAG
;

67 
ERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
:

68 
je_code
 = 
REJECT_REASON_MISSING_REQUIRED_PARAMETER
;

70 
ERROR_CODE_REJECT_PARAMETER_OUT_OF_RANGE
:

71 
je_code
 = 
REJECT_REASON_PARAMETER_OUT_OF_RANGE
;

73 
ERROR_CODE_REJECT_TOO_MANY_ARGUMENTS
:

74 
je_code
 = 
REJECT_REASON_TOO_MANY_ARGUMENTS
;

76 
ERROR_CODE_REJECT_UNDEFINED_ENUMERATION
:

77 
je_code
 = 
REJECT_REASON_UNDEFINED_ENUMERATION
;

79 
ERROR_CODE_REJECT_UNRECOGNIZED_SERVICE
:

80 
je_code
 = 
REJECT_REASON_UNRECOGNIZED_SERVICE
;

82 
ERROR_CODE_REJECT_PROPRIETARY
:

83 
je_code
 = 
FIRST_PROPRIETARY_REJECT_REASON
;

85 
ERROR_CODE_REJECT_OTHER
:

87 
je_code
 = 
REJECT_REASON_OTHER
;

91  (
je_code
);

92 
	}
}

95 
	$je_code_du
(

96 
ut8_t
 * 
du
,

97 
ut8_t
 
voke_id
,

98 
ut8_t
 
je_as
)

100 
du_n
 = 0;

102 i(
du
) {

103 
du
[0] = 
PDU_TYPE_REJECT
;

104 
du
[1] = 
voke_id
;

105 
du
[2] = 
je_as
;

106 
du_n
 = 3;

109  
du_n
;

110 
	}
}

112 #i!
BACNET_SVC_SERVER


114 
	$je_decode_rvi_que
(

115 
ut8_t
 * 
du
,

116 
du_n
,

117 
ut8_t
 * 
voke_id
,

118 
ut8_t
 * 
je_as
)

120 
n
 = 0;

122 i(
du_n
) {

123 i(
voke_id
)

124 *
voke_id
 = 
du
[0];

125 i(
je_as
)

126 *
je_as
 = 
du
[1];

129  
n
;

130 
	}
}

133 #ifde
TEST


134 
	~<as.h
>

135 
	~<rg.h
>

136 
	~"e.h
"

139 
	$je_decode_du
(

140 
ut8_t
 * 
du
,

141 
du_n
,

142 
ut8_t
 * 
voke_id
,

143 
ut8_t
 * 
je_as
)

145 
n
 = 0;

147 i(!
du
)

150 i(
du_n
) {

151 i(
du
[0] !
PDU_TYPE_REJECT
)

153 i(
du_n
 > 1) {

154 
n
 =

155 
	`je_decode_rvi_que
(&
du
[1], 
du_n
 - 1,

156 
voke_id
, 
je_as
);

160  
n
;

161 
	}
}

163 
	$Reje
(

164 
Te
 * 
pTe
)

166 
ut8_t
 
du
[480] = { 0 };

167 
n
 = 0;

168 
du_n
 = 0;

169 
ut8_t
 
voke_id
 = 0;

170 
ut8_t
 
je_as
 = 0;

171 
ut8_t
 
_voke_id
 = 0;

172 
ut8_t
 
_je_as
 = 0;

174 
n
 = 
	`je_code_du
(&
du
[0], 
voke_id
, 
je_as
);

175 
	`_
(
pTe
, 
n
 != 0);

176 
du_n
 = 
n
;

178 
n
 =

179 
	`je_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

180 &
_je_as
);

181 
	`_
(
pTe
, 
n
 != -1);

182 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

183 
	`_
(
pTe
, 
_je_as
 =
je_as
);

186 
du
[0] = 
PDU_TYPE_ABORT
;

187 
n
 =

188 
	`je_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

189 &
_je_as
);

190 
	`_
(
pTe
, 
n
 == -1);

193 
n
 =

194 
	`je_decode_du
(
NULL
, 
du_n
, &
_voke_id
,

195 &
_je_as
);

196 
	`_
(
pTe
, 
n
 == -1);

199 
n
 =

200 
	`je_decode_du
(&
du
[0], 0, &
_voke_id
, &
_je_as
);

201 
	`_
(
pTe
, 
n
 == 0);

205 
voke_id
 = 0; invoke_id < 255; invoke_id++) {

206 
je_as
 = 0;eject_reason < 255;eject_reason++) {

207 
n
 = 
	`je_code_du
(&
du
[0], 
voke_id
, 
je_as
);

208 
du_n
 = 
n
;

209 
	`_
(
pTe
, 
n
 != 0);

210 
n
 =

211 
	`je_decode_du
(&
du
[0], 
du_n
, &
_voke_id
,

212 &
_je_as
);

213 
	`_
(
pTe
, 
n
 != -1);

214 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

215 
	`_
(
pTe
, 
_je_as
 =
je_as
);

218 
	}
}

220 #ifde
TEST_REJECT


221 
	$ma
(

224 
Te
 *
pTe
;

225 
bo
 
rc
;

227 
pTe
 = 
	`_
("BACÈReje", 
NULL
);

229 
rc
 = 
	`_addTeFuni
(
pTe
, 
Reje
);

230 
	`as
(
rc
);

232 
	`_tSm
(
pTe
, 
dout
);

233 
	`_run
(
pTe
);

234 (
	`_pt
(
pTe
);

235 
	`_deroy
(
pTe
);

238 
	}
}

	@src/ringbuf.c

39 
	~<ddef.h
>

40 
	~<dbo.h
>

41 
	~<dt.h
>

42 
	~"rgbuf.h
"

50 
	$Rgbuf_Cou
(

51 
RING_BUFFER
 cڡ *
b
)

53 
hd
, 

;

55 i(
b
) {

56 
hd
 = 
b
->head;

57 

 = 
b
->tail;

58  
hd
 - 

;

62 
	}
}

70 
bo
 
	$Rgbuf_Fu
(

71 
RING_BUFFER
 cڡ *
b
)

73  (
b
 ? (
	`Rgbuf_Cou
(b=b->
emt_cou
: 
ue
);

74 
	}
}

82 
bo
 
	$Rgbuf_Emy
(

83 
RING_BUFFER
 cڡ *
b
)

85  (
b
 ? (
	`Rgbuf_Cou
(b=0: 
ue
);

86 
	}
}

94 vީ
ut8_t
 *
	$Rgbuf_Pk
(

95 
RING_BUFFER
 cڡ *
b
)

97 vީ
ut8_t
 *
da_emt
 = 
NULL
;

99 i(!
	`Rgbuf_Emy
(
b
)) {

100 
da_emt
 = 
b
->
bufr
;

101 
da_emt
 +((
b
->

 % b->
emt_cou
* b->
emt_size
);

104  
da_emt
;

105 
	}
}

113 
bo
 
	$Rgbuf_P
(

114 
RING_BUFFER
 * 
b
,

115 
ut8_t
 * 
da_emt
)

117 
bo
 
us
 = 
l
;

118 vީ
ut8_t
 *
rg_da
 = 
NULL
;

119 
i
;

121 i(!
	`Rgbuf_Emy
(
b
)) {

122 
rg_da
 = 
b
->
bufr
;

123 
rg_da
 +((
b
->

 % b->
emt_cou
* b->
emt_size
);

124 i(
da_emt
) {

125 
i
 = 0; i < 
b
->
emt_size
; i++) {

126 
da_emt
[
i
] = 
rg_da
[i];

129 
b
->

++;

130 
us
 = 
ue
;

133  
us
;

134 
	}
}

142 
bo
 
	$Rgbuf_Put
(

143 
RING_BUFFER
 * 
b
,

144 
ut8_t
 * 
da_emt
)

146 
bo
 
us
 = 
l
;

147 vީ
ut8_t
 *
rg_da
 = 
NULL
;

148 
i
;

150 i(
b
 && 
da_emt
) {

152 i(!
	`Rgbuf_Fu
(
b
)) {

153 
rg_da
 = 
b
->
bufr
;

154 
rg_da
 +((
b
->
hd
 % b->
emt_cou
* b->
emt_size
);

155 
i
 = 0; i < 
b
->
emt_size
; i++) {

156 
rg_da
[
i
] = 
da_emt
[i];

158 
b
->
hd
++;

159 
us
 = 
ue
;

163  
us
;

164 
	}
}

174 
bo
 
	$Rgbuf_Put_Frt
(

175 
RING_BUFFER
 * 
b
,

176 
ut8_t
 * 
da_emt
)

178 
bo
 
us
 = 
l
;

179 vީ
ut8_t
 *
rg_da
 = 
NULL
;

180 
i
 = 0;

182 i(
b
 && 
da_emt
) {

184 i(!
	`Rgbuf_Fu
(
b
)) {

185 
b
->

--;

186 
rg_da
 = 
b
->
bufr
;

187 
rg_da
 +((
b
->

 % b->
emt_cou
* b->
emt_size
);

189 
i
 = 0; i < 
b
->
emt_size
; i++) {

190 
rg_da
[
i
] = 
da_emt
[i];

192 
us
 = 
ue
;

196  
us
;

197 
	}
}

206 vީ
ut8_t
 *
	$Rgbuf_Da_Pk
(
RING_BUFFER
 * 
b
)

208 vީ
ut8_t
 *
rg_da
 = 
NULL
;

210 i(
b
) {

212 i(!
	`Rgbuf_Fu
(
b
)) {

213 
rg_da
 = 
b
->
bufr
;

214 
rg_da
 +((
b
->
hd
 % b->
emt_cou
* b->
emt_size
);

218  
rg_da
;

219 
	}
}

229 
bo
 
	$Rgbuf_Da_Put
(
RING_BUFFER
 * 
b
, vީ
ut8_t
 *
da_emt
)

231 
bo
 
us
 = 
l
;

232 vީ
ut8_t
 *
rg_da
 = 
NULL
;

234 i(
b
) {

236 i(!
	`Rgbuf_Fu
(
b
)) {

237 
rg_da
 = 
b
->
bufr
;

238 
rg_da
 +((
b
->
hd
 % b->
emt_cou
* b->
emt_size
);

239 i(
rg_da
 =
da_emt
) {

241 
b
->
hd
++;

242 
us
 = 
ue
;

247  
us
;

248 
	}
}

257 
	$Rgbuf_In
(

258 
RING_BUFFER
 * 
b
,

259 vީ
ut8_t
 * 
bufr
,

260 
emt_size
,

261 
emt_cou
)

263 i(
b
) {

264 
b
->
hd
 = 0;

265 
b
->

 = 0;

266 
b
->
bufr
 = buffer;

267 
b
->
emt_size
 =lement_size;

268 
b
->
emt_cou
 =lement_count;

272 
	}
}

274 #ifde
TEST


275 
	~<as.h
>

276 
	~<rg.h
>

277 
	~<lims.h
>

278 
	~"e.h
"

281 
	$RgAroundBufr
(

282 
Te
 * 
pTe
,

283 
RING_BUFFER
 * 
_bufr
,

284 
ut8_t
 * 
da_emt
,

285 
emt_size
,

286 
emt_cou
)

288 vީ
ut8_t
 *
_da
;

289 
dex
;

290 
da_dex
;

291 
cou
;

292 
dummy
;

293 
bo
 
us
;

295 
	`_
(
pTe
, 
	`Rgbuf_Emy
(
_bufr
));

297 
dex
 = 0; index < 
emt_cou
; index++) {

298 
cou
 = 1; count < 4; count++) {

299 
dummy
 = 
dex
 * 
cou
;

300 
da_dex
 = 0; da_dex < 
emt_size
; data_index++) {

301 
da_emt
[
da_dex
] = 
dummy
;

303 
us
 = 
	`Rgbuf_Put
(
_bufr
, 
da_emt
);

304 
	`_
(
pTe
, 
us
 =
ue
);

307 
cou
 = 1; count < 4; count++) {

308 
dummy
 = 
dex
 * 
cou
;

309 
_da
 = 
	`Rgbuf_Pk
(
_bufr
);

310 
	`_
(
pTe
, 
_da
);

311 i(
_da
) {

312 
da_dex
 = 0; da_dex < 
emt_size
; data_index++) {

313 
	`_
(
pTe
, 
_da
[
da_dex
] =
dummy
);

316 (
	`Rgbuf_P
(
_bufr
, 
NULL
);

319 
	`_
(
pTe
, 
	`Rgbuf_Emy
(
_bufr
));

320 
	}
}

323 
	$RgBuf
(

324 
Te
 * 
pTe
,

325 
ut8_t
 * 
da_e
,

326 
ut8_t
 * 
da_emt
,

327 
emt_size
,

328 
emt_cou
)

330 
RING_BUFFER
 
_bufr
;

331 vީ
ut8_t
 *
_da
;

332 
dex
;

333 
da_dex
;

334 
bo
 
us
;

336 
	`Rgbuf_In
(&
_bufr
, 
da_e
, 
emt_size
, 
emt_cou
);

337 
	`_
(
pTe
, 
	`Rgbuf_Emy
(&
_bufr
));

339 
da_dex
 = 0; da_dex < 
emt_size
; data_index++) {

340 
da_emt
[
da_dex
] = data_index;

342 
us
 = 
	`Rgbuf_Put
(&
_bufr
, 
da_emt
);

343 
	`_
(
pTe
, 
us
 =
ue
);

344 
	`_
(
pTe
, !
	`Rgbuf_Emy
(&
_bufr
));

346 
_da
 = 
	`Rgbuf_Pk
(&
_bufr
);

347 
da_dex
 = 0; da_dex < 
emt_size
; data_index++) {

348 
	`_
(
pTe
, 
_da
[
da_dex
] =
da_emt
[data_index]);

350 
	`_
(
pTe
, !
	`Rgbuf_Emy
(&
_bufr
));

351 (
	`Rgbuf_P
(&
_bufr
, 
NULL
);

352 
	`_
(
pTe
, 
	`Rgbuf_Emy
(&
_bufr
));

355 
dex
 = 0; index < 
emt_cou
; index++) {

356 
da_dex
 = 0; da_dex < 
emt_size
; data_index++) {

357 
da_emt
[
da_dex
] = 
dex
;

359 
us
 = 
	`Rgbuf_Put
(&
_bufr
, 
da_emt
);

360 
	`_
(
pTe
, 
us
 =
ue
);

361 
	`_
(
pTe
, !
	`Rgbuf_Emy
(&
_bufr
));

364 
dex
 = 0; index < 
emt_cou
; index++) {

365 
da_dex
 = 0; da_dex < 
emt_size
; data_index++) {

366 
da_emt
[
da_dex
] = 
dex
;

368 
us
 = 
	`Rgbuf_Put
(&
_bufr
, 
da_emt
);

369 
	`_
(
pTe
, 
us
 =
l
);

370 
	`_
(
pTe
, !
	`Rgbuf_Emy
(&
_bufr
));

374 
dex
 = 0; index < 
emt_cou
; index++) {

375 
_da
 = 
	`Rgbuf_Pk
(&
_bufr
);

376 
	`_
(
pTe
, 
_da
);

377 i(
_da
) {

378 
da_dex
 = 0; da_dex < 
emt_size
; data_index++) {

379 
	`_
(
pTe
, 
_da
[
da_dex
] =
dex
);

382 (
	`Rgbuf_P
(&
_bufr
, 
NULL
);

384 
	`_
(
pTe
, 
	`Rgbuf_Emy
(&
_bufr
));

386 
	`RgAroundBufr
(
pTe
, &
_bufr
, 
da_emt
, 
emt_size
,

387 
emt_cou
);

390 
_bufr
.
hd
 = 
UINT_MAX
 - 1;

391 
_bufr
.

 = 
UINT_MAX
 - 1;

393 
	`RgAroundBufr
(
pTe
, &
_bufr
, 
da_emt
, 
emt_size
,

394 
emt_cou
);

397 
	}
}

399 
	$RgBufSize16
(

400 
Te
 * 
pTe
)

402 
ut8_t
 
da_emt
[5];

403 
ut8_t
 
da_e
[(
da_emt
) * 16];

405 
	`RgBuf
(
pTe
, 
da_e
, 
da_emt
, (data_element),

406 (
da_e
/ (
da_emt
));

407 
	}
}

409 
	$RgBufSize32
(

410 
Te
 * 
pTe
)

412 
ut8_t
 
da_emt
[16];

413 
ut8_t
 
da_e
[(
da_emt
) * 32];

415 
	`RgBuf
(
pTe
, 
da_e
, 
da_emt
, (data_element),

416 (
da_e
/ (
da_emt
));

417 
	}
}

420 #ifde
TEST_RING_BUFFER


421 
	$ma
(

424 
Te
 *
pTe
;

425 
bo
 
rc
;

427 
pTe
 = 
	`_
("Rg Bufr", 
NULL
);

430 
rc
 = 
	`_addTeFuni
(
pTe
, 
RgBufSize16
);

431 
	`as
(
rc
);

432 
rc
 = 
	`_addTeFuni
(
pTe
, 
RgBufSize32
);

433 
	`as
(
rc
);

435 
	`_tSm
(
pTe
, 
dout
);

436 
	`_run
(
pTe
);

437 (
	`_pt
(
pTe
);

439 
	`_deroy
(
pTe
);

442 
	}
}

	@src/rp.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~".h
"

42 #i
BACNET_SVC_RP_A


44 
	$_code_du
(

45 
ut8_t
 * 
du
,

46 
ut8_t
 
voke_id
,

47 
BACNET_READ_PROPERTY_DATA
 * 
da
)

49 
n
 = 0;

50 
du_n
 = 0;

52 i(
du
) {

53 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

54 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

55 
du
[2] = 
voke_id
;

56 
du
[3] = 
SERVICE_CONFIRMED_READ_PROPERTY
;

57 
du_n
 = 4;

58 i(
da
->
obje_ty
 <
BACNET_MAX_OBJECT
) {

61 
n
 =

62 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0,

63 
da
->
obje_ty
,pda->
obje_
);

64 
du_n
 +
n
;

66 i(
da
->
obje_ݔty
 <= 4194303) {

69 
n
 =

70 
	`code_cڋxt_umed
(&
du
[
du_n
], 1,

71 
da
->
obje_ݔty
);

72 
du_n
 +
n
;

75 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

76 
n
 =

77 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 2,

78 
da
->
y_dex
);

79 
du_n
 +
n
;

83  
du_n
;

84 
	}
}

88 
	$_decode_rvi_que
(

89 
ut8_t
 * 
du
,

90 
du_n
,

91 
BACNET_READ_PROPERTY_DATA
 * 
da
)

93 
n
 = 0;

94 
ut8_t
 
g_numb
 = 0;

95 
ut32_t
 
n_vue_ty
 = 0;

96 
ut16_t
 
ty
 = 0;

97 
ut32_t
 
ݔty
 = 0;

98 
ut32_t
 
y_vue
 = 0;

101 i(
da
 !
NULL
) {

104 i(
du_n
 < 7) {

105 
da
->
r_code
 = 
ERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
;

106  
BACNET_STATUS_REJECT
;

110 i(!
	`decode_is_cڋxt_g
(&
du
[
n
++], 0)) {

111 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

112  
BACNET_STATUS_REJECT
;

114 
n
 +
	`decode_obje_id
(&
du
[n], &
ty
, &
da
->
obje_
);

115 
da
->
obje_ty
 = (
BACNET_OBJECT_TYPE

ty
;

117 
n
 +=

118 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

119 &
n_vue_ty
);

120 i(
g_numb
 != 1) {

121 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

122  
BACNET_STATUS_REJECT
;

124 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
ݔty
);

125 
da
->
obje_ݔty
 = (
BACNET_PROPERTY_ID

ݔty
;

127 i(
n
 < 
du_n
) {

128 
n
 +=

129 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

130 &
n_vue_ty
);

131 i((
g_numb
 =2&& (
n
 < 
du_n
)) {

132 
n
 +=

133 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
, &
y_vue
);

134 
da
->
y_dex
 = 
y_vue
;

136 
da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

137  
BACNET_STATUS_REJECT
;

140 
da
->
y_dex
 = 
BACNET_ARRAY_ALL
;

143 i(
n
 < 
du_n
) {

145 i(
da
) {

146 
da
->
r_code
 = 
ERROR_CODE_REJECT_TOO_MANY_ARGUMENTS
;

148  
BACNET_STATUS_REJECT
;

151  (
n
;

152 
	}
}

155 
	$_ack_code_du_
(

156 
ut8_t
 * 
du
,

157 
ut8_t
 
voke_id
,

158 
BACNET_READ_PROPERTY_DATA
 * 
da
)

160 
n
 = 0;

161 
du_n
 = 0;

163 i(
du
) {

164 
du
[0] = 
PDU_TYPE_COMPLEX_ACK
;

165 
du
[1] = 
voke_id
;

166 
du
[2] = 
SERVICE_CONFIRMED_READ_PROPERTY
;

167 
du_n
 = 3;

170 
n
 =

171 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0, 
da
->
obje_ty
,

172 
da
->
obje_
);

173 
du_n
 +
n
;

174 
n
 =

175 
	`code_cڋxt_umed
(&
du
[
du_n
], 1,

176 
da
->
obje_ݔty
);

177 
du_n
 +
n
;

179 i(
da
->
y_dex
 !
BACNET_ARRAY_ALL
) {

180 
n
 =

181 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 2,

182 
da
->
y_dex
);

183 
du_n
 +
n
;

185 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 3);

186 
du_n
 +
n
;

189  
du_n
;

190 
	}
}

193 
	$_ack_code_du_obje_ݔty_d
(

194 
ut8_t
 * 
du
)

196 
du_n
 = 0;

198 i(
du
) {

199 
du_n
 = 
	`code_osg_g
(&
du
[0], 3);

202  
du_n
;

203 
	}
}

205 
	$_ack_code_du
(

206 
ut8_t
 * 
du
,

207 
ut8_t
 
voke_id
,

208 
BACNET_READ_PROPERTY_DATA
 * 
da
)

210 
n
 = 0;

211 
du_n
 = 0;

213 i(
du
) {

215 
du_n
 = 
	`_ack_code_du_
(
du
, 
voke_id
, 
da
);

217 
n
 = 0; < 
da
->
iti_da_n
;en++) {

218 
du
[
du_n
++] = 
da
->
iti_da
[
n
];

220 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 3);

223  
du_n
;

224 
	}
}

227 #i
BACNET_SVC_RP_A


239 
	$_ack_decode_rvi_que
(

240 
ut8_t
 * 
du
,

241 
du_n
,

242 
BACNET_READ_PROPERTY_DATA
 * 
da
)

244 
ut8_t
 
g_numb
 = 0;

245 
ut32_t
 
n_vue_ty
 = 0;

246 
g_n
 = 0;

247 
n
 = 0;

248 
ut16_t
 
obje
 = 0;

249 
ut32_t
 
ݔty
 = 0;

250 
ut32_t
 
y_vue
 = 0;

254 i(!
	`decode_is_cڋxt_g
(&
du
[0], 0))

256 
n
 = 1;

257 
n
 +
	`decode_obje_id
(&
du
[n], &
obje
, &
da
->
obje_
);

258 
da
->
obje_ty
 = (
BACNET_OBJECT_TYPE

obje
;

260 
n
 +=

261 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue_ty
);

262 i(
g_numb
 != 1)

264 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
ݔty
);

265 
da
->
obje_ݔty
 = (
BACNET_PROPERTY_ID

ݔty
;

267 
g_n
 =

268 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue_ty
);

269 i(
g_numb
 == 2) {

270 
n
 +
g_n
;

271 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue_ty
, &
y_vue
);

272 
da
->
y_dex
 = 
y_vue
;

274 
da
->
y_dex
 = 
BACNET_ARRAY_ALL
;

276 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 3)) {

278 
n
++;

280 
da
->
iti_da
 = &
du
[
n
];

281 
da
->
iti_da_n
 = 
du_n
 - 
n
 - 1 ;

283 
n
 = 
du_n
;

288  
n
;

289 
	}
}

292 #ifde
TEST


293 
	~<as.h
>

294 
	~<rg.h
>

295 
	~"e.h
"

297 
	$_decode_du
(

298 
ut8_t
 * 
du
,

299 
du_n
,

300 
ut8_t
 * 
voke_id
,

301 
BACNET_READ_PROPERTY_DATA
 * 
da
)

303 
n
 = 0;

304 
offt
 = 0;

306 i(!
du
)

309 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

312 *
voke_id
 = 
du
[2];

313 i(
du
[3] !
SERVICE_CONFIRMED_READ_PROPERTY
)

315 
offt
 = 4;

317 i(
du_n
 > 
offt
) {

318 
n
 =

319 
	`_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

320 
da
);

323  
n
;

324 
	}
}

326 
	$_ack_decode_du
(

327 
ut8_t
 * 
du
,

328 
du_n
,

329 
ut8_t
 * 
voke_id
,

330 
BACNET_READ_PROPERTY_DATA
 * 
da
)

332 
n
 = 0;

333 
offt
 = 0;

335 i(!
du
)

338 i(
du
[0] !
PDU_TYPE_COMPLEX_ACK
)

340 *
voke_id
 = 
du
[1];

341 i(
du
[2] !
SERVICE_CONFIRMED_READ_PROPERTY
)

343 
offt
 = 3;

344 i(
du_n
 > 
offt
) {

345 
n
 =

346 
	`_ack_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

347 
da
);

350  
n
;

351 
	}
}

353 
	$RdPrݔtyAck
(

354 
Te
 * 
pTe
)

356 
ut8_t
 
du
[480] = { 0 };

357 
ut8_t
 
du2
[480] = { 0 };

358 
n
 = 0;

359 
du_n
 = 0;

360 
ut8_t
 
voke_id
 = 1;

361 
ut8_t
 
_voke_id
 = 0;

362 
BACNET_READ_PROPERTY_DATA
 
da
;

363 
BACNET_READ_PROPERTY_DATA
 
_da
;

364 
BACNET_OBJECT_TYPE
 
obje_ty
 = 
OBJECT_DEVICE
;

365 
ut32_t
 
obje_
 = 0;

366 
ut16_t
 
obje
 = 0;

368 
da
.
obje_ty
 = 
OBJECT_DEVICE
;

369 
da
.
obje_
 = 1;

370 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

371 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

373 
da
.
iti_da_n
 =

374 
	`code_ba_obje_id
(&
du2
[0], 
da
.
obje_ty
,

375 
da
.
obje_
);

376 
da
.
iti_da
 = &
du2
[0];

378 
n
 = 
	`_ack_code_du
(&
du
[0], 
voke_id
, &
da
);

379 
	`_
(
pTe
, 
n
 != 0);

380 
	`_
(
pTe
, 
n
 != -1);

381 
du_n
 = 
n
;

382 
n
 = 
	`_ack_decode_du
(&
du
[0], 
du_n
,

383 &
_voke_id
, &
_da
);

384 
	`_
(
pTe
, 
n
 != -1);

385 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

387 
	`_
(
pTe
, 
_da
.
obje_ty
 =
da
.object_type);

388 
	`_
(
pTe
, 
_da
.
obje_
 =
da
.object_instance);

389 
	`_
(
pTe
, 
_da
.
obje_ݔty
 =
da
.object_property);

390 
	`_
(
pTe
, 
_da
.
y_dex
 =
da
.array_index);

391 
	`_
(
pTe
,

392 
_da
.
iti_da_n
 =
da
.application_data_len);

396 
n
 =

397 
	`decode_obje_id
(
_da
.
iti_da
, &
obje
,

398 &
obje_
);

399 
obje_ty
 = 
obje
;

400 
	`_
(
pTe
, 
obje_ty
 =
da
.object_type);

401 
	`_
(
pTe
, 
obje_
 =
da
.object_instance);

402 
	}
}

404 
	$RdPrݔty
(

405 
Te
 * 
pTe
)

407 
ut8_t
 
du
[480] = { 0 };

408 
n
 = 0;

409 
du_n
 = 0;

410 
ut8_t
 
voke_id
 = 128;

411 
ut8_t
 
_voke_id
 = 0;

412 
BACNET_READ_PROPERTY_DATA
 
da
;

413 
BACNET_READ_PROPERTY_DATA
 
_da
;

415 
da
.
obje_ty
 = 
OBJECT_DEVICE
;

416 
da
.
obje_
 = 1;

417 
da
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

418 
da
.
y_dex
 = 
BACNET_ARRAY_ALL
;

419 
n
 = 
	`_code_du
(&
du
[0], 
voke_id
, &
da
);

420 
	`_
(
pTe
, 
n
 != 0);

421 
du_n
 = 
n
;

423 
n
 = 
	`_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
_da
);

424 
	`_
(
pTe
, 
n
 != -1);

425 
	`_
(
pTe
, 
_da
.
obje_ty
 =
da
.object_type);

426 
	`_
(
pTe
, 
_da
.
obje_
 =
da
.object_instance);

427 
	`_
(
pTe
, 
_da
.
obje_ݔty
 =
da
.object_property);

428 
	`_
(
pTe
, 
_da
.
y_dex
 =
da
.array_index);

431 
	}
}

433 #ifde
TEST_READ_PROPERTY


434 
	$ma
(

437 
Te
 *
pTe
;

438 
bo
 
rc
;

440 
pTe
 = 
	`_
("BACÈRdPrݔty", 
NULL
);

442 
rc
 = 
	`_addTeFuni
(
pTe
, 
RdPrݔty
);

443 
	`as
(
rc
);

444 
rc
 = 
	`_addTeFuni
(
pTe
, 
RdPrݔtyAck
);

445 
	`as
(
rc
);

447 
	`_tSm
(
pTe
, 
dout
);

448 
	`_run
(
pTe
);

449 (
	`_pt
(
pTe
);

450 
	`_deroy
(
pTe
);

453 
	}
}

	@src/rpm.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"ba.h
"

37 
	~"bacdcode.h
"

38 
	~"bacdef.h
"

39 
	~"ba.h
"

40 
	~"memcy.h
"

41 
	~"m.h
"

45 #i
BACNET_SVC_RPM_A


47 
	$m_code_du_
(

48 
ut8_t
 * 
du
,

49 
ut8_t
 
voke_id
)

51 
du_n
 = 0;

53 i(
du
) {

54 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

55 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

56 
du
[2] = 
voke_id
;

57 
du
[3] = 
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
;

58 
du_n
 = 4;

61  
du_n
;

62 
	}
}

64 
	$m_code_du_obje_beg
(

65 
ut8_t
 * 
du
,

66 
BACNET_OBJECT_TYPE
 
obje_ty
,

67 
ut32_t
 
obje_
)

69 
du_n
 = 0;

71 i(
du
) {

72 
du_n
 =

73 
	`code_cڋxt_obje_id
(&
du
[0], 0, 
obje_ty
,

74 
obje_
);

76 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 1);

79  
du_n
;

80 
	}
}

82 
	$m_code_du_obje_ݔty
(

83 
ut8_t
 * 
du
,

84 
BACNET_PROPERTY_ID
 
obje_ݔty
,

85 
ut32_t
 
y_dex
)

87 
du_n
 = 0;

89 i(
du
) {

90 
du_n
 = 
	`code_cڋxt_umed
(&
du
[0], 0, 
obje_ݔty
);

92 i(
y_dex
 !
BACNET_ARRAY_ALL
)

93 
du_n
 +=

94 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1, 
y_dex
);

97  
du_n
;

98 
	}
}

100 
	$m_code_du_obje_d
(

101 
ut8_t
 * 
du
)

103 
du_n
 = 0;

105 i(
du
) {

106 
du_n
 = 
	`code_osg_g
(&
du
[0], 1);

109  
du_n
;

110 
	}
}

120 
	$m_code_du
(

121 
ut8_t
 * 
du
,

122 
size_t
 
max_du
,

123 
ut8_t
 
voke_id
,

124 
BACNET_READ_ACCESS_DATA
 * 
ad_acss_da
)

126 
du_n
 = 0;

127 
n
 = 0;

128 
BACNET_READ_ACCESS_DATA
 *
m_obje
;

129 
ut8_t
 
du_mp
[16];

130 
BACNET_PROPERTY_REFERENCE
 *
m_ݔty
;

132 
n
 = 
	`m_code_du_
(&
du_mp
[0], 
voke_id
);

133 
n
 =

134 (
	`memcy
(&
du
[0], &
du_mp
[0], (
size_t

du_n
, (size_t
n
,

135 (
size_t

max_du
);

136 i(
n
 == 0) {

139 
du_n
 +
n
;

140 
m_obje
 = 
ad_acss_da
;

141 
m_obje
) {

142 
n
 =

143 
	`code_cڋxt_obje_id
(&
du_mp
[0], 0, 
m_obje
->
obje_ty
,

144 
m_obje
->
obje_
);

145 
n
 =

146 (
	`memcy
(&
du
[0], &
du_mp
[0], (
size_t

du_n
,

147 (
size_t

n
, (size_t
max_du
);

148 i(
n
 == 0) {

151 
du_n
 +
n
;

153 
n
 = 
	`code_ݒg_g
(&
du_mp
[0], 1);

154 
n
 =

155 (
	`memcy
(&
du
[0], &
du_mp
[0], (
size_t

du_n
,

156 (
size_t

n
, (size_t
max_du
);

157 i(
n
 == 0) {

160 
du_n
 +
n
;

161 
m_ݔty
 = 
m_obje
->
liOfPrݔts
;

162 
m_ݔty
) {

164 
n
 =

165 
	`code_cڋxt_umed
(&
du_mp
[0], 0,

166 
m_ݔty
->
ݔtyIdtifr
);

167 
n
 =

168 (
	`memcy
(&
du
[0], &
du_mp
[0], (
size_t

du_n
,

169 (
size_t

n
, (size_t
max_du
);

170 i(
n
 == 0) {

173 
du_n
 +
n
;

175 i(
m_ݔty
->
ݔtyAayIndex
 !
BACNET_ARRAY_ALL
) {

176 
n
 =

177 
	`code_cڋxt_unsigd
(&
du_mp
[0], 1,

178 
m_ݔty
->
ݔtyAayIndex
);

179 
n
 =

180 (
	`memcy
(&
du
[0], &
du_mp
[0], (
size_t

du_n
,

181 (
size_t

n
, (size_t
max_du
);

182 i(
n
 == 0) {

185 
du_n
 +
n
;

187 
m_ݔty
 =pm_ݔty->
xt
;

189 
n
 = 
	`code_osg_g
(&
du_mp
[0], 1);

190 
n
 =

191 (
	`memcy
(&
du
[0], &
du_mp
[0], (
size_t

du_n
,

192 (
size_t

n
, (size_t
max_du
);

193 i(
n
 == 0) {

196 
du_n
 +
n
;

197 
m_obje
 =pm_obje->
xt
;

200  
du_n
;

201 
	}
}

208 
	$m_decode_obje_id
(

209 
ut8_t
 * 
du
,

210 
du_n
,

211 
BACNET_RPM_DATA
 * 
mda
)

213 
n
 = 0;

214 
ut16_t
 
ty
 = 0;

217 i(
du
 && 
du_n
 && 
mda
) {

218 i(
du_n
 < 5) {

219 
mda
->
r_code
 = 
ERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
;

220  
BACNET_STATUS_REJECT
;

223 i(!
	`decode_is_cڋxt_g
(&
du
[
n
++], 0)) {

224 
mda
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

225  
BACNET_STATUS_REJECT
;

227 
n
 +
	`decode_obje_id
(&
du
[n], &
ty
, &
mda
->
obje_
);

228 
mda
->
obje_ty
 = (
BACNET_OBJECT_TYPE

ty
;

230 i(!
	`decode_is_ݒg_g_numb
(&
du
[
n
], 1)) {

231 
mda
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

232  
BACNET_STATUS_REJECT
;

234 
n
++;

237  (
n
;

238 
	}
}

240 
	$m_decode_obje_d
(

241 
ut8_t
 * 
du
,

242 
du_n
)

244 
n
 = 0;

246 i(
du
 && 
du_n
) {

247 i(
	`decode_is_osg_g_numb
(
du
, 1=
ue
)

248 
n
 = 1;

251  
n
;

252 
	}
}

262 
	$m_decode_obje_ݔty
(

263 
ut8_t
 * 
du
,

264 
du_n
,

265 
BACNET_RPM_DATA
 * 
mda
)

267 
n
 = 0;

268 
ti_n
 = 0;

269 
ut8_t
 
g_numb
 = 0;

270 
ut32_t
 
n_vue_ty
 = 0;

271 
ut32_t
 
ݔty
 = 0;

272 
ut32_t
 
y_vue
 = 0;

275 i(
du
 && 
du_n
 && 
mda
) {

277 i(!
	`IS_CONTEXT_SPECIFIC
(
du
[
n
])) {

278 
mda
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

279  
BACNET_STATUS_REJECT
;

282 
n
 +=

283 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

284 &
n_vue_ty
);

285 i(
g_numb
 != 0) {

286 
mda
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

287  
BACNET_STATUS_REJECT
;

290 i((
n
 + 
n_vue_ty
>
du_n
) {

291 
mda
->
r_code
 = 
ERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
;

292  
BACNET_STATUS_REJECT
;

294 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
ݔty
);

295 
mda
->
obje_ݔty
 = (
BACNET_PROPERTY_ID

ݔty
;

297 
mda
->
y_dex
 = 
BACNET_ARRAY_ALL
;

299 i(
	`IS_CONTEXT_SPECIFIC
(
du
[
n
]&& !
	`IS_CLOSING_TAG
(apdu[len])) {

300 
ti_n
 =

301 (
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

302 &
n_vue_ty
);

303 i(
g_numb
 == 1) {

304 
n
 +
ti_n
;

306 i((
n
 + 
n_vue_ty
>
du_n
) {

307 
mda
->
r_code
 =

308 
ERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
;

309  
BACNET_STATUS_REJECT
;

311 
n
 +=

312 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
, &
y_vue
);

313 
mda
->
y_dex
 = 
y_vue
;

318  (
n
;

319 
	}
}

321 
	$m_ack_code_du_
(

322 
ut8_t
 * 
du
,

323 
ut8_t
 
voke_id
)

325 
du_n
 = 0;

327 i(
du
) {

328 
du
[0] = 
PDU_TYPE_COMPLEX_ACK
;

329 
du
[1] = 
voke_id
;

330 
du
[2] = 
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
;

331 
du_n
 = 3;

334  
du_n
;

335 
	}
}

337 
	$m_ack_code_du_obje_beg
(

338 
ut8_t
 * 
du
,

339 
BACNET_RPM_DATA
 * 
mda
)

341 
du_n
 = 0;

343 i(
du
) {

345 
du_n
 =

346 
	`code_cڋxt_obje_id
(&
du
[0], 0, 
mda
->
obje_ty
,

347 
mda
->
obje_
);

349 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 1);

352  
du_n
;

353 
	}
}

355 
	$m_ack_code_du_obje_ݔty
(

356 
ut8_t
 * 
du
,

357 
BACNET_PROPERTY_ID
 
obje_ݔty
,

358 
ut32_t
 
y_dex
)

360 
du_n
 = 0;

362 i(
du
) {

364 
du_n
 = 
	`code_cڋxt_umed
(&
du
[0], 2, 
obje_ݔty
);

366 i(
y_dex
 !
BACNET_ARRAY_ALL
)

367 
du_n
 +=

368 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 3, 
y_dex
);

371  
du_n
;

372 
	}
}

374 
	$m_ack_code_du_obje_ݔty_vue
(

375 
ut8_t
 * 
du
,

376 
ut8_t
 * 
iti_da
,

377 
iti_da_n
)

379 
du_n
 = 0;

380 
n
 = 0;

382 i(
du
) {

384 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 4);

385 i(
iti_da
 =&
du
[
du_n
]) {

386 
du_n
 +
iti_da_n
;

388 
n
 = 0; < 
iti_da_n
;en++) {

389 
du
[
du_n
++] = 
iti_da
[
n
];

392 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 4);

395  
du_n
;

396 
	}
}

398 
	$m_ack_code_du_obje_ݔty_r
(

399 
ut8_t
 * 
du
,

400 
BACNET_ERROR_CLASS
 
r_ass
,

401 
BACNET_ERROR_CODE
 
r_code
)

403 
du_n
 = 0;

405 i(
du
) {

407 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 5);

408 
du_n
 +=

409 
	`code_iti_umed
(&
du
[
du_n
], 
r_ass
);

410 
du_n
 +
	`code_iti_umed
(&
du
[du_n], 
r_code
);

411 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 5);

414  
du_n
;

415 
	}
}

417 
	$m_ack_code_du_obje_d
(

418 
ut8_t
 * 
du
)

420 
du_n
 = 0;

422 i(
du
) {

423 
du_n
 = 
	`code_osg_g
(&
du
[0], 1);

426  
du_n
;

427 
	}
}

429 #i
BACNET_SVC_RPM_A


432 
	$m_ack_decode_obje_id
(

433 
ut8_t
 * 
du
,

434 
du_n
,

435 
BACNET_OBJECT_TYPE
 * 
obje_ty
,

436 
ut32_t
 * 
obje_
)

438 
n
 = 0;

439 
ut16_t
 
ty
 = 0;

442 i(
du
 && 
du_n
 && 
obje_ty
 && 
obje_
) {

444 i(!
	`decode_is_cڋxt_g
(&
du
[
n
++], 0))

446 
n
 +
	`decode_obje_id
(&
du
[n], &
ty
, 
obje_
);

447 i(
obje_ty
)

448 *
obje_ty
 = (
BACNET_OBJECT_TYPE

ty
;

450 i(!
	`decode_is_ݒg_g_numb
(&
du
[
n
], 1))

452 
n
++;

455  (
n
;

456 
	}
}

459 
	$m_ack_decode_obje_d
(

460 
ut8_t
 * 
du
,

461 
du_n
)

463 
n
 = 0;

465 i(
du
 && 
du_n
) {

466 i(
	`decode_is_osg_g_numb
(
du
, 1))

467 
n
 = 1;

470  
n
;

471 
	}
}

473 
	$m_ack_decode_obje_ݔty
(

474 
ut8_t
 * 
du
,

475 
du_n
,

476 
BACNET_PROPERTY_ID
 * 
obje_ݔty
,

477 
ut32_t
 * 
y_dex
)

479 
n
 = 0;

480 
g_n
 = 0;

481 
ut8_t
 
g_numb
 = 0;

482 
ut32_t
 
n_vue_ty
 = 0;

483 
ut32_t
 
ݔty
 = 0;

484 
ut32_t
 
y_vue
 = 0;

487 i(
du
 && 
du_n
 && 
obje_ݔty
 && 
y_dex
) {

489 i(!
	`IS_CONTEXT_SPECIFIC
(
du
[
n
]))

491 
n
 +=

492 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

493 &
n_vue_ty
);

494 i(
g_numb
 != 2)

496 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
ݔty
);

497 i(
obje_ݔty
)

498 *
obje_ݔty
 = (
BACNET_PROPERTY_ID

ݔty
;

500 i((
n
 < 
du_n
&& 
	`IS_CONTEXT_SPECIFIC
(
du
[len]) &&

501 (!
	`IS_CLOSING_TAG
(
du
[
n
]))) {

502 
g_n
 =

503 (
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

504 &
n_vue_ty
);

505 i(
g_numb
 == 3) {

506 
n
 +
g_n
;

507 
n
 +=

508 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
, &
y_vue
);

509 *
y_dex
 = 
y_vue
;

511 *
y_dex
 = 
BACNET_ARRAY_ALL
;

514 *
y_dex
 = 
BACNET_ARRAY_ALL
;

518  (
n
;

519 
	}
}

523 #ifde
TEST


524 
	~<as.h
>

525 
	~<rg.h
>

526 
	~"e.h
"

528 
	$m_ack_decode_du
(

529 
ut8_t
 * 
du
,

530 
du_n
,

531 
ut8_t
 * 
voke_id
,

532 
ut8_t
 ** 
rvi_que
,

533 *
rvi_que_n
)

535 
offt
 = 0;

537 i(!
du
)

540 i(
du
[0] !
PDU_TYPE_COMPLEX_ACK
)

542 *
voke_id
 = 
du
[1];

543 i(
du
[2] !
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
)

545 
offt
 = 3;

546 i(
du_n
 > 
offt
) {

547 i(
rvi_que
)

548 *
rvi_que
 = &
du
[
offt
];

549 i(
rvi_que_n
)

550 *
rvi_que_n
 = 
du_n
 - 
offt
;

553  
offt
;

554 
	}
}

556 
	$m_decode_du
(

557 
ut8_t
 * 
du
,

558 
du_n
,

559 
ut8_t
 * 
voke_id
,

560 
ut8_t
 ** 
rvi_que
,

561 *
rvi_que_n
)

563 
offt
 = 0;

565 i(!
du
)

568 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

571 *
voke_id
 = 
du
[2];

572 i(
du
[3] !
SERVICE_CONFIRMED_READ_PROP_MULTIPLE
)

574 
offt
 = 4;

576 i(
du_n
 > 
offt
) {

577 i(
rvi_que
)

578 *
rvi_que
 = &
du
[
offt
];

579 i(
rvi_que_n
)

580 *
rvi_que_n
 = 
du_n
 - 
offt
;

583  
offt
;

584 
	}
}

586 
	$RdPrݔtyMuɝ
(

587 
Te
 * 
pTe
)

589 
ut8_t
 
du
[480] = { 0 };

590 
n
 = 0;

591 
_n
 = 0;

592 
du_n
 = 0;

593 
ut8_t
 
voke_id
 = 12;

594 
ut8_t
 
_voke_id
 = 0;

595 
ut8_t
 *
rvi_que
 = 
NULL
;

596 
rvi_que_n
 = 0;

597 
BACNET_RPM_DATA
 
mda
;

599 
mda
.
obje_ty
 = 
OBJECT_DEVICE
;

600 
mda
.
obje_
 = 0;

601 
mda
.
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

602 
mda
.
y_dex
 = 0;

610 
du_n
 = 
	`m_code_du_
(&
du
[0], 
voke_id
);

612 
du_n
 +=

613 
	`m_code_du_obje_beg
(&
du
[
du_n
], 
OBJECT_DEVICE
, 123);

615 
du_n
 +=

616 
	`m_code_du_obje_ݔty
(&
du
[
du_n
],

617 
PROP_OBJECT_IDENTIFIER
, 
BACNET_ARRAY_ALL
);

618 
du_n
 +=

619 
	`m_code_du_obje_ݔty
(&
du
[
du_n
], 
PROP_OBJECT_NAME
,

620 
BACNET_ARRAY_ALL
);

621 
du_n
 +
	`m_code_du_obje_d
(&
du
[apdu_len]);

623 
du_n
 +=

624 
	`m_code_du_obje_beg
(&
du
[
du_n
], 
OBJECT_ANALOG_INPUT
, 33);

625 
du_n
 +=

626 
	`m_code_du_obje_ݔty
(&
du
[
du_n
],

627 
PROP_OBJECT_IDENTIFIER
, 
BACNET_ARRAY_ALL
);

628 
du_n
 +=

629 
	`m_code_du_obje_ݔty
(&
du
[
du_n
], 
PROP_ALL
,

630 
BACNET_ARRAY_ALL
);

631 
du_n
 +
	`m_code_du_obje_d
(&
du
[apdu_len]);

633 
	`_
(
pTe
, 
du_n
 != 0);

635 
_n
 = 
	`m_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
rvi_que
,

636 &
rvi_que_n
);

637 
	`_
(
pTe
, 
_n
 != -1);

638 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

639 
	`_
(
pTe
, 
rvi_que
 !
NULL
);

640 
	`_
(
pTe
, 
rvi_que_n
 > 0);

642 
_n
 =

643 
	`m_decode_obje_id
(
rvi_que
, 
rvi_que_n
, &
mda
);

644 
	`_
(
pTe
, 
_n
 > 0);

645 
	`_
(
pTe
, 
mda
.
obje_ty
 =
OBJECT_DEVICE
);

646 
	`_
(
pTe
, 
mda
.
obje_
 == 123);

647 
n
 = 
_n
;

649 
_n
 =

650 
	`m_decode_obje_ݔty
(&
rvi_que
[
n
],

651 
rvi_que_n
 - 
n
, &
mda
);

652 
	`_
(
pTe
, 
_n
 > 0);

653 
	`_
(
pTe
, 
mda
.
obje_ݔty
 =
PROP_OBJECT_IDENTIFIER
);

654 
	`_
(
pTe
, 
mda
.
y_dex
 =
BACNET_ARRAY_ALL
);

655 
n
 +
_n
;

656 
_n
 =

657 
	`m_decode_obje_ݔty
(&
rvi_que
[
n
],

658 
rvi_que_n
 - 
n
, &
mda
);

659 
	`_
(
pTe
, 
_n
 > 0);

660 
	`_
(
pTe
, 
mda
.
obje_ݔty
 =
PROP_OBJECT_NAME
);

661 
	`_
(
pTe
, 
mda
.
y_dex
 =
BACNET_ARRAY_ALL
);

662 
n
 +
_n
;

664 
_n
 =

665 
	`m_decode_obje_ݔty
(&
rvi_que
[
n
],

666 
rvi_que_n
 - 
n
, &
mda
);

667 
	`_
(
pTe
, 
_n
 < 0);

669 
_n
 =

670 
	`m_decode_obje_d
(&
rvi_que
[
n
],

671 
rvi_que_n
 - 
n
);

672 
	`_
(
pTe
, 
_n
 == 1);

673 
n
 +
_n
;

675 
_n
 =

676 
	`m_decode_obje_id
(&
rvi_que
[
n
], 
rvi_que_n
 -en,

677 &
mda
);

678 
	`_
(
pTe
, 
_n
 > 0);

679 
	`_
(
pTe
, 
mda
.
obje_ty
 =
OBJECT_ANALOG_INPUT
);

680 
	`_
(
pTe
, 
mda
.
obje_
 == 33);

681 
n
 +
_n
;

683 
_n
 =

684 
	`m_decode_obje_ݔty
(&
rvi_que
[
n
],

685 
rvi_que_n
 - 
n
, &
mda
);

686 
	`_
(
pTe
, 
_n
 > 0);

687 
	`_
(
pTe
, 
mda
.
obje_ݔty
 =
PROP_OBJECT_IDENTIFIER
);

688 
	`_
(
pTe
, 
mda
.
y_dex
 =
BACNET_ARRAY_ALL
);

689 
n
 +
_n
;

690 
_n
 =

691 
	`m_decode_obje_ݔty
(&
rvi_que
[
n
],

692 
rvi_que_n
 - 
n
, &
mda
);

693 
	`_
(
pTe
, 
_n
 > 0);

694 
	`_
(
pTe
, 
mda
.
obje_ݔty
 =
PROP_ALL
);

695 
	`_
(
pTe
, 
mda
.
y_dex
 =
BACNET_ARRAY_ALL
);

696 
n
 +
_n
;

697 
_n
 =

698 
	`m_decode_obje_ݔty
(&
rvi_que
[
n
],

699 
rvi_que_n
 - 
n
, &
mda
);

700 
	`_
(
pTe
, 
_n
 < 0);

702 
_n
 =

703 
	`m_decode_obje_d
(&
rvi_que
[
n
],

704 
rvi_que_n
 - 
n
);

705 
	`_
(
pTe
, 
_n
 == 1);

706 
n
 +
_n
;

707 
	`_
(
pTe
, 
n
 =
rvi_que_n
);

708 
	}
}

710 
	$RdPrݔtyMuɝAck
(

711 
Te
 * 
pTe
)

713 
ut8_t
 
du
[480] = { 0 };

714 
n
 = 0;

715 
_n
 = 0;

716 
du_n
 = 0;

717 
ut8_t
 
voke_id
 = 12;

718 
ut8_t
 
_voke_id
 = 0;

719 
ut8_t
 *
rvi_que
 = 
NULL
;

720 
rvi_que_n
 = 0;

721 
BACNET_OBJECT_TYPE
 
obje_ty
 = 
OBJECT_DEVICE
;

722 
ut32_t
 
obje_
 = 0;

723 
BACNET_PROPERTY_ID
 
obje_ݔty
 = 
PROP_OBJECT_IDENTIFIER
;

724 
ut32_t
 
y_dex
 = 0;

725 
BACNET_APPLICATION_DATA_VALUE
 
iti_da
[4] = { {0} };

726 
BACNET_APPLICATION_DATA_VALUE
 
_iti_da
 = { 0 };

727 
ut8_t
 
iti_da_bufr
[
MAX_APDU
] = { 0 };

728 
iti_da_bufr_n
 = 0;

729 
BACNET_ERROR_CLASS
 
r_ass
;

730 
BACNET_ERROR_CODE
 
r_code
;

731 
BACNET_RPM_DATA
 
mda
;

742 
du_n
 = 
	`m_ack_code_du_
(&
du
[0], 
voke_id
);

744 
mda
.
obje_ty
 = 
OBJECT_DEVICE
;

745 
mda
.
obje_
 = 123;

746 
du_n
 +
	`m_ack_code_du_obje_beg
(&
du
[du_n], &
mda
);

748 
du_n
 +=

749 
	`m_ack_code_du_obje_ݔty
(&
du
[
du_n
],

750 
PROP_OBJECT_IDENTIFIER
, 
BACNET_ARRAY_ALL
);

752 
iti_da
[0].
g
 = 
BACNET_APPLICATION_TAG_OBJECT_ID
;

753 
iti_da
[0].
ty
.
Obje_Id
.ty = 
OBJECT_DEVICE
;

754 
iti_da
[0].
ty
.
Obje_Id
.

 = 123;

755 
iti_da_bufr_n
 =

756 
	`ba_code_iti_da
(&
iti_da_bufr
[0],

757 &
iti_da
[0]);

758 
du_n
 +=

759 
	`m_ack_code_du_obje_ݔty_vue
(&
du
[
du_n
],

760 &
iti_da_bufr
[0], 
iti_da_bufr_n
);

762 
du_n
 +=

763 
	`m_ack_code_du_obje_ݔty
(&
du
[
du_n
], 
PROP_OBJECT_TYPE
,

764 
BACNET_ARRAY_ALL
);

766 
iti_da
[1].
g
 = 
BACNET_APPLICATION_TAG_ENUMERATED
;

767 
iti_da
[1].
ty
.
Enumed
 = 
OBJECT_DEVICE
;

768 
iti_da_bufr_n
 =

769 
	`ba_code_iti_da
(&
iti_da_bufr
[0],

770 &
iti_da
[1]);

771 
du_n
 +=

772 
	`m_ack_code_du_obje_ݔty_vue
(&
du
[
du_n
],

773 &
iti_da_bufr
[0], 
iti_da_bufr_n
);

775 
du_n
 +
	`m_ack_code_du_obje_d
(&
du
[apdu_len]);

778 
mda
.
obje_ty
 = 
OBJECT_ANALOG_INPUT
;

779 
mda
.
obje_
 = 33;

780 
du_n
 +
	`m_ack_code_du_obje_beg
(&
du
[du_n], &
mda
);

782 
du_n
 +=

783 
	`m_ack_code_du_obje_ݔty
(&
du
[
du_n
],

784 
PROP_PRESENT_VALUE
, 
BACNET_ARRAY_ALL
);

786 
iti_da
[2].
g
 = 
BACNET_APPLICATION_TAG_REAL
;

787 
iti_da
[2].
ty
.
Rl
 = 0.0;

788 
iti_da_bufr_n
 =

789 
	`ba_code_iti_da
(&
iti_da_bufr
[0],

790 &
iti_da
[2]);

791 
du_n
 +=

792 
	`m_ack_code_du_obje_ݔty_vue
(&
du
[
du_n
],

793 &
iti_da_bufr
[0], 
iti_da_bufr_n
);

795 
du_n
 +=

796 
	`m_ack_code_du_obje_ݔty
(&
du
[
du_n
], 
PROP_DEADBAND
,

797 
BACNET_ARRAY_ALL
);

799 
du_n
 +=

800 
	`m_ack_code_du_obje_ݔty_r
(&
du
[
du_n
],

801 
ERROR_CLASS_PROPERTY
, 
ERROR_CODE_UNKNOWN_PROPERTY
);

803 
du_n
 +
	`m_ack_code_du_obje_d
(&
du
[apdu_len]);

804 
	`_
(
pTe
, 
du_n
 != 0);

807 
_n
 = 
	`m_ack_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
rvi_que
,

808 &
rvi_que_n
);

809 
	`_
(
pTe
, 
_n
 != -1);

810 
	`_
(
pTe
, 
_voke_id
 =
voke_id
);

811 
	`_
(
pTe
, 
rvi_que
 !
NULL
);

812 
	`_
(
pTe
, 
rvi_que_n
 > 0);

814 
_n
 =

815 
	`m_ack_decode_obje_id
(
rvi_que
, 
rvi_que_n
,

816 &
obje_ty
, &
obje_
);

817 
	`_
(
pTe
, 
_n
 != -1);

818 
	`_
(
pTe
, 
obje_ty
 =
OBJECT_DEVICE
);

819 
	`_
(
pTe
, 
obje_
 == 123);

820 
n
 = 
_n
;

822 
_n
 =

823 
	`m_ack_decode_obje_ݔty
(&
rvi_que
[
n
],

824 
rvi_que_n
 - 
n
, &
obje_ݔty
, &
y_dex
);

825 
	`_
(
pTe
, 
obje_ݔty
 =
PROP_OBJECT_IDENTIFIER
);

826 
	`_
(
pTe
, 
y_dex
 =
BACNET_ARRAY_ALL
);

827 
n
 +
_n
;

829 
	`_
(
pTe
, 
	`decode_is_ݒg_g_numb
(&
rvi_que
[
n
], 4));

830 
n
++;

834 
_n
 =

835 
	`ba_decode_iti_da
(&
rvi_que
[
n
],

836 
rvi_que_n
 - 
n
, &
_iti_da
);

837 
	`_
(
pTe
, 
_n
 > 0);

838 
	`_
(
pTe
, 
	`ba_me_vue
(&
iti_da
[0],

839 &
_iti_da
));

840 
n
 +
_n
;

841 
	`_
(
pTe
, 
	`decode_is_osg_g_numb
(&
rvi_que
[
n
], 4));

842 
n
++;

844 
_n
 =

845 
	`m_ack_decode_obje_ݔty
(&
rvi_que
[
n
],

846 
rvi_que_n
 - 
n
, &
obje_ݔty
, &
y_dex
);

847 
	`_
(
pTe
, 
_n
 != -1);

848 
	`_
(
pTe
, 
obje_ݔty
 =
PROP_OBJECT_TYPE
);

849 
	`_
(
pTe
, 
y_dex
 =
BACNET_ARRAY_ALL
);

850 
n
 +
_n
;

852 
	`_
(
pTe
, 
	`decode_is_ݒg_g_numb
(&
rvi_que
[
n
], 4));

853 
n
++;

855 
_n
 =

856 
	`ba_decode_iti_da
(&
rvi_que
[
n
],

857 
rvi_que_n
 - 
n
, &
_iti_da
);

858 
	`_
(
pTe
, 
_n
 > 0);

859 
	`_
(
pTe
, 
	`ba_me_vue
(&
iti_da
[1],

860 &
_iti_da
));

861 
n
 +
_n
;

862 
	`_
(
pTe
, 
	`decode_is_osg_g_numb
(&
rvi_que
[
n
], 4));

863 
n
++;

866 
_n
 =

867 
	`m_ack_decode_obje_ݔty
(&
rvi_que
[
n
],

868 
rvi_que_n
 - 
n
, &
obje_ݔty
, &
y_dex
);

869 
	`_
(
pTe
, 
_n
 == -1);

871 
_n
 =

872 
	`m_ack_decode_obje_d
(&
rvi_que
[
n
],

873 
rvi_que_n
 - 
n
);

874 
	`_
(
pTe
, 
_n
 == 1);

875 
n
 +
_n
;

877 
_n
 =

878 
	`m_ack_decode_obje_id
(&
rvi_que
[
n
],

879 
rvi_que_n
 - 
n
, &
obje_ty
, &
obje_
);

880 
	`_
(
pTe
, 
_n
 != -1);

881 
	`_
(
pTe
, 
obje_ty
 =
OBJECT_ANALOG_INPUT
);

882 
	`_
(
pTe
, 
obje_
 == 33);

883 
n
 +
_n
;

885 
_n
 =

886 
	`m_ack_decode_obje_ݔty
(&
rvi_que
[
n
],

887 
rvi_que_n
 - 
n
, &
obje_ݔty
, &
y_dex
);

888 
	`_
(
pTe
, 
_n
 != -1);

889 
	`_
(
pTe
, 
obje_ݔty
 =
PROP_PRESENT_VALUE
);

890 
	`_
(
pTe
, 
y_dex
 =
BACNET_ARRAY_ALL
);

891 
n
 +
_n
;

893 
	`_
(
pTe
, 
	`decode_is_ݒg_g_numb
(&
rvi_que
[
n
], 4));

894 
n
++;

896 
_n
 =

897 
	`ba_decode_iti_da
(&
rvi_que
[
n
],

898 
rvi_que_n
 - 
n
, &
_iti_da
);

899 
	`_
(
pTe
, 
_n
 > 0);

900 
	`_
(
pTe
, 
	`ba_me_vue
(&
iti_da
[2],

901 &
_iti_da
));

902 
n
 +
_n
;

903 
	`_
(
pTe
, 
	`decode_is_osg_g_numb
(&
rvi_que
[
n
], 4));

904 
n
++;

906 
_n
 =

907 
	`m_ack_decode_obje_ݔty
(&
rvi_que
[
n
],

908 
rvi_que_n
 - 
n
, &
obje_ݔty
, &
y_dex
);

909 
	`_
(
pTe
, 
_n
 != -1);

910 
	`_
(
pTe
, 
obje_ݔty
 =
PROP_DEADBAND
);

911 
	`_
(
pTe
, 
y_dex
 =
BACNET_ARRAY_ALL
);

912 
n
 +
_n
;

914 
	`_
(
pTe
, 
	`decode_is_ݒg_g_numb
(&
rvi_que
[
n
], 5));

915 
n
++;

917 
_n
 =

918 
	`ba_decode_r_ass_d_code
(&
rvi_que
[
n
],

919 
rvi_que_n
 - 
n
, &
r_ass
, &
r_code
);

920 
	`_
(
pTe
, 
_n
 != 0);

921 
	`_
(
pTe
, 
r_ass
 =
ERROR_CLASS_PROPERTY
);

922 
	`_
(
pTe
, 
r_code
 =
ERROR_CODE_UNKNOWN_PROPERTY
);

923 
n
 +
_n
;

924 
	`_
(
pTe
, 
	`decode_is_osg_g_numb
(&
rvi_que
[
n
], 5));

925 
n
++;

927 
_n
 =

928 
	`m_ack_decode_obje_ݔty
(&
rvi_que
[
n
],

929 
rvi_que_n
 - 
n
, &
obje_ݔty
, &
y_dex
);

930 
	`_
(
pTe
, 
_n
 == -1);

932 
_n
 =

933 
	`m_ack_decode_obje_d
(&
rvi_que
[
n
],

934 
rvi_que_n
 - 
n
);

935 
	`_
(
pTe
, 
_n
 == 1);

936 
n
 +
_n
;

938 
_n
 =

939 
	`m_ack_decode_obje_id
(&
rvi_que
[
n
],

940 
rvi_que_n
 - 
n
, &
obje_ty
, &
obje_
);

941 
	`_
(
pTe
, 
_n
 == 0);

942 
	`_
(
pTe
, 
n
 =
rvi_que_n
);

943 
	}
}

945 #ifde
TEST_READ_PROPERTY_MULTIPLE


946 
	$ma
(

949 
Te
 *
pTe
;

950 
bo
 
rc
;

952 
pTe
 = 
	`_
("BACÈRdPrݔtyMuɝ", 
NULL
);

954 
rc
 = 
	`_addTeFuni
(
pTe
, 
RdPrݔtyMuɝ
);

955 
	`as
(
rc
);

956 
rc
 = 
	`_addTeFuni
(
pTe
, 
RdPrݔtyMuɝAck
);

957 
	`as
(
rc
);

959 
	`_tSm
(
pTe
, 
dout
);

960 
	`_run
(
pTe
);

961 (
	`_pt
(
pTe
);

962 
	`_deroy
(
pTe
);

965 
	}
}

	@src/sbuf.c

40 
	~<dt.h
>

41 
	~<dbo.h
>

42 
	~<ddef.h
>

43 
	~"sbuf.h
"

45 
	$sbuf_
(

46 
STATIC_BUFFER
 * 
b
,

47 *
da
,

48 
size
)

50 i(
b
) {

51 
b
->
da
 = data;

52 
b
->
size
 = size;

53 
b
->
cou
 = 0;

57 
	}
}

60 
bo
 
	$sbuf_emy
(

61 
STATIC_BUFFER
 cڡ *
b
)

63  (
b
 ? (b->
cou
 =0: 
l
);

64 
	}
}

66 *
	$sbuf_da
(

67 
STATIC_BUFFER
 cڡ *
b
)

69  (
b
 ? b->
da
 : 
NULL
);

70 
	}
}

72 
	$sbuf_size
(

73 
STATIC_BUFFER
 * 
b
)

75  (
b
 ? b->
size
 : 0);

76 
	}
}

78 
	$sbuf_cou
(

79 
STATIC_BUFFER
 * 
b
)

81  (
b
 ? b->
cou
 : 0);

82 
	}
}

85 
bo
 
	$sbuf_put
(

86 
STATIC_BUFFER
 * 
b
,

87 
offt
,

88 *
da
,

89 
da_size
)

91 
bo
 
us
 = 
l
;

93 i(
b
 && b->
da
) {

94 i(((
offt
 + 
da_size
< 
b
->
size
)) {

95 
b
->
cou
 = 
offt
 + 
da_size
;

96 
da_size
) {

97 
b
->
da
[
offt
] = *data;

98 
offt
++;

99 
da
++;

100 
da_size
--;

102 
us
 = 
ue
;

106  
us
;

107 
	}
}

110 
bo
 
	$sbuf_nd
(

111 
STATIC_BUFFER
 * 
b
,

112 *
da
,

113 
da_size
)

115 
cou
 = 0;

117 i(
b
) {

118 
cou
 = 
b
->count;

121  
	`sbuf_put
(
b
, 
cou
, 
da
, 
da_size
);

122 
	}
}

125 
bo
 
	$sbuf_un
(

126 
STATIC_BUFFER
 * 
b
,

127 
cou
)

129 
bo
 
us
 = 
l
;

131 i(
b
) {

132 i(
cou
 < 
b
->
size
) {

133 
b
->
cou
 = count;

134 
us
 = 
ue
;

138  
us
;

139 
	}
}

141 #ifde
TEST


142 
	~<as.h
>

143 
	~<rg.h
>

145 
	~"e.h
"

147 
	$SticBufr
(

148 
Te
 * 
pTe
)

150 
STATIC_BUFFER
 
sbufr
;

151 *
da1
 = "Joshua";

152 *
da2
 = "Anna";

153 *
da3
 = "Christopher";

154 *
da4
 = "Mary";

155 
da_bufr
[480] = "";

156 
_da_bufr
[480] = "";

157 *
da
;

158 
cou
;

160 
	`sbuf_
(&
sbufr
, 
NULL
, 0);

161 
	`_
(
pTe
, 
	`sbuf_emy
(&
sbufr
=
ue
);

162 
	`_
(
pTe
, 
	`sbuf_da
(&
sbufr
=
NULL
);

163 
	`_
(
pTe
, 
	`sbuf_size
(&
sbufr
) == 0);

164 
	`_
(
pTe
, 
	`sbuf_cou
(&
sbufr
) == 0);

165 
	`_
(
pTe
, 
	`sbuf_nd
(&
sbufr
, 
da1
, 
	`
(da1)=
l
);

167 
	`sbuf_
(&
sbufr
, 
da_bufr
, (data_buffer));

168 
	`_
(
pTe
, 
	`sbuf_emy
(&
sbufr
=
ue
);

169 
	`_
(
pTe
, 
	`sbuf_da
(&
sbufr
=
da_bufr
);

170 
	`_
(
pTe
, 
	`sbuf_size
(&
sbufr
=(
da_bufr
));

171 
	`_
(
pTe
, 
	`sbuf_cou
(&
sbufr
) == 0);

173 
	`_
(
pTe
, 
	`sbuf_nd
(&
sbufr
, 
da1
, 
	`
(da1)=
ue
);

174 
	`_
(
pTe
, 
	`sbuf_nd
(&
sbufr
, 
da2
, 
	`
(da2)=
ue
);

175 
	`_
(
pTe
, 
	`sbuf_nd
(&
sbufr
, 
da3
, 
	`
(da3)=
ue
);

176 
	`_
(
pTe
, 
	`sbuf_nd
(&
sbufr
, 
da4
, 
	`
(da4)=
ue
);

177 
	`rt
(
_da_bufr
, 
da1
);

178 
	`rt
(
_da_bufr
, 
da2
);

179 
	`rt
(
_da_bufr
, 
da3
);

180 
	`rt
(
_da_bufr
, 
da4
);

181 
	`_
(
pTe
, 
	`sbuf_cou
(&
sbufr
=
	`
(
_da_bufr
));

183 
da
 = 
	`sbuf_da
(&
sbufr
);

184 
cou
 = 
	`sbuf_cou
(&
sbufr
);

185 
	`_
(
pTe
, 
	`memcmp
(
da
, 
_da_bufr
, 
cou
) == 0);

186 
	`_
(
pTe
, 
cou
 =
	`
(
_da_bufr
));

188 
	`_
(
pTe
, 
	`sbuf_un
(&
sbufr
, 0=
ue
);

189 
	`_
(
pTe
, 
	`sbuf_cou
(&
sbufr
) == 0);

190 
	`_
(
pTe
, 
	`sbuf_size
(&
sbufr
=(
da_bufr
));

191 
	`_
(
pTe
, 
	`sbuf_nd
(&
sbufr
, 
da4
, 
	`
(da4)=
ue
);

192 
da
 = 
	`sbuf_da
(&
sbufr
);

193 
cou
 = 
	`sbuf_cou
(&
sbufr
);

194 
	`_
(
pTe
, 
	`memcmp
(
da
, 
da4
, 
cou
) == 0);

195 
	`_
(
pTe
, 
cou
 =
	`
(
da4
));

198 
	}
}

200 #ifde
TEST_STATIC_BUFFER


201 
	$ma
(

204 
Te
 *
pTe
;

205 
bo
 
rc
;

207 
pTe
 = 
	`_
("ibufr", 
NULL
);

210 
rc
 = 
	`_addTeFuni
(
pTe
, 
SticBufr
);

211 
	`as
(
rc
);

213 
	`_tSm
(
pTe
, 
dout
);

214 
	`_run
(
pTe
);

215 (
	`_pt
(
pTe
);

217 
	`_deroy
(
pTe
);

220 
	}
}

	@src/timestamp.c

35 
	~"as.h
"

36 
	~"timeamp.h
"

41 
	$ba_timeamp_cy
(

42 
BACNET_TIMESTAMP
 * 
de
,

43 
BACNET_TIMESTAMP
 * 
c
)

45 i(
de
 && 
c
) {

46 
de
->
g
 = 
c
->tag;

47 
c
->
g
) {

48 
TIME_STAMP_TIME
:

49 
	`dime_cy_time
(&
de
->
vue
.
time
, &
c
->value.time);

51 
TIME_STAMP_SEQUENCE
:

52 
de
->
vue
.
quNum
 = 
c
->value.sequenceNum;

54 
TIME_STAMP_DATETIME
:

55 
	`dime_cy
(&
de
->
vue
.
deTime
, &
c
->value.dateTime);

61 
	}
}

63 
	$ba_code_timeamp
(

64 
ut8_t
 * 
du
,

65 
BACNET_TIMESTAMP
 * 
vue
)

67 
n
 = 0;

69 i(
vue
 && 
du
) {

70 
vue
->
g
) {

71 
TIME_STAMP_TIME
:

72 
n
 = 
	`code_cڋxt_time
(&
du
[0], 0, &
vue
->vue.
time
);

75 
TIME_STAMP_SEQUENCE
:

76 
n
 =

77 
	`code_cڋxt_unsigd
(&
du
[0], 1,

78 
vue
->vue.
quNum
);

81 
TIME_STAMP_DATETIME
:

82 
n
 =

83 
	`ba_code_cڋxt_dime
(&
du
[0], 2,

84 &
vue
->vue.
deTime
);

88 
n
 = 0;

89 
	`as
(0);

94  
n
;

95 
	}
}

97 
	$ba_code_cڋxt_timeamp
(

98 
ut8_t
 * 
du
,

99 
ut8_t
 
g_numb
,

100 
BACNET_TIMESTAMP
 * 
vue
)

102 
n
 = 0;

103 
du_n
 = 0;

105 i(
vue
 && 
du
) {

106 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 
g_numb
);

107 
du_n
 +
n
;

108 
n
 = 
	`ba_code_timeamp
(&
du
[
du_n
], 
vue
);

109 
du_n
 +
n
;

110 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 
g_numb
);

111 
du_n
 +
n
;

113  
du_n
;

114 
	}
}

116 
	$ba_decode_timeamp
(

117 
ut8_t
 * 
du
,

118 
BACNET_TIMESTAMP
 * 
vue
)

120 
n
 = 0;

121 
i_n
;

122 
ut32_t
 
n_vue_ty
;

123 
ut32_t
 
quNum
;

125 i(
du
) {

126 
i_n
 =

127 
	`decode_g_numb_d_vue
(&
du
[
n
], &
vue
->
g
,

128 &
n_vue_ty
);

130 i(-1 =
i_n
) {

133 
vue
->
g
) {

134 
TIME_STAMP_TIME
:

135 i((
i_n
 =

136 
	`decode_cڋxt_ba_time
(&
du
[
n
], 
TIME_STAMP_TIME
,

137 &
vue
->vue.
time
)) == -1) {

140 
n
 +
i_n
;

144 
TIME_STAMP_SEQUENCE
:

145 i((
i_n
 =

146 
	`decode_cڋxt_unsigd
(&
du
[
n
],

147 
TIME_STAMP_SEQUENCE
, &
quNum
)) == -1) {

150 i(
quNum
 <= 0xffff) {

151 
n
 +
i_n
;

152 
vue
->vue.
quNum
 = (
ut16_t
) sequenceNum;

159 
TIME_STAMP_DATETIME
:

160 i((
i_n
 =

161 
	`ba_decode_cڋxt_dime
(&
du
[
n
],

162 
TIME_STAMP_DATETIME
,

163 &
vue
->vue.
deTime
)) == -1) {

166 
n
 +
i_n
;

175  
n
;

176 
	}
}

178 
	$ba_decode_cڋxt_timeamp
(

179 
ut8_t
 * 
du
,

180 
ut8_t
 
g_numb
,

181 
BACNET_TIMESTAMP
 * 
vue
)

183 
n
 = 0;

184 
i_n
;

187 i(
	`decode_is_ݒg_g_numb
(&
du
[
n
], 
g_numb
)) {

188 
n
++;

189 
i_n
 = 
	`ba_decode_timeamp
(&
du
[
n
], 
vue
);

190 i(
i_n
 > 0) {

191 
n
 +
i_n
;

192 i(
	`decode_is_osg_g_numb
(&
du
[
n
], 
g_numb
)) {

193 
n
++;

199  
n
;

200 
	}
}

202 #ifde
TEST


204 
	~<as.h
>

205 
	~<rg.h
>

206 
	~"e.h
"

209 
	$TimeampSequ
(

210 
Te
 * 
pTe
)

212 
BACNET_TIMESTAMP
 
TimeampIn
;

213 
BACNET_TIMESTAMP
 
TimeampOut
;

214 
ut8_t
 
bufr
[
MAX_APDU
];

215 
L
;

216 
outL
;

218 
TimeampIn
.
g
 = 
TIME_STAMP_SEQUENCE
;

219 
TimeampIn
.
vue
.
quNum
 = 0x1234;

221 
	`memt
(&
TimeampOut
, 0, (testTimestampOut));

224 
L
 = 
	`ba_code_cڋxt_timeamp
(
bufr
, 2, &
TimeampIn
);

225 
outL
 = 
	`ba_decode_cڋxt_timeamp
(
bufr
, 2, &
TimeampOut
);

227 
	`_
(
pTe
, 
L
 =
outL
);

228 
	`_
(
pTe
, 
TimeampIn
.
g
 =
TimeampOut
.tag);

229 
	`_
(
pTe
,

230 
TimeampIn
.
vue
.
quNum
 ==

231 
TimeampOut
.
vue
.
quNum
);

232 
	}
}

234 
	$TimeampTime
(

235 
Te
 * 
pTe
)

237 
BACNET_TIMESTAMP
 
TimeampIn
;

238 
BACNET_TIMESTAMP
 
TimeampOut
;

239 
ut8_t
 
bufr
[
MAX_APDU
];

240 
L
;

241 
outL
;

243 
TimeampIn
.
g
 = 
TIME_STAMP_TIME
;

244 
TimeampIn
.
vue
.
time
.
hour
 = 1;

245 
TimeampIn
.
vue
.
time
.
m
 = 2;

246 
TimeampIn
.
vue
.
time
.
c
 = 3;

247 
TimeampIn
.
vue
.
time
.
hunddths
 = 4;

249 
	`memt
(&
TimeampOut
, 0, (testTimestampOut));

252 
L
 = 
	`ba_code_cڋxt_timeamp
(
bufr
, 2, &
TimeampIn
);

253 
outL
 = 
	`ba_decode_cڋxt_timeamp
(
bufr
, 2, &
TimeampOut
);

255 
	`_
(
pTe
, 
L
 =
outL
);

256 
	`_
(
pTe
, 
TimeampIn
.
g
 =
TimeampOut
.tag);

257 
	`_
(
pTe
,

258 
TimeampIn
.
vue
.
time
.
hour
 =
TimeampOut
.value.time.hour);

259 
	`_
(
pTe
,

260 
TimeampIn
.
vue
.
time
.
m
 =
TimeampOut
.value.time.min);

261 
	`_
(
pTe
,

262 
TimeampIn
.
vue
.
time
.
c
 =
TimeampOut
.value.time.sec);

263 
	`_
(
pTe
,

264 
TimeampIn
.
vue
.
time
.
hunddths
 ==

265 
TimeampOut
.
vue
.
time
.
hunddths
);

266 
	}
}

268 
	$TimeampTimeDe
(

269 
Te
 * 
pTe
)

271 
BACNET_TIMESTAMP
 
TimeampIn
;

272 
BACNET_TIMESTAMP
 
TimeampOut
;

273 
ut8_t
 
bufr
[
MAX_APDU
];

274 
L
;

275 
outL
;

277 
TimeampIn
.
g
 = 
TIME_STAMP_DATETIME
;

278 
TimeampIn
.
vue
.
deTime
.
time
.
hour
 = 1;

279 
TimeampIn
.
vue
.
deTime
.
time
.
m
 = 2;

280 
TimeampIn
.
vue
.
deTime
.
time
.
c
 = 3;

281 
TimeampIn
.
vue
.
deTime
.
time
.
hunddths
 = 4;

283 
TimeampIn
.
vue
.
deTime
.
de
.
yr
 = 1901;

284 
TimeampIn
.
vue
.
deTime
.
de
.
mth
 = 1;

285 
TimeampIn
.
vue
.
deTime
.
de
.
wday
 = 2;

286 
TimeampIn
.
vue
.
deTime
.
de
.
day
 = 3;

288 
	`memt
(&
TimeampOut
, 0, (testTimestampOut));

290 
L
 = 
	`ba_code_cڋxt_timeamp
(
bufr
, 2, &
TimeampIn
);

291 
outL
 = 
	`ba_decode_cڋxt_timeamp
(
bufr
, 2, &
TimeampOut
);

293 
	`_
(
pTe
, 
L
 =
outL
);

294 
	`_
(
pTe
, 
TimeampIn
.
g
 =
TimeampOut
.tag);

295 
	`_
(
pTe
,

296 
TimeampIn
.
vue
.
deTime
.
time
.
hour
 ==

297 
TimeampOut
.
vue
.
deTime
.
time
.
hour
);

298 
	`_
(
pTe
,

299 
TimeampIn
.
vue
.
deTime
.
time
.
m
 ==

300 
TimeampOut
.
vue
.
deTime
.
time
.
m
);

301 
	`_
(
pTe
,

302 
TimeampIn
.
vue
.
deTime
.
time
.
c
 ==

303 
TimeampOut
.
vue
.
deTime
.
time
.
c
);

304 
	`_
(
pTe
,

305 
TimeampIn
.
vue
.
deTime
.
time
.
hunddths
 ==

306 
TimeampOut
.
vue
.
deTime
.
time
.
hunddths
);

308 
	`_
(
pTe
,

309 
TimeampIn
.
vue
.
deTime
.
de
.
yr
 ==

310 
TimeampOut
.
vue
.
deTime
.
de
.
yr
);

311 
	`_
(
pTe
,

312 
TimeampIn
.
vue
.
deTime
.
de
.
mth
 ==

313 
TimeampOut
.
vue
.
deTime
.
de
.
mth
);

314 
	`_
(
pTe
,

315 
TimeampIn
.
vue
.
deTime
.
de
.
wday
 ==

316 
TimeampOut
.
vue
.
deTime
.
de
.
wday
);

317 
	`_
(
pTe
,

318 
TimeampIn
.
vue
.
deTime
.
de
.
day
 ==

319 
TimeampOut
.
vue
.
deTime
.
de
.
day
);

321 
	}
}

323 #ifde
TEST_TIME_STAMP


325 
	$ma
(

328 
Te
 *
pTe
;

329 
bo
 
rc
;

331 
pTe
 = 
	`_
("BACÈTimSmp", 
NULL
);

333 
rc
 = 
	`_addTeFuni
(
pTe
, 
TimeampSequ
);

334 
	`as
(
rc
);

336 
rc
 = 
	`_addTeFuni
(
pTe
, 
TimeampTime
);

337 
	`as
(
rc
);

339 
rc
 = 
	`_addTeFuni
(
pTe
, 
TimeampTimeDe
);

340 
	`as
(
rc
);

342 
	`_tSm
(
pTe
, 
dout
);

343 
	`_run
(
pTe
);

344 (
	`_pt
(
pTe
);

345 
	`_deroy
(
pTe
);

348 
	}
}

	@src/timesync.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"ba.h
"

39 
	~"timesync.h
"

42 #i
BACNET_SVC_TS_A


44 
	$timesync_code_du_rvi
(

45 
ut8_t
 * 
du
,

46 
BACNET_UNCONFIRMED_SERVICE
 
rvi
,

47 
BACNET_DATE
 * 
my_de
,

48 
BACNET_TIME
 * 
my_time
)

50 
n
 = 0;

51 
du_n
 = 0;

53 i(
du
 && 
my_de
 && 
my_time
) {

54 
du
[0] = 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
;

55 
du
[1] = 
rvi
;

56 
du_n
 = 2;

57 
n
 = 
	`code_iti_de
(&
du
[
du_n
], 
my_de
);

58 
du_n
 +
n
;

59 
n
 = 
	`code_iti_time
(&
du
[
du_n
], 
my_time
);

60 
du_n
 +
n
;

63  
du_n
;

64 
	}
}

66 
	$timesync_utc_code_du
(

67 
ut8_t
 * 
du
,

68 
BACNET_DATE
 * 
my_de
,

69 
BACNET_TIME
 * 
my_time
)

71  
	`timesync_code_du_rvi
(
du
,

72 
SERVICE_UNCONFIRMED_UTC_TIME_SYNCHRONIZATION
, 
my_de
, 
my_time
);

73 
	}
}

75 
	$timesync_code_du
(

76 
ut8_t
 * 
du
,

77 
BACNET_DATE
 * 
my_de
,

78 
BACNET_TIME
 * 
my_time
)

80  
	`timesync_code_du_rvi
(
du
,

81 
SERVICE_UNCONFIRMED_TIME_SYNCHRONIZATION
, 
my_de
, 
my_time
);

82 
	}
}

86 
	$timesync_decode_rvi_que
(

87 
ut8_t
 * 
du
,

88 
du_n
,

89 
BACNET_DATE
 * 
my_de
,

90 
BACNET_TIME
 * 
my_time
)

92 
n
 = 0;

93 
ut8_t
 
g_numb
 = 0;

94 
ut32_t
 
n_vue
 = 0;

96 i(
du_n
 && 
my_de
 && 
my_time
) {

98 
n
 +=

99 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

100 i(
g_numb
 =
BACNET_APPLICATION_TAG_DATE
) {

101 
n
 +
	`decode_de
(&
du
[n], 
my_de
);

105 
n
 +=

106 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

107 i(
g_numb
 =
BACNET_APPLICATION_TAG_TIME
) {

108 
n
 +
	`decode_ba_time
(&
du
[n], 
my_time
);

113  
n
;

114 
	}
}

140 
	$timesync_code_timesync_cs
(

141 
ut8_t
 * 
du
,

142 
max_du
,

143 
BACNET_RECIPIENT_LIST
 * 
c
)

145 
n
 = 0;

146 
du_n
 = 0;

147 
BACNET_OCTET_STRING
 
o_rg
;

148 
BACNET_RECIPIENT_LIST
 *
pRec
;

150 
pRec
 = 
c
;

151 
pRec
 !
NULL
) {

152 i(
pRec
->
g
 == 0) {

153 i(
max_du
 >= (1 + 4)) {

155 
n
 =

156 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0,

157 
pRec
->
ty
.
devi
.type,

158 
pRec
->
ty
.
devi
.

);

159 
du_n
 +
n
;

161  
BACNET_STATUS_ABORT
;

163 } i(
pRec
->
g
 == 1) {

164 i(
pRec
->
ty
.
addss
.
t
) {

165 
n
 = 1 + 3 + 2 + 
pRec
->
ty
.
addss
.len + 1;

167 
n
 = 1 + 3 + 2 + 
pRec
->
ty
.
addss
.
mac_n
 + 1;

169 i(
max_du
 >
n
) {

171 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 1);

172 
du_n
 +
n
;

175 
n
 =

176 
	`code_iti_unsigd
(&
du
[
du_n
],

177 
pRec
->
ty
.
addss
.
t
);

178 
du_n
 +
n
;

181 i(
pRec
->
ty
.
addss
.
t
 =
BACNET_BROADCAST_NETWORK
) {

182 
	`org_
(&
o_rg
, 
NULL
, 0);

183 } i(
pRec
->
ty
.
addss
.
t
) {

184 
	`org_
(&
o_rg
,

185 &
pRec
->
ty
.
addss
.
adr
[0],

186 
pRec
->
ty
.
addss
.
n
);

188 
	`org_
(&
o_rg
,

189 &
pRec
->
ty
.
addss
.
mac
[0],

190 
pRec
->
ty
.
addss
.
mac_n
);

192 
n
 =

193 
	`code_iti_o_rg
(&
du
[
du_n
],

194 &
o_rg
);

195 
du_n
 +
n
;

197 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 1);

198 
du_n
 +
n
;

203 
pRec
 =Rec->
xt
;

206  
du_n
;

207 
	}
}

233 
	$timesync_decode_timesync_cs
(

234 
ut8_t
 * 
du
,

235 
max_du
,

236 
BACNET_RECIPIENT_LIST
 * 
c
)

238 
n
 = 0;

239 
du_n
 = 0;

240 
g_n
 = 0;

241 
ut8_t
 
g_numb
 = 0;

242 
ut32_t
 
n_vue_ty
 = 0;

243 
ut32_t
 
unsigd_vue
 = 0;

244 
BACNET_OCTET_STRING
 
o_rg
;

245 
BACNET_RECIPIENT_LIST
 *
pRec
;

247 
pRec
 = 
c
;

248 
pRec
 !
NULL
) {

250 i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 0)) {

251 
pRec
->
g
 = 0;

252 
n
 =

253 
	`decode_cڋxt_obje_id
(&
du
[
du_n
], 0,

254 &
pRec
->
ty
.
devi
.type,

255 &
pRec
->
ty
.
devi
.

);

256 i(
n
 < 0) {

257  
BACNET_STATUS_ABORT
;

259 
du_n
 +
n
;

260 } i(
	`decode_is_cڋxt_g
(&
du
[
du_n
], 1)) {

261 
du_n
 += 1;

262 
pRec
->
g
 = 1;

264 
g_n
 =

265 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

266 &
n_vue_ty
);

267 
du_n
 +
g_n
;

268 i(
g_numb
 !
BACNET_APPLICATION_TAG_UNSIGNED_INT
) {

269  
BACNET_STATUS_ABORT
;

271 
n
 =

272 
	`decode_unsigd
(&
du
[
du_n
], 
n_vue_ty
,

273 &
unsigd_vue
);

274 
pRec
->
ty
.
addss
.
t
 = 
unsigd_vue
;

275 
du_n
 +
n
;

277 
g_n
 =

278 
	`decode_g_numb_d_vue
(&
du
[
du_n
], &
g_numb
,

279 &
n_vue_ty
);

280 
du_n
 +
g_n
;

281 i(
g_numb
 !
BACNET_APPLICATION_TAG_OCTET_STRING
) {

282  
BACNET_STATUS_ABORT
;

284 
n
 = 
	`decode_o_rg
(&
du
[0], 
n_vue_ty
, &
o_rg
);

285 
du_n
 +
n
;

286 i(
	`org_ngth
(&
o_rg
) == 0) {

288 } i(
pRec
->
ty
.
addss
.
t
) {

289 
pRec
->
ty
.
addss
.
n
 =

290 
	`org_cy_vue
(&
pRec
->
ty
.
addss
.
adr
[0],

291 (
pRec
->
ty
.
addss
.
adr
), &
o_rg
);

293 
pRec
->
ty
.
addss
.
mac_n
 =

294 
	`org_cy_vue
(&
pRec
->
ty
.
addss
.
mac
[0],

295 (
pRec
->
ty
.
addss
.
mac
), &
o_rg
);

298  
BACNET_STATUS_ABORT
;

300 
pRec
 =Rec->
xt
;

303  
du_n
;

304 
	}
}

307 #ifde
TEST


308 
	~<as.h
>

309 
	~<rg.h
>

310 
	~"e.h
"

312 
	$TimeSyncRecDa
(

313 
Te
 * 
pTe
,

314 
BACNET_RECIPIENT_LIST
 * 
c1
,

315 
BACNET_RECIPIENT_LIST
 * 
c2
)

317 
i
 = 0;

319 i(
c1
 && 
c2
) {

320 
	`_
(
pTe
, 
c1
->
g
 =
c2
->tag);

321 i(
c1
->
g
 == 0) {

322 
	`_
(
pTe
,

323 
c1
->
ty
.
devi
.ty =
c2
->type.device.type);

324 
	`_
(
pTe
,

325 
c1
->
ty
.
devi
.

 ==

326 
c2
->
ty
.
devi
.

);

327 } i(
c1
->
g
 == 1) {

328 
	`_
(
pTe
,

329 
c1
->
ty
.
addss
.
t
 =
c2
->type.address.net);

330 i(
c1
->
ty
.
addss
.
t
 =
BACNET_BROADCAST_NETWORK
) {

331 
	`_
(
pTe
,

332 
c1
->
ty
.
addss
.
mac_n
 ==

333 
c2
->
ty
.
addss
.
mac_n
);

334 } i(
c1
->
ty
.
addss
.
t
) {

335 
	`_
(
pTe
,

336 
c1
->
ty
.
addss
.
n
 ==

337 
c2
->
ty
.
addss
.
n
);

338 
i
 = 0; i < 
c1
->
ty
.
addss
.
n
; i++) {

339 
	`_
(
pTe
,

340 
c1
->
ty
.
addss
.
adr
[
i
] ==

341 
c2
->
ty
.
addss
.
adr
[
i
]);

344 
	`_
(
pTe
,

345 
c1
->
ty
.
addss
.
mac_n
 ==

346 
c2
->
ty
.
addss
.
mac_n
);

347 
i
 = 0; i < 
c1
->
ty
.
addss
.
mac_n
; i++) {

348 
	`_
(
pTe
,

349 
c1
->
ty
.
addss
.
mac
[
i
] ==

350 
c2
->
ty
.
addss
.
mac
[
i
]);

354 
	`_
(
pTe
, 
c1
->
g
 <= 1);

357 
	}
}

359 
	$TimeSyncRec
(

360 
Te
 * 
pTe
)

362 
ut8_t
 
du
[480] = { 0 };

363 
n
 = 0;

364 
BACNET_RECIPIENT_LIST
 
c
[4];

365 
BACNET_RECIPIENT_LIST
 
_c
[4];

368 
c
[0].
xt
 = &recipient[1];

369 
c
[1].
xt
 = &recipient[2];

370 
c
[2].
xt
 = &recipient[3];

371 
c
[3].
xt
 = 
NULL
;

373 
_c
[0].
xt
 = &test_recipient[1];

374 
_c
[1].
xt
 = &test_recipient[2];

375 
_c
[2].
xt
 = &test_recipient[3];

376 
_c
[3].
xt
 = 
NULL
;

378 
c
[0].
g
 = 0;

379 
c
[0].
ty
.
devi
.ty = 
OBJECT_DEVICE
;

380 
c
[0].
ty
.
devi
.

 = 1234;

383 
c
[1].
g
 = 1;

384 
c
[1].
ty
.
addss
.
t
 = 
BACNET_BROADCAST_NETWORK
;

385 
c
[2].
ty
.
addss
.
mac_n
 = 0;

387 
c
[1].
g
 = 1;

388 
c
[2].
ty
.
addss
.
t
 = 4201;

389 
c
[2].
ty
.
addss
.
adr
[0] = 127;

390 
c
[2].
ty
.
addss
.
n
 = 1;

392 
c
[2].
ty
.
addss
.
t
 = 0;

393 
c
[2].
ty
.
addss
.
mac
[0] = 10;

394 
c
[2].
ty
.
addss
.
mac
[1] = 1;

395 
c
[2].
ty
.
addss
.
mac
[2] = 0;

396 
c
[2].
ty
.
addss
.
mac
[3] = 86;

397 
c
[2].
ty
.
addss
.
mac
[4] = 0xBA;

398 
c
[2].
ty
.
addss
.
mac
[5] = 0xC1;

399 
c
[2].
ty
.
addss
.
mac_n
 = 6;

401 
n
 =

402 
	`timesync_code_timesync_cs
(&
du
[0], (apdu),

403 &
c
[0]);

404 
	`_
(
pTe
, 
n
 !
BACNET_STATUS_ABORT
);

405 
	`_
(
pTe
, 
n
 > 0);

406 
n
 =

407 
	`timesync_decode_timesync_cs
(&
du
[0], (apdu),

408 &
_c
[0]);

409 
	`_
(
pTe
, 
n
 !
BACNET_STATUS_ABORT
);

410 
	`_
(
pTe
, 
n
 > 0);

411 
	`TimeSyncRecDa
(
pTe
, &
c
[0], &
_c
[0]);

412 
	}
}

414 
	$timesync_decode_du_rvi
(

415 
ut8_t
 * 
du
,

416 
BACNET_UNCONFIRMED_SERVICE
 
rvi
,

417 
du_n
,

418 
BACNET_DATE
 * 
my_de
,

419 
BACNET_TIME
 * 
my_time
)

421 
n
 = 0;

423 i(!
du
)

426 i(
du
[0] !
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
)

428 i(
du
[1] !
rvi
)

431 i(
du_n
 > 2) {

432 
n
 =

433 
	`timesync_decode_rvi_que
(&
du
[2], 
du_n
 - 2, 
my_de
,

434 
my_time
);

437  
n
;

438 
	}
}

440 
	$timesync_utc_decode_du
(

441 
ut8_t
 * 
du
,

442 
du_n
,

443 
BACNET_DATE
 * 
my_de
,

444 
BACNET_TIME
 * 
my_time
)

446  
	`timesync_decode_du_rvi
(
du
,

447 
SERVICE_UNCONFIRMED_UTC_TIME_SYNCHRONIZATION
, 
du_n
, 
my_de
,

448 
my_time
);

449 
	}
}

451 
	$timesync_decode_du
(

452 
ut8_t
 * 
du
,

453 
du_n
,

454 
BACNET_DATE
 * 
my_de
,

455 
BACNET_TIME
 * 
my_time
)

457  
	`timesync_decode_du_rvi
(
du
,

458 
SERVICE_UNCONFIRMED_TIME_SYNCHRONIZATION
, 
du_n
, 
my_de
, 
my_time
);

459 
	}
}

461 
	$TimeSyncDa
(

462 
Te
 * 
pTe
,

463 
BACNET_DATE
 * 
my_de
,

464 
BACNET_TIME
 * 
my_time
)

466 
ut8_t
 
du
[480] = { 0 };

467 
n
 = 0;

468 
du_n
 = 0;

469 
BACNET_DATE
 
_de
;

470 
BACNET_TIME
 
_time
;

472 
n
 = 
	`timesync_code_du
(&
du
[0], 
my_de
, 
my_time
);

473 
	`_
(
pTe
, 
n
 != 0);

474 
du_n
 = 
n
;

475 
n
 = 
	`timesync_decode_du
(&
du
[0], 
du_n
, &
_de
, &
_time
);

476 
	`_
(
pTe
, 
n
 != -1);

477 
	`_
(
pTe
, 
	`dime_com_time
(
my_time
, &
_time
) == 0);

478 
	`_
(
pTe
, 
	`dime_com_de
(
my_de
, &
_de
) == 0);

480 
n
 = 
	`timesync_utc_code_du
(&
du
[0], 
my_de
, 
my_time
);

481 
	`_
(
pTe
, 
n
 != 0);

482 
du_n
 = 
n
;

483 
n
 = 
	`timesync_utc_decode_du
(&
du
[0], 
du_n
, &
_de
, &
_time
);

484 
	`_
(
pTe
, 
n
 != -1);

485 
	`_
(
pTe
, 
	`dime_com_time
(
my_time
, &
_time
) == 0);

486 
	`_
(
pTe
, 
	`dime_com_de
(
my_de
, &
_de
) == 0);

487 
	}
}

489 
	$TimeSync
(

490 
Te
 * 
pTe
)

492 
BACNET_DATE
 
bde
;

493 
BACNET_TIME
 
btime
;

495 
bde
.
yr
 = 2006;

496 
bde
.
mth
 = 4;

497 
bde
.
day
 = 11;

498 
bde
.
wday
 = 1;

500 
btime
.
hour
 = 7;

501 
btime
.
m
 = 0;

502 
btime
.
c
 = 3;

503 
btime
.
hunddths
 = 1;

505 
	`TimeSyncDa
(
pTe
, &
bde
, &
btime
);

506 
	}
}

508 #ifde
TEST_TIMESYNC


509 
	$ma
(

512 
Te
 *
pTe
;

513 
bo
 
rc
;

515 
pTe
 = 
	`_
("BACÈTime-Sync", 
NULL
);

517 
rc
 = 
	`_addTeFuni
(
pTe
, 
TimeSync
);

518 
	`as
(
rc
);

520 
	`_tSm
(
pTe
, 
dout
);

521 
	`_run
(
pTe
);

522 (
	`_pt
(
pTe
);

523 
	`_deroy
(
pTe
);

526 
	}
}

	@src/tsm.c

35 
	~<dbo.h
>

36 
	~<dt.h
>

37 
	~<ddef.h
>

38 
	~"bs.h
"

39 
	~"du.h
"

40 
	~"bacdef.h
"

41 
	~"bacdcode.h
"

42 
	~"banum.h
"

43 
	~"tsm.h
"

44 
	~"cfig.h
"

45 
	~"dk.h
"

46 
	~"hdrs.h
"

47 
	~"addss.h
"

48 
	~"baddr.h
"

52 #i(
MAX_TSM_TRANSACTIONS
)

62 
BACNET_TSM_DATA
 
	gTSM_Li
[
MAX_TSM_TRANSACTIONS
];

65 
ut8_t
 
	gCut_Invoke_ID
 = 1;

68 
ut8_t
 
	$tsm_fd_vokeID_dex
(

69 
ut8_t
 
vokeID
)

71 
i
 = 0;

72 
ut8_t
 
dex
 = 
MAX_TSM_TRANSACTIONS
;

74 
i
 = 0; i < 
MAX_TSM_TRANSACTIONS
; i++) {

75 i(
TSM_Li
[
i
].
InvokeID
 =
vokeID
) {

76 
dex
 = (
ut8_t

i
;

81  
dex
;

82 
	}
}

84 
ut8_t
 
	$tsm_fd_f__dex
(

87 
i
 = 0;

88 
ut8_t
 
dex
 = 
MAX_TSM_TRANSACTIONS
;

90 
i
 = 0; i < 
MAX_TSM_TRANSACTIONS
; i++) {

91 i(
TSM_Li
[
i
].
InvokeID
 == 0) {

92 
dex
 = (
ut8_t

i
;

97  
dex
;

98 
	}
}

100 
bo
 
	$tsm_i_avaab
(

103 
bo
 
us
 = 
l
;

104 
i
 = 0;

106 
i
 = 0; i < 
MAX_TSM_TRANSACTIONS
; i++) {

107 i(
TSM_Li
[
i
].
InvokeID
 == 0) {

109 
us
 = 
ue
;

114  
us
;

115 
	}
}

117 
ut8_t
 
	$tsm_i_id_cou
(

120 
ut8_t
 
cou
 = 0;

121 
i
 = 0;

123 
i
 = 0; i < 
MAX_TSM_TRANSACTIONS
; i++) {

124 i((
TSM_Li
[
i
].
InvokeID
 == 0) &&

125 (
TSM_Li
[
i
].
e
 =
TSM_STATE_IDLE
)) {

127 
cou
++;

131  
cou
;

132 
	}
}

136 
	$tsm_vokeID_t
(

137 
ut8_t
 
vokeID
)

139 i(
vokeID
 == 0) {

140 
vokeID
 = 1;

142 
Cut_Invoke_ID
 = 
vokeID
;

143 
	}
}

148 
ut8_t
 
	$tsm_xt__vokeID
(

151 
ut8_t
 
dex
 = 0;

152 
ut8_t
 
vokeID
 = 0;

153 
bo
 
found
 = 
l
;

156 i(
	`tsm_i_avaab
()) {

157 !
found
) {

158 
dex
 = 
	`tsm_fd_vokeID_dex
(
Cut_Invoke_ID
);

159 i(
dex
 =
MAX_TSM_TRANSACTIONS
) {

161 
found
 = 
ue
;

163 
dex
 = 
	`tsm_fd_f__dex
();

164 i(
dex
 !
MAX_TSM_TRANSACTIONS
) {

165 
TSM_Li
[
dex
].
InvokeID
 = 
vokeID
 = 
Cut_Invoke_ID
;

166 
TSM_Li
[
dex
].
e
 = 
TSM_STATE_IDLE
;

167 
TSM_Li
[
dex
].
RequeTim
 = 
	`du_timeout
();

169 
Cut_Invoke_ID
++;

171 i(
Cut_Invoke_ID
 == 0) {

172 
Cut_Invoke_ID
 = 1;

178 
Cut_Invoke_ID
++;

180 i(
Cut_Invoke_ID
 == 0) {

181 
Cut_Invoke_ID
 = 1;

187  
vokeID
;

188 
	}
}

190 
	$tsm_t_cfmed_ungmd_i
(

191 
ut8_t
 
vokeID
,

192 
BACNET_ADDRESS
 * 
de
,

193 
BACNET_NPDU_DATA
 * 
ndpu_da
,

194 
ut8_t
 * 
du
,

195 
ut16_t
 
du_n
)

197 
ut16_t
 
j
 = 0;

198 
ut8_t
 
dex
;

200 i(
vokeID
) {

201 
dex
 = 
	`tsm_fd_vokeID_dex
(
vokeID
);

202 i(
dex
 < 
MAX_TSM_TRANSACTIONS
) {

204 
TSM_Li
[
dex
].
e
 = 
TSM_STATE_AWAIT_CONFIRMATION
;

205 
TSM_Li
[
dex
].
RryCou
 = 0;

207 
TSM_Li
[
dex
].
RequeTim
 = 
	`du_timeout
();

209 
j
 = 0; j < 
du_n
; j++) {

210 
TSM_Li
[
dex
].
du
[
j
] =pdu[j];

212 
TSM_Li
[
dex
].
du_n
 =pdu_len;

213 
	`du_cy_da
(&
TSM_Li
[
dex
].
du_da
, 
ndpu_da
);

214 
	`ba_addss_cy
(&
TSM_Li
[
dex
].
de
, dest);

219 
	}
}

223 
bo
 
	$tsm_g_i_pdu
(

224 
ut8_t
 
vokeID
,

225 
BACNET_ADDRESS
 * 
de
,

226 
BACNET_NPDU_DATA
 * 
ndpu_da
,

227 
ut8_t
 * 
du
,

228 
ut16_t
 * 
du_n
)

230 
ut16_t
 
j
 = 0;

231 
ut8_t
 
dex
;

232 
bo
 
found
 = 
l
;

234 i(
vokeID
) {

235 
dex
 = 
	`tsm_fd_vokeID_dex
(
vokeID
);

237 i(
dex
 < 
MAX_TSM_TRANSACTIONS
) {

241 *
du_n
 = (
ut16_t

TSM_Li
[
dex
].apdu_len;

242 
j
 = 0; j < *
du_n
; j++) {

243 
du
[
j
] = 
TSM_Li
[
dex
].apdu[j];

245 
	`du_cy_da
(
ndpu_da
, &
TSM_Li
[
dex
].
du_da
);

246 
	`ba_addss_cy
(
de
, &
TSM_Li
[
dex
].dest);

247 
found
 = 
ue
;

251  
found
;

252 
	}
}

255 
	$tsm_tim_mlicds
(

256 
ut16_t
 
mlicds
)

258 
i
 = 0;

260 
i
 = 0; i < 
MAX_TSM_TRANSACTIONS
; i++) {

261 i(
TSM_Li
[
i
].
e
 =
TSM_STATE_AWAIT_CONFIRMATION
) {

262 i(
TSM_Li
[
i
].
RequeTim
 > 
mlicds
)

263 
TSM_Li
[
i
].
RequeTim
 -
mlicds
;

265 
TSM_Li
[
i
].
RequeTim
 = 0;

267 i(
TSM_Li
[
i
].
RequeTim
 == 0) {

268 i(
TSM_Li
[
i
].
RryCou
 < 
	`du_s
()) {

269 
TSM_Li
[
i
].
RequeTim
 = 
	`du_timeout
();

270 
TSM_Li
[
i
].
RryCou
++;

271 
	`dk_nd_pdu
(&
TSM_Li
[
i
].
de
,

272 &
TSM_Li
[
i
].
du_da
, &TSM_Li[i].
du
[0],

273 
TSM_Li
[
i
].
du_n
);

278 
TSM_Li
[
i
].
e
 = 
TSM_STATE_IDLE
;

283 
	}
}

286 
	$tsm__voke_id
(

287 
ut8_t
 
vokeID
)

289 
ut8_t
 
dex
;

291 
dex
 = 
	`tsm_fd_vokeID_dex
(
vokeID
);

292 i(
dex
 < 
MAX_TSM_TRANSACTIONS
) {

293 
TSM_Li
[
dex
].
e
 = 
TSM_STATE_IDLE
;

294 
TSM_Li
[
dex
].
InvokeID
 = 0;

296 
	}
}

302 
bo
 
	$tsm_voke_id_
(

303 
ut8_t
 
vokeID
)

305 
bo
 
us
 = 
ue
;

306 
ut8_t
 
dex
;

308 
dex
 = 
	`tsm_fd_vokeID_dex
(
vokeID
);

309 i(
dex
 < 
MAX_TSM_TRANSACTIONS
)

310 
us
 = 
l
;

312  
us
;

313 
	}
}

321 
bo
 
	$tsm_voke_id_ed
(

322 
ut8_t
 
vokeID
)

324 
bo
 
us
 = 
l
;

325 
ut8_t
 
dex
;

327 
dex
 = 
	`tsm_fd_vokeID_dex
(
vokeID
);

328 i(
dex
 < 
MAX_TSM_TRANSACTIONS
) {

331 i(
TSM_Li
[
dex
].
e
 =
TSM_STATE_IDLE
)

332 
us
 = 
ue
;

335  
us
;

336 
	}
}

339 #ifde
TEST


340 
	~<as.h
>

341 
	~<rg.h
>

342 
	~"e.h
"

345 
bo
 
	gI_Am_Reque
 = 
ue
;

348 
	$dk_nd_pdu
(

349 
BACNET_ADDRESS
 * 
de
,

350 
BACNET_NPDU_DATA
 * 
du_da
,

351 
ut8_t
 * 
pdu
,

352 
pdu_n
)

354 (
de
;

355 (
du_da
;

356 (
pdu
;

357 (
pdu_n
;

360 
	}
}

363 
	$dk_g_brd_addss
(

364 
BACNET_ADDRESS
 * 
de
)

366 (
de
;

367 
	}
}

369 
	$TSM
(

370 
Te
 * 
pTe
)

374 
	}
}

376 #ifde
TEST_TSM


377 
	$ma
(

380 
Te
 *
pTe
;

381 
bo
 
rc
;

383 
pTe
 = 
	`_
("BACÈTSM", 
NULL
);

385 
rc
 = 
	`_addTeFuni
(
pTe
, 
TSM
);

386 
	`as
(
rc
);

388 
	`_tSm
(
pTe
, 
dout
);

389 
	`_run
(
pTe
);

390 (
	`_pt
(
pTe
);

391 
	`_deroy
(
pTe
);

394 
	}
}

	@src/version.c

34 
	~"vsi.h
"

38 *
	gBACt_Vsi
 = 
BACNET_VERSION_TEXT
;

	@src/vmac.c

34 
	~<ddef.h
>

35 
	~<dt.h
>

36 
	~<dbo.h
>

37 
	~<dio.h
>

38 
	~<dlib.h
>

39 
	~"cfig.h
"

40 
	~"bacdef.h
"

41 
	~"keyli.h
"

43 
	~"vmac.h
"

52 
OS_Keyli
 
	gVMAC_Li
;

57 
	$VMAC_Cou
()

59  ()
	`Keyli_Cou
(
VMAC_Li
);

60 
	}
}

70 
bo
 
	$VMAC_Add
(
ut32_t
 
devi_id
, 
vmac_da
 *
c
)

72 
bo
 
us
 = 
l
;

73 
vmac_da
 *
pVMAC
 = 
NULL
;

74 
dex
 = 0;

75 
size_t
 
i
 = 0;

77 
pVMAC
 = 
	`Keyli_Da
(
VMAC_Li
, 
devi_id
);

78 i(!
pVMAC
) {

79 
pVMAC
 = 
	`oc
(1, (
vmac_da
));

80 i(
pVMAC
) {

82 
i
 = 0; i < (
pVMAC
->
mac
); i++) {

83 i(
i
 < 
c
->
mac_n
) {

84 
pVMAC
->
mac
[
i
] = 
c
->mac[i];

89 
pVMAC
->
mac_n
 = 
c
->mac_len;

90 
dex
 = 
	`Keyli_Da_Add
(
VMAC_Li
, 
devi_id
, 
pVMAC
);

91 i(
dex
 >= 0) {

92 
us
 = 
ue
;

93 
	`tf
("VMAC %udded.\n", ()
devi_id
);

98  
us
;

99 
	}
}

108 
bo
 
	$VMAC_De
(
ut32_t
 
devi_id
)

110 
bo
 
us
 = 
l
;

111 
vmac_da
 *
pVMAC
;

113 
pVMAC
 = 
	`Keyli_Da_De
(
VMAC_Li
, 
devi_id
);

114 i(
pVMAC
) {

115 
	`
(
pVMAC
);

116 
us
 = 
ue
;

119  
us
;

120 
	}
}

129 
vmac_da
 *
	$VMAC_Fd_By_Key
(
ut32_t
 
devi_id
)

131  
	`Keyli_Da
(
VMAC_Li
, 
devi_id
);

132 
	}
}

141 
bo
 
	$VMAC_Dif
(

142 
vmac_da
 *
vmac1
,

143 
vmac_da
 *
vmac2
)

145 
bo
 
us
 = 
l
;

146 
i
 = 0;

147 
mac_n
 = 
VMAC_MAC_MAX
;

149 i(
vmac1
 && 
vmac2
) {

150 i(
vmac1
->
mac_n
 !
vmac2
->mac_len) {

151 
us
 = 
ue
;

153 i(
vmac1
->
mac_n
 < mac_len) {

154 
mac_n
 = ()
vmac1
->mac_len;

156 
i
 = 0; i < 
mac_n
; i++) {

157 i(
vmac1
->
mac
[
i
] !
vmac2
->mac[i]) {

158 
us
 = 
ue
;

164  
us
;

165 
	}
}

174 
bo
 
	$VMAC_Mch
(

175 
vmac_da
 *
vmac1
,

176 
vmac_da
 *
vmac2
)

178 
bo
 
us
 = 
l
;

179 
i
 = 0;

180 
mac_n
 = 
VMAC_MAC_MAX
;

182 i(
vmac1
 && 
vmac2
 && vmac1->
mac_n
) {

183 
us
 = 
ue
;

184 i(
vmac1
->
mac_n
 !
vmac2
->mac_len) {

185 
us
 = 
l
;

187 i(
vmac1
->
mac_n
 < mac_len) {

188 
mac_n
 = ()
vmac1
->mac_len;

190 
i
 = 0; i < 
mac_n
; i++) {

191 i(
vmac1
->
mac
[
i
] !
vmac2
->mac[i]) {

192 
us
 = 
l
;

198  
us
;

199 
	}
}

209 
bo
 
	$VMAC_Fd_By_Da
(
vmac_da
 *
vmac
, 
ut32_t
 *
devi_id
)

211 
bo
 
us
 = 
l
;

212 
vmac_da
 *
li_vmac
;

213 
cou
 = 0;

214 
dex
 = 0;

216 
cou
 = 
	`Keyli_Cou
(
VMAC_Li
);

217 
cou
) {

218 
dex
 = 
cou
 - 1;

219 
li_vmac
 = 
	`Keyli_Da_Index
(
VMAC_Li
, 
dex
);

220 i(
li_vmac
) {

221 i(
	`VMAC_Mch
(
vmac
, 
li_vmac
)) {

222 i(
devi_id
) {

223 *
devi_id
 = 
	`Keyli_Key
(
VMAC_Li
, 
dex
);

225 
us
 = 
ue
;

229 
cou
--;

232  
us
;

233 
	}
}

238 
	$VMAC_C˪up
()

240 
vmac_da
 *
pVMAC
;

242 i(
VMAC_Li
) {

244 
pVMAC
 = 
	`Keyli_Da_P
(
VMAC_Li
);

245 i(
pVMAC
) {

246 
	`
(
pVMAC
);

248 } 
pVMAC
);

249 
	`Keyli_De
(
VMAC_Li
);

250 
VMAC_Li
 = 
NULL
;

252 
	}
}

257 
	$VMAC_In
()

259 
VMAC_Li
 = 
	`Keyli_Ce
();

260 i(
VMAC_Li
) {

261 
	`ex
(
VMAC_C˪up
);

262 
	`tf
("VMAC List initialized.\n");

264 
	}
}

266 #ifde
TEST


267 
	~<as.h
>

268 
	~<rg.h
>

269 
	~"e.h
"

271 
	$VMAC
(

272 
Te
 * 
pTe
)

274 
ut32_t
 
devi_id
 = 123;

275 
ut32_t
 
_devi_id
 = 0;

276 
vmac_da
 
_vmac_da
;

277 
vmac_da
 *
pVMAC
;

278 
i
 = 0;

279 
bo
 
us
 = 
l
;

281 
	`VMAC_In
();

282 
i
 = 0; i < 
VMAC_MAC_MAX
; i++) {

283 
_vmac_da
.
mac
[
i
] = 1 + i;

285 
_vmac_da
.
mac_n
 = 
VMAC_MAC_MAX
;

286 
us
 = 
	`VMAC_Add
(
devi_id
, &
_vmac_da
);

287 
	`_
(
pTe
, 
us
);

288 
pVMAC
 = 
	`VMAC_Fd_By_Key
(0);

289 
	`_
(
pTe
, 
pVMAC
 =
NULL
);

290 
pVMAC
 = 
	`VMAC_Fd_By_Key
(
devi_id
);

291 
	`_
(
pTe
, 
pVMAC
);

292 
us
 = 
	`VMAC_Dif
(
pVMAC
, &
_vmac_da
);

293 
	`_
(
pTe
, !
us
);

294 
us
 = 
	`VMAC_Mch
(
pVMAC
, &
_vmac_da
);

295 
	`_
(
pTe
, 
us
);

296 
us
 = 
	`VMAC_Fd_By_Da
(&
_vmac_da
, &
_devi_id
);

297 
	`_
(
pTe
, 
us
);

298 
	`_
(
pTe
, 
_devi_id
 =
devi_id
);

299 
us
 = 
	`VMAC_De
(
devi_id
);

300 
	`_
(
pTe
, 
us
);

301 
pVMAC
 = 
	`VMAC_Fd_By_Key
(
devi_id
);

302 
	`_
(
pTe
, 
pVMAC
 =
NULL
);

303 
	`VMAC_C˪up
();

304 
	}
}

306 #ifde
TEST_VMAC


307 
	$ma
(

310 
Te
 *
pTe
;

311 
bo
 
rc
;

313 
pTe
 = 
	`_
("BACÈVMAC", 
NULL
);

315 
rc
 = 
	`_addTeFuni
(
pTe
, 
VMAC
);

316 
	`as
(
rc
);

318 
	`_tSm
(
pTe
, 
dout
);

319 
	`_run
(
pTe
);

320 (
	`_pt
(
pTe
);

321 
	`_deroy
(
pTe
);

324 
	}
}

	@src/whohas.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"whohas.h
"

44 
	$whohas_code_du
(

45 
ut8_t
 * 
du
,

46 
BACNET_WHO_HAS_DATA
 * 
da
)

48 
n
 = 0;

49 
du_n
 = 0;

51 i(
du
 && 
da
) {

52 
du
[0] = 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
;

53 
du
[1] = 
SERVICE_UNCONFIRMED_WHO_HAS
;

54 
du_n
 = 2;

56 i((
da
->
low_lim
 >= 0)

57 && (
da
->
low_lim
 <
BACNET_MAX_INSTANCE
)

58 && (
da
->
high_lim
 >= 0)

59 && (
da
->
high_lim
 <
BACNET_MAX_INSTANCE
)) {

60 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0, 
da
->
low_lim
);

61 
du_n
 +
n
;

62 
n
 =

63 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1, 
da
->
high_lim
);

64 
du_n
 +
n
;

66 i(
da
->
is_obje_me
) {

67 
n
 =

68 
	`code_cڋxt_cha_rg
(&
du
[
du_n
], 3,

69 &
da
->
obje
.
me
);

70 
du_n
 +
n
;

72 
n
 =

73 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 2,

74 (
da
->
obje
.
idtifr
.
ty
,

75 
da
->
obje
.
idtifr
.

);

76 
du_n
 +
n
;

80  
du_n
;

81 
	}
}

84 
	$whohas_decode_rvi_que
(

85 
ut8_t
 * 
du
,

86 
du_n
,

87 
BACNET_WHO_HAS_DATA
 * 
da
)

89 
n
 = 0;

90 
ut8_t
 
g_numb
 = 0;

91 
ut32_t
 
n_vue
 = 0;

92 
ut32_t
 
decoded_vue
 = 0;

93 
ut16_t
 
decoded_ty
 = 0;

95 i(
du_n
 && 
da
) {

97 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 0)) {

98 
n
 +=

99 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

100 &
n_vue
);

101 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

102 i(
decoded_vue
 <
BACNET_MAX_INSTANCE
)

103 
da
->
low_lim
 = 
decoded_vue
;

104 i(!
	`decode_is_cڋxt_g
(&
du
[
n
], 1))

106 
n
 +=

107 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

108 &
n_vue
);

109 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

110 i(
decoded_vue
 <
BACNET_MAX_INSTANCE
)

111 
da
->
high_lim
 = 
decoded_vue
;

113 
da
->
low_lim
 = -1;

114 
da
->
high_lim
 = -1;

117 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 2)) {

118 
da
->
is_obje_me
 = 
l
;

119 
n
 +=

120 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

121 &
n_vue
);

122 
n
 +=

123 
	`decode_obje_id
(&
du
[
n
], &
decoded_ty
,

124 &
da
->
obje
.
idtifr
.

);

125 
da
->
obje
.
idtifr
.
ty
 = 
decoded_ty
;

128 i(
	`decode_is_cڋxt_g
(&
du
[
n
], 3)) {

129 
da
->
is_obje_me
 = 
ue
;

130 
n
 +=

131 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

132 &
n_vue
);

133 
n
 +=

134 
	`decode_cha_rg
(&
du
[
n
], 
n_vue
,

135 &
da
->
obje
.
me
);

142  
n
;

143 
	}
}

145 #ifde
TEST


146 
	~<as.h
>

147 
	~<rg.h
>

148 
	~"e.h
"

150 
	$whohas_decode_du
(

151 
ut8_t
 * 
du
,

152 
du_n
,

153 
BACNET_WHO_HAS_DATA
 * 
da
)

155 
n
 = 0;

157 i(!
du
)

160 i(
du
[0] !
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
)

162 i(
du
[1] !
SERVICE_UNCONFIRMED_WHO_HAS
)

165 i(
du_n
 > 2) {

166 
n
 = 
	`whohas_decode_rvi_que
(&
du
[2], 
du_n
 - 2, 
da
);

169  
n
;

170 
	}
}

172 
	$WhoHasDa
(

173 
Te
 * 
pTe
,

174 
BACNET_WHO_HAS_DATA
 * 
da
)

176 
ut8_t
 
du
[480] = { 0 };

177 
n
 = 0;

178 
du_n
 = 0;

179 
BACNET_WHO_HAS_DATA
 
_da
;

181 
n
 = 
	`whohas_code_du
(&
du
[0], 
da
);

182 
	`_
(
pTe
, 
n
 != 0);

183 
du_n
 = 
n
;

185 
n
 = 
	`whohas_decode_du
(&
du
[0], 
du_n
, &
_da
);

186 
	`_
(
pTe
, 
n
 != -1);

187 
	`_
(
pTe
, 
_da
.
low_lim
 =
da
->low_limit);

188 
	`_
(
pTe
, 
_da
.
high_lim
 =
da
->high_limit);

189 
	`_
(
pTe
, 
_da
.
is_obje_me
 =
da
->is_object_name);

191 i(
da
->
is_obje_me
 =
l
) {

192 
	`_
(
pTe
,

193 
_da
.
obje
.
idtifr
.
ty
 =
da
->object.identifier.type);

194 
	`_
(
pTe
,

195 
_da
.
obje
.
idtifr
.

 ==

196 
da
->
obje
.
idtifr
.

);

200 
	`_
(
pTe
, 
	`charg_me
(&
_da
.
obje
.
me
,

201 &
da
->
obje
.
me
));

203 
	}
}

205 
	$WhoHas
(

206 
Te
 * 
pTe
)

208 
BACNET_WHO_HAS_DATA
 
da
;

210 
da
.
low_lim
 = -1;

211 
da
.
high_lim
 = -1;

212 
da
.
is_obje_me
 = 
l
;

213 
da
.
obje
.
idtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

214 
da
.
obje
.
idtifr
.

 = 1;

215 
	`WhoHasDa
(
pTe
, &
da
);

217 
da
.
low_lim
 = 0; da.low_lim <
BACNET_MAX_INSTANCE
;

218 
da
.
low_lim
 +(
BACNET_MAX_INSTANCE
 / 4)) {

219 
da
.
high_lim
 = 0; da.high_lim <
BACNET_MAX_INSTANCE
;

220 
da
.
high_lim
 +(
BACNET_MAX_INSTANCE
 / 4)) {

221 
da
.
is_obje_me
 = 
l
;

222 
da
.
obje
.
idtifr
.
ty
 = 
OBJECT_ANALOG_INPUT
;

223 
da
.
obje
.
idtifr
.
ty
 < 
MAX_BACNET_OBJECT_TYPE
;

224 
da
.
obje
.
idtifr
.
ty
++) {

225 
da
.
obje
.
idtifr
.

 = 1;

226 
da
.
obje
.
idtifr
.

 <
BACNET_MAX_INSTANCE
;

227 
da
.
obje
.
idtifr
.

 <<= 1) {

228 
	`WhoHasDa
(
pTe
, &
da
);

231 
da
.
is_obje_me
 = 
ue
;

232 
	`charg__si
(&
da
.
obje
.
me
, "patricia");

233 
	`WhoHasDa
(
pTe
, &
da
);

236 
	}
}

238 #ifde
TEST_WHOHAS


239 
	$ma
(

242 
Te
 *
pTe
;

243 
bo
 
rc
;

245 
pTe
 = 
	`_
("BACÈWho-Has", 
NULL
);

247 
rc
 = 
	`_addTeFuni
(
pTe
, 
WhoHas
);

248 
	`as
(
rc
);

250 
	`_tSm
(
pTe
, 
dout
);

251 
	`_run
(
pTe
);

252 (
	`_pt
(
pTe
);

253 
	`_deroy
(
pTe
);

256 
	}
}

	@src/whois.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"whois.h
"

43 
	$whois_code_du
(

44 
ut8_t
 * 
du
,

45 
t32_t
 
low_lim
,

46 
t32_t
 
high_lim
)

48 
n
 = 0;

49 
du_n
 = 0;

51 i(
du
) {

52 
du
[0] = 
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
;

53 
du
[1] = 
SERVICE_UNCONFIRMED_WHO_IS
;

54 
du_n
 = 2;

56 i((
low_lim
 >0&& (low_lim <
BACNET_MAX_INSTANCE
) &&

57 (
high_lim
 >0&& (high_lim <
BACNET_MAX_INSTANCE
)) {

58 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 0, 
low_lim
);

59 
du_n
 +
n
;

60 
n
 = 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1, 
high_lim
);

61 
du_n
 +
n
;

65  
du_n
;

66 
	}
}

69 
	$whois_decode_rvi_que
(

70 
ut8_t
 * 
du
,

71 
du_n
,

72 
t32_t
 * 
pLow_lim
,

73 
t32_t
 * 
pHigh_lim
)

75 
n
 = 0;

76 
ut8_t
 
g_numb
 = 0;

77 
ut32_t
 
n_vue
 = 0;

78 
ut32_t
 
decoded_vue
 = 0;

81 i(
du_n
) {

82 
n
 +=

83 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

84 i(
g_numb
 != 0) {

85  
BACNET_STATUS_ERROR
;

87 i(
du_n
 > 
n
) {

88 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

89 i(
decoded_vue
 <
BACNET_MAX_INSTANCE
) {

90 i(
pLow_lim
) {

91 *
pLow_lim
 = 
decoded_vue
;

94 i(
du_n
 > 
n
) {

95 
n
 +=

96 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

97 i(
g_numb
 != 1) {

98  
BACNET_STATUS_ERROR
;

100 i(
du_n
 > 
n
) {

101 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
decoded_vue
);

102 i(
decoded_vue
 <
BACNET_MAX_INSTANCE
) {

103 i(
pHigh_lim
) {

104 *
pHigh_lim
 = 
decoded_vue
;

108  
BACNET_STATUS_ERROR
;

111  
BACNET_STATUS_ERROR
;

114  
BACNET_STATUS_ERROR
;

117 i(
pLow_lim
) {

118 *
pLow_lim
 = -1;

120 i(
pHigh_lim
) {

121 *
pHigh_lim
 = -1;

123 
n
 = 0;

126  ()
n
;

127 
	}
}

129 #ifde
TEST


130 
	~<as.h
>

131 
	~<rg.h
>

132 
	~"e.h
"

134 
	$whois_decode_du
(

135 
ut8_t
 * 
du
,

136 
du_n
,

137 
t32_t
 * 
pLow_lim
,

138 
t32_t
 * 
pHigh_lim
)

140 
n
 = 0;

142 i(!
du
) {

143  
BACNET_STATUS_ERROR
;

146 i(
du_n
 >= 2) {

148 i(
du
[0] !
PDU_TYPE_UNCONFIRMED_SERVICE_REQUEST
) {

149  
BACNET_STATUS_ERROR
;

151 i(
du
[1] !
SERVICE_UNCONFIRMED_WHO_IS
) {

152  
BACNET_STATUS_ERROR
;

154 
n
 =

155 
	`whois_decode_rvi_que
(&
du
[2], 
du_n
 - 2, 
pLow_lim
,

156 
pHigh_lim
);

159  
n
;

160 
	}
}

162 
	$WhoIs
(

163 
Te
 * 
pTe
)

165 
ut8_t
 
du
[480] = { 0 };

166 
n
 = 0;

167 
du_n
 = 0;

168 
t32_t
 
low_lim
 = -1;

169 
t32_t
 
high_lim
 = -1;

170 
t32_t
 
_low_lim
 = 0;

171 
t32_t
 
_high_lim
 = 0;

174 
n
 = 
	`whois_code_du
(&
du
[0], 
low_lim
, 
high_lim
);

175 
	`_
(
pTe
, 
n
 > 0);

176 
du_n
 = 
n
;

178 
n
 =

179 
	`whois_decode_du
(&
du
[0], 
du_n
, &
_low_lim
,

180 &
_high_lim
);

181 
	`_
(
pTe
, 
n
 !
BACNET_STATUS_ERROR
);

182 
	`_
(
pTe
, 
_low_lim
 =
low_lim
);

183 
	`_
(
pTe
, 
_high_lim
 =
high_lim
);

186 
low_lim
 = 0;ow_lim <
BACNET_MAX_INSTANCE
;

187 
low_lim
 +(
BACNET_MAX_INSTANCE
 / 4)) {

188 
high_lim
 = 0; high_lim <
BACNET_MAX_INSTANCE
;

189 
high_lim
 +(
BACNET_MAX_INSTANCE
 / 4)) {

190 
n
 = 
	`whois_code_du
(&
du
[0], 
low_lim
, 
high_lim
);

191 
du_n
 = 
n
;

192 
	`_
(
pTe
, 
n
 > 0);

193 
n
 =

194 
	`whois_decode_du
(&
du
[0], 
du_n
, &
_low_lim
,

195 &
_high_lim
);

196 
	`_
(
pTe
, 
n
 !
BACNET_STATUS_ERROR
);

197 
	`_
(
pTe
, 
_low_lim
 =
low_lim
);

198 
	`_
(
pTe
, 
_high_lim
 =
high_lim
);

203 
low_lim
 = 0;

204 
high_lim
 = 0;

205 
n
 = 
	`whois_code_du
(&
du
[0], 
low_lim
, 
high_lim
);

206 
	`_
(
pTe
, 
n
 > 0);

207 
du_n
 = 
n
;

208 
low_lim
 = -1;

209 
high_lim
 = -1;

210 
n
 = 
	`whois_code_du
(&
du
[0], 
low_lim
, 
high_lim
);

211 
	`_
(
pTe
, 
n
 > 0);

212 
du_n
 = 
n
;

213 
n
 =

214 
	`whois_decode_du
(&
du
[0], 
du_n
, &
_low_lim
,

215 &
_high_lim
);

216 
	`_
(
pTe
, 
n
 !
BACNET_STATUS_ERROR
);

217 
	`_
(
pTe
, 
_low_lim
 =
low_lim
);

218 
	`_
(
pTe
, 
_high_lim
 =
high_lim
);

219 
	}
}

221 #ifde
TEST_WHOIS


222 
	$ma
(

225 
Te
 *
pTe
;

226 
bo
 
rc
;

228 
pTe
 = 
	`_
("BACÈWho-Is", 
NULL
);

230 
rc
 = 
	`_addTeFuni
(
pTe
, 
WhoIs
);

231 
	`as
(
rc
);

233 
	`_tSm
(
pTe
, 
dout
);

234 
	`_run
(
pTe
);

235 (
	`_pt
(
pTe
);

236 
	`_deroy
(
pTe
);

239 
	}
}

	@src/wp.c

34 
	~<dt.h
>

35 
	~"banum.h
"

36 
	~"bacdcode.h
"

37 
	~"bacdef.h
"

38 
	~"wp.h
"

41 #i
BACNET_SVC_WP_A


43 
	$wp_code_du
(

44 
ut8_t
 * 
du
,

45 
ut8_t
 
voke_id
,

46 
BACNET_WRITE_PROPERTY_DATA
 * 
wpda
)

48 
du_n
 = 0;

49 
n
 = 0;

51 i(
du
) {

52 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

53 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

54 
du
[2] = 
voke_id
;

55 
du
[3] = 
SERVICE_CONFIRMED_WRITE_PROPERTY
;

56 
du_n
 = 4;

57 
n
 =

58 
	`code_cڋxt_obje_id
(&
du
[
du_n
], 0, 
wpda
->
obje_ty
,

59 
wpda
->
obje_
);

60 
du_n
 +
n
;

61 
n
 =

62 
	`code_cڋxt_umed
(&
du
[
du_n
], 1,

63 
wpda
->
obje_ݔty
);

64 
du_n
 +
n
;

66 i(
wpda
->
y_dex
 !
BACNET_ARRAY_ALL
) {

67 
n
 =

68 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 2,

69 
wpda
->
y_dex
);

70 
du_n
 +
n
;

73 
n
 = 
	`code_ݒg_g
(&
du
[
du_n
], 3);

74 
du_n
 +
n
;

75 
n
 = 0; < 
wpda
->
iti_da_n
;en++) {

76 
du
[
du_n
 + 
n
] = 
wpda
->
iti_da
[len];

78 
du_n
 +
wpda
->
iti_da_n
;

79 
n
 = 
	`code_osg_g
(&
du
[
du_n
], 3);

80 
du_n
 +
n
;

82 i(
wpda
->
iܙy
 !
BACNET_NO_PRIORITY
) {

83 
n
 =

84 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 4, 
wpda
->
iܙy
);

85 
du_n
 +
n
;

89  
du_n
;

90 
	}
}

96 
	$wp_decode_rvi_que
(

97 
ut8_t
 * 
du
,

98 
du_n
,

99 
BACNET_WRITE_PROPERTY_DATA
 * 
wpda
)

101 
n
 = 0;

102 
g_n
 = 0;

103 
ut8_t
 
g_numb
 = 0;

104 
ut32_t
 
n_vue_ty
 = 0;

105 
ut16_t
 
ty
 = 0;

106 
ut32_t
 
ݔty
 = 0;

107 
ut32_t
 
unsigd_vue
 = 0;

108 
i
 = 0;

111 i(
du_n
 && 
wpda
) {

113 i(!
	`decode_is_cڋxt_g
(&
du
[
n
++], 0))

115 
n
 +
	`decode_obje_id
(&
du
[n], &
ty
, &
wpda
->
obje_
);

116 
wpda
->
obje_ty
 = (
BACNET_OBJECT_TYPE

ty
;

118 
n
 +=

119 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

120 &
n_vue_ty
);

121 i(
g_numb
 != 1)

123 
n
 +
	`decode_umed
(&
du
[n], 
n_vue_ty
, &
ݔty
);

124 
wpda
->
obje_ݔty
 = (
BACNET_PROPERTY_ID

ݔty
;

127 
g_n
 =

128 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

129 &
n_vue_ty
);

130 i(
g_numb
 == 2) {

131 
n
 +
g_n
;

132 
n
 +=

133 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
, &
unsigd_vue
);

134 
wpda
->
y_dex
 = 
unsigd_vue
;

136 
wpda
->
y_dex
 = 
BACNET_ARRAY_ALL
;

138 i(!
	`decode_is_ݒg_g_numb
(&
du
[
n
], 3))

141 
wpda
->
iti_da_n
 =

142 
	`ba_da_n
(&
du
[
n
], 
du_n
 -en,

143 (
BACNET_PROPERTY_ID

ݔty
);

145 
n
++;

147 
i
 = 0; i < 
wpda
->
iti_da_n
; i++) {

148 
wpda
->
iti_da
[
i
] = 
du
[
n
 + i];

151 
n
 +
wpda
->
iti_da_n
;

152 i(!
	`decode_is_osg_g_numb
(&
du
[
n
], 3))

155 
n
++;

157 
wpda
->
iܙy
 = 
BACNET_MAX_PRIORITY
;

158 i((
n
 < 
du_n
) {

159 
g_n
 =

160 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

161 &
n_vue_ty
);

162 i(
g_numb
 == 4) {

163 
n
 +
g_n
;

164 
n
 =

165 
	`decode_unsigd
(&
du
[
n
], 
n_vue_ty
,

166 &
unsigd_vue
);

167 i((
unsigd_vue
 >
BACNET_MIN_PRIORITY
)

168 && (
unsigd_vue
 <
BACNET_MAX_PRIORITY
)) {

169 
wpda
->
iܙy
 = (
ut8_t

unsigd_vue
;

176  
n
;

177 
	}
}

179 #ifde
TEST


180 
	~<as.h
>

181 
	~<rg.h
>

182 
	~"e.h
"

184 
	$wp_decode_du
(

185 
ut8_t
 * 
du
,

186 
du_n
,

187 
ut8_t
 * 
voke_id
,

188 
BACNET_WRITE_PROPERTY_DATA
 * 
wpda
)

190 
n
 = 0;

191 
offt
 = 0;

193 i(!
du
)

196 i(
du
[0] !
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
)

199 *
voke_id
 = 
du
[2];

200 i(
du
[3] !
SERVICE_CONFIRMED_WRITE_PROPERTY
)

202 
offt
 = 4;

204 i(
du_n
 > 
offt
) {

205 
n
 =

206 
	`wp_decode_rvi_que
(&
du
[
offt
], 
du_n
 - offset,

207 
wpda
);

210  
n
;

211 
	}
}

213 
	$WrePrݔtyTag
(

214 
Te
 * 
pTe
,

215 
BACNET_APPLICATION_DATA_VALUE
 * 
vue
)

217 
BACNET_WRITE_PROPERTY_DATA
 
wpda
 = { 0 };

218 
BACNET_WRITE_PROPERTY_DATA
 
_da
 = { 0 };

219 
BACNET_APPLICATION_DATA_VALUE
 
_vue
;

220 
ut8_t
 
du
[480] = { 0 };

221 
n
 = 0;

222 
du_n
 = 0;

223 
ut8_t
 
voke_id
 = 128;

224 
ut8_t
 
_voke_id
 = 0;

226 
wpda
.
iti_da_n
 =

227 
	`ba_code_iti_da
(&
wpda
.
iti_da
[0], 
vue
);

228 
n
 = 
	`wp_code_du
(&
du
[0], 
voke_id
, &
wpda
);

229 
	`_
(
pTe
, 
n
 != 0);

231 
du_n
 = 
n
;

232 
n
 = 
	`wp_decode_du
(&
du
[0], 
du_n
, &
_voke_id
, &
_da
);

233 
	`_
(
pTe
, 
n
 != -1);

234 
	`_
(
pTe
, 
_da
.
obje_ty
 =
wpda
.object_type);

235 
	`_
(
pTe
, 
_da
.
obje_
 =
wpda
.object_instance);

236 
	`_
(
pTe
, 
_da
.
obje_ݔty
 =
wpda
.object_property);

237 
	`_
(
pTe
, 
_da
.
y_dex
 =
wpda
.array_index);

239 
n
 =

240 
	`ba_decode_iti_da
(
_da
.
iti_da
,

241 
_da
.
iti_da_n
, &
_vue
);

242 
	`_
(
pTe
, 
_vue
.
g
 =
vue
->tag);

243 
_vue
.
g
) {

244 
BACNET_APPLICATION_TAG_NULL
:

246 
BACNET_APPLICATION_TAG_BOOLEAN
:

247 
	`_
(
pTe
, 
_vue
.
ty
.
Boޗn
 =
vue
->type.Boolean);

249 
BACNET_APPLICATION_TAG_UNSIGNED_INT
:

250 
	`_
(
pTe
,

251 
_vue
.
ty
.
Unsigd_I
 =
vue
->type.Unsigned_Int);

253 
BACNET_APPLICATION_TAG_SIGNED_INT
:

254 
	`_
(
pTe
,

255 
_vue
.
ty
.
Sigd_I
 =
vue
->type.Signed_Int);

257 
BACNET_APPLICATION_TAG_REAL
:

258 
	`_
(
pTe
, 
_vue
.
ty
.
Rl
 =
vue
->type.Real);

260 
BACNET_APPLICATION_TAG_ENUMERATED
:

261 
	`_
(
pTe
,

262 
_vue
.
ty
.
Enumed
 =
vue
->type.Enumerated);

264 
BACNET_APPLICATION_TAG_DATE
:

265 
	`_
(
pTe
, 
_vue
.
ty
.
De
.
yr
 =
vue
->type.Date.year);

266 
	`_
(
pTe
,

267 
_vue
.
ty
.
De
.
mth
 =
vue
->type.Date.month);

268 
	`_
(
pTe
, 
_vue
.
ty
.
De
.
day
 =
vue
->type.Date.day);

269 
	`_
(
pTe
, 
_vue
.
ty
.
De
.
wday
 =
vue
->type.Date.wday);

271 
BACNET_APPLICATION_TAG_TIME
:

272 
	`_
(
pTe
, 
_vue
.
ty
.
Time
.
hour
 =
vue
->type.Time.hour);

273 
	`_
(
pTe
, 
_vue
.
ty
.
Time
.
m
 =
vue
->type.Time.min);

274 
	`_
(
pTe
, 
_vue
.
ty
.
Time
.
c
 =
vue
->type.Time.sec);

275 
	`_
(
pTe
,

276 
_vue
.
ty
.
Time
.
hunddths
 ==

277 
vue
->
ty
.
Time
.
hunddths
);

279 
BACNET_APPLICATION_TAG_OBJECT_ID
:

280 
	`_
(
pTe
,

281 
_vue
.
ty
.
Obje_Id
.ty =
vue
->type.Object_Id.type);

282 
	`_
(
pTe
,

283 
_vue
.
ty
.
Obje_Id
.

 ==

284 
vue
->
ty
.
Obje_Id
.

);

289 
	}
}

291 
	$WrePrݔty
(

292 
Te
 * 
pTe
)

294 
BACNET_APPLICATION_DATA_VALUE
 
vue
;

296 
vue
.
g
 = 
BACNET_APPLICATION_TAG_NULL
;

297 
	`WrePrݔtyTag
(
pTe
, &
vue
);

299 
vue
.
g
 = 
BACNET_APPLICATION_TAG_BOOLEAN
;

300 
vue
.
ty
.
Boޗn
 = 
ue
;

301 
	`WrePrݔtyTag
(
pTe
, &
vue
);

302 
vue
.
ty
.
Boޗn
 = 
l
;

303 
	`WrePrݔtyTag
(
pTe
, &
vue
);

305 
vue
.
g
 = 
BACNET_APPLICATION_TAG_UNSIGNED_INT
;

306 
vue
.
ty
.
Unsigd_I
 = 0;

307 
	`WrePrݔtyTag
(
pTe
, &
vue
);

308 
vue
.
ty
.
Unsigd_I
 = 0xFFFF;

309 
	`WrePrݔtyTag
(
pTe
, &
vue
);

310 
vue
.
ty
.
Unsigd_I
 = 0xFFFFFFFF;

311 
	`WrePrݔtyTag
(
pTe
, &
vue
);

313 
vue
.
g
 = 
BACNET_APPLICATION_TAG_SIGNED_INT
;

314 
vue
.
ty
.
Sigd_I
 = 0;

315 
	`WrePrݔtyTag
(
pTe
, &
vue
);

316 
vue
.
ty
.
Sigd_I
 = -1;

317 
	`WrePrݔtyTag
(
pTe
, &
vue
);

318 
vue
.
ty
.
Sigd_I
 = 32768;

319 
	`WrePrݔtyTag
(
pTe
, &
vue
);

320 
vue
.
ty
.
Sigd_I
 = -32768;

321 
	`WrePrݔtyTag
(
pTe
, &
vue
);

323 
vue
.
g
 = 
BACNET_APPLICATION_TAG_REAL
;

324 
vue
.
ty
.
Rl
 = 0.0;

325 
	`WrePrݔtyTag
(
pTe
, &
vue
);

326 
vue
.
ty
.
Rl
 = -1.0;

327 
	`WrePrݔtyTag
(
pTe
, &
vue
);

328 
vue
.
ty
.
Rl
 = 1.0;

329 
	`WrePrݔtyTag
(
pTe
, &
vue
);

330 
vue
.
ty
.
Rl
 = 3.14159;

331 
	`WrePrݔtyTag
(
pTe
, &
vue
);

332 
vue
.
ty
.
Rl
 = -3.14159;

333 
	`WrePrݔtyTag
(
pTe
, &
vue
);

335 
vue
.
g
 = 
BACNET_APPLICATION_TAG_ENUMERATED
;

336 
vue
.
ty
.
Enumed
 = 0;

337 
	`WrePrݔtyTag
(
pTe
, &
vue
);

338 
vue
.
ty
.
Enumed
 = 0xFFFF;

339 
	`WrePrݔtyTag
(
pTe
, &
vue
);

340 
vue
.
ty
.
Enumed
 = 0xFFFFFFFF;

341 
	`WrePrݔtyTag
(
pTe
, &
vue
);

343 
vue
.
g
 = 
BACNET_APPLICATION_TAG_DATE
;

344 
vue
.
ty
.
De
.
yr
 = 2005;

345 
vue
.
ty
.
De
.
mth
 = 5;

346 
vue
.
ty
.
De
.
day
 = 22;

347 
vue
.
ty
.
De
.
wday
 = 1;

348 
	`WrePrݔtyTag
(
pTe
, &
vue
);

350 
vue
.
g
 = 
BACNET_APPLICATION_TAG_TIME
;

351 
vue
.
ty
.
Time
.
hour
 = 23;

352 
vue
.
ty
.
Time
.
m
 = 59;

353 
vue
.
ty
.
Time
.
c
 = 59;

354 
vue
.
ty
.
Time
.
hunddths
 = 12;

355 
	`WrePrݔtyTag
(
pTe
, &
vue
);

357 
vue
.
g
 = 
BACNET_APPLICATION_TAG_OBJECT_ID
;

358 
vue
.
ty
.
Obje_Id
.ty = 
OBJECT_ANALOG_INPUT
;

359 
vue
.
ty
.
Obje_Id
.

 = 0;

360 
	`WrePrݔtyTag
(
pTe
, &
vue
);

361 
vue
.
ty
.
Obje_Id
.ty = 
OBJECT_LIFE_SAFETY_ZONE
;

362 
vue
.
ty
.
Obje_Id
.

 = 
BACNET_MAX_INSTANCE
;

363 
	`WrePrݔtyTag
(
pTe
, &
vue
);

366 
	}
}

368 #ifde
TEST_WRITE_PROPERTY


369 
	$ma
(

372 
Te
 *
pTe
;

373 
bo
 
rc
;

375 
pTe
 = 
	`_
("BACÈWrePrݔty", 
NULL
);

377 
rc
 = 
	`_addTeFuni
(
pTe
, 
WrePrݔty
);

378 
	`as
(
rc
);

380 
	`_tSm
(
pTe
, 
dout
);

381 
	`_run
(
pTe
);

382 (
	`_pt
(
pTe
);

383 
	`_deroy
(
pTe
);

386 
	}
}

	@src/wpm.c

26 
	~<dt.h
>

27 
	~"ba.h
"

28 
	~"banum.h
"

29 
	~"bacdcode.h
"

30 
	~"bacdef.h
"

31 
	~"wp.h
"

32 
	~"wpm.h
"

33 
	~"rg.h
"

52 
	$wpm_decode_obje_id
(

53 
ut8_t
 * 
du
,

54 
ut16_t
 
du_n
,

55 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

57 
ut8_t
 
g_numb
 = 0;

58 
ut32_t
 
n_vue
 = 0;

59 
ut32_t
 
obje_
 = 0;

60 
ut16_t
 
obje_ty
 = 0;

61 
ut16_t
 
n
 = 0;

63 i(
du
 && (
du_n
 > 5&& 
wp_da
) {

65 
n
 +=

66 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

67 i((
g_numb
 =0&& (
du_n
 > 
n
)) {

68 
du_n
 -
n
;

69 i(
du_n
 >= 4) {

70 
n
 +=

71 
	`decode_obje_id
(&
du
[
n
], &
obje_ty
,

72 &
obje_
);

73 
wp_da
->
obje_ty
 = object_type;

74 
wp_da
->
obje_
 = object_instance;

75 
du_n
 -
n
;

77 
wp_da
->
r_code
 =

78 
ERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
;

79  
BACNET_STATUS_REJECT
;

82 
wp_da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

83  
BACNET_STATUS_REJECT
;

87 i(
du_n
 && !
	`decode_is_ݒg_g_numb
(&
du
[
n
], 1)) {

88 
wp_da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

89  
BACNET_STATUS_REJECT
;

92 
wp_da
->
r_code
 = 
ERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
;

93  
BACNET_STATUS_REJECT
;

96  (
n
;

97 
	}
}

100 
	$wpm_decode_obje_ݔty
(

101 
ut8_t
 * 
du
,

102 
ut16_t
 
du_n
,

103 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

105 
ut8_t
 
g_numb
 = 0;

106 
ut32_t
 
n_vue
 = 0;

107 
ut32_t
 
ulV
 = 0;

108 
n
 = 0, 
i
 = 0;

111 i((
du
&& (
du_n
&& (
wp_da
)) {

112 
wp_da
->
y_dex
 = 
BACNET_ARRAY_ALL
;

113 
wp_da
->
iܙy
 = 
BACNET_MAX_PRIORITY
;

114 
wp_da
->
iti_da_n
 = 0;

116 
n
 +=

117 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

118 i(
g_numb
 == 0) {

119 
n
 +
	`decode_umed
(&
du
[n], 
n_vue
, &
ulV
);

120 
wp_da
->
obje_ݔty
 = 
ulV
;

122 
wp_da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

123  
BACNET_STATUS_REJECT
;

127 
n
 +=

128 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

129 i(
g_numb
 == 1) {

130 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
ulV
);

131 
wp_da
->
y_dex
 = 
ulV
;

133 
n
 +=

134 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

135 &
n_vue
);

138 i((
g_numb
 =2&& (
	`decode_is_ݒg_g
(&
du
[
n
 - 1]))) {

139 
n
--;

140 
wp_da
->
iti_da_n
 =

141 
	`ba_da_n
(&
du
[
n
], ((
du_n
 -en),

142 
wp_da
->
obje_ݔty
);

143 
n
++;

146 
i
 = 0; i < 
wp_da
->
iti_da_n
; i++) {

147 
wp_da
->
iti_da
[
i
] = 
du
[
n
 + i];

149 
n
 +
wp_da
->
iti_da_n
;

150 
n
 +=

151 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
,

152 &
n_vue
);

154 i((
g_numb
 !2&& (
	`decode_is_osg_g
(&
du
[
n
 - 1]))) {

155 
wp_da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

156  
BACNET_STATUS_REJECT
;

159 
wp_da
->
r_code
 = 
ERROR_CODE_REJECT_INVALID_TAG
;

160  
BACNET_STATUS_REJECT
;

164 
n
 +=

165 
	`decode_g_numb_d_vue
(&
du
[
n
], &
g_numb
, &
n_vue
);

166 i(
g_numb
 == 3) {

167 
n
 +
	`decode_unsigd
(&
du
[n], 
n_vue
, &
ulV
);

168 
wp_da
->
iܙy
 = 
ulV
;

170 
n
--;

172 
wp_da
->
r_code
 = 
ERROR_CODE_REJECT_MISSING_REQUIRED_PARAMETER
;

173  
BACNET_STATUS_REJECT
;

176  
n
;

177 
	}
}

180 
	$wpm_code_du_
(

181 
ut8_t
 * 
du
,

182 
ut8_t
 
voke_id
)

184 
du_n
 = 0;

186 i(
du
) {

187 
du
[0] = 
PDU_TYPE_CONFIRMED_SERVICE_REQUEST
;

188 
du
[1] = 
	`code_max_gs_max_du
(0, 
MAX_APDU
);

189 
du
[2] = 
voke_id
;

190 
du
[3] = 
SERVICE_CONFIRMED_WRITE_PROP_MULTIPLE
;

191 
du_n
 = 4;

194  
du_n
;

196 
	}
}

198 
	$wpm_code_du_obje_beg
(

199 
ut8_t
 * 
du
,

200 
BACNET_OBJECT_TYPE
 
obje_ty
,

201 
ut32_t
 
obje_
)

203 
du_n
 = 0;

205 i(
du
) {

206 
du_n
 =

207 
	`code_cڋxt_obje_id
(&
du
[0], 0, 
obje_ty
,

208 
obje_
);

210 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 1);

213  
du_n
;

214 
	}
}

216 
	$wpm_code_du_obje_d
(

217 
ut8_t
 * 
du
)

219 
du_n
 = 0;

221 i(
du
) {

222 
du_n
 = 
	`code_osg_g
(&
du
[0], 1);

225  
du_n
;

226 
	}
}

228 
	$wpm_code_du_obje_ݔty
(

229 
ut8_t
 * 
du
,

230 
BACNET_WRITE_PROPERTY_DATA
 * 
wpda
)

232 
du_n
 = 0;

233 
n
 = 0;

235 i(
du
) {

236 
du_n
 =

237 
	`code_cڋxt_umed
(&
du
[0], 0, 
wpda
->
obje_ݔty
);

239 i(
wpda
->
y_dex
 !
BACNET_ARRAY_ALL
) {

240 
du_n
 +=

241 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 1,

242 
wpda
->
y_dex
);

244 
du_n
 +
	`code_ݒg_g
(&
du
[apdu_len], 2);

245 
n
 = 0; < 
wpda
->
iti_da_n
;en++) {

246 
du
[
du_n
] = 
wpda
->
iti_da
[
n
];

247 
du_n
++;

249 
du_n
 +
	`code_osg_g
(&
du
[apdu_len], 2);

250 i(
wpda
->
iܙy
 !
BACNET_NO_PRIORITY
) {

251 
du_n
 +=

252 
	`code_cڋxt_unsigd
(&
du
[
du_n
], 3, 
wpda
->
iܙy
);

256  
du_n
;

257 
	}
}

259 
	$wpm_code_du
(

260 
ut8_t
 * 
du
,

261 
size_t
 
max_du
,

262 
ut8_t
 
voke_id
,

263 
BACNET_WRITE_ACCESS_DATA
 * 
wre_acss_da
)

265 
du_n
 = 0;

266 
n
 = 0;

267 
BACNET_WRITE_ACCESS_DATA
 *
wpm_obje
;

268 
ut8_t
 
du_mp
[
MAX_APDU
];

269 
BACNET_PROPERTY_VALUE
 *
wpm_ݔty
;

270 
BACNET_WRITE_PROPERTY_DATA
 
wpda
;

272 i(
du
) {

273 
n
 = 
	`wpm_code_du_
(&
du
[0], 
voke_id
);

274 
du_n
 +
n
;

276 
wpm_obje
 = 
wre_acss_da
;

278 
wpm_obje
){

280 
n
 = 
	`wpm_code_du_obje_beg
(&
du
[
du_n
],

281 
wpm_obje
->
obje_ty
, wpm_obje->
obje_
);

282 
du_n
 +
n
;

284 
wpm_ݔty
 = 
wpm_obje
->
liOfPrݔts
;

286 
wpm_ݔty
){

287 
wpda
.
obje_ݔty
 = 
wpm_ݔty
->
ݔtyIdtifr
;

288 
wpda
.
y_dex
 = 
wpm_ݔty
->
ݔtyAayIndex
;

289 
wpda
.
iܙy
 = 
wpm_ݔty
->priority;

291 
wpda
.
iti_da_n
 = 
	`ba_code_da
(&
du_mp
[0],

292 &
wpm_ݔty
->
vue
);

293 
	`memy
(&
wpda
.
iti_da
[0], &
du_mp
[0],

294 (
size_t
)
wpda
.
iti_da_n
);

296 
n
 = 
	`wpm_code_du_obje_ݔty
(&
du
[
du_n
], &
wpda
);

297 
du_n
 +
n
;

299 
wpm_ݔty
 = wpm_ݔty->
xt
;

302 
n
 = 
	`wpm_code_du_obje_d
(&
du
[
du_n
]);

303 
du_n
 +
n
;

305 
wpm_obje
 = wpm_obje->
xt
;

309  
du_n
;

310 
	}
}

312 
	$wpm_ack_code_du_
(

313 
ut8_t
 * 
du
,

314 
ut8_t
 
voke_id
)

316 
n
 = 0;

318 i(
du
) {

319 
du
[
n
++] = 
PDU_TYPE_SIMPLE_ACK
;

320 
du
[
n
++] = 
voke_id
;

321 
du
[
n
++] = 
SERVICE_CONFIRMED_WRITE_PROP_MULTIPLE
;

324  
n
;

325 
	}
}

327 
	$wpm_r_ack_code_du
(

328 
ut8_t
 * 
du
,

329 
ut8_t
 
voke_id
,

330 
BACNET_WRITE_PROPERTY_DATA
 * 
wp_da
)

332 
n
 = 0;

334 i(
du
) {

335 
du
[
n
++] = 
PDU_TYPE_ERROR
;

336 
du
[
n
++] = 
voke_id
;

337 
du
[
n
++] = 
SERVICE_CONFIRMED_WRITE_PROP_MULTIPLE
;

339 
n
 +
	`code_ݒg_g
(&
du
[len], 0);

340 
n
 +
	`code_iti_umed
(&
du
[n], 
wp_da
->
r_ass
);

341 
n
 +
	`code_iti_umed
(&
du
[n], 
wp_da
->
r_code
);

342 
n
 +
	`code_osg_g
(&
du
[len], 0);

344 
n
 +
	`code_ݒg_g
(&
du
[len], 1);

345 
n
 +=

346 
	`code_cڋxt_obje_id
(&
du
[
n
], 0, 
wp_da
->
obje_ty
,

347 
wp_da
->
obje_
);

348 
n
 +=

349 
	`code_cڋxt_umed
(&
du
[
n
], 1, 
wp_da
->
obje_ݔty
);

351 i(
wp_da
->
y_dex
 !
BACNET_ARRAY_ALL
)

352 
n
 +=

353 
	`code_cڋxt_unsigd
(&
du
[
n
], 2, 
wp_da
->
y_dex
);

354 
n
 +
	`code_osg_g
(&
du
[len], 1);

356  
n
;

357 
	}
}

	@test/ctest.c

3 
	~"e.h
"

4 
	~<dio.h
>

5 
	~<rg.h
>

6 
	~<dlib.h
>

7 
	~<as.h
>

10 um { 
	mCHUNK
 = 10 };

12 
Te
 *
	$_
(

13 cڡ *
me
,

14 (*

(
Te
 *))

16 
backOutLev
 = 0;

17 
Te
 *
pTe
 = 
	`mloc
((Test));

18 i(
pTe
) {

19 
pTe
->
nPass
 =Te->
nFa
 =Te->
nTes
 = 0;

20 
pTe
->
pSm
 = 
dout
;

23 
	`as
(
CHUNK
);

24 
pTe
->
pTeFuns
 = 
	`oc
(
CHUNK
, (
TeFunc
));

25 i(
pTe
->
pTeFuns
) {

26 
pTe
->
maxTes
 = 
CHUNK
;

28 
	`as
(
me
);

29 
pTe
->
me
 = 
	`mloc
(
	`
(name) + 1);

30 i(
pTe
->
me
)

31 
	`ry
(
pTe
->
me
,ame);

33 ++
backOutLev
;

35 ++
backOutLev
;

39 i(
backOutLev
) {

40 
backOutLev
) {

42 
	`
(
pTe
->
pTeFuns
);

43 
pTe
->
pTeFuns
 = 
NULL
;

45 
	`
(
pTe
);

46 
pTe
 = 
NULL
;

48 } i(

) {

49 
	`as
(
pTe
);

50 
	`
(
pTe
);

52  
pTe
;

53 
	}
}

55 
	$_deroy
(

56 
Te
 * 
pTe
)

58 
	`as
(
pTe
);

59 
	`as
(
pTe
->
pTeFuns
);

60 
	`
(
pTe
->
pTeFuns
);

61 
pTe
->
pTeFuns
 = 
NULL
;

62 
	`as
(
pTe
->
me
);

63 
	`
(
pTe
->
me
);

64 
pTe
->
me
 = 
NULL
;

65 
	`
(
pTe
);

66 
	}
}

68 
bo
 
	$_addTeFuni
(

69 
Te
 * 
pTe
,

70 
TeFunc
 
tfun
)

72 
	`as
(
pTe
);

73 
	`as
(
pTe
->
pTeFuns
);

74 i(
pTe
->
nTes
 =pTe->
maxTes
) {

75 
size_t
 
wSize
 = 
pTe
->
nTes
 + 
CHUNK
;

76 
TeFunc
 *
w_pTeFuns
 = 
	`loc
(
pTe
->
pTeFuns
,

77 
wSize
 * (
TeFunc
));

78 i(!
w_pTeFuns
)

79  
l
;

80 
pTe
->
pTeFuns
 = 
w_pTeFuns
;

81 
pTe
->
maxTes
 +
CHUNK
;

83 
	`as
(
pTe
->
nTes
 <Te->
maxTes
);

84 
pTe
->
pTeFuns
[pTe->
nTes
++] = 
tfun
;

85  
ue
;

86 
	}
}

88 
	$_tSm
(

89 
Te
 * 
pTe
,

90 
FILE
 * 
pSm
)

92 
pTe
->
pSm
 =Stream;

93 
	}
}

95 
FILE
 *
	$_gSm
(

96 
Te
 * 
pTe
)

98  
pTe
->
pSm
;

99 
	}
}

101 
	$_pt
(

102 
Te
 * 
pTe
)

104 
	`as
(
pTe
);

105 i(
pTe
->
pSm
) {

106 
	`rtf
(
pTe
->
pSm
, "Test \"%s\":\n\tPassed: %ld\n\tFailed: %ld\n",

107 
pTe
->
me
,Te->
nPass
,Te->
nFa
);

109  
pTe
->
nFa
;

110 
	}
}

113 
	$_suced
(

114 
Te
 * 
pTe
)

116 
	`as
(
pTe
);

117 ++
pTe
->
nPass
;

118 
	}
}

120 
	$_do_
(

121 
Te
 * 
pTe
,

122 cڡ *
r
,

123 
bo
 
cd
,

124 cڡ *
fe
,

125 
le
)

127 
	`as
(
pTe
);

128 i(!
cd
)

129 
	`_do_
(
pTe
, 
r
, 
fe
, 
le
);

131 
	`_suced
(
pTe
);

132 
	}
}

134 
	$_do_
(

135 
Te
 * 
pTe
,

136 cڡ *
r
,

137 cڡ *
fe
,

138 
le
)

140 
	`as
(
pTe
);

141 ++
pTe
->
nFa
;

142 i(
pTe
->
pSm
) {

143 
	`rtf
(
pTe
->
pSm
, "%s failure: (%s), %s (line %ld)\n",

144 
pTe
->
me
, 
r
, 
fe
, 
le
);

146 
	}
}

148 
	$_gNumPasd
(

149 
Te
 * 
pTe
)

151 
	`as
(
pTe
);

152  
pTe
->
nPass
;

153 
	}
}

155 
	$_gNumFaed
(

156 
Te
 * 
pTe
)

158 
	`as
(
pTe
);

159  
pTe
->
nFa
;

160 
	}
}

162 
	$_run
(

163 
Te
 * 
pTe
)

165 
size_t
 
Num
;

166 
	`as
(
pTe
);

167 
Num
 = 0;eNum < 
pTe
->
nTes
; ++testNum)

168 
pTe
->
pTeFuns
[
Num
] (pTest);

169  
pTe
->
nFa
;

170 
	}
}

172 
	$_t
(

173 
Te
 * 
pTe
)

175 
	`as
(
pTe
);

176 
pTe
->
nFa
 =Te->
nPass
 = 0;

177 
	}
}

179 cڡ *
	$_gName
(

180 
Te
 * 
pTe
)

182 
	`as
(
pTe
);

183  (
pTe
->
me
);

184 
	}
}

186 
	$_gNumTes
(

187 
Te
 * 
pTe
)

189 
	`as
(
pTe
);

190  
pTe
->
nTes
;

191 
	}
}

	@test/ctest.h

5 #ide
CTEST_H


6 
	#CTEST_H


	)

8 
	~<dio.h
>

9 
	~<dbo.h
>

11 
	#_
(

, 
cd
) \

12 
	`_do_
(

, #cd, 
cd
, 
__FILE__
, 
__LINE__
)

	)

13 
	#_
(

, 
r
) \

14 
	`_do_
(

, 
r
, 
__FILE__
, 
__LINE__
)

	)

16 
_Te
 
	tTe
;

19 *
	tTeFunc
) (

20 
	tTe
 *);

22 
	s_Te
 {

23 *
me
;

24 
FILE
 *
pSm
;

25 
size_t
 
nTes
;

26 
size_t
 
maxTes
;

27 
TeFunc
 *
pTeFuns
;

28 
nPass
;

29 
nFa
;

32 #ifde
__lulus


36 
Te
 *
	`_
(

37 cڡ *
me
,

38 (*

(
Te
 *));

39 
	`_deroy
(

40 
Te
 * 
pTe
);

42 cڡ *
	`_gName
(

43 
Te
 * 
pTe
);

44 
	`_gNumPasd
(

45 
Te
 * 
pTe
);

46 
	`_gNumFaed
(

47 
Te
 * 
pTe
);

48 
	`_gNumTes
(

49 
Te
 * 
pTe
);

50 
FILE
 *
	`_gSm
(

51 
Te
 * 
pTe
);

52 
	`_tSm
(

53 
Te
 * 
pTe
,

54 
FILE
 * 
am
);

56 
bo
 
	`_addTeFuni
(

57 
Te
 * 
pTe
,

58 
TeFunc
 
tfun
);

59 
	`_suced
(

60 
Te
 * 
pTe
);

61 
	`_run
(

62 
Te
 * 
pTe
);

63 
	`_pt
(

64 
Te
 * 
pTe
);

65 
	`_t
(

66 
Te
 * 
pTe
);

69 
	`_do_
(

70 
Te
 * 
pTe
,

71 cڡ *
r
,

72 
bo
 
cd
,

73 cڡ *
fe
,

74 
le
);

75 
	`_do_
(

76 
Te
 * 
pTe
,

77 cڡ *
r
,

78 cڡ *
fe
,

79 
le
);

81 #ifde
__lulus


82 
	}
}

	@/usr/include/arpa/inet.h

18 #ide
_ARPA_INET_H


19 
	#_ARPA_INET_H
 1

	)

21 
	~<us.h
>

22 
	~<t/.h
>

25 #ide
__sockn_t_defed


26 
__sockn_t
 
	tsockn_t
;

27 
	#__sockn_t_defed


	)

30 
__BEGIN_DECLS


34 
_addr_t
 
	$_addr
 (cڡ *
__

__THROW
;

37 
_addr_t
 
	$_aof
 (
_addr
 
__

__THROW
;

41 
_addr
 
	$_makddr
 (
_addr_t
 
__t
, in_addr_
__ho
)

42 
__THROW
;

45 
_addr_t
 
	$_tof
 (
_addr
 
__

__THROW
;

49 
_addr_t
 
	$_twk
 (cڡ *
__

__THROW
;

53 *
	$_
 (
_addr
 
__

__THROW
;

58 
	$_
 (
__af
, cڡ *
__ri
 
__
,

59 *
__ri
 
__buf

__THROW
;

64 cڡ *
	$_
 (
__af
, cڡ *
__ri
 
__
,

65 *
__ri
 
__buf
, 
sockn_t
 
__n
)

66 
__THROW
;

70 #ifde
__USE_MISC


73 
	$_
 (cڡ *
__
, 
_addr
 *
__p

__THROW
;

77 *
	$_Ï
 (
_addr_t
 
__t
, *
__buf
, 
size_t
 
__n

__THROW
;

82 *
	$_t_
 (
__af
, cڡ *
__
, 
__bs
,

83 *
__buf
, 
size_t
 
__n

__THROW
;

88 
	$_t_
 (
__af
, cڡ *
__
,

89 *
__buf
, 
size_t
 
__n

__THROW
;

94 
	$_np_addr
 (cڡ *
__
,

95 *
__buf
, 
__n

__THROW
;

99 *
	$_np_
 (
__n
, cڡ *
__
,

100 *
__buf

__THROW
;

103 
__END_DECLS


	@/usr/include/assert.h

22 #ifdef 
_ASSERT_H


24 #unde
_ASSERT_H


25 #unde
as


26 #unde
__ASSERT_VOID_CAST


28 #ifdef 
__USE_GNU


29 #unde
as_


34 
	#_ASSERT_H
 1

	)

35 
	~<us.h
>

37 #i
defed
 
__lulus
 && 
__GNUC_PREREQ
 (2,95)

38 
	#__ASSERT_VOID_CAST
 
ic_
<>

	)

40 
	#__ASSERT_VOID_CAST
 ()

	)

48 #ifdef 
NDEBUG


50 
	#as
(
ex
(
	`__ASSERT_VOID_CAST
 (0))

	)

58 #ifdef 
__USE_GNU


59 
	#as_
(
um
(
	`__ASSERT_VOID_CAST
 (0))

	)

64 #ide
_ASSERT_H_DECLS


65 
	#_ASSERT_H_DECLS


	)

66 
__BEGIN_DECLS


69 
	$__as_
 (cڡ *
__asi
, cڡ *
__fe
,

70 
__le
, cڡ *
__funi
)

71 
__THROW
 
	`__ibu__
 ((
__nܑu__
));

74 
	$__as__
 (
__um
, cڡ *
__fe
,

75 
__le
, cڡ *
__funi
)

76 
__THROW
 
	`__ibu__
 ((
__nܑu__
));

81 
	$__as
 (cڡ *
__asi
, cڡ *
__fe
, 
__le
)

82 
__THROW
 
	`__ibu__
 ((
__nܑu__
));

85 
__END_DECLS


88 
	#as
(
ex
) \

89 ((
ex
) \

90 ? 
	`__ASSERT_VOID_CAST
 (0) \

91 : 
	`__as_
 (#ex, 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

93 #ifdef 
__USE_GNU


94 
	#as_
(
um
) \

95 (!(
um
) \

96 ? 
	`__ASSERT_VOID_CAST
 (0) \

97 : 
	`__as__
 ((
um
), 
__FILE__
, 
__LINE__
, 
__ASSERT_FUNCTION
))

	)

105 #i
defed
 
__lulus
 ? 
	`__GNUC_PREREQ
 (2, 6) : __GNUC_PREREQ (2, 4)

106 
	#__ASSERT_FUNCTION
 
__PRETTY_FUNCTION__


	)

108 #i
defed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

109 
	#__ASSERT_FUNCTION
 
__func__


	)

111 
	#__ASSERT_FUNCTION
 ((cڡ *0)

	)

118 #i
defed
 
__USE_ISOC11
 && !defed 
__lulus


119 #unde
ic_as


120 
	#ic_as
 
_Stic_as


	)

	@/usr/include/ctype.h

22 #idef 
_CTYPE_H


23 
	#_CTYPE_H
 1

	)

25 
	~<us.h
>

26 
	~<bs/tys.h
>

28 
	g__BEGIN_DECLS


30 #ide
_ISb


39 
	~<dn.h
>

40 #i
__BYTE_ORDER
 =
__BIG_ENDIAN


41 
	#_ISb
(
b
(1 << (b))

	)

43 
	#_ISb
(
b
((b< 8 ? ((1 << (b)<< 8: ((1 << (b)>> 8))

	)

48 
	m_ISu
 = 
_ISb
 (0),

49 
	m_ISlow
 = 
_ISb
 (1),

50 
	m_ISpha
 = 
_ISb
 (2),

51 
	m_ISdig
 = 
_ISb
 (3),

52 
	m_ISxdig
 = 
_ISb
 (4),

53 
	m_ISa
 = 
_ISb
 (5),

54 
	m_ISt
 = 
_ISb
 (6),

55 
	m_ISgph
 = 
_ISb
 (7),

56 
	m_ISbnk
 = 
_ISb
 (8),

57 
	m_ISl
 = 
_ISb
 (9),

58 
	m_ISpun
 = 
_ISb
 (10),

59 
	m_ISnum
 = 
_ISb
 (11)

79 cڡ **
	$__y_b_loc
 ()

80 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

81 cڡ 
__t32_t
 **
	$__y_tow_loc
 ()

82 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

83 cڡ 
__t32_t
 **
	$__y_tou_loc
 ()

84 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

87 #ide
__lulus


88 
	#__isy
(
c
, 
ty
) \

89 ((*
	`__y_b_loc
 ())[((
c
)] & (
ty
)

	)

90 #i
defed
 
__USE_EXTERN_INLINES


91 
	#__isy_f
(
ty
) \

92 
__ex_le
 \

93 
is
##
	`ty
 (
__c

__THROW
 \

95  (*
	`__y_b_loc
 ())[((
__c
)] & (
_IS
##
ty
; \

96 
	}

	)
}

99 
	#__iscii
(
c
(((c& ~0x7f=0

	)

100 
	#__tscii
(
c
((c& 0x7f

	)

102 
	#__exy
(
me

	`me
 (
__THROW


	)

104 
__BEGIN_NAMESPACE_STD


110 
__exy
 (
ium
);

111 
__exy
 (
iha
);

112 
__exy
 (
isl
);

113 
__exy
 (
isdig
);

114 
__exy
 (
iow
);

115 
__exy
 (
isgph
);

116 
__exy
 (
irt
);

117 
__exy
 (
iun
);

118 
__exy
 (
isa
);

119 
__exy
 (
isu
);

120 
__exy
 (
isxdig
);

124 
	$tow
 (
__c

__THROW
;

127 
	$tou
 (
__c

__THROW
;

129 
__END_NAMESPACE_STD


133 #ifdef 
__USE_ISOC99


134 
__BEGIN_NAMESPACE_C99


136 
	`__exy
 (
isbnk
);

138 
__END_NAMESPACE_C99


141 #ifde
__USE_GNU


143 
	$isy
 (
__c
, 
__mask

__THROW
;

146 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


150 
	$iscii
 (
__c

__THROW
;

154 
	$tscii
 (
__c

__THROW
;

158 
	`__exy
 (
_tou
);

159 
	`__exy
 (
_tow
);

163 
	#__tobody
(
c
, 
f
, 
a
, 
gs
) \

164 (
__exnsi__
 \

165 ({ 
__s
; \

166 i( (
c
) > 1) \

168 i(
	`__but_cڡt_p
 (
c
)) \

170 
__c
 = (
c
); \

171 
__s
 = 
__c
 < -128 || __> 255 ? __: (
a
)[__c]; \

174 
__s
 = 
f
 
gs
; \

177 
__s
 = (
a
)[((
c
)]; \

178 
__s
; 
	}
}))

	)

180 #i!
defed
 
__NO_CTYPE


181 #ifde
__isy_f


182 
	$__isy_f
 (
num
)

183 
	$__isy_f
 (
pha
)

184 
	$__isy_f
 (
l
)

185 
	$__isy_f
 (
dig
)

186 
	$__isy_f
 (
low
)

187 
	$__isy_f
 (
gph
)

188 
	$__isy_f
 (
t
)

189 
	$__isy_f
 (
pun
)

190 
	$__isy_f
 (
a
)

191 
	$__isy_f
 (
u
)

192 
	$__isy_f
 (
xdig
)

193 #ifde
__USE_ISOC99


194 
	$__isy_f
 (
bnk
)

196 #i
defed
 
__isy


197 
	#ium
(
c

	`__isy
((c), 
_ISnum
)

	)

198 
	#iha
(
c

	`__isy
((c), 
_ISpha
)

	)

199 
	#isl
(
c

	`__isy
((c), 
_ISl
)

	)

200 
	#isdig
(
c

	`__isy
((c), 
_ISdig
)

	)

201 
	#iow
(
c

	`__isy
((c), 
_ISlow
)

	)

202 
	#isgph
(
c

	`__isy
((c), 
_ISgph
)

	)

203 
	#irt
(
c

	`__isy
((c), 
_ISt
)

	)

204 
	#iun
(
c

	`__isy
((c), 
_ISpun
)

	)

205 
	#isa
(
c

	`__isy
((c), 
_ISa
)

	)

206 
	#isu
(
c

	`__isy
((c), 
_ISu
)

	)

207 
	#isxdig
(
c

	`__isy
((c), 
_ISxdig
)

	)

208 #ifde
__USE_ISOC99


209 
	#isbnk
(
c

	`__isy
((c), 
_ISbnk
)

	)

213 #ifde
__USE_EXTERN_INLINES


214 
__ex_le
 

215 
	`__NTH
 (
	$tow
 (
__c
))

217  
__c
 >-128 && __< 256 ? (*
	`__y_tow_loc
 ())[__c] : __c;

218 
	}
}

220 
__ex_le
 

221 
__NTH
 (
	$tou
 (
__c
))

223  
__c
 >-128 && __< 256 ? (*
	`__y_tou_loc
 ())[__c] : __c;

224 
	}
}

227 #i
__GNUC__
 >2 && 
defed
 
__OPTIMIZE__
 && !defed 
__lulus


228 
	#tow
(
c

	`__tobody
 (c, 
tow
, *
	`__y_tow_loc
 (), (c))

	)

229 
	#tou
(
c

	`__tobody
 (c, 
tou
, *
	`__y_tou_loc
 (), (c))

	)

232 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


233 
	#iscii
(
c

	`__iscii
 (c)

	)

234 
	#tscii
(
c

	`__tscii
 (c)

	)

236 
	#_tow
(
c
(((*
	`__y_tow_loc
 ())[((c)])

	)

237 
	#_tou
(
c
(((*
	`__y_tou_loc
 ())[((c)])

	)

243 #ifde
__USE_XOPEN2K8


257 
	~<xlo.h
>

261 
	#__isy_l
(
c
, 
ty
, 
lo
) \

262 ((
lo
)->
__y_b
[((
c
)] & (
ty
)

	)

264 
	#__exy_l
(
me
) \

265 
	`me
 (, 
__lo_t

__THROW


	)

271 
__exy_l
 (
ium_l
);

272 
__exy_l
 (
iha_l
);

273 
__exy_l
 (
isl_l
);

274 
__exy_l
 (
isdig_l
);

275 
__exy_l
 (
iow_l
);

276 
__exy_l
 (
isgph_l
);

277 
__exy_l
 (
irt_l
);

278 
__exy_l
 (
iun_l
);

279 
__exy_l
 (
isa_l
);

280 
__exy_l
 (
isu_l
);

281 
__exy_l
 (
isxdig_l
);

283 
__exy_l
 (
isbnk_l
);

287 
	$__tow_l
 (
__c
, 
__lo_t
 
__l

__THROW
;

288 
	$tow_l
 (
__c
, 
__lo_t
 
__l

__THROW
;

291 
	$__tou_l
 (
__c
, 
__lo_t
 
__l

__THROW
;

292 
	$tou_l
 (
__c
, 
__lo_t
 
__l

__THROW
;

294 #i
__GNUC__
 >2 && 
defed
 
__OPTIMIZE__
 && !defed 
__lulus


295 
	#__tow_l
(
c
, 
lo
) \

296 
	`__tobody
 (
c
, 
__tow_l
, (
lo
)->
__y_tow
, (c,o))

	)

297 
	#__tou_l
(
c
, 
lo
) \

298 
	`__tobody
 (
c
, 
__tou_l
, (
lo
)->
__y_tou
, (c,o))

	)

299 
	#tow_l
(
c
, 
lo

	`__tow_l
 ((c), (lo))

	)

300 
	#tou_l
(
c
, 
lo

	`__tou_l
 ((c), (lo))

	)

304 #ide
__NO_CTYPE


305 
	#__ium_l
(
c
,
l

	`__isy_l
((c), 
_ISnum
, (l))

	)

306 
	#__iha_l
(
c
,
l

	`__isy_l
((c), 
_ISpha
, (l))

	)

307 
	#__isl_l
(
c
,
l

	`__isy_l
((c), 
_ISl
, (l))

	)

308 
	#__isdig_l
(
c
,
l

	`__isy_l
((c), 
_ISdig
, (l))

	)

309 
	#__iow_l
(
c
,
l

	`__isy_l
((c), 
_ISlow
, (l))

	)

310 
	#__isgph_l
(
c
,
l

	`__isy_l
((c), 
_ISgph
, (l))

	)

311 
	#__irt_l
(
c
,
l

	`__isy_l
((c), 
_ISt
, (l))

	)

312 
	#__iun_l
(
c
,
l

	`__isy_l
((c), 
_ISpun
, (l))

	)

313 
	#__isa_l
(
c
,
l

	`__isy_l
((c), 
_ISa
, (l))

	)

314 
	#__isu_l
(
c
,
l

	`__isy_l
((c), 
_ISu
, (l))

	)

315 
	#__isxdig_l
(
c
,
l

	`__isy_l
((c), 
_ISxdig
, (l))

	)

317 
	#__isbnk_l
(
c
,
l

	`__isy_l
((c), 
_ISbnk
, (l))

	)

319 #ifde
__USE_MISC


320 
	#__iscii_l
(
c
,
l
(), 
	`__iscii
 (c))

	)

321 
	#__tscii_l
(
c
,
l
(), 
	`__tscii
 (c))

	)

324 
	#ium_l
(
c
,
l

	`__ium_l
 ((c), (l))

	)

325 
	#iha_l
(
c
,
l

	`__iha_l
 ((c), (l))

	)

326 
	#isl_l
(
c
,
l

	`__isl_l
 ((c), (l))

	)

327 
	#isdig_l
(
c
,
l

	`__isdig_l
 ((c), (l))

	)

328 
	#iow_l
(
c
,
l

	`__iow_l
 ((c), (l))

	)

329 
	#isgph_l
(
c
,
l

	`__isgph_l
 ((c), (l))

	)

330 
	#irt_l
(
c
,
l

	`__irt_l
 ((c), (l))

	)

331 
	#iun_l
(
c
,
l

	`__iun_l
 ((c), (l))

	)

332 
	#isa_l
(
c
,
l

	`__isa_l
 ((c), (l))

	)

333 
	#isu_l
(
c
,
l

	`__isu_l
 ((c), (l))

	)

334 
	#isxdig_l
(
c
,
l

	`__isxdig_l
 ((c), (l))

	)

336 
	#isbnk_l
(
c
,
l

	`__isbnk_l
 ((c), (l))

	)

338 #ifde
__USE_MISC


339 
	#iscii_l
(
c
,
l

	`__iscii_l
 ((c), (l))

	)

340 
	#tscii_l
(
c
,
l

	`__tscii_l
 ((c), (l))

	)

347 
__END_DECLS


	@/usr/include/dirent.h

22 #idef 
_DIRENT_H


23 
	#_DIRENT_H
 1

	)

25 
	~<us.h
>

27 
	g__BEGIN_DECLS


29 
	~<bs/tys.h
>

31 #ifde
__USE_XOPEN


32 #ide
__o_t_defed


33 #ide
__USE_FILE_OFFSET64


34 
__o_t
 
	to_t
;

36 
__o64_t
 
	to_t
;

38 
	#__o_t_defed


	)

40 #i
defed
 
__USE_LARGEFILE64
 && !defed 
__o64_t_defed


41 
__o64_t
 
	to64_t
;

42 
	#__o64_t_defed


	)

61 
	~<bs/dt.h
>

63 #i
defed
 
__USE_MISC
 && !defed 
d_fo


64 
	#d_o
 
d_fo


	)

81 #ifde
_DIRENT_HAVE_D_NAMLEN


82 
	#_D_EXACT_NAMLEN
(
d
((d)->
d_mn
)

	)

83 
	#_D_ALLOC_NAMLEN
(
d
(
	`_D_EXACT_NAMLEN
 (d+ 1)

	)

85 
	#_D_EXACT_NAMLEN
(
d
(
	`
 ((d)->
d_me
))

	)

86 #ifde
_DIRENT_HAVE_D_RECLEN


87 
	#_D_ALLOC_NAMLEN
(
d
(((*(d+ (d)->
d_
- &(d)->
d_me
[0])

	)

89 
	#_D_ALLOC_NAMLEN
(
d
( (d)->
d_me
 > 1 ?  (d)->d_name : \

90 
	`_D_EXACT_NAMLEN
 (
d
+ 1)

	)

95 #ifde
__USE_MISC


99 
	mDT_UNKNOWN
 = 0,

100 
	#DT_UNKNOWN
 
DT_UNKNOWN


	)

101 
	mDT_FIFO
 = 1,

102 
	#DT_FIFO
 
DT_FIFO


	)

103 
	mDT_CHR
 = 2,

104 
	#DT_CHR
 
DT_CHR


	)

105 
	mDT_DIR
 = 4,

106 
	#DT_DIR
 
DT_DIR


	)

107 
	mDT_BLK
 = 6,

108 
	#DT_BLK
 
DT_BLK


	)

109 
	mDT_REG
 = 8,

110 
	#DT_REG
 
DT_REG


	)

111 
	mDT_LNK
 = 10,

112 
	#DT_LNK
 
DT_LNK


	)

113 
	mDT_SOCK
 = 12,

114 
	#DT_SOCK
 
DT_SOCK


	)

115 
	mDT_WHT
 = 14

116 
	#DT_WHT
 
DT_WHT


	)

120 
	#IFTODT
(
mode
(((mode& 0170000>> 12)

	)

121 
	#DTTOIF
(
dty
((dty<< 12)

	)

127 
__dam
 
	tDIR
;

134 
DIR
 *
	$ݒd
 (cڡ *
__me

	`__nnu
 ((1));

136 #ifde
__USE_XOPEN2K8


141 
DIR
 *
	`fdݒd
 (
__fd
);

149 
	$od
 (
DIR
 *
__dp

	`__nnu
 ((1));

161 #ide
__USE_FILE_OFFSET64


162 
dt
 *
	$add
 (
DIR
 *
__dp

	`__nnu
 ((1));

164 #ifde
__REDIRECT


165 
dt
 *
	`__REDIRECT
 (
add
, (
DIR
 *
__dp
), 
add64
)

166 
	`__nnu
 ((1));

168 
	#add
 
add64


	)

172 #ifde
__USE_LARGEFILE64


173 
dt64
 *
	$add64
 (
DIR
 *
__dp

	`__nnu
 ((1));

176 #ifde
__USE_POSIX


182 #ide
__USE_FILE_OFFSET64


183 
	$add_r
 (
DIR
 *
__ri
 
__dp
,

184 
dt
 *
__ri
 
__y
,

185 
dt
 **
__ri
 
__su
)

186 
	`__nnu
 ((1, 2, 3));

188 #ifde
__REDIRECT


189 
	`__REDIRECT
 (
add_r
,

190 (
DIR
 *
__ri
 
__dp
,

191 
dt
 *
__ri
 
__y
,

192 
dt
 **
__ri
 
__su
),

193 
add64_r

	`__nnu
 ((1, 2, 3));

195 
	#add_r
 
add64_r


	)

199 #ifde
__USE_LARGEFILE64


200 
	$add64_r
 (
DIR
 *
__ri
 
__dp
,

201 
dt64
 *
__ri
 
__y
,

202 
dt64
 **
__ri
 
__su
)

203 
	`__nnu
 ((1, 2, 3));

208 
	$wdd
 (
DIR
 *
__dp

__THROW
 
	`__nnu
 ((1));

210 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


211 
	~<bs/tys.h
>

214 
	$ekd
 (
DIR
 *
__dp
, 
__pos

__THROW
 
	`__nnu
 ((1));

217 
	$d
 (
DIR
 *
__dp

__THROW
 
	`__nnu
 ((1));

220 #ifde
__USE_XOPEN2K8


223 
	$dfd
 (
DIR
 *
__dp

__THROW
 
	`__nnu
 ((1));

225 #i
defed
 
__OPTIMIZE__
 && defed 
_DIR_dfd


226 
	#dfd
(
dp

	`_DIR_dfd
 (dp)

	)

229 #ifde
__USE_MISC


230 #ide
MAXNAMLEN


232 
	~<bs/posix1_lim.h
>

235 #ifde
NAME_MAX


236 
	#MAXNAMLEN
 
NAME_MAX


	)

238 
	#MAXNAMLEN
 255

	)

243 
	#__ed_size_t


	)

244 
	~<ddef.h
>

253 #ide
__USE_FILE_OFFSET64


254 
	$snd
 (cڡ *
__ri
 
__d
,

255 
dt
 ***
__ri
 
__mi
,

256 (*
__
(cڡ 
dt
 *),

257 (*
__cmp
(cڡ 
dt
 **,

258 cڡ 
dt
 **))

259 
	`__nnu
 ((1, 2));

261 #ifde
__REDIRECT


262 
	`__REDIRECT
 (
snd
,

263 (cڡ *
__ri
 
__d
,

264 
dt
 ***
__ri
 
__mi
,

265 (*
__
(cڡ 
dt
 *),

266 (*
__cmp
(cڡ 
dt
 **,

267 cڡ 
dt
 **)),

268 
snd64

	`__nnu
 ((1, 2));

270 
	#snd
 
snd64


	)

274 #i
defed
 
__USE_GNU
 && defed 
__USE_LARGEFILE64


277 
	$snd64
 (cڡ *
__ri
 
__d
,

278 
dt64
 ***
__ri
 
__mi
,

279 (*
__
(cڡ 
dt64
 *),

280 (*
__cmp
(cڡ 
dt64
 **,

281 cڡ 
dt64
 **))

282 
	`__nnu
 ((1, 2));

285 #ifde
__USE_GNU


291 #ide
__USE_FILE_OFFSET64


292 
	$snd
 (
__dfd
, cڡ *
__ri
 
__d
,

293 
dt
 ***
__ri
 
__mi
,

294 (*
__
(cڡ 
dt
 *),

295 (*
__cmp
(cڡ 
dt
 **,

296 cڡ 
dt
 **))

297 
	`__nnu
 ((2, 3));

299 #ifde
__REDIRECT


300 
	`__REDIRECT
 (
snd
,

301 (
__dfd
, cڡ *
__ri
 
__d
,

302 
dt
 ***
__ri
 
__mi
,

303 (*
__
(cڡ 
dt
 *),

304 (*
__cmp
(cڡ 
dt
 **,

305 cڡ 
dt
 **)),

306 
snd64

	`__nnu
 ((2, 3));

308 
	#snd
 
snd64


	)

314 
	$snd64
 (
__dfd
, cڡ *
__ri
 
__d
,

315 
dt64
 ***
__ri
 
__mi
,

316 (*
__
(cڡ 
dt64
 *),

317 (*
__cmp
(cڡ 
dt64
 **,

318 cڡ 
dt64
 **))

319 
	`__nnu
 ((2, 3));

323 #ide
__USE_FILE_OFFSET64


324 
	$phast
 (cڡ 
dt
 **
__e1
,

325 cڡ 
dt
 **
__e2
)

326 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

328 #ifde
__REDIRECT


329 
	`__REDIRECT_NTH
 (
phast
,

330 (cڡ 
dt
 **
__e1
,

331 cڡ 
dt
 **
__e2
),

332 
phast64

__ibu_pu__
 
	`__nnu
 ((1, 2));

334 
	#phast
 
phast64


	)

338 #i
defed
 
__USE_GNU
 && defed 
__USE_LARGEFILE64


339 
	$phast64
 (cڡ 
dt64
 **
__e1
,

340 cڡ 
dt64
 **
__e2
)

341 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

346 #ifde
__USE_MISC


351 #ide
__USE_FILE_OFFSET64


352 
__ssize_t
 
	$gds
 (
__fd
, *
__ri
 
__buf
,

353 
size_t
 
__nbys
,

354 
__off_t
 *
__ri
 
__bap
)

355 
__THROW
 
	`__nnu
 ((2, 4));

357 #ifde
__REDIRECT


358 
__ssize_t
 
	`__REDIRECT_NTH
 (
gds
,

359 (
__fd
, *
__ri
 
__buf
,

360 
size_t
 
__nbys
,

361 
__off64_t
 *
__ri
 
__bap
),

362 
gds64

	`__nnu
 ((2, 4));

364 
	#gds
 
gds64


	)

368 #ifde
__USE_LARGEFILE64


369 
__ssize_t
 
	$gds64
 (
__fd
, *
__ri
 
__buf
,

370 
size_t
 
__nbys
,

371 
__off64_t
 *
__ri
 
__bap
)

372 
__THROW
 
	`__nnu
 ((2, 4));

376 #ifde
__USE_GNU


378 #ide
__USE_FILE_OFFSET64


379 
	$vsist
 (cڡ 
dt
 **
__e1
,

380 cڡ 
dt
 **
__e2
)

381 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

383 #ifde
__REDIRECT


384 
	`__REDIRECT_NTH
 (
vsist
,

385 (cڡ 
dt
 **
__e1
,

386 cڡ 
dt
 **
__e2
),

387 
vsist64
)

388 
__ibu_pu__
 
	`__nnu
 ((1, 2));

390 
	#vsist
 
vsist64


	)

394 #ifde
__USE_LARGEFILE64


395 
	$vsist64
 (cڡ 
dt64
 **
__e1
,

396 cڡ 
dt64
 **
__e2
)

397 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

401 
__END_DECLS


	@/usr/include/errno.h

22 #idef 
_ERRNO_H


26 #idef 
__ed_Emh


27 
	#_ERRNO_H
 1

	)

28 
	~<us.h
>

31 
	g__BEGIN_DECLS


35 
	~<bs/o.h
>

36 #unde
__ed_Emh


38 #ifdef 
_ERRNO_H


45 #idef 
o


46 
o
;

49 #ifde
__USE_GNU


54 *
ogm_voti_me
, *
ogm_voti_sht_me
;

58 
	g__END_DECLS


66 #i
defed
 
__USE_GNU
 || defed 
__ed_r_t


67 #ide
__r_t_defed


68 
	tr_t
;

69 
	#__r_t_defed
 1

	)

71 #unde
__ed_r_t


	@/usr/include/fcntl.h

22 #idef 
_FCNTL_H


23 
	#_FCNTL_H
 1

	)

25 
	~<us.h
>

28 
	g__BEGIN_DECLS


31 
	~<bs/tys.h
>

35 
	~<bs/f.h
>

39 #ifde
__O_TMPFILE


40 
	#__OPEN_NEEDS_MODE
(
oag
) \

41 (((
oag
& 
O_CREAT
!0 || ((oag& 
__O_TMPFILE
=__O_TMPFILE)

	)

43 
	#__OPEN_NEEDS_MODE
(
oag
(((oag& 
O_CREAT
!0)

	)

49 #ide
__mode_t_defed


50 
__mode_t
 
	tmode_t
;

51 
	#__mode_t_defed


	)

54 #ide
__off_t_defed


55 #ide
__USE_FILE_OFFSET64


56 
__off_t
 
	toff_t
;

58 
__off64_t
 
	toff_t
;

60 
	#__off_t_defed


	)

63 #i
defed
 
__USE_LARGEFILE64
 && !defed 
__off64_t_defed


64 
__off64_t
 
	toff64_t
;

65 
	#__off64_t_defed


	)

68 #ide
__pid_t_defed


69 
__pid_t
 
	tpid_t
;

70 
	#__pid_t_defed


	)

74 #i
defed
 
__USE_XOPEN
 || defed 
__USE_XOPEN2K8


75 
	#__ed_timeec


	)

76 
	~<time.h
>

77 
	~<bs/.h
>

79 
	#S_IFMT
 
__S_IFMT


	)

80 
	#S_IFDIR
 
__S_IFDIR


	)

81 
	#S_IFCHR
 
__S_IFCHR


	)

82 
	#S_IFBLK
 
__S_IFBLK


	)

83 
	#S_IFREG
 
__S_IFREG


	)

84 #ifde
__S_IFIFO


85 
	#S_IFIFO
 
__S_IFIFO


	)

87 #ifde
__S_IFLNK


88 
	#S_IFLNK
 
__S_IFLNK


	)

90 #i(
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K8
&& defed 
__S_IFSOCK


91 
	#S_IFSOCK
 
__S_IFSOCK


	)

96 
	#S_ISUID
 
__S_ISUID


	)

97 
	#S_ISGID
 
__S_ISGID


	)

99 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


101 
	#S_ISVTX
 
__S_ISVTX


	)

104 
	#S_IRUSR
 
__S_IREAD


	)

105 
	#S_IWUSR
 
__S_IWRITE


	)

106 
	#S_IXUSR
 
__S_IEXEC


	)

108 
	#S_IRWXU
 (
__S_IREAD
|
__S_IWRITE
|
__S_IEXEC
)

	)

110 
	#S_IRGRP
 (
S_IRUSR
 >> 3

	)

111 
	#S_IWGRP
 (
S_IWUSR
 >> 3

	)

112 
	#S_IXGRP
 (
S_IXUSR
 >> 3

	)

114 
	#S_IRWXG
 (
S_IRWXU
 >> 3)

	)

116 
	#S_IROTH
 (
S_IRGRP
 >> 3

	)

117 
	#S_IWOTH
 (
S_IWGRP
 >> 3

	)

118 
	#S_IXOTH
 (
S_IXGRP
 >> 3

	)

120 
	#S_IRWXO
 (
S_IRWXG
 >> 3)

	)

123 #ifdef 
__USE_MISC


124 #ide
R_OK


127 
	#R_OK
 4

	)

128 
	#W_OK
 2

	)

129 
	#X_OK
 1

	)

130 
	#F_OK
 0

	)

135 #i
defed
 
__USE_XOPEN
 || defed 
__USE_XOPEN2K8


136 
	#SEEK_SET
 0

	)

137 
	#SEEK_CUR
 1

	)

138 
	#SEEK_END
 2

	)

146 
f
 (
__fd
, 
__cmd
, ...);

155 #ide
__USE_FILE_OFFSET64


156 
	$ݒ
 (cڡ *
__fe
, 
__oag
, ...
	`__nnu
 ((1));

158 #ifde
__REDIRECT


159 
	`__REDIRECT
 (
ݒ
, (cڡ *
__fe
, 
__oag
, ...), 
ݒ64
)

160 
	`__nnu
 ((1));

162 
	#ݒ
 
ݒ64


	)

165 #ifde
__USE_LARGEFILE64


166 
	$ݒ64
 (cڡ *
__fe
, 
__oag
, ...
	`__nnu
 ((1));

169 #ifde
__USE_ATFILE


179 #ide
__USE_FILE_OFFSET64


180 
	$ݒ
 (
__fd
, cڡ *
__fe
, 
__oag
, ...)

181 
	`__nnu
 ((2));

183 #ifde
__REDIRECT


184 
	`__REDIRECT
 (
ݒ
, (
__fd
, cڡ *
__fe
, 
__oag
,

185 ...), 
ݒ64

	`__nnu
 ((2));

187 
	#ݒ
 
ݒ64


	)

190 #ifde
__USE_LARGEFILE64


191 
	$ݒ64
 (
__fd
, cڡ *
__fe
, 
__oag
, ...)

192 
	`__nnu
 ((2));

201 #ide
__USE_FILE_OFFSET64


202 
	$t
 (cڡ *
__fe
, 
mode_t
 
__mode

	`__nnu
 ((1));

204 #ifde
__REDIRECT


205 
	`__REDIRECT
 (
t
, (cڡ *
__fe
, 
mode_t
 
__mode
),

206 
t64

	`__nnu
 ((1));

208 
	#t
 
t64


	)

211 #ifde
__USE_LARGEFILE64


212 
	$t64
 (cڡ *
__fe
, 
mode_t
 
__mode

	`__nnu
 ((1));

215 #i!
defed
 
F_LOCK
 && (defed 
__USE_MISC
 || (defed 
__USE_XOPEN_EXTENDED
 \

216 && !
defed
 
__USE_POSIX
))

225 
	#F_ULOCK
 0

	)

226 
	#F_LOCK
 1

	)

227 
	#F_TLOCK
 2

	)

228 
	#F_TEST
 3

	)

230 #ide
__USE_FILE_OFFSET64


231 
	`lockf
 (
__fd
, 
__cmd
, 
off_t
 
__n
);

233 #ifde
__REDIRECT


234 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__n
), 
lockf64
);

236 
	#lockf
 
lockf64


	)

239 #ifde
__USE_LARGEFILE64


240 
	`lockf64
 (
__fd
, 
__cmd
, 
off64_t
 
__n
);

244 #ifde
__USE_XOPEN2K


247 #ide
__USE_FILE_OFFSET64


248 
	$posix_dvi
 (
__fd
, 
off_t
 
__offt
, off_
__n
,

249 
__advi

__THROW
;

251 #ifde
__REDIRECT_NTH


252 
	`__REDIRECT_NTH
 (
posix_dvi
, (
__fd
, 
__off64_t
 
__offt
,

253 
__off64_t
 
__n
, 
__advi
),

254 
posix_dvi64
);

256 
	#posix_dvi
 
posix_dvi64


	)

259 #ifde
__USE_LARGEFILE64


260 
	$posix_dvi64
 (
__fd
, 
off64_t
 
__offt
, off64_
__n
,

261 
__advi

__THROW
;

269 #ide
__USE_FILE_OFFSET64


270 
	`posix_o
 (
__fd
, 
off_t
 
__offt
, off_
__n
);

272 #ifde
__REDIRECT


273 
	`__REDIRECT
 (
posix_o
, (
__fd
, 
__off64_t
 
__offt
,

274 
__off64_t
 
__n
),

275 
posix_o64
);

277 
	#posix_o
 
posix_o64


	)

280 #ifde
__USE_LARGEFILE64


281 
	`posix_o64
 (
__fd
, 
off64_t
 
__offt
, off64_
__n
);

287 #i
__USE_FORTIFY_LEVEL
 > 0 && 
defed
 
__ftify_funi
 \

288 && 
defed
 
__va_g_ck_n


289 
	~<bs/f2.h
>

292 
__END_DECLS


	@/usr/include/features.h

18 #idef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

97 #unde
__USE_ISOC11


98 #unde
__USE_ISOC99


99 #unde
__USE_ISOC95


100 #unde
__USE_ISOCXX11


101 #unde
__USE_POSIX


102 #unde
__USE_POSIX2


103 #unde
__USE_POSIX199309


104 #unde
__USE_POSIX199506


105 #unde
__USE_XOPEN


106 #unde
__USE_XOPEN_EXTENDED


107 #unde
__USE_UNIX98


108 #unde
__USE_XOPEN2K


109 #unde
__USE_XOPEN2KXSI


110 #unde
__USE_XOPEN2K8


111 #unde
__USE_XOPEN2K8XSI


112 #unde
__USE_LARGEFILE


113 #unde
__USE_LARGEFILE64


114 #unde
__USE_FILE_OFFSET64


115 #unde
__USE_MISC


116 #unde
__USE_ATFILE


117 #unde
__USE_GNU


118 #unde
__USE_REENTRANT


119 #unde
__USE_FORTIFY_LEVEL


120 #unde
__KERNEL_STRICT_NAMES


124 #ide
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

135 #i
defed
 
__GNUC__
 && defed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
m
) \

137 ((
__GNUC__
 << 16+ 
__GNUC_MINOR__
 >((
maj
<< 16+ (
m
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
m
0

	)

146 #i(
defed
 
_BSD_SOURCE
 || defed 
_SVID_SOURCE
) \

147 && !
defed
 
	g_DEFAULT_SOURCE


152 #unde
_DEFAULT_SOURCE


153 
	#_DEFAULT_SOURCE
 1

	)

157 #ifde
_GNU_SOURCE


158 #unde
_ISOC95_SOURCE


159 
	#_ISOC95_SOURCE
 1

	)

160 #unde
_ISOC99_SOURCE


161 
	#_ISOC99_SOURCE
 1

	)

162 #unde
_ISOC11_SOURCE


163 
	#_ISOC11_SOURCE
 1

	)

164 #unde
_POSIX_SOURCE


165 
	#_POSIX_SOURCE
 1

	)

166 #unde
_POSIX_C_SOURCE


167 
	#_POSIX_C_SOURCE
 200809L

	)

168 #unde
_XOPEN_SOURCE


169 
	#_XOPEN_SOURCE
 700

	)

170 #unde
_XOPEN_SOURCE_EXTENDED


171 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

172 #unde
_LARGEFILE64_SOURCE


173 
	#_LARGEFILE64_SOURCE
 1

	)

174 #unde
_DEFAULT_SOURCE


175 
	#_DEFAULT_SOURCE
 1

	)

176 #unde
_ATFILE_SOURCE


177 
	#_ATFILE_SOURCE
 1

	)

182 #i(
defed
 
_DEFAULT_SOURCE
 \

183 || (!
defed
 
	g__STRICT_ANSI__
 \

184 && !
defed
 
	g_ISOC99_SOURCE
 \

185 && !
defed
 
	g_POSIX_SOURCE
 && !defed 
	g_POSIX_C_SOURCE
 \

186 && !
defed
 
	g_XOPEN_SOURCE
))

187 #unde
_DEFAULT_SOURCE


188 
	#_DEFAULT_SOURCE
 1

	)

192 #i(
defed
 
_ISOC11_SOURCE
 \

193 || (
defed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

194 
	#__USE_ISOC11
 1

	)

198 #i(
defed
 
_ISOC99_SOURCE
 || defed 
_ISOC11_SOURCE
 \

199 || (
defed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

200 
	#__USE_ISOC99
 1

	)

204 #i(
defed
 
_ISOC99_SOURCE
 || defed 
_ISOC11_SOURCE
 \

205 || (
defed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

206 
	#__USE_ISOC95
 1

	)

213 #i((
defed
 
__lulus
 && __cplusplus >= 201103L) \

214 || 
defed
 
__GXX_EXPERIMENTAL_CXX0X__
)

215 
	#__USE_ISOCXX11
 1

	)

221 #ifde
_DEFAULT_SOURCE


222 #i!
defed
 
_POSIX_SOURCE
 && !defed 
_POSIX_C_SOURCE


223 
	#__USE_POSIX_IMPLICITLY
 1

	)

225 #unde
_POSIX_SOURCE


226 
	#_POSIX_SOURCE
 1

	)

227 #unde
_POSIX_C_SOURCE


228 
	#_POSIX_C_SOURCE
 200809L

	)

230 #i((!
defed
 
__STRICT_ANSI__
 \

231 || (
defed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

232 && !
defed
 
_POSIX_SOURCE
 && !defed 
_POSIX_C_SOURCE
)

233 
	#_POSIX_SOURCE
 1

	)

234 #i
defed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

235 
	#_POSIX_C_SOURCE
 2

	)

236 #i
defed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

237 
	#_POSIX_C_SOURCE
 199506L

	)

238 #i
defed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

239 
	#_POSIX_C_SOURCE
 200112L

	)

241 
	#_POSIX_C_SOURCE
 200809L

	)

243 
	#__USE_POSIX_IMPLICITLY
 1

	)

246 #i(
defed
 
_POSIX_SOURCE
 \

247 || (
defed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

248 || 
defed
 
_XOPEN_SOURCE
)

249 
	#__USE_POSIX
 1

	)

252 #i
defed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || defed 
_XOPEN_SOURCE


253 
	#__USE_POSIX2
 1

	)

256 #i
defed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

257 
	#__USE_POSIX199309
 1

	)

260 #i
defed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

261 
	#__USE_POSIX199506
 1

	)

264 #i
defed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

265 
	#__USE_XOPEN2K
 1

	)

266 #unde
__USE_ISOC95


267 
	#__USE_ISOC95
 1

	)

268 #unde
__USE_ISOC99


269 
	#__USE_ISOC99
 1

	)

272 #i
defed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

273 
	#__USE_XOPEN2K8
 1

	)

274 #unde
_ATFILE_SOURCE


275 
	#_ATFILE_SOURCE
 1

	)

278 #ifdef 
_XOPEN_SOURCE


279 
	#__USE_XOPEN
 1

	)

280 #i(
_XOPEN_SOURCE
 - 0) >= 500

281 
	#__USE_XOPEN_EXTENDED
 1

	)

282 
	#__USE_UNIX98
 1

	)

283 #unde
_LARGEFILE_SOURCE


284 
	#_LARGEFILE_SOURCE
 1

	)

285 #i(
_XOPEN_SOURCE
 - 0) >= 600

286 #i(
_XOPEN_SOURCE
 - 0) >= 700

287 
	#__USE_XOPEN2K8
 1

	)

288 
	#__USE_XOPEN2K8XSI
 1

	)

290 
	#__USE_XOPEN2K
 1

	)

291 
	#__USE_XOPEN2KXSI
 1

	)

292 #unde
__USE_ISOC95


293 
	#__USE_ISOC95
 1

	)

294 #unde
__USE_ISOC99


295 
	#__USE_ISOC99
 1

	)

298 #ifde
_XOPEN_SOURCE_EXTENDED


299 
	#__USE_XOPEN_EXTENDED
 1

	)

304 #ifde
_LARGEFILE_SOURCE


305 
	#__USE_LARGEFILE
 1

	)

308 #ifde
_LARGEFILE64_SOURCE


309 
	#__USE_LARGEFILE64
 1

	)

312 #i
defed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

313 
	#__USE_FILE_OFFSET64
 1

	)

316 #i
defed
 
_DEFAULT_SOURCE


317 
	#__USE_MISC
 1

	)

320 #ifdef 
_ATFILE_SOURCE


321 
	#__USE_ATFILE
 1

	)

324 #ifdef 
_GNU_SOURCE


325 
	#__USE_GNU
 1

	)

328 #i
defed
 
_REENTRANT
 || defed 
_THREAD_SAFE


329 
	#__USE_REENTRANT
 1

	)

332 #i
defed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0 \

333 && 
__GNUC_PREREQ
 (4, 1&& 
defed
 
	g__OPTIMIZE__
 && __OPTIMIZE__ > 0

334 #i
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 
	#__USE_FORTIFY_LEVEL
 0

	)

345 
	~<dc-edef.h
>

353 #unde
__GNU_LIBRARY__


354 
	#__GNU_LIBRARY__
 6

	)

358 
	#__GLIBC__
 2

	)

359 
	#__GLIBC_MINOR__
 23

	)

361 
	#__GLIBC_PREREQ
(
maj
, 
m
) \

362 ((
__GLIBC__
 << 16+ 
__GLIBC_MINOR__
 >((
maj
<< 16+ (
m
))

	)

365 #ide
__ASSEMBLER__


366 #ide
_SYS_CDEFS_H


367 
	~<sys/cdefs.h
>

372 #i
defed
 
__USE_FILE_OFFSET64
 && !defed 
__REDIRECT


373 
	#__USE_LARGEFILE
 1

	)

374 
	#__USE_LARGEFILE64
 1

	)

380 #i
__GNUC_PREREQ
 (2, 7&& 
defed
 
__OPTIMIZE__
 \

381 && !
defed
 
	g__OPTIMIZE_SIZE__
 && !defed 
	g__NO_INLINE__
 \

382 && 
defed
 
	g__ex_le


383 
	#__USE_EXTERN_INLINES
 1

	)

391 
	~<gnu/ubs.h
>

	@/usr/include/getopt.h

19 #ide
_GETOPT_H


21 #ide
__ed_gt


22 
	#_GETOPT_H
 1

	)

32 #i!
defed
 
__GNU_LIBRARY__


33 
	~<y.h
>

36 #ide
__THROW


37 #ide
__GNUC_PREREQ


38 
	#__GNUC_PREREQ
(
maj
, 
m
(0)

	)

40 #i
defed
 
__lulus
 && 
__GNUC_PREREQ
 (2,8)

41 
	#__THROW
 
	`throw
 ()

	)

43 
	#__THROW


	)

47 #ifdef 
__lulus


57 *
ݏrg
;

71 
td
;

76 
݋
;

80 
tt
;

82 #ide
__ed_gt


104 
	sti


106 cڡ *
	gme
;

109 
	ghas_g
;

110 *
	gag
;

111 
	gv
;

116 
	#no_gumt
 0

	)

117 
	#qued_gumt
 1

	)

118 
	#tiڮ_gumt
 2

	)

146 #ifde
__GNU_LIBRARY__


150 
gt
 (
___gc
, *cڡ *
___gv
, cڡ *
__shtts
)

151 
__THROW
;

153 #i
defed
 
__ed_gt
 && defed 
__USE_POSIX2
 \

154 && !
defed
 
	g__USE_POSIX_IMPLICITLY
 && !defed 
	g__USE_GNU


158 #ifde
__REDIRECT


159 
__REDIRECT_NTH
 (
gt
, (
___gc
, *cڡ *
___gv
,

160 cڡ *
__shtts
),

161 
__posix_gt
);

163 
__posix_gt
 (
___gc
, *cڡ *
___gv
,

164 cڡ *
__shtts

__THROW
;

165 
	#gt
 
__posix_gt


	)

169 
gt
 ();

172 #ide
__ed_gt


173 
gt_lg
 (
___gc
, *cڡ *
___gv
,

174 cڡ *
__shtts
,

175 cڡ 
ti
 *
__lgts
, *
__lgd
)

176 
__THROW
;

177 
gt_lg_ly
 (
___gc
, *cڡ *
___gv
,

178 cڡ *
__shtts
,

179 cڡ 
ti
 *
__lgts
, *
__lgd
)

180 
__THROW
;

184 #ifdef 
__lulus


189 #unde
__ed_gt


	@/usr/include/ifaddrs.h

19 #ide
_IFADDRS_H


20 
	#_IFADDRS_H
 1

	)

22 
	~<us.h
>

23 
	~<sys/sock.h
>

25 
__BEGIN_DECLS


29 
	siddrs


31 
iddrs
 *
	mi_xt
;

33 *
	mi_me
;

34 
	mi_ags
;

36 
sockaddr
 *
	mi_addr
;

37 
sockaddr
 *
	mi_tmask
;

44 
sockaddr
 *
	mifu_brdaddr
;

45 
sockaddr
 *
	mifu_daddr
;

46 } 
	mi_ifu
;

49 #ide
i_brdaddr


50 
	#i_brdaddr
 
i_ifu
.
ifu_brdaddr


	)

52 #ide
i_daddr


53 
	#i_daddr
 
i_ifu
.
ifu_daddr


	)

56 *
	mi_da
;

66 
	$giddrs
 (
iddrs
 **
__ip

__THROW
;

69 
	$iddrs
 (
iddrs
 *
__i

__THROW
;

71 
__END_DECLS


	@/usr/include/libgen.h

18 #ide
_LIBGEN_H


19 
	#_LIBGEN_H
 1

	)

21 
	~<us.h
>

23 
__BEGIN_DECLS


26 *
	$dme
 (*
__th

__THROW
;

34 *
	$__xpg_bame
 (*
__th

__THROW
;

35 
	#bame
 
__xpg_bame


	)

37 
__END_DECLS


	@/usr/include/limits.h

22 #ide
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<us.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #i!
defed
 
__GNUC__
 || __GNUC__ < 2

41 #ide
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<bs/wdsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifde
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #i
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #i
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifde
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #i
defed
 
__GNUC__
 && !defed 
_GCC_LIMITS_H_


123 #ude_x<
lims
.
h
>

129 #i
defed
 
__USE_ISOC99
 && defed 
__GNUC__


130 #ide
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #ide
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #ide
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<bs/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<bs/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<bs/xݒ_lim.h
>

	@/usr/include/linux/if_arcnet.h

16 #ide
_LINUX_IF_ARCNET_H


17 
	#_LINUX_IF_ARCNET_H


	)

19 
	~<lux/tys.h
>

20 
	~<lux/if_h.h
>

30 
	#ARC_P_IP
 212

	)

31 
	#ARC_P_IPV6
 196

	)

32 
	#ARC_P_ARP
 213

	)

33 
	#ARC_P_RARP
 214

	)

34 
	#ARC_P_IPX
 250

	)

35 
	#ARC_P_NOVELL_EC
 236

	)

38 
	#ARC_P_IP_RFC1051
 240

	)

39 
	#ARC_P_ARP_RFC1051
 241

	)

42 
	#ARC_P_ETHER
 232

	)

45 
	#ARC_P_DATAPOINT_BOOT
 0

	)

46 
	#ARC_P_DATAPOINT_MOUNT
 1

	)

47 
	#ARC_P_POWERLAN_BEACON
 8

	)

48 
	#ARC_P_POWERLAN_BEACON2
 243

	)

49 
	#ARC_P_LANSOFT
 251

	)

50 
	#ARC_P_ATALK
 0xDD

	)

53 
	#ARCNET_ALEN
 1

	)

58 
	sc_rfc1201
 {

59 
__u8
 
	mo
;

60 
__u8
 
	ml_ag
;

61 
__be16
 
	mqu
;

62 
__u8
 
	myld
[0];

64 
	#RFC1201_HDR_SIZE
 4

	)

69 
	sc_rfc1051
 {

70 
__u8
 
	mo
;

71 
__u8
 
	myld
[0];

73 
	#RFC1051_HDR_SIZE
 1

	)

79 
	sc_h_p
 {

80 
__u8
 
	mo
;

81 
hhdr
 
	mh
;

82 
__u8
 
	myld
[0];

84 
	#ETH_ENCAP_HDR_SIZE
 14

	)

86 
	sc_p
 {

87 
__u8
 
	mo
;

88 
__u8
 
	mcook
[()];

91 
__u8
 
	mack
;

92 
__u8
 
	mw
[0];

93 } 
	mmes
;

104 
	sc_hdwe
 {

105 
__u8
 
	msour
;

106 
__u8
 
	mde
;

107 
__u8
 
	mofft
[2];

109 
	#ARC_HDR_SIZE
 4

	)

115 
	schdr
 {

117 
c_hdwe
 
	mhd
;

121 
c_rfc1201
 
	mrfc1201
;

122 
c_rfc1051
 
	mrfc1051
;

123 
c_h_p
 
	mh_p
;

124 
c_p
 
	mp
;

125 
__u8
 
	mw
[0];

126 } 
	mso
;

	@/usr/include/linux/if_ether.h

21 #ide
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lux/tys.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_TLEN
 2

	)

33 
	#ETH_HLEN
 14

	)

34 
	#ETH_ZLEN
 60

	)

35 
	#ETH_DATA_LEN
 1500

	)

36 
	#ETH_FRAME_LEN
 1514

	)

37 
	#ETH_FCS_LEN
 4

	)

43 
	#ETH_P_LOOP
 0x0060

	)

44 
	#ETH_P_PUP
 0x0200

	)

45 
	#ETH_P_PUPAT
 0x0201

	)

46 
	#ETH_P_TSN
 0x22F0

	)

47 
	#ETH_P_IP
 0x0800

	)

48 
	#ETH_P_X25
 0x0805

	)

49 
	#ETH_P_ARP
 0x0806

	)

50 
	#ETH_P_BPQ
 0x08FF

	)

51 
	#ETH_P_IEEEPUP
 0x0a00

	)

52 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

53 
	#ETH_P_BATMAN
 0x4305

	)

54 
	#ETH_P_DEC
 0x6000

	)

55 
	#ETH_P_DNA_DL
 0x6001

	)

56 
	#ETH_P_DNA_RC
 0x6002

	)

57 
	#ETH_P_DNA_RT
 0x6003

	)

58 
	#ETH_P_LAT
 0x6004

	)

59 
	#ETH_P_DIAG
 0x6005

	)

60 
	#ETH_P_CUST
 0x6006

	)

61 
	#ETH_P_SCA
 0x6007

	)

62 
	#ETH_P_TEB
 0x6558

	)

63 
	#ETH_P_RARP
 0x8035

	)

64 
	#ETH_P_ATALK
 0x809B

	)

65 
	#ETH_P_AARP
 0x80F3

	)

66 
	#ETH_P_8021Q
 0x8100

	)

67 
	#ETH_P_IPX
 0x8137

	)

68 
	#ETH_P_IPV6
 0x86DD

	)

69 
	#ETH_P_PAUSE
 0x8808

	)

70 
	#ETH_P_SLOW
 0x8809

	)

71 
	#ETH_P_WCCP
 0x883E

	)

73 
	#ETH_P_MPLS_UC
 0x8847

	)

74 
	#ETH_P_MPLS_MC
 0x8848

	)

75 
	#ETH_P_ATMMPOA
 0x884

	)

76 
	#ETH_P_PPP_DISC
 0x8863

	)

77 
	#ETH_P_PPP_SES
 0x8864

	)

78 
	#ETH_P_LINK_CTL
 0x886

	)

79 
	#ETH_P_ATMFATE
 0x8884

	)

82 
	#ETH_P_PAE
 0x888E

	)

83 
	#ETH_P_AOE
 0x88A2

	)

84 
	#ETH_P_8021AD
 0x88A8

	)

85 
	#ETH_P_802_EX1
 0x88B5

	)

86 
	#ETH_P_TIPC
 0x88CA

	)

87 
	#ETH_P_8021AH
 0x88E7

	)

88 
	#ETH_P_MVRP
 0x88F5

	)

89 
	#ETH_P_1588
 0x88F7

	)

90 
	#ETH_P_PRP
 0x88FB

	)

91 
	#ETH_P_FCOE
 0x8906

	)

92 
	#ETH_P_TDLS
 0x890D

	)

93 
	#ETH_P_FIP
 0x8914

	)

94 
	#ETH_P_80221
 0x8917

	)

95 
	#ETH_P_LOOPBACK
 0x9000

	)

96 
	#ETH_P_QINQ1
 0x9100

	)

97 
	#ETH_P_QINQ2
 0x9200

	)

98 
	#ETH_P_QINQ3
 0x9300

	)

99 
	#ETH_P_EDSA
 0xDADA

	)

100 
	#ETH_P_AF_IUCV
 0xFBFB

	)

102 
	#ETH_P_802_3_MIN
 0x0600

	)

109 
	#ETH_P_802_3
 0x0001

	)

110 
	#ETH_P_AX25
 0x0002

	)

111 
	#ETH_P_ALL
 0x0003

	)

112 
	#ETH_P_802_2
 0x0004

	)

113 
	#ETH_P_SNAP
 0x0005

	)

114 
	#ETH_P_DDCMP
 0x0006

	)

115 
	#ETH_P_WAN_PPP
 0x0007

	)

116 
	#ETH_P_PPP_MP
 0x0008

	)

117 
	#ETH_P_LOCALTALK
 0x0009

	)

118 
	#ETH_P_CAN
 0x000C

	)

119 
	#ETH_P_CANFD
 0x000D

	)

120 
	#ETH_P_PPPTALK
 0x0010

	)

121 
	#ETH_P_TR_802_2
 0x0011

	)

122 
	#ETH_P_MOBITEX
 0x0015

	)

123 
	#ETH_P_CONTROL
 0x0016

	)

124 
	#ETH_P_IRDA
 0x0017

	)

125 
	#ETH_P_ECONET
 0x0018

	)

126 
	#ETH_P_HDLC
 0x0019

	)

127 
	#ETH_P_ARCNET
 0x001A

	)

128 
	#ETH_P_DSA
 0x001B

	)

129 
	#ETH_P_TRAILER
 0x001C

	)

130 
	#ETH_P_PHONET
 0x00F5

	)

131 
	#ETH_P_IEEE802154
 0x00F6

	)

132 
	#ETH_P_CAIF
 0x00F7

	)

133 
	#ETH_P_XDSA
 0x00F8

	)

140 #ide
__UAPI_DEF_ETHHDR


141 
	#__UAPI_DEF_ETHHDR
 1

	)

144 #i
__UAPI_DEF_ETHHDR


145 
	shhdr
 {

146 
	mh_de
[
ETH_ALEN
];

147 
	mh_sour
[
ETH_ALEN
];

148 
__be16
 
	mh_o
;

149 } 
__ibu__
((
cked
));

	@/usr/include/linux/if_packet.h

1 #ide
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<lux/tys.h
>

6 
	ssockaddr_pkt
 {

7 
	mkt_my
;

8 
	mkt_devi
[14];

9 
__be16
 
	mkt_oc
;

12 
	ssockaddr_
 {

13 
	ml_my
;

14 
__be16
 
	ml_oc
;

15 
	ml_ifdex
;

16 
	ml_hy
;

17 
	ml_pky
;

18 
	ml_h
;

19 
	ml_addr
[8];

24 
	#PACKET_HOST
 0

	)

25 
	#PACKET_BROADCAST
 1

	)

26 
	#PACKET_MULTICAST
 2

	)

27 
	#PACKET_OTHERHOST
 3

	)

28 
	#PACKET_OUTGOING
 4

	)

29 
	#PACKET_LOOPBACK
 5

	)

30 
	#PACKET_USER
 6

	)

31 
	#PACKET_KERNEL
 7

	)

33 
	#PACKET_FASTROUTE
 6

	)

37 
	#PACKET_ADD_MEMBERSHIP
 1

	)

38 
	#PACKET_DROP_MEMBERSHIP
 2

	)

39 
	#PACKET_RECV_OUTPUT
 3

	)

41 
	#PACKET_RX_RING
 5

	)

42 
	#PACKET_STATISTICS
 6

	)

43 
	#PACKET_COPY_THRESH
 7

	)

44 
	#PACKET_AUXDATA
 8

	)

45 
	#PACKET_ORIGDEV
 9

	)

46 
	#PACKET_VERSION
 10

	)

47 
	#PACKET_HDRLEN
 11

	)

48 
	#PACKET_RESERVE
 12

	)

49 
	#PACKET_TX_RING
 13

	)

50 
	#PACKET_LOSS
 14

	)

51 
	#PACKET_VNET_HDR
 15

	)

52 
	#PACKET_TX_TIMESTAMP
 16

	)

53 
	#PACKET_TIMESTAMP
 17

	)

54 
	#PACKET_FANOUT
 18

	)

55 
	#PACKET_TX_HAS_OFF
 19

	)

56 
	#PACKET_QDISC_BYPASS
 20

	)

57 
	#PACKET_ROLLOVER_STATS
 21

	)

58 
	#PACKET_FANOUT_DATA
 22

	)

60 
	#PACKET_FANOUT_HASH
 0

	)

61 
	#PACKET_FANOUT_LB
 1

	)

62 
	#PACKET_FANOUT_CPU
 2

	)

63 
	#PACKET_FANOUT_ROLLOVER
 3

	)

64 
	#PACKET_FANOUT_RND
 4

	)

65 
	#PACKET_FANOUT_QM
 5

	)

66 
	#PACKET_FANOUT_CBPF
 6

	)

67 
	#PACKET_FANOUT_EBPF
 7

	)

68 
	#PACKET_FANOUT_FLAG_ROLLOVER
 0x1000

	)

69 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

71 
	sack_s
 {

72 
	m_cks
;

73 
	m_drs
;

76 
	sack_s_v3
 {

77 
	m_cks
;

78 
	m_drs
;

79 
	m_ze_q_t
;

82 
	sack_rlov_s
 {

83 
__igd_u64
 
	m_l
;

84 
__igd_u64
 
	m_huge
;

85 
__igd_u64
 
	m_ed
;

88 
	uack_s_u
 {

89 
ack_s
 
	ms1
;

90 
ack_s_v3
 
	ms3
;

93 
	sack_auxda
 {

94 
__u32
 
	m_us
;

95 
__u32
 
	m_n
;

96 
__u32
 
	m_n
;

97 
__u16
 
	m_mac
;

98 
__u16
 
	m_t
;

99 
__u16
 
	m_vn_tci
;

100 
__u16
 
	m_vn_id
;

104 
	#TP_STATUS_KERNEL
 0

	)

105 
	#TP_STATUS_USER
 (1 << 0)

	)

106 
	#TP_STATUS_COPY
 (1 << 1)

	)

107 
	#TP_STATUS_LOSING
 (1 << 2)

	)

108 
	#TP_STATUS_CSUMNOTREADY
 (1 << 3)

	)

109 
	#TP_STATUS_VLAN_VALID
 (1 << 4

	)

110 
	#TP_STATUS_BLK_TMO
 (1 << 5)

	)

111 
	#TP_STATUS_VLAN_TPID_VALID
 (1 << 6

	)

112 
	#TP_STATUS_CSUM_VALID
 (1 << 7)

	)

115 
	#TP_STATUS_AVAILABLE
 0

	)

116 
	#TP_STATUS_SEND_REQUEST
 (1 << 0)

	)

117 
	#TP_STATUS_SENDING
 (1 << 1)

	)

118 
	#TP_STATUS_WRONG_FORMAT
 (1 << 2)

	)

121 
	#TP_STATUS_TS_SOFTWARE
 (1 << 29)

	)

122 
	#TP_STATUS_TS_SYS_HARDWARE
 (1 << 30

	)

123 
	#TP_STATUS_TS_RAW_HARDWARE
 (1 << 31)

	)

126 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

128 
	sack_hdr
 {

129 
	m_us
;

130 
	m_n
;

131 
	m_n
;

132 
	m_mac
;

133 
	m_t
;

134 
	m_c
;

135 
	m_uc
;

138 
	#TPACKET_ALIGNMENT
 16

	)

139 
	#TPACKET_ALIGN
(
x
(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

140 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
ack_hdr
)+ (
sockaddr_
))

	)

142 
	sack2_hdr
 {

143 
__u32
 
	m_us
;

144 
__u32
 
	m_n
;

145 
__u32
 
	m_n
;

146 
__u16
 
	m_mac
;

147 
__u16
 
	m_t
;

148 
__u32
 
	m_c
;

149 
__u32
 
	m_nc
;

150 
__u16
 
	m_vn_tci
;

151 
__u16
 
	m_vn_id
;

152 
__u8
 
	m_ddg
[4];

155 
	sack_hdr_v1
 {

156 
__u32
 
	m_rxhash
;

157 
__u32
 
	m_vn_tci
;

158 
__u16
 
	m_vn_id
;

159 
__u16
 
	m_ddg
;

162 
	sack3_hdr
 {

163 
__u32
 
	m_xt_offt
;

164 
__u32
 
	m_c
;

165 
__u32
 
	m_nc
;

166 
__u32
 
	m_n
;

167 
__u32
 
	m_n
;

168 
__u32
 
	m_us
;

169 
__u16
 
	m_mac
;

170 
__u16
 
	m_t
;

173 
ack_hdr_v1
 
	mhv1
;

175 
__u8
 
	m_ddg
[8];

178 
	sack_bd_ts
 {

179 
	mts_c
;

181 
	mts_uc
;

182 
	mts_nc
;

186 
	sack_hdr_v1
 {

187 
__u32
 
	mblock_us
;

188 
__u32
 
	mnum_pkts
;

189 
__u32
 
	mofft_to_f_pkt
;

194 
__u32
 
	mblk_n
;

205 
__igd_u64
 
	mq_num
;

232 
ack_bd_ts
 
	mts_f_pkt
, 
	mts_ϡ_pkt
;

235 
	uack_bd_hd_u
 {

236 
ack_hdr_v1
 
	mbh1
;

239 
	sack_block_desc
 {

240 
__u32
 
	mvsi
;

241 
__u32
 
	mofft_to_iv
;

242 
ack_bd_hd_u
 
	mhdr
;

245 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
ack2_hdr
)+ (
sockaddr_
))

	)

246 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
ack3_hdr
)+ (
sockaddr_
))

	)

248 
	eack_vsis
 {

249 
	mTPACKET_V1
,

250 
	mTPACKET_V2
,

251 
	mTPACKET_V3


267 
	sack_q
 {

268 
	m_block_size
;

269 
	m_block_
;

270 
	m_ame_size
;

271 
	m_ame_
;

274 
	sack_q3
 {

275 
	m_block_size
;

276 
	m_block_
;

277 
	m_ame_size
;

278 
	m_ame_
;

279 
	m_te_blk_tov
;

280 
	m_sizeof_iv
;

281 
	m_u_q_wd
;

284 
	uack_q_u
 {

285 
ack_q
 
	mq
;

286 
ack_q3
 
	mq3
;

289 
	sck_mq
 {

290 
	mmr_ifdex
;

291 
	mmr_ty
;

292 
	mmr_
;

293 
	mmr_addss
[8];

296 
	#PACKET_MR_MULTICAST
 0

	)

297 
	#PACKET_MR_PROMISC
 1

	)

298 
	#PACKET_MR_ALLMULTI
 2

	)

299 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/serial.h

10 #ide
_LINUX_SERIAL_H


11 
	#_LINUX_SERIAL_H


	)

13 
	~<lux/tys.h
>

15 
	~<lux/y_ags.h
>

18 
	srl_ru
 {

19 
	mty
;

20 
	mle
;

21 
	mpt
;

22 
	mq
;

23 
	mags
;

24 
	mxm_fifo_size
;

25 
	mcuom_divis
;

26 
	mbaud_ba
;

27 
	mo_day
;

28 
	mio_ty
;

29 
	mrved_ch
[1];

30 
	mhub6
;

31 
	mosg_wa
;

32 
	mosg_wa2
;

33 *
	miomem_ba
;

34 
	miomem_g_shi
;

35 
	mpt_high
;

36 
	miom_ba
;

43 
	#ASYNC_CLOSING_WAIT_INF
 0

	)

44 
	#ASYNC_CLOSING_WAIT_NONE
 65535

	)

49 
	#PORT_UNKNOWN
 0

	)

50 
	#PORT_8250
 1

	)

51 
	#PORT_16450
 2

	)

52 
	#PORT_16550
 3

	)

53 
	#PORT_16550A
 4

	)

54 
	#PORT_CIRRUS
 5

	)

55 
	#PORT_16650
 6

	)

56 
	#PORT_16650V2
 7

	)

57 
	#PORT_16750
 8

	)

58 
	#PORT_STARTECH
 9

	)

59 
	#PORT_16C950
 10

	)

60 
	#PORT_16654
 11

	)

61 
	#PORT_16850
 12

	)

62 
	#PORT_RSA
 13

	)

63 
	#PORT_MAX
 13

	)

65 
	#SERIAL_IO_PORT
 0

	)

66 
	#SERIAL_IO_HUB6
 1

	)

67 
	#SERIAL_IO_MEM
 2

	)

68 
	#SERIAL_IO_MEM32
 3

	)

69 
	#SERIAL_IO_AU
 4

	)

70 
	#SERIAL_IO_TSI
 5

	)

71 
	#SERIAL_IO_MEM32BE
 6

	)

73 
	#UART_CLEAR_FIFO
 0x01

	)

74 
	#UART_USE_FIFO
 0x02

	)

75 
	#UART_STARTECH
 0x04

	)

76 
	#UART_NATSEMI
 0x08

	)

82 
	srl_muɝt_ru
 {

83 
	mq
;

84 
	mpt1
;

85 
	mmask1
, 
	mmch1
;

86 
	mpt2
;

87 
	mmask2
, 
	mmch2
;

88 
	mpt3
;

89 
	mmask3
, 
	mmch3
;

90 
	mpt4
;

91 
	mmask4
, 
	mmch4
;

92 
	mpt_mڙ
;

93 
	mrved
[32];

100 
	srl_icou_ru
 {

101 
	ms
, 
	md
, 
	mg
, 
	mdcd
;

102 
	mrx
, 
	mtx
;

103 
	mame
, 
	movrun
, 
	mry
, 
	mbrk
;

104 
	mbuf_ovrun
;

105 
	mrved
[9];

115 
	srl_rs485
 {

116 
__u32
 
	mags
;

117 
	#SER_RS485_ENABLED
 (1 << 0

	)

118 
	#SER_RS485_RTS_ON_SEND
 (1 << 1

	)

121 
	#SER_RS485_RTS_AFTER_SEND
 (1 << 2

	)

123 
	#SER_RS485_RX_DURING_TX
 (1 << 4)

	)

124 
__u32
 
	mday_s_befe_nd
;

125 
__u32
 
	mday_s_a_nd
;

126 
__u32
 
	mddg
[5];

	@/usr/include/math.h

23 #idef 
_MATH_H


24 
	#_MATH_H
 1

	)

26 
	~<us.h
>

28 
	g__BEGIN_DECLS


31 
	~<bs/mh-ve.h
>

35 
	~<bs/huge_v.h
>

36 #ifde
__USE_ISOC99


37 
	~<bs/huge_vf.h
>

38 
	~<bs/huge_vl.h
>

41 
	~<bs/f.h
>

44 
	~<bs/n.h
>

48 
	~<bs/mhdef.h
>

55 
	#__SIMD_DECL
(
funi

	`__CONCAT
 (
__DECL_SIMD_
, funi)

	)

57 
	#__MATHCALL_VEC
(
funi
, 
suffix
, 
gs
) \

58 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funi
, 
suffix
)) \

59 
	`__MATHCALL
 (
funi
, 
suffix
, 
gs
)

	)

61 
	#__MATHDECL_VEC
(
ty
, 
funi
,
suffix
, 
gs
) \

62 
	`__SIMD_DECL
 (
	`__MATH_PRECNAME
 (
funi
, 
suffix
)) \

63 
	`__MATHDECL
(
ty
, 
funi
,
suffix
, 
gs
)

	)

65 
	#__MATHCALL
(
funi
,
suffix
, 
gs
) \

66 
	`__MATHDECL
 (
_Mdoub_
,
funi
,
suffix
, 
gs
)

	)

67 
	#__MATHDECL
(
ty
, 
funi
,
suffix
, 
gs
) \

68 
	`__MATHDECL_1
(
ty
, 
funi
,
suffix
, 
gs
); \

69 
	`__MATHDECL_1
(
ty
, 
	`__CONCAT
(
__
,
funi
),
suffix
, 
gs
)

	)

70 
	#__MATHCALLX
(
funi
,
suffix
, 
gs
, 
ib
) \

71 
	`__MATHDECLX
 (
_Mdoub_
,
funi
,
suffix
, 
gs
, 
ib
)

	)

72 
	#__MATHDECLX
(
ty
, 
funi
,
suffix
, 
gs
, 
ib
) \

73 
	`__MATHDECL_1
(
ty
, 
funi
,
suffix
, 
gs

	`__ibu__
 (
ib
); \

74 
	`__MATHDECL_1
(
ty
, 
	`__CONCAT
(
__
,
funi
),
suffix
, 
gs

	`__ibu__
 (
ib
)

	)

75 
	#__MATHDECL_1
(
ty
, 
funi
,
suffix
, 
gs
) \

76 
ty
 
	`__MATH_PRECNAME
(
funi
,
suffix

gs
 
__THROW


	)

78 
	#_Mdoub_
 

	)

79 
	#__MATH_PRECNAME
(
me
,
r

	`__CONCAT
ame,r)

	)

80 
	#__MATH_DECLARING_DOUBLE
 1

	)

81 
	#_Mdoub_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

82 
	#_Mdoub_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

83 
	~<bs/mhs.h
>

84 #unde
_Mdoub_


85 #unde
_Mdoub_BEGIN_NAMESPACE


86 #unde
_Mdoub_END_NAMESPACE


87 #unde
__MATH_PRECNAME


88 #unde
__MATH_DECLARING_DOUBLE


90 #ifde
__USE_ISOC99


96 #ide
_Mt_


97 
	#_Mt_
 

	)

99 
	#_Mdoub_
 
_Mt_


	)

100 
	#__MATH_PRECNAME
(
me
,
r
me##
f
##
	)
r

101 
	#__MATH_DECLARING_DOUBLE
 0

	)

102 
	#_Mdoub_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

103 
	#_Mdoub_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

104 
	~<bs/mhs.h
>

105 #unde
_Mdoub_


106 #unde
_Mdoub_BEGIN_NAMESPACE


107 #unde
_Mdoub_END_NAMESPACE


108 #unde
__MATH_PRECNAME


109 #unde
__MATH_DECLARING_DOUBLE


111 #i!(
defed
 
__NO_LONG_DOUBLE_MATH
 && defed 
_LIBC
) \

112 || 
defed
 
__LDBL_COMPAT
 \

113 || 
defed
 
_LIBC_TEST


114 #ifde
__LDBL_COMPAT


116 #ifde
__USE_ISOC99


117 
	$__dbl_xowdf
 (
__x
, 
__y
)

118 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

119 #ifde
__REDIRECT_NTH


120 
	`__REDIRECT_NTH
 (
xowdf
, (
__x
, 
__y
),

121 
__dbl_xowdf
)

122 
	`__ibu__
 ((
__cڡ__
));

123 
	`__REDIRECT_NTH
 (
xowd
, (
__x
, 
__y
),

124 
x

	`__ibu__
 ((
__cڡ__
));

125 
	`__REDIRECT_NTH
 (
xowdl
,

126 (
__x
, 
__y
),

127 
x

	`__ibu__
 ((
__cڡ__
));

131 #unde
__MATHDECL_1


132 
	#__MATHDECL_2
(
ty
, 
funi
,
suffix
, 
gs
, 
s
) \

133 
ty
 
	`__REDIRECT_NTH
(
	`__MATH_PRECNAME
(
funi
,
suffix
), \

134 
gs
, 
s
)

	)

135 
	#__MATHDECL_1
(
ty
, 
funi
,
suffix
, 
gs
) \

136 
	`__MATHDECL_2
(
ty
, 
funi
,
suffix
, 
gs
, 
	`__CONCAT
(funi,suffix))

	)

142 #ide
_Mlg_doub_


143 
	#_Mlg_doub_
 

	)

145 
	#_Mdoub_
 
_Mlg_doub_


	)

146 
	#__MATH_PRECNAME
(
me
,
r
me##
l
##
	)
r

147 
	#__MATH_DECLARING_DOUBLE
 0

	)

148 
	#_Mdoub_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

149 
	#_Mdoub_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

150 
	#__MATH_DECLARE_LDOUBLE
 1

	)

151 
	~<bs/mhs.h
>

152 #unde
_Mdoub_


153 #unde
_Mdoub_BEGIN_NAMESPACE


154 #unde
_Mdoub_END_NAMESPACE


155 #unde
__MATH_PRECNAME


156 #unde
__MATH_DECLARING_DOUBLE


161 #unde
__MATHDECL_1


162 #unde
__MATHDECL


163 #unde
__MATHCALL


166 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


168 
signgam
;

173 #ifde
__USE_ISOC99


211 
FP_NAN
 =

212 
	#FP_NAN
 0

	)

213 
FP_NAN
,

214 
FP_INFINITE
 =

215 
	#FP_INFINITE
 1

	)

216 
FP_INFINITE
,

217 
FP_ZERO
 =

218 
	#FP_ZERO
 2

	)

219 
FP_ZERO
,

220 
FP_SUBNORMAL
 =

221 
	#FP_SUBNORMAL
 3

	)

222 
FP_SUBNORMAL
,

223 
FP_NORMAL
 =

224 
	#FP_NORMAL
 4

	)

225 
FP_NORMAL


233 #i
	`__GNUC_PREREQ
 (4,4&& !
defed
 
__SUPPORT_SNAN__
 \

234 && !
defed
 
__OPTIMIZE_SIZE__


235 
	#assify
(
x

	`__but_assify
 (
FP_NAN
, 
FP_INFINITE
, \

236 
FP_NORMAL
, 
FP_SUBNORMAL
, 
FP_ZERO
, 
x
)

	)

237 #i
defed
 
__NO_LONG_DOUBLE_MATH


238 
	#assify
(
x
) \

239 ( (
x
= (? 
	`__assifyf
 (x: 
	`__assify
 (x))

	)

241 
	#assify
(
x
) \

242 ( (
x
) ==  () \

243 ? 
	`__assifyf
 (
x
) \

244 :  (
x
) ==  () \

245 ? 
	`__assify
 (
x
: 
	`__assifyl
 (x))

	)

249 #i
	`__GNUC_PREREQ
 (4,0)

250 
	#signb
(
x
) \

251 ( (
x
) ==  () \

252 ? 
	`__but_signbf
 (
x
) \

253 :  (
x
) ==  () \

254 ? 
	`__but_signb
 (
x
: 
	`__but_signbl
 (x))

	)

256 #ifde
__NO_LONG_DOUBLE_MATH


257 
	#signb
(
x
) \

258 ( (
x
= (? 
	`__signbf
 (x: 
	`__signb
 (x))

	)

260 
	#signb
(
x
) \

261 ( (
x
) ==  () \

262 ? 
	`__signbf
 (
x
) \

263 :  (
x
) ==  () \

264 ? 
	`__signb
 (
x
: 
	`__signbl
 (x))

	)

269 #i
	`__GNUC_PREREQ
 (4,4&& !
defed
 
__SUPPORT_SNAN__


270 
	#isfe
(
x

	`__but_isfe
 (x)

	)

271 #i
defed
 
__NO_LONG_DOUBLE_MATH


272 
	#isfe
(
x
) \

273 ( (
x
= (? 
	`__fef
 (x: 
	`__fe
 (x))

	)

275 
	#isfe
(
x
) \

276 ( (
x
) ==  () \

277 ? 
	`__fef
 (
x
) \

278 :  (
x
) ==  () \

279 ? 
	`__fe
 (
x
: 
	`__f
 (x))

	)

283 #i
	`__GNUC_PREREQ
 (4,4&& !
defed
 
__SUPPORT_SNAN__


284 
	#im
(
x

	`__but_im
 (x)

	)

286 
	#im
(
x
(
	`assify
 (x=
FP_NORMAL
)

	)

291 #i
	`__GNUC_PREREQ
 (4,4&& !
defed
 
__SUPPORT_SNAN__


292 
	#i
(
x

	`__but_i
 (x)

	)

293 #i
defed
 
__NO_LONG_DOUBLE_MATH


294 
	#i
(
x
) \

295 ( (
x
= (? 
	`__if
 (x: 
	`__i
 (x))

	)

297 
	#i
(
x
) \

298 ( (
x
) ==  () \

299 ? 
	`__if
 (
x
) \

300 :  (
x
) ==  () \

301 ? 
	`__i
 (
x
: 
	`__il
 (x))

	)

305 #i
	`__GNUC_PREREQ
 (4,4&& !
defed
 
__SUPPORT_SNAN__


306 
	#isf
(
x

	`__but_isf_sign
 (x)

	)

307 #i
defed
 
__NO_LONG_DOUBLE_MATH


308 
	#isf
(
x
) \

309 ( (
x
= (? 
	`__isff
 (x: 
	`__isf
 (x))

	)

311 
	#isf
(
x
) \

312 ( (
x
) ==  () \

313 ? 
	`__isff
 (
x
) \

314 :  (
x
) ==  () \

315 ? 
	`__isf
 (
x
: 
	`__is
 (x))

	)

319 
	#MATH_ERRNO
 1

	)

320 
	#MATH_ERREXCEPT
 2

	)

325 #ide
__FAST_MATH__


326 
	#mh_rhdlg
 (
MATH_ERRNO
 | 
MATH_ERREXCEPT
)

	)

331 #ifde
__USE_GNU


333 #ifde
__NO_LONG_DOUBLE_MATH


334 
	#issiglg
(
x
) \

335 ( (
x
= (? 
	`__issiglgf
 (x: 
	`__issiglg
 (x))

	)

337 
	#issiglg
(
x
) \

338 ( (
x
) ==  () \

339 ? 
	`__issiglgf
 (
x
) \

340 :  (
x
) ==  () \

341 ? 
	`__issiglg
 (
x
: 
	`__issiglgl
 (x))

	)

345 #ifdef 
__USE_MISC


349 
_IEEE_
 = -1,

350 
_SVID_
,

351 
_XOPEN_
,

352 
_POSIX_
,

353 
_ISOC_


354 } 
	t_LIB_VERSION_TYPE
;

359 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

363 #ifde
__USE_MISC


369 #ifde
__lulus


370 
__exi


372 
exi


375 
ty
;

376 *
me
;

377 
g1
;

378 
g2
;

379 
tv
;

380 
	}
};

382 #ifde
__lulus


383 
	$mhr
 (
__exi
 *
__exc

	`throw
 ();

385 
	`mhr
 (
exi
 *
__exc
);

388 
	#X_TLOSS
 1.41484755040568800000e+16

	)

391 
	#DOMAIN
 1

	)

392 
	#SING
 2

	)

393 
	#OVERFLOW
 3

	)

394 
	#UNDERFLOW
 4

	)

395 
	#TLOSS
 5

	)

396 
	#PLOSS
 6

	)

399 
	#HUGE
 3.40282347e+38F

	)

403 #ifde
__USE_XOPEN


405 
	#MAXFLOAT
 3.40282347e+38F

	)

412 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


413 
	#M_E
 2.7182818284590452354

	)

414 
	#M_LOG2E
 1.4426950408889634074

	)

415 
	#M_LOG10E
 0.43429448190325182765

	)

416 
	#M_LN2
 0.69314718055994530942

	)

417 
	#M_LN10
 2.30258509299404568402

	)

418 
	#M_PI
 3.14159265358979323846

	)

419 
	#M_PI_2
 1.57079632679489661923

	)

420 
	#M_PI_4
 0.78539816339744830962

	)

421 
	#M_1_PI
 0.31830988618379067154

	)

422 
	#M_2_PI
 0.63661977236758134308

	)

423 
	#M_2_SQRTPI
 1.12837916709551257390

	)

424 
	#M_SQRT2
 1.41421356237309504880

	)

425 
	#M_SQRT1_2
 0.70710678118654752440

	)

431 #ifde
__USE_GNU


432 
	#M_El
 2.718281828459045235360287471352662498L

	)

433 
	#M_LOG2El
 1.442695040888963407359924681001892137L

	)

434 
	#M_LOG10El
 0.434294481903251827651128918916605082L

	)

435 
	#M_LN2l
 0.693147180559945309417232121458176568L

	)

436 
	#M_LN10l
 2.302585092994045684017991454684364208L

	)

437 
	#M_PIl
 3.141592653589793238462643383279502884L

	)

438 
	#M_PI_2l
 1.570796326794896619231321691639751442L

	)

439 
	#M_PI_4l
 0.785398163397448309615660845819875721L

	)

440 
	#M_1_PIl
 0.318309886183790671537767526745028724L

	)

441 
	#M_2_PIl
 0.636619772367581343075535053490057448L

	)

442 
	#M_2_SQRTPIl
 1.128379167095512573896158903121545172L

	)

443 
	#M_SQRT2l
 1.414213562373095048801688724209698079L

	)

444 
	#M_SQRT1_2l
 0.707106781186547524400844362104849039L

	)

451 #i
defed
 
__STRICT_ANSI__
 && !defed 
__NO_MATH_INLINES


452 
	#__NO_MATH_INLINES
 1

	)

455 #i
defed
 
__USE_ISOC99
 && 
	`__GNUC_PREREQ
(2,97)

462 
	#isg
(
x
, 
y

	`__but_isg
(x, y)

	)

463 
	#isgequ
(
x
, 
y

	`__but_isgequ
(x, y)

	)

464 
	#iess
(
x
, 
y

	`__but_iess
(x, y)

	)

465 
	#iesqu
(
x
, 
y

	`__but_iesqu
(x, y)

	)

466 
	#iessg
(
x
, 
y

	`__but_iessg
(x, y)

	)

467 
	#isunded
(
u
, 
v

	`__but_isunded
(u, v)

	)

471 #ifde
__USE_EXTERN_INLINES


472 
	~<bs/mhle.h
>

477 #i
defed
 
__FINITE_MATH_ONLY__
 && __FINITE_MATH_ONLY__ > 0

478 
	~<bs/mh-fe.h
>

481 #ifde
__USE_ISOC99


485 #ide
isg


486 
	#isg
(
x
, 
y
) \

487 (
__exnsi__
 \

488 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

489 !
	`isunded
 (
__x
, 
__y
&& __x > __y; 
	}
}))

	)

493 #ide
isgequ


494 
	#isgequ
(
x
, 
y
) \

495 (
__exnsi__
 \

496 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

497 !
	`isunded
 (
__x
, 
__y
&& __x >__y; }))

	)

501 #ide
iess


502 
	#iess
(
x
, 
y
) \

503 (
__exnsi__
 \

504 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

505 !
	`isunded
 (
__x
, 
__y
&& __x < __y; }))

	)

509 #ide
iesqu


510 
	#iesqu
(
x
, 
y
) \

511 (
__exnsi__
 \

512 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

513 !
	`isunded
 (
__x
, 
__y
&& __x <__y; }))

	)

517 #ide
iessg


518 
	#iessg
(
x
, 
y
) \

519 (
__exnsi__
 \

520 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

521 !
	`isunded
 (
__x
, 
__y
&& (__x < __y || __y < __x); }))

	)

525 #ide
isunded


526 
	#isunded
(
u
, 
v
) \

527 (
__exnsi__
 \

528 ({ 
	`__tyof__
(
u

__u
 = (u); __tyof__(
v

__v
 = (v); \

529 
	`assify
 (
__u
=
FP_NAN
 || fpassify (
__v
=FP_NAN; }))

	)

534 
	g__END_DECLS


	@/usr/include/memory.h

22 #idef 
_MEMORY_H


23 
	#_MEMORY_H
 1

	)

25 
	~<us.h
>

28 #idef 
_STRING_H


29 
	~<rg.h
>

	@/usr/include/net/ethernet.h

21 #ide
__NET_ETHERNET_H


22 
	#__NET_ETHERNET_H
 1

	)

24 
	~<sys/cdefs.h
>

25 
	~<sys/tys.h
>

26 
	~<lux/if_h.h
>

28 
__BEGIN_DECLS


32 
	sh_addr


34 
u_t8_t
 
	mh_addr_o
[
ETH_ALEN
];

35 } 
__ibu__
 ((
__cked__
));

38 
	sh_hd


40 
u_t8_t
 
	mh_dho
[
ETH_ALEN
];

41 
u_t8_t
 
	mh_sho
[
ETH_ALEN
];

42 
u_t16_t
 
	mh_ty
;

43 } 
__ibu__
 ((
__cked__
));

46 
	#ETHERTYPE_PUP
 0x0200

	)

47 
	#ETHERTYPE_SPRITE
 0x0500

	)

48 
	#ETHERTYPE_IP
 0x0800

	)

49 
	#ETHERTYPE_ARP
 0x0806

	)

50 
	#ETHERTYPE_REVARP
 0x8035

	)

51 
	#ETHERTYPE_AT
 0x809B

	)

52 
	#ETHERTYPE_AARP
 0x80F3

	)

53 
	#ETHERTYPE_VLAN
 0x8100

	)

54 
	#ETHERTYPE_IPX
 0x8137

	)

55 
	#ETHERTYPE_IPV6
 0x86dd

	)

56 
	#ETHERTYPE_LOOPBACK
 0x9000

	)

59 
	#ETHER_ADDR_LEN
 
ETH_ALEN


	)

60 
	#ETHER_TYPE_LEN
 2

	)

61 
	#ETHER_CRC_LEN
 4

	)

62 
	#ETHER_HDR_LEN
 
ETH_HLEN


	)

63 
	#ETHER_MIN_LEN
 (
ETH_ZLEN
 + 
ETHER_CRC_LEN


	)

64 
	#ETHER_MAX_LEN
 (
ETH_FRAME_LEN
 + 
ETHER_CRC_LEN


	)

67 
	#ETHER_IS_VALID_LEN
(
foo
) \

68 ((
foo
>
ETHER_MIN_LEN
 && (foo<
ETHER_MAX_LEN
)

	)

75 
	#ETHERTYPE_TRAIL
 0x1000

	)

76 
	#ETHERTYPE_NTRAILER
 16

	)

78 
	#ETHERMTU
 
ETH_DATA_LEN


	)

79 
	#ETHERMIN
 (
ETHER_MIN_LEN
 - 
ETHER_HDR_LEN
 - 
ETHER_CRC_LEN
)

	)

81 
	g__END_DECLS


	@/usr/include/net/if.h

19 #ide
_NET_IF_H


20 
	#_NET_IF_H
 1

	)

22 
	~<us.h
>

24 #ifde
__USE_MISC


25 
	~<sys/tys.h
>

26 
	~<sys/sock.h
>

31 
	#IF_NAMESIZE
 16

	)

33 
	sif_medex


35 
	mif_dex
;

36 *
	mif_me
;

40 #ifde
__USE_MISC


44 
	mIFF_UP
 = 0x1,

45 
	#IFF_UP
 
IFF_UP


	)

46 
	mIFF_BROADCAST
 = 0x2,

47 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

48 
	mIFF_DEBUG
 = 0x4,

49 
	#IFF_DEBUG
 
IFF_DEBUG


	)

50 
	mIFF_LOOPBACK
 = 0x8,

51 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

52 
	mIFF_POINTOPOINT
 = 0x10,

53 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

54 
	mIFF_NOTRAILERS
 = 0x20,

55 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

56 
	mIFF_RUNNING
 = 0x40,

57 
	#IFF_RUNNING
 
IFF_RUNNING


	)

58 
	mIFF_NOARP
 = 0x80,

59 
	#IFF_NOARP
 
IFF_NOARP


	)

60 
	mIFF_PROMISC
 = 0x100,

61 
	#IFF_PROMISC
 
IFF_PROMISC


	)

64 
	mIFF_ALLMULTI
 = 0x200,

65 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

67 
	mIFF_MASTER
 = 0x400,

68 
	#IFF_MASTER
 
IFF_MASTER


	)

69 
	mIFF_SLAVE
 = 0x800,

70 
	#IFF_SLAVE
 
IFF_SLAVE


	)

72 
	mIFF_MULTICAST
 = 0x1000,

73 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

75 
	mIFF_PORTSEL
 = 0x2000,

76 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

77 
	mIFF_AUTOMEDIA
 = 0x4000,

78 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

79 
	mIFF_DYNAMIC
 = 0x8000

80 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

88 
	siddr


90 
sockaddr
 
	mi_addr
;

93 
sockaddr
 
	mifu_brdaddr
;

94 
sockaddr
 
	mifu_daddr
;

95 } 
	mi_ifu
;

96 
i
 *
	mi_i
;

97 
iddr
 *
	mi_xt
;

100 
	#i_brdaddr
 
i_ifu
.
ifu_brdaddr


	)

101 
	#i_daddr
 
i_ifu
.
ifu_daddr


	)

111 
	sifm


113 
	mmem_t
;

114 
	mmem_d
;

115 
	mba_addr
;

116 
	mq
;

117 
	mdma
;

118 
	mpt
;

126 
	sieq


128 
	#IFHWADDRLEN
 6

	)

129 
	#IFNAMSIZ
 
IF_NAMESIZE


	)

132 
	min_me
[
IFNAMSIZ
];

133 } 
	mi_in
;

137 
sockaddr
 
	miu_addr
;

138 
sockaddr
 
	miu_daddr
;

139 
sockaddr
 
	miu_brdaddr
;

140 
sockaddr
 
	miu_tmask
;

141 
sockaddr
 
	miu_hwaddr
;

142 
	miu_ags
;

143 
	miu_ivue
;

144 
	miu_mtu
;

145 
ifm
 
	miu_m
;

146 
	miu_ave
[
IFNAMSIZ
];

147 
	miu_wme
[
IFNAMSIZ
];

148 
__ddr_t
 
	miu_da
;

149 } 
	mi_iu
;

151 
	#i_me
 
i_in
.
in_me


	)

152 
	#i_hwaddr
 
i_iu
.
iu_hwaddr


	)

153 
	#i_addr
 
i_iu
.
iu_addr


	)

154 
	#i_daddr
 
i_iu
.
iu_daddr


	)

155 
	#i_brdaddr
 
i_iu
.
iu_brdaddr


	)

156 
	#i_tmask
 
i_iu
.
iu_tmask


	)

157 
	#i_ags
 
i_iu
.
iu_ags


	)

158 
	#i_mric
 
i_iu
.
iu_ivue


	)

159 
	#i_mtu
 
i_iu
.
iu_mtu


	)

160 
	#i_m
 
i_iu
.
iu_m


	)

161 
	#i_ave
 
i_iu
.
iu_ave


	)

162 
	#i_da
 
i_iu
.
iu_da


	)

163 
	#i_ifdex
 
i_iu
.
iu_ivue


	)

164 
	#i_bdwidth
 
i_iu
.
iu_ivue


	)

165 
	#i_qn
 
i_iu
.
iu_ivue


	)

166 
	#i_wme
 
i_iu
.
iu_wme


	)

167 
	#_IOT_ieq
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),16,0,0)

	)

168 
	#_IOT_ieq_sht
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

169 
	#_IOT_ieq_t
 
	`_IOT
(
	`_IOTS
(),
IFNAMSIZ
,_IOTS(),1,0,0)

	)

176 
	sifcf


178 
	mifc_n
;

181 
__ddr_t
 
	mifcu_buf
;

182 
ieq
 *
	mifcu_q
;

183 } 
	mifc_ifcu
;

185 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

186 
	#ifc_q
 
ifc_ifcu
.
ifcu_q


	)

187 
	#_IOT_ifcf
 
	`_IOT
(
	`_IOTS
(
ifcf
),1,0,0,0,0

	)

190 
__BEGIN_DECLS


193 
	$if_modex
 (cڡ *
__iame

__THROW
;

194 *
	$if_dextame
 (
__ifdex
, *
__iame

__THROW
;

197 
if_medex
 *
	$if_medex
 (
__THROW
;

200 
	$if_medex
 (
if_medex
 *
__r

__THROW
;

202 
__END_DECLS


	@/usr/include/net/if_arp.h

22 #ide
_NET_IF_ARP_H


24 
	#_NET_IF_ARP_H
 1

	)

25 
	~<sys/cdefs.h
>

27 
	~<sys/tys.h
>

28 
	~<sys/sock.h
>

30 
	g__BEGIN_DECLS


33 
	#MAX_ADDR_LEN
 7

	)

39 
	#ARPOP_REQUEST
 1

	)

40 
	#ARPOP_REPLY
 2

	)

41 
	#ARPOP_RREQUEST
 3

	)

42 
	#ARPOP_RREPLY
 4

	)

43 
	#ARPOP_InREQUEST
 8

	)

44 
	#ARPOP_InREPLY
 9

	)

45 
	#ARPOP_NAK
 10

	)

54 
	sphdr


56 
	m_hrd
;

57 
	m_o
;

58 
	m_h
;

59 
	m_n
;

60 
	m_
;

64 
	m___sha
[
ETH_ALEN
];

65 
	m___s
[4];

66 
	m___tha
[
ETH_ALEN
];

67 
	m___t
[4];

73 
	#ARPHRD_NETROM
 0

	)

74 
	#ARPHRD_ETHER
 1

	)

75 
	#ARPHRD_EETHER
 2

	)

76 
	#ARPHRD_AX25
 3

	)

77 
	#ARPHRD_PRONET
 4

	)

78 
	#ARPHRD_CHAOS
 5

	)

79 
	#ARPHRD_IEEE802
 6

	)

80 
	#ARPHRD_ARCNET
 7

	)

81 
	#ARPHRD_APPLETLK
 8

	)

82 
	#ARPHRD_DLCI
 15

	)

83 
	#ARPHRD_ATM
 19

	)

84 
	#ARPHRD_METRICOM
 23

	)

85 
	#ARPHRD_IEEE1394
 24

	)

86 
	#ARPHRD_EUI64
 27

	)

87 
	#ARPHRD_INFINIBAND
 32

	)

90 
	#ARPHRD_SLIP
 256

	)

91 
	#ARPHRD_CSLIP
 257

	)

92 
	#ARPHRD_SLIP6
 258

	)

93 
	#ARPHRD_CSLIP6
 259

	)

94 
	#ARPHRD_RSRVD
 260

	)

95 
	#ARPHRD_ADAPT
 264

	)

96 
	#ARPHRD_ROSE
 270

	)

97 
	#ARPHRD_X25
 271

	)

98 
	#ARPHRD_HWX25
 272

	)

99 
	#ARPHRD_PPP
 512

	)

100 
	#ARPHRD_CISCO
 513

	)

101 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

102 
	#ARPHRD_LAPB
 516

	)

103 
	#ARPHRD_DDCMP
 517

	)

104 
	#ARPHRD_RAWHDLC
 518

	)

106 
	#ARPHRD_TUNNEL
 768

	)

107 
	#ARPHRD_TUNNEL6
 769

	)

108 
	#ARPHRD_FRAD
 770

	)

109 
	#ARPHRD_SKIP
 771

	)

110 
	#ARPHRD_LOOPBACK
 772

	)

111 
	#ARPHRD_LOCALTLK
 773

	)

112 
	#ARPHRD_FDDI
 774

	)

113 
	#ARPHRD_BIF
 775

	)

114 
	#ARPHRD_SIT
 776

	)

115 
	#ARPHRD_IPDDP
 777

	)

116 
	#ARPHRD_IPGRE
 778

	)

117 
	#ARPHRD_PIMREG
 779

	)

118 
	#ARPHRD_HIPPI
 780

	)

119 
	#ARPHRD_ASH
 781

	)

120 
	#ARPHRD_ECONET
 782

	)

121 
	#ARPHRD_IRDA
 783

	)

122 
	#ARPHRD_FCPP
 784

	)

123 
	#ARPHRD_FCAL
 785

	)

124 
	#ARPHRD_FCPL
 786

	)

125 
	#ARPHRD_FCFABRIC
 787

	)

126 
	#ARPHRD_IEEE802_TR
 800

	)

127 
	#ARPHRD_IEEE80211
 801

	)

128 
	#ARPHRD_IEEE80211_PRISM
 802

	)

129 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

130 
	#ARPHRD_IEEE802154
 804

	)

131 
	#ARPHRD_IEEE802154_PHY
 805

	)

133 
	#ARPHRD_VOID
 0xFFFF

	)

134 
	#ARPHRD_NONE
 0xFFFE

	)

138 
	seq


140 
sockaddr
 
	mp_
;

141 
sockaddr
 
	mp_ha
;

142 
	mp_ags
;

143 
sockaddr
 
	mp_tmask
;

144 
	mp_dev
[16];

147 
	seq_d


149 
sockaddr
 
	mp_
;

150 
sockaddr
 
	mp_ha
;

151 
	mp_ags
;

152 
sockaddr
 
	mp_tmask
;

156 
	#ATF_COM
 0x02

	)

157 
	#ATF_PERM
 0x04

	)

158 
	#ATF_PUBL
 0x08

	)

159 
	#ATF_USETRAILERS
 0x10

	)

160 
	#ATF_NETMASK
 0x20

	)

162 
	#ATF_DONTPUB
 0x40

	)

163 
	#ATF_MAGIC
 0x80

	)

167 
	#ARPD_UPDATE
 0x01

	)

168 
	#ARPD_LOOKUP
 0x02

	)

169 
	#ARPD_FLUSH
 0x03

	)

171 
	spd_que


173 
	mq
;

174 
u_t32_t
 
	m
;

175 
	mdev
;

176 
	mamp
;

177 
	mupded
;

178 
	mha
[
MAX_ADDR_LEN
];

181 
	g__END_DECLS


	@/usr/include/net/route.h

20 #ide
_NET_ROUTE_H


21 
	#_NET_ROUTE_H
 1

	)

23 
	~<us.h
>

24 
	~<sys/sock.h
>

25 
	~<sys/tys.h
>

26 
	~<t/.h
>

27 
	~<bs/wdsize.h
>

31 
	sy


33 
	m_d1
;

34 
sockaddr
 
	m_d
;

35 
sockaddr
 
	m_geway
;

36 
sockaddr
 
	m_gmask
;

37 
	m_ags
;

38 
	m_d2
;

39 
	m_d3
;

40 
	m_tos
;

41 
	m_ass
;

42 #i
__WORDSIZE
 == 64

43 
	m_d4
[3];

45 
	m_d4
;

47 
	m_mric
;

48 *
	m_dev
;

49 
	m_mtu
;

50 
	m_wdow
;

51 
	m_
;

54 
	#_mss
 
_mtu


	)

57 
	s6_msg


59 
6_addr
 
	mmsg_d
;

60 
6_addr
 
	mmsg_c
;

61 
6_addr
 
	mmsg_geway
;

62 
u_t32_t
 
	mmsg_ty
;

63 
u_t16_t
 
	mmsg_d_n
;

64 
u_t16_t
 
	mmsg_c_n
;

65 
u_t32_t
 
	mmsg_mric
;

66 
	mmsg_fo
;

67 
u_t32_t
 
	mmsg_ags
;

68 
	mmsg_ifdex
;

72 
	#RTF_UP
 0x0001

	)

73 
	#RTF_GATEWAY
 0x0002

	)

75 
	#RTF_HOST
 0x0004

	)

76 
	#RTF_REINSTATE
 0x0008

	)

77 
	#RTF_DYNAMIC
 0x0010

	)

78 
	#RTF_MODIFIED
 0x0020

	)

79 
	#RTF_MTU
 0x0040

	)

80 
	#RTF_MSS
 
RTF_MTU


	)

81 
	#RTF_WINDOW
 0x0080

	)

82 
	#RTF_IRTT
 0x0100

	)

83 
	#RTF_REJECT
 0x0200

	)

84 
	#RTF_STATIC
 0x0400

	)

85 
	#RTF_XRESOLVE
 0x0800

	)

86 
	#RTF_NOFORWARD
 0x1000

	)

87 
	#RTF_THROW
 0x2000

	)

88 
	#RTF_NOPMTUDISC
 0x4000

	)

91 
	#RTF_DEFAULT
 0x00010000

	)

92 
	#RTF_ALLONLINK
 0x00020000

	)

93 
	#RTF_ADDRCONF
 0x00040000

	)

95 
	#RTF_LINKRT
 0x00100000

	)

96 
	#RTF_NONEXTHOP
 0x00200000

	)

98 
	#RTF_CACHE
 0x01000000

	)

99 
	#RTF_FLOW
 0x02000000

	)

100 
	#RTF_POLICY
 0x04000000

	)

102 
	#RTCF_VALVE
 0x00200000

	)

103 
	#RTCF_MASQ
 0x00400000

	)

104 
	#RTCF_NAT
 0x00800000

	)

105 
	#RTCF_DOREDIRECT
 0x01000000

	)

106 
	#RTCF_LOG
 0x02000000

	)

107 
	#RTCF_DIRECTSRC
 0x04000000

	)

109 
	#RTF_LOCAL
 0x80000000

	)

110 
	#RTF_INTERFACE
 0x40000000

	)

111 
	#RTF_MULTICAST
 0x20000000

	)

112 
	#RTF_BROADCAST
 0x10000000

	)

113 
	#RTF_NAT
 0x08000000

	)

115 
	#RTF_ADDRCLASSMASK
 0xF8000000

	)

116 
	#RT_ADDRCLASS
(
ags
((
__u_t32_t
ag>> 23)

	)

118 
	#RT_TOS
(
tos
(os& 
IPTOS_TOS_MASK
)

	)

120 
	#RT_LOCALADDR
(
ags
((ag& 
RTF_ADDRCLASSMASK
) \

121 =(
RTF_LOCAL
|
RTF_INTERFACE
))

	)

123 
	#RT_CLASS_UNSPEC
 0

	)

124 
	#RT_CLASS_DEFAULT
 253

	)

126 
	#RT_CLASS_MAIN
 254

	)

127 
	#RT_CLASS_LOCAL
 255

	)

128 
	#RT_CLASS_MAX
 255

	)

131 
	#RTMSG_ACK
 
NLMSG_ACK


	)

132 
	#RTMSG_OVERRUN
 
NLMSG_OVERRUN


	)

134 
	#RTMSG_NEWDEVICE
 0x11

	)

135 
	#RTMSG_DELDEVICE
 0x12

	)

136 
	#RTMSG_NEWROUTE
 0x21

	)

137 
	#RTMSG_DELROUTE
 0x22

	)

138 
	#RTMSG_NEWRULE
 0x31

	)

139 
	#RTMSG_DELRULE
 0x32

	)

140 
	#RTMSG_CONTROL
 0x40

	)

142 
	#RTMSG_AR_FAILED
 0x51

	)

	@/usr/include/netdb.h

22 #idef 
_NETDB_H


23 
	#_NETDB_H
 1

	)

25 
	~<us.h
>

27 
	~<t/.h
>

28 
	~<dt.h
>

29 #ifde
__USE_MISC


32 
	~<c/tdb.h
>

35 #ifde
__USE_GNU


36 
	#__ed_sigevt_t


	)

37 
	~<bs/sigfo.h
>

38 
	#__ed_timeec


	)

39 
	~<time.h
>

42 
	~<bs/tdb.h
>

45 
	#_PATH_HEQUIV
 "/c/hos.equiv"

	)

46 
	#_PATH_HOSTS
 "/c/hos"

	)

47 
	#_PATH_NETWORKS
 "/c/twks"

	)

48 
	#_PATH_NSSWITCH_CONF
 "/c/nsswch.cf"

	)

49 
	#_PATH_PROTOCOLS
 "/c/ocs"

	)

50 
	#_PATH_SERVICES
 "/c/rvis"

	)

53 
	g__BEGIN_DECLS


55 #i
defed
 
__USE_MISC
 || !defed 
__USE_XOPEN2K8


58 
	#h_o
 (*
	`__h_o_loti
 ())

	)

61 *
	$__h_o_loti
 (
__THROW
 
	`__ibu__
 ((
__cڡ__
));

65 
	#HOST_NOT_FOUND
 1

	)

66 
	#TRY_AGAIN
 2

	)

68 
	#NO_RECOVERY
 3

	)

70 
	#NO_DATA
 4

	)

73 #ifde
__USE_MISC


74 
	#NETDB_INTERNAL
 -1

	)

75 
	#NETDB_SUCCESS
 0

	)

76 
	#NO_ADDRESS
 
NO_DATA


	)

79 #i
defed
 
__USE_XOPEN2K
 || defed 
__USE_XOPEN_EXTENDED


81 
	#IPPORT_RESERVED
 1024

	)

84 #ifde
__USE_GNU


86 
	#SCOPE_DELIMITER
 '%'

	)

89 #ifde
__USE_MISC


92 
	$hr
 (cڡ *
__r

__THROW
;

95 cڡ *
	$h
 (
__r_num

__THROW
;

100 
	shot


102 *
h_me
;

103 **
h_s
;

104 
h_addy
;

105 
h_ngth
;

106 **
h_addr_li
;

107 #ifde
__USE_MISC


108 
	#h_addr
 
h_addr_li
[0]

	)

117 
	`thot
 (
__ay_ݒ
);

123 
	`dhot
 ();

130 
hot
 *
	`ghot
 ();

137 
hot
 *
	`ghobyaddr
 (cڡ *
__addr
, 
__sockn_t
 
__n
,

138 
__ty
);

144 
hot
 *
	`ghobyme
 (cڡ *
__me
);

146 #ifde
__USE_MISC


155 
hot
 *
	`ghobyme2
 (cڡ *
__me
, 
__af
);

167 
	`ghot_r
 (
hot
 *
__ri
 
__su_buf
,

168 *
__ri
 
__buf
, 
size_t
 
__bu
,

169 
hot
 **
__ri
 
__su
,

170 *
__ri
 
__h_
);

172 
	`ghobyaddr_r
 (cڡ *
__ri
 
__addr
, 
__sockn_t
 
__n
,

173 
__ty
,

174 
hot
 *
__ri
 
__su_buf
,

175 *
__ri
 
__buf
, 
size_t
 
__bu
,

176 
hot
 **
__ri
 
__su
,

177 *
__ri
 
__h_
);

179 
	`ghobyme_r
 (cڡ *
__ri
 
__me
,

180 
hot
 *
__ri
 
__su_buf
,

181 *
__ri
 
__buf
, 
size_t
 
__bu
,

182 
hot
 **
__ri
 
__su
,

183 *
__ri
 
__h_
);

185 
	`ghobyme2_r
 (cڡ *
__ri
 
__me
, 
__af
,

186 
hot
 *
__ri
 
__su_buf
,

187 *
__ri
 
__buf
, 
size_t
 
__bu
,

188 
hot
 **
__ri
 
__su
,

189 *
__ri
 
__h_
);

198 
	`t
 (
__ay_ݒ
);

204 
	`dË
 ();

211 
Ë
 *
	`gË
 ();

218 
Ë
 *
	`gtbyaddr
 (
ut32_t
 
__t
, 
__ty
);

224 
Ë
 *
	`gtbyme
 (cڡ *
__me
);

226 #ifdef 
__USE_MISC


237 
	`gË_r
 (
Ë
 *
__ri
 
__su_buf
,

238 *
__ri
 
__buf
, 
size_t
 
__bu
,

239 
Ë
 **
__ri
 
__su
,

240 *
__ri
 
__h_
);

242 
	`gtbyaddr_r
 (
ut32_t
 
__t
, 
__ty
,

243 
Ë
 *
__ri
 
__su_buf
,

244 *
__ri
 
__buf
, 
size_t
 
__bu
,

245 
Ë
 **
__ri
 
__su
,

246 *
__ri
 
__h_
);

248 
	`gtbyme_r
 (cڡ *
__ri
 
__me
,

249 
Ë
 *
__ri
 
__su_buf
,

250 *
__ri
 
__buf
, 
size_t
 
__bu
,

251 
Ë
 **
__ri
 
__su
,

252 *
__ri
 
__h_
);

257 
	srvt


259 *
s_me
;

260 **
s_s
;

261 
s_pt
;

262 *
s_o
;

270 
	`trvt
 (
__ay_ݒ
);

276 
	`drvt
 ();

283 
rvt
 *
	`grvt
 ();

290 
rvt
 *
	`grvbyme
 (cڡ *
__me
, cڡ *
__o
);

297 
rvt
 *
	`grvbypt
 (
__pt
, cڡ *
__o
);

300 #ifdef 
__USE_MISC


308 
	`grvt_r
 (
rvt
 *
__ri
 
__su_buf
,

309 *
__ri
 
__buf
, 
size_t
 
__bu
,

310 
rvt
 **
__ri
 
__su
);

312 
	`grvbyme_r
 (cڡ *
__ri
 
__me
,

313 cڡ *
__ri
 
__o
,

314 
rvt
 *
__ri
 
__su_buf
,

315 *
__ri
 
__buf
, 
size_t
 
__bu
,

316 
rvt
 **
__ri
 
__su
);

318 
	`grvbypt_r
 (
__pt
, cڡ *
__ri
 
__o
,

319 
rvt
 *
__ri
 
__su_buf
,

320 *
__ri
 
__buf
, 
size_t
 
__bu
,

321 
rvt
 **
__ri
 
__su
);

326 
	s


328 *
p_me
;

329 **
p_s
;

330 
p_o
;

338 
	`r
 (
__ay_ݒ
);

344 
	`d
 ();

351 

 *
	`g
 ();

357 

 *
	`gobyme
 (cڡ *
__me
);

363 

 *
	`gobynumb
 (
__o
);

366 #ifdef 
__USE_MISC


374 
	`g_r
 (

 *
__ri
 
__su_buf
,

375 *
__ri
 
__buf
, 
size_t
 
__bu
,

376 

 **
__ri
 
__su
);

378 
	`gobyme_r
 (cڡ *
__ri
 
__me
,

379 

 *
__ri
 
__su_buf
,

380 *
__ri
 
__buf
, 
size_t
 
__bu
,

381 

 **
__ri
 
__su
);

383 
	`gobynumb_r
 (
__o
,

384 

 *
__ri
 
__su_buf
,

385 *
__ri
 
__buf
, 
size_t
 
__bu
,

386 

 **
__ri
 
__su
);

395 
	`g
 (cڡ *
__tgroup
);

403 
	`dtg
 ();

412 
	`gtg
 (**
__ri
 
__hop
,

413 **
__ri
 
__u
,

414 **
__ri
 
__domap
);

423 
	`tgr
 (cڡ *
__tgroup
, cڡ *
__ho
,

424 cڡ *
__ur
, cڡ *
__doma
);

432 
	`gtg_r
 (**
__ri
 
__hop
,

433 **
__ri
 
__u
,

434 **
__ri
 
__domap
,

435 *
__ri
 
__bufr
, 
size_t
 
__bu
);

439 #ifde
__USE_MISC


451 
	`rcmd
 (**
__ri
 
__aho
, 
__t
,

452 cڡ *
__ri
 
__locur
,

453 cڡ *
__ri
 
__mur
,

454 cڡ *
__ri
 
__cmd
, *__ri 
__fd2p
);

463 
	`rcmd_af
 (**
__ri
 
__aho
, 
__t
,

464 cڡ *
__ri
 
__locur
,

465 cڡ *
__ri
 
__mur
,

466 cڡ *
__ri
 
__cmd
, *__ri 
__fd2p
,

467 
_my_t
 
__af
);

479 
	`xec
 (**
__ri
 
__aho
, 
__t
,

480 cڡ *
__ri
 
__me
,

481 cڡ *
__ri
 
__ss
,

482 cڡ *
__ri
 
__cmd
, *__ri 
__fd2p
);

491 
	`xec_af
 (**
__ri
 
__aho
, 
__t
,

492 cڡ *
__ri
 
__me
,

493 cڡ *
__ri
 
__ss
,

494 cڡ *
__ri
 
__cmd
, *__ri 
__fd2p
,

495 
_my_t
 
__af
);

505 
	`rurok
 (cڡ *
__rho
, 
__sur
,

506 cڡ *
__mur
, cڡ *
__locur
);

515 
	`rurok_af
 (cڡ *
__rho
, 
__sur
,

516 cڡ *
__mur
, cڡ *
__locur
,

517 
_my_t
 
__af
);

528 
	`urok
 (
ut32_t
 
__ddr
, 
__sur
,

529 cڡ *
__mur
, cڡ *
__locur
);

539 
	`urok_af
 (cڡ *
__ddr
, 
__sur
,

540 cڡ *
__mur
, cڡ *
__locur
,

541 
_my_t
 
__af
);

551 
	`esvpt
 (*
__pt
);

560 
	`esvpt_af
 (*
__pt
, 
_my_t
 
__af
);

565 #ifde
__USE_XOPEN2K


567 
	saddrfo


569 
ai_ags
;

570 
ai_my
;

571 
ai_sockty
;

572 
ai_oc
;

573 
sockn_t
 
ai_add
;

574 
sockaddr
 *
ai_addr
;

575 *
ai_nme
;

576 
addrfo
 *
ai_xt
;

579 #ifde
__USE_GNU


581 
	sgaicb


583 cڡ *
_me
;

584 cڡ *
_rvi
;

585 cڡ 
addrfo
 *
_que
;

586 
addrfo
 *
_su
;

588 
__tu
;

589 
__glibc_rved
[5];

593 
	#GAI_WAIT
 0

	)

594 
	#GAI_NOWAIT
 1

	)

598 
	#AI_PASSIVE
 0x0001

	)

599 
	#AI_CANONNAME
 0x0002

	)

600 
	#AI_NUMERICHOST
 0x0004

	)

601 
	#AI_V4MAPPED
 0x0008

	)

602 
	#AI_ALL
 0x0010

	)

603 
	#AI_ADDRCONFIG
 0x0020

	)

605 #ifde
__USE_GNU


606 
	#AI_IDN
 0x0040

	)

609 
	#AI_CANONIDN
 0x0080

	)

610 
	#AI_IDN_ALLOW_UNASSIGNED
 0x0100

	)

612 
	#AI_IDN_USE_STD3_ASCII_RULES
 0x0200

	)

615 
	#AI_NUMERICSERV
 0x0400

	)

618 
	#EAI_BADFLAGS
 -1

	)

619 
	#EAI_NONAME
 -2

	)

620 
	#EAI_AGAIN
 -3

	)

621 
	#EAI_FAIL
 -4

	)

622 
	#EAI_FAMILY
 -6

	)

623 
	#EAI_SOCKTYPE
 -7

	)

624 
	#EAI_SERVICE
 -8

	)

625 
	#EAI_MEMORY
 -10

	)

626 
	#EAI_SYSTEM
 -11

	)

627 
	#EAI_OVERFLOW
 -12

	)

628 #ifde
__USE_GNU


629 
	#EAI_NODATA
 -5

	)

630 
	#EAI_ADDRFAMILY
 -9

	)

631 
	#EAI_INPROGRESS
 -100

	)

632 
	#EAI_CANCELED
 -101

	)

633 
	#EAI_NOTCANCELED
 -102

	)

634 
	#EAI_ALLDONE
 -103

	)

635 
	#EAI_INTR
 -104

	)

636 
	#EAI_IDN_ENCODE
 -105

	)

639 #ifde
__USE_MISC


640 
	#NI_MAXHOST
 1025

	)

641 
	#NI_MAXSERV
 32

	)

644 
	#NI_NUMERICHOST
 1

	)

645 
	#NI_NUMERICSERV
 2

	)

646 
	#NI_NOFQDN
 4

	)

647 
	#NI_NAMEREQD
 8

	)

648 
	#NI_DGRAM
 16

	)

649 #ifde
__USE_GNU


650 
	#NI_IDN
 32

	)

651 
	#NI_IDN_ALLOW_UNASSIGNED
 64

	)

653 
	#NI_IDN_USE_STD3_ASCII_RULES
 128

	)

662 
	`gaddrfo
 (cڡ *
__ri
 
__me
,

663 cڡ *
__ri
 
__rvi
,

664 cڡ 
addrfo
 *
__ri
 
__q
,

665 
addrfo
 **
__ri
 
__i
);

668 
	$addrfo
 (
addrfo
 *
__ai

__THROW
;

671 cڡ *
	$gai_
 (
__ecode

__THROW
;

677 
	`gmefo
 (cڡ 
sockaddr
 *
__ri
 
__
,

678 
sockn_t
 
__n
, *
__ri
 
__ho
,

679 
sockn_t
 
__hon
, *
__ri
 
__rv
,

680 
sockn_t
 
__rvn
, 
__ags
);

683 #ifde
__USE_GNU


692 
	`gaddrfo_a
 (
__mode
, 
gaicb
 *
__li
[
__ri_r
],

693 
__t
, 
sigevt
 *
__ri
 
__sig
);

703 
	`gai_sud
 (cڡ 
gaicb
 *cڡ 
__li
[], 
__t
,

704 cڡ 
timeec
 *
__timeout
);

707 
	$gai_r
 (
gaicb
 *
__q

__THROW
;

710 
	$gai_nl
 (
gaicb
 *
__gaicbp

__THROW
;

713 
__END_DECLS


	@/usr/include/netinet/in.h

18 #idef 
_NETINET_IN_H


19 
	#_NETINET_IN_H
 1

	)

21 
	~<us.h
>

22 
	~<dt.h
>

23 
	~<sys/sock.h
>

24 
	~<bs/tys.h
>

27 
__BEGIN_DECLS


30 
ut32_t
 
	t_addr_t
;

31 
	s_addr


33 
_addr_t
 
	ms_addr
;

37 
	~<bs/.h
>

42 
	mIPPROTO_IP
 = 0,

43 
	#IPPROTO_IP
 
IPPROTO_IP


	)

44 
	mIPPROTO_ICMP
 = 1,

45 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

46 
	mIPPROTO_IGMP
 = 2,

47 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

48 
	mIPPROTO_IPIP
 = 4,

49 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

50 
	mIPPROTO_TCP
 = 6,

51 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

52 
	mIPPROTO_EGP
 = 8,

53 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

54 
	mIPPROTO_PUP
 = 12,

55 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

56 
	mIPPROTO_UDP
 = 17,

57 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

58 
	mIPPROTO_IDP
 = 22,

59 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

60 
	mIPPROTO_TP
 = 29,

61 
	#IPPROTO_TP
 
IPPROTO_TP


	)

62 
	mIPPROTO_DCCP
 = 33,

63 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

64 
	mIPPROTO_IPV6
 = 41,

65 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

66 
	mIPPROTO_RSVP
 = 46,

67 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

68 
	mIPPROTO_GRE
 = 47,

69 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

70 
	mIPPROTO_ESP
 = 50,

71 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

72 
	mIPPROTO_AH
 = 51,

73 
	#IPPROTO_AH
 
IPPROTO_AH


	)

74 
	mIPPROTO_MTP
 = 92,

75 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

76 
	mIPPROTO_BEETPH
 = 94,

77 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

78 
	mIPPROTO_ENCAP
 = 98,

79 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

80 
	mIPPROTO_PIM
 = 103,

81 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

82 
	mIPPROTO_COMP
 = 108,

83 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

84 
	mIPPROTO_SCTP
 = 132,

85 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

86 
	mIPPROTO_UDPLITE
 = 136,

87 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

88 
	mIPPROTO_MPLS
 = 137,

89 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

90 
	mIPPROTO_RAW
 = 255,

91 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

92 
	mIPPROTO_MAX


98 #ide
__USE_KERNEL_IPV6_DEFS


101 
	mIPPROTO_HOPOPTS
 = 0,

102 
	#IPPROTO_HOPOPTS
 
IPPROTO_HOPOPTS


	)

103 
	mIPPROTO_ROUTING
 = 43,

104 
	#IPPROTO_ROUTING
 
IPPROTO_ROUTING


	)

105 
	mIPPROTO_FRAGMENT
 = 44,

106 
	#IPPROTO_FRAGMENT
 
IPPROTO_FRAGMENT


	)

107 
	mIPPROTO_ICMPV6
 = 58,

108 
	#IPPROTO_ICMPV6
 
IPPROTO_ICMPV6


	)

109 
	mIPPROTO_NONE
 = 59,

110 
	#IPPROTO_NONE
 
IPPROTO_NONE


	)

111 
	mIPPROTO_DSTOPTS
 = 60,

112 
	#IPPROTO_DSTOPTS
 
IPPROTO_DSTOPTS


	)

113 
	mIPPROTO_MH
 = 135

114 
	#IPPROTO_MH
 
IPPROTO_MH


	)

119 
ut16_t
 
	t_pt_t
;

124 
	mIPPORT_ECHO
 = 7,

125 
	mIPPORT_DISCARD
 = 9,

126 
	mIPPORT_SYSTAT
 = 11,

127 
	mIPPORT_DAYTIME
 = 13,

128 
	mIPPORT_NETSTAT
 = 15,

129 
	mIPPORT_FTP
 = 21,

130 
	mIPPORT_TELNET
 = 23,

131 
	mIPPORT_SMTP
 = 25,

132 
	mIPPORT_TIMESERVER
 = 37,

133 
	mIPPORT_NAMESERVER
 = 42,

134 
	mIPPORT_WHOIS
 = 43,

135 
	mIPPORT_MTP
 = 57,

137 
	mIPPORT_TFTP
 = 69,

138 
	mIPPORT_RJE
 = 77,

139 
	mIPPORT_FINGER
 = 79,

140 
	mIPPORT_TTYLINK
 = 87,

141 
	mIPPORT_SUPDUP
 = 95,

144 
	mIPPORT_EXECSERVER
 = 512,

145 
	mIPPORT_LOGINSERVER
 = 513,

146 
	mIPPORT_CMDSERVER
 = 514,

147 
	mIPPORT_EFSSERVER
 = 520,

150 
	mIPPORT_BIFFUDP
 = 512,

151 
	mIPPORT_WHOSERVER
 = 513,

152 
	mIPPORT_ROUTESERVER
 = 520,

155 
	mIPPORT_RESERVED
 = 1024,

158 
	mIPPORT_USERRESERVED
 = 5000

166 
	#IN_CLASSA
(
a
((((
_addr_t
))& 0x80000000=0)

	)

167 
	#IN_CLASSA_NET
 0xff000000

	)

168 
	#IN_CLASSA_NSHIFT
 24

	)

169 
	#IN_CLASSA_HOST
 (0xfffffff& ~
IN_CLASSA_NET
)

	)

170 
	#IN_CLASSA_MAX
 128

	)

172 
	#IN_CLASSB
(
a
((((
_addr_t
))& 0xc0000000=0x80000000)

	)

173 
	#IN_CLASSB_NET
 0xffff0000

	)

174 
	#IN_CLASSB_NSHIFT
 16

	)

175 
	#IN_CLASSB_HOST
 (0xfffffff& ~
IN_CLASSB_NET
)

	)

176 
	#IN_CLASSB_MAX
 65536

	)

178 
	#IN_CLASSC
(
a
((((
_addr_t
))& 0xe0000000=0xc0000000)

	)

179 
	#IN_CLASSC_NET
 0xffffff00

	)

180 
	#IN_CLASSC_NSHIFT
 8

	)

181 
	#IN_CLASSC_HOST
 (0xfffffff& ~
IN_CLASSC_NET
)

	)

183 
	#IN_CLASSD
(
a
((((
_addr_t
))& 0xf0000000=0xe0000000)

	)

184 
	#IN_MULTICAST
(
a

	`IN_CLASSD
)

	)

186 
	#IN_EXPERIMENTAL
(
a
((((
_addr_t
))& 0xe0000000=0xe0000000)

	)

187 
	#IN_BADCLASS
(
a
((((
_addr_t
))& 0xf0000000=0xf0000000)

	)

190 
	#INADDR_ANY
 ((
_addr_t
0x00000000)

	)

192 
	#INADDR_BROADCAST
 ((
_addr_t
0xffffffff)

	)

194 
	#INADDR_NONE
 ((
_addr_t
0xffffffff)

	)

197 
	#IN_LOOPBACKNET
 127

	)

199 #ide
INADDR_LOOPBACK


200 
	#INADDR_LOOPBACK
 ((
_addr_t
0x7f000001

	)

204 
	#INADDR_UNSPEC_GROUP
 ((
_addr_t
0xe0000000

	)

205 
	#INADDR_ALLHOSTS_GROUP
 ((
_addr_t
0xe0000001

	)

206 
	#INADDR_ALLRTRS_GROUP
 ((
_addr_t
0xe0000002

	)

207 
	#INADDR_MAX_LOCAL_GROUP
 ((
_addr_t
0xe00000ff

	)

209 #ide
__USE_KERNEL_IPV6_DEFS


211 
	s6_addr


215 
ut8_t
 
	m__u6_addr8
[16];

216 #ifde
__USE_MISC


217 
ut16_t
 
	m__u6_addr16
[8];

218 
ut32_t
 
	m__u6_addr32
[4];

220 } 
	m__6_u
;

221 
	#s6_addr
 
__6_u
.
__u6_addr8


	)

222 #ifde
__USE_MISC


223 
	#s6_addr16
 
__6_u
.
__u6_addr16


	)

224 
	#s6_addr32
 
__6_u
.
__u6_addr32


	)

229 cڡ 
6_addr
 
6addr_y
;

230 cڡ 
6_addr
 
6addr_loback
;

231 
	#IN6ADDR_ANY_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0 } } }

	)

232 
	#IN6ADDR_LOOPBACK_INIT
 { { { 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1 } } }

	)

234 
	#INET_ADDRSTRLEN
 16

	)

235 
	#INET6_ADDRSTRLEN
 46

	)

239 
	ssockaddr_


241 
__SOCKADDR_COMMON
 (
s_
);

242 
_pt_t
 
	ms_pt
;

243 
_addr
 
	ms_addr
;

246 
	ms_zo
[ (
sockaddr
) -

247 
__SOCKADDR_COMMON_SIZE
 -

248  (
_pt_t
) -

249  (
_addr
)];

252 #ide
__USE_KERNEL_IPV6_DEFS


254 
	ssockaddr_6


256 
__SOCKADDR_COMMON
 (
s6_
);

257 
_pt_t
 
	ms6_pt
;

258 
ut32_t
 
	ms6_owfo
;

259 
6_addr
 
	ms6_addr
;

260 
ut32_t
 
	ms6_sce_id
;

264 #ifde
__USE_MISC


266 
	s_mq


269 
_addr
 
	mimr_muɟddr
;

272 
_addr
 
	mimr_r
;

275 
	s_mq_sour


278 
_addr
 
	mimr_muɟddr
;

281 
_addr
 
	mimr_r
;

284 
_addr
 
	mimr_souraddr
;

288 #ide
__USE_KERNEL_IPV6_DEFS


290 
	sv6_mq


293 
6_addr
 
	mv6mr_muɟddr
;

296 
	mv6mr_r
;

300 #ifde
__USE_MISC


302 
	sgroup_q


305 
ut32_t
 
	mgr_r
;

308 
sockaddr_age
 
	mgr_group
;

311 
	sgroup_sour_q


314 
ut32_t
 
	mg_r
;

317 
sockaddr_age
 
	mg_group
;

320 
sockaddr_age
 
	mg_sour
;

325 
	s_msfr


328 
_addr
 
	mimsf_muɟddr
;

331 
_addr
 
	mimsf_r
;

334 
ut32_t
 
	mimsf_fmode
;

337 
ut32_t
 
	mimsf_numc
;

339 
_addr
 
	mimsf_i
[1];

342 
	#IP_MSFILTER_SIZE
(
numc
( (
_msfr
) \

343 -  (
_addr
) \

344 + (
numc
*  (
_addr
))

	)

346 
	sgroup_fr


349 
ut32_t
 
	mgf_r
;

352 
sockaddr_age
 
	mgf_group
;

355 
ut32_t
 
	mgf_fmode
;

358 
ut32_t
 
	mgf_numc
;

360 
sockaddr_age
 
	mgf_i
[1];

363 
	#GROUP_FILTER_SIZE
(
numc
( (
group_fr
) \

364 -  (
sockaddr_age
) \

365 + ((
numc
) \

366 *  (
sockaddr_age
)))

	)

376 
ut32_t
 
	$ohl
 (
ut32_t
 
__Îg

__THROW
 
	`__ibu__
 ((
__cڡ__
));

377 
ut16_t
 
	$ohs
 (
ut16_t
 
__tsht
)

378 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

379 
ut32_t
 
	$htl
 (
ut32_t
 
__holg
)

380 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

381 
ut16_t
 
	$hts
 (
ut16_t
 
__hosht
)

382 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

384 
	~<dn.h
>

387 
	~<bs/bysw.h
>

389 #ifde
__OPTIMIZE__


393 #i
__BYTE_ORDER
 =
__BIG_ENDIAN


396 
	#ohl
(
x
(x)

	)

397 
	#ohs
(
x
(x)

	)

398 
	#htl
(
x
(x)

	)

399 
	#hts
(
x
(x)

	)

401 #i
__BYTE_ORDER
 =
__LITTLE_ENDIAN


402 
	#ohl
(
x

	`__bsw_32
 (x)

	)

403 
	#ohs
(
x

	`__bsw_16
 (x)

	)

404 
	#htl
(
x

	`__bsw_32
 (x)

	)

405 
	#hts
(
x

	`__bsw_16
 (x)

	)

410 #ifde
__GNUC__


411 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

412 (
__exnsi__
 \

413 ({ cڡ 
6_addr
 *
__a
 = (cڡ 6_add*(
a
); \

414 
__a
->
s6_addr32
[0] == 0 \

415 && 
__a
->
s6_addr32
[1] == 0 \

416 && 
__a
->
s6_addr32
[2] == 0 \

417 && 
__a
->
s6_addr32
[3] =0; 
	}
}))

	)

419 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

420 (
__exnsi__
 \

421 ({ cڡ 
6_addr
 *
__a
 = (cڡ 6_add*(
a
); \

422 
__a
->
s6_addr32
[0] == 0 \

423 && 
__a
->
s6_addr32
[1] == 0 \

424 && 
__a
->
s6_addr32
[2] == 0 \

425 && 
__a
->
s6_addr32
[3] =
	`htl
 (1); }))

	)

427 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

428 (
__exnsi__
 \

429 ({ cڡ 
6_addr
 *
__a
 = (cڡ 6_add*(
a
); \

430 (
__a
->
s6_addr32
[0] & 
	`htl
 (0xffc00000)=ht(0x800000); }))

	)

432 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

433 (
__exnsi__
 \

434 ({ cڡ 
6_addr
 *
__a
 = (cڡ 6_add*(
a
); \

435 (
__a
->
s6_addr32
[0] & 
	`htl
 (0xffc00000)=ht(0xc00000); }))

	)

437 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

438 (
__exnsi__
 \

439 ({ cڡ 
6_addr
 *
__a
 = (cڡ 6_add*(
a
); \

440 
__a
->
s6_addr32
[0] == 0 \

441 && 
__a
->
s6_addr32
[1] == 0 \

442 && 
__a
->
s6_addr32
[2] =
	`htl
 (0xffff); }))

	)

444 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

445 (
__exnsi__
 \

446 ({ cڡ 
6_addr
 *
__a
 = (cڡ 6_add*(
a
); \

447 
__a
->
s6_addr32
[0] == 0 \

448 && 
__a
->
s6_addr32
[1] == 0 \

449 && 
__a
->
s6_addr32
[2] == 0 \

450 && 
	`ohl
 (
__a
->
s6_addr32
[3]> 1; }))

	)

452 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

453 (
__exnsi__
 \

454 ({ cڡ 
6_addr
 *
__a
 = (cڡ 6_add*(
a
); \

455 cڡ 
6_addr
 *
__b
 = (cڡ 6_add*(
b
); \

456 
__a
->
s6_addr32
[0] =
__b
->s6_addr32[0] \

457 && 
__a
->
s6_addr32
[1] =
__b
->s6_addr32[1] \

458 && 
__a
->
s6_addr32
[2] =
__b
->s6_addr32[2] \

459 && 
__a
->
s6_addr32
[3] =
__b
->s6_addr32[3]; }))

	)

461 
	#IN6_IS_ADDR_UNSPECIFIED
(
a
) \

462 (((cڡ 
ut32_t
 *(
a
))[0] == 0 \

463 && ((cڡ 
ut32_t
 *(
a
))[1] == 0 \

464 && ((cڡ 
ut32_t
 *(
a
))[2] == 0 \

465 && ((cڡ 
ut32_t
 *(
a
))[3] =0)

	)

467 
	#IN6_IS_ADDR_LOOPBACK
(
a
) \

468 (((cڡ 
ut32_t
 *(
a
))[0] == 0 \

469 && ((cڡ 
ut32_t
 *(
a
))[1] == 0 \

470 && ((cڡ 
ut32_t
 *(
a
))[2] == 0 \

471 && ((cڡ 
ut32_t
 *(
a
))[3] =
	`htl
 (1))

	)

473 
	#IN6_IS_ADDR_LINKLOCAL
(
a
) \

474 ((((cڡ 
ut32_t
 *(
a
))[0] & 
	`htl
 (0xffc00000)) \

475 =
	`htl
 (0x800000))

	)

477 
	#IN6_IS_ADDR_SITELOCAL
(
a
) \

478 ((((cڡ 
ut32_t
 *(
a
))[0] & 
	`htl
 (0xffc00000)) \

479 =
	`htl
 (0xc00000))

	)

481 
	#IN6_IS_ADDR_V4MAPPED
(
a
) \

482 ((((cڡ 
ut32_t
 *(
a
))[0] == 0) \

483 && (((cڡ 
ut32_t
 *(
a
))[1] == 0) \

484 && (((cڡ 
ut32_t
 *(
a
))[2] =
	`htl
 (0xffff)))

	)

486 
	#IN6_IS_ADDR_V4COMPAT
(
a
) \

487 ((((cڡ 
ut32_t
 *(
a
))[0] == 0) \

488 && (((cڡ 
ut32_t
 *(
a
))[1] == 0) \

489 && (((cڡ 
ut32_t
 *(
a
))[2] == 0) \

490 && (
	`ohl
 (((cڡ 
ut32_t
 *(
a
))[3]> 1))

	)

492 
	#IN6_ARE_ADDR_EQUAL
(
a
,
b
) \

493 ((((cڡ 
ut32_t
 *(
a
))[0] =((cڡ ut32_*(
b
))[0]) \

494 && (((cڡ 
ut32_t
 *(
a
))[1] =((cڡ ut32_*(
b
))[1]) \

495 && (((cڡ 
ut32_t
 *(
a
))[2] =((cڡ ut32_*(
b
))[2]) \

496 && (((cڡ 
ut32_t
 *(
a
))[3] =((cڡ ut32_*(
b
))[3]))

	)

499 
	#IN6_IS_ADDR_MULTICAST
(
a
(((cڡ 
ut8_t
 *))[0] =0xff)

	)

501 #ifde
__USE_MISC


503 
	$bdsvpt
 (
__sockfd
, 
sockaddr_
 *
__sock_

__THROW
;

506 
	$bdsvpt6
 (
__sockfd
, 
sockaddr_6
 *
__sock_
)

507 
__THROW
;

511 
	#IN6_IS_ADDR_MC_NODELOCAL
(
a
) \

512 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

513 && ((((cڡ 
ut8_t
 *(
a
))[1] & 0xf=0x1))

	)

515 
	#IN6_IS_ADDR_MC_LINKLOCAL
(
a
) \

516 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

517 && ((((cڡ 
ut8_t
 *(
a
))[1] & 0xf=0x2))

	)

519 
	#IN6_IS_ADDR_MC_SITELOCAL
(
a
) \

520 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

521 && ((((cڡ 
ut8_t
 *(
a
))[1] & 0xf=0x5))

	)

523 
	#IN6_IS_ADDR_MC_ORGLOCAL
(
a
) \

524 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

525 && ((((cڡ 
ut8_t
 *(
a
))[1] & 0xf=0x8))

	)

527 
	#IN6_IS_ADDR_MC_GLOBAL
(
a
) \

528 (
	`IN6_IS_ADDR_MULTICAST
(
a
) \

529 && ((((cڡ 
ut8_t
 *(
a
))[1] & 0xf=0xe))

	)

532 #ifde
__USE_GNU


533 
cmsghdr
;

535 #ide
__USE_KERNEL_IPV6_DEFS


537 
	s6_pktfo


539 
6_addr
 
i6_addr
;

540 
i6_ifdex
;

544 
	s6_mtufo


546 
sockaddr_6
 
6m_addr
;

547 
ut32_t
 
6m_mtu
;

552 
	$6_ti_a
 (
__nbys
)

553 
__THROW
 
__ibu_dd__
;

554 
	$6_ti_
 (*
__bp
, 
cmsghdr
 **
__cmsgp
,

555 
__ty

__THROW
 
__ibu_dd__
;

556 
	$6_ti_nd
 (
cmsghdr
 *
__cmsg
,

557 cڡ 
ut8_t
 *
__typ
, 
__mux
,

558 
__usy

__THROW
 
__ibu_dd__
;

559 
ut8_t
 *
	$6_ti_loc
 (
cmsghdr
 *
__cmsg
, 
__d
,

560 
__mux
, 
__usy
)

561 
__THROW
 
__ibu_dd__
;

562 
	$6_ti_xt
 (cڡ 
cmsghdr
 *
__cmsg
,

563 
ut8_t
 **
__p
)

564 
__THROW
 
__ibu_dd__
;

565 
	$6_ti_fd
 (cڡ 
cmsghdr
 *
__cmsg
,

566 
ut8_t
 **
__p
, 
__ty
)

567 
__THROW
 
__ibu_dd__
;

571 
	$6_t_
 (*
__extbuf
, 
sockn_t
 
__ex

__THROW
;

572 
	$6_t_nd
 (*
__extbuf
, 
sockn_t
 
__ex
, 
__offt
,

573 
ut8_t
 
__ty
, 
sockn_t
 
__n
, ut8_
__ign
,

574 **
__dabu

__THROW
;

575 
	$6_t_fish
 (*
__extbuf
, 
sockn_t
 
__ex
, 
__offt
)

576 
__THROW
;

577 
	$6_t_t_v
 (*
__dabuf
, 
__offt
, *
__v
,

578 
sockn_t
 
__vn

__THROW
;

579 
	$6_t_xt
 (*
__extbuf
, 
sockn_t
 
__ex
, 
__offt
,

580 
ut8_t
 *
__typ
, 
sockn_t
 *
__
,

581 **
__dabu

__THROW
;

582 
	$6_t_fd
 (*
__extbuf
, 
sockn_t
 
__ex
, 
__offt
,

583 
ut8_t
 
__ty
, 
sockn_t
 *
__
,

584 **
__dabu

__THROW
;

585 
	$6_t_g_v
 (*
__dabuf
, 
__offt
, *
__v
,

586 
sockn_t
 
__vn

__THROW
;

590 
sockn_t
 
	$6_h_a
 (
__ty
, 
__gmts

__THROW
;

591 *
	$6_h_
 (*
__bp
, 
sockn_t
 
__bp_n
, 
__ty
,

592 
__gmts

__THROW
;

593 
	$6_h_add
 (*
__bp
, cڡ 
6_addr
 *
__addr

__THROW
;

594 
	$6_h_v
 (cڡ *
__
, *
__out

__THROW
;

595 
	$6_h_gmts
 (cڡ *
__bp

__THROW
;

596 
6_addr
 *
	$6_h_gaddr
 (cڡ *
__bp
, 
__dex
)

597 
__THROW
;

603 
	$gv4sourfr
 (
__s
, 
_addr
 
__r_addr
,

604 
_addr
 
__group
, 
ut32_t
 *
__fmode
,

605 
ut32_t
 *
__numc
, 
_addr
 *
__i
)

606 
__THROW
;

609 
	$tv4sourfr
 (
__s
, 
_addr
 
__r_addr
,

610 
_addr
 
__group
, 
ut32_t
 
__fmode
,

611 
ut32_t
 
__numc
,

612 cڡ 
_addr
 *
__i
)

613 
__THROW
;

617 
	$gsourfr
 (
__s
, 
ut32_t
 
__r_addr
,

618 cڡ 
sockaddr
 *
__group
,

619 
sockn_t
 
__grou
, 
ut32_t
 *
__fmode
,

620 
ut32_t
 *
__numc
,

621 
sockaddr_age
 *
__i

__THROW
;

624 
	$tsourfr
 (
__s
, 
ut32_t
 
__r_addr
,

625 cڡ 
sockaddr
 *
__group
,

626 
sockn_t
 
__grou
, 
ut32_t
 
__fmode
,

627 
ut32_t
 
__numc
,

628 cڡ 
sockaddr_age
 *
__i

__THROW
;

631 
__END_DECLS


	@/usr/include/netpacket/packet.h

19 #ide
__NETPACKET_PACKET_H


20 
	#__NETPACKET_PACKET_H
 1

	)

22 
	ssockaddr_


24 
	ml_my
;

25 
	ml_oc
;

26 
	ml_ifdex
;

27 
	ml_hy
;

28 
	ml_pky
;

29 
	ml_h
;

30 
	ml_addr
[8];

35 
	#PACKET_HOST
 0

	)

36 
	#PACKET_BROADCAST
 1

	)

37 
	#PACKET_MULTICAST
 2

	)

38 
	#PACKET_OTHERHOST
 3

	)

39 
	#PACKET_OUTGOING
 4

	)

40 
	#PACKET_LOOPBACK
 5

	)

41 
	#PACKET_FASTROUTE
 6

	)

45 
	#PACKET_ADD_MEMBERSHIP
 1

	)

46 
	#PACKET_DROP_MEMBERSHIP
 2

	)

47 
	#PACKET_RECV_OUTPUT
 3

	)

48 
	#PACKET_RX_RING
 5

	)

49 
	#PACKET_STATISTICS
 6

	)

50 
	#PACKET_COPY_THRESH
 7

	)

51 
	#PACKET_AUXDATA
 8

	)

52 
	#PACKET_ORIGDEV
 9

	)

53 
	#PACKET_VERSION
 10

	)

54 
	#PACKET_HDRLEN
 11

	)

55 
	#PACKET_RESERVE
 12

	)

56 
	#PACKET_TX_RING
 13

	)

57 
	#PACKET_LOSS
 14

	)

58 
	#PACKET_VNET_HDR
 15

	)

59 
	#PACKET_TX_TIMESTAMP
 16

	)

60 
	#PACKET_TIMESTAMP
 17

	)

61 
	#PACKET_FANOUT
 18

	)

62 
	#PACKET_TX_HAS_OFF
 19

	)

63 
	#PACKET_QDISC_BYPASS
 20

	)

64 
	#PACKET_ROLLOVER_STATS
 21

	)

65 
	#PACKET_FANOUT_DATA
 22

	)

67 
	sck_mq


69 
	mmr_ifdex
;

70 
	mmr_ty
;

71 
	mmr_
;

72 
	mmr_addss
[8];

75 
	#PACKET_MR_MULTICAST
 0

	)

76 
	#PACKET_MR_PROMISC
 1

	)

77 
	#PACKET_MR_ALLMULTI
 2

	)

78 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/poll.h

1 
	~<sys/pl.h
>

	@/usr/include/pthread.h

18 #ide
_PTHREAD_H


19 
	#_PTHREAD_H
 1

	)

21 
	~<us.h
>

22 
	~<dn.h
>

23 
	~<sched.h
>

24 
	~<time.h
>

26 
	~<bs/hadtys.h
>

27 
	~<bs/tjmp.h
>

28 
	~<bs/wdsize.h
>

34 
	mPTHREAD_CREATE_JOINABLE
,

35 
	#PTHREAD_CREATE_JOINABLE
 
PTHREAD_CREATE_JOINABLE


	)

36 
	mPTHREAD_CREATE_DETACHED


37 
	#PTHREAD_CREATE_DETACHED
 
PTHREAD_CREATE_DETACHED


	)

44 
	mPTHREAD_MUTEX_TIMED_NP
,

45 
	mPTHREAD_MUTEX_RECURSIVE_NP
,

46 
	mPTHREAD_MUTEX_ERRORCHECK_NP
,

47 
	mPTHREAD_MUTEX_ADAPTIVE_NP


48 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K8


50 
	mPTHREAD_MUTEX_NORMAL
 = 
PTHREAD_MUTEX_TIMED_NP
,

51 
	mPTHREAD_MUTEX_RECURSIVE
 = 
PTHREAD_MUTEX_RECURSIVE_NP
,

52 
	mPTHREAD_MUTEX_ERRORCHECK
 = 
PTHREAD_MUTEX_ERRORCHECK_NP
,

53 
	mPTHREAD_MUTEX_DEFAULT
 = 
PTHREAD_MUTEX_NORMAL


55 #ifde
__USE_GNU


57 , 
	mPTHREAD_MUTEX_FAST_NP
 = 
PTHREAD_MUTEX_TIMED_NP


62 #ifde
__USE_XOPEN2K


66 
	mPTHREAD_MUTEX_STALLED
,

67 
	mPTHREAD_MUTEX_STALLED_NP
 = 
PTHREAD_MUTEX_STALLED
,

68 
	mPTHREAD_MUTEX_ROBUST
,

69 
	mPTHREAD_MUTEX_ROBUST_NP
 = 
PTHREAD_MUTEX_ROBUST


74 #i
defed
 
__USE_POSIX199506
 || defed 
__USE_UNIX98


78 
	mPTHREAD_PRIO_NONE
,

79 
	mPTHREAD_PRIO_INHERIT
,

80 
	mPTHREAD_PRIO_PROTECT


85 #ifde
__PTHREAD_MUTEX_HAVE_PREV


86 
	#PTHREAD_MUTEX_INITIALIZER
 \

87 { { 0, 0, 0, 0, 0, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

88 #ifde
__USE_GNU


89 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

90 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

91 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

92 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

93 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

94 { { 0, 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 
__PTHREAD_SPINS
, { 0, 0 } } }

	)

98 
	#PTHREAD_MUTEX_INITIALIZER
 \

99 { { 0, 0, 0, 0, 0, { 
__PTHREAD_SPINS
 } } }

	)

100 #ifde
__USE_GNU


101 
	#PTHREAD_RECURSIVE_MUTEX_INITIALIZER_NP
 \

102 { { 0, 0, 0, 
PTHREAD_MUTEX_RECURSIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

103 
	#PTHREAD_ERRORCHECK_MUTEX_INITIALIZER_NP
 \

104 { { 0, 0, 0, 
PTHREAD_MUTEX_ERRORCHECK_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

105 
	#PTHREAD_ADAPTIVE_MUTEX_INITIALIZER_NP
 \

106 { { 0, 0, 0, 
PTHREAD_MUTEX_ADAPTIVE_NP
, 0, { 
__PTHREAD_SPINS
 } } }

	)

113 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K


116 
	mPTHREAD_RWLOCK_PREFER_READER_NP
,

117 
	mPTHREAD_RWLOCK_PREFER_WRITER_NP
,

118 
	mPTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,

119 
	mPTHREAD_RWLOCK_DEFAULT_NP
 = 
PTHREAD_RWLOCK_PREFER_READER_NP


125 #ide
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


126 #i
__WORDSIZE
 == 64

127 
	#__PTHREAD_RWLOCK_INT_FLAGS_SHARED
 1

	)

132 
	#PTHREAD_RWLOCK_INITIALIZER
 \

133 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

134 #ifde
__USE_GNU


135 #ifde
__PTHREAD_RWLOCK_INT_FLAGS_SHARED


136 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

137 { { 0, 0, 0, 0, 0, 0, 0, 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, \

138 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
 } }

	)

140 #i
__BYTE_ORDER
 =
__LITTLE_ENDIAN


141 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

142 { { 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
, \

143 0, 
__PTHREAD_RWLOCK_ELISION_EXTRA
, 0, 0 } }

	)

145 
	#PTHREAD_RWLOCK_WRITER_NONRECURSIVE_INITIALIZER_NP
 \

146 { { 0, 0, 0, 0, 0, 0, 0, 0, 0, 
PTHREAD_RWLOCK_PREFER_WRITER_NONRECURSIVE_NP
,\

147 0 } }

	)

157 
	mPTHREAD_INHERIT_SCHED
,

158 
	#PTHREAD_INHERIT_SCHED
 
PTHREAD_INHERIT_SCHED


	)

159 
	mPTHREAD_EXPLICIT_SCHED


160 
	#PTHREAD_EXPLICIT_SCHED
 
PTHREAD_EXPLICIT_SCHED


	)

167 
	mPTHREAD_SCOPE_SYSTEM
,

168 
	#PTHREAD_SCOPE_SYSTEM
 
PTHREAD_SCOPE_SYSTEM


	)

169 
	mPTHREAD_SCOPE_PROCESS


170 
	#PTHREAD_SCOPE_PROCESS
 
PTHREAD_SCOPE_PROCESS


	)

177 
	mPTHREAD_PROCESS_PRIVATE
,

178 
	#PTHREAD_PROCESS_PRIVATE
 
PTHREAD_PROCESS_PRIVATE


	)

179 
	mPTHREAD_PROCESS_SHARED


180 
	#PTHREAD_PROCESS_SHARED
 
PTHREAD_PROCESS_SHARED


	)

186 
	#PTHREAD_COND_INITIALIZER
 { { 0, 0, 0, 0, 0, (*0, 0, 0 } }

	)

190 
	s_had_nup_bufr


192 (*
	m__route
) (*);

193 *
	m__g
;

194 
	m__ny
;

195 
_had_nup_bufr
 *
	m__ev
;

201 
	mPTHREAD_CANCEL_ENABLE
,

202 
	#PTHREAD_CANCEL_ENABLE
 
PTHREAD_CANCEL_ENABLE


	)

203 
	mPTHREAD_CANCEL_DISABLE


204 
	#PTHREAD_CANCEL_DISABLE
 
PTHREAD_CANCEL_DISABLE


	)

208 
	mPTHREAD_CANCEL_DEFERRED
,

209 
	#PTHREAD_CANCEL_DEFERRED
 
PTHREAD_CANCEL_DEFERRED


	)

210 
	mPTHREAD_CANCEL_ASYNCHRONOUS


211 
	#PTHREAD_CANCEL_ASYNCHRONOUS
 
PTHREAD_CANCEL_ASYNCHRONOUS


	)

213 
	#PTHREAD_CANCELED
 ((*-1)

	)

217 
	#PTHREAD_ONCE_INIT
 0

	)

220 #ifde
__USE_XOPEN2K


224 
	#PTHREAD_BARRIER_SERIAL_THREAD
 -1

	)

228 
__BEGIN_DECLS


233 
	$had_
 (
had_t
 *
__ri
 
__wthad
,

234 cڡ 
had__t
 *
__ri
 
__
,

235 *(*
__t_route
) (*),

236 *
__ri
 
__g

__THROWNL
 
	`__nnu
 ((1, 3));

242 
	$had_ex
 (*
__tv

	`__ibu__
 ((
__nܑu__
));

250 
	`had_jo
 (
had_t
 
__th
, **
__thad_tu
);

252 #ifde
__USE_GNU


255 
	$had_yjo_
 (
had_t
 
__th
, **
__thad_tu

__THROW
;

263 
	`had_timedjo_
 (
had_t
 
__th
, **
__thad_tu
,

264 cڡ 
timeec
 *
__abime
);

271 
	$had_dach
 (
had_t
 
__th

__THROW
;

275 
had_t
 
	$had_lf
 (
__THROW
 
	`__ibu__
 ((
__cڡ__
));

278 
	$had_equ
 (
had_t
 
__thad1
,thad_
__thad2
)

279 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

287 
	$had__
 (
had__t
 *
__

__THROW
 
	`__nnu
 ((1));

290 
	$had__deroy
 (
had__t
 *
__
)

291 
__THROW
 
	`__nnu
 ((1));

294 
	$had__gdache
 (cڡ 
had__t
 *
__
,

295 *
__dache
)

296 
__THROW
 
	`__nnu
 ((1, 2));

299 
	$had__tdache
 (
had__t
 *
__
,

300 
__dache
)

301 
__THROW
 
	`__nnu
 ((1));

305 
	$had__ggudsize
 (cڡ 
had__t
 *
__
,

306 
size_t
 *
__gudsize
)

307 
__THROW
 
	`__nnu
 ((1, 2));

310 
	$had__tgudsize
 (
had__t
 *
__
,

311 
size_t
 
__gudsize
)

312 
__THROW
 
	`__nnu
 ((1));

316 
	$had__gschedm
 (cڡ 
had__t
 *
__ri
 
__
,

317 
sched_m
 *
__ri
 
__m
)

318 
__THROW
 
	`__nnu
 ((1, 2));

321 
	$had__tschedm
 (
had__t
 *
__ri
 
__
,

322 cڡ 
sched_m
 *
__ri


323 
__m

__THROW
 
	`__nnu
 ((1, 2));

326 
	$had__gschedpicy
 (cڡ 
had__t
 *
__ri


327 
__
, *
__ri
 
__picy
)

328 
__THROW
 
	`__nnu
 ((1, 2));

331 
	$had__tschedpicy
 (
had__t
 *
__
, 
__picy
)

332 
__THROW
 
	`__nnu
 ((1));

335 
	$had__ghsched
 (cڡ 
had__t
 *
__ri


336 
__
, *
__ri
 
__h
)

337 
__THROW
 
	`__nnu
 ((1, 2));

340 
	$had__thsched
 (
had__t
 *
__
,

341 
__h
)

342 
__THROW
 
	`__nnu
 ((1));

346 
	$had__gsce
 (cڡ 
had__t
 *
__ri
 
__
,

347 *
__ri
 
__sce
)

348 
__THROW
 
	`__nnu
 ((1, 2));

351 
	$had__tsce
 (
had__t
 *
__
, 
__sce
)

352 
__THROW
 
	`__nnu
 ((1));

355 
	$had__gackaddr
 (cڡ 
had__t
 *
__ri


356 
__
, **
__ri
 
__ackaddr
)

357 
__THROW
 
	`__nnu
 ((1, 2)
__ibu_dd__
;

363 
	$had__tackaddr
 (
had__t
 *
__
,

364 *
__ackaddr
)

365 
__THROW
 
	`__nnu
 ((1)
__ibu_dd__
;

368 
	$had__gacksize
 (cڡ 
had__t
 *
__ri


369 
__
, 
size_t
 *
__ri
 
__acksize
)

370 
__THROW
 
	`__nnu
 ((1, 2));

375 
	$had__tacksize
 (
had__t
 *
__
,

376 
size_t
 
__acksize
)

377 
__THROW
 
	`__nnu
 ((1));

379 #ifde
__USE_XOPEN2K


381 
	$had__gack
 (cڡ 
had__t
 *
__ri
 
__
,

382 **
__ri
 
__ackaddr
,

383 
size_t
 *
__ri
 
__acksize
)

384 
__THROW
 
	`__nnu
 ((1, 2, 3));

389 
	$had__tack
 (
had__t
 *
__
, *
__ackaddr
,

390 
size_t
 
__acksize

__THROW
 
	`__nnu
 ((1));

393 #ifde
__USE_GNU


396 
	$had__ffy_
 (
had__t
 *
__
,

397 
size_t
 
__utsize
,

398 cڡ 
u_t_t
 *
__ut
)

399 
__THROW
 
	`__nnu
 ((1, 3));

403 
	$had__gaffy_
 (cڡ 
had__t
 *
__
,

404 
size_t
 
__utsize
,

405 
u_t_t
 *
__ut
)

406 
__THROW
 
	`__nnu
 ((1, 3));

409 
	$had_g_deu_
 (
had__t
 *
__
)

410 
__THROW
 
	`__nnu
 ((1));

414 
	$had_r_deu_
 (cڡ 
had__t
 *
__
)

415 
__THROW
 
	`__nnu
 ((1));

420 
	$had_g_
 (
had_t
 
__th
, 
had__t
 *
__
)

421 
__THROW
 
	`__nnu
 ((2));

429 
	$had_tschedm
 (
had_t
 
__rg_thad
, 
__picy
,

430 cڡ 
sched_m
 *
__m
)

431 
__THROW
 
	`__nnu
 ((3));

434 
	$had_gschedm
 (
had_t
 
__rg_thad
,

435 *
__ri
 
__picy
,

436 
sched_m
 *
__ri
 
__m
)

437 
__THROW
 
	`__nnu
 ((2, 3));

440 
	$had_tschedio
 (
had_t
 
__rg_thad
, 
__io
)

441 
__THROW
;

444 #ifde
__USE_GNU


446 
	$had_gme_
 (
had_t
 
__rg_thad
, *
__buf
,

447 
size_t
 
__bu
)

448 
__THROW
 
	`__nnu
 ((2));

451 
	$had_ame_
 (
had_t
 
__rg_thad
, cڡ *
__me
)

452 
__THROW
 
	`__nnu
 ((2));

456 #ifde
__USE_UNIX98


458 
	$had_gccucy
 (
__THROW
;

461 
	$had_tccucy
 (
__v

__THROW
;

464 #ifde
__USE_GNU


469 
	$had_yld
 (
__THROW
;

474 
	$had_ffy_
 (
had_t
 
__th
, 
size_t
 
__utsize
,

475 cڡ 
u_t_t
 *
__ut
)

476 
__THROW
 
	`__nnu
 ((3));

479 
	$had_gaffy_
 (
had_t
 
__th
, 
size_t
 
__utsize
,

480 
u_t_t
 *
__ut
)

481 
__THROW
 
	`__nnu
 ((3));

494 
	$had_
 (
had__t
 *
___cڌ
,

495 (*
___route
()
	`__nnu
 ((1, 2));

506 
	`had_tnle
 (
__e
, *
__de
);

510 
	`had_tny
 (
__ty
, *
__dty
);

513 
	`had_nl
 (
had_t
 
__th
);

518 
	`had_nl
 ();

527 
__jmp_buf
 
__nl_jmp_buf
;

528 
__mask_was_ved
;

529 } 
__nl_jmp_buf
[1];

530 *
__d
[4];

531 } 
	t__had_unwd_buf_t
 
	t__ibu__
 ((
	t__igd__
));

534 #ide
__nup_f_ibu


535 
	#__nup_f_ibu


	)

540 
	s__had_nup_ame


542 (*
__nl_route
) (*);

543 *
__nl_g
;

544 
__do_
;

545 
__nl_ty
;

548 #i
defed
 
__GNUC__
 && defed 
__EXCEPTIONS


549 #ifde
__lulus


551 as
	c__had_nup_ass


553 (*
__nl_route
) (*);

554 *
__nl_g
;

555 
__do_
;

556 
__nl_ty
;

558 
public
:

559 
	$__had_nup_ass
 ((*
__f
(*), *
__g
)

560 : 
	`__nl_route
 (
__f
), 
	`__nl_g
 (
__g
), 
	$__do_
 (1) { }

561 ~
	$__had_nup_ass
 ({ i(
__do_

	`__nl_route
 (
__nl_g
); 
	}
}

562 
	$__tdo
 (
__wv
{ 
__do_
 = __wv; 
	}
}

563 
	$__der
 ({ 
	`had_tny
 (
PTHREAD_CANCEL_DEFERRED
,

564 &
__nl_ty
); 
	}
}

565 
	$__e
 (cڡ { 
	`had_tny
 (
__nl_ty
, 0); 
	}
}

575 
	#had_nup_push
(
route
, 
g
) \

577 
__had_nup_ass
 
	`__ame
 (
route
, 
g
)

	)

581 
	#had_nup_p
(
execu
) \

582 
__ame
.
	`__tdo
 (
execu
); \

583 } 0)

	)

585 #ifde
__USE_GNU


589 
	#had_nup_push_der_
(
route
, 
g
) \

591 
__had_nup_ass
 
	`__ame
 (
route
, 
g
); \

592 
__ame
.
	`__der
 ()

	)

597 
	#had_nup_p_e_
(
execu
) \

598 
__ame
.
	`__e
 (); \

599 
__ame
.
	`__tdo
 (
execu
); \

600 } 0)

	)

607 
__ex_le
 

608 
	$__had_nup_route
 (
__had_nup_ame
 *
__ame
)

610 i(
__ame
->
__do_
)

611 
__ame
->
	`__nl_route
 (__ame->
__nl_g
);

612 
	}
}

621 
	#had_nup_push
(
route
, 
g
) \

623 
__had_nup_ame
 
__ame
 \

624 
	`__ibu__
 ((
	`__nup__
 (
__had_nup_route
))) \

625 { .
__nl_route
 = (
route
), .
__nl_g
 = (
g
), \

626 .
__do_
 = 1 };

	)

630 
	#had_nup_p
(
execu
) \

631 
__ame
.
__do_
 = (
execu
); \

632 } 0)

	)

634 #ifde
__USE_GNU


638 
	#had_nup_push_der_
(
route
, 
g
) \

640 
__had_nup_ame
 
__ame
 \

641 
	`__ibu__
 ((
	`__nup__
 (
__had_nup_route
))) \

642 { .
__nl_route
 = (
route
), .
__nl_g
 = (
g
), \

643 .
__do_
 = 1 }; \

644 (
	`had_tny
 (
PTHREAD_CANCEL_DEFERRED
, \

645 &
__ame
.
__nl_ty
)

	)

650 
	#had_nup_p_e_
(
execu
) \

651 (
	`had_tny
 (
__ame
.
__nl_ty
, 
NULL
); \

652 
__ame
.
__do_
 = (
execu
); \

653 } 0)

	)

664 
	#had_nup_push
(
route
, 
g
) \

666 
__had_unwd_buf_t
 
__nl_buf
; \

667 (*
__nl_route
(*(
route
); \

668 *
__nl_g
 = (
g
); \

669 
__n_f_
 = 
	`__sigtjmp
 ((
__jmp_buf_g
 *) (*) \

670 
__nl_buf
.
__nl_jmp_buf
, 0); \

671 i(
	`__glibc_uiky
 (
__n_f_
)) \

673 
	`__nl_route
 (
__nl_g
); \

674 
	`__had_unwd_xt
 (&
__nl_buf
); \

678 
	`__had_gi_nl
 (&
__nl_buf
); \

679 d{

	)

680 
__had_gi_nl
 (
__had_unwd_buf_t
 *
__buf
)

681 
__nup_f_ibu
;

685 
	#had_nup_p
(
execu
) \

688 
	`__had_uegi_nl
 (&
__nl_buf
); \

689 i(
execu
) \

690 
	`__nl_route
 (
__nl_g
); \

691 } 0)

	)

692 
	$__had_uegi_nl
 (
__had_unwd_buf_t
 *
__buf
)

693 
__nup_f_ibu
;

695 #ifde
__USE_GNU


699 
	#had_nup_push_der_
(
route
, 
g
) \

701 
__had_unwd_buf_t
 
__nl_buf
; \

702 (*
__nl_route
(*(
route
); \

703 *
__nl_g
 = (
g
); \

704 
__n_f_
 = 
	`__sigtjmp
 ((
__jmp_buf_g
 *) (*) \

705 
__nl_buf
.
__nl_jmp_buf
, 0); \

706 i(
	`__glibc_uiky
 (
__n_f_
)) \

708 
	`__nl_route
 (
__nl_g
); \

709 
	`__had_unwd_xt
 (&
__nl_buf
); \

713 
	`__had_gi_nl_der
 (&
__nl_buf
); \

714 d{

	)

715 
	`__had_gi_nl_der
 (
__had_unwd_buf_t
 *
__buf
)

716 
__nup_f_ibu
;

721 
	#had_nup_p_e_
(
execu
) \

724 
	`__had_uegi_nl_e
 (&
__nl_buf
); \

725 i(
execu
) \

726 
	`__nl_route
 (
__nl_g
); \

727 
	}
} 0)

	)

728 
	$__had_uegi_nl_e
 (
__had_unwd_buf_t
 *
__buf
)

729 
__nup_f_ibu
;

733 
	$__had_unwd_xt
 (
__had_unwd_buf_t
 *
__buf
)

734 
__nup_f_ibu
 
	`__ibu__
 ((
__nܑu__
))

735 #ide
SHARED


736 
	`__ibu__
 ((
__wk__
))

742 
__jmp_buf_g
;

743 
	$__sigtjmp
 (
__jmp_buf_g
 *
__v
, 
__vemask

__THROWNL
;

749 
	$had_mux_
 (
had_mux_t
 *
__mux
,

750 cڡ 
had_mux_t
 *
__mux
)

751 
__THROW
 
	`__nnu
 ((1));

754 
	$had_mux_deroy
 (
had_mux_t
 *
__mux
)

755 
__THROW
 
	`__nnu
 ((1));

758 
	$had_mux_ylock
 (
had_mux_t
 *
__mux
)

759 
__THROWNL
 
	`__nnu
 ((1));

762 
	$had_mux_lock
 (
had_mux_t
 *
__mux
)

763 
__THROWNL
 
	`__nnu
 ((1));

765 #ifde
__USE_XOPEN2K


767 
	$had_mux_timedlock
 (
had_mux_t
 *
__ri
 
__mux
,

768 cڡ 
timeec
 *
__ri


769 
__abime

__THROWNL
 
	`__nnu
 ((1, 2));

773 
	$had_mux_uock
 (
had_mux_t
 *
__mux
)

774 
__THROWNL
 
	`__nnu
 ((1));

778 
	$had_mux_giog
 (cڡ 
had_mux_t
 *

779 
__ri
 
__mux
,

780 *
__ri
 
__iog
)

781 
__THROW
 
	`__nnu
 ((1, 2));

785 
	$had_mux_riog
 (
had_mux_t
 *
__ri
 
__mux
,

786 
__iog
,

787 *
__ri
 
__d_g
)

788 
__THROW
 
	`__nnu
 ((1, 3));

791 #ifde
__USE_XOPEN2K8


793 
	$had_mux_csit
 (
had_mux_t
 *
__mux
)

794 
__THROW
 
	`__nnu
 ((1));

795 #ifde
__USE_GNU


796 
	$had_mux_csit_
 (
had_mux_t
 *
__mux
)

797 
__THROW
 
	`__nnu
 ((1));

806 
	$had_mux_
 (
had_mux_t
 *
__
)

807 
__THROW
 
	`__nnu
 ((1));

810 
	$had_mux_deroy
 (
had_mux_t
 *
__
)

811 
__THROW
 
	`__nnu
 ((1));

814 
	$had_mux_gpshed
 (cڡ 
had_mux_t
 *

815 
__ri
 
__
,

816 *
__ri
 
__pshed
)

817 
__THROW
 
	`__nnu
 ((1, 2));

820 
	$had_mux_shed
 (
had_mux_t
 *
__
,

821 
__pshed
)

822 
__THROW
 
	`__nnu
 ((1));

824 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K8


826 
	$had_mux_gty
 (cڡ 
had_mux_t
 *
__ri


827 
__
, *
__ri
 
__kd
)

828 
__THROW
 
	`__nnu
 ((1, 2));

833 
	$had_mux_y
 (
had_mux_t
 *
__
, 
__kd
)

834 
__THROW
 
	`__nnu
 ((1));

838 
	$had_mux_goc
 (cڡ 
had_mux_t
 *

839 
__ri
 
__
,

840 *
__ri
 
__oc
)

841 
__THROW
 
	`__nnu
 ((1, 2));

845 
	$had_mux_roc
 (
had_mux_t
 *
__
,

846 
__oc
)

847 
__THROW
 
	`__nnu
 ((1));

850 
	$had_mux_giog
 (cڡ 
had_mux_t
 *

851 
__ri
 
__
,

852 *
__ri
 
__iog
)

853 
__THROW
 
	`__nnu
 ((1, 2));

856 
	$had_mux_riog
 (
had_mux_t
 *
__
,

857 
__iog
)

858 
__THROW
 
	`__nnu
 ((1));

860 #ifde
__USE_XOPEN2K


862 
	$had_mux_grobu
 (cڡ 
had_mux_t
 *
__
,

863 *
__robuss
)

864 
__THROW
 
	`__nnu
 ((1, 2));

865 #ifde
__USE_GNU


866 
	$had_mux_grobu_
 (cڡ 
had_mux_t
 *
__
,

867 *
__robuss
)

868 
__THROW
 
	`__nnu
 ((1, 2));

872 
	$had_mux_obu
 (
had_mux_t
 *
__
,

873 
__robuss
)

874 
__THROW
 
	`__nnu
 ((1));

875 #ifde
__USE_GNU


876 
	$had_mux_obu_
 (
had_mux_t
 *
__
,

877 
__robuss
)

878 
__THROW
 
	`__nnu
 ((1));

883 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K


888 
	$had_rwlock_
 (
had_rwlock_t
 *
__ri
 
__rwlock
,

889 cڡ 
had_rwlock_t
 *
__ri


890 
__

__THROW
 
	`__nnu
 ((1));

893 
	$had_rwlock_deroy
 (
had_rwlock_t
 *
__rwlock
)

894 
__THROW
 
	`__nnu
 ((1));

897 
	$had_rwlock_rdlock
 (
had_rwlock_t
 *
__rwlock
)

898 
__THROWNL
 
	`__nnu
 ((1));

901 
	$had_rwlock_yrdlock
 (
had_rwlock_t
 *
__rwlock
)

902 
__THROWNL
 
	`__nnu
 ((1));

904 #ifde
__USE_XOPEN2K


906 
	$had_rwlock_timedrdlock
 (
had_rwlock_t
 *
__ri
 
__rwlock
,

907 cڡ 
timeec
 *
__ri


908 
__abime

__THROWNL
 
	`__nnu
 ((1, 2));

912 
	$had_rwlock_wock
 (
had_rwlock_t
 *
__rwlock
)

913 
__THROWNL
 
	`__nnu
 ((1));

916 
	$had_rwlock_ywock
 (
had_rwlock_t
 *
__rwlock
)

917 
__THROWNL
 
	`__nnu
 ((1));

919 #ifde
__USE_XOPEN2K


921 
	$had_rwlock_timedwock
 (
had_rwlock_t
 *
__ri
 
__rwlock
,

922 cڡ 
timeec
 *
__ri


923 
__abime

__THROWNL
 
	`__nnu
 ((1, 2));

927 
	$had_rwlock_uock
 (
had_rwlock_t
 *
__rwlock
)

928 
__THROWNL
 
	`__nnu
 ((1));

934 
	$had_rwlock_
 (
had_rwlock_t
 *
__
)

935 
__THROW
 
	`__nnu
 ((1));

938 
	$had_rwlock_deroy
 (
had_rwlock_t
 *
__
)

939 
__THROW
 
	`__nnu
 ((1));

942 
	$had_rwlock_gpshed
 (cڡ 
had_rwlock_t
 *

943 
__ri
 
__
,

944 *
__ri
 
__pshed
)

945 
__THROW
 
	`__nnu
 ((1, 2));

948 
	$had_rwlock_shed
 (
had_rwlock_t
 *
__
,

949 
__pshed
)

950 
__THROW
 
	`__nnu
 ((1));

953 
	$had_rwlock_gkd_
 (cڡ 
had_rwlock_t
 *

954 
__ri
 
__
,

955 *
__ri
 
__ef
)

956 
__THROW
 
	`__nnu
 ((1, 2));

959 
	$had_rwlock_tkd_
 (
had_rwlock_t
 *
__
,

960 
__ef

__THROW
 
	`__nnu
 ((1));

968 
	$had_cd_
 (
had_cd_t
 *
__ri
 
__cd
,

969 cڡ 
had_cd_t
 *
__ri
 
__cd_
)

970 
__THROW
 
	`__nnu
 ((1));

973 
	$had_cd_deroy
 (
had_cd_t
 *
__cd
)

974 
__THROW
 
	`__nnu
 ((1));

977 
	$had_cd_sigl
 (
had_cd_t
 *
__cd
)

978 
__THROWNL
 
	`__nnu
 ((1));

981 
	$had_cd_brd
 (
had_cd_t
 *
__cd
)

982 
__THROWNL
 
	`__nnu
 ((1));

989 
	$had_cd_wa
 (
had_cd_t
 *
__ri
 
__cd
,

990 
had_mux_t
 *
__ri
 
__mux
)

991 
	`__nnu
 ((1, 2));

1000 
	$had_cd_timedwa
 (
had_cd_t
 *
__ri
 
__cd
,

1001 
had_mux_t
 *
__ri
 
__mux
,

1002 cڡ 
timeec
 *
__ri
 
__abime
)

1003 
	`__nnu
 ((1, 2, 3));

1008 
	$had_cd_
 (
had_cd_t
 *
__
)

1009 
__THROW
 
	`__nnu
 ((1));

1012 
	$had_cd_deroy
 (
had_cd_t
 *
__
)

1013 
__THROW
 
	`__nnu
 ((1));

1016 
	$had_cd_gpshed
 (cڡ 
had_cd_t
 *

1017 
__ri
 
__
,

1018 *
__ri
 
__pshed
)

1019 
__THROW
 
	`__nnu
 ((1, 2));

1022 
	$had_cd_shed
 (
had_cd_t
 *
__
,

1023 
__pshed

__THROW
 
	`__nnu
 ((1));

1025 #ifde
__USE_XOPEN2K


1027 
	$had_cd_gock
 (cڡ 
had_cd_t
 *

1028 
__ri
 
__
,

1029 
__ockid_t
 *
__ri
 
__ock_id
)

1030 
__THROW
 
	`__nnu
 ((1, 2));

1033 
	$had_cd_tock
 (
had_cd_t
 *
__
,

1034 
__ockid_t
 
__ock_id
)

1035 
__THROW
 
	`__nnu
 ((1));

1039 #ifde
__USE_XOPEN2K


1044 
	$had__
 (
had_lock_t
 *
__lock
, 
__pshed
)

1045 
__THROW
 
	`__nnu
 ((1));

1048 
	$had__deroy
 (
had_lock_t
 *
__lock
)

1049 
__THROW
 
	`__nnu
 ((1));

1052 
	$had__lock
 (
had_lock_t
 *
__lock
)

1053 
__THROWNL
 
	`__nnu
 ((1));

1056 
	$had__ylock
 (
had_lock_t
 *
__lock
)

1057 
__THROWNL
 
	`__nnu
 ((1));

1060 
	$had__uock
 (
had_lock_t
 *
__lock
)

1061 
__THROWNL
 
	`__nnu
 ((1));

1068 
	$had_brr_
 (
had_brr_t
 *
__ri
 
__brr
,

1069 cڡ 
had_brr_t
 *
__ri


1070 
__
, 
__cou
)

1071 
__THROW
 
	`__nnu
 ((1));

1074 
	$had_brr_deroy
 (
had_brr_t
 *
__brr
)

1075 
__THROW
 
	`__nnu
 ((1));

1078 
	$had_brr_wa
 (
had_brr_t
 *
__brr
)

1079 
__THROWNL
 
	`__nnu
 ((1));

1083 
	$had_brr_
 (
had_brr_t
 *
__
)

1084 
__THROW
 
	`__nnu
 ((1));

1087 
	$had_brr_deroy
 (
had_brr_t
 *
__
)

1088 
__THROW
 
	`__nnu
 ((1));

1091 
	$had_brr_gpshed
 (cڡ 
had_brr_t
 *

1092 
__ri
 
__
,

1093 *
__ri
 
__pshed
)

1094 
__THROW
 
	`__nnu
 ((1, 2));

1097 
	$had_brr_shed
 (
had_brr_t
 *
__
,

1098 
__pshed
)

1099 
__THROW
 
	`__nnu
 ((1));

1111 
	$had_key_
 (
had_key_t
 *
__key
,

1112 (*
__der_funi
) (*))

1113 
__THROW
 
	`__nnu
 ((1));

1116 
	$had_key_de
 (
had_key_t
 
__key

__THROW
;

1119 *
	$had_gecific
 (
had_key_t
 
__key

__THROW
;

1122 
	$had_tecific
 (
had_key_t
 
__key
,

1123 cڡ *
__por

__THROW
 ;

1126 #ifde
__USE_XOPEN2K


1128 
	$had_guockid
 (
had_t
 
__thad_id
,

1129 
__ockid_t
 *
__ock_id
)

1130 
__THROW
 
	`__nnu
 ((2));

1145 
	$had_fk
 ((*
__e
) (),

1146 (*
__
) (),

1147 (*
__chd
()
__THROW
;

1150 #ifde
__USE_EXTERN_INLINES


1152 
__ex_le
 

1153 
	`__NTH
 (
	$had_equ
 (
had_t
 
__thad1
,thad_
__thad2
))

1155  
__thad1
 =
__thad2
;

1156 
	}
}

1159 
	g__END_DECLS


	@/usr/include/sched.h

19 #idef 
_SCHED_H


20 
	#_SCHED_H
 1

	)

22 
	~<us.h
>

25 
	~<bs/tys.h
>

27 
	#__ed_size_t


	)

28 
	~<ddef.h
>

30 #ifde
__USE_XOPEN2K


31 
	#__ed_time_t


	)

32 
	#__ed_timeec


	)

34 
	~<time.h
>

36 #ide
__pid_t_defed


37 
__pid_t
 
	tpid_t
;

38 
	#__pid_t_defed


	)

43 
	~<bs/sched.h
>

45 
	#sched_iܙy
 
__sched_iܙy


	)

48 
__BEGIN_DECLS


51 
	$sched_am
 (
__pid_t
 
__pid
, cڡ 
sched_m
 *
__m
)

52 
__THROW
;

55 
	$sched_gm
 (
__pid_t
 
__pid
, 
sched_m
 *
__m

__THROW
;

58 
	$sched_tschedur
 (
__pid_t
 
__pid
, 
__picy
,

59 cڡ 
sched_m
 *
__m

__THROW
;

62 
	$sched_gschedur
 (
__pid_t
 
__pid

__THROW
;

65 
	$sched_yld
 (
__THROW
;

68 
	$sched_g_iܙy_max
 (
__gܙhm

__THROW
;

71 
	$sched_g_iܙy_m
 (
__gܙhm

__THROW
;

74 
	$sched__g_rv
 (
__pid_t
 
__pid
, 
timeec
 *
__t

__THROW
;

77 #ifde
__USE_GNU


79 
	#CPU_SETSIZE
 
__CPU_SETSIZE


	)

80 
	#CPU_SET
(
u
, 
u

	`__CPU_SET_S
 (u,  (
u_t_t
), cpu)

	)

81 
	#CPU_CLR
(
u
, 
u

	`__CPU_CLR_S
 (u,  (
u_t_t
), cpu)

	)

82 
	#CPU_ISSET
(
u
, 
u

	`__CPU_ISSET_S
 (u,  (
u_t_t
), \

83 
u
)

	)

84 
	#CPU_ZERO
(
u

	`__CPU_ZERO_S
 ( (
u_t_t
), cpu)

	)

85 
	#CPU_COUNT
(
u

	`__CPU_COUNT_S
 ( (
u_t_t
), cpu)

	)

87 
	#CPU_SET_S
(
u
, 
tsize
, 
u

	`__CPU_SET_S
 (u, ssize, cpu)

	)

88 
	#CPU_CLR_S
(
u
, 
tsize
, 
u

	`__CPU_CLR_S
 (u, ssize, cpu)

	)

89 
	#CPU_ISSET_S
(
u
, 
tsize
, 
u

	`__CPU_ISSET_S
 (cpu, setsize, \

90 
u
)

	)

91 
	#CPU_ZERO_S
(
tsize
, 
u

	`__CPU_ZERO_S
 (tsize, cpu)

	)

92 
	#CPU_COUNT_S
(
tsize
, 
u

	`__CPU_COUNT_S
 (tsize, cpu)

	)

94 
	#CPU_EQUAL
(
u1
, 
u2
) \

95 
	`__CPU_EQUAL_S
 ( (
u_t_t
), 
u1
, 
u2
)

	)

96 
	#CPU_EQUAL_S
(
tsize
, 
u1
, 
u2
) \

97 
	`__CPU_EQUAL_S
 (
tsize
, 
u1
, 
u2
)

	)

99 
	#CPU_AND
(
det
, 
ct1
, 
ct2
) \

100 
	`__CPU_OP_S
 ( (
u_t_t
), 
det
, 
ct1
, 
ct2
, &)

	)

101 
	#CPU_OR
(
det
, 
ct1
, 
ct2
) \

102 
	`__CPU_OP_S
 ( (
u_t_t
), 
det
, 
ct1
, 
ct2
, |)

	)

103 
	#CPU_XOR
(
det
, 
ct1
, 
ct2
) \

104 
	`__CPU_OP_S
 ( (
u_t_t
), 
det
, 
ct1
, 
ct2
, ^)

	)

105 
	#CPU_AND_S
(
tsize
, 
det
, 
ct1
, 
ct2
) \

106 
	`__CPU_OP_S
 (
tsize
, 
det
, 
ct1
, 
ct2
, &)

	)

107 
	#CPU_OR_S
(
tsize
, 
det
, 
ct1
, 
ct2
) \

108 
	`__CPU_OP_S
 (
tsize
, 
det
, 
ct1
, 
ct2
, |)

	)

109 
	#CPU_XOR_S
(
tsize
, 
det
, 
ct1
, 
ct2
) \

110 
	`__CPU_OP_S
 (
tsize
, 
det
, 
ct1
, 
ct2
, ^)

	)

112 
	#CPU_ALLOC_SIZE
(
cou

	`__CPU_ALLOC_SIZE
 (cou)

	)

113 
	#CPU_ALLOC
(
cou

	`__CPU_ALLOC
 (cou)

	)

114 
	#CPU_FREE
(
ut

	`__CPU_FREE
 (ut)

	)

118 
	$sched_ffy
 (
__pid_t
 
__pid
, 
size_t
 
__utsize
,

119 cڡ 
u_t_t
 *
__ut

__THROW
;

122 
	$sched_gaffy
 (
__pid_t
 
__pid
, 
size_t
 
__utsize
,

123 
u_t_t
 *
__ut

__THROW
;

126 
__END_DECLS


	@/usr/include/semaphore.h

18 #ide
_SEMAPHORE_H


19 
	#_SEMAPHORE_H
 1

	)

21 
	~<us.h
>

22 
	~<sys/tys.h
>

23 #ifde
__USE_XOPEN2K


24 
	#__ed_timeec


	)

25 
	~<time.h
>

29 
	~<bs/mhe.h
>

32 
__BEGIN_DECLS


36 
	$m_
 (
m_t
 *
__m
, 
__pshed
, 
__vue
)

37 
__THROW
;

39 
	$m_deroy
 (
m_t
 *
__m

__THROW
;

42 
m_t
 *
	$m_ݒ
 (cڡ *
__me
, 
__oag
, ...
__THROW
;

45 
	$m_o
 (
m_t
 *
__m

__THROW
;

48 
	$m_uƚk
 (cڡ *
__me

__THROW
;

54 
	`m_wa
 (
m_t
 *
__m
);

56 #ifde
__USE_XOPEN2K


61 
	`m_timedwa
 (
m_t
 *
__ri
 
__m
,

62 cڡ 
timeec
 *
__ri
 
__abime
);

66 
	$m_ywa
 (
m_t
 *
__m

__THROWNL
;

69 
	$m_po
 (
m_t
 *
__m

__THROWNL
;

72 
	$m_gvue
 (
m_t
 *
__ri
 
__m
, *__ri 
__sv
)

73 
__THROW
;

76 
__END_DECLS


	@/usr/include/signal.h

22 #idef 
_SIGNAL_H


24 #i!
defed
 
__ed_sig_omic_t
 && !defed 
__ed_sigt_t


25 
	#_SIGNAL_H


	)

28 
	~<us.h
>

30 
	g__BEGIN_DECLS


32 
	~<bs/sigt.h
>

36 #i
defed
 
__ed_sig_omic_t
 || defed 
_SIGNAL_H


37 #ide
__sig_omic_t_defed


38 
	#__sig_omic_t_defed


	)

39 
__BEGIN_NAMESPACE_STD


40 
__sig_omic_t
 
	tsig_omic_t
;

41 
	g__END_NAMESPACE_STD


43 #unde
__ed_sig_omic_t


46 #i
defed
 
__ed_sigt_t
 || (defed 
_SIGNAL_H
 && defed 
__USE_POSIX
)

47 #ide
__sigt_t_defed


48 
	#__sigt_t_defed


	)

49 
__sigt_t
 
	tsigt_t
;

51 #unde
__ed_sigt_t


54 #ifde
_SIGNAL_H


56 
	~<bs/tys.h
>

57 
	~<bs/signum.h
>

59 #i
defed
 
__USE_XOPEN
 || defed 
__USE_XOPEN2K


60 #ide
__pid_t_defed


61 
__pid_t
 
	tpid_t
;

62 
	#__pid_t_defed


	)

64 #ifde
__USE_XOPEN


66 #ide
__uid_t_defed


67 
__uid_t
 
	tuid_t
;

68 
	#__uid_t_defed


	)

72 #ifde
__USE_POSIX199309


74 
	#__ed_timeec


	)

75 
	~<time.h
>

78 #i
defed
 
__USE_POSIX199309
 || defed 
__USE_XOPEN_EXTENDED


80 
	~<bs/sigfo.h
>

85 (*
	t__sighdr_t
) ();

90 
__sighdr_t
 
	$__sysv_sigl
 (
__sig
, 
__sighdr_t
 
__hdr
)

91 
__THROW
;

92 #ifde
__USE_GNU


93 
__sighdr_t
 
	$sysv_sigl
 (
__sig
, 
__sighdr_t
 
__hdr
)

94 
__THROW
;

100 
__BEGIN_NAMESPACE_STD


101 #ifde
__USE_MISC


102 
__sighdr_t
 
	$sigl
 (
__sig
, 
__sighdr_t
 
__hdr
)

103 
__THROW
;

106 #ifde
__REDIRECT_NTH


107 
__sighdr_t
 
	`__REDIRECT_NTH
 (
sigl
,

108 (
__sig
, 
__sighdr_t
 
__hdr
),

109 
__sysv_sigl
);

111 
	#sigl
 
__sysv_sigl


	)

114 
__END_NAMESPACE_STD


116 #ifde
__USE_XOPEN


119 
__sighdr_t
 
	$bsd_sigl
 (
__sig
, 
__sighdr_t
 
__hdr
)

120 
__THROW
;

126 #ifde
__USE_POSIX


127 
	$kl
 (
__pid_t
 
__pid
, 
__sig

__THROW
;

130 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED


134 
	$kg
 (
__pid_t
 
__pg
, 
__sig

__THROW
;

137 
__BEGIN_NAMESPACE_STD


139 
	$i
 (
__sig

__THROW
;

140 
__END_NAMESPACE_STD


142 #ifde
__USE_MISC


144 
__sighdr_t
 
	$ssigl
 (
__sig
, 
__sighdr_t
 
__hdr
)

145 
__THROW
;

146 
	$gsigl
 (
__sig

__THROW
;

149 #ifde
__USE_XOPEN2K8


151 
	`psigl
 (
__sig
, cڡ *
__s
);

154 
	`psigfo
 (cڡ 
sigfo_t
 *
__pfo
, cڡ *
__s
);

166 #ifde
__USE_XOPEN


167 #ifde
__GNUC__


168 
	$sigu
 (
__sig

	`__asm__
 ("__xpg_sigpause");

170 
	`__sigu
 (
__sig__mask
, 
__is_sig
);

172 
	#sigu
(
sig

	`__sigu
 ((sig), 1)

	)

177 #ifde
__USE_MISC


184 
	#sigmask
(
sig

	`__sigmask
(sig)

	)

187 
	$sigblock
 (
__mask

__THROW
 
__ibu_dd__
;

190 
	$sigtmask
 (
__mask

__THROW
 
__ibu_dd__
;

193 
	$siggmask
 (
__THROW
 
__ibu_dd__
;

197 #ifde
__USE_MISC


198 
	#NSIG
 
_NSIG


	)

201 #ifde
__USE_GNU


202 
__sighdr_t
 
	tsighdr_t
;

206 #ifde
__USE_MISC


207 
__sighdr_t
 
	tsig_t
;

210 #ifde
__USE_POSIX


213 
	$sigemyt
 (
sigt_t
 *
__t

__THROW
 
	`__nnu
 ((1));

216 
	$sigflt
 (
sigt_t
 *
__t

__THROW
 
	`__nnu
 ((1));

219 
	$sigaddt
 (
sigt_t
 *
__t
, 
__signo

__THROW
 
	`__nnu
 ((1));

222 
	$sigdt
 (
sigt_t
 *
__t
, 
__signo

__THROW
 
	`__nnu
 ((1));

225 
	$sigismemb
 (cڡ 
sigt_t
 *
__t
, 
__signo
)

226 
__THROW
 
	`__nnu
 ((1));

228 #ifde
__USE_GNU


230 
	$sigimyt
 (cڡ 
sigt_t
 *
__t

__THROW
 
	`__nnu
 ((1));

233 
	$sigdt
 (
sigt_t
 *
__t
, cڡ sigt_*
__
,

234 cڡ 
sigt_t
 *
__right

__THROW
 
	`__nnu
 ((1, 2, 3));

237 
	$sigܣt
 (
sigt_t
 *
__t
, cڡ sigt_*
__
,

238 cڡ 
sigt_t
 *
__right

__THROW
 
	`__nnu
 ((1, 2, 3));

243 
	~<bs/sigai.h
>

246 
	$sigocmask
 (
__how
, cڡ 
sigt_t
 *
__ri
 
__t
,

247 
sigt_t
 *
__ri
 
__ot

__THROW
;

254 
	$sigsud
 (cڡ 
sigt_t
 *
__t

	`__nnu
 ((1));

257 
	$sigai
 (
__sig
, cڡ 
sigai
 *
__ri
 
__a
,

258 
sigai
 *
__ri
 
__

__THROW
;

261 
	$signdg
 (
sigt_t
 *
__t

__THROW
 
	`__nnu
 ((1));

268 
	$sigwa
 (cڡ 
sigt_t
 *
__ri
 
__t
, *__ri 
__sig
)

269 
	`__nnu
 ((1, 2));

271 #ifde
__USE_POSIX199309


276 
	$sigwafo
 (cڡ 
sigt_t
 *
__ri
 
__t
,

277 
sigfo_t
 *
__ri
 
__fo

	`__nnu
 ((1));

284 
	$sigtimedwa
 (cڡ 
sigt_t
 *
__ri
 
__t
,

285 
sigfo_t
 *
__ri
 
__fo
,

286 cڡ 
timeec
 *
__ri
 
__timeout
)

287 
	`__nnu
 ((1));

291 
	$sigqueue
 (
__pid_t
 
__pid
, 
__sig
, cڡ 
sigv
 
__v
)

292 
__THROW
;

297 #ifde
__USE_MISC


301 cڡ *cڡ 
_sys_sigli
[
_NSIG
];

302 cڡ *cڡ 
sys_sigli
[
_NSIG
];

306 
	~<bs/sigcڋxt.h
>

309 
	$sigtu
 (
sigcڋxt
 *
__s

__THROW
;

314 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K8


315 
	#__ed_size_t


	)

316 
	~<ddef.h
>

321 
	$sigu
 (
__sig
, 
__u

__THROW
;

323 
	~<bs/sigack.h
>

324 #i
defed
 
__USE_XOPEN
 || defed 
__USE_XOPEN2K8


326 
	~<sys/ucڋxt.h
>

332 
	$sigack
 (
sigack
 *
__ss
, sigack *
__oss
)

333 
__THROW
 
__ibu_dd__
;

337 
	$sigtack
 (cڡ 
sigtack
 *
__ri
 
__ss
,

338 
sigtack
 *
__ri
 
__oss

__THROW
;

342 #ifde
__USE_XOPEN_EXTENDED


346 
	$sighd
 (
__sig

__THROW
;

349 
	$sigl
 (
__sig

__THROW
;

352 
	$sigigne
 (
__sig

__THROW
;

355 
__sighdr_t
 
	$sigt
 (
__sig
, 
__sighdr_t
 
__di

__THROW
;

358 #i
defed
 
__USE_POSIX199506
 || defed 
__USE_UNIX98


361 
	~<bs/hadtys.h
>

362 
	~<bs/sigthad.h
>

369 
	$__libc_cut_sigm
 (
__THROW
;

371 
	$__libc_cut_sigmax
 (
__THROW
;

375 
__END_DECLS


	@/usr/include/stdint.h

22 #ide
_STDINT_H


23 
	#_STDINT_H
 1

	)

25 
	~<us.h
>

26 
	~<bs/wch.h
>

27 
	~<bs/wdsize.h
>

34 #ide
__t8_t_defed


35 
	#__t8_t_defed


	)

36 sigd 
	tt8_t
;

37 
	tt16_t
;

38 
	tt32_t
;

39 #i
__WORDSIZE
 == 64

40 
	tt64_t
;

42 
__exnsi__


43 
	tt64_t
;

48 
	tut8_t
;

49 
	tut16_t
;

50 #ide
__ut32_t_defed


51 
	tut32_t
;

52 
	#__ut32_t_defed


	)

54 #i
__WORDSIZE
 == 64

55 
	tut64_t
;

57 
__exnsi__


58 
	tut64_t
;

65 sigd 
	tt_a8_t
;

66 
	tt_a16_t
;

67 
	tt_a32_t
;

68 #i
__WORDSIZE
 == 64

69 
	tt_a64_t
;

71 
__exnsi__


72 
	tt_a64_t
;

76 
	tut_a8_t
;

77 
	tut_a16_t
;

78 
	tut_a32_t
;

79 #i
__WORDSIZE
 == 64

80 
	tut_a64_t
;

82 
__exnsi__


83 
	tut_a64_t
;

90 sigd 
	tt_8_t
;

91 #i
__WORDSIZE
 == 64

92 
	tt_16_t
;

93 
	tt_32_t
;

94 
	tt_64_t
;

96 
	tt_16_t
;

97 
	tt_32_t
;

98 
__exnsi__


99 
	tt_64_t
;

103 
	tut_8_t
;

104 #i
__WORDSIZE
 == 64

105 
	tut_16_t
;

106 
	tut_32_t
;

107 
	tut_64_t
;

109 
	tut_16_t
;

110 
	tut_32_t
;

111 
__exnsi__


112 
	tut_64_t
;

117 #i
__WORDSIZE
 == 64

118 #ide
___t_defed


119 
	t_t
;

120 
	#___t_defed


	)

122 
	tu_t
;

124 #ide
___t_defed


125 
	t_t
;

126 
	#___t_defed


	)

128 
	tu_t
;

133 #i
__WORDSIZE
 == 64

134 
	ttmax_t
;

135 
	tutmax_t
;

137 
__exnsi__


138 
	ttmax_t
;

139 
__exnsi__


140 
	tutmax_t
;

144 #i
__WORDSIZE
 == 64

145 
	#__INT64_C
(
c
## 
L


	)

146 
	#__UINT64_C
(
c
## 
UL


	)

148 
	#__INT64_C
(
c
## 
LL


	)

149 
	#__UINT64_C
(
c
## 
ULL


	)

155 
	#INT8_MIN
 (-128)

	)

156 
	#INT16_MIN
 (-32767-1)

	)

157 
	#INT32_MIN
 (-2147483647-1)

	)

158 
	#INT64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

160 
	#INT8_MAX
 (127)

	)

161 
	#INT16_MAX
 (32767)

	)

162 
	#INT32_MAX
 (2147483647)

	)

163 
	#INT64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

166 
	#UINT8_MAX
 (255)

	)

167 
	#UINT16_MAX
 (65535)

	)

168 
	#UINT32_MAX
 (4294967295U)

	)

169 
	#UINT64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

173 
	#INT_LEAST8_MIN
 (-128)

	)

174 
	#INT_LEAST16_MIN
 (-32767-1)

	)

175 
	#INT_LEAST32_MIN
 (-2147483647-1)

	)

176 
	#INT_LEAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

178 
	#INT_LEAST8_MAX
 (127)

	)

179 
	#INT_LEAST16_MAX
 (32767)

	)

180 
	#INT_LEAST32_MAX
 (2147483647)

	)

181 
	#INT_LEAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

184 
	#UINT_LEAST8_MAX
 (255)

	)

185 
	#UINT_LEAST16_MAX
 (65535)

	)

186 
	#UINT_LEAST32_MAX
 (4294967295U)

	)

187 
	#UINT_LEAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

191 
	#INT_FAST8_MIN
 (-128)

	)

192 #i
__WORDSIZE
 == 64

193 
	#INT_FAST16_MIN
 (-9223372036854775807L-1)

	)

194 
	#INT_FAST32_MIN
 (-9223372036854775807L-1)

	)

196 
	#INT_FAST16_MIN
 (-2147483647-1)

	)

197 
	#INT_FAST32_MIN
 (-2147483647-1)

	)

199 
	#INT_FAST64_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

201 
	#INT_FAST8_MAX
 (127)

	)

202 #i
__WORDSIZE
 == 64

203 
	#INT_FAST16_MAX
 (9223372036854775807L)

	)

204 
	#INT_FAST32_MAX
 (9223372036854775807L)

	)

206 
	#INT_FAST16_MAX
 (2147483647)

	)

207 
	#INT_FAST32_MAX
 (2147483647)

	)

209 
	#INT_FAST64_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

212 
	#UINT_FAST8_MAX
 (255)

	)

213 #i
__WORDSIZE
 == 64

214 
	#UINT_FAST16_MAX
 (18446744073709551615UL)

	)

215 
	#UINT_FAST32_MAX
 (18446744073709551615UL)

	)

217 
	#UINT_FAST16_MAX
 (4294967295U)

	)

218 
	#UINT_FAST32_MAX
 (4294967295U)

	)

220 
	#UINT_FAST64_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

224 #i
__WORDSIZE
 == 64

225 
	#INTPTR_MIN
 (-9223372036854775807L-1)

	)

226 
	#INTPTR_MAX
 (9223372036854775807L)

	)

227 
	#UINTPTR_MAX
 (18446744073709551615UL)

	)

229 
	#INTPTR_MIN
 (-2147483647-1)

	)

230 
	#INTPTR_MAX
 (2147483647)

	)

231 
	#UINTPTR_MAX
 (4294967295U)

	)

236 
	#INTMAX_MIN
 (-
	`__INT64_C
(9223372036854775807)-1)

	)

238 
	#INTMAX_MAX
 (
	`__INT64_C
(9223372036854775807))

	)

241 
	#UINTMAX_MAX
 (
	`__UINT64_C
(18446744073709551615))

	)

247 #i
__WORDSIZE
 == 64

248 
	#PTRDIFF_MIN
 (-9223372036854775807L-1)

	)

249 
	#PTRDIFF_MAX
 (9223372036854775807L)

	)

251 
	#PTRDIFF_MIN
 (-2147483647-1)

	)

252 
	#PTRDIFF_MAX
 (2147483647)

	)

256 
	#SIG_ATOMIC_MIN
 (-2147483647-1)

	)

257 
	#SIG_ATOMIC_MAX
 (2147483647)

	)

260 #i
__WORDSIZE
 == 64

261 
	#SIZE_MAX
 (18446744073709551615UL)

	)

263 #ifde
__WORDSIZE32_SIZE_ULONG


264 
	#SIZE_MAX
 (4294967295UL)

	)

266 
	#SIZE_MAX
 (4294967295U)

	)

271 #ide
WCHAR_MIN


273 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

274 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

278 
	#WINT_MIN
 (0u)

	)

279 
	#WINT_MAX
 (4294967295u)

	)

282 
	#INT8_C
(
c

	)
c

283 
	#INT16_C
(
c

	)
c

284 
	#INT32_C
(
c

	)
c

285 #i
__WORDSIZE
 == 64

286 
	#INT64_C
(
c
## 
L


	)

288 
	#INT64_C
(
c
## 
LL


	)

292 
	#UINT8_C
(
c

	)
c

293 
	#UINT16_C
(
c

	)
c

294 
	#UINT32_C
(
c
## 
U


	)

295 #i
__WORDSIZE
 == 64

296 
	#UINT64_C
(
c
## 
UL


	)

298 
	#UINT64_C
(
c
## 
ULL


	)

302 #i
__WORDSIZE
 == 64

303 
	#INTMAX_C
(
c
## 
L


	)

304 
	#UINTMAX_C
(
c
## 
UL


	)

306 
	#INTMAX_C
(
c
## 
LL


	)

307 
	#UINTMAX_C
(
c
## 
ULL


	)

	@/usr/include/stdio.h

23 #ide
_STDIO_H


25 #i!
defed
 
__ed_FILE
 && !defed 
__ed___FILE


26 
	#_STDIO_H
 1

	)

27 
	~<us.h
>

29 
	g__BEGIN_DECLS


31 
	#__ed_size_t


	)

32 
	#__ed_NULL


	)

33 
	~<ddef.h
>

35 
	~<bs/tys.h
>

36 
	#__ed_FILE


	)

37 
	#__ed___FILE


	)

41 #i!
defed
 
__FILE_defed
 && defed 
__ed_FILE


44 
	g_IO_FILE
;

46 
__BEGIN_NAMESPACE_STD


48 
_IO_FILE
 
	tFILE
;

49 
	g__END_NAMESPACE_STD


50 #i
defed
 
__USE_LARGEFILE64
 || defed 
__USE_POSIX
 \

51 || 
defed
 
	g__USE_ISOC99
 || defed 
	g__USE_XOPEN
 \

52 || 
defed
 
__USE_POSIX2


53 
	$__USING_NAMESPACE_STD
(
FILE
)

56 
	#__FILE_defed
 1

	)

58 #unde
__ed_FILE


61 #i!
defed
 
____FILE_defed
 && defed 
__ed___FILE


64 
_IO_FILE
 
	t__FILE
;

66 
	#____FILE_defed
 1

	)

68 #unde
__ed___FILE


71 #ifdef 
_STDIO_H


72 
	#_STDIO_USES_IOSTREAM


	)

74 
	~<libio.h
>

76 #i
defed
 
__USE_XOPEN
 || defed 
__USE_XOPEN2K8


77 #ifde
__GNUC__


78 #ide
_VA_LIST_DEFINED


79 
_G_va_li
 
	tva_li
;

80 
	#_VA_LIST_DEFINED


	)

83 
	~<dg.h
>

87 #ifde
__USE_XOPEN2K8


88 #ide
__off_t_defed


89 #ide
__USE_FILE_OFFSET64


90 
__off_t
 
	toff_t
;

92 
__off64_t
 
	toff_t
;

94 
	#__off_t_defed


	)

96 #i
defed
 
__USE_LARGEFILE64
 && !defed 
__off64_t_defed


97 
__off64_t
 
	toff64_t
;

98 
	#__off64_t_defed


	)

101 #ide
__ssize_t_defed


102 
__ssize_t
 
	tssize_t
;

103 
	#__ssize_t_defed


	)

108 
__BEGIN_NAMESPACE_STD


109 #ide
__USE_FILE_OFFSET64


110 
_G_os_t
 
	tos_t
;

112 
_G_os64_t
 
	tos_t
;

114 
__END_NAMESPACE_STD


115 #ifde
__USE_LARGEFILE64


116 
_G_os64_t
 
	tos64_t
;

120 
	#_IOFBF
 0

	)

121 
	#_IOLBF
 1

	)

122 
	#_IONBF
 2

	)

126 #ide
BUFSIZ


127 
	#BUFSIZ
 
_IO_BUFSIZ


	)

133 #ide
EOF


134 
	#EOF
 (-1)

	)

140 
	#SEEK_SET
 0

	)

141 
	#SEEK_CUR
 1

	)

142 
	#SEEK_END
 2

	)

143 #ifde
__USE_GNU


144 
	#SEEK_DATA
 3

	)

145 
	#SEEK_HOLE
 4

	)

149 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


151 
	#P_tmpd
 "/tmp"

	)

164 
	~<bs/dio_lim.h
>

168 
_IO_FILE
 *
d
;

169 
_IO_FILE
 *
dout
;

170 
_IO_FILE
 *
dr
;

172 
	#d
 
d


	)

173 
	#dout
 
dout


	)

174 
	#dr
 
dr


	)

176 
__BEGIN_NAMESPACE_STD


178 
	$move
 (cڡ *
__fame

__THROW
;

180 
	$me
 (cڡ *
__d
, cڡ *
__w

__THROW
;

181 
__END_NAMESPACE_STD


183 #ifde
__USE_ATFILE


185 
	$mt
 (
__dfd
, cڡ *
__d
, 
__wfd
,

186 cڡ *
__w

__THROW
;

189 
__BEGIN_NAMESPACE_STD


194 #ide
__USE_FILE_OFFSET64


195 
FILE
 *
	$tmpfe
 (
__wur
;

197 #ifde
__REDIRECT


198 
FILE
 *
	`__REDIRECT
 (
tmpfe
, (), 
tmpfe64

__wur
;

200 
	#tmpfe
 
tmpfe64


	)

204 #ifde
__USE_LARGEFILE64


205 
FILE
 *
	$tmpfe64
 (
__wur
;

209 *
	$tmam
 (*
__s

__THROW
 
__wur
;

210 
__END_NAMESPACE_STD


212 #ifde
__USE_MISC


215 *
	$tmam_r
 (*
__s

__THROW
 
__wur
;

219 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


227 *
	$mam
 (cڡ *
__d
, cڡ *
__pfx
)

228 
__THROW
 
__ibu_mloc__
 
__wur
;

232 
__BEGIN_NAMESPACE_STD


237 
	`fo
 (
FILE
 *
__am
);

242 
	`fush
 (
FILE
 *
__am
);

243 
__END_NAMESPACE_STD


245 #ifde
__USE_MISC


252 
	`fush_uocked
 (
FILE
 *
__am
);

255 #ifde
__USE_GNU


262 
	`fol
 ();

266 
__BEGIN_NAMESPACE_STD


267 #ide
__USE_FILE_OFFSET64


272 
FILE
 *
	$fݒ
 (cڡ *
__ri
 
__fame
,

273 cڡ *
__ri
 
__modes

__wur
;

278 
FILE
 *
	$eݒ
 (cڡ *
__ri
 
__fame
,

279 cڡ *
__ri
 
__modes
,

280 
FILE
 *
__ri
 
__am

__wur
;

282 #ifde
__REDIRECT


283 
FILE
 *
	`__REDIRECT
 (
fݒ
, (cڡ *
__ri
 
__fame
,

284 cڡ *
__ri
 
__modes
), 
fݒ64
)

285 
__wur
;

286 
FILE
 *
	`__REDIRECT
 (
eݒ
, (cڡ *
__ri
 
__fame
,

287 cڡ *
__ri
 
__modes
,

288 
FILE
 *
__ri
 
__am
), 
eݒ64
)

289 
__wur
;

291 
	#fݒ
 
fݒ64


	)

292 
	#eݒ
 
eݒ64


	)

295 
__END_NAMESPACE_STD


296 #ifde
__USE_LARGEFILE64


297 
FILE
 *
	$fݒ64
 (cڡ *
__ri
 
__fame
,

298 cڡ *
__ri
 
__modes

__wur
;

299 
FILE
 *
	$eݒ64
 (cڡ *
__ri
 
__fame
,

300 cڡ *
__ri
 
__modes
,

301 
FILE
 *
__ri
 
__am

__wur
;

304 #ifdef 
__USE_POSIX


306 
FILE
 *
	$fdݒ
 (
__fd
, cڡ *
__modes

__THROW
 
__wur
;

309 #ifdef 
__USE_GNU


312 
FILE
 *
	$fݒcook
 (*
__ri
 
__magic_cook
,

313 cڡ *
__ri
 
__modes
,

314 
_IO_cook_io_funis_t
 
__io_funcs

__THROW
 
__wur
;

317 #ifde
__USE_XOPEN2K8


319 
FILE
 *
	$fmemݒ
 (*
__s
, 
size_t
 
__n
, cڡ *
__modes
)

320 
__THROW
 
__wur
;

325 
FILE
 *
	$ݒ_memam
 (**
__buoc
, 
size_t
 *
__sizoc

__THROW
 
__wur
;

329 
__BEGIN_NAMESPACE_STD


332 
	$tbuf
 (
FILE
 *
__ri
 
__am
, *__ri 
__buf

__THROW
;

336 
	$tvbuf
 (
FILE
 *
__ri
 
__am
, *__ri 
__buf
,

337 
__modes
, 
size_t
 
__n

__THROW
;

338 
__END_NAMESPACE_STD


340 #ifdef 
__USE_MISC


343 
	$tbufr
 (
FILE
 *
__ri
 
__am
, *__ri 
__buf
,

344 
size_t
 
__size

__THROW
;

347 
	$ebuf
 (
FILE
 *
__am

__THROW
;

351 
__BEGIN_NAMESPACE_STD


356 
	`rtf
 (
FILE
 *
__ri
 
__am
,

357 cڡ *
__ri
 
__fm
, ...);

362 
	`tf
 (cڡ *
__ri
 
__fm
, ...);

364 
	$rtf
 (*
__ri
 
__s
,

365 cڡ *
__ri
 
__fm
, ...
__THROWNL
;

371 
	`vrtf
 (
FILE
 *
__ri
 
__s
, cڡ *__ri 
__fm
,

372 
_G_va_li
 
__g
);

377 
	`vtf
 (cڡ *
__ri
 
__fm
, 
_G_va_li
 
__g
);

379 
	$vrtf
 (*
__ri
 
__s
, cڡ *__ri 
__fm
,

380 
_G_va_li
 
__g

__THROWNL
;

381 
__END_NAMESPACE_STD


383 #i
defed
 
__USE_ISOC99
 || defed 
__USE_UNIX98


384 
__BEGIN_NAMESPACE_C99


386 
	$tf
 (*
__ri
 
__s
, 
size_t
 
__maxn
,

387 cڡ *
__ri
 
__fm
, ...)

388 
__THROWNL
 
	`__ibu__
 ((
	`__fm__
 (
__tf__
, 3, 4)));

390 
	$vtf
 (*
__ri
 
__s
, 
size_t
 
__maxn
,

391 cڡ *
__ri
 
__fm
, 
_G_va_li
 
__g
)

392 
__THROWNL
 
	`__ibu__
 ((
	`__fm__
 (
__tf__
, 3, 0)));

393 
__END_NAMESPACE_C99


396 #ifde
__USE_GNU


399 
	$vartf
 (**
__ri
 
__r
, cڡ *__ri 
__f
,

400 
_G_va_li
 
__g
)

401 
__THROWNL
 
	`__ibu__
 ((
	$__fm__
 (
__tf__
, 2, 0))
__wur
;

402 
	$__artf
 (**
__ri
 
__r
,

403 cڡ *
__ri
 
__fmt
, ...)

404 
__THROWNL
 
	`__ibu__
 ((
	$__fm__
 (
__tf__
, 2, 3))
__wur
;

405 
	$artf
 (**
__ri
 
__r
,

406 cڡ *
__ri
 
__fmt
, ...)

407 
__THROWNL
 
	`__ibu__
 ((
	$__fm__
 (
__tf__
, 2, 3))
__wur
;

410 #ifde
__USE_XOPEN2K8


412 
	$vdtf
 (
__fd
, cڡ *
__ri
 
__fmt
,

413 
_G_va_li
 
__g
)

414 
	`__ibu__
 ((
	`__fm__
 (
__tf__
, 2, 0)));

415 
	$dtf
 (
__fd
, cڡ *
__ri
 
__fmt
, ...)

416 
	`__ibu__
 ((
	`__fm__
 (
__tf__
, 2, 3)));

420 
__BEGIN_NAMESPACE_STD


425 
	$fsnf
 (
FILE
 *
__ri
 
__am
,

426 cڡ *
__ri
 
__fm
, ...
__wur
;

431 
	$snf
 (cڡ *
__ri
 
__fm
, ...
__wur
;

433 
	$ssnf
 (cڡ *
__ri
 
__s
,

434 cڡ *
__ri
 
__fm
, ...
__THROW
;

436 #i
defed
 
__USE_ISOC99
 && !defed 
__USE_GNU
 \

437 && (!
defed
 
__LDBL_COMPAT
 || !defed 
__REDIRECT
) \

438 && (
defed
 
__STRICT_ANSI__
 || defed 
__USE_XOPEN2K
)

439 #ifde
__REDIRECT


443 
	`__REDIRECT
 (
fsnf
, (
FILE
 *
__ri
 
__am
,

444 cڡ *
__ri
 
__fm
, ...),

445 
__isoc99_fsnf

__wur
;

446 
	`__REDIRECT
 (
snf
, (cڡ *
__ri
 
__fm
, ...),

447 
__isoc99_snf

__wur
;

448 
	`__REDIRECT_NTH
 (
ssnf
, (cڡ *
__ri
 
__s
,

449 cڡ *
__ri
 
__fm
, ...),

450 
__isoc99_ssnf
);

452 
	$__isoc99_fsnf
 (
FILE
 *
__ri
 
__am
,

453 cڡ *
__ri
 
__fm
, ...
__wur
;

454 
	$__isoc99_snf
 (cڡ *
__ri
 
__fm
, ...
__wur
;

455 
	$__isoc99_ssnf
 (cڡ *
__ri
 
__s
,

456 cڡ *
__ri
 
__fm
, ...
__THROW
;

457 
	#fsnf
 
__isoc99_fsnf


	)

458 
	#snf
 
__isoc99_snf


	)

459 
	#ssnf
 
__isoc99_ssnf


	)

463 
__END_NAMESPACE_STD


465 #ifdef 
__USE_ISOC99


466 
__BEGIN_NAMESPACE_C99


471 
	$vfsnf
 (
FILE
 *
__ri
 
__s
, cڡ *__ri 
__fm
,

472 
_G_va_li
 
__g
)

473 
	`__ibu__
 ((
	$__fm__
 (
__snf__
, 2, 0))
__wur
;

479 
	$vsnf
 (cڡ *
__ri
 
__fm
, 
_G_va_li
 
__g
)

480 
	`__ibu__
 ((
	$__fm__
 (
__snf__
, 1, 0))
__wur
;

483 
	$vssnf
 (cڡ *
__ri
 
__s
,

484 cڡ *
__ri
 
__fm
, 
_G_va_li
 
__g
)

485 
__THROW
 
	`__ibu__
 ((
	`__fm__
 (
__snf__
, 2, 0)));

487 #i!
defed
 
__USE_GNU
 \

488 && (!
defed
 
__LDBL_COMPAT
 || !defed 
__REDIRECT
) \

489 && (
defed
 
__STRICT_ANSI__
 || defed 
__USE_XOPEN2K
)

490 #ifde
__REDIRECT


494 
	`__REDIRECT
 (
vfsnf
,

495 (
FILE
 *
__ri
 
__s
,

496 cڡ *
__ri
 
__fm
, 
_G_va_li
 
__g
),

497 
__isoc99_vfsnf
)

498 
	`__ibu__
 ((
	$__fm__
 (
__snf__
, 2, 0))
__wur
;

499 
	`__REDIRECT
 (
vsnf
, (cڡ *
__ri
 
__fm
,

500 
_G_va_li
 
__g
), 
__isoc99_vsnf
)

501 
	`__ibu__
 ((
	$__fm__
 (
__snf__
, 1, 0))
__wur
;

502 
	`__REDIRECT_NTH
 (
vssnf
,

503 (cڡ *
__ri
 
__s
,

504 cڡ *
__ri
 
__fm
,

505 
_G_va_li
 
__g
), 
__isoc99_vssnf
)

506 
	`__ibu__
 ((
	`__fm__
 (
__snf__
, 2, 0)));

508 
	$__isoc99_vfsnf
 (
FILE
 *
__ri
 
__s
,

509 cڡ *
__ri
 
__fm
,

510 
_G_va_li
 
__g

__wur
;

511 
	$__isoc99_vsnf
 (cڡ *
__ri
 
__fm
,

512 
_G_va_li
 
__g

__wur
;

513 
	$__isoc99_vssnf
 (cڡ *
__ri
 
__s
,

514 cڡ *
__ri
 
__fm
,

515 
_G_va_li
 
__g

__THROW
;

516 
	#vfsnf
 
__isoc99_vfsnf


	)

517 
	#vsnf
 
__isoc99_vsnf


	)

518 
	#vssnf
 
__isoc99_vssnf


	)

522 
__END_NAMESPACE_C99


526 
__BEGIN_NAMESPACE_STD


531 
	`fgc
 (
FILE
 *
__am
);

532 
	`gc
 (
FILE
 *
__am
);

538 
	`gch
 ();

539 
__END_NAMESPACE_STD


543 
	#gc
(
_

	`_IO_gc
 (_)

	)

545 #ifde
__USE_POSIX


550 
	`gc_uocked
 (
FILE
 *
__am
);

551 
	`gch_uocked
 ();

554 #ifde
__USE_MISC


561 
	`fgc_uocked
 (
FILE
 *
__am
);

565 
__BEGIN_NAMESPACE_STD


573 
	`utc
 (
__c
, 
FILE
 *
__am
);

574 
	`putc
 (
__c
, 
FILE
 *
__am
);

580 
	`putch
 (
__c
);

581 
__END_NAMESPACE_STD


585 
	#putc
(
_ch
, 
_

	`_IO_putc
 (_ch, _)

	)

587 #ifde
__USE_MISC


594 
	`utc_uocked
 (
__c
, 
FILE
 *
__am
);

597 #ifde
__USE_POSIX


602 
	`putc_uocked
 (
__c
, 
FILE
 *
__am
);

603 
	`putch_uocked
 (
__c
);

607 #i
defed
 
__USE_MISC
 \

608 || (
defed
 
__USE_XOPEN
 && !defed 
__USE_XOPEN2K
)

610 
	`gw
 (
FILE
 *
__am
);

613 
	`putw
 (
__w
, 
FILE
 *
__am
);

617 
__BEGIN_NAMESPACE_STD


622 *
	$fgs
 (*
__ri
 
__s
, 
__n
, 
FILE
 *__ri 
__am
)

623 
__wur
;

625 #i!
defed
 
__USE_ISOC11
 \

626 || (
defed
 
__lulus
 && __cplusplus <= 201103L)

638 *
	$gs
 (*
__s

__wur
 
__ibu_dd__
;

640 
__END_NAMESPACE_STD


642 #ifde
__USE_GNU


649 *
	$fgs_uocked
 (*
__ri
 
__s
, 
__n
,

650 
FILE
 *
__ri
 
__am

__wur
;

654 #ifdef 
__USE_XOPEN2K8


665 
_IO_ssize_t
 
	$__gdim
 (**
__ri
 
__l
,

666 
size_t
 *
__ri
 
__n
, 
__dim
,

667 
FILE
 *
__ri
 
__am

__wur
;

668 
_IO_ssize_t
 
	$gdim
 (**
__ri
 
__l
,

669 
size_t
 *
__ri
 
__n
, 
__dim
,

670 
FILE
 *
__ri
 
__am

__wur
;

678 
_IO_ssize_t
 
	$gle
 (**
__ri
 
__l
,

679 
size_t
 *
__ri
 
__n
,

680 
FILE
 *
__ri
 
__am

__wur
;

684 
__BEGIN_NAMESPACE_STD


689 
	`uts
 (cڡ *
__ri
 
__s
, 
FILE
 *__ri 
__am
);

695 
	`puts
 (cڡ *
__s
);

702 
	`ungc
 (
__c
, 
FILE
 *
__am
);

709 
size_t
 
	$d
 (*
__ri
 
__r
, 
size_t
 
__size
,

710 
size_t
 
__n
, 
FILE
 *
__ri
 
__am

__wur
;

715 
size_t
 
	`fwre
 (cڡ *
__ri
 
__r
, size_
__size
,

716 
size_t
 
__n
, 
FILE
 *
__ri
 
__s
);

717 
__END_NAMESPACE_STD


719 #ifde
__USE_GNU


726 
	`uts_uocked
 (cڡ *
__ri
 
__s
,

727 
FILE
 *
__ri
 
__am
);

730 #ifde
__USE_MISC


737 
size_t
 
	$d_uocked
 (*
__ri
 
__r
, 
size_t
 
__size
,

738 
size_t
 
__n
, 
FILE
 *
__ri
 
__am

__wur
;

739 
size_t
 
	`fwre_uocked
 (cڡ *
__ri
 
__r
, size_
__size
,

740 
size_t
 
__n
, 
FILE
 *
__ri
 
__am
);

744 
__BEGIN_NAMESPACE_STD


749 
	`fek
 (
FILE
 *
__am
, 
__off
, 
__wh
);

754 
	$l
 (
FILE
 *
__am

__wur
;

759 
	`wd
 (
FILE
 *
__am
);

760 
__END_NAMESPACE_STD


767 #i
defed
 
__USE_LARGEFILE
 || defed 
__USE_XOPEN2K


768 #ide
__USE_FILE_OFFSET64


773 
	`feko
 (
FILE
 *
__am
, 
__off_t
 
__off
, 
__wh
);

778 
__off_t
 
	$lo
 (
FILE
 *
__am

__wur
;

780 #ifde
__REDIRECT


781 
	`__REDIRECT
 (
feko
,

782 (
FILE
 *
__am
, 
__off64_t
 
__off
, 
__wh
),

783 
feko64
);

784 
__off64_t
 
	`__REDIRECT
 (
lo
, (
FILE
 *
__am
), 
lo64
);

786 
	#feko
 
feko64


	)

787 
	#lo
 
lo64


	)

792 
__BEGIN_NAMESPACE_STD


793 #ide
__USE_FILE_OFFSET64


798 
	`fgpos
 (
FILE
 *
__ri
 
__am
, 
os_t
 *__ri 
__pos
);

803 
	`fos
 (
FILE
 *
__am
, cڡ 
os_t
 *
__pos
);

805 #ifde
__REDIRECT


806 
	`__REDIRECT
 (
fgpos
, (
FILE
 *
__ri
 
__am
,

807 
os_t
 *
__ri
 
__pos
), 
fgpos64
);

808 
	`__REDIRECT
 (
fos
,

809 (
FILE
 *
__am
, cڡ 
os_t
 *
__pos
), 
fos64
);

811 
	#fgpos
 
fgpos64


	)

812 
	#fos
 
fos64


	)

815 
__END_NAMESPACE_STD


817 #ifde
__USE_LARGEFILE64


818 
	`feko64
 (
FILE
 *
__am
, 
__off64_t
 
__off
, 
__wh
);

819 
__off64_t
 
	$lo64
 (
FILE
 *
__am

__wur
;

820 
	`fgpos64
 (
FILE
 *
__ri
 
__am
, 
os64_t
 *__ri 
__pos
);

821 
	`fos64
 (
FILE
 *
__am
, cڡ 
os64_t
 *
__pos
);

824 
__BEGIN_NAMESPACE_STD


826 
	$
 (
FILE
 *
__am

__THROW
;

828 
	$of
 (
FILE
 *
__am

__THROW
 
__wur
;

830 
	$
 (
FILE
 *
__am

__THROW
 
__wur
;

831 
__END_NAMESPACE_STD


833 #ifde
__USE_MISC


835 
	$_uocked
 (
FILE
 *
__am

__THROW
;

836 
	$of_uocked
 (
FILE
 *
__am

__THROW
 
__wur
;

837 
	$_uocked
 (
FILE
 *
__am

__THROW
 
__wur
;

841 
__BEGIN_NAMESPACE_STD


846 
	`
 (cڡ *
__s
);

847 
__END_NAMESPACE_STD


853 
	~<bs/sys_i.h
>

856 #ifdef 
__USE_POSIX


858 
	$fo
 (
FILE
 *
__am

__THROW
 
__wur
;

861 #ifde
__USE_MISC


863 
	$fo_uocked
 (
FILE
 *
__am

__THROW
 
__wur
;

867 #ifde
__USE_POSIX2


872 
FILE
 *
	$pݒ
 (cڡ *
__commd
, cڡ *
__modes

__wur
;

878 
	`po
 (
FILE
 *
__am
);

882 #ifdef 
__USE_POSIX


884 *
	$mid
 (*
__s

__THROW
;

888 #ifde
__USE_XOPEN


890 *
	`curid
 (*
__s
);

894 #ifdef 
__USE_GNU


895 
oback
;

898 
	$oback_tf
 (
oback
 *
__ri
 
__oback
,

899 cڡ *
__ri
 
__fm
, ...)

900 
__THROWNL
 
	`__ibu__
 ((
	`__fm__
 (
__tf__
, 2, 3)));

901 
	$oback_vtf
 (
oback
 *
__ri
 
__oback
,

902 cڡ *
__ri
 
__fm
,

903 
_G_va_li
 
__gs
)

904 
__THROWNL
 
	`__ibu__
 ((
	`__fm__
 (
__tf__
, 2, 0)));

908 #ifde
__USE_POSIX


912 
	$ockfe
 (
FILE
 *
__am

__THROW
;

916 
	$rylockfe
 (
FILE
 *
__am

__THROW
 
__wur
;

919 
	$fuockfe
 (
FILE
 *
__am

__THROW
;

922 #i
defed
 
__USE_XOPEN
 && !defed 
__USE_XOPEN2K
 && !defed 
__USE_GNU


926 
	#__ed_gt


	)

927 
	~<gt.h
>

932 #ifde
__USE_EXTERN_INLINES


933 
	~<bs/dio.h
>

935 #i
__USE_FORTIFY_LEVEL
 > 0 && 
defed
 
__ftify_funi


936 
	~<bs/dio2.h
>

938 #ifde
__LDBL_COMPAT


939 
	~<bs/dio-ldbl.h
>

942 
__END_DECLS


	@/usr/include/stdlib.h

22 #idef 
_STDLIB_H


24 
	~<us.h
>

27 
	#__ed_size_t


	)

28 #ide
__ed_mloc_d_oc


29 
	#__ed_wch_t


	)

30 
	#__ed_NULL


	)

32 
	~<ddef.h
>

34 
	g__BEGIN_DECLS


36 #ide
__ed_mloc_d_oc


37 
	#_STDLIB_H
 1

	)

39 #i(
defed
 
__USE_XOPEN
 || defed 
__USE_XOPEN2K8
&& !defed 
_SYS_WAIT_H


41 
	~<bs/waags.h
>

42 
	~<bs/waus.h
>

44 #ifde
__USE_MISC


49 #i
defed
 
__GNUC__
 && !defed 
__lulus


50 
	#__WAIT_INT
(
us
) \

51 (
	`__exnsi__
 (((uni { 
	`__tyof
(
us

__
; 
__i
; }) \

52 { .
__
 = (
us
}).
__i
))

	)

54 
	#__WAIT_INT
(
us
(*(*&(us))

	)

62 #i!
defed
 
__GNUC__
 || __GNUC__ < 2 || defed 
__lulus


63 
	#__WAIT_STATUS
 *

	)

64 
	#__WAIT_STATUS_DEFN
 *

	)

69 
wa
 *
	m__ur
;

70 *
	m__
;

71 } 
	t__WAIT_STATUS
 
	t__ibu__
 ((
	t__t_uni__
));

72 
	#__WAIT_STATUS_DEFN
 *

	)

77 
	#__WAIT_INT
(
us
(us)

	)

78 
	#__WAIT_STATUS
 *

	)

79 
	#__WAIT_STATUS_DEFN
 *

	)

84 
	#WEXITSTATUS
(
us

	`__WEXITSTATUS
 (
	`__WAIT_INT
 (us))

	)

85 
	#WTERMSIG
(
us

	`__WTERMSIG
 (
	`__WAIT_INT
 (us))

	)

86 
	#WSTOPSIG
(
us

	`__WSTOPSIG
 (
	`__WAIT_INT
 (us))

	)

87 
	#WIFEXITED
(
us

	`__WIFEXITED
 (
	`__WAIT_INT
 (us))

	)

88 
	#WIFSIGNALED
(
us

	`__WIFSIGNALED
 (
	`__WAIT_INT
 (us))

	)

89 
	#WIFSTOPPED
(
us

	`__WIFSTOPPED
 (
	`__WAIT_INT
 (us))

	)

90 #ifde
__WIFCONTINUED


91 
	#WIFCONTINUED
(
us

	`__WIFCONTINUED
 (
	`__WAIT_INT
 (us))

	)

95 
__BEGIN_NAMESPACE_STD


99 
	mqu
;

100 
	mm
;

101 } 
	tdiv_t
;

104 #ide
__ldiv_t_defed


107 
	mqu
;

108 
	mm
;

109 } 
	tldiv_t
;

110 
	#__ldiv_t_defed
 1

	)

112 
	g__END_NAMESPACE_STD


114 #i
defed
 
__USE_ISOC99
 && !defed 
__div_t_defed


115 
__BEGIN_NAMESPACE_C99


117 
__exnsi__
 struct

119 
	mqu
;

120 
	mm
;

121 } 
	tdiv_t
;

122 
	#__div_t_defed
 1

	)

123 
	g__END_NAMESPACE_C99


128 
	#RAND_MAX
 2147483647

	)

133 
	#EXIT_FAILURE
 1

	)

134 
	#EXIT_SUCCESS
 0

	)

138 
	#MB_CUR_MAX
 (
	`__y_g_mb_cur_max
 ())

	)

139 
size_t
 
	$__y_g_mb_cur_max
 (
__THROW
 
__wur
;

142 
__BEGIN_NAMESPACE_STD


144 
	$of
 (cڡ *
__Ō
)

145 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1)
__wur
;

147 
	$oi
 (cڡ *
__Ō
)

148 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1)
__wur
;

150 
	$
 (cڡ *
__Ō
)

151 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1)
__wur
;

152 
__END_NAMESPACE_STD


154 #ifde
__USE_ISOC99


155 
__BEGIN_NAMESPACE_C99


157 
__exnsi__
 
	$l
 (cڡ *
__Ō
)

158 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1)
__wur
;

159 
__END_NAMESPACE_C99


162 
__BEGIN_NAMESPACE_STD


164 
	$od
 (cڡ *
__ri
 
__Ō
,

165 **
__ri
 
__dr
)

166 
__THROW
 
	`__nnu
 ((1));

167 
__END_NAMESPACE_STD


169 #ifdef 
__USE_ISOC99


170 
__BEGIN_NAMESPACE_C99


172 
	$of
 (cڡ *
__ri
 
__Ō
,

173 **
__ri
 
__dr

__THROW
 
	`__nnu
 ((1));

175 
	$d
 (cڡ *
__ri
 
__Ō
,

176 **
__ri
 
__dr
)

177 
__THROW
 
	`__nnu
 ((1));

178 
__END_NAMESPACE_C99


181 
__BEGIN_NAMESPACE_STD


183 
	$
 (cڡ *
__ri
 
__Ō
,

184 **
__ri
 
__dr
, 
__ba
)

185 
__THROW
 
	`__nnu
 ((1));

187 
	$oul
 (cڡ *
__ri
 
__Ō
,

188 **
__ri
 
__dr
, 
__ba
)

189 
__THROW
 
	`__nnu
 ((1));

190 
__END_NAMESPACE_STD


192 #ifde
__USE_MISC


194 
__exnsi__


195 
	$oq
 (cڡ *
__ri
 
__Ō
,

196 **
__ri
 
__dr
, 
__ba
)

197 
__THROW
 
	`__nnu
 ((1));

199 
__exnsi__


200 
	$ouq
 (cڡ *
__ri
 
__Ō
,

201 **
__ri
 
__dr
, 
__ba
)

202 
__THROW
 
	`__nnu
 ((1));

205 #ifde
__USE_ISOC99


206 
__BEGIN_NAMESPACE_C99


208 
__exnsi__


209 
	$l
 (cڡ *
__ri
 
__Ō
,

210 **
__ri
 
__dr
, 
__ba
)

211 
__THROW
 
	`__nnu
 ((1));

213 
__exnsi__


214 
	$ou
 (cڡ *
__ri
 
__Ō
,

215 **
__ri
 
__dr
, 
__ba
)

216 
__THROW
 
	`__nnu
 ((1));

217 
__END_NAMESPACE_C99


221 #ifde
__USE_GNU


235 
	~<xlo.h
>

239 
	$_l
 (cڡ *
__ri
 
__Ō
,

240 **
__ri
 
__dr
, 
__ba
,

241 
__lo_t
 
__loc

__THROW
 
	`__nnu
 ((1, 4));

243 
	$oul_l
 (cڡ *
__ri
 
__Ō
,

244 **
__ri
 
__dr
,

245 
__ba
, 
__lo_t
 
__loc
)

246 
__THROW
 
	`__nnu
 ((1, 4));

248 
__exnsi__


249 
	$l_l
 (cڡ *
__ri
 
__Ō
,

250 **
__ri
 
__dr
, 
__ba
,

251 
__lo_t
 
__loc
)

252 
__THROW
 
	`__nnu
 ((1, 4));

254 
__exnsi__


255 
	$ou_l
 (cڡ *
__ri
 
__Ō
,

256 **
__ri
 
__dr
,

257 
__ba
, 
__lo_t
 
__loc
)

258 
__THROW
 
	`__nnu
 ((1, 4));

260 
	$od_l
 (cڡ *
__ri
 
__Ō
,

261 **
__ri
 
__dr
, 
__lo_t
 
__loc
)

262 
__THROW
 
	`__nnu
 ((1, 3));

264 
	$of_l
 (cڡ *
__ri
 
__Ō
,

265 **
__ri
 
__dr
, 
__lo_t
 
__loc
)

266 
__THROW
 
	`__nnu
 ((1, 3));

268 
	$d_l
 (cڡ *
__ri
 
__Ō
,

269 **
__ri
 
__dr
,

270 
__lo_t
 
__loc
)

271 
__THROW
 
	`__nnu
 ((1, 3));

275 #ifde
__USE_EXTERN_INLINES


276 
__BEGIN_NAMESPACE_STD


277 
__ex_le
 

278 
	`__NTH
 (
	$oi
 (cڡ *
__Ō
))

280  (
	`
 (
__Ō
, (**
NULL
, 10);

281 
	}
}

282 
__ex_le
 

283 
__NTH
 (
	$
 (cڡ *
__Ō
))

285  
	`
 (
__Ō
, (**
NULL
, 10);

286 
	}
}

287 
	g__END_NAMESPACE_STD


289 #ifde
__USE_ISOC99


290 
__BEGIN_NAMESPACE_C99


291 
__exnsi__
 
__ex_le
 

292 
__NTH
 (
	$l
 (cڡ *
__Ō
))

294  
	`l
 (
__Ō
, (**
NULL
, 10);

295 
	}
}

296 
	g__END_NAMESPACE_C99


301 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED


305 *
	$l64a
 (
__n

__THROW
 
__wur
;

308 
	$a64l
 (cڡ *
__s
)

309 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1)
__wur
;

313 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED


314 
	~<sys/tys.h
>

321 
	$ndom
 (
__THROW
;

324 
	$dom
 (
__ed

__THROW
;

330 *
	$e
 (
__ed
, *
__ebuf
,

331 
size_t
 
__

__THROW
 
	`__nnu
 ((2));

335 *
	$te
 (*
__ebuf

__THROW
 
	`__nnu
 ((1));

338 #ifde
__USE_MISC


343 
	sndom_da


345 
t32_t
 *

;

346 
t32_t
 *

;

347 
t32_t
 *
e
;

348 
nd_ty
;

349 
nd_deg
;

350 
nd_p
;

351 
t32_t
 *
d_r
;

354 
	$ndom_r
 (
ndom_da
 *
__ri
 
__buf
,

355 
t32_t
 *
__ri
 
__su

__THROW
 
	`__nnu
 ((1, 2));

357 
	$dom_r
 (
__ed
, 
ndom_da
 *
__buf
)

358 
__THROW
 
	`__nnu
 ((2));

360 
	$e_r
 (
__ed
, *
__ri
 
__ebuf
,

361 
size_t
 
__
,

362 
ndom_da
 *
__ri
 
__buf
)

363 
__THROW
 
	`__nnu
 ((2, 4));

365 
	$te_r
 (*
__ri
 
__ebuf
,

366 
ndom_da
 *
__ri
 
__buf
)

367 
__THROW
 
	`__nnu
 ((1, 2));

372 
__BEGIN_NAMESPACE_STD


374 
	$nd
 (
__THROW
;

376 
	$d
 (
__ed

__THROW
;

377 
__END_NAMESPACE_STD


379 #ifde
__USE_POSIX


381 
	$nd_r
 (*
__ed

__THROW
;

385 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


389 
	$dnd48
 (
__THROW
;

390 
	$d48
 (
__xsubi
[3]
__THROW
 
	`__nnu
 ((1));

393 
	$̪d48
 (
__THROW
;

394 
	$Īd48
 (
__xsubi
[3])

395 
__THROW
 
	`__nnu
 ((1));

398 
	$mnd48
 (
__THROW
;

399 
	$jnd48
 (
__xsubi
[3])

400 
__THROW
 
	`__nnu
 ((1));

403 
	$d48
 (
__edv

__THROW
;

404 *
	$ed48
 (
__ed16v
[3])

405 
__THROW
 
	`__nnu
 ((1));

406 
	$lcg48
 (
__m
[7]
__THROW
 
	`__nnu
 ((1));

408 #ifde
__USE_MISC


412 
	sdnd48_da


414 
__x
[3];

415 
__d_x
[3];

416 
__c
;

417 
__
;

418 
__exnsi__
 
__a
;

423 
	$dnd48_r
 (
dnd48_da
 *
__ri
 
__bufr
,

424 *
__ri
 
__su

__THROW
 
	`__nnu
 ((1, 2));

425 
	$d48_r
 (
__xsubi
[3],

426 
dnd48_da
 *
__ri
 
__bufr
,

427 *
__ri
 
__su

__THROW
 
	`__nnu
 ((1, 2));

430 
	$̪d48_r
 (
dnd48_da
 *
__ri
 
__bufr
,

431 *
__ri
 
__su
)

432 
__THROW
 
	`__nnu
 ((1, 2));

433 
	$Īd48_r
 (
__xsubi
[3],

434 
dnd48_da
 *
__ri
 
__bufr
,

435 *
__ri
 
__su
)

436 
__THROW
 
	`__nnu
 ((1, 2));

439 
	$mnd48_r
 (
dnd48_da
 *
__ri
 
__bufr
,

440 *
__ri
 
__su
)

441 
__THROW
 
	`__nnu
 ((1, 2));

442 
	$jnd48_r
 (
__xsubi
[3],

443 
dnd48_da
 *
__ri
 
__bufr
,

444 *
__ri
 
__su
)

445 
__THROW
 
	`__nnu
 ((1, 2));

448 
	$d48_r
 (
__edv
, 
dnd48_da
 *
__bufr
)

449 
__THROW
 
	`__nnu
 ((2));

451 
	$ed48_r
 (
__ed16v
[3],

452 
dnd48_da
 *
__bufr

__THROW
 
	`__nnu
 ((1, 2));

454 
	$lcg48_r
 (
__m
[7],

455 
dnd48_da
 *
__bufr
)

456 
__THROW
 
	`__nnu
 ((1, 2));

462 #ide
__mloc_d_oc_defed


463 
	#__mloc_d_oc_defed


	)

464 
__BEGIN_NAMESPACE_STD


466 *
	$mloc
 (
size_t
 
__size

__THROW
 
__ibu_mloc__
 
__wur
;

468 *
	$oc
 (
size_t
 
__nmemb
, size_
__size
)

469 
__THROW
 
__ibu_mloc__
 
__wur
;

470 
__END_NAMESPACE_STD


473 #ide
__ed_mloc_d_oc


474 
__BEGIN_NAMESPACE_STD


480 *
	$loc
 (*
__r
, 
size_t
 
__size
)

481 
__THROW
 
__ibu_wn_unud_su__
;

483 
	$
 (*
__r

__THROW
;

484 
__END_NAMESPACE_STD


486 #ifdef 
__USE_MISC


488 
	$c
 (*
__r

__THROW
;

491 #ifde
__USE_MISC


492 
	~<lo.h
>

495 #i(
defed
 
__USE_XOPEN_EXTENDED
 && !defed 
__USE_XOPEN2K
) \

496 || 
defed
 
__USE_MISC


498 *
	$vloc
 (
size_t
 
__size

__THROW
 
__ibu_mloc__
 
__wur
;

501 #ifde
__USE_XOPEN2K


503 
	$posix_memign
 (**
__memr
, 
size_t
 
__ignmt
, size_
__size
)

504 
__THROW
 
	`__nnu
 ((1)
__wur
;

507 #ifde
__USE_ISOC11


509 *
	$igd_loc
 (
size_t
 
__ignmt
, size_
__size
)

510 
__THROW
 
__ibu_mloc__
 
	`__ibu_loc_size__
 ((2)
__wur
;

513 
__BEGIN_NAMESPACE_STD


515 
	$abt
 (
__THROW
 
	`__ibu__
 ((
__nܑu__
));

519 
	$ex
 ((*
__func
()
__THROW
 
	`__nnu
 ((1));

521 #i
defed
 
__USE_ISOC11
 || defed 
__USE_ISOCXX11


523 #ifde
__lulus


524 "C++" 
	$_quick_ex
 ((*
__func
) ())

525 
__THROW
 
	`__asm
 ("_quick_ex"
	`__nnu
 ((1));

527 
	$_quick_ex
 ((*
__func
()
__THROW
 
	`__nnu
 ((1));

530 
__END_NAMESPACE_STD


532 #ifdef 
__USE_MISC


535 
	$_ex
 ((*
__func
(
__us
, *
__g
), *__arg)

536 
__THROW
 
	`__nnu
 ((1));

539 
__BEGIN_NAMESPACE_STD


543 
	$ex
 (
__us

__THROW
 
	`__ibu__
 ((
__nܑu__
));

545 #i
defed
 
__USE_ISOC11
 || defed 
__USE_ISOCXX11


549 
	$quick_ex
 (
__us

__THROW
 
	`__ibu__
 ((
__nܑu__
));

551 
__END_NAMESPACE_STD


553 #ifde
__USE_ISOC99


554 
__BEGIN_NAMESPACE_C99


557 
	$_Ex
 (
__us

__THROW
 
	`__ibu__
 ((
__nܑu__
));

558 
__END_NAMESPACE_C99


562 
__BEGIN_NAMESPACE_STD


564 *
	$gv
 (cڡ *
__me

__THROW
 
	`__nnu
 ((1)
__wur
;

565 
__END_NAMESPACE_STD


567 #ifde
__USE_GNU


570 *
	$cu_gv
 (cڡ *
__me
)

571 
__THROW
 
	`__nnu
 ((1)
__wur
;

574 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


578 
	$punv
 (*
__rg

__THROW
 
	`__nnu
 ((1));

581 #ifde
__USE_XOPEN2K


584 
	$nv
 (cڡ *
__me
, cڡ *
__vue
, 
__a
)

585 
__THROW
 
	`__nnu
 ((2));

588 
	$unnv
 (cڡ *
__me

__THROW
 
	`__nnu
 ((1));

591 #ifdef 
__USE_MISC


595 
	$nv
 (
__THROW
;

599 #i
defed
 
__USE_MISC
 \

600 || (
defed
 
__USE_XOPEN_EXTENDED
 && !defed 
__USE_XOPEN2K8
)

606 *
	$mkmp
 (*
__me

__THROW
 
	`__nnu
 ((1));

609 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K8


618 #ide
__USE_FILE_OFFSET64


619 
	$mkemp
 (*
__me

	`__nnu
 ((1)
__wur
;

621 #ifde
__REDIRECT


622 
	`__REDIRECT
 (
mkemp
, (*
__me
), 
mkemp64
)

623 
	`__nnu
 ((1)
__wur
;

625 
	#mkemp
 
mkemp64


	)

628 #ifde
__USE_LARGEFILE64


629 
	$mkemp64
 (*
__me

	`__nnu
 ((1)
__wur
;

633 #ifde
__USE_MISC


640 #ide
__USE_FILE_OFFSET64


641 
	$mkemps
 (*
__me
, 
__suffixn

	`__nnu
 ((1)
__wur
;

643 #ifde
__REDIRECT


644 
	`__REDIRECT
 (
mkemps
, (*
__me
, 
__suffixn
),

645 
mkemps64

	`__nnu
 ((1)
__wur
;

647 
	#mkemps
 
mkemps64


	)

650 #ifde
__USE_LARGEFILE64


651 
	$mkemps64
 (*
__me
, 
__suffixn
)

652 
	`__nnu
 ((1)
__wur
;

656 #ifde
__USE_XOPEN2K8


662 *
	$mkdmp
 (*
__me

__THROW
 
	`__nnu
 ((1)
__wur
;

665 #ifde
__USE_GNU


672 #ide
__USE_FILE_OFFSET64


673 
	$mkoemp
 (*
__me
, 
__ags

	`__nnu
 ((1)
__wur
;

675 #ifde
__REDIRECT


676 
	`__REDIRECT
 (
mkoemp
, (*
__me
, 
__ags
), 
mkoemp64
)

677 
	`__nnu
 ((1)
__wur
;

679 
	#mkoemp
 
mkoemp64


	)

682 #ifde
__USE_LARGEFILE64


683 
	$mkoemp64
 (*
__me
, 
__ags

	`__nnu
 ((1)
__wur
;

692 #ide
__USE_FILE_OFFSET64


693 
	$mkoemps
 (*
__me
, 
__suffixn
, 
__ags
)

694 
	`__nnu
 ((1)
__wur
;

696 #ifde
__REDIRECT


697 
	`__REDIRECT
 (
mkoemps
, (*
__me
, 
__suffixn
,

698 
__ags
), 
mkoemps64
)

699 
	`__nnu
 ((1)
__wur
;

701 
	#mkoemps
 
mkoemps64


	)

704 #ifde
__USE_LARGEFILE64


705 
	$mkoemps64
 (*
__me
, 
__suffixn
, 
__ags
)

706 
	`__nnu
 ((1)
__wur
;

711 
__BEGIN_NAMESPACE_STD


716 
	$syem
 (cڡ *
__commd

__wur
;

717 
__END_NAMESPACE_STD


720 #ifdef 
__USE_GNU


723 *
	$nilize_fe_me
 (cڡ *
__me
)

724 
__THROW
 
	`__nnu
 ((1)
__wur
;

727 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED


733 *
	$th
 (cڡ *
__ri
 
__me
,

734 *
__ri
 
__sved

__THROW
 
__wur
;

739 #ide
__COMPAR_FN_T


740 
	#__COMPAR_FN_T


	)

741 (*
	t__comr__t
) (const *, const *);

743 #ifdef 
__USE_GNU


744 
__comr__t
 
	tcomris__t
;

747 #ifde
__USE_GNU


748 (*
	t__comr_d__t
) (const *, const *, *);

751 
__BEGIN_NAMESPACE_STD


754 *
	$bch
 (cڡ *
__key
, cڡ *
__ba
,

755 
size_t
 
__nmemb
, size_
__size
, 
__comr__t
 
__comr
)

756 
	`__nnu
 ((1, 2, 5)
__wur
;

758 #ifde
__USE_EXTERN_INLINES


759 
	~<bs/dlib-bch.h
>

764 
	$qst
 (*
__ba
, 
size_t
 
__nmemb
, size_
__size
,

765 
__comr__t
 
__comr

	`__nnu
 ((1, 4));

766 #ifde
__USE_GNU


767 
	$qst_r
 (*
__ba
, 
size_t
 
__nmemb
, size_
__size
,

768 
__comr_d__t
 
__comr
, *
__g
)

769 
	`__nnu
 ((1, 4));

774 
	$abs
 (
__x

__THROW
 
	`__ibu__
 ((
__cڡ__
)
__wur
;

775 
	$bs
 (
__x

__THROW
 
	`__ibu__
 ((
__cڡ__
)
__wur
;

776 
__END_NAMESPACE_STD


778 #ifde
__USE_ISOC99


779 
__exnsi__
 
	$abs
 (
__x
)

780 
__THROW
 
	`__ibu__
 ((
__cڡ__
)
__wur
;

784 
__BEGIN_NAMESPACE_STD


788 
div_t
 
	$div
 (
__num
, 
__dom
)

789 
__THROW
 
	`__ibu__
 ((
__cڡ__
)
__wur
;

790 
ldiv_t
 
	$ldiv
 (
__num
, 
__dom
)

791 
__THROW
 
	`__ibu__
 ((
__cڡ__
)
__wur
;

792 
__END_NAMESPACE_STD


794 #ifde
__USE_ISOC99


795 
__BEGIN_NAMESPACE_C99


796 
__exnsi__
 
div_t
 
	$div
 (
__num
,

797 
__dom
)

798 
__THROW
 
	`__ibu__
 ((
__cڡ__
)
__wur
;

799 
__END_NAMESPACE_C99


803 #i(
defed
 
__USE_XOPEN_EXTENDED
 && !defed 
__USE_XOPEN2K8
) \

804 || 
defed
 
__USE_MISC


811 *
	$ecvt
 (
__vue
, 
__ndig
, *
__ri
 
__det
,

812 *
__ri
 
__sign

__THROW
 
	`__nnu
 ((3, 4)
__wur
;

817 *
	$fcvt
 (
__vue
, 
__ndig
, *
__ri
 
__det
,

818 *
__ri
 
__sign

__THROW
 
	`__nnu
 ((3, 4)
__wur
;

823 *
	$gcvt
 (
__vue
, 
__ndig
, *
__buf
)

824 
__THROW
 
	`__nnu
 ((3)
__wur
;

827 #ifde
__USE_MISC


829 *
	$qecvt
 (
__vue
, 
__ndig
,

830 *
__ri
 
__det
, *__ri 
__sign
)

831 
__THROW
 
	`__nnu
 ((3, 4)
__wur
;

832 *
	$qfcvt
 (
__vue
, 
__ndig
,

833 *
__ri
 
__det
, *__ri 
__sign
)

834 
__THROW
 
	`__nnu
 ((3, 4)
__wur
;

835 *
	$qgcvt
 (
__vue
, 
__ndig
, *
__buf
)

836 
__THROW
 
	`__nnu
 ((3)
__wur
;

841 
	$ecvt_r
 (
__vue
, 
__ndig
, *
__ri
 
__det
,

842 *
__ri
 
__sign
, *__ri 
__buf
,

843 
size_t
 
__n

__THROW
 
	`__nnu
 ((3, 4, 5));

844 
	$fcvt_r
 (
__vue
, 
__ndig
, *
__ri
 
__det
,

845 *
__ri
 
__sign
, *__ri 
__buf
,

846 
size_t
 
__n

__THROW
 
	`__nnu
 ((3, 4, 5));

848 
	$qecvt_r
 (
__vue
, 
__ndig
,

849 *
__ri
 
__det
, *__ri 
__sign
,

850 *
__ri
 
__buf
, 
size_t
 
__n
)

851 
__THROW
 
	`__nnu
 ((3, 4, 5));

852 
	$qfcvt_r
 (
__vue
, 
__ndig
,

853 *
__ri
 
__det
, *__ri 
__sign
,

854 *
__ri
 
__buf
, 
size_t
 
__n
)

855 
__THROW
 
	`__nnu
 ((3, 4, 5));

859 
__BEGIN_NAMESPACE_STD


862 
	$mbn
 (cڡ *
__s
, 
size_t
 
__n

__THROW
;

865 
	$mbtowc
 (
wch_t
 *
__ri
 
__pwc
,

866 cڡ *
__ri
 
__s
, 
size_t
 
__n

__THROW
;

869 
	$womb
 (*
__s
, 
wch_t
 
__wch

__THROW
;

873 
size_t
 
	$mbowcs
 (
wch_t
 *
__ri
 
__pwcs
,

874 cڡ *
__ri
 
__s
, 
size_t
 
__n

__THROW
;

876 
size_t
 
	$wcombs
 (*
__ri
 
__s
,

877 cڡ 
wch_t
 *
__ri
 
__pwcs
, 
size_t
 
__n
)

878 
__THROW
;

879 
__END_NAMESPACE_STD


882 #ifde
__USE_MISC


887 
	$mch
 (cڡ *
__ڣ

__THROW
 
	`__nnu
 ((1)
__wur
;

891 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K8


898 
	$gsubt
 (**
__ri
 
__tip
,

899 *cڡ *
__ri
 
__toks
,

900 **
__ri
 
__vu
)

901 
__THROW
 
	`__nnu
 ((1, 2, 3)
__wur
;

905 #ifde
__USE_XOPEN


907 
	$tkey
 (cڡ *
__key

__THROW
 
	`__nnu
 ((1));

913 #ifde
__USE_XOPEN2KXSI


915 
	$posix_ݒ
 (
__oag

__wur
;

918 #ifde
__USE_XOPEN


923 
	$g
 (
__fd

__THROW
;

927 
	$uock
 (
__fd

__THROW
;

932 *
	$ame
 (
__fd

__THROW
 
__wur
;

935 #ifde
__USE_GNU


939 
	$ame_r
 (
__fd
, *
__buf
, 
size_t
 
__bu
)

940 
__THROW
 
	`__nnu
 ((2));

943 
	`g
 ();

946 #ifde
__USE_MISC


950 
	$gldavg
 (
__ldavg
[], 
__m
)

951 
__THROW
 
	`__nnu
 ((1));

954 
	~<bs/dlib-t.h
>

957 #i
__USE_FORTIFY_LEVEL
 > 0 && 
defed
 
__ftify_funi


958 
	~<bs/dlib.h
>

960 #ifde
__LDBL_COMPAT


961 
	~<bs/dlib-ldbl.h
>

965 #unde
__ed_mloc_d_oc


967 
__END_DECLS


	@/usr/include/string.h

22 #idef 
_STRING_H


23 
	#_STRING_H
 1

	)

25 
	~<us.h
>

27 
	g__BEGIN_DECLS


30 
	#__ed_size_t


	)

31 
	#__ed_NULL


	)

32 
	~<ddef.h
>

35 #i
defed
 
__lulus
 && 
__GNUC_PREREQ
 (4, 4)

36 
	#__CORRECT_ISO_CPP_STRING_H_PROTO


	)

40 
__BEGIN_NAMESPACE_STD


42 *
	$memy
 (*
__ri
 
__de
, cڡ *__ri 
__c
,

43 
size_t
 
__n

__THROW
 
	`__nnu
 ((1, 2));

46 *
	$memmove
 (*
__de
, cڡ *
__c
, 
size_t
 
__n
)

47 
__THROW
 
	`__nnu
 ((1, 2));

48 
__END_NAMESPACE_STD


53 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


54 *
	$memcy
 (*
__ri
 
__de
, cڡ *__ri 
__c
,

55 
__c
, 
size_t
 
__n
)

56 
__THROW
 
	`__nnu
 ((1, 2));

60 
__BEGIN_NAMESPACE_STD


62 *
	$memt
 (*
__s
, 
__c
, 
size_t
 
__n

__THROW
 
	`__nnu
 ((1));

65 
	$memcmp
 (cڡ *
__s1
, cڡ *
__s2
, 
size_t
 
__n
)

66 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

69 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


72 *
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

73 
__THROW
 
	`__asm
 ("memchr"
__ibu_pu__
 
	`__nnu
 ((1));

74 cڡ *
	`memchr
 (cڡ *
__s
, 
__c
, 
size_t
 
__n
)

75 
__THROW
 
	`__asm
 ("memchr"
__ibu_pu__
 
	`__nnu
 ((1));

77 #ifde
__OPTIMIZE__


78 
__ex_ways_le
 *

79 
	`memchr
 (*
__s
, 
__c
, 
size_t
 
__n

__THROW


81  
	`__but_memchr
 (
__s
, 
__c
, 
__n
);

84 
__ex_ways_le
 const *

85 
	`memchr
 (cڡ *
__s
, 
__c
, 
size_t
 
__n

__THROW


87  
	`__but_memchr
 (
__s
, 
__c
, 
__n
);

90 
	}
}

92 *
	$memchr
 (cڡ *
__s
, 
__c
, 
size_t
 
__n
)

93 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

95 
__END_NAMESPACE_STD


97 #ifde
__USE_GNU


100 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


101 "C++" *
	$wmemchr
 (*
__s
, 
__c
)

102 
__THROW
 
	`__asm
 ("wmemchr"
__ibu_pu__
 
	`__nnu
 ((1));

103 "C++" cڡ *
	$wmemchr
 (cڡ *
__s
, 
__c
)

104 
__THROW
 
	`__asm
 ("wmemchr"
__ibu_pu__
 
	`__nnu
 ((1));

106 *
	$wmemchr
 (cڡ *
__s
, 
__c
)

107 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

111 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


112 "C++" *
	$memrchr
 (*
__s
, 
__c
, 
size_t
 
__n
)

113 
__THROW
 
	`__asm
 ("memrchr"
__ibu_pu__
 
	`__nnu
 ((1));

114 "C++" cڡ *
	$memrchr
 (cڡ *
__s
, 
__c
, 
size_t
 
__n
)

115 
__THROW
 
	`__asm
 ("memrchr"
__ibu_pu__
 
	`__nnu
 ((1));

117 *
	$memrchr
 (cڡ *
__s
, 
__c
, 
size_t
 
__n
)

118 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

123 
__BEGIN_NAMESPACE_STD


125 *
	$ry
 (*
__ri
 
__de
, cڡ *__ri 
__c
)

126 
__THROW
 
	`__nnu
 ((1, 2));

128 *
	$y
 (*
__ri
 
__de
,

129 cڡ *
__ri
 
__c
, 
size_t
 
__n
)

130 
__THROW
 
	`__nnu
 ((1, 2));

133 *
	$rt
 (*
__ri
 
__de
, cڡ *__ri 
__c
)

134 
__THROW
 
	`__nnu
 ((1, 2));

136 *
	$t
 (*
__ri
 
__de
, cڡ *__ri 
__c
,

137 
size_t
 
__n

__THROW
 
	`__nnu
 ((1, 2));

140 
	$rcmp
 (cڡ *
__s1
, cڡ *
__s2
)

141 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

143 
	$cmp
 (cڡ *
__s1
, cڡ *
__s2
, 
size_t
 
__n
)

144 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

147 
	$rcl
 (cڡ *
__s1
, cڡ *
__s2
)

148 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

150 
size_t
 
	$rxm
 (*
__ri
 
__de
,

151 cڡ *
__ri
 
__c
, 
size_t
 
__n
)

152 
__THROW
 
	`__nnu
 ((2));

153 
__END_NAMESPACE_STD


155 #ifde
__USE_XOPEN2K8


159 
	~<xlo.h
>

162 
	$rcl_l
 (cڡ *
__s1
, cڡ *
__s2
, 
__lo_t
 
__l
)

163 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2, 3));

165 
size_t
 
	$rxm_l
 (*
__de
, cڡ *
__c
, 
size_t
 
__n
,

166 
__lo_t
 
__l

__THROW
 
	`__nnu
 ((2, 4));

169 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K8


171 *
	$rdup
 (cڡ *
__s
)

172 
__THROW
 
__ibu_mloc__
 
	`__nnu
 ((1));

178 #i
defed
 
__USE_XOPEN2K8


179 *
	$dup
 (cڡ *
__rg
, 
size_t
 
__n
)

180 
__THROW
 
__ibu_mloc__
 
	`__nnu
 ((1));

183 #i
defed
 
__USE_GNU
 && defed 
__GNUC__


185 
	#rdu
(
s
) \

186 (
__exnsi__
 \

188 cڡ *
__d
 = (
s
); \

189 
size_t
 
__n
 = 
	`
 (
__d
) + 1; \

190 *
__w
 = (*
	`__but_lo
 (
__n
); \

191 (*
	`memy
 (
__w
, 
__d
, 
__n
); \

192 
	}
}))

	)

195 
	#du
(
s
, 
n
) \

196 (
__exnsi__
 \

198 cڡ *
__d
 = (
s
); \

199 
size_t
 
__n
 = 
	`n
 (
__d
, (
n
)); \

200 *
__w
 = (*
	`__but_lo
 (
__n
 + 1); \

201 
__w
[
__n
] = '\0'; \

202 (*
	`memy
 (
__w
, 
__d
, 
__n
); \

203 }))

	)

206 
	g__BEGIN_NAMESPACE_STD


208 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


211 *
rchr
 (*
__s
, 
__c
)

212 
__THROW
 
__asm
 ("rchr"
__ibu_pu__
 
__nnu
 ((1));

213 cڡ *
rchr
 (cڡ *
__s
, 
__c
)

214 
__THROW
 
__asm
 ("rchr"
__ibu_pu__
 
__nnu
 ((1));

216 #ifde
__OPTIMIZE__


217 
__ex_ways_le
 *

218 
rchr
 (*
__s
, 
__c

	g__THROW


220  
__but_rchr
 (
__s
, 
__c
);

223 
__ex_ways_le
 const *

224 
rchr
 (cڡ *
__s
, 
__c

	g__THROW


226  
__but_rchr
 (
__s
, 
__c
);

231 *
	$rchr
 (cڡ *
__s
, 
__c
)

232 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

235 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


238 *
	`chr
 (*
__s
, 
__c
)

239 
__THROW
 
	`__asm
 ("chr"
__ibu_pu__
 
	`__nnu
 ((1));

240 cڡ *
	`chr
 (cڡ *
__s
, 
__c
)

241 
__THROW
 
	`__asm
 ("chr"
__ibu_pu__
 
	`__nnu
 ((1));

243 #ifde
__OPTIMIZE__


244 
__ex_ways_le
 *

245 
	`chr
 (*
__s
, 
__c

__THROW


247  
	`__but_chr
 (
__s
, 
__c
);

250 
__ex_ways_le
 const *

251 
	`chr
 (cڡ *
__s
, 
__c

__THROW


253  
	`__but_chr
 (
__s
, 
__c
);

256 
	}
}

258 *
	$chr
 (cڡ *
__s
, 
__c
)

259 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

261 
__END_NAMESPACE_STD


263 #ifde
__USE_GNU


266 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


267 "C++" *
	$rchul
 (*
__s
, 
__c
)

268 
__THROW
 
	`__asm
 ("rchul"
__ibu_pu__
 
	`__nnu
 ((1));

269 "C++" cڡ *
	$rchul
 (cڡ *
__s
, 
__c
)

270 
__THROW
 
	`__asm
 ("rchul"
__ibu_pu__
 
	`__nnu
 ((1));

272 *
	$rchul
 (cڡ *
__s
, 
__c
)

273 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

277 
__BEGIN_NAMESPACE_STD


280 
size_t
 
	$rcn
 (cڡ *
__s
, cڡ *
__je
)

281 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

284 
size_t
 
	$rn
 (cڡ *
__s
, cڡ *
__ac
)

285 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

287 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


290 *
	`brk
 (*
__s
, cڡ *
__ac
)

291 
__THROW
 
	`__asm
 ("brk"
__ibu_pu__
 
	`__nnu
 ((1, 2));

292 cڡ *
	`brk
 (cڡ *
__s
, cڡ *
__ac
)

293 
__THROW
 
	`__asm
 ("brk"
__ibu_pu__
 
	`__nnu
 ((1, 2));

295 #ifde
__OPTIMIZE__


296 
__ex_ways_le
 *

297 
	`brk
 (*
__s
, cڡ *
__ac

__THROW


299  
	`__but_brk
 (
__s
, 
__ac
);

302 
__ex_ways_le
 const *

303 
	`brk
 (cڡ *
__s
, cڡ *
__ac

__THROW


305  
	`__but_brk
 (
__s
, 
__ac
);

308 
	}
}

310 *
	$brk
 (cڡ *
__s
, cڡ *
__ac
)

311 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

314 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


317 *
	`rr
 (*
__hayack
, cڡ *
__ed
)

318 
__THROW
 
	`__asm
 ("rr"
__ibu_pu__
 
	`__nnu
 ((1, 2));

319 cڡ *
	`rr
 (cڡ *
__hayack
, cڡ *
__ed
)

320 
__THROW
 
	`__asm
 ("rr"
__ibu_pu__
 
	`__nnu
 ((1, 2));

322 #ifde
__OPTIMIZE__


323 
__ex_ways_le
 *

324 
	`rr
 (*
__hayack
, cڡ *
__ed

__THROW


326  
	`__but_rr
 (
__hayack
, 
__ed
);

329 
__ex_ways_le
 const *

330 
	`rr
 (cڡ *
__hayack
, cڡ *
__ed

__THROW


332  
	`__but_rr
 (
__hayack
, 
__ed
);

335 
	}
}

337 *
	$rr
 (cڡ *
__hayack
, cڡ *
__ed
)

338 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

343 *
	$ok
 (*
__ri
 
__s
, cڡ *__ri 
__dim
)

344 
__THROW
 
	`__nnu
 ((2));

345 
__END_NAMESPACE_STD


349 *
	$__ok_r
 (*
__ri
 
__s
,

350 cڡ *
__ri
 
__dim
,

351 **
__ri
 
__ve_r
)

352 
__THROW
 
	`__nnu
 ((2, 3));

353 #ifde
__USE_POSIX


354 *
	$ok_r
 (*
__ri
 
__s
, cڡ *__ri 
__dim
,

355 **
__ri
 
__ve_r
)

356 
__THROW
 
	`__nnu
 ((2, 3));

359 #ifde
__USE_GNU


361 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


362 "C++" *
	$rr
 (*
__hayack
, cڡ *
__ed
)

363 
__THROW
 
	`__asm
 ("rr"
__ibu_pu__
 
	`__nnu
 ((1, 2));

364 "C++" cڡ *
	$rr
 (cڡ *
__hayack
,

365 cڡ *
__ed
)

366 
__THROW
 
	`__asm
 ("rr"
__ibu_pu__
 
	`__nnu
 ((1, 2));

368 *
	$rr
 (cڡ *
__hayack
, cڡ *
__ed
)

369 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

373 #ifde
__USE_GNU


377 *
	$memmem
 (cڡ *
__hayack
, 
size_t
 
__hayackn
,

378 cڡ *
__ed
, 
size_t
 
__edn
)

379 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 3));

383 *
	$__mempy
 (*
__ri
 
__de
,

384 cڡ *
__ri
 
__c
, 
size_t
 
__n
)

385 
__THROW
 
	`__nnu
 ((1, 2));

386 *
	$mempy
 (*
__ri
 
__de
,

387 cڡ *
__ri
 
__c
, 
size_t
 
__n
)

388 
__THROW
 
	`__nnu
 ((1, 2));

392 
__BEGIN_NAMESPACE_STD


394 
size_t
 
	$
 (cڡ *
__s
)

395 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

396 
__END_NAMESPACE_STD


398 #ifdef 
__USE_XOPEN2K8


401 
size_t
 
	$n
 (cڡ *
__rg
, 
size_t
 
__maxn
)

402 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

406 
__BEGIN_NAMESPACE_STD


408 *
	$
 (
__um

__THROW
;

409 
__END_NAMESPACE_STD


410 #ifde
__USE_XOPEN2K


418 #i
defed
 
__USE_XOPEN2K
 && !defed 
__USE_GNU


421 #ifde
__REDIRECT_NTH


422 
	`__REDIRECT_NTH
 (
_r
,

423 (
__um
, *
__buf
, 
size_t
 
__bu
),

424 
__xpg__r

	`__nnu
 ((2));

426 
	$__xpg__r
 (
__um
, *
__buf
, 
size_t
 
__bu
)

427 
__THROW
 
	`__nnu
 ((2));

428 
	#_r
 
__xpg__r


	)

433 *
	$_r
 (
__um
, *
__buf
, 
size_t
 
__bu
)

434 
__THROW
 
	`__nnu
 ((2)
__wur
;

438 #ifde
__USE_XOPEN2K8


440 *
	$_l
 (
__um
, 
__lo_t
 
__l

__THROW
;

446 
	$__bzo
 (*
__s
, 
size_t
 
__n

__THROW
 
	`__nnu
 ((1));

448 #ifde
__USE_MISC


450 
	$bcy
 (cڡ *
__c
, *
__de
, 
size_t
 
__n
)

451 
__THROW
 
	`__nnu
 ((1, 2));

454 
	$bzo
 (*
__s
, 
size_t
 
__n

__THROW
 
	`__nnu
 ((1));

457 
	$bcmp
 (cڡ *
__s1
, cڡ *
__s2
, 
size_t
 
__n
)

458 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

461 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


464 *
	`dex
 (*
__s
, 
__c
)

465 
__THROW
 
	`__asm
 ("dex"
__ibu_pu__
 
	`__nnu
 ((1));

466 cڡ *
	`dex
 (cڡ *
__s
, 
__c
)

467 
__THROW
 
	`__asm
 ("dex"
__ibu_pu__
 
	`__nnu
 ((1));

469 #i
defed
 
__OPTIMIZE__
 && !defed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


470 
__ex_ways_le
 *

471 
	`dex
 (*
__s
, 
__c

__THROW


473  
	`__but_dex
 (
__s
, 
__c
);

476 
__ex_ways_le
 const *

477 
	`dex
 (cڡ *
__s
, 
__c

__THROW


479  
	`__but_dex
 (
__s
, 
__c
);

482 
	}
}

484 *
	$dex
 (cڡ *
__s
, 
__c
)

485 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

489 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


492 *
	`rdex
 (*
__s
, 
__c
)

493 
__THROW
 
	`__asm
 ("rdex"
__ibu_pu__
 
	`__nnu
 ((1));

494 cڡ *
	`rdex
 (cڡ *
__s
, 
__c
)

495 
__THROW
 
	`__asm
 ("rdex"
__ibu_pu__
 
	`__nnu
 ((1));

497 #i
defed
 
__OPTIMIZE__
 && !defed 
__CORRECT_ISO_CPP_STRINGS_H_PROTO


498 
__ex_ways_le
 *

499 
	`rdex
 (*
__s
, 
__c

__THROW


501  
	`__but_rdex
 (
__s
, 
__c
);

504 
__ex_ways_le
 const *

505 
	`rdex
 (cڡ *
__s
, 
__c

__THROW


507  
	`__but_rdex
 (
__s
, 
__c
);

510 
	}
}

512 *
	$rdex
 (cڡ *
__s
, 
__c
)

513 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

518 
	$ffs
 (
__i

__THROW
 
	`__ibu__
 ((
__cڡ__
));

522 #ifdef 
__USE_GNU


523 
	$ff
 (
__l

__THROW
 
	`__ibu__
 ((
__cڡ__
));

524 
__exnsi__
 
	$ffl
 (
__
)

525 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

529 
	$rcmp
 (cڡ *
__s1
, cڡ *
__s2
)

530 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

533 
	$cmp
 (cڡ *
__s1
, cڡ *
__s2
, 
size_t
 
__n
)

534 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

537 #ifdef 
__USE_GNU


540 
	$rcmp_l
 (cڡ *
__s1
, cڡ *
__s2
,

541 
__lo_t
 
__loc
)

542 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2, 3));

544 
	$cmp_l
 (cڡ *
__s1
, cڡ *
__s2
,

545 
size_t
 
__n
, 
__lo_t
 
__loc
)

546 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2, 4));

549 #ifdef 
__USE_MISC


552 *
	$rp
 (**
__ri
 
__rgp
,

553 cڡ *
__ri
 
__dim
)

554 
__THROW
 
	`__nnu
 ((1, 2));

557 #ifdef 
__USE_XOPEN2K8


559 *
	$rsigl
 (
__sig

__THROW
;

562 *
	$__py
 (*
__ri
 
__de
, cڡ *__ri 
__c
)

563 
__THROW
 
	`__nnu
 ((1, 2));

564 *
	$py
 (*
__ri
 
__de
, cڡ *__ri 
__c
)

565 
__THROW
 
	`__nnu
 ((1, 2));

569 *
	$__y
 (*
__ri
 
__de
,

570 cڡ *
__ri
 
__c
, 
size_t
 
__n
)

571 
__THROW
 
	`__nnu
 ((1, 2));

572 *
	$y
 (*
__ri
 
__de
,

573 cڡ *
__ri
 
__c
, 
size_t
 
__n
)

574 
__THROW
 
	`__nnu
 ((1, 2));

577 #ifdef 
__USE_GNU


579 
	$rvscmp
 (cڡ *
__s1
, cڡ *
__s2
)

580 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

583 *
	$ry
 (*
__rg

__THROW
 
	`__nnu
 ((1));

586 *
	$memob
 (*
__s
, 
size_t
 
__n

__THROW
 
	`__nnu
 ((1));

588 #ide
bame


593 #ifde
__CORRECT_ISO_CPP_STRING_H_PROTO


594 "C++" *
	$bame
 (*
__fame
)

595 
__THROW
 
	`__asm
 ("bame"
	`__nnu
 ((1));

596 "C++" cڡ *
	$bame
 (cڡ *
__fame
)

597 
__THROW
 
	`__asm
 ("bame"
	`__nnu
 ((1));

599 *
	$bame
 (cڡ *
__fame

__THROW
 
	`__nnu
 ((1));

605 #i
defed
 
__GNUC__
 && __GNUC__ >= 2

606 #i
defed
 
__OPTIMIZE__
 && !defed 
__OPTIMIZE_SIZE__
 \

607 && !
defed
 
__NO_INLINE__
 && !defed 
__lulus


627 
	~<bs/rg.h
>

630 
	~<bs/rg2.h
>

633 #i
__USE_FORTIFY_LEVEL
 > 0 && 
defed
 
__ftify_funi


635 
	~<bs/rg3.h
>

639 #i
defed
 
__USE_GNU
 && defed 
__OPTIMIZE__
 \

640 && 
defed
 
__ex_ways_le
 && 
	$__GNUC_PREREQ
 (3,2)

641 #i!
defed
 
_FORCE_INLINES
 && !defed 
_HAVE_STRING_ARCH_mempy


643 #unde
mempy


644 #unde
__mempy


645 
	#mempy
(
de
, 
c
, 
n

	`__mempy_le
 (de, src,)

	)

646 
	#__mempy
(
de
, 
c
, 
n

	`__mempy_le
 (de, src,)

	)

648 
__ex_ways_le
 *

649 
	$__mempy_le
 (*
__ri
 
__de
,

650 cڡ *
__ri
 
__c
, 
size_t
 
__n
)

652  (*
	`memy
 (
__de
, 
__c
, 
__n
) + __n;

653 
	}
}

658 
	g__END_DECLS


	@/usr/include/strings.h

18 #idef 
_STRINGS_H


19 
	#_STRINGS_H
 1

	)

24 #i!
defed
 
_STRING_H
 || !defed 
__USE_MISC


26 
	~<us.h
>

27 
	#__ed_size_t


	)

28 
	~<ddef.h
>

31 #i
defed
 
__lulus
 && 
__GNUC_PREREQ
 (4, 4)

32 
	#__CORRECT_ISO_CPP_STRINGS_H_PROTO


	)

35 
	g__BEGIN_DECLS


37 #i
defed
 
__USE_MISC
 || !defed 
__USE_XOPEN2K8


39 
	$bcmp
 (cڡ *
__s1
, cڡ *
__s2
, 
size_t
 
__n
)

40 
__THROW
 
__ibu_pu__
;

43 
	$bcy
 (cڡ *
__c
, *
__de
, 
size_t
 
__n

__THROW
;

46 
	$bzo
 (*
__s
, 
size_t
 
__n

__THROW
;

49 #ifde
__CORRECT_ISO_CPP_STRINGS_H_PROTO


52 *
	`dex
 (*
__s
, 
__c
)

53 
__THROW
 
	`__asm
 ("dex"
__ibu_pu__
 
	`__nnu
 ((1));

54 cڡ *
	`dex
 (cڡ *
__s
, 
__c
)

55 
__THROW
 
	`__asm
 ("dex"
__ibu_pu__
 
	`__nnu
 ((1));

57 #i
defed
 
__OPTIMIZE__
 && !defed 
__CORRECT_ISO_CPP_STRING_H_PROTO


58 
__ex_ways_le
 *

59 
	`dex
 (*
__s
, 
__c

__THROW


61  
	`__but_dex
 (
__s
, 
__c
);

64 
__ex_ways_le
 const *

65 
	`dex
 (cڡ *
__s
, 
__c

__THROW


67  
	`__but_dex
 (
__s
, 
__c
);

70 
	}
}

72 *
	$dex
 (cڡ *
__s
, 
__c
)

73 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

77 #ifde
__CORRECT_ISO_CPP_STRINGS_H_PROTO


80 *
	`rdex
 (*
__s
, 
__c
)

81 
__THROW
 
	`__asm
 ("rdex"
__ibu_pu__
 
	`__nnu
 ((1));

82 cڡ *
	`rdex
 (cڡ *
__s
, 
__c
)

83 
__THROW
 
	`__asm
 ("rdex"
__ibu_pu__
 
	`__nnu
 ((1));

85 #i
defed
 
__OPTIMIZE__
 && !defed 
__CORRECT_ISO_CPP_STRING_H_PROTO


86 
__ex_ways_le
 *

87 
	`rdex
 (*
__s
, 
__c

__THROW


89  
	`__but_rdex
 (
__s
, 
__c
);

92 
__ex_ways_le
 const *

93 
	`rdex
 (cڡ *
__s
, 
__c

__THROW


95  
	`__but_rdex
 (
__s
, 
__c
);

98 
	}
}

100 *
	$rdex
 (cڡ *
__s
, 
__c
)

101 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1));

105 #i
defed
 
__USE_MISC
 || !defed 
__USE_XOPEN2K8
 || defed 
__USE_XOPEN2K8XSI


108 
	$ffs
 (
__i

__THROW
 
	`__ibu__
 ((const));

112 
	$rcmp
 (cڡ *
__s1
, cڡ *
__s2
)

113 
__THROW
 
__ibu_pu__
;

116 
	$cmp
 (cڡ *
__s1
, cڡ *
__s2
, 
size_t
 
__n
)

117 
__THROW
 
__ibu_pu__
;

119 #ifdef 
__USE_XOPEN2K8


123 
	~<xlo.h
>

127 
	$rcmp_l
 (cڡ *
__s1
, cڡ *
__s2
, 
__lo_t
 
__loc
)

128 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2, 3));

130 
	$cmp_l
 (cڡ *
__s1
, cڡ *
__s2
,

131 
size_t
 
__n
, 
__lo_t
 
__loc
)

132 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2, 4));

135 
__END_DECLS


	@/usr/include/termios.h

22 #idef 
_TERMIOS_H


23 
	#_TERMIOS_H
 1

	)

25 
	~<us.h
>

26 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K8


28 
	~<bs/tys.h
>

29 #ide
__pid_t_defed


30 
__pid_t
 
	tpid_t
;

31 
	#__pid_t_defed


	)

35 
	g__BEGIN_DECLS


39 
	~<bs/rmios.h
>

41 #ifde
__USE_MISC


44 
	#CCEQ
(
v
, 
c
((c=(v&& (v!
_POSIX_VDISABLE
)

	)

48 
d_t
 
	$cfgod
 (cڡ 
rmios
 *
__rmios_p

__THROW
;

51 
d_t
 
	$cfgid
 (cڡ 
rmios
 *
__rmios_p

__THROW
;

54 
	$cftod
 (
rmios
 *
__rmios_p
, 
d_t
 
__d

__THROW
;

57 
	$cftid
 (
rmios
 *
__rmios_p
, 
d_t
 
__d

__THROW
;

59 #ifdef 
__USE_MISC


61 
	$cftd
 (
rmios
 *
__rmios_p
, 
d_t
 
__d

__THROW
;

66 
	$tcg
 (
__fd
, 
rmios
 *
__rmios_p

__THROW
;

70 
	$tcr
 (
__fd
, 
__tiڮ_ais
,

71 cڡ 
rmios
 *
__rmios_p

__THROW
;

74 #ifdef 
__USE_MISC


76 
	$cfmakaw
 (
rmios
 *
__rmios_p

__THROW
;

80 
	$tcndbak
 (
__fd
, 
__duti

__THROW
;

86 
	`tcd
 (
__fd
);

90 
	$tcush
 (
__fd
, 
__queue_

__THROW
;

94 
	$tcow
 (
__fd
, 
__ai

__THROW
;

97 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K8


99 
__pid_t
 
	$tcgsid
 (
__fd

__THROW
;

103 #ifde
__USE_MISC


104 
	~<sys/ydeus.h
>

107 
__END_DECLS


	@/usr/include/time.h

22 #idef 
_TIME_H


24 #i(! 
defed
 
__ed_time_t
 && !defed 
__ed_ock_t
 && \

25 ! 
defed
 
	g__ed_timeec
)

26 
	#_TIME_H
 1

	)

27 
	~<us.h
>

29 
	g__BEGIN_DECLS


33 #ifdef 
_TIME_H


35 
	#__ed_size_t


	)

36 
	#__ed_NULL


	)

37 
	~<ddef.h
>

41 
	~<bs/time.h
>

44 #i!
defed
 
__STRICT_ANSI__
 && !defed 
__USE_XOPEN2K


45 #ide
CLK_TCK


46 
	#CLK_TCK
 
CLOCKS_PER_SEC


	)

52 #i!
defed
 
__ock_t_defed
 && (defed 
_TIME_H
 || defed 
__ed_ock_t
)

53 
	#__ock_t_defed
 1

	)

55 
	~<bs/tys.h
>

57 
__BEGIN_NAMESPACE_STD


59 
__ock_t
 
	tock_t
;

60 
	g__END_NAMESPACE_STD


61 #i
defed
 
__USE_XOPEN
 || defed 
__USE_POSIX


62 
	$__USING_NAMESPACE_STD
(
ock_t
)

66 #unde
__ed_ock_t


68 #i!
defed
 
__time_t_defed
 && (defed 
_TIME_H
 || defed 
__ed_time_t
)

69 
	#__time_t_defed
 1

	)

71 
	~<bs/tys.h
>

73 
__BEGIN_NAMESPACE_STD


75 
__time_t
 
	ttime_t
;

76 
__END_NAMESPACE_STD


77 #ifde
__USE_POSIX


78 
	$__USING_NAMESPACE_STD
(
time_t
)

82 #unde
__ed_time_t


84 #i!
defed
 
__ockid_t_defed
 && \

85 ((
defed
 
_TIME_H
 && defed 
__USE_POSIX199309
|| defed 
__ed_ockid_t
)

86 
	#__ockid_t_defed
 1

	)

88 
	~<bs/tys.h
>

91 
__ockid_t
 
	tockid_t
;

94 #unde
__ockid_time_t


96 #i!
defed
 
__tim_t_defed
 && \

97 ((
defed
 
_TIME_H
 && defed 
__USE_POSIX199309
|| defed 
__ed_tim_t
)

98 
	#__tim_t_defed
 1

	)

100 
	~<bs/tys.h
>

103 
__tim_t
 
	ttim_t
;

106 #unde
__ed_tim_t


109 #i(!
defed
 
__timeec_defed
 \

110 && ((
defed
 
_TIME_H
 \

111 && (
defed
 
__USE_POSIX199309
 \

112 || 
defed
 
__USE_ISOC11
)) \

113 || 
defed
 
__ed_timeec
))

114 
	#__timeec_defed
 1

	)

116 
	~<bs/tys.h
>

120 
	stimeec


122 
__time_t
 
tv_c
;

123 
__sys_g_t
 
tv_nc
;

127 #unde
__ed_timeec


130 #ifdef 
_TIME_H


131 
__BEGIN_NAMESPACE_STD


133 
	stm


135 
tm_c
;

136 
tm_m
;

137 
tm_hour
;

138 
tm_mday
;

139 
tm_m
;

140 
tm_yr
;

141 
tm_wday
;

142 
tm_yday
;

143 
tm_isd
;

145 #ifdef 
__USE_MISC


146 
tm_gmtoff
;

147 cڡ *
tm_ze
;

149 
__tm_gmtoff
;

150 cڡ *
__tm_ze
;

153 
__END_NAMESPACE_STD


154 #i
defed
 
__USE_XOPEN
 || defed 
__USE_POSIX


155 
	$__USING_NAMESPACE_STD
(
tm
)

159 #ifde
__USE_POSIX199309


161 
	simec


163 
timeec
 
_rv
;

164 
timeec
 
_vue
;

168 
sigevt
;

172 #ifde
__USE_XOPEN2K


173 #ide
__pid_t_defed


174 
__pid_t
 
	tpid_t
;

175 
	#__pid_t_defed


	)

180 #ifde
__USE_ISOC11


182 
	#TIME_UTC
 1

	)

186 
__BEGIN_NAMESPACE_STD


189 
ock_t
 
	$ock
 (
__THROW
;

192 
time_t
 
	$time
 (
time_t
 *
__tim

__THROW
;

195 
	$difime
 (
time_t
 
__time1
,ime_
__time0
)

196 
__THROW
 
	`__ibu__
 ((
__cڡ__
));

199 
time_t
 
	$mktime
 (
tm
 *
__

__THROW
;

205 
size_t
 
	$rime
 (*
__ri
 
__s
, 
size_t
 
__maxsize
,

206 cڡ *
__ri
 
__fm
,

207 cڡ 
tm
 *
__ri
 
__

__THROW
;

208 
__END_NAMESPACE_STD


210 #ifde
__USE_XOPEN


213 *
	$time
 (cڡ *
__ri
 
__s
,

214 cڡ *
__ri
 
__fmt
, 
tm
 *
__
)

215 
__THROW
;

218 #ifde
__USE_XOPEN2K8


221 
	~<xlo.h
>

223 
size_t
 
	$rime_l
 (*
__ri
 
__s
, 
size_t
 
__maxsize
,

224 cڡ *
__ri
 
__fm
,

225 cڡ 
tm
 *
__ri
 
__
,

226 
__lo_t
 
__loc

__THROW
;

229 #ifde
__USE_GNU


230 *
	$time_l
 (cڡ *
__ri
 
__s
,

231 cڡ *
__ri
 
__fmt
, 
tm
 *
__
,

232 
__lo_t
 
__loc

__THROW
;

236 
__BEGIN_NAMESPACE_STD


239 
tm
 *
	$gmtime
 (cڡ 
time_t
 *
__tim

__THROW
;

243 
tm
 *
	$loime
 (cڡ 
time_t
 *
__tim

__THROW
;

244 
__END_NAMESPACE_STD


246 #ifde
__USE_POSIX


249 
tm
 *
	$gmtime_r
 (cڡ 
time_t
 *
__ri
 
__tim
,

250 
tm
 *
__ri
 
__

__THROW
;

254 
tm
 *
	$loime_r
 (cڡ 
time_t
 *
__ri
 
__tim
,

255 
tm
 *
__ri
 
__

__THROW
;

258 
__BEGIN_NAMESPACE_STD


261 *
	$asime
 (cڡ 
tm
 *
__

__THROW
;

264 *
	$ime
 (cڡ 
time_t
 *
__tim

__THROW
;

265 
__END_NAMESPACE_STD


267 #ifde
__USE_POSIX


272 *
	$asime_r
 (cڡ 
tm
 *
__ri
 
__
,

273 *
__ri
 
__buf

__THROW
;

276 *
	$ime_r
 (cڡ 
time_t
 *
__ri
 
__tim
,

277 *
__ri
 
__buf

__THROW
;

282 *
__tzme
[2];

283 
__daylight
;

284 
__timeze
;

287 #ifdef 
__USE_POSIX


289 *
tzme
[2];

293 
	$tzt
 (
__THROW
;

296 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


297 
daylight
;

298 
timeze
;

301 #ifde
__USE_MISC


304 
	$ime
 (cڡ 
time_t
 *
__wh

__THROW
;

310 
	#__ip
(
yr
) \

311 ((
yr
% 4 =0 && ((yr% 100 !0 || (yr% 400 =0))

	)

314 #ifde
__USE_MISC


319 
time_t
 
	$timegm
 (
tm
 *
__

__THROW
;

322 
time_t
 
	$timol
 (
tm
 *
__

__THROW
;

325 
	$dysize
 (
__yr

__THROW
 
	`__ibu__
 ((
__cڡ__
));

329 #ifde
__USE_POSIX199309


334 
	`nop
 (cڡ 
timeec
 *
__queed_time
,

335 
timeec
 *
__mag
);

339 
	$ock_gs
 (
ockid_t
 
__ock_id
, 
timeec
 *
__s

__THROW
;

342 
	$ock_gtime
 (
ockid_t
 
__ock_id
, 
timeec
 *
__

__THROW
;

345 
	$ock_ime
 (
ockid_t
 
__ock_id
, cڡ 
timeec
 *
__
)

346 
__THROW
;

348 #ifde
__USE_XOPEN2K


353 
	`ock_nop
 (
ockid_t
 
__ock_id
, 
__ags
,

354 cڡ 
timeec
 *
__q
,

355 
timeec
 *
__m
);

358 
	$ock_guockid
 (
pid_t
 
__pid
, 
ockid_t
 *
__ock_id

__THROW
;

363 
	$tim_
 (
ockid_t
 
__ock_id
,

364 
sigevt
 *
__ri
 
__evp
,

365 
tim_t
 *
__ri
 
__timid

__THROW
;

368 
	$tim_de
 (
tim_t
 
__timid

__THROW
;

371 
	$tim_ime
 (
tim_t
 
__timid
, 
__ags
,

372 cڡ 
imec
 *
__ri
 
__vue
,

373 
imec
 *
__ri
 
__ovue

__THROW
;

376 
	$tim_gtime
 (
tim_t
 
__timid
, 
imec
 *
__vue
)

377 
__THROW
;

380 
	$tim_govrun
 (
tim_t
 
__timid

__THROW
;

384 #ifde
__USE_ISOC11


386 
	$timeec_g
 (
timeec
 *
__ts
, 
__ba
)

387 
__THROW
 
	`__nnu
 ((1));

391 #ifde
__USE_XOPEN_EXTENDED


403 
gde_r
;

412 
tm
 *
	`gde
 (cڡ *
__rg
);

415 #ifde
__USE_GNU


426 
	`gde_r
 (cڡ *
__ri
 
__rg
,

427 
tm
 *
__ri
 
__sbu
);

430 
__END_DECLS


	@/usr/include/unistd.h

22 #idef 
_UNISTD_H


23 
	#_UNISTD_H
 1

	)

25 
	~<us.h
>

27 
	g__BEGIN_DECLS


32 #ifde
__USE_XOPEN2K8


34 
	#_POSIX_VERSION
 200809L

	)

35 #i
defed
 
__USE_XOPEN2K


37 
	#_POSIX_VERSION
 200112L

	)

38 #i
defed
 
__USE_POSIX199506


40 
	#_POSIX_VERSION
 199506L

	)

41 #i
defed
 
__USE_POSIX199309


43 
	#_POSIX_VERSION
 199309L

	)

46 
	#_POSIX_VERSION
 199009L

	)

52 #ifde
__USE_XOPEN2K8


53 
	#__POSIX2_THIS_VERSION
 200809L

	)

55 #i
defed
 
__USE_XOPEN2K


57 
	#__POSIX2_THIS_VERSION
 200112L

	)

58 #i
defed
 
__USE_POSIX199506


60 
	#__POSIX2_THIS_VERSION
 199506L

	)

63 
	#__POSIX2_THIS_VERSION
 199209L

	)

67 
	#_POSIX2_VERSION
 
__POSIX2_THIS_VERSION


	)

70 
	#_POSIX2_C_VERSION
 
__POSIX2_THIS_VERSION


	)

74 
	#_POSIX2_C_BIND
 
__POSIX2_THIS_VERSION


	)

78 
	#_POSIX2_C_DEV
 
__POSIX2_THIS_VERSION


	)

82 
	#_POSIX2_SW_DEV
 
__POSIX2_THIS_VERSION


	)

86 
	#_POSIX2_LOCALEDEF
 
__POSIX2_THIS_VERSION


	)

89 #ifde
__USE_XOPEN2K8


90 
	#_XOPEN_VERSION
 700

	)

91 #i
defed
 
__USE_XOPEN2K


92 
	#_XOPEN_VERSION
 600

	)

93 #i
defed
 
__USE_UNIX98


94 
	#_XOPEN_VERSION
 500

	)

96 
	#_XOPEN_VERSION
 4

	)

100 
	#_XOPEN_XCU_VERSION
 4

	)

103 
	#_XOPEN_XPG2
 1

	)

104 
	#_XOPEN_XPG3
 1

	)

105 
	#_XOPEN_XPG4
 1

	)

108 
	#_XOPEN_UNIX
 1

	)

111 
	#_XOPEN_CRYPT
 1

	)

115 
	#_XOPEN_ENH_I18N
 1

	)

118 
	#_XOPEN_LEGACY
 1

	)

205 
	~<bs/posix_t.h
>

208 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K


209 
	~<bs/vmts.h
>

213 
	#STDIN_FILENO
 0

	)

214 
	#STDOUT_FILENO
 1

	)

215 
	#STDERR_FILENO
 2

	)

220 
	~<bs/tys.h
>

222 #idef 
__ssize_t_defed


223 
__ssize_t
 
	tssize_t
;

224 
	#__ssize_t_defed


	)

227 
	#__ed_size_t


	)

228 
	#__ed_NULL


	)

229 
	~<ddef.h
>

231 #i
defed
 
__USE_XOPEN
 || defed 
__USE_XOPEN2K


234 #ide
__gid_t_defed


235 
__gid_t
 
	tgid_t
;

236 
	#__gid_t_defed


	)

239 #ide
__uid_t_defed


240 
__uid_t
 
	tuid_t
;

241 
	#__uid_t_defed


	)

244 #ide
__off_t_defed


245 #ide
__USE_FILE_OFFSET64


246 
__off_t
 
	toff_t
;

248 
__off64_t
 
	toff_t
;

250 
	#__off_t_defed


	)

252 #i
defed
 
__USE_LARGEFILE64
 && !defed 
__off64_t_defed


253 
__off64_t
 
	toff64_t
;

254 
	#__off64_t_defed


	)

257 #ide
__ucds_t_defed


258 
__ucds_t
 
	tucds_t
;

259 
	#__ucds_t_defed


	)

262 #ide
__pid_t_defed


263 
__pid_t
 
	tpid_t
;

264 
	#__pid_t_defed


	)

268 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K


269 #ide
___t_defed


270 
___t
 
	t_t
;

271 
	#___t_defed


	)

275 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


276 #ide
__sockn_t_defed


277 
__sockn_t
 
	tsockn_t
;

278 
	#__sockn_t_defed


	)

284 
	#R_OK
 4

	)

285 
	#W_OK
 2

	)

286 
	#X_OK
 1

	)

287 
	#F_OK
 0

	)

290 
	$acss
 (cڡ *
__me
, 
__ty

__THROW
 
	`__nnu
 ((1));

292 #ifde
__USE_GNU


295 
	$euidacss
 (cڡ *
__me
, 
__ty
)

296 
__THROW
 
	`__nnu
 ((1));

299 
	$css
 (cڡ *
__me
, 
__ty
)

300 
__THROW
 
	`__nnu
 ((1));

303 #ifde
__USE_ATFILE


307 
	$cst
 (
__fd
, cڡ *
__fe
, 
__ty
, 
__ag
)

308 
__THROW
 
	`__nnu
 ((2)
__wur
;

313 #idef 
_STDIO_H


314 
	#SEEK_SET
 0

	)

315 
	#SEEK_CUR
 1

	)

316 
	#SEEK_END
 2

	)

317 #ifde
__USE_GNU


318 
	#SEEK_DATA
 3

	)

319 
	#SEEK_HOLE
 4

	)

323 #i
defed
 
__USE_MISC
 && !defed 
L_SET


325 
	#L_SET
 
SEEK_SET


	)

326 
	#L_INCR
 
SEEK_CUR


	)

327 
	#L_XTND
 
SEEK_END


	)

336 #ide
__USE_FILE_OFFSET64


337 
__off_t
 
	$lek
 (
__fd
, 
__off_t
 
__offt
, 
__wh

__THROW
;

339 #ifde
__REDIRECT_NTH


340 
__off64_t
 
	`__REDIRECT_NTH
 (
lek
,

341 (
__fd
, 
__off64_t
 
__offt
, 
__wh
),

342 
lek64
);

344 
	#lek
 
lek64


	)

347 #ifde
__USE_LARGEFILE64


348 
__off64_t
 
	$lek64
 (
__fd
, 
__off64_t
 
__offt
, 
__wh
)

349 
__THROW
;

356 
	`o
 (
__fd
);

363 
ssize_t
 
	$ad
 (
__fd
, *
__buf
, 
size_t
 
__nbys

__wur
;

369 
ssize_t
 
	$wre
 (
__fd
, cڡ *
__buf
, 
size_t
 
__n

__wur
;

371 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K8


372 #ide
__USE_FILE_OFFSET64


379 
ssize_t
 
	$d
 (
__fd
, *
__buf
, 
size_t
 
__nbys
,

380 
__off_t
 
__offt

__wur
;

387 
ssize_t
 
	$pwre
 (
__fd
, cڡ *
__buf
, 
size_t
 
__n
,

388 
__off_t
 
__offt

__wur
;

390 #ifde
__REDIRECT


391 
ssize_t
 
	`__REDIRECT
 (
d
, (
__fd
, *
__buf
, 
size_t
 
__nbys
,

392 
__off64_t
 
__offt
),

393 
d64

__wur
;

394 
ssize_t
 
	`__REDIRECT
 (
pwre
, (
__fd
, cڡ *
__buf
,

395 
size_t
 
__nbys
, 
__off64_t
 
__offt
),

396 
pwre64

__wur
;

398 
	#d
 
d64


	)

399 
	#pwre
 
pwre64


	)

403 #ifde
__USE_LARGEFILE64


407 
ssize_t
 
	$d64
 (
__fd
, *
__buf
, 
size_t
 
__nbys
,

408 
__off64_t
 
__offt

__wur
;

411 
ssize_t
 
	$pwre64
 (
__fd
, cڡ *
__buf
, 
size_t
 
__n
,

412 
__off64_t
 
__offt

__wur
;

420 
	$pe
 (
__pedes
[2]
__THROW
 
__wur
;

422 #ifde
__USE_GNU


425 
	$pe2
 (
__pedes
[2], 
__ags

__THROW
 
__wur
;

435 
	$m
 (
__cds

__THROW
;

447 
	`p
 (
__cds
);

449 #i(
defed
 
__USE_XOPEN_EXTENDED
 && !defed 
__USE_XOPEN2K8
) \

450 || 
defed
 
__USE_MISC


455 
__ucds_t
 
	$um
 (
__ucds_t
 
__vue
, __ucds_
__rv
)

456 
__THROW
;

463 
	`up
 (
__ucds_t
 
__ucds
);

472 
	`u
 ();

476 
	$chown
 (cڡ *
__fe
, 
__uid_t
 
__owr
, 
__gid_t
 
__group
)

477 
__THROW
 
	`__nnu
 ((1)
__wur
;

479 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K8


481 
	$fchown
 (
__fd
, 
__uid_t
 
__owr
, 
__gid_t
 
__group

__THROW
 
__wur
;

486 
	$lchown
 (cڡ *
__fe
, 
__uid_t
 
__owr
, 
__gid_t
 
__group
)

487 
__THROW
 
	`__nnu
 ((1)
__wur
;

491 #ifde
__USE_ATFILE


494 
	$fchowt
 (
__fd
, cڡ *
__fe
, 
__uid_t
 
__owr
,

495 
__gid_t
 
__group
, 
__ag
)

496 
__THROW
 
	`__nnu
 ((2)
__wur
;

500 
	$chd
 (cڡ *
__th

__THROW
 
	`__nnu
 ((1)
__wur
;

502 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K8


504 
	$fchd
 (
__fd

__THROW
 
__wur
;

514 *
	$gcwd
 (*
__buf
, 
size_t
 
__size

__THROW
 
__wur
;

516 #ifdef 
__USE_GNU


520 *
	$g_cut_d_me
 (
__THROW
;

523 #i(
defed
 
__USE_XOPEN_EXTENDED
 && !defed 
__USE_XOPEN2K8
) \

524 || 
defed
 
__USE_MISC


528 *
	$gwd
 (*
__buf
)

529 
__THROW
 
	`__nnu
 ((1)
__ibu_dd__
 
__wur
;

534 
	$dup
 (
__fd

__THROW
 
__wur
;

537 
	$dup2
 (
__fd
, 
__fd2

__THROW
;

539 #ifde
__USE_GNU


542 
	$dup3
 (
__fd
, 
__fd2
, 
__ags

__THROW
;

546 **
__v
;

547 #ifde
__USE_GNU


548 **
v
;

554 
	$execve
 (cڡ *
__th
, *cڡ 
__gv
[],

555 *cڡ 
__vp
[]
__THROW
 
	`__nnu
 ((1, 2));

557 #ifde
__USE_XOPEN2K8


560 
	$xecve
 (
__fd
, *cڡ 
__gv
[], *cڡ 
__vp
[])

561 
__THROW
 
	`__nnu
 ((2));

566 
	$execv
 (cڡ *
__th
, *cڡ 
__gv
[])

567 
__THROW
 
	`__nnu
 ((1, 2));

571 
	$exee
 (cڡ *
__th
, cڡ *
__g
, ...)

572 
__THROW
 
	`__nnu
 ((1, 2));

576 
	$exe
 (cڡ *
__th
, cڡ *
__g
, ...)

577 
__THROW
 
	`__nnu
 ((1, 2));

581 
	$execvp
 (cڡ *
__fe
, *cڡ 
__gv
[])

582 
__THROW
 
	`__nnu
 ((1, 2));

587 
	$exep
 (cڡ *
__fe
, cڡ *
__g
, ...)

588 
__THROW
 
	`__nnu
 ((1, 2));

590 #ifde
__USE_GNU


593 
	$execv
 (cڡ *
__fe
, *cڡ 
__gv
[],

594 *cڡ 
__vp
[])

595 
__THROW
 
	`__nnu
 ((1, 2));

599 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


601 
	$ni
 (
__c

__THROW
 
__wur
;

606 
	$_ex
 (
__us

	`__ibu__
 ((
__nܑu__
));

612 
	~<bs/came.h
>

615 
	$thcf
 (cڡ *
__th
, 
__me
)

616 
__THROW
 
	`__nnu
 ((1));

619 
	$hcf
 (
__fd
, 
__me

__THROW
;

622 
	$syscf
 (
__me

__THROW
;

624 #ifdef 
__USE_POSIX2


626 
size_t
 
	$cfr
 (
__me
, *
__buf
, 
size_t
 
__n

__THROW
;

631 
__pid_t
 
	$gpid
 (
__THROW
;

634 
__pid_t
 
	$gid
 (
__THROW
;

637 
__pid_t
 
	$gpg
 (
__THROW
;

640 
__pid_t
 
	$__gpgid
 (
__pid_t
 
__pid

__THROW
;

641 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K8


642 
__pid_t
 
	$gpgid
 (
__pid_t
 
__pid

__THROW
;

649 
	$gid
 (
__pid_t
 
__pid
, __pid_
__pgid

__THROW
;

651 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED


663 
	$g
 (
__THROW
;

670 
__pid_t
 
	$tsid
 (
__THROW
;

672 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K8


674 
__pid_t
 
	$gsid
 (
__pid_t
 
__pid

__THROW
;

678 
__uid_t
 
	$guid
 (
__THROW
;

681 
__uid_t
 
	$geuid
 (
__THROW
;

684 
__gid_t
 
	$ggid
 (
__THROW
;

687 
__gid_t
 
	$gegid
 (
__THROW
;

692 
	$ggroups
 (
__size
, 
__gid_t
 
__li
[]
__THROW
 
__wur
;

694 #ifdef 
__USE_GNU


696 
	$group_memb
 (
__gid_t
 
__gid

__THROW
;

703 
	$tuid
 (
__uid_t
 
__uid

__THROW
 
__wur
;

705 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED


708 
	$euid
 (
__uid_t
 
__ruid
, __uid_
__euid

__THROW
 
__wur
;

711 #ifde
__USE_XOPEN2K


713 
	$uid
 (
__uid_t
 
__uid

__THROW
 
__wur
;

720 
	$tgid
 (
__gid_t
 
__gid

__THROW
 
__wur
;

722 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED


725 
	$egid
 (
__gid_t
 
__rgid
, __gid_
__egid

__THROW
 
__wur
;

728 #ifde
__USE_XOPEN2K


730 
	$gid
 (
__gid_t
 
__gid

__THROW
 
__wur
;

733 #ifde
__USE_GNU


736 
	$gsuid
 (
__uid_t
 *
__ruid
, __uid_*
__euid
, __uid_*
__suid
)

737 
__THROW
;

741 
	$gsgid
 (
__gid_t
 *
__rgid
, __gid_*
__egid
, __gid_*
__sgid
)

742 
__THROW
;

746 
	$esuid
 (
__uid_t
 
__ruid
, __uid_
__euid
, __uid_
__suid
)

747 
__THROW
 
__wur
;

751 
	$esgid
 (
__gid_t
 
__rgid
, __gid_
__egid
, __gid_
__sgid
)

752 
__THROW
 
__wur
;

759 
__pid_t
 
	$fk
 (
__THROWNL
;

761 #i(
defed
 
__USE_XOPEN_EXTENDED
 && !defed 
__USE_XOPEN2K8
) \

762 || 
defed
 
__USE_MISC


767 
__pid_t
 
	$vfk
 (
__THROW
;

773 *
	$yme
 (
__fd

__THROW
;

777 
	$yme_r
 (
__fd
, *
__buf
, 
size_t
 
__bu
)

778 
__THROW
 
	`__nnu
 ((2)
__wur
;

782 
	$iy
 (
__fd

__THROW
;

784 #i
defed
 
__USE_MISC
 \

785 || (
defed
 
__USE_XOPEN_EXTENDED
 && !defed 
__USE_UNIX98
)

788 
	$y
 (
__THROW
;

793 
	$lk
 (cڡ *
__om
, cڡ *
__to
)

794 
__THROW
 
	`__nnu
 ((1, 2)
__wur
;

796 #ifde
__USE_ATFILE


799 
	$lk
 (
__omfd
, cڡ *
__om
, 
__tofd
,

800 cڡ *
__to
, 
__ags
)

801 
__THROW
 
	`__nnu
 ((2, 4)
__wur
;

804 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K


806 
	$symlk
 (cڡ *
__om
, cڡ *
__to
)

807 
__THROW
 
	`__nnu
 ((1, 2)
__wur
;

812 
ssize_t
 
	$adlk
 (cڡ *
__ri
 
__th
,

813 *
__ri
 
__buf
, 
size_t
 
__n
)

814 
__THROW
 
	`__nnu
 ((1, 2)
__wur
;

817 #ifde
__USE_ATFILE


819 
	$symlk
 (cڡ *
__om
, 
__tofd
,

820 cڡ *
__to

__THROW
 
	`__nnu
 ((1, 3)
__wur
;

823 
ssize_t
 
	$adlk
 (
__fd
, cڡ *
__ri
 
__th
,

824 *
__ri
 
__buf
, 
size_t
 
__n
)

825 
__THROW
 
	`__nnu
 ((2, 3)
__wur
;

829 
	$uƚk
 (cڡ *
__me

__THROW
 
	`__nnu
 ((1));

831 #ifde
__USE_ATFILE


833 
	$uƚk
 (
__fd
, cڡ *
__me
, 
__ag
)

834 
__THROW
 
	`__nnu
 ((2));

838 
	$rmd
 (cڡ *
__th

__THROW
 
	`__nnu
 ((1));

842 
__pid_t
 
	$tcgpg
 (
__fd

__THROW
;

845 
	$tcg
 (
__fd
, 
__pid_t
 
__pg_id

__THROW
;

852 *
	`glog
 ();

853 #i
defed
 
__USE_REENTRANT
 || defed 
__USE_POSIX199506


860 
	$glog_r
 (*
__me
, 
size_t
 
__me_n

	`__nnu
 ((1));

863 #ifdef 
__USE_MISC


865 
	$og
 (cڡ *
__me

__THROW
 
	`__nnu
 ((1));

869 #ifdef 
__USE_POSIX2


873 
	#__ed_gt


	)

874 
	~<gt.h
>

878 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K


882 
	$ghome
 (*
__me
, 
size_t
 
__n

__THROW
 
	`__nnu
 ((1));

886 #i
defed
 
__USE_MISC


889 
	$thome
 (cڡ *
__me
, 
size_t
 
__n
)

890 
__THROW
 
	`__nnu
 ((1)
__wur
;

894 
	$thoid
 (
__id

__THROW
 
__wur
;

900 
	$gdomame
 (*
__me
, 
size_t
 
__n
)

901 
__THROW
 
	`__nnu
 ((1)
__wur
;

902 
	$tdomame
 (cڡ *
__me
, 
size_t
 
__n
)

903 
__THROW
 
	`__nnu
 ((1)
__wur
;

909 
	$vhgup
 (
__THROW
;

912 
	$voke
 (cڡ *
__fe

__THROW
 
	`__nnu
 ((1)
__wur
;

920 
	$of
 (*
__me_bufr
, 
size_t
 
__size
,

921 
size_t
 
__offt
, 
__s
)

922 
__THROW
 
	`__nnu
 ((1));

928 
	$ac
 (cڡ *
__me

__THROW
;

932 *
	$gurshl
 (
__THROW
;

933 
	$durshl
 (
__THROW
;

934 
	$turshl
 (
__THROW
;

940 
	$dm
 (
__nochd
, 
__noo

__THROW
 
__wur
;

944 #i
defed
 
__USE_MISC
 || (defed 
__USE_XOPEN
 && !defed 
__USE_XOPEN2K
)

947 
	$chro
 (cڡ *
__th

__THROW
 
	`__nnu
 ((1)
__wur
;

951 *
	$gss
 (cڡ *
__om

	`__nnu
 ((1));

959 
	`fsync
 (
__fd
);

962 #ifde
__USE_GNU


965 
	$syncfs
 (
__fd

__THROW
;

969 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED


972 
	`ghoid
 ();

975 
	$sync
 (
__THROW
;

978 #i
defed
 
__USE_MISC
 || !defed 
__USE_XOPEN2K


981 
	$ggesize
 (
__THROW
 
	`__ibu__
 ((
__cڡ__
));

986 
	$gdbsize
 (
__THROW
;

992 #i
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K8


995 #ide
__USE_FILE_OFFSET64


996 
	$un
 (cڡ *
__fe
, 
__off_t
 
__ngth
)

997 
__THROW
 
	`__nnu
 ((1)
__wur
;

999 #ifde
__REDIRECT_NTH


1000 
	`__REDIRECT_NTH
 (
un
,

1001 (cڡ *
__fe
, 
__off64_t
 
__ngth
),

1002 
un64

	`__nnu
 ((1)
__wur
;

1004 
	#un
 
un64


	)

1007 #ifde
__USE_LARGEFILE64


1008 
	$un64
 (cڡ *
__fe
, 
__off64_t
 
__ngth
)

1009 
__THROW
 
	`__nnu
 ((1)
__wur
;

1014 #i
defed
 
__USE_POSIX199309
 \

1015 || 
defed
 
__USE_XOPEN_EXTENDED
 || defed 
__USE_XOPEN2K


1018 #ide
__USE_FILE_OFFSET64


1019 
	$run
 (
__fd
, 
__off_t
 
__ngth

__THROW
 
__wur
;

1021 #ifde
__REDIRECT_NTH


1022 
	`__REDIRECT_NTH
 (
run
, (
__fd
, 
__off64_t
 
__ngth
),

1023 
run64

__wur
;

1025 
	#run
 
run64


	)

1028 #ifde
__USE_LARGEFILE64


1029 
	$run64
 (
__fd
, 
__off64_t
 
__ngth

__THROW
 
__wur
;

1035 #i(
defed
 
__USE_XOPEN_EXTENDED
 && !defed 
__USE_XOPEN2K
) \

1036 || 
defed
 
__USE_MISC


1040 
	$brk
 (*
__addr

__THROW
 
__wur
;

1046 *
	$sbrk
 (
_t
 
__d

__THROW
;

1050 #ifde
__USE_MISC


1061 
	$sys
 (
__syo
, ...
__THROW
;

1066 #i(
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED
&& !defed 
F_LOCK


1078 
	#F_ULOCK
 0

	)

1079 
	#F_LOCK
 1

	)

1080 
	#F_TLOCK
 2

	)

1081 
	#F_TEST
 3

	)

1083 #ide
__USE_FILE_OFFSET64


1084 
	$lockf
 (
__fd
, 
__cmd
, 
__off_t
 
__n

__wur
;

1086 #ifde
__REDIRECT


1087 
	`__REDIRECT
 (
lockf
, (
__fd
, 
__cmd
, 
__off64_t
 
__n
),

1088 
lockf64

__wur
;

1090 
	#lockf
 
lockf64


	)

1093 #ifde
__USE_LARGEFILE64


1094 
	$lockf64
 (
__fd
, 
__cmd
, 
__off64_t
 
__n

__wur
;

1099 #ifde
__USE_GNU


1104 
	#TEMP_FAILURE_RETRY
(
exessi
) \

1105 (
__exnsi__
 \

1106 ({ 
__su
; \

1107 d
__su
 = ((
exessi
); \

1108 
__su
 =-1L && 
o
 =
EINTR
); \

1109 
__su
; 
	}
}))

	)

1112 #i
defed
 
__USE_POSIX199309
 || defed 
__USE_UNIX98


1115 
fdasync
 (
__fdes
);

1121 #ifdef 
__USE_XOPEN


1123 *
	$y
 (cڡ *
__key
, cڡ *
__
)

1124 
__THROW
 
	`__nnu
 ((1, 2));

1128 
	$y
 (*
__glibc_block
, 
__edag
)

1129 
__THROW
 
	`__nnu
 ((1));

1136 
	$swab
 (cڡ *
__ri
 
__om
, *__ri 
__to
,

1137 
ssize_t
 
__n

__THROW
 
	`__nnu
 ((1, 2));

1143 #i
defed
 
__USE_XOPEN
 && !defed 
__USE_XOPEN2K


1145 *
	$mid
 (*
__s

__THROW
;

1150 #i
__USE_FORTIFY_LEVEL
 > 0 && 
defed
 
__ftify_funi


1151 
	~<bs/unid.h
>

1154 
__END_DECLS


	@/usr/include/alloca.h

18 #idef 
_ALLOCA_H


19 
	#_ALLOCA_H
 1

	)

21 
	~<us.h
>

23 
	#__ed_size_t


	)

24 
	~<ddef.h
>

26 
	g__BEGIN_DECLS


29 #unde
lo


32 *
	$lo
 (
size_t
 
__size

__THROW
;

34 #ifdef 
__GNUC__


35 
	#lo
(
size

	`__but_lo
 (size)

	)

38 
__END_DECLS


	@/usr/include/endian.h

18 #idef 
_ENDIAN_H


19 
	#_ENDIAN_H
 1

	)

21 
	~<us.h
>

31 
	#__LITTLE_ENDIAN
 1234

	)

32 
	#__BIG_ENDIAN
 4321

	)

33 
	#__PDP_ENDIAN
 3412

	)

36 
	~<bs/dn.h
>

40 #ide
__FLOAT_WORD_ORDER


41 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

44 #ifdef 
__USE_MISC


45 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

46 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

47 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

48 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

51 #i
__BYTE_ORDER
 =
__LITTLE_ENDIAN


52 
	#__LONG_LONG_PAIR
(
HI
, 
LO
LO, 
	)
HI

53 #i
__BYTE_ORDER
 =
__BIG_ENDIAN


54 
	#__LONG_LONG_PAIR
(
HI
, 
LO
HI, 
	)
LO

58 #i
defed
 
__USE_MISC
 && !defed 
__ASSEMBLER__


60 
	~<bs/bysw.h
>

62 #i
__BYTE_ORDER
 =
__LITTLE_ENDIAN


63 
	#htobe16
(
x

	`__bsw_16
 (x)

	)

64 
	#hte16
(
x
(x)

	)

65 
	#be16toh
(
x

	`__bsw_16
 (x)

	)

66 
	#16toh
(
x
(x)

	)

68 
	#htobe32
(
x

	`__bsw_32
 (x)

	)

69 
	#hte32
(
x
(x)

	)

70 
	#be32toh
(
x

	`__bsw_32
 (x)

	)

71 
	#32toh
(
x
(x)

	)

73 
	#htobe64
(
x

	`__bsw_64
 (x)

	)

74 
	#hte64
(
x
(x)

	)

75 
	#be64toh
(
x

	`__bsw_64
 (x)

	)

76 
	#64toh
(
x
(x)

	)

79 
	#htobe16
(
x
(x)

	)

80 
	#hte16
(
x

	`__bsw_16
 (x)

	)

81 
	#be16toh
(
x
(x)

	)

82 
	#16toh
(
x

	`__bsw_16
 (x)

	)

84 
	#htobe32
(
x
(x)

	)

85 
	#hte32
(
x

	`__bsw_32
 (x)

	)

86 
	#be32toh
(
x
(x)

	)

87 
	#32toh
(
x

	`__bsw_32
 (x)

	)

89 
	#htobe64
(
x
(x)

	)

90 
	#hte64
(
x

	`__bsw_64
 (x)

	)

91 
	#be64toh
(
x
(x)

	)

92 
	#64toh
(
x

	`__bsw_64
 (x)

	)

	@/usr/include/libio.h

28 #ide
_IO_STDIO_H


29 
	#_IO_STDIO_H


	)

31 
	~<_G_cfig.h
>

33 
	#_IO_os_t
 
_G_os_t


	)

34 
	#_IO_os64_t
 
_G_os64_t


	)

35 
	#_IO_size_t
 
size_t


	)

36 
	#_IO_ssize_t
 
__ssize_t


	)

37 
	#_IO_off_t
 
__off_t


	)

38 
	#_IO_off64_t
 
__off64_t


	)

39 
	#_IO_pid_t
 
__pid_t


	)

40 
	#_IO_uid_t
 
__uid_t


	)

41 
	#_IO_icv_t
 
_G_icv_t


	)

42 
	#_IO_HAVE_ST_BLKSIZE
 
_G_HAVE_ST_BLKSIZE


	)

43 
	#_IO_BUFSIZ
 
_G_BUFSIZ


	)

44 
	#_IO_va_li
 
_G_va_li


	)

45 
	#_IO_wt_t
 
wt_t


	)

48 
	#__ed___va_li


	)

49 
	~<dg.h
>

50 #ifde
__GNUC_VA_LIST


51 #unde
_IO_va_li


52 
	#_IO_va_li
 
__gnuc_va_li


	)

55 #ide
__P


56 
	~<sys/cdefs.h
>

59 
	#_IO_UNIFIED_JUMPTABLES
 1

	)

61 #ide
EOF


62 
	#EOF
 (-1)

	)

64 #ide
NULL


65 #i
defed
 
__GNUG__
 && \

66 (
	g__GNUC__
 > 2 || (__GNUC__ =2 && 
__GNUC_MINOR__
 >= 8))

67 
	#NULL
 (
__nu
)

	)

69 #i!
defed
(
__lulus
)

70 
	#NULL
 ((*)0)

	)

72 
	#NULL
 (0)

	)

77 
	#_IOS_INPUT
 1

	)

78 
	#_IOS_OUTPUT
 2

	)

79 
	#_IOS_ATEND
 4

	)

80 
	#_IOS_APPEND
 8

	)

81 
	#_IOS_TRUNC
 16

	)

82 
	#_IOS_NOCREATE
 32

	)

83 
	#_IOS_NOREPLACE
 64

	)

84 
	#_IOS_BIN
 128

	)

92 
	#_IO_MAGIC
 0xFBAD0000

	)

93 
	#_OLD_STDIO_MAGIC
 0xFABC0000

	)

94 
	#_IO_MAGIC_MASK
 0xFFFF0000

	)

95 
	#_IO_USER_BUF
 1

	)

96 
	#_IO_UNBUFFERED
 2

	)

97 
	#_IO_NO_READS
 4

	)

98 
	#_IO_NO_WRITES
 8

	)

99 
	#_IO_EOF_SEEN
 0x10

	)

100 
	#_IO_ERR_SEEN
 0x20

	)

101 
	#_IO_DELETE_DONT_CLOSE
 0x40

	)

102 
	#_IO_LINKED
 0x80

	)

103 
	#_IO_IN_BACKUP
 0x100

	)

104 
	#_IO_LINE_BUF
 0x200

	)

105 
	#_IO_TIED_PUT_GET
 0x400

	)

106 
	#_IO_CURRENTLY_PUTTING
 0x800

	)

107 
	#_IO_IS_APPENDING
 0x1000

	)

108 
	#_IO_IS_FILEBUF
 0x2000

	)

109 
	#_IO_BAD_SEEN
 0x4000

	)

110 
	#_IO_USER_LOCK
 0x8000

	)

112 
	#_IO_FLAGS2_MMAP
 1

	)

113 
	#_IO_FLAGS2_NOTCANCEL
 2

	)

114 #ifde
_LIBC


115 
	#_IO_FLAGS2_FORTIFY
 4

	)

117 
	#_IO_FLAGS2_USER_WBUF
 8

	)

118 #ifde
_LIBC


119 
	#_IO_FLAGS2_SCANF_STD
 16

	)

120 
	#_IO_FLAGS2_NOCLOSE
 32

	)

121 
	#_IO_FLAGS2_CLOEXEC
 64

	)

125 
	#_IO_SKIPWS
 01

	)

126 
	#_IO_LEFT
 02

	)

127 
	#_IO_RIGHT
 04

	)

128 
	#_IO_INTERNAL
 010

	)

129 
	#_IO_DEC
 020

	)

130 
	#_IO_OCT
 040

	)

131 
	#_IO_HEX
 0100

	)

132 
	#_IO_SHOWBASE
 0200

	)

133 
	#_IO_SHOWPOINT
 0400

	)

134 
	#_IO_UPPERCASE
 01000

	)

135 
	#_IO_SHOWPOS
 02000

	)

136 
	#_IO_SCIENTIFIC
 04000

	)

137 
	#_IO_FIXED
 010000

	)

138 
	#_IO_UNITBUF
 020000

	)

139 
	#_IO_STDIO
 040000

	)

140 
	#_IO_DONT_CLOSE
 0100000

	)

141 
	#_IO_BOOLALPHA
 0200000

	)

144 
_IO_jump_t
; 
	g_IO_FILE
;

147 #ifde
_IO_MTSAFE_IO


150 
	t_IO_lock_t
;

156 
	s_IO_mk
 {

157 
_IO_mk
 *
	m_xt
;

158 
_IO_FILE
 *
	m_sbuf
;

162 
	m_pos
;

164 
t_ampos
(
ampos
 

{ 
	m_os
 = sp; }

165 
t_offt
(
offt
{ 
	m_pos
 = offt; 
	m_os
 = (
ampos
)(-2); }

166 
	mpublic
:

167 
ammk
(
ambuf
 *
sb
);

168 ~
ammk
();

169 
vg
({  
	m_os
 == -2; }

170 
d
(
ammk
&);

171 
d
();

176 
	e__codecvt_su


178 
	m__codecvt_ok
,

179 
	m__codecvt_l
,

180 
	m__codecvt_r
,

181 
	m__codecvt_nocv


184 #i
defed
 
_LIBC
 || defed 
_GLIBCPP_USE_WCHAR_T


187 
	s_IO_codecvt


189 (*
	m__codecvt_der
(
	m_IO_codecvt
 *);

190 
__codecvt_su
 (*
__codecvt_do_out
(
	m_IO_codecvt
 *,

191 
	m__mbe_t
 *,

192 cڡ 
	mwch_t
 *,

193 cڡ 
	mwch_t
 *,

194 cڡ 
	mwch_t
 **, *,

196 
__codecvt_su
 (*
__codecvt_do_unshi
(
	m_IO_codecvt
 *,

197 
	m__mbe_t
 *, *,

199 
__codecvt_su
 (*
__codecvt_do_
(
	m_IO_codecvt
 *,

200 
	m__mbe_t
 *,

202 cڡ **, 
	mwch_t
 *,

203 
	mwch_t
 *, wchar_t **);

204 (*
	m__codecvt_do_codg
(
	m_IO_codecvt
 *);

205 (*
	m__codecvt_do_ways_nocv
(
	m_IO_codecvt
 *);

206 (*
	m__codecvt_do_ngth
(
	m_IO_codecvt
 *, 
	m__mbe_t
 *,

207 cڡ *, cڡ *, 
	m_IO_size_t
);

208 (*
	m__codecvt_do_max_ngth
(
	m_IO_codecvt
 *);

210 
_IO_icv_t
 
	m__cd_
;

211 
_IO_icv_t
 
	m__cd_out
;

215 
	s_IO_wide_da


217 
wch_t
 *
	m_IO_ad_r
;

218 
wch_t
 *
	m_IO_ad_d
;

219 
wch_t
 *
	m_IO_ad_ba
;

220 
wch_t
 *
	m_IO_wre_ba
;

221 
wch_t
 *
	m_IO_wre_r
;

222 
wch_t
 *
	m_IO_wre_d
;

223 
wch_t
 *
	m_IO_buf_ba
;

224 
wch_t
 *
	m_IO_buf_d
;

226 
wch_t
 *
	m_IO_ve_ba
;

227 
wch_t
 *
	m_IO_backup_ba
;

229 
wch_t
 *
	m_IO_ve_d
;

231 
__mbe_t
 
	m_IO_e
;

232 
__mbe_t
 
	m_IO_ϡ_e
;

233 
_IO_codecvt
 
	m_codecvt
;

235 
wch_t
 
	m_shtbuf
[1];

237 cڡ 
_IO_jump_t
 *
	m_wide_vb
;

241 
	s_IO_FILE
 {

242 
	m_ags
;

243 
	#_IO_fe_ags
 
_ags


	)

247 * 
	m_IO_ad_r
;

248 * 
	m_IO_ad_d
;

249 * 
	m_IO_ad_ba
;

250 * 
	m_IO_wre_ba
;

251 * 
	m_IO_wre_r
;

252 * 
	m_IO_wre_d
;

253 * 
	m_IO_buf_ba
;

254 * 
	m_IO_buf_d
;

256 *
	m_IO_ve_ba
;

257 *
	m_IO_backup_ba
;

258 *
	m_IO_ve_d
;

260 
_IO_mk
 *
	m_mks
;

262 
_IO_FILE
 *
	m_cha
;

264 
	m_fo
;

266 
	m_blksize
;

268 
	m_ags2
;

270 
_IO_off_t
 
	m_d_offt
;

272 
	#__HAVE_COLUMN


	)

274 
	m_cur_cumn
;

275 sigd 
	m_vb_offt
;

276 
	m_shtbuf
[1];

280 
_IO_lock_t
 *
	m_lock
;

281 #ifde
_IO_USE_OLD_IO_FILE


284 
	s_IO_FILE_come


286 
_IO_FILE
 
	m_fe
;

288 #i
defed
 
_G_IO_IO_FILE_VERSION
 && _G_IO_IO_FILE_VERSION == 0x20001

289 
_IO_off64_t
 
	m_offt
;

290 #i
defed
 
_LIBC
 || defed 
_GLIBCPP_USE_WCHAR_T


292 
_IO_codecvt
 *
	m_codecvt
;

293 
_IO_wide_da
 *
	m_wide_da
;

294 
_IO_FILE
 *
	m_䓻s_li
;

295 *
	m_䓻s_buf
;

297 *
	m__d1
;

298 *
	m__d2
;

299 *
	m__d3
;

300 *
	m__d4
;

302 
size_t
 
	m__d5
;

303 
	m_mode
;

305 
	m_unud2
[15 *  (- 4 *  (*-  (
size_t
)];

309 #ide
__lulus


310 
_IO_FILE
 
	t_IO_FILE
;

313 
	g_IO_FILE_us
;

315 
_IO_FILE_us
 
_IO_2_1_d_
;

316 
_IO_FILE_us
 
_IO_2_1_dout_
;

317 
_IO_FILE_us
 
_IO_2_1_dr_
;

318 #ide
_LIBC


319 
	#_IO_d
 ((
_IO_FILE
*)(&
_IO_2_1_d_
))

	)

320 
	#_IO_dout
 ((
_IO_FILE
*)(&
_IO_2_1_dout_
))

	)

321 
	#_IO_dr
 ((
_IO_FILE
*)(&
_IO_2_1_dr_
))

	)

323 
_IO_FILE
 *
_IO_d
 
ibu_hidd
;

324 
_IO_FILE
 *
_IO_dout
 
ibu_hidd
;

325 
_IO_FILE
 *
_IO_dr
 
ibu_hidd
;

333 
__ssize_t
 
	t__io_ad_
 (*
	t__cook
, *
	t__buf
, 
	tsize_t
 
	t__nbys
);

341 
__ssize_t
 
	t__io_wre_
 (*
	t__cook
, cڡ *
	t__buf
,

342 
	tsize_t
 
	t__n
);

350 
	t__io_ek_
 (*
	t__cook
, 
	t_IO_off64_t
 *
	t__pos
, 
	t__w
);

353 
	t__io_o_
 (*
	t__cook
);

356 #ifde
_GNU_SOURCE


358 
__io_ad_
 
	tcook_ad_funi_t
;

359 
__io_wre_
 
	tcook_wre_funi_t
;

360 
__io_ek_
 
	tcook_ek_funi_t
;

361 
__io_o_
 
	tcook_o_funi_t
;

366 
__io_ad_
 *
	mad
;

367 
__io_wre_
 *
	mwre
;

368 
__io_ek_
 *
	mek
;

369 
__io_o_
 *
	mo
;

370 } 
	t_IO_cook_io_funis_t
;

371 
_IO_cook_io_funis_t
 
	tcook_io_funis_t
;

373 
	g_IO_cook_fe
;

376 
_IO_cook_
 (
_IO_cook_fe
 *
__cfe
, 
__ad_wre
,

377 *
__cook
, 
_IO_cook_io_funis_t
 
__s
);

381 #ifde
__lulus


385 
__undow
 (
_IO_FILE
 *);

386 
__uow
 (
_IO_FILE
 *);

387 
__ovow
 (
_IO_FILE
 *, );

388 #i
defed
 
_LIBC
 || defed 
_GLIBCPP_USE_WCHAR_T


389 
_IO_wt_t
 
__wundow
 (
_IO_FILE
 *);

390 
_IO_wt_t
 
__wuow
 (
_IO_FILE
 *);

391 
_IO_wt_t
 
__wovow
 (
_IO_FILE
 *, _IO_wint_t);

394 #i 
__GNUC__
 >= 3

395 
	#_IO_BE
(
ex
, 
s

	`__but_ex
 (x),es)

	)

397 
	#_IO_BE
(
ex
, 
s
x)

	)

400 
	#_IO_gc_uocked
(
_
) \

401 (
	`_IO_BE
 ((
_
)->
_IO_ad_r
 >(_)->
_IO_ad_d
, 0) \

402 ? 
	`__uow
 (
_
: *(*(_)->
_IO_ad_r
++)

	)

403 
	#_IO_ekc_uocked
(
_
) \

404 (
	`_IO_BE
 ((
_
)->
_IO_ad_r
 >(_)->
_IO_ad_d
, 0) \

405 && 
	`__undow
 (
_
=
EOF
 ? EOF \

406 : *(*(
_
)->
_IO_ad_r
)

	)

407 
	#_IO_putc_uocked
(
_ch
, 
_
) \

408 (
	`_IO_BE
 ((
_
)->
_IO_wre_r
 >(_)->
_IO_wre_d
, 0) \

409 ? 
	`__ovow
 (
_
, ((
_ch
)) \

410 : ((*(
_
)->
_IO_wre_r
++ = (
_ch
)))

	)

412 #i
defed
 
_LIBC
 || defed 
_GLIBCPP_USE_WCHAR_T


413 
	#_IO_gwc_uocked
(
_
) \

414 (
	`_IO_BE
 ((
_
)->
_wide_da
 =
NULL
 \

415 || ((
_
)->
_wide_da
->
_IO_ad_r
 \

416 >(
_
)->
_wide_da
->
_IO_ad_d
), 0) \

417 ? 
	`__wuow
 (
_
: (
_IO_wt_t
*(_)->
_wide_da
->
_IO_ad_r
++)

	)

418 
	#_IO_putwc_uocked
(
_wch
, 
_
) \

419 (
	`_IO_BE
 ((
_
)->
_wide_da
 =
NULL
 \

420 || ((
_
)->
_wide_da
->
_IO_wre_r
 \

421 >(
_
)->
_wide_da
->
_IO_wre_d
), 0) \

422 ? 
	`__wovow
 (
_
, 
_wch
) \

423 : (
_IO_wt_t
(*(
_
)->
_wide_da
->
_IO_wre_r
++ = (
_wch
)))

	)

426 
	#_IO_of_uocked
(
__
(((__)->
_ags
 & 
_IO_EOF_SEEN
!0)

	)

427 
	#_IO__uocked
(
__
(((__)->
_ags
 & 
_IO_ERR_SEEN
!0)

	)

429 
_IO_gc
 (
_IO_FILE
 *
__
);

430 
_IO_putc
 (
__c
, 
_IO_FILE
 *
__
);

431 
_IO_of
 (
_IO_FILE
 *
__

__THROW
;

432 
_IO_
 (
_IO_FILE
 *
__

__THROW
;

434 
_IO_ekc_locked
 (
_IO_FILE
 *
__
);

437 
	#_IO_PENDING_OUTPUT_COUNT
(
_
) \

438 ((
_
)->
_IO_wre_r
 - (_)->
_IO_wre_ba
)

	)

440 
_IO_ockfe
 (
_IO_FILE
 *
__THROW
;

441 
_IO_fuockfe
 (
_IO_FILE
 *
__THROW
;

442 
_IO_rylockfe
 (
_IO_FILE
 *
__THROW
;

444 #ifde
_IO_MTSAFE_IO


445 
	#_IO_ekc
(
_

	`_IO_ekc_locked
 (_)

	)

446 
	#_IO_ockfe
(
_
) \

447 i(((
_
)->
_ags
 & 
_IO_USER_LOCK
=0
	`_IO_ockfe
 (_)

	)

448 
	#_IO_fuockfe
(
_
) \

449 i(((
_
)->
_ags
 & 
_IO_USER_LOCK
=0
	`_IO_fuockfe
 (_)

	)

451 
	#_IO_ekc
(
_

	`_IO_ekc_uocked
 (_)

	)

452 
	#_IO_ockfe
(
_


	)

453 
	#_IO_fuockfe
(
_


	)

454 
	#_IO_rylockfe
(
_


	)

455 
	#_IO_nup_gi_t
(
_f
, 
_


	)

456 
	#_IO_nup_gi_d
(
_Do


	)

459 
_IO_vfsnf
 (
_IO_FILE
 * 
__ri
, const * __restrict,

460 
_IO_va_li
, *
__ri
);

461 
_IO_vrtf
 (
_IO_FILE
 *
__ri
, const *__restrict,

462 
_IO_va_li
);

463 
_IO_ssize_t
 
_IO_dn
 (
_IO_FILE
 *, , _IO_ssize_t);

464 
_IO_size_t
 
_IO_sgn
 (
_IO_FILE
 *, *, _IO_size_t);

466 
_IO_off64_t
 
_IO_ekoff
 (
_IO_FILE
 *, _IO_off64_t, , );

467 
_IO_off64_t
 
_IO_ekpos
 (
_IO_FILE
 *, _IO_off64_t, );

469 
_IO__backup_
 (
_IO_FILE
 *
__THROW
;

471 #i
defed
 
_LIBC
 || defed 
_GLIBCPP_USE_WCHAR_T


472 
_IO_wt_t
 
_IO_gwc
 (
_IO_FILE
 *
__
);

473 
_IO_wt_t
 
_IO_putwc
 (
wch_t
 
__wc
, 
_IO_FILE
 *
__
);

474 
_IO_fwide
 (
_IO_FILE
 *
__
, 
__mode

__THROW
;

475 #i
__GNUC__
 >= 2

478 #i
defed
 
_LIBC
 && defed 
SHARED


479 
	~<shlib-comt.h
>

480 #i
SHLIB_COMPAT
 (
libc
, 
GLIBC_2_0
, 
GLIBC_2_1
)

481 
	#_IO_fwide_maybe_comtib
 \

482 (
	`__but_ex
 (&
_IO_d_ud
 =
NULL
, 0))

	)

483 cڡ 
_IO_d_ud
;

484 
wk_ex
 (
_IO_d_ud
);

487 #ide
_IO_fwide_maybe_comtib


488 
	#_IO_fwide_maybe_comtib
 (0)

	)

492 
	#_IO_fwide
(
__
, 
__mode
) \

493 ({ 
__su
 = (
__mode
); \

494 i(
__su
 < 0 && ! 
_IO_fwide_maybe_comtib
) \

496 i((
__
)->
_mode
 == 0) \

498 (
__
)->
_mode
 = -1; \

499 
__su
 = (
__
)->
_mode
; \

501 i(
	`__but_cڡt_p
 (
__mode
) && (__mode) == 0) \

502 
__su
 = 
_IO_fwide_maybe_comtib
 ? -1 : (
__
)->
_mode
; \

504 
__su
 = 
	`_IO_fwide
 (
__
, __result); \

505 
__su
; })

	)

508 
_IO_vfwsnf
 (
_IO_FILE
 * 
__ri
, cڡ 
wch_t
 * __restrict,

509 
_IO_va_li
, *
__ri
);

510 
_IO_vfwtf
 (
_IO_FILE
 *
__ri
, cڡ 
wch_t
 *__restrict,

511 
_IO_va_li
);

512 
_IO_ssize_t
 
_IO_wdn
 (
_IO_FILE
 *, 
wt_t
, _IO_ssize_t);

513 
_IO__wbackup_
 (
_IO_FILE
 *
__THROW
;

516 #ifde
__LDBL_COMPAT


517 
	~<bs/libio-ldbl.h
>

520 #ifde
__lulus


	@/usr/include/linux/tty_flags.h

1 #ide
_LINUX_TTY_FLAGS_H


2 
	#_LINUX_TTY_FLAGS_H


	)

13 
	#ASYNCB_HUP_NOTIFY
 0

	)

15 
	#ASYNCB_FOURPORT
 1

	)

16 
	#ASYNCB_SAK
 2

	)

17 
	#ASYNCB_SPLIT_TERMIOS
 3

	)

18 
	#ASYNCB_SPD_HI
 4

	)

19 
	#ASYNCB_SPD_VHI
 5

	)

20 
	#ASYNCB_SKIP_TEST
 6

	)

21 
	#ASYNCB_AUTO_IRQ
 7

	)

23 
	#ASYNCB_SESSION_LOCKOUT
 8

	)

24 
	#ASYNCB_PGRP_LOCKOUT
 9

	)

25 
	#ASYNCB_CALLOUT_NOHUP
 10

	)

26 
	#ASYNCB_HARDPPS_CD
 11

	)

27 
	#ASYNCB_SPD_SHI
 12

	)

28 
	#ASYNCB_LOW_LATENCY
 13

	)

29 
	#ASYNCB_BUGGY_UART
 14

	)

31 
	#ASYNCB_AUTOPROBE
 15

	)

32 
	#ASYNCB_MAGIC_MULTIPLIER
 16

	)

33 
	#ASYNCB_LAST_USER
 16

	)

36 
	#ASYNCB_INITIALIZED
 31

	)

37 
	#ASYNCB_SUSPENDED
 30

	)

38 
	#ASYNCB_NORMAL_ACTIVE
 29

	)

39 
	#ASYNCB_BOOT_AUTOCONF
 28

	)

40 
	#ASYNCB_CLOSING
 27

	)

41 
	#ASYNCB_CTS_FLOW
 26

	)

42 
	#ASYNCB_CHECK_CD
 25

	)

43 
	#ASYNCB_SHARE_IRQ
 24

	)

44 
	#ASYNCB_CONS_FLOW
 23

	)

45 
	#ASYNCB_FIRST_KERNEL
 22

	)

47 
	#ASYNC_HUP_NOTIFY
 (1U << 
ASYNCB_HUP_NOTIFY
)

	)

48 
	#ASYNC_SUSPENDED
 (1U << 
ASYNCB_SUSPENDED
)

	)

49 
	#ASYNC_FOURPORT
 (1U << 
ASYNCB_FOURPORT
)

	)

50 
	#ASYNC_SAK
 (1U << 
ASYNCB_SAK
)

	)

51 
	#ASYNC_SPLIT_TERMIOS
 (1U << 
ASYNCB_SPLIT_TERMIOS
)

	)

52 
	#ASYNC_SPD_HI
 (1U << 
ASYNCB_SPD_HI
)

	)

53 
	#ASYNC_SPD_VHI
 (1U << 
ASYNCB_SPD_VHI
)

	)

54 
	#ASYNC_SKIP_TEST
 (1U << 
ASYNCB_SKIP_TEST
)

	)

55 
	#ASYNC_AUTO_IRQ
 (1U << 
ASYNCB_AUTO_IRQ
)

	)

56 
	#ASYNC_SESSION_LOCKOUT
 (1U << 
ASYNCB_SESSION_LOCKOUT
)

	)

57 
	#ASYNC_PGRP_LOCKOUT
 (1U << 
ASYNCB_PGRP_LOCKOUT
)

	)

58 
	#ASYNC_CALLOUT_NOHUP
 (1U << 
ASYNCB_CALLOUT_NOHUP
)

	)

59 
	#ASYNC_HARDPPS_CD
 (1U << 
ASYNCB_HARDPPS_CD
)

	)

60 
	#ASYNC_SPD_SHI
 (1U << 
ASYNCB_SPD_SHI
)

	)

61 
	#ASYNC_LOW_LATENCY
 (1U << 
ASYNCB_LOW_LATENCY
)

	)

62 
	#ASYNC_BUGGY_UART
 (1U << 
ASYNCB_BUGGY_UART
)

	)

63 
	#ASYNC_AUTOPROBE
 (1U << 
ASYNCB_AUTOPROBE
)

	)

64 
	#ASYNC_MAGIC_MULTIPLIER
 (1U << 
ASYNCB_MAGIC_MULTIPLIER
)

	)

66 
	#ASYNC_FLAGS
 ((1U << (
ASYNCB_LAST_USER
 + 1)- 1)

	)

67 
	#ASYNC_DEPRECATED
 (
ASYNC_SESSION_LOCKOUT
 | 
ASYNC_PGRP_LOCKOUT
 | \

68 
ASYNC_CALLOUT_NOHUP
 | 
ASYNC_AUTOPROBE
)

	)

69 
	#ASYNC_USR_MASK
 (
ASYNC_SPD_MASK
|
ASYNC_CALLOUT_NOHUP
| \

70 
ASYNC_LOW_LATENCY
)

	)

71 
	#ASYNC_SPD_CUST
 (
ASYNC_SPD_HI
|
ASYNC_SPD_VHI
)

	)

72 
	#ASYNC_SPD_WARP
 (
ASYNC_SPD_HI
|
ASYNC_SPD_SHI
)

	)

73 
	#ASYNC_SPD_MASK
 (
ASYNC_SPD_HI
|
ASYNC_SPD_VHI
|
ASYNC_SPD_SHI
)

	)

75 
	#ASYNC_INITIALIZED
 (1U << 
ASYNCB_INITIALIZED
)

	)

76 
	#ASYNC_NORMAL_ACTIVE
 (1U << 
ASYNCB_NORMAL_ACTIVE
)

	)

77 
	#ASYNC_BOOT_AUTOCONF
 (1U << 
ASYNCB_BOOT_AUTOCONF
)

	)

78 
	#ASYNC_CLOSING
 (1U << 
ASYNCB_CLOSING
)

	)

79 
	#ASYNC_CTS_FLOW
 (1U << 
ASYNCB_CTS_FLOW
)

	)

80 
	#ASYNC_CHECK_CD
 (1U << 
ASYNCB_CHECK_CD
)

	)

81 
	#ASYNC_SHARE_IRQ
 (1U << 
ASYNCB_SHARE_IRQ
)

	)

82 
	#ASYNC_CONS_FLOW
 (1U << 
ASYNCB_CONS_FLOW
)

	)

83 
	#ASYNC_INTERNAL_FLAGS
 (~((1U << 
ASYNCB_FIRST_KERNEL
- 1))

	)

	@/usr/include/linux/types.h

1 #ide
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/tys.h
>

6 #ide
__ASSEMBLY__


8 
	~<lux/posix_tys.h
>

16 #ifde
__CHECKER__


17 
	#__bwi__
 
	`__ibu__
((
bwi
))

	)

19 
	#__bwi__


	)

21 #ifde
__CHECK_ENDIAN__


22 
	#__bwi
 
__bwi__


	)

24 
	#__bwi


	)

27 
__u16
 
	t__bwi
 
	t__16
;

28 
__u16
 
	t__bwi
 
	t__be16
;

29 
__u32
 
	t__bwi
 
	t__32
;

30 
__u32
 
	t__bwi
 
	t__be32
;

31 
__u64
 
	t__bwi
 
	t__64
;

32 
__u64
 
	t__bwi
 
	t__be64
;

34 
__u16
 
	t__bwi
 
	t__sum16
;

35 
__u32
 
	t__bwi
 
	t__wsum
;

46 
	#__igd_u64
 
__u64
 
	`__ibu__
((
	`igd
(8)))

	)

47 
	#__igd_be64
 
__be64
 
	`__ibu__
((
	`igd
(8)))

	)

48 
	#__igd_64
 
__64
 
	`__ibu__
((
	`igd
(8)))

	)

	@/usr/include/rpc/netdb.h

36 #ide
_RPC_NETDB_H


37 
	#_RPC_NETDB_H
 1

	)

39 
	~<us.h
>

41 
	#__ed_size_t


	)

42 
	~<ddef.h
>

44 
__BEGIN_DECLS


46 
	s


48 *
	mr_me
;

49 **
	mr_s
;

50 
	mr_numb
;

53 
	$p
 (
__ayݒ

__THROW
;

54 
	$d
 (
__THROW
;

55 

 *
	$gcbyme
 (cڡ *
__me

__THROW
;

56 

 *
	$gcbynumb
 (
__numb

__THROW
;

57 

 *
	$g
 (
__THROW
;

59 #ifde
__USE_MISC


60 
	$gcbyme_r
 (cڡ *
__me
, 

 *
__su_buf
,

61 *
__bufr
, 
size_t
 
__bu
,

62 

 **
__su

__THROW
;

64 
	$gcbynumb_r
 (
__numb
, 

 *
__su_buf
,

65 *
__bufr
, 
size_t
 
__bu
,

66 

 **
__su

__THROW
;

68 
	$g_r
 (

 *
__su_buf
, *
__bufr
,

69 
size_t
 
__bu
, 

 **
__su

__THROW
;

72 
__END_DECLS


	@/usr/include/stdc-predef.h

18 #idef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifde
__GCC_IEC_559


37 #i
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifde
__GCC_IEC_559_COMPLEX


45 #i
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

55 
	#__STDC_ISO_10646__
 201505L

	)

58 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/xlocale.h

20 #ide
_XLOCALE_H


21 
	#_XLOCALE_H
 1

	)

27 
	s__lo_ru


30 
__lo_da
 *
	m__los
[13];

33 cڡ *
	m__y_b
;

34 cڡ *
	m__y_tow
;

35 cڡ *
	m__y_tou
;

38 cڡ *
	m__mes
[13];

39 } *
	t__lo_t
;

42 
__lo_t
 
	tlo_t
;

	@/usr/include/_G_config.h

4 #ide
_G_cfig_h


5 
	#_G_cfig_h
 1

	)

9 
	~<bs/tys.h
>

10 
	#__ed_size_t


	)

11 #i
defed
 
_LIBC
 || defed 
_GLIBCPP_USE_WCHAR_T


12 
	#__ed_wch_t


	)

14 
	#__ed_NULL


	)

15 
	~<ddef.h
>

16 
	#__ed_mbe_t


	)

17 #i
defed
 
_LIBC
 || defed 
_GLIBCPP_USE_WCHAR_T


18 
	#__ed_wt_t


	)

20 
	~<wch.h
>

23 
__off_t
 
	m__pos
;

24 
__mbe_t
 
	m__e
;

25 } 
	t_G_os_t
;

28 
__off64_t
 
	m__pos
;

29 
__mbe_t
 
	m__e
;

30 } 
	t_G_os64_t
;

31 #i
defed
 
_LIBC
 || defed 
_GLIBCPP_USE_WCHAR_T


32 
	~<gcv.h
>

35 
__gcv_fo
 
	m__cd
;

38 
__gcv_fo
 
	m__cd
;

39 
__gcv__da
 
	m__da
;

40 } 
	m__combed
;

41 } 
	t_G_icv_t
;

46 
	#_G_va_li
 
__gnuc_va_li


	)

48 
	#_G_HAVE_MMAP
 1

	)

49 
	#_G_HAVE_MREMAP
 1

	)

51 
	#_G_IO_IO_FILE_VERSION
 0x20001

	)

54 
	#_G_HAVE_ST_BLKSIZE
 
	`defed
 (
_STATBUF_ST_BLKSIZE
)

	)

56 
	#_G_BUFSIZ
 8192

	)

	@/usr/include/linux/posix_types.h

1 #ide
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lux/ddef.h
>

21 #unde
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_bs
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__kl_fd_t
;

29 (*
	t__kl_sighdr_t
)();

32 
	t__kl_key_t
;

33 
	t__kl_mqd_t
;

35 
	~<asm/posix_tys.h
>

	@/usr/include/gconv.h

22 #ide
_GCONV_H


23 
	#_GCONV_H
 1

	)

25 
	~<us.h
>

26 
	#__ed_mbe_t


	)

27 
	#__ed_wt_t


	)

28 
	~<wch.h
>

29 
	#__ed_size_t


	)

30 
	#__ed_wch_t


	)

31 
	~<ddef.h
>

34 
	#__UNKNOWN_10646_CHAR
 ((
wch_t
0xfffd)

	)

39 
	m__GCONV_OK
 = 0,

40 
	m__GCONV_NOCONV
,

41 
	m__GCONV_NODB
,

42 
	m__GCONV_NOMEM
,

44 
	m__GCONV_EMPTY_INPUT
,

45 
	m__GCONV_FULL_OUTPUT
,

46 
	m__GCONV_ILLEGAL_INPUT
,

47 
	m__GCONV_INCOMPLETE_INPUT
,

49 
	m__GCONV_ILLEGAL_DESCRIPTOR
,

50 
	m__GCONV_INTERNAL_ERROR


57 
	m__GCONV_IS_LAST
 = 0x0001,

58 
	m__GCONV_IGNORE_ERRORS
 = 0x0002,

59 
	m__GCONV_SWAP
 = 0x0004,

60 
	m__GCONV_TRANSLIT
 = 0x0008

65 
	g__gcv_
;

66 
	g__gcv__da
;

67 
	g__gcv_lded_obje
;

71 (*
	t__gcv_f
(
	t__gcv_
 *, 
	t__gcv__da
 *,

73 **, 
	tsize_t
 *, , );

76 
	$wt_t
 (*
	t__gcv_btowc_f
(
	t__gcv_
 *, );

79 (*
	t__gcv__f
(
	t__gcv_
 *);

80 (*
	t__gcv_d_f
(
	t__gcv_
 *);

84 
	s__gcv_


86 
__gcv_lded_obje
 *
__shlib_hd
;

87 cڡ *
__modme
;

89 
__cou
;

91 *
__om_me
;

92 *
__to_me
;

94 
__gcv_f
 
__f
;

95 
__gcv_btowc_f
 
__btowc_f
;

96 
__gcv__f
 
___f
;

97 
__gcv_d_f
 
__d_f
;

101 
__m_eded_om
;

102 
__max_eded_om
;

103 
__m_eded_to
;

104 
__max_eded_to
;

107 
__eful
;

109 *
__da
;

114 
	s__gcv__da


116 *
__outbuf
;

117 *
__outbund
;

121 
__ags
;

125 
__voti_cou
;

129 
___u
;

131 
__mbe_t
 *
__
;

132 
__mbe_t
 
__e
;

138 
	s__gcv_fo


140 
size_t
 
__ns
;

141 
__gcv_
 *
__s
;

142 
__exnsi__
 
__gcv__da
 
__da
 
__exr
;

143 } *
	t__gcv_t
;

146 
	`__gcv_e
 (
__gcv_
 *

,

147 
__gcv__da
 *
_da
,

148 cڡ *
buft
,

149 cڡ **
bu
,

150 cڡ *
bund
,

151 **
outbuft
,

152 
size_t
 *
vsib
);

	@/usr/include/linux/stddef.h

	@/usr/include/wchar.h

23 #ide
_WCHAR_H


25 #i!
defed
 
__ed_mbe_t
 && !defed 
__ed_wt_t


26 
	#_WCHAR_H
 1

	)

27 
	~<us.h
>

30 #ifde
_WCHAR_H


32 
	#__ed___FILE


	)

33 #i
defed
 
__USE_UNIX98
 || defed 
__USE_XOPEN2K


34 
	#__ed_FILE


	)

36 
	~<dio.h
>

38 
	#__ed___va_li


	)

39 
	~<dg.h
>

41 
	~<bs/wch.h
>

44 
	#__ed_size_t


	)

45 
	#__ed_wch_t


	)

46 
	#__ed_NULL


	)

48 #i
defed
 
_WCHAR_H
 || defed 
__ed_wt_t
 || !defed 
__WINT_TYPE__


49 #unde
__ed_wt_t


50 
	#__ed_wt_t


	)

51 
	~<ddef.h
>

55 #ide
_WINT_T


60 
	#_WINT_T


	)

61 
	twt_t
;

65 #i
defed
 
__lulus
 && defed 
_GLIBCPP_USE_NAMESPACES
 \

66 && 
defed
 
__WINT_TYPE__


67 
__BEGIN_NAMESPACE_STD


68 
__WINT_TYPE__
 
	twt_t
;

69 
	g__END_NAMESPACE_STD


74 #i
defed
 
__lulus
 && 
__GNUC_PREREQ
 (4, 4)

75 
	#__CORRECT_ISO_CPP_WCHAR_H_PROTO


	)

79 #i(
defed
 
_WCHAR_H
 || defed 
__ed_mbe_t
&& !defed 
____mbe_t_defed


80 
	#____mbe_t_defed
 1

	)

84 
	m__cou
;

87 #ifde
__WINT_TYPE__


88 
__WINT_TYPE__
 
	m__wch
;

90 
wt_t
 
	m__wch
;

92 
	m__wchb
[4];

93 } 
	m__vue
;

94 } 
	t__mbe_t
;

96 #unde
__ed_mbe_t


101 #ifde
_WCHAR_H


103 #ide
__mbe_t_defed


104 
__BEGIN_NAMESPACE_C99


106 
__mbe_t
 
	tmbe_t
;

107 
	g__END_NAMESPACE_C99


108 
	#__mbe_t_defed
 1

	)

111 #ifde
__USE_GNU


112 
	$__USING_NAMESPACE_C99
(
mbe_t
)

115 #ide
WCHAR_MIN


117 
	#WCHAR_MIN
 
__WCHAR_MIN


	)

118 
	#WCHAR_MAX
 
__WCHAR_MAX


	)

121 #ide
WEOF


122 
	#WEOF
 (0xffffffffu)

	)

127 #i
defed
 
__USE_XOPEN
 && !defed 
__USE_UNIX98


128 
	~<wy.h
>

132 
__BEGIN_DECLS


134 
__BEGIN_NAMESPACE_STD


137 
tm
;

138 
__END_NAMESPACE_STD


142 
	$__USING_NAMESPACE_STD
(
tm
)

145 
__BEGIN_NAMESPACE_STD


147 
wch_t
 *
	$wcsy
 (
wch_t
 *
__ri
 
__de
,

148 cڡ 
wch_t
 *
__ri
 
__c
)

149 
__THROW
 
	`__nnu
 ((1, 2));

152 
wch_t
 *
	$wcy
 (
wch_t
 *
__ri
 
__de
,

153 cڡ 
wch_t
 *
__ri
 
__c
, 
size_t
 
__n
)

154 
__THROW
 
	`__nnu
 ((1, 2));

157 
wch_t
 *
	$wcst
 (
wch_t
 *
__ri
 
__de
,

158 cڡ 
wch_t
 *
__ri
 
__c
)

159 
__THROW
 
	`__nnu
 ((1, 2));

161 
wch_t
 *
	$wct
 (
wch_t
 *
__ri
 
__de
,

162 cڡ 
wch_t
 *
__ri
 
__c
, 
size_t
 
__n
)

163 
__THROW
 
	`__nnu
 ((1, 2));

166 
	$wcscmp
 (cڡ 
wch_t
 *
__s1
, cڡ wch_*
__s2
)

167 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

169 
	$wccmp
 (cڡ 
wch_t
 *
__s1
, cڡ wch_*
__s2
, 
size_t
 
__n
)

170 
__THROW
 
__ibu_pu__
 
	`__nnu
 ((1, 2));

171 
__END_NAMESPACE_STD


173 #ifde
__USE_XOPEN2K8


175 
	$wcscmp
 (cڡ 
wch_t
 *
__s1
, cڡ wch_*
__s2

__THROW
;

178 
	$wccmp
 (cڡ 
wch_t
 *
__s1
, cڡ wch_*
__s2
,

179 
size_t
 
__n

__THROW
;

183 
	~<xlo.h
>

185 
	$wcscmp_l
 (cڡ 
wch_t
 *
__s1
, cڡ wch_*
__s2
,

186 
__lo_t
 
__loc

__THROW
;

188 
	$wccmp_l
 (cڡ 
wch_t
 *
__s1
, cڡ wch_*
__s2
,

189 
size_t
 
__n
, 
__lo_t
 
__loc

__THROW
;

192 
__BEGIN_NAMESPACE_STD


195 
	$wcscl
 (cڡ 
wch_t
 *
__s1
, cڡ wch_*
__s2

__THROW
;

199 
size_t
 
	$wcsxm
 (
wch_t
 *
__ri
 
__s1
,

200 cڡ 
wch_t
 *
__ri
 
__s2
, 
size_t
 
__n

__THROW
;

201 
__END_NAMESPACE_STD


203 #ifde
__USE_XOPEN2K8


209 
	$wcscl_l
 (cڡ 
wch_t
 *
__s1
, cڡ wch_*
__s2
,

210 
__lo_t
 
__loc

__THROW
;

215 
size_t
 
	$wcsxm_l
 (
wch_t
 *
__s1
, cڡ wch_*
__s2
,

216 
size_t
 
__n
, 
__lo_t
 
__loc

__THROW
;

219 
wch_t
 *
	$wcsdup
 (cڡ 
wch_t
 *
__s

__THROW
 
__ibu_mloc__
;

222 
__BEGIN_NAMESPACE_STD


224 #ifde
__CORRECT_ISO_CPP_WCHAR_H_PROTO


225 "C++" 
wch_t
 *
	$wcschr
 (
wch_t
 *
__wcs
, wch_
__wc
)

226 
__THROW
 
	`__asm
 ("wcschr"
__ibu_pu__
;

227 "C++" cڡ 
wch_t
 *
	$wcschr
 (cڡ 
wch_t
 *
__wcs
, wch_
__wc
)

228 
__THROW
 
	`__asm
 ("wcschr"
__ibu_pu__
;

230 
wch_t
 *
	$wcschr
 (cڡ 
wch_t
 *
__wcs
, wch_
__wc
)

231 
__THROW
 
__ibu_pu__
;

234 #ifde
__CORRECT_ISO_CPP_WCHAR_H_PROTO


235 "C++" 
wch_t
 *
	$wcchr
 (
wch_t
 *
__wcs
, wch_
__wc
)

236 
__THROW
 
	`__asm
 ("wcchr"
__ibu_pu__
;

237 "C++" cڡ 
wch_t
 *
	$wcchr
 (cڡ 
wch_t
 *
__wcs
, wch_
__wc
)

238 
__THROW
 
	`__asm
 ("wcchr"
__ibu_pu__
;

240 
wch_t
 *
	$wcchr
 (cڡ 
wch_t
 *
__wcs
, wch_
__wc
)

241 
__THROW
 
__ibu_pu__
;

243 
__END_NAMESPACE_STD


245 #ifde
__USE_GNU


248 
wch_t
 *
	$wcschul
 (cڡ 
wch_t
 *
__s
, wch_
__wc
)

249 
__THROW
 
__ibu_pu__
;

252 
__BEGIN_NAMESPACE_STD


255 
size_t
 
	$wcscn
 (cڡ 
wch_t
 *
__wcs
, cڡ wch_*
__je
)

256 
__THROW
 
__ibu_pu__
;

259 
size_t
 
	$wcsn
 (cڡ 
wch_t
 *
__wcs
, cڡ wch_*
__ac
)

260 
__THROW
 
__ibu_pu__
;

262 #ifde
__CORRECT_ISO_CPP_WCHAR_H_PROTO


263 "C++" 
wch_t
 *
	$wcbrk
 (
wch_t
 *
__wcs
, cڡ wch_*
__ac
)

264 
__THROW
 
	`__asm
 ("wcbrk"
__ibu_pu__
;

265 "C++" cڡ 
wch_t
 *
	$wcbrk
 (cڡ 
wch_t
 *
__wcs
,

266 cڡ 
wch_t
 *
__ac
)

267 
__THROW
 
	`__asm
 ("wcbrk"
__ibu_pu__
;

269 
wch_t
 *
	$wcbrk
 (cڡ 
wch_t
 *
__wcs
, cڡ wch_*
__ac
)

270 
__THROW
 
__ibu_pu__
;

273 #ifde
__CORRECT_ISO_CPP_WCHAR_H_PROTO


274 "C++" 
wch_t
 *
	$wcsr
 (
wch_t
 *
__hayack
, cڡ wch_*
__ed
)

275 
__THROW
 
	`__asm
 ("wcsr"
__ibu_pu__
;

276 "C++" cڡ 
wch_t
 *
	$wcsr
 (cڡ 
wch_t
 *
__hayack
,

277 cڡ 
wch_t
 *
__ed
)

278 
__THROW
 
	`__asm
 ("wcsr"
__ibu_pu__
;

280 
wch_t
 *
	$wcsr
 (cڡ 
wch_t
 *
__hayack
, cڡ wch_*
__ed
)

281 
__THROW
 
__ibu_pu__
;

285 
wch_t
 *
	$wcok
 (
wch_t
 *
__ri
 
__s
,

286 cڡ 
wch_t
 *
__ri
 
__dim
,

287 
wch_t
 **
__ri
 
__r

__THROW
;

290 
size_t
 
	$wc
 (cڡ 
wch_t
 *
__s

__THROW
 
__ibu_pu__
;

291 
__END_NAMESPACE_STD


293 #ifde
__USE_XOPEN


295 #ifde
__CORRECT_ISO_CPP_WCHAR_H_PROTO


296 "C++" 
wch_t
 *
	$wcswcs
 (
wch_t
 *
__hayack
, cڡ wch_*
__ed
)

297 
__THROW
 
	`__asm
 ("wcswcs"
__ibu_pu__
;

298 "C++" cڡ 
wch_t
 *
	$wcswcs
 (cڡ 
wch_t
 *
__hayack
,

299 cڡ 
wch_t
 *
__ed
)

300 
__THROW
 
	`__asm
 ("wcswcs"
__ibu_pu__
;

302 
wch_t
 *
	$wcswcs
 (cڡ 
wch_t
 *
__hayack
, cڡ wch_*
__ed
)

303 
__THROW
 
__ibu_pu__
;

307 #ifde
__USE_XOPEN2K8


309 
size_t
 
	$wcn
 (cڡ 
wch_t
 *
__s
, 
size_t
 
__maxn
)

310 
__THROW
 
__ibu_pu__
;

314 
__BEGIN_NAMESPACE_STD


316 #ifde
__CORRECT_ISO_CPP_WCHAR_H_PROTO


317 "C++" 
wch_t
 *
	$wmemchr
 (
wch_t
 *
__s
, wch_
__c
, 
size_t
 
__n
)

318 
__THROW
 
	`__asm
 ("wmemchr"
__ibu_pu__
;

319 "C++" cڡ 
wch_t
 *
	$wmemchr
 (cڡ 
wch_t
 *
__s
, wch_
__c
,

320 
size_t
 
__n
)

321 
__THROW
 
	`__asm
 ("wmemchr"
__ibu_pu__
;

323 
wch_t
 *
	$wmemchr
 (cڡ 
wch_t
 *
__s
, wch_
__c
, 
size_t
 
__n
)

324 
__THROW
 
__ibu_pu__
;

328 
	$wmemcmp
 (cڡ 
wch_t
 *
__s1
, cڡ wch_*
__s2
, 
size_t
 
__n
)

329 
__THROW
 
__ibu_pu__
;

332 
wch_t
 *
	$wmemy
 (
wch_t
 *
__ri
 
__s1
,

333 cڡ 
wch_t
 *
__ri
 
__s2
, 
size_t
 
__n

__THROW
;

337 
wch_t
 *
	$wmemmove
 (
wch_t
 *
__s1
, cڡ wch_*
__s2
, 
size_t
 
__n
)

338 
__THROW
;

341 
wch_t
 *
	$wmemt
 (
wch_t
 *
__s
, wch_
__c
, 
size_t
 
__n

__THROW
;

342 
__END_NAMESPACE_STD


344 #ifde
__USE_GNU


347 
wch_t
 *
	$wmempy
 (
wch_t
 *
__ri
 
__s1
,

348 cڡ 
wch_t
 *
__ri
 
__s2
, 
size_t
 
__n
)

349 
__THROW
;

353 
__BEGIN_NAMESPACE_STD


356 
wt_t
 
	$btowc
 (
__c

__THROW
;

360 
	$wob
 (
wt_t
 
__c

__THROW
;

364 
	$mbs
 (cڡ 
mbe_t
 *
__ps

__THROW
 
__ibu_pu__
;

368 
size_t
 
	$mbowc
 (
wch_t
 *
__ri
 
__pwc
,

369 cڡ *
__ri
 
__s
, 
size_t
 
__n
,

370 
mbe_t
 *
__ri
 
__p

__THROW
;

373 
size_t
 
	$wtomb
 (*
__ri
 
__s
, 
wch_t
 
__wc
,

374 
mbe_t
 *
__ri
 
__ps

__THROW
;

377 
size_t
 
	$__mb
 (cڡ *
__ri
 
__s
, 
size_t
 
__n
,

378 
mbe_t
 *
__ri
 
__ps

__THROW
;

379 
size_t
 
	$mb
 (cڡ *
__ri
 
__s
, 
size_t
 
__n
,

380 
mbe_t
 *
__ri
 
__ps

__THROW
;

381 
__END_NAMESPACE_STD


383 #ifde
__USE_EXTERN_INLINES


389 
wt_t
 
	$__btowc_s
 (
__c

	`__asm
 ("btowc");

390 
__ex_le
 
wt_t


391 
	`__NTH
 (
	$btowc
 (
__c
))

392 {  (
	`__but_cڡt_p
 (
__c
) && __c >= '\0' && __c <= '\x7f'

393 ? (
wt_t

__c
 : 
	`__btowc_s
 (__c)); 
	}
}

395 
	$__wob_s
 (
wt_t
 
__c

	`__asm
 ("wctob");

396 
__ex_le
 

397 
	`__NTH
 (
	$wob
 (
wt_t
 
__wc
))

398 {  (
	`__but_cڡt_p
 (
__wc
&& __w>
L
'\0' && __wc <= L'\x7f'

399 ? (
__wc
 : 
	`__wob_s
 (__wc)); 
	}
}

401 
__ex_le
 
size_t


402 
__NTH
 (
	$mb
 (cڡ *
__ri
 
__s
, 
size_t
 
__n
,

403 
mbe_t
 *
__ri
 
__ps
))

404 {  (
__ps
 !
NULL


405 ? 
	`mbowc
 (
NULL
, 
__s
, 
__n
, 
__ps
: 
	`__mb
 (__s, __n, NULL)); 
	}
}

408 
__BEGIN_NAMESPACE_STD


411 
size_t
 
	$mbtowcs
 (
wch_t
 *
__ri
 
__d
,

412 cڡ **
__ri
 
__c
, 
size_t
 
__n
,

413 
mbe_t
 *
__ri
 
__ps

__THROW
;

417 
size_t
 
	$wctombs
 (*
__ri
 
__d
,

418 cڡ 
wch_t
 **
__ri
 
__c
, 
size_t
 
__n
,

419 
mbe_t
 *
__ri
 
__ps

__THROW
;

420 
__END_NAMESPACE_STD


423 #ifdef 
__USE_XOPEN2K8


426 
size_t
 
	$mbowcs
 (
wch_t
 *
__ri
 
__d
,

427 cڡ **
__ri
 
__c
, 
size_t
 
__nmc
,

428 
size_t
 
__n
, 
mbe_t
 *
__ri
 
__ps

__THROW
;

432 
size_t
 
	$wcombs
 (*
__ri
 
__d
,

433 cڡ 
wch_t
 **
__ri
 
__c
,

434 
size_t
 
__nwc
, size_
__n
,

435 
mbe_t
 *
__ri
 
__ps

__THROW
;

440 #ifde
__USE_XOPEN


442 
	$wcwidth
 (
wch_t
 
__c

__THROW
;

446 
	$wcswidth
 (cڡ 
wch_t
 *
__s
, 
size_t
 
__n

__THROW
;

450 
__BEGIN_NAMESPACE_STD


453 
	$wcod
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

454 
wch_t
 **
__ri
 
__dr

__THROW
;

455 
__END_NAMESPACE_STD


457 #ifde
__USE_ISOC99


458 
__BEGIN_NAMESPACE_C99


460 
	$wcof
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

461 
wch_t
 **
__ri
 
__dr

__THROW
;

462 
	$wcd
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

463 
wch_t
 **
__ri
 
__dr

__THROW
;

464 
__END_NAMESPACE_C99


468 
__BEGIN_NAMESPACE_STD


471 
	$wc
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

472 
wch_t
 **
__ri
 
__dr
, 
__ba

__THROW
;

476 
	$wcoul
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

477 
wch_t
 **
__ri
 
__dr
, 
__ba
)

478 
__THROW
;

479 
__END_NAMESPACE_STD


481 #ifde
__USE_ISOC99


482 
__BEGIN_NAMESPACE_C99


485 
__exnsi__


486 
	$wcl
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

487 
wch_t
 **
__ri
 
__dr
, 
__ba
)

488 
__THROW
;

492 
__exnsi__


493 
	$wcou
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

494 
wch_t
 **
__ri
 
__dr
,

495 
__ba

__THROW
;

496 
__END_NAMESPACE_C99


499 #ifde
__USE_GNU


502 
__exnsi__


503 
	$wcoq
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

504 
wch_t
 **
__ri
 
__dr
, 
__ba
)

505 
__THROW
;

509 
__exnsi__


510 
	$wcouq
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

511 
wch_t
 **
__ri
 
__dr
,

512 
__ba

__THROW
;

515 #ifde
__USE_GNU


529 
	~<xlo.h
>

533 
	$wc_l
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

534 
wch_t
 **
__ri
 
__dr
, 
__ba
,

535 
__lo_t
 
__loc

__THROW
;

537 
	$wcoul_l
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

538 
wch_t
 **
__ri
 
__dr
,

539 
__ba
, 
__lo_t
 
__loc

__THROW
;

541 
__exnsi__


542 
	$wcl_l
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

543 
wch_t
 **
__ri
 
__dr
,

544 
__ba
, 
__lo_t
 
__loc

__THROW
;

546 
__exnsi__


547 
	$wcou_l
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

548 
wch_t
 **
__ri
 
__dr
,

549 
__ba
, 
__lo_t
 
__loc
)

550 
__THROW
;

552 
	$wcod_l
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

553 
wch_t
 **
__ri
 
__dr
, 
__lo_t
 
__loc
)

554 
__THROW
;

556 
	$wcof_l
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

557 
wch_t
 **
__ri
 
__dr
, 
__lo_t
 
__loc
)

558 
__THROW
;

560 
	$wcd_l
 (cڡ 
wch_t
 *
__ri
 
__Ō
,

561 
wch_t
 **
__ri
 
__dr
,

562 
__lo_t
 
__loc

__THROW
;

566 #ifde
__USE_XOPEN2K8


569 
wch_t
 *
	$wy
 (
wch_t
 *
__ri
 
__de
,

570 cڡ 
wch_t
 *
__ri
 
__c

__THROW
;

574 
wch_t
 *
	$wny
 (
wch_t
 *
__ri
 
__de
,

575 cڡ 
wch_t
 *
__ri
 
__c
, 
size_t
 
__n
)

576 
__THROW
;

583 
__FILE
 *
	$ݒ_wmemam
 (
wch_t
 **
__buoc
, 
size_t
 *
__sizoc

__THROW
;

586 #i
defed
 
__USE_ISOC95
 || defed 
__USE_UNIX98


587 
__BEGIN_NAMESPACE_STD


590 
	$fwide
 (
__FILE
 *
__
, 
__mode

__THROW
;

597 
	`fwtf
 (
__FILE
 *
__ri
 
__am
,

598 cڡ 
wch_t
 *
__ri
 
__fm
, ...)

604 
	`wtf
 (cڡ 
wch_t
 *
__ri
 
__fm
, ...)

607 
	$swtf
 (
wch_t
 *
__ri
 
__s
, 
size_t
 
__n
,

608 cڡ 
wch_t
 *
__ri
 
__fm
, ...)

609 
__THROW
 ;

615 
	`vfwtf
 (
__FILE
 *
__ri
 
__s
,

616 cڡ 
wch_t
 *
__ri
 
__fm
,

617 
__gnuc_va_li
 
__g
)

623 
	`vwtf
 (cڡ 
wch_t
 *
__ri
 
__fm
,

624 
__gnuc_va_li
 
__g
)

628 
	$vswtf
 (
wch_t
 *
__ri
 
__s
, 
size_t
 
__n
,

629 cڡ 
wch_t
 *
__ri
 
__fm
,

630 
__gnuc_va_li
 
__g
)

631 
__THROW
 ;

638 
	`fwsnf
 (
__FILE
 *
__ri
 
__am
,

639 cڡ 
wch_t
 *
__ri
 
__fm
, ...)

645 
	`wsnf
 (cڡ 
wch_t
 *
__ri
 
__fm
, ...)

648 
	$swsnf
 (cڡ 
wch_t
 *
__ri
 
__s
,

649 cڡ 
wch_t
 *
__ri
 
__fm
, ...)

650 
__THROW
 ;

652 #i
defed
 
__USE_ISOC99
 && !defed 
__USE_GNU
 \

653 && (!
defed
 
__LDBL_COMPAT
 || !defed 
__REDIRECT
) \

654 && (
defed
 
__STRICT_ANSI__
 || defed 
__USE_XOPEN2K
)

655 #ifde
__REDIRECT


659 
	`__REDIRECT
 (
fwsnf
, (
__FILE
 *
__ri
 
__am
,

660 cڡ 
wch_t
 *
__ri
 
__fm
, ...),

661 
__isoc99_fwsnf
)

663 
	`__REDIRECT
 (
wsnf
, (cڡ 
wch_t
 *
__ri
 
__fm
, ...),

664 
__isoc99_wsnf
)

666 
	`__REDIRECT_NTH
 (
swsnf
, (cڡ 
wch_t
 *
__ri
 
__s
,

667 cڡ 
wch_t
 *
__ri
 
__fm
,

668 ...), 
__isoc99_swsnf
)

671 
	`__isoc99_fwsnf
 (
__FILE
 *
__ri
 
__am
,

672 cڡ 
wch_t
 *
__ri
 
__fm
, ...);

673 
	`__isoc99_wsnf
 (cڡ 
wch_t
 *
__ri
 
__fm
, ...);

674 
	$__isoc99_swsnf
 (cڡ 
wch_t
 *
__ri
 
__s
,

675 cڡ 
wch_t
 *
__ri
 
__fm
, ...)

676 
__THROW
;

677 
	#fwsnf
 
__isoc99_fwsnf


	)

678 
	#wsnf
 
__isoc99_wsnf


	)

679 
	#swsnf
 
__isoc99_swsnf


	)

683 
__END_NAMESPACE_STD


686 #ifde
__USE_ISOC99


687 
__BEGIN_NAMESPACE_C99


692 
	`vfwsnf
 (
__FILE
 *
__ri
 
__s
,

693 cڡ 
wch_t
 *
__ri
 
__fm
,

694 
__gnuc_va_li
 
__g
)

700 
	`vwsnf
 (cڡ 
wch_t
 *
__ri
 
__fm
,

701 
__gnuc_va_li
 
__g
)

704 
	$vswsnf
 (cڡ 
wch_t
 *
__ri
 
__s
,

705 cڡ 
wch_t
 *
__ri
 
__fm
,

706 
__gnuc_va_li
 
__g
)

707 
__THROW
 ;

709 #i!
defed
 
__USE_GNU
 \

710 && (!
defed
 
__LDBL_COMPAT
 || !defed 
__REDIRECT
) \

711 && (
defed
 
__STRICT_ANSI__
 || defed 
__USE_XOPEN2K
)

712 #ifde
__REDIRECT


713 
	`__REDIRECT
 (
vfwsnf
, (
__FILE
 *
__ri
 
__s
,

714 cڡ 
wch_t
 *
__ri
 
__fm
,

715 
__gnuc_va_li
 
__g
), 
__isoc99_vfwsnf
)

717 
	`__REDIRECT
 (
vwsnf
, (cڡ 
wch_t
 *
__ri
 
__fm
,

718 
__gnuc_va_li
 
__g
), 
__isoc99_vwsnf
)

720 
	`__REDIRECT_NTH
 (
vswsnf
, (cڡ 
wch_t
 *
__ri
 
__s
,

721 cڡ 
wch_t
 *
__ri
 
__fm
,

722 
__gnuc_va_li
 
__g
), 
__isoc99_vswsnf
)

725 
	`__isoc99_vfwsnf
 (
__FILE
 *
__ri
 
__s
,

726 cڡ 
wch_t
 *
__ri
 
__fm
,

727 
__gnuc_va_li
 
__g
);

728 
	`__isoc99_vwsnf
 (cڡ 
wch_t
 *
__ri
 
__fm
,

729 
__gnuc_va_li
 
__g
);

730 
	$__isoc99_vswsnf
 (cڡ 
wch_t
 *
__ri
 
__s
,

731 cڡ 
wch_t
 *
__ri
 
__fm
,

732 
__gnuc_va_li
 
__g

__THROW
;

733 
	#vfwsnf
 
__isoc99_vfwsnf


	)

734 
	#vwsnf
 
__isoc99_vwsnf


	)

735 
	#vswsnf
 
__isoc99_vswsnf


	)

739 
__END_NAMESPACE_C99


743 
__BEGIN_NAMESPACE_STD


748 
wt_t
 
	`fgwc
 (
__FILE
 *
__am
);

749 
wt_t
 
	`gwc
 (
__FILE
 *
__am
);

755 
wt_t
 
	`gwch
 ();

762 
wt_t
 
	`utwc
 (
wch_t
 
__wc
, 
__FILE
 *
__am
);

763 
wt_t
 
	`putwc
 (
wch_t
 
__wc
, 
__FILE
 *
__am
);

769 
wt_t
 
	`putwch
 (
wch_t
 
__wc
);

777 
wch_t
 *
	`fgws
 (wch_*
__ri
 
__ws
, 
__n
,

778 
__FILE
 *
__ri
 
__am
);

784 
	`utws
 (cڡ 
wch_t
 *
__ri
 
__ws
,

785 
__FILE
 *
__ri
 
__am
);

792 
wt_t
 
	`ungwc
 (wt_
__wc
, 
__FILE
 *
__am
);

793 
__END_NAMESPACE_STD


796 #ifde
__USE_GNU


804 
wt_t
 
	`gwc_uocked
 (
__FILE
 *
__am
);

805 
wt_t
 
	`gwch_uocked
 ();

813 
wt_t
 
	`fgwc_uocked
 (
__FILE
 *
__am
);

821 
wt_t
 
	`utwc_uocked
 (
wch_t
 
__wc
, 
__FILE
 *
__am
);

830 
wt_t
 
	`putwc_uocked
 (
wch_t
 
__wc
, 
__FILE
 *
__am
);

831 
wt_t
 
	`putwch_uocked
 (
wch_t
 
__wc
);

840 
wch_t
 *
	`fgws_uocked
 (wch_*
__ri
 
__ws
, 
__n
,

841 
__FILE
 *
__ri
 
__am
);

849 
	`utws_uocked
 (cڡ 
wch_t
 *
__ri
 
__ws
,

850 
__FILE
 *
__ri
 
__am
);

854 
__BEGIN_NAMESPACE_C99


858 
size_t
 
	$wcsime
 (
wch_t
 *
__ri
 
__s
, 
size_t
 
__maxsize
,

859 cڡ 
wch_t
 *
__ri
 
__fm
,

860 cڡ 
tm
 *
__ri
 
__

__THROW
;

861 
__END_NAMESPACE_C99


863 #ifde
__USE_GNU


864 
	~<xlo.h
>

868 
size_t
 
	$wcsime_l
 (
wch_t
 *
__ri
 
__s
, 
size_t
 
__maxsize
,

869 cڡ 
wch_t
 *
__ri
 
__fm
,

870 cڡ 
tm
 *
__ri
 
__
,

871 
__lo_t
 
__loc

__THROW
;

880 #i
defed
 
__USE_UNIX98
 && !defed 
__USE_GNU


881 
	#__ed_iswxxx


	)

882 
	~<wy.h
>

886 #i
__USE_FORTIFY_LEVEL
 > 0 && 
defed
 
__ftify_funi


887 
	~<bs/wch2.h
>

890 #ifde
__LDBL_COMPAT


891 
	~<bs/wch-ldbl.h
>

894 
__END_DECLS


902 #unde
__ed_mbe_t


903 #unde
__ed_wt_t


	@/usr/include/wctype.h

23 #ide
_WCTYPE_H


25 
	~<us.h
>

26 
	~<bs/tys.h
>

28 #ide
__ed_iswxxx


29 
	#_WCTYPE_H
 1

	)

32 
	#__ed_wt_t


	)

33 
	~<wch.h
>

37 #ide
WEOF


38 
	#WEOF
 (0xffffffffu)

	)

41 #unde
__ed_iswxxx


46 #ide
__iswxxx_defed


47 
	#__iswxxx_defed
 1

	)

49 
__BEGIN_NAMESPACE_C99


52 
	twy_t
;

53 
	g__END_NAMESPACE_C99


55 #ide
_ISwb


60 
	~<dn.h
>

61 #i
__BYTE_ORDER
 =
__BIG_ENDIAN


62 
	#_ISwb
(
b
(1 << (b))

	)

64 
	#_ISwb
(
b
) \

65 ((
b
) < 8 ? () ((1UL << (bit)) << 24) \

66 : ((
b
) < 16 ? () ((1UL << (bit)) << 8) \

67 : ((
b
) < 24 ? () ((1UL << (bit)) >> 8) \

68 : (((1UL << (
b
)>> 24))))

	)

73 
	m__ISwu
 = 0,

74 
	m__ISwlow
 = 1,

75 
	m__ISwpha
 = 2,

76 
	m__ISwdig
 = 3,

77 
	m__ISwxdig
 = 4,

78 
	m__ISwa
 = 5,

79 
	m__ISwt
 = 6,

80 
	m__ISwgph
 = 7,

81 
	m__ISwbnk
 = 8,

82 
	m__ISwl
 = 9,

83 
	m__ISwpun
 = 10,

84 
	m__ISwnum
 = 11,

86 
	m_ISwu
 = 
_ISwb
 (
__ISwu
),

87 
	m_ISwlow
 = 
_ISwb
 (
__ISwlow
),

88 
	m_ISwpha
 = 
_ISwb
 (
__ISwpha
),

89 
	m_ISwdig
 = 
_ISwb
 (
__ISwdig
),

90 
	m_ISwxdig
 = 
_ISwb
 (
__ISwxdig
),

91 
	m_ISwa
 = 
_ISwb
 (
__ISwa
),

92 
	m_ISwt
 = 
_ISwb
 (
__ISwt
),

93 
	m_ISwgph
 = 
_ISwb
 (
__ISwgph
),

94 
	m_ISwbnk
 = 
_ISwb
 (
__ISwbnk
),

95 
	m_ISwl
 = 
_ISwb
 (
__ISwl
),

96 
	m_ISwpun
 = 
_ISwb
 (
__ISwpun
),

97 
	m_ISwnum
 = 
_ISwb
 (
__ISwnum
)

102 
__BEGIN_DECLS


104 
__BEGIN_NAMESPACE_C99


111 
	$iswnum
 (
wt_t
 
__wc

__THROW
;

117 
	$iswpha
 (
wt_t
 
__wc

__THROW
;

120 
	$iswl
 (
wt_t
 
__wc

__THROW
;

124 
	$iswdig
 (
wt_t
 
__wc

__THROW
;

128 
	$iswgph
 (
wt_t
 
__wc

__THROW
;

133 
	$iswlow
 (
wt_t
 
__wc

__THROW
;

136 
	$iswt
 (
wt_t
 
__wc

__THROW
;

141 
	$iswpun
 (
wt_t
 
__wc

__THROW
;

146 
	$iswa
 (
wt_t
 
__wc

__THROW
;

151 
	$iswu
 (
wt_t
 
__wc

__THROW
;

156 
	$iswxdig
 (
wt_t
 
__wc

__THROW
;

161 #ifde
__USE_ISOC99


162 
	$iswbnk
 (
wt_t
 
__wc

__THROW
;

171 
wy_t
 
	$wy
 (cڡ *
__ݔty

__THROW
;

175 
	$iswy
 (
wt_t
 
__wc
, 
wy_t
 
__desc

__THROW
;

176 
__END_NAMESPACE_C99


183 
__BEGIN_NAMESPACE_C99


186 cڡ 
	t__t32_t
 *
	twns_t
;

187 
__END_NAMESPACE_C99


188 #ifde
__USE_GNU


189 
	$__USING_NAMESPACE_C99
(
wns_t
)

192 
__BEGIN_NAMESPACE_C99


194 
wt_t
 
	$towlow
 (
wt_t
 
__wc

__THROW
;

197 
wt_t
 
	$towu
 (
wt_t
 
__wc

__THROW
;

198 
__END_NAMESPACE_C99


200 
__END_DECLS


207 #ifde
_WCTYPE_H


213 
__BEGIN_DECLS


215 
__BEGIN_NAMESPACE_C99


218 
wns_t
 
	$wns
 (cڡ *
__ݔty

__THROW
;

221 
wt_t
 
	$towns
 (
wt_t
 
__wc
, 
wns_t
 
__desc

__THROW
;

222 
__END_NAMESPACE_C99


224 #ifde
__USE_XOPEN2K8


226 
	~<xlo.h
>

230 
	$iswnum_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

236 
	$iswpha_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

239 
	$iswl_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

243 
	$iswdig_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

247 
	$iswgph_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

252 
	$iswlow_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

255 
	$iswt_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

260 
	$iswpun_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

265 
	$iswa_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

270 
	$iswu_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

275 
	$iswxdig_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

280 
	$iswbnk_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

284 
wy_t
 
	$wy_l
 (cڡ *
__ݔty
, 
__lo_t
 
__lo
)

285 
__THROW
;

289 
	$iswy_l
 (
wt_t
 
__wc
, 
wy_t
 
__desc
, 
__lo_t
 
__lo
)

290 
__THROW
;

298 
wt_t
 
	$towlow_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

301 
wt_t
 
	$towu_l
 (
wt_t
 
__wc
, 
__lo_t
 
__lo

__THROW
;

305 
wns_t
 
	$wns_l
 (cڡ *
__ݔty
, 
__lo_t
 
__lo
)

306 
__THROW
;

309 
wt_t
 
	$towns_l
 (
wt_t
 
__wc
, 
wns_t
 
__desc
,

310 
__lo_t
 
__lo

__THROW
;

314 
__END_DECLS


	@
1
.
1
/usr/include
638
15077
demo/dcc/main.c
demo/epics/bacepics.h
demo/epics/main.c
demo/gateway/gateway.h
demo/gateway/main.c
demo/handler/dlenv.c
demo/handler/h_alarm_ack.c
demo/handler/h_arf.c
demo/handler/h_arf_a.c
demo/handler/h_awf.c
demo/handler/h_bbmd6.c
demo/handler/h_ccov.c
demo/handler/h_cov.c
demo/handler/h_dcc.c
demo/handler/h_gas_a.c
demo/handler/h_get_alarm_sum.c
demo/handler/h_getevent.c
demo/handler/h_getevent_a.c
demo/handler/h_iam.c
demo/handler/h_ihave.c
demo/handler/h_lso.c
demo/handler/h_npdu.c
demo/handler/h_pt.c
demo/handler/h_pt_a.c
demo/handler/h_rd.c
demo/handler/h_routed_npdu.c
demo/handler/h_rp.c
demo/handler/h_rp_a.c
demo/handler/h_rpm.c
demo/handler/h_rpm_a.c
demo/handler/h_rr.c
demo/handler/h_rr_a.c
demo/handler/h_ts.c
demo/handler/h_ucov.c
demo/handler/h_upt.c
demo/handler/h_whohas.c
demo/handler/h_whois.c
demo/handler/h_wp.c
demo/handler/h_wpm.c
demo/handler/noserv.c
demo/handler/objects.c
demo/handler/s_ack_alarm.c
demo/handler/s_arfs.c
demo/handler/s_awfs.c
demo/handler/s_cevent.c
demo/handler/s_cov.c
demo/handler/s_dcc.c
demo/handler/s_iam.c
demo/handler/s_ihave.c
demo/handler/s_lso.c
demo/handler/s_ptransfer.c
demo/handler/s_rd.c
demo/handler/s_readrange.c
demo/handler/s_router.c
demo/handler/s_rp.c
demo/handler/s_rpm.c
demo/handler/s_ts.c
demo/handler/s_uevent.c
demo/handler/s_upt.c
demo/handler/s_whohas.c
demo/handler/s_whois.c
demo/handler/s_wp.c
demo/handler/s_wpm.c
demo/handler/txbuf.c
demo/iamrouter/main.c
demo/initrouter/main.c
demo/mstpcap/main.c
demo/mstpcrc/main.c
demo/object/ai.c
demo/object/ai.h
demo/object/ao.c
demo/object/ao.h
demo/object/av.c
demo/object/av.h
demo/object/bacfile.c
demo/object/bacfile.h
demo/object/bi.c
demo/object/bi.h
demo/object/bo.c
demo/object/bo.h
demo/object/bv.c
demo/object/bv.h
demo/object/csv.c
demo/object/csv.h
demo/object/device-client.c
demo/object/device.c
demo/object/device.h
demo/object/gw_device.c
demo/object/lc.c
demo/object/lc.h
demo/object/lo.c
demo/object/lo.h
demo/object/lsp.c
demo/object/lsp.h
demo/object/ms-input.c
demo/object/ms-input.h
demo/object/mso.c
demo/object/mso.h
demo/object/msv.c
demo/object/msv.h
demo/object/nc.c
demo/object/nc.h
demo/object/osv.c
demo/object/osv.h
demo/object/piv.c
demo/object/piv.h
demo/object/schedule.c
demo/object/schedule.h
demo/object/trendlog.c
demo/object/trendlog.h
demo/perl/perl_bindings.c
demo/piface/device.c
demo/piface/main.c
demo/ptransfer/main.c
demo/readbdt/main.c
demo/readfile/main.c
demo/readprop/main.c
demo/readpropm/main.c
demo/readrange/main.c
demo/reinit/main.c
demo/router-ipv6/main.c
demo/router/ipmodule.c
demo/router/ipmodule.h
demo/router/main.c
demo/router/msgqueue.c
demo/router/msgqueue.h
demo/router/mstpmodule.c
demo/router/mstpmodule.h
demo/router/network_layer.c
demo/router/network_layer.h
demo/router/portthread.c
demo/router/portthread.h
demo/scov/main.c
demo/server/main.c
demo/server/server.h
demo/timesync/main.c
demo/ucov/main.c
demo/uptransfer/main.c
demo/whohas/main.c
demo/whois/main.c
demo/whoisrouter/main.c
demo/writefile/main.c
demo/writeprop/main.c
include/abort.h
include/address.h
include/alarm_ack.h
include/apdu.h
include/arcnet.h
include/arf.h
include/awf.h
include/bacaddr.h
include/bacapp.h
include/bacdcode.h
include/bacdef.h
include/bacdevobjpropref.h
include/bacenum.h
include/bacerror.h
include/bacint.h
include/bacnet.h
include/bacprop.h
include/bacpropstates.h
include/bacreal.h
include/bacstr.h
include/bactext.h
include/bactimevalue.h
include/bigend.h
include/bip.h
include/bip6.h
include/bits.h
include/bvlc.h
include/bvlc6.h
include/bytes.h
include/client.h
include/config.h
include/cov.h
include/crc.h
include/datalink.h
include/datetime.h
include/dcc.h
include/debug.h
include/dlenv.h
include/dlmstp.h
include/ethernet.h
include/event.h
include/fifo.h
include/filename.h
include/get_alarm_sum.h
include/getevent.h
include/handlers.h
include/iam.h
include/ihave.h
include/indtext.h
include/key.h
include/keylist.h
include/lighting.h
include/lso.h
include/memcopy.h
include/mstp.h
include/mstpdef.h
include/mstptext.h
include/mydata.h
include/npdu.h
include/objects.h
include/proplist.h
include/ptransfer.h
include/rd.h
include/readrange.h
include/reject.h
include/ringbuf.h
include/rp.h
include/rpm.h
include/sbuf.h
include/timestamp.h
include/timesync.h
include/tsm.h
include/txbuf.h
include/version.h
include/vmac.h
include/whohas.h
include/whois.h
include/wp.h
include/wpm.h
lib/main.cpp
lib/main.h
ports/arm7/_stdint.h
ports/arm7/bip.c
ports/arm7/net.h
ports/arm7/stdbool.h
ports/at91sam7s/ai.c
ports/at91sam7s/at91sam7s256.h
ports/at91sam7s/av.c
ports/at91sam7s/bi.c
ports/at91sam7s/blinker.c
ports/at91sam7s/board.h
ports/at91sam7s/bv.c
ports/at91sam7s/device.c
ports/at91sam7s/dlmstp.c
ports/at91sam7s/init.c
ports/at91sam7s/irq.c
ports/at91sam7s/isr.c
ports/at91sam7s/isr.h
ports/at91sam7s/main.c
ports/at91sam7s/rs485.c
ports/at91sam7s/rs485.h
ports/at91sam7s/timer.c
ports/at91sam7s/timer.h
ports/atmega168/ai.c
ports/atmega168/ai.h
ports/atmega168/apdu.c
ports/atmega168/av.c
ports/atmega168/av.h
ports/atmega168/avr035.h
ports/atmega168/bv.c
ports/atmega168/bv.h
ports/atmega168/device.c
ports/atmega168/device.h
ports/atmega168/dlmstp.c
ports/atmega168/h_rp.c
ports/atmega168/h_whois.c
ports/atmega168/h_wp.c
ports/atmega168/hardware.h
ports/atmega168/iar2gcc.h
ports/atmega168/main.c
ports/atmega168/rs485.c
ports/atmega168/rs485.h
ports/atmega168/stack.c
ports/atmega168/stack.h
ports/atmega168/stdbool.h
ports/atmega168/stdint.h
ports/atmega168/timer.c
ports/atmega168/timer.h
ports/atmega8/ai.c
ports/atmega8/apdu.c
ports/atmega8/av.c
ports/atmega8/avr035.h
ports/atmega8/bv.c
ports/atmega8/device.c
ports/atmega8/dlmstp.c
ports/atmega8/h_rp.c
ports/atmega8/hardware.h
ports/atmega8/iar2gcc.h
ports/atmega8/main.c
ports/atmega8/rs485.c
ports/atmega8/rs485.h
ports/atmega8/stdbool.h
ports/atmega8/stdint.h
ports/atmega8/timer.c
ports/atmega8/timer.h
ports/bdk-atxx4-mstp/adc-block.c
ports/bdk-atxx4-mstp/adc.c
ports/bdk-atxx4-mstp/adc.h
ports/bdk-atxx4-mstp/ai.c
ports/bdk-atxx4-mstp/av.c
ports/bdk-atxx4-mstp/avrosp/AVRBootloader.cpp
ports/bdk-atxx4-mstp/avrosp/AVRBootloader.hpp
ports/bdk-atxx4-mstp/avrosp/AVRDevice.cpp
ports/bdk-atxx4-mstp/avrosp/AVRDevice.hpp
ports/bdk-atxx4-mstp/avrosp/AVRInSystemProg.cpp
ports/bdk-atxx4-mstp/avrosp/AVRInSystemProg.hpp
ports/bdk-atxx4-mstp/avrosp/AVRProgrammer.cpp
ports/bdk-atxx4-mstp/avrosp/AVRProgrammer.hpp
ports/bdk-atxx4-mstp/avrosp/CommChannel.cpp
ports/bdk-atxx4-mstp/avrosp/CommChannel.hpp
ports/bdk-atxx4-mstp/avrosp/ErrorMsg.cpp
ports/bdk-atxx4-mstp/avrosp/ErrorMsg.hpp
ports/bdk-atxx4-mstp/avrosp/HEXParser.cpp
ports/bdk-atxx4-mstp/avrosp/HEXParser.hpp
ports/bdk-atxx4-mstp/avrosp/JobInfo.cpp
ports/bdk-atxx4-mstp/avrosp/JobInfo.hpp
ports/bdk-atxx4-mstp/avrosp/SerialPort.cpp
ports/bdk-atxx4-mstp/avrosp/SerialPort.hpp
ports/bdk-atxx4-mstp/avrosp/Utility.cpp
ports/bdk-atxx4-mstp/avrosp/Utility.hpp
ports/bdk-atxx4-mstp/avrosp/XMLParser.cpp
ports/bdk-atxx4-mstp/avrosp/XMLParser.hpp
ports/bdk-atxx4-mstp/avrosp/main.cpp
ports/bdk-atxx4-mstp/bacnet.c
ports/bdk-atxx4-mstp/bacnet.h
ports/bdk-atxx4-mstp/bi.c
ports/bdk-atxx4-mstp/bname.c
ports/bdk-atxx4-mstp/bname.h
ports/bdk-atxx4-mstp/bo.c
ports/bdk-atxx4-mstp/bootloader/defines.h
ports/bdk-atxx4-mstp/bootloader/flash.h
ports/bdk-atxx4-mstp/bootloader/main.c
ports/bdk-atxx4-mstp/bootloader/serial.c
ports/bdk-atxx4-mstp/bootloader/serial.h
ports/bdk-atxx4-mstp/crossworks/stdbool.h
ports/bdk-atxx4-mstp/device.c
ports/bdk-atxx4-mstp/dlmstp.c
ports/bdk-atxx4-mstp/eeprom.c
ports/bdk-atxx4-mstp/eeprom.h
ports/bdk-atxx4-mstp/fuses.c
ports/bdk-atxx4-mstp/hardware.h
ports/bdk-atxx4-mstp/iar2gcc.h
ports/bdk-atxx4-mstp/init.c
ports/bdk-atxx4-mstp/init.h
ports/bdk-atxx4-mstp/input.c
ports/bdk-atxx4-mstp/input.h
ports/bdk-atxx4-mstp/led.c
ports/bdk-atxx4-mstp/led.h
ports/bdk-atxx4-mstp/main.c
ports/bdk-atxx4-mstp/nvdata.h
ports/bdk-atxx4-mstp/rs485.c
ports/bdk-atxx4-mstp/rs485.h
ports/bdk-atxx4-mstp/seeprom.c
ports/bdk-atxx4-mstp/seeprom.h
ports/bdk-atxx4-mstp/serial.c
ports/bdk-atxx4-mstp/serial.h
ports/bdk-atxx4-mstp/stack.c
ports/bdk-atxx4-mstp/stack.h
ports/bdk-atxx4-mstp/test.c
ports/bdk-atxx4-mstp/test.h
ports/bdk-atxx4-mstp/timer.c
ports/bdk-atxx4-mstp/timer.h
ports/bdk-atxx4-mstp/timer2.c
ports/bdk-atxx4-mstp/watchdog.c
ports/bdk-atxx4-mstp/watchdog.h
ports/bsd/bip-init.c
ports/bsd/main.c
ports/bsd/net.h
ports/bsd/stdbool.h
ports/bsd/timer.c
ports/bsd/timer.h
ports/dos/dlmstp.c
ports/dos/extkword.h
ports/dos/main.c
ports/dos/mk_fp.h
ports/dos/pchwio.c
ports/dos/pchwio.h
ports/dos/queue.c
ports/dos/queue.h
ports/dos/rs485.c
ports/dos/rs485.h
ports/dos/serial.c
ports/dos/serial.h
ports/dos/stdbool.h
ports/dos/stdint.h
ports/dos/timer.c
ports/dos/timer.h
ports/linux/arcnet.c
ports/linux/bip-init.c
ports/linux/bip6.c
ports/linux/dlmstp.c
ports/linux/dlmstp_linux.c
ports/linux/dlmstp_linux.h
ports/linux/ethernet.c
ports/linux/mstpsnap.c
ports/linux/net.h
ports/linux/rs485.c
ports/linux/rs485.h
ports/linux/rx_fsm.c
ports/linux/timer.c
ports/linux/timer.h
ports/lwip/bip.c
ports/lwip/net.h
ports/pic18f6720/ai.c
ports/pic18f6720/apdu.c
ports/pic18f6720/av.c
ports/pic18f6720/bi.c
ports/pic18f6720/bv.c
ports/pic18f6720/device.c
ports/pic18f6720/dlmstp.c
ports/pic18f6720/dlmstp.h
ports/pic18f6720/hardware.h
ports/pic18f6720/isr.c
ports/pic18f6720/main.c
ports/pic18f6720/mstp.c
ports/pic18f6720/mstp.h
ports/pic18f6720/rs485.c
ports/pic18f6720/rs485.h
ports/pic18f6720/stdbool.h
ports/pic18f6720/stdint.h
ports/rtos32/bip-init.c
ports/rtos32/dlmstp.c
ports/rtos32/ethernet.c
ports/rtos32/init.c
ports/rtos32/main.c
ports/rtos32/mstp.c
ports/rtos32/mstp.h
ports/rtos32/net.h
ports/rtos32/netcfg.h
ports/rtos32/rs485.c
ports/rtos32/rs485.h
ports/rtos32/stdbool.h
ports/rtos32/stdint.h
ports/rx62n/bacnet.c
ports/rx62n/bacnet.h
ports/rx62n/bo.c
ports/rx62n/device.c
ports/rx62n/ethernet.c
ports/rx62n/hardware.h
ports/rx62n/led.c
ports/rx62n/led.h
ports/rx62n/main.c
ports/rx62n/timer-hdw.c
ports/rx62n/timer.c
ports/rx62n/timer.h
ports/stm32f10x/CMSIS/core_cm3.c
ports/stm32f10x/CMSIS/core_cm3.h
ports/stm32f10x/CMSIS/stm32f10x.h
ports/stm32f10x/CMSIS/system_stm32f10x.h
ports/stm32f10x/automac.c
ports/stm32f10x/automac.h
ports/stm32f10x/bacnet.c
ports/stm32f10x/bacnet.h
ports/stm32f10x/bo.c
ports/stm32f10x/device.c
ports/stm32f10x/dlmstp.c
ports/stm32f10x/drivers/inc/stm32f10x_adc.h
ports/stm32f10x/drivers/inc/stm32f10x_bkp.h
ports/stm32f10x/drivers/inc/stm32f10x_can.h
ports/stm32f10x/drivers/inc/stm32f10x_cec.h
ports/stm32f10x/drivers/inc/stm32f10x_crc.h
ports/stm32f10x/drivers/inc/stm32f10x_dac.h
ports/stm32f10x/drivers/inc/stm32f10x_dbgmcu.h
ports/stm32f10x/drivers/inc/stm32f10x_dma.h
ports/stm32f10x/drivers/inc/stm32f10x_exti.h
ports/stm32f10x/drivers/inc/stm32f10x_flash.h
ports/stm32f10x/drivers/inc/stm32f10x_fsmc.h
ports/stm32f10x/drivers/inc/stm32f10x_gpio.h
ports/stm32f10x/drivers/inc/stm32f10x_i2c.h
ports/stm32f10x/drivers/inc/stm32f10x_iwdg.h
ports/stm32f10x/drivers/inc/stm32f10x_misc.h
ports/stm32f10x/drivers/inc/stm32f10x_pwr.h
ports/stm32f10x/drivers/inc/stm32f10x_rcc.h
ports/stm32f10x/drivers/inc/stm32f10x_rtc.h
ports/stm32f10x/drivers/inc/stm32f10x_sdio.h
ports/stm32f10x/drivers/inc/stm32f10x_spi.h
ports/stm32f10x/drivers/inc/stm32f10x_tim.h
ports/stm32f10x/drivers/inc/stm32f10x_usart.h
ports/stm32f10x/drivers/inc/stm32f10x_wwdg.h
ports/stm32f10x/drivers/src/stm32f10x_adc.c
ports/stm32f10x/drivers/src/stm32f10x_bkp.c
ports/stm32f10x/drivers/src/stm32f10x_can.c
ports/stm32f10x/drivers/src/stm32f10x_cec.c
ports/stm32f10x/drivers/src/stm32f10x_crc.c
ports/stm32f10x/drivers/src/stm32f10x_dac.c
ports/stm32f10x/drivers/src/stm32f10x_dbgmcu.c
ports/stm32f10x/drivers/src/stm32f10x_dma.c
ports/stm32f10x/drivers/src/stm32f10x_exti.c
ports/stm32f10x/drivers/src/stm32f10x_flash.c
ports/stm32f10x/drivers/src/stm32f10x_fsmc.c
ports/stm32f10x/drivers/src/stm32f10x_gpio.c
ports/stm32f10x/drivers/src/stm32f10x_i2c.c
ports/stm32f10x/drivers/src/stm32f10x_iwdg.c
ports/stm32f10x/drivers/src/stm32f10x_misc.c
ports/stm32f10x/drivers/src/stm32f10x_pwr.c
ports/stm32f10x/drivers/src/stm32f10x_rcc.c
ports/stm32f10x/drivers/src/stm32f10x_rtc.c
ports/stm32f10x/drivers/src/stm32f10x_sdio.c
ports/stm32f10x/drivers/src/stm32f10x_spi.c
ports/stm32f10x/drivers/src/stm32f10x_tim.c
ports/stm32f10x/drivers/src/stm32f10x_usart.c
ports/stm32f10x/drivers/src/stm32f10x_wwdg.c
ports/stm32f10x/drivers/src/syscalls.c
ports/stm32f10x/hardware.h
ports/stm32f10x/led.c
ports/stm32f10x/led.h
ports/stm32f10x/main.c
ports/stm32f10x/rs485.c
ports/stm32f10x/rs485.h
ports/stm32f10x/stm32f10x_conf.h
ports/stm32f10x/stm32f10x_it.c
ports/stm32f10x/stm32f10x_it.h
ports/stm32f10x/system_stm32f10x.c
ports/stm32f10x/timer.c
ports/stm32f10x/timer.h
ports/stm32f10x/timer_sys.c
ports/win32/bip-init.c
ports/win32/bip6.c
ports/win32/dlmstp-mm.c
ports/win32/dlmstp.c
ports/win32/ethernet.c
ports/win32/main.c
ports/win32/net.h
ports/win32/rs485.c
ports/win32/rs485.h
ports/win32/rx_fsm.c
ports/win32/stdbool.h
ports/win32/stdint.h
ports/win32/timer.c
ports/win32/timer.h
src/abort.c
src/address.c
src/alarm_ack.c
src/apdu.c
src/arf.c
src/awf.c
src/bacaddr.c
src/bacapp.c
src/bacdcode.c
src/bacdevobjpropref.c
src/bacerror.c
src/bacint.c
src/bacprop.c
src/bacpropstates.c
src/bacreal.c
src/bacstr.c
src/bactext.c
src/bactimevalue.c
src/bigend.c
src/bip.c
src/bvlc.c
src/bvlc6.c
src/cov.c
src/crc.c
src/datalink.c
src/datetime.c
src/dcc.c
src/debug.c
src/event.c
src/fifo.c
src/filename.c
src/get_alarm_sum.c
src/getevent.c
src/iam.c
src/ihave.c
src/indtext.c
src/key.c
src/keylist.c
src/lighting.c
src/lso.c
src/memcopy.c
src/mstp.c
src/mstptext.c
src/npdu.c
src/proplist.c
src/ptransfer.c
src/rd.c
src/readrange.c
src/reject.c
src/ringbuf.c
src/rp.c
src/rpm.c
src/sbuf.c
src/timestamp.c
src/timesync.c
src/tsm.c
src/version.c
src/vmac.c
src/whohas.c
src/whois.c
src/wp.c
src/wpm.c
test/ctest.c
test/ctest.h
/usr/include/arpa/inet.h
/usr/include/assert.h
/usr/include/ctype.h
/usr/include/dirent.h
/usr/include/errno.h
/usr/include/fcntl.h
/usr/include/features.h
/usr/include/getopt.h
/usr/include/ifaddrs.h
/usr/include/libgen.h
/usr/include/limits.h
/usr/include/linux/if_arcnet.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_packet.h
/usr/include/linux/serial.h
/usr/include/math.h
/usr/include/memory.h
/usr/include/net/ethernet.h
/usr/include/net/if.h
/usr/include/net/if_arp.h
/usr/include/net/route.h
/usr/include/netdb.h
/usr/include/netinet/in.h
/usr/include/netpacket/packet.h
/usr/include/poll.h
/usr/include/pthread.h
/usr/include/sched.h
/usr/include/semaphore.h
/usr/include/signal.h
/usr/include/stdint.h
/usr/include/stdio.h
/usr/include/stdlib.h
/usr/include/string.h
/usr/include/strings.h
/usr/include/termios.h
/usr/include/time.h
/usr/include/unistd.h
/usr/include/alloca.h
/usr/include/endian.h
/usr/include/libio.h
/usr/include/linux/tty_flags.h
/usr/include/linux/types.h
/usr/include/rpc/netdb.h
/usr/include/stdc-predef.h
/usr/include/xlocale.h
/usr/include/_G_config.h
/usr/include/linux/posix_types.h
/usr/include/gconv.h
/usr/include/linux/stddef.h
/usr/include/wchar.h
/usr/include/wctype.h
